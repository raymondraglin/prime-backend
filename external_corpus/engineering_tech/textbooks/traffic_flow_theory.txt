Traffic Flow Theory:
An introduction with exercises

Victor L. Knoop
TRAFFIC FLOW THEORY: AN INTRODUCTION WITH
                          EXERCISES

                            VICTOR L. KNOOP

                 This work is licensed under CC BY-NC-SA 4.0
TRAFFIC FLOW THEORY: AN INTRODUCTION WITH
                          EXERCISES

                            VICTOR L. KNOOP

First publication: August 2018

Third Edition: November 2020

Cover image:  Traffic flow at the A4 near Leiden; notice the queue spillback and
              a offramp with spare capacity. Picture by Victor L. Knoop.

Copyright  2020 Victor L. Knoop / TU Delft Open
ISBN Paperback / softback: 978-94-6366-377-9 Ebook : 978-94-6366-378-6

DOI: https://doi.org/10.5074/t.2021.002

    This Open Textbook is licensed under a Creative Commons Attribution-
NonCommercial-ShareAlike 4.0 International License, except the following. CC BY-NC-SA
conditions are not applicable to figures 6.2 (p 50), 6.5 (p 52), 14.9 (p 135), 6.4 (p 51), 6.5 (p
52), 12.1 (p 112), 12.10 (p 119), 12.5 (p 114), 12.8 (p 117), 12.9b (p 118), 12.10 (p 119), and
section 6.2.2.
The latest edition of this book is available for online use and for free download from the TU
Delft Open Textbook repository at textbooks.open.tudelft.nl.
                                         CONTENTS

1 Variables                              1

1.1 Levels of description . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

1.1.1 Microscopic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

1.1.2 Marcoscopic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

1.1.3 Other levels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.2 Measuring principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.2.1 Local . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.2.2 Instantaneous . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6

1.2.3 Spatio-temporal measurements . . . . . . . . . . . . . . . . . . . 6

1.3 Stationarity and homogeneity. . . . . . . . . . . . . . . . . . . . . . . . 8

2 Cumulative curves                      11

2.1 Defenition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

2.2 Vertical queuing model . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

2.3 Travel times, densities and delays . . . . . . . . . . . . . . . . . . . . . . 13

2.3.1 Construction of cumulative curves. . . . . . . . . . . . . . . . . . 13

2.3.2 Travel times, number of vehicles in the section . . . . . . . . . . . 13

2.3.3 Delays . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

2.4 Slanted cumulative curves . . . . . . . . . . . . . . . . . . . . . . . . . 15

2.5 Practical limitations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

2.6 Example application . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

3 Relationships of traffic variables     19

3.1 Fundamental relationship . . . . . . . . . . . . . . . . . . . . . . . . . 19

3.2 Fundamental diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

3.2.1 Qualitative understanding of the shape . . . . . . . . . . . . . . . 20

3.2.2 Traffic state . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

3.2.3 Important points. . . . . . . . . . . . . . . . . . . . . . . . . . . 21

3.2.4 Fundamental diagram in different planes . . . . . . . . . . . . . . 22

3.2.5 Shapes of the fundamental diagram . . . . . . . . . . . . . . . . . 22

3.3 Microscopic behaviour . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

3.3.1 Equilibrium behaviour . . . . . . . . . . . . . . . . . . . . . . . . 24

3.3.2 Hysteresis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

3.4 Moving observer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

4 Shock wave theory                      29

4.1 Theory and derivation of equations . . . . . . . . . . . . . . . . . . . . . 29

4.2 Example: Temporal increase in demand at a road with a lane drop . . . . . 31

4.3 Example: Temporal capacity reduction . . . . . . . . . . . . . . . . . . . 34

4.4 Stop and go waves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

                                      v
vi                                      CONTENTS

5 Shockwave theory: moving bottlenecks  39

    5.1 Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

    5.2 Example 1: moving truck, no overtaking possibilities . . . . . . . . . . . . 40

    5.3 Example 2: moving truck with overtaking possibilities . . . . . . . . . . . 42

    5.4 Example 3: moving truck and high demand . . . . . . . . . . . . . . . . . 44

6 Traffic states and Phenomena          47

    6.1 Stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

    6.1.1 Local stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

    6.1.2 Platoon stability . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

    6.1.3 Traffic flow stability . . . . . . . . . . . . . . . . . . . . . . . . . 49

    6.1.4 Use of stability analysis . . . . . . . . . . . . . . . . . . . . . . . 49

    6.2 Capacity drop . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

    6.2.1 Phenomenon description . . . . . . . . . . . . . . . . . . . . . . 50

    6.2.2 Empirics (from Yuan et al. (2015a)). . . . . . . . . . . . . . . . . . 51

    6.3 Stop-and-go wave. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

    6.3.1 Phenomenon description . . . . . . . . . . . . . . . . . . . . . . 52

    6.4 Kerner's Three Phase Traffic Flow Theory . . . . . . . . . . . . . . . . . . 53

    6.4.1 States . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

    6.4.2 Transitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

7 Car-following                         59

    7.1 Newell's car following model . . . . . . . . . . . . . . . . . . . . . . . . 59

    7.2 Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

    7.2.1 Dependencies . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

    7.2.2 Reaction time . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

    7.2.3 Multi leader car-following models . . . . . . . . . . . . . . . . . . 61

    7.2.4 Insensitivity depending on distance . . . . . . . . . . . . . . . . . 62

    7.3 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

    7.3.1 Helly . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

    7.3.2 Optimal Velocity Model . . . . . . . . . . . . . . . . . . . . . . . 64

    7.3.3 Intelligent Driver model . . . . . . . . . . . . . . . . . . . . . . . 64

    7.4 Relation to fundamental diagram . . . . . . . . . . . . . . . . . . . . . . 65

8 Microscopic lane change models        67

    8.1 Type of lane changes . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

    8.2 Slugs and rabbits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

    8.2.1 Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

    8.2.2 Traffic operations . . . . . . . . . . . . . . . . . . . . . . . . . . 69

    8.2.3 Loading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

    8.2.4 Consequences . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

    8.3 Utility model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

    8.3.1 Model idea . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

    8.3.2 Model equations . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

    8.4 Integrated modelling . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
CONTENTS                                    vii

9 Use of traffic models                     73

9.1 Goal of the model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

9.2 Type of models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

9.2.1 Level . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

9.2.2 Stochasticity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

9.2.3 Different user classes . . . . . . . . . . . . . . . . . . . . . . . . 76

9.3 Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

9.3.1 Use of calibration . . . . . . . . . . . . . . . . . . . . . . . . . . 76

9.3.2 Techniques. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

9.3.3 Number of parameters . . . . . . . . . . . . . . . . . . . . . . . . 78

9.4 Validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

9.4.1 Need of validation . . . . . . . . . . . . . . . . . . . . . . . . . . 79

9.4.2 Data handling for calibration and validation . . . . . . . . . . . . . 79

9.4.3 Techniques. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

9.5 Often made mistakes . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80

10 Macroscopic Dynamic Traffic flow Models  81

10.1 Mathematical models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

10.2 Spatial and temporal discretisation . . . . . . . . . . . . . . . . . . . . . 82

10.2.1 Model working: Cell Transmission Model . . . . . . . . . . . . . . 83

10.2.2 The CTM at work: example . . . . . . . . . . . . . . . . . . . . . 85

10.2.3 Numerical diffusion . . . . . . . . . . . . . . . . . . . . . . . . . 95

10.3 Simulation of the N-model . . . . . . . . . . . . . . . . . . . . . . . . . 96

10.4 Event based . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

10.4.1 Link Transmission Model . . . . . . . . . . . . . . . . . . . . . . 97

10.5 Multi-class . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

10.5.1 Principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

10.5.2 Fastlane . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

10.6 Higher order modelling . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

10.7 Suggested problems. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

11 An Introduction to Node Models           103

11.1 Node models in the Cell Transmission Model . . . . . . . . . . . . . . . . 105

11.1.1 Merge model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105

11.1.2 Diverge model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

11.2 General node models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

11.3 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

12 Macroscopic fundamental diagram          111

12.1 Perimeter control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

12.2 Traffic dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

12.2.1 Approaches to include the standard deviation . . . . . . . . . . . . 116

12.3 Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

12.4 Recent insights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
viii                                                CONTENTS

13 Method of characteristics                        121

      13.1 Mathematical construction . . . . . . . . . . . . . . . . . . . . . . . . . 121

      13.1.1 Construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121

      13.1.2 Application to homogeneous roads . . . . . . . . . . . . . . . . . 123

      13.1.3 Interpretation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

      13.2 Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

      13.2.1 Acceleration fan . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

      13.2.2 Deceleration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125

14 Headway models                                   127

      14.1 Relation between headway and capacity . . . . . . . . . . . . . . . . . . 127

      14.2 Arrivals per interval . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

      14.2.1 Poisson . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

      14.2.2 Binomial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130

      14.2.3 Negative binomial . . . . . . . . . . . . . . . . . . . . . . . . . . 131

      14.3 Headway distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 131

      14.3.1 Exponential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131

      14.3.2 Composite headway models . . . . . . . . . . . . . . . . . . . . . 132

      14.4 Critical gap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133

      14.4.1 Situations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133

      14.4.2 Inflow capacity. . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

15 Traffic state dynamics in three representations  137

      15.1 Describing parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

      15.2 N-model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

      15.2.1 Shockwave Theory in the XT-plane. . . . . . . . . . . . . . . . . . 139

      15.3 X-model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

      15.3.1 Shockwave Theory in the NT plane . . . . . . . . . . . . . . . . . 143

      15.4 T-model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

      15.4.1 Shockwave Theory in the NX-plane . . . . . . . . . . . . . . . . . 144

      15.5 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145

References                                          147

A Test questions                                    155

      A.1 Problem set 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

      A.1.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

      A.1.2 State recognition . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

      A.1.3 Simulation model . . . . . . . . . . . . . . . . . . . . . . . . . . 157

      A.1.4 Moving bottleneck . . . . . . . . . . . . . . . . . . . . . . . . . . 157

      A.1.5 Marathon Delft . . . . . . . . . . . . . . . . . . . . . . . . . . . 157

      A.2 Problem set 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158

      A.2.1 Short open questions . . . . . . . . . . . . . . . . . . . . . . . . 158

      A.2.2 Leaving the parking lot. . . . . . . . . . . . . . . . . . . . . . . . 158

      A.2.3 Traffic lights . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159

      A.2.4 Car-following model . . . . . . . . . . . . . . . . . . . . . . . . . 160

      A.2.5 Pedestrians in a narrow tunnel . . . . . . . . . . . . . . . . . . . . 161
CONTENTS  ix

      A.2.6 Moving bottleneck with different speeds . . . . . . . . . . . . . . . 161
A.3 Problem set 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162

      A.3.1 Short open questions . . . . . . . . . . . . . . . . . . . . . . . . 162
      A.3.2 Multi-leader car-following models . . . . . . . . . . . . . . . . . . 163
      A.3.3 Measuring the speed at a cross section. . . . . . . . . . . . . . . . 163
      A.3.4 Moving bottleneck . . . . . . . . . . . . . . . . . . . . . . . . . . 165
      A.3.5 Multi-lane traffic flow . . . . . . . . . . . . . . . . . . . . . . . . 166
A.4 Problem set 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
      A.4.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
      A.4.2 From car-following to a fundamental diagram . . . . . . . . . . . . 167
      A.4.3 MOBIL lane change model . . . . . . . . . . . . . . . . . . . . . . 167
      A.4.4 Snow plow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168
      A.4.5 Cumulative curves . . . . . . . . . . . . . . . . . . . . . . . . . . 169
      A.4.6 Crown jewels in the tower . . . . . . . . . . . . . . . . . . . . . . 170
A.5 Problem set 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
      A.5.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
      A.5.2 Motorway traffic operations . . . . . . . . . . . . . . . . . . . . . 173
      A.5.3 Car-following . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
      A.5.4 Partial road blocking near a signalised intersection . . . . . . . . . 174
      A.5.5 Network Fundamental Diagram . . . . . . . . . . . . . . . . . . . 176
A.6 Problem set 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
      A.6.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
      A.6.2 Bridge opening. . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
      A.6.3 Variable road layout . . . . . . . . . . . . . . . . . . . . . . . . . 178
      A.6.4 Traffic stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
      A.6.5 Levels of description . . . . . . . . . . . . . . . . . . . . . . . . . 181
A.7 Problem set 7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
      A.7.1 Short open questions . . . . . . . . . . . . . . . . . . . . . . . . 181
      A.7.2 Cumulative curves . . . . . . . . . . . . . . . . . . . . . . . . . . 183
      A.7.3 Macroscopic traffic variables

               in case of different vehicle classes . . . . . . . . . . . . . . . . . . 185
      A.7.4 Slow truck on the motorway . . . . . . . . . . . . . . . . . . . . . 186
A.8 Problem set 8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186
      A.8.1 Short open questions . . . . . . . . . . . . . . . . . . . . . . . . 186
      A.8.2 Microscopic effects on the fundamental diagram . . . . . . . . . . 187
      A.8.3 Prediction of downstream conditions . . . . . . . . . . . . . . . . 187
      A.8.4 Demonstration of police cars . . . . . . . . . . . . . . . . . . . . 188
      A.8.5 Stairs for cyclists at Delft train station . . . . . . . . . . . . . . . . 189
A.9 Problem set 9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190
      A.9.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 190
      A.9.2 Car-following in fog . . . . . . . . . . . . . . . . . . . . . . . . . 191
      A.9.3 Cleaning the road . . . . . . . . . . . . . . . . . . . . . . . . . . 191
      A.9.4 Mobil lane changing model . . . . . . . . . . . . . . . . . . . . . 192
      A.9.5 Pedestrians at a traffic light . . . . . . . . . . . . . . . . . . . . . 192
      A.9.6 Hysteresis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
x                                                       CONTENTS

   A.10 Problem set 10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
         A.10.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
         A.10.2 Traffic flow properties . . . . . . . . . . . . . . . . . . . . . . . . 195
         A.10.3 Speeds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
         A.10.4 Analyse a car-following model . . . . . . . . . . . . . . . . . . . . 196
         A.10.5 Traffic light. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196
         A.10.6 Macroscopic Fundamental Diagram . . . . . . . . . . . . . . . . . 197
         A.10.7 Non-vehicular traffic . . . . . . . . . . . . . . . . . . . . . . . . . 198

   A.11 Problem set 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198
         A.11.1 Short questions . . . . . . . . . . . . . . . . . . . . . . . . . . . 198
         A.11.2 Biking queues . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198
         A.11.3 Speed averaging . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
         A.11.4 Experiment of ACC equipped cars . . . . . . . . . . . . . . . . . . 199
         A.11.5 Accident downstream of a bridge . . . . . . . . . . . . . . . . . . 200
         A.11.6 Moving bottleneck principles . . . . . . . . . . . . . . . . . . . . 201
         A.11.7 Multi-lane traffic . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
         A.11.8 Macroscopic traffic simulation. . . . . . . . . . . . . . . . . . . . 201

B Solutions to test questions                           203

C Matlab code for creating (slanted) cumulative curves  249

Index                                                   251
CONTENTS  xi

PREFACE

Traffic processes cause several problems in the world. Traffic delay, pollution are some
of it. They can be solved with the right road design or traffic management (control)
measure. Before implementing these designs of measures, though, their effect could
be tested. To this end, knowledge of traffic flow theory is needed.

    This book is meant as learning book for students. To learn an engineering discipline,
practising is essential. One of the core qualities of this book, is that more than 250 prac-
tice questions (and answers) are available. Therefore, this book can be used as material
for courses.

    The historical perspective is that the book is an end product of developing, using and
continuously improving the lecture notes at Delft University of Technology. I am grateful
for the comments by students, and the help of colleagues to this book; particularly for
chapter 15, I have been following up from material written by Marie-Jette Wierbos.

    I believe that sharing this work can help students, lecturers and possibly practition-
ers. An online version of the course Traffic Flow Theory and Simulation, including lec-
tures given at Delft University of Technology is freely and openly available via Open
Courseware at TU Delft (https://ocw.tudelft.nl/, search for traffic and you will find
the course on https://ocw.tudelft.nl/courses/traffic-flow-theory-simulation/).
I believe in open access, and a community where knowledge is shared. The book is hence
free to use, and free to distribute to students.

    The book is, like science, not finished. By now, it has reached a state of maturity
that students highly value the book as it is. Therefore, this is for me the time to share
this work. I plan to have updates to the book. If you have remarks - errors, additional
request, things which are unclear - please let me know at v.l.knoop@tudelft.nl.

    The book is meant as introduction to the field of traffic flow theory. Only basic cal-
culus is assumed as base knowledge. For more in-depth knowledge, the reader can con-
tinue in other books, including:

      May, A.D. Traffic flow fundamentals. 1990.

      Leutzbach, W. Introduction to the theory of traffic flow. Vol. 47. Berlin: Springer-
        Verlag, 1988.

      Daganzo, C.F. Fundamentals of transportation and traffic operations. Vol. 30. Ox-
        ford: Pergamon, 1997.

      Treiber, M., and A. Kesting. "Traffic flow dynamics." Traffic Flow Dynamics: Data,
        Models and Simulation, Springer-Verlag Berlin Heidelberg (2013).

      Elefteriadou, L. An introduction to traffic flow theory. Vol. 84. New York, NY, USA:
        Springer, 2014.

      Ni, D. Traffic Flow Theory: Characteristics, Experimental Methods, and Numerical
        Techniques. Butterworth-Heinemann, 2015.

Of course, there also is a vast, and ever expanding, body of scientific literature which the
reader can use as follow-up material.
          1

                                 VARIABLES

After this chapter, the student is able to:

      Use the right terms for level of descriptions, and stationarity and homogeneity

      Give an interpretation to variables {x, n, t , v, q, k}

      Analyse and explain the differences between observation methods and averaging
        methods (time mean vs space mean)

      Compute and explain Edie's generalized variables of traffic

    This chapter describes the main variables which are used in traffic flow theory. Sec-
tion 1.1 will show the different levels (microscopic, macroscopic and other levels) at
which traffic is generally described. Section 1.2 will describe different principles (local,
instantaneous and spatio-temporal) to measure the traffic flow. The last section (1.3)
describes traffic flow characteristics.

1.1. LEVELS OF DESCRIPTION

This section will show the different levels at which traffic is generally described. Sections
1.1.1 and 1.1.2 will discuss the variables in the microscopic and macroscopic descrip-
tions in more detail.

    In a microscopic traffic description, every vehicle-driver combination is described.
The smallest element in the description is the vehicle-driver combination. The other
often used level of traffic flow description is the macroscopic traffic description. Differ-
ent from the microscopic description, this level does not consider individual vehicles.
Instead, the traffic variables are aggregated over several vehicles or, most commonly, a
road stretch. Typical characteristics of the traffic flow on a road stretch are the average
speed, vehicle density or flow (see section 1.1.2).Other levels of description can also be
used, these are described in the last section(see section 1.1.3).

                                                          1
2                                                         1. VARIABLES

1 Vehicle trajectories on a multilane motorway
                                      300
                                      250

              200

   Space (m)  150

              100

              50

              00   20  40  60        80  100    120

                           Time (s)

Figure 1.1: Vehicle trajectories on a multilane motorway

                                                                  gross
                                                                        net

Figure 1.2: The difference between gross and net spacing (or headway)

1.1.1. MICROSCOPIC

In a microscopic traffic description, the vehicle-driver combinations (often referred to
as "vehicles", which we will do from now on) are described individually. Full information
of a vehicle is given in its trajectory, i.e. the specification of the position of the vehicle at
all times. To have full information on these, the positions of all vehicles at all times have
to be specified. A graphical representation of vehicle trajectories is given in figure 1.1

    The trajectories are drawn in a space time plot, with time on the horizontal axis. Note
that vehicle trajectories can never go back in time. Trajectories might move back in space
if the vehicles are going in the opposite direction, for instance on a two-lane bidirectional
rural road. This is not expected on motorways. The slope of the line is the speed of the
vehicles. Therefore, the trajectories cannot be vertical - that would mean an infinite
speed. Horizontal trajectories are possible at speed zero.

    Basic variables in the microscopic representation are speed, headway, and space
headway. The speed is the amount of distance a vehicle covers in a unit of time, which is
indicated by v. Sometimes, the inverse of speed is a useful measure, the amount of time
a vehicle needs to cover a unit of space; this is called the pace p. Furthermore, there is
the space headway or spacing (s) of the vehicle. The net space headway is the distance
between the vehicle and its leader. This is also called the gap. The gross space headway
of a (following) vehicle is the distance including the length of the vehicle, so the distance
from the rear bumper of the leading vehicle to the rear bumper of the following vehi-
cle. Similarly, we can define the time it takes for a follower to get to reach (with its front
bumper) the position of its leader's rear bumper. This is called the net time headway. If
we also add the time it costs to cover the distance of a vehicle length, we get the gross
time headway. See also figure 1.2. The symbol used to indicate the headway is h.
1.1. LEVELS OF DESCRIPTION                                             3

           200                    Two vehicles                                 1
           180       Truck
Space (m)  160       Passenger car
           140
           120                                          hgross
           100                          hnet

            80             snet
            60    sgross
            40
            20    2 4 6 8 10 12 14 16 18 20 22
              00                     Time (s)

Figure 1.3: The microscopic variables explained based on two vehicles

    From now on, in this reader we will use the following conventions:

      Unless specified otherwise, headway means time headway

      Unless specified otherwise, headways and spacing are given as gross values

    Figure 1.3 shows the variables graphically. The figure shows two vehicles, a longer
vehicle and a shorter vehicle. Note that the length of the vehicles remains unchanged,
so the difference between the gross and net spacing is the same, namely the vehicle
length. The lines hence have the same thickness (i.e., vertical extension), being the
vehicle length. They seem thicker as the line is more horizontal; this is a perception
error since the reduce in thickness orthogonal to the direction of the line (which has
no physical meaning). Whereas the difference between gross and net space headway
is constant (namely the vehicle length), the difference between the gross and net time
headway changes based on the vehicle speed.

    In a trajectory plot, the slope of the line is the speed. If this slope changes, the vehicle
accelerates or decelerates. So, the curvature of the lines in a trajectory plot shows the
acceleration or deceleration of the vehicle. If the slope increases, the vehicle accelerates,
if it decreases, it decelerates.

1.1.2. MARCOSCOPIC

In a macroscopic traffic description, one does not describe individual vehicles. Rather,
one describes for each road section the aggregated variables. That is, one can specify the
density k, i.e. how close in space vehicles are together. Furthermore, one can specify the
flow q i.e. the number of vehicles passing a reference point per unit of time. Finally, one
can describe the average speed u of the vehicles on a road section. Other words for flow
are throughput, volume or intensity; we will strictly adhere to the term flow to indicate
this concept.

    All of the mentioned macroscopic variables have their microscopic counterpart. This
is summarized in table 1.1. The density is calculated as one divided by the average spac-
ing, and is calculated over a certain road stretch. For instance, if vehicles have a spacing
4                                                   1. VARIABLES

1 Table 1.1: Overview of the microscopic and macroscopic variables and their relationship; the pointy brackets
                      indicate the mean.

   Microscopic symbol unit Macroscopic symbol unit  relation

   Headway     h  s  Flow                   q      vtg/h q =                     3600

                                                                                 h
                                                                                 1000
   Spacing     s  m Density                 k      vtg/km k =
                                                                                 s

   Speed       v  m/s Average speed u              km/u u = 3.6 v

of 100 meters, there are 1/100 vehicles per meter, or 1000/100=10 veh/km. The flow is
the number of vehicles that pass a point per unit of time. It can be directly calculated
from the headways by dividing one over the average headway. For instance, if all vehi-
cles have a headway of 4 seconds, there are 1/4 vehicles per second. That means there
are 3600(s/h)/4(s/veh)= 900 veh/h. In table 1.1 units are provided and in the conversion
from one quantity to the other, one needs to pay attention. Note that the provided units
are not obligatory: one can present individual speed in km/h, or density in veh/hm.
However, always pay attention to the units before converting or calculating.

RELATION TO THE MICROSCOPIC LEVEL
The average speed is calculated as an average of the speeds of vehicles at a certain road
stretch. This speed differs from the average speed obtained by averaging speed of all
vehicles passing a certain point. The next section explains the different measuring prin-
ciples. The full explanation of the differences between the two speeds and how one can
approximate the (space) average speed by speeds of vehicles passing a certain location
is presented in section 3.4.

    Another concept for a traffic flow, in particular in relation to a detector (see also sec-
tion 1.2), is the occupancy o. This indicates which fraction of a time a detector embed-
ded in the roadway is occupied, i.e. whether there is a vehicle on top of the detector.
Suppose a detector has a length Ldet and a vehicle a length of Li . The occupancy is de-
fined as the time the detector is occupied, occupied divided by all time, i.e. the time it is
occupied and time is is not occupied not occupied

                                   occupied                                            (1.1)
                     o=

                          occupied + not occupied

The occupation time can be derived from the distances and the speed. The distance the

vehicle has to cover from the moment it starts occupying the detector up to the time it

leaves the detector is its own length plus the length of the detector. Hence, the occu-

pancy time is

                     occupied = Li + Ldet                                              (1.2)
                                         v

Once the first vehicle drives off the detector, the distance for the following vehicle to

reach the detector is the gap (i.e., the spacing minus the length of the vehicle) between

the vehicles minus the length of the detector. The amount of time this takes is

                     not occupied = s - Li - Ldet                                      (1.3)
                                               v
1.2. MEASURING PRINCIPLES                 5

into equation 1.1 and rearranging the terms, we get Substituting the expressions for the occupancy time and the non-occupancy time 1

                           o = Li + Ldet  (1.4)
                                     s

In practice, the detector length is known for a certain road configuration (usually, there
are country specific standards). So assuming a vehicle length, one can calculate the
spacing, and hence the density, from the occupancy.

1.1.3. OTHER LEVELS

Apart from the macroscopic and microscopic traffic descriptions, there are three other
levels to describe traffic. They are are less common, and are therefore not discussed in
detail. The levels mentioned here are mainly used in computer simulation models.

MESOSCOPIC
The term mesoscopic is used for any description of traffic flow which is in-between
macroscopic and microscopic. It can also be a term for simulation models which cal-
culate some elements macroscopically and some microscopically. For instance, Dynas-
mart (2003), uses such a mesoscopic description.

SUBMICROSCOPIC
In a submicroscopic description the total system state is determined by the sub levels
of a vehicle and/or driver. Processes which influence the speed of a vehicle, like for
instance mechanically throttle position and engine response, or psychologically speed
perception, are explicitly modelled. This allows to explicitly model the (change in) reac-
tion on inputs. For instance, what influence would cars with a stronger engine have on
the traffic flow.

NETWORK LEVEL
A relatively new way of describing the traffic state is the network level. This has recently
gained attention after the publication by Geroliminis and Daganzo (2008). Instead of
describing a part of a road as smallest element, one can take an area (e.g. a city center)
and consider this as one unit.

1.2. MEASURING PRINCIPLES

Whereas the previous sections described which variables are used to describe traffic flow,
this section will introduce three principles of measuring the traffic flow. These principles
are local, instantaneous and spatio-temporal.

1.2.1. LOCAL

With local measurements one observes traffic at one location. This can be for instance
a position at the roadway. To measure motorway traffic, often inductive loops are used.
These are coils embedded in the pavement in which a electrical current produces a (ver-
tical) magnetic field. If a car enters or leaves this magnetic field, this can be measured in
6  1. VARIABLES

1 single loops are used, giving the occupancy of the loop. Using equation 1.4, this can be the current of the coil. Thus, one knows how long a loop is occupied. In the US, usually

                 translated into density. The detectors also measure the flow. As will be explained later
                 in section 3.1, this suffices to completely characterise the traffic flow.

                      This determination of density builds upon the assumption of the vehicle length being
                 known. One can also measure the length of a vehicle for passing vehicles, using dual loop
                 detectors. These are inductive loops which are placed a known short distance (order of 1
                 m) from each other. If one carefully measures the time between the moment the vehicle
                 starts occupying the first loop and the moment it starts occupying the second loop, one
                 can measure its speed. If its speed is known, as well as the time it occupies one loop, the
                 length of the vehicle can also be determined.

              1.2.2. INSTANTANEOUS

                 Contrary to local measurements, there are instantaneous measurements. These are mea-
                 surements which are taken at one moment in time, most likely over a certain road stretch.
                 An example of such a measurement is an areal photograph. In such a measurement, one
                 can clearly distinguish spatial characteristics, as for instance the density. However, mea-
                 suring the temporal component (flow) is not possible.

              1.2.3. SPATIO-TEMPORAL MEASUREMENTS

                 Apart from local or instantaneous measurements, one can use measurements which
                 stretch over a period of time and a stretch of road. For instance, the trajectories in figure
                 1.1 are an example thereof. This section will introduce Edie's definitions of flow, density
                 and speed for an area in space and time.

                      A combination of instantaneous measurements and local measurements can be found
                 in remote sensing observations. These are observations which stretch in both space and
                 time. For instance, the trajectories presented in figure 1.1 can be observed using a cam-
                 era mounted on a high point or a helicopter. One can see a road stretch, and observe it
                 for a period of time.

                      Measuring average speed by definition requires an observation which stretches over
                 time and space. At one location, one cannot determine speed, nor at one moment. One
                 needs at least two locations close by (several meters) or two time instances close by. Ig-
                 noring these short distances one can calculate a local mean speed based on speeds of
                 the vehicles passing by location. Ignoring the short times, one can calculate the time
                 mean speed from the speed of the vehicles currently at the road. At this moment, we
                 suffice by mentioning these average speeds are different. Section 3.4 will show how the
                 space mean speed can be approximated from local measurements.

                      Figure 1.4 shows the same trajectories as figure 1.1, but in figure1.4 an area is se-
                 lected. Trajectories within this area in space and time are coloured red. Note that an se-
                 lected area is not necessarily square. It is even possible to have a convex area, or bound-
                 aries moving backwards and forwards in time. The definitions as introduced here will
                 hold for all types of areas, regardless of their shape in space-time.

                      Let us consider the area X . We indicate its size by WX , which is expressed in km-h, or
                 any other unit of space times time. For all vehicles, we consider the distance they drive in
                 area X , which we call dX ,i . Adding these for all vehicles i gives the total distance covered
1.2. MEASURING PRINCIPLES                                    7

in area X , indicated by T D:                                                                     1

                               TD =                   dX ,i  (1.5)

                                      all vehicles i

For a rectangular area in space and time, the distance covered might be the distance
from the upstream end to the downstream end, but the trajectory can also begin and/or
end at the side of the area, at a certain time. In that case, the distance is less than the full
distance.

    Similarly, we can define the time a vehicle spends in area X , tX ,i , which we can sum
for all vehicles i to get the total time spent in area X , indicated by T T .

                               TT =                   tX ,i  (1.6)

                                      all vehicles i

    Obviously, both quantities grow in principle with the area size. Therefore, the traffic
flow is best characterised by the quantities T D/WX and T T /WX . This gives the flow and
the density respectively:

                                          TD                 (1.7)
                               q=                            (1.8)

                                          WX
                                          TT
                               k=
                                          WX

    Intuitively, the relationship is best understood reasoning from the known relations of
density and flow. Starting with a situation of 1000 veh/h at a cross section, and an area
of 1 h and 2 km. In 1 hour, 1000 vehicles pass by, which all travel 2 kilometres in the area.
(There the vehicles which cannot cover the 2 km because the time runs out, but there
are just as many which are in the section when the time window starts). So the total
distance is the flow times the size of the area: T D = qWX . This can be simply rewritten
to equation 1.8.

    A similar relation is constructed for the density, considering again the rectangular
area of 1 hour times 2 kilometres. Starting with a density of 10 veh/km, there are 20
vehicles in the area, which we all follow for one hour. The total time spent, is hence
10*2*1, or T T = kWX . This can be rewritten to equation 1.8.

    The average speed is defined as the total distance divided by the total time, so

                                           TD                (1.9)
                                      u=

                                           TT

    The average travel time over a distance l can be found as the average of the time a
vehicle travels over a distance l . In an equation, we find:

                               t t =    l     =l      1      (1.10)

                                        v             v

In this equation, t t indicates the travel time and the pointy brackets indicate the mean.

This can be measured for all vehicles passing a road stretch, for instance at a local de-

tector. Note that the mean travel time is not equal to the distance divided by the mean

speed:

                               t t = l     1  =l      1      (1.11)

                                           v          v 
8                                                                                                 1. VARIABLES

1 Area in space and time
                           300
                                                               trajectory

           250         Boundary

                       Considered trajectory

Space (m)  200

           150

           100

           50

           0
            0 20 40 60 80 100 120

                                    Time (s)

Figure 1.4: Vehicle trajectories and the selection of an area in space and time

In fact, it can be proven that in case speeds of vehicles are not the same, the average
travel time is underestimated if the mean speed is used.

                                                                           t t = l  1  l  1       (1.12)

                                                                                    v     v 

The harmonically averaged speed (i.e., 1 divided by the average of 1 divided by the speed)

does provide a good basis for the travel time estimation. In an equation, we best first

define the pace, pi :                                                             1
                                                                           pi = vi
                                                                                                  (1.13)

The harmonically averaged speed now is

                                                                                       1      1
                       v harmonically = p = 1                                                     (1.14)

                                                                                              vi

The same quantity is required to find the space mean speed. Section 3.4 shows the dif-
ference qualitatively. In short, differences can be several tens of percents.

1.3. STATIONARITY AND HOMOGENEITY

Traffic characteristics can vary over time and/or over space. There are dedicated names
for traffic if the state does not change.

    Traffic is called stationary if the traffic flow does not change over time (but it can
change over space). An example can be for instance two different road sections with
different characteristics. An example is given in figure 1.5a, where there first is a low
speed, then the speed of the vehicles is high.

    Traffic is called homogeneous if the traffic flow does not change over space (but it
can change over time). An example is given in figure 1.5b, where at time 60 the speed de-
creases at the whole road section. This is much less common than the stationary condi-
tions. For this type of situation to occur, the traffic regulations have to change externally.
For instance, the speed limits might change at a certain moment in time (lower speeds
at night).
1.3. STATIONARITY AND HOMOGENEITY                                                                                                                                                     9

        1 Stationary conditions

12
                                                                                                                                                              Homogeneous conditions
                                                                                                                            1500

11

                                                                                                                1000
Space (km)
10
                                                                                                                 Space (m)
                                                                500
9
                                                                             Vehicle
     Vehicle                                                                 Change in traffic conditions
                                                                   0
8    Change in traffic conditions
                                          1 0 20 40 60 80 100 120 Time (s)
0.5  0.6                   0.7  0.8  0.9
                           Time (h)                (b) Homogeneous conditions

(a) Stationary conditions

SELECTED PROBLEMS

For this chapter, consider problems: 5, 6, 162, 172, 173, 174, 175, 196, 217, 232, A.10.3,
A.11.3
     2

CUMULATIVE CURVES

After this chapter, the student is able to:

      Construct (slanted/oblique) cumulative curves in practice or from theoretical prob-
        lem

      Interpret these and calculate: delays, travel times, density, flow

    This chapter discusses cumulative curves, also known as cumulative flow curves. The
chapter first defines the cumulative curves (section 2.1), then it is shown how traffic char-
acteristics can be derived from these (section 2.2). Section 2.4 shows the application of
slanted cumulative curves.

2.1. DEFENITION

The function Nx (t ) is defined as the number of vehicles that have passed a point x at
time t and is only used for traffic into one direction. Hence, this function only increases
over time. Strictly speaking, this function is a step function increasing by one every time
a vehicle passes. However, for larger time spans and higher flow rates, the function is
often smoothed into a continuous differentiable function.

    The increase rate of this function equals the flow:

                                                      dN        (2.1)
                                                            =q

                                                       dt
Hence from the flow, we can construct the cumulative curve:

N = qdt                                                         (2.2)

This gives one degree of freedom, the initial value. This can be chosen freely, or should
be adapted to cumulative curves for other locations.

                                                          11
12                                                                                      2. CUMULATIVE CURVES

2

                      Figure 2.1: Illustration of a vertical queue

2.2. VERTICAL QUEUING MODEL

A vertical queuing model is a model which assumes an unlimited inflow and and an
outflow which is restricted to capacity. The vehicles which cannot pass the bottleneck
are stacked "vertically" and do not occupy any space. Figure 2.1 illustrates this principle.

    Let us now study the dynamics of such a queue. We discretize time in steps of dura-

tion t , referred to by index t . The demand is externally given, and indicated by D. At

time steps t we compute the flow into and out of the stack (the number of vehicles in the

stack indicated as S). In between the time steps, indicated here as t + 1/2, the number of

vehicles in the stack is updated based on the flows q. Then, the stack provides the basis

for the flows in the next time step.

    The stack starts at zero. Then, for each time step first the inflow to the stack is com-

puted.

                                                                    qin,t = D           (2.3)

and the stack is updated accordingly, going to an intermediate state at time step t+1/2.
This intermediate step is the number of vehicles in the queue if there was no outflow, so
the original queue plus the inflow:

                                                                    St+1/2 = St + qint  (2.4)

Then, the outflow out of the stack (qout) is the minimum of the number of vehicles in
this intermediate queue and the maximum outflow determined by the capacity C :

        qout = min{C t , Si +1/2}                                                       (2.5)

The stack after the time step is then computed as follows

        Si +1 = Si +1/2 - qoutt = Si + qin,i - qout,i t                                 (2.6)

    Let us consider a situation as depicted in figure 2.1, and we are interested in the de-
lays due to the bottleneck with a constant capacity of 4000 veh/h. The demand curve
is plotted in figure 2.2a. The flows are determined using the vertical queuing model.
The flows are also shown in figure 2.2a. Note that the area between the flow and de-
mand curve where the demand is higher than the flow (between approximately 90 to
160 seconds), is the same as the area between the curves where the flow is higher than
the demand (between approximately 160 and 200 seconds). The reasoning is that the
2.3. TRAVEL TIMES, DENSITIES AND DELAYS                                                                                                13

        Demand and supply                                                                               Cumulative curves

4500                                                                                            250
4000
                                      Demand

                                      Capacity

                                      Flow                                                      200

Demand (veh/h)

                                                                                             N
3500

                                 2 150

3000

                                                                                                100

2500                                                                                                              x1

                                                                                                50                x2

2000                                                                                                              Vehicles in section

                                                                                                                  travel time

1500    100            200       300        400                                                 0    0  50 100 150 200 250 300 350
     0
                       Time (s)
                                                                                                        Time (s)

(a) Demand and supply                            (b) Cumulative curves

Figure 2.2: Demand and cumulative curves

area represents a number of vehicles (a flow times a time). From 90 to 160 seconds the
demand is higher than the flow, i.e., the inflow is higher than the outflow. The area rep-
resents the number of vehicles that cannot pass the bottleneck, and hence the number
of queued vehicles. From 160 seconds, the outflow of the queue is larger than the inflow.
That area represents the number of vehicles that has left the queue, and cannot be larger
than the number of vehicles queued. Moreover, the flow remains at capacity until the
stack is empty, so both areas must be equal.

2.3. TRAVEL TIMES, DENSITIES AND DELAYS

This section explains how travel times and delays. Delay can be computed using cumu-
lative curves. Note that this methodology does not take spillback effects into account. If
one requires this to be accounted for, please refer to shockwave theory (chapter 4).

2.3.1. CONSTRUCTION OF CUMULATIVE CURVES

The cumulative curves for the above situation is shown in figure 2.2b. The curves show
the flows as determined by the vertical queuing model. For the inflow we hence use
equation 2.3 and for the outflow we use 2.5; for both, the cumulative curves are con-
structed using equation 2.2.

2.3.2. TRAVEL TIMES, NUMBER OF VEHICLES IN THE SECTION

A black line is drawn at t = 140s in figure 2.2b. The figure shows by intersection of this
line with the graphs how many vehicles have passed the upstream point x1 and how
many vehicles have passed the downstream point x2. Consequently, it can be deter-
mined how many vehicles are in the section between x1 and x2. This number can also
be found in the graph, by taking the difference between the inflow and the outflow at
that moment. This is indicated in the graph by the bold vertical black line.

    Similarly, we can take a horizontal line; consider for instance the line at N = 150. The
intersection with the inflow line shows when the 150th vehicle enters the section, and
the intersection with the outflow line shows when this vehicle leaves the section. So, the
14                                           2. CUMULATIVE CURVES

                 horizontal distance between the two lines is the travel time of the 150th vehicle. At times
                 where the demand is lower than the capacity, the vehicles have a free flow travel time. So
                 without congestion, the outflow curve is the inflow curve which is translated to the right
                 by the free flow travel time.

2 The vertical distance is the number of vehicles in the section (N ) at a moment t . In a time period d t this adds N d t to the total travel time (each vehicle contributes d t ). To

                 get the total travel time, we integrate over all infinitesimal intervals d t :

    t t = Nd t                               (2.7)

    The horizontal distance between the two lines is the travel time for one vehicle, and
vertically we find the number of vehicles. Adding up the travel times for all vehicles gives
the total travel time:

    t t = t ti                               (2.8)

             i

In a continuous approach, this changes into

    tt = tti di                              (2.9)

    Both calculation methods lead to the same interpretation: the total time spent can be
determined by the area between the inflow and outflow curve.

2.3.3. DELAYS

Delays for a vehicle are the extra time it needs compared to the free flow travel time;
so, to calculate delay, one subtracts the free flow travel time from the actual travel time.
To subtract the free flow travel time from the travel time, we can graphically move the
outflow curve to the left, as is shown in figure 2.3a. For illustration purposes, the figure is
zoomed at figure 2.3b. The figure shows that if the travel time equals the free flow travel
time, both curves are the same, leading to 0 delay.

    Similar to how the cumulative curves can be used to determine the travel time, the
moved cumulative curves can be used to determine the delay. The delay for an individ-
ual vehicle can be found by the horizontal distance between the two lines. The vertical
distance between the two lines can be interpreted as the number of vehicles queuing.
The total delay is the area between the two lines:

    D = t ti - t tfree flowd i               (2.10)

This is the area between the two lines. If we define Nqueue as the number of vehicles in
the queue at moment t, we can also rewrite the total delay as

    D = Nqueue(t )d t                        (2.11)
2.4. SLANTED CUMULATIVE CURVES                                                                                               15

                  Moved cumulative curves                                                   Moved slanted cumulative curves
200                                                                            -30

                                                                            -32
150

                                                                               -34                                                   2

N
                                                                            N
100

                                                                               -36

      50                                                                       -38

       0 80 100 120 140 160                       x1                           -40 80  100 120 140 160                x1
                                 Time (s)         x2                                                 Time (s)         x2

(a) Moved cumulative curves                180 200                                                             180 200

                                                      (b) Slanted cumulative curves

Figure 2.3: Determining the delay and the flows from cumulative curves

2.4. SLANTED CUMULATIVE CURVES

Slanted cumulative curves or oblique cumulative curves is a very powerful yet simple

tool to analyse traffic streams. These are cumulative curves which are off set by a con-

stant flow:

             N~ = q - q0d t - q0d t = qd t - q0d t                                                                           (2.12)

This means that differences with the freely chosen reference flow q0 are amplified: in
fact, only the difference with the reference flow are counted. The best choice for the
reference flow q0 is a capacity flow.

    Figure 2.3b shows the slanted cumulative curves for the same situation as in figure
2.3a. The figure is off set by q0 = 4000 veh/h. Because the demand is initially lower than
the capacity, N~ reaches a negative value. From the moment outflow equals capacity, the
slanted cumulative outflow curve is constant. Since the demand is higher than the ca-
pacity, this increases. At the moment both curves intersect again, the queue is dissolved.

    The vertical distance between the two lines still shows the length of the queue, Nqueue.
That means that equation 2.10 still can be applied in the same way for the slanted cu-
mulative curves, and the delay is the area between the two lines.

    Slanted cumulative curves are also particularly useful to determine capacity, and to
study changes of capacity, for instance the capacity drop (see section 6.2). In that case,
for one detector the slanted cumulative curves are drawn. By a change of the slope of
the line a change of capacity is detected. In appendix C a Matlab code is provided by
which cumulative curves can be made, and which includes the computation of several
key performance indices.

2.5. PRACTICAL LIMITATIONS

Cumulative curves are very useful for models where the blocking of traffic does not play
a role. For calculating the delay in practise, the method is not very suitable due to fail-
ing detectors. Any error in the detection (a missed or double counted observation), will
change one of the curves and will offset the cumulative flow, and this is never corrected;
   16                                                                         2. CUMULATIVE CURVES

                     6000                     Demand
                     5000
                                                                    Demand
                                                                    Capacity

       Flow (veh/h)  4000

2                    3000

                     2000

                     1000

                                    0  0  50  100         150  200  250

                                              Time (min)

   Figure 2.4: Demand and capacity

   this is called cumulative drift. Recently, an algorithm has been proposed to check the off-
   sets by cross checking the cumulative curves with observed travel times (Van Lint et al.,
   2014). This is work under development. Moreover, some types of detectors will system-
   atically miscount vehicles, which makes the above-mentioned error larger.

       Apart from their use in models, slanted cumulative curves are very powerful to show
   changes in capacity in practise.

   2.6. EXAMPLE APPLICATION                               for t < 1h          (2.13)
                                                          for 1h < t < 1.5h
   Consider a road with a demand of:                      for t > 1.5h
                                               
                                               3600v/h

                                       qin = 5000v/h
                                                 2000v/h

   The capacity of the road is 4000 veh/h. A graph of the demand and capacity is shown in
   figure 2.4.

       1. Construct the (translated=moved) cumulative curves

       2. Calculate the first vehicle which encounters delay (N)

       3. Calculate the time at which the delay is largest

       4. Calculate the maximum number of vehicles in the queue

       5. Calculate the vehicle number (N) with the largest delay

       6. Calculate the delay this vehicle encounters (in h, or mins)

       7. Calculate the time the queue is solved

       8. Calculate the last vehicle (N) which encounters delay

       9. Calculate the total delay (veh-h)
2.6. EXAMPLE APPLICATION  17

10. Calculate the average delay of the vehicles which are delayed (h)

  This can be answered by the following:

 1. For the cumulative curves, an inflow and an outflow curve needs to be constructed;

   both increase. For the inflow curve, the slope is equal to the demand. For the out- flow curve, the slope is restricted to the capacity. During the first hour, the demand 2

     is lower than the capacity, hence the outflow is equal to the demand. From t=1h,
     the inflow exceeds the capacity and the outflow will be equal to the demand. The
     cumulative curve hence increases with a slope equal to the capacity. As long as
     there remains a queue, i.e. the cumulative inflow is higher than the outflow, the
     outflow remains at capacity. The outflow remains hence increasing with a slope
     equal to the capacity until it intersects with the cumulative inflow. Then, the out-
     flow follows the inflow: see figure 2.5a and for a more detailed figure 2.5b.

 2. The first vehicle which encounters delay (N) Delays as soon as q>C: so after 1h at
     3600 v/h = 3600 vehicles.

 3. The time at which the delay is largest: A queue builds up as long as q>C, so up to
     1.5 h. At that moment, the delay is largest

 4. The maximum number of vehicles in the queue: 0.5 h after the start of the queue,
     0.5*5000=2500 veh entered the queue, and 0.5*4000=2000 left: so 500 vehicles are
     in the queue at t=0.5h

 5. The vehicle number (N) with the largest delay: N(1.5h)=3600+0.5*5000 = 6100

 6. The delay this vehicle encounters (in h, or mins): It is the 2500th vehicle after t=1h.
     The delay is the horizontal delay between the entry and exit curve. It takes at ca-
     pacity 2500/4000 = 37.5 mins to serve 2500 vehicles. It entered 0.5 hours = 30 mins
     after t=1, so the delay is 7.5 mins

 7. The time the queue is solved: This is the time point that the inflow and outflow
     curves intersect again. 500 vehicles is the maximum queue length, and it reduces
     with 4000-2000=2000veh/h. So 500/2000=15 minutes after the time that q<C the
     queue is solved, i.e. 1:45h after the start.

 8. The last vehicle (N) which encounters delay This is the vehicle number at the mo-
     ment the inflow and outflow curves meet again. 15 minutes after the vehicle num-
     ber with the largest delay: 6100+0.25*2000 = 6600 veh

 9. The total delay. This is the area of the triangle between inflow and outflow curve.
     This area is computed by 0.5 * height * base = 0.5 * 500 * (30+15)/60 = 187,5 veh-h.
     Note that here we use a generalised equation for the area of a triangle. Indeed, we
     transform the triangle to a triangle with a base that has the same width, and the
     hight which is the same for all times (i.e., we skew it). The hight of this triangle is
     500 vehicles (the largest distance between the lines) and the width is 45 minutes.

10. The average delay of the vehicles which are delayed (h) 187,5 veh-h/ (6600-3600)
     veh = 0,0625 h = 3,75 min
18                                                                                                                               2. CUMULATIVE CURVES

10000                      Cumulative curves                                                                                     Cumulative curves
                 Nin
                 Nout                                                                                       6500  Nin

 8000                                                                                                             Nout

                                                                                                            6000

Cumulative flow2 6000                                                                                       5500
                                                                                           Cumulative flow  5000

    4000                                                                                                    4500

    2000                                                                                                    4000

    0     0            50  100  150           200  250                                                      3500             70  80          90     100
                                                                                                                         60

                           Time (min)                                                                                            Time (min)

(a) Overview of the cumulative curves                   (b) More detailed view of the cumulative curves

Figure 2.5: Cumulative curves for the example

SELECTED PROBLEMS

For this chapter, consider problems: 3, 4, 68, 69, 70, 71, 100, 142, 143, 144, A.7.2, 205, 205,
234, 235, 260, A.11.2
        3

RELATIONSHIPS OF TRAFFIC

                             VARIABLES

After this chapter, the student is able to:

      Comment on the restrictions of the fundamental diagram

      Translate the fundamental diagram in three planes

      Interpret the shape of the fundamental diagram in terms of driving behavior

    Chapter 1 defined the variables and their definition. This chapter will discuss the
relationship between these variables. First of all the mathematically required relation-
ships are shown (section 3.1), then typical properties of traffic in equilibrium are dis-
cussed (section 3.2). Section 3.3 discusses these relationships in the light of drivers, and
expands this to non-equilibrium conditions. Finally, section 3.4 gives attention to the
moving observer.

3.1. FUNDAMENTAL RELATIONSHIP

In microscopic view, it is obvious that the headway (h), the spacing (s) and the speed
(v) are related. The headway times the speed will give the distance covered in this time,
which is the spacing. It thus suffices to know two of the three basic variables to calculate
the third one.

s = hv                         (3.1)

Since headways and spacings have macroscopic counterparts, there is a macroscopic
equivalent for this relationship. After reordering, equation 3.1 reads

11                             (3.2)
  =v

hs

19
20                                                             3. RELATIONSHIPS OF TRAFFIC VARIABLES

Table 3.1: The basic traffic variables and their relationship

                                   Microscopic Macroscopic

                                             s                 k=  1

                                                                   s
                                                                   1
                                             h                 q=
                                                                   h
                                                                   1
                                             v                 u=
                                                                   v 

3 s = hv q = ku

The macroscopic equivalent of this relationship is the average of this equation. Remem-

bering  that  q  =   1  and  k  =  s1 ,  we  get:
                    h

                                                   q = ku              (3.3)

This equation shows that the flow q is proportional with both the speed u and the den-
sity k. Intuitively, this makes sense because when the whole traffic stream moves twice
as fast if the flow doubles. Similarly, if - at original speed - the density doubles, the flow
doubles as well.

    Table 3.1 summarizes the variables and their relationships.

3.2. FUNDAMENTAL DIAGRAM

If two of the three macroscopic traffic flow variables are known, the third one can be
calculated. This section will show that there is another relationship. In fact, there is an
equilibrium relationship between the speed and the density. First, a qualitative under-
standing will be given, after that the effect will be shown for various couples of variables.
Also, different shapes of the supposed relationship will be shown (section 3.2.5).

3.2.1. QUALITATIVE UNDERSTANDING OF THE SHAPE

Let us, for the sake of argument, consider the relationship between density and flow. And
let us furthermore start considering the most extreme cases. First, the case that there is
no vehicle on the road. Since the density is 0, the flow is 0, according to equation 3.3. In
the other extreme case the density on the road is very high, and the speed is 0. Using
again equation 3.3 we find also for this case a flow of 0. In between, there are traffic
states for which the traffic flow is larger than zero. Assuming a continuous relationship
between the speed and the density (which is not necessarily true, as will be discussed
section 6.2) there will be a curve relating the two points at flow 0. This is indicated in
figure 3.1c.

    This relationship is being observed in traffic. However, it is important to note that
this is not a causal relationship. One might argue that due to the low speed, drivers will
drive closer together. Alternatively, one might argue that due to the close spacing, drivers
need to slow down.
3.2. FUNDAMENTAL DIAGRAM                                                                                                           21

                                                                            Flow (veh/h)  qmax: 1 veh/1.5 sec

                                                                                          dq/dk=vfree=80 km/h       kmax: 8 m/veh

                                                                                          Density (veh/km)

     (a) One extreme: an empty road      (b) One extreme: a jammed road     (c) Basic shape of the fundamental di-
                                                                            agram

Figure 3.1: The extreme situations and an idea for the fundamental diagram

                                                                          3

3.2.2. TRAFFIC STATE

We can define a traffic state by its density, flow and speed. Using equation 3.3, we only
need to specify two of the variables. Furthermore, using the fundamental diagram, one
can be sufficient. It is required that the specified variable then has a unique relationship
to the others. For instance, judged by figure 3.1c, specifying the density will lead to a
unique flow, and a unique speed (using equation 3.3, and thus a unique traffic state).
However, specifying the flow (at any value between 0 and the capacity) will lead to two
possible densities, two possible speeds, and hence two possible traffic states.

    The speed of the traffic can be derived using the equation 3.3:

                                                             q                                                               (3.4)
                                                        u=

                                                             k

For a traffic state in the flow density plane, we can draw a line from the traffic state to the
origin. The slope of this line is q/k. So the speed of the traffic can be found by the slope
of a line connecting the origin to the traffic state in the flow density plane. The free flow
speed can be found by the slope of the fundamental diagram at k=0, i.e. the derivative
of the fundamental diagram in the origin.

3.2.3. IMPORTANT POINTS

The most important aspect of the fundamental diagram for practitioners is the capacity.

This is the maximum flow which can be maintained for a while at a road. The same

word is also used for the traffic state at which maximum flow is obtained. This point

is found at the top of the fundamental diagram. Since we know that the flow can be

determined from the headway, we can estimate a value for the capacity if we consider the

minimum headway. For drivers on a motorway, the minimum headway is approximately

1.5  to  2  seconds,  so  we    find  a  typical  capacity  value    of  1  to   1        vehicles             per  second.  If    we
                                                                         2      1.5
                                                                                                                    3600
convert     this  to  vehicles  per   hour,  we   find  (there  are  3600   seconds       in  an    hour)             2   =  1800

to  3600  =  2400  vehicles     per  hour.
     1.5

     The density for this point is called the critical density, and the related speed the crit-

ical speed. The capacity is found when the average headway is shortest, which is when a

large part of the vehicles is in car-following mode. This happens at speeds of typically 80

km/h; this then is the critical speed. From the capacity and the critical speed, the critical

density can be calculated using equation 3.3. This varies from typically 20 veh/km/lane

to 28 veh/km/lane.

     For densities lower than the critical density, traffic is in an uncongested state; for
22                                                         3. RELATIONSHIPS OF TRAFFIC VARIABLES

higher densities, traffic is in a congested state. In the uncongested part, the traffic flow

increases with an increase of density. In the congested branch, the traffic flow decreases

with an increase of density. The part of the fundamental diagram of uncongested traffic

states is called the uncongested branch of the diagram. Similarly, the congested branch

gives the points for which the traffic state is congested.

    The free flow speed is the speed of the vehicles at zero density. At the other end, we

find the density at which the vehicles come to a complete stop, which is called the jam

density. For the jam density, we can also make an estimation based on the length of the

3 long, and they keep some distance even at standstill (2-3 meters), which means the jam vehicles and the distance they keep at standstill. A vehicle is approximately 5 meters

density  is   1   to   1    veh/m,  or  1000 5+3 =125veh/km  to  5+2 1000 =142  veh/km.
             5+3      5+2

3.2.4. FUNDAMENTAL DIAGRAM IN DIFFERENT PLANES

So far, the fundamental diagram has only be presented in the flow density plane. How-
ever, since the fundamental equation (equation 3.3) relates the three variables to each
other, any function relating two of the three variables to each other will have the same
effect. Stated otherwise, the fundamental relationship can be presented as flow-density
relationship, but also as speed-density relationship or speed-flow relationship. Figure
3.2 shows all three representations of the fundamental diagram for a variety of functional
forms.

    In the speed-density plane, one can observe the high speeds for low densities, and
the speed gradually decreasing with increasing density. In the speed-flow diagram, one
sees two branches: the congested branch with high speeds and high flows, and also a
congested branch with a low speed and lower flows.

3.2.5. SHAPES OF THE FUNDAMENTAL DIAGRAM

There are many shapes proposed for the fundamental diagram. The data are quite scat-
tered, so different approaches have been taken: very simple functions, functions with
mathematically useful properties, or functions derived from a microscopic point of view.
Even today, new shapes are proposed. In the remainder of this section, we will show
some elementary shapes; the graphs are shown in figure 3.2.

GREENSHIELDS
Greenshields was the first to observe traffic flows and publish on this in 1934 (Green-
shields, 1934). He observed a platoon of vehicles and checked the density of the platoon
and their speed. He assumed this relationship to be linear:

                                                v = v0 -ck                                           (3.5)

Note  that   for  k  =  v0  the  speed  equals  0,  hence  the   flow  equals   zero.    Therefore,  the  the
                        c
                          v0
jam  density  equals      c   .

TRIANGULAR
The Greenshields diagram is not completely realistic since for a range of low densities,
drivers keep the same speed, possibly limited by the current speed limit. The funda-
mental diagram which is often used in academia is the triangular fundamental diagram,
3.2. FUNDAMENTAL DIAGRAM                                                                  23

reffering to the triangular shape in the flow-density plane. The equation is as follows:

                                             if k < kc                (3.6)
                           v0k               if k  kc
                      q = qc - k - kc qc

                                    kj - kc

TRUNCATED TRIANGULAR

Daganzo (1997) shows a truncated triangular fundamental diagram. That means that

the flow is constant and maximized for a certain range of densities. The equation is as       3

follows:                  

                          v0k                if k < k1
                          v0k1
                      q=                     if k1 < k < kc           (3.7)

                           k - kc
                          qc -           qc if k  kc
                                kj - kc

SMULDERS
Smulders (1989) proposed a fundamental diagram in which the speed decreases linearly
with the density for the free flow branch. In the congested branch the flow decreases
linearly with density.

DRAKE
Drake et al. (1967) proposes a continuous fundamental diagram where the speed is an
exponentially decreasing function of the density:

                                             1 k2                     (3.8)
                            v = v0 exp - 2 kc

INVERSE LAMBDA

The capacity drop (see section 6.2) is not present in the fundamental diagrams presented
above. Koshi et al. (1981) introduced an `inverse lambda'fundamental diagram. This
means the traffic has a free speed up to a capacity point. The congested branch however,
does not start at capacity but connects a bit lower at the free flow branch. It is assumed
that traffic remains in the free flow branch and after congestion has set in, will move
to the congested branch. Only after the congestion has solved, passing a density lower
than the density where the congested branch connects to the free flow branch, traffic
flows can grow again to higher values. The description is as follows:

                                    if k < kc                         (3.9)
               v0k                  if k  k1and traffic is congested
          q = v0k1 - k - k1 v0k1

                           kj - k1

    This shape of the fundamental diagram allows for two traffic states with similar den-
sities but different flows. This can yield unrealistic solutions to the kinematic wave model
(see section 4).
   24                                      3. RELATIONSHIPS OF TRAFFIC VARIABLES

   WU

   An addition to the inverse-lambda fundamental diagram is made by Wu (2002). He as-

   sumes the speed in the free flow branch to decrease with increasing density. The shape

   of the free flow branch is determined by the overtaking opportunities, which in turn de-

   pend on the number of lanes, l . The equation for the speed is

                    k l -1         k l -1
           
           
           k 1 - k1  v0 + k1 vp if v > up
       q=                                                                    (3.10)
3                   k - k1
           vp k1 -           v0k1          if k  k1and traffic is congested
                    kj - k1

   KERNER
   Kerner (2004) has proposed a different theory on traffic flow, the so-called three phase
   traffic flow theory. This will be described in more detail in section 6.4. For here, it is
   important to note that the congested branch in the three phase traffic flow theory is not
   a line, but an area.

   3.3. MICROSCOPIC BEHAVIOUR

   Section 3.2 showed the equilibrium relationships observed in traffic. This is a result of
   behavior, which can be described at the level of individual drivers as well. This section
   does so. First, the equilibrium behaviour is described in section 3.3.1. Then, section 3.3.2
   discusses hysteresis, i.e. structural off-equilibrium behaviour under certain conditions.

   3.3.1. EQUILIBRIUM BEHAVIOUR

   The fundamental diagram describes traffic in equilibrium conditions. That can happen
   if all drivers are driving in equilibrium conditions, i.e. all drivers are driving at a headway
   which matches a speed. Using the relationships in table 3.1 one can change a fundamen-
   tal diagram on an aggregated level to a fundamental diagram on an individual level. This
   way, one can relate individual headways to individual speeds.

       The fundamental diagram gives the average distance drivers keep. However, there is
   a large variation in drivers' behaviour. Some keep a larger headway, and some drivers
   keep a smaller headway for the same speed. These effects average out in a fundamental
   diagram, since the average headway for a certain speed is used. On an individual basis,
   there is a much larger spread in behaviour.

   3.3.2. HYSTERESIS

   Apart from the variation between drivers, there is also a variation within a driver for a
   distance it keeps at a certain speed (which we assume in this section as representative
   of the fundamental diagram). These can be random variations, but there are also some
   structural variations. Usually the term Hysteresis is used to indicate that the driving be-
   haviour (i.e. the distance) is different for drivers before they enter the congestion com-
   pared to after they come out of congestion. That is, the distance at the same speed is
   different in each of these conditions.

       Two phenomena might play a role here:
3.3. MICROSCOPIC BEHAVIOUR                                                                                                                                     25

          Name                       Density-flow                                    Flow-speed                                Density-speed
     Greenshields
                                    2500                                           100                                         100
       Triangular
Truncated Triangular                2000                                           80                                          80

       Smulders       Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60
          Drake
                                    1000                                           40                                          40
   Inverse lambda
            Wu                      500                                            20                                          20                                  3

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

                                    2500                                           100                                         100

                                    2000                                           80                                          80

                      Flow (veh/h)  1500                             Speed (km/h)  60                            Speed (km/h)  60

                                    1000                                           40                                          40

                                    500                                            20                                          20

                                    00    50  100               150                00   500 1000 1500 2000 2500                00   50  100               150

                                              Density (veh/km)                          Flow (veh/h)                                    Density (veh/km)

Figure 3.2: Different shapes of the fundamental diagram
26                                                                                                                               3. RELATIONSHIPS OF TRAFFIC VARIABLES

                   Perceived hyserisis due to measuring technique                                                                                                 Headway evolution
    160                                                                                                                           -6
    140                                                                                                                           -8
                                                                                                                                 -10

Space (m)120                                                                                                                     -12
                                                                                                           Distance headway (m)
    100                                                                                                                          -14

    80                                                                                                                           -16

    60                                                                                                                           -18

3 40                                             10 12 14 16 18 20 22 24 26                                                      -20
                                              8                            Time (s)                                              -22

(a) Trajectories                                                                                                                       8  10 12 14 16 18 20 22 24 26
                                                                                                                                                                    Time (s)

                                                                                     (b) Headways

Figure 3.3: Mistakes if making the headway analysis at one moment in time

    1. Delayed reaction to a change of speed

    2. Anticipation of a change in speed

Zhang (1999) provides an excellent introduction to hysteresis. The simplified reasoning
is as follows.

    Let's first discuss case 1, drivers have a delayed reaction to a change of speed. That
means that when driving at a speed, first the speed of the leader reduces, then the dis-
tance reduces. So during the deceleration process, the headway is shorter than the equi-
librium headway. When the congestion solves, first the leader will accelerate, and the
driver will react late on that. That means that the leader will shy away from the consid-
ered car, and the distance will be larger than the equilibrium distance.

    In case 2, if the driver anticipates the change in speed, the exact opposite happens.
Before the deceleration actually happens, a driver will already decrease speed (by defi-
nition in anticipation), leading to a larger headway than the equilibrium headway for a
certain speed. Under acceleration, the opposite happens, and a driver can already ac-
celerate before that would be suitable in case of equilibrium conditions. Hence, in the
acceleration phase, the driver has a shorter headway than in equilibrium conditions for
the same speed.

    In traffic, we expect drivers to have a reaction time. In fact, the reaction time can
be derived from the fundamental diagram, as section 7.1 will show later on. It will also
show that the best way to analyse car-following behaviour is not comparing the distance-
speed relationship for one pair at one moment in time, as shown in figure 3.3. It shows
that the drivers have no hysteresis - they copy the movement of the leader perfectly -
but still the gap changes with a constant speed. Instead, one should make the analysis of
car-following behavior along the axis parallel to the wave speed. Laval (2011) provides a
very good insight in the differences one can obtain using this correct technique or using
the (erroneous) comparison of instantaneous headways (as in the arrows in figure 3.3b).
3.4. MOVING OBSERVER                                      27

3.4. MOVING OBSERVER

An observer will only observe what is in the observation range. Many observations are

taken at a point in space . This point might move with time, for instance a driver might

check the number of trucks he is overtaking. In this case, the driver is moving and ob-

serving, this is called a moving observer. This section discusses the effects of the speed

of the moving observer, and also discusses the effect of observed subjects passing a sta-

tionary observer with different speeds.

Basically, the movement at speed  has no effect on density, but the relative speed

of traffic changes. Therefore, applying equation 3.3, the relative flow changes. Written        3

down explicitly, one obtains a relative flow qrel:

                      qrel = k (v - )                     (3.11)

If the observer moves with the speed of the traffic, the observed relative flow becomes

zero. In practice if not all vehicles drive at the same speed, the flow needs to be divided

into classes with the same speed and the partial flows for each of these classes should be

calculated.

                      qrel = kVehicles at speed v (v - )  (3.12)

                                 v

LOCAL MEASUREMENTS
Suppose there is a local detector located at location xdetector. Now we reconstruct which
vehicles will pass in the time of one aggregation period. For this to happen, the vehicle i
must be closer to the detector than the distance it travels in the aggregation time:

                      xdetector - xi  taggvi              (3.13)

In this formula, x is the position on the road and tagg the aggregation time. For faster
vehicles, this distance is larger. Therefore, if one takes the local (arithmetic) mean, one
overestimates the influence of the faster vehicles. If the influence of the faster vehicles on
speeds is overestimated, the average speed ut is overestimated (compared to the space-
mean speed us ).

    The discussion above might be conceived as academic. However, if we look at empir-
ical data, then the differences between the time-mean speeds and space-mean speeds
become apparent. Figure 3.4a shows an example where the time-mean speed and space-
mean speed have been computed from motorway individual vehicle data collected on
the A9 motorway near Amsterdam, The Netherlands. Figure 3.4b shows that the time
mean speed can be twice as high as the space mean speed. Also note that the space-
mean speeds are always lower than the time-mean speeds.

    In countries where inductive loops are used to monitor traffic flow operations and
arithmetic mean speeds are computed and stored, average speeds are overestimated, af-
fecting travel time estimations. Namely, to estimate the average travel time, the average
of T T = L/v is needed, in which L is the length of the road stretch and v the travel speed.
Since L is constant, the average travel time can be expressed as

                                     1                    (3.14)
                      T T  = L

                                     v
28                                                                                                                   3. RELATIONSHIPS OF TRAFFIC VARIABLES

               Time mean speed and space mean speed                                                                                       Comparison of speeds
    120                                                                                                              1.8
    100
     80                                                                                                                                                                   Agg time 10 s
Space mean speed (km/h)                                                                                                                                                   Agg time 60 s
                                                                                spacee mean speed / time mean speed                                                       Agg time 90 s
                                                                                                                     1.6

    60                                                                                                               1.4

    40

                                                                                                                     1.2

    20

30      0  20 40 60 80 100 120                                                                                       1    0       50   100                150

           Time mean speed (km/h)                                                                                                 time mean speed (km/h)

(a) The arithmetic mean and the harmonic mean of the (b) The arithmetic mean and the harmonic mean of the
speeds of the vehicles passing a cross section of a motorway speeds of the vehicles passing a cross section of a motorway

Figure 3.4: The effect of inhomogeneities in speeds: the difference in arithmetic mean and harmonic mean
speed; figures inspired by and based on the data used in Knoop et al. (2007)

                                 250                     Computed densities
                                 200
           q/<v>H (veh/km/lane)  150
                                 100
                                  50                 50  100                                                                 150  200

                                    0
                                     0

                                                     q/<v>T (veh/km/lane)

Figure 3.5: Densities computed using arithmic mean speeds or harmonic mean speeds; based on Knoop et al.
(2007).

From this, it follows that the harmonically averaged speed is required for estimating the
mean travel time.

    Furthermore, since q = ku (equation 3.3) can only be used for space-mean speeds,
we cannot determine the density k from the local speed and flow measurements, compli-
cating the use of the collected data for, e.g. traffic information and traffic management
purposes. As figure 3.4b already shows, largest relative deviation is found at the lower
speeds. In absolute terms, this is not too much, so one might argue this is not important.
However, a low speed means a high density or a large travel time. For estimating the
densities, this speed averaging has therefore a large effect, as can be seen in figure 3.5.

SELECTED PROBLEMS

For this chapter, consider problems: 1, 66, 90, A.5.3, 140, 141, 155, 156, 176, 177, 178, 188,
195, 194, 197, 215, 223, 224, 245, 255, A.10.5, 258, 285, 286, 290
          4

                  SHOCK WAVE THEORY

After this chapter, the student is able to:

      Construct the traffic dynamics in space-time for a given demand profile and one
        (or more) stationary bottleneck(s), or give properties of traffic given the traffic in
        space-time

    This chapter describes shock wave theory to capture queuing dynamics. This differs
from cumulative curves in the way that the spatial extent of the queue is considered. In
this section, fixed bottlenecks are discussed. At fixed bottleneck some lanes of a high-
way are (temporarily) blocked. Firstly the theory and derivation of equations will be
discussed (section 4.1). Thereafter, two examples are given (Section 4.2 and 4.3). Then
section 4.4 describes the stop-and-go waves in this modelling framework. This frame-
work can also be applied to moving observers, which is presented in chapter 5.

4.1. THEORY AND DERIVATION OF EQUATIONS

Let us consider a situation with two different states: state A downstream, with a matching
qA, kA and v A, and state B upstream (qB , kB and vB ). The states are plotted in the space-
time diagram 4.1. We choose the axis in such a way that the shockwave moves through
the point t=0 at x=0. We will now derive the equation to get the speed of this wave.

    In the derivation, we base the reasoning on figure 4.1. The boundary between is
called a shock wave. This wave indicates where the speed of the vehicles changes. It is
important to note that there are no vehicles captured in the wave itself: the wave itself
does not have a physical length. Thus the assumption is that vehicles change speed
instantaneously.

    Because there are no vehicles in the wave, the number of vehicles entering the wave
must be equal to the number of vehicles exiting the wave, or we can state that rate of
vehicles entering the wave must be equal to the rate of vehicles exiting the wave. This
principle, in combination with the following equation (already presented in equation

                                                          29
30                                                                            4. SHOCK WAVE THEORY

                                           Shock wave

            Space (km)        0                                   Schokgolf
                           -0.5                                   Voertuig

                             -1                                B
                           -1.5
                                        A
                             -2
                           -2.5    0.1     0.2            0.3  0.4       0.5

                             -3
                           -3.5

                             -4
                                0

                                                Tijd (u)

4 Figure 4.1: A shockwave where traffic speed changes from high to low.

                 3.3) is used to calculate the speed of the wave:

                                           q =kv                              (4.1)

The speed of the wave is indicated by w. Note that we can apply this equation to moving
frames of reference as well. In that case, the flow changes, as does the speed. The density
is invariant under a change of reference speed.

    To determine the attachment and exit rate, we will move with the speed of the wave
(in the frame of a moving observer). At the downstream end, the density is kB . The speed
in the moving frame of reference is vB -w. The exit rate in the moving frame of reference
is calculated using equation 4.1.

                                   qexit = kB (vB - w )                       (4.2)

    In the same way, the attachment rate can be determined. The upstream density is

kA. The speed of the vehicles in the frame of reference moving with the wave speed w

is v A + w. Using equation 4.1 again, we find the attachment rate in this moving frame of

reference:

                                   qattachment = k A (v A - w )               (4.3)

Since these rates have to be equal, we find:

                                            qexit = qattachment               (4.4)
                                   kA (vA - w) = kB (vB - w)                  (4.5)

This can be rewritten as:

                                   kAvA - kAw = kB vB - kB w                  (4.6)
                                      qA - kAw = qB - kB w                    (4.7)

In the last step, the speeds have been substituted using equation 4.1. We can solve this
equation for the shock wave speed w. We find

                                   qA - qB = (-kB + kA) w                     (4.8)
4.2. EXAMPLE: TEMPORAL INCREASE IN DEMAND AT A ROAD WITH A LANE DROP                         31

                                                                        Demand

                                       7000

                                       6000

                                       5000

                       Demand (veh/h)  4000

                                       3000

(a) The road                           2000
Figure 4.2: Situation
                                       1000

                                       00                       0.5  1  1.5       2  2.5  3

                                                                        Time (h)

                       (b) Demand pattern

                                                                4

And isolating w gives the wave speed equation:                                               (4.9)
                                               w = qA - qB = q
                                                     kA - kB k

    Note that in a space-time plot, the speed w is the slope of the shock wave between A
and B. The right hand side is the ratio between the difference in flow and the difference
in density of states A and B. This is also the slope of a line segment between A and B in
the flow-density plot. This becomes very useful when constructing the traffic states.

    The above reasoning holds for the speed of any shock wave, moving backward or
forward. The following section shows an example for both.

4.2. EXAMPLE: TEMPORAL INCREASE IN DEMAND AT A ROAD

        WITH A LANE DROP

Let's consider a 3 lane road with a reduction to 2 lanes over a 1 km section between x=10
and x=12.5 (see figure 4.2b). For the road, we assume lanes with equal characteristics,
described by a triangular fundamental diagram with a free speed of 80 km/h, a capacity
of 2000 veh/h/lane and a jam density of 150 veh/km/lane. At the start of the road, there
is a demand of 2500 veh/h which temporarily increases to 5000 veh/h between t=1h and
t=2h (see the demand profile in figure 4.2b). The question we will answer in this example
is: What are the resulting traffic conditions?

    The final answer to the question are the traffic states which are shown in table 4.1,
and shown on the fundamental diagram in figure 4.3a. The speed of the shock waves is
given in table 4.2, and the resulting traffic situation is shown in figure 4.3b. We will now
explain how this solution can be found.

    The inflow to the system is given, being 2500 veh/h (state A) and 5000 veh/h (state
B) on a three lane road. The matching densities can be computed from the fundamental
diagram for a three lane road. This gives densities of (equation 4.1) kA = uqAA = 258000 =
31.25veh/km and kB = uqBB = 508000 = 62.5veh/km. The separation with the empty road
32                                                                                                                               4. SHOCK WAVE THEORY

    8000            Fundamental diagram                                                                                                           Space-time diagram
    7000                                                                                                             15
    6000                              Fundamental diagram 3 lanes
    5000 B                            Fundamentel diagram 2 lanes                                                        A                                            D
                                      Shock waves

                                                                                                                         A                                            D

                                                                                                                     10

Flow (veh/h)
                                                                                                         Space (km)
    4000 D          C                                                                                                                                                 C

    3000                                                                                                             5   A       B                                            A
            A

    2000

    1000

40  0          100  200    300        400      500                                                                   00  0.5  1  1.5       2                             2.5     3

                    Density (veh/km)                                                                                             Time (h)

(a) Position of traffic states at the fundamental diagram          (b) Shock waves in space-time

Figure 4.3: The situation

Table 4.1: The states on the road

                    State  Flow (ven/h)         Density (veh/km)                                                              Speed (km/h)
                    A      2500                 31.25                                                                         80
                    B      5000                 62.5                                                                          80
                    C      4000                 200                                                                           20
                    D      4000                 50                                                                            80

Table 4.2: The shock waves present on the road

                           State 1    State 2                      shock wave speed w (km/h)
                           A          B                            80
                           B          C                            -7.3
                           A          C                            8.9
4.2. EXAMPLE: TEMPORAL INCREASE IN DEMAND AT A ROAD WITH A LANE DROP  33

moves forward with a speed of 80 km/h, i.e. the speed of the vehicles. This can also be
found by the shock wave equation, equation 4.9. The difference in flow is 2500 veh/h
and the difference in density is 31.25 veh/km. The shock wave then moves with:

               w0A = q0 - qA = -2500 = 80km/h                         (4.10)
                        k0 - kA -31.25

Note that it does not matter whether the speed of shock wave w0A or shock wave w A0 is

calculated. This remark holds for every combination of states.

     Also the wave between state A and B moves forward with 80 km/h, calculated by

equation 4.9:

               w AB = qA - qB = 2500 - 5000 = 80km/h                  (4.11)
                        kA - kB 31.25 - 62.5

Note that this equals the free flow speed. This is because we use a triangular fundamental  4

diagram. The speed wab is the direction of the line segment AB in figure 4.3a. This has

the same slope as the slope of the free flow speed (i.e. the slope of the fundamental

diagram at the origin) because its shape is triangular.

     Now this wave hits the two lane section. The flow is higher then the capacity of the

two lane section. That means that downstream, the road will operate at capacity, and

upstream a queue will form (i.e. we have a congested state). The capacity of the down-

stream part is, according to the fundamental diagram, 4000 veh/h (state D). The speed

follows from the (triangular) fundamental diagram, and is 80 km/h. The density hence

is:            kD = qD = 4000 = 50veh/km

               uD 80                                                  (4.12)

If 4000 veh/h drive onto the two lane segment, 4000 veh/h have to drive off the three lane
segment (no vehicles can be lost or created at the transition from three to two lanes).
That means that upstream of the transition, we have a congested state with a flow of
4000 veh/h. The density is derived from the fundamental diagram:

               qcong = qcapacity - qcapacity k - kc = 4000            (4.13)
                                                  kj - kc

Substituting the parameters for the fundamental diagram, and realising that the capacity
is found by qcapacity = l ucapacitykc (l is the number of lanes) we calculate the density
at point C, 200 veh/km. Graphically, we can find point C on the fundamental diagram
by the intersection of the congested branch and a line at a constant flow value of 4000
veh/h.

    The speed at which the tail of the queue moves backwards, i.e., the speed of the
boundary between B and C, is calculated by the shock wave equation (equation 4.9)

               wBC = qB - qC = 5000 - 4000 = -7.3km/h                 (4.14)
                        kB - kC 62.5 - 200

Note that this speed can also be derived graphically from the fundamental diagram, i.e.
the slope of the line segment BC. That the slope in figure 4.3a and figure 4.3b is graphi-
cally not the same, which is a consequence of different axis scales in the figures.
34                                                                    4. SHOCK WAVE THEORY

Table 4.3: The states on the road with a temporal bottleneck

                             Number          Flow     Density  Speed
                             A               2500     31.25    80
                             B               1000     387.5
                             C               1000     12.5     12.5
                             D               6000     75       75

      Then the demand reduces again and the inflow state returns to A. When lower de-

mand hits the tail of the jam, the queue can solve from the tail. At the head of the queue,

this change has no influence yet, since drivers are still waiting to get out onto the smaller

roadway segment. The boundary between C and A moves with a speed of

4 qC - qA 4000 - 2500
                             wC A = kC - kA = 200 - 31.25 = 8.9km/h   (4.15)

Here again, the speed could also be derived graphically, by the slope of the line segment
AC.

    Then, this wave arrives at the transition of the two lane road to a three lane road,
and the congestion state C is dissolved. In the two lane part, the flow is now the same
as the demand (the state in A, 2500 veh/h). The boundary between state D and A moves
forward with a speed of

                             wD A = qD - qA = 4000 - 2500 = 80km/h    (4.16)
                                       kD - kA 50 - 31.25

4.3. EXAMPLE: TEMPORAL CAPACITY REDUCTION

Another typical situation is a road with a temporal local reduction of capacity, for in-

stance due to an accident. This section explains which traffic situation will result from

that.

      The case is as follows. Consider a three-lane freeway, with a triangular fundamental

diagram. The free flow speed is 80 km/h, the capacity is 2000 veh/h/lane and the jam

density is 150 veh/km/lane. The demand is constant at 2500 veh/h. From t=0.5h to

t=1.5h, an incident occurs at x=10, limiting the capacity to 1000 veh/h. Calculate the

traffic states and the shock waves, and draw them in the space-time diagram. Also draw

several vehicle trajectories.

      For referring to certain states, we will first show the resulting states, and then explain

how these states are constructed. Figure 4.4a shows the fundamental diagram and the

occurring states, 4.4b shows how the states move in space and time. The details of the

states can be found in table 4.3, and the details of the shock waves can be found in table

4.4.

      At the start, there are free flow conditions (state A) at an inflow of 2500 veh/h. For

the assumed triangular fundamental diagram, the speed for uncongested conditions is

equal to the free flow speed, so 80 km/h. The matching density can be found by applying

equation  4.1:  kA  =  q  =  2500  =  31.25  veh/km.
                       u      80
4.3. EXAMPLE: TEMPORAL CAPACITY REDUCTION                                                                                                                                                                      35

    6000          D        Fundamental diagram                                                                                                               Time space temporal bottleneck
                                                                                                                                  15
                                                        Fundamental diagram
                                                        Schokgolven

    5000                                                                                                                              A                       C                                   D

    4000                                                                                                                          10

Flow (veh/h)                                                                                                                                                                              B
                                                                                                                      Space (km)  5
    3000
            A

    2000

    1000C                                 B                                                                                           A                       A

                                                                                                                                      Vehicle

                                                                                                                                      Shock wave

       0                                                                                                                          00           0.5  1                                        1.5          2
        0 50 100 150 200 250 300 350 400 450
                                                                                                                                                    Time (h)
                                          Density (veh/km)

(a) Position of traffic states at the fundamental diagram                        (b) Shock waves in space-time

Figure 4.4: The situation                                                                                                                                                                                          4

Table 4.4: The shock waves present on the road with a temporal bottleneck

                                 State 1  State 2                            shock wave speed w (km/h)
                                 A        C                                  80
                                 B        C                                  0
                                 A        B                                  -4.2
                                 B        D                                  -16

    From t=0.5h to t=1.5h, a flow limiting condition is introduced. We draw this in the

space time diagram. The flow is too high to pass the bottleneck, so the moment the

bottleneck occurs, a congested state (B) will form upstream. Downstream of the bot-

tleneck we find uncongested conditions (once the vehicles have passed the bottleneck,

there is no further restriction in their progress): state C. For state C, the flow equals the

flow that can pass the bottleneck, which is given at 1000 veh/h. The speed is the free

flow speed of 80 km/h, so the matching density can be found by applying equation 4.1:

kC  =     q    =  1000  =  12.5  veh/km.  The  speed                         of  the  shock                                           wave          between  state                           A    and  C  can  be
          u        80

calculated using the shock wave equation, 4.9:

                                 w AC = qA - qB = 2500 - 1000 = 80km/h                                                                                                                                    (4.17)
                                          kA - kB 31.25 - 12.5

This equals the free flow speed. Graphically, we understand this because both states
can be found at the free flow branch of the fundamental diagram (figure 4.4a) and the
shock wave speed is the slope of the line segment connecting these states. Because the
fundamental diagram is triangular, this slope is equal to the slope at the origin (i.e., the
free flow speed).

    Upstream of the bottleneck a congested state forms (B). The flow in this area must be
the same as the flow which can pass the bottleneck. This is because at the bottleneck no
new vehicles can be formed. That means state B is a congested state with a flow of 1000
veh/h. From the fundamental diagram we find the matching density in the congested
branch, 387.5 veh/km. The speed at which the shock between states A and B now moves,
   36                                                          4. SHOCK WAVE THEORY

   can be calculated using equation 4.9:

       w AB = qA - qB = 2500 - 1000 = -4.2km/h                 (4.18)
                kA - kB 31.25 - 387.5

   The minus sign means that the shock wave moves in the opposite direction of the traffic,

   upstream. We could also graphically derive the speed of the shock wave by the slope of

   the line between point A and B in the fundamental diagram.

       Once the temporal bottleneck has been removed, the vehicles can drive out of the

   queue: state D. Because state C is congested, the outflow will be capacity (or the queue

   discharge rate in case there is a capacity drop). That is for this case a flow of 3x2000

   veh/h = 6000 veh/h. Realising the vehicle speed equals the free flow speed of 80 km/h,

   the density can be found using equation 4.1:

4      qD 6000

       kD = uD = 80 = 75km/h                                   (4.19)

   The shock wave between state B and D moves backward. The speed thereof can be found
   by applying equation 4.9

       wBD = qB - qD = 1000 - 6000 = -16km/h                   (4.20)
                 kB - kD 387.5 - 75

   The negative shock wave speed means the wave moves upstream. Intuitively, this is right,
   since the vehicles at the head of the queue can accelerate out of the queue, and thus the
   head moves backwards.

   4.4. STOP AND GO WAVES

   On motorways, often so called stop-and-go waves occur. These short traffic jams start
   from local instabilities, and the speed (and flow) in the stop-and-go waves is almost zero.
   For a more detailed explanation, see section 6.3. Now the speed of the boundaries of the
   traffic states are known, we can apply this to stop-and-go waves, and understand why
   this typical pattern arises (figure 4.5).

       Stop-and-go waves arise in dense traffic. The traffic demand is then mostly near ca-
   pacity, or at approximately the level of the queue discharge rate. The upstream boundary
   of such a shock moves upstream. When it is in congested conditions, both the upstream
   state (the congested condition) and the downstream state (the standing traffic) are con-
   gested, hence the upstream boundary moves backwards with a speed equal to the wave
   speed of the fundamental diagram. Once it gets out of congestion, the inflow is most
   likely approximately equal to the capacity of the road. That means that the upstream
   boundary moves with a speed which is equal to the slope of the line in the fundamental
   diagram connecting the capacity point with the point of jam density, which is the wave
   speed.

       The downstream boundary separates the jam state (standing traffic) with capacity
   (by default: vehicles are waiting to get out of the jam, hence a capacity state occurs). The
   speed between these two states is found by connecting the points in the fundamental
   diagram. The resulting speed is the wave speed of the fundamental diagram.
4.4. STOP AND GO WAVES                                                                               37

                                                               Time space stop-and-go waves
                                    16

                                    14

                                    12

                        Space (km)  10

                                    8

                                    6

                                    4

                                    2 Vehicle

                                        Shock wave

                                    00  0.5         1  1.5       2                           2.5  3

                                                       Time (h)

4 Figure 4.5: Stop and go waves in time and space

    After the first stop-and-go wave has moved upstream, the inflow in the second stop-
and-go wave equals the outflow of the first stop-and-go wave. These are the upstream
respectively the downstream state of the second wave, which thus are the same. In be-
tween, within the wave, there is another, jammed state. According to shock wave theory
the shock between state A and B (i.e., the upstream state and the state within the stop-
and-go wave) and the shock between B and A (i.e. the state within the stop-and-go wave
and the downstream state, which equals the upstream state) is the same. This speed is
approximately equal for all roads, 15-20 km/h (Schreiter et al., 2010). Hence, the length
of the stop-and-go wave remains the same.

    This way, stop-and-go waves can travel long distances upstream. Section 6.4 will
discuss the stop-and-go waves and their characteristics in more detail.

SELECTED PROBLEMS

This chapter is a part of what was previously a combination of fixed bottlenecks (this
chapter) and moving bottlenecks (now chapter 5). The following exercises mostly start
with a fixed bottleneck, but at some point include a moving bottleneck. Students are
supposed to be able to answer these questions up to the moving bottleneck. These prob-
lems are: A.1.4, A.2.6, 67, 72, A.3.4, A.4.4, 101, 102, A.5.4, A.6.3, A.7.4, A.8.3, A.8.4, A.9.3,
259, 275, 287.
          5

      SHOCKWAVE THEORY: MOVING

                                   B OT T L E N E C K S

After this chapter, the student is able to:

      Construct the traffic dynamics in space-time for a given demand profile and one
        (or more) stationary or moving bottleneck(s), or give properties of traffic given the
        traffic in space-time

    This section describes what happens if the road is blocked, either completely or not
completely, by a moving bottleneck. This can be a slow moving truck or agricultural ve-
hicle, a funeral or wedding procession. Moving bottlenecks are indeed relevant for these
practical events, but is also used in a more theoretical framework, for instance applying
variational theory for capacity estimates (Daganzo, 2005). In the current chapter, first
the theory is explained (section 5.1), and then three examples follow (section 5.2, 5.3 and
5.4).

5.1. THEORY

For the moving bottleneck, the same theory applies as for the fixed bottleneck. The
recipe is the same: check for each bottleneck weather the demand exceeds capacity. If
so, there is congestion upstream and a free flow condition (or capacity) downstream.
Once again, the shock wave equation applies (equation 4.9).

    Different compared to the regular, fixed bottlenecks, is the position of the congested
state. For fixed bottlenecks, the flow upstream of the bottleneck equals the flow down-
stream of the bottleneck. In case of moving bottlenecks this differs. Consider a bottle-
neck which moves downstream without any overtaking opportunities. The downstream
flow is zero, but vehicles can accumulate in the growing area between the considered
point and the moving bottleneck, so the upstream flow is not zero.

    In these types of calculations, the capacity of vehicles passing the moving bottleneck
is usually an input. This gives the downstream point at the fundamental diagram. To

                                                          39
   40                                                             5. SHOCKWAVE THEORY: MOVING BOTTLENECKS

                Fundamental diagram                                                                                                    Time space moving bottleneck

       6000  D                               Fundamental diagram
                                             Shock waves
                                                                                                                       16                             D
       5000                                                                                                            14              C
                                                                                                                       12 A
                                                                                                                                           B

       4000

   Flow (veh/h)                                                                                                        10
                                                                                                           Space (km)
       3000 A                                                                                                          8
                                                               B
                                                                                                                       6
       2000
                                                                                                                                                                        A
                                                                                                                       4                                                     2.5

       1000                                                                                                                A                 A

                                                                                                                       2      Vehicle

                                                                                                                              Shock wave

       0C       100 150 200 250 300 350 400 450                                                                        00     0.5         1              1.5         2
        0 50                   Density (veh/km)

                                                                                                                                             Time (h)

   (a) Position of traffic states at the fundamental diagram      (b) Shock waves in space-time

   Figure 5.1: The situation with a moving bottleneck without overtaking opportunities

   find the upstream state on the fundamental diagram, one has to realise the shock wave

5  is the moving bottleneck, so the speed of the shock wave must equal the speed of the

   moving bottleneck. By constructing a shock wave moving with the speed of the moving

   bottleneck in the fundamental diagram from the uncongested downstream point, one

   finds the congested point. This is at the intersection of the line segment starting at the

   uncongested point moving with the bottleneck speed and the congested branch of the

   fundamental diagram. The following examples clarify the procedure.

   5.2. EXAMPLE 1: MOVING TRUCK, NO OVERTAKING POSSIBILI-

           TIES

   Consider a three lane road, where at all three lanes a triangular fundamental diagram
   holds. The capacity is 2000 veh/h/lane, the free flow speed 80 km/h and the jam density
   150 veh/km. The demand is 3000 veh/h. A truck enters the road at t=0.5h and x=10 km,
   and leaves the road at t=1h and x=15 km, hence driving 10 km/h. There are no overtaking
   opportunities. What is the traffic state at the road?

       The solution of this example is given in a space-time diagram (figure 5.1b) and in the
   fundamental diagram (figure 5.1a). The characteristics of the states are given in table 5.1,
   and the characteristics of the shock waves are given in table 5.2. The explanation how
   these points are found follows below.

       At two points states can be identified at the fundamental diagram (figure 5.1a), the
   intial state A (flow of 2500 veh/h, free flow speed 80 km/h) and the state downstream of
   the moving bottleneck (given "no overtaking possibilities" hence density zero and flow
   zero). In these examples, the states are identified by only two variables from the three
   flow, density and speed, since the third one can be calculated using equation 4.1.

       The position upstream of the moving bottleneck can be determined by the intersec-
   tion of two lines:

                                                                  q1 = qC + v (k - kC )                                                                                           (5.1)
                                                                  q2 = qD + w (k - kc )                                                                                           (5.2)
5.2. EXAMPLE 1: MOVING TRUCK, NO OVERTAKING POSSIBILITIES                                                41

Table 5.1: The states on the road for a moving bottleneck without overtaking opportunities

   Name  Flow  Density  Speed
   A     3000  37.5     80
   B     2769  277      10
   C     0     0        NaN
   D     6000  75       80

Table 5.2: The shock waves present on the road for a moving bottleneck without overtaking opportunities

State 1 State 2 shock wave speed w (km/h)

A  B     -0.96

B  C     10

A  C     80

D  C     80

B  D     -16

A  D     80

                                                                                                             5

The first equation is a line in the fundamental diagram, figure 5.1a starting from point
C and moving forward with the bottleneck speed v. The second line is the congested
branch of the fundamental diagram, in which w is the slope of the congested branch.
The intersection of these lines can be found by solving the density k from the equation
q1 = q2. For this upstream density, the density of state B, we find kB = 277 veh/km.
The matching flow is found by filling this in either equation 5.1 or 5.2, resulting in qB =
2769 veh/km. The speed is determined by the ratio of flow and density: u = kqBB = 2277679 =
10km/h. Note that this is the speed of the moving bottleneck. This must be since there
are no overtaking opportunities.

    The speed of the shock wave between A and B can be calculated using the shock wave
equation 4.9 applied to state A and B:

   w AB = qA - qB = 3000 - 2769 = -0.96km/h                                                 (5.3)
            kA - kB 37.5 - 277

This means the shock wave moves upstream with a low speed. With a different speed of
the moving bottleneck or a different demand level, the shock wave might move faster
upstream (lower bottleneck speed or higher demand), or it might move downstream
(higher bottleneck speed or lower demand).

    The speed of the shock wave between state B and C can also be calculated with equa-
tion 4.9. It can be determined from reasoning instead of calculations as well: it must be
equal to the speed of the moving bottleneck, 10 km/h.

    Once the moving bottleneck has left the road, vehicles will exit the jam. This means
a boundary between the jam state, state B, at the capacity state, state D. For capacity the
flow (6000 veh/h) and speed (80 km/h) can be derived from the road characteristics. The
speed of the shock wave between state D and B can be determined by applying the shock
wave equation (4.9) on state B and D. Alternatively, from the fundamental diagram in
figure 5.1a we see that the speed of the shock wave must equal the slope of the congested
   42                                                                  5. SHOCKWAVE THEORY: MOVING BOTTLENECKS

                     Fundamental diagram                                                                                                                  Time space moving bottleneck

       6000    D                                  Fundamental diagram
                                                  Shock waves
                                                                                                                                     16                                             D
       5000                                                                                                                          14                         C

                                                                                                                                                       A                B
                                                                                                                                     12
       4000

                                                        B
       3000

               A
       2000
   Flow (veh/h)                                                                                                                      10
                                                                                                                         Space (km)
                                                                                                                                     8

                                                                                                                                     6

                                                                                                                                     4

       1000 C                                                                                                                            A                                              A
                                                                                                                                                                                                    1.5
                                                                                                                                     2 Vehicle

                                                                                                                                         Shock wave

       0                                                                                                                             00                   0.5             1
        0 50 100 150 200 250 300 350 400 450
                                                                                                                                                                Time (h)
                                          Density (veh/km)

   (a) Position of traffic states at the fundamental diagram                 (b) Shock waves in space-time

   Figure 5.2: The situation at a moving bottleneck with overtaking possibilities

   Table 5.3: The states on the road at a moving bottleneck with overtaking possibilities

5                 State Flow (veh/h) Density(veh/km) Speed (km/h)

                  A                                        2500        31.25                                                                              80

                  B                                        3307        243                                                                                13.6

                  C                                        1000        12.5                                                                               80

                  D                                        6000        75                                                                                 80

   branch of the fundamental diagram, -16 km/h. Because any shock wave between any
   congested state and capacity moves with this speed, this speed is also called the wave
   speed of the fundamental diagram.

       Speeds of shock waves between A and C, C and D, and D and A all can be calculated
   using the shock wave equation 4.9. Moreover, all these states lie on the free flow branch
   of the fundamental diagram, so the shock waves between these states move at the free
   flow speed of 80 km/h.

   5.3. EXAMPLE 2: MOVING TRUCK WITH OVERTAKING POSSIBIL-

           ITIES

   Now, let's consider a different situation, where overtaking of the moving bottleneck is
   possible. We change the conditions as follows. Consider a three lane road, where at
   all three lanes a triangular fundamental diagram holds. The capacity is 2000 veh/h/lane,
   the free flow speed 80 km/h and the jam density 150 veh/km. The demand is 2500 veh/h.
   A truck enters the road at t=0.5h and x=10 km, and leaves the road at t=1h and x=15 km,
   hence driving 10 km/h. There are overtaking opportunities, such that downstream of the
   bottleneck the flow is 1000 veh/h. What is the traffic state at the road?

       The states and fundamental diagram, as well as the resulting traffic states are show
   in figures 5.2a and 5.2b respectively. Tables 5.3 and 5.4 give the properties of the states
   and the shock waves respectively. Below, it is explained how these states and waves are
   found.
5.3. EXAMPLE 2: MOVING TRUCK WITH OVERTAKING POSSIBILITIES                                           43

Table 5.4: The shock waves present on the road at a moving bottleneck with overtaking possibilities

State 1                         State 2  shock wave speed w (km/h)
A                               B        3.8
A                               C        80
D                               C        80
B                               D        -16
A                               D        80

The demand is the same as in the previous example, so state A is the same. Down-

stream of the moving bottleneck there is a free flow traffic state (it is downstream of the

bottleneck, so it is free flow). The flow is given at 1000 veh/h, and since it is in free flow,
the speed is 80 km/h. Hence, the density is kC = uqCC = 108000 = 12.5 veh/km.

    Since the demand is higher than the capacity of the moving bottleneck, upstream of

the bottleneck, a congested state occurs. Is is separated from state C by a shock wave

which moves with the speed of the moving bottleneck (it is the moving bottleneck). This                     5

means we have to find state B in the fundamental diagram which connects to state C with

a line with a slope of 10 km/h; this line is indicated by q1 (equation 5.4) Furthermore,

state B has to lie on the congested branch of the fundamental diagram, indicated by q2

(equation 5.5). The position upstream of the moving bottleneck can be determined by

the intersection of two lines:

                                q1 = qC + v (k - kC )                                                (5.4)
                                q2 = qD + w (k - kc )                                                (5.5)

We find the density for state B by q1 = q2. This results in kB = 243 veh/km. The match-
ing flow can be found by subsituting this into equation 5.4 or equation 5.5, leading to
qB =3307 veh/h.

    The shock wave speeds between B and C, as well as the shock wave speed between A
and B can be calculated using the shock wave equation, equation 4.9:

wBC = qB - qC = 3307 - 1000 = 10 km/h                                                                (5.6)
          kB - kC 243 - 12.5                                                                         (5.7)

w AB = qA - qB = 2500 - 3307 = 3.8 km/h
         kA - kB 31.25 - 243

Note that the shock wave between B and C moves with the speed of the moving bottle-
neck.

    Once the moving bottleneck leaves the road, the method is exactly the same as in the
previous example. The queued vehicles exit state B at the road capacity, state D with a
flow 6000 veh/h and a speed of 80 km/h. The shock wave between state D and B moves
backward with a speed which can be calculated by the shock wave equation. The shock
wave speed must also be equal to the wave speed of the fundamental diagram, so using
the knowledge of the previous example, we find wBD = -16 km/h.
   44                                                                     5. SHOCKWAVE THEORY: MOVING BOTTLENECKS

       6000 D              Fundamental diagram                                                                           16              Time space moving bottleneck
                                                     Fundamental diagram
       5000                                          Shock waves                                                         14                  C
                   A                                                                                                     12 A                                 D
                                            B
       4000

       3000
   Flow (veh/h)                                                                                                          10
                                                                                                             Space (km)
                                                                                                                         8                     B

       2000                                                                                                              6

                                                                                                                         4                                                A
                                                                                                                                                                               2.5
       1000 C                                                                                                                   A              A

                                                                                                                         2      Vehicle

                                                                                                                                Shock wave

       0     0        100  200  300          400  500                                                                    0

                                                                                                                             0     0.5      1            1.5           2

                           Density (veh/km)                                                                                                    Time (h)

   (a) Position of traffic states at the fundamental diagram              (b) Shock waves in space-time

   Figure 5.3: The situation for the moving bottleneck with overtaking opportunities and a high demand.

5  5.4. EXAMPLE 3: MOVING TRUCK AND HIGH DEMAND

   Consider a three lane road, where at all three lanes a triangular fundamental diagram

   holds. The capacity is 2000 veh/h/lane, the free flow speed 80 km/h and the jam density

   150 veh/km. The demand is increased to 4500 veh/h. A truck enters the road at t=0.5h

   and x=10 km, and leaves the road at t=1h and x=15 km, hence driving 10 km/h, limiting

   the flow downstream of the moving bottleneck to 1000 veh/h. What are the conditions

   on the road?

       The states and fundamental diagram, as well as the resulting traffic states are shown

   in figures 5.3a and 5.3b respectively. Tables 5.5 and 5.6 give the properties of the states

   and the shock waves respectively. This situation is very similar to the situation described

   in example 2 (section 5.3). Below, we will comment on the similarities and differences.

       The downstream part is the same. States A and C, as well as the congested state up-

   stream of the moving bottleneck are determined by the properties of the moving bottle-

   neck, and are thus the same as in the previous example. The speed of the wave between

   state A and B differs, since state A is different. The speed can be calculated using the

   shock wave equation, equation 4.9:

                                w AB = qA - qB = 4500 - 3307 = -6.3 km/h                                                                                                            (5.8)
                                         kA - kB 56.25 - 243

   So, the methodology to compute the shock wave speed is the same. However, the phe-
   nomenon is difference: contrary to the previous example, the shock wave moves up-
   stream.

       When the moving bottleneck leaves the road, the queue discharge (capacity) state
   D is also the same as in the previous example. Since states B and D are the same, the
   shock wave speed between the two is also the same. Also the shock wave speed between
   state A and D is the same, because both points are at the free flow branch of the funda-
   mental diagram, hence the shock wave speed is the speed of the free flow branch of the
   (triangular) fundamental diagram.
5.4. EXAMPLE 3: MOVING TRUCK AND HIGH DEMAND                45

Table 5.5: The states on the road for the moving bottleneck with overtaking opportunities and a high demand.

State     Flow (veh/h)  Density(veh/km)       Speed (km/h)
A         4500          56.25                 80
B         3077          243                   13.6
C         1000          12.5                  80
D         6000          75                    80

Table 5.6: The shock waves present on the road for the moving bottleneck with overtaking opportunities and a
high demand

       State 1 State 2 shock wave speed w (km/h)

       A  B             -6.3

       A  C             80

       B  C             10

       D  C             80

       B  D             -16

       A D 80 5

SELECTED PROBLEMS

A.1.4, A.2.6, 67, 72, A.3.4, A.4.4, 101, 102, A.5.4, A.6.3, A.7.4, A.8.3, A.8.4, A.9.3, 259, 275,
287.
          6

TRAFFIC STATES AND PHENOMENA

After this chapter, the student is able to:
      Comment on different levels of stability for traffic
      Recognise traffic states from traffic measurements, and derive the causes for the
        observed traffic states
      Comment on the capacity drop, and show this in empirical data
      Comment on the three states of traffic according to Kerner's theory
    This chapter discusses some of the important phenomena in traffic.

6.1. STABILITY

In traffic, we can differentiate between three levels of stability: local, platoon, and traffic.
This is indicated in table 6.1, and shown graphically in figure 6.1.

Table 6.1: Identification scheme for different levels of stability

Name     relevant vehicles      criterion
Local    One vehicle pair       Does the follower relax into a steady state speed
                                after a speed change of the leader?
Platoon  A platoon of vehilces  Does the change of speed of a leader increase
                                over the vehicle number in the platoon?
Traffic  More than one platoon  Does the speed disturbance propagate to the
                                next platoon?

                                47
48  6. TRAFFIC STATES AND PHENOMENA

6

                      Figure 6.1: Graphical view of the three different types of stability. The graphs show the speeds as function of
                      time for different vehicles. Figure concept from Pueboobpaphan and van Arem (2010)
6.1. STABILITY  49

6.1.1. LOCAL STABILITY

For local stability, one has to consider one vehicle pair, in which the second vehicle is
following the leader. If the leader reduces speed, the follower needs to react. In case
of local stability, he does so gracefully and relaxes into a new state. Some car following
models in combination with particular parameter settings will cause the following vehi-
cle to continuously change speeds. The following vehicle then has oscillatory speed with
increasing amplitude. This is not realistic in real life traffic.

6.1.2. PLATOON STABILITY

For a platoon, it should be considered how a change of speed propagates through a pla-
toon. This is called platoon stability or string stability. Consider a small change in speed
for the platoon leader. The following vehicle needs to react (all vehicles in the platoon are
in car-following mode). Platoon stability is whether the speed disruption will grow over
the vehicle number in the platoon. In platoon stable traffic, the disruption will reduce,
in platoon unstable traffic, this disruption will grow.

    Note that platoon stability becomes only relevant to study for locally stable traffic.
For locally stable traffic, one can have platoon instability if for a single vehicle the oscil-
lations decrease over time, but they increase over the vehicle number, as shown in figure
6.1.

                                                                          6

6.1.3. TRAFFIC FLOW STABILITY

The third type of stability is traffic flow stability. This indicates whether a traffic stream is
stable. For the other types of stabilities, we have seen that stability is judged by the speed
profile of another vehicle. For traffic flow stability it matters whether a change in speed
of a vehicle will increase over a long time to any vehicle, even exceeding the platoon
boundary. Traffic which is platoon stable is always traffic stable. The other way around,
platoon unstable traffic is not always traffic unstable. It could happen that the unstable
platoons are separated by gaps which are large enough to absorb disruptions. In this
case, the traffic flow is stable, but the platoons are not. If the disruption propagates to
other platoons, the traffic flow is unstable.

6.1.4. USE OF STABILITY ANALYSIS

There are mathematical tools to check analytically how disruptions are transmitted if a
continuous car-following model is provided. For platoon stability this is not very realistic
since all drivers drive differently. Therefore an analytical descriptions should be taken
with care if used to describe traffic since one cannot assume all drivers to drive the same.
In fact, driver heterogeneity has a large impact on stability. The other way around, the
stability analysis could indicate whether a car-following model is realistic.

    From data, one knows that traffic is locally stable and mostly platoon unstable. De-
pending on the traffic flows, it can be traffic unstable or stable. For large number of
vehicles, traffic is generally stable (otherwise, there would be an accident for any speed
disruption).
50                                                                         6. TRAFFIC STATES AND PHENOMENA

V(t)-q0x(t-t0), q0 = 9,200 vph                            X1
                                                        X2

                                                                                           9,240 vph

                                                              Breakdown    X3 and X4
                                                              t = 6:23:30

                                10,480                  10,250 vph
                                vph

                                50            t = 6:13                                                       (a)

                                 0      6:10  6:15            6:20  6:25   6:30            6:35  6:40  6:45       6:50
                                  6:05                              Time (measured at X3)

Figure 6.2: Example of an analysis with slanted cumulative curves, from Cassidy and Rudjanakanoknad (2005)

6

                      Figure 6.3: Illustration of the capacity drop in the fundamental diagram using real-world data

            6.2. CAPACITY DROP

              6.2.1. PHENOMENON DESCRIPTION

                 The capacity drop is a phenomenon that the maximum flow over a bottleneck is larger
                 before congestion sets in than afterwards. That is, once the bottleneck is active, i.e. there
                 is a congested state upstream of the bottleneck and no influence from bottlenecks fur-
                 ther downstream, the traffic flow is lower. This flow is called the queue discharge rate, or
                 sometimes the outflow capacity.

                      The best way to analyse this is by slanted cumulative curves. Generally, the flow dur-
                 ing congestion would be the same. That is, the queue outflow does not depend on the
                 length of the queue. Therefore, a natural way to offset the cumulative curves is by the
                 flow observed during discharging conditions. One would observe an increasing value
                 line congestion sets in and a horizontal line during congestion. Figure 6.2 shows an ex-
                 ample with real life data (figure from Cassidy and Rudjanakanoknad (2005)).

                      In the fundamental diagram, one would then observe a congested branch which will
                 not reach the capacity point. Instead, one has a lower congested branch, for instance the
                 inverse lambda fundamental diagram. The capacity drop is the difference between the
                 free flow capacity and the queue discharge rate. This is shown in figure 6.3.
6.2. CAPACITY DROP                                                                                                       51

                    Queue discharge rate (veh/h)7500                                         Empirical data in A4
                                                7000                                         Empirical data in A12
                                                6500                                         Rainy day (8.8mm, A12)
                                                6000
                                                5500                                            Linear fitting
                                                5000
                                                4500                                Qdischarge = 29  vcongestion + 5000
                                                4000
                                                        20  40  60                  80
                                                     0  Speed in congestion (km/h)

Figure 6.4: The dependency of the queue discharge rate of the speed in the queue (from Yuan et al. (2015a)

6.2.2. EMPIRICS (FROM YUAN ET AL. (2015A))

Capacity with congestion upstream is lower than the possible maximum flow. This ca-
pacity drop phenomenon has been empirically observed for decades. Those observa-
tions point out that the range of capacity drop, difference between the bottleneck capac-
ity and the queue discharging rate, can vary in a wide range. Hall and Agyemang-Duah
(1991) report a drop of around 6% on empirical data analysis. Cassidy and Bertini (1999)
place the drop ranging from 8% to 10%. Srivastava and Geroliminis (2013) observe that

present a few empirical observations of capacity drop from 3% to 18% at three active the capacity falls by approximately 15% at an on-ramp bottleneck. Chung et al. (2007) 6

bottlenecks. Excluding the influences of light rain, they show at the same location the
capacity drop can range from 8% to 18%. Cassidy and Rudjanakanoknad (2005) observe
capacity drop ranging from 8.3% to 14.7%. Oh and Yeo (2012) collect empirical observa-
tions of capacity drop in nearly all previous research before 2008. The drop ranges from
3% up to 18%. The large drop of capacity reduces the performance of road network.

    In most of observations, capacity drop at one bottleneck only exhibits a small day to
day deviation (Cassidy and Bertini, 1999; Chung et al., 2007). However, it is possible to
observe a large difference in the capacity drop empirically at the same location. Srivas-
tava and Geroliminis (2013) observe two different capacity drop, around 15% and 8%, at
the same on-ramp bottleneck. Yuan et al. (2) observe different discharging flows at the
same freeway section with a lane-drop bottleneck upstream and estimate the outflow of
congestion in three-lane section ranging from 5400 vph to 6040 vph. All of these studies
show that the capacity drop can be controlled and some strategies have been described
to reach the goal (Carlson et al., 2010; Cassidy and Rudjanakanoknad, 2005; Chung et al.,
2007). Those control strategies strongly rely on the relation between the congestion and
the capacity drop.

    Recent research Yuan et al. (2015a) clearly shows this relationship with speed, see
figure 6.4 (figure from Yuan et al. (2015a)).

    The main cause of the capacity drop is not identified yet. Some argue it is lane chang-
ing, others argue it is the limited acceleration (not instantaneous), whereas others argue
it is the difference in acceleration (not all the same). This remains an active field of re-
search, both for causes of the capacity drop and for ways to control it.
52                                                           6. TRAFFIC STATES AND PHENOMENA

6 Figure 6.5: Space-time plot of the traffic operations of the German A5, 14 October 2001 - figure from traffic-
                      states.com

            6.3. STOP-AND-GO WAVE

              6.3.1. PHENOMENON DESCRIPTION

                 Stop-and-go waves are a specific type of traffic jams. Generally, all traffic states at the
                 congested branch are considered congested states. Sometimes traffic experiences short
                 so-called stop-and-go waves. In these short traffic jams, vehicles come to (almost) a
                 complete standstill. The duration of the queues is a few minutes. At the downstream
                 end of the jam, there is no physical bottleneck. For many drivers, it is surprising they
                 have been in the queue "for no obvious reason".

                      The outflow of these stop-and-go waves is at the point of the queue discharge rate.

                                            Stop and go wave causes regular congestion
                                                                                                                            120

    Space (km) -- driving direction ->  36                          100

                                                                                                                                             80
                                        38

                                                                                                                                             60

                                        40
                                                                                                                                             40

                                        42                          20

                                                                    0

                                            16:00  17:00     18:00

                                                   Time (h)

Figure 6.6: Example of a stop-and-go wave triggering a standing queue at the A4 motorway
6.4. KERNER'S THREE PHASE TRAFFIC FLOW THEORY  53

Since the traffic in the jam is at almost standstill, the density in the stop-and-go wave is
jam density. The speed at which the head moves, can be determined with shock wave
theory. Using the fact that the wave speed is the difference in flow divided by the dif-
ference in density, we find that the head propagates backward with the wave speed (the
slope of the congested branch of the fundamental diagram).

    These short jams usually start in congestion. Only if traffic is unstable, short distur-
bances can grow to jams. In free traffic, the spacing between platoons is usually large
enough to ensure these jams do not grow. That means that upstream of the stop-and-go
wave, traffic conditions are probably close to capacity. A similar traffic state upstream
and downstream of the stop-and-go wave means that the upstream and downstream
boundary move at the same speed. Therefore, the jam keeps its length.

    Often, these type of jams occur regularly, with intervals in the order of 10 minutes.
Then, the outflow of the first stop-and-go wave (queue discharge rate) is the inflow of
the second one. Then, the upstream and downstream boundary must move at the same
speed. Hence, the jams move parallel in a space time figure - see also figure 6.5 (figure
from traffic-states.com).

    Since traffic in the jam is (almost) at standstill, no flow is possible. That means that
the upstream boundary must continue propagating backwards through a bottleneck -
the inflow stays at the same level and the vehicles which join the queue have no choice
but join the queue keeping their desired jam spacing to their predecessor. Once the

jam passes the bottleneck, the desired outflow would be the queue discharge rate of the section where the congestion is. However, the capacity of the bottleneck might be lower. 6

    In such a case, the stop-and-go wave triggers a standing congestion, as is seen in
figure 6.6. A stop-and-go wave propagates past a botteneck near location 43km. The
outflow of the stop and go wave would be larger, but now the flow is limited. Between
the stop-and-go wave and the bottleneck, a congested state occurs, of which the flow
equals the flow through the bottleneck (a localised bottleneck, so at both sides the same
flow). This congested state is at the fundamental diagram. For most applications where
the congested branch of the fundamental diagram is considered a straight line, this con-
gested state will lie on the line connecting the queue discharge point with the jam den-
sity. The speed of the downstream boundary of the stop-and-go wave is now determined
by the slope of the line connecting the "stopped" jam state with the new congestion state.
Since these are all on the same line, the speed is the same, and the stop-and-go wave
continues propagating.

6.4. KERNER'S THREE PHASE TRAFFIC FLOW THEORY

In the first decade of this century, the number of traffic states were debated. Kerner
(2004) claimed that there would be three states (free flow, congested, and synchronised).
He claimed that all other theories, using two branches of the fundamental diagram - a
free flow branch and a congested branch - assumed two states. This led to a hefty sci-
entific debate, of which the most clear objections are presented by Treiber et al. (2000)
and Helbing et al. (1999). A main criticism of them is that the states are not clearly dis-
tinguished. Whereas most scientist now agree that three phase traffic flow theory is not
a fully correct description of traffic flow, it includes some features which are observed
in traffic. In order to discuss these features and introduce the names in that framework,
54  6. TRAFFIC STATES AND PHENOMENA

                 the theory is included in the course. This reader provides a short description for each of
                 the states: an interested reader is referred to Kerner's book for full information (Kerner,
                 2004), or the wikipedia entry on three phase traffic flow theory for more concise infor-
                 mation.

              6.4.1. STATES

                 Kerner argues there are three different states: free flow, synchronized flow and wide mov-
                 ing jams.

                 FREE FLOW
                 In free flow traffic, vehicles are not (much) influenced by each other and can move freely.
                 In multi-lane traffic, this means that vehicles can freely overtake. Note that as conse-
                 quence, the traffic in the left lane is faster than the traffic in the right lane. The descrip-
                 tion of Kerner's free flow state therefore has similarities with the description of the two-
                 pipe regime in Daganzo's theory of slugs and rabbits (see section 8.2).

                 SYNCHRONIZED FLOW
                 Synchronized flow is found in multi-lane traffic and is characterized by the fact that the
                 speeds in both lanes become equal - hence the name of the state: the speeds are "syn-
                 chronized". This could be seen similar to the one-pipe regime of Daganzo.

6 In Kerner's three phase traffic flow theory this is one of the congested states, the other

                 one being wide moving jams. The characterising difference between the two is that in
                 synchronised flow, the vehicles are moving at a (possibly high) speed, whereas in wide
                 moving jams, they are at (almost) standstill. Kerner attributes several characteristics to
                 the synchronized flow:

                     1. Speeds in all lanes are equal

                     2. Speeds can be high

                     3. The flow can be high - possibly higher than the maximum free flow speed. Note
                         that in this case, the "capacity" of the road is found in the synchronized flow.

                     4. (Important) there is an area, rather than a line, of traffic states in the fundamental
                         diagram.

                      The area indicated by an "S" in figure 6.7a is the area where traffic states with syn-
                 chronised flow can be found. Note that in the figure, the free flow branch ("F") does
                 not extend beyond the maximum flow. However, note that for a certain density, various
                 flows are possible. The explanation by Kerner is that drivers have different equilibrium
                 speeds, leading to different flows.

                 WIDE MOVING JAMS
                 A wide moving jam is most similar to what is more often called a "stop and go wave".
                 Stop-and-go relates to the movement an individual vehicle makes: it stops (briefly, in the
                 order of 1-2 minutes), and then sets off again. Kerner relates the name to the pattern (it
                 moves in the opposite direction of the traffic stream), and "wide" is related to the width
6.4. KERNER'S THREE PHASE TRAFFIC FLOW THEORY                                     55

(a) Concepts, figure from Wikipedia  (b) Observations, figure from Kerner (2004)
Figure 6.7: Synchronized flow

                                                                          6

Figure 6.8: Observations of wide moving jams propagating through synchronised flow; figure from Kerner
(2004)

(or more accurately, it would be called length: the distance from the tail to the head) of
the queue compared to the acceleration/deceleration zones surrounding the jam. The
speed in the jam is (almost) 0. In the flow-density plane, the traffic state is hence found
at flow (almost) 0 and jam density.

    By consequence hence the tail moves upstream with every vehicle attaching to the
jam. The head also moves upstream, since the vehicles drive off from the front. Hence
the pattern of the jam moves upstream. This phenomenon is purely based on the low
flow inside the jam, hence it can travel upstream for long distances (dozens of kilome-
ters). It can pass through areas of synchronised flow, and pass on and off ramps, see
figure 6.8

6.4.2. TRANSITIONS

The other aspect in which Kerner's theory deviates from the traditional view, is the tran-
sitions between the states. Kerner argues there are probabilities to go from the free flow
to the synchronized flow and from synchronized flow to wide moving jams. These prob-
abilities depend on the density, and are related to the size of a disturbance.
56  6. TRAFFIC STATES AND PHENOMENA

6

                      Figure 6.9: Transitions between the phases, figure from Kerner (2004)
6.4. KERNER'S THREE PHASE TRAFFIC FLOW THEORY  57

    Let's consider the transition from free flow to synchronized flow as an example. As
the density approaches higher densities, the pertubation which is needed to move into
another state, is reducing (since the propagation and amplification increases). One can
draw the minimum size of a disturbance which changes the traffic state as function of
the density, see figure 6.9. Besides, one also knows with which probability these distur-
bances occur. Hence, one can describe with what probability a phase transition occurs,
see figure 6.9.

SELECTED PROBLEMS

For this chapter, consider problems: A.1.2, 12-13, 25, 30, 31, A.2.2, 64, 99, 107, 108, 109
110, A.5.1, A.5.2, 153, 161, 183, 180, 191, 192, 189, 218, 243, 244, A.10.2, 278, 279

                                                                                             6
        7

    CAR-FOLLOWING

After this chapter, the student is able to:

      Predict the vehicle's trajectory given a CF model (know Newell's model by heart,
        others given in eqns)

      Interpret a model/FD at the other aggregation level (microscopic and macroscopic)

    A car following model describes the longitudinal action of the vehicle as function
of it's leader(s). That can be, it describes its position, speed or acceleration. There are
many different forms, and all have their advantages and disadvantages. They all aim
to describe driving behavior, and human behavior is inconsistent and hence difficult to
capture in models.

    This chapter does not give an overview of all models, nor a historical overview. That
is given by Brackstone and McDonald (1999). Instead, in this chapter we discuss the
simplest, Newell's, and discuss some characteristics which one might include.

7.1. NEWELL'S CAR FOLLOWING MODEL

The most easy car-following model is the model presented by Newell (2002). It prescribes
the position of the following xi+1 car as function of the position of the leader xi . The
model simply states that the position (and - by consequence - also speed, acceleration
or jerk) of the follower is a distance s j upstream of the position (or respectively speed,
acceleration or jerk) of the leader of a time  earlier

xi+1(t ) = xi (t - ) - s j  (7.1)

    This means that the follower's trajectory is a copy of the leader's trajectory, translated
over a vector {, s j } in the xt-plane (see figure 7.1). This vector has also a direction, which
can be computed by dividing its vertical component over the horizontal component.

      sj                    (7.2)
w= 

59
60                          7. CAR-FOLLOWING

    Space                x
           

                                                                        Time

Figure 7.1: Newell's car-following model is translating a leader's trajectory over a vector {, s j }
                                       Space

                                                                                                                             Time

                      Figure 7.2: The average of the car-following behavior of drivers each with different parameters of the Newell
                      model leads to a shock wave speed

7

                 This slope is the speed at which information travels backward in congested conditions,
                 and hence is the slope of the congested branch of the fundamental diagram.

                      For each driver, different values for  and s j can be found. From empirical analysis
                 (Chiabaut et al., 2010) it is shown that averaging the slopes over more than 12 drivers
                 would yield a constant shock wave speed. This is illustrated in figure 7.2. Although the
                 parameters of the car-following model are all different, the wave speed is an average
                 translation of the disturbance, indicated by the red dotted line.

            7.2. CHARACTERISTICS

              7.2.1. DEPENDENCIES

                 The car-following model describes the action of the following vehicle. That of course
                 can depend on the movement of the leading vehicle. Some elements which are often
                 included in a car-following model are:

                       Acceleration of the leader: if the leader accelerates, the follower can get closer

                       Speed: a higher speed would require a longer spacing

                       Speed difference: if a follower is approaching his predecessor at a high speed, he
                         needs to brake in time
7.2. CHARACTERISTICS  61

      Spacing: if the spacing is large, he might (i) accelerate and/or (ii) be less influenced
        by its leader

      Desired speed: (i) the faster he wants to go, the more his desire to close a gap. But
        also (ii) even if the predecessor is far away, the follower will not exceed its desired
        speed

All these elements occur in car-following models. This list combines elements used for
different type of models. For instance, some models might prescribe a distance, and
hence use speed as input, whereas others might prescribe a speed, and use distance as
input.

    Surprisingly, many of the available car-following models are "incomplete", i.e. they
lack one or more of the above elements and are therefore limited in their use. Using them
for a dedicated task is of course allowable. A user should ensure that the model is suited
for the task.

7.2.2. REACTION TIME

Human drivers have a reaction time. Mostly, the models are evaluated at time steps,
which are chosen small, often in the order of 0.1 second. A good model allows to set
the reaction time of the driver separately. Then, only information which is more than a
reaction time earlier can influence a driver's acceleration.

    Some models will use the model time step as reaction time. In that case the speed or
acceleration of the model is evaluated every time step, which then is typically 1 second.
Information of the previous time step is immediately used in the next time step, and in

flow is described in Treiber et al. (2006). Generally speaking, a large reaction time can between there are no accelerations considered. The effect of reaction time on the traffic 7

make the traffic flow unstable.

7.2.3. MULTI LEADER CAR-FOLLOWING MODELS

Human drivers can anticipate on the movement of their leader by looking ahead and
considering more leaders. This has empirically been shown by Ossen (2008). Generally,
one would adapt the car-following model allowing n times the spacing for the nth leader.
Also, one might expect that a follower acts less sensitive on inputs from leaders further
away - that might be in terms of lower acceleration (i.e., closer to zero) or later (i.e., a
higher reaction time).

    Two "mistakes" are common, leading to multi-leader car-following models which
seem to make sense, but are not realistic.

    1. In the car-following behavior, only vehicles in the same platoon should be con-
        sidered, or vehicles which might influence the following vehicle. A car-following
        model which always takes three leaders regardless of the spacings might take a
        leader which is a long distance away, which in reality will not influence the driver.

    2. If the car following model predicts the average acceleration caused by each of the
        leaders, it might be that the follower crashes into its leader. Instead, a minimum
        operator is usually more suitable.
62                  Spacing                        7. CAR-FOLLOWING

4. No notice that                       1. A follower
driver over-                            with a speed
decelerates, so                         larger than the
relative                                leader
acceleration                            approaches with
                                        a constant
                                        relative speed

                                           2. When
                                           the
                                           threshold is
                                           reached,
                                           the driver
                                           decelerates

                              v=vfollower-vleader

                             3. Deceleration
                             until v=0

                      Figure 7.3: Schematic overview of the principles by Wiedemann

7

              7.2.4. INSENSITIVITY DEPENDING ON DISTANCE

                 Most car-following models indicate drivers will adapt their speed based on the action
                 of their leaders. Wiedemann (1974) states that drivers only react if the required action
                 is above a certain threshold. Specifically, he indicates that within some bounds, drivers
                 are unable to observe speed differences. One might also argue that within some bound-
                 aries, drivers are unwilling to adapt their speeds because the adaptation is too low. These
                 bounds depend on the spacing between the leader and follower: the larger the spacing,
                 the larger the speed difference needs to be before a driver is able to observe the speed
                 difference. As an example, a 1 km/h speed difference might be unobservable (or unim-
                 portant to react upon) on a 200 meter spacing, but if the spacing is 10 meter, this is
                 observable (or important).

                      It is relevant to draw a diagram relating the relative speed to the spacing, as is done
                 in figure 7.3. The thresholds are indicated: within these bounds, the driver is insensitive
                 and is considered to keep his current speed. Outside the bounds, the driver accelerates
                 to match the traffic situation.

                      When the leader brakes, the follower closes in. That means that point is in the right
                 half (the follower has a higher speed) and the line is going down (the spacing reduces
                 because the follower is driving faster). At a certain moment, the follower comes closer to
                 his leader and starts reacting to the speed difference, i.e. he will reduce speed. He can
                 either not brake enough and have still a higher speed, or overreact. If the braking is not
7.2. CHARACTERISTICS                                                                                     63

                                                                           Wiedemann principle
                                         70

                                         60

                                         50

                      Gross spacing (m)  40

                                         30

                                         20

                                         10

                                         0
                                         -10  -8  -6  -4  -2  0                                 2  4  6

                                                  Speed leader - speed follower (m/s)

Figure 7.4: Empirical observations of leader-follower pairs in the relative speed - spacing plane

enough, the situation is the same as the starting situation, and the same situation will

occur. Therefore, we will assume for the further reasoning that the follower overreacts.

The overreaction means that the follower will have a lower speed than the leader.

That means that the speed difference will go through zero (the y-axis in the figure).

At that moment, the speeds are equal, so the spacing remains momentarily the same.

Therefore, when crossing the y-axis, the line is horizontal. After that, the leader drives at

a higher speed than the follower, and the spacing will start increasing. For low speed dif-

ferences, the speed difference is under the observation threshold and the follower does

not adapt his acceleration. Only once the next bound is reached, he will notice the leader

is shying away and start accelerating again.                                                                 7

If he will again overreact, the speed difference will become positive. Again, the speed

difference will go through zero (the y-axis) where the line has a horizontal tangent line

(a zero speed difference means that at that moment the spacing remains constant). One

can continue constructing this figure, and it shows that in this phase plane (i.e., the plane

relative speed - spacing) the leader-follower pair makes circles.

The wider the circles are, the wider the observation thresholds. The thresholds are

considered to be higher for larger spacings. Empirical studies (e.g., Hoogendoorn et al.

(2011); Knoop et al. (2009) indeed reveal these type of circles.

Caution is required in interpreting these figures. A Newell car-following model does

not implement these type of observation thresholds. However, the relative speed - spac-

ing figures will show circles due to the reaction time. Namely, once the leader brakes,

the follower will not yet, and in the relative speed-spacing plane this will be shown as a

part of a circle. A correct analysis tracks the car-following behaviour not at the same mo-

ments in time (vertical lines in the space time diagram), but at lines moving back with

the shock wave speed. When doing so for the Newell model, one would not find any

circles at all. A detailed analysis of this method is presented by Laval (2011)

Finally, some words on the principle in relation to car-following. Car-following mod-

els prescribe the position, speed or acceleration of the follower based on the position,

speed, or acceleration of their leaders. The principle laid out in this section only men-

tions when the speed is not adapted, but does not specify the acceleration outside the

thresholds. As such, it therefore cannot be considered a car-following model. Instead, it
   64                                                           7. CAR-FOLLOWING

   can be combined with another car-following model to get a complete description.

   7.3. EXAMPLES

   This section shows the some frequently used models, apart from the Newell car-following
   model described in 7.1.

   7.3.1. HELLY

   The first model we describe here is the Helly model (Helly, 1959). The Helly model pre-
   scribes a desired spacing s as function of the speed v:

                             s = s0 + T v                                           (7.3)

   Note that this could be considered as a spacing at standstill (jam spacing) plus a dynamic

   part where T is the net time headway (subtracting the jam spacing from desired spacing).

       Now the acceleration is determined by a desire to drive at the same speed as the

   predecessor and a desire to drive at the desired headway. The model prescribes the fol-

   lowing acceleration:

                         a(t ) =  (v(t - )) +  s(t - ) - s                          (7.4)

   In this equation, v is the speed difference, t is a moment in time and  a reaction time.

   7.3.2. OPTIMAL VELOCITY MODEL

   The optimal velocity model proposed by Bando et al. (1995) is a car-following model
   specifying the acceleration a as follows:

7                            a = a0(v - v)                                          (7.5)

   In this equation, v is the speed of the vehicle, and a0 a reference acceleration (tunable
   parameter, constant for a specific vehicle-driver combination). v is determined as fol-

   lows:

                         v = 16.8(tanh(0.086(s - 25) + 0.913))                      (7.6)

   In this equation, s is the spacing (in meters) between the vehicle and its leader, giving
   the speed in m/s.

   7.3.3. INTELLIGENT DRIVER MODEL

   Treiber et al. (2000) proposes the Intelligent Driver Model. This prescribes the following

   acceleration:             v 4 s(v,v) 2

                         dv
                         dt = a0 1 - v0 - s                                         (7.7)

   with the desired spacing s as function of speed v and speed difference v:

                             s(v,v) = s0 + vT + vv                                  (7.8)
                                                         2 ab

       In this equation, v is the speed difference between the leader and the follower, a is
   acceleration and b a comfortable deceleration. a0 is a reference acceleration (parame-
   ter). Likewise, v0 in 7.7 is a reference speed which is a parameter.
7.4. RELATION TO FUNDAMENTAL DIAGRAM                                                                 65

                                      1800         Fundamental diagram according to the OVM
                                      1600
                        Flow (veh/h)  1400
                                      1200
                                      1000     10  20  30  40            50                  60  70

                                       800
                                       600
                                       400
                                       200

                                          0
                                            0

                                                       Density (veh/km)

Figure 7.5: Fundamental diagram according to the OVM

7.4. RELATION TO FUNDAMENTAL DIAGRAM

The fundamental diagram gives in its usual form the relation between the density and

the flow for homogeneous and stationary conditions. Also car-following models can de-

scribe homogeneous and stationary conditions. In that case, all vehicles should drive at

the speed and should not change speed (stationary). Therefore, the acceleration of all

vehicles must be zero.

Many car-following model prescribe the acceleration based on speed and spacing.

The equilibrium conditions mean that the acceleration is zero (and one might argue the

relative speeds as well). The relation between spacing and speed then gives an implicit

equation for the spacing-speed diagram. Using that the density is the inverse of the (av-

erage) spacing, and the flow is (average) speed times density, one can reformulate the                       7

spacing-speed diagram from the car-following model into a fundamental diagram.

    Take for example the OVM, equation 7.5 and equation 7.6. Equilibrium conditions
prescribe that drivers do not accelerate, hence a0(v - v) = 0. That means that either

a0 = 0, or                                     (v - v) = 0  v = v

                                                                                                     (7.9)

Since a0 cannot be zero - in that case the vehicle would never accelerate. Therefore, in
equilibrium conditions, equation 7.9 should hold. Using equation 7.6, we find:

                                      v = 16.8(tanh(0.086(s - 25) + 0.913))                          (7.10)

This gives a relation between speed and spacing. For a fundamental diagram in flow-
density, that gives (using q = kv:

            q = kv = k (16.8(tanh(0.086(s - 25) + 0.913)))                                           (7.11)

The spacing can be changed into a density. Since all vehicles have the same spacing
(equilibrium conditions), we may use

                                                   s = s = 1/k                                       (7.12)

Substituting this in equation 7.11, we find an expression for the fundamental diagram.

                        q = k (16.8(tanh(0.086(1/k - 25) + 0.913)))                                  (7.13)
   66  7. CAR-FOLLOWING

   Note that in this expression with the values as in equation 7.6, density should be in vehi-
   cles per meter and the resulting flow is given in veh/s. Converting these units, this results
   in the fundamental diagram as shown in figure 7.5.

   SELECTED PROBLEMS

   For this chapter, consider problems: 11, A.2.4, A.3.2, A.4.2, 133, 154, 179, 181, 220, 222,
   A.10.4, 266, 277, 280, 281, 282, 283

7
          8

        MICROSCOPIC LANE CHANGE

                                              MODELS

After this chapter, the student is able to:

      differentiate between courtesy, mandatory and desired lane changes

      comment on the principles of the Mobil lane change model

      comment on lane selection theories, "slugs and rabbits" in particular

      explain 4 other lane change strategies

      comment and analyse lane distributions

      describe the principle of relaxation

    The parts up to now are mainly focussed on the longitudinal driving behaviour and
the modelling thereof. This chapter discusses lateral driving behaviour. For multi-lane
roads, the lane changing plays an important role. In fact, lane changing is claimed to be
the main cause for traffic breakdowns (Ahn and Cassidy, 2007). They argue that a single
lane change manoeuvre might lead to a disturbance which grows and due to overreac-
tion, leads to a stop and go wave. Moreover, the lane flow distribution (LFD) is not equal
at bottlenecks, implying that in some lanes there is capacity remaining even though the
combined flow gets overcritical.

    Firstly, this chapter discusses a lane selection model from a psychological perspec-
tive (section 8.2). Then, in section 8.3 a microscopic lane change model is introduced.
Section 8.4 discusses more advanced lane change models, combining lateral and longi-
tudinal movements.

                                                          67
68                                                                8. MICROSCOPIC LANE CHANGE MODELS

                         (a) Desired lane changes

                         (b) Mandatory lane changes

8

                         (c) Coutesy lane changes
                      Figure 8.1: Different type of lane changes
8.1. TYPE OF LANE CHANGES                                                       69

8.1. TYPE OF LANE CHANGES

Three types of lane changes are distinguished. These are show in figure 8.1 and explained
below

    1. Desired lane changes are lane changes which a driver does to be better off, usually
        because the speed in the adjacent lane is larger.

    2. Mandatory lane changes are lane changes which a driver does because he has to
        to continue to its destination. This might be because the lane ends and the driver
        has to merge, or because the road splits into roadways with different directions,
        see figure 8.1b

    3. Courtesy lane changes are lane changes which a driver makes to help other drivers.
        There is no direct benefit for the driver that makes the lane change.

8.2. SLUGS AND RABBITS

This section describes a theory of lane selection, posed by Daganzo (2002a,b).

8.2.1. THEORY

This theory poses there are slugs and rabbits, two different types of drivers each with a

specific type of lane selection. They are defined as follows:

Category free speed lane choice

Slug  Low                    always right

Rabbit High                  Fastest

This means that the left lane(s) can operate at a different speed, and even in a different

regime than the right lane.

8.2.2. TRAFFIC OPERATIONS

Consider a situation with low demand. Then, slugs drive at their desired speed in the           8

right lane. This speed is lower than the desired speed of the rabbits. Rabbits hence drive

their desired speed and stay in the left lane(s). Both (type of) lanes have a different speed,

and operate independently. That is why this state is called a two pipe regime.

If the density in the left lane(s) increases, the speed can decrease to values below the

free flow speed of the right lane. Rabbits then choose to change lanes towards the right

lane, since they will change to the fastest lane. This will increase the density on the right

lane, and lower the speed. The density on the left lane(s) will decrease and the speed will

increase. Thus, the difference in speeds between the right and the left lane(s) decreases.

This process of changing lanes continues until the speed differences between the left

and the right lane have decreased to zero. Then, the complete flow operates at one state,

and this flow is called a one pipe regime.

8.2.3. LOADING

The section above describes traffic operations at a continuous motorway stretch. Inter-
esting phenomena occur at on-ramps. At an on-ramp, traffic merges onto the main road,
but always into the right lane. Consequently, the rabbits are not in their desired lane.
70  8. MICROSCOPIC LANE CHANGE MODELS

                 They need a distance to perform the additional lane change into the left, and faster, lane.
                 If the density in the left lane already is high, the traffic in the left lane might become over-
                 critical, and speeds might reduce. Note that this is happening downstream of the point
                 of merging, namely at a point where the rabbits change towards the fast lane.

              8.2.4. CONSEQUENCES

                 Although the model of lane selection as proposed by Daganzo is simple, it does explain
                 the following features observed in traffic.

                       Boomerang effect. This effect (Helbing, 2003) says that a traffic disturbance starts
                         at an discontinuity (for instance an onramp), than travels a while with the traf-
                         fic, before traffic breaks down to very low speeds and the disturbance will travel
                         upstream back to the discontinuity where it started.

                       Uneven lane distribution. It is found that near capacity conditions, the left lane
                         has a much higher traffic flow than the right lane (see e.g., (Knoop et al., 2010).

                       Capacity drop, elaborated in section 6.2.

            8.3. UTILITY MODEL

                 The theory of slugs and rabbits is a psychological theory which explains some phenom-
                 ena. It can not yet directly be implemented in a model. The lane change model MOBIL,
                 abbreviation for Minimizing Overall Braking Induced by Lane Changes, is a full working
                 model which can be directly implemented in a traffic simulation. It describes for each
                 time step whether or not a vehicle will change lanes. The model is explained in this sec-
                 tion. The section first describes the idea of the model. Then, the model is formulated in
                 terms of equations.

8 The basic idea of the model is that for each of the lanes a utility is calculated. This utility 8.3.1. MODEL IDEA

                 is based on the following items (note: all of the utilities below have a different value for a
                 different lane choice):

                       Foreseen acceleration of the driver: the more it can accelerate the better it is

                       Foreseen acceleration of the other drivers: one would prefer not to hinder others

                       (For European driving:) how far right: the rules prescribe to keep right unless over-
                         taking.

                 These utilities are calculated for each of the possible decisions: change left, change right
                 or stay in current lane. Then, they are weighted per decision and summed. This gives
                 the utility for a certain lane.

              8.3.2. MODEL EQUATIONS

                 The model is based on utility, calculated per lane, which we indicate by U. Drivers take
                 their own utility into account, as well as the utility of others. Figure 8.2 shows the other
8.3. UTILITY MODEL                                                         71

                                                                        nc
                                                                 o

Figure 8.2: The lane changing vehicle and the surrounding vehicles. In this figure, the vehicle is considering a
lane change to a left lane. If a lane change to the right lane is considered, vehicles in the other lane should be
considered, which will be indicated with the same symbols

vehicles involved in a lane change. The lane changing vehicle is indicated by a c, the new
follower by a n and the old follower by a o.

    The total utility for a driver is considered a weighted sum of the utility for himself and
the other vehicles:

                    Utot = Uc + P                   Ui = Uc + p (Uo +Un )  (8.1)

                                   i other drivers

The utility for the vehicle is expressed by its instantaneous acceleration a, as computed

using the IDM car-following model (see section 7.3.3). The utility U for vehicle i is then

expressed as

                                             v  s(vv) 2                    (8.2)
                    Ui = ai = a0 1 - v0 - s

For the interpretation of the variables, we refer to section 7.3.3.

    A lane change is performed if the utility of the driver for the other lane is at least
ath higher than the utility of the driver in the current lane. The variable ath acts as a
threshold variable in this case: as long as the utility gain is lower than that threshold, a
driver will not change lanes. From a behavioral point of view, ath can be seen as the cost
of lane changing, which can differ per driver.

EUROPEAN DRIVING RULES                                                                                              8

In Europe, driving rules dictate to stay right unless overtaking. In the United Kingdom,

the rule is to stay left unless overtaking. In the description here, we will refer to left

and right for right hand driving as in continental Europe; for changes in the UK system,

change left and right in the following description.

Two changes are made to the model:

1. The utility in the right lane is maximised at the utility of the left lane. By that
    change, one accounts for the fact that overtaking at the right is not allowed.

2. A bias towards the right is introduced, abias. This variable has a value larger than 0,

and shows how much utility people attach to keeping right. A lane change to the

right is performed if

                                   U right -U left  ath - abias            (8.3)

A lane change to the left is performed if

                                   U left -U right  ath + abias            (8.4)
72  8. MICROSCOPIC LANE CHANGE MODELS

            8.4. INTEGRATED MODELLING

                 Usually, models for lane changing separate a desire to change lanes from the manoeuvre
                 itself, which is for instance modelled by gap acceptance Gipps (1986). The model MOBIL,
                 as described in 8.3, incorporates the longitudinal accelerations into the choice for the
                 lane. Alternatively, the integrated model by Toledo et al. (2007, 2009) starts with the lane
                 change decision as lead and determines the acceleration.

                      Intuitively, one might think that drivers prepare for a lane change in their acceler-
                 ation, leave gaps for others merging into the traffic stream and only gradually adapt
                 their headways after someone merged in front, a phenomenon which is called relax-
                 ation. These concepts are incorporated in the LMRS model, the Lane Change model
                 with Relaxation and Synchronisation (Schakel et al., 2012).

                      Recent experimental (Keyvan-Ekbatani et al., 2016) findings show that drivers have
                 four distinct lane change strategies:

                     1. Speed leading: drivers choose a speed and in order to keep that speed, they change
                         lanes

                     2. Speed leading with overtaking: drivers choose a speed, and change lanes to over-
                         take. In contrast to the speed leading strategy, drivers will speed up in order to
                         reduce the time of overtaking.

                     3. Lane leading: drivers choose a certain lane and adapt their speed to the traffic in
                         that lane

                     4. Traffic leading: drivers claim they "adapt to the traffic", i.e. they do not have a
                         certain lane or speed in mind.

                 Surprisingly, although there are 4 distinct strategies, drivers expect that they drive "as
                 anyone else", and they are not aware that other drivers can follow a different strategy.

8 SELECTED PROBLEMS

                 For this chapter, consider problems: 2, A.3.5, A.4.3, A.5.2, 137, 138, 182, 190, A.9.4, 249,
                 A.11.7
          9

              USE OF TRAFFIC MODELS

After this chapter, the student is able to:

      choose the appropriate level of simulation

      comment on the value of calibration and validation

      (in principle) calibrate and validate a model

      comment on the number of parameters in models

      comment on stochasticity in models, and the use of random seeds

    Traffic simulation models are a very useful tool to assess the impact of a road design
or a new traffic management measure. In assessing measures, we differentiate between
ex ante and ex post analyses. This means respectively that the analysis is carried out
before the measure is implemented in practice, or after. Especially in ex ante analyses,
traffic models are very useful.

    The traffic flow theory and proposed simulation tools as discussed in this book can
form a useful basis to perform these analyses. However, they need to be used with care.
This chapter describes some steps a researcher or engineer needs to take before the
models can be used. These steps are calibration (section 9.3) and validation (section
9.3) of the models. Section 9.2.2 discusses the stochasticy of models, and how to handle
this. The last section discusses examples where it can go wrong. Before the steps are
taken the goal of the model has to be defined, which will be explained in the following
section.

9.1. GOAL OF THE MODEL

The goal of the model has to be defined in advance and the aspects the performance
of the model will be judged upon also have to be defined in advance. This is called the
measure of performance or measure of effectiveness. Examples of this measures of ef-
fectiveness are:

                                                          73
74  9. USE OF TRAFFIC MODELS

                       average speed at (x,t)

                       travel time

                       delay

                      Even if the measure of performance has been set, it has to be determined how this
                 will be measured. This is called the goodness of fit. This can be for instance the root
                 mean square error of the travel time.

            9.2. TYPE OF MODELS

                 Traffic models can be differentiated at different dimensions. First, we differentiate the
                 level at which a model operates. Furthermore, the model might have one or more driver/ve-
                 hicle types. Finally, another dimension is the stochasticity included.

              9.2.1. LEVEL

                 There are different levels at which one can simulate traffic. The levels considered in this
                 course are

                       Microscopically

                       Macroscopically

                       (Network level)

                 In case of microscopic simulation, one describes all vehicles. In case of macroscopic
                 simulation, one describes the traffic states on the road. Hence, this is one level higher
                 than the microscopic simulation. In this book, we only consider traffic simulations with
                 dynamics. Often, in planning, static assignment models are used; these are not consid-
                 ered here.

                      The choice of the level of simulation depends on the requirements, for instance with
                 regard to the:

                       unknown items (e.g., effect of influencing driving behavior, connected vehicles)

9

                       network size

                       allowed time for the simulation

                      The most important reason to choose a microscopic simulation model is if one wants
                 to analyse the effects of individual behaviour on the traffic operations.

              9.2.2. STOCHASTICITY

                 Many traffic simulation models are stochastic. That means that not all simulation runs
                 are the same. The runs can be seen as representation of different days for which the
                 same input conditions hold. Typical changes from run to run are:

                       Moment of entry into simulation, i.e. headway.
9.2. TYPE OF MODELS                                                                 75

 Car/driver specific:
  - driver type
  - routing information
  - equipped driver (connected)

To get a representative idea of the traffic situation, multiple random seeds (also called

replications or iterations) are required. Generally, it is advised to use proper statistics

to determine the right number of random seeds. A good way to assess this is to first

test what the model needs the represent, the so called measure of effictiveness. In a

few runs, determine the standard of this measure of effectiveness for various runs. Also

determine the required accuracy of the measure of effectiveness for the study at hand. A

very accessible approach is found in Driels and Shin (2004).

Let's consider an example. Suppose one wants to assess the average travel time in a

simulation and one would like to know with 95% certainty that the calculated travel time

does not differ more than 15% from the mean from the real. Several test runs show as

initial values a mean travel time of 28 minutes (x), and a standard deviation (variation

between the different random seeds, not variation between the drivers) of 6 minutes (),

which is the maximum allowed error ( max). From statistics, we know that 95% of the

observations fall within a margin of 1.96 standard deviations, so we choose a z-value of

1.96.

From statistics it is known that the bandwidth for the mean depends on the number

of replications:

                                         zS                                         (9.1)
                                 max =

                                           n

In this equation, z is used to obtain the likelihood the observation is in between the
bandwidth (1.96 in the example case). S is the standard deviation of the process, here
approximated by the standard deviation of the test set , 6 minutes. n is the number of
replications, to be determined. The maximum error is 5% of the mean of the process,
here estimated by 5% of the mean of the test set, being 5% of 28 minutes, is 1.4 minutes.

    Inversing equation 9.1 gives the equation for the required number of random seeds:

                                                            zS 2                    (9.2)
                                                   n
                                                                                               9
                                                                               max

Filling the values for the example, we obtain:

                     n           1.96  6 2    70                                   (9.3)

                                 1.4

    This process can be used. Note that the derivation assumes that the estimation for
S is accurate, so one needs already a small set of replications to estimate this. Alterna-
tively, one can check at the end whether the used number of replications also holds if
S is re-evaluated based on all runs. Moreover, it is a stochastic process and the equa-
tions assume a normal distribution. They hence can only be applied for larger sets of
replications.

    Finally a note from what is been used in practice. Often, due to the long compu-
tation times of traffic simulation programs - especially microscopic simulation times -
76  9. USE OF TRAFFIC MODELS

                      Figure 9.1: Examples of different random seeds in a simulation model. Colors indicate speed in a time-space
                      plane (space is horizontal, time increases from bottom to top

                 traffic engineers consider a "manual inspection" of the typical patterns, and use 10-15
                 replications. This will hence not give a statistically significant outcome.

              9.2.3. DIFFERENT USER CLASSES

                 Moreover, a traffic model can include different user classes. For instance, this could be
                 trucks and passenger cars, but one can include more classes: different destinations, dif-
                 ferent aggressiveness of driving, different type of information.

            9.3. CALIBRATION

                 The goal of the calibration is to make the model representative to the reality. The back-
                 ground will be discussed in the next section. Section 9.3.2 will provide some techniques
                 for calibration.

              9.3.1. USE OF CALIBRATION

                 Whereas some aspects of traffic are universal (conservation of vehicles), the driving be-
                 haviour is not constant. It might differ for instance per:

9  Road layout

                       Day of the week

                       Weather condition

                       Lighting condition

                       Region/country

                       Time of the day (including peak / non peak)

                 That also means that developers of the model cannot provide a model which can be
                 used in any condition. Therefore, the user has to change the parameters in the model
                 such that it fits the situation he wants to use the model for.
9.3. CALIBRATION                                        77

    The calibration entails adapting the driving parameters such that the model is in
agreement with reality. It is therefore essential that the user has data of traffic available
to calculate the goodness of fit of the model.

    For microscopic models, if the microscopic behaviour has to be represented cor-
rectly, it is needed that microscopic data is available. For an overview of the techniques
and uses of microscopic calibration and validation, we refer to the thesis of Ossen (2008).
Some microscopic models only aim at representing macroscopic characteristics. For
these cases, the model can be calibrated using macroscopic data that uses macroscopic
measures of performance. It can not be assumed, though, that the underlying micro-
scopic properties are correct.

    The end result of a calibration is a model including a parameter set which is repre-
senting the situation for which it has been calibrated. To test and check its predictive
power for other situations, a validation (section 9.3) is carried out.

9.3.2. TECHNIQUES

The idea is to get the best performance of the model, i.e. optimizing the goodness of fit.
In this section, two frequently used values will be discussed, being the root mean square
error and the log-likelihood.

ROOT MEAN SQUARE ERROR

An often used measure to indicate the quality of the simulation is the root mean square

error, or RMSE. For instance the RMSE of the speeds at each time and space interval

indicates how far the speeds are off "on average". The root mean square error is the

difference in speed (or in general: the indicator) squared, and then averaged over all

observations, in most cases several observations over space and time. Of this average of

squares, one takes the mean to get a value for the difference. This gives an indication

how far the speeds are different from the base values.

Note that the RMSE of speeds is not always a good measure. For instance, speeds

for the free flow branch, the traffic state can differ considerably, with an (almost) equal

speed. Choosing density as predictor for a traffic state is more meaningful as represen-

tative of the traffic state. However, the core of the calibration process lies in which is

the measure of performance the user wants to reproduce. If the user is satisfied if the

speeds are correctly predicted and the traffic states are off, the RMSE of speeds can be          9

a good way. Moreover, if there are stop-and-go waves which originate at random times,

the RMSE of speed can be very far off if the waves are predicted in the "other phase"

(i.e., start is predicted when traffic is stopped and vice versa). In that case, all speeds are

wrong, and a simulation predicting no congestion would be better, although from a traf-

fic flow perspective that is further from the truth. All in all, it lies in the requirements for

the user: if the user really wants speeds, minimising the RMSE might be a good option.

LOG-LIKELIHOOD
For stochastic models, the model predicts the outcome of a certain traffic state with a
probability. Let us denote the probability on a traffic state P (S|). This depends on
the parameters of the model, . The likelihood indicates how likely it is that the data
is found given the model. Assuming independency between the observations, one can
78                                                      9. USE OF TRAFFIC MODELS

express the likelihood as:

                            L () =                     P (Sobserved|)      (9.4)

                                    All observed data

Theoretically, one likes to maximize the likelihood of the model giving the observations
by adjusting the parameters. Hence, the optimal parameter set  is found by:

                                     = arg max L (()                       (9.5)

                                               par set

    The likelihood is very small. That is because each datapoint contributes a multiplica-
tive factor of 0 to 1 to the likelihood, being the probability that the model with that pa-
rameter set predicts that outcome. For many observations, that value will be very small.
For computational reasons, it might therefore be advisable to maximize the logarithm of
the likelihood instead, also called the loglikelihood.

    The loglikelihood L is defined as

                                    L = log L                              (9.6)

Because the likelihood is a product of probabilities, the log likelihood changes into a sum
of the logs of the probabilities:

    L = log L =                                        log P (Sobserved|)  (9.7)

                                    All observed data

              9.3.3. NUMBER OF PARAMETERS

                 A higher number of parameters gives more degrees of freedom to fit the model to the
                 data. However, this also comes at a risk of overfitting. One might choose the parameters
                 to best fit the data, but the interpretation of the parameters could be wrong because
                 the parameters are actually fitted random effects in the data rather than the underlying
                 structure of the data.

                      For model developers, the advice is that a parsimonious model should be used - a

9 only fit the parameters which can be estimated reliably and which have an influence on model as simple as possible which represent the data. For model users, the advice is to

                 the data which are collected.
                      A typical example of where (too) many parameters are to be estimated is in calibrat-

                 ing a microscopic model, including all driver parameters, using macroscopic data. As
                 is indicated in Ossen (2008), one cannot calibrate a microscopic model using macro-
                 scopic data since many combinations of parameters in the microscopic model lead to
                 the same macroscopic traffic patterns. If one would like to calibrate the microscopic
                 model nonetheless, one should refer to microscopic data.

9.4. VALIDATION

The section describes the validation of a model. In the validation, is is tested how well
the model is performing for the cases it is intended for.
9.4. VALIDATION                                                                        79

9.4.1. NEED OF VALIDATION

The result of a calibration is a model and parameters which are optimized. The purpose
of validation is checking whether the model indeed does as it is intended to. It could
be that all data from the calibration fits perfect, but for the cases in validation there are
other patterns. In that case the model is calibrated, but not validated. In general, the
calibration consists of finding an optimal parameter set, for which no specific quality
level needs to be given. For the validation, the goal of the model must be set, as well as a
validity range.

    The validity range is the range for conditions under which the model is working at a
quality level defined by the user on beforehand. This validity range could be the same
conditions as the validation, another day, another location, another country, another
number of lanes - this is to be specified by the user. However, note that the model is only
validated for those conditions the validation has been carried out for. For example, if the
validation is carried out for a similar day on the same road layout, it is not necessarily a
correct model for another road layout.

    The essence of validation is to make sure the model indeed performs to the required
level. Before that is done, no statements of the quality of the model can be made.

9.4.2. DATA HANDLING FOR CALIBRATION AND VALIDATION

For calibration and validation different data sets should be used. This prevents for prob-
lems of overfitting: if the parameters are fit to the specific (random) properties of the
data, this should not show in the validation.

    If the validity range is different from the calibration, one data set could be used for
the calibration and another dataset can be used for validation. That could for instance
be two different locations. If no specific conditions could be identified, the data should
at random be split in a part for calibration and validation. A typical distribution is to
allow 2/3 for calibration and 1/3 for validation.

9.4.3. TECHNIQUES

As mentioned before, the first thing one needs to do is set the aims for the model: under

which conditions the model needs to perform at which level. These are preferably intu-

itive measures; for instance a log-likelihood value is hard to interpret and hence not very    9

useful.

The process then is straightforward: run the model with the correct input variables,

and then consider the outcome in the chosen measure of performance and goodness of

fit. To which extent does it meet the required (or desired) criteria.

For instance, we want to validate a macroscopic traffic flow model for another day

than the day used for the calibration. Data are available for that day, showing the flows

and the speeds. We require that with the right inflow, measured at each km and aggre-

gated over 5 minutes, the RMSE of the speeds (compared to the ground truth data) is

below 5 km/h. The inflow at the beginning of the road stretch is put into the model,

the model predicts the speeds. These are compared with the data, and the RMSE of the

speeds is calculated. If the RMSE is below 5 km/h, the model is validated. For a good

overview of calibration and validation, see chapter 16 of Treiber and Kesting (2013).
80  9. USE OF TRAFFIC MODELS

            9.5. OFTEN MADE MISTAKES

                 In traffic engineering this often goes wrong. In this section, some examples are given.
                      The first, and most serious mistake is that uncalibrated models are being used. That

                 could mean that a model is developed such that some behaviour is in there. For com-
                 mercial micro simulation packages and drivers on freeways, that means that typical car-
                 following behaviour is implemented, just as a lane change model. However, drivers drive
                 differently all over the world and in different conditions. If one would simply implement
                 a road layout and put it in the specific package assuming that the drivers drive as the
                 developer put into the model, the risk of having a very wrong model is large. This risk is
                 further enhanced by the fact that the vehicle trajectories look realistic. This is because
                 the underlying car movements make sense. However, they are not necessarily true for
                 the case at hand.

                      Calibrated but unvalidated models are also common in practice. Data are being col-
                 lected and parameters of the model are optimized. However, without validation, one
                 knows the model is the best prediction possible (although a risk of overfitting exists), but
                 one does not know how good it is. It can be very far off the reality.

                      In microsimulation a vehicle demand is given. It can happen that the tail of conges-
                 tion in the network is spilling back to the entry of the network. In that case, the demand
                 cannot be put on the network due to the congestion. Various simulation programs then
                 act differently. Some will not generate new vehicles, whereas others store the vehicles in
                 "vertical queues". Since it is generally not known what models do, it is best practice to
                 avoid congestion spilling back to the network entry. Note that network entries also can
                 be onramps halfway the network. In this case, one can consider elongating the onramp.

                      The final mistake commonly made is the validated models outside their validation
                 range. For instance, a model could be validated for Dutch freeways with no slope at a
                 speed limit of 100 km/h and dry weather conditions. That model, with those parameter
                 settings, is then only validated for that range. A road in Italy, or road with slopes, or with
                 a different speed limit or with different weather conditions would then fall outside the
                 validation range.

            SELECTED PROBLEMS

9 For this chapter, consider problems: 163, 219, 221
        10

  MACROSCOPIC DYNAMIC TRAFFIC
                            FLOW MODELS

After this chapter, the student is able to:
      Describe the Cell Transmission Model
      Compute flows using the Cell Transmission model
      Compute propagation of traffic flows using the Cell Transmission Model
      Program the propagation of traffic flows using the Cell Transmission Model
      Comment on numerical errors and the CFL condition
      Give a physical meaning of using the N-model/Lagrangian coordinates and ex-
        plain the advantages thereof
      Explain when a model is a higher order model
      Comment on how to model multi-class traffic in a macroscopic description
      Comment and physically interpret a PCE value
    This chapter describes the principles which can be used in macroscopic traffic flow

modelling. First, the mathematical models are presented (section 10.1). From section
10.2 several discretisation schemes are presented, i.e. models which can be implemented
in a computer model.

10.1. MATHEMATICAL MODELS

Also on the macroscopic level, one can model the traffic operations. The main advan-
tages of macroscopic modelling over microscopic modelling are

                                                          81
    82                               10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10      1. a lower calculation time

        2. less sensitive to stochastic effects

        Simulating traffic flow macroscopically means that one has to find the equations of

    the dynamics of the macroscopic traffic flow variables. Conservation of vehicles (real-

    ising there are no vehicles created or disappearing along a motorway stretch) yield the

    following equation:

                                     k q                                               (10.1)
                                     t + x = 0

    This is a specific form of equation 13.1, with no source and sinks.

        The most basic modelling is first order modelling. In this case, a fundamental dia-

    gram is assumed, and hence there is a relationship

                                                 q = q (k)                             (10.2)

    Substituting this equation in equation 10.1, we find

                                                     k q k                             (10.3)
                                                     t + k x = 0
    This can be rewritten using the characteristic speed (see chapter 13): k q = c(k)

                                     k           k
                                     t + c(k) x = 0                                    (10.4)

        As chapter 13 already showed, the boundary conditions for the traffic flow can come
    from either downstream or upstream. Therefore, a combination of a downwind and an
    upwind scheme have been proposed, as section 10.2 will show. This model is described
    in the N-model (see section 15.2). The simulations also can be done in other coordinate
    systems. Especially the X-model is useful. Section 10.3 will discuss a numerical scheme
    similar to the cell transmission model of section 10.2 in the X-model. In this coordinate
    system, some of the mathematical disadvantages disappear

        Regardless of the coordinate system, the system might contain various classes. Sec-
    tion 10.5 discusses this phenomenon; a way to implement it in a computer model in
    discrete equations is proposed in section 10.5.2.

        All above methods use the fundamental diagram as starting point. This is not neces-
    sarily true. Section 10.6 discusses higher order models, i.e. models where traffic states
    can deviate from the fundamental diagram based on dynamics.

    10.2. SPATIAL AND TEMPORAL DISCRETISATION

    The most standard way to calculate traffic models is to discretise the space and time. In
    particular, this section will explain the cell transmission model, as introduced by Da-
    ganzo (1994). Mathematically speaking, this model is based on the model indepen-
    dently proposed by Lighthill and Whitham (1955) and Richards (1956) that is discretized
    in space and time and solved with a solution scheme proposed by Godunov (Godunov,
    1959). The model is also referred to as LWR model, an asseveration of Lighthill, Williams
    and Richards.
10.2. SPATIAL AND TEMPORAL DISCRETISATION  83

10.2.1. MODEL WORKING: CELL TRANSMISSION MODEL                                                 10

To start, a road is split up into segments of length L, and time is discretised in steps of
t . The state of a cell i at time step t is determined by its density. For each cell, the
fundamental diagram is specified. First the concept is explained. Then, the details and
equations are given.

    In uncongested conditions, the flow between upstream cell i and a downstream cell
i + 1 is determined by the demand (in veh/h) from cell i to cell i + 1. If there are more
vehicles, the demand is higher. The actual demand can be derived from the density in
cell i and the fundamental diagram.

    In congested conditions, the demand is high (many vehicles want to get out of the
area), but the supply is the restriction of the flow. In this case, the downstream cell i + 1
restricts the flow. The flow is hence determined by the flow in the downstream cell, which
can be derived from the density and the fundamental diagram.

    The CTM determines the flow over the boundary between cell i and cell i + 1 based
on demand and supply. Once this flow is determined, for each cell the difference in
inflow and outflow is known, and hence how the density in the cell changes. This gives
an updated density, and the process can be started again for the next time step.

    Note there is a relation between the cell length L and the time step t . Since the flow
maximum flow is determined by the downstream cell and upstream cell, information
from more than 1 cell from the boundary is not taken into account. Therefore, the time
step should be small enough such that within one time step, no vehicle (or congested
wave) travels more than one time step. Hence,

L t vmax                                   (10.5)

In this equation, vmax is the highest (absolute) speed of information in the traffic system.
In freeway conditions, these are the vehicle speeds. This inequality is called the CFL
condition, named after the researchers Courant, Friedrichs and Lewy (Courant et al.,
1928). In physical terms, it makes sense because one cannot have vehicles passing more
than one cell in a time step.

    Note that equation 10.5 shows an inequality sign. In principle, shorter time steps do
not form a fundamental problem. However, contrary to what one might intially think,
the solution does not improve if the time step becomes shorter. The reason is that the
homogeneity condition within a cell is violated stronger. Let's take an example for an
empty road which fills up from the start and a short time step. In the first time step, some
vehicles flow into the first cell. This cell is then considered homogeneous for determin-
ing the demand towards the next cell. At the end of the time step, there will be a demand
and a flow from cell 1 to cell 2, even though in reality the vehicles did not have the op-
portunity to reach the boundary yet. The errors which occur in due to the discretisation
scheme are called numercial errors. In this case, the wave between the empty road and
the vehicles that arrive does not remain sharp, but some vehicles are propagating very
fast, whereas the main part of the vehicles moves slows. The wave hence gets diffuse
due to the numercial scheme, and this is also called numerical diffusion. This is in an
exmaple shown in section 10.2.3.

    The more formal traffic flow scheme is as follows. We start by splitting the fundamen-
tal diagram into two parts. We define a demand function D as function of the density,
    84                                             10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

                    Demand                             Supply                                                                                                                     Demand and supply

10  3000                               3000                                                                                                                                 3000                     Demand
                                                                                                                                                                            2500                     Supply
    2500                               2500

    Demand (veh/h)2000                 2000                                                                                                                                 2000
                                                                                 Supply (veh/h)
                                                                                                                                                              Flow (veh/h)150015001500

    1000                               1000                                                                                                                                 1000

    500                                500                                                                                                                                  500

        00      50          100   150  00          50          100   150                                                                                                    00    50  100            150

                Density (veh/km)                   Density (veh/km)                                                                                                               Density (veh/km)

    (a) Demand                         (b) Supply                             (c) Demand and supply

    Figure 10.1: The demand and supply curves

    which equals the flow for undercritical conditions and the capacity in overcritical condi-

    tions.

                                             D = q(k) if k  kc                                                                                                                                               (10.6)
                                                    C if k > kc

    This indicates how much traffic wants to go from the upstream cell to the downstream
    cell.

        Similarly, we create a supply function S, which limits the flow at the entry of a cell
    in cases in which the cell is in overcritical conditions. This function equals capacity for
    undercritical conditions, and is equal to the flow given by the congested branch of the
    fundamental diagram in overcritical conditions:

                                                       C             ifk  kc                                                                                                                                 (10.7)
                                                   S
                                                       q(k) ifk > kc

        The demand and supply curves resulting from a triangular fundamental diagram can
    be found in figure 10.1. The flow from cell i to cell i + 1 is determined by the minimum
    of the demand in cell i and the supply in cell i + 1:

                                             qi ,i +1 = min {Di , Si +1}                                                                                                                                     (10.8)

    From figure 10.1c, it also shows how the fundamental diagram results from the minimum
    of demand and supply.

        This can be translated into an actual number of vehicles, by multiplying this flow
    by its duration, i.e. the duration of a time step t . The effect that this flow has on the
    densities in the cells depends on the lengths of the cells:

                                       ki = qi -1,i - qi ,i +1 (t /L)                                                                                                                                        (10.9)

        In implementing the CTM it is essential to realise that one determines the flow over
    the boundaries, and updates the cell densities iteratively. So every time, one has to
    change from a boundary perspective to a cell perspective. Also note that each cell is
    connected to two boundaries (one upstream one and a downstream one), which makes
    the numbering of cells and boundaries asynchronous. Consider this as warning in the
    implementation. There is no generic way the cells or boundaries must be numbered. In
    the following example, we will number cells 1-n and boundaries as well starting from 1.
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                              85

   Cell 1  Cell 2   Cell 3                                                                      10

 Boundary 1 Boundary 2 Boundary 3 Boundary 4

Figure 10.2: Numbering of cells and boundaries in the CTM

Cell number\Time 1  2       3   4                          5                    6  7

4                  17.5 17.5 0  0                          0                    0  20

3                  17.5 0   0   0                          0                    20 20

2                  17.5 35 52.1 66 77.3 66.3 57.5

1                  17.5 17.5 17.9 21.5 27.7 36.2 41.9

Table 10.1: The end result: the densities for all 7 time steps for all 4 cells

However, since the first boundary starts before the first cell, and the last boundary ends
after the last cell, there is one more boundary then cells (see figure 10.2)

    Note that the demand at the first boundary and the supply of the last boundary are
not defined in this way. The demand at the first boundary is determined by the externally
defined inflow into the network - how many vehicles want to flow in. The supply of the
last boundary can be set to infinite, showing that there is no capacity restriction outside
the simulated network (otherwise, that should have been in the simulation).

    Finally note that the aim of the CTM is to get the densities. With the densities and
the fundamental diagram (used as input), the flow in the cells and the speeds can be
determined. The flows as determined over the boundary should not be used as cell flows.

10.2.2. THE CTM AT WORK: EXAMPLE

Let's consider an example. We consider the case that there is a constant inflow of 1750
veh/h into a network. All cells have the same triangular fundamental diagram, with a
capacity C of 2000 veh/h, a free flow speed v f of 100 km/h and a jam density of 125
veh/km. Consequently, the critical density is kc = C /v f = 2000/100 = 20 veh/km. After
some time, a short blocking occurs in the network, which we represent here by setting
the maximum capacity at one boundary temporarily (2 seconds) to 0. For the sake of
illustration, we will now go over all computational steps to be made. The final traffic
states are represented by the density in each of the cells, and the final result is presented
in table 10.1. In this example, we use a time step of 0.5 seconds, and a cell length of 13.9
meter. Note that now the flow is blocked between cell 2 and 3, and causes an empty area
downstream (cells 3 and 4), and congestion upstream. At time step 6, flow recovers again,
and downstream cells are in capacity state. Later on (not shown here for space reasons),
the capacity state will also move to cell 2 and 1 (boundary is moving upstream).

    We will now show all the steps that are needed to get to this. In the tables below,
the cells are presented in horizontally next to each other and time goes down (note that
this is different than typical speed contourplots). This in in line with the cell layout as in
figure 10.2. In table 10.1 we chose to present time as columns (like in a speed contour
plot).

    For the next iterations, we show step by step how the densities are being computed.
    86                                          10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10  For reasons of understanding the steps, we will show each of the steps, which takes some
    space (tables) and causes redundancy.

         We first start with the densities as given in the beginning, i.e. at the start all cells
    have a density of 17.5 veh/km. Note that in all subsequent tables, we leave out units for
    reasons of space. Variables are given in default units, i.e. density in veh/km, flow in veh/h
    and veh nr N (and hence differences in vehicles, N ) in veh. In the table below we also
    indicate the flow which matches the density according to the prescribed fundamental
    diagram, indicated by Qk . This is, as argued above, not the flow over the boundaries.
    Instead, it helps in determining the demand and supply later. Moreover, after the flow
    Qk it is indicated whether this state is in free-flow conditions or congested conditions
    with a letter f or c respectively. At the first time step we hence have this network state
    (table 10.2):

    Cell            1                     2                    3                    4
    Bdry 1                       2                          3                    4                    5

                    k =17.5               k =17.5              k =17.5              k =17.5
                    Qk =1750f             Qk =1750f            Qk =1750f            Qk =1750f

    Table 10.2: CTM: time step 1

        All states are in free flow conditions, and at a density of 17.5 veh/km.
        Now, we determine the demand and supply on all of the boundaries. For this, we
    consider for all boundaries the demand (denoted d in the table below) determined by
    the upstream cell and the supply (denoted s) determined by the downstream cell. The
    flow over the boundary (q) is the minimum of demand and supply at the boundary. The
    flow over the boundary can be transferred into a number of vehicles that flows over the
    boundary in a time step. This is indicated by N , and is equal to the flow times the time
    step (note that one has to align units, so e.g. transform the time step to hours).

    Cell           1                   2                       3                       4
    Bdry                                          3                       4
          1                   2                                                                   5
                                                               k =17.5                 k =17.5
                   k =17.5             k =17.5                 Qk =1750f               Qk =1750f  d =1750
                                                  d =1750                 d =1750                 s=Inf
                   Qk =1750f           Qk =1750f  s=2000                  s=2000                  q =1750
                                                  q =1750                 q =1750                 N =0.243
          d =1750             d =1750             N =0.243                N =0.243

          s=2000              s=2000

          q =1750             q =1750

          N =0.243            N =0.243

    Table 10.3: CTM: time step 1.5

        In table 10.3 we see stationary, homogeneous, and undersaturated conditions. The
    demands are equal to the equilibrium flow, because the states are free flow. The supplies
    are equal to capacity, because the states are in free flow. The flow is hence equal to the
    demand, yielding 0.243 vehicles to flow over each boundary.

        Now moving one time step further, we check how these vehicular flows over the
    boundary change the densities in the cells. We use c N to indicate how many more
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                                          87

Cell           1                   2                    3                    4                         10
Bdry
      1                   2                    3                    4                    5

               k =17.5             k =17.5              k =17.5              k =17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=2000               s=2000               s=Inf

      q =1750             q =1750              q =1750              q =1750              q =1750

      N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

               c N =0              c N =0               c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

Table 10.4: CTM: time step 2

vehicles have flown into a cell then have flown out of the cell in the previous time step
(note this is a different concept than N , which we defined for boundaries). In this case,
since the flows over the boundaries are equal for all boundaries, an equal amount of
vehicles flows over each of the boundaries (see table 10.4)

    This leaves the change in number of vehicles in each cell, Del t ac N at 0, hence there
is no density change, and the densities are the same as the previous time step (17.5 ve-
h/km).

    Now a blocking takes place between cell 2 and 3. This is modelled by limiting the
supply of cell 3 to 0. We hence obtain the following table (table 10.5).

Cell           1                   2                    3                    4
Bdry
      1                   2                    3                    4                    5

               k =17.5             k =17.5              k =17.5              k =17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=2000               s=2000               s=Inf

      q =1750             q =1750              q =1750              q =1750              q =1750

      N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

               c N =0              c N =0               c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=0                  s=2000               s=Inf

      q =1750             q =1750              q =0                 q =1750              q =1750

      N =0.243            N =0.243             N =0                 N =0.243             N =0.243

Table 10.5: CTM: time step 2.5

    As you can see, the change is the supply at boundary 3, and consequently the flow
over boundary 3, and hence the number of vehicles flowing in one time step over bound-
ary 3.

    This has consequences for the density in the next time step. We follow the CTM and
check the differences in flow into and out of each cell. Since the number of vehicles
flowing over boundary 3 is lower than the number of vehicles flowing over boundary 2,
more vehicles flow into cell 2 than flow out of it. Likewise, since the number of vehicle
that flow over boundary 4 is higher than the number of vehicles that flows over bound-
    88                                          10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10  Cell           1                   2                    3                    4
    Bdry
          1                   2                    3                    4                    5

                   k =17.5             k =17.5              k =17.5              k =17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=2000               s=2000               s=Inf

          q =1750             q =1750              q =1750              q =1750              q =1750

          N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

                   c N =0              c N =0               c N =0               c N =0
                   k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=0                  s=2000               s=Inf

          q =1750             q =1750              q =0                 q =1750              q =1750

          N =0.243            N =0.243             N =0                 N =0.243             N =0.243

                   c N =0              c N =0.243           c N =-0.243          c N =0
                   k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

                   Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

    Table 10.6: CTM: time step 3

    ary 3, the number of vehicles in cell 3 decreases. In fact the differences in number of
    vehicles in one cell is indicated by c N . Cell 2 has 0.243 additional vehicles compared
    to the previous time step, and cell 3 has 0.243 vehicles less than in the previous time
    step. Converting this number to a density change, we need to divide the change in vehi-
    cle number (plus 0.243 veh resp minus 0.243 veh) by the cell length (13.9 m), yielding a
    density difference of 17.5 veh/km. The density in cell 2 hence increases by 17.5 veh/km,
    to 35 veh/km, and the density in cell 3 decreases by 17.5 veh/km to 0 veh/km, see table
    10.6. Note that vehicles from cell 1 can flow unhindered into cell 2 because there is no
    effect of the blocking yet because the density is still under critical.

        Note that the equilibrium flows for these densities are also different. For (the now
    empty) cell 3, Qk =0. Cell 2 gets to a congested state (the density exceeds the critical
    density), and with an equilibrium flow of 1714 veh/h.

        Note here that cell 3 completely empties in one time step. That is because cell 3 op-
    erates at free flow speed (under critical conditions and triangular fundamental diagram)
    and the cell length is chosen to be the time step times the free flow speed. In physical
    terms, the last car just manages to drive out of the cell in one time step.

        In the next step, we again determine the demand and the supply, which are being
    determined from the equilibrium flows. The congestion in cell 2 limits the supply to
    the equilibrium flow. Moreover, the supply to cell 3 is still limited to 0, representing the
    blocking. The demand from cell 3 is 0 because there are no vehicles, see table 10.7.

        Once the demand and supply are determined for each boundary, the flow is found
    by taking the minimum of the two. We see a slightly lower flow over boundary 2 due to
    congestion in cell 2 (limiting supply). Besides, there is no flow over boundary 3 due to
    the blocking and no flow over boundary 4 due to no demand (no vehicles in cell 3). The
    flow in vehicles over boundary 2 0.238 vehicles, i.e. slightly lower than the flow over cell
    boundary 1.

        Now, let's see how these flows cause changes in the density in the next time step.
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                                          89

Cell           1                   2                    3                    4                         10
Bdry
      1                   2                    3                    4                    5

               k =17.5             k =17.5              k =17.5              k =17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=2000               s=2000               s=Inf

      q =1750             q =1750              q =1750              q =1750              q =1750

      N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

               c N =0              c N =0               c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=0                  s=2000               s=Inf

      q =1750             q =1750              q =0                 q =1750              q =1750

      N =0.243            N =0.243             N =0                 N =0.243             N =0.243

               c N =0              c N =0.243           c N =-0.243          c N =0
               k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

               Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

      d =1750             d =1750              d =2000              d =0                 d =1750

      s=2000              s=1714               s=0                  s=2000               s=Inf

      q =1750             q =1714              q =0                 q =0                 q =1750

      N =0.243            N =0.238             N =0                 N =0                 N =0.243

Table 10.7: CTM: time step 3.5

Cell           1                   2                    3                    4
Bdry
      1                   2                    3                    4                    5

               k =17.5             k =17.5              k =17.5              k =17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=2000               s=2000               s=Inf

      q =1750             q =1750              q =1750              q =1750              q =1750

      N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

               c N =0              c N =0               c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=0                  s=2000               s=Inf

      q =1750             q =1750              q =0                 q =1750              q =1750

      N =0.243            N =0.243             N =0                 N =0.243             N =0.243

               c N =0              c N =0.243           c N =-0.243          c N =0
               k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

               Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

      d =1750             d =1750              d =2000              d =0                 d =1750

      s=2000              s=1714               s=0                  s=2000               s=Inf

      q =1750             q =1714              q =0                 q =0                 q =1750

      N =0.243            N =0.238             N =0                 N =0                 N =0.243

               c N =0.005          c N =0.238           c N =0               c N =-0.243
               k=0.4 k=17.9        k=17.1 k=52.1        k=0 k=0              k=-17.5 k=0

               Qk =1786f           Qk =1388c            Qk =0f               Qk =0f

Table 10.8: CTM: time step 4

Since the flow over boundary 2 is higher than the flow over boundary 3 (1714 veh/h, or
0.238 veh in one time step), the density in cell 2 increases with 0.238 vehicles. Trans-
    90                                          10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10  forming that into a density at a cell length of 13.9 meters, we have an increase in density
    of 17.1 veh/km. The flow over boundary 2 is slightly lower than over boundary 1, causing
    the number of vehicles in cell 1 to slightly increase. The difference of 0.243-0.238=0.05
    veh can be converted to density by dividing over the cell length. We thus have an increase
    of 0.4 veh/km in density in cell 1, and the density becomes 17.9 veh/km.

        Both boundaries 3 and 4 have no flow, so the density in cell 3 remains constant, at 0
    veh/km. Boundary 4 and 5 have a difference in flow, of 0.243 veh. Transforming that to a
    density difference, we find an decrease of density of 17.5 veh/km in cell 4, emptying cell
    4 completely, see table 10.8. The reasoning behind this is similar to cell 3 getting empty
    in the previous time step.

        Looking at the equilibrium flows of the cells, we see that cell 1 has density of 17.9
    veh/km, which is below the critical density of 20- veh/km and hence is in free flow. The
    matching equilibrium flow of is 1786 veh/km. Cell 2 gets further congested compared
    to previous time step, with an lower equilibrium flow of 1388 veh/km. Cell 3 and 4 are
    empty, and hence have a equilibrium flow of 0.

    Cell           1                   2                    3                    4
    Bdry
          1                   2                    3                    4                    5

                   k =17.5             k =17.5              k =17.5              k =17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=2000               s=2000               s=Inf

          q =1750             q =1750              q =1750              q =1750              q =1750

          N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

                   c N =0              c N =0               c N =0               c N =0
                   k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=0                  s=2000               s=Inf

          q =1750             q =1750              q =0                 q =1750              q =1750

          N =0.243            N =0.243             N =0                 N =0.243             N =0.243

                   c N =0              c N =0.243           c N =-0.243          c N =0
                   k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

                   Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

          d =1750             d =1750              d =2000              d =0                 d =1750

          s=2000              s=1714               s=0                  s=2000               s=Inf

          q =1750             q =1714              q =0                 q =0                 q =1750

          N =0.243            N =0.238             N =0                 N =0                 N =0.243

                   c N =0.005          c N =0.238           c N =0               c N =-0.243
                   k=0.4 k=17.9        k=17.1 k=52.1        k=0 k=0              k=-17.5 k=0

                   Qk =1786f           Qk =1388c            Qk =0f               Qk =0f

          d =1750             d =1786              d =2000              d =0                 d =0

          s=2000              s=1388               s=0                  s=2000               s=Inf

          q =1750             q =1388              q =0                 q =0                 q =0

          N =0.243            N =0.193             N =0                 N =0                 N =0

    Table 10.9: CTM: time step 4.5

        Now, the densities are determined again, we can go and consider the boundaries.
    Boundary 3 has still the supply set to 0 artificially, and no flow. Cell 1 is in free flow state,
    so the supply is at capacity level. With the demand lower at 1750 veh/h, the flow over
    boundary 1 equals 1750 veh/h, or 0.243 veh in the time step. Cell 2 is congested, leading
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                                          91

to a supply of 1388 veh/h for boundary 2. The demand for boundary 2 is based on the                    10
free flow demand in cell 1 1786 veh/h. The flow is hence 1388 veh/h, or 0.193 veh in
the time step. With no vehicles in cell 3 and cell 4, the demand over boundary 4 and 5
respectively is 0.

Cell           1                   2                    3                    4
Bdry
      1                   2                    3                    4                    5

               k =17.5             k =17.5              k =17.5              k =17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=2000               s=2000               s=Inf

      q =1750             q =1750              q =1750              q =1750              q =1750

      N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

               c N =0              c N =0               c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

      d =1750             d =1750              d =1750              d =1750              d =1750

      s=2000              s=2000               s=0                  s=2000               s=Inf

      q =1750             q =1750              q =0                 q =1750              q =1750

      N =0.243            N =0.243             N =0                 N =0.243             N =0.243

               c N =0              c N =0.243           c N =-0.243          c N =0
               k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

               Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

      d =1750             d =1750              d =2000              d =0                 d =1750

      s=2000              s=1714               s=0                  s=2000               s=Inf

      q =1750             q =1714              q =0                 q =0                 q =1750

      N =0.243            N =0.238             N =0                 N =0                 N =0.243

               c N =0.005          c N =0.238           c N =0               c N =-0.243
               k=0.4 k=17.9        k=17.1 k=52.1        k=0 k=0              k=-17.5 k=0

               Qk =1786f           Qk =1388c            Qk =0f               Qk =0f

      d =1750             d =1786              d =2000              d =0                 d =0

      s=2000              s=1388               s=0                  s=2000               s=Inf

      q =1750             q =1388              q =0                 q =0                 q =0

      N =0.243            N =0.193             N =0                 N =0                 N =0

               c N =0.05           c N =0.193           c N =0               c N =0
               k=3.6 k=21.5        k=13.9 k=66          k=0 k=0              k=0 k=0

               Qk =1972c           Qk =1123c            Qk =0f               Qk =0f

      d =1750             d =2000              d =2000              d =0                 d =0

      s=1972              s=1123               s=0                  s=2000               s=Inf

      q =1750             q =1123              q =0                 q =0                 q =0

      N =0.243            N =0.156             N =0                 N =0                 N =0

               c N =0.087          c N =0.156           c N =0               c N =0
               k=6.3 k=27.7        k=11.2 k=77.3        k=0 k=0              k=0 k=0

               Qk =1852c           Qk =909c             Qk =0f               Qk =0f

      d =1750             d =2000              d =2000              d =0                 d =0

      s=1852              s=909                s=2000               s=2000               s=Inf

      q =1750             q =909               q =2000              q =0                 q =0

      N =0.243            N =0.126             N =0.278             N =0                 N =0

Table 10.10: CTM: time step 6.5

    The subsequent time steps can be done similarly (see the values in table 10.10), and
are left to the reader. Let's pick up the steps again once the blocking is being removed,
after time step 6 so let's do step "6.5". Then, the supply of boundary 3 is no longer limited,
and with an empty cell 3 the supply is 2000 veh/h. With cell 2 congested, the demand
    92                                           10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10  is also at capacity, at 2000 veh/h. The flow over the boundary is hence the minimum of
    demand and supply, being 2000 veh/h. For boundary 2, cell 2 is still in congestion and
    poses a limitation on the supply. For boundary 4, there is no demand since there are no
    vehicles in cell 3. This is shown in table 10.10.

    Cell           1                   2                    3                    4
    Bdry
          1                   2                    3                    4                    5

                   k =17.5             k =17.5              k =17.5              k =17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=2000               s=2000               s=Inf

          q =1750             q =1750              q =1750              q =1750              q =1750

          N =0.243            N =0.243             N =0.243             N =0.243             N =0.243

                   c N =0              c N =0               c N =0               c N =0
                   k=0 k=17.5          k=0 k=17.5           k=0 k=17.5           k=0 k=17.5

                   Qk =1750f           Qk =1750f            Qk =1750f            Qk =1750f

          d =1750             d =1750              d =1750              d =1750              d =1750

          s=2000              s=2000               s=0                  s=2000               s=Inf

          q =1750             q =1750              q =0                 q =1750              q =1750

          N =0.243            N =0.243             N =0                 N =0.243             N =0.243

                   c N =0              c N =0.243           c N =-0.243          c N =0
                   k=0 k=17.5          k=17.5 k=35          k=-17.5 k=0          k=0 k=17.5

                   Qk =1750f           Qk =1714c            Qk =0f               Qk =1750f

          d =1750             d =1750              d =2000              d =0                 d =1750

          s=2000              s=1714               s=0                  s=2000               s=Inf

          q =1750             q =1714              q =0                 q =0                 q =1750

          N =0.243            N =0.238             N =0                 N =0                 N =0.243

                   c N =0.005          c N =0.238           c N =0               c N =-0.243
                   k=0.4 k=17.9        k=17.1 k=52.1        k=0 k=0              k=-17.5 k=0

                   Qk =1786f           Qk =1388c            Qk =0f               Qk =0f

          d =1750             d =1786              d =2000              d =0                 d =0

          s=2000              s=1388               s=0                  s=2000               s=Inf

          q =1750             q =1388              q =0                 q =0                 q =0

          N =0.243            N =0.193             N =0                 N =0                 N =0

                   c N =0.05           c N =0.193           c N =0               c N =0
                   k=3.6 k=21.5        k=13.9 k=66          k=0 k=0              k=0 k=0

                   Qk =1972c           Qk =1123c            Qk =0f               Qk =0f

          d =1750             d =2000              d =2000              d =0                 d =0

          s=1972              s=1123               s=0                  s=2000               s=Inf

          q =1750             q =1123              q =0                 q =0                 q =0

          N =0.243            N =0.156             N =0                 N =0                 N =0

                   c N =0.087          c N =0.156           c N =0               c N =0
                   k=6.3 k=27.7        k=11.2 k=77.3        k=0 k=0              k=0 k=0

                   Qk =1852c           Qk =909c             Qk =0f               Qk =0f

          d =1750             d =2000              d =2000              d =0                 d =0

          s=1852              s=909                s=2000               s=2000               s=Inf

          q =1750             q =909               q =2000              q =0                 q =0

          N =0.243            N =0.126             N =0.278             N =0                 N =0

                   c N =0.117          c N =-0.151          c N =0.278           c N =0
                   k=8.4 k=36.2        k=-10.9 k=66.3       k=20 k=20            k=0 k=0

                   Qk =1692c           Qk =1117c            Qk =2000f            Qk =0f

    Table 10.11: CTM: time step 7

        The final state of this example is shown in table 10.11, where the flows of the previous
    time step have lead to changes in density. One sees due to the flow over boundary 3 an
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                                            93

increase in in vehicle number in cell 3, up to the capacity (due to the choice of the cell               10
length in relation to the time step: the cell fills exactly up to the next boundary). Cell
2 has more outflow than inflow and its density reduces. It would take some more time
steps before this cell it is completely at capacity conditions.

Cell           1                   2                      3                    4
Bdry
      1                   2                      3                    4                    5

               k =17.5             k =17.5                k =17.5              k =17.5

               Qk =1750f           Qk =1750f              Qk =1750f            Qk =1750f

      d =1750             d =1750                d =1750              d =1750              d =1750

      s=2000              s=2000                 s=2000               s=2000               s=Inf

      q =1750             q =1750                q =1750              q =1750              q =1750

      N =0.243            N =0.243               N =0.243             N =0.243             N =0.243

               c N =0              c N =0                 c N =0               c N =0
               k=0 k=17.5          k=0 k=17.5             k=0 k=17.5           k=0 k=17.5

               Qk =1750f           Qk =1750f              Qk =1750f            Qk =1750f

      d =1750             d =1750                d =1750              d =1750              d =1750

      s=2000              s=2000                 s=1000               s=2000               s=Inf

      q =1750             q =1750                q =1000              q =1750              q =1750

      N =0.243            N =0.243               N =0.139             N =0.243             N =0.243

               c N =0              c N =0.104             c N =-0.104          c N =0
               k=0 k=17.5          k=7.5 k=25             k=-7.5 k=10          k=0 k=17.5

               Qk =1750f           Qk =1905c              Qk =1000f            Qk =1750f

      d =1750             d =1750                d =2000              d =1000              d =1750

      s=2000              s=1905                 s=1000               s=2000               s=Inf

      q =1750             q =1750                q =1000              q =1000              q =1750

      N =0.243            N =0.243               N =0.139             N =0.139             N =0.243

               c N =0              c N =0.104             c N =0               c N =-0.104
               k=0 k=17.5          k=7.5 k=32.5           k=0 k=10             k=-7.5 k=10

               Qk =1750f           Qk =1762c              Qk =1000f            Qk =1000f

      d =1750             d =1750                d =2000              d =1000              d =1000

      s=2000              s=1762                 s=1000               s=2000               s=Inf

      q =1750             q =1750                q =1000              q =1000              q =1000

      N =0.243            N =0.243               N =0.139             N =0.139             N =0.139

               c N =0              c N =0.104             c N =0               c N =0
               k=0 k=17.5          k=7.5 k=40             k=0 k=10             k=0 k=10

               Qk =1750f           Qk =1619c              Qk =1000f            Qk =1000f

      d =1750             d =1750                d =2000              d =1000              d =1000

      s=2000              s=1619                 s=1000               s=2000               s=Inf

      q =1750             q =1619                q =1000              q =1000              q =1000

      N =0.243            N =0.225               N =0.139             N =0.139             N =0.139

               c N =0.018          c N =0.086             c N =0               c N =0
               k=1.3 k=18.8        k=6.2 k=46.2           k=0 k=10             k=0 k=10

               Qk =1881f           Qk =1501c              Qk =1000f            Qk =1000f

      d =1750             d =1881                d =2000              d =1000              d =1000

      s=2000              s=1501                 s=2000               s=2000               s=Inf

      q =1750             q =1501                q =2000              q =1000              q =1000

      N =0.243            N =0.208               N =0.278             N =0.139             N =0.139

               c N =0.035          c N =-0.069            c N =0.139           c N =0
               k=2.5 k=21.3        k=-5 k=41.2            k=10 k=20            k=0 k=10

               Qk =1975c           Qk =1596c              Qk =2000f            Qk =1000f

Table 10.12: CTM working for a partial blocking

    As a final note, a similar example could be given for a state with a partial blocking,
allowing 1000 veh/h rather than 0. The full computational scheme of that case is given
    94  10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10  in table 10.12. The reasoning behind the steps is entirely the same. The only difference is
    that the (artifical) supply restriction during the blocking is set to 1000 veh/h rather than
    0 veh/h. The interpretation thereof is left to the reader.
10.2. SPATIAL AND TEMPORAL DISCRETISATION                                                                                                                                                95

                                      DT = 1s - T=0s                                            DT = 1s - T=180s                                            DT = 1s - T=360s                 10
                  150                                                        150                                                         150

                                                      150                                                         150                                                         150

Density (veh/km)  100                                 120  Density (veh/km)  100                                  120  Density (veh/km)  100                                  120

                                                      90                                                          90                                                          90

                  50                                  60                     50                                   60                     50                                   60

                                                      30                                                          30                                                          30

                  00   2  4                           60                     00   2  4                            60                     00   2  4                            60

(a) time step 1 s                                          (b) time step 1 s                                           (c) time step 1 s

                           DT = 10s - T=0s                                             DT = 10s - T=180s                                           DT = 10s - T=360s
       150                                                           150                                                         150

                                                      150                                                         150                                                               150
                                                                                                                                                                                    120
Density (veh/km)  100                                 120  Density (veh/km)  100                                  120  Density (veh/km)  100                                        90
                                                                                                                                                                                    60
                                                      90                                                          90                                                                30
                                                                                                                                                                              60
                  50                                  60                     50                                   60                     50

                                                      30                                                          30

                  00   2  4                           60                     00   2  4                            60                     00   2  4

(d) time step 10 s                                         (e) time step 10 s                                          (f) time step 10 s

Figure 10.3: An example of the numerical diffusion in an CTM model. Without numerical diffusion, in this
example all traffic states would either be at capacity or at jam density.

10.2.3. NUMERICAL DIFFUSION

The main disadvantage of the the CTM is the discretisation scheme leading to so called
numerical diffusion. This means that the shocks as described with shock wave theory
do not stay sharp. The numerical diffusion is lowest if the cell length are as short as
possible, but if the cell lengths should never be smaller than the time step times the free
flow speed, so no vehicle can travel further than one cell in a time step.

    Figure 10.3 shows this numerical diffusion in an example. The situation starts with a
high density (jam density) between km 3 and 4. At km 5, the road is blocked. Once the
simulation starts, shock wave theory predicts that the shock remains intact and travels
upstream. The analytical solution is as follows. When there is no further inflow, it should
reduce from the tail whereas the head travels backward. A second queue at jam density
should start growing with the head at km 5. This is what should be modelled by the
method.

    The numerical models show different effect based on their time step. The figure
shows the results at time 0 (one queue, initial conditions), 180 seconds and 360 seconds.
The cell lengths were chosen to match the temporal resolution, so to minimize numer-
ical diffusing. For the simulation, we chose a fundamental digram with kc =25 veh/km,
k j = 150 veh/km, and C =2000 veh/h.

    The figure shows that whereas we would ideally see a sharp shock between waves,
this starts to differ. With the short time step, due to the numerical scheme of the solution,
the shock is smoothed. If a non matching cell length would be chosen, this effect would
have been larger. For larger time steps, the inaccuracy in absolute spatial terms is largers
(the shock takes a larger space). For very large time steps (the right column), due to the
large spatial areas to match so, the patterns is not longer recognizable due to aggregation
of all vehicles into too large cells.
                    96  10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10

Figure 10.4: Simulation results of the backward propagation of a congestion tail, simulated in Lagrangian and
Eulerian coordinates. Figure from Leclercq et al. (2007)

    With other discretisation schemes, or other coordinates, for instance lagrangian co-
ordinates (see section 10.3), this numerical error can be less.

10.3. SIMULATION OF THE N-MODEL

An alternative to the cell transmission model could be a model which does not have
cells which are fixed in space, but which has cells of a block of vehicles. Basically, the
system now predicts the movement of each N vehicle, where its speed is governed by
the V (s) fundamental diagram. The difference in space between the Nth vehicle and the
(N -N )th vehicle determines the spacing, which in turn determines the speed. Assume
a time step of t seconds. After applying the speed for t seconds, new positions are
assigned, leading to new spacings etc.

    A main advantage is that numerical diffusion is not or less present with a well chosen
discretisation scheme in lagrangian coordinates. Figure 10.4 shows how the numerical
schemes can work.

    A mathematical description of a multiclass model in Lagrangian coordinates is given
in section 10.5.2. For more information on Lagrangian macroscopic models, see van
Wageningen-Kessels et al. (2010).

10.4. EVENT BASED

In event based models, time is not approached by infinitely small time steps. Instead,
the traffic is assumed to stay the same up to the next event.

    A simple event based traffic model is the shock wave theory discussed in section 4.
There, the traffic states propagate until two waves intersect, and the next wave will be
created. Then again, the next event can be calculated, but there is no need to check how
the waves propagate in the mean time.
10.4. EVENT BASED                                                                                                                                                                                        97

                               Fundamental diagram 4 speeds                                                                                           Fundamental diagram 4 speeds speedlines                10
1400
                                                                                                                                    5000

                                                                                                                                              Fundamental Diagram

                                                                                                                                              100 km/h

1200                                                                                                                                4000      40 km/h

                                                                                                                                              0 km/h

1000                                                                                                                                               -18 km/h
                                                                                                                                    3000

Flow (veh/h/lane)800                                                                                                                2000
                                                                                                                 Flow (veh/h/lane)
600                                                                                                                                 1000

400                                                                                                                                 0

200                                                                                                                                 -1000

00      20  40               60  80                          100  120                                                               -2000     20             40    60  80                      100  120
                                                                                                                                           0

            Density (veh/km/lane)                                                                                                                            Density (veh/km/lane)

(a) The fundamental diagram                                            (b) The fundamental diagram and the speed curves

Figure 10.5: The fundamental diagram in the flow density plane

10.4.1. LINK TRANSMISSION MODEL

The link transmission model is a model developed by Yperman et al. (2006). It considers

nodes as base elements, and using cumulative curves it is determined how much traffic

can flow into the link and out of the link. Just like the cell transmission model, a demand

and a supply are determined; the difference being that this has to be determined only

once per node. A link hence does not need to be cut in different cells, which makes the

computation more efficient.

It is based on Newell (1993), which gives limits for the number of vehicles which

will have passed a specific point. That is maximized by the traffic, but limited by either

demand or supply.

Suppose the road has a piecewise linear fundamental diagram, as in figure 10.5a.

Each of the pieces of the fundamental diagram corresponds with a wave speed. For
several moving observers, passing with a speed  one can calculate the maximum flow

passed this observer, which can be calculated by (see equation 3.11). The flow for a cer-

tain density is given by the fundamental diagram. However, by moving there is a flow
k subtracted from it. This flow difference which should be subtracted is indicated in

the colored lines in figure 10.5b. The flow relative to the observer is then the distance

between that line and the fundamental diagram, or in an equation (equal to equation

3.11):

                                                                  qrel = k (v - )                                                                                                                   (10.10)

This maximum flow is plotted in figure 10.5b. This relative flow for each of the observers
is plotted in figure 10.6a. It is important to note that these relative flows are maximum for
the density range in which the characteristic speed of the fundamental diagram matches
the speed of the corresponding moving observer.

    These flows are measured along a moving path, as indicated in figure 10.6b. For
the point of interest, indicated in the figure, one can calculate how many vehicles have
passed. This depends on the conditions earlier in time. The limits of the number of
vehicles that can have passed are given by relative flows passing the moving observer.

    In our case for four different parts of the fundamental diagram, there are four paths
    98                                                10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10                            Relative flow                                                                                                                                 Space time 4 speeds
                                                                                                                                         12
        2000

           0                                                                                                                             10
     -2000
     -4000Flow (veh/h/lane)                                                                                                              8
     -6000                                                                                                                   Space (km)
     -8000                                                                                                                               6
    -10000
    -12000                                                                                                                               4

             0                                                                                                                                                                                   Point of interest

                100 km/h                                                                                                                 2 100 km/h
                40 km/h                                                                                                                                                                                      40 km/h
                0 km/h
                -18 km/h                                                                                                                                                                         0 km/h

                    20                                                                                                                                                                           -18 km/h

                          40  60             80  100  120                                                                                00  1  2              3                                 4                    5

                          Density (veh/km/lane)                                                                                                    Time (min)

    (a) The relative flows passing the different moving observers (b) The trajectories of the moving observers

    Figure 10.6: Calculating the flow using moving observers

    along which the relative flow should be checked, as shown in figure 10.6b. If the initial
    conditions (at t =0) are known, the cumulative vehicle number at each of the starting
    points of these lines is known (indicated by N0,i ). To this initial cumulative vehicle num-
    ber we should add the relative flow times the time to have the restriction on the vehicle
    number for that particular moving observer, indexed i

                                                      Nlim i  N0,i + qrelt                                                                                                                                            (10.11)

    Because the relative flow is maximum if the characteristic speed is the speed of the mov-
    ing observer, we know that we can only consider the maximum flow pass the moving
    observer. Or in other words, the lower flows for other densities do not need to be consid-
    ered. Hence the vehicle number in the point of interest can be calculated:

                                                      N = min Nlim i                                                                                                                                                  (10.12)

                                                                i

    10.5. MULTI-CLASS

    10.5.1. PRINCIPLES

    Another dimension, which in principle can be combined with all discretisations men-
    tioned above, is the number of classes in the model. Usually, these are trucks and pas-
    senger cars, since these have distinct characteristics. The three main differences are:

        1. Trucks have a lower speed

        2. Trucks have a longer length

        3. Trucks have a lower acceleration

        In first-order traffic flow modelling, accelerations are not considered as such, and
    thus difference three is ignored. The first two differences lead to a different fundamental
    diagram for trucks.
10.5. MULTI-CLASS                                       99

                                 40 m                            10

                                       50 m

                             7m                   20 m

Figure 10.7: The influence of the vehicle length on the density and the remaining net spacing for different
speeds

Figure 10.7 shows what the influence is of different speeds at the gross headways. For

high speeds, the gross distance mainly consists of net headway, and thus the truck does

not occupy much more space than a passenger car. For low speeds, this difference is the

same, but relatively, this difference is larger.

The capacity is the maximum number of vehicles that can pass a cross section per

unit of time. As is clear from the above, this number will be less if the traffic stream

consists of more trucks. The effect of trucks is expressed as passenger car equivalent, or

PCE. The PCE value for vehicles in class J is indicated by P J . In this description, the flow

is limited by the capacity:

                                 q  PJqJ                (10.13)

                                         J

In this equation, qJ , is the flow of vehicle class J . PCE values for trucks can be found in
hand books, for instance Heikoop (2011); Transportation Research Board, (2000). Typi-
cally, the PCE for trucks is around 2. If we consider a road with a capacity of 2000 pcu/h
(passenger car unit, but often simply quoted as 2000 veh/h), a demand of 2000 passen-
ger cars per hour is critical. A demand of 1800 passenger cars per hour and 200 trucks
per hour leads to an effective demand of 1800+2*200=2200 pce/h (see equation 10.13),
which is overcritial. Given the vehicle demand of 1800 veh/h and the capacity of 2000
pcu/h, there is a remaining capacity of 200 pcu per hour. This equals a flow of 200/2=100
trucks/h.

    1. [ PCE calculation]Exercise: calculate the PCE for trucks for the fastlane discription
for 10% and 20% trucks. Assume reasonable numbers for the unknown variables.

10.5.2. FASTLANE

The two classes can be mixed, and then the classes should interact. Fastlane (van Lint
et al., 2008) is a model where this mixture is incorporated. The model is based on a
class-specific fundamental diagram which gives the relation between the net distance
headway and the speed. Note that this relation does not directly work with the density,
i.e., the inverse of the gross distance headway. The reasoning is that the speed of both
classes in congestion is equal and depends only on the net distance headway. Because
trucks are longer, the gross distance headway for the same speeds is longer for trucks. By
separating the headways from the length of the vehicle, only one speed-headway rela-
tionship for congestion needs to be specified.
    100             10. MACROSCOPIC DYNAMIC TRAFFIC FLOW MODELS

10      The independent variable for the model could be "empty space". This can be uniquely
    changed into a generalized density, assuming a uniform vehicle of one passenger car ve-
    hicle.

        Using these principles, as well as the class-specific fundamental diagrams and the
    model equations for the Fastlane model can be derived. The resulting model equation
    can be found in Van Wageningen-Kessels (2013), from which the remainder of this sec-
    tion is taken.

        Before we reformulate the multi-class conservation equation into Lagrangian coor-
    dinates (see section 10.3), we need some definitions and preliminaries. We define class
    1 as the reference class for the coordinate system. This implies that only vehicles of class
    1 are numbered. Therefore, coordinate n refers to the number of vehicles of class 1 that
    have passed location x until time t . Furthermore, the coordinate system moves with the
    vehicles of class 1, i.e. with velocity v1. Therefore, the Lagrangian time derivative in the
    multi-class model is defined by:

                    D          
                    Dt = t + v1 x              (10.14)

    Finally, the class-specific spacing of class 1 can be expressed as the partial derivative:

                            x                  (10.15)
                    s1 = - n

    Realising that su = 1/ku, this can be substituted into the Eulerian conservation equation
    (10.1), the quotient rule is applied and the result is rewritten:

          1 +  vu = 0  su - su vu + vu su = 0  (10.16)
         t su x su     t              x  x

    Subsequently, substituting the multi-class Lagrangian time derivative (10.14) yields:

         Dsu - su vu + (vu - v1) su = 0        (10.17)
         Dt         x              x

    Finally, (10.15) is substituted to find the Lagrangian multi-class conservation equation:

         Dsu + su vu + v1 - vu su = 0          (10.18)
         Dt s1 n       s1 n

    We note that for class 1 the conservation equation (10.18) reduces to a simpler form:

                    Ds1 + v1 = 0               (10.19)
                    Dt n

        Yet an alternative formulation of the conservation equation in Lagrangian coordi-
    nates is proposed in (Yuan, 2013; Yuan et al., 2015b):

                    Dsu + vu = 0               (10.20)
                    Dt nu
10.6. HIGHER ORDER MODELLING                                       101

with Lagrangian time derivative:                                                             10

                                  D  
                                  Dt = t + vu xu                   (10.21)

The main difference is that in this model a different coordinate system is introduced for
each class. The coordinate systems are coupled via the fundamental relation and the ef-
fective density function. Yuan (2013); Yuan et al. (2015b) argue that this formulation may
lead to more efficient simulations if there are only few vehicles in the reference class.

10.6. HIGHER ORDER MODELLING

There are other macroscopic models, which include more terms and can include traffic
states that are not on the fundamental diagram. That way, hysteresis can be included.
One of the most used higher order models is the Metanet model. In this model, the
speed increase is limited, representing a reaction time and a limited acceleration. In this
reader we do not discuss these models. For more information on the disadvantages and
advantages, see Daganzo (1995b) and Aw and Rascle (2000). For more information on
the Metanet model, see Kotsialos et al. (2002), which is a macroscopic equivalent of the
Payne car-following model (Payne, 1971).

10.7. SUGGESTED PROBLEMS

28, A.2.1, A.3.1, 88, 134, 135, 136, 193, 240, 241, 242, 291, 292
        11

        AN INTRODUCTION TO NODE

                                    MODELS

Acknowledgment This chapter is partially based on the text by Lin Xiao and Jeroen P.T.
van der Gun

    After this chapter, the student is able to:

      Build, interpret, and comment on the equal demand merge model the capacity
        based merge model

      Explain the 7 golden rules for node models (when given, no need to learn by heart)

    Links and nodes are the essential elements of network topology. No matter we con-
sider people or goods transported in physical network or data delivered in logical net-
work, the structure of network is determined by the arrangement of these components.
Each network, regardless of its complexity, can be schematized as an abstract topological
network with links and nodes only. So does the traffic network.

    In traffic simulation, road network are generally built up by connected links and
nodes. Links are considered as the roads where the vehicles travel on. And nodes are
the intersections of these links, which passing flows from and to different segments.
Therefore, the connected links and nodes form a network to support vehicles' move-
ments from each origin to various destinations.

    Important for traffic simulation is the ability to mimic the propagation of vehicle
flows along the network. In the texts so far, we have mainly considered the traffic opera-
tions at links, ignoring what is happening at nodes. In this chapter, we discuss the node
models.

    The node model is the mechanism of receiving flow and sending flow at a node. It
reflects the movement of flow from upstream to downstream links and determines how
much flow can be actually carried out. Flow is constrained by traffic demand and sup-
ply. In general, traffic demand are the flows which intend to move from incoming links
to outgoing links. And traffic supply is defined as the maximum flows that outgoing

                                                         103
    104               11. AN INTRODUCTION TO NODE MODELS

11  From\To 1 2 .. n   Contraints                                                 From\To 1 2 .. n
             1                                                                             1
             2                        Blad1                                                2
             ..                                                                            ..
             n        Node model                                                           n

      Demands                                                                         Flows

    Figure 11.1: OD matrix and flow matrix as input and output of the node model

    links can receive. Because of the possible imbalance between demand and supply, ac-

    tual flows are not as same as the demand flows. Therefore, node model is expected to

    be a distribution process of traffic flow, transforming an origin-destination matrix (with

    origins and destinations the inflow and outflow links of a node, repectively) into a flow

    matrix (see figure 11.1).

        The general structure of a node model is shown in figure 11.2. Each node model is

    connected with one or several incoming links (1,2. . . nin) and outgoing links (1,2. . . nout),
    which are sending and receiving flow from and to the node.

                                                                                                                               j

        Outgoing link j receives flows from each incoming link, as the qi in j th column of
    flow matrix. (Note that we will use subscripts to indicate incoming links and superscripts
    to indicate outgoing links) Outflow q j is the total flows towards outgoing link j , which

    is restricted by the ability of the downstream link to accept more vehicles, indicated by
    maximum receiving flow R j . We thus have a supply constraint:

                      q j = qij  R j                                              (11.1)

                                i

    Likewise, the sum of the flows from a incoming link cannot exceed the capacity of that

    link Si :                         j

                      qi = qi  Si                                                 (11.2)

                               j

                                                   j

        The turning fraction fi is defined as the fraction of the total flow qi turning to out-
    flow link j . At the scale we are considering here, congestion leaves this ratio invariant
    (i.e., we do not assume the vehicles chose a different route due to congestion). There-
    fore, the node model should leave the turning ratio invariant.

        In Tampre et al. (2011) two functions of node models are described. First, a node
    model imposes constraints on outflow of incoming links because imbalanced demand
    and supply. If node demand is larger than node supply (for any of the outflow links - or
    possibly for an internal contraint), not all the demand flow can be satisfied and flow is
    then limited to the minimum flow that can be achieved. Therefore outflow of upstream
    links are constrained.

        The second function of node model is to see consistency between demand and sup-
    ply constraints. The constraints imposed only on link inflow and outflow leads to the
11.1. NODE MODELS IN THE CELL TRANSMISSION MODEL                105

Inflows                            Outflow                                11

... Node model ...

 Demands per link, Di              Supply constraints, Rj
 Capacities per link, Si           (receiving flow capacity)
 (sending flow capacity)           Priority rules
 Turning fractions fij

Figure 11.2: Node model structure

                                   Node model
                                                            qj

Figure 11.3: Merge model

                                                                                                          j

interactions between each flows. It means any change of qi may lead to changes of the
other flow. Thus the node model distributes flow under the guarantee of consistency,
and it becomes a flow optimization problem with demand and supply constraints.

    We will in the sequel first show a simplified case to get the model to work for a merge
or diverge with a the cell transmission model, and then comment on the generic require-
ments for the node models.

11.1. NODE MODELS IN THE CELL TRANSMISSION MODEL

Daganzo (1995a) first defines the two basic forms of a node model he considers: a merge
model and a diverge model. Restricting the attention to networks with three-legged
junctions, Daganzo described a merge model as two links enter the cell and only one
link leave it, while diverge model has one incoming link and two outgoing links. Valid
node representations are outlined in paper and it should be stressed that links can only
belong to either the merge model or diverge model. Junctions with more legs are not
considered here.

11.1.1. MERGE MODEL
    106  11. AN INTRODUCTION TO NODE MODELS

11  PRINCIPLES

    Considering three-legged junction, we have two incoming links (i =1,2) and one outgoing
    link ( j =1) in merge model (figure 11.3). The demands at the two the incoming links are
    d1 and d2. The outgoing link has a supply constraint as R. More importantly, we define a
    capacity priority fractions p1 and p2, which indicate the relative priority to traffic coming
    from link 1 and link 2. The priorities are defined as fraction of the total flow, hence p1 +
    p2 = 1. Then, because of demand and supply constraints, the flow should satisfy:

               q1  d1  (11.3)
               q2  d2  (11.4)
         q1 + q2  R    (11.5)

    There are now 3 possible combination of demand, which are also graphically shown in
    figure 11.4. That figure shows the flows on both axes (demands from the incoming links
    are denoted as d1 and d2, as well as the demand (d ) per incoming link. We list them
    in order of increasing demand, or alternatively seen as order of decreasing maximum
    receiving flow.

    1. A high maximum receiving flow R, or d1 +d2  R. In this case, the demand is lower
        than the supply and all traffic can be handled. That results in q j = q1 + q2. In this

        case, traffic is free flow on both incoming links, and q1 = d1 and q2 = d2.

    2. If the R < q1 + q2, there is congestion at at least one of the two links. The outflow
        in this case is the capacity (q j = R). Based on this flow, the maximum permissible

        flow per incoming link is p1q j for link 1 and p2q j for link 2. (At least one of the
        two exceeds this value, otherwise we are at condition (1)) Condition (2) holds if

        only one of the 2 exceeds this value, condition (3) if both exceed this value. The
        situation as depicted in figure 11.4 shows that p1q j > d1. Hence, all flow from link
        1 can be served, so q1 = d1. We then can derive that q2 = R - q1. Graphically, in
        figure 11.4, that means that the flows are found at q, at the intersection of the

        demand of the inflow link 1 and the supply of the outflow link.

    3. If the supply is restricted R < q1 + q2, and neither of the two incoming links can
        output his demand to the outflow link, the flows are distributed by priority frac-
        tions. We hence have: q1 = p1R and , q2 = p2R. Graphically, in figure 11.4, these
        flows are on intersection of the line with the right turn fractions and the line of the
        maximum supply (3).

        In a static traffic assignment model, flows from an incoming link can be sustained at
    a flow lower than capacity of that link. In a dynamic model, as soon as congestion occurs,
    the demand from the incoming link at the node immediately goes to the capacity of that
    link (there is namely congestion at the downstream end). In this model, that means that
    once there is congestion at both links, the ratio between the flows from each incoming
    link is fixed, and it is not longer dependent on the flow further upstream on that link.
    Therefore, in practice, the priority ratio will apply quite often. In practice, this ratio is
    determined by infrastructural design.
11.1. NODE MODELS IN THE CELL TRANSMISSION MODEL                                                   107

               q1+q2=R                                                                                       11
   q2 (2) (1)

        (3)                                        q1/q2=p1/p2
q2=S2

                            q1=S1 q2

Figure 11.4: Diagram of feasible flows for a merge junction

NUMERICAL EXAMPLE

Let's now consider a numerical examples. Let's assume a road with a demand d1=3500
veh/h, d2=1500 veh/h. The priority of the roads in oversaturated conditions is 4:1 (for
instance due to 4 lanes to the intersection in road 1 and 1 lane for road 2). We consider
this system in 3 scenarios for the capacity of the outgoing link: 8000 veh/h, 4500 veh/h
and 2000 veh/h. The matching situations are illustrated in figure 11.5

1. If the capacity of the outgoing link is 8000 veh/h, the full demand can be served.
    We hence have q1 = d1 =3500 veh/h and q2 = d2 =1500 veh/h.

2. If the capacity of the outgoing link is 4500 veh/h, that is not sufficient for all de-

    mands: d1 + d2 = 3500 + 1500 > 4500. If we consider how much of the capacity
    of the outgoing link would be available for inflow 1, that is 4 1+4 4500 = 3600 veh/h,
    which is higher than the demand of 1, being 3500 veh/h. Hence, the full demand

    of 1 is served: q1 = 3500 veh/h. The remaining capacity is allocated to direction 2:

    q2 = 4500 - 3500 = 1000 veh/h.

3. If the capacity of the outgoing link is 2000, neither of the two streams can be fully

served while respecting the priority. Hence, we divide the capacity of the outgoing

link  over   the  priority  rules:  q1  =  2000     4   =  1600,  and  q2  =  2000     1   =  400
                                                   4+1                                4+1

11.1.2. DIVERGE MODEL
    108                                                                             11. AN INTRODUCTION TO NODE MODELS

11  q2  8000             Numerical examples merge model
        7000                                                Outgoing link capacity
        6000                                                Demand
        5000                                                Priority
        4000                                                Solution
        3000
        2000                                (1)
        1000             (3) (2)
                 1000 2000 3000 4000 5000 6000 7000 8000
            0
              0                              q1

    Figure 11.5: Numerical examples of the merge model

                                Node model

    Figure 11.6: Diverge model

    PRINCIPLES

    In the diverge model, there is one incoming link (i=1) and two outgoing links ( j =1,2). The

    objective is to maximize the total outflow q of the incoming link, and hence to maximize

    the total inflow to the downstream links. There is a demand from the incoming link equal
    to d . The supply constraints are R1 and R2. The fraction heading towards link 1 and 2 are
    denoted f 1 and f 2 respectively. With the turning fractions given, flows should satisfy:

                                      q1 = f 1q  R1                                 (11.6)
                                      q2 = f 2q  R2                                 (11.7)
                                q1 +q2  S                                           (11.8)

        It is assumed that a vehicle unable to exit the incoming link hinder the vehicle be-

    hind, which implies that the first-in-first-out rule (FIFO) is applied in the diverge model,

    which is also known as conservation of turning fractions (CTF) in this context. One can

    interpret this as that 1 out of n vehicles is turning, so if the flow to the exit is limited, also

    the flow to the main line is limited.
        One can first determine whether all both are possible. If f 1d < R1 and f 2d < R2, all

    flow can pass, so q1 = d f 1 and q2 = d f 2.
        If not, the most restrictive outflow link will determine the relative flow. Let's de-

    termine the fraction of demand towards a particular outflow link that can continue:
    i = f i d /Ri . The minimum of these factors is  = mi n(1, 2). Now, the overall flow
    should be reduced to a factor  of the demand:

                                q1 = d f 1                                           (11.9)
                                q2 = d f 2                                          (11.10)

                                                                                    (11.11)
11.2. GENERAL NODE MODELS  109

    Note that the turning fractions can be specified explicitly, potentially as a function    11
of time, but can also be derived by modelling traffic flows heterogeneously. In Daganzo
(1995a), traffic is for example disaggregated by destination, and we can then specify the
turning fractions per destination. E.g. Yperman (2007) further generalizes this into the
concept of multi-commodity modelling. Van der Gun et al. (2015) for example instead
use disaggregation by origin to specify turning fractions.

    Finally, note that whereas this has been formulated as a two-link outflow model, this
is easily transferred to a system with multiple outflow links.

NUMERICAL EXAMPLE
Consider a freeway with a capacity of 4000 veh/h (direction 1) and an offramp of 1000
veh/h (direction 2). The demand is 3000 veh/h. Now we consider two different situa-
tions:

    1. If the turn fraction to the offramp (2) is 1/6, the demand to the offramp is 1/6
        * 3000 = 500 veh/h<1000 veh/h, so no congestion occurs. For the main line, the
        demand is 5/6 * 3000 = 2500 so no congestion occurs there either. We hence have
        q1 = 2500 veh/h, and q2 = 500 veh/h.

    2. if the turn fractino to the offramp (2 is 2/3, the demand to the offramp is 2/3 *
        3000 = 2000 veh/h. This is twice the capacity of the onramp. The demand to the
        main line can fit into the main line (1/3 * 3000 = 1000 < 4000 veh/h), 1 = 1. The
        minimum of the two fractions is  = 2 = 21 . That means that half of the demand
        can go through. We have q1 = 1000 = 500 veh/h, and q2 = 2000 = 1000 veh/h.
        Note that the total flow out of the node is q = q1 + q2 = 1500veh/h. This means
        congestion occurs, and will grow on the upstream link.

11.2. GENERAL NODE MODELS

The previously discussed node models only apply to simple merges and diverges. Gen-
eral node models with an arbitrary number of incoming and outgoing links are a lot more
difficult to formulate. Tampre et al. (2011) cite Bliemer (2007) as a typical general model
for which they provide a numerical example.

    An important problem with the Bliemer model, that also occurs in the previously de-
scribed Daganzo (1995a) merge model, is that it does not satisfy the so-called invariance
principle. Introduced by Lebacque (2005), this principle states that flows across an in-
tersection should not change during an infinitesimal time step if demand and supply
remain constant. In practice, that would happen if one assigns an outflow proportional
to the overall inflow demand. One should consider that at one location the queue forms,
and hence take - as explained in section 11.1.1 - a infrastructural proportionality con-
stant (e.g., based on capacities

    Before formulating a node model themselves, Tampre et al. first formulate the list
of requirements it should satisfy:

      Support arbitrary numbers of incoming and outgoing links.

      Maximize flows. The final solution should not leave capacity underused if there is
        demand. There can also be internal constraints within the node.
    110  11. AN INTRODUCTION TO NODE MODELS

11        Produce non-negative flows.

          Conserve vehicles.

          Satisfy demand and supply constraints of the connected links. There may be ad-
            ditional internal node supply constraints, e.g. to account for crossing flows that
            do not have an incoming or outgoing link in common. The previously mentioned
            SCIRs should also be satisfied.

          Conserve turning fractions (CTF).

          Satisfy the invariance principle. (Discussed above)

    Then, they mathematically formulate node models for unsignalized and signalized inter-
    sections satisfying these requirements. The employed solution to satisfy the invariance
    principle is to define priorities proportional to the capacities (i.e. maximum demands)
    of incoming links rather than the current demands of incoming links. The unsignalized
    intersection model does not include node supply constraints, whereas the signalized in-
    tersection model includes node supply constraints representing the green phases of the
    traffic lights. The solution algorithm is too complex to describe here, so the interested
    reader is referred to the paper for details. Despite its complexity, it is guaranteed to con-
    verge to the solution within a fixed, finite number of iterations.

        However, the solutions are not necessarily unique, as shown by Corthout et al. (2012).
    There can be a case with through traffic and left turning traffic, where through traffic
    has priority. If a situation is triggered which makes one direction flow (say, direction
    bottom-up), then that limits the turning flow in the opposite direction (top-down), and
    hence also the through flow in the opposite direction (top-down). That in turn allows a
    higher turning flow from bottom to top, strengthening the unequal situation. The same
    situation could also be reversed, with a higher flow bottom to top. Note that the problem
    is symmetrical, and the priority rules are not different from one side or the other.

    11.3. DISCUSSION

    One may wonder whether there exist other approaches to solve a general node model. As
    an alternative to the Tampre et al. (2011) algorithm, Fltterd and Rohde (2011) propose
    an incremental procedure and extend that to include node supply constraints, finding
    the same solution in a different way. There seems plenty of work to do to operational-
    ize and validate node models for all kinds of complex intersection shapes that exist in
    reality, including e.g. roundabouts. For example, Smits et al. (2015) show that while the
    invariance principle can be satisfied without assuming capacity-proportional priorities,
    the solution algorithms of the such node models may not fully converge within finite
    time.

        As final note: there is an analogy between the node models and a macroscopic multi-
    lane framework extending the cell transmission model. That lane change model can be
    expressed in terms of a network, where each link represents a lane for the length of some
    segment and each node between segments represents an opportunity to change lanes
    Laval and Daganzo (2006); Nagalur Subraveti et al. (2019)
        12

      MACROSCOPIC FUNDAMENTAL

                                            DIAGRAM

After this chapter, the student is able to:

      Explain the concept of the MFD

      Explain the differences between the MFD and FD

      Comment on the influence of density heterogeneity on the MFD

      Give examples of control concepts based on the MFD

      Explain the value of perimeter control, for instance using cumulative curves

    The idea of a Macroscopic Fundamental Diagram (MFD) or Network Fundamental
Diagram (NFD) is that rather than at the level of a road, at the level of an area there ex-
ists a relationship between the number of travellers on the road and the average speed
of these travellers. Moreover, it could be argued that the noise in the measurements
might be less. For individual detectors, one will find deviations from the fundamental
diagram, (both upward and downward) which creates high scatter. Geroliminis and Da-
ganzo (2008) showed that if one averages all detectors over a large area almost all scatter
disappears (see figure 12.1; figure from Geroliminis and Daganzo (2008)). From a mathe-
matical point, this makes sense since it simply is the law of large numbers. But although
the concept seems simple, the effect might be large.

    The essence of an MFD is that a high density affects the traffic flow to even under
capacity. This is in contrast to a single road with a bottleneck, where in case of a high de-
mand, the outflow will be at capacity (or queue discharge rate). This internal congestion
can only take place if the (tail of ) the congestion influences the throughput. This is the
case with spill back effects, e.g. a tail of the queue growing backwards and thereby in-
fluencing drivers which want to take an exit which does not pass the bottleneck. A very

                                                         111
    112                                                          12. MACROSCOPIC FUNDAMENTAL DIAGRAM

    1                                                                                                                                                                      0      0.2      0.4            0.6
                                                                                                                                                                    0.15
    0.75
                                                                                                                                                                     0.1
    0. 5qi /max {qi }                                                                                                                                                                                          A1
                                                                                                                                                                    0.05                                       B1
                                                                                                                                                                 u                                             C1
                                                                                                                                                                                                               D1
                                                                                                             q (vh/sec)                                                                                        A2
                                                                                                                                                                                                               B2
12  0.25                                                                                                                                                                                                       C2
                                                                                                                                                                                                               D2
             Detector #: 10-003D      Detector #: T07-005D

    0                                                                                                                                                               0

          0  0.2                  oi  0.4                   0.6                                                                                                        0      30       60             90       120

                                                                                                                                                                                       ku (vh/ln-km)

    Figure 12.1: The first Macroscopic Fundamental Diagram constructed from data, from Geroliminis and Da-
    ganzo (2008).

    Figure 12.2: A simplified network congestion influences the outflow.

    Table 12.1: Variables for the MFD

             Name                 symbol   meaning
             Accumulation         A        Number of vehicles in the network (veh, or veh/km)
             Production           P        Internal flows in the network (veh/h)
             Performance          P        Outflow out of the network (veh/h)
12.1. PERIMETER CONTROL                                                        113

                         A=VHT/t [veh]       k=A/L [veh/km]
                                             q=P/L [veh/h]
P=#exits/t [veh/h]       P=VMT/t [veh km/h]
                         v=P/N [km/h]

                         T=P/Q=VMT/#exits

                         Normalize:        Normalize:
                         x trip length T   / lane length L

Figure 12.3: The relation between the different quantities related in the MFD

                                                                                                 12

much simplified example of this is given by Daganzo (2007), which proposed a single
ring road with entrances and exits everywhere, see fig 12.2.

    In MFDs, some terminology is different (see table 12.1 for an overview). Accumu-
lation (A) is the total number of vehicles in a network, which can be expressed as total
number of vehicles or number of vehicles per roadway length. Note that since the road-
way length is fixed, these two are proportional. Some scientific works separate accu-
mulation from the average density, with the network length (preferably the lane-kms) as
proportionality factor. It can be argued that for comparison of the traffic state between
networks the scaled version, average density, is more relevant. In the sequel of this work,
we will hence use accumulation also as scaled variable.

    Production (P ) is the internal flow in the network. The average flow can be computed
by Edie's definitions for all links in the network (equation 1.8). If this is not corrected for
the network length (only total travel distance divided by the aggregation time), one gets
the total production. Similar to accumulation and average density, it can be argued that
a scaled version would be more useful to compare between networks, hence here we will
be using production for the average flow (i.e., the total distance divided by the aggrega-
tion time and the network length). Performance (P ) is the outflow of the network, which
is the sum of the flow of the outgoing links. Geroliminis and Daganzo (2008) show there
is a strong relationship between the production and the performance. This relationship
for empirical data is shown in figure 12.4. The ratio of production and performance is
the length of the trip within the zone. (As a thought experiment: if one increases the trip
length inside the zone by a factor of two, the internal flow, and hence the production,
needs to increase by a factor of two before the same outflow, performance, is reached).

    This chapter first discusses what could be a possible control application for the MFD,
before continuing to conditions under which the MFD holds (section 12.2). Then, sec-
tion 12.3 discusses a way to include the MFD into a simulation model, and the chapter
ends with some recent developments.

12.1. PERIMETER CONTROL

The idea behind perimeter control is as follows. As the production decreases with an
increasing accumulation, it might be better to limit the accumulation in a zone, the so
called protected network. Let's consider for the sake of simplicity the situation, with one
zone which has this limitation, and storing vehicles outside the network will not affect
traffic operations in the neigbouring zones (of course the waiting vehicles themselves
are affected).
    114                                                                         12. MACROSCOPIC FUNDAMENTAL DIAGRAM

             Production and performance - Geroliminis and Daganzo (2008)                                                                                        Correlation - Geroliminis and Daganzo (2008)
                                                                                                                                               7
         15                                                               0.15

                                                                                                                                               6

    Outbound flow (veh/s)10                                               0.1                                                                  5
                                                                                                         Average flow (veh/s)
12                                                                                                                      Outbound flow (veh/s)  4

         5                                                                0.05                                                                 3

                                                                                                                                               2

                    Performance

                    Production

         0                                                                0                                                                    1
             4 6 8 10 12 14 16 18 20 22 24                                                                                                     0.02 0.04 0.06 0.08  0.1  0.12 0.14 0.16

                    Time of day                                                                                                                   Average flow (veh/s)

    (a) timeseries                                                              (b) correlation

    Figure 12.4: The relation between the production and the performance

    Figure 12.5: The effect of perimeter control in cumulative curves, figure from Daganzo (2007).
12.2. TRAFFIC DYNAMICS  115

     If we assume a constant trip length, for instance by assigning random exits around          12
the ring road, the production will decrease as well. This causes an escalating effect of
further increasing accumulation and a further decreasing outflow. An example can be
found in figure 12.5 (figure from Daganzo (2007)). This principle will now be discussed.

     The top figure shows the cumulative inflow curve (upper curve, indicated A(t ) - note
that in this example, the original notation from (Daganzo, 2007) will be used), and the
cumulative outflow curve without (L(t )) and with perimeter control (L(t )). The inflow
curve is externally given, as is the MFD showing the production (outflow, G in this exam-
ple) as function of accumulation (lower figure, n in the example, so the line is indicated
G(n)). The accumulation in the system can be found by the difference between the in-
flow and outflow. Only the outflow at t=0 is specified, which equals 0, leading to the
accumulation n(0), which happens to be greater than the critical accumulation .

     The dynamics of the outflow can now be predicted. In case of no perimeter control,
the performance is governed by the MFD, which is the derivative of the outflow function.
In the example n(0) > , so the traffic is in a congested state, and the outflow can be read
from G(n). This outflow is lower than the inflow into the system, and as a consequence,
the accumulation increases, leading to a decreasing outflow. Hence, the cumulative out-
flow curve L(t ) flattens. Once the accumulation increases to , the maximum number
of vehicles in the road, the outflow reduces to 0.

     Perimeter control entails limiting the inflow into the ring, and keep this at the level of
the critical accumulation where the outflow is highest, i.e. not exceed . The inflow curve
with the restriction is indicated with A(t ) in the figure. It starts with not letting any
vehicles in until the accumulation is equal to . By consequence, the outflow increases
over this time, since the accumulation becomes closer to mu, and hence the outflow
closer to the maximum outflow . Once the accumulation is reduced to , the outflow is
; to maintain this number of vehicles, the same amount of vehicles are left in the system.
Once the queue is solved, i.e. no more vehicles have to wait to get into the system, the
perimeter control stops. The outflow curve constructed in this way is indicated as L(t ).

     The perimeter control comes at a cost, the waiting time outside the network. This can
be indicated in the figure as the area between lines A and A. The benefit is the higher
outflow, which is the shaded area between L and L. Note that the benefits exceed the
costs.

12.2. TRAFFIC DYNAMICS

A very strict claim on the application of the MFD is that it only holds if the traffic condi-
tions are homogeneous throughout the network. In that case, all links in the area have a
similar density, and the MFD simply is an average of all the same traffic states; the aver-
age then is that traffic state. In Cassidy et al. (2011) it has been shown what the averaging
effects are in case a triangular fundamental diagram is assumed for the underlying links.

     Figure 12.6 shows the effect of averaging two traffic states. If both states lie on the
free flow branch, the average also lies on the free flow branch. If both lie on the con-
gested branch, the average also lies on the congested branch. Only if one point lies on
the congested branch and one point at the free flow branch, the average does not lie on
either branch, but under the fundamental diagram. With a similar reasoning it can be
shown that the average traffic state always lies under the fundamental diagram for one
    116                             12. MACROSCOPIC FUNDAMENTAL DIAGRAM

                       2000                           Fundamental diagram
                       1500                           Considered area
                       1000                           Mean state

         Flow (veh/h)   500
                           0
                             0  50  100               150  200

                                    Density (veh/km)

12

    Figure 12.6: The construction of the average traffic state for two states on a triangular fundamental diagram.

    Figure 12.7: Illustration of a 4x4 grid network with periodic boundary conditions

    link if the fundamental diagram is concave.
        One can continue this arguing and find that the larger the spread is, the further the

    average flow deviates from the flow which would match the average density according
    to the fundamental diagram. In an extreme case, some links are empty (q=0, k=0), and
    other links are jammed (q=0, k=k j ). All links then have a flow of 0, so the average flow
    also equals 0. However, the flow matching the average density, somewhere between 0 <
    k < k j in the fundamental diagram is larger than 0.

    12.2.1. APPROACHES TO INCLUDE THE STANDARD DEVIATION

    It hence makes sense to include the spread of the densities as second explanatory vari-
    able besides the average density.

        One can show the effects of the network dynamics by performing a traffic simulation
    study and analysing the results (Knoop et al., 2015). One of the simplest network setups
    is a Manhattan grid network (one way streets in a square grid) with periodic boundary
    conditions. Periodic boundary conditions mean that traffic exiting at the right of the
    network enters at the left and traffic from exiting at the top enters at the bottom and vice
    versa. The network structure is shown in figure 12.7.
12.2. TRAFFIC DYNAMICS                                                                     117

                                                                                                12

(a) start of the simulation  (b) 0.5 hour

(c) 1 hour                   (d) 1.5 hour

(e) 2 hour                   (f) 3 hour

(g) 3.5 hour                 (h) 4 hour

Figure 12.8: Evolution of the densities (bar heights) and speeds (colours) in the network
    118                                                                                                             12. MACROSCOPIC FUNDAMENTAL DIAGRAM

            Generalised Macroscopic Fundamental Diagram                                                                                                   Isoproduction lines (production in veh/h/lane)

    Production (veh/h)                                                                                                                     70
                                                                                                                          . (veh/km/lane)                                                                                                       1200
                                                                                                              1400
                                                                                                                                           60
    1500
                                                                                                              1200                         50 1000

    1000

    500                                                   1000

                                                                                                                                           40                                        800

         0                                                800

    80                                                                                                                                     30
                                                                                                                                           20
            60 600                                                                                                                         10                                        600
                                                                                                                                            0
            40                                                      400                                                                                                              400
                                                                                                                                                  20
12                   20                              100  150                                                                                                                        200
                                  50                                200

    . (veh/km/lane)      00  A (veh/km/lane)                                                                                                          40  60  80           100  120

                                                                                                                                                          A (veh/km/lane)

    (a) The generalised macroscopic fundamental diagram                                                             (b) Iso-production lines in the accumulation-inhomogeneity
                                                                                                                    of density plane

    Figure 12.9: The generalised macroscopic fundamental diagram

        When the traffic starts to run, various distributed bottlenecks become active. This
    is shown in figure 12.8b. After some time (figure 12.8d-f), traffic problems concentrate
    more and more around one location. The number of vehicles in the rest of the network
    reduces, ensuring free flow conditions there. This complete evolution can be found in
    figure 12.8a-f.

        This indicates that with this second explanatory variable, the traffic flow can be ap-
    proximated reliably. We thus define a concept, the generalised fundamental diagram
    (GMFD) which predicts the production as function of the accumulation and the stan-
    dard deviation of density (Knoop et al., 2015)

                                                          P = P (A,A).                                                                                                               (12.1)

        Figure 12.9a shows the GMFD. Figure 12.9b shows the same surface, but now in iso-
    production lines. The production decreases once the inhomogeneity increases, and that
    this holds for every accumulation.

    12.3. SIMULATION

    Since there is a relation between the number of vehicles in a zone and the outflow, also
    a dynamic simulation model can be developed. This is a recent development, see e.g.
    Knoop and Hoogendoorn (2015) for the Network Transmission Model. In this model, an
    area is divided into zones, and the traffic flow is calculated using the MFDs.

        In each of the MFDs, the principle as described in the beginning of this section is
    implemented, where the accumulation determines the outflow. The interesting part of
    this concept is that, contrary to the isolated example in 12.1, the queuing outside the
    protected network also influences the traffic flow in that zone. Hence, there is a trade-off
    between letting vehicles into a protected zone, delaying the protected zone, or letting
    them wait outside, delaying the vehicles outside. Also, routing around the protected
    zone is an option, at the cost of more traffic outside (Hajiahmadi et al., 2013).

        This model has been applied for the city of The Hague (Knoop et al., 2016), with a
    good result, showing that the rough approach works in giving the approximately right
12.3. SIMULATION                                                                                   119

                                                                                                                       12

(a) Initial parameters, first part of simulation  (b) Initial parameters, last part of simulation

(c) Adapted parameters, first part of simulation  (d) Adapted parameters, last part of simulation

 (e) Adapted parameters, accident, first part of simulation (f) Adapted parameters, accident, last part of simulation

Figure 12.10: Screen shots of the simulation. The color indicates the speed relative to the free flow speed, and
the height the accumulation, figure from Knoop et al. (2016)
    120  12. MACROSCOPIC FUNDAMENTAL DIAGRAM

12  results for traffic states. The model output with speeds (color) and accumulations (bar
    height) is shown in figure 12.10 (from Knoop et al. (2016)).

    12.4. RECENT INSIGHTS

    The field of the MFD is actively studied. The simulation models of which one example
    is described above in section 12.3 are field of studies, but there are other approaches as
    well. The division of space into different zones is also currently being studied, since one
    would like to have homogeneous areas, see Ji and Geroliminis (2012).

        An interesting development is to estimate the MFD from scratch, without measure-
    ments. For fundamental diagrams, such estimates are possible. Laval and Castrilln
    (2015) uses an interesting technique to do the same for a zone, simplified to a ring road
    with random traffic lights. This paper follows other work, for instance by Leclercq and
    Geroliminis (2013).

        Finally, the route length is not constant. Leclercq et al. (2015) indicates that the traffic
    patterns might lead to people using a different, non-shortest, route, thereby influencing
    the relationship performance-production. All in all, some aspects of the MFD still need
    studying, but the concept is perceived as promising.

    SELECTED PROBLEMS

    For this chapter, consider problems: 26, 27, 86, 87, A.5.5, 157, 158, 159, 164, 202, 214,
    A.10.6, 268
       13

METHOD OF CHARACTERISTICS

The kinematic wave model provides a relatively simple approach to reproduce and pre-
dict the spatio-temporal characteristics of traffic congestion by means of a macroscopic
model, either by simulation (numerical solution approaches) or, as we will discuss in
this chapter, analytically. The so-called method of characteristics (MoC) is a well known
solution method for partial differential equations.

    The kinematic wave model is, however, a bit special. Since in many cases, the kine-
matic wave model does not have a classical solution (solutions which are continuously
differentiable) due to the occurrence of shocks. As a result, we will look for so-called
generalised solutions (weak solutions that are piece-wise continuously differentiable).
However, since there is an infinite number of generalised solutions, we will have to look
for a special solution which satisfies the entropy condition (i.e. local maximisation of the
flow).

    This chapter describes the MoC approach to determine solutions of the kinematic
wave model. We will start with briefly explaining the general concept and the mathe-
matics. Then, section 13.2 will show two examples.

13.1. MATHEMATICAL CONSTRUCTION

This section first describes the construction of the curves, then applies the theory to a
road with no entering and exiting traffic Section 13.1.3 gives the interpretation.

13.1.1. CONSTRUCTION

The conservation of vehicles yields that change of the number of vehicles in a section
( tk ) is explained by the difference in flow at both ends of the section x q , the inflow within
that section (r , also called a source) and the outflow within that section (s, also called

sink term). Put together, we get the conservation equation:

k q            (13.1)
t + x = r - s

121
    122                                   13. METHOD OF CHARACTERISTICS

                Space  B B c(k)

                                                                                    Time
    Figure 13.1: A boundary with known traffic states in the space-time diagram, and a characteristic curve

13  Note that the flow and density are both functions of time t and location x. We further-

    more have:

                       q = Q(k, t , x)                (13.2)

    Note that we allow spatial and temporal fluctuations in the fundamental diagram.
        Now suppose that we know the traffic conditions (i.e. the traffic density) for a bound-

    ary B in the (t , x) plane. These can either reflect initial conditions (e.g. the density on
    the road at some initial time t = t0), boundary conditions (inflow into the considered
    roadway section; outflow restrictions), etc.

        Together with the boundary conditions, the kinematic wave model can be used to de-
    termine the traffic conditions influence by the traffic conditions described at the bound-
    ary B (see figure 13.1).

        The idea of the method of characteristics is to transform the kinematic wave model
    (which is a partial differential equation) into a set of ordinary differential equations,
    which can be solved with standard techniques. To see how to do this, we fill in Eq. (13.2)
    into Eq. (13.1) yielding:

                       k Q k k k          Q
                       t + k x = t + c x = r - s - x  (13.3)

    Note that c = c(k, t , x) = k Q is the slope of the fundamental diagram at (t , x), describing
    the speed of a very small shock (a so-called kinematic wave).

        Let us now consider a point B on the boundary B. This point (tB , xB ) describes the
    initial point of the characteristic curve. Next to the initial point, the curve is defined by

    its slope, which is by definition equal to the kinematic wave speed c = c(k, t , x) (see figure

    13.1). This gives us the following expression:

                       dx                             (13.4)
                           = c(k, t , x)

                       dt

    with:

                       x(tB ) = xB                    (13.5)

        Note that on the boundary we know the density k. If we are able to determine the
    change in the density along the characteristic from that point onward, we can determine
13.2. APPLICATION                                                                                             123

the    density    along    the  characteristic.   That  is,   we  want  to  establish  dk  .  We  get:
                                                                                       dt

                                               d k k k d x                                                    (13.6)
                                               d t = t + x d t

Since     along      the  characteristic,  we  have    dx  =  c,  we  can  rewrite:
                                                       dt

                                      d k k k                              Q
                                           d t = t + c x = r - s - x                                          (13.7)

with initial condition k(tB , xB ) = kB given. This ordinary differential equation shows                                 13
how the density changes along the characteristic. Considering all characteristics ema-
nating from the boundary should allow us to construct the density everywhere within
the interior of the boundary, at least at all points where the density is determined by the
conditions in the boundary (so-called region of influence of B).

13.1.2. APPLICATION TO HOMOGENEOUS ROADS

To further interpret these results, let us now consider a homogeneous road, i.e. Q(k, t , x) =
Q(k). Furthermore, no traffic enters or exits the road. In this case, Eq. (13.7) becomes:

                                                       dk                                                     (13.8)
                                                           =0

                                                       dt

This means that the derivative of the density along the characteristic is equal to 0, i.e.

the density is constant along the characteristic. Since k(tB , xB ) = kB , along the entire

characteristic we have k(t , x) = kB . In other words, the density is conserved along the

characteristic curve.

       Furthermore, the density is constant along the curve, so the kinematic wave speed

is  c  =  c (k )  =  Q  .  Since  by  definition  the  characteristic      curve  satisfies   dx  =  c,  the  slope  of
                     x                                                                        dt

the curve is under these conditions constant meaning that the curve is in fact a straight

line.

13.1.3. INTERPRETATION

The consequence from the mathematics described in section 13.1.1 is that traffic states
always propagate on lines in space-time moving with the speed of the derivative of the
fundamental diagram. This makes the construction of the characteristics very simple,
and the characteristics can be used to track back or forward traffic conditions in space
and time.

13.2. APPLICATION

Let us now see an application of the method of characteristics in the prediction of traffic
conditions. For this case, we will take the boundary B to be the initial conditions on an
infinite length roadway section. Two cases will be considered here: the first one where
traffic is dense upstream and in low density downstream (e.g., the moment a traffic light
turns to green). Also the different situation is considered, where traffic upstream is in a
low density condition and traffic downstream is in a high density condition.
    124                                        13. METHOD OF CHARACTERISTICS

                 Initial conditions at t = 0                         q                      dQ k1
    k                                                                                c k1 
                                                    0
          high density region                                                                     dk
                                                      dQ k2 
                                               c k2   dk

                           low density region

               k1          kc k2                                        0 k2 kc  k1  k

    (a) initial condtions                      (b) Fundamental diagram

13  c(k)

                     kc
           0 k2 k k

    (c) Characteristic speeds

    Figure 13.2: Traffic states and their characteristic speeds for an acceleration fan

    13.2.1. ACCELERATION FAN

    Consider a situation where upstream traffic is in an overcritical state (i.e., density is
    higher than the critical density) and downstream the traffic is in an undercritical state,
    see figure 13.2a. The characteristic speeds depend on the traffic density. For a concave
    fundamental diagram (see figure 13.2b) they are sketched in figure 13.2c.

        For each of the states at the initial position the density is determined. For that den-
    sity, the characteristic speed is determined, i.e., the derivative of the fundamental dia-
    gram at that density. Note once more that these speeds are not the speeds of the vehilces
    in that traffic state. Figure 13.2c sketches the characteristic speed. The traffic states now
    propagate with that speed. This means that states in the free flow condition propagate in
    the forward direction, whereas congested traffic states move in the backward direction.
    The capacity state moves at a speed zero, so remains at the same location.

        The characteristic curves and their speeds are shown in figure 13.3. Due to the con-
    cavity of the fundamental diagram, these lines spread out. The area over which the den-
    sity changes hence take place increases. Because the lines are straight, the increase is
    linear over time. Because of the pattern, this phenomenon is also called an acceleration
    fan.

        Note that the analysis here is based on a concave fundamental diagram. If a trian-
    gular fundamental diagram would be used, one might argue there are only two waves:
    one moving forward with the free flow speeed and one moving backward with the wave
13.2. APPLICATION                                                     125

                                   x k2 > kc

                   density      k2                    trajectory
                                              uc (speed at capacity)
                            kc

                            k1
                                                               u(k1)
                                                                                                            t            13

                                                            k1 < kcdensity
                        k2
Figure 13.3: The kinematic waves (or characteristic curves) for an traffic situtation where the upstream traffic
state is overcritical and the downstream traffic state is undercriticalk1 kc

                                                         x

                                                                                                  intersecting
                                                                                                characteristics?

                                                                                        One point (x,t) with two values
                                                                                        Shockwave!
                                                                                        Use shockwave theory there!

                                                                                                        t

Figure 13.4: Illustration of the characteristics in space-time for an deceleration

speed. This would leave a void in conditions at the area in between these waves. It
is better to consider a triangular fundamental diagram as a continuously differentiable
fundamental diagram which happens to change curvature very slowly on the branches
and very quickly at the top. In that case, the same analysis can be done.

    In case of a traffic light, the density drop can be sudden, where upstream of the traffic
light the traffic is in jam density and downstream the road is empty. Then, this could be
approximated by a smooth curve with a very sharp decrease of density with an increase
of space at the stop line. Then, one could apply the same analysis, yielding the same
characteristic curves expanding, now all from the location of the stop line.

13.2.2. DECELERATION

A similar construction can be made for a deceleration wave. The difference is that in this
case the upstream traffic states have a higher density than the downstream ones. The
traffic states with higher densities, in this case the downstream states, have lower char-
acteristic speeds (see figure 13.2b). See figure 13.4 shows the characteristics in space
time. In case of a deceleration, the upstream characteristics travel faster than the down-
stream characteristics, leading to intersecting characteristics. Since each characteristic
    126  13. METHOD OF CHARACTERISTICS

    curve represent a traffic state, crossing characteristics would mean having two traffic
    states at the same place at the same time.

        If the characteristics cross, one has to revert to shockwave theory. Each of the char-
    acteristics indicates a certain traffic state. If these two traffic states meet, one has a shock
    for which the speed is known (see section 4).

    SELECTED PROBLEMS

    For this chapter, consider problems: 145, 146, 147, 216, 269

13
  14

HEADWAY MODELS

This section discusses headway models. In this chapter, the headway is always the time
headway.

14.1. RELATION BETWEEN HEADWAY AND CAPACITY

The headway distribution describes which headways can be observed with which prob-
ability. One might argue that this is related to the flow, since the average headway is
the flow. The flow is determined by the demand. However, in the bottleneck the flow is
determined by the minimum headway at which drivers follow each other. Or in other
words, the headway distribution determines the capacity in the bottleneck. Suppose the
headway distribution is given by P (h). Then, the average headway can be determined by

             inf    (14.1)

h = hP (h)d h

            0

This is a mathematical way to describe the average headway once the distribution is
given. The flow in the active bottleneck, hence the capacity is the inverse of the mean
headway, see table 1.1:

C = 1/ hbottleneck  (14.2)

    The number of vehicles arriving in a certain period could be a useful measure. This
holds for instance for traffic lights, where the number of arrivals per red period is rele-
vant. As illustrated in figure 14.1, there could be different lanes for different directions at
a traffic light. The idea is that the traffic towards one direction will not block the traffic to
other directions, hence, the length should be long enough to allow the number of vehi-
cles in the red period. The average number of vehicles in a red period can be determined
from the flow. However, mostly requirements are that in p% of the red times (under a
constant demand) the queue should not exceed the dedicated lane. In that case, the
distribution of number of arrivals in that period can form the basis for the calculations.

127
    128                                                                 14. HEADWAY MODELS

14  Figure 14.1: A queuing area. The orange coloured vehicles turn right, whereas the blue ones continue straight

    Table 14.1: The different processes and the underlying assumptions

    Process characteristic          Headway dist                        Dist of nr of arrivals per interval
    Independent arrivals            Exponential                         Poisson
    Correlated arrivals                                                 Binomial
    Negatively correlated arrivals                                      Negative binomial

    Table 14.2: Overview of the means and variances of the different distribtions. In this table, q is the flow in the
    observation period, p is the probability of including the observation in the period.

    Distribution       Mean         Variance      =mean
    Poisson            q                          <mean
    Binomial           np           q             >mean
    Negative binomial  n(1 - p)/p   np(1 - p)
                                    n(1 - p)/p2
14.2. ARRIVALS PER INTERVAL                                                                                 129

                                                            Poisson distribution function
                              0.7

                                                                                           flow=100 veh/h

Probability density function  0.6                                                          flow=200 veh/h

                                                                                           flow=500 veh/h

                              0.5                                                          flow=1000 veh/h

                                                                                           flow=1500 veh/h

                              0.4

                              0.3

                              0.2

                              0.1

                              0
                                            0 1 2 3 4 5 6 7 8 9 10
                                                                Number of vehicles

Figure 14.2: Example of the Poisson distribution for different flow values; the flow is indicated in veh/h, and
these are the probabilities for arrivals in 15 seconds

14.2. ARRIVALS PER INTERVAL                                                                                         14

This section describes the number of arrivals per time interval. For different conditions,
this distribution is different. Table 14.2 gives an overview of the distributions described
in this section, and gives some characteristics. One should differentiate between the
probability of number of arrivals (a macroscopic characteristic, based on aggregating
over a certain duration of time), described in this section, and the probability of a head-
way (a microscopic characteristic, described in section 14.3).

14.2.1. POISSON

The first distribution function described here is the Poisson distribution. One will ob-
serve this distribution function once the arrivals are independent (see also section 14.3.1).
The resulting probability is described by a so-called Poisson distribution function. Math-
ematically, this function is described by:

                                   P (X = k) = q e k -q .                                                   (14.3)
                                                   k!

This equation gives the probability that k vehicles arrive if the average arrival rate per
period is q. Hence note that one needs to rescale q to units of number of vehicles per
aggregation period!

    As example, consider a flow of 600 veh/h with independent arrivals. What is the prob-
ability to have 7 vehicles arriving in a period of 30 seconds? Answer: we first rescale the
flow to the same interval as the period of interest, i.e. 30 seconds. We find q=600 veh/h
= 5 veh/30 seconds. Now, applying equation 14.3, we find the probability of finding 7
vehicles in the observation interval:

                                   P (X = 7) = 5 e 7 -5 = 0.104                                             (14.4)
                                                  7!

So in this example, there is a 10.4% chance that 7 vehicles arrive in this period.
    Figure 14.2 shows examples of the Poisson distribution. Note that for low values

of the flow (expected value smaller than 1), the probability is decreasing. If the flow is
higher, there is a maximum probability at a number of arrivals which is at a higher value
than 1.
    130                                                                                                                     14. HEADWAY MODELS

    Figure 14.3: Illustration of the number of arrivals from real world data

                                                               Binomial distribution function
                                  0.5

                                       N=2, p=0.42, flow= 200 veh/h

    Probability density function       N=8, p=0.10 . flow=200 veh/h

                                  0.4  N=8, p=0.52 , flow=1000 veh/h

                                  0.3

                                  0.2

                                  0.1

14                                0
                                                0 1 2 3 4 5 6 7 8 9 10
                                                                    Number of vehicles

    Figure 14.4: Examples of the binomial distribution function for the number of arrivals in an aggregation period,
    conceptual idea from Hoogendoorn (2005)

        Figure 14.3 shows the best fits of this distribution on real life data. This distribution
    is accurate if the flow is low, and is not so good if the flow increases. This is because
    once the flow is high, the assumption of independent arrivals does not hold any more.
    Once vehicles are bound by the minimum headway, the arrivals are not independent any
    more. This restriction come more into play once the flow is high.

    14.2.2. BINOMIAL

    The binomial distribution can be used if there are correlations between the arrivals. For
    instance on busy roads, one can expect that more vehicles drive at a minimum headway.
    Whereas in case of the Poisson distribution, the variance of the distribution was equal
    to the mean, in this case the variance is smaller (since more drivers drive at a certain
    headway). The mathematical equation describing the function is:

                                                                                               P (X = k) = n pk (1 - p)n-k  (14.5)
                                                                                                               k

        The idea behind the distribution is that one does n trial, each with an independent
    success rate of p. The number of successes is k. The mean of the distribution is np, see
    table 14.2. A certain flow specifies the mean of the arrivals, which hence determines np.
    This gives a freedom to choose n or p, by which one can match the spread of the function.
    The number of observations in the distribution can never exceed n, so an reasonable
    choice of n would be the interval time divided by the minimum headway. Figure 14.4
    shows examples of the binomial distribution function.

        Note that the variance of the binomial function is smaller than the Poisson distribu-
    tion for the same flow. This can be a reason to choose this function.
14.3. HEADWAY DISTRIBUTIONS                                                                                         131

                                                                           Negative binomial distribution function
                                                      1

                                                           R=0.83, p=0.5, flow= 200 veh/h

                        Probability density function       R=0.21, p=0.8, flow=200 veh/h

                                                      0.8  R=4.17, p=0.5 , flow=1000 veh/h

                                                           R=1.04, p=0.8. flow=200 veh/h

                                                      0.6

                                                      0.4

                                                      0.2

                                                      0
                                                                    0 1 2 3 4 5 6 7 8 9 10
                                                                                        Number of vehicles

Figure 14.5: Example of the negative binomial function for the number of arrivals in an aggregation period

14.2.3. NEGATIVE BINOMIAL

The negative binomial distribution can be used if there are negative correlations be-

tween the arrivals. In traffic this happens for instance downstream of a signalised inter-

section. If one observes several vehicles at a short headway, one gets a larger probability

that net next headway will be large because the traffic light will switch to red.

     The probability distribution function for the number of observed vehicles in an ag-                                    14

gregation interval is:

                                                           P (X = k) = k + r - 1 pk (1 - p)r                        (14.6)
                                                                                k

This distribution describes when one observes individual and independent process with
a success rate of p. One observes so until r failures are observed. X is the stochast
indicating how many successes are observed.

    Figure 14.5 shows the value of this function for different parameter sets. Note that the
variance (and hence standard deviation) can be set independently from the mean, like
in the binomial distribution function. For this distribution (see table 14.2), the mean is
given by n(1 - p)/p, and the variance is given by n(1 - p)/p2, which is the mean divided
by p. Since p is a probability and has a value between 0 and 1, we can derive that the
variance is larger than the mean. A larger variance is what one would intuitively expect
downstream of a signalised intersection. This characteristic can be used to have an idea
of the distribution to use.

14.3. HEADWAY DISTRIBUTIONS

In this section the exponential headway distribution is described, used with indepen-
dent arrivals, and composite headway models.

14.3.1. EXPONENTIAL

The first distribution is the exponential distribution, shown in figure 14.7. This is defined

by:

                                                           P (h|q) = q exp -qh                                      (14.7)

Note that this equation has a single parameter, being the flow q. That is the inverse of the
average headway. The underlying assumption of this distribution is that all drivers can
choose their moment of arrival independently. Consider that each (infinitesimal small)
    132                                                                                                                   14. HEADWAY MODELS

                                                                 Exponential distribution function
                                       35

                                                                                                    flow=100 veh/h

                                                                                                    flow=200 veh/h

                                       30                                                           flow=500 veh/h

                                                                                                    flow=1000 veh/h

                                                                                                    flow=1500 veh/h

         Probability density function  25

                                       20

                                       15

                                       10

                                       5

                                       0   0  0.1  0.2  0.3                                         0.4              0.5

                                                   Headway (s)

    Figure 14.6: The probability density function for headways according to the exponential distribution for differ-
    ent flow values

14  time step a driver considers to leave with a fixed probability. One then gets a exponential
    distribution function for the headway.

        This is a very good assumption on quiet roads, when there are no interactions be-
    tween the vehicles. The interactions occur once vehicles are limited in choosing their
    headway, mostly indicated by the minimum headway. An illustration how this works out
    for a real life case is shown in figure 14.3 for the number of arrivals (see section 14.2.

        The only good way to test whether the exponential data describes the data one ob-
    serves is to do a proper statistical test (e.g., a Kolmogorov-Smirnov test). There are also
    rules of thumb. A characteristic for this distribution is that the standard deviation is
    equal to the mean. If one has data of which one thinks the arrivals are independent and
    this criterion is satisfied, the arrivals are very likely to be exponentially distributed.

        This distribution function for the headways matches the Poisson distribution func-
    tion for the number of arrivals.

    14.3.2. COMPOSITE HEADWAY MODELS

    Whereas the exponential distribution function works well for low flows, for higher flows
    the distribution function is not very good. For these situations, so called composite
    headway distributions are being used (see for more information Hoogendoorn (2005)).
    The basic idea is that a fraction of the traffic  is driving freely following a headway dis-
    tribution function Pfree(h). The other fraction of the traffic 1- is driving constraint, i.e.
    is following their leader, and have a headway distribution function Pconstraint(h).

        In a composite headway distribution, these two distribution functions are combined.
    The combined distribution function can hence be expressed as

         P (h) = Pfree(h) + (1 - )Pconstraint(h)                                                                          (14.8)

    Given the reasoning in section 14.3.1, it would make sense to choose an exponential
    distribution function for the free headways.

        A plot of the headway distribution function (in fact, a survival function of the head-
    way, i.e. 1- the cumulative distribution function) is shown in figure 14.7. The vertical
    axis is a logarithmic axis. Note that in these axis the exponential distribution function is
14.4. CRITICAL GAP                                                                                133

Figure 14.7: Example of the composite headway distribution and its estimation for real life data

                                                                                                       14

                                            (b) Overtaking

(a) Turning onto a road which has priority
Figure 14.8: Examples of critical headways

a straight line. That is what is observed for the large headways. For the smaller headways
(in the figure, for less then 7 seconds) this does not hold any more. This is due to the lim-
itation of following distance. As the figure shows, this can be determined graphically. In
the right figure, you find the observation frequency of the constraint drivers (dark line),
and all drivers (the light line). Note how the distribution for all drivers is higher for larger
headways and (almost) all short headways are for constraint drivers.

14.4. CRITICAL GAP

The critical gap is the smallest gap (time gap) that a vehicle accepts to go into. Some
examples are given in section 14.4.1. The relation with the inflow capacity is discussed
in section 14.4.2.

14.4.1. SITUATIONS

Examples of situations where the critical gap is relevant, are vehicles turning onto a road
where one has to give priority, overtaking, merging into the traffic stream or lane chang-
ing. Some of them are shown in figure 14.8.

    The critical gap is defined in the flow. Note that the critical gap differs per person, as
well as per situation. One might have a small critical gap to merge into a traffic stream
moving at slow speed.

    For overtaking, the critical gap (measured in headway in the opposite traffic stream)
needs to be larger because the traffic is moving in the opposite direction. For instance, if
    134                                                            14. HEADWAY MODELS

    a driver spends 3 seconds in lane for traffic in the direction for an overtaking manoeuvre,
    during that time the opposing vehicles also move in the direction of the overtaking vehi-
    cle. To find the critical (time) gap, one needs to consider the distance the overtaker uses
    at the other lane (overtaking time times speed) - this is the space the overtaker would
    need if the opposing vehicles were stationary. To this, one should add the distance the
    opposing traffic moves in the overtaking time (overtaking time times the speed of the
    opposing vehicles). This combined distance gap (plus arguably a safety margin) can be
    translated into a time gap. Since one measures the gap as headway in the opposing traf-
    fic, one needs to divide the required space gap by the speed of the opposing traffic.

14  14.4.2. INFLOW CAPACITY

    Consider the situation as in figure 14.8a. Consider that the main line traffic (traffic from
    left to right) has a headway distribution of P (h), and there is an infinite line of vehicles
    waiting to enter the road, all with an critical gap g c. One can calculate how many vehi-
    cles can enter the road per unit of time, as will be shown below.

        We know that for certain gaps, vehicles can enter. The first step is to find the number
    of gaps which pass per unit of time. That equals the number of vehicles (each vehicle
    causes one new gap). The number of vehicles per unit of time is the flow, which is the
    inverse of the mean of the headway, which in turn can be calculated from the headway
    distribution.

        Then, for all headways larger than the critical gap, but smaller than twice the critical
    gap one vehicle can enter. The frequency that this happens is the flow (=gap rate) times
    the probability that the gap is this size, determined from integrating the probability den-
    sity function of the headway over the right headways:

                                               2g c

                             qin1 vehicle = q        P (h)d h                  (14.9)

                                               gc

        The probability that in one gap two vehicles can enter is the integral of the probability

    density function for the headways from twice the critical gap to three times the critical

    gap. The rate at which these gaps occur is the flow q, so the rate at which these gaps
    occur is q 2gc 3gc P (h)d h. Per gap, two vehicles enter, so the matching inflow is

                                                   3g c

         qin2 vehicles = 2q                              P (h)d h              (14.10)

                                               2g c

         One can continue this reasoning and find an equation for the inflow:

                                                         (n+1)g c

         qintotal =          qinn vehicles = nq                    P (h)d h    (14.11)

                          n                    n         ngc

    This can numerically be evaluated.
        Typically, one would expect the headway in the order of twice the minimum head-

    way. Namely, after merging, one would like to have at least a minimum headway up-
    stream (lag gap) and a minimum headway downstream (lead gap).

        In the calculation of the maximum inflow, the headway distribution function plays
    an important role. As an extreme example, suppose that all headways are equal at 99% of
14.4. CRITICAL GAP                                                                                                                              135

                                                  Comparison Capacity Formulas Single-lane Roundabout

                    Entry Capacity [pcu/h]                       with tC = 4.1 s, tF = 2.4 s en tM =2 s .

                                            1800
                                                                                                                   Siegloch

                                            1600  Tanner [= Troutbeck =(1 -

                                            1400  tmqr)]

                                                                                                                   Troutbeck  = 0,8(1 - tmqr )
                                            1200 Wu

                                            1000  Akelik kd=1

                                            800

                                            600

                                            400

                                            200

                                            0

                                              0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200

                                                                                                          Circulatory Volume QR [veh/h]

Figure 14.9: The inflow onto a road (or roundabout) as function of the main road (roundabout) traffic - figure
from Fortuijn and Hoogendoorn (2015)

the critical gap. Then, the flow is at about half the capacity of the road, but the inflow is 0.                                                     14
For different distribution functions it can be calculated what is the maximum inflow on
the main road. This is shown in figure 14.9 for different functions. It shows that the inflow
capacity decreases with the main road flow. However, the precise type of distribution
matters less: the graphs for the different distribution functions are quite similar.

SELECTED PROBLEMS

For this chapter, consider problems: 38, 39, 40, 160, 186, 187, 231, 239
        15

TRAFFIC STATE DYNAMICS IN THREE

                            REPRESENTATIONS

Traffic can be described by a fixed relation between X , N and T . The most common
way to describe traffic is the N -model using Eulerian coordinates, which describes the
number of vehicles (N ) that have passed location x at time t . Another well-known rep-
resentation is the X -model in Lagrangian coordinates, which describes the position (X )
of vehicle n at time t . The third and least common representation is the T -model, which
describes the time (T ) at which vehicle n crosses location x (Laval and Leclercq (2013)).
All three models describe the same traffic state, for example the situation shown in fig-
ure 15.1. The example displays the journey of around 75 vehicles on a single lane road.
The 5th vehicle stops for around 60 time steps and creates a jam, which slowly dissolves.
With use of this example, the describing parameters, characteristics and shockwave the-
ory in the 3 different approaches are described in the following sections.

                            3dim Traffic State

Time  200
      150
      100                   00                                                               1000
       50                                                               500
                                                                      Space
         0
      100

                        50
           Nr of vehicles

Figure 15.1: Example of a traffic situation, expressed in x, n and t

                            137
    138        15. TRAFFIC STATE DYNAMICS IN THREE REPRESENTATIONS

    Table 15.1: Variables used in different coordinate systems

               N (x, t ) X (n, t ) T (n, x)

         /d t q(x, t ) v(n, t )

         /d x -k(x, t )                                         p(n, x)

         /d n                                    -s(n, t ) h(n, x)

    Table 15.2: Overview of parameters            N(x, t)       X (n, t )    T (n, x)
                                                     x              n            n
                       1st explanatory variable       t             t            x
                       2nd explanatory variable     -k             -s            p
                       Independent variable          q              v            h
                       Dependent variable
                       FD                          Q (k )         V (s)       H (p )
                       Trajectories                iso-n          iso-x       iso-t
                       slope trajectories         d t d x = v    d t dn = q  d x dn = -s
                       vertical distance         N x = - k1     n X = -k     T x = v
                       horizontal distance        N t = q1      X t = p      T n = q

15  15.1. DESCRIBING PARAMETERS

    In the different models, the traffic state are explained in different combinations of x, n
    and t . The derivatives of these parameters give a first insight to the important variables.
    For example, the change in vehicle number n with time t is the flow q and the change
    of vehicle number n with space x is the density k. An overview of the other variables are
    presented in table 15.1. The pitfall in determining the derivatives are the correct signs,
    which originate from the convention of the scales. The convention of space can be either
    positive or negative, but time is always positive. For vehicle number, the convention is
    that the first vehicle on a road has the lowest n number. As a result, the higher vehicle
    numbers correspond to lower x values, and the derivative d N /d x has a minus sign.

        In the sequel of this chapter, the equivalencies of the representations will be shown,
    as well as how they can be used. We will be using that similar equations allow to use
    the same answers and computation schemes. Table 15.2 summarizes the comparisons
    which will be explained in the following sections.

    15.2. N-MODEL

    The most common way to describe traffic is the N-model. In this model the flow q is
    proportional to the density k and speed u, with q = ku. A fundamental diagram can be
    drawn for flow where density is the main variable to determine the flow. In the remainder
    of this chapter we will be using the triangular fundamental diagram.

        Trajectories in the N-model are iso-n lines which represent the movement of an indi-
    vidual vehicle in time and space. The XT-diagram in Figure 15.2b shows model output of
    around 75 vehicles driving on a 1 lane road, which is the same situation as in Figure 15.1.
    The 5th vehicle stops at x = 450 for around 60 timesteps, causing a jam. The trajecto-
15.3. X-MODEL                                                                  139

(a) Fundamental diagram for the N-model                (b) XT-diagram and iso-n lines, with 3 trajectories. The colors
                                                       indicate the vehicle number.

Figure 15.2: Representation of traffic in the N-model

ries of 3 cars are isolated, the first having an undisturbed path, the second trajectory is

stationary for around 40 timesteps before continuing its path, and the third trajectory is

stationary at a smaller x-location for a shorter time period. This indicates that the jam

grows in the -x direction, and that the queue length dissolves with time. In this model

data, but also in observed trajectory data, the vertical distance between two trajecto-

ries provides information about the density, using             x     = - 1k .  The horizontal distance                  15
                                                               N
                                                         t     q1 .
between  trajectories  is  a  measure    for  the  flow  N  =

Assuming that all vehicles that enter a certain road stretch also have to exit the road

stretch within a certain amount of time, it can be stated that the number of vehicles

are conserved. Hence, with no sinks and sources, the conservation equation (earlier

generally stated in equation 13.1) is given by:

                                              k q                              (15.1)
                                              t + x = 0

This states that the change in density k with time t and the change of flow q with distance
x should equal out to zero.

15.2.1. SHOCKWAVE THEORY IN THE XT-PLANE

By combining trajectory data and the fundamental diagram, it is possible to identify traf-
fic states. These traffic states are a combination of density and flow, for example, jam
state or capacity state. Figure 15.3 shows an example the traffic states which are iden-
tified using the fundamental diagram. Here, the example is given. A full explanation is
given in chapter 4.

15.3. X-MODEL

The most useful description mathematically is the X-model. In this case, X is being de-
scribed as function of n and t. In this representation, the fundamental diagram describes
the speed V based on the spacing s. The shape of V (s) is presented in Figure 15.4a and
has the following properties:
    140  15. TRAFFIC STATE DYNAMICS IN THREE REPRESENTATIONS

15       (a) XT-diagram with different traffic states

                                          (b) Fundamental diagram with different traffic states

    Figure 15.3: Shockwave Theory in the N-model, with different traffic states, A = inflow, B = jam, C = Capacity, D
    = empty road
15.3. X-MODEL                                                               141

 A speed of 0 between the origin s = 0 and the jam spacing s j

 A congestion branch where speed increases with spacing. This state occurs when
  s j < s  sc , the angle of increase is equal to  = 1/(w k)

 A free flow branch where the speed is maximum and continuous (v f ). This state
  occurs when spacing exceeds the critical value s > sc

 A critical spacing sc which is the minimum value for spacing with maximum speed
  (v f )

From the perspective of the X-model, the traffic situation of Figure 15.1 is visualized

in the NT diagram 15.4b. Looking horizontally in the plot, there is a continuous increase

in distance (colors) for the first vehicles, indicating that they have an undisturbed jour-

ney. Vehicle nr 20 is positioned on 1 location for a period of time, so it experiences a

delay due to a jam. The length of the jam is not visible in this representation, only the

delay it causes. The delay is largest for the lower vehicle numbers (but >5) and decreases

with time for higher vehicle numbers, indicating that the jam is slowly dissolving. Fur-

thermore, the delay starts at a distance around 400m (green color) and changes to blue

colors with time, indicating that the jam is moving in the -x direction.

Trajectories in the X-model are iso-x lines. It tracks how many vehicles have crossed

a fixed location with time, in other words, every trajectory is cumulative curve. The

three indicated trajectories in Figure 15.4b are cumulative curves for approximately x =        15

100, x = 400 and x = 600.

From the NX diagram, also other traffic variables can be estimated. The vertical dis-

tance between two trajectories is a measure for density    n  = -k  = - 1s  and the horizontal
                                                           X
                                           t         v1 .
distance can be used to estimate the pace  X  =p  =

    Based on the assumption that vehicles cannot disappear from the road, a continuity
equation can be retrieved. The continuity equation for the X-model is:

                           s v                                              (15.2)
                           t + n = 0

which states that the change in spacing s with time t and the change of speed v with
vehicle number n summed should be to zero.

    The description in the X-model is also called a Lagrangian coordinate system. In this
system, the coordinates move with the traffic. This is opposed to a system where coor-
dinates are fixed, which we call a Eulerian coordinate system. In this representation, we
describe the position of the Nth vehicle; for a discretisation of N =1, we hence have a
microscopic model. Also for other values of N , there is an easy linking of the micro-
scopic to the macroscopic variables, since the vehicle movements are described. Table
15.3 shows the comparison of the two coordinate systems.

    Since the equations are similarly formed, similar solution techniques can be done
in this representation as in the N-model. As with the other representations, shockwave
theory will be discussed. Due to the importance and the mathematical advantages of
a numerical scheme, for this representation also numerical simulation scheme is pre-
sented, similar to the cell transmission model: see section 10.3.
    142  15. TRAFFIC STATE DYNAMICS IN THREE REPRESENTATIONS

15                                                                                       (b) NT-diagram and iso-x lines, with 3 trajectories. The colors
                                                                                         indicate the location x.

     (a) Fundamental diagram for the X-model

    Figure 15.4: Representation of traffic in the X-model

    Table 15.3: The variables in the Lagrangian formulation

         Variable       Euler                                Lagrange
         Traffic state  Flow q                               Speed v
                        Density k                            Spacing s
         Variable       space                                vehicle number
                        time                                 time
15.4. T-MODEL  143

 (a) NT-diagram with different traffic states                                                                                               15

                                                                                     (b) Fundamental diagram with different traffic states

Figure 15.5: Shockwave Theory in the X-model, with different traffic states, A = inflow, B = jam, C = Capacity, D
= empty road. Traffic state D is infinitely small.

15.3.1. SHOCKWAVE THEORY IN THE NT PLANE

Similar to Shockwave Theory in the N-model, it is possible to also identify traffic states
in the X-model. This is done by combining the trajectory data in the NT-plane with the
fundamental diagram, as shown in Figure 15.5. Four states can be identified: Inflow
A, jam B, capacity C and empty road D. The steps to identify traffic states is similar to
the shockwave theory in the XT-plane, with 1 exception. The spacing on an empty road
can be infinitely large, so state D does not have an exact position in the fundamental
diagram. Since the spacing at D is infinitely large, the shock between jam B and empty
road D is horizontal in the limit. Furthermore, the size of the shock is infinitely small,
so it is invisible in the NT-diagram. The connecting line between inflow state A and jam
state B, indicates how fast the jam is growing, whereas the connection line between jam
state B and capacity state C, gives information on how the jam dissolves.

    In summary these are the main advantages of the Lagrangian formulation are:

      "Easy" numerical discretization (simulation)

      Accurate simulation results

      Fast simulation

      Trajectories of (individual) vehicles come out by default

15.4. T-MODEL

The variables used to describe traffic states in the T-model are pace p and headway h.
The properties of the fundamental diagram for headway as function of pace H (p) are:

      There is a capacity state at a minimum pace pc where headway is minimum Hc at
        H = 1/C
    144                    15. TRAFFIC STATE DYNAMICS IN THREE REPRESENTATIONS

          Headway increases from Hc to infinity in the free flow branch, so it is a vertical line
           at p = 1/v f

          Headway increases with pace in the congested branch with angle which equals
           1/k j

          For high values of pace (=low speed), the headway increases to infinity

         The traffic state in the T-model is represented in the NX-plane, see Figure 15.6. In this

    graph, the colors represent the time, so a jump in colouring indicates the boundary to a

    different traffic state. A horizontal line in the NX diagram gives the time at which all ve-

    hicles cross a certain location, so the vertical color jump indicates that there is an empty

    road. A vertical line in the NX diagram follows 1 vehicles and give the time at which that

    vehicle passes a certain position. The color jump in vertical direction indicates that the

    vehicle takes a longer time than usual before reaching the next position, so it is caught

    in a jam. The extent of the color jump indicates the magnitude of the jam. A large jump

    equals a large delay.

         Trajectories in the T-model are iso-t lines which are basically snapshots. It provides

    the position of all vehicles on the road at a certain time step. The orientation of the line

    is from the upper left to the lower right, which is opposite to the trajectories in the other

    two models. The different orientation is a result of the convention of scale in vehicle

15  number, as mentioned in section 15.1. The example trajectory nr 2 in Figure 15.6b in-

    dicates that the first 5 vehicles are situated around 800 distance, followed by an empty

    road. Then, approximately 5 vehicles are going at capacity flow between 550 to 450 dis-

    tance, while 10 vehicles are trapped in a jam around distance 400. Finally, 10 vehicles are

    situated between distance 0 and 375 in the `normal' or initial traffic state. It is difficult to

    see in this example, but the slope of trajectory is smallest (least negative) in the capacity

    state. In general, the vertical distance between two trajectories is an estimation of speed

    x  =v  =  1  while the horizontal distance is a measure for the flow  n  =q  =  h1 .
    T         p                                                           T

         Assuming that no vehicles disappear from the road, the continuity equation for the

    T-model is given by:

                           p h
                           n - x = 0

    stating that the change of pace p with vehicle number n should be equal to the change
    in headway h with distance x.

    15.4.1. SHOCKWAVE THEORY IN THE NX-PLANE

    Due to the opposite orientation of the trajectories, the fundamental diagram needs to
    be adjusted before shockwave theory can be applied. Since the free flow branch of the
    H (p) is vertical, it is sufficient to only reflect the congested branch in the line H = Hc ,
    resulting in a line with angle -q. This line is partially drawn in Figure 15.7b, with jam
    state B' located at minus infinity.

        Returning to the XN-diagram, two traffic states are easily recognized due to the jumps
    in color, with initial state A in the lower part and the capacity state C in the upper right
    part. In between these states, two infinitely small traffic states exists. State D indicates
    the empty road, and state B indicates the jam state. The headway for an empty road and
15.5. DISCUSSION                                       145

                                                       (b) XN-diagram and iso-t lines, with 3 trajectories. The colors
                                                       indicate the time.

(a) Fundamental diagram for the T-model

Figure 15.6: Representation of traffic in the T-model

at stand still are both infinitely large, therefore the states B and D are not physical points                          15
in the fundamental diagram, but indicated with the arrows. Because the jam state is
infinitely large, the shockwave of the jam (B) with the inflow (A) and outflow (C) are par-
allel, with an infinitely small area in between. A similar reasoning holds for the empty
road state D, which is situated in between the initial state A and capacity state C.

    Only the tail of the queue is visualized in the NX-diagram, and not the queue itself.
This is because stopped vehicles do not move in X and therefore are not visualized. Only
in the time step where they start to move again, the vehicles are visualized in the next
state. The tail of the jam moves in -x direction with slope - = - k1j , so it depends on the
jam density only. In this example, the tail of the jam grows till it reaches the beginning
of the road. If the jam had dissolved sooner, there would have been another vertical
shock between capacity state C and inflow state A, at the vehicle number that does not
experience any delay anymore.

    Although shockwave theory can be applied in this representation, it does not provide
extra information. The occurrence of a jam can be identified from this graph and the
growth of the jam in space can be estimated. However, it is impossible to identify when
the congestion will be dissolved. This is a disadvantage of this representation.

15.5. DISCUSSION

In summary, the N-model is more intuitive and easy to understand. The X-model is
mathematically easier but more difficult to interpret. The X-model is difficult to grasp
and does not yet have clear benefits. Table 15.2 provides an overview of the main pa-
rameters used in the different representation.

SELECTED PROBLEMS

For this chapter, consider problem: 276.
    146  15. TRAFFIC STATE DYNAMICS IN THREE REPRESENTATIONS

15       (a) XN-diagram with different traffic states

                                          (b) Fundamental diagram with different traffic states

    Figure 15.7: Shockwave Theory in the T-model, with different traffic states, A = inflow, B = jam, C = Capacity, D
    = empty road. Traffic state B and D are infinitely small.
                              REFERENCES

Ahn, S. and Cassidy, M. (2007). Freeway traffic oscillations and vehicle lane-change ma-
   neuvers. In Allsop, R. E., Bell, M. G. H., and Heydecker, B. G., editors, Proceedigs of the
   International Symposium of Transportation and Traffic Theory, pages 691-710. Else-
   vier, Amsterdam.

Aw, A. and Rascle (2000). Resurrection of the "second order" models of traffic flow. SIAM
   Journal on Applied Mathematics, 60:916-938.

Bando, M., Hasebe, K., Nakayama, A., Shibata, A., and Sugiyama, Y. (1995). Dynamical
   model of traffic congestion and numerical simulation. Physical Review E, 51(2):1035.
   Copyright (C) 2007 The American Physical Society Please report any problems to
   prola@aps.org PRE.

Bliemer, M. (2007). Dynamic queuing and spillback in analytical multiclass dynamic
   network loading model. Transportation Research Record: Journal of the Transportation
   Research Board, (2029):14-21.

Brackstone, M. and McDonald, M. (1999). Car-Following: A Historical Review. Trans-
   portation Research F, 2:181 - 186.

Carlson, R. C., Papamichail, I., Papageorgiou, M., and Messmer, A. (2010). Optimal mo-
   torway traffic flow control involving variable speed limits and ramp metering. Trans-
   portation Science, 44(2):238-253.

Cassidy, M. and Bertini, R. (1999). Some traffic features at freeway bottlenecks. Trans-
   portation Research Part B: Methodological, 33(1):25 - 42.

Cassidy, M., Jang, K., and Daganzo, C. (2011). Macroscopic fundamental diagram for
   freeway networks: Theory and observation. In Proceedings of the 90th Annual Meeting
   of the Transportation Research Board.

Cassidy, M. J. and Rudjanakanoknad, J. (2005). Increasing the capacity of an isolated
   merge by metering its on-ramp. Transportation Research Part B: Methodological,
   39(10):896 - 913. ISSN 0191-2615.

Chiabaut, N., Leclercq, L., and Buisson, C. (2010). From heterogeneous drivers to
   macroscopic patterns in congestion. Transportation Research Part B: Methodological,
   44(2):299 - 308. ISSN 0191-2615.

Chung, K., Rudjanakanoknad, J., and Cassidy, M. J. (2007). Relation between traffic den-
   sity and capacity drop at three freeway bottlenecks. Transportation Research Part B:
   Methodological, 41(1):82-95.

                                                         147
    148  REFERENCES

15  Corthout, R., Fltterd, G., Viti, F., and Tampre, C. M. (2012). Non-unique flows in
       macroscopic first-order intersection models. Transportation Research Part B: Method-
       ological, 46(3):343-359.

    Courant, R., Friedrichs, K., and Lewy, H. (1928). ber die partiellen differenzengleichun-
       gen der mathematischen physik. Mathematische annalen, 100(1):32-74.

    Daganzo, C. (2007). Urban gridlock: Macroscopic modeling and mitigation approaches.
       Transportation Research Part B: Methodological, 41(1):49-62.

    Daganzo, C. F. (1994). The Cell Transmission Model: a Dynamic Representation of High-
       way Traffic Consistent With the Hydrodynamic Theory. Transportation research part
       B, 28B(4):269-287.

    Daganzo, C. F. (1995a). The cell transmission model, part ii: network traffic. Transporta-
       tion Research Part B: Methodological, 29(2):79-93.

    Daganzo, C. F. (1995b). Requiem for second-order fluid approximations of traffic flow.
       Tranportation Research Part B: Methodological, 29:277-286.

    Daganzo, C. F. (1997). Fundamentals of Transportation and Traffic Operations. Perga-
       mon.

    Daganzo, C. F. (2002a). A behavioral theory of multi-lane traffic flow. part i: Long homo-
       geneous freeway sections. Transportation Research Part B: Methodological, 36(2):131
       - 158. ISSN 0191-2615.

    Daganzo, C. F. (2002b). A behavioral theory of multi-lane traffic flow. part ii: Merges and
       the onset of congestion. Transportation Research Part B: Methodological, 36(2):159 -
       169. ISSN 0191-2615.

    Daganzo, C. F. (2005). A variational formulation of kinematic waves: basic theory
       and complex boundary conditions. Transportation Research Part B: Methodological,
       39(2):187-196.

    Drake, J. S., Schfer, J. L., and May, A. (1967). A statistical analysis of speed density hy-
       potheses. In Edie, L. C., Herman, R., and Rothery, R., editors, Proceedings of the Third
       International Symposium on the Theory of Traffic Flow. Elsevier North-Holland, New
       York.

    Driels, M. R. and Shin, Y. S. (2004). Determining the number of iterations for monte carlo
       simulations of weapon effectiveness.

    Dynasmart (2003). DYNAMSMART-X - User's Guide. Technical report, University of
       Maryland.

    Fltterd, G. and Rohde, J. (2011). Operational macroscopic modeling of complex urban
       road intersections. Transportation Research Part B: Methodological, 45(6):903-922.
REFERENCES  149

Fortuijn, L. G. H. and Hoogendoorn, S. P. (2015). Turbo roundabouts: Comparing capac-        15
   ity estimation on gap and flow level. In Proceedings of the 94th Annual Meeting of the
   Transportation Research Board.

Geroliminis, N. and Daganzo, C. F. (2008). Existence of urban-scale macroscopic fun-
   damental diagrams: Some experimental findings. Transportation Research Part B:
   Methodological, 42(9):759-770.

Gipps, G. P. (1986). A model for the structure of lane-changing descisions. Tranportation
   Research Part B: Methodological, 20:403-414.

Godunov, S. K. (1959). A difference scheme for numerical computation of of discontinu-
   ous solutions of equations of fluid dynamics. Math. Sb., 47:271 - 290.

Greenshields, B. D. (1934). A Study of Traffic Capacity. Proceedings Highway Research
   Board, 14:448-477.

Hajiahmadi, M., Knoop, V. L., De Schutter, B., and Hellendoorn, H. (2013). Optimal dy-
   namic route guidance: A model predictive approach using the macroscopic funda-
   mental diagram. In Intelligent Transportation Systems-(ITSC), 2013 16th International
   IEEE Conference on, pages 1022-1028. IEEE.

Hall, F. L. and Agyemang-Duah, K. (1991). Freeway Capacity Drop and the Definition
   of Capacity. Transportation Research Record: Journal of the Transportation Research
   Board No.1320, pages 91-98.

Heikoop, H., editor (2011). Capaciteitswaarden Infrastructuur Autosnelwegen. Dienst
   Verkeer en Scheepvaart.

Helbing, D. (2003). A section-based queueing-theoretical traffic model for congestion
   and travel time analysis in networks. Journal of Physics A: Mathematical and General,
   36(46):L593.

Helbing, D., Hennecke, A., and Treiber, M. (1999). Phase diagram of traffic states in the
   presence of inhomogeneities. Physical Review Letters, 82(21):4360.

Helly, W. . (1959). Simulation of bottlenecks in single lane traffic flow. In Proceedings
   of the Symposium on Theory of Traffic Flow, pages 207- 238. General Motors Research
   Laboratories, Elsevier, New York.

Hoogendoorn, S., Hoogendoorn, R. G., and Daamen, W. (2011). Wiedemann revis-
   ited. Transportation Research Record: Journal of the Transportation Research Board,
   2260(1):152-162.

Hoogendoorn, S. P. (2005). Unified approach to estimating free speed distributions.
   Transportation Research Part B: Methodological, 39(8):709-727.

Ji, Y. and Geroliminis, N. (2012). On the spatial partitioning of urban transportation net-
   works. Transportation Research Part B: Methodological, 46(10):1639-1656.
    150  REFERENCES

15  Kerner, B. S. (2004). The Physics Of Traffic: Empirical Freeway Pattern Features, Engineer-
       ing Applications, And Theory. Springer, Berlin.

    Keyvan-Ekbatani, M., Daamen, W., and Knoop, V. (2016). Categorization of the lane-
       change decision process on freeways. Transportation Research part C.

    Knoop, V., Tamminga, G., , and Leclercq, L. (2016). Network transmission model: Appli-
       cation to a real world city. In proceedings of the 95th Annual Meeting of the Transporta-
       tion Reseach Board.

    Knoop, V. L., Duret, A., Buisson, C., and Van Arem, B. (2010). Lane distribution of traffic
       near merging zones - influence of variable speed limits. In Proceedings of IEEE Intelli-
       gent Transportation Systems.

    Knoop, V. L. and Hoogendoorn, S. P. (2015). An area-aggregated dynamic traffic simula-
       tion model. European Journal of Transport and Infrastructure Research (EJTIR), 15 (2),
       2015.

    Knoop, V. L., Hoogendoorn, S. P., and Van Zuylen, H. J. (2007). Empirical Differences be-
       tween Time Mean Speed and Space Mean Speed. In Proceedings of Traffic and Gran-
       ular Flow 07. Springer, Paris, France.

    Knoop, V. L., van Lint, H., and Hoogendoorn, S. P. (2015). Traffic dynamics: Its impact
       on the macroscopic fundamental diagram. Physica A: Statistical Mechanics and its
       Applications, 438:236-250.

    Knoop, V. L., Van Zuylen, H. J., and Hoogendoorn, S. P. (2009). Proceeding of the Interna-
       tional Symposium of Transportation and Traffic Theory, chapter Microscopic Traffic
       Behavior near Accidents. Springer, New York.

    Koshi, M., Iwasaki, M., and Ohkura, I. (1981). Some findings and an overview on vehic-
       ular flow characteristics. In Proceedings of the 8th International Symposium on Trans-
       portation and Traffic Theory, pages 403-426. Univ. of Toronto Press, Toronto.

    Kotsialos, A., Papageorgiou, M., Diakaki, C., Pavlis, Y., and Middelham, F. (2002). Traffic
       flow modeling of large-scale motorway networks using the macroscopic modeling tool
       metanet. Intelligent Transportation Systems, IEEE Transactions on, 3(4):282-292.

    Laval, J. and Castrilln, F. (2015). Stochastic approximations for the macroscopic funda-
       mental diagram of urban networks. In Transportation Research Procedia, volume 7,
       page 615-630.

    Laval, J. A. (2011). Hysteresis in traffic flow revisited: An improved measurement method.
       Transportation Research Part B: Methodological, 45(2):385 - 391.

    Laval, J. A. and Daganzo, C. F. (2006). Lane-changing in traffic streams. Transportation
       Research Part B: Methodological, 40(3):251-264.

    Laval, J. A. and Leclercq, L. (2013). The hamilton-jacobi partial differential equation and
       the three representations of traffic flow. Transportation Research Part B: Methodologi-
       cal, 52:17-30.
REFERENCES  151

Lebacque, J.-P. (2005). First-order macroscopic traffic flow models: Intersection mod-       15
   eling, network modeling. In Transportation and Traffic Theory. Flow, Dynamics and
   Human Interaction. 16th International Symposium on Transportation and Traffic The-
   ory.

Leclercq, L., Chiabaut, N., Laval, J. A., and Buisson, C. (2007). Relaxation Phenomenon
   After Lane Changing. Transportation Research Record: Journal of the Transportation
   Research Board, No. 1999, pages 79-85.

Leclercq, L. and Geroliminis, N. (2013). Estimating mfds in simple networks with route
   choice. Transportation Research Part B: Methodological, 57:468-484.

Leclercq, L., Parzani, C., Knoop, V. L., Amourette, J., and Hoogendoorn, S. P. (2015).
   Macroscopic traffic dynamics with heterogeneous route patterns. Transportation Re-
   search Part C: Emerging Technologies, 59:292-307.

Lighthill, M. J. and Whitham, G. B. (1955). On Kinematic Waves. II. A Theory of Traffic
   Flow on Long Crowded Roads,. Proceedings of the Royal Society of London. Series A,
   Mathematical and Physical Sciences, 229(1178):317 - 345.

Nagalur Subraveti, H. H. S., Knoop, V. L., and van Arem, B. (2019). First order multi-lane
   traffic flow model-an incentive based macroscopic model to represent lane change
   dynamics. Transportmetrica B: Transport Dynamics, 7(1):1758-1779.

Newell, G. (2002). A simplified car-following theory: a lower order model. Transportation
   Research Part B: Methodological, 36(3):195-205.

Newell, G. F. (1993). A simplified theory of kinematic waves in highway traffic, part ii:
   Queueing at freeway bottlenecks. Transportation Research Part B: Methodological,
   27(4):289 - 303.

Oh, S. and Yeo, H. (2012). Estimation of capacity drop in highway merging sec-
   tions. Transportation Research Record: Journal of the Transportation Research Board,
   2286(1):111-121.

Ossen, S. J. L. (2008). Longitudinal Driving Behavior: Theory and Empirics. Trail thesis
   series, Delft University of Technology.

Payne, H. J. (1971). Models of freeway traffic and control, mathematical models of public
   systems. Simulation Council Proceedings Series, 28(1):51-61.

Pueboobpaphan, R. and van Arem, B. (2010). Understanding the relation between
   driver/vehicle characteristics and platoon/traffic flow stability for the design and as-
   sessment of cooperative cruise control. In Proceedings of the 89th Annual Meeting of
   the Transportation Research Board.

Richards, P. I. (1956). Shock waves on the highway. Operations Research 4, 4:42 - 51.

Schakel, W. J., Van Arem, B., and Knoop, V. (2012). Lmrs: An integrated lane change
   model with relaxation and synchronization. In Proceedings of the 91st Annual Meeting
   of the Transportation Research Board.
    152  REFERENCES

15  Schreiter, T., Van Lint, H., Yuan, Y., and P., H. S. (2010). Propagation wave speed estima-
       tion of freeway traffic with image processing tools. In Proceedings of the 89th Annual
       Meeting .

    Smits, E.-S., Bliemer, M. C., Pel, A. J., and van Arem, B. (2015). A family of macroscopic
       node models. Transportation Research Part B: Methodological, 74:20-39.

    Smulders, S. (1989). Control of freeway traffic flow. CWI Tract, 80.

    Srivastava, A. and Geroliminis, N. (2013). Empirical observations of capacity drop in free-
       way merges with ramp control and integration in a first-order model. Transportation
       Research Part C: Emerging Technologies, 30:161-177.

    Tampre, C. M., Corthout, R., Cattrysse, D., and Immers, L. H. (2011). A generic class of
       first order node models for dynamic macroscopic simulation of traffic flows. Trans-
       portation Research Part B: Methodological, 45(1):289-309.

    Toledo, T., Koutsopoulos, H. N., and Ben-Akiva, M. (2007). Integrated driving behavior
       modeling. Transportation Research Part C: Emerging Technologies, 15(2):96 - 112. ISSN
       0968-090X.

    Toledo, T., Koutsopoulos, H. N., and Ben-Akiva, M. (2009). Estimation of an inte-
       grated driving behavior model. Transportation Research Part C: Emerging Technolo-
       gies, 17(4):365 - 380. ISSN 0968-090X.

    Transportation Research Board, (2000). Highway Capacity Manual. Technical report.

    Treiber, M., Hennecke, A., and Helbing, D. (2000). Congested traffic states in empirical
       observations and microscopic simulations. Physical Review E, 62(2):1805.

    Treiber, M. and Kesting, A. (2013). Traffic Flow Dynamics; Data, Models and Simulation.
       Springer.

    Treiber, M., Kesting, A., and Helbing, D. (2006). Delays, inaccuracies and anticipation
       in microscopic traffic models. Physica A: Statistical Mechanics and its Applications,
       360(1):71-88.

    Van der Gun, J. P., Pel, A. J., and Van Arem, B. (2015). A general activity-based methodol-
       ogy for simulating multimodal transportation networks during emergencies. In ICEM
       2015: 3rd International Conference on Evacuation Modeling and Management, Tainan,
       Taiwan, 1-3 June 2015.

    Van Lint, J., Bertini, R. L., and Hoogendoorn, S. P. (2014). Data fusion solutions to com-
       pute performance measures for urban arterials. In Symposium Celebrating 50 years
       of Traffic Flow Theory 2014 FTF Summer Meeting, Portland (USA), 11-13 August, 2014.
       TRB.

    van Lint, J. W., Hoogendoorn, S. P., and Schreuder, M. (2008). Fastlane: New multiclass
       first-order traffic flow model. Transportation Research Record: Journal of the Trans-
       portation Research Board, 2088(1):177-187.
REFERENCES  153

van Wageningen-Kessels, F., van Lint, H., Hoogendoorn, S., and Vuik, K. (2010). La-
   grangian formulation of multiclass kinematic wave model. Transportation Research
   Record: Journal of the Transportation Research Board, (2188):29-36.

Van Wageningen-Kessels, F. L. M. (2013). Multi-class continuum traffic flow models:
   Analysis and simulation methods. Ph.D. thesis, Delft University of Technology.

Wiedemann, R. (1974). Stimulation des Strassenverkehrsflusses. Heft 8 der schriftenreihe
   des ifv, Universits,,^zt Karlsruhe.

Wu, N. (2002). A new approach for modeling of Fundamental Diagrams. Transporta-
   tion Research Part A: Policy and Practice, 36(10):867-884. Doi: DOI: 10.1016/S0965-
   8564(01)00043-X.

Yperman, I. (2007). The link transmission model for dynamic network loading.

Yperman, I., Logghe, S., Tampre, C. M. J., and Immers, B. (2006). Multicommodity link
   transmission model for dynamic network loading. In Proceedings of the 85th Annual
   Meeting of the Transportation Research Board.

Yuan, K., Knoop, V., and Hoogendoorn, S. (2015a). Capacity drop: A relation between the
   speed in congestion and the queue discharge rate. In Proceedings of the 94th Annual
   Meeting of the Transportation Research Board.

Yuan, Y. (2013). Lagranian Multi-Class traffic State Estimation. Ph.D. thesis, Delft Uni-
   versity of Technology.

Yuan, Y., Van Wageningen-Kessels, F., Van Lint, H., and Hoogendoorn, S. (2015b). Pro-
   ceedings of Traffic and Granular Flow 2011, chapter Two modeling and discretization
   choices for Lagrangian multi-class first-order traffic flow model and their related (dis-
   )advantages. Springer.

Zhang, H. M. (1999). A mathematical theory of traffic hysteresis. Transportation Research
   Part B: Methodological, 33(1):1 - 23.
          A

                        TEST QUESTIONS

The following pages contain exams with relevant questions. Problem set 1-11 are sets for
a full exam of "traffic flow theory and simulation". The level of the questions is the same
as can be expected for the course "Traffic Flow Modelling and Control"; note that some
of the content of these questions falls in part 1, and some of the content falls in part 2.
There is an example quesiton on Urban intersection control. From problem set 12, the
exams are full exams of Traffic Flow Modelling and Control part 1. Overall, a 3 hour exam
is expected to have approximately 55 to 60 points.

A.1. PROBLEM SET 1

A.1.1. SHORT QUESTIONS

A road has a capacity of 2000 veh/h, a free flow speed of 120 km/h, a critical density of
25 veh/km and a jam density of 150 veh/km.

Exercise 1. Draw a realistic fundamental diagram in the with the above properties, both
in the flow-density plane and in the speed-density plane; indicate how speed can be found
in the flow-density diagram. (4 points)

Exercise 2. Describe briefly (100 words) the assumptions in Daganzo's theory of slugs and
rabbits (3 points)

Exercise 3. What are cumulative curves, and how are they constructed? (1 point)

Exercise 4. What is a vertical queuing model and how is this related to cumulative curves
(2 points)

Exercise 5. What is higher, the space mean speed of the time mean speed? Why? (1 point)

Exercise 6. How can the space mean speed be calculated from individual local speed ob-
servations vi . Give an equation. (1 point)

                                                         155
156                          A. TEST QUESTIONS

A Exercise 7. What are the phases according to three-phase traffic flow theory? How are A.1.2. STATE RECOGNITION

                  they characterised? (2 points)

                       Below, you find some traffic state figures from www.traffic-states.com. For each fig-
                  ure, indicate:

                      1. The driving direction (top-down or bottom-up) and explain why based on traffic
                          flow theory (0.5pt per figure, spread over b-d) and

                      2. the traffic characteristics present, and the most likely causes for these (6 pt, spread
                          over b-d)

Exercise 8.
(up to 10.00 am) (2 points)

Exercise 9.
(3 points)

Exercise 10.
(3.5 points)
A.1. PROBLEM SET 1  157

Exercise 11. Explain briefly (indication: 100 words) Newells car-following model. Also A.1.3. SIMULATION MODEL A

plot a space-time diagram indicating these properties. (3 points)

Exercise 12. Name the three types of (in)stability in traffic flow, and explain briefly their
effect (50 words and 1 graph per type) (3 points)

Exercise 13. Can multi-anticipation improve stability? Which type and how? (3 points)

Exercise 14. How can lane-changing cause a breakdown? (50 words) (1 point)

Exercise 15. How can lane-changing prevent a breakdown? (Hint: use the lane distribu-
tion.) (2 points)

A.1.4. MOVING BOTTLENECK

Imagine a truck drivers strike in France on a 3-lane motorway from time t=t0. For the
road you may assume a triangular fundamental diagram with a capacity of 2000 ve-
h/h/lane, a critical density of 25 veh/km/lane and a jam density of 125 veh/h/lane. Sup-
pose there is no traffic jam at t<t0, and a constant demand of 5000 veh/h. Assume the
truck drivers drive at 30 km/h, not allowing any vehicle to pass.

Exercise 16. Calculate is the maximum flow on the road behind the trucks? (3 points)

Exercise 17. Sketch the traffic flow operations in a space-time diagram. Pay attention to
the direction of the shockwave, and note the propagation speeds of the other waves. (3
points)

    After a while, the trucks leave the road.

Exercise 18. Sketch again the traffic operations in the space time diagram. Do this un-
til the traffic jam is solved (if applicable), or until the traffic states propagate linearly if
demand does not change. (3 points)

Exercise 19. Calculate the speed at which the tail of the queue propagate backwards? (1
point)

Exercise 20. In the plot of question 2, draw the trajectory of the vehicle arriving at the
tail of the queue at the moment the strike ends (Use a different colour or style than the
shockwaves). (1 point)

Exercise 21. What is the speed of the vehicle in the jam? (1 point)

A.1.5. MARATHON DELFT

Imagine a marathon organised in Delft. There are 30.000 participants, starting at a road-
way section which is 25 meters wide.

Exercise 22. Give a realistic estimate for the capacity of the roadway in runners per hour.
Base your answer on the width and headway of a runner

Exercise 23. Calculate how long it would take for all runners to start? (1 point)
158                     A. TEST QUESTIONS

A and all run at a constant speed. Suppose the runners have uniform distribution of running times from 2.5 to 4.5 hours,

                  Exercise 24. Given your earlier assumptions, calculate the minimum required width of
                  the road halfway the track to avoid congestion? For reasons of simplicity, you may assume
                  that they all start at the same moment (instead of your answer at question 5b). (5 points)

            A.2. PROBLEM SET 2

               A.2.1. SHORT OPEN QUESTIONS

                  Exercise 25. Explain why Kerner claims that in his three phase theory there is no funda-
                  mental diagram (indication: 25 words) (1 point)

                  Exercise 26. What is a Macroscopic Fundamental Diagram (indication: 25 words)? (1
                  point)

                  Exercise 27. What are similarities and differences of a Macroscopic Fundamental Dia-
                  gram compared to a normal fundamental diagram? Explain based on the underlying
                  phenomena (indication: 75 words). (2 points)

                  Exercise 28. Explain in words the how the flow in from one cell to the next is calculated
                  according to the Cell Transmission Model (indication: 100 words; equations can be useful,
                  but need to be explained). (2 points)

                  Exercise 29. What do we mean with Lagrangian coordinates in macroscopic traffic flow
                  simulation? Which variables are used? Why is this an advantage over other systems? (in-
                  dication: total 100 words) (3 points)

A.2.2. LEAVING THE PARKING LOT

Consider the situation where many cars are gathered at one place, and they can only
leave over one road.

      Large                                  Flow
     parking                                 direction
                         Increasing road
       area                  capacity
                        (and no spillback)
              Detector

The above figure shows a simplified representation of the road layout. There is a detector
at the red line, in the two-lane road stretch. Downstream of the detector the road widens
and there are no further downstream bottlenecks.
A.2. PROBLEM SET 2  159

Exercise 30. Explain what the capacity drop is (be precise in your wording!). (1 point) A

Exercise 31. How large is the capacity drop? Give a typical interval bound. (1 point)

Exercise 32. Sketch the traffic flow at the detector (indicated in the figure) as function of
the demand (in veh/h, ranging from 0 to three times the road capacity) from the parking
lot. (2 points)

Exercise 33. Explain the general shape you draw in the previous question. (1 point)

Exercise 34. Give some rough estimates for values in your graph. (1 point)

A.2.3. TRAFFIC LIGHTS

Consider a junction with a traffic light with equal green time g , and a clearance time of
2 seconds (i.e., the time needed to clear the junction; during this time, both directions
are red). If the traffic light turns green, the first vehicle needs 3 seconds to cross the
line. Afterwards, vehicles waiting in the queue will follow this vehicle with a 2 second
headway.

500 veh/h

                       800 veh/h

Exercise 35. What is the fraction of time traffic is flowing over the stop line per direction
as function of the cycle time c? (2 points)

Exercise 36. What is the maximum flow per direction as function of the cycle time? In
your equation, what are the units for the variables? (3 points)

    Suppose traffic flow from direction 1 is 500 veh/h and traffic from direction 2 is 800
veh/h, and suppose a uniform arrival pattern.

Exercise 37. What is the minimum cycle time to ensure that no queue remains at the
end of the cycle? Does an approach with vertical queuing models yield the same result as
shockwave theory? Why? (3 points)

    This cycle time is fixed now at 120 seconds. We relax the assumption of uniform
distribution to a more realistic exponential arrival pattern.

Exercise 38. To which distribution function for the number of arrivals per cycle (N ) does
this lead? Name this distribution (1 pt). (1 point)
160                                                           A. TEST QUESTIONS

A The probability distribution function of X is given by:

         f (k; ) = Pr(X = k) =  k e-                       ,                        (A.1)

                                k!

with e  2.71828...) and k! is the factorial of k. The positive real number  is equal to the
expected value of X , which also equals the variance.
Assume there is no traffic waiting when the traffic light turns red at the beginning of the
cycle.

Exercise 39. Express the probability p that there are vehicles remaining in the queue for
direction 2 when the traffic light turns red at the end of the cycle in an equation (p = ...).
Write your answer as mathematical expression in which you specify the variables. Avoid
infinite series. There is no need to calculate the final answer as a number (3 points)

Exercise 40. Argue whether this probability is higher or lower than if a uniform arrival
process is assumed (1 point)

A.2.4. CAR-FOLLOWING MODEL

Consider the IDM car-following model, prescribing the following acceleration:

     dv  v 4 s(v,v) 2
     dt = a0 1 - v0 - s                                                             (A.2)

with the desired distance s as function of speed v and speed difference v:

         s(v,v) = s0 + v T + v v                                                    (A.3)
                                     2 ab

Exercise 41. Explain in words the working of this car-following; i.e. comment on the
acceleration. (3 points)

     Another car-following model is the relatively simple car-following of Newell.

Exercise 42. How does the Newell car-following model work? (indication: 50 words) (1
point)

Exercise 43. Name two weak points of both car-following models (IDM and Newell) (2
points)

Exercise 44. Give two reasons to choose the IDM model over Newell's model (2 points)

Exercise 45. Give two reasons to choose Newell's model over the IDM model (2 points)
A.2. PROBLEM SET 2                   161

We consider a pedestrian flow through a narrow tunnel, which forms the bottleneck in A.2.5. PEDESTRIANS IN A NARROW TUNNEL A

the network under high demand. The tunnel is 4 meters wide and 20 meters long. You
may assume that the pedestrians are distributed evenly across the width of the tunnel.
The pedestrian flow characteristics are described by a triangular fundamental diagram,
with free speed v0 = 1.5m/s, critical density kc = 1P /m2 and jam density k j = 6P /m2 (P
stands for pedestrian).

Exercise 46. Draw the fundamental diagram for the tunnel. What is the capacity of the
tunnel expressed in P /mi n? (2 points)

    Between 11-12 am, the average flow through the tunnel is q = 180 P /mi n.

Exercise 47. Assuming stationary conditions, what is the density in the tunnel expressed
in P /m2 ? (2 points)

A.2.6. MOVING BOTTLENECK WITH DIFFERENT SPEEDS

Consider a two-lane road with traffic in opposing directions. Assume a triangular fun-
damental diagram with a free speed of 80 km/h, a critical density of 20 veh/km and a
jam density of 120 veh/h. At t=0 there is a platoon of 30 vehicles on the road with equal
spacing in the section x=0 to x=2km. There are no other vehicles on the road. In this
question, we will consider the effect of a speed reduction to 15 km/h.

Exercise 48. Calculate the density on the road in the platoon. Indicate the conditions in
the fundamental diagram. Make a clear, large drawing of the fundamental diagram such
that you can reuse it for indicating states in the remaining of the question. (1 point)

    In each of the following subquestions, consider these initial conditions and no other
bottlenecks than introduced in that subquestion - i.e., there never is more than one bottle-
neck.
Suppose there is a local, stationary bottleneck where drivers have to pass at 15 km/h
from time t 1 to t 2. The figure below shows the position and the duration compared to
the platooSpnacientimthe teemsppoaracl eloctailmboettlepnleockt.

       6
                   boundary of platoon

       5 bottleneck

Distance (km)  4

               3

               2

               1

                  t1             t2

               00 0.5 1 1.5 2 2.5 3

                     Time (min)

Exercise 49. Sketch the resulting traffic operations in a space-time plot. Also sketch some
trajectories in the plot, using a different color or style. Indicate how you construct the
diagram (i.e., indicate how you get the lines, angles, and distances in the plot). There is
no need to calculate the exact traffic states. Additional information: the combination of
speeds and the fundamental diagram will lead to congestion. (4 points)
162  A. TEST QUESTIONS

A over the whole length of the road at the same time. You may assume the platoon to be Suppose there is a temporal speed reduction to 15 km/h for a short period of time

                  completely on the road.

                  Exercise 50. Sketch the resulting traffic operations in a space-time plot. Also sketch some
                  trajectories in the plot, using a different color or style. Indicate how you construct the
                  diagram (i.e., indicate how you get the lines, angles, and distances in the plot). (2 points)

                       Suppose there is a large tractor moving in the opposite direction of the traffic at 5
                  km/h from x1 to x2. This wide vehicle causes vehicles that are next to it to reduce speed
                  to 15 km/h. The speed (5 km/h) is lower than the speed of the shock wave at the tail of
                  the queue in question b

                  Exercise 51. Sketch the resulting traffic operations in a space-time plot. Also sketch some
                  trajectories in the plot, using a different color or style. Indicate how you construct the
                  diagram (i.e., indicate how you get the lines, angles, and distances in the plot). (4 points)

                       Suppose there is a large tractor moving in the opposite direction of the traffic at 50
                  km/h. This wide vehicle causes vehicles that are next to it to reduce speed to 15 km/h.
                  The tractor speed (50 km/h) is higher than the speed of the shock wave of the tail of the
                  queue in question b.

                  Exercise 52. Sketch the resulting traffic operations in a space-time plot. Also sketch some
                  trajectories in the plot, using a different color or style. Indicate how you construct the
                  diagram (i.e., indicate how you get the lines, angles, and distances in the plot). (Hint: it
                  can help to consider a finite tractor length, but it is not necessary) (5 points)

            A.3. PROBLEM SET 3

               A.3.1. SHORT OPEN QUESTIONS

                  Below, two simulation results of a homogeneous congested area spilling back upstream
                  are plotted. You see a high density, congested area, indicated with h downstream of x=0
                  at t=0, and a low density, uncongested area, indicated by l. The driving direction is up.
                  One of the figures plots the results of a simulation in Eulearian coordinates and one of a
                  simulation in Lagrangian coordinates.
A.3. PROBLEM SET 3                                                             163

                                                                          A

Exercise 53. Explain which of the two is Eulerian and which one Lagrangian.(1 point)

Exercise 54. Give the two main advantages of using Lagrangian coordinates. (2 points)

Exercise 55. Explain what a pce value is. (30 words) (1 point)

Exercise 56. How does the pce value of trucks depend on the speed, qualitatively (i.e., does
it increase, decrease, ...). Give your reasoning

Exercise 57. How does the pce value of trucks depend on the speed, qualitatively (i.e., does
it increase, decrease, ...). Give your reasoning (2 points)

A.3.2. MULTI-LEADER CAR-FOLLOWING MODELS

Consider the IDM car-following model, prescribing the following acceleration:

                    dv  v 4 s(v,v) 2
                    dt = a0 1 - v0 - s                                         (A.4)

In this equation, v is the speed of the following vehicle, v0 a reference speed, s the dis-
tance headway and s a reference distance headway as function of speed v and the dif-

ference in speed with the leader, v:

                        s(v,v) = s0 + v T + v v                                (A.5)
                                                    2 ab

In this equation s0 is a desired distance at standstill, and a is a reference acceleration and
b is the maximum comfortable braking.

Exercise 58. Explain in words the working of this car-following model; i.e. comment on
the acceleration. Only comment on equation A.4. (indication: 50 words) (2 points)

Exercise 59. Explain in words what is meant with multiple-leader car-following models.
Only comment on the multi-leader part. (indication: 50 words) (1 point)

Exercise 60. Reformulate the IDM model into a multiple-leader car-following model by
including two leaders. Give your reasoning, and, for all points, formulate those reasonings
into equations. (3 points)

Exercise 61. Formulate the generalised car-following IDM model considering n leaders (3
points)

A.3.3. MEASURING THE SPEED AT A CROSS SECTION

Consider the following road layout with a lane drop from 3 to 2 lanes; traffic is flowing
left to right.
                  164                                                                                                                                              A. TEST QUESTIONS

A Detectors

        Ca 1 km          Very small
        (quest. h)

    The demand, as well as the flow at the downstream detector, is given in the figure
below. The speed at the detector, located just upstream (you may assume no spacing
between the bottleneck and the detector) of the bottleneck, is as follows.

                    Vertical queues                                                                                                                         Speed
                                                                                                                    110
4500
4000                                                                                                                100
3500
3000                                                                                                                90
2500
2000                                                                                                                80
1500
1000Flow (veh/h)                                                                                                    70
                                                                                                      Speed (km/h)
     0                                                                                                              60

                                                                                                                    50

                                                                                                                    40

                                                                                                                    30

        0.1         0.2            0.3  0.4  0.5                                                                    200  0.1  0.2                                  0.3  0.4  0.5

                         Time (h)                                                                                                  Time (h)

(a) subfigure[Flow and demand                     (b) subfigure[Speed

In the question, you might need values from the graph. Slightly misreading the graph is
not a problem, but mention the values you directly read from the graph and where you
find these.

Exercise 62. In figure a with the flow and the demand, which line is the demand and
which line the flow. Argue why (1 point)

Exercise 63. Give the free flow capacity (and the reasoning how you find it) (2 points)

Exercise 64. Give the queue discharge rate. (and the reasoning how you find it) (2 points)

    Assume the fundamental diagram per lane is the same for all lanes, at all locations in
this setting.

Exercise 65. Explain why can this situation not be described with a triangular funda-
mental diagram. (1 point)

Exercise 66. Draw the simplest fundamental diagram possible for the three lane section
(aggregated over all lanes). Explain how you find the values for the relevant points, and
give calculate them. (5 points)
A.3. PROBLEM SET 3  165

above figure, indicate the times of speed change in the graph - no points given) and in the Exercise 67. On you answer sheet, sketch the demand as function of time (i.e., copy the A

same graph, sketch the resulting flow at the detector. Pay attention to the times at which
the flow changes compared to the time of the speed changes. (2 points)

    Now the delay is analysed by slanted cumulative curves.

Exercise 68. Explain the offset you choose. (1 point)

Exercise 69. Sketch the slanted cumulative curve of the flow and the demand for the sit-
uation at hand. (2 points)

Exercise 70. Indicate in the figure how you can determine the delay. (1 point)

    Now a second detector is constructed approximately 1 km upstream of the bottle-
neck.

Exercise 71. Sketch the demand as function of time (i.e., copy the second figure of this
question, indicate the times of speed change in the graph - no points given) and in the
same graph, sketch the resulting flow at this second detector. Pay attention to the times at
which the flow changes compared to the time of the speed changes. (2 points)

    We now relax the assumption of all traffic states at the fundamental diagram to a
more realistic situation (i.e., including demand and supply variations). In this situa-
tion, We measure the one-minute aggregated (harmonically averaged) speeds during
one month.

Exercise 72. Sketch a probability distribution or histogram of these speeds. Explain the
shape (2 points)

A.3.4. MOVING BOTTLENECK

Consider a two-lane motorway. Assume a triangular fundamental diagram with a free
flow speed of 80 km/h, a critical density of 25 veh/h/lane and a jam density of 150 ve-
h/km/lane. The inflow is stationary at 2000 veh/h.

Exercise 73. Draw the fundamental diagram and calculate the capacity of the road stretch2

    Consider a wide vehicle (special transport) driving slowly is entering the road. There
are no overtaking possibilities. This creates congestion, of which the tail happens to stay
at the same position.

Exercise 74. Calculate the flow in the jam. (Hint: you can use the speed of the shockwave
at the tail of the queue)1

Exercise 75. Calculate the density in the jam.2

Exercise 76. Calculate the speed of the special transport.2

    After 5 km, the truck leaves the road.

Exercise 77. Construct the space-time diagram of this situation, from before the moment
the truck enters the road to after the moment the traffic situation is stationary. Explain
how you find the speed of the solving of congestion; you may re-use the figure you created
in a.4

Exercise 78. At the maximum queue length, how many vehicles are in congestion1
166                                                        A. TEST QUESTIONS

A A.3.5. MULTI-LANE TRAFFIC FLOW Exercise 79. Give the names of two regimes according to Daganzo's theory of slugs and

                  rabbits (only names are required). (1 point)

                       Below, you find a Google Earth image of the A1 motorway near Bathmen. Consider
                  the right to left (east to west) direction

Exercise 80. To which of the regimes of question a) does the situation in the figure resem-
ble most. Explain why (2 points)

    There are 4 trucks and 7 passenger cars (including one delivery van) in the image.
The fraction of passenger cars in the density is hence 7/11.

Exercise 81. What would you expect from the fraction of passenger cars in the flow: is this
higher, lower or equal to 7/11. Motivate your answer 2 points

Exercise 82. Calculate the fraction of the is passenger cars in the flow. Assume reasonable
speeds for the different vehicle types in your answer - state your assumptions clearly. (4
points)

    Below, a figure of a lane flow distribution for a three lane road in the Netherlands is
given.

                       Average lane distribution km 40.11 - Speed Limit 120kph
            1

                      0.9

                      0.8

                      0.7

Fraction of the flow  0.6

                      0.5

                      0.4

                      0.3

                      0.2

                      0.1

                      00   50                    100  150

                               Density (veh/km)

Exercise 83. In the figure, which color matches which lane. Argue why (1 point)

Exercise 84. Describe briefly (100 words) the assumptions in Daganzo's theory of slugs
and rabbits (3 points)

Exercise 85. Using Daganzo's theory of slugs and rabbits, explain the differences in flow
between most used lane (blue) and the least used lane (red) at a density of 75 veh/km. (2
points)
A.4. PROBLEM SET 4                                                                   167

A.4. PROBLEM SET 4                                                                           A

A.4.1. SHORT QUESTIONS

Exercise 86. What does a Macroscopic Fundamental Diagram describe? Make sure your

answer shows clearly the differences between an MFD and a fundamental diagram.(2

points)

Exercise 87. What is qualitatively the effect of inhomogeneity in the network on the MFD?
(No explanation needed) (1 points)

Exercise 88. In Lagrangian coordinates, the fundamental diagram is often expressed in
spacing (horizontal) - speed (vertical) form. Sketch a fundamental diagram in the spacing-
speed plane (2 points)

A.4.2. FROM CAR-FOLLOWING TO A FUNDAMENTAL DIAGRAM

The optimal velocity model is a car-following model specifying the acceleration a as fol-

lows:

                        a = a0(v - v)                                                (A.6)

In this equation, v is the speed of the vehicle, and a0 a reference acceleration (tunable
parameter, constant for a specific vehicle-driver combination). v is determined as fol-

lows:

                    v = 16.8(tanh(0.086(x - 25) + 0.913))                            (A.7)

In this equation, x is the distance (in meters) between the vehicle and its leader.

Exercise 89. Explain qualitatively the working of this car-following model; i.e. comment
on these two equations. (2 points)

Exercise 90. What are the conditions for which a fundamental diagram holds? (1 point)

Exercise 91. Derive the expression a fundamental diagram (flow as function of density)
for these conditions using the OVM model4

Exercise 92. What are the values capacity, free speed and jam density (either derive the
value or use you graphical calculator to determine this - you may round numbers to the
precision of your liking...) (1 point)

Exercise 93. Argue whether the values in the previous question are reasonable for the
spacing/speed relationship? If so, for what conditions (urban, freeway...?) If not, can you
change the parameters (numbers) of the model (A.6 and A.7) to get a proper fundamental
diagram (if so: what are reasonable numbers). Show in your answer that you understand
the traffic operations, and/or the model working.

A.4.3. MOBIL LANE CHANGE MODEL

Consider the mobil lane change model. A driver c has several options: change lanes to
the left, to the right or stay in his current lane. For each of the options a total utility
(denoted Utot) can be calculated.

                    Utot = Uc + p                   Ui                               (A.8)

                                   i other drivers
168                                                 A. TEST QUESTIONS

A puted using a car-following model (the Intelligent Driver Model - although the specific The utility for the driver i Ui is assumed to be its instantaneous acceleration, as com-

                  model is not relevant for the question). The driver is assumed to take the option with the
                  highest utility.

                  Exercise 94. Explain the working of the model in words (2 points)

                  Exercise 95. What value for p can be expected (1 point)

                       A situation like this can be observed in practice

Exercise 96. Does the MOBIL lane change model explain this? Reasoning from the model,
explain how (if it does explain) or why (if it does not explain). (2 points)

A.4.4. SNOW PLOW

During a winter night, a 30 cm snow covered a three lane motorway fell. Traffic is still
moving.

This changes the traffic operations. Assume a triangular fundamental diagram. The free

flow speed reduces to 30 km/h, the jam density to 125 veh/km/lane. The capacity is 5000

veh/h.

                    Fundamental diagram snow

              6000

              5000

              4000

Flow (veh/h)  3000

              2000

              1000

              00    50 100 150 200 250 300 350 400

                    Density (veh/km)

A truck spins and cannot move further, thereby blocking the road completely, not allow-
ing other vehicles to pass. This leads to a traffic jam. The inflow is 1000 veh/h.
A.4. PROBLEM SET 4  169

mental diagram. Calculate all shock wave speeds. (4 points) Exercise 97. Draw the resulting traffic operations in a space time plot and in the funda- A

    A snow plow comes to free the vehicles that are stuck. After freeing the vehicles, the
snow plows clear two of the three lanes of the motorway. Thereby, they drive at 5 km/h
on the motorway. The capacity of vehicles passing the snow plough on the left lane is
2000 veh/h. The inflow on the road is 1000 veh/h.

Exercise 98. Sketch the traffic operations in a space-time plot and in the fundamental
diagram. Explain how you construct the graphs. (No point given here for the beginning,
discussed in question b) (5 points)

A.4.5. CUMULATIVE CURVES

The graphs show cumulative curves for different locations along the road. The legends
shows the distances in km from the beginning (i.e., upstream end) of a road. For the
remainder of the question, reasoning is more important than exact readouts from the
graph. When using graph readouts, please state so explicitly and note the values you read
from the graph.
170                                                            A. TEST QUESTIONS

A 2500                              Cumulative curves

                          0

                          6

                          12

                    2000  18

                          24

                          30

N (Nr of vehicles)        36

                    1500  42

                          48

                    1000

                    500

                    00    0.2  0.4  0.6  0.8           1  1.2  1.4

                                         Time (h)

Exercise 99. Explain the traffic state, mention a possible cause (e.g., "different speed limits
for different sections", "peak hour jam") and explain why. (3 points)

Exercise 100. Estimate is the total delay encountered here (3 points)

Exercise 101. Sketch the traffic situation in space-time (shock waves - no trajectories
needed). Estimate the the location of changes in traffic states. (3 points)

    Assume a triangular fundamental diagram.

Exercise 102. Estimate, from the given curves, give the free speed, capacity, critical density
and jam density (4 points)

A.4.6. CROWN JEWELS IN THE TOWER

We consider an exhibition with the most important piece an object in a small glass show
case in the middle of the room. Visitors do not have a preference to see a particular side
of the piece. The room is 15 meters long and 6 meters wide.

Exercise 103. Explain why a larger glass show case can increase the capacity of the exhi-
bition room, in terms of visitors per unit of time2

    The exhibitor has chosen for a show case of 3x1 meters.

Exercise 104. Estimate the capacity of the room, measured in visitors per minute; base
your answer on a reasonable watching time for the piece of art and state the assumptions
explicitly4
A.5. PROBLEM SET 5                                                                171

visitors can stand on a moving walkway (like in the airport), which is constructed at each An alternative design is considered. Instead of the visitors walking by the art, the A

side of the glass. Visitors step at the moving walkway at the beginning of the room, and
step off at the end. They are not allowed to walk backwards on the moving walkway.

Exercise 105. What is the capacity of the room in this case. Base your answer on (explicitly
stated) reasonable assumptions on distance and speed.3

A.5. PROBLEM SET 5

A.5.1. SHORT QUESTIONS

Below, you find a google maps image of New York; Times Square is shaded in blue. The
municipality of NY claimed that 1,000,000 people were at Times Square at the start of the
new year (1 January 0h00).

Exercise 106. From a traffic flow perspective, comment on this claim. (2 points)
172  A. TEST QUESTIONS

A Exercise 107. How can synchronized flow be recognized? (1 point)

                  Exercise 108. Sketch the three phases of traffic flow in a flow-density diagram, and give
                  the names (2 points)

                  Exercise 109. Comment on the concept of capacity in the three phase traffic flow theory
                  (1 point)

                  Exercise 110. How are Lagragian coordinates for traffic defined (i.e., what is special on
                  the the definition of the coordinates; how do they differ from Eulerian coordinates?) (1
                  point)

                  Exercise 111. What the main mathematical advantage of the Lagrangian coordinate sys-
                  tem? (1 point)
A.5. PROBLEM SET 5                                                                                       173

Below, you find a speed contour plot of traffic operations at a motorway (the negative A.5.2. MOTORWAY TRAFFIC OPERATIONS A

speeds are plotted for color representation: units are in km/h, so blue is 100 km/h and
red is (almost) standstill). (if you are color blind and cannot see the colors - please ask!)

                                          SpaceTime speed
           15

                                                                                                   -10

                                        -20

                                                                                                    -30
            10

                                                                                                    -40

Space (km)                              -50

                                        -60

            5                           -70

                                        -80

                                        -90

            0                           -100

             0 10 20 30 40 50 60 70 80

                    Time (min)

Exercise 112. Explain which direction traffic is flowing from the graphs1

Exercise 113. Name the two main traffic phenomena you see - and briefly describe what
is happening. (2 points)

Exercise 114. What are the three different levels of stability, and what do they mean (2
points)

Exercise 115. Comment on the stability of traffic for this day (3 points)

Exercise 116. What traffic states can occur according to the theory of slugs and rabbits.
Give the names and a short description (10-20 words per state) (2 points)

Exercise 117. Modelling a multi lane Dutch motorway, how does this theory in result-
ing traffic differ from the Mobil lane change model for moderately dense (undercritical)
traffic? (2 points)
174                                                                                               A. TEST QUESTIONS

A A.5.3. CAR-FOLLOWING

                  A fundamental diagram only holds in stationary and homogeneous traffic conditions.

Exercise 118. Explain the terms stationary and homogeneous (indication: 20 words each)
(2 points)

     From a car-following model the fundamental diagram can be derived.

Exercise 119. Can a car-following model be derived from the fundamental diagram? If
so, explain how. If not, explain why not. (2 points)

    The two speed-density relationships shown below relate to a triangular fundamental
diagram and Smulders fundamental diagram

100                                                                                      100

     80                                                                                  80

Speed (km/h)60                                                                           60
                                                                           Speed (km/h)
     40                                                                                  40

     20                                                                                  20

     00  50  100               150                                                       00   50  100               150

             Density (veh/km)                                                                     Density (veh/km)

Exercise 120. Which figure is which fundamental diagram. Why? (1 point)

Exercise 121. Draw the corresponding flow-density and speed-flow curves for Smulders
fundamental diagram (in your drawing, put attention to (or indicate) the values or slopes
at several critical points at the ends of lines or at turning points)3

A.5.4. PARTIAL ROAD BLOCKING NEAR A SIGNALISED INTERSECTION

Upstream of a signalised intersection the road is partially blocked by a crane (see be-
low figure for illustration). Assume that between the crane and the intersection, all four
lanes can (and will) be used if needed. That means that the length between the crane and
intersection is longer than in the images.
A.5. PROBLEM SET 5  175

                              A

During the red phase, the tail of the queue spills back further than the crane. During the
green phase, the queue dissipates completely. Throughout this question, assume a fun-
damental diagram which is concave (not triangular).

Exercise 122. Sketch the fundamental diagrams. Give typical values for the characteriz-
ing points. (2 points)

    Use this diagram throughout this question.

Exercise 123. Sketch the traffic operations in a space time plot, starting at the moment
the traffic light turns red and ending at the moment the traffic light turns red again. Also
indicate all states in the fundamental diagram. Only consider traffic states upstream of
the traffic light.8

Exercise 124. Draw the (moved) cumulative curves upstream of the traffic jam and down-
stream of the traffic light (2 points)

Exercise 125. How could you get the total delay from this for all vehicles together (explain,
but no need for calculations) (1 point)

Exercise 126. Comment qualitatively on the effect of the distance between the intersection
and the crane on the delay (2 points)

    The workers move the crane downstream in order to reach a building further down-
stream. They can only do so when there is no queue downstream. Assume they start
when the queue is dissolving and traffic flows past the crane, but the queue is not dis-
solved completely yet, and assume a speed for the movement. The fundamental diagram
does not change due to the movement (i.e., you may use the FDs of question a)

Exercise 127. Sketch the traffic states in the flow-density plane, from the moment the
crane moves until the queue is completely dissipated (you may assume the traffic light
stays green, and assume the distance to the traffic light is large enough that the crane can
keep moving until the traffic jam is solved). (4 points)
176                                                A. TEST QUESTIONS

A Exercise 128. What variables are related to each other in the Network Fundamental Dia- A.5.5. NETWORK FUNDAMENTAL DIAGRAM

                  gram. Give the names and explain the terms (more than one answer possible) (2 points)

                  Exercise 129. Sketch a typical NFD (1 point)

                  Exercise 130. How is this shape different from a regular fundamental diagram. Explain
                  briefly why (20 words). (1 point) -

                  Exercise 131. Comment on the traffic mechanism behind the right hand side. Show in
                  your answer that you understand the difference in traffic mechanism with the fundamen-
                  tal diagram (1 point)

                       A traffic engineer suggests to limit the access to the central business district, a part of
                  the road network with many companies.

                  Exercise 132. Explain using the NFD why this can be beneficial even though the stopped
                  vehicles need to wait and experience delay. (3 points)

A.6. PROBLEM SET 6

Exercise 133. Explain what a car-following model does in general (1 point)

A.6.1. SHORT QUESTIONS

The pce value of a truck is claimed to be 2 for a road without queue warning systems.

Exercise 134. Explain what a pce value is (indication: 30 words). (1 point)

    A study shows that by installing queue tail warning systems the capacity of the road
increases. The factor by which it increases is 1.05 for passenger cars and 1.09 for trucks,
meaning it can handle 5% more cars and 9% more trucks

Exercise 135. Based on the information above, calculate the new pce value for trucks for
the road with queue warning systems. (3 points)

Exercise 136. Traffic simulation in Lagrangian coordinates has the advantage that there
is less numerical diffusion. Explain in your own words what this means - indication 50
words. (1 point)

    The total utility U for the mobil lane change model is given by:

     Utot = Uown vehicle + p                   Ui                           (A.9)

                              i other drivers

In this equation, the utility for each driver is determined by its instanteneous accelera-

tion, given by a car following model. This utility can be calculated for the situation with
lane change (U (lane change)), as well as without lane change, (U (no lane change)). For Euro-
pean driving, vehicle will change to the right if U (change to the right) > (U (no lane change) - ath
and to the left if U (change to the left) > (U (no lane change) + ath . In these equations, at h is a

threshold which should be exceeded to perform a lane change.
A.6. PROBLEM SET 6  177

Exercise 137. What is a reasonable value for ath - explain why. (1 point) A

Exercise 138. What would be a reasonable range for the parameter p - explain why. (1
point)

    Consider a fundamental diagram for pedestrian flow in the flow-density plane.

Exercise 139. What are the units, as well as the minimum and maximum values at the
axes? (2 points)
178                     A. TEST QUESTIONS

A Consider a two lane motorway, with a capacity of 5000 veh/h and a queue discharge rate A.6.2. BRIDGE OPENING

                  of 4500 veh/h. On this motorway, the free flow speed differs from the critical speed.

                  Exercise 140. Sketch a fundamental diagram for the motorway in the flow-speed (!) plane.2

Exercise 141. Indicate reasonable values for the (i) free flow speed, (ii) critical speed, (iii)
critical density and (iv) jam density.3

    Assume the fundamental diagram holds. The demand is constant at 3500 veh/h. The
bridge opens at t=1h and is opened for 15 minutes.

Exercise 142. Sketch the cumulative curves for the inflow and outflow.2

Exercise 143. Calculate the maximum number of vehicles in the queue.1

Exercise 144. Calculate the total delay of all vehicles combined.3

    In the remainder of the question, assume a Greenshields fundamental diagram with
a capacity of 5000 veh/h, and a critical density of 60 veh/km.

    A further detailed description of the traffic situation uses a so called acceleration fan.

Exercise 145. Explain in your own words what is an acceleration fan.1

Exercise 146. Under this assumption, sketch the flow 500 meters downstream of the bridge
as function of time from the moment of the bridge closing (i.e., when the vehicles can flow
again); also provide a reference value at the vertical axis.3

Exercise 147. Calculate when the flow starts to change in the graph above (hard question:
2 instead of 4 points).2

A.6.3. VARIABLE ROAD LAYOUT

Consider a 3 lane motorway with a 100 km/h speed limit. The road has a narrower part
of a limited length (a bridge, 500 meters long), which can be used as two lane stretch
with 100 km/h speed limit, or as three lane stretch with 80 km/h speed limit.

100 A 100 B 100

100      80             100
                 C

     0m  500m       0m
A.6. PROBLEM SET 6                                                                      179

types. For the wide lanes, the critical density is 25 veh/km/lane and the jam density Throughout the question you may assume a triangular fundamental diagram for all road A

is 125 veh/km/lane. Assume the width of the lanes does not influence the congested
branch.

Exercise 148. Sketch the fundamental diagrams (aggregated over all lanes) for the three
parts (all in one figure): three wide lanes, two wide lanes and three narrow lanes: parts A,
B and C in the figure above. (2 points)

Exercise 149. Calculate the capacity of the three lane narrow road section. (2 points)

    The road authority switches dynamically between the three narrow lanes and the two
wide lanes.

Exercise 150. Explain why this dynamic switching is beneficial for the delays (i.e., why
does this give less delays than choosing one layout permanently) (indication: 50 words).
(1 point)

    During switching, the road needs to have an empty stretch of 300 meters (because
one cannot change the lanes at which vehicles are driving). The road authority wants to
do so by insert a pace car into the traffic stream starting 1000m upstream of the switching
part. This should drive at an appropriate speed (vpc ) to create this gap (the gap should
be downstream of the pace car after this has travelled 700m). Consider the situation of
switching from 3 lanes to 2 lanes. The demand is 3000 veh/h. For illustration purposes,
the process is also shown in figures below.
   180                                                                               A. TEST QUESTIONS

A  3000 veh/h

               vpc                          100                          80          100

               In normal conditions a pace car is introduced, driving at a speed vpc

   3000 veh/h

               100                     vpc                               80          100

                    700m                                             0m
                                                 300m

               After 700 m driving, the pace car has a gap in front of 300 m. The last
               vehicle of the platoon downstream of the pace car is 300 downstream of

               the pace car, at the location of the change of layout

   3000 veh/h

                                  100

                                                                         100 vpc 80  100

               Upstream of the pace car, the road switches to a 2 lane road with a 100
               km/h speed limit

   3000 veh/h

                                       100                               100              100

               If the pace car is out of the narrow section, it adapts its speed to the speed
               limit if not limited by traffic. Otherwise, it adapts it speed to the vehicles
               in front.

   Exercise 151. Calculate the speed at which the pace car needs to drive. (1 point)

       The pace car acts hence as moving bottleneck, and will continue driving at this speed
   throughout the bridge section, and then (instanteneously) speed up to the free speed.

   Exercise 152. Indicate the traffic states in the flow density diagram and sketch traffic
   states in the space-time diagram (and relate them to each other using shock wave the-
   ory). (no vehicle trajectories needed) (hard question: 6 points awarded for 9.5 points).
   Tip for sketching: choose the demand low in your graph (for simplicity you may assume
   other flows to be higher). If you did not find an answer for the question above, assume it is
   driving 60 km/h. (6 points)
A.7. PROBLEM SET 7  181

Exercise 153. Give the name of the mild congestion located at a bottleneck location in A.6.4. TRAFFIC STABILITY A

Kerner's three phase traffic flow theory (1 point)

    In the flow-density plan, this is an area rather than a line.

Exercise 154. Link this to the Wiedeman car-following principle. (indication: 100 words)
(2 points)

A.6.5. LEVELS OF DESCRIPTION

One can argue that there are three levels at which traffic can be described: microscopic,
macroscopic, and network-level. On the microscopic level, traffic behaviour can be in-
dicated by a spacing-speed diagram.

Exercise 155. Sketch this diagram. (2 points)

Exercise 156. Sketch the matching diagram in the flow-density plane; indicate how the
values for this graph can be obtained from the previous graph.(2 points)

Exercise 157. Give is the name for the flow aggregated on network level (1 point)

Exercise 158. Give the name for the density aggregated on network level (1 point)

Exercise 159. Sketch the matching Network Fundamental Diagram for the network level
in the same graph as the fundamental diagram of question b, and briefly comment on the
difference (50 words).2

A.7. PROBLEM SET 7

A.7.1. SHORT OPEN QUESTIONS

Upstream of an junction is a controlled intersection.

Exercise 160. Which distribution is likely to describe the number of arrivals per time in-
terval (i.e., flow) on the main road near this junction (and downstream of the controlled
intersection)? Name and explain briefly why (no need to comment on the equations of the
distribution functions). (2 points)

Exercise 161. Argue why traffic instability can only occur under platoon instability. (2
points)

    Traffic dynamics can be described by linking three variables, usually indicated by x,
N, and t.

Exercise 162. Describe the physical meaning of N(x,t). (1 point)

Exercise 163. Describe the difference between calibration and validation of a traffic model.
(Indication: 40 words) (2 points)

Exercise 164. Which relationship is described by the macroscopic fundamental diagram.
In your answer, make sure to be specific enough that the answer does not apply for the
fundamental diagram. (There is no need to comment on the shape, traffic process leading
to the shape or to name specific terms - indication: 25 words) (1 point)
182  A. TEST QUESTIONS

A book is 1.22. For pedestrian traffic, a typical value for the capacity which can be found in a hand-

                  Exercise 165. What are the units for this capacity. (1 point)
                  Exercise 166. What is the physical meaning of these units? (1 point)
A.7. PROBLEM SET 7                                      183

A.7.2. CUMULATIVE CURVES                                          A

Consider the following road layout:

x=5550 m                             x=6700 km
Offramp                              Drop to two lanes

A three lane road has an offramp just downstream of 5500m, and a lane drop at approxi-
mately 6700m.

    Cumulative counts are obtained from Fosim.

Exercise 167. Name the two main limitations of using cumulative curves for delay deter-
mination in real world conditions. (2 points)

    On the next page, you find the cumulative curves, the moved cumulative curves (i.e.,
corrected for the free flow travel time), the slanted cumulative curves (offset 3900 veh/h),
and the slanted moved cumulative curve (i.e., corrected for the free flow travel time). (If
you cannot differentiate colors, raise your hand to get explanation on the lines!)
   184                                                                                                                                                              A. TEST QUESTIONS

A                         5000                    Cumulative curves                                                                                  Moved cumulative curves
                          4500
                 N (veh)  4000                                                        x=500 m                       N (veh)  5000                                                        x=500 m
                          3500                                                        x=3500 m                               4500                                                        x=3500 m
                          3000                                                        x=4000 m                               4000                                                        x=4000 m
                          2500                                                        x=4500 m                               3500                                                        x=4500 m
                          2000                                                        x=5000 m                               3000                                                        x=5000 m
                          1500                                                        x=5200 m                               2500                                                        x=5200 m
                          1000                                                        x=5500 m                               2000                                                        x=5500 m
                                                                                      x=5800 m                               1500                                                        x=5800 m
                           500                                                        x=6700 m                               1000                                                        x=6700 m
                              0                                                       x=7500 m                                                                                           x=7500 m
                                0                                                                                             500
                                        0.2  0.4  0.6            0.8          1       1.2                                        0         0.2       0.4       0.6       0.8     1         1.2
                                                                                                                                   0

                                                  Time (h)                                                                                                     Time (h)

   N-q0 t (veh)  1400          Slanted (offset 3900 veh/h) cumulative curves                    N-q0 t (veh)  1500            Moved slanted (offset 3900 veh/h) cumulative curves
                 1200                                                                                         1000
                 1000     x=500 m                                                                                            x=500 m
                          x=3500 m                                                                             500           x=3500 m
                  800     x=4000 m                                                                                           x=4000 m
                  600     x=4500 m                                                                                           x=4500 m
                  400     x=5000 m                                                                                           x=5000 m
                  200     x=5200 m                                                                                           x=5200 m
                          x=5500 m                                                                                           x=5500 m
                     0    x=5800 m                                                                                           x=5800 m
                 -200     x=6700 m                                                                                           x=6700 m
                 -400     x=7500 m                                                                                           x=7500 m
                 -600
                                                                                                              0
                       0
                                   0.2  0.4  0.6            0.8       1          1.2                          -500  0                 0.2       0.4       0.6       0.8       1     1.2

                                                  Time (h)                                                                                                Time (s)

   Exercise 168. Describe the traffic operations (or sketch the traffic operations in space-
   time): This should show: is there an temporal bottleneck? Why does congestion end (de-
   mand or supply)? Where is the head and tail of the queue approximately. Also indicate
   what information you use to get to this conclusions. (3 points)

   Exercise 169. Estimate the (free flow) capacity of the bottleneck in veh/h from the curves.
   (2 points)

   Exercise 170. Estimate the capacity drop in veh/h from the curves. (2 points)

       The total delay due to the queuing is determined by summing the delays for all vehi-
   cles.

   Exercise 171. Argue whether the delay would differ if a vertical queuing model for the
   bottleneck was used, and if so, would the delay be less or more with a vertical queuing
   model. (2 points)
A.7. PROBLEM SET 7  185

A.7.3. MACROSCOPIC TRAFFIC VARIABLES A

           IN CASE OF DIFFERENT VEHICLE CLASSES
Suppose there are two classes of vehicles, fast vehicles driving 120 km/h and slow ve-
hicles moving at 90 km/h. At the entrance to the road (x=0), an equal number of each
type of vehicles is measured under a total flow of 1000 veh/h (so 500 veh/h each). For
some subquestions you might need answers of earlier subquestions, which you could not
answer. In that case, assume an answer, state so on your answer sheet and continue with
the assumed answers.

Exercise 172. Calculate the density on the road. Base your answer on the density of the
slow vehicles and the fast vehicles. (3 points)

Exercise 173. Calculate the space mean speed. (2 points)

Exercise 174. Calculate the time mean speed. (2 points)

Exercise 175. Give the equation for Edie's generalised definition of density. (1 point)

    There is an observer moving at 60 km/h.

Exercise 176. Calculate the flow of fast moving vehicles passing this observer. (3 points)

Exercise 177. What is the time mean speed (absolute to the road, not relative to the ob-
server) of the vehicles moving this observer (hard question: 3.5 points, yielding 2 points) (2
points)

Exercise 178. Will the flow of slow moving vehicles passing the moving observer be larger
than, equal to or lower than the flow of the fast moving vehicles passing the moving ob-
server. Argue (rather than calculate) why. (2 points)

    The capacity of the road is, independent of the vehicle class, 2000 veh/h, and the
jam density is, independent of the vehicle class, 125 veh/km. Assume the car-following
behavior of both classes can be described by Newell's car-following model.

Exercise 179. Draw (not sketch) the fundamental diagrams for the two vehicle classes (2
points)

Exercise 180. If we take the fast vehicles as reference, what is the pce value (or fce, "fast
car equivalent") of the slow vehicle (so expressed in units of fast vehicles) (1 point)

Exercise 181. Give the car-following model equation for the fast vehicle, including the
values of the parameters for the fast vehicles (only the free flow branch is needed). (3
points)

    Consider these traffic operations at a two lane road. According to a lane selection
model, all fast vehicles stay left and all slow vehicles stay right.

Exercise 182. What is the name of this model (only the name is needed - no reasoning).
(1 point)

    Now consider a different traffic state. Once traffic goes into the congested state, the
fast cars move to the fastest lane.

Exercise 183. Give the name of this state called according to three phase traffic flow the-
ory. (1 point)
186                                     A. TEST QUESTIONS

A Consider a road for which on all of the lanes a triangular fundamental diagram holds A.7.4. SLOW TRUCK ON THE MOTORWAY

                  with a critical density of 25 veh/km, a capacity of 2000 veh/h and a jam density of 125
                  veh/km. There is a two-lane road for a length of x<2km, and with an extra third lane for
                  x>2km. The traffic demand is 3000 veh/h. At t=0 a wide truck (special transport) joins
                  the road from x=0, driving at 15 km/h. This truck blocks two lanes, so in the two lane
                  section, there are no overtaking possibilities: see figure.

Traffic demand:                15 km/h
3000 veh/h

                                        x=2 km
                                        Third lane starts

                 x=0 km
                 Truck enters

Exercise 184. Sketch the traffic operations (both in space-time and in flow-density) for
the time up to the moment the truck reaches the three lane section. (5 points)

    After the truck reaches the downstream section, vehicles can overtake. The capacity
point lies at k=60veh/km and q=2600 veh/h for the whole roadway.

Exercise 185. Sketch the traffic operations (both in space-time as in flow-density) from
the moment the truck reaches the three lane section. Sketch the slopes of the waves which
occur from that moment, but do not consider possible waves which start later.(5 points)

A.8. PROBLEM SET 8

A.8.1. SHORT OPEN QUESTIONS

Exercise 186. Give the name of the distribution describing the headway distribution if the
arrival process of vehicles is independent. (1 point)

    A particular distribution function describes the number of vehicles per aggregation
interval well if the flow on the road is high.

Exercise 187. Give the name of this distribution. (1 point)

    The lane flow distribution is the ratio of the flow in a lane over the total flow.

Exercise 188. Express the relative flow in lane i fi as function of the average headways
< hi >, which are given for all lanes i on a motorway (3 points)

    The theory of slugs and rabbits states there are two types of cars/drivers on the road.
Assume they both have a pce value of 1.

Exercise 189. Give the meaning of the letters pce (give the full words). (1 point)

    Consider the theory of slugs and rabbits. The demand (in veh/h) of slugs is equal to
the demand of rabbits. Assume a two-lane road operating below critical density at all
lanes.
A.8. PROBLEM SET 8  187

(qualitatively - no numbers are needed)? Give your reasoning. (2 points) Exercise 190. What is the distribution of the flow over the lanes in free flow conditions A

Exercise 191. Explain how stop-and-go waves emerge. Use, name, and describe the two
most relevant levels of stability in your answer. (3 points)

Exercise 192. Explain why in the three phase theory of Kerner there is not one value for
capacity. (1 point)

    One of the advantages of using Lagrangian coordinates is that traffic predictions do
not have "numerical diffusion".

Exercise 193. Explain in your own words what "numerical diffusion" is. (1 point)

A.8.2. MICROSCOPIC EFFECTS ON THE FUNDAMENTAL DIAGRAM

Exercise 194. Give the conditions under which the fundamental diagram holds. (1 point)

    When aggregating traffic, a better fundamental diagram can be found if instead of a
rectangular area in space-time a parallelogram is used.

Exercise 195. Explain why, discussing free flow conditions as well as congested condi-
tions. In your answer, also indicate the slopes of the edges of the parallelogram. (3 points)

    Traditionally, the density is calculated at one moment in time over a road section,
and the flow is calculated over a time period at one location.

Exercise 196. Give the name for the definitions used to express flow and density for an
area in space-time. Equations are not needed. (1 point)

    During acceleration, one could observe deviations from the fundamental diagram.
Consider multi-anticipation, i.e. drivers adapting their speed not only on the leader, but
also on vehicles further downstream. This influences amongst others transitions from a
congested state to capacity.

Exercise 197. Describe for this transition the effect of multi-anticipation on hysteresis
and sketch the effect of these changes in the flow-density plane (also show the normal FD
in this graph as reference).4

A.8.3. PREDICTION OF DOWNSTREAM CONDITIONS

The number of lanes on a freeway reduces from 3 to 2 to 1, as sketched below.

    The one lane section forms an active bottleneck. Assume throughout this question
a triangular fundamental diagram, equal for each of the lanes, with a free flow speed of
100 km/h.
188  A. TEST QUESTIONS

A lane. His speed is 8 km/h and he estimates the gross spacing to his predecessor in the In the three lane part, a driver is driving in congestion due to the reduction to one

                  same lane at 11m. (If you are at one part unable to find the correct answer, assume one,
                  state so clearly, and continue with the next part of the question).

                  Exercise 198. Assuming homogeneous conditions, calculate the flow through the bottle-
                  neck. (4 points)

                  Exercise 199. Calculate the jam density for the three lane part. Hint: use the capacity of
                  the three lane part. (4 points)

                  Exercise 200. Calculate the speed of the vehicles in the two lane section. (3 points)

                       Changes of inflow can lead to a changing traffic state. Adapting inflow can then make
                  the traffic state stationary (i.e. constant over time). Consider one of these stationary
                  situations, with congestion spilling back to somewhere in the three lane section

                  Exercise 201. Sketch the flow (aggregated over all lanes) as function of space for this situ-
                  ation. (1 point)

                       Consider all possible stationary situations, which have a different accumulation (i.e.,
                  nr of vehicles in the area).

                  Exercise 202. Sketch the traffic production (here, average internal flow in veh/h) as func-
                  tion of the accumulation. Values are not needed in the sketch. (2 points)

               A.8.4. DEMONSTRATION OF POLICE CARS

                  The police are planning a demonstration by which they drive 30 km/h on all lanes of the
                  motorway. In practice, the police cars travel as normal vehicles in the traffic stream be-
                  fore the demonstration. And at t=0, they slow down instantaneously to 30 km/h. During
                  the demonstration (the slow driving), there are no overtaking possibilities. In this ques-
                  tion, the traffic state upstream of the police cars is referred to as "congestion". See the
                  figure below for an idea.

    In this question we consider the following variables:

    1. The duration of the demonstration d

    2. the demand (assumed constant throughout the demonstration), qin.
After the demonstration, the police cars instantaneously accelerate to the free flow speed.

    Assume a triangular fundamental diagram with a free flow speed of 80 km/h, a ca-
pacity of 2000 veh/h/lane (indicated C ) and a jam density of 150 veh/h/lane. Consider a
two lane road with no on and off ramps.
A.8. PROBLEM SET 8  189

high demand (demand is higher than the flow in congestion). (6 points) Exercise 203. Sketch the traffic states in space-time and in the flow density plane for a A

Exercise 204. Calculate the flow in the congestion. (3 points)

Exercise 205. Sketch the moved cumulative curves for the inflow and the moved cumu-
lative curves for the outflow with the demonstration. Consider the inflow point upstream
of any queue, and the outflow point downstream of any queue. Consider time frame from
well before the demonstration to well after any queue. (4 points)

Exercise 206. Show that the total delay (D) is given by the equation
D = (1/2)  d 2  qin  C /(C - qin). (4 points)

Exercise 207. What happens to the delay if the demand approaches capacity? Explain
from a traffic flow perspective why. (3 points)

Exercise 208. Sketch the traffic states in space-time and in the flow density plane for a
demand lower than the flow in congestion (2 points)

Exercise 209. Argue whether the equation for the delay still holds in this case (1 point)

Exercise 210. Give the reasoning why the delay is quadratic as function of duration of the
demonstration (3 points)

A.8.5. STAIRS FOR CYCLISTS AT DELFT TRAIN STATION

Currently, the station in Delft has an underground bike parking. To get to the street level,
the cyclists need to dismount, and walk their bicycle up the stairs. See the picture below.
Assume all cyclists do so with the bike at their right. The figures below give an impression
of the site, although not at peak demand

Exercise 211. Calculate the capacity for this site based on an assumption of headway
between people walking their bike. (3 points)

    In the peak hour, a train arrives. Suppose 300 passengers leave the train station by
bike using these stairs. Suppose the difference between the first passenger leaving the
bike parking and the last one is 2 minutes. Assume a triangular demand pattern at the
bottom of the stairs:
                  190                                              A. TEST QUESTIONS

A Demand
                               (cyclist/min)
                                     q0

                                              1 min          Time
                                                     2 min

Exercise 212. Calculate the value for q0 in this pattern. (3 points)

    Assume the capacity C is lower than q0. Number the cyclists 1...N in order of leaving
the bike parking. The cyclist with the highest delay due to queuing is NE .

Exercise 213. Derive the equation for NE as function of C and q0. Give your reasoning.
(If you are unable to give the equation, points can be awarded for a description of the
construction.) (4 points)

A.9. PROBLEM SET 9

A.9.1. SHORT QUESTIONS

The Macroscopic Fundamental Diagram relates the average density to the average flow.

Exercise 214. Give the name for the term used to indicate the average flow. (1 point)

Exercise 215. On a particular road the Greenshields fundamental diagram holds, with
a free flow speed of 80 km/h and a jam density of 100 veh/km. Does this determine the
capacity with no further assumptions? If so, calculate. If not, why not. (3 points)

Exercise 216. Describe what an acceleration fan is. (2 points)

    On a road, traffic is measured using loop detectors at a cross section. For each aggre-
gation period the flow is given as output, as well as the time mean speed of traffic passing
that detector. Then, densities are computed from the speed and flow, and a relation be-
tween speed and flow is plotted.

Exercise 217. Explain whether there is a bias in the densities; if yes, explain which and
why; if no, explain why not. (3 points)

Exercise 218. Traffic in a model is locally stable. Can the platoons be unstable? Explain
why or why not. (2 points)

Exercise 219. Explain when and why "random seeds" are needed (approximately 100
words, no equations needed). (2 points)
A.9. PROBLEM SET 9                                                                 191

Helly's car-following model is given by the following equations: A.9.2. CAR-FOLLOWING IN FOG A

                                                a = v +  s - s                     (A.10)
                                               s = x0 + vT                         (A.11)

In this equation, a is the acceleration, v denotes the speed, v the difference in speed
between the leader and its predecessor, s the spacing. Parameters in the model are ,
, x0 and T . The interpretation of the parameters, and the meaning of s is left to the
students. For reasons of simplicity, the time dependence and reaction time are ignored

in this question.

Exercise 220. Derive the equation of the fundamental diagram, q=q(k), from the above
equation for the congested branch. Hint: use the relation v=v(s) in the derivation.4

The model can be calibrated and validated.

Exercise 221. Explain what is the value of validating the model (i.e., what can a validated
model be used for, which cannot be done with a non-validated model).(1 point)

    The following parameters are found to fit the traffic best:
 = 0.3s-1,  = 0.08s-2, x0 = 20m, T = 1s. (In this line, s means second and m meter).
Besides the car-following part, also a free speed is required to derive a full fundamental

diagram. This is found to be 30 m/s.

Exercise 222. Compute the capacity of the road in veh/h (hard question)(2 points)

    The Dutch government recommends drivers in fog: "Half the speed, double the space
headway to the predecessor". Suppose everyone takes this advice.

Exercise 223. Compute the capacity of the road in the fog. You may (but do not need to)
relate this to question 2c; in case you did not find an answer to that question, assume an
answer and state so explicitly.(3 points)

A.9.3. CLEANING THE ROAD

Consider a one-lane road for which the following fundamental diagram holds:

                                     Fundamental Diagram
         60

              50

              40

Speed (km/h)  30

              20

              10

              0   0  20  40  60  80 100 120 140

                             Density (veh/km)

This is a well-known fundamental diagram.
192                                        A. TEST QUESTIONS

A Exercise 224. Give the name of the shape of this fundamental diagram.(1 point)

                  Exercise 225. Compute the capacity of the road.(2 points)

                  Exercise 226. Sketch the fundamental diagram in the flow-density plane.(1 point)

                       A cleaning car enters the road to clean the road, driving at 15 km/h.

                  Exercise 227. Compute the maximum flow upstream of the cleaning car using the given
                  fundamental diagram.(2 points)

                       The inflow to the road is 1200 veh/h; the cleaning car enters the road at x=1km and
                  leaves at x=2 km. Overtaking is not possible.

                  Exercise 228. Construct the traffic state using shockwave theory: i.e., sketch the traffic
                  operations in the flow-density plan and in space-time(6 points)

A.9.4. MOBIL LANE CHANGING MODEL

The Mobil lane change model describes whether drivers change lanes or not. The equa-
tions for a European system (keep right unless overtaking) are given by the following
equations. The utility for a driver is given by:

     Utot = Uc + P (Uo +Un )               (A.12)

The utility is calculated for each lane. Acceleration is considered as utility, and subscripts
indicate the current vehicle (c), the old follower (o) and the (potential) new follower (n).
A lane change to the right is performed if

     Utot right -Utot left  ath - abias    (A.13)

A lane change to the left is performed if

     Utot left -Utot right  ath + abias    (A.14)

Exercise 229. Explain the working of the Mobil lane change model in words (approx 100
words); in your answer, include an interpretation for P . (3 points)

Exercise 230. Give approximate values (including units) for ath and abias, and reason
why (3 points)

A.9.5. PEDESTRIANS AT A TRAFFIC LIGHT

Consider pedestrians approaching the traffic light at a busy intersection. The pedestri-
ans arrive independently at the traffic light at a flow of 1200 peds/h. The cycle time is
120 seconds. Assume all pedestrians cross the road simultaneously (next to each other)
in negligible time and then the traffic light turns red again. (So the pedestrian traffic
light is red for 120 seconds, then all pedestrians cross instantaneously and the traffic
light turns red again instantaneously). A sketch of the situation is found below:
A.9. PROBLEM SET 9                                                              193

B                                                                                         A
Zone y
                                   Bottleneck, width=60cm
Zone z               Vertical queuing,
A                    negligible travel time

                       Cycle time 120s,
                       Crossing time negligible

                           Vertical queuing
                             Pedestrians,
                             1200 peds/h

Exercise 231. Give the name of the distribution of the number of pedestrians arriving per
red time. (1 point)

Exercise 232. How many pedestrians cross during a green phase. (2 points)

          Weidmann proposed the following fundamental diagram for pedestrians.

                               Weidmann fundamental diagram
          1.4

          1.2

          1

Flow [?]  0.8

          0.6

          0.4

          0.2

          0    0  1  2  3            4  5  6

                        Density [?]

Exercise 233. Give the units for the values at the axes. (2 points)

    The pedestrians cross (simultaneously) during the green phase and arrive at the other
side. After a short (negligible) distance, the sidewalk has a bottleneck of 60 cm wide. As-
sume that the Weidmann fundamental diagram holds. You may assume this bottleneck
has no length (e.g., a door on the sidewalk).

Exercise 234. Calculate how long would it take the pedestrians to pass the bottleneck. (3
points)

Exercise 235. Sketch the moved cumulative curves for this situation (inflow at the blue
dashed line "A", outflow at the blue dashed line "B") for a period of one cycle. Start your
sketch just before the moment the traffic light is green, i.e. the pedestrians are about to
cross the road. Hint: at that moment, how many pedestrians have then crossed line A and
not line B? (3 points)
194                                                              A. TEST QUESTIONS

A On a road the following fundamental diagram holds under equilibrium conditions. A.9.6. HYSTERESIS

                   2500         Fundamental diagram

                   2000

Flow (veh/h/lane)  1500

                   1000

                   500

                   0     0  25  50  75  100            125  150

                                Density (veh/km/lane)

However, due to the delayed reaction of drivers, hysteresis occurs. Copy the fundamental
diagram to your answer sheet.

Exercise 236. In the fundamental diagram, sketch which path the traffic states make in
the transition from congestion to capacity and back. Argue why. (2 points)

Exercise 237. Draw (not sketch) the fundamental diagram in the speed-spacing plane. (3
points)

Exercise 238. Sketch the hysteresis of question a in the fundamental diagram in the speed-
spacing plane. (1 point)

A.10. PROBLEM SET 10

A.10.1. SHORT QUESTIONS

Consider a road where vehicles are arriving independently.

Exercise 239. Give the name for the distribution of the number of vehicles arriving within
a time interval on this road. (1 point)

    The pce value of a truck is claimed to be 2 for a road without queue warning systems.

Exercise 240. Explain in your own words what a pce value of two means. (1 point)

    A study shows that by installing queue tail warning systems the capacity of the road
increases. The factor by which it increases is 1.05 for passenger cars and 1.09 for trucks,
meaning it can handle 5% more or and 9% more trucks.

Exercise 241. Based on the information above, calculate the new pce value for trucks for
the road with queue warning systems (3 points)

    Traffic simulation in Lagrangian coordinates has the advantage that there is less nu-
merical diffusion.

Exercise 242. Explain in your own words what numerical diffusion in traffic simulation
is. (1 point)
A.10. PROBLEM SET 10  195

Exercise 243. Explain what is meant by local instability in traffic. (1 point) A

Exercise 244. Can a stationary tail of the queue occur due to a moving bottleneck? If so,
explain how. If not, explain why not. (2 points)

    Someone claims traffic on a road is behaving according toa Greenshields funda-
mental diagram with free flow capacity=2000 veh/h, critical density = 20 veh/km and
kjam=150 veh/km.

Exercise 245. Is this possible? If so, sketch the fundamental diagram in the speed-density
plane and comment on the construction; if not possible, argue why. (2 points)

A.10.2. TRAFFIC FLOW PROPERTIES

Consider the following flow contour plot (left) and speed contour plots (right):

Exercise 246. Derive in which direction traffic is flowing (2 points)

    The spatial scale is lacking.

Exercise 247. Reason what is the length of the road shown in the figure. Base your answer
on traffic properties. (2 points)

Exercise 248. Does traffic at this day exhibit a capacity drop? If so, estimate the capac-
ity drop, and explain how you find it. If not, explain how a capacity drop would show.
For clarity, hand in the graphs in which you indicate the various observation points. (2
points)

A.10.3. SPEEDS

Consider a road with slugs and rabbits

Exercise 249. What are the behavioural assumption(s) with regard to lane choice for rab-
bits in Daganzo's theory of slugs and rabbits. (1 point)

    Traffic is in a two-pipe regime, and the speed of rabbits is 100 km/h and the speed
of slugs is 80 km/h. Instantaneously on the the road, the amount of slugs and rabbits is
equal.

Exercise 250. Compute which fraction of flow is rabbits. (2 points)
196  A. TEST QUESTIONS

A Exercise 251. Compute the time mean speed. (2 points)

                  Exercise 252. Explain how the mean speed can be computed using Edie's generalised def-
                  initions. Equations only do not suffice; explanation of the working of the equations is
                  needed. (2 points)

               A.10.4. ANALYSE A CAR-FOLLOWING MODEL

                  For car-following, the following model is being proposed (Helly model):

                         a(t ) =  (vi (t - ) - vi-1(t - )) +  (xi-1(t - ) - xi (t - ) - s0 - T vi (t - ))

                  In this model, x denotes the position, v denotes the speed and a denotes the acceler-
                  ation, all evaluated at a time t or t -  ( >0 representing a reaction time); subscripts i
                  and i -1 indicate the current vehicle or its leader, respectively. Further parameters of the
                  model are s0 and T , as well as sensitivity parameters  and .

                  Exercise 253. Explain the working of this model in words.(2 points)

                  Exercise 254. Sketch the congested branch of the fundamental diagram in the speed-
                  spacing plane. To do so, first derive this relationship in mathematical expressions.(5 points)

                       Due to hysteresis not all traffic states are on the fundamental diagram.

                  Exercise 255. Sketch in the speed-spacing plane how traffic states move in the fundamen-
                  tal diagram, i.e. indicate hysteresis. Motivate your answer.(2 points)

                       The fundamental diagram can be transferred to the flow-density plane.

                  Exercise 256. Derive this relationship mathematically.(2 points)

               A.10.5. TRAFFIC LIGHT

                  Consider a road at an intersection. The traffic can be described with a triangular funda-
                  mental diagram with a capacity of 1500 veh/h, a free flow speed of 50 km/h and a wave
                  speed of -15 km/h. The inflow is 1000 veh/h.

                  Exercise 257. Sketch the fundamental diagram in the flow-density plane.(1 point)

Exercise 258. Compute the jam density. (2 points)

    At t=0, the traffic light turns red for 2 minutes. Then, the traffic light turns green for
0.5 minute, after which the traffic light turns red again for 1 minute. Afterwards, the
traffic light stays green.

Exercise 259. Using shockwave theory, sketch the traffic states in the space-time diagram
and show the states and waves in the flow density diagram. Comment on how you find the
lines. (9 points)
A.10. PROBLEM SET 10                                                                197

A.10.6. MACROSCOPIC FUNDAMENTAL DIAGRAM A

For a zone the following Macroscopic Fundamental Diagram holds:

                            Macroscopic Fundamental Diagram
       400

                         350

                         300

Performance (veh/h)      250

                         200

                         150

                         100

                         50

                         0     0  20     40  60  80 100 120 140

                                             Accumulation (veh/km)

The performance on the vertical axis indicates the outflow out of the zone; the total road
length in the network is 3.8 km. Assuming homogeneous and stationary traffic condi-
tions, the following cumulative inflow and outflow curves are obtained:

                         1500                Cumulative curves

Cumulative veh nr (veh)  1000

                         500

                                                                       Inflow
                                                                       Outflow

                         0     0      2      4            6         8           10

                                                Time (h)                            The inflow curve is a result of (exogenously

given) demand.

Exercise 260. Sketch the inflow pattern as flow over time; estimate the maximum flow
into the road. (2 points)

Exercise 261. Explain the shape of the outflow curve; in particular, include a description
of the process underlying the shape from t=2h to t=5h. (3 points)

Exercise 262. Explain how perimeter control can reduce delay. (2 points)

Exercise 263. Sketch in the graph the amount of total delay that can be reduced; comment
on your construction. (2 points)
                  198                                                                     A. TEST QUESTIONS

A Consider the trajectories of pedestrians in this figure: A.10.7. NON-VEHICULAR TRAFFIC

The trajectory of pedestrian C is temporarily horizontal.

Exercise 264. Does this imply he is standing still? Argue why. (1 point)

    Pedestrian traffic can be described with the social force model

Exercise 265. Give a conceptual description of the model (equations are not needed); in
your answer, include whether the model is microscopic or macroscopic. (3 points)

A.11. PROBLEM SET 11

A.11.1. SHORT QUESTIONS

Exercise 266. Describe what characterizes the difference between a cellular automaton
model and another car-following model. (1 point)

Exercise 267. Give a reasonable value (with unit) for the capacity of pedestrians. (1 point)

Exercise 268. Explain why the MFD does not have the same "pointy" top as a fundamen-
tal diagram for a road. (1 point)

Exercise 269. Explain why in the method of characteristics, characteristics cannot cross
each other in the xt=plane. Comment on an intersection of characteristics of the same
traffic state and of different traffic states. (2 point)

    In a traffic stream with independent arrivals, both the exponential probability distri-
bution function as well as the Poisson distribution function play a role.

Exercise 270. Give the name of the variable of which the distribution is quantified by a
Poisson distribution (be precise). (1 point)

A.11.2. BIKING QUEUES

A group of 50 people approaches a traffic light with a flow of 1 cyclist per 2 seconds. A
traffic light is red when they approach, and turns green 10 seconds after the last person
has arrived at the traffic light. The capacity is 1 cyclist per second.

Exercise 271. Sketch the cumulative curves upstream and downstream of the traffic light
(assuming vertical queuing). (2 points)
A.11. PROBLEM SET 11                                                                199

Exercise 272. Indicate how the delay can be computed with cumulative curves. (1 point) A

    One can approximate the traffic operations with a triangular fundamental diagram.
Then, the same questions could be computed with shockwave theory.

Exercise 273. Argue whether the delay computations would be different using shockwave
theory, and if so, whether they would be smaller or larger. (2 points)

A.11.3. SPEED AVERAGING

Consider a group of cyclists all following the same circular route: 80% rides a normal
bike, and 20% a bike with electrical support motor. Cyclists at a normal bike move at 15
km/h and those with an electrical support motor move at 25 km/h

Exercise 274. Argue whether the time mean speed is higher or lower than the space mean
speed.(2 points)

Exercise 275. Compute the average speed on the track using Edie's generalised definitions
of traffic. Show the steps you take. (4 points)

A.11.4. EXPERIMENT OF ACC EQUIPPED CARS

An experiment was carried out with vehicles driving an adaptive cruise control, i.e., the
vehicle adapts the speed to its predecessor, which is measured by radar. The graph be-
low shows the resulting speeds.

       16

Speed (m/s)  14

             12

             10

                 0    20  40                        60  80                     100

                                          Time (s)                                       The

platoon consists of these three vehicles

Exercise 276. Give the convention of numbering vehicles: upstream to downstream or
downstream to upstream. (1 point)

Exercise 277. Indicate which line relate to each of the vehicles 1 to 3. Argue why. (2 points)

Exercise 278. Comment on the local stability for these vehicles. (1 point)
Exercise 279. Comment on the platoon stability for these vehicles. (2 points)
200                                                                 A. TEST QUESTIONS

A Consider a road with a bridge. Drivers do not exceed the speed limit. In congestion, they A.11.5. ACCIDENT DOWNSTREAM OF A BRIDGE

                  act according to the Helly car following model. The acceleration a at moment t is given
                  by:

                a(t ) =  (v(t - )) +  s(t - ) - s                   (A.15)

t is the time, v is speed, and v is the speed difference with the leader. s is the spacing,

s is given by:

                s = s0 + T v(t - )                                  (A.16)

, s0, and T , as well as  and  are parameters on driving behavior.

Exercise 280. Explain the working of this model. (2 points)

Exercise 281. Give a realistic value for  (include units in your answer where relevant). (1
point)

Exercise 282. Reason which parameters determine the fundamental diagram. (2 points)

    On the road, there is a bridge At the bridge, driver behavior changes due to nar-
rower lanes. The fundamental diagram hence changes. Both fundamental diagrams are
shown.

Note both branches change.

Exercise 283. Reason which model parameter(s) change(s). Only comment on parame-
ters which can be derived from the fundamental diagram.2

    On a particular day, there are free flow traffic operations until an accident happens
downstream of the bridge which temporarily blocks the road completely. The tail has
spilled back further upstream than the bridge when the incident is cleared. Consider
constant inflow.

Exercise 284. Sketch the traffic operations in the time-space diagram, using a construc-
tion in the density-flow diagram. Show the construction steps. For simplicity, you may
assume the bridge has a length of 0 (but the capacity constrain remains). (8 points)
A.11. PROBLEM SET 11                                                                                                                         201

A.11.6. MOVING BOTTLENECK PRINCIPLES A

Consider a two-lane road with a Greenshields fundamental diagram. The free flow speed
is 60 km/h and the jam density is 100 veh/km/lane, hence 200 veh/km for the roadway.

Exercise 285. Argue whether this information is sufficient to specify the fundamental dia-
gram. If so, determine the roadway capacity. If not, indicate which information is missing,
and state a reasonable value for this. (3 points)

    A truck is driving slowly at 15 km/h. Traffic can overtake the truck. The capacity point
at the (moving) bottleneck is characterised by a density of 50 veh/km, and a flow of 1000
veh/h. This will yield congestion.

Exercise 286. Sketch the fundamental diagram in the flow-density plane (if needed with
the additional estimates).(1 points)

Exercise 287. Sketch how to find the states upstream and downstream of the moving bot-
tleneck in the fundamental diagram. (2 points)

A.11.7. MULTI-LANE TRAFFIC

Consider the following graphs, representing the fraction of flow and the fraction of den-
sity at each of the three lanes on the three lane part of the A13 motorway near Delft in
the evening peak.

0.5                                                                                                  0.5

0.45                                                                                                 0.45

0.4                                                                                                  0.4

0.35                                                                                                 0.35

0.3Fraction                                                                                          0.3
                                                                                           Fraction

0.25                                                                                                 0.25

0.2                                                                                                  0.2

0.15                                                                                                 0.15

0.1   0  50  100      150          200                                                               0.1   0  50  100  150              200

         Roadway density (veh/km)                                                                             Roadway density (veh/km)

Exercise 288. Argue which line denotes the left lane, which the center lane and which one
the right lane.(2 points)

Exercise 289. Argue which graph denotes the fraction of flow and which the fraction of
density. (3 points)

A.11.8. MACROSCOPIC TRAFFIC SIMULATION

A road is split into cells of length x. For each of the cells, the same triangular funda-
mental diagram holds. This fundamental diagram is depicted in the speed-flow plane.
202                                                                        A. TEST QUESTIONS

A FD speed flow
                                 120
                                 100

speed(km/h)  80

             60

             40

             20

             0   0  500  1000  1500   2000  2500

                         flow(veh/h)

Exercise 290. Draw (precisely, no sketch; use graph paper for this question) this funda-
mental diagram in the flow-density plane. Comment on the construction.3

             At a certain moment, the cells have the following densities:

Direction                      ---------------------

Cell number                    12 3 4 5

Density (veh/km) 5 20 100 20 125

Exercise 291. Calculate the flow (in veh/h) from cell 2 to cell 3 according to the cell trans-
mission model.2

Exercise 292. Calculate the flow from (in veh/h) cell 3 to cell 4 according to the cell trans-
mission model.3
          B

    SOLUTIONS TO TEST QUESTIONS

1 Note that there is a capacity drop here, so the fundamental diagram should either con-
tain a capacity drop (e.g., inverse lambda) or be curved.

2 Slugs stay always in the right lane (1) Rabbits choose the fastest lane (1) Free speed of
rabbits is higher than the free speed of slugs (1)

3 A count of the number of vehicles over time at one location (1).

4 A model describing the inflow and outflow of the vehicles, with a restriction on the
maximum outflow rate. The queues will not occupy any horizontal space (1). This is
basically two cumulative curves, inflow and outflow, at one location, in which the angle
of the outflow is maximized at capacity (1).

5 Time mean speed, since the faster cars are weighted higher (1)

6 u = 1/ i (1/vi )

7 1. Free flow => free driving + speed
    2. Synchonized flow => equal speeds in both lanes, speeds <70 km/h
    3. Wide Moving Jams => backwards travelling waves, v very low.
     (1 point for names, 1 for definitions)

8 Down-top => stop-and-go wave travelling backwards (0.5) Stop -and-go wave (0.5)
and a local bottleneck at 482 (0.5) causing an area of synchronised flow (congestion)
(0.5)

9 down-top. Finer structure within the congested part. (0.5) Moving bottleneck (0.5) =>
structure moves upstream (1) Data error at 8am (1)

                                                         203
204  B. SOLUTIONS TO TEST QUESTIONS

                 10 down-top, from the shockwave speeds (0.5) Incident (1) Synchronized flows (and
                  stop-and-go waves) (1) Moving bottleneck after resolving (1)

                 11 Trajectory of vehicle is its leaders' trajectory delayed in time (1) and moved back-

B wards in space (1).

                 12 1. Follower-leader (local) => over reaction on disturbance in one leader-follower
                          pair

    2. Platoon => disturbance grows in a platoon

    3. Traffic flow => space between platoons is insufficient, so a disturbance in a pla-
        toon causes a delay in the next platoon

13 Yes. Smoothing (1) of disturbances improves platoon stability (1). Thereby, the am-
plitudes of a disturbance are reduced (1).

14 A slower vehicle can merge into another lane, which causes a disturbance, growing
to a breakdown (1)

15 Now the lane distribution is uneven (1). If vehicles change towards lanes with lower
densities, a jam might be prevented (1).

16 Use the triangular fundamental diagram. For the congested branch, the equation is
q=2000-2000/100*(k-25). From the speed we q=kv=30k. Solving this set of equations (1),
we find k=50, and thus the flow of 30*50 = 1500 veh/h (1)

17
Starting with shockwave theory can be rewarded with 1 pt.

18
19 in I: flow 5000 veh/h, and density 62.5 veh/km, using the equation for the congested
branch used in e (1 point). In J: q=4500 veh/h, k=150 veh/km. Wij=-500/87.5=-5.7. So it
moves with 4.7 km/h upstream (1).
                                                                               205

20 Already in drawing

21 Speed is equal to the truck speed, 30 km/h. (1)

22 Width of a runner 75 cm (1 point for 50-100 cm), headway 1.5 sec (1 point for 0.9 to 2      B

seconds). 25 meters / 0.75 = 33,3 runners per roadway (both this, and the rounded values

are correct). The capacity is 33,3/0,75 x 3600 = 79,200 pedestrians per hour.

23 30,000/79,200 * 60 min/h = 23 min. (1)

24 Halfway: 1 hour duration of the passing of all runners (1) 30,000 runners in 1 hour
=> 30,000/60 = 500 runners per min. (1) Assumed earlier: 75 com width, 1.5 second
headway, so capacity is 1/(0.75 * 1.5) = 0,89 ped/m/s = 53 ped/m/min (1) The required
width: 500/53 = 9,4 meters. (1)

25 The congested branch is not a line, but an area (1)

26 An MFD relates the average density in an area, the accumulation, to the average flow
in the area

27 The MFD is flattened at the top compared to the regular FD (1). This is due to averag-
ing effects: the top can only be reached if all links are operating at capacity. If some have
a over-critical density and some an under-critical, the average density can be critical, but
the flow is less than at capacity (1).

28 The CTM is a numerical scheme to calculate traffic flows in a macroscopic way (0.5),
based on demand of the upstream cell and supply of the downstream cell(0.5). The flow
is the minimum of both (0.5); demand is increasing with density up to the critical density
and remains constant afterwards, supply starts at capacity and starts decreasing from
capacity (0.5)

29 Lagrangian coordinates are used in macroscopic traffic flow description. Instead of
fixing coordinates at moments in space, the coordinates go with the traffic (1). Variables
used in this system are hence time, vehicle number (1) and speed. This is an advantage
since the representation of traffic flow equations is more accurate (no numerical diffu-
sion) (1)

30 The maximum flow on the road before the onset of congestion is higher than the flow
of vehicles driving out of congestion. (0.5) This phenomenon of drivers keeping a larger
headway after a standstill is called the capacity drop. (0.5)

31 Approximately a few to sometimes 30% is claimed
   206                                                                                                    B. SOLUTIONS TO TEST QUESTIONS

                                                       Flow demand 2

                                  2000

        Flow on detector (veh/h)  1500

B                                 1000

                                  500

                                  0   0      1000 2000 3000 4000 5000

   32                                                  Demand (veh/h)                      (1 for shape + 1 for capacity drop):

   33 the flow equals the demand (0.5), but is never higher than the capacity, and it will not
   decrease (no over-critical densities) (0.5). Capacity drop explained if present.

   34 Capacity is approximately 2000 veh/h/lane (1500-2500: 0.5 pt, possibly lower if urban
   roads are assumed and explained), so 4000 veh/h for the roadway (0.5)

   35 Effective green: (g - 3) seconds per direction (0.5). The cylce time is c = 2(g + 2) (0.5).
   Thus,g = (c/2) - 2 (0.5). Relative green time: 2 c g -3 = 2 c c/2-5 (0.5) = 1 - c10 .

   36 Relative green time per direction is half that of the total relative green time: 21 - c5 (1).

   The flow when effective green is 3600(sec/h)/2(s/veh)=1800 vehicles per hour, or 1/2

   vehicle per second (either flow value: 1 point). The flow per direction is thus 1/2( 12 - c5 )
                                                                                        1        5
   with  flow                            in  veh/s  and  c   in  seconds   or    1800(  2  -     c  )  with     flow    in  veh/h  and   c  in  seconds.

   (1 point)

   37 Both methods will yield the same answer, since not the queue length, but the flow is

   asked. (1) Most vehicles come from direction 2, so the green time (still equal) should be

   based                          on    direction   2  (1).  Using  the  equation       from     the      last  question,     we   have  1800(  1  -  5  )  =
                                                                                                                                                2     c
                                                                        1     5     8      94 .        5     101 ,
   800  (0.5).                          Solving  this  for   c  yields  2  -  c  =  18  =        So    c  =         so  c  =  50  seconds(0.5).

   38 Poisson distribution

   39 The cycle time is 120 seconds. The expected number of vehicles in a cycle is 120/60 
   800/60 = 160/6 = 26.7 (0.5) so  = 26.7 (0.5) 120 seconds cycle time, so 60 seconds per
   direction. 5 seconds are lost (2 s clearance time and 3 s startup loss), so 55 seconds lead-
   ing to floor(55/2)=27 vehicles at maximum through a green phase (0.5). The probability
   of an overflow queue is the probability that the number of cars arriving is 28 or larger,
   P (X >= 28) (0.5); this can be calculated by 1 - P (X <= 27) (0.5). This is calculated as
   p = k=0 k! 27 26.7k e-26.7 (0.5)

   40 The spread of a Poisson arrival process is larger(0.5), so the probability of having over-
   flow queues is larger(0.5; only with correct reasoning)

   41 Vehicles accelerate in principle with acceleration a, but this reduces when they ap-
   proach their desired speed (1) or if they approach their desired distance (1). The desired
   distance increases with speed.
                                                                            207

42 It is a translation of the leaders' trajectory (0.5), translated forward in time by a fixed
value  and back in space by x (0.5).

43 Choose two:

 Drivers are considering multiple vehicles ahead                                               B

 Drivers are unable to judge perfectly speed and gap

 Drivers are not changing acceleration continuously

 There is also interaction with lane-changing

44 Choose 2:
      It better captures the non-equilibrium conditions.
      There is a possibility that stop-and-go waves form (instabilities).
      Drivers have a finite acceleration

45 Choose 2 (1 point per good answer):
      In the IDM, drivers will, unrealistically, never reach their desired speed, not even
        if the distance is larger than the desired distance
      It has less parameters to calibrate - more realistic
      It is better understandable

46 Convert the densities to tunnel-wide properties. The critical density then is 4P/m

and the jam density 24P /m. (1) The capacity is vk=6 P /s. (0.5)

                     Fundamental diagram tunnel
        6

            5

Flow (P/s)  4

            3

            2

            1

            00  5  10  15         20  25

                   Density (P/m)          (0.5)

47 180P/min = 3 P/s (unit conversion: 0.5). Undercritical (of course, the tunnel is the

bottleneck!), so v=vf. k = q/v=3/1.5=2 P/m (0.5). That is 2 pedestrians per meter length,
so 0.5 pedestrians per m2 (1)
   208                                                B. SOLUTIONS TO TEST QUESTIONS

   48 30 vehicles in a 2 km section, so the density is 15 veh/km. (0.5)

                                   initial states
      2000

B  1500

            1

   1000

   500

        0
         0 20 40 60 80 100 120

                                                             (figure: 0.5);

   49 Draw a line with an slope of 15 km/h up in the fundamental diagram. You find the

   intersection with the congested branch at point 2. (0.5 point) The flow is lower than the

   initial conditions, so congestion occurs. (given)

                          all states

   2000

                    4
   1500

            1

   1000 7                 2
         6

   500                 5

            3

          0
            0 20 40 60 80 100 120

                                                              (0.5 points)
   For the xt-plot we start with the bottleneck at a constant x from t1 to t2. This causes traf-
   fic state 2 to occur. The boundary moves backwards with w1,2, which is the same as the
   angle in the fundamental diagram between state 1 and 2. (0.5). Downstream, the flow
   is the same as the capacity in 2, but in free flow (state 6) (0.5). After removal of the bot-
   tleneck, there are capacity conditions (0.5) and the shock waves propagate with speeds
   equal to the angle 2-4 and 1-4 (0.5 combined). From t 1 there also is a shock wave sepa-
   rating state 1 and 6, moving with a speed equalling the slope of line 1-6 in the FD (0.5).
   Trajectories: 0.5.
   All xt-plots are found in the next figure
                                                                                                                  209

                                                                          B

50 Since it is temporal, the density remains constant (1 point). This leads to the con-
struction of point 3 a the intersection of the line with a slope of 15 km/h and the density
of 15 veh/km (0.5, including showing this point in the graph). Trajectories 0.5.
51 It is given that the tractor moves back very slowly, so we start at the situation compa-
rable to b/ That means there will be a congestion state at the fundamental diagram where
people drive 15 km/h (0.5), state 2 in the graph. The moving vehicle forms a boundary
in shockwave theory (1), separating state 2 from another state where traffic moves out of
the queue. By using the speed of the tractor, we find state 7 (0.5) as outflow state. After
the tractor leaves the road, traffic is at capacity (0.5) and restores just like in question c
(0.5).
fundamental diagram (0.5) & trajectories: (0.5)
52 The tractor forms a moving bottleneck, and the boundary between two traffic states
(0.5). It separates the initial traffic state 1 from another traffic state where vehicles travel
at 50 km/h (1). Constructing this in the fundamental diagram is done by drawing a line
with a slope of 50 km/h down from point 1. We find the traffic state next to the tractor
at this point (0.5), drawing point 5 in fundamental diagram: 0.5. The end of the tractor
has a similar effect of a boundary (0.5) moving with 50 km/h. Constructing this in the
fundamental diagram gives back point 1 (0.5). So at both ends, we have traffic state 1
(1), and next to the truck state 5 (no points for that). There are no other shock waves.
Trajectories move either straight on, or are delayed a bit next to the tractor. (0.5)
   210                                                  B. SOLUTIONS TO TEST QUESTIONS

   53 The left one is Eulerian. Is shows numerical diffusion. Moreover, the grid structure
   in time and space is clearly visible, whereas in Lagrangian coordinates the grids follow a
   fixed time and the vehicles (trajectories are visible in the right figure) (1 point for one of
   the explanations)

B  54 The representation of traffic flow equations is more accurate (no numerical diffusion)

   (1); also, the calculations are more efficient since it is not needed to consider both the

   upstream and downstream cell as with Eulerian coordinates (e.g., CTM) (1)

   55 The relative amount of space (in time! -0.5 if not mentioned) that a non-passenger
   car vehicle occupies on the road

   56 Trucks are longer, which influences the pce value. If the pce is the ratio of the length
   + net headway, assuming the same net headway the pce value increases with deceasing
   speed.

   57 Trucks are longer, which influences the pce value. If the pce is the ratio of the length
   + net headway, assuming the same net headway the pce value increases with deceasing
   speed.

   58 Vehicles accelerate in principle with acceleration a, but this reduces when they ap-
   proach their desired speed (1) or if they approach their desired distance (1). The desired
   distance increases with speed.

   59 In regular cf-models, the drivers react on actions by their leader. In multiple-leader
   models, drivers take several leaders into account in determining their action

   60 Calculate for both leaders the desired distance:

              s1(v, v) = s0 + v T + v v                                       (B.1)
                                          2 ab

   and        s2(v, v) = s0 + 2  v T + v v

                                                        2 ab                  (B.2)

   Note that the desired distance to the second leader has twice the speed component.(1)

   Each of these will lead to an acceleration:

              a v 4 s 1 = a0 1 - - 1(v, v ) 2                                 (B.3)
              v0                                s                             (B.4)

              a v 4 s 2 = a0 1 - - 2(v, v ) 2
              v0                                x2 - x0

   (1) (Note the desired distance to the second leader is compared with the distance be-

   tween the second leader and current vehicle) These have to be combined into one accel-

   eration (0.5). For safety, we choose the minimum acceleration rather than for instance

   the mean:  dv
              dt = mi n{a1, a2}
                                                                              (B.5)

   (0.5)
                                                                 211

61 This basically is the same as the 2-leader model. First formulate the desired distance

to the n-th leader

                    sn(v, v) = s0 + nv T + v v                   (B.6)
                                                  2 ab

(1) Then calculate the resulting acceleration for each of them:                               B

                    a v 4 s n = a0 1 - - n(v, v ) 2              (B.7)
                    v0  xn - x0

These have to be combined into one acceleration (0.5). For safety, we choose the mini-
mum acceleration rather than for instance the mean:

                    dv                                           (B.8)
                    dt = min {an}

(0.5)

62 The edgy line is the flow, since at the start the demand will exceed the flow before
this is reversed. (Also: the flow will be capped at capacity (queue discharge rate) and is
expected to be constant for a while). Alternatively: the integral these curves are cumula-
tive curves, and the cumulative curve of the demand cannot exceed the one of the flow.
Therefore, the one reducing earlier is the flow)

63 The free flow capacity can be found by the flow at the upstream detector before con-
gestion sets in (1), so 4200 veh/h (read from the graph at the time congestion sets in)(1)

64 The queue discharge rate can be found by the flow after congestion has set in (1), so
3800 veh/h (1)

65 The free flow capacity is higher than the queue discharge rate, i.e., there is a capacity
drop (1 for either explanation)

66 The FD should have a capacity drop (see previous questions), so the simplest is to
assume an inverse lambda shaped FD (0.5 pt either by naming or in drawing) The free
flow capacity is found in question a: 3x2100 veh/h. Also the free flow speed is known
(from the speed figure): 100 km/h (0.5 for both combined). This gives the free flow
branch (0.5 point for drawing). The density matching the queue outflow rate can be
found on the free flow branch, by looking up the density for the queue outflow rate (0.5).
Kc=qc/vfree=1900/100=19 veh/km. (multiply by 3 for the 3-lane section (1)). Further-
more, it is known that with a flow of 2 lanes x 1900 veh/h/lane (the flow through the
bottleneck), the speed is 22,6 km/h (read from graph) (1 pt), which gives a density of
3800/22.6=168 veh/km (0.5 pt). Now, the congested branch can be constructed. We find
the wave speed w=q/k=((3*1900)-(2*1900))/(3*19 -168)=-17 km/h. The jam density is
found by kj=Kc-qc/w=3*(19-1900/-17.1)=390 veh/km (0.5 pt).
   212                                                                                                              B. SOLUTIONS TO TEST QUESTIONS

B  Flow (veh/h)  7000                                   Fundamental diagram 3 lanes
                 6000
                 5000                       50 100 150 200 250 300 350 400
                 4000                                           Density (veh/km)
                 3000
                 2000
                 1000

                     0
                      0

                                                                              Vertical queues
                                      4500

                                      4000

                                      3500

                 Flow (veh/h)         3000

                                      2500

                                      2000

                                      1500

                    1000                    0.1  0.2            0.3                            0.4  0.5
                          0
                                                      Time (h)
   67

   Points for the general shape (1) and for the correct times of flow change (1)

   68 The most useful offset is the maximum flow of the road which is maintained for a
   while, i.e. the queue discharge rate (1 pt). (Alternative: the free flow capacity: 1/2)

                                       x 105Slanted cumulative curves offset queue discharge rate
                                      2

                                                                                                            Flow

                                                                                                            Demand
                                      0

                 Cumulative vehicles  -2

                                      -4

                                      -6

                                      -8

                                      -10

                   -12                      0.1  0.2            0.3                            0.4  0.5
                       0
                                                      Time (h)
   69

   70 This is the area between the curves

   71 It takes a while before the congestion spills back to the second detector. Similarly,
   congestion resolves from the tail, so the flow starts following the demand already earlier
in time                                   Second detector                            213

      4500                                          Demand                                     B
      4000                                          Flow detector one
      3500                                          Flow second detector (upstream)
      3000
      2500                       500      1000                 1500  2000
      2000
      1500
      1000

            0

72 If we do not relax the assumption of the fundamental diagram, there are only two

speeds: the free flow speed and the speed for the state in the congested branch where

the flow matches the queue discharge rate for the 2 lane stretch. (1) The frequency at

which they are measured depends on the relative time of congestion (typically, 2 peaks at

each 1 hour of congestion, so approximately 10% of the time congestion) (0.5). Relaxing

the assumption of the fundamental diagram now, we do not find two exact values of the

speed, but a distribution centered around two values:

                                      Two speeds distribution

                          0.025

                          0.02

Probability of measuring  0.015

                          0.01

                          0.005

           0                          50                100          150
            0
                                          Speed (km/h)
(0.5)

73 Capacity is maximum flow, q=ku=25*80=2000 veh/h/lane. For a two lane section, this
is 4000 veh/h. (1 for points) plus 1 for graph

74 Since the tail is at the same place, the flow in the queue should be equal to the inflow
(1), so 2000 veh/h.

75 The fundamental diagram is described by q=C(1-((k-kc)/(kj-kc))); use kj=300;C=4000;kc=50;
(1) Use the fundamental diagram to find the density at q=2000 veh/h. (0.5) Solving
q=1000 veh/h gives k=175 veh/km (0.5)

76 The speed of the vehicle is equal to the speed in the congested state (1). Using q=ku
(0.5), this gives v=2000/175=11,4 km/h (0.5)
214                                                                                                                        B. SOLUTIONS TO TEST QUESTIONS

77 The truck drives at 11,4 km/h, and forms the moving bottleneck for 5 km. This can

be plotted in the space time diagram (1). The tail of the queue remains stationary (1).

                                       Time space moving bottleneck                                                        Fundamental diagram

     15                                             D                                                              4000 D     Fundamental diagram
B AC                                                                                                               3000       Shock waves

Space (km)
                                                                         Flow (veh/h)
     10                                                                                                            2000 A  B
                             B

     5                                                                        A                                    1000

                                    A  Vehicle      A

     0                                 Shock wave                                                                  0C
                                                                                                                    0 50
      0                                0.5      1      1.5                 2     2.5                                       100 150 200 250 300
                                                Time (h)                                                                    Density (veh/km)

For the solution of the traffic jam, construct the line in the FD between the jam point and
the capacity point (1). Finishing the figure: 1 point.

78 The queue has at maximum a length of 5 km, and the density is 175 veh/km - so
5*175= 875 veh.

79 Two-pipe regime and one-pipe regime

80 Two-pipe regime (1). Trucks drive in one lane, and passenger cars in the other, at
higher speeds (based on the density) (1).

81 The speed of the passenger cars is higher, so they will pass the stationary detectors
more "often" (1). Hence, the fraction of the flow will be higher (1).

82 Requested is the fraction of the flow of passenger cars, (class 1):  = q1/qtot = q1/(q1+
q2) = (k1v1)/(k1v1 + k2v2). (1 point for q=kv per class).
From the image we know k2=4/7*k1 (0.5 point), so  = (k1v1)/(k1v1 +4/7k1v2) = v1/(v1 +
4/7v2) (0.5 point) in which v indicates the speeds. Assuming v1=120 km/h and v2=80
km/h (1 point - assuming equal speeds maximizes the nr of points for this question to
1), we find:  = 120/(120 + 4/780) = ... (1)

                                       Average lane distribution km 40.11 - Speed Limit 120kph

                               1
                                                                                                      Median Lane

                               0.9                                            Centre Lane

                                                                              Outside Lane

                               0.8

                               0.7

         Fraction of the flow  0.6

                               0.5

                               0.4

                               0.3

                               0.2

                               0.1

                      0                         50                    100                       150
                       0
                                                    Density (veh/km)                                   If it is really quiet on the road, people keep
83

right (hence blue is right). When it gets busier, more people go towards the middle lane,
                                                                           215

and then towards the left lane. (0.5 for the right reasoning, 0.5 for drawing the right con-
clusions; no points for only conclusions; 0.5 if middle and median lane exchanged.)

84 Slugs stay always in the right lane (1) Rabbits choose the fastest lane (1) Free speed of
rabbits is higher than the free speed of slugs (1)

                                                                          B

85 Near capacity, the left lanes travel still faster then the right lane (1). All rabbits are
hence in the left lane, leaving gaps in the right lane (0.5) which hence has a lower flow
(0.5)

86 It averages the flow and densities (0.5) for an area (by which it differs from the regular
FD) (1) and relates them to each other (0.5)

87 The average flow decreases for the same average density if the traffic is distributed
less homogeneously over the network.

88 The speed is increasing with increasing spacing (0.5). There is a minimum spacing
(0.5) and a maximum speed (0.5). Plot: 0.5

                                      Lagrangian fundamental diagram
          120

              100

              80

Speed (km/h)  60

              40

              20

              00   20  40  60       80  100

                       Spacing (m)

89 Vehicles have a desired speed v which is determined by the distance to their leader
(1). The acceleration is proportional to the difference between their speed and the de-
sired speed.

90 Traffic must be stationary and homogeneous

91 If traffic is stationary, the acceleration is 0 (1), so v = v (1). Realising that k = 1/x

(0.5), or correcting for the units (density is in veh/km!) we find k = 1000/x (0.5), leading

to:

                           v = 16.8(t anh(0.086((1/k) - 25) + 0.913))      (B.9)

(0.5) This is the speed in m/s, which should be translated into km/h, so:

                           v = 3.616.8(t anh(0.086((1/k) - 25) + 0.913))   (B.10)

(0.5) Now applying q=ku=kv (0.5), we find

                           q = k3.616.8(t anh(0.086((1/k) - 25) + 0.913))  (B.11)

(0.5)
216                                                                                               B. SOLUTIONS TO TEST QUESTIONS

92 The fundamental diagram is shown below:

                                                             Fundamental diagram OVM

              1800

              1600

Flow (veh/h)                               1400

B 1200

                                           1000

              800

              600

              400

              200

              00                                 10      20      30  40               50  60  70

                                                             Density (veh/km)

From this, we read a capacity of approximately 1750 veh/h, the free flow speed is approx-
imately 60 km/h and a critical density of approximately 70 veh/km(1).

93 A free speed of 60 km/h could match a provincial road. However, the capacity for a
provincial road is usually not so high. For sure, the jam density would be more in line
with the jam density of motorways, i.e. well over 100 veh/km. Therefore, the fundamen-
tal diagram is not very accurate. It would be better to have a higher jam density, so scale
the graph on the horizontal axis , meaning the number 0.086 should be lower (by about a
factor 125/75=1.75 - increasing the jam density to 140). Then, the speed drops even fur-
ther, so that should be corrected (increase a factor 1.75), and then once more increased
by a factor of almost 2 to get a motorway speed . This means increasing 16.8 to 1.75 x 2 x
16.8=... While this would give a proper free speed and jam density, the capacity increases
to extreme values (1), so a proper parameter set is not possible

                                    Fundamental diagram OVM modified
        7000

              6000

              5000

              4000

              3000

              2000

              1000

              00                                 20  40      60      80 100 120 140 160

94 Drivers are expected to change lanes whenever it is beneficial for them (measured in
terms of acceleration) (1). They do take the other drivers' benefit into account, but less
then their own (at factor p) (1).

95 It can be expected that drivers take other drivers into account (p>0), but value their
benefits less then their own (p<1).

96 No, it does not. The drivers are all at the left lanes. There is no more acceleration in
the left lane, so the model does not give higher utility to the left lane.
                                                                                                                  217

97 Once the trucks come to a complete stop, upstream an congested area at jams density
will be created (0.5); downstream, there will be an empty road (0.5). There are three
shock waves. One with the free speed (30 km/h) separating the empty road with from the
initial state (1). One at the location of the stopped trucks, separating the empty road from

at a speed of q/k=1000/((1000/30)-425)=-2,5 km/h (upstream). (1 point) the jam state, at 0 km/h (1). Finally, there is a wave at the tail of the queue, propagating B

98 The start is the same as described in b. Then, at the head of the queue, vehicles are
freed. The fastest vehicles, passing the moving bottleneck, will drive at a free flow speed
of 30 km/h (1, including drawing in xt). The snow plows will form a moving bottleneck
driving at 5 km/h (1, including drawing in xt). Downstream of this moving bottleneck
there will be a free flow (0.5) traffic state with a flow of 2000 veh/h (given, 0.5) - this is
state 3. The plows will form a moving bottleneck, and hence the separation of two traffic
states, a congested upstream (state 4, unknown yet) and an uncongested downstream
(state 3). (0.5 point). Plotting: 0.5 point. State 4 can be found by plotting the shock wave
in the fundamental diagram, from state 3 upwards with a slope of 5 km/h (1). The shock
wave speeds between 4 and 1, as well as between 3 and 1 can be found by the slope of
the lines connecting these states in the FD (1).

99 The inflow is constant (constant raise of N at x=4 - 1 point), but the outflow is tem-
porarily zero (no extra vehicles temporarily in the graph (1). Hence, there is a temporal
blocking (0.5) completely blocking the flow. (0.5)
100 The total delay can be derived from the area between the cumulative curves (1).
In this case, we compare the cumulative curves where there is no delay (at x=4km) and
218                                                   B. SOLUTIONS TO TEST QUESTIONS

that where the delay is maximum (near x=25 km) (1). The surface between the lines is
(calculate: 1 point).

                 101 There is a temporal blocking, so the general pattern is as follows:Space

B Space-time
                                            100
                                              90
                                              80
                                              70
                                              60
                                              50
                                              40
                                              30
                                              20
                                              10

       100 200 300 400 500 600 700 800 900 1000  (1)
                                         Time

The head of the queue, and thus the location of the blocking is between location 16 and

20 (1). The tail is between km 8 and 12, since there is no delay (1)

102 The capacity is the derivative of cumulative curve during the outflow (0.5), here 2000
veh/h (0.5). The jam density can be derived from the number of vehicles between the
cumulative curves in standstill: here 120 veh/km (480 veh in 4 km) (1). The slope of
the congested branch van be determined by the speed at which the head of the queue
(0.5) moves backward, e.g. at 16 km at t=0.6 and 12 km at t=0.8, i.e. 4 km in 0.2h = 20
km/h (0.5). The critical density then is the jam density minus the capacity divided by the
shock wave speed (120-2000/20=120-100=20veh/km - 0.5 pt). The free speed then is the
capacity divided by the critical density, i.e. 2000/20=100 km/h.

103 The limiting point for the flow is not the amount of space in the room, but the vis-
itors watching the piece of art (1). Because then there are more visitors that can have
a look at the art at the same time, because they do not stand crowded around a single
object but have a large circumference to stand around (1).

104 I assume every visitor wants to be in the front row (1 point) for the assumed watch-
ing time of 30 seconds per person (10 s - 2 minutes: 1 point). Finally, I assume the width
of a pedestrian to be 75 cm (50-110 cm: 1 point). The circumference of the show case
is 2x3+2x1=8 meter, which means 8/0.75=10 2/3 visitors can stand at the circumference.
(Both rounding to an integer number of visitors, as continuing with the real number is
OK - arguing that the spots are not predefined, but dynamically filled). The capacity is
10 visitors per 30 seconds = 20 visitors per minute.(1)

105 When stepping on the moving walkway, visitors keep a gross distance headway of
approximately 75 cm (50-110 cm: 1 point; net=gross-20cm); assume a single lane of vis-
itors (for the best view) per walkway. The walkway moves with an assumed 0.5 m/s (0.2-
1.5: 1 point). The flow is then 1/0.75*.5=2/3 visitor per second = 40 visitors per minute.
(0.5) Since there are walkways at both sides, the capacity is increased to 80 visitors per
minute. (0.5)
                                                                                 219

106 The figure shows the size of the square approximately 500x50/2=12,500 square me-
ters(0.5) The maximum density for pedestrians is approximately 5 ped/square meter (3-
10: 0.5 pt). So, at times square at maximum 75,00 people can stand (0.5). The claim
cannot be strictly right.(0.5)

107 Speeds in both lanes are equal(1). Alternatives with speeds etc: 0.5 points                B

108 Sketch showing the areas in more or less the right place (0.5), with appropriate
names (0.5). Note that synchronized flow is an area (1)

109 There is no capacity(0.5), since there is a probability of breakdown from free flow to
synchronised flow(0.5). This is an increasing function with flow. (Remarks on the area in
synchronize flow: no points)

110 The coordinates move with the traffic, rather than that they are fixed at a certain
location

111 No numerical diffusion, so more accurate results

112 Traffic is flowing from bottom because the congested patterns propagate in the op-
posite direction.

113 Bottleneck at km 14 (0.5), creating congestion and instability (1 point for this causal-
ity) leads to wide moving jams (0.5 for name)

114 Local: a change of speed of the vehicle cause oscillations with increasing amplitude
in speeds with the direct follower (or not)
String: the amplitude of speed disturbances grows (or not) over a platoon,
Traffic: the disturbances within a platoon are propagated (or not) to the next platoon
(one point for the names, one point for the explanation)

115 The stability of traffic is one of the levels of above - we only need to consider that
level. We see wide moving jams (or stop and go waves) emerging from an area of conges-
tion, so traffic is unstable in the congested branch. (1) That means traffic is also platoon
unstable. (1). Traffic is in general locally stable (only instable in simulations)

116 In the two pipe traffic state (0.5) traffic has different speeds in each lane / slugs and
rabbits are separated (0.5); in one pipe traffic state (0.5) slugs and rabbits mix and the
speeds are the same (0.5)

117 According to slugs and rabbits, the traffic is more present in the left lane (1), whereas
for the Mobil lane change model there is a stronger tendency for drivers to take the right
lane if there is no other vehicle.(1)

118 Stationary means that the traffic stream does not change over time (1). Homoge-
neous means that the traffic state does not change with space (the same at different lo-
cations) (1).
220                                                                                            B. SOLUTIONS TO TEST QUESTIONS

119 It cannot, since the FD gives the equilibrium conditions (1), and drivers have differ-
ent ways to reach these equilibrium conditions. (1)

                 120 The right one is the triangular, since there is no influence of density in the speed in

B the free flow part

                 121 2 plots - for each one point. 1 point for the values

2500                                                                                      100

2000                                                                                      80

Flow (veh/h)1500                                                                          60
                                                                            Speed (km/h)
1000                                                                                      40

500                                                                                       20

     00          50        100            150                                             00   500 1000 1500 2000 2500

                     Density (veh/km)                                                          Flow (veh/h)

122 This is an urban area, so the free flow speed is around 50 km/h. (0.5). The jam
density is hardly dependent on the conditions, so around 125 veh/km/lane (0.5) The
capacity is a bit lower than in motorway conditions, at around 1200 veh/h/lane (1000-
2000 veh/h/lane: 0.5 point). Draw this for a 4 and 1 lane part (0.5 point)

     q               7

           23                             4
              1
                        6                      5
   123
                                                     k
x
                           5              7        2                                                     1a
                                                                                                     1b
                                       6          3
                                               54                                              1a

                        1a

                                                                        t

If during the green phase the queue completely dissipates, the inflow should be lower
than the capacity for the one lane part (1). Starting with the traffic light in green/red: 1
point. During the red phase, the flow is zero, so we get jam density in the 3 lane part
                                                                             221

(0.5) and the 1 lane part (0.5). Once the traffic light turns green, there is capacity outflow
(state 7 - 0.5 point). Once the backward shockwave reaches the part where the crane
is, the flow in the part where the crate is, is now limited to the of one lane (0.5). In the
downstream part, we now have the same flow in the free flow branch (0.5). An congested

the traffic states). Now, connect all traffic states (2.5 points). traffic state with the same flow occurs upstream of the crane area (1 point) (5.5 points for B

124 Upstream, the inflow is equal to the flow in 1 (0.5). Downstream, the flow is zero
(during the red phase)(0.5), the flow of 7 (0.5), the flow of 2 and the flow of 1 once the
queue has been dissolved. (0.5)

x  5      7      2          1a

       6     3          1b
             54

   1a               1a

                                                                          t
N

                                                                                t

125 The delay is the area between the blue and the black line

126 If the crane is further from the intersection, state 7 lasts longer (1). Hence, the far-
ther upstream the crane is, the longer the steep increase of the blue line (0.5) and the
smaller the delay (0.5).

127 Still, the traffic operations next to the moving crane are at capacity conditions as
long as there is a queue waiting. (0.5) Hence, we have point 3 (0.5). The crane forms a
moving bottleneck and these are shocks which connect to the free flow and congested
states on the fundamental diagram downstream and upstream (1 point for mentioning,
1 point for drawing correctly in FD). The remainder of the shocks can now be drawn (1
point for finishing)
222                             B. SOLUTIONS TO TEST QUESTIONS

        q          7
                             9
B

           23                   4

   18              6                    5
                                             k
x
               5      7 2 8 1a
                                    1b
                      33
                   6  5 49

               1a               1a

                                                                             t

128 The Network Fundamental Diagram describes the production (0.5) average flow
(0.5) as function of the accumulation (0.5) , i.e. the number of vehicles in a network
(0.5) Also possible: the performance (0.5), i.e. the outflow (0.5), as function of the accu-
mulation. Wrong combination of terms and meaning costs 1 point.

129 NFD plot with flattened top (top: 0,5 point).

130 The NFD goes up and down, just like the regular FD, but the top is flattened (1 pt,
including graph). The flat top is caused by the fact that not all roads can be operating at
capacity (1)

131 Once the roads get more congested, the blocking back causes the traffic to slow
down.

132 See the course slides. If the inflow is limited, the production can be higher, and
hence the outflow can be higher (1). Without control, the inflow into the protected net-
work can be higher than the outflow out of the protected network(1), thereby steadily
increasing the accumulation(1). The higher the accumulation, the lower the outflow,
until finally a gridlock situation occurs.
                                                                          223

133 A car-following model describes how the position, speed or acceleration of a fol-
lower depends on the movement of the leader

134 The relative amount of space (in time! -0.5 if not mentioned) that a non-passenger      B

car vehicle occupies on the road

135 The road could handle 1 passenger car per unit of time (without loss of general-
ity, choose time unit appropriately such that this is correct) or 0.5 truck (0.5 for this
reasoning, or any other leading anywhere). Now, this would be 1.05 passenger car of
1.09*0.5=0.545 truck (1). To get the pce value, one has to divide the maximum truck flow
over the passenger flow (1): 1.05/0.545 = 1.92.

136 This means that the the solution is more exact; a platoon or stop-and-go wave will
for instance spread in a Eulerian coordinate system, whereas this will stay together (resp
the wave will remain sharp) in the Lagrangian coordinates.

137 Comfortable accelerations lie in the order of 1 m/s2, strong braking in the order of
6 m/s2. A threshold value to accelerate would hence be around 1 m/s2 (0.3 to 2: 1 point)

138 It is the politeness - how people value the acceleration of others. This can be as-
sumed to be between irrelevant (value: 0) and just as important as themselves (value:
1)

139 Flow in ped/s/m (max: 0.6-2), density in ped/m2 (max: 4-12 1 point) Base for in-
stance the flow on a 1.5s headway per lane (similar to car traffic), leading to 1/1.5=0.67
ped/s/lane. In 1 meter, at 60cm width per ped, 1,67 fit next to each other (leading to 1
or two lanes). Being partly next to each other, the lane capacity is multiplied by 1.67:
cap=.97*1.67=1.1 ped/m/s

140 Capdrop: 0.5 point. Decreasing speed): 0.5 point. General shape: 0.5

                                Flow speed
     120

              100

Speed (km/h)  80

              60

              40

              20

              00   1000 2000 3000 4000 5000

                   Flow (veh/km/lane)

141 Free flow speed (100-120 km/h), critical speed(75-95 km/h), critical density(17-30
veh/km/lane), jam density (100-200 veh/km/lane). 1 point for the densities, 1 for the
speeds. 1 point for matching numbers (q=ku) at capacity (free flow / critical)
224                                                                            B. SOLUTIONS TO TEST QUESTIONS

              10000                                  Cumcurves bridge
               8000
                                          Inflow
                                          Outflow

B 6000N (veh)

                                    4000

              2000

              00                          0.5  1  1.5                  2  2.5

142                                            Time (h)

143 In 15 minutes 3500/4=875 vehicles arrive, which are in the queue. After the bridge
opens, the queue length reduces (3500 veh/h in 4500 veh/h out)

144 See the cumulative curves. The total delay is the total area between the lines.(1)
In this case, the congestion reduction phase lasts 875/(4500-3500)*60 = 52,5 min, (1) so
in total congestion lasts 67,5 minutes. (0.5). This is a triangle, which surface is being
determined by the height times the width times divided by two. The surface then is 67,5
min * 875 veh/ 2 /60 (min/hr) = 492 veh h. (0.5)

145 From one point different waves occur: a fast one to high speeds, and a backward
moving one to lower speeds.

146 At the beginning there is no flow (the first vehicles need some time to arrive - 0.5)
and it then gradually increases (0.5) to the capacity (1) which it will asymptotically reach
(so no touching!) - 1.

147 This is downstream. The fastest wave travels at free flow speed (0.5). This is de-
rived from the fundamental diagram (0.5). The Greenshields fundamental diagram is
a parabola (0.5). To find the parameter (1 pt): the speed decreases linearly with the
density. The capacity is found halfway the density range, so at 60 veh/km. The speed
there can be determined by v=q/k=5000/60=83 km/h. Since the speed-density relation
is linear, the speed at k=0 is twice as high: v0=83*2=166 km/h Other possibility: for the
sake of calculation, flip the parabola to a form upside down, and move it to such that
the top at (0,0) and increasing flow. The parameters are found by a(60)2 = 5000 (0.5),
so a = 5000/3600 = 1.39veh/h/(veh/km)2 = 1.39km2/veh/h (0.5). The speed is the
derivative (0.5), i.e. 2ax at x=60. That means v=2*1.39*60 = 167 km/h. (0.5) Note that
it is unlikely that a wave will travel that fast in Dutch motorways. So the wave arrives at
200 m downstream 500/(167/3.6)=11 seconds after the bridge closes.

     Because this is a hard question, the final points are divided by 2.

148 For each of the FDs one point. Note the congested branch is uninfluenced for the
congested part, so is overlapping with the three lane FD
8000    Three fundamental diagrams                 225
6000
4000                               3 wide lanes              B
2000                               2 wide lanes
                                   3 narrow lanes
    0
     0  100  200  300  400

149 The question relates to: where do the free flow line for 80 kms/h and the congested
line cross. (0.5) The free flow line is: q=80k (0.5). The congested line is q=100*25-25*(k-
25). (0.5) Setting q equal gives kc=29.8 veh/km/lane and q=2381 veh/h/l/lane. (0.5) For
three lanes this gives 7129 veh/h. (0.5)

150 In busy conditions, the increased capacity causes less queuing, and hence a lower
travel time (0.5). In free flow conditions, the higher speed causes lower travel times. (0.5)

151 The last vehicle downstream of the pace car needs to travel 1000 meters, where the
pace car travels 700 meters. Upstream, the traffic has a speed of 100 km/h (0.5), so the
time is 1000/(100/3.6)=10*3.6=36 seconds (0.5). The pace car hence has to drive 700
meter in 36 seconds (0.5), hence the speed is 700/36 * 3.6 = 70 km/h. (0.5) (the factor 3.6
is for unit conversion to km/h.

152 Traffic is in free flow conditions (0.5), at a flow of 3000 veh/h (0.5), giving a state in
high speeds (state 1) (0.5) and at 80 km/h in the narrow lane section (state 2) (0.5 - lower
speeds). At a certain moment, the pace car enters, driving at 70 km/h leaving a gap in
front (state 0) (0.5) Upstream there will be a congested state at the fundamental diagram
for three wide lanes (0.5) at 70 km/h (0.5) (state 3). The capacity for the two lane part at
70 km/h (the pace car still determines the speed) is point 4 (0.5). This is lower than the
local demand, state 3. Hence, there will a congested state upstream (state 5 - 1 pt) with
the same flow as the congested state in the two lane section. Once the pace car leaves
the road, a flow equal to the capacity of the two lane section exits the congested state 4.
The head of this tail is moving backward (just like a head of a queue once the traffic light
turns green). Downstream in the 3 lane section, the same flow (capacity flow of the two
lane section) is found. Then, two possibilities arise (based on your sketch - no need for
exact computation): (1) backward wave gets to the end of the bridge before the forward
bridge reaches it. Then, in the three lane section a congested state with the same flow
as the capacity in the two lane section is arises. Possibility (2) is that the forward wave
is earlier, and in that case the congestion solves from the tail. Drawing the space time
diagram: 2 points: (cumulative: 9.5, divide points by 1.5 because it is a hard question)
226                                            B. SOLUTIONS TO TEST QUESTIONS

q          100 km/h                    x          1     0      6        1

              80 km/h                  bridge 2         046 1
              3 70 km/h
B 35 7  6

              7 01

        12 4           5                       1

inflow                       Start of                1

     0                       pace car

                          k                                       t

        Solution 1: backward wave gets to the end of the bridge before
        the forward bridge reaches it

q          100 km/h                    x          1     0      6        1

              80 km/h                  bridge     2     04  6        1
              3 70 km/h
        6
              7 0 35
                                                            1

        12 4           5                       1

inflow                       Start of                1

     0                       pace car

                          k                                       t

        Solution 2: backward wave gets to the end of the bridge after

        the forward bridge reaches it

153 Synchronized flow
                                                                   227

154 Wiedeman states that drivers will not react to minor speed differences if they are
below a certain threshold (1). That is similar to the synchronize flow area (0.5) which
states that drivers are willing to accept various time headways at different speeds (0.5)

155 Speed increases with increasing spacing (0.5). No values for smaller spacings than a        B

critical value, and for higher spacings the speed is constant (0.5) (at the desired speed).

                                           Speed-spacing
                   120

                   100

Speed (km/h)       80

                   60

                   40

                   20

                   00      20      40  60                 80  100

                                   Spacing (m)

(1 for graph)

156 Free flow speed is slope (0.5), critical density is 1/critical spacing (0.5), jam density

= 1/min spacing. (0.5)

                          Fundamental diagram
    3000

                   2500

Flow (veh/h/lane)  2000

                   1500

                   1000

                   500

                   0    0      50               100           150

                               Density (veh/km/lane)

A piecewise linear speed-spacing diagram leads to a triangular fundamental diagram
(0.5 - not asked in wording, but a wrong shape will get a reduction in points).

157 Production

158 Accumulation

159 (it is lower and it has a flattened top. (1) Plotting: (1). The right part is mainly theo-
retical, since one cannot reach that state (not needed for points).
   228                                                               B. SOLUTIONS TO TEST QUESTIONS

                                           Fundamental diagram
                      3000

                      2500

   Flow (veh/h/lane)  2000

B                     1500

                      1000

                      500

                      00    50  100                             150

                            Density (veh/km/lane)

   Good reasoning as well: in a network, the speeds are lower, so the overall NFD is lower.

   160 The controlled intersection causes headways to be more spread (1). In this case, the
   negative binomial (1) function is a good way to describe arrivals.

   161 If the platoon is stable, it means traffic disturbances damp out within the platoon
   (1). That means that they cannot grow from platoon to platoon, which is the definition
   for traffic instability (1)

   162 N(x,t) indicates how many vehicles have passed location x at time t

   163 With calibration, one finds the best parameter settings for a model (1), whereas in
   validation, one checks how good this (optimized) model works for another situation (1)

   164 An MFD indicates the relation between the outflow out of (or internal flows in) an
   area to the number of vehicles in that area

   165 Capacity is given in ped/m/s

   166 The capacity indicates the number of pedestrians per unit of time per unit of width.

   167 (1) One has to estimate the number of vehicles in the road section at the start, (2)
   there is a increasing error from miscounts (3 - less of an issue) one does not have obser-
   vations from the vehicles leaving or entering the road section (one has not here in this
   case either - therefore 0.5 point)

   168 The queue starts at the bottleneck, since there is delay between x=6700 and x=5800
   (there is a distance between the moved slanted cumulative curves of 6700 and 5800) (1).
   The delay spills back to approximately 3500m (there is still a little delay between 3500
   and 4000m) (1). The congestion solves by a lower demand, seen from the demand curve
   (only that: 0.5 pt) and the fact that the delay at the more upstream locations solves earlier
   (add that: 0.5).
                                                                                    229

169 The most accurate reading is from the slanted curves.

                                             Capacity drop determination
              800

                       500

              600      3500

                       4000

              400      4500

N-q0 t (veh)           5000

              200      5200

                       5500                                                                    B

              0        5800

                       6700

              -200     7500

              -400

              -600  0  0.2   0.4  0.6       0.8                           1  1.2

                                  Time (s)

Before congestion it has a slope of approximately (650- -400)/(1.2 - 0.2)=1050 veh/h (1).
This should be added to the offset to get the flow (0.5): 1050+3900 = 5050 veh/h (0.5) -
reading from the non slanted curves 1 pt. Reading the maximum flow from the highest
value on the three lane section: 0.5 point (it is a flow, but not related to the capacity)

170 The difference between the flow before congestion sets in and after it has set in
is the capacity drop (1). After congestion has set in, the slope is approximately 0 (0.5)
(or equalling a flow of 3900 veh/h). The flow 1050 veh/h lower than before congestion,
which is the value for the capacity drop (0.5)

171 Yes, the delay would differ since the delay of the vehicles leaving at the offramp
would not be taken into account (1). Hence, the delay computed with a vertical queuing
model would be less (1)

172 The partial densities can be calculated by k=q/v per class (1), leading to k1=500/120=4.2
veh/km and k2=500/90=5.6 veh/km (1). The total density is the sum of these two (0.5),
9.7 veh/km (0.5)

173 For the space mean speed, one can (a) average the paces or (b) Put weight on the
speed values the speeds using the densities (either method: 1 point). (a) The result is
1/((1/90+1/120)/2) (0.5) = 102.8 km/h (0.5) (b) The result is 4.2 * 120+ 5.6 * 90 /(4.2+5.6)
(0.5 point) = 102.8 km/h

174 (i) For the time mean speed, one observes as many slow as fast vehicles (equal
flows). (1) Hence, the mean speed is (90+120)/2 (0.5 pt) =105 km/h (0.5 pt). If b is the
correct answer to c and c the correct answer to b: 1 point total.

175 kEdie = Area in space-time Total time spent (1 point)

176 Use the equation qrel=kfast*vrel (1). kfast=4.2 veh/km (0.5) and vrel=120-60=60
km/h (1). Therefore,qrel=4.2*60=250 veh/h

177 Calculate - in the same way as above - the flow of the slow moving vehicles: qs-
low=5.6*20=113 veh/h (2). Now, average the speeds:

                                  vmean = (qslow  80 + qfast  120)/(qfast + qslow)  (B.12)

(1 point) = 107.6 (0.5)
   230                                                                        B. SOLUTIONS TO TEST QUESTIONS

   178 The flows passing a fixed observer are equal, and relative speed difference with the
   fast vehicles is larger. (1) Hence, using qrel=k*vrel, the flow of the fast vehicles becomes
   relative larger (1).

B                     2000         Fundamental diagrams

                      1800                                         Fast
                                                                   Slow

                      1600

                      1400

        Flow (veh/h)  1200

                      1000

                      800

                      600

                      400

                      200

                      0     0  20  40  60  80            100  120        140

   179                                 Density (veh/km)

   1 point for each line

   180 1 since the capacities of both vehicle classes are equal

   181 Newell's car-following model is described by the equation

                                                         xi(t ) = xi-1(t - ) - sjam  (B.13)

   (1 point)  can be found as 1/capacity (1) 1/2000 (/h), or 3600/2000=1.8 s (0.5). sjam can
   be found as 1/jam density (1), or 1/125 (/km), or 1000/125=8 m (0.5)

   182 Slugs and Rabbits

   183 Synchronised flow

   184 Only the two lane part is relevant here, so draw that fundamental diagram (1 point
   for the FD with the correct axes (per roadway, rather than lane). The initial conditions
   (A) can be indicated in the FD (0.5). Now, the traffic upstream of the truck is driving at
   15 km/h (0.5), hence we get a congested state at the line q=15*k, leading to B (0.5 point).
   The trajectory of the truck can be put in xt, driving at 15 km/h (1 point). The congested
   state B spills backwards with a speed of which the slope equals the slope of A-B in the
   fundamental diagram (1 point). Downstream of the truck, there is an empty road (0.5)
   and the matching shockwave between that and state A (0.5)

   185 Draw the fundamental diagrams (1 point), and the capacity point C (0.5). The truck
   forms a bottleneck, and hence moving at 15 km/h, (0.5) through point C, there is a line
   with a slope of 15 km/h (0.5), connecting downstream point E (0.5) and upstream point
   D (0.5). Shockwaves 0-E (0.5) and ED (0.5) can now be drawn. In the two lane section,
   state is at the two-lane fundamental diagram: a congested state at the same flow of D -
                                                                                                                  231
point F (1 point). Shock wave BF at the speed of the line BF in the FD (0.5 point).

                                                                          B

186 Exponential
232                                                  B. SOLUTIONS TO TEST QUESTIONS

187 Binomial distribution

188  fi = qi = qi = 1/ hi 

Bq                                     all lanes qi  all lanes 1/ hi   (B.14)

(The step at each equal sign is 1 point)

189 Passenger car equivalent

190 The demands are equal, hence the flows of slugs and rabbits are equal (0.5). They
are separated in free flow conditions (1), so the flow in both lanes is equal (0.5)

191 If a platoon is unstable (0.5) a small disturbance can grow over the platoon (0.5). If
the disturbance also grows beyond the platoon into the next platoon (0.5) this is called
platoon instability (0.5). A small disturbance hence can grow until vehicles come to a
complete stop (0.5).

192 Breakdowns occur stochastically, and with a higher flow, the probability of a break-
down is higher. Then, there is not a single value for capacity.

193 It means that the predicted traffic states are not exact; shock waves get spread out
over space if time progresses (1)

194 Traffic must be stationary and homogeneous

195 Traffic characteristics move with the slope of the fundamental diagram. (1 pt, word
characteristics not needed) Simplifying to a triangular fundamental diagram, they move
either forward with the free flow speed or backward with the wave speed. A parallelo-
gram with slopes free speed and wave speeds (1) aggregates hence a more homogeneous
traffic states.

196 Edie's (generalised) definitions

197 Due to this multi-anticipation, drivers will accelerate earlier out of the congested
state (1) (even before the density will go down as much as usual - i.e., the FD). Hence,
the speed and thus the flow go up faster than normal (1). The end situation (capacity)
is the same(1). We hence get a transition line above the congested branch (1: sketch).

 flow

                              density
                                                                                                                                                                                                           233

198 The flow through the bottleneck is equal to the flow in the jam (1). This is found by
q=ku (1). k=1000/11*3=273 (0.5 + 0.5 for the *3 part) and u=8 (0.5). Hence, q= 273*8=2182
veh/h (0.5)

part (0.5), which is the flow through the bottleneck (0.5). So the capacity is 3*2128=6545 199 The capacity point for the three lane part is three times the capacity of the one lane B

veh/h (0.5). The critical density is hence 6545/cfree=65 veh/km (1). The wave speed
can be found by realising the point q=2182 and k=272 lied on the FD (0.5). Now, the
jam density can be found in various ways. For instance: the wave speed is dq/dk, with
dq=-(6545-2182)=-4364 and dk=272-65=207 w=-21km/h. kj=kc+C/w=67+3*2182/21=375
veh/km (1)

200 This question relates to the flow in the two lane section in a congested state (0.5)
for a flow of 2182 (0.5). The density is exactly between the critical density (2/3*65=44
veh/km) and the jam density (2/3*375 = 250 veh/km), so at 294/2=150-3=147 veh/km.
(1) The speed then is u=q/k=2182/147=15 km/h (1).

201 Since the traffic state is stationary, the shock waves must have slope zero, so the
flows must be equal. (1)

202 For all stationary states, the flow is the same for all locations. Hence, the average
flow is the same as the outflow. (1) This increases as in the FD up to the critical density,
and then remains at that maximum (1).

203 Sketch the FD (1). Draw a line with slope - speed - 30 km/h from the origin (0.5).
This is the line where the congested state must lie, i.e. at the intersection of this line and
the FD - indicate in FD (1). The original traffic situation is at a demand level higher than
this flow (given) at the free flow branch (0.5). After the police cars speed up, the state
returns to capacity (1). Indicate the connections in the FD (1) and in space-time (1)
The following graphs are sketches, and the units are not matching the question at hand.

4000        D          Fundamental diagram                                                                                                                    Time space moving bottleneck
                                                            Fundamental diagram
3500                                                        Shock waves                                                           16                                                         D
                                                                                                                                  14                            C
                   B
                                                                                                                                                      A                  B
3000
                                                                                                                                  12
2500 A                                                                                                                            10
Flow (veh/h)
                                                                                                                      Space (km)
2000 8

1500                                                                                                                              6

                                                                                                                                                                                                   A

1000                                                                                                                              4

                                                                                                                                        A                        A

500                                                                                                                               2     Vehicle

                                                                                                                                        Shock wave

0        C                                                                                                                        0

      0        50  100  150               200  250                               300                                                 0                   0.5  1            1.5                  2     2.5

                        Density (veh/km)                                                                                                                         Time (h)

204 Calculate the intersection point of the line with slope v0 and the FD (1) Description
of the congested FD: q=C-C*(k-kc)/(kj-kc) (1). Fill in values, and solve:
C -C  (k - kc)/(k j - kc) = v0k
k=104 veh/km (1) q=v0 k (0.5)= 30*104 = 3130 veh/h (0.5)
234                                                                                          B. SOLUTIONS TO TEST QUESTIONS

205 Inflow is constant (0.5), so a straight line with slope of demand (0.5). Outflow is

equal to the inflow until the moment that the police cars enter (0.5). From that moment

in time, the outflow hence slope is 0 (1). After they leave, the flow is the capacity (not

asked), so steeper outflow (0.5), up to the moment they are at the same vehicle level

B (0.5), after which they are at the same line (0.5)
                              Cumcurves police demonstration
   6000

                  Inflow
                  Outflow

   5000

   4000

N  3000

   2000

   1000

            0                       0.5
            -0.5           0                                  1     1.5

                                    Time (h)

206 The delay is given by the area between the two lines in the graph above (1). The max

nr of vehicles in the queue (Nmax) is d  qin. The time to solve is then tsolve = Nmax/(C -
qin) = d  qin/(C - qin) (1). The area is 1/2  Nmax  (d + tsolve (0.5). Replacing the terms
givesD = d  qin  (d + d  qin/(C - qin). Further simplification (proof) leads to

207 The delay approaches infinity if the demand approaches the capacity. (1). That
is because the jam will never solve if the demand is equal to the outflow (1), and all
following vehicles will get a delay (1).

208 This is basically the same as the question b, with the difference that the demand is

above the congested flow on the free flow branch of the FD (0.5). The segment connect-

ing this point to the congested traffic state hence goes down (0.5), and this means the

tail of the queue moves back (0.5). In graphs:

                     Time space moving bottleneck                                              Fundamental diagram

                                                                                       6000 D    Fundamental diagram

            15                C     D                                                  5000      Shock waves

                  A              B

Space (km)                                                               Flow (veh/h)  4000

            10

                                                                                       3000 A B

            5 A 2000

                  A  Vehicle        A                                                  1000

            0        Shock wave                                                        0C

             0       0.5         1            1.5                2  2.5                0       100 200 300 400 500
                                    Time (h)                                                   Density (veh/km)

209 It does - it is based on the flows and the gaps, and they remain the same.

210 See the cumulative curves: the area is the delay (no points - awarded earlier). This
increases proportional with both the number of vehicles in the queue, as well as with the
                                                                                  235

delay for the first vehicle (1), which are both proportional to the duration of the demon-
stration (1), so in total that means a quadratic relationship (1)

211 Expected headway: 5 seconds. (1). Flow per lane: 3600/5 peds/h. (1) Flow total:

3600/5*2 = 1440 ped/h. (1) B

212 In total the number of cyclists N is the area under the graph (1), calculated by

                                                              2                   (B.15)

                                                   N = q(t )d t

                                                            0

. By geometry, this equals leading to: 2 (min) * q0 *1/2 = q0 [cyclist/min] (1). This equals
300 cyclists (0.5). Therefore, q0=300 cyclist/min

213 The queue grows as long as q is larger than C (0.5), hence we need to find the

number of cyclists that have passed at the moment q reduces to a value lower than

C (0.5). It is (1-(C/q0)) minutes (0.5) after the peak of the flow (0.5) at one minute, so

tE = (1 - (C /q0)) + 1 = 2 - C /q0. The amount of cyclist which then have passed is NE =
tE
0    q(t  )d  t  ,  (1)  which  equals  (or  from  geometry)

                    NE = 1/2  q0 + (tE - 1)  C + 1/2  (tE - 1)  (q0 - C )         (B.16)
                           = 1/2  q0 + (1 -C /q0)  C + 1/2  (1 -C /q0)  (q0 -C )  (B.17)
                           = 1/2  q0 + (1 -C /q0)(C + 1/2(q0 -C ))                (B.18)

(1)

214 Production

215 Yes, we can. The critical density for the Greenshields fundamental diagram is halfway
the density range (0.5), hence at 50 veh/km (0.5). The speed at that density is half the
free flow speed (linear relationship, 0.5 pt), being 40 km/h (0.5 pt). The capacity hence is
q=ku (0.5 pt) = 40*50 = 2000 veh/h (0.5 pt)

216 An acceleration fan occurs at the head of a jam. Since characteristics of the lowest
density move upstream, and characteristics of highest density move downstream, the
sharp shock at the head of the queue (1) will spread out (1).

217 The density should be derived from the quotient of the flow and the space mean
speed (1). The time mean speed overestimates the space mean speed (1), hence the
density is underestimated (1)

218 Locally stable traffic means a vehicle will reduce the amplitude of it speed varia-
tion over time; from vehicle to vehicle, the amplitude can still grow, so platoons can be
unstable.

219 In a stochastic simulation package (1 point), the traffic situation is depending on a
random draw. You should do multiple simulations to check to which extent the results
depend on the random draw.
   236                                                                          B. SOLUTIONS TO TEST QUESTIONS

   220 FD holds in equilibrium, hence v equals 0, and a equals zero. This means (first
   equation) that s = s. (1). The second equation gives a relation between speed and den-

   sity. We can rewrite this to

                                                              v = (s - x0)/T               (B.19)

B  (1 pt) Now substituting s=1/k gives:

                                                              v = (1/k - x0)/T             (B.20)

   (1 pt) Multiplying both sides with k gives the relation q=q(k)

                                          vk = q = k(1/k - x0)/T = 1/T - kx0/T             (B.21)

   (1 pt)

   221 After validation, it is known to which extent the model can be applied in other con-
   ditions and what it's quality is

   222 Since in the congested branch (equation above) q decreases with k, the capacity is

   found at the intersection of the congested branch and the free flow speed. We hence

   have to solve

                                          v = q/k = k(1/k - x0)/T /k = v f = (1/k - x0)/T  (B.22)

   (1) Solving this to k gives

                                                            k = 1/(T v f + x0)             (B.23)

   (1) Using the parameters, we find k=1/(1*30+20)=1/50 veh/m. (0.5) Computing q from
   this gives q=kv=1/50 * 30 = 30/50 =3/5 veh/s (1) = 2160 veh/h (0.5)

   223 Consider the FD in speed-density. Its form does not change, only the distance
   changes hence the values at the density axis are halved (0.5 pt). Moreover, the speed
   reduces to half, hence the values on the speed axis are also halved (0.5 pt). The effect on
   capacity is that the product of density and speed (1 point) is half times half = 1 quarter
   of the original capacity (1 point). The capacity is hence 2160/4=1080/2=540 veh/h

   224 Smulders fundamental diagram

   225 Capacity is at the point where the congested branch starts (0.5); reading out the
   graph gives 35 veh/km and 50 km/h (0.5), so a capacity of (q=ku, 0.5 point), 35*50 = 1750
   veh/h

                         1800         Fundamental Diagram qk

                         1600

                         1400

                         1200

           Flow (veh/h)  1000

                         800

                         600

                         400

                         200

                         0     0  20  40  60  80 100 120 140

   226                                    Density (veh/km)

   There is a slight curvature in the free flow branch, and a straight congested branch
                                                                                                                                                          237

227 This is the traffic state at 15 km/h (0.5), for which the FDs can be used (0.5). Hence,
read out the FD at 15 km/h (0.5), yielding a density of approximately 70,5 veh/km (0.5).
Using q=ku (0.5), this gives a flow of approximately 1060 veh/h

228 First, find the traffic state upstream of the moving bottleneck, which is found by constructing the intersection point of the line q=15k and the fundamental diagram (1 B

point, point B). Downstream of the MB is an empty road (state D, 1 point). Inflow point
is at the free flow branch (0.5 point), and after the MB leaves the road, the state is at
capacity (1 point).
Constructing the space time: start with the MB (1 point), construct AB, AC and CB (1
point), finishing 0.5 point.

                           Spacetime no overtaking                                                               1800         QK no overtaking exam 2016
3.5                                                                                                                           C

                                                                                                1600
3

                                                                                                1400

2.5                                                                                                              1200     A

Time (h)                                                                                                         1000 B
                                                                                                   Flow (veh/h)
2A D                            C

                                                                                                                 800

1.5                                                                                                              600

                                                                                                                 400

1                B                                        A

        A                                                                                                        200

0.5        0.05     0.1                             0.15                                                         0D
     0                                                       0.2                                                       0  20  40  60  80 100 120 140

                    Space (km)                                                                                                    Density (veh/km)

229 A driver will change lanes whenever the utility for changing lanes is higher then
staying in the current lane (1). The utility consists of the accelerations (no points, men-
tioned), for the driver itself and for the vehicles directly influenced (n and o) (1), where
the latter two are discounted using a politeness factor P (1)

230 The values are accelerations so should be given in m/s2 (1 point). abias should be
higher than ath, otherwise no lane change to the right. Accelerations in the order of 1
m/s2 are sizeable (i.e., quite some throttle opening), so values should be in the order of
one thenth of that. Values between 0.01 and 1 are given 1 point (Treiber and Kesting
propose 0.3 and 0.1 m/s2 for abias and ath respectively.)

231 Poisson

232 1200 peds/h = 1200/60 peds/min = 20 peds/min. In 120 seconds = 2 mins 2*20 = 40
peds arrive (and cross) (1 point for flow times cycle time, 0.5 point for unit conversions,
0.5 point for end answer)

233 Flow in peds/m/s and density in peds/m2 (1 point for each)

234 The capacity (read from graph) is 1.22 peds/m/s (1 point for using the capacity
value), so the capacity for the bottleneck is 0.6*1.22 = 0.732 peds/s. (1). It will hence
take 40 peds/ 0.732 peds/s (0.5) = 54 seconds (0.5)to pass the bottleneck.
238                                                              B. SOLUTIONS TO TEST QUESTIONS

                 235 Starting with the hint: at the start, 40 pedestrians have crossed A and not B (seeTime (min)
                  question b). (0.5) So start the curves with 40 pedestrians difference (0.5). Then, the
                  inflow steadily increases with 1200 peds/h, or 40 peds/cycle (1). For the outflow, the
                  queue discharges at 0.732 peds/s up to the moment that 40 pedestrians have exited, and

B traffic light again, so the lines do not touch. remains constant then (1). (Indeed, by that time other pedestrians are waiting at the

                                                       Cumulative curves crossing and bottleneck
                                      120

                                      100

                                        80

                                        60

                                        40

                                        20

                                         0
                                           0 0.5 1 1.5 2 2.5 3 3.5 4
                                                                             N (peds)

236 Consider for instance an acceleration from low speeds to high speeds. Traffic starts

right bottom, and then the density decreases. However, since the speed of the vehicle

is not adapted, it is still low, so it curves counter-clockwise to the top. (1) The other

way round, under deceleration, consider a point near the top. Then, first the density in-

creases (traffic states moves to the right), and the speed is still higher than for the newly

increased density. Hence, the traffic state moves counter-clockwise down.(0.5 for a sec-

ond reasoning)

                   2500         Fundamental diagram

                   2000

Flow (veh/h/lane)  1500

                   1000

                   500

                   0     0  25  50  75  100            125  150

                                Density (veh/km/lane)

237 Triangular, so the free flow speed is fixed (at 2500/25=100 km/h). Straight line in
congested branch means q and k are linear, say form q=1/r-wk. Divide both sides by k,
and use substitution s=1/k: q/k=v=1/k 1/r-w = 1/r s - w, so also v and s are linear. From
the fundamental diagram, find 1/r= 3000 veh/h (point where the congested line would
intersect the y-axis) and w= 2500/125=20km/h. (Also accepted: triangular fundamental
diagram in qk leads to a piecewise linear fundamental diagram in vs, with smin=1/kjam,
scrit=1/kcrit and vmax=qcrit/kcrit). Plotting the minimum of congested speed and free
flow speed gives:
                                                                                      239

                                         Fundamental diagram VS
              120

              100

              80

Speed (km/h)  60                                                                               B

              40

              20

              0    0                  20      40      60         80       100

                                              Spacing (m)                      (1pt)

                   120                        Fundamental diagram VS
                   100
                        Speed (km/h)
                    80
                    60                    20      40       60         80       100
                    40
                    20                            Spacing (m)

                      0
                       0

238

239 Poisson distribution

240 Every truck counts for two vehicles in determining the capacity.

241 If we relate it to time headways (1) of a passenger car without queue warning sys-
tems, we get for cars a pce=1/1.05 and for trucks 2/1.09. (1). The new pce value is the
ratio of the two (0.5): 2/1.09/(1/1.05)=1.05/1.09*2=1.92 (0.5)

242 It means that the edge of a traffic jam flattens (contrary to predicted with shockwave
theory)(1)

243 It means that after a braking manouever of a leader, a follower will not find the same
speed, but keeps continuing adjusting speed (0.5) in an increasing amplitude, i.e. going
to higher and lower speed for every iteration (0.5).

244 Yes, if the inflow is equal to the flow in the queue behind the moving bottleneck, the
tail remains stationary

245 This is not possible. For Greenshields, the critical density is half the jam density (1).
Since this is not the case here, we cannot draw. (1)
A linear FD in VK is awarded 1/2 point.
   240  B. SOLUTIONS TO TEST QUESTIONS

   246 Stop-and-go waves travel in the opposite direction of traffic, so traffic is moving
   top-down. No point rewarded if the tail of the queue of the accident is indicated.

B  247 Given one specific traffic jam and its slope (choose one, 1 point), we find the length

   of the shown road is around the distance travelled in 2/3 of an hour. Since stop-and-go

   waves travel with approximately 18 km/h, this equals or 12 km (1).

   248 The figure shows an accident at the road at the second tick from the bottom. This is
   not the fixed bottleneck. The fixed bottleneck is located at around the first tick from the
   bottom. The capacity drop would be visible at a location just downstream of the fixed
   bottleneck (0.5). There, the flow would be higher before congestion has set than after
   congestion has set in (1). In the current graph, this is not visible. (0.5)

   249 Rabbits take the lane where the speed is the highest.

   250 The density is equal (from question,0.5), and the flow is proportional to density
   times speed (0.5), i.e. a normalized flow of 80 of slugs and 100 of rabbits(0.5). That means
   100/180 = 5/9 of the flow is rabbits(0.5).

   251 Weighted average speed proportional to the flows (1): 5/9*100+4/9*80=91 km/h.
   Computing space mean speed, or assuming flows are equal gives no points.

   252 Edie's generalised definitions suggest that the speed is the total distance covered
   divided by the total time spent. TTD is the sum of all distance covered by all vehicles
   within a predefined area in space-time; TTS is the sum of all time spent of all vehicles
   within a predefined area in space-time.
   Only the equations do not give any points.

   253 The model prescribes an acceleration based on a speed difference (first term, sen-
   sitivity ) (1) and a difference between the spacing (xi-1(t - ) - xi (t - ) and a desired
   spacing (s0 + T vi (t - )) (second term, sensitivity .) (1) The desired spacing is linearly
   increasing with the speed of the vehicle.

   254 FD is homogeneous and stationary conditions (0.5), meaning vi = vi-1 = u (homo-
   geneous, 0.5), and a=0 (stationary: 0.5). Hence, xi-1(t - ) - xi (t - ) - s0 - Tu (0.5 - 2
   points up to now). Spacing can be obtained by s(t - ) = xi-1(t - ) - xi (t - ) (0.5) and
   stationarity s(t ) = s(t - ) = s (0.5). Then, a = 0 = 0 +  (s - s0 - Tu), or u = (s - s0)/T . (1)
   Plotting gives a linear increase of u as function of spacing

   Explicitly making the assumptions is essential. A non-motivated sketch in vt gives no
   points; starting from u = (s - s0)/T and plotting that will provide 1 point in total.
                                                                        241

                                           Helly speed-spacing
              30

              25

              20

Speed (km/h)  15                                                                              B

              10

              5

              0   0  10  20  30           40                    50  60

                             Spacing (m)

255 The delay  causes a delayed reaction. If the leader accelerates (going right in the
spacing), the follower goes later up in speed (1); similar reasoning for decelerating (0.5),
so we obtain a anti-clockwise hysteresis loop (0.5).

Plotting arrows based on an assumption delayed/anticipation, or providing both will
give 1 point.

         30 Helly speed-spacing

              25

              20

Speed (km/h)  15

              10

              5

              0   0  10  20  30           40                    50  60

                             Spacing (m)

256 Starting from s = s0 + Tu, we apply s = 1/k (0.5) and u = q/k (0.5). We obtain 1/k =
s0 + T q/k , rewritten to 1 = ks0 + T q, or q = (1 - ks0)/T (1).

258 The critical density is 1500/50=30veh/km (0.5); The jam density is 1500/15=100 ve-
h/km higher than the critical density (1), hence the jam density is 30+100=130 veh/km
(0.5)

259 Indicate the inflow state in FD (A, 0.5). Then, the first light causes an empty con-
gested state downstream (state C, 0.5) and a state at jam density upstream (B, 0.5). This
creates three waves: AB, AC, BC (0.5 each; 1.5 total). When the traffic light turns green,
a capacity state D (0.5) emerges, with shock waves CD and BD (0.5 point each - total so
far: 4.5). The next red phase causes again states B (0.5) and C (0.5). However, this now
gives waves BD (0.5) and CD (0.5). When waves AB and BD of the first traffic light join,
wave AD emerges, up to the moment that this intersects with BD (0.5). Then, a wave AB
continues (1). Finishing goes in the same way as finishing the first red phase: state D,
waves CD, BD (0.5). When wave DB intersects with BD, the wave AD occurs and moves
242                                                                                                                              B. SOLUTIONS TO TEST QUESTIONS

                  forward (0.5).                                     1500                                                                    D                           Fundamental diagram
                                                                     1000                                                            A                                   Wave
                             10
Space (km)
B

                             9.5

                                                                                                                      500

            9

                                                                                                                              C                                                B

                    1             1.05  1.1          1.15                                                             0    0     20     40         60     80 100 120 140

                                        Time (h)

For this answer, the graphs have been constructed automatically. In your answer, pro-
vide the reasoning as above. Moreover, place letters in within the space-time diagram.
The dotted shock waves should be drawn just as the others. Trajectories are not needed
(not part of the question)

260 The flow is the slope of the cumulative inflow, which first increases (0.5) and then
decreases, see graph above (0.5). The maximum flow is the highest slope, estimated at
600 veh/h (0.5).
Half a point reduction if the line does not increase at the beginning.

1500                                    Max flow                                                                                                              Inflow
                                                                                                                      600

                                                                                                                      500

1000Cumulative veh nr (veh)                                                                                           400
                                                                                                      Inflow (veh/h)
                                                                                                                      300

            500                                                                                                       200

                                                                                                                      100

                                                        Inflow

                                                        Outflow

            0    0     2          4               6  8           10                                                   0    0     1   2          3      4              5  6  7                 8

                                        Time (h)                                                                                                   Time (h)

261 The outflow curve increases when traffic starts to accumulate (1). The slope of the
line is the outflow, given by the accumulation. If the accumulation increases to values
over capacity, the outflow decreases, yielding a flatter outflow curve (1). Only when the
inflow reduces to values under the low outflow, the accumulation decreases and the out-
flow increases again (1).

262 By limiting the inflow and not exceeding the critical accumulation, an outflow of
600 veh can be maintained (1); the remaining queuing is outside the network (1).

263 Whenever there are too many vehicles in the network, we assume they can be queued
outside the network (perimeter control), and the outflow will be 400 veh/h, i.e. the ca-
pacity outflow from the MFD (0.5). The cumulative outflow under perimeter control
                                                                                                                                    243

hence keeps increasing with 400 veh/h whenever there is an excess number of vehicles

between cumulative inflow and outflow(0.5). The amount of travel time gained is the

area between the old and new outflow curve, indicated in green here.

                         1500                                               Gain by perimeter control

Cumulative veh nr (veh)  1000                                                                                                            B

                         500

                                                                                                                  Inflow

                                                                                                                  Outflow

                         0     0                                         2  4             6            8                   10

                                                                                Time (h)

264 No, he can be moving in the y-direction

265 The SFM describes for individual pedestrians (hence, microscopic, 1) how they move.
A "force" changes their direction: they are attracted by their destination (1), and repelled
by obstacles (0.5) and other pedestrians (0.5).

266 In a cellular automaton model, the space is discretized (1).

267 1.22 peds/m/s. Unit, 0.5 point. Value between 0.6 and 2: 0.5 point.

268 One can only see the top they all operate at capacity. (0.5) Whereas this is theoreti-
cally possible, in practice this will not happen (0.5). [Additional/alternative: it can only
happen if all roads have the same FD, which is unlikely to be the case (1) - 1 point max]

269 A characteristic indicate a traffic state. At one moment in time, a location can only
have one traffic state, hence characteristics of different traffic states cannot cross. (1) For
the same traffic state: they have the same speed (because fully determined by the state),
hence they do not get to each other; moreover, once they are at the same location, they
will leave as one at one speed (because fully determined by the traffic state)(1).

270 The number of arriving vehicles in a period of time (1 point; no points for headways;
no points for mentioning independent process, or "independent arrivals", since this was
given in the intro).

                                  Cumulative vehicle number N (veh)                            Cumulative curves
                                                                     60

                                                                                 Inflow
                                                                                 Outflow
                                                                     50

                                                                     40

                                                                     30

                                                                     20

                                                                     10

                   0                                                        50            100                     150          200
                     0
                                                                                Time (s)
271
244                                                   B. SOLUTIONS TO TEST QUESTIONS

272 The delay is the area between the two lines (1).

                 273 Shockwave theory adds a spatial extent, but this is not relevant(1), hence the delay

                  is the same(1). (In case of a non-triangular fundamental diagram, delays would increase

B since the speeds would remain low - this goes beyond the required answer.)

                 274 The faster cyclists are observed more frequently (0.5), and hence have a higher weight

                  (0.5). Hence, the time mean speed is higher (1)

275 We would need to compute total travelled distance (TTD) in an area of space-time
and total time spent (TTS); both should be divided by the area in space time, and then
the quotient should be taken (1). We consider the full track (asked), and a time T (one
could for simplicity take 1 hour). Assume n cyclists (or for simplicity 100 cyclists). (0.5)
Since the quotient should be taken, the area in space-time drops out and is is not needed
to compute the area and: v=TTD/TTS. (0.5)

     TTS =nT                                                               (B.24)

(there are n cyclists each present during the full time T, 0.5 point)

     T T D = 0.8  n  15  T + 0.2  n  25  T                                 (B.25)

(There are 0.8*n cyclist on a normal bike each travelling 15 T in time T, and 0.2*n cyclists
each travelling 25 T in time T, 1 point). Now, we compute: v = T T D/T T S = 0.8  15 +
0.2  25 = 17 km/h (0.5) This is indeed the same as the space mean speed, and could be
obtained directly. That was not the question, and hence would receive no points.

276 The most downstream vehicle has the lowest number

277 The vehicles react on a leader, hence the information comes later to vehicles further
upstream in the platoon (1). Hence, red=1, blue=2, and yellow=3. (1 for correct numbers,
0.5 subtracted for a mistake)

278 Changes in speed dampen out quite nicely, so there is local stability

279 The speed reductions of the first vehicle are exaggerated by the following vehicles,
e.g. at the first speed decrease, the first vehicle reduces speed to around 10.8 m/s and
the last vehicle to 10.2 m/s. (1) If this is the case, this is called platoon unstable (1).

280 A desired distance is s, computed increasing (linearly) with speed v. (1) The accel-
eration is a linear combination of the speed difference of the leader and the difference of
spacing and desired spacing, (1) each with its own sensitivity parameter

281  can be compared to a reaction time, of around 1 second (0-2 seconds: 1 point; one
might also argue about anticipation which reduces reaction time).

282 The FD is based found in equilibrium, hence v equals 0, and acceleration equals
0, so  and  is irrelevant (1). The FD is hence determined by s = s0 + T v (0.5); so with
parameters s0 and T . (0.5) (s and v are the variables, and no parameters)
                                                                                                                  245

283 The jam density stays the same, hence s0 is the same (1). The congested branch is
lower, hence T changes.(1)
284 Draw the FDs and the xt plane.(0 points).

                                                                          B

Consider an inflow lower than the capacity of road (no congestion, given), leading to
state A on the free flow branch (1). A road block will lead to empty state D downstream
(0.5) and jam density upstream, state B (0.5). Waves AD (0.5) and AB (0.5) follow the
speeds of the connections in the FD. Once the incident is removed, there is capacity out-
flow (0.5), with wave DC (0.5). When DC reaches the bridge, no more outflow is possible
then the capacity of the bridge, leading to state E downstream (1) and F upstream (1).
Waves CE (0.5), EF (0.5) and AF (0.5) can now be constructed, followed by EA (0.5)

285 It suffices: Greenshields assumes a linear relation between speed and flow, so with
two given points it is fully determined (1). The capacity is found halfway the density
range (1 for knowing or deriving). The speed is half the free flow speed, so the capacity
is 30*100=3000 veh/h. (60*1000, ignoring the speed reduction would not give the third
point.)

286 Any convex FD will do... We can draw exactly, see next question. Not curved FD:
-0.5 point.

287 The fundamental diagram is as follows:

              3000          Finding states

                        Fundamental diagram

                            Capacity point
              2500 B

Flow (veh/h)  2000

              1500

              1000

              500       50                   100  150  200
                     A
                                                              (1 point)
                 0
                  0

                            Density (veh/km)
   246                                                   B. SOLUTIONS TO TEST QUESTIONS

   One can draw a line through the capacity point with a speed equal to the speed of the
   moving bottleneck (1 point). This connects the (free flow) state downstream of the mov-
   ing bottleneck (state A) and the (congested) state B upstream of the moving bottleneck.

B  288 The blue line starts from 0 at the low densities, which is the left lane (keep right rule

   prevents people from using the left lane if not needed) (1). The red line is the right lane,

   since it starts (like the green one) high, but reduces more quickly and to lower flows than

   the green one (1).

   289 The speeds differ per lane, see the fundamental diagrams:

                                        Speeds per lane
         140

                 120

   Speed (km/h)  100

                 80

                 60

                 40

                 20   0  50      100           150  200

                         Roadway density (veh/km)

   Speeds in the left lane are highest(1), so the graph with the highest fraction in the left
   lane is the flow (1), so the left figure is the flow (1). Similar reasoning (but the other way
   around) for right lane.

   290 Given is that the fundamental diagram is triangular. The free flow branch is a straight

   line with a slope of the free speed, 100 km/h, (0.5) up to the maximum flow (2500 veh/h),

   yielding the critical density of 25 veh/km. (0.5). The congested branch is a straight line

   down (0.5), hence one point on the congested branch suffices (0.5). We read a flow of

   2000 veh/h and a speed of 40 km/h, yielding a density of 2000/40=50 veh/km (0.5). The

   fundamental diagram is finilized by drawing a line through the capacity point and the

   found point (0.5)

                2500         FD density-flow

                2000

   flow(veh/h)  1500

                1000

                 500

                 0    0      50       100           150

                             Density (veh/km)

   291 We take the minimum of demand of cell 2 and supply of cell 3. Cell 2 is undercriti-
   cal, and has a demand read from the fundamental diagram at k=20 veh/km (0.5), being
        247

2000 veh/h. Cell 3 is overcritical and has a supply read from the fundamental diagram
at k=100 veh/km (0.5), being 1000 veh/h. The flow is determined by the minimum, here
the supply at 1000 veh/h. (1)

292 We take the minimum of demand of cell 3 and supply of cell 4. Cell 3 is overcriti-    B

cal, hence demand equals capacity, 2500 veh/h (1). Cell 4 is undercritical, hence supply

equals capacity, 2500 veh/h (1). The minimum of both is the flow (0.5), hence 2500 veh/h

(0.5).
                C

           MATLAB CODE FOR CREATING
       (SLANTED) CUMULATIVE CURVES

1 function cumcurves()

2 %This function will give the cumulative curves for a flow which

3 %has (in time) three values, and one bottleneck halfway

4 q0=[3600;5000;2000];%the three demands

5 Tchange=[60;90];%times in minutes at which the demands change

6 c=4000;%capacity

7 T=0:200;%minutes

8 dt=1/60;%time steps (in hours: time step is 1 min)

9 dem=q0(end)*ones(size(T));%pre-allocate demand function to the last ...
           demand value

10 for(i=numel(Tchange):-1:1)

11      dem(T<Tchange(i))=q0(i);%adapt the demand function

12 end

13

14 figure;

15 plot(dem,'linewidth',2)

16 hold on

17 plot(repmat(c,size(dem)),'r--','linewidth',3)

18 ylim([0 6000])

19 legend('Demand','Capacity','location','Northeast')

20 ylabel('Flow (veh/h)')

21 xlabel('Time (min)')

22 exportfig('Demand')

23 %%

24

25 Nin=dt*cumsum(dem);
26 qout=zeros(size(Nin));

27 qout(1)=dem(1);%in veh/h

28 queued=zeros(size(dem));

29 for(t=2:numel(T))

30      qout(t)=1/dt*min(dt*c, dt*dem(t)+queued(t-1));

31      queued(t)=queued(t-1)+dt*dem(t)-dt*qout(t);

                               249
250  C. MATLAB CODE FOR CREATING (SLANTED) CUMULATIVE CURVES

32 end
33 Nout=dt*cumsum(qout);
34 figure;plot(Nin,'linewidth',2,'color',[0.5 0.5 1]);hold ...

            on;plot(Nout,'r--','linewidth',3)
35 legend('N_{in}','N_{out}','location','Northwest')
36 ylabel('Cumulative flow')
37 xlabel('Time (min)')
38 exportfig('Cumulative curves')
39 %%

40

41 %compute total delay:
42 TotalD=dt*sum(queued)%then the total delay in hours
43 NrVeh=Nin(end);
44 AvgDelay=TotalD/NrVeh%then the total delay in hours
45 AvgDelayMin=60*AvgDelay;%then the total delay in hours

46

47 %%
48 Tin=interp1(Nin,T,1:NrVeh);%time to enter for each vehicle -- ...

            interpolation
49 Tout=interp1(Nout,T,1:NrVeh);%time to exit for each vehicle -- ...

            interpolation
50 DT=Tout-Tin;%additional travel time
51 figure;
52 plot(1:NrVeh,DT,'linewidth',2)
53 xlabel('Vehicle number')
54 ylabel('Delay (min)')
55 exportfig('Delay per vehicle')

56

57 figure;
58 plot(Tin,DT,'linewidth',2)
59 xlabel('Entry time (min)')
60 ylabel('Delay (min)')
61 exportfig('Delay as function of time')
                                            INDEX

acceleration fan, 124                  flow, 3
accumulation, 113                      Free flow, 54
                                       free flow capacity, 50
Binomial distribution, 130             free flow speed, 22
                                       Fundamental diagram, 20
capacity, 21
capacity drop, 50                            Drake, 23
Car-following models, 59                     Greenshields, 22
                                             Inverse lambda, 23
      Newell, 59                             Smulders, 23
cell transmission model, 82                  Triangular, 22
cfl condition, 83                            Truncated triangular, 23
characteristic curve, 122                    Wu, 24
composite headway distributions, 132
congested branch, 22                   gap, 2
congested state, 22                    generalised fundamental diagram, 118
conservation equation, 121             Godunov scheme, 82
courtesy lane changes, 69              goodness of fit, 74
critical density, 21                   Greenshields fundamental diagram, 22
Critical gap, 133                      gross space headway, 2
critical speed, 21                     gross time headway, 2
Cumulative curves
                                       Headway
      Oblique cumulative curves, 15          composite headway distributions, 132
      Slanted cumulative curves, 15          distributions, 131
cumulative curves, 11                        Exponential distribution, 131
cumulative flow curves, 11                   Gross space headway, 2
                                             Gross time headway, 2
delay, 13                                    Negative binomial distribution, 131
Demand functions, 84                         Net space headway, 2
density, 3                                   Net time headway, 2
desired lane changes, 69                     Time headway, 127
Drake fundamental diagram, 23
dual loop detectors, 6                 headway, 127
                                       Headway distribution, 129
edie's definitions, 6                  homogeneous, 8
eulerian coordinate system, 141        hysteresis, 24
ex ante, 73
ex post, 73                            instantaneous measurements, 6
Exponential headway distribution, 131  Instantaneous measuring, 6
                                       Integrated lane change modelling, 72
First order macroscopic modelling, 82

                                       251
252                                        INDEX

intensity, 3                               microscopic, 1
inverse lambda, 23                         Microscopic lane change models, 67
Inverse lambda fundamental diagram, 23     Microscopic traffic description, 2
iterations, 75                             minimizing overall braking induced by lane

jam density, 22                                         changes, 70
                                           mobil, 70
Kerner's Three Phase Traffic Flow Theory,  MoC, 121
             53                            Model:N-model, 138
                                           Model:X-model, 139
kinematic wave, 122                        moving bottleneck, 39
                                           moving observer, 27
lag gap, 134                               Multi-class modelling, 98
lagrangian coordinate system, 141
Lane change model                          n-model, 138
                                           Negative binomial distribution, 131
      Integrated modelling, 72             net space headway, 2
      microscopic, 67                      net time headway, 2
      MOBIL, 70                            network fundamental diagram, 111
      Slugs and rabbits, 69                Network traffic description, 5
Lane Flow Distribution, 67                 network transmission model, 118
lead gap, 134                              Newell's car following model, 59
lfd, 67                                    nfd, 111
lighthill, williams and richards, 82       node model, 103
Link Transmission model, 97                numercial errors, 83
local mean speed, 6                        numerical diffusion, 83, 95
local measurements, 5
Local measuring, 5                         oblique cumulative curves, 15
local stability, 49                        occupancy, 4
lwr, 82                                    one pipe regime, 69
                                           outflow capacity, 50
macroscopic, 1                             overfitting, 79
macroscopic fundamental diagram, 111
Macroscopic models                         pace, 2
                                           Passenger car equivalent, 99
      First order modelling, 82            passenger car unit, 99
Macroscopic traffic models, 81             pce, 99
mandatory lane changes, 69                 performance, 113
Marcoscopic traffic description, 3         Perimeter control, 113
measure of effectiveness, 73               platoon stability, 49
measure of effictiveness, 75               poisson distribution, 129
measure of performance, 73                 production, 113
Measuring principles, 5                    Protected network, 113

      Instantaneous, 6                     q = ku, 20
      Local, 5                             queue discharge rate, 50
mesoscopic, 5
Mesoscopic traffic description, 5          Rabbits, 69
Method of characteristics, 121
mfd, 111
INDEX                                                                                       253

random seeds, 75                       Traffic simulation
relaxation, 72                               Network Transmission Model, 118
remote sensing, 6
replications, 75                       traffic state, 21
root mean square error, 77             Traffic states

shock wave, 29                               Free flow, 54
Shock wave theory, 29                  trajectory, 2
slanted cumulative curves, 15          Travel time, 13
Slugs and Rabbits, 69                  Triangular fundamental diagram, 22
Smulders fundamental diagram, 23       Trucks, 98
space headway, 2                       Truncated triangular fundamental diagram,
spacing, 2
spatio-temporal measuring, 6                        23
spatio-temporal principles             two pipe regime, 69

      spatio-temporal, 6               uncongested branch, 22
stationary, 8                          uncongested state, 21
stop-and-go waves, 36
string stability, 49                   validity range, 79
Submicroscopic traffic description, 5  Variables
Supply functions, 84
Synchronized flow, 54                        Fundamental relationships, 20
                                       variables, 1
Three phase Traffic Flow Theory, 53    vertical queuing model, 12
three phase traffic flow theory, 24    volume, 3
throughput, 3
time mean speed, 6                     wave speed, 42
Traffic description                    Wave speed equation, 31
                                       Wu fundamental diagram, 24
      Marcoscopic, 3
      Mesoscopic, 5                    X-model, 139
      Microscopic, 2
      Network, 5
      Submicroscopic, 5
Traffic flow
      homogeneous, 8
      stationary, 8
Traffic flow models, 73
traffic flow stability, 49
Traffic Model
      Discretisation, 82
Traffic model
      Demand functions, 84
      Link Transmission model, 97
      Supply functions, 84
Traffic Models
      Macroscopic traffic models, 81
Traffic Flow Theory: An introduction with exercises

Victor L. Knoop

Traffic processes cause several problems in the world. Traffic delay, pollution
are some of it. They can be solved with the right road design or traffic
management (control) measure. Before implementing these designs of
measures, though, their effect could be tested. To this end, knowledge of
traffic flow theory is needed.

This book teaches students in the field of traffic flow theory. It takes an
approach from physical phenomena, focussing on observable and tangable
quantities. It uses examples and storytelling to educate future traffic
engineers. It also contains over 250 example questions on the study material,
allowing students to practice.

                            Dr. Victor L. Knoop
                            TU Delft | Civil Engineering

                            Dr. Victor Knoop is associate professor at the
                            Department of Transport & Planning. He has a
                            background in flows, with a master degree in physics.
                            Since his PhD his main research interest lies in
                            traffic dynamics. His research focuses on how driver
                            movements create effects at the level of a traffic stream.

                            He is author of over 200 scientific publications in the field
                            of Traffic Flow Theory. He is a very enthousiastic lecturer,
                            and has taught courses on Traffic Flow Theory for over a
                            decade.

                                                                                                                                                     2020 TU Delft Open
                                                                                                                                                    ISBN 978-94-6366-378-6
                                                                                                                                                    DOI https://doi.org/10.5074/t.2021.002
                                                                                                                                                    textbooks.open.tudelft.nl

                                                                                                                                                    Cover image: Traffic flow at the
                                                                                                                                                    A4 near Leiden; notice the queue
                                                                                                                                                    spillback and an offramp with spare
                                                                                                                                                    capacity by Victor L. Knoop is
                                                                                                                                                    licensed under CC BY-NC-SA 4.0
