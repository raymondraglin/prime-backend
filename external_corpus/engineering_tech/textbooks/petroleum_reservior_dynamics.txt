Louisiana State University

LSU Scholarly Repository

E-Textbooks
1-2025

Petroleum Reservoir Dynamics

Mehdi Zeidouni
Louisiana State University and Agricultural and Mechanical College

Follow this and additional works at: https://repository.lsu.edu/etext
Recommended Citation
Zeidouni, Mehdi, "Petroleum Reservoir Dynamics" (2025). E-Textbooks. 4.
https://repository.lsu.edu/etext/4
This Book is brought to you for free and open access by LSU Scholarly Repository. It has been accepted for
inclusion in E-Textbooks by an authorized administrator of LSU Scholarly Repository. For more information, please
contact ir@lsu.edu.
Petroleum
Reservoir
Dynamics

                            Mehdi Zeidouni
Table of Contents

TABLE OF CONTENTS...............................................................................................................................................I

PREFACE ...............................................................................................................................................................IV

1 INTRODUCTION ............................................................................................................................................ 1

   1.1 PETROLEUM ENGINEERING ................................................................................................................................1
   1.2 THE RESERVOIR SYSTEM ....................................................................................................................................2
   1.3 RESERVOIR PROPERTIES.....................................................................................................................................3
   1.4 EVALUATION OF RESERVOIR PROPERTIES...............................................................................................................4

2 DARCY EQUATION AND ITS LIMITATIONS ..................................................................................................... 6

   2.1 POROSITY.......................................................................................................................................................6
   2.2 PERMEABILITY.................................................................................................................................................8
   2.3 FRACTURE PERMEABILITY ................................................................................................................................13
   2.4 CARMAN-KOZENY EQUATION...........................................................................................................................15
   2.5 COMPLICATIONS............................................................................................................................................17

       2.5.1 Inertia...................................................................................................................................................17
       2.5.2 Slippage ...............................................................................................................................................18
       2.5.3 Heterogeneity ......................................................................................................................................20
       2.5.4 Anisotropy............................................................................................................................................24
   2.6 CHAPTER PROBLEMS ......................................................................................................................................29

3 FLOW GEOMETRY ....................................................................................................................................... 32

   3.1 DARCY EQUATION IN FIELD UNITS......................................................................................................................32
   3.2 FLOW GEOMETRY ..........................................................................................................................................33
   3.3 INCOMPRESSIBLE FLOW...................................................................................................................................34

       3.3.1 Incompressible linear flow ...................................................................................................................34
       3.3.2 Incompressible radial flow ...................................................................................................................37
       3.3.3 Incompressible spherical flow ..............................................................................................................40
       3.3.4 Skin factor ............................................................................................................................................43
       3.3.5 Productivity index and flow efficiency .................................................................................................46
       3.3.6 Permeability averaging in radial flow ..................................................................................................47
   3.4 CHAPTER PROBLEMS ......................................................................................................................................50

4 STEADY-STATE COMPRESSIBLE FLOW ......................................................................................................... 52

   4.1 STEADY-STATE OIL FLOW .................................................................................................................................52
   4.2 STEADY STATE FLOW OF GAS ............................................................................................................................58

       4.2.1 Real gas - low pressure approximation................................................................................................58
       4.2.2 Real gas - high pressure approximation ..............................................................................................61
       4.2.3 Rigorous approach ...............................................................................................................................62
   4.3 CHAPTER PROBLEMS ......................................................................................................................................66

5 ACCOUNTING FOR THE EFFECT OF GRAVITY IN STEADY FLOW .................................................................... 68

                                                                                                                     i
5.1 FLOW POTENTIAL...........................................................................................................................................68
5.2 CHAPTER PROBLEMS.......................................................................................................................................77

6 THE GOVERNING EQUATION FOR FLOW IN RESERVOIRS ............................................................................ 78

6.1 DERIVATION OF PRESSURE DIFFUSIVITY EQUATION ................................................................................................78
6.2 STEADY FLOW SOLUTION IN TERMS OF AVERAGE PRESSURE.....................................................................................80
6.3 RADIUS OF INVESTIGATION ..............................................................................................................................84
6.4 DIMENSIONLESS VARIABLES .............................................................................................................................87

7 PSEUDO-STEADY STATE (PSS) FLOW ........................................................................................................... 88

7.1 FLOW IN A CLOSED RESERVOIR..........................................................................................................................88
7.2 PSS FLOW SOLUTION DERIVATION.....................................................................................................................92
7.3 RATE VARIATION WITH RADIUS .........................................................................................................................97
7.4 TIME-DEPENDENCE OF PRESSURE ......................................................................................................................98
7.5 WELLS DRAINING NON-CIRCULAR AREAS...........................................................................................................101
7.6 INFLOW PERFORMANCE RELATIONSHIP (IPR).....................................................................................................107
7.7 VERTICAL FLOW PERFORMANCE (VFP).............................................................................................................109
7.8 NODAL ANALYSIS .........................................................................................................................................110
7.9 CHAPTER PROBLEMS ....................................................................................................................................111

8 TRANSIENT RADIAL FLOW AND DRAWDOWN TEST ANALYSIS .................................................................. 113

8.1  TRANSIENT RADIAL FLOW SOLUTION FOR CONSTANT RATE PRODUCTION .................................................................113

8.2 DRAWDOWN TEST ANALYSIS ..........................................................................................................................116

8.3 WELLBORE STORAGE (WBS) EFFECT ...............................................................................................................118

8.4 LOG-LOG DIAGNOSTIC PLOT ...........................................................................................................................121

8.5 DRAWDOWN TEST ANALYSIS PROCEDURE..........................................................................................................121

8.6 CHAPTER PROBLEMS ....................................................................................................................................124

9 SUPERPOSITION PRINCIPLE AND PRESSURE BUILDUP TEST ANALYSIS ...................................................... 126

9.1 SUPERPOSITION IN SPACE ..............................................................................................................................126
   9.1.1 Presence of sealing fault ....................................................................................................................128
   9.1.2 Pressure drawdown behavior in presence of sealing fault ................................................................131
   9.1.3 Pressure drawdown test analysis in presence of sealing fault...........................................................132

9.2 SUPERPOSITION IN TIME................................................................................................................................135
9.3 PRESSURE BUILDUP TEST ANALYSIS ..................................................................................................................138

   9.3.1 Horner method...................................................................................................................................138
   9.3.2 Identification and removal of WBS effect ..........................................................................................142
9.4 CHAPTER PROBLEMS ....................................................................................................................................146

APPENDIX A. TRANSIENT (INFINITE-ACTING) RADIAL FLOW SOLUTION OF THE DIFFUSIVITY EQUATION ........... 149

APPENDIX B. EFFECT OF WELLBORE STORAGE ................................................................................................... 152

QUESTIONS ANSWERS ....................................................................................................................................... 153

REFERENCES....................................................................................................................................................... 159

     ii
iii
Preface

I began teaching Reservoir Dynamics at Louisiana State University (LSU) with the invaluable
support of Dr. Christopher White's brilliant course notes, which he published shortly before my
arrival in Fall 2014. His work exemplifies a lasting legacy - making life easier for those who follow.
Dr. White's notes were immensely helpful to both my students and me.

Over the past decade, while teaching Reservoir Dynamics ten times, I have worked to develop
and incorporate my own perspective into the subject matter. This book represents the
culmination of that effort, building on the foundational structure and organization of Dr. White's
work while reflecting the knowledge I have accumulated throughout my career in reservoir
engineering.

The book is structured into nine chapters, each designed to build a comprehensive understanding
of reservoir engineering principles. Chapter 1 introduces the discipline and its connections with
other areas of petroleum engineering. Chapters 2 through 5 address steady-state flow and its
various complexities: Darcy's equation and its limitations (Chapter 2); flow geometries and skin
factor concepts (Chapter 3); compressible oil and gas flow (Chapter 4); and non-horizontal flow
using the flow potential concept (Chapter 5).

In Chapter 6, the pressure diffusivity equation is explored alongside key concepts of radius of
investigation and average reservoir pressure. Chapter 7 delves into the pseudo-steady-state (PSS)
flow regime, its applications in multi-well drainage, and its relationship with well productivity
index, inflow performance relationship, vertical flow performance, and nodal analysis.

The final chapters focus on transient radial flow and its applications in well testing. Chapter 8
introduces transient drawdown analysis. Chapter 9 discusses the superposition principle in time
and space, with application to the modeling of sealing faults and buildup test analysis.

To enhance engagement and learning, each chapter includes quiz questions - primarily in a
True/False format - with answers provided at the end of the book. Additionally, numerous
examples are integrated throughout to demonstrate the practical significance of the concepts
and their relevance to reservoir engineering practice.

                                                                        Mehdi Zeidouni
                                                                        Louisiana State University
                                                                        zeidouni@lsu.edu

                                                                                                                    iv
                                        Petroleum Reservoir Dynamics

1 Introduction

In this chapter, we cover the basics of petroleum reservoir engineering, its relationship with other
petroleum engineering subdisciplines, the role of reservoir engineers, central reservoir rock and
fluid properties, and approaches to estimate those properties.

An oil/gas reservoir which sometimes is referred to as pool is actually not a pool but a porous
rock containing hydrocarbons. The rock hosting the hydrocarbon is quite similar to a very normal
rock typically seen around a river or in the mountains. Figure 1-1 shows an oil-bearing rock and
how it differs from a clean rock. The figure also shows a tight rock containing oil which is often
produced by hydraulic fracturing. In petroleum engineering, our goal is to explore to find the
oil/gas is in the subsurface and commercially produce it. Once produced, oil/gas is passed to
recipient industrial units (e.g. processing facilities, refineries, chemical plants) to be turned into
various petroleum products. Accordingly, petroleum exploration and production (E&P) is
upstream industry as related to refining and surface processing which are downstream
industries. And within E&P itself, exploration is upstream of production.

(a)  (b)

Figure 1-1 a) Oil-bearing versus non-oil-bearing rocks showing rocks where the oil is found. (b) An oil-bearing tight
             rock. Hydraulic fracturing is the most common way of producing tight hydrocarbon resources.

1.1 Petroleum engineering

It is important to distinguish between the responsibilities of different disciplines under petroleum
engineering including drilling, completion, production, and reservoir. The drilling engineer's goal

                                                                                                                    1
                                                   Introduction

is to drill the well so that the target hydrocarbon bearing formation is accessed in the subsurface.
The completion engineer optimizes the contact surface area with the formation (e.g. by
perforation and fracturing) so the hydrocarbons can flow to the wellbore. The production
engineer makes sure that the wellbore is optimized in order to bring as much fluid as possible
from the reservoir depth to the surface (e.g. by use of artificial lift). The reservoir engineer is the
one who looks at the reservoir holistically and aims to manage the reservoir development to
achieve maximum hydrocarbon recovery. Reservoir engineering is, therefore, more about overall
reservoir management than day-to-day activities.

The main responsibilities of a reservoir engineer are: (1) Prospect appraisal or estimating
potential in new area, (2) Estimation of resource (the hydrocarbon volume initially in place) and
reserve (the technically and economically recoverable hydrocarbon volumes), (3) Performance
prediction i.e. determining how quickly the hydrocarbons can be produced, (4) Analyzing the
production performance in order to improve the recovery e.g. by identifying presence of near-
wellbore damage and requirement for stimulation, (5) Economic evaluation of an oil/gas
property.

Question 1-1. Which of the following is/are not responsibilities of reservoir engineer? a) Estimate
the in-place hydrocarbon volumes, (b) Fracture treatment design, (c) Well planning, (d) Evaluate
the well damage/condition, (e) Determine rate of hydrocarbon recovery, (f) Suggest location of
new drilling.

1.2 The reservoir system

In this course, the term "reservoir" refers to conventional reservoirs, although the flow principles
may also apply to unconventionals. The reservoir system has four components: source rock,
migration path, trap, and reservoir (Figure 1-2). Source rock is where the oil and gas have been
generated from the organic matter under significant heating. Tectonic activities and other
processes have then allowed for migration of the generated oil and gas from the reservoir. The
migrating oil and gas would have ended up at the earth surface unless trapped by an effectively
impermeable rock barrier such as sealing caprock or fault. The oil and gas would then accumulate
in a high-quality rock overlain by the sealing trap. The high-quality rock where the hydrocarbons
are accumulated is known as the reservoir. It is worth noting that over millions of years roughly
45% of what has been generated in the source rocks has migrated but was not trapped, 5%
accumulated in conventional reservoirs, and the remaining 50% still remains in the source rock.

                                                                                                                    2
                                        Petroleum Reservoir Dynamics
The source rock resources are commonly known as shale reservoirs today and produced by a
combination of horizontal drilling and massive hydraulic fracturing mainly in North America.

                                  migration path

Figure 1-2 Components of a conventional reservoir system and relationship with unconventional reservoirs. [Source:
                                                                 slb.com]

1.3 Reservoir properties
Many rock and fluid properties are relevant to reservoir engineering. However, many of these
properties can be related to two major characteristics: storativity and productivity. Storativity
refers to the potential of the rock to store hydrocarbons. This is related to the size of the
container or the bucket size. The productivity is a measure of the flow potential of the oil and gas
from the reservoir all the way to the surface. In comparison to the bucket size for storativity, the
productivity can be thought of as the pipe size. The controlling properties of storage should be
drainage area (A), thickness (h), porosity (), saturation (So). Also, thermodynamics of reservoir
fluids affect the storage because it determines how the volume in the subsurface translates into
the surface volume. A low-density hydrocarbon would result in a larger volume compared to a
denser hydrocarbon when brought to the surface. The productivity is related to absolute
permeability (k), relative permeability (kr), thickness (h), and total compressibility (ct). Again, fluid

                                                                                                                    3
Introduction

properties such as viscosity and solution-gas ratio affect the productivity. A low viscosity fluid
would flow more easily toward the well compared to a more viscous fluid. Also, higher dissolved
gas ratio (Rs) would give the fluid more energy to flow toward the surface by dropping the average
density of fluids in the wellbore column (same way the wellbore fluid density is dropped by
artificial lift). Note that thickness affects both storage and productivity. For storage, larger
thickness simply means larger volume all else equal. For productivity, larger thickness means
more contact area between the well and the reservoir. It should be noted that fracturing is one
way to increase the contact area with the reservoir. For a single-phase reservoir, the properties
above are often grouped into the groups shown in the Table 1-1.

Table 1-1 Reservoir properties common groups.

Storativity        =  ct
Mobility           = k / 
Diffusivity        =  / = k / (  ct)
Flow capacity     k h
Transmissibility  k h/

Question 1-2. Which property affects both the productivity and storativity? (a) Permeability (k),
(b) porosity (), (c) thickness (h).

Question 1-3. Can the reservoir rock be accessed on the surface? (a) Yes, (b) No, (c) Maybe.

1.4 Evaluation of reservoir properties

Constraining the reservoir properties is a challenge. If the reservoir outcrops at the surface
samples may be taken to determine its properties. But, would these measured properties be
representative of the subsurface? If the reservoir was uniform and homogenous then those
properties may have been useful. However, reservoir is never homogenous (see Figure 1-3 for
potential heterogeneities). In addition, samples at the surface are not under the stresses and
compaction the rock experience at the subsurface and therefore cannot be representative even
if the reservoir was homogenous.

Therefore, to get representative properties, the reservoir rock and fluids must be sampled in the
subsurface which is often done by coring and fluid sampling. Figure 1-4 shows the cores that have
been taken from a well. Basic and special tests on the cores and fluid samples are then conducted
to provide an estimate of the required reservoir rock and fluid properties. Once the properties

                                                                                                                    4
     Petroleum Reservoir Dynamics

are measured/estimated, they must be used along with relevant relationships to enable
calculation of unknows of interest e.g. the production rates. Darcy's equation is the most basic
equation to be covered, which is the topic of next chapter.

It is important to note that the reservoir rock and fluid are highly undersampled. Assuming
intense drilling e.g. 16 wells per mile2 and coring (7-inch diameter) every drilled well, the fraction
of the sampled reservoir volume would be ~10-7. This extremely small number implies that the
reservoir is significantly undersampled and reservoir geometry and properties are mostly non-
measured. Also, rock and fluid properties vary over a wide range e.g. permeability may be 10-6 -
10 Darcy and viscosity may be 0.01 - 106 cp. Undersampling combined with the variability of the
reservoir properties poses a major challenge in characterizing the subsurface.

(a)  (b)

                                                             (c)

Figure 1-3 (a) A relatively homogeneous rock in horizontal direction with vertical heterogeneity. (b) A rock with
                dissolution-triggered heterogeneity, (c) A rock with fracturing-induced heterogeneity.

     Figure 1-4 Sampling the subsurface reservoir by taking cores during drilling.

                                                                                                     5
                Darcy Equation and its limitations

2 Darcy equation and its limitations

In this chapter, we introduce Darcy's equation for single-phase flow of a fluid through a porous
rock. Porosity and permeability as two fundamental characteristics related to single-phase flow
in rocks are first introduced. The concept of permeability is presented by idealizing the porous
rock with a bundle of tubes system. The relationship with Darcy equation is then presented along
with an equation relating the permeability and porosity. Conditions where Darcy equation can
no longer be used or requires modifications are also presented.

2.1 Porosity

Reservoir rock is combined of solid grains and pores (voids). Porosity () is the ratio of the pore
volume () to the bulk volume ():

 =  = 1 -  2-1
              

where Vg is the grain volume which is simply the bulk volume minus the pore volume. Figure 2.1
shows 3D image of grain volume (left) and pore volume (right) for a cube-shaped 111 mm3
sandstone sample. It is evident that the porosity must be defined over a Representative
Elementary Volume (REV) of the rock in order to be a representative porosity. REV is the smallest
volume the porosity of which will be representative of the whole rock. For instance, selecting a 1
m3 REV for the rock sample shown in Figure 2-1, results in  = 1 if the REV is overlain in the pore
and  = 0 if it is on the solid grains. Thus, REV is obviously required to be larger than 1 m3.

Figure 2-1 3D image of a 111 mm3 sandstone sample with 22% porosity. (a) Solid fraction (pore space is made
                   transparent). (b) Pore space (solid fraction is made transparent)(Louis et al. 2007).

                                                                                                                   6
                                        Petroleum Reservoir Dynamics

Porosity can be of two types: primary porosity which develops during rock deposition (see Figure
1-3a), and secondary porosity which has been developed after initial rock deposition due to
diagenetic processes such as dissolution vugs (Figure 1-3b) and faulting/fracturing (Figure 1-3c).
Primary porosity is more visible in clastic rocks while carbonates are more susceptible to
secondary porosity.
A starting point to obtain a range for rock porosity is to consider the rock to be composed of
identical sphere-shaped grains. There will then be two end possibilities of the grain packing: cubic
and rhombohedral. The cubic packing maximizes the pore volume fraction while rhombohedral
packing minimizes the pore volume fraction. The former results in 47.6% porosity while the latter
results in 25.96% (Figure 2-2).
The range obtained for the rock porosity assuming equal-size spherical grains is 25.96 to 47.6
percent. Does this suggest that the porosity cannot be lower than 25.96%? How is it possible for
the porosity to be lower than 25.96%? The grain sizes are identical in obtaining the 25.96%
porosity. If the grains are of different sizes, the smaller ones can fill the otherwise available pore
space and lower the porosity. In addition, cementing of the grains in consolidated rocks can also
decrease the porosity. On the other hand the porosity can - theoretically- also be larger than
47.6% because of possibility of secondary porosity development which makes additional pore
space.

Figure 2-2 Variation of porosity for a rock composed of identical sphere-shaped grains for (a) cubic packing and (b)
                                             rhombohedral packing (Amyx et al. 1960).

Question 2-1. Assuming identical sphere-shaped grains, does porosity depend on the grain size?

                                                                                                                    7
                                      Darcy Equation and its limitations

Question 2-2. Is porosity independent of the average grain size assuming that the grain size
follows a normal grain size distribution around the average gran size? Table 2-1 shows how clastic
rocks are classified based on the average grain size.

     2-1 Clastic rock classification as a function of average grain diameter.

     Grain diameter (mm)  Class             Main constituent in rock
     64                   Cobbles           Conglomerate
     4                    Pebbles           Granulestone
     2                    Granules
     1                    Very coarse       Sandstone
     0.5                  Coarse
     0.25                 Medium            Siltstone
     0.125                Fine              Shale
     0.0625               Very fine
     0.003963             Silt
     <0.003963            Clay

2.2 Permeability

Permeability is a measure of the rock ability to transmit fluids. As expected, it should be related
to porosity, the relationship of which will be discussed later in this chapter. However,
theoretically, it is possible that the rock is porous but impermeable. This is when the pores are
disconnected.

Similar to porosity, some idealization of the rock is required in order to reach a fundamental
understanding of the rock permeability. Due to the rock complex pore and granular space, it is
difficult to model flow through a rock. The simplest idealization is to consider all flow paths as
capillary tubes and hence, the rock would be thought of as a bundle of capillary tubes (Figure
2-3). It is therefore required to understand the flow through a tube.

(a)                                    (b)

Figure 2-3 (a) Rock with spherical grains, and (b) its idealization by a bundle of tubes model.

                                                                                                                    8
                                  Petroleum Reservoir Dynamics

Consider a tube with length , radius , through which fluid with viscosity  flows at a rate
 while experiencing a constant pressure drop . The flow velocity at any given distance from
the center () is given by:

 () =  (2 - 2) 2-2
           4

Replacement of  =  in this equation results in zero velocity which confirms the requirement
for the velocity to be zero at the tube wall. Also, assigning  = 0 would maximize the velocity
which is again expected as the velocity is maximum at the center of the tube. If the velocity was
constant at any radius from the center the rate would have been simply the velocity multiplied
by cross-section area of the tube. However, given the velocity variation, the flow rate () can be
calculated by:

   =  ()  =   (2 - 2) 2 2-3
              0 4
  0

Expanding and simplifying gives:

 =    2 ( 2 -  3)
4
           0       0

=  2 (2 2  | - 4  | )
   4 2 0 4 0

     4 4
= 4 2 ( 2 - 4 )
 4 2-4
= 4 2 ( 4 )

=  2 (2)
     8

    2
=   ( 8 )

In short, the flow rate through a tube is given by:
        2

  =   ( 8 ) 2-5

Next, we compare the above equation to the experimentally driven Darcy equation for flow
through a rock. According to Darcy equation, the steady pressure drop associated with flowing a

                                                                9
                             Darcy Equation and its limitations

fluid with viscosity  at a rate  through a rock with cross sectional area  and length  indicate
that the following ratio remains constant for different combinations of the related variables:


 = Constant 2-6

The constant is the rock property of permeability. Therefore, Darcy equation for flow through a
rock is given by:

    
 =   or  =   2-7

Comparison of the Darcy equation with equation for flow through a tube suggests that:

(a) The permeability dimension is 2. However, m2 is rarely used as permeability unit. Instead,
Darcy is used: 1 Darcy  10-12 m2.

(b) A rock with permeability 2/8 is equally permeable to a capillary tube with radius .

(c) Permeability of a capillary tube with radius  is 2/8 m2.

An important note regarding the differential form of Darcy equation ( =  ) that  is
                                                                                         

considered positive. In other words, the space () coordinate is defined such that pressure

increases with increasing .

Example 2-1. Calculate the radius of a capillary tube which is equally permeable to a 111 mm3
rock with k=0.12510-12 m2.

Solution: 2 = 0.125  10-12  2 = 10-12   = 10-6 m

                 8

Example 2-2. Calculate the permeability of a human-hair-like capillary tube with R=10 m in
Darcy.

Solution:  = (10-5)2 = 12.5  10-12 = 12.5 Darcy. Note that permeability may vary between

                             8

10 - 1000 mD in typical Gulf of Mexico reservoirs. Does this mean that the flow paths in the
reservoir rock are even narrower than a human hair? The answer is No; that's partly because we
have overlooked the solid part of the rock so far. When we consider the solid part, we could
obtain hair-size capillary tube for a permeability of 1000 mD. See Question 2-7 below.

                                                                                                                   10
        Petroleum Reservoir Dynamics

Now, let's account for the solid part of the rock i.e. the grains. What would be the permeability
if the capillary tube passes through an otherwise impermeable rock solid? What permeability
would be representative of the rock permeability? It is clear that the permeability must account
for the fraction of the rock volume taken by the capillary tube:

 =  + (1 - )  0 =                                                                      2-8

The capillary tube permeability is renamed as intrinsic permeability since it intrinsically
represents the capillary tube permeability by itself. For an otherwise impermeable rock
containing  flow tubes with different sizes, we can then write:



 =  ,                                                                                   2-9

=1

where  represents the porosity of each tube by itself i.e. the volume fraction of each
tube to the bulk volume.

Question 2-3. Calculate the permeability of the steel block below (111 mm3) containing a
capillary tube with R=10 m.

          Figure 2-4 111 mm3 steel block with a capillary tube.

Question 2-4. Provide the permeability of the steel block shown in Figure 2-4 in the direction
horizontally perpendicular to the blue arrow.

The capillary tube considered may not be parallel to the rock bedding and/or flow direction
(Figure 2-5). The rate calculated above must then be multiplied by / so that the true length of
the tube is accounted for:
  =    2-10

          

                                                                                                                   11
                          Darcy Equation and its limitations

Figure 2-5 An inclined capillary tube to introduce the tortuosity concept.

In addition, the rate of interest is parallel to the bedding and therefore, only the flow component
parallel to the bedding which is / fraction of the above rate should be calculated:

 =     2-11
          

Defining tortuosity as  = ()2, the above equation can be re-written as:

                                               

 =   where  =  2-12
                        

In practice, 1 <  < 3.

Question 2-5. Number of holes drilled in a steel block are doubled. How is its permeability
changed?

Question 2-6. (True/False) There are  capillary tubes all with same radius () and tortuosity ()
in an otherwise impermeable rock. The effective permeability of the rock is given by  = 2

                                                                                                                                                                 8

where  is the fraction of the bulk volume taken by all capillary tubes i.e. the porosity.

Question 2-7. Consider a rock with 1000-mD permeability, 0.25 porosity, and a tortuosity of 3.
Assuming the rock consists of equal-sized capillary tubes, calculate the radius of each tube.

                                                                            12
                                        Petroleum Reservoir Dynamics

Following the above, it is important to distinguish the following velocity definitions:
     Superficial velocity is the flow rate () divided by cross-sectional area (A):  = 

                                                                                                                                                    

     Advance velocity is the velocity to external observer which should take the actual area
         open to flow i.e.    in the denominator:  =   = 

     Interstitial velocity is the average velocity within the flow passage given by:  =
          

     Streamline velocity varies within the flow passage so that ( = 0) = 2,
         ( = ) = 0.

Question 2-8. Which of the superficial, advance, and interstitial velocities is the largest?

2.3 Fracture permeability

It can be mathematically derived that the intrinsic permeability of a fracture with a width wf is
given by:

      2                              2-13

            

 =
12

When fracture width in ft, the following can then be used to obtain the permeability in mD:

[mD] = 7.84  1012([ft])2            2-14

For a single fracture in an otherwise impermeable rock, the permeability would be given by:

 =                                   2-15

For a rock with multiple fractures:

                                     2-16

 =  ,,

        =1

                                                                                             13
           Darcy Equation and its limitations

Example 2-3. Assume two parallel fractures in an otherwise impermeable medium as shown in
Figure 2.6 with  = 3 ft,  = 2 ft, and  = 4 ft. The fracture widths are 1 = 0.01 in, and 2 =
0.02 in. Calculate (a) the porosity for each fracture, (b) intrinsic fracture permeability for each
fracture, and (c) the effective permeability.

Solution:                                                                         W

a) 1 = 0.01/12 3 = 0.00028, 2 = 0.02/12 3 = 0.00056

                                                                                                                                                    h

Therefore, the total porosity is 0.00028+0.00056=0.00084

b) [] = 7.84  1012([ft])2                                                           L

Therefore,                                     w1                             w2

1 = 7.84  1012(0.01/12)2 = 5.4  106mD        Figure 2-6. Fractured rock.
2 = 7.84  1012(0.02/12)2 = 21.7  106mD

c)  = 11 + 22 = 0.00028  5.4  106 + 0.00056  21.7  106 = 13600 mD

Note that fracture 2's contribution to flow is 8 times more than fracture 1.

Example 2-4. A core holder has been tested to measure a reservoir rock core permeability. The
core diameter is 7 cm (~2 5/8 inches) and its permeability is 0.1 Darcy. The rubber sleeve which
should tightly seal the core has been leaking. Assuming a uniform gap at the interface between
the core and the rubber sleeve with 50 m aperture, calculate the permeability (in Darcy)
obtained by core data analysis.

                            ubber
                          sleeve

                             Core

           Figure 2-7 A leaking core holder with a uniform gap separating the core from the core holder wall.

Solution: The overall permeability of the core is obtained based on the following equation:

                                                                                                                   14
                     Petroleum Reservoir Dynamics

 =  + (1 - )

Let  be the aperture of the gap, and  be radius of the core holder. Note that  >> . Then,

          2 2
 = 2 = 

Also,

         2
 = 12

Therefore,

2 2               2
 =  12 + (1 -  ) 

       3    2
 = 6 + (1 -  ) 

Replacement into the above gives:

 = (50  10-6)3 + (1 - 2  50  10-6)  0.1  10-12
       6  0.035     0.035

And
 = 0.695  10-12 2  0.7 Darcy

2.4 Carman-Kozeny equation

Bundle of tubes idealization of the rock can also permit obtaining an equation to relate the
porosity to permeability. Be reminded that  identical capillary tubes in an otherwise
impermeable rock give an effective permeability of  = 2  where  is the fraction of bulk

                                                                                                      8

volume taken by all tubes. Now, consider a rock composed of identical spherical grains each with
diameter . How the (effective) permeability of the two media (granular material and the
capillary tube model) can be related? The key is to consider that the hydraulic radius is identical
for both media. The hydraulic radius is defined as the ratio of the pore space to the surface area
contacted by the fluid filling it:

                                                     15
                             Darcy Equation and its limitations

 = Pore volume 2-17
       Contacted surface area

For a capillary tube model:

    2                                                                                 2-18
 =      =
    2 2

The rock permeability with capillary tube is given by:

 = 2  = 2  2-19
      8 2

For a rock composed of spherical grains of equal size with diameter Dp we can write:

    Pore volume              Grain volume              4  3       
                                                    3( 2 )
 = Grain volume  Contacted surface area = 1-  2 = 1- 6 2-20
                                                        4 ( 2 )

Replacement of Rh obtained for granular material (Eq 2.20) into Eq 2.19 gives:

=   2 2 1  2 3                                                                        2-21
              =
   (1-) 36 2  72 (1-)2       2

This equation is referred to as Carman-Kozeny equation in its simplest form. Sometimes, it is
presented in the following generalized form with   [4,5]:

 =   2                                                                                2-22

     (1-)  2

The following form is also used for data fitting:

 =  2                                                                                 2-23

Question 2-9. Based on simple-form Carman-Kozeny equation, which parameter affects the
permeability the most?

Question 2-10. How does the permeability change as a result of doubling the grain size?
                                                                                                                   16
                                        Petroleum Reservoir Dynamics

Question 2-11. All else held constant, what would be the permeability ratio (2/1) when porosity
is increased from 1=10% to 2 =20%? Use simplest form of CK equation.

Question 2-12. (True/False) Increasing the grain size increases both permeability and porosity.

Question 2-13. Based on Carman-Kozeny equation (fitting form), which of the following graphs is
linear? (a)  vs , (b) () vs , (c)  vs (), (d) () vs ()

2.5 Complications
Darcy's equation may not be applicable under certain conditions requiring further modifications.
In the following, we discuss some of major conditions where Darcy equation needs to be modified
before applicable.
2.5.1 Inertia
Reynolds number for flow in a rock or porous medium is given by:
  = 2-24 

           
where  is the average grain diameter, and  is Darcy (superficial) velocity.  can be high e.g.
due to high flow rates or low viscosities. At high , the flow becomes less efficient, and more
energy will be lost for same flow rate. Thus, for the fluid to attain a given velocity, higher pressure
gradient will be experienced. The flow is considered Darcy flow as long as  < 1. This is often
the case in porous rocks filled with hydrocarbons except in the region close to the wellbore where
flow velocities are high. When  exceeds 10, the flow is called non-Darcy flow. The pressure
gradient for Darcy's law is given by:
  =  =   2-25
   
For non-Darcy flow, additional pressure gradient is expected for the same velocity . The
additional term is given in the Forchheimer equation:
  =   + 2 2-26
  
where  is the Forchheimer coefficient given by:

                                                                                                                   17
Darcy Equation and its limitations

[ft-1] = 1.88  1010([mD])-1.47-0.53  2-27

Based on this equation, non-Darcy effect is most significant for low porosity rock flowing at high
rates. Low porosity implies high tortuosity resulting in less efficient flow of the fluid in the more
tortuous paths at higher velocities. In short, for the same pressure drop, the velocity will be
higher for Darcy flow compared to non-Darcy flow. It follows that for the same velocity, pressure
drop will be larger for non-Darcy flow compared to Darcy flow.

Question 2-14. (True/False) Non-Darcy flow develops only if Reynolds number exceeds 2100.
Question 2-15. (True/False) Non-Darcy flow makes production less efficient.
Question 2-16. (True/False) Non-Darcy effect is more significant in lower porosity rock.

2.5.2 Slippage

At low pressures in small pores, gas velocity at the pore wall may be no longer zero due to
slippage. Gas molecules slippage on the pore wall leads to an apparent permeability larger than
the actual permeability of the rock. This is known as Klinkenberg effect following his observation
that the gas apparent permeability () increases linearly with reciprocal of the average pressure
at which it was measured ():

                 
  =  (1 + ) 2-28

where  is the slippage factor and  is the absolute permeability. Based on this equation, the gas
permeability measurements can be plotted versus 1/ to obtain the absolute permeability
(Figure 2-8). The absolute permeability would be the intercept of the fitted line with y-axis and
the slope will be equal to the product  from which slippage factor () can be obtained.

                                                                                           18
                                        Petroleum Reservoir Dynamics

                                  

                                                                         1 
                        Figure 2-8 Variation of gas permeability versus reciprocal of mean pressure.

It should be noted that for a conventional reservoir rock, b is generally very low such that the
slippage effect is negligible at reservoir conditions. Accounting for gas slippage would be only
important at the lab in calculating the absolute permeability from gas permeability
measurements. However, gas slippage can affect the permeability at the reservoir conditions in
unconventional shale/tight reservoirs significantly mainly because the pore size is very small in
the same order of the size of hydrocarbon molecules. The apparent permeability can be 100
times larger than the absolute permeability. The required correction highly depends on the
Knudsen number which is the ratio of gas molecule mean free path to pore diameter.

Question 2-17. Permeability of a rock is measured using Nitrogen at average pressures of 0.5 and
1 atm. The resulting apparent permeabilities are 45 and 35 mD, respectively. Calculate the
absolute permeability.
Question 2-18. (True/False) Absolute permeability is independent of fluid type.
Question 2-19. (True/False) Apparent permeability with gas at low pressure is higher than
absolute permeability.
Question 2-20. (True/False) Klinkenberg effect is generally visible at conventional reservoir
conditions.

                                                                                                                   19
                          Darcy Equation and its limitations

2.5.3 Heterogeneity

The permeability can vary from one location to another implying rock heterogeneity.
Heterogeneity may be experienced at small- or large-scale. Near-wellbore damages associated
with well drilling can induce small-scale heterogeneities. Sparse distribution of shale facies in a
sandstone reservoir is another example of small-scale heterogeneity. Reservoir layering where
the fluid flows toward the well through multiple contiguous layers with different permeabilities
is an example of large-scale heterogeneity. Such a large-scale heterogeneity can be formulated
using flow in-parallel and in-series approach (see Figure 2-9) to obtain an equivalent (average)
permeability representing the reservoir.

(a)                       (b)

q k t 1                   h1 q                                k1 k2 k3
               k2                                             L1 L2 L3
               k3                          t

                          h2

                          h3

                          Figure 2-9 (a) Flow in parallel, and (b) flow in series.

2.5.3.1 Flow in parallel

Consider the 3-layer system shown in Figure 2-9a. The total flow rate () through the system is
equal to the sum of flow rates through each of the layers, i.e.

 = 1 + 2 + 3                                                                        2-29

According to Darcy equation, the above equation can be re-written as:

   = 11  + 22  + 33  2-30
        

where  is the equivalent permeability of the system. Note that the pressure drop () and the
length () over which it occurs are identical for all the layers. Therefore, () and () are written
with no subscript. Same applies to viscosity () because the same fluid is flowing through all
layers. Since the area cross-sectional to the flow is equal to the width multiplied by the thickness
of each layer, we can re-write the above equation as:

                                                                                          20
                        Petroleum Reservoir Dynamics

  = 11  + 22  + 33  2-31
                          

Therefore, the equivalent permeability is obtained by arithmetic averaging of the permeabilities.

 = 11 + 22 + 33                                                               2-32
                

More generally, for flow through n parallel layers, we can write:

            

   =1
 =                                                                            2-33
=1 

2.5.3.2 Flow in series

Consider a system composed of 3 rocks with different permeabilities and lengths through which
the fluid flows in series (Figure 2-9b). For this system, the total pressure drop would be equal to
the sum of pressure drops over each of the rock sections, i.e.

 = 1 + 2 + 3                                                                  2-34

Re-writing this equation based on Darcy equation, we get:

 = 1 + 2 + 3 2-35
  1 2 3

After cancelling identical properties, we get:

 = 1 + 2 + 3                                                                  2-36
 1 2 3

Accordingly, the equivalent permeability is given by the harmonic averaging:

 = 1 + 2 + 3 1 2 3                                                            2-37
     1 + 2 + 3

More generally, for  sections, we can write:

 = =1                                                                         2-38
      
       =1 

                                                                                    21
                                      Darcy Equation and its limitations

Example 2-5: Consider the system shown in Figure 2-10. Calculate the equivalent permeability
(a) in horizontal direction, and (b) in vertical direction.
Solution: For the horizontal flow, we use the equation for flow in parallel layers. Therefore,
 = 100  10 + 200  5 + 50  15 = 91.7 mD

                10 + 5 + 15
For the flow in vertical direction, the in-series equation should be used according to which,
 = 10 + 5 + 15 = 70.6 mD

     100 10 + 200 5 + 50 15

100 mD                                   10 ft
200 mD                                    5 ft
50 mD
                                         15 ft
               Figure 2-10 Example 2-5.

Effect of heterogeneity on flow is analogous to light refraction. Refraction is bending of the light
when traveling from one medium to another where light speed is different. The bending occurs
such that the light finds the quickest route of travel from one object to another e.g. from a fish
in the water to an observer's eyes (Figure 2-11). The light bends so that it minimizes the time to
reach the observer eyes which means maximizing the distance travelled in the high-speed
medium (air) and minimizing the distance travelled in the low-speed medium (water). For the
same reason, flow lines bend for the flow from fine to coarse grain rock and vice versa (see Figure
2-12).

                                                22
                                        Petroleum Reservoir Dynamics

                  Figure 2-11 Light refraction when traveling from a fish in the water to observer's eyes.

 Figure 2-12 Refraction of flow when flowing from low to high permeability and vice versa (Roti and Dawe 1993).

Question 2-21. The flow in a beadpack with different bead sizes is shown in Figure 2-13.
Streamlines are marked with dye. Flow is from high to low permeability. (True/False)

                                                                                                                   23
                                      Darcy Equation and its limitations

                      Figure 2-13 Flow in a beadpack with different bead sizes (Roti and Dawe 1993).

2.5.4 Anisotropy
While the permeability can vary from one location to another (heterogeneity), it can be also
different in different directions for a given location. Variation of permeability in different
directions for a given location is referred to as anisotropy. If permeabilities in different directions
are identical for any given location, the rock is considered isotropic. The most significant
anisotropy is evident in the ratio of vertical to horizontal permeability (kv/kh) which can be very
low but a default number may be 0.1. The example problem in the previous section indicated
that the vertical permeability is lower than horizontal permeability because harmonic averaging
results in lower value than arithmetic averaging. Also, rock compaction is known to alter the
grains roundness during deposition. Consequently, the angularity of grains increases with rock
compaction. Figure 2-14 shows how roundness of the spherical grains changes upon compaction.
As a consequence of increased angularity, the rock presents less continuity to flow in vertical
direction, hence, less permeability.

     Figure 2-14 Changes in rock angularity upon compaction leading to lower vertical permeability compared to
                                                        horizontal permeability.

                                                                                                                   24
                                        Petroleum Reservoir Dynamics

Distinction between permeability heterogeneity and anisotropy is demonstrated in Figure 2-15.
The rock is considered homogeneous and isotropic if the permeability is independent of both
location and direction (Figure 2-15 Possible combinations of permeability
homogeneity/heterogeneity and isotropy/anisotropy (Freeze and Cherry 1979).Figure 2-15a).
The rock is anisotropic but homogeneous if the permeability varies with direction but remains
unchanged in that direction from one location to another (Figure 2-15b). The rock is
heterogeneous but isotropic if the permeability changes from one location to another but it does
not vary with direction (Figure 2-15c). The rock is heterogeneous and anisotropic if permeability
changes with both location and direction while the anisotropy (kz/kx) may or may not change
from one location to another.

(a)  (b)

(c)  (d)

Figure 2-15 Possible combinations of permeability homogeneity/heterogeneity and isotropy/anisotropy (Freeze and
                                                              Cherry 1979).

Example 2-6. The blocks in Figure 2-16 are impermeable and 2 ft (in x-direction) by 1 ft (in y-
direction) each. Assuming that the slots separating the blocks are uniform in aperture in both
directions, calculate the anisotropy kx/ky.

                                                                                                                   25
      Darcy Equation and its limitations

   y

      x

   Figure 2-16. Block model to illustrate the anisotropy concept.

Solution: Note that:  = . Therefore:                (  )

                                                    = () . The intrinsic permeabilities of the

                                                                   

openings in  and  directions are the same. The fraction of the pore space is independent of

direction, and we can consider identical volume fractions in - and - directions. Therefore:  =

                                                                                                                                                              

. The tortuosity in x-direction is unity because the fluids follow a straight line parallel to x-axis.



Considering all the 5 blocks in  and  directions, the tortuosity in -direction is given by:  =

(9)2. However, if only 4 blocks are considered, we get:  = (8)2. For 3 blocks, we get:  =
5                                                  4

(5)2. For 2 blocks:  = (4)2. For 1 block:  = 1.
3  2

To generalize the above observations, when the number of blocks is even  = 4 and when the
number is odd  = (2-1)2where  is the number of blocks. In the context of reservoir

                                           

characterization, a core sample needs to be representative of the reservoir and therefore for a
homogenous rock, the tortuosity should be independent of scale. We note that as   , i.e.
when the number of blocks is increased, the tortuosity becomes identical for both even and odd
number of blocks. This suggests that  = 4 is the correct tortuosity.

In short, tortuosity should be evaluated over a symmetry element which is 12 blocks in  and 
directions as shown by the red square in Figure 2-16.

                                                                   26
                                        Petroleum Reservoir Dynamics
Example 2-7. Consider a block of rock 2.51.02.0 m3 (xyz) shown in Figure 2-17. The rock is
impermeable granite with a fracture plane perpendicular to y-direction. The fracture width is 1
mm.
(a) What is the intrinsic permeability (in Darcy) of the fracture?
(b) What is the effective permeability (in Darcy) of the rock in x-direction?
(c) What is the effective permeability (in Darcy) of the rock in y-direction?
(d) What is the effective permeability (in Darcy) of the rock in x-direction if the fracture is not
parallel to the x-axis with actual length of 2.65 m?
(e) What is the effective permeability (in Darcy) of the rock in x-direction if the fracture is replaced
by a straight capillary tube (in x-direction) with 4 mm radius?
(f) What is the effective permeability (in Darcy) of the rock in x-direction if it contains both the
inclined fracture (part (d)) and straight capillary tube (part (e))?
(g) What is the effective permeability (in Darcy) of the rock in part (f), in z-direction?

           z
          y x

                Figure 2-17. Impermeable block with a fracture.

                                                                                                                   27
                           Darcy Equation and its limitations

Solution:

(a)  2 10-6 ,  = = = 83333  10-122 = 83333
           12     12

(b)  = ,  = 83333  0.001 1 = 83.3

(c) zero.

(d)  =     ,   =  833330.0012.65

                                   12.5
                      2.65 2 = 78.6 
                      ()
                      2.5

(e)  = ,  = 2 8  2  = 1610-6 8  1610-6 21 = 50.2  10-122 (10-122 1 ) = 50.2 

(f)  =  +  = 78.6 + 50.2  128.8 

(g)  ,  83333  = = 12.5 0.0012.65 = 88.33 
                      1

                                                                                     28
                                        Petroleum Reservoir Dynamics
2.6 Chapter Problems
Problem 2-1. Consider a block of rock 111 cm3. The rock is impermeable granite with a fracture
parallel to one of the faces of the block. The fracture width is 10 m.
(a) What is the intrinsic permeability (in Darcy) of the fracture?
(b) What is the effective permeability (in Darcy) of the rock?

Problem 2-2. Consider a block of rock 111 cm3. The rock is impermeable granite with a fracture
and two capillary tubes all parallel to one of the faces of the block. The fracture width is 0.5 m
and capillary tubes' radii are 7 and 8 m. What is the effective permeability (in Darcy) of the rock?

Problem 2-3. Consider a block of rock 111 m3. The rock is impermeable granite with a fracture
plane perpendicular to y-direction. The fracture width is 1 mm.
(a) What is the intrinsic permeability (in Darcy) of the fracture?
(b) What is the effective permeability (in Darcy) of the rock in x-direction?
(c) What is the effective permeability (in Darcy) of the rock in y-direction?
(d) What is the effective permeability (in Darcy) of the rock in x-direction if the fracture is replaced
by a capillary tube (in same direction) with 1 mm radius?
(e) What is the effective permeability (in Darcy) of the rock in x-direction if it contains both the
fracture and capillary tube?
(f) What is the effective permeability (in Darcy) of this rock in z-direction?
(g) Re-answer part (b) considering a fracture that is not parallel to the x-axis with actual length of
1.2 m?

                                                                                                                   29
                                      Darcy Equation and its limitations

                      z x
                           y

Problem 2-4. Consider a block of rock 111 cm3. The rock is impermeable granite with a fracture
plane perpendicular to y-direction. The fracture width is 0.1 mm.
(a) What is the intrinsic permeability (in Darcy) of the fracture?
(b) What is the effective permeability (in Darcy) of the rock in x-direction?
(c) What is the effective permeability (in Darcy) of the rock in y-direction?
(d) What is the effective permeability (in Darcy) of the rock in x-direction if the fracture is replaced
by a capillary tube (in x-direction) with 0.1 mm radius?
(e) What is the effective permeability (in Darcy) of the rock in x-direction if it contains both the
fracture and capillary tube?
(f) What is the effective permeability (in Darcy) of this rock in z-direction?

                               z x
                                   y

                                                                                                                   30
                                        Petroleum Reservoir Dynamics
Problem 2-5. All else held constant, what would be the permeability ratio (k2/k1) when porosity
is increased from 1=15% to 2=30%?

Problem 2-6. The blocks in the figure below are impermeable and 2 ft (in x-direction) by 1 ft (in
y-direction) each. Assuming that the slots separating the blocks are uniform in thickness in both
directions, calculate the anisotropy kx/ky.

  y
             x

Problem 2-7. The blocks in the figure below are impermeable and 3 ft (in x-direction) by 1 ft (in
y-direction) each. Assuming that the slots separating the blocks are uniform in thickness in both
directions, calculate the anisotropy kx/ky.

 y
         x

                                                                                                                   31
                                          Flow geometry

3 Flow geometry

3.1 Darcy equation in field units

In the previous chapter, we presented the Darcy equation and its complications. The presented
Darcy equation for flow of single-phase fluid with viscosity  and rate q along a core with
permeability k, length L, and cross-sectional area A is:

  =   3-1
       

where p is the pressure drop along the core. Darcy's equation has been previously presented in
SI units:

    m3 [m2][m2] [Pa]
  [ s ] = [Pa. s] [m] 3-2

The equation in field units is given by:

 [bbl] = 0.001127 [mD][ft2] [psi] 3-3
day               [cp] [ft]

Proof is shown in the following. Let  be the coefficient:

 [bbl] =  [mD][ft2] [psi] 3-4
day            [cp] [ft]

Rearranging the equation gives:
   [bbl day] [cp][ft] 3-5

 [mD][ft2][psi] = 

We know that:

 [bbl day] ( 1 m 6.29 bbl) (86400 s)  3 1 day [cp] ( 1 Pa. s 1000 cp) [ft] ( 1m 3.281 ft)
            10-15 m2 1 m2 105 Pa = 1 3-6
[mD] (            ) [ft2] (        2 2) [psi] (            )
            1 mD             3.281 ft            14.7 psi

Therefore,

                                                                                           32
                  Petroleum Reservoir Dynamics

 [bbl day] ( 1 m 6.29 bbl) (86400 s)  3 1 day [] ( 1 Pa. s 1000 cp) [] ( 1 m 3.281 ft)
    [] (10-15 m2) [2] ( 1 m2 105 Pa = 2 2) [] ( )
            1 mD  3.281 ft   14.7 psi

  [day bbl] [cp][ft] 3.2812  14.7 3-7
[mD][ft2][psi] (6.29  86400  1000  3.281  10-15  105) =

         1
 (0.001127) = 1

Therefore,

  [bbl day] [cp][ft] 3-8
[mD][ft2][psi] =  = 0.001127

or

 [bbl] = 0.001127 [mD][ft2] [psi] 3-9
    day           [cp] [ft]

3.2 Flow geometry

Darcy equation presented above is valid only for horizontal flow along the rock e.g. core sample.
The flow lines are essentially linear extending from one side of the core to another. This is an
example of linear flow geometry. Another example is flow toward a planar fracture (Figure 3-1a).
Flow geometry, however, can be non-linear including radial (cylindrical) or spherical.

Vertical drilling with open-hole completion is probably the lowest cost approach to produce
hydrocarbons. For such fully penetrating vertical wells, the flow is horizontally radial (Figure 3-1b)
because the flow lines are all directed toward the wellbore (assuming that reservoir dip is
negligible). Vertical flow is negligible because of much lower vertical permeability. For a partially
penetrating well, the flow geometry is spherical (Figure 3-1c). In this chapter, we present the
equations for pressure variation considering linear, radial, and spherical geometries. The rock
and fluid are considered incompressible.

                                                                                        33
                                  Flow geometry

(a)                      (b)                     (c)

Figure 3-1 Flow geometry corresponding to (a) fractured well showing linear flow, (b) fully penetrating vertical well
showing radial flow, and (c) partially penetrating well showing spherical flow.

3.3 Incompressible flow

3.3.1 Incompressible linear flow

Let's consider linear flow at constant mass rate in an incompressible rock and fluid system. Mass

balance implies that mass rate into the reservoir must be equal to the mass rate out of it. If the

rock and fluid system is compressible, mass inflow rate may be different from mass outflow rate

since mass can accumulate in the system (Figure 3-2). However, even for a compressible system,

the mass inflow rate can eventually become equal to the mass outflow rate. In other words,

steady flow conditions will be eventually established. While steady flow necessitates the equality

of the mass rate into and out of the system, it does not imply that the corresponding volumetric

rates would be identical. Mathematically,  =  does not imply that () = () or

( ) = ( ) . The subscript rc indicates reservoir conditions. If the volumetric rates are
          

presented at identical pressure and temperature conditions (e.g. the standard conditions T=60 F

and p=14.65 psi), equal mass rates will have to translate to equal volumetric rate i.e.  = 

translates to () = (). The relationship between qrc and qsc is given by:

 =                                                                        3-10
      

where  is the formation volume factor defined as the volume at reservoir conditions divided by

that at surface conditions which is pressure dependent. The equality () = () would

then be equivalent to ( ) = ( ) .
                                    

                                                                                34
          Petroleum Reservoir Dynamics

                                                   

                                          Figure 3-2 Mass balance over a control volume.

With introduction of B, the rate q will be always presented at surface conditions. In other words,
(   ) = ( )    would simply translates into  = . In essence, including B in the
volumetric rate equations turns them into mass rate equations. Using  is therefore essential
when writing the equations for steady flow. However, for incompressible flow,  is unity and
independent of pressure. Nevertheless, we include it in the incompressible flow equations for
completeness.

For linear flow in an incompressible rock and fluid system, the mass rate is identical at any cross
section perpendicular to the flow. As an example, one can consider steady linear flow from a
reservoir into a fracture with surface area A (Figure 3-3). The following equation is valid at any
location in the system,  =  .

                                                 

       A

                x  x=L

          x=0

          p=p0     p=pL

          Figure 3-3 Linear flow into a fracture.

In order to obtain the pressure at any given location  in the reservoir, the above should be
rewritten as:

        
 =   3-11

Integration of the above is easy because the coefficient  is constant (independent of pressure

                                                                                                

and location). Therefore,

        

0 0   =    =  0   3-12

                                                     35
                                          Flow geometry

Therefore,


 = ( - 0)                                                    3-13


This can be rewritten as:

  = 0 +   3-14
              

at  = 0, we get  = 0. At  = , we get:
  = 0 +   3-15

               
or

 =   - 0 3-16
      

In field units, the equations above are:

 = 0.001127  -0                  = 0.001127  -0              3-17

                                                           

The above equations suggest that for incompressible linear flow, the pressure changes linearly
with distance (Figure 3-4).

                             p

                                   p0
                                                                                                       x

            Figure 3-4 For incompressible linear flow, the pressure changes linearly with distance.

                                                                                                               36
                                        Petroleum Reservoir Dynamics

3.3.2 Incompressible radial flow
For radial flow (Figure 3-5), the Darcy equation is:
  =   3-18

        
where  = 2. Therefore,
  = 2   3-19

         

            Figure 3-5 Radial flow toward a fully penetrating well in a horizontal reservoir.

The latter equation can be rewritten as:

 2
 =   3-20

Integration gives:

       2            
 =                                                                                             3-21
             

Therefore,

      2
 () =  ( - ) 3-22

or

                                                                                                     37
                                          Flow geometry

               
 =  + 2  () 3-23

This equation implies that:

 =  +   (  ) 3-24
               2 

or

    2  - 
 = 
                                                            3-25
      ()

In field units:

 =  (  0.00708 -)                    and   =  0.00708 -     3-26

                                                        ()

This equation implies that the pressure for radial flow would show linear behavior when plotted
versus () (or versus ()) as shown in Figure 3-6.

                                     p

                                             pwf

                                                                                                               ln(r) or log(r)

                               Figure 3-6 Linear behavior of pressure versus  or  of radius.

When plotted versus radius, the pressure shows a concave downward graph as shown in Figure
3-7. While this is mathematically drawn from the equation, it can be alternatively explained
based on Eq. (3.18) which is valid for any flow geometry including radial and linear. In linear form,

                                                                                                                   38
                                        Petroleum Reservoir Dynamics

the surface area perpendicular to flow remains the same as distance from the well is decreased.
On the contrary, the surface area to flow decreases toward the well, in radial flow. To
accommodate the assigned constant rate ( =  ) while the area is reducing, the pressure
gradient has to increase toward the well.

            p

            pwf

                                                                 r
             Figure 3-7 Pressure variation with respect to radius for incompressible radial flow.

Example 3-1. Calculate the pressure 100-ft away from the wellbore for a well producing at 100
STB/day if the pressure at the wellbore is 1000 psi, the reservoir permeability is 100 mD, and
reservoir thickness is 30 ft. The oil formation volume factor is 1.2 bbl/STB and the oil viscosity is
0.5 cp. The well is vertical and fully penetrates the formation. Wellbore radius is 0.35 ft.

Solution:

=  0.00708  - 

     ()        

Therefore,

            141.2    141.2(100)(0.5)(1.2) 100
 =  +   () = 1000 +              (0.35) = 1016 psi
                     (100)(30)

                                                                                                   39
                                      Flow geometry

3.3.3 Incompressible spherical flow

Again, we start with Darcy equation:

  =   3-27
        

where  = 42. Therefore,

 = 4 2  3-28
       

Then:                                                          3-29
      4

   2  =   

Integration gives:

1 1 4
 -  =  ( - ) 3-30

Therefore,

               1 1
 =  + 4 ( - ) 3-31

and

                1 1
 =  + 4 ( - ) 3-32

Therefore,

     4  - 
 =  1 1
     ( - )                                                     3-33

Multiplying by 0.001127, the equation in field units becomes:

 = 1 1 0.01416 -    and   = 1 1 0.01416 -                      3-34

             (-)                      (-)

It can be implied that plotting the pressure versus 1/ gives linear behavior as shown in Figure
3-8. Similar to radial flow, the area decreases toward the well and therefore the graph is concave

                                                                                                                   40
Pressure                                Petroleum Reservoir Dynamics
downward when plotted versus radius. However, since the area decreases faster for spherical
flow compared to radial flow, the pressure gradient is steeper for spherical flow (Figure 3-9).

                                              p

                                                                                                                  1/r

                   Figure 3-8 Linear behavior of pressure versus reciprocal of radius for spherical flow.

                                                                                                        Linear flow
                                                                                                        Radial flow
                                                                                                        Spherical flow

                                                                      x or r
                      Figure 3-9 Comparison of pressure behavior of linear, radial, and spherical flow.

Question 3-1. (True/False) Consider linear flow at constant mass rate into a reservoir. Mass
balance implies that mass inflow rate must be equal to the mass outflow rate.

                                                                                                                   41
                                                 Flow geometry

Question 3-2. (True/False) Consider linear flow at constant mass rate into an incompressible rock
and fluid system. Mass balance implies that mass inflow rate must be equal to the mass outflow
rate.

Question 3-3. (True/False) If the rock and fluid system is compressible, mass inflow rate may be
different from mass outflow rate.

Question 3-4. (True/False) For a compressible rock and fluid system, the mass inflow rate will
eventually get equal to the mass outflow rate.

Question 3-5. (True/False) Equal mass rates into and out of the system imply that the
corresponding volumetric rates would be identical.

Question 3-6. (True/False)  =   , = ,.

Question 3-7. (True/False)  =   (   ) = ( )    .

Question 3-8. (True/False)  =   , = ,.

Question 3-9. (True/False)  =   (   ) = ( )    .

Question 3-10. (True/False) For incompressible linear flow, the mass rate is identical at any cross
section perpendicular to the flow.

Question 3-11. (True/False) For incompressible linear flow, the pressure does not change with
distance.

Question 3-12. (True/False) For incompressible linear flow, the pressure gradient does not change
with distance.

Question 3-13. (True/False) For incompressible radial flow, the pressure gradient does not change
with distance.

Question 3-14. (True/False) The pressure gradient increases toward the well for both
incompressible radial and spherical flow.

                                                                                                                   42
                                        Petroleum Reservoir Dynamics

Question 3-15. Plotting pressure with respect to which of the following provides linear behavior
for radial flow? (a) r, (b) 1/r, (c) ln(r), (d) log(r), (e) Both C and D.

Question 3-16. Plotting pressure with respect to which of the following provides linear behavior
for spherical flow? (a) r, (b) 1/r, (c) ln(r).

3.3.4 Skin factor

The well pressure () is sometimes affected by near-wellbore skin/stimulation that
worsens/enhances the pressure drop near the wellbore. Let's consider wellbore damage for
consistency. The additional pressure drop because of damage () would be equal to the
pressure drop over the damage zone in presence of damage ( - 0) minus the pressure
drop over the damage zone if there was no damage( - 0) as shown in Figure 3-10.
Mathematically, this means:

 = 0 - 

= ( - ) - ( - 0)

=   (  ) -   (  )
2  2 
                                                  3-35
=  [(  - 1)  (  )]
2        

   
= 2 

where  is skin factor defined by:

 = (  - 1)  (  ) 3-36
      

The following can be implied from this equation:

 Skin factor is a dimensionless number.
 Skin factor is a lumped parameter that depends on both the extent (radius) of well

    damage zone and its permeability. Having an estimate of skin factor, one cannot obtain
     and  separately.

                                                        43
                                             Flow geometry

 The effect of radius of the damage zone on the skin factor appears in the ln function and
    therefore muted. The skin is more controlled by the damage zone permeability than its
    extent.

 There is a negative lower bound for the skin factor. When   , then   -  (  ).
    On the other hand, there is (theoretically) no upper bound for the skin factor since /
    can take any large number when  is decreased compared to .

 Skin factor is negative if there is stimulation ( < ) and positive if there is damage ( >
    ).

                                        p

              pwf0                rs                                log(r)
              pwf

                  rw

                                  Figure 3-10 Skin factor concept.

The radial flow equation presented earlier can be re-written to account for skin. To do so, the
skin pressure drop should be added to the original pressure drop:

                   
() -  = 2  () + 

     
= 2  () + 2  3-37

  
= 2 [ () + ]

Comparison of the equation to the original one (   (  )) indicates that the skin effect can
                                      2  

be added simply by adding the skin factor to (/). This hints that one can lump the skin

factor into the ln-term so that:

                                                                            44
           Petroleum Reservoir Dynamics

                                      
() -  = 2 [ () + ] = 2  () 3-38

where  is the apparent wellbore radius. From the equation above:

       
[ () + ] =  () 3-39

Therefore,

  =  (   )     =  (-) 3-40

Note that if the skin factor is zero, (-) = 0, and therefore,  = . If skin factor is positive
(well is damaged), (-) < 1, and consequently,  < . Similarly,  >  for a
stimulated well. This is also physically explainable because a damaged/stimulated well acts as if
its radius is smaller/larger than its actual radius.

For a hydraulically fractured well (with high conductivity fracture), it has been shown that:

 =                                                                3-41
  2

where  is the fracture half-length.

Question 3-17. Which of the following statements is incorrect regarding the skin factor? (a) Skin
factor is dimensionless. (b) The skin factor is more impacted by permeability of the damaged zone
than its radius. (c) The skin factor can theoretically take any negative or positive number. (d) Skin
factor is negative if reservoir is stimulated.

Question 3-18. (True/False) A stimulated well acts as if its radius is larger than its actual radius.

Question 3-19. The fracture length of a fractured well is 500 ft. Calculate its skin factor. Wellbore
radius is 0.5 ft.

                                                                                               45
                       Flow geometry

3.3.5 Productivity index and flow efficiency

Two wells producing at the same rate from a given reservoir may be considered equally
productive. However, it is important to consider the pressure drop corresponding to each of the
wells. For instance, consider two wells producing 1000 STB/day from a reservoir with pressure of
5000 psi at the external boundary. However, the wells are producing by dropping the pressure at
the wellbore to 1000 and 2000 psi respectively. Which well is more favorable? Obviously, the
well which is able to produce the same rate (1000 STB/day) while dropping the pressure less i.e.
the well for which the well pressure is dropped to 2000 psi. This clearly shows that well
productivity needs to account for both rate and pressure drop. Accordingly, the productivity
index which shows the production capacity of the well is defined as the ratio of the production
rate to the pressure drop:

  
 =  =  -  3-42

For the steady-state radial flow, we can write:

    2
 =  =  [ () + ] 3-43

The flow efficiency (JD) is defined as the ratio of the actual well productivity index over that if the
well is not damaged/stimulated:

         (  )                                    3-44
 =  =  

        (  ) + 
                     

Question 3-20. (True/False) Flow efficiency of a damaged well is less then unity.

Question 3-21. For a well in the center of a closed circular drainage area with typical wellbore
radius, a rule of thumb value of  ( )  7 is often used. Calculate the fold of increase in a well

                                                              

productivity, if its skin factor is dropped (using an acid job) from 49 to 7.

                                                       46
                         Petroleum Reservoir Dynamics

3.3.6 Permeability averaging in radial flow

In a composite radial system, the permeability is different at different radial distances from the
wellbore (Figure 3-11). This represents flow in series in radial geometry. Considering 3 different
permeabilities over 3 regions, we can write:

3 -  = (3 - 2) + (2 - 1) + (1 - )                      3-45

Accordingly, we get:

 ln (3 ) =  ln (3) +  ln (2) +  ln (1 ) 3-46
2  23 2 22 1 21 

where  is the average permeability. Cancelling the identical coefficients on both sides followed
by rearrangement gives:

          ln (3 )
=                   
ln ( ) ln ( )  3 2 ln (1 ) 3-47
    2 + 1 + 
   3          2       1

Or more generally:

 ln ( )
=                                                      3-48
            
          ln ( )
          -1
          

      =1

where  =  and 0 = .

                                                             47
            Flow geometry

            pw p1              p2                               p3

            k1             k2                               k3

            rw r1              r2                               r3

            Figure 3-11 Radial flow in series formulation.

The above equation is for radial flow in series. It can be easily shows that for radial flow in parallel
layers, the same averaging equation as linear flow is still valid:

     1    
  =
 =                                                                                        3-49
=1 

Example 3-2. Consider radial flow in the system depicted in the figure below. Calculate:
(a) The skin factor.
(b) The average permeability.
(c) The wellbore pressure if there was no damage.
(d) The pressure at the damaged zone radius.
(e) The pressure at the reservoir external radius.
(f) The wellbore apparent radius.
(g) The productivity index.
(h) The flow efficiency.

                                                                                                48
                               Petroleum Reservoir Dynamics

                               q= 500 STB/day
                               pwf = 350 psi

                               rw = 0.3 ft
                               B = 1.2 bbl/STB
                                = 0.8 cp

                        30 ft                  200 mD          60 ft
                    10 mD

                                    3000 ft

Solution:

(a)  = (  - 1)  (  ) = (200 - 1)  (30) = 87.5
                    10              0.3

 ln(  )             ln(3000)

                          0.3
(b)  = ln( ) ln(  ) = ln( 0.3 3000) ln(0.3 30) = 19.51 mD
            +     200 + 10

(c)  =  0.00708  = 5000.81.2 0.0070820060 (87.5) = 494.35 psi

Therefore, 0 =  +  = 494.35 + 350 = 844.35 psi

(d)  =  +  0.00708 ( (  ) + ) = 350 + 5000.81.2 0.0070820060 ( (30 0.3) + 87.5) = 870.4 psi

(e)  =  +  0.00708 ( (  ) + ) = 350 + 5000.81.2 0.0070820060 ( (3000 0.3 ) + 87.5) = 896.4 psi
(f)  = - = 0.3  exp(-87.5) = 3  10-39ft

(g)  =  = 500 = 0.915 STB/day
- 896.4-350                    psi

                

(h)  =  =  - = -0 = 896.4-844.35 = 0.095
             -      -          896.4-350
                 0

                                                                                             49
                                         Flow geometry

Example 3-3. The following information are given for the configuration shown in the figure
below.

Production rate (q) = 500 STB/day                        Viscosity () = 2 cp

Wellbore radius (rw) = 0.35 ft                           Formation vol. factor (B) = 1.2 bbl/STB

Pressure at rw if damage occurred = 1000 psi             Original permeability (k) = 20 mD

Pressure at rw if no damage occurred = 1500 psi          Reservoir thickness (h) = 50 ft

(a) Calculate the skin pressure drop (Ps).

(b) Calculate the skin factor (s).

(c) Calculate the apparent well radius.

(d) Calculate the flow efficiency assuming reservoir radius of 1000 ft.

                                    rw

                                            Damage zone

                                                         re

Solution:  = 1500 - 1000 = 500 psi

0.00708  0.00708  20  50
 =   = 500  2  1.2 500 = 2.95

 = - = 0.35 ( - 2.95) = 0.0183 ft

ln ( )   ln (1000 0.35 )
 = ln ( ) +  ln ( ) + 2.95 = 1000 = 0.73
         0.35

3.4 Chapter Problems

Problem 3-1. A vertical well is perforated over the full thickness of a radial reservoir with outer
radius of 2840 ft and thickness of 30 ft. The well radius is 0.3 ft, the bottomhole pressure at the
well is 4000 psi, and well flow rate is 500 STB/day. The reservoir permeability is 500 mD, the fluid

                                                                                                                   50
                                        Petroleum Reservoir Dynamics

viscosity is 0.0025 Pa.s, and the fluid formation volume factor is 1.2 bbl/STB. The well skin factor
is 10. (a) Calculate the pressure at the outer radius of the reservoir assuming steady
incompressible flow. (b) Calculate the pressure at the damage zone radius if the damage zone
radius is 20 ft.

Problem 3-2. The following information are given for the configuration shown in Figure 3-11.

Production rate (q) = 1000 STB/day               Viscosity () = 1 cp

Wellbore radius (rw) = 0.5 ft                    Formation vol. factor (B) = 1.2 bbl/STB

Pressure at rw if damage occurred = 900 psi      Original permeability (k) = 50 mD

Pressure at rw if no damage occurred = 1500 psi  Reservoir thickness (h) = 20 ft

(a) Calculate the skin pressure drop (Ps).

(b) Calculate the skin factor (s).

(c) Calculate the apparent well radius.

Problem 3-3. The coefficient appearing in field units' Darcy equation is 0.001127. Provide the
coefficient if permeability is in Darcy and pressure is in atm.

                                                                                              51
                                       Steady-state compressible flow

4 Steady-state compressible flow

In the previous chapter, incompressible flow was formulated. For incompressible flow, the mass
inflow rate must be equal to the mass outflow rate. Since there is no mass accumulation in the
system, the pressure at any given location will be independent of time assuming that mass rate
is fixed. In other words, the incompressible flow is steady state by nature. If the pressure at the
outer radius is 3000 psi and at the wellbore is 1000 psi, they remain so at all times.
Compressible flow, in contrary, may not be steady-state i.e. pressure at any given location may
vary with time. However, after sufficiently long time, the steady-state compressible flow can be
established if the mass inflow rate becomes equal to the mass outflow rate. Consequently,
pressure at any given location in the system will be independent of time. In this chapter, we
introduce the flow equations for steady-state compressible flow. The main compressible fluids
of interest are oil and natural gas.
4.1 Steady-state oil flow
For linear flow, the constant mass rate implies that the following will be constant:

            
  = ()()  4-1

Unlike incompressible flow,  and  are now functions of pressure. While  is generally variable
with pressure, it can be assumed constant for oil. However, the oil formation volume factor ()
changes with pressure.  is the ratio of oil volume at reservoir conditions to the corresponding
volume at surface conditions.  is larger than 1 because oil shrinks when brought to the surface
due to gas exsolution and temperature reduction. In the reservoir, gas remains dissolved in the
oil as long as reservoir pressure is above the bubble point. Therefore, as the pressure is decreased
with production, the fluid volume in the reservoir increases. Consequently, the ratio of reservoir
volume to surface volume of the oil also increases as the pressure decreases.

                                                                                                                   52
             Petroleum Reservoir Dynamics

             pb< p(=pi-p)

             V                                                                    pi

psc, Tsc
1 STB

          Figure 4-1 Variation of the oil formation volume factor with pressure.

The oil compressibity can be used to formulate the variation of B versus pressure. Increasing the
pressure of a given volume of oil  by  decreases the volume by . The compressibility is
then defined by:

  = 1  4-2
       

In differential form, this becomes:

      -1 
  =   4-3

Note that the negative sign is added because increasing pressure is associated with volume
decrease. Using the definition of formation volume factor, we can write:

 = -1 () = -1  4-4
           

Rearrangement gives,

 - =  4-5
             

The compressibility generally varies with pressure. However, oil compressibility can be assumed
constant. It is also small in the order of 10-6/psi. That's why oil is often referred to as slightly
compressible fluid. Integrating the above equation gives:

                                                                                      53
                            Steady-state compressible flow

             

-   =                                                                      4-6
                                                                           4-7
                                                                           4-8
                                                                           4-9
Therefore,                                                                4-10
                                                                          4-11

 -( - ) =  ( )                                                            4-12
                                                                          4-13

And                                                                           54
  =  [-( - )]

This equation can now be replaced in the Darcy equation:

                            1     
 = ()  =   [-( - )] 

Rearrangement gives:

                    
  =  [-( - )]

Integration gives:

            1             
 0   =  0  [-( - )]

Therefore,

 1                             1    

  =  0  [-( - )] =  0 [( - )]|

                    1                                     11        1
            = ([( - )] - [(0 - )]) = ( -                               )
                                                           () (0)

Therefore,

   1                   1
 =  (() - (0))

We can prove (see below) that the above equation is equivalent to:
                                Petroleum Reservoir Dynamics

 =   - 0                                                                                                                  4-14
                                                                                                                              55
where  is the formation volume factor evaluated at  = +0.

                                                                                                       2

Proof

   1      11
       -      = ([( - )] - [(0 - )])
() (0) 

Using series expansion of the exponential function and truncation gives:

   1      11                          2                                                                             2
       -      = (1 + ( - ) + ( - )2 - 1 - (0 - ) - (0 - )2)
() (0)                                2                                                                             2

=  1  (( - ) +   2  (2  +  2    -  2)    -  (0  -  )  -  2  (02                                           +  2   -  20))

                 2                                       2                                                     

=  1  (( - 0) +  2  (2  -  2    -  2  +  20))

                 2           0

   1             2
=  (( - 0) + 2 (( - 0)( + 0) - 2( - 0)))

= 1 (( - 0) + 2( - 0) (( + 0) - ))
                                   2

= 1 (( - 0) + 2( - 0)( - ))
   

   1
= ( - 0)(1 + ( - ))

   

   1
= ( - 0)(1 - ( - ))

   

   1
= ( - 0) (-( - ))

   

=         1         ( - 0)

    (-( - ))

   1
= ( - 0)

   

Replacement in  =  ( 1 - 1 ) gives:  =   -0
                  () (0)                         

End of proof
                                                            Steady-state compressible flow

The solution for radial flow can be established by analogy to the relationship between linear flow
and radial flow solutions for incompressible flow in the previous chapter according to which, the
radial flow solution is given by:

 = 2  ( 1 () - 1 ()) (  1 )                                 and  =   2 -0                        4-15

                                                                               ( )

                                                                                               

And in presence of skin, we get:

 = 2 ( 1 - 1 ) 1 and  =   2 -0                                                                   4-16
 () () ( )+                                                  ( )+
                                                            

Example 4-1. Consider steady-state radial oil flow in a reservoir with the following characteristics.
Reservoir permeability, k = 10 md
Reservoir thickness, h = 50 ft
Reservoir initial pressure, Pi=3000 psi
Pressure at outer radius, Pe=3000 psi
Wellbore pressure, Pwf=1000 psi
Reservoir outer radius, re=2000 ft
Wellbore radius, rw=0.5 ft
Oil viscosity, =2 cp
Compressibility, c = 510-5 psi-1
Formation volume factor at initial pressure, Boi = 1.5 bbl/STB
Skin factor, s = 5
Calculate the flow rate considering:
(i) Using actual formation volume factors,
(ii) Using the average formation volume factor.

                                                                                                                   56
                                      Petroleum Reservoir Dynamics

Solution:

(i)

=     0.00708  (              1    -  1  )

       ( (  ) + ) () (0)

           

=     0.00708  (              1    -  1     )

       ( (  ) + ) () ()

           

                         bbl
() =  = 1.5

                         STB

() =  (-[ - ]) = 1.5  (-5  10-5[1000 - 3000]) = 1.658 bbl
                                                                                                          STB

           0.00708  10  50               11         STB
2  5  10-5  ( (  = 2000) + 5) (1.5 - 1.658) = 168.5 day
                              0.5

(ii)

     3000 + 1000
 = 2 = 2000 psi

                                               -5                             bbl
 = () =  (-[ - ]) = 1.5  (-5  10 [2000 - 3000]) = 1.577
                                                                              STB

      0.00708 ( - ) 0.00708  10  50 (3000 - 1000)                        STB
 =   (  ) + 5 = 2  1.577  (2000 = 168.9 ) + 5 day
                                               0.5

Note that the solutions from the two approaches are in close agreement.

                                                                                                               57
                              Steady-state compressible flow

4.2 Steady state flow of gas

Similar to oil, the following would be constant for constant gas rate  =  . However, unlike

                                                                                                                                

oil, the concept of fluid compressibility cannot be used to formulate the gas formation volume
factor. The reason is that gas compressibility, unlike oil compressibility, cannot be assumed
independent of pressure. Instead of compressibility, we use the following to relate B to pressure:

                     
         
= =  = =                      ==                              4-17
                                   
                     

where  = 14.65 psi and  = 60 F. Therefore,

 =     4-18
         

If the gas is assumed to be ideal gas:  = constant,  = 1:

 =     4-19
           

Integration gives:

    =      =   1    =   2 - 02                                4-20
            0             0            2
0

Therefore,

 =   2 - 02                                                   4-21
        2

4.2.1 Real gas - low pressure approximation
For a real gas at pressures below 1500 psi, the product  is relatively constant (see Figure 4-2).
Therefore,

                                                                                                                   58
                    Petroleum Reservoir Dynamics

 =     4-22
         

or

 =     4-23
        

Therefore,

 =     4-24
           

Integration gives:

    =      =      =   2 - 02                                                                                                                           4-25
            0         0    2
    0

Therefore,

 =   2 - 02                                                                                                                                            4-26
         2

The average  can be approximated by  at the average pressure given by  = 2+02.

                                                                                                                                                    2

                                                                                                                                                       59
                                               Steady-state compressible flow

0.05                                                                                        2.5E+05

0.045                                                                                       2.0E+05
 0.04

0.035 z (cp)                                                                                                                                           1.5E+05
 0.03                                                                                                                                    p/( z), psi/cp1.0E+05
                                                                               mu.z                                                                    5.0E+04
0.025                                                                          p/p(/m(u.z)
 0.02

0.015

0.01             2000                          4000            6000            8000               0.0E+00
       0                                                                                    10000

                                                     p (psia)

Figure 4-2 The variation of  and / versus pressure for a dry gas. For pressures lower than 1500 psi,  can be
               considered constant. However, for pressures higher than 4000 psi, / is relatively fixed.

Example 4-2. Wellbore pressure of a fully penetrating vertical well is 800 psi, and external
pressure is 1000 psi. The wellbore pressure is decreased to 600 psi. Calculate the ratio of new
rate to the initial rate for (a) oil reservoir and, (b) gas reservoir. Oil compressibility is 510-6/psi.

Solution:

(a) The flow geometry is not specified (and need not be). We use the radial flow equations. The
following is the equation for oil after setting the pressure at the outer boundary:

2  - 
 = 
            
             ()

          +
where  = (),  =

                                            2

Therefore,

                                                                                                                                                                60
                        Petroleum Reservoir Dynamics

2 (     -   )    ( - )2 1  ( - )2  (-(2 - ))

              2
1 = ( - )        =          2  ( - )
                    ( - )                (-(1 - ))
        1 1 1

   1000 - 600 (-5  10-6(900 - 1000)) 1000 - 600      -4
=                                    =            (-5  10 )  2
   1000 - 800 (-5  10 (800 - 1000)) 1000 - 800-6

(b) The pressure is below 1500 psi. Therefore, we can use the low-pressure approximation for
gas. Thus, we can write:

     0.00708  1 2 - 2
 =  (  )   2

            

Thus,

2 (2 - 2 )2 10002 - 6002
   =2 2=                   2 = 1.78
1 ( - )1 1000 - 8002

Dropping the pressure by the same amount may result in more significant increase in the
production rate for an oil well compared to a gas well.

4.2.2 Real gas - high pressure approximation
For real gas at pressures above 4000 psi, the product / is relatively constant (see Figure 4-2).
Therefore,
  =     4-27

          

or
  =   (  )  4-28

             

or
  =   (  )  4-29

               

Integration gives:
                                                                                                                   61
                         Steady-state compressible flow

                               

  =   ( )  =  ( )   =  ( ) ( - 0)                        4-30
     0                     0   
0

Therefore,
  =   (  ) ( - 0) 4-31

             

The average / can be approximated as the / at the arithmetic average pressure ( =
+0).

  2

Note that the real gas rate at low pressures is proportional to 2 similar to an ideal gas. Also, at
high pressure, the real gas rate is proportional to  similar to oil. These observations should not
be surprising because a gas at low pressure acts like ideal gas, and at high pressure acts similar
to liquids.

4.2.3 Rigorous approach

The low-pressure and high-pressure approaches above can be used only for the corresponding
pressure ranges. A rigorous approach is required to be used for any give pressure. The rigorous
approach is based on the definition of the adjusted pressure:

                                                         4-32
 =  

          

where  is an arbitrary reference pressure. Note that there is a one-to-one relationship between
the pressure and adjusted pressure. For any given pressure, the adjusted pressure can be readily
calculated. Taking the derivative and combining with  =     gives:

                                                                                                        

 =       =     =                                         4-33
                 

Integration gives:

                          

0 0    =    =  0                                         4-34

Therefore,
                                                                                                                   62
                             Petroleum Reservoir Dynamics

 =   - 0                                                                   4-35
      

To show how the adjusted pressure is calculated, we use a spreadsheet from Wattenbarger
(2009). The yellow-highlighted cells in the spreadsheet are the input data cells to enable
calculating the gas viscosity and z-factor at any given pressure. The minimum required data are
the gas specific gravity, reservoir temperature, and initial pressure. Columns E, F, G, and H show
the calculated z-factor, viscosity, and gas formation volume factor for various pressures. We can
use the trapezoid rule to calculate the adjusted pressure for any given pressure.

    () +()
                   -1
 =   2 ( - -1)                                                             4-36

   =1

 is the number of pressure space discretizations between the reference pressure () and the
pressure of interest ().

Example 4-3. Consider steady-state radial gas flow in a reservoir with the following
characteristics: Gas specific gravity=0.7, Reservoir temperature=100 F, Reservoir permeability, k
= 10 md, Reservoir thickness, h = 50 ft, Reservoir initial pressure, pi=3000 psi, Pressure at outer
radius, pe=3000 psi, Wellbore pressure, pwf=1000 psi, Reservoir outer radius, re=2000 ft, Wellbore
radius, rw=0.5 ft.

Calculate the flow rate considering:

(i) Low pressure approach

(ii) High pressure approach

(iii) Rigorous approach

Compare and comment on your results.

Pressure (psi)  .z (cp)      .z/p (cp/psi)  Bg (ft3/SCF)   (cp)  pa (psi)
1000            0.011        1.1e-5         0.013         0.013  280.1
2000            0.014        6.9e-6         0.006         0.018  1031.1
3000            0.019        6.2e-6         0.004         0.023  1999.1

                                                                           63
                                 Steady-state compressible flow

Solution:
(i) valid only when p<1500 psi

 = (  0.00708  1 2-2 )   2 ,  = 30002+10002 2 = 2236 psi

                  

Interpolation at 2236 psi is required:

  - 0.014 0.019 - 0.014
2236 - 2000 = 3000 - 2000
Therefore,

 = 0.0152

And,

       0.00708  10  50 520              1 30002 - 10002               5.615
 (  = 2000) 14.65  560 0.0152 2 = 7.356/ ( 1 )
           0.5

           = 4.137/

(ii) valid only when P>4000 psi

 = (  0.00708  )  ( ) ( - ),  = 3000+1000 2 = 2000

                  

     0.00708  10  50 520                1 (3000 - 1000) = 7.846/ (5.615)
=
       2000) 14.65  560 6.9 - 6                                       1
        ( 0.5

           = 4.47/

(iii)

       0.00708 , - ,
 = 
                 (  )
                

       0.00708  10  50 1999.1 - 280.1                     5.615
 = 0.023  0.004  (2000) = 7.966/ ( 1 ) = 4.477/
                                 0.5

The results are quite close. The rigorous approach is most reliable.

                                                                             64
                               Petroleum Reservoir Dynamics

In summary, we find that for oil and gas we obtain equations similar to those of incompressible
flow as given in Tables 4-1 and 4-2.

Table 4-1 Comparison of steady-state compressible flow equations to incompressible flow in consistent units.

        Incompressible flow    Steady-state oil              Steady-state gas

Linear      =   - 0                    =   - 0                =   - 0
Radial                                                             
                               where  = () and  =
        =  2  -                                              =  2  - ,
                               +0
             ()                  2                                ()            

                                         2  - 
                                    =   (  )

                                                     

           Table 4-2 Same comparison as shown in Table 4-1 but in field units.

        Incompressible flow    Steady-state oil              Steady-state gas

Linear   = 0.001127  - 0        = 0.001127  - 0               = 0.001127  - 0
Radial                                                                            

                               where  = () and
                                = +0

                                         2

           0.00708  -          0.00708  -                       0.00708  - ,
        =                       =                            =
             ()                                                   ()              
                                                  ()

Question 4-1. (True/False) Oil formation volume factor increases with decreasing pressure
associated with production.

Question 4-2. (True/False) Considering fluid compressibility, the oil flow rate is proportional to
pressure drop.

                                                                                                                   65
                                       Steady-state compressible flow

Question 4-3. (True/False) Considering fluid compressibility, gas flow rate is proportional to
pressure drop.

Question 4-4. (True/False) Considering fluid compressibility, the gas flow rate is proportional to
pressure drop if the pressure is sufficiently high.

Question 4-5. Which of the following is relatively constant for gas flow at low pressures (<1500
psi)? (a) Viscosity, (b) z-factor, (c) Viscosity  z-factor, (d) (Viscosity  z-factor)/pressure

Question 4-6. Which of the following is relatively constant for gas flow at high pressures (>4000
psi)? (a) Viscosity, (b) z-factor, (c) Viscosity  z-factor, (d) (Viscosity  z-factor)/pressure

Question 4-7. How many approaches were introduced for steady-state gas flow calculations? (a)
1, (b) 2, (c) 3, (d) 4

Question 4-8. (True/False) Adjusted pressure is independent of reservoir initial conditions.

Question 4-9. For steady-state gas flow, which approach is most accurate at low pressures? (a)
Low pressure approach, (b) High pressure approach, (c) Rigorous approach

4.3 Chapter Problems
Problem 4-1. An oil well is produced under steady-state radial flow conditions. The following
properties are given:
Initial oil formation volume factor = 1.6 bbl/STB
Reservoir permeability = 0.1 D
Reservoir thickness = 50 ft
Oil viscosity =0.5 cp
Oil compressibility = 10-5/psi
Reservoir initial pressure = 6000 psi
Pressure at outer radius = 6000 psi

                                                                                                                   66
                                        Petroleum Reservoir Dynamics

Wellbore pressure = 1000 psi
Reservoir outer radius = 3000 ft
Skin factor = 5
Wellbore radius =0.3 ft
Calculate the oil well rate at standard conditions using:
(i) Actual formation volume factors, and
(ii) Average formation volume factor.

Problem 4-2. Consider steady-state radial gas flow in a reservoir with the following
characteristics.
Gas specific gravity=0.6
Reservoir temperature=150 F
Reservoir permeability, k = 20 md
Reservoir thickness, h = 50 ft
Reservoir initial pressure, Pi=4000 psi
Pressure at outer radius, Pe=4000 psi
Wellbore pressure, Pwf=2000 psi
Reservoir outer radius, re=1000 ft
Wellbore radius, rw=0.5 ft

Use modified Gasprop6 spreadsheet (posted on Moodle) to calculate the flow rate considering:
(i) Low pressure approach,
(ii) High pressure approach
(iii) Rigorous approach

                                                                                                                   67
                            Accounting for the effect of gravity in steady flow

5 Accounting for the effect of gravity in steady flow

In the previous chapters, the flow was assumed horizontal. Therefore, the effect of gravity was
neglected. In practice, the reservoir almost always has a certain dip angle. In absence of dip angle,
steady-flow equation is given by:
  =   5-1

        
5.1 Flow potential
A reminder that if fluid is compressible,  is replaced by  for oil. For gas,  is evaluated at the
initial pressure, and pressure is replaced by adjusted pressure. However, would Eq. 5-1 be still
valid when flow is non-horizontal? For instance, consider the water-saturated sand in Figure 5-1.
The sand is open at the top and capped at the bottom so there is no flow ( = 0). For Eq. 5-1 to
be applicable, the pressure difference () must be zero, so that q becomes zero. However,  =
 since the pressure at the top is atmospheric and at the bottom is atmospheric plus  (in
terms of gauge pressures, the pressure at the top is zero and at the bottom is ).
Figure 5-1b shows another scenario illustrating that Eq. 5-1 is not applicable for non-horizontal
flow. For this scenario, the flow rate is non-zero because the cap is removed from the bottom.
Both the top and bottom are open i.e. the gauge pressure at both top and bottom is zero.
Consequently =0 while the flow rate is non-zero. Again, this clearly shows that Eq. 5-1 is not
applicable for non-horizontal flow.

       Figure 5-1 Pressure and rate relationship for (a) capped and (b) uncapped water-saturated sand. (From K.
                                                      Thompson's course slides).

                                                                                                                   68
                              Petroleum Reservoir Dynamics

To make Eq. 5-1 applicable to non-horizontal flow, the pressure must be replaced by the flow
potential ():

 =   5-2
      

The potential is defined by:

 =  +                                                                                    5-3

where Z is the elevation from a user-defined datum,  is the fluid density in the porous medium
across . Note that  is a unique measurable (or computed) quantity. However, elevation is
not. Therefore,  is not unique either. We only use  in flow calculations. The flow will be from
the higher potential toward the lower potential. This is analogous to horizontal flow, where flow
is from higher pressure toward lower pressure. To show relevance of the modified equation, we
can apply it to the two cases shown in Figure 5-1. A datum needs to be first chosen which it can
be at any depth. If the datum is chosen at the bottom, then Z=0 at the bottom and Z=H at the
top. Consequently, for the capped sand, we can write:

 =  +  =  + 0 = 

 =  +  = 0 +  = 

Therefore =0 resulting in q=0 based on Eq (2) which is consistent with the observation.

Question 5.1. Consider a u-tube partially filled with water. Does water flow in any direction?

                                                                                         69
                            Accounting for the effect of gravity in steady flow

Example 5-1. Consider a water-saturated sand in the figure below. If cross-section area is 90 cm2,
viscosity is 1 cp, water density filling the sand is 1000 kg/m3, and formation volume factor is 1
rm3/sm3. Determine the flow direction and calculate the flow rate.

                                               ptop = 1.20 atm

H = 60 cm              water-saturated sand
                       k = 1500 mD

                          pbottom = 1.25 atm

Solution:

 = 1.2  1.01325  105 + 1000  9.8  0.6 = 127470 Pa

 = 1.25  1.01325  105 + 0 = 126656 Pa

Therefore, the flow is from the top to bottom. The flow rate is given by:

   1500  10-15  90  10-4 127470 - 126656            -8 3
=                                            = 1.831  10 m /s
           -3             0.6
           1  10  1

The example above used the SI units. In field units, density,  is given in lb/ft3 which can be
translated to pressure gradient by:

                           
 =     pressure gradient =  =  

where gc=32.2 lb.ft/(lbf.s2) is the mass-force conversion factor. A note that gc is often omitted in
the equations written in SI units because it is equal to 1 (kgm)/(Ns2). Considering gc, the pressure
gradient is:

                                                                           70
                         Petroleum Reservoir Dynamics

                     lb  32.2 s2 ft      lbf  lbf 1 ft2   lbf
Pres. grad. =  ( 3)                 =  ( 3) =  ( 3) (   2) = ( 2 )
        ft 32.2 2 lb. ft ft                   ft 144 in 144 in . ft

                         lbf. s

        =  (psi)
           144 ft

In field units, one may work with oil specific gravity. The specific gravity of a liquid is given by:

      
 = 

where  is the fluid density and w is the water density at standard conditions (=62.4 lb/ft3). In
terms of specific gravity, this becomes:

Pres. grad. =  (psi) = 0.433  (psi)
        144 ft                       ft

Question 5-2. Calculate specific gravity of an oil with 50 lb/ft3 density.

Question 5-3. Calculate the bottom-hole pressure (in psi) of a 10,000-ft deep well filled with 50
lb/ft3 density oil.

Question 5-4. Calculate the bottom-hole pressure (in psi) of a 10,000-ft deep well filled with a gas
with 5 lb/ft3 average density.

Example 5-2. The schematic below shows an oil reservoir intersected by two wells. Well 1 is filled
with water (shown in blue) and well 2 is filled with oil (shown in gray). Water and oil specific
gravities are 1.05 and 0.85, respectively. Water and oil viscosities are 1 and 1.3 cp, respectively.
Water and oil formation volume factors are 1 and 1.2 bbl/STB, respectively. The reservoir width
(perpendicular to the page) is 100 ft. Reservoir permeability is 300 mD. Calculate (a) direction of
the flow, and (b) the flow rate.

                                                                                                       71
Well 1  Accounting for the effect of gravity in steady flow

                                                           Well 2
                                                                       5750 ft

6000 ft
                                                                            40 ft

Solution:

1 = 1 + 0 = 0.433  1.05  6000 = 2731 psi
2 = 2 + 0.433(1 - 2) = 0.433  0.85  5750 + 0.433  0.85  (6000 - 5750)

                  = 2211 psi

Therefore, the flow is from 1 toward 2.
                  300  40  100 (2731 - 2211)

 = 0.001127 1.3  1.2  800 = 563.5 STB/day

                                                                                   72
                    Petroleum Reservoir Dynamics

Example 5-3. The schematic shows cross-             Well

sectional view of an oil well drilled at the crest

of an anticline reservoir. The pressure at the

boundary of the reservoir is fixed at 5000 psi

due to external pressure support. Calculate

the rate if the well bottomhole pressure is         2000 ft

4000 psi. Well radius is 0.35 ft. The well radial

distance from reservoir edge is 2000 ft. Oil

specific gravity, viscosity, and average                        2000 ft

formation volume factor are 0.8, 0.7 cp, and

1.4 bbl/STB, respectively. Reservoir height is

50 ft and its width (perpendicular to the page)

is 100 ft. Its permeability is 100 mD.

Solution:

Note that the flow is linear but inclined. Take the datum at the depth of the boundary.

 =  + 0.433 = 4000 + 0.433  0.8  2000 = 4692.8 psi

 =  + 0 = 5000 psi

Length of the flow path from the well to the reservoir boundary is 2 =  = (2000) =
                                                             4  2                        2

3141.5 ft.

     0.001127  100  100  50 (5000 - 4692.8)
 = 0.7  1.4  3141.5 = 5620 STB/day

The calculated rate above corresponds to one-half of the reservoir. Therefore, the total rate is
256.2=112.4 STB/day.

Example 5-4. Consider steady-state linear flow in the inclined gas reservoir in the figure below.
The reservoir is supported by water influx. The pressure at the gas-water contact is fixed at the
initial pressure of 1400 psi and the pressure at the wellbore is 225 psi. The reservoir width
(perpendicular to the schematic) is 100 ft. Reservoir permeability and thickness are 1 mD and 30
ft respectively. The gas average density is 4.65 lb/ft3. Other PVT properties are given in the table
below. Calculate the gas flow rate at surface conditions.

                                                                                                                   73
                  Accounting for the effect of gravity in steady flow

           pressure (psia)    z-Factor  viscosity(cp)  Bg (rcf/scf)  Adj. pressure (psi)
                         100                            1.56E-01                      3.77
                         200   0.989        0.0117      7.72E-02                    15.35
                         300   0.978        0.0118      5.09E-02                    34.65
                         400   0.968        0.0119      3.78E-02                    61.65
                         500   0.957        0.0120      2.99E-02                    96.30
                         600   0.947        0.0122      2.46E-02
                         700   0.937        0.0124      2.09E-02                   138.52
                         800   0.928        0.0126      1.81E-02                   188.20
                         900   0.918        0.0128      1.59E-02                   245.21
                               0.909        0.0130      1.42E-02                   309.40
                      1,000    0.901        0.0132      1.28E-02                   380.60
                      1,100    0.893        0.0135      1.16E-02                   458.60
                      1,200    0.885        0.0137      1.07E-02                   543.19
                      1,300    0.878        0.0140      9.82E-03                   634.13
                      1,400    0.871        0.0143                                 731.16

Solution:

 = 0.001127 , - ,0
                  

Let the datum be at the WGC. Then:  =  = 1400 psi  , = , = 731.1 psi

At the wellbore:

0 = 0 +  144 0 = 225 + 4.65 144  3000  ( 50) = 299.2 psi  ,0 = 34.65 psi

                                                                                            74
                                 Petroleum Reservoir Dynamics

Therefore,

            1  30  100 (731.1 - 34.65)         STB 5.615SCF
 = 0.001127 0.0143  0.00982                      = 6299 day ( 1 STB )
                                   3000

            = 35367 SCF/day

A more realistic situation is when the reservoir is also partially filled with water. In such scenario
the free water level (assuming negligible capillary pressure) would be a good datum to chase at
which the phase potentials are equal.

Example 5-5. Leakage is occurring through a vertical plugged & abandoned (P&A) oil well.
Leakage is facilitated by a micro-annulus on the perimeter of the casing at the casing-cement
interface. The average aperture of the micro-annulus is 200 m, and the casing diameter is 20
cm. The reservoir pressure is 10 MPa and that at the surface is zero (gauge pressures). Well
depth is 1000 m. Oil density, viscosity, and formation volume factor are 800 kg/m3, 0.7 cp, and
1.1 bbl/STB, respectively. Calculate the leakage rate. (Hint: Treat the micro-annulus as a fracture.)

Solution:

 = 2 = (2  10-4)2 = 0.33  10-8 2
   12       12

 =  = (0.2)(2  10-4) = 1.26  10-4 2

Let the datum be at the reservoir depth. We can then write:

 =  = 107Pa
 =  +  = 0 + 800  9.81  1000 = 7.848  106 Pa

Therefore, the oil leakage rate is given by:

     -  0.33  10-8  1.26  10-4 (107 - 7.848  106)
=               =
                                   -3                          1000
                                 0.7  10  1.1

            = 1.162  10-6 3
                                 

Conversion to field units give:

                                                                       75
                   Accounting for the effect of gravity in steady flow

            -6 3 6.29  86400 (
1.162  10         3 )(                     ) = 0.632 bbl/day
             1           1 

This well leakage rate is not significant.

Example 5-6. Consider a 0.3-m diameter sandpack composed of a fine sand underlain by coarse
sand as shown in the figure below. Both sands are fully saturated by water. The permeability of
the bottom coarse sand is 1000 mD and that of the top fine sand is 50 mD. The thickness (height)
of the bottom and top sands is 0.3 and 0.45 m, respectively. A column of water with 0.35-m
height is placed above the core and bottom is open to air. Water viscosity is 1 cp.

     (a) Calculate the average permeability of the core.
     (b) Calculate the flow rate.
     (c) Calculate the flow potential at the interface between the two sands

         assuming that the datum is at the base of the bottom sand.

Solution:
(a)

 = 1 + 2 1 2 = 0.3 + 0.45 0.3 0.45 = 80.65 mD
     1 + 2 1000 + 50

(b)

 =   -  =  (1 + 2 + )
      1 + 2                 1 + 2

            =  80.65  10-15  3.14  0.152 1000  9.81  (0.3 + 0.45 + 0.35)

                     10-3                      0.3 + 0.45

            = 8.2  10-8 2/

(c)

 =  (1 + 2 + ) = 1 
            1 + 2         1

Therefore,

 = 1 (1 + 2 + )  = 350 Pa 1 1 + 2
                 1 2
                                                                                                                   76
                                        Petroleum Reservoir Dynamics

5.2 Chapter problems
Problem 5-1. Oil is flowing through an inclined, slab-shaped reservoir composed of two sections
with distinct permeabilities as shown in the figure below. The reservoir thickness is 100 ft, and
its width is 5000 ft. Oil viscosity and formation volume factor are 0.6 cp and 1.4 bbl/STB
respectively. The pressure at the well bottomhole is 200 psia, and the pressure at the reservoir
outer boundary is 1000 psia. Oil density is 45 lb/ft3.
(a) Choose an appropriate datum and calculate potentials at two ends of the reservoir.
(b) Calculate the average permeability.
(c) Calculate the well production rate.
(d) Calculate the pressure at the interface between the two sections.
(e) What pressure at the external boundary would result in zero flow?

                                                                                Production well

                        k1=30 mD

k2=100 mD  =15 degrees

                                  77
        The Governing Equation for Flow in Reservoirs

6 The Governing Equation for Flow in Reservoirs

The equal mass inflow and outflow rates permitted steady-state flow in previous chapters. All
properties and specifically the pressure were independent of time but varying with location (x or
r). Starting with this chapter, we focus on non-steady-state (transient and pseudo-steady-state)
radial flow where pressure varies with time. We start with deriving the governing equation for
radial flow in reservoirs known as radial diffusivity equation. All equations will be presented for
horizontal flow of slightly-compressible fluid (oil). For compressible fluid (gas), the pressure () is
to be replaced by adjusted pressure (). For non-horizontal flow, pressure () is to be replaced
by .

After deriving the pressure diffusivity equation, we discuss its implications for the pressure
propagation into the reservoir and its similarity to heat propagation in solids. Accordingly, the
concept of radius of investigation is introduced. Also, the diffusivity equation is solved for steady
flow to show it reproduces the equations we derived earlier (in Chapters 3 to 5). The solution is
then presented considering the average pressure of the reservoir.

6.1 Derivation of pressure diffusivity equation

Consider radial flow to a vertical well as shown in Figure 6-1a. Let's take a cylindrical volume
element (as shown in Figure 6-1b) to write the mass balance.

(a)         (b)

Figure 6-1 (a) A homogeneous and isotropic reservoir with a vertical well at the center, and (b) a cylindrical volume
                                                       element of the reservoir.

Considering the mass accumulation, the mass balance over the volume element implies that:

 -  =                                                  6-1

() - () =                                              6-2

                                                                                           78
                             Petroleum Reservoir Dynamics

The rate at which the mass accumulates in this element of volume equals:

  = () 6-3
                

where  = 2. Therefore,

(2)+/2 - (2)-/2 = (2) 6-4
                                                       

This simplifies to:

()+/2 - ()-/2 = () 6-5
                                          

Or

1 ()+/2 - ()-/2 = () 6-6
                             

In the limit, when r0 and t0, we get:

1  () =  () 6-7
       

Working on the LHS, we get:

1  () = 1   () + 1   ()
                              

= 1   () + 1   
                       

= 1   () +  1  
                       
                                                                          6-8
    1                
=    () +  

   1      
=    (  ) + ( )  

    1                         2
=    (  ) + ()  ()

The second term on the right side of the above is negligible considering slightly compressible fluid
for which cf is small. dp/dr is also generally small for conventional reservoirs. Therefore,

                                                                          79
                     The Governing Equation for Flow in Reservoirs

1  () =  1   ( ) 6-9
                        

Working on the right hand side (RHS) of Eq. 6-7, we get:

 () =   () +   () =   6-10
                                      

where ct=cr+cf. Eq. 6-10 reduces to:

    1                
    ( ) =   6-11

Or

1   1 
  ( ) =   6-12

where  =  .

                   

Eq. 6-12 is the pressure diffusivity equation and  is the pressure diffusivity coefficient. The
diffusivity coefficient has SI unit of m2/s.  controls how the pressure propagates into the
reservoir. The pressure propagates faster if  is high. Conversely, the pressure propagation is
slower for lower values of .

Eq. 6-12 is in the form of diffusion equation, hence referred to as pressure diffusivity equation. It
implies that pressure propagation in the reservoir is similar in nature to other diffusive processes
e.g. diffusion of perfume sprayed in one part of the room which allows it smelling everywhere in
the room. Another example is the temperature propagation in a solid cylinder by introducing a
heating element at the center of the solid.

6.2 Steady flow solution in terms of average pressure

When / = 0, the solution to the above equation should be identical to the steady flow
solution discussed in chapters 3 to 5 (considering horizontal flow). When / = 0, the
diffusivity equation becomes:

                                                                                                                   80
                 Petroleum Reservoir Dynamics

1  ( ) = 0 6-13
  

Therefore,

  = 1 6-14
  

Constant rate (at surface conditions) at the well (based on Darcy's equation) implies that:

            
   | = 2 6-15

Therefore:

1 =  6-16
      2

Therefore:

  =  6-17
   2

Therefore,

              

  =                                                                                          6-18
            2  


And

                  
( - ) = 2  () 6-19

Therefore,

               
 -  = 2  () 6-20

This is the same as that derived for steady-state flow. Considering the pressure pe at the outer
boundary re we can write:

 -  =   (  ) 6-21
               2 

                                                                                             81
           The Governing Equation for Flow in Reservoirs

When the pressure becomes time-dependent, we often work with the average pressure which is
the volumetrically averaged pressure of the reservoir. Mathematically, it is given by:

 =   6-22
        

Considering steady-state flow, the average pressure is obtained by:

    2 2            2          
 = 2     = 2   = 2 [ ( +      ( )) ]
                             2 

2                  
= 2 [  +            ( ) ]
          2 

2   2   
= 2 [ +    ( ) ]
    2 2  
                                                                     6-23
    2  1            2 
2        ( 2  ( ) - )| ]
= 2 [ +
    2 2 2           4 
                           

2   2  2  2
= 2 [ +  (  ( ) - )]
    2 2 2  4

=  +  [ (  ) - 1]
           2  2

Intuitively, the average pressure should be between the wellbore pressure () and the external
boundary pressure (). This is evident by comparing the equations for  and . Notice that:

( +  2  (  )) > ( +  2 [ (  ) - 12])   >                             6-24

It would be interesting to note that the pressure half-way between the well and external
boundary is not . To find the location  where the pressure is , the equation for  should be
replaced in the equation for pressure at any given location:

 +  [( ( ) - 1)] =  +   (  ) 6-25
   2      2          2 

Therefore,  ( ) = 12   = 1.65   = 0.61. Therefore, the location at which the pressure
is equal to the average pressure is closer to the outer boundary than the wellbore. The steady
flow radial equations are summarized in the table below.

                                                                     82
                  Petroleum Reservoir Dynamics

                  6-1 Steady-state flow equations in terms of pressure and average pressure.

Without skin                    With skin

 =  +   ( )                      =  +  ( (  ) + )
                                               2 

 =  +  ( ( ) - )                 =  +  ( ( ) - 1 + )
                                              2  2

Example 6-1. Calculate the average reservoir pressure if the steady-state external boundary
pressure is 6000 psi, the flowing bottomhole pressure is 3000 psi, reservoir radius is 2980 ft, and
wellbore radius is 0.3 ft. Skin is zero.

Solution:

 -  =  2  (  ) and  -  =  2 ( (  ) - 12)

The ratio gives:

 -   ( )           (2980 0.3 )
 -  =  (  ) - 1 =  (2980) - 1 = 1.057
               2  0.3 2

     6000 - 3000
 = 1.057 + 3000 = 5837 psi

Example 6-2. A well is produced at a rate of 100 STB/day under steady flow conditions. The
reservoir thickness is 30 ft and its permeability is 100 mD. The fluid viscosity is 2 cp and the
average formation volume factor is 1.2 bbl/STB. The external reservoir radius is 3000 ft and well
radius is 0.3 ft. Skin factor is zero and well flowing pressure is 1000 psi. Calculate the average
pressure.

Solution:

 -  =  ( (  ) - 1)
              0.00708  2

                                                                                                                   83
                 The Governing Equation for Flow in Reservoirs

                 100  2  1.2  3000 1
 = 1000 + 0.00708  100  30 ( ( 0.3 ) - 2) = 1098.5 psi

6.3 Radius of investigation

Consider an extensively large reservoir (by area) with a well in the center as shown in Figure 6-1a.
The well is produced at an impulse rate (i.e. very large volume over a very short time period as
shown in Figure 6-2a). How would the pressure behavior be at a certain location in the reservoir?

Obviously, it will take some time for the pressure change to be detected. The more distant is the
observation location, the longer it takes for the pressure change to be detected. Once the
pressure change is detected, it continues to increase. But does it increase monotonically?
Obviously not, the pressure change increases until a maximum value is achieved. Then, the
pressure change starts to decrease as the pressure pulse passes the observation location (as
shown in Figure 6-2b). In Figure 6-2b, it is also observed that the maximum pressure change at a
location closer to the well is larger than that at a farther well, as intuitively expected. The pressure
change shown in Figure 6-2b is for two different locations, 60 and 600 m from the well. The time
it takes for the pressure impulse to reach these two locations (i.e. the time it takes for the
maximum pressure change to be observed) is 10 s and 1000 s for the 60 and 600 m distance
locations, respectively. Comparing these numbers indicate that 2 is constant. It can be

                                                                                                                        

mathematically proved that this constant is equal to 4. In other words,

 = 4                                                            6-26

It takes time of t=r2/4 to reach distance r from the well. As such, the radius of investigation for
a given time (t) is the radius to which the pressure impulse has reached, i.e.

 = 4                                                            6-27

In field units,

  = 0.0325  6-28
                     

A note that the field unit for time is hours. The equation above shows that pressure diffusivity
coefficient () determines how fast the pressure propagates into the reservoir. The radius of
investigation at a given time is therefore, independent of the impulse volume. In other words,
whether 100 STB or 10000 STB of impulse volume is produced does not make a difference in the
rinv at a given time.

                                                                                                                   84
                                        Petroleum Reservoir Dynamics

While the radius of investigation concept is presented in the context of an impulse production, it
is widely used in the context of constant or variable rate production. Since, rinv is independent of
rate, the equation above is applicable for any rate conditions. A common misconception about
the radius of investigation is that the pressure change beyond it must be zero. For instance see
Figure 6-3 which shows the impulse pressure response after 10 seconds when the radius of
investigation is 60 m (as shown in Figure 6-2b). It is evident that the pressure change beyond
rinv=60 m is non-zero although small. The pressure change will be of course dependent on the
impulse volume. Doubling the impulse volume doubles the pressure change.

(a)  (b)

     Figure 6-2 (a) Impulse rate at the well and, (b) the pressure response.

     Figure 6-3 Impulse rate pressure response after 10 seconds.

                                                                                           85
                              The Governing Equation for Flow in Reservoirs
When dealing with constant rate as in the upcoming chapters, the same concept applies. The
radius of investigation would be independent of rate. However, the pressure change beyond the
radius of investigation would be non-zero as well. For instance, look at the pressure response to
constant rate production at different times shown in Figure 6-4. The pressure near the well drops
and that far into the reservoir remains at the initial pressure. The radius of investigation at
different times is shown by the black dots. As can be easily noticed, there is a difference between
initial pressure and the pressure beyond the back dot (i.e. radius of investigation) which indicates
the non-zero pressure change even beyond the radius of investigation. The pressure change will
also depend on the rate. As shown in Figure 6-5, the pressure change will be larger when the rate
is increased. However, the radius of investigation (100 m is this case shown by the solid red,
green, and blue dots) will be independent of the rate.

           Figure 6-4 Pressure variation versus radius form the well at different times (Spivey and Lee 2013).

    Figure 6-5 Pressure sensitivity to rate. Also, insensitivity of  to rate is also shown (Spivey and Lee 2013).

                                                                                                                   86
                                        Petroleum Reservoir Dynamics

Question 6-1. (True/False) For a given time, the radius of investigation is the distance from the
well where the pressure change has been felt.
Question 6-2. (True/False) Radius of investigation does not change with changing the production
rate.
Question 6-3. (True/False) The pressure change beyond the radius of investigation is independent
of rate.

6.4 Dimensionless variables
The diffusivity equation can be much easier to solve when in dimensionless form. Let's introduce
the following equations for dimensionless radius (), dimensionless time (), dimensionless
pressure ():

        
  =  6-29
  = 2  6-30

        
  = 2 ( - ) 6-31

         
Taking the derivative of the above and replacing in Eq. 6-12 gives:

 1  (  ) =  6-32
    

                                                                                                                   87
                                        Pseudo-steady state (PSS) flow

7 Pseudo-steady state (PSS) flow

Starting this chapter, we discuss the flow regimes for which the pressure is no longer
independent of time i.e. the pressure derivative with respect to time (/) is no longer zero.
In this chapter, the PSS flow regime is discussed for which / is constant but non-zero. The
flow regime is referred to as transient flow if / is variable which will be discussed in the
upcoming chapters.

7.1 Flow in a closed reservoir
Imagine a large tank filled with very viscous liquid (e.g. the tank shown in Figure 7-1). The fluid is
pumped out from the tank center at constant rate using a powerful pump. How would the liquid
level change after pumping begins? The change is shown in Figure 7-2. At early time, the fluid
level drops below the initial level only near the tank center. Over time as the effect of level drop
reaches the tank boundary, the level in the entire tank will start to change with time. If this tank
is within a much larger tank which feeds it at the same mass rate being pumped, the pressure
will stabilize after reaching the boundary i.e. the steady-state flow prevails. However, if the tank
is closed with a no-flow external boundary (as it is in Figure 7-1), the flow will continue to be
unsteady.

                                     Figure 7-1 A large tank filled with very viscous liquid.

                                                                                                                   88
                                        Petroleum Reservoir Dynamics

                                   Figure 7-2 The change in the liquid level during pumping.

The pressure drop in a reservoir is similar in behavior to the liquid level in a tank described above.
The flow is called transient before the effect of pressure drop is felt at the boundary of the
reservoir. After the pressure drop is felt at all reservoir boundaries, the flow regime is called
pseudo-steady state considering constant production rate from the reservoir and no fluid support
beyond the boundaries. In the event of full fluid support so that the mass production rate is
identical to the support mass rate, the fluid flow is referred to as steady-state which was
discussed in detail in Chapters 3 - 5. Our focus in this chapter and upcoming chapters are PSS and
transient flow i.e. no external support. The pressure would then be characterized by the behavior
shown in the Figure 7-3.

                  Figure 7-3 The pressure behavior during production from a bounded (closed) reservoir.

                                                                                                                   89
                                        Pseudo-steady state (PSS) flow

Let's focus on the behavior after the pressure is felt at the boundary i.e. PSS flow. Figure 7-4below
shows the PSS pressure profiles both in Cartesian and semilog plots while (2 - 1) = (3 - 2).
Because of optical illusion, it may not be readily visible from the Cartesian graph that the profiles
are parallel. However, the semilog graph clearly shows that the profiles are parallel. This means
that the pressure drops from one time to another by the same value regardless of location.
Mathematically, this means that / is independent of location. Given that (2 - 1) =
(3 - 2), and that the separations between the curves are the same, we can write that 2-1 2-1 =
3-2. Mathematically, this means that / is independent of time too. In short, / is

3-2

independent of both time and radius and therefore it must be a constant value. Consequently,
the change of the average pressure with time i.e. / is also constant value and equal to
/.

The parallel profiles also imply that the pressure gradient at any given location is constant and
independent of time. / is zero at the external boundary because rate at the external
boundary is zero (no fluid coming from outside). Based on Darcy equation, this translates to
/ = 0.

(a)  (b)

     Figure 7-4 PSS pressure profiles in (a) Cartesian and, (b) semi-log graphs.

                                                                                                  90
                                        Petroleum Reservoir Dynamics

Question 7-1. (True/False) After the pressure effect is felt at the boundary, the flow regime
switches from transient to PSS.

Question 7-2. (True/False) After the pressure effect is felt at the boundary, the flow regime
switches from transient to PSS only if there is no external support.

Question 7-3. (True/False) After the pressure effect is felt at the boundary, the flow regime
switches from transient to PSS only if there is no external support. In addition, production rate at
standard conditions must be constant.

Question 7-4. (True/False) PSS/SS flow regimes are always preceded by transient flow.

Question 7-5. (True/False) Pressure derivative with respect to time (/) is negative during
production.

Question 7-6. (True/False) Pressure derivative with respect to time (/) is independent of
radius and time during PSS flow.

Question 7-7. (True/False) For a constant rate, / is constant at the wellbore regardless of
flow regime.

Question 7-8. (True/False) At any given location in the reservoir, / does not vary with time
over the PSS flow period.

Question 7-9. (True/False) For PSS flow, / is zero at the reservoir external boundary.

                                                                                                                   91
                                        Pseudo-steady state (PSS) flow

The time to reach the boundary for a closed circular reservoir can be calculated using the radius
of investigation equation:
  = 0.0325  7-1

                     

Example 7-1. Calculate the time it takes for the PSS to start in reservoir with re=2000 ft, k=1 mD,
=0.2, =2 cp, ct=10-6/psi.
Solution:

2000 = 0.0325                       = 1515 hr

                         -6
               0.2  2  10

7.2 PSS flow solution derivation

Given the characteristics of the PSS flow described above, we can now use the diffusivity equation
to derive an equation to calculate the pressure during PSS flow in a closed cylindrical reservoir.
Be reminded of the diffusivity equation:

1  1  1 
  ( ) =   7-2

As discussed above, / = / = constant. To obtain a relationship for /, we can use
the compressibility definition:

      -1 
 =   7-3

According to this equation,  pressure drop in the average pressure of a single-phase oil

reservoir with initial fluid volume of V and total compressibility ct results in an increase of dV in

the volume of the fluid (or withdrawal of dV volume of fluid). Note that  =  =  where

A, h, and  are the reservoir area, thickness, and initial porosity, respectively. N and Bi are the oil

initial in place (assuming no water in the system) and initial oil formation volume factor,

respectively. Also,  =  where Q is the cumulative production at standard conditions and B

is evaluated at the average pressure i.e. +. Consequently,  =  where q is production rate
                                  2            

                                                 92
                           Petroleum Reservoir Dynamics

at standard conditions. Replacement in the above equation while dividing the numerator and
denominator by dt gives:

       -1 
 =  / 7-4

Therefore,

 -                 -
      =     =2                                                                           7-5
   

where re is the radius of the reservoir. Replacement in the diffusivity equation gives:

1  ( ) = 1  = 2  - = 2 - 7-6
         

or

 1  ( ) = -1 7-7
   
where 1 = 2  . Therefore,

                      

  ( ) = -1 7-8
       

Integrating from a given radius to the external boundary gives:

                      

   (   ) = -1   7-9

Since  = 0 at re, we get:

          

            2 - 2                                                                        7-10
 = 1
            2

Rearrangement gives:

 = 1     2 - 2                                                                           7-11

            2

Integration from the wellbore to any given radius r gives:

                                                                                         93
                         Pseudo-steady state (PSS) flow

                2 - 2

  = 1           2                                                               7-12

    

Therefore,

            1 2  2 - 2
 -  = [  ( ) -              ]                                                   7-13
            2            2

or

                    2 - 2
 -  =          [ ( ) - 2 ]                                                      7-14
            2            2

Evaluating the pressure at the external radius and noting that re>>rw, we get:

 -  =  [ (  ) - 1] 7-15
               2  2

By introducing the average pressure, we get:

  -  =  [ ( ) - 3] 7-16
               2  4

To account for the skin, the skin factor should be added to the logarithmic term. A summary of
the equations for SS and PSS radial flow are given in Table 7-1.

Table 7-1 Comparing the steady-state (SS) and pseudo-steady-state (PSS) equations in terms of external pressure
                                                       and average pressure.

SS                                            PSS

 =  +  ( (  ) + )                              =  +  ( (  ) - 1 + )
               2                                             2  2

 =  +  ( ( ) - 1 + )                           =  +  ( ( ) - 3 + )
              2  2                                          2  4

Question 7-10. The Cartesian graph below shows the pressure versus radius. The solid curve
shows _______and the dashed curve shows________.

                                                                                                                   94
                                        Petroleum Reservoir Dynamics

                                       Figure 7-5 Cartesian graph of pressure versus radius.

Question 7-11. The semilogx graph below shows the pressure versus radius. SS is shown
by_____curve and the PSS is shown by_____curve.

                                       Figure 7-6 Cartesian graph of pressure versus radius.

Example 7-2. A well is produced at a rate of 100 STB/day under steady-state flow conditions
while the average reservoir pressure is 5000 psi and the well flowing pressure is 1000 psi.
Calculate the external pressure required to produce the same rate under pseudo-steady-state
conditions.

                                                                                                                   95
                      Pseudo-steady state (PSS) flow

Solution:

Under SS:  -  =  2 ( (  ) - 12 + )

Under PSS:  -  =  2 ( (  ) - 12 + )

Therefore,

 -  =           -  = 1                      , =  = 5000 psi
 -                , - 

Example 7-3. The oil initial in place of a reservoir is 1 billion STB. The initial and current pressures
are 8000 and 7000 psi respectively. Also, the initial and current formation volume factors are
1.35 and 1.65 bbl/STB. The total compressibility is 10-5 /psi. Reservoir initial porosity is =0.2,
thickness is h=70 ft, and irreducible water saturation is Swi=0. (Actual values are =0.3 and Swi=
0.35. However, to eliminate the need for two-phase modeling, an equivalent porosity of 0.3(1-
0.35)0.2 with Swi=0 is assumed.) Calculate (a) the volume of oil produced from the reservoir in
STB, and (b) reservoir area.

Solution:

(a) The total compressibility is given by:
 = 1  = 1 

         

As discussed above, this becomes:
        1 

 =  
where  = (1.35 + 1.65)/2 = 1.5 bbl/STB. Therefore,

 =  = (109)(1.35)(10-5)(8000 - 7000) = 9  107 STB
                      1.5

(b) To calculate the reservoir area, we can use the following volumetric relationship: = .

Therefore,  =  = 1095.6151.35 = 5.4  108ft2
              700.2

                                                             96
                            Petroleum Reservoir Dynamics

7.3 Rate variation with radius

The rate at the well is known and constant. The rate at the external radius is zero. How does the
rate vary with radius?

Using Darcy equation, we can write:

 =  2                                                                                7-17
            
     

Note the following two equations derived above:

                        2 - 2                                                        7-18
 -  =         [ ( ) - 2 + ]
            2               2

 -  =  [ ( ) - 3 + ] 7-19
              2  4

Subtracting these two equations gives:

                3 1 2 - 2                                                            7-20
 -  =         [ ( ) - +              2]
       2  4 2 

Note that  = 0. Therefore,

                 

               2                                                                     7-21
=             [1 - 2]
 2 

Therefore,

    2  2                             2           2                                   7-22
 =          =               [1 - 2] =  [1 - 2]
       2                                         

The rate variation versus radius according to this equation is shown in Figure 7-7.

                                                                                     97
           Pseudo-steady state (PSS) flow

           Figure 7-7 Flow rate variation versus radius.

Example 7-4. A well is produced at a rate of 100 STB/day under pseudo-steady-state flow
conditions. Calculate the flow rate at radial distance half of the reservoir radius.

Solution: =  [1 - 2 2] = 100  [1 - 0.52] = 75 STB
                                 day

7.4 Time-dependence of pressure

Note that in the equation derived above for PSS flow there is no time dependency:

            2 - 2                                                                  7-23
 -  =    [ ( ) - 2 ]
       2   2

However, as we discussed the pressure drops with time after PSS flow is established. Is there an
error with the above equation?

PSS flow equation does not suggest that pressure is independent of time. However, it suggests
that, during PSS flow, the difference between pressure (p) at any given radius and well flowing
pressure (pwf) is independent of time.

To formulate the time-dependence of the pressure, be reminded of the following relationship
that was introduced earlier using the compressibility concept:

 -                                                                                 7-24
=2
  

                                                                                   98
                    Petroleum Reservoir Dynamics

       - 

  = 2                                                   7-25
         0


       -
 -  = 2                                                 7-26
        

Also note the following equations:

 -  =  [ ( ) - 3 + ] 7-27
              2  4

 -  =      3 1 2 - 2                                    7-28
         [ ( ) - +                  2]
       2  4 2 

Combining these equations with Eq. 7-26 gives:

 -  = 2  +  [ (  ) - 3 + ] 7-29
                2  4

                                     3 1 2 - 2          7-30
 -  = 2  +        [ ( ) - +                     2]
         2  4 2 

In field units, these equations become:

 -  = 2 0.0744  +  [ ( ) - 3 + ] 7-31
                  0.00708  4

       0.0744  +                          3 1 2 - 2     7-32
 -  = 2                             [ ( ) - +       2]
                  0.00708                 4 2 

Note: In the above equations, B in the first term on the RHS is the average formation volume

factor evaluated at +. B in the second term on the RHS is the average formation volume factor

                                    2

evaluated at +. For convenience, we assume these two formation volume factors are identical.

                        2

                                                        99
                             Pseudo-steady state (PSS) flow

Example 7-5. Assume PSS radial flow for the reservoir and fluid properties given in the table

below. (a) Calculate the average pressure, (b) Calculate the well flowing pressure and reservoir

pressure at the external boundary assuming 2000-ft reservoir radius.

Well radius, rw              0.3                             ft

Pay zone, h                  30                              ft

Total compressibility, ct    310-5                          1/psi

porosity,                    0.1                             -

Top reservoir depth          6000                            ft

Initial pressure, pi         5000                            psi

Temperature, T               212                             F

Formation volume factor, Bo  1.2                             bbl/STB

Viscosity,                   1                               cp

Production period, t         10000                           hr

Permeability, k              100                             md

Flow rate, q                 500                             STB/day

Skin factor, s               4                               -

External radius, re          2000                            ft

Solution: (a)

     0.0744           
 -  = 2
             

                0.0744  500  1.2  10000
5000 -  = 20002  30  0.1  3  10-5 = 1240

Therefore,

 = 3760 psi

(b)

 =  +  ( ( ) - 3 + )
              0.00708  4

                                                                      100
              Petroleum Reservoir Dynamics

       500  1  1.2  2000 3
 = 3760 - 0.00708  100  30 ( ( 0.3 ) - 4 + 4) = 3419.5 psi

(c)

 =  +  ( (  ) - 1 + )
               0.00708  2

       500  1  1.2                   2000 1
 = 3419.5 + 0.00708  100  30 ( ( 0.3 ) - 2 + 4) = 3767.1 psi

7.5 Wells draining non-circular areas

The PSS flow equation for the circular reservoirs can be extended to non-circular reservoirs by
introduction of Dietz shape factor, :

        1  4
 =  +  (  (  2) + )                                             7-33
       2 2  

where =0.5722... is the Euler's constant. Values of  are presented in Figure 7-8 for various
shapes of drainage area and well locations.

Question 7-12. This equation should reduce to the circular reservoir equation derived earlier if the
area is considered circular. Find the corresponding shape factor?

From the equation above and Figure 7-8 , the following can be implied:

     All else constant, larger  implies less pressure drop. For example, for a given production
         rate from a given area, the  is higher for a circle than a square. This is because the flow
         is fully symmetric in the circle making all flow lines identical in length. However, for the
         square, the flow lines originating from the corners are longer than others. This flow line
         asymmetry makes the flow less efficient for the square area compared with the circle
         area. Consequently, the pressure drop is higher for the square than the circular area.

      is inside the logarithm. Its effect is muted. Consequently, large differences in drainage
         shapes (and therefore ) while the area is fixed can cause small differences in flow rate.

      is similar for similarly shaped areas e.g. circle, square, and hexagon.

                                                                101
     Pseudo-steady state (PSS) flow

In contrast with the SS productivity index introduced in Chapter 3, the PSS productivity index is
given by:

  2  1
 =  -  =  1 4 7-34 2  ( 2) + 
     

Note that as  increases, J increases. Highest J corresponds to highest  (circular reservoir)
because skewed drainage area is less efficient making the flow paths of different lengths.

Question 7-13. Which one has higher , a circle or square?

Question 7-14. Which one has higher , a square with well in the center or a square with well off
the center?

Figure 7-8 The value of Dietz shape factor (CA) of different well location and shape of boundary (Li and Chen
                                                               2021).

                                                                                                              102
                                        Petroleum Reservoir Dynamics

For a homogeneous reservoir, / should be identical throughout the reservoir. / is given
by:
  -

  =  7-35
This implies that:

  
  = constant 7-36
This should apply to the entire reservoir and each of the wells. Therefore, drainage area of a given
well is simply proportional to the q/h ratio of that well. Note that the above equation is not
perfect. The average pressure may drop faster in a more skewed drainage area. Consequently,
/ would be higher for a more skewed (or less circular) area. In addition, even if the drainage
area is identical for all wells, the areas corresponding to wells with higher skin factor would
experience higher /.
While the drainage area of a given well can be estimated as explained in the previous paragraph,
it is difficult to determine the shape of drainage area. The drainage area is often assumed by
assigning a drainage boundary between wells. The drainage boundary between each two wells is
assumed perpendicular to the line connecting each pair of wells. The drainage area per each well
is honored by adjusting the drainage boundary as shown in the following example problems.

Question 7-15. (True/False) The wells in Figure 7-9 below experience identical decrease in the
average pressure under PSS flow.
Question 7-16. (True/False) The wells in Figure 7-9 below experience identical decrease in the well
flowing pressure under PSS flow.

                                                                                                                 103
A q        Pseudo-steady state (PSS) flow

                        2A
                                    2q

           Figure 7-9 Schematics for Questions 7-15 and 7-16.

Example 7-6. A reservoir with uniform thickness and properties shown in Figure 7-10 is produced
by two wells. The rate for the well A is 250 STB/day and the well B produces 500 STB/day. Each
square is 10001000 ft2.

(i) Calculate the drainage area per well and sketch the boundary.

(ii) Which well has higher shape factor (CA)?

(iii) Calculate the average pressure for each of the wells. Assume 10 mD permeability, 50 ft
thickness, 0.5 cp viscosity, and 1.2 bbl/STB formation volume factor. Skin factor is zero for both
wells. Well flowing pressure for well A is 8075 psi and that for well B is 7550 psi. Well radius is
0.3 ft.

           A  B

           Figure 7-10 Drainage area drained by wells A and B.

Solution:
(a)
 =  = 
  

                                                                104
                           Petroleum Reservoir Dynamics

The drainage boundary can be considered a line perpendicular to the line connecting the wells.
In this case, the line is vertical. Let the boundary be located at xb, with x ranging between 0 and
15000 based on the cell number. The location of well A is then x=2500 and for well B is x=11500.
The drainage area for well A will be equal to 5000xb ft2. The drainage area of well B will be equal
to 5000(15000-xb) ft2. Therefore,

250 =            = 5000
500 15000 - 

 = 5000  5000 = 2.57 ft2

 = 10000  5000 = 57 ft2

To verify that this is the drainage area, the reservoir was simulated using reservoir simulation
software (Figure 7-11). The cells with solid circles are the ones showing the maximum pressure
and therefore indicate the boundary between the wells. The vertical line drainage boundary is
quite close to the boundary identified by simulation.

          Figure 7-11 Drainage area inferred from reservoir simulation. Cooler colors indicate lower pressure.

(b) CA is larger for well A. CA,A=30.9 for a square with well in its center. CA,B is not given in the
table. The well is located in a 12 area with a well at 35 percent of the longer length. Therefore,
CA should be between 22.6 and 4.86. Interpolation between these two values gives 11.96.

(c)

             1  4
 =  +       [  (  2) + ]
            2 2  

Therefore,

            250  0.5  1.2 1  4  2.57
 = 8075 + 0.00708  10  50 [2  (1.781  30.9  0. 32)] = 8431.4 

                                                               105
Pseudo-steady state (PSS) flow

500  0.5  1.2 1  4  57
 = 7550 + 0.00708  10  50 [2  (1.781  11.96  0. 32)] = 8332.3 

Example 7-7. A two-well fault block is shown in Figure 7-12. Total drainage area is 480 acres. Each
well produced for 200 days since previous shut-in. Permeability is 8.2 md, viscosity is 1 cp,
formation volume factor is 1.2 bbl/STB, well radius is 0.35 ft, and well flowing pressure is 2000
psi. The following information are also given for each well.

                 A B

qo (STB/day) 200 100

h (ft)           40 36

s (-)            0 2

Calculate: (a) drainage area per well, and (b) average pressure within each drainage area.

                                                 B
A

      Figure 7-12 Two-well fault block corresponding to Example 7-6 (modified from Economides et al. 2013).

Solution:
 =   200 = 40  9 = 5
  100 36

                                                                                                                 106
                               Petroleum Reservoir Dynamics

Also,  +  = 480 acres

Therefore,

 = 309 acres

 = 171 acres

Based on the above areas, the boundary of the drainage areas for the wells can be drawn as
shown in Figure 7-12 so that distance of Well A from the boundary is 2600 ft. Also, based on the
shape of drainage areas shown in the figure, the following approximate CA's can be obtained from
the CA table for each of the wells:

, = 12.9

, = 21.9

We can now use the following equation to obtain the average pressure for each of the wells:

             1              4
 =  +         ( ln (  2) + )
            2 2  

                     200  1  1.2 1 4  309  43560
 = 2000 + 0.00708  8.2  40 (2 ln (1.781  12.9  0.352) + 0) = 2866 psi

                     100  1  1.2 1 4  171  43560
 = 2000 + 0.00708  8.2  36 (2 ln (1.781  21.9  0.352) + 2) = 2564 psi

Note the uneven depletion.

7.6 Inflow performance relationship (IPR)

IP 's main purpose is to present a relationship of bottomhole flowing pressure () versus flow
rate (). Considering the PSS oil flow, the following relationship has been already presented:

              2                1
 =  -  =  1 4 7-37 2  ( 2) + 
                               

Accordingly, we can write:

                                                                       107
                                        Pseudo-steady state (PSS) flow
               1
  =  -   7-38
In graphical terms, this implies that  versus rate follows a linear behavior with intercept  and
slope -1/. According to the above equation, IPR can be established if the reservoir properties
(i.e. drainage area, permeability, thickness, fluid viscosity and formation volume factor, shape
factor, and skin factor) are known. However, in practice these properties are never accurately
known. Therefore, pressure tests (e.g. flow after flow test, isochronal test, and modified
isochronal test) have been proposed to obtain these relationships.

Example 7-8. A flow after flow test was conducted according to which the bottomhole pressure
stabilized at 4925 and 4884.1 psi for flow rates of 100 and 150 STB/day, respectively (see Figure
7-13). Calculate the productivity index, the average reservoir pressure, and the absolute open
flow (AOF). Plot the IPR.

                     Figure 7-13 A flow after flow test with corresponding rate and pressure responses.

Solution:
According to the two pairs of pressure and rate, we get:
pwf = -0.818 q + 5006.8

                                                                                                                 108
                           Petroleum Reservoir Dynamics

Therefore, the average pressure is 5006.8 psi. Also, 1/=0.818 or =1.22 STB/day/psi. By setting
pwf =0, we obtain AOF=6121 STB/day. The resulting IPR is plotted below.

pwf (psi)  4930
           4925
           4920       110  120  130     140                                150
           4915
           4910
           4905
           4900
           4895
           4890
           4885
           4880

                 100

                           q (STB/day)

                           Figure 7-14 IPR curve for Example problem 7-8.

Single-phase oil IPR is generally linear. However, complications such as two-phase flow, large
compressibility, and non-Darcy effects tend to make the curve concave downward. This implies
that at higher rates, the curve is steeper i.e. 1/ is larger, or  is smaller. This is expected since
higher rates make the flow less efficient (remember the non-Darcy effects).

There are a wide range of IPR models available in the literature applying to various conditions
which can be found in any production engineering textbook. An important reminder that the IPR
changes with time given that the average pressure does so.

The IPR gives a picture of what the reservoir can deliver for a set value of bottomhole well
pressure considering the current average pressure of the reservoir. However, in general, the
pressure is set at the surface at the tubing head not at the bottomhole. Therefore, a relationship
between the bottomhole flowing pressure () and production rate () is required for a set
value of the tubing head pressure (). This relationship is established by the vertical flow
performance (VFP).

7.7 Vertical flow performance (VFP)

VFP curve is the graph of  versus q for a given .  can be related to  using the
following equation:

                                                                                                                 109
           Pseudo-steady state (PSS) flow

 =  +  +                                   7-39

where  is the average density of the fluid filling the wellbore,  is the wellbore depth, and 
is the pressure loss due to friction. If  is fixed and is negligible, the resulting  (for a fixed
) will be constant and independent of . Then, the resulting VFP will be a flat horizontal line.
However,  is highly dependent on q.  increases with increased velocity and . Therefore,
VFP primarily has a positive slope showing increasing  with . The slope is much higher for
gas (or high-GOR oil) wells compared with oil wells.

However, for two-phase flow, the VFP positive slope is reversed at low production rates. When
rates are low, liquid gets accumulated (liquid loading) in the wellbore necessitating higher 
for the same  and fixed . In other words, lowering  can allow for liquid loading which
increases the difference between  and . As an analogy, if you are blowing through a straw,
less liquid accumulates when you blow faster (increase ) causing less pressure difference
between two ends of the straw. A sample VFP for a specified  is shown in Figure 7-15.

7.8 Nodal analysis

When IPR and VFP curves are combined, one can obtain the well deliverability for a given
value. The intersection point of the two curves shows the well operating  and  (see Figure
7-15). By varying  and replotting the VFP, one can obtain the well operating  and  for
different values.

pw f       IPR

                                                                                                        Operating point
                                                     VFP

                                                                                      q

Figure 7-15 Determining the well deliverability through combination of VFP and IPR curves.

                                                                                                     110
                                        Petroleum Reservoir Dynamics

7.9 Chapter Problems

Problem 7-1. A well is produced at a rate of 100 STB/day under steady-state flow conditions
while the average reservoir pressure is 5000 psi and the well flowing pressure is 1000 psi.
Calculate the external pressure required to produce at 50 STB/day under pseudo-steady-state
conditions.

Problem 7-2. A well is produced at a rate of 100 STB/day under pseudo-steady state flow
conditions while the average reservoir pressure is 5000 psi and the well flowing pressure is 1000
psi. Calculate the external pressure required to produce the same rate under steady-state
conditions. Assume ln(re/rw)=7 and skin factor of 3.

Problem 7-3. Assume PSS radial flow for the reservoir and fluid properties given in the table
below. (a) Calculate the average pressure, (b) Calculate the well flowing pressure and reservoir
pressure at the external boundary assuming 3000-ft reservoir radius.

Well radius, rw              0.3     ft
Pay zone, h                  35      ft
Total compressibility, ct    310-5  1/psi
porosity,                    0.2     -
Initial pressure, pi         8000    psi
Formation volume factor, Bo  1.2     bbl/STB
Viscosity,                   0.7     cp
Production period, t         100     days
Permeability, k              200     md
Flow rate, q                 1000    STB/day
Skin factor, s               3       -

Problem 7-4. Each of the wells shown in the figure below drain 640 acres of reservoir area. The
reservoir average pressure is 5651 psi, well flowing pressure for both wells is 3500 psi. Formation
volume factor is 1.2 bbl/STB, viscosity is 0.5 cp, permeability is 8.2 md, and thickness is 53 ft. Well

                                                                                                                 111
              Pseudo-steady state (PSS) flow

   radius and skin factor are 0.328 ft and zero for both wells. Calculate the production rate for each
   of the wells.

              Well 2

      Well 1

   Problem 7-5. For the reservoir shape given below, the rate for the well A is 250 STB/day and the
   well B produces 750 STB/day. Each square is 500500 ft2.

   (i) Calculate the drainage area per well and sketch the boundary.

   (ii) Which well has higher shape factor (CA)?

   (iii) Calculate the average pressure for each of the wells. Assume 50 mD permeability, 20 ft
   thickness, 0.7 cp viscosity, and 1.4 bbl/STB formation volume factor. Skin factor is 5 for well A
   and 10 for well B. Well radius is 0.35 ft. Assume shape factor is 30 for both wells. Assume well
   flowing pressure is the same for both wells at 6500 psi.

y  A                  B

      x

   Problem 7-6. A well is producing at 200 STB/day from a cylindrical reservoir with 5000-ft radius.
   Calculate the radial rate at 2500 ft.

                                                                                                                    112
                    Petroleum Reservoir Dynamics

8 Transient radial flow and drawdown test analysis

As discussed in previous chapters, transient flow regime is observed first before either of SS or
PSS flow are established.

A reminder that for steady-state (SS) flow of slightly compressible fluid under constant rate
production condition, we had:

 -  =  [ln (  ) + ] 8-1
               2 

 -  =  [ln ( ) - 1 + ] 8-2
              2  2

For PSS:

 -  =  [ln ( ) - 3 + ] 8-3
              2  4

The time dependency was obtained given the following:

          
 -  = 2                                                       8-4
           

The summation of the last two equations gave the following:

 -  = 2  +  [ln (  ) - 3 + ] 8-5
                2  4

Which has been extended for a non-circular drainage area by:

                 1  4
 -  =        +  [ ln (  2) + ]                                8-6
           2 2  

8.1 Transient radial flow solution for constant rate production
Be reminded of the pressure diffusivity equation:
 1  1  1 
   ( ) =   8-7

                                                              113
                  Transient radial flow and drawdown test analysis

Unlike the PSS flow,  is no longer constant. In addition, the outer boundary of the reservoir (re)

                                   

has not been reached during transient flow. Therefore, the reservoir is essentially infinite-acting
such that p=pi at   . The rate at the well is constant. Therefore, at r=rw, we can write:

       2 
  =     | 8-8

To simplify the solution derivation, we assume rw is small (rw0). Considering these two
boundary conditions along with the initial condition of p=pi at t=0, the following solution is
obtained using the combination of variables approach (see derivation in Appendix A):

                     1 -2
  - (, ) = 2 [- 2 Ei ( 4 )] 8-9

Setting the radius at the well, the following is obtained for the well flowing pressure:

 -  =        1 -2
               [- Ei ( ) + ]
            2 2 4
                                                                                          8-10
            -  2

= 4 [-Ei ( 4 ) + 2]

when x<0.01, the Ei term can be approximated by: -(-) = - () - . Therefore,

                  2
 -  =          [- ln ( ) -  + 2]
            4     4

    4
=    [ln ( 2 ) -  + 2]
   4 
     8-11
=    [ln (        2) + ln( 4) -  + 2]
   4 

=    [ln (        2) + 0.809 + 2]

   4 

Be reminded of the following relationship between the natural log and log10 function:

() = ln() = ln() 8-12
            ln(10) 2.303

Therefore,

                                                                                          114
                                Petroleum Reservoir Dynamics

 -  =            2.303  [log (         2) +  0.809 2
                                               +      ]
                 4               2.303 2.303
                    2.303  8-13
                 =            [ (            2) + 0.351 + 0.869]
                    4                  

In field units:

                 2.303         [log (0.0002637
 -  =                                          2 ) + 0.351 + 0.869]             8-14
                 2  0.00708           

or

 -  =            162.6  [log() + log (         2) - 3.23 + 0.869]               8-15

                                       

For completeness, the field-unit equation in terms of Ei function is given by:

 -  =            70.6  [-Ei ( -9482          ) + 2]                             8-16

                                  

Example 8-1. Calculate the well flowing pressure after 12 hours of transient flow considering the
properties in the table below.

Well radius,                    0.3     ft
Pay zone,                       50      ft
Total compressibility,          10-6    1/psi
porosity,                       0.1     -
Initial pressure,               5000    psi
Formation volume factor, Bo     1.2     bbl/STB
Viscosity,                      1       cp
Permeability,                   100     md
Flow rate,                      100     STB/day
Skin factor,                    2       -

Solution:

                 162.6(100)(1)(1.2)                  100  12
5000 -  = (100)(50) [log (0.1  1  1 - 6  0.3  0.3) - 3.23 + 0.869  2]

                                                                                115
                Transient radial flow and drawdown test analysis

 = 4962.4 psi

Question 7-1. (True/False) Exponential integral of a negative number is positive.

Question 7-2. (True/False) The exponential integral can be approximated by logarithmic function
after sufficiently long time.

Question 7-3. (True/False) Well flowing pressure (pwf) varies linearly with logarithm of time for
transient radial flow if the flow rate is constant.

8.2 Drawdown test analysis

The pressure drawdown data during the transient radial flow at fixed production rate can be used
to estimate permeability and skin factor. Based on the last equation above, semi-log graph of
pressure versus logarithm of time should demonstrate linear behavior. Sample data are shown
in Cartesian and semi-log graphs in Figure 8-1. The slope and intercept of line-fritted data can be
used to estimate permeability and skin factor. The slope (m) of the fitted line on the semi-log
graph is a negative value given by:

  = - 162.6 8-17
               

Therefore,

 = 162.6 8-18
        ||

where ||is the absolute value of the slope. On the other hand, the intercept of the line referred
to as p1hr is given by:

1 =  -      162.6  [log (     2) - 3.23 + 0.869]                  8-19

                         

Therefore,

 = 1.151 [ - 1 - log ( 2  ) + 3.23] 8-20
            ||     

                                                                  116
                             Petroleum Reservoir Dynamics

5005                                                                            4990

5000                                4985
4995

4990                                4980

pwf (psi)4985                                                                   4975
                                                                       pwf (psi)4980

4975                                4970

4970                                                                            4965
4965

4960                                                                            4960
        0
                     500      1000                                                0.001  0.1             10  1000
                  Time (hr)
                                                                                              Time (hr)

Figure 8-1. Cartesian and semi-log graphs of well flowing pressure versus time during transient radial flow.

Example 8-2. Calculate permeability and skin factor for the data given in the figures below (in
terms of pwf versus time and (pi-pwf)/q versus time). The reservoir with 5000-psi initial pressure,
50-ft thickness, 20 percent porosity, 1.44e-5/psi total compressibility which is produced at a 10
STB/day by a well with 0.35-ft well radius. The oil viscosity and formation volume factor are 0.7
cp and 1.436 bbl/STB, respectively.

Solution:

Based on the slope of semilog graph of pwf versus time, we can find the permeability. However,
we first need to present the fitting equation in terms of log10 (not the natural log):

y = -1.408ln(x) + 4974.3=-1.4082.303log(x) + 4974.3=-3.243 log(x) + 4974.3

Therefore,

162.6 162.6  10  0.7  1.436  = 10.08md
 = || =
                  3.243  50

The skin factor:

                                                                                                              117
                     Transient radial flow and drawdown test analysis

 = 1.151 [ - 1 - log ( 2  ) + 3.23]
                 ||           

                         5000 - 4974.3           10.08
                 = 1.151 [ 3.243 - log (0.2  0.7  1.44 - 5  0.352) + 3.23]

                 = 4.08

Alternatively, the semi-log graph of p/q versus time can be used which is often observed in the
commercial well testing software. The transient flow equation should then be rewritten in the
following form:

 -  = 162.6 [log() + log ( 2  ) - 3.23 + 0.869]
                              

Consequently:

     162.6
 = ||

   - |
                1             
 = 1.151 [           - log (    2) + 3.23]
               ||           

It would have been ideal if the semi-log graph would have demonstrated linear behavior from
the beginning of production. Unfortunately, the linear behavior is often distorted by the wellbore
storage effect at least for the first few hours of production.

8.3 Wellbore storage (WBS) effect

It may be easiest to explain the WBS effect considering a gas reservoir with a wellbore initially
filled with gas. At time t=0, the valve is opened at the surface to produce at a constant rate q.
Does this mean that the rate at the well bottom hole (the reservoir sandface) is also q? The
answer is definitely negative. At the beginning all the production comes because of expansion of
the gas contained in the wellbore i.e. no gas comes from the reservoir. However, the reservoir
quickly begins to contribute to production and eventually all the produced gas comes from the
reservoir. A schematic of flow contribution of the reservoir under constant well surface rate is
shown in Figure 8-2. The time it takes for the reservoir full contribution may be only hours.

                                                                                                                 118
Production rate                         Petroleum Reservoir Dynamics
However, the pressure during this WBS-dominated time period cannot be used for transient
radial flow analysis because for that analysis rate must be known. The pressure behavior during
the WBS-dominated flow does not show linear behavior. Consequently, it is important to identify
the part of data distorted by WBS and exclude it from the transient radial flow analysis.

                  q
               qsf

                                                                                Time

      Figure 8-2. Flow rate at the reservoir sandface (qsf) considering constant production rate at the surface (q).

As shown in Appendix B, when plotted versus time on a log-log graph, the pressure change ( =
 - ) overlaps the pressure change logarithmic derivative (  ln() =    ) while following a
unit slope during the WBS-dominated period. Therefore, to distinguish the data dominated by
WBS from those not affected by WBS, the log-log graph is used which is often referred to as the
log-log diagnostic plot given its proved usefulness beyond just identifying the WBS.

                                                                                                                 119
p and its log-derivative    Transient radial flow and drawdown test analysis

                                                               Time

Figure 8-3. Log-log plot of pressure change (, shown by the dashed black curve) and its logarithmic derivative
(  , shown by the solid black curve) versus time. The unit-slope red line can be used to identify the data

 ln()

dominated by WBS. Both the pressure drawdown and its log-derivative follow unit-slope for the beginning two time
log-cycles (shown by the red shaded area) which shows the WBS dominance. The gold line indicates the zero-slope
behavior expected during radial transient flow. The gold-shaded area indicates the data corresponding to radial
transient flow.

Question 8-4. (True/False) The well production at the surface comes purely from expansion of the
wellbore fluids at the beginning of a well test.
Question 8-5. (True/False) Constant production rate at the surface implies constant rate at the
sandface.
Question 8-6. (True/False) Constant production rate at the surface implies constant rate at the
sandface after sufficiently long time.
Question 8-7. In the context of well pressure testing, p is ____________ .

    (a)  - 
    (b)  - 
    (c) - 

                                                                                                                 120
                                        Petroleum Reservoir Dynamics
Question 8-8. Which of the red and black drawdown test data indicates wellbore storage effect?

Question 8-9. (True/False) dp/dlnt = t dp/dt.

8.4 Log-log diagnostic plot
The diagnostic plot is a log-log plot which includes both pressure change (p=pi-pwf) and its
logarithmic derivative (dp/dln(t)) versus time - as shown in Figure 8-3. A note that the
logarithmic derivative is often referred to as derivative for brevity. As noted above, the pressure
change and its log-derivative follow unit-slope linear behavior when WBS is dominant. After the
WBS effect ends - i.e. the rate at the surface becomes identical to that at the sandface - the
transient radial flow should be identifiable based on zero-slope linear behavior on the derivative.
The reason is that taking the derivative of the radial transient pressure change gives:

    70.6
  ln( ) =  8-21
This equation indicates that the derivative is constant during transient radial flow. Therefore,
zero-slope linear behavior of the derivative can be used to identify the transient radial flow. Once,
the data corresponding to radial transient flow are identified, the semi-log graph presented
earlier can be used to line-fit these data, and obtain permeability and skin factor.

8.5 Drawdown test analysis procedure
According to the above theory, the following steps should be taken to analyze the pressure
drawdown test data:

                                                                                                                 121
                            Transient radial flow and drawdown test analysis

     Plot pwf versus time on a semi-log graph
     Calculate p=pi - pwf (pressure drawdown)
     Calculate dp/dlnt = t dp/dt (logarithmic derivative)
     Plot the diagnostic plot
     Find the beginning of radial transient flow which would be the time for the start of the

         semi-log straight line (tslsl).
     Use the semilog graph starting tslsl and line-fit the data to obtain the slope (m) and

         intercept (p1hr)
     Calculate k and s.

Example 8-3. A pressure drawdown test has been conducted in an oil well producing 10 STB/day.
The data is plotted in terms of semi-log graph and log-log diagnostic graph in the figure below.
The reservoir thickness, porosity, total compressibility, and initial pressure are 50 ft, 0.2, 1.4410-
5/psi, and 5000 psi, respectively. The oil formation volume factor is 1.426 bbl/STB and oil viscosity
is 0.7 cp. The wellbore radius is 0.35 ft. Obtain permeability and skin factor.

           5010

           5000

           4990

pwf (psi)  4980

           4970

           4960

           4950

           4940

           0.001  0.01  0.1  1          10  100  1000

                             Time (hr)

                                                 122
                                                  Petroleum Reservoir Dynamics

p and its derivative (psi)  100
                             10
                               1           0.001  0.01           0.1        1      10  100            1000
                             0.1

                           0.01
                          0.001

                               0.0001

                                                                 Time (hr)

Solution:

The log-log diagnostic plot clearly indicates the WBS effect is dominant until 0.2 hours given the
unit-slope on both the pressure change and its derivative. The zero-slope line appears only after
tslsl 20 hours. Line-fitting the pressure data on the semi-log graph (based on the figure below)
gives:

m=1.4342.303=3.3025 psi/log-cycle

p1hr=4957.6 psi

Using these values, the permeability and skin factor are obtained by:

                          162.6 162.6  10  0.7  1.436
 = || =                                                          = 9.9 md
                                                  3.3025  50

 = 1.151 [ - 1 - log ( 2  ) + 3.23]
                                       ||         

                                                  5000 - 4957.6                10
                                       = 1.151 [ 3.3025 - log (0.2  0.7  1.44 - 5  0.352) + 3.23]

                                       = 9.74

                                                                                                      123
                        Transient radial flow and drawdown test analysis

           5010

           5000

           4990

pwf (psi)  4980

           4970

           4960                         y = -1.434ln(x) + 4957.6

           4950

           4940

           0.001  0.01  0.1  1          10  100                           1000

                             Time (hr)

Question 8-10. (True/False) The slope of logarithmic pressure derivative on the log-log diagnostic
plot is zero during the transient radial flow.

Question 8-11. (True/False) The slope of logarithmic pressure derivative on the log-log diagnostic
plot is zero during the transient radial flow.

8.6 Chapter Problems

Problem 8-1. The pressure drawdown test data are given in the next page. The well is producing
at a rate of 600 STB/day from a 10-ft thick oil reservoir. The reservoir porosity and total
compressibility are 20 percent and 1.3510-5/psi. Well radius is 0.35 ft. The oil formation volume
factor is 1.5 bbl/STB and oil viscosity is 0.8 cp.

(a) Is the test data affected by wellbore storage? Support your answer with reason.

(b) At what time the reservoir starts showing the radial transient flow?

(c) Calculate the reservoir permeability and skin factor.

(d) After 200 hours since the start of the test, the log-log graph showed indication of a sealing
fault. What is the new value of the log-derivative after the fault effect is felt?

(e) The data after 200 hours are line-fitted on the semi-log graph showing an intersection point
with the earlier line at 140 hours. Calculate the fault's distance from the well.

                                                                                                                 124
                                                                Petroleum Reservoir Dynamics

                            1000

p and log-derivative (psi)  100

                            10

                            1       0.001  0.01  0.1                                          1  10                        100
                            0.0001               Time (hr)

pwf (psi)6000
         5500
         5000                                                                                    y = -51.67ln(x) + 3851.8
         4500
         4000                       0.001  0.01  0.1                                          1  10                        100
         3500                                    Time (hr)
         3000

             0.0001

                                                                                                                           125
                       Superposition principle and pressure buildup test analysis

9 Superposition principle and pressure buildup test analysis

In this chapter we first present the superposition principle followed by its application in pressure
well testing during production and shut-in periods.

Superposition principle states that the pressure change in response to multiple events will be the
sum of the pressure change caused by each of those events individually. The pre-requisite for
applicability of this principle is that the equations governing the flow should be mathematically
linear. Given that the pressure diffusivity equation is a linear partial-differential equation, the
superposition principle is applicable to calculate the pressure in the reservoir. Superposition
principle can be presented in two major contexts: (1) superposition in space, and (2)
superposition in time. In the following, we first cover the former.

9.1 Superposition in space

Based on superposition in space, the pressure drop at a given location in the reservoir caused by
production from multiple wells is equal to the sum of the pressure changes caused by each of the
wells individually.

Example 9-1: An oil reservoir is produced by three wells shown in the figure below. The reservoir
thickness, porosity, and permeability are 40 ft, 0.3, and 150 mD respectively. The oil viscosity and
formation volume factor are 0.6 cp and 1.4 bbl/STB respectively. The reservoir total
compressibility is 10-5/psi. The production rates are 300, 400, and 600 STB/day for wells 1, 2, and
3 respectively. In addition, the skin factor is 10, 5, and zero for wells 1, 2, and 3 respectively. The
well radius is 0.35 ft for all wells. Calculate (1) the pressure drop at the observation well after 10
days production, and (b) the pressure drop at well 1 after 10 days production.

       Well 2                                 Well 3
(-2000 ft, 2500 ft)                     (4500 ft, 2400 ft)

                     Observation well
                     (400 ft, 1400 ft)

                     Well 1
                     (0, 0)

                                                                                                126
                         Petroleum Reservoir Dynamics

Solution:

(a) The pressure drop will be the sum of pressure drops induced by each of the wells individually.
Therefore,

 = 1 + 2 + 3

where 1, 2, and 3 indicate the pressure drop due to each of wells 1, 2, and 3 respectively.
An important note that the pressure out of a well skin zone (e.g. at the location of the observation
well) would be independent of the skin factor of the well. Therefore,

1 = 162.61 [() +  ( 2  ) - 3.23]
                               1

2 = 162.62 [() +  ( 2  ) - 3.23]
                               2

3 = 162.63 [() +  ( 2  ) - 3.23]
                               3

Therefore,

1 =  162.6  3000  0.6  1.4  [(100  24)

              150  40

                                           150
              +  (0.3  0.6  10-5  (4002 + 14002)) - 3.23] = 119.15 psi

2 =  162.6  4000  0.6  1.4  [(100  24)

              150  40

                                                        150
              +  (0.3  0.6  10-5  ((400 + 2000)2 + (1400 - 2500)2)) - 3.23]

              = 112 psi

3 =  162.6  6000  0.6  1.4  [(100  24)

              150  40

                                                        150
              +  (0.3  0.6  10-5  ((400 - 4500)2 + (1400 - 2400)2)) - 3.23]

              = 112 psi

Therefore, the total pressure drop at the observation well is 343 psi.

                                                                                127
     Superposition principle and pressure buildup test analysis

(b) The pressure drop at the location of well 1 requires calculation of pressure drops because of
all the three wells at its location.

1 =  162.6  3000  0.6  1.4  [(100  24) +  (                    150            2) - 3.23

     150  40                                                            -5
                                                             0.3  0.6  10  0.35

     + 0.869  10] = 1206.9 psi

Note that the skin factor must be accounted for in calculating 1.

2 =  162.6  4000  0.6  1.4  [(100  24)

     150  40

                                   150
     +  (0.3  0.6  10-5  (20002 + 25002)) - 3.23] = 96.5 psi

3 =  162.6  6000  0.6  1.4  [(100  24)

     150  40

                                   150
     +  (0.3  0.6  10-5  (45002 + 24002)) - 3.23] = 89.5 psi

Therefore, the total pressure drop at well 1 is 1392.9 psi.

9.1.1 Presence of sealing fault

Consider a well at distance L from a sealing fault. It takes some time for the pressure to reach the
fault and therefore, a typical transient radial flow behavior would be first observed. However,
the behavior becomes different after the pressure change is felt at the fault. It can be shown that
the effect of fault presence on the pressure can be modelled by removing the fault and
considering an image well at the other side of the fault. The superposition in space can be then
applied to obtain the pressure at the well because of production from both the actual and image
wells.

The pressure distribution in a reservoir with a fault is shown in Figure 9-1a. Figure 9-1b shows
the pressure distribution ignoring the fault while including an image well. Both of these sub-
figures show identical pressure distribution (color represents the pressure). To make the
comparison more quantitative, the pressure variation at the well for both models is shown in
Figure 9-2. The identical behavior implies that effect of a sealing fault can be modeled by inclusion
of a mirror (image) well.

                                                                                    128
                           Petroleum Reservoir Dynamics

                 (a)             (b)

Figure 9-1. Pressure distribution in the reservoir for a well near a fault. (color represents the pressure where warmer
colors show higher pressures). Part (a) shows the actual system, and part (b) shows the modeled pressure in presence
 of an image well while the fault is removed. The pressure distribution around the well is identical for both models.

          4970

           4965

           4960

pwf (psi)  4955                                   Faulted
           4950                                   Image well - No fault

           4945

           4940

           4935

           4930       500  1000  1500  2000       2500   3000            3500  4000
                   0

                                       Time (hr)

Figure 9-2. The well bottomhole pressure for the actual faulted model and when the fault is replaced by an image
well. The overlap between the pressure behavior indicates that the effect of fault on the pressure can be accounted

                                                for by considering an image well.

                                                                                                                129
                      Superposition principle and pressure buildup test analysis

Based on the superposition principle, the pressure drop (at any given location including the
location of the actual well i.e. at r=rw) would be the sum of pressure drop caused by the actual
well and that caused by the image well. The pressure drop due to production from the actual well
is given by:

 -  =                 -2                                                                  9-1
                      [- ( ) + 2]
       4              4

In order to calculate the pressure drop due to production from the image well (i.e. r=2L), rw must
be replaced by 2L:

                      -42
 -  = 4 [- ( 4 )] 9-2

Therefore, the pressure drop after the pressure effect reaches the fault is obtained by:

                      -2                          -42                                     9-3
 -  =                 [- ( ) + 2] +     [- ( )]
       4              4              4            4

or in field units:

 -  =  70.6           [- (-9482      ) + 2] +     70.6  [- (  -94842              )] 9-4

                                                              

The following important notes should be made:

1. Skin factor is not included in formulating the effect of production from the image well simply
because the actual well is outside of the skin zone of the image well.

2. Log-approximation of the Ei function for the actual well would apply shortly (seconds to
minutes) after the start of production. That's because the argument of the Ei function quickly
becomes less than 0.01. However, this is not necessarily correct for the image well. Depending
on the well-fault distance L, it may take significant time for the log-approximation to apply.
Therefore, the last equation above simplifies to:

 -  =  162.6          [() +  (         2) - 3.23 + 0.869]

                                                                                          9-5

                    70.6    -9484              2

                    +  [- (  )]

                                                                                          130
                Petroleum Reservoir Dynamics

3. After sufficiently log time, eventually the argument of the Ei function in the last equation above
becomes less than 0.01. Consequently, the equation becomes:

 -  =  162.6  [() +  (    2) - 3.23 + 0.869]

                        
          162.6  9-6
       +        [() +  (     2) - 3.23]
                          4

After a few mathematical manipulations, this equation becomes:

 -  = 2  162.6 [() +  ( 2  ) - 3.23 + 0.869  + ( )] 9-7
                                                                2  2

9.1.2 Pressure drawdown behavior in presence of sealing fault

Based on the theory covered above, the following drawdown pressure behavior is expected in
presence of a sealing fault:

(1) Early-time period: It takes some time for the pressure effect to reach the fault. Therefore, the
pressure drop at early time is solely due to production from the actual well. The pressure drop at
early-time would then be given by the transient radial flow equation:

 -  =  162.6  [() +  (    2) - 3.23 + 0.869]                          9-8

                        

(2) Transition time: During this time, the effect of fault has been felt. However, log-approximation
for the image well effect is not yet applicable. Therefore, the pressure is given by:

 -  =  162.6  [() +  (    2) - 3.23 + 0.869]

                                                                      9-9

          70.6  -9484     2

       +  [- (  )]

(3) Late-time period: The argument of the Ei function for the image well would eventually become
less than 0.01. Then the log-approximation would apply for the image well as well. Consequently,
the pressure drop would be given by:

 -  = 2  162.6 [() +  ( 2  ) - 3.23 + 0.869  + ( )] 9-10
                                                                2  2

                                                                      131
                       Superposition principle and pressure buildup test analysis

Note that this equation indicates that at late-time, the slope on the semi-log graph would be
doubled. In addition, the zero-slope value (  ) on the log-log plot would also double. This is

                                                                            ()

important. It is this signature (i.e. doubling the slope on the semi-log graph and doubling the log-
derivative on the log-log graph) that shows the presence of a sealing fault. This behavior is visible
in Figure 9-3. On the semi-log, the early-time slope is 95.32 (=41.392.303) while at late-time it
is 184.91 (=80.292.303). On the log-log plot the early-time zero-slope value is ~40 and that at
late-time is ~80 psi.

9.1.3 Pressure drawdown test analysis in presence of sealing fault

Based on the above three time periods, the following procedure can be followed to analyze
pressure drawdown test in presence of a sealing fault.

(1) Early-time: From the early-time analysis both permeability and skin can be determined
following exactly the same procedure presented in Chapter 8 for the transient radial flow. The
semi-log and log-log plots should be established. The data corresponding to the zero-slope
behavior on the log-log plot should be identified. Next, those data should be line-fitted on the
log-log plot. The slope (m) and intercept (p1hr) are then used to estimate permeability and skin.

(2) Late-time: After fault effect is fully felt, the late-time behavior should show doubling the slope
on the semi-log graph and doubling the log-derivative on the log-log graph. Let tx be the time at
which the early-time and late-time fitted lines meet. At that time, the early-time and late-time
data should give identical pressure drop. Therefore, the following would apply:

162.6       [() +  (      2) - 3.23 + 0.869]

                    

            =  2  162.6  [() +  (                  2) - 3.23       9-11

                                  

            + 0.869  + ( )]
               2          2

After some mathematical rearrangements, we obtain:

 ( 2  ) = 3.23 9-12
      4

Therefore,

                                                                    132
                                        Petroleum Reservoir Dynamics

  = 0.0122  9-13
                  

Thus, the late-time pressure data can be analyzed to obtain the well-fault distance (L).

Example 9-2. Determine permeability, skin, and well distance to fault using the following
properties and the drawdown test plots shown in Figure 9.4.

Wellbore radius (ft) 0.35                 viscosity (cp)                 1
                                          Total compressibility (1/psi)  510-5
Porosity (frac.)    0.2                   Initial pressure (psi)         3000
                                          Production rate (STB/day)      400
Thickness (ft)      20

Bo (bbl/STB)        1.2

Solution: The permeability can be obtained based on the early-time fitted line slope:

     162.6 162.6  400  1  1.2
 = || = 41.39  2.303  20 = 40.9 mD

The skin factor is accordingly given by:

 = 1.151 [ - 1 -  ( 2  ) + 3.23]
                ||       

                    3000 - 2440.7                            40.9
                = 1.151 [ 41.39  2.303 -  (0.2  1  5  10-5  0.352) + 3.23] = 1.6

The intersection time, tx can be either read from the semi-log graph or calculated based on the
line-fitted equations. Accordingly, tx=65 hours. Therefore, the well-fault distance is:

 = 0.0122   = 0.0122  0.2  1  5  10-5 40.9  65 = 199 ft

                                                                                       133
                                      Superposition principle and pressure buildup test analysis

3600

3400                                                                                      (a)

3200

3000

2800

pwf (psi)                   2600

                                                           y = -41.39ln(x) + 2440.7

2400

2200

2000

1800                                                                                      y = -80.29ln(x) + 2602.9

1600

                              0.0001  0.001  0.01  0.1  1          10                100          1000                                 10000

                                                        Time (hr)

10000

                                                                                          (b)

p & its log-derivative (psi)1000

                              100

                              10

                              1

                              0.0001  0.001  0.01  0.1  1          10                100          1000                                 10000
                                                        Time (hr)

                                   Figure 9-3. Semi-log and log-log plots of drawdown data taken from a well next to a sealing fault.

                                                                                                                                       134
                               Petroleum Reservoir Dynamics

9.2 Superposition in time

Based on superposition in time, the pressure change in response to production at multiple rates
over time is equal to the sum of multiple wells producing at constant rate but coming to operation
at different times. Consider a well producing at the rate history shown in Figure 9-4. The pressure
drop at time t1 would be only dependent on the rate during the initial time period before t1 which
is given by:

(1) =  -  = 162.61 [(1) +  ( 2  ) - 3.23 + 0.869]
                                                                                          9-14

           = (1, 1)

                                                                          q3

Flow rate                      q2

           q1

                           t1  Time  t2                                       t3

                           Figure 9-4. Variable rate production history.

Calculation of the pressure at time t2 is no longer obvious because there has been a rate change
from q1 to q2 at time t1. Based on the superposition principle, the pressure drop at time t2 can be
calculated by considering two wells producing at the same location: (1) first a well producing at
a rate q1 for a period of t2, and (2) the second well produces at a rate of (q2-q1) for a period of (t2-
t1). Mathematically, this can be written as:

(2) = (1, 2) + (2 - 1, 2 - 1)                                                             9-15

Again, based on the superposition principle, the pressure change at time t3 is given by:

(3) = (1, 3) + (2 - 1, 3 - 1) + (3 - 2, 3 - 2)                                            9-16

                                                                                          135
                                      Superposition principle and pressure buildup test analysis

Example 9-3. The pressure profile for a well producing at a rate q=500 STB/day is given in the
figure below.

             pi-pwf, psia  1300
                           1250
                           1200       50  100 150 200 250 300 350 400 450
                           1150                Time, hr
                           1100
                           1050
                           1000

                            950
                            900
                            850
                            800

                                   0

Calculate the pressure drop for a well producing at the following rate history after 300 hours.

q (STB/day)1000
            900
            800                       50  100  150        200  250  300
            700                                Time (hr)
            600
            500
            400
            300
            200
            100
               0
                   0

Solution:
p = p (q1, t3) + p (q2-q1, t3- t1) + p (q3-q2, t3-t2)

        =p (500 STB/day, 300 hr) + p (500 STB/day, 250 hr)+ p (-500 STB/day, 50 hr)
         =1220 + 1200 - 1050 = 1370 psi

                                                                                                                 136
                                      Petroleum Reservoir Dynamics

Example 9-4. Consider a vertical well in a faulted reservoir with set of properties below:

(a) Calculate the well bottomhole pressure after production for 1000 hours.

(b) Repeat (a) if the well rate is variable given by the figure below.

Well radius (ft)                   0.35     Viscosity (cp)                   0.5
                                            Total compressibility (1/psi)    10-5
Porosity (frac.)                   0.2      Initial pressure (psi)           5000
                                            Production rate (STB/day)        500
Thickness (ft)                     50       Distance to fault (ft)           500

Skin factor (-)                    5

Permeability (md)                  50

Oil fm. vol. factor (bbl/STB) 1.4

Rate (STB/day)  500

                            200

                     200         Time (hr)  1000

Solution:

(a) The following equation should be used:

 -  = 2  162.6 [() +  ( 2  ) - 3.23 + 0.869  + ( )]                2
                                                                             2

                     = 2  162.6  500  0.5  1.4 [(1000) +  (              50              2)

                                                                                   -5
                            50  50                                     0.2  0.5  10  0.35

                            0.869           0.35
                     - 3.23 + 2  5 + (2  500)] = 323.1 psi

Therefore:

 = 5000 - 323.1 = 4676.9 psi

                                                                                               137
        Superposition principle and pressure buildup test analysis

(b)

                                   
 -  =  (500  , 1000 ) +  (-300  , 800 )

                                 
        = 323.1 -  (300  , 800 )

where,

           
 (300  , 800 )

        = 2  162.6  300  0.5  1.4 [(800) +  (                   50       2)

                50  50                                                 -5
                                                   0.2  0.5  10  0.35

                0.869    0.35
        - 3.23 + 2  5 + (2  500)] = 191.2 psi

Therefore,  -  = 323.1 - 191.2 = 131.9 psi and  = 5000 - 131.9 = 4868.1 psi

Question 9-1. (True/False) To model the effect of a sealing fault on the pressure, the fault can be
removed, and an image well considered on other side of the fault.

Question 9-2. (True/False) Effect of skin should be also considered for the image well when
accounting for the effect of a fault.

Question 9-3. (True/False) The log-derivative value doubles when the effect of fault is fully felt.

Question 9-4. (True/False) The log-derivative value should be increased by a factor of 4 when the
well is bounded by two orthogonal faults.

9.3 Pressure buildup test analysis
9.3.1 Horner method
The production rate must remain constant for reliable drawdown test analysis. However,
attaining a constant production rate for a long period may be impractical. The simplest way to

                                                                                                                 138
                           Petroleum Reservoir Dynamics

ensure constant rate is to shut in the well after a period of production. Consequently, the rate
will be fixed at zero and well bottomhole pressure rises as shown in Figure 9-5.

25                                                                                                                  5050

                                                                                        5000
20

                                                                                        4950
Flow rate (STB/day)
15                                                                                      Bottom-hole pressure (psi)  4900

10 tp t 4850

                                                                                        4800
 5

                                                                                        4750

0                                                                                                                   4700

    0       50     100     150    200                                                                                     0  50  100        150  200

                Time (hr)                                                                                                        Time (hr)

    Figure 9-5. Rate and pressure behavior during a build-up test following a pressure drawdown period.

The superposition principle (in time) can be applied to obtain the pressure response during a
build-up test. Consider production at a constant rate for a production period  followed by shut-
in. Considering superposition in time, the shut-in pressure,  at shut-in time,  can be
obtained by:

 -  =       162.6  [log( + ) + log (         2) - 3.23 + 0.869]

                                         

            -   162.6      [log() + log (    2) - 3.23 + 0.869]                                                                                  9-17

                                         

            = 162.6 log ( + )
                                

Therefore,

  =  - 162.6 log() 9-18
                    

where the time ratio  = +  is known as Horner-time ratio. Plotting  versus  can be line-

                                                                                                                               162.6

fitted with slope () from which the permeability can be obtained by  = | | . An important

                                                                                                                                    

note the  decreases with increasing time. The skin factor can be estimated by:

                                                                                                                                                 139
       Superposition principle and pressure buildup test analysis

 = 1.151 [( = 1) -  -  ( 2  ) + 3.23] 9-19
         ||                           

This equation is derived as follows:

1. The pressure after 1 hour shut-in time is given by:

( = 1 hr) =  - 162.6 log ( + 1) 9-20
                                      1

2. The well flowing pressure at the end of production period is given by:

 =  -  162.6  [log() + log (                  2) - 3.23 + 0.869]           9-21

                                      

3. Combining the above two equations provides:

( = 1 hr) -  = 162.6 [log (  ) + log ( 2  ) - 3.23 + 0.869] 9-22
                                               + 1      

Note that  + 1  . Therefore,

( = 1 hr) -  =  162.6                 [log (       2) - 3.23 + 0.869]      9-23

                                            

4. According to this last equation, we can write:

 = 1.151 [( = 1) -  - log ( 2  ) + 3.23] 9-24
         ||                           

Note that ( = 1 hr) is sometimes denoted by p1hr which is the pressure calculated from
the Horner plot after  = 1 hr or  =  + 1.

                                                                           140
                                     Petroleum Reservoir Dynamics

           6000

           5950

           5900 p1hr

pws (psi)  5850

           5800

           5750                                                    y = -19.78ln(x) + 5999.5
           5700

           5650       10             100  1000          10000      100000  1000000 10000000
                   1

                                                tR (-)

Figure 9-6. Shut-in pressure versus Horner time ratio. Production period is 100 hr. Therefore, p1hr is evaluated at
                                                               = 101.

Example 9-5. For the data graphed versus Horner time ratio in Figure 9-6, calculate the
permeability and skin factor. The production rate is 100 STB/day, production period is 100 hours,
and the well flowing pressure at time of shut-in is 5650 psi. Porosity is 20 percent, thickness is 50
ft, and total compressibility is 1e-5/psi. Fluid formation volume factor is 1.4 bbl/STB, and viscosity
is 0.5 cp. Well radius is 0.35 ft.

Solution:

The line slope is 19.782.303=45.55 psi/log-cycle. Therefore,

     162.6  100  0.5  1.4
 = 45.55  50 = 5 mD

                      5908.2 - 5650       5
 = 1.151 [ 45.55 - log (0.2  0.5  10-5  0.352) + 3.23] = 1.44

                                                                                             141
         Superposition principle and pressure buildup test analysis

9.3.2 Identification and removal of WBS effect

Similar to drawdown test, the build-up test data can be also affected by wellbore storage. It is
essential to apply diagnostic log-log graphical approach to identify the data dominated by WBS
and that corresponding to trainset radial flow. The log-log diagnostic plot during buildup test is
similar to that during drawdown test with the following adjustments: (1) the pressure difference
is  =  - (), and (2) the time is replaced by the equivalent time,  = /( +
). In essence, these two adjustments make the radial transient flow equation identical for both
drawdown and buildup periods. To demonstrate this, first be reminded of the following equation
governing the drawdown pressure response during radial transient flow:

 -  =  162.6  [log() + log (         2) - 3.23 + 0.869]               9-25

                                

Based on the above-suggested adjustments, the following should be the equation for the buildup
pressure response during radial transient flow:

 - () =  162.6  [log() + log (                    2) - 3.23 + 0.869]  9-26

                                     

Here is the proof that this equation is correct. Note that:

 = () +  162.6  [log() + log (                    2) - 3.23 + 0.869]  9-27

                                     

Now we can use this equation to replace  in  -  = 162.6  log (+  ) . The resulting
equation is:

 - () = 162.6 [log (  ) + log ( 2  ) - 3.23 + 0.869] 9-28
                                 +                

which is the same as Eq. 9-26.

The following should be noted regarding the equivalent time, :

(1)  increases with increasing time while  decreases with increasing time.

(2)  <  implying that the pressure change  - () at any given elapsed time during
the buildup period is smaller than the pressure change  - at the same elapsed time during
the drawdown.

                                                                                                                 142
                                        Petroleum Reservoir Dynamics

(3) At early-time,    which means that buildup and drawdown pressure changes are almost
identical at same elapsed time.

(4) At the limit when   , we get   . Therefore, the buildup pressure change () -
() becomes equal to  - (). In other words, the buildup pressure approaches the
initial pressure after long shut-in time.

From Eq. 9-17, it is clear that the intercept of Horner graph is the initial pressure. However, this
is only the case if the flow remains transient during production period. If the transient flow
terminates during the production and boundary effects are reached, the intercept is not the
initial pressure nor the average drainage-area pressure. The intercept is referred to as  which
is used along with other methods to estimate the average pressure.

Example 9-6. The properties below along with Horner and log-log diagnostic plots are given for
a pressure buildup test. Calculate the reservoir permeability and well skin factor.

rw 0.35 ft
 0.18 fraction
h 30 ft
B 1.1 bbl/STB
 0.5 cp
ct 10-5 1/psi
pi 4000 psi
q 500 STB/day
tp 200 hr
pwf (tp) 3766.3 psi

Solution: The equivalent time at which the zero-slope radial flow response begins on the
diagnostic plot can be safely chosen as 1 hr. Therefore:
 =  = 200 = 200

       1
Therefore, the data prior to <200 should be line-fitted on the Horner plot. Accordingly, the
slope is: m= 12.96*2.303=29.85 psi/log-cycle. Therefore:

                                                                                                                 143
                                    Superposition principle and pressure buildup test analysis

162.6 162.6  500  0.5  1.1
 = || =                                                    = 49.94 mD
                                          29.85  30

1 from Horner plot at  =  + 1 = 201 gives:

1 = -12.96  ln(201) + 4000 = 3931.3 psi

Therefore:

 = 1.151 (1 -  - log ( 2  ) + 3.23)
                                    ||           

                                  = 1.151 (  3931.3 - 3766.314             49.94
                                                                - log (0.18  0.5  10-5  0.352) + 3.23)
                                                 29.85

                                  = 0.12

                            1000

p and log-derivative (psi)  100

                            10

                            1

                            0.0001        0.001      0.01       0.1        1                    10      100

                                                                teff (hr)

                                                                                                        144
           4000           Petroleum Reservoir Dynamics
           3950
           3900                   y = -12.96ln(x) + 4000
           3850
pws (psi)  3800
           3750
                      10  100  1000               10000   100000  1000000
                   1

                               Horner time ratio

                                                                  145
                             Superposition principle and pressure buildup test analysis

9.4 Chapter Problems

Problem 9-1. The figure below shows the pressure drop at a well producing at a rate of 200
STB/day.

pi-pwf, psia  2900
              2800
              2700           50  100  150  200  250        300  350  400                 450  500
              2600
              2500
              2400
              2300
              2200
              2100
              2000

                      0

                                                Time, hr

(a) calculate the pressure drop at the end of the production considering the rate history below.

             700

             600

             500

q (STB/day)  400

             300

             200

             100

              0

                  0      50      100  150  200  250        300  350  400                 450  500

                                                Time (hr)

(b) What would be the pressure drop if the final rate in the rate history of part (a) is 200 STB/day
(instead of 600 STB/day)?

(c) What would be the pressure drop if the final rate in the rate history of part (a) is 100 STB/day
(instead of 600 STB/day)?

                                                                                                                 146
                                        Petroleum Reservoir Dynamics

Problem 9-2. The pressure drawdown test data below are given. The well has been producing at
a rate of 600 STB/day from a 10-ft thick oil reservoir. The reservoir porosity and total
compressibility are 20 percent and 1.3510-5/psi. Well radius is 0.35 ft. The oil formation volume
factor is 1.5 bbl/STB and oil viscosity is 0.8 cp.

(a) Is the test data affected by wellbore storage? Support your answer with reason.

(b) Is there any indication that the reservoir includes a sealing fault? Why? At what time range
the reservoir shows the effect of fault.

(c) At what time range the reservoir shows the initial radial transient flow?

(d) Calculate the reservoir permeability and skin factor.

(e) Calculate the well distance from the fault.

10000

p and log-derivative (psi)1000

                            100

                            10

                            1

                            0.0001  0.001  0.01  0.1  1          10  100  1000  10000

                                                      Time (hr)

                                                                                147
                   Superposition principle and pressure buildup test analysis

6000

5500

5000

pwf (psi)4500

         4000

                                        y = -51.67ln(x) + 3851.8

         3500

                                                                  y = -100.5ln(x) + 4092.7

3000

           0.0001  0.001  0.01  0.1  Time (hr)1 10  100                        1000  10000

                                                                                            148
                   Petroleum Reservoir Dynamics

Appendix A. Transient (infinite-acting) radial flow solution of the
    diffusivity equation

In dimensional form, we need to solve:
1   1 
  ( ) =  

Subject to:

Initial condition:  =  at  = 0

First boundary condition:  =  at   

Second boundary condition:  = 2  | at   0
                                         

The governing diffusivity equation and corresponding initial and boundary conditions can be
written in dimensionless form:

1  ( ) = 
   

 = 0 @  = 0

 = 0 @   

  = -1 @   0
   

where,  = 2 ( - ),  = 2 ,  =  . In order to solve the above partial differential
                                        

equation (PDE) system, the following similarity variable can be defined:

 = 2                                    2
     4         =,
                                         
                                        =- 2
                2                       4

 =   =  
   2 

 =   = -2 
   4 

                                                                          149
   Appendix A. Transient (infinite-acting) radial flow solution of the diffusivity equation

1       -2 
   (        )= 2
  2  4 

1  (2 )  = - 
     

1  2  ( ) = - 
 2    

 ( ) = - 
            

The initial condition and the first boundary condition - in terms of x - become:

 = 0 at   

And, the second boundary becomes:

  = -1 at   0
   

    =    = 2  = -1
             2    

   = - 1 at   0
         2

In summary, the original PDE turns into the following ordinary differential equation (ODE):

 ( ) = - 
            

 = 0 at   

  = - 1 at   0
      2

Solution of this ODE is obtained by:

 ( )
       = -

    
   
 ( ) = - + 0

       
                                                                                                                 150
                              Petroleum Reservoir Dynamics

where c0 is the integration constant. Consequently,

  = -
   

The constant c can be obtained using the following condition:

  = - 1 at   0   = - 1
          2                      2

Thus,

  = --
    2

Integration gives:

             1  -

0   = - 2    

          1
 = - (-)

          2

or

       1     2

              
 = -  (- )
       2     4

In dimensional form, we get:

                    2
 -  = - 4 Ei (- 4)

To evaluate the pressure at the wellbore the radius must be set at rw and effect of skin must be
accounted for:

 -  =      1                  2
                    (- Ei (- ) + )
          2 2                 4

                                                               151
                   Appendix B. Effect of wellbore storage

Appendix B. Effect of wellbore storage

Assume a wellbore (with Vwb volume) initially filled with dry gas. The pressure drop can be related
to the flow rates at the surface and sandface by:

 = -1 ( - )
         24 /

Introducing the wellbore storage coefficient  = , and noticing that at early time,  
0, we can write:
/ = - 

                  24
Therefore,
 =  -  =  

                      24
while,
 = 
  24
Consequently, the logarithmic pressure derivative is:
  =   =  
()  24

The interesting observation from the equations above is that:
 =  =  

       () 24

Consequently,

log() = log (  ) = log () + log ()
               ()  24

This last equation indicates that plotting  and  jointly versus time on a log-log graph

                                                                                        ()

should show unit-slope overlapping graphs during the WBS-dominated flow period. This is exactly
the way the WBS-dominated data are identified and eliminated.

                                                               152
                                        Petroleum Reservoir Dynamics

Questions answers

Chapter 1
1-1. b and c. Fracture treatment design is mainly the responsibility of a completion engineer since
it is about the amounts of stimulation fluids and proppants needed, pumping schedule, etc. Well
planning is drilling engineer's responsibility and is about the selection and depths of setting the
casings.
1-2. c
1-3. c. Reservoir rock may outcrop at the surface.

Chapter 2
2-1. No. Filling a room with soccer balls or tennis balls would essentially give identical ratio of the
pore volume to bulk (room) volume.
2-2. No. The porosity would be larger for larger average grain size rock.
2-3.  = 3.14  10-6 10-10 = 3.14  10-4   =   = 3.14  10-4  12.5  10-12 =
3.925  10-15 m2  4 
2-4. Zero. No fluid can flow in that direction and therefore the permeability is zero.
2-5. Permeability is doubled.
2-6. True.
2-7. 2 = 10-12   = 8  3  10-12/0.25  10-5 m = 10 m

         8

2-8. Interstitial
2-9. Grain size (Dp) because it varies over widest range while raised to power 2.
2-10. Increases 4x
2-11. 10.1
2-12. False
2-13. D

                                                                                                                 153
            Questions answers

2-14. False, flow is no longer Darcy flow when Reynolds number exceeds 1.

2-15. True

2-16. True

2-17. 25 mD. Note that the absolute permeability ( =                                                      ) is identical regardless of the

                                                                                                    (1+)

average pressure. Therefore,  45 =  35 .

                                                   1+0.5 1+1

Therefore, b=0.4 atm. Using the apparent permeability at 1 atm which is 35 mD, we can now
obtain:  = 35 = 25 mD.

                     1+0.4

2-18. True
2-19. True
2-20. False
2-21. False. The flow is from low to high permeability (from fine to coarse beadpack) because the
flow lines get longer in the second medium.

Chapter 3

3-1. False
3-2. True
3-3. True
3-4. True
3-5. False
3-6. False
3-7. False
3-8. True
3-9. True
3-10. True

                                                                                                                 154
             Petroleum Reservoir Dynamics

3-11. False
3-12. True
3-13. False
3-14. True
3-15. e
3-16. b
3-17. c
3-18. True
3-19. -5.5
3-20. True
3-21. 4

Chapter 4
4-1. True
4-2. True
4-3. False
4-4. True
4-5. c
4-6. d
4-7. c
4-8. False
4-9. c

                                           155
                                               Questions answers

Chapter 5
5-1. No
5-2. 50/62.4=0.8
5-3. 50*10000/144=3465 psi or 0.433*0.8*10000=3465
5-4. 5*10000/144=346.5 psi

Chapter 6
6-1. False. For a given time, radius of investigation is where the peak pressure change is felt in
response to an impulse production.
6-2. True.
6-3. False. The pressure change depends on the rate.

Chapter 7
7-1. False
7-2. False
7-3. True
7-4. True
7-5. True
7-6. True
7-7. True
7-8. True
7-9. True
7-10. SS, PSS
7-11. Solid, dotted

                                                                                                                 156
                     Petroleum Reservoir Dynamics

7-12. For a circular area,  = 2. Replacement in the above equation while equating to the
circular area equation, we get:

 1 42                                    3
(  (  2) + ) =         ( ( ) - + )
2 2                  2  4

Simplifying and rearranging gives CA=31.6 for a circular drainage area.

7-13. Circle

7-14. A square with well in the center

7-15. True. Be reminded that  -  = -  . Therefore, doubling the area while the rate is
doubled does not affect the  -  difference nor .

7-16. False. In the previous question, we learned that  remains unchanged. The relationship
between  and  is given by:

               1  4
 -  =         (  (  2) + )
              2 2  

Doubling A and q increases  - . Therefore,  is going to be lower for the right figure.

Chapter 8
8-1. False
8-2. True
8-3. True
8-4. True
8-5. False
8-6. True
8-7. A
8-8. A
8-9. True

                                                                                                                 157
            Questions answers

8-10. True
8-11. True

Chapter 9

9-1. True

9-2. False. Because the actual well is not within the damage zone of the image well.

9-3. True. This is mathematically shown in the equations. In essence, it is because we have total
of two wells (the actual well and the image well) affecting the pressure drop.

9-4. True. This is because there will be 3 image wells when two orthogonal faults exist.
Consequently, the total number of wells is 4 and therefore, the value of log-derivative would be
quadrupled.

                               158
                                        Petroleum Reservoir Dynamics

References

Amyx, James, Bass, Dantel, and Whiting, Robert L. 1960. Petroleum reservoir engineering physical
         properties.

Economides, Michael J, Hill, A. D., Ehlig-Economides, C. et al. 2013. Petroleum production systems:
         Pearson Education.

Freeze, R Allan and Cherry, John A. 1979. Groundwater.
Li, Dang and Chen, Junbin. 2021. Unsteady Percolation of Slightly Compressible Fluid. In Mechanics of Oil

         and Gas Flow in Porous Media, ed. Dang Li and Junbin Chen, 125-162. Singapore: Springer
         Singapore.
Louis, L., Baud, P., Wong, T.-F. et al. 2007. Characterization of pore-space heterogeneity in sandstone by
         X-ray computed tomography. In Rock Physics and Geomechanics in the Study of Reservoirs and
         Repositories, Vol. 284, 0. Geological Society of London.
Roti, ystein and Dawe, Richard A. 1993. Modelling fluid flow in cross-bedded sections. Transp Porous
         Media 12 (2): 143-159.
Spivey, John P. and Lee, W. John 2013. Applied Well Test Interpretation, Vol. 13: SPE Textbook Series.
Wattenbarger, R. A. . 2009. Gas properties calculator (Reprint).
         https://drive.google.com/file/d/1dm8oSUOdvywO5kDoUCGbDuyof3UqyM-i/view?usp=sharing.

                                                                                                                 159
