                                             Thomas sauTer
                                             marco albrechT

INTRODUCTION
      TO SYSTEMS
           BIOLOGY

          Workbook for
    Flipped-Classroom

                  Teaching
INTRODUCTION TO SYSTEMS BIOLOGY
INTRODUCTION TO SYSTEMS BIOLOGY
Workbook for Flipped-Classroom Teaching

           Thomas Sauter and Marco Albrecht
                                              https://www.openbookpublishers.com

   2023 Thomas Sauter and Marco Albrecht

  This work is licensed under a Creative Commons Attribution-NonCommercial (CC BY-NC) license. This
  license allows you to share, copy, distribute, and transmit the work providing you do not modify the
  work, you do not use the work for commercial purposes, you attribute the work to the authors, and you
  provide a link to the license. Attribution should not in any way suggest that the authors endorse you or
  your use of the work and should include the following information:

Thomas Sauter and Marco Albrecht, Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching.
Cambridge, UK: Open Book Publishers, 2023, https://doi.org/ 10.11647/OBP.0291

  Copyright and permissions for the reuse of many of the images included in this publication differ from
  the above. This information is provided in the captions and in the list of illustrations.

  Further details about CC licenses are available at http://creativecommons.org/licenses/by/4.0/

  All external links were active at the time of publication unless otherwise stated and have been archived
  via the Internet Archive Wayback Machine at https://archive.org/web

  Digital material and resources associated with this volume are available at https://doi.org/
  10.11647/OBP.0291#resources

  Every effort has been made to identify and contact copyright holders and any omission or error will be
  corrected if notification is made to the publisher.
  ISBN Paperback: 978-1-80064-410-6
  ISBN Hardback: 978-1-80064-411-3
  ISBN Digital (PDF): 978-1-80064-412-0
  DOI: 10.11647/OBP.0291

  Cover image: Photo by Vlado Paunovic on Unsplash at https://unsplash.com/photos/LfsXOnS41dg
  Cover design by Anna Gatti
Preface

The content of this book was developed over more than 15 years of teaching the course
"Introduction to Systems Biology", first at the University of Stuttgart and then mainly at
the University of Luxembourg. This course aims to introduce key mathematical concepts
of systems biology to students with mainly biology backgrounds. Easily accessible toy
examples are used to illustrate these concepts in a straightforward way. Some of these
examples, as well as some of the ideas in the book, come from colleagues, whom we
would like to thank very much for sharing their work.

         Over the years, the course style changed from traditional classroom
teachingwith lectures on the concepts and demonstrations of exercise solutionsto
more self-paced and interactive learning using the flipped-classroom method (see the
Introduction of this book). This usually consisted of a short kick-off lecture emphasizing
the key concepts briefly and answering some general questions of the class. The
remainder of the day was then organized into flexible group work in class with the
support of tutors, and independent study time (usually in the afternoons). This allowed
the students to progress at their own pace and to support each other. Final exam results
improved by around 2 points on a scale of 20 as a result of this new method.

         The course was complemented with talks about current research questions and
examples of the lab or the field in general. These talks were either given by me (Thomas
Sauter) or by the assisting postdoctoral and PhD students. Within the curriculum of the
Master's in Integrated Systems Biology at the University of Luxembourg, this course was
followed by 2 practical computational courses, where the students applied the introduced
mathematical concepts to self-designed and self-executed projects. These project-based
learning courses focused on metabolic network modelling using constraint-based
modelling (see Chapter 2 of this book) and on pharmacokinetic (PK) modelling using
ordinary differential equations (see Chapter 3 of this book). The structure of these
courses, along with some illustrative example projects, is detailed in the article "Project-
Based Learning Course on Metabolic Network Modelling in Computational Systems
Biology" (Sauter et al., 2022)1. The combination of studying the theory at one's own pace
and applying it to self-designed projects has proven to be an effective way of learning.

1 PLoS Comput Biol 2022 Jan 27; 18(1):e1009711, https://doi.org/10.1371/journal.pcbi.1009711.

 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0  https://doi.org/10.11647/OBP.0291.05
         Suggestions and corrections are very welcome (by email to: thomas.sauter@uni.lu)
and will be considered for the next edition of this book.

         On a personal note, I would like to take this opportunity to express my
thankfulness to my parentsyour love and hard work have laid the foundation for my
careerand to my family: Sabine, it is so precious to have you by my side. Josephine, it
is great to see you growing up and shining. And Leonard, I am grateful for our days
together. You were the first to see this book.

Thomas Sauter, Nittel & Belval, October 2022
                    Acknowledgments

The authors would like to thank several people for their contribution and support, in
particular:

          Prof. Dr.-Ing. Herbert Wehlan, Institute for System Dynamics, University
                  of Stuttgart, Germany

          Dr.-Ing. Michael Ederer
          Prof. Dr.-Ing. Andreas Kremling, Technical University of Munich, Germany
          Dr.-Ing. Steffen Klamt, Max Planck Institute for Dynamics of Complex

                  Technical Systems, Magdeburg, Germany
          Ass.-Prof. Dr.-Ing. Steffen Waldherr, University of Vienna, Austria
          Dr. Giulia Cesi, Department of Life Sciences and Medicine, University of

                  Luxembourg
          Dr. Maria Pires Pacheco, Department of Life Sciences and Medicine,

                  University of Luxembourg
          Apurva Badkas, Department of Life Sciences and Medicine, University of

                  Luxembourg
          All MISB and IMBM students who went over the course materials over the

                  last few years.
Introduction

Thomas Sauter, Marco Albrecht

  Motivation
  In this book, you will learn how mathematical models of biological networks are built and how the analysis of
  such models help to understand the system-level properties of networks. The book will introduce you to the
  language of systems biology which needs to be spoken among biologists, physicists, computer scientists, and
  engineers in the interdisciplinary research environment of bio-medicine. Science is about what is; Engineering
  is about what can be. Combining both will enrich your profile as an academic and enrich your view of the
  world around us. We are on the brink of the era of network medicine. This novel approach has the potential to
  revolutionize and personalize the treatment of patients. This book focuses on some of the fundamental concepts
  which are essential to developing successful network medicine approaches in the upcoming years. We hope you
  enjoy reading this book as much as we enjoyed writing it.

  Keywords
  Systems biology -- Flipped-classroom teaching

 Contact: thomas.sauter@uni.lu. Licence: CC BY-NC

                   Contents                             network-based drug discovery, with applications mainly
                                                        in cancer biology. He has more than 20 years of experi-
1 Authors                    1                          ence in educating and supporting students.

2 Overview                   1                              Marco Albrecht is an engineer,
                                                        trained in system theory, control
3 Planning                   2                          engineering, modeling, and molec-
                                                        ular biology. He studied bio-
4 Learning                   3                          systems engineering at the Otto-
                                                        von-Guericke University in Magde-
5 Learning checklist         8                          burg and did a PhD at the Uni-
                                                        versity of Luxembourg on "Math-
6 Further reading            11                         ematical histopathology and sys-
                                                        tems pharmacology of melanoma" in the context of the
References                   11                         MELPLEX ITN training program supported by the Eu-
                                                        ropean HORIZON 2020. He is now a research scientist
                       1. Authors                       at esqLABS GmbH, Germany, with expertise in Quanti-
                                                        tative Systems Pharmacology.
Thomas Sauter has been pro-
fessor for Systems Biology                                                    2. Overview
and study director of the
Master in Integrated Sys-                               Complex systems can be found in many fields, and re-
tems Biology and the In-                                searchers in biology take ever more advantage of this
ternational Master in Bio-                              and related concepts shown in Figure 1. The concepts are
Medicine at the University                              now reaching the realm of medicine and also raise sev-
of Luxembourg since 2008.                               eral challenges for data integration. We suggest reading
He studied Technical Biol-                              the paper on systems medicine [1] which is summarized
ogy at the University of                                in Figure 2. Some of these concepts will be explained in
Stuttgart and at the Max Planck Institute for Dynamics  this book "Introduction to Systems Biology".
of Complex Technical Systems in Magdeburg, Germany.
He received a PhD in Engineering for modeling of the        Many computational courses rely on linear algebra
metabolism of Escherichia coli. His research group de-  and other mathematical concepts. Consequently, it will
velops tools for molecular network reconstruction and   be very important to pay sufficient attention to these
                                                        mathematical basics. We incorporated a good share of
 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0
                                                                                                https://doi.org/10.11647/OBP.0291.06
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  2/14

Figure 1. Complex systems organizational map. Created by H. Sayama, Collective Dynamics of Complex Systems
Research Group at Binghamton University, New York. Wikimedia. Licence: CC BY 4.0.

it in this book, as you will see in the following chapters.   Course aims (what):
But first we would like to make some remarks about
the design of the book and the respective course on "In-           Gain confidence in the step-wise calculation of
troduction to Systems Biology". We therefore review                  mathematical problems.
the research evidence for effective learning and reveal
pitfalls which might emerge within an interdisciplinary            Connect mathematical concepts to biological real-
study program. We also give you lists with small and                 world problems.
prioritized learning units, which you can tick off step by
step. This book contains several links to YouTube videos.          Enable efficient communication between biology
Check them out by clicking on the link:                              and computational disciplines.
YouTube: Systems Thinking
                                                              Course goals (how):
                      3. Planning
                                                                   We demonstrate the step-wise calculation in this
We divided this course into four parts with increasing               book and with the help of YouTube videos.
levels of modeling detail, shown in Figure 3.
                                                                   We connect theoretical approaches with real-world
    The detailed content is specified in the learning check-         biology.
list on page 8. Here, we give here a rough overview of
what we want to achieve.                                           We explain the geometrical intuition behind math-
                                                                     ematical operations.
                                                                                                             Whither systems medicine?                     Introduction -- 3/14
                                                                                                             R Apweiler et al
                                                                                                                                                                                             3
Personalization                                                                                                                                         Generalization

Patient                                        Physician                                                          Principles            Clinical Trial   Systems Biology
                                                                                                                Mechanisms
                          Therapeutic                     Diagnosis                                          Explanation                in vivo model       Network & PKPD
                            Decision                      Prognosis                                                                         in vitro    Modelling & Simulation
                                                                                                                                            model
                                                                                                                                                         Molecular & Cell
                                                                                                                                                               Biology

                                                                                                                                        Mechanistic evidence

                                                               Systems Medicine

                          Conventional Analysis

Patient                                                                                                      Causal inference
 Data

                          Clinical                             Indication                                    Justification                               Biostatistics
                           Data                                                                                 Stratification                          Epidemiology
                                                                                                                                        Population
                                    Molecular                                                                  Classification            Cohorts              Data
                                       Data                                                                                             Subgroup         Management

                                               Bioinformatics                                                                                              Medical
                                                                                                                                                         Informatics

Integration                                                                                                                                                   Delineation

Figure 2Fi.guSrye s1teSmysstemmsemdeidciicninee:aBs raonwinnte:grcaotivnevaepnprtoiaocnh,acloampbpinrinogatcehch.nGolorgeieesn, :dadtaa,tmaeftlhoowdo.loBgileus ea:ndinefxoperrmtisea.tiBoronwnfl:oCwon.veSnotiuonracle: [1].
Licencaen:aClysCis oBfYpa4ti.e0n.t data. Green: Data flow. Blue: Information flow, linked to the disciplinary expertise involved.

         DATA AVAILABILITY, ACCOUNTABILITY, QUALITY,                                                         Likewise, benchmark data sets need to be developed and made
         ANALYSIS, INTEGRATION AND INTERPRETATION
                                                                                                             advaila0bl.e8in: ostpreonnsgouercffeescotftware.
This book has been developed for a full-time two-week
                                                                                                             `MACROSCOPES' TO EXPLAIN PRINCIPLES OF TISSUE
         The more data sources are connected to a patient, the more
                                                                                                             OwRiGthANthIZeAhTiInOtNthat even minor effects can become relevant
coursedfaotallopwroivnenganthcee ifsliopfpkeedy-cinltaesrsesrto. oNmot aapllpdraotaacshouwrchesicchan        Oinnecogomalboifnsaytsiteomnswmietdhicointehiesrtso. explain the emergence and
we wilpl rionvtirdoe dthuecheigihnestthdeatnaeqxutalsiteyc. tTihoenre. is always a trade off on
                                                                                                             progression of disease phenotypes with the help of molecular,
         how much effort (and time) can be put into capturing data and
                                                                                                             cellular, physiological and environmental data. We are dealing
       how high the da4t.a Lqueaalitrynhiansgto fulfill its purpose. For
                                                                                                             wSiethlfa-emffuicltailceyvebl eanlidefmaunltdiscraelge usylsatteimon. Doifseeafsfeos rotccur across a
         example, clinical documentation, primarily used for capturing
                                                                                                             wide range of interlinked temporal and spatial scales (from the
The fotlhloewraitniognailne soifgahctesrtcaoinmtreeaftrmoemnt, emdiughctabteiolensas lreslteuvadnitefsor
[2]. Sorceisaelarscchienthtainstsrcepoomrtps afrreombetcwlineiecanl-gtrrioalus.p Ldikifefweirseen, cdeasta   The most effective attitude is the self-efficacy belief (d =
and wictohllienct-egdrforoumpedleicftfreorneicnpcaetsienwt irtehcotrhdsewmilleianseuvirtaeblCy ochonentasin
                                                                                                             seconds and minutes of molecular reactions to the weeks and
         a lot of `noise' and have to be cleaned before being used for
                                                                                                             1.81). Accordingly, we have organized the course in a
d. A Cohens d = 0.5 means that the difference between
                                                                                                             years during which diseases progress). By focusing on well-
         research purposes.
                                                                                                             dwefianyetdhacltineincasluqrueesstyioonus,hiat vise tphosesimbleosttofldeexveibloiplitcyonintextat-ckling
groups isDhataalfprtohveendainfcfeereemnbcreacwesithhigihn qguraoliutypdsa.taSosocuiarcless.ciSetann--       stpheecifipcromboledmels,s ownhiychouarreownont, agennderiwc,ebwutillntervyertthoelsesuspport
tists indtearrdpsrfeotrddaatsa fporlolvoewnasn:ce like `W3C Prov' (https://www.w3.                           pyroeduic. tiW ve.eInhaevcoelotgryi,edphytosicgs,ivmeetceoleroalrogoybajnedctievnegisn,eeprirnigoritize
                                                                                                             wthe ealdreiafdfeyrerenlyt teanstikreslyaonnd porepdtiicmtiviezemtohdeelscofour rdseecissitornucture
         org/TR/prov-overview/) can be very helpful, but are rarely used                                     mtoakhineglpanydouundperrsotagnrdeinsgs ofaf sutndweriltyhinoguctaulosaslimngechtiamnisem. s.These
                                                                                                             Dpersepcitaeutthieocnhsalalelnsgoescopomsepdlbeymbeionlotgyicoaul croambpilleitxyityt,oadrveagnucelas te the
d  0.2 : small effect                                                                                        ienffhoigrht-bthyroyuoghuprustetlefc(hdno=log0ie.7s 5a)n.dYdoatuarinpteogsriattiiovne pernoevirdgey and
                                                                                                             twreimlleinndgonusesosptpoormtunaistiteesr ftohr isdaatam-dbriivteinoums ocdoeulinrgs,e wwhiicllhmake
         by the biomedical community yet. There is already consider-                                         hthavee byiegt gteostbeimrepaaliczetdb.2e0,y21onTdo aunnydetrhsitanngd wtheeceamnedrgoen. cPea, ssing
                                                                                                             pthroigsrecsosiuonrsaengdivpreesveynotiuonaogf rdeiasetasfeese, lwinegmoufstacmcaokme ipnlfiesr-hment
d  0.5ab:leminevdesitummenet fifnetcot IT solutions for improved data prove-
                                                                                                             ences across multiple levels of structural and functional
         nance. However, medical informatics, without a systems
         medicine approach, is like building a house without the                                             and a new view of biology. With the right practice and
         instaPllaarttio1n of switches to turn the light on.PTarhte2 need of data
         ansatelyasdiys,stiantteegration and interpretation, as swteealdl yastathtee construc-               organization (for example, from molecules to cells and organs,
         tnieotnwoorfk rmeopdreolsducible workflows and valimdeataebdolmic netehtwoodrokslogies, is
         inlicnreeaarsailngegbrawith data diversity, genersatoteicdhiobmyetraicnmaetxripxanding              the belief that you can make the most difference, you
         arsenal of technologies. There still is a big gap in the availability
         of methods and software tools to perform such sophisticated                                         from molecular reactions to tissue physiology, from molecules
         analysis. Methods that allow analysis of high-dimensional data
         sets and multi-scale data integration have to be developed.                                         thoaMveRIthsceankse)y. Htoowsuthcicsecsasninbeyaocuhirevoewd ninhaarnadtiosn. aTl hanisd effect
                                                                                                             psriazceticiasl vweayr,yresmtraoinnsgananopdencoscmienpteifincscahtaellsenfgoer. differences in
          Part 4                                            Part 3                                           talent, intelligence, and unchangeable traits to a large
nonlinear reaction terms                                                                                     extent. Personality, intelligence, gEexpnerdimeern,tatli&mMeoloecfuylaer aMredaicninde
                                               dynamic change of the system                                  working hours (for an office-based job) are altogether
    quantity calculus                                      elements                                          minor effects (-0.24 < d < 0.32). Intelligence explains
        bioreactor                                                                                           4% of the exam results. Joy, pride, and hope (-0.24 <
                                                       systems science                                       d < 0.32) are more productive attitudes than anger, fear,
     enzyme kinetics                                  control, hysteresis                                    and charm (-0.8 < d < -0.28).

Figure 3. Advance organizer of this book.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching               PRACTICE
                                                                                   4/14 Integrating

Effective practice in an interdisciplinary environment             Do not underestimate the amount of effort required               AQUIRE
                                                               to learn mathematics. Concepts make up around 20-30%
The success of teaching various learning strategies de-
clines from elementary school (d = 0.92) to university         of your learning time and 70-80% of your time will be                Component
(d = 0.28), which can be explained by the supposition          necessarily devoted to solving equations and tasks on                    skills
that students learn which strategy is best for achieving       your own. This can be best compared with your lab
results over time. However, learning strategies are highly     work. The more you can automatize isolated tasks like
subject dependent and can hardly ever be transferred to
other disciplines. Studying concepts in biology requires       media preparation and pipetting, the more capacity is
the memorization of many facts to achieve a sufficient
knowledge base. A huge amount of initially unrelated           free to solve more comprehensive and complex working
facts have to be learnt in order to interpret new obser-
vations, design experiments, and understand relation-          schedules in the lab. Time set aside for practice is im-
ships. Mathematics and engineering, however, require
the memorization of a few and simple basic concepts            portant (see Figure 4). In the beginning, you will work
with which they construct their theories. Only axioms
and basic equations must be learned. The challenge is to       through several subparts of a task, but one individual
apply those concepts to different cases and tasks. Some
tasks seem simple but can be unsolvable problems, while        subtask might still limiting your overall performance.
other, seemingly more complicated equation sets, can
turn out to be easy. Getting a feeling for the underlying      This can be frustrating--for example, if one learns a new
approaches in each discipline takes time. Biologists usu-
ally have to make countless observations and deconstruct       programming language. At first, it seems unfathomable,                  Un
things in order to understand their origin. In contrast,
engineers combine different elements to build something        but you can make more progress than you think. After
up and to achieve a certain behavior. Engineers combine
problem-dependent modules of equations together to             fast. At the upper level, you will become so proficient you have reached a certain level, you will progress very co
represent desired or natural systems and their behavior.
In contrast, physicists always search for a simple underly-    that the improvements seem to slow down as they are
ing equation to help them understand nature itself. Com-
puter scientists, bio-informaticians etc structure, handle,    not recognizable anymore. At this stage, expert feedbCaocknscious
and store data by automating procedures according to
the wishes of a user without the inner motivation to           is necessary to help you recognize flaws and find cnoewmpetence
understand nature itself. A new problem can confront
computational scientists with the time-consuming need          challenges to work on.
to develop new software. Once this step is solved, the
computational running time for solving the actual prob-        Additionally, having willingness to solve the given prob-
lem might be low. Therefore, they always search for            lem with diff1erent approaches,2whatever it takes3, is a             4
pre-developed software modules and libraries. The gen-
eration of data in biology is much more incremental and        good trait to become a good computational scientist. We
steady, partly because the problems and tasks are often
unique. Thus, the general thinking and research prac-          provide you with the solutions directly to give you more
tices of different scientists can contrast. Synthetic biology
is a sub-discipline of biology which resembles the think-                                     Conscious
ing in engineering the most. To engineers, it might be
helpful to say that they have to solve a so-called inverse     responsibility, but do not look at the solution immediately-
problem, which is the most frequent problem biologists
face. This is a very sharp separation of different think-      only if you get stuck for a long timei.nYcooumhapvee ttoeinmcperove
ing schools, and you will see that scientists can have a
mixture of those approaches but it might help to recog-        your skills, not just your knowledge. One also has to
nize problems of misunderstanding. Neither of these
is wrong, nor better than the other. The problems they         frequently chanUgenbceotwnesecniostuudsying concepts and prac-
tackle have simply moulded their way of thinking to the
optimal mode for the discipline, which would probably          ticing in order tionpcroogmrepsse. tSeonmceeformulations might be
fail if applied to another area.
                                                               circuitous at first glimpse, but become more understand-

                                                               able after solving tasks. But don't worry, the purpose of

                                                               this course is an introduction to computational problem-

                                                               solving and many difficulties remain even in physics,

                                                               mathematics, and engineering schools, where years are

                                                               dedicated to solving such tasks. Much of what you learn

                                                                             late

                                                               performanc e                      mid

                                                                              early

                                                                                time practicing

                                                               Figure 4. Performance gain in complex tasks can seem
                                                               nonlinear. When too many uncertainties in subtasks
                                                               hamper overall performance, sufficient practice time ac-
                                                               celerates performance until it flattens down again. Do
                                                               not give up too quickly. You never know when you will
                                                               skyrocket. Source: [3]. Copyright  2010, John Wiley
                                                               and Sons.
                                                               Introduction -- 5/14

in the course is comparable with learning a sequence of        ple to explain the issue to each other. More or fewer
activities not far from following a cooking recipe. You        students than this is ineffective. Group members should
will manage it! Because we integrate active learning           have more or less the same ability level. Share insights,
sessions, we will likely reduce the failure rate. Tradi-       knowledge, and understanding of theories, formulas,
tional lecturing would increase the failure rate by 55%        and equations. Collaborative learning is beneficial, and
in science, engineering, and mathematics [4].                  you do not stand in competition with each other. How-
                                                               ever, do the work by yourself first to figure out how to
How to study engineering, math, and physics                    get started. In groups, some students might be very fast,
                                                               and then you do not learn how to tackle engineering
We have some tips for studying courses with many equa-         problems on your own. Moreover, never end a group
tions. Our book will be somewhat between a classical           meeting when one member has still not understood the
biology and typical engineering text.                          issue. This is a great opportunity to learn and solidify
                                                               your knowledge by teaching. Find ways to achieve under-
About understanding and learning                               standing. Maybe one has to figure out gaps in previous
                                                               knowledge and then explain this. Each student should
It is quite favorable to tackle the material before the lec-   explain at the end what the problem was and how the
ture. Concepts in mathematics, engineering, and physics        solution has been obtained.
are more or less always the same and do not change as
fast as some concepts in biology. They are also not as         Be flexible and chill a bit
comprehensive as in biology. But they are not so eas-
ily accessible, because mathematical terms are made up         The general recommended sequence is:
of highly compressed knowledge. Lecturers in biology
more often use PowerPoint presentations to transmit               1. Read lecture notes
the knowledge, while lecturers in engineering use the             2. Read books
blackboard to slow the knowledge transfer down. It is             3. Understand sample questions
essential to see how things evolve. It will also be on an         4. Do the homework
entirely different level than what you are used to from
high school. In an engineering class, you have to plan         Well, not many engineering students do this. Go jovially
more time for digesting and understanding the material         through the script and if you get stuck for more than
before moving on to new topics. Most engineering stu-          5 minutes, just go on. Forcing yourself to go through
dents prefer to see the concepts first in order to be able to  the script and trying to understand everything step for
better follow the lecture content. Engineering students        step has disadvantages. You might read too much, sleep
spend hours trying to understand the material at home.         away, and at the end the questions still confuse you--and
You will also need weeks and months of occasional re-          time runs out. A better strategy might be to first read
visiting until the material is sufficiently digested. This is  the questions in the exercise and try to solve them.
the reason for the late final exam. Understanding is the
biggest problem, and after you understand the material,           1. Go through lecture notes calmly
you have to learn little by heart. Remember, you learn a          2. Look at the exercise questions and look at what
lot in biology, and then you understand it. You have to
understand and practice a lot in engineering, and then                you can solve already
you learn a bit by heart.                                         3. Understand sample questions in the manuscript
                                                                  4. Understand the manuscript explanations and search
Problem-solving
                                                                      out textbooks
The major time-consumer will be problem-solving. You              5. Iterate! Go back and forth
will be confronted with many tasks and problems. The              6. At the end, try to understand everything including
more problems you solve, the better you will understand
how to apply the information you have learnt and the                  the manuscript
better your grade will be. Solve the tasks we have given
you! If that is not sufficient, search for more tasks in       If you do tasks at an earlier point in this sequence, you
textbooks. Also solve the problems set out in past ex-         will get stuck for sure. One expects this without under-
ams. It is important not to give up and to embrace the         standing the lecture notes. But now, you have a question
intellectual challenge. Try as many methods and strate-        in mind, and it will be easier for you to understand the
gies as possible and always look for possible calculation      lecture notes. After you have tried the examples, look at
mistakes or typos. Messing up the minus-sign and plus-         the sample questions, and if you struggle there, look at
sign is quite common. Only if you get completely stuck         the lecture notes and books. Only at the end, and when
and consultation of the theory no longer helps, then you       you have tried everything, look at the solutions. Wait
should look up the solution.                                   at least one day before you look up solutions. What we
                                                               want to say is that you will have to use an iterative work-
Study groups                                                   ing style between example questions and theory. Do not
                                                               be too strict and harsh with yourself. But of course, in the
Everyone has times when they get stuck, and the desire         end, you should understand everything, the complete
to give up is strong. Establish study groups of 3-5 peo-       handout. Also read textbooks or related papers to get
                                                               a consistent view on the issues and connect new knowl-
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  6/14

edge with old. This will help you later in the following           column (2/3) is used for your notes as usual. At the
courses and your career, in a way that only looking up             bottom of your sheet is a summary section (5cm).
things related to solving tasks will not.                          Fill the left column and the summary section in
YouTube: Nine study techniques for engineering courses             within 24 hours of taking your notes. It will help
Education corner: How to study engineering?                        you reflect on the content.

How to study medicine and biology                           Avoid distractions: keep distracting devices like iPods
                                                                   and smartphones away.
Medicine and biology are characterized by a massive
workload. As a former mathematics or physics student,       Watch in small pieces: if you watch everything at once
you might not be used to this enormous amount. You                 for long periods, it is less efficient than spreading
might think it unnecessary to learn all this as long as            the sessions over time. Watch a video every now
you understand the underlying laws--but this is not the            and then.
case. For example, immunology is so comprehensive and
complex that you genuinely need to learn all this stuff     Enjoy with peers: you might use the opportunity to dis-
before you really start to understand how the immune               cuss the content with others so you can learn from
system works. No biologist will ever take you seriously if         each other.
you do not catch up and show a decent knowledge base.
Moreover, your computational models will fail if you        YouTube: Cornell notes method
do not know enough of all the issues and complexity
around them. Even if you do not model everything,           Self-directed learner and critical thinking
knowing the details is nevertheless crucial. Knowing        Learning habits are set out in stages, as shown by Grow's
more information helps you to guide your modeling           levels of self-directed learning [5].
better. You need excellent time management, reading
skills, and memorizing strategies to manage this. You       Stage 1 (Dependent learner): Relies on instructor. No
will have to read much more, and the biology books are             self-direction. Task-oriented.
much thicker. In these disciplines, it is also helpful to
teach others. Watch the highly recommended advice           Stage 2 (Interested learner): Not always directed. Seeks
of a graduate of a medical school, and the organization            some opportunities and sets some goals.
skills of a medical student. Their learning strategies are
impressive.                                                 Stage 3 (Involved learner): Ability to learn individu-
YouTube: Medical School: How to study, read, and learn             ally. Has learning goals and methods to achieve
YouTube: Watch an organized medical student                        those goals.

How to watch educational videos                             Stage 4 (Self-directed learner): Sets goals. Knows how
                                                                   to assess and how to self-motivate. Finds valid and
Watching educational videos is not like watching a Bol-            reliable resources.
lywood movie.
                                                            YouTube: Self-directed learning (Part 1)
Learning objectives: take one to two minutes to think       YouTube: Self-directed learning (Part 2)
       about what learning goals you have before starting
       a video. Many videos, linked in this handout, help   To become a self-directed (self-regulated, lifelong) learner,
       you deepen your knowledge, but do not forget to      you must learn to assess the demands of the task, evalu-
       make progress. First go through the handout and      ate your previous knowledge and skills, plan your ap-
       then use the possibility to go deeper. Plan your     proach, monitor the progress, and adjust the strategy
       learning.                                            if needed [3]. Planning the learning process is a step
                                                            which is frequently ignored, and the time required for
Pause and ponder: if you were not concentrating for a       learning to take place is often underestimated. Ponder
       moment or you missed the point, rewind or push       on why you take a certain approach and not another
       the stop button.                                     one. Also think about what was ineffective last time
                                                            and how this can be improved in the future. Self-critical
Speed adjustment: if you can, speed up or slow down         evaluation is important to avoid directing yourself mean-
       the video for your convenience. Double-speed?        inglessly. Keep in mind what Karl Popper1 said: "If we
       Why not?                                             are uncritical we shall always find what we want: we
                                                            shall look for, and find, confirmations, and we shall look
Take notes: you cannot ask questions immediately. Jot       away from, and not see, whatever might be dangerous to
       your thoughts down and keep them for the lecture     our pet theories". Wisdom and the best approximation
       in the classroom. Apply the Cornell note-taking
       system: the upper left column (1/3) of your sheet        1 Austrian and British philosopher Sir Karl Raimund Popper 1902--
       is reserved for questions and keywords. The right    1994.
                                                                           Introduction -- 7/14

of truth come only if you are your most merciless but                      is to learn from mistakes in order to improve your work.
constructive critic. It is the right but the hardest way.                  Careless and deliberate sloppiness has nothing to do
Also watch the lecture series on critical thinking, which                  with it and is not appreciated.
will help you to become a better scientist.
YouTube: Critical thinking                                                         MASTERY
In a book based on the work of the Foundation for Critical
Thinking we found the following definition by Francis                                         KNOW WHEN TO APPLY
Brown2: "Critical thinking is a desire to seek, patience to
doubt, fondness to meditate, slowness to assert, readi-                                                   Skills
ness to consider, carefulness to dispose and set in order;                                                              PRACTICE
and hatred for every kind of imposture."
                                                                                                                        Integrating skills
Repetition or elaboration strategies
                                                                                                                           ACQUIRE
Repetition does not have a significant measurable impact
on learning. Repetition is the consolidation of something                                                                Component
but this does not mean you are consolidating something                                                                       skills
useful or correct. Misconceptions can be consolidated as
well. Thus, feedback from peers and the teacher is im-                     Figure 5. Elements of mastery. Source: [3]. Copyright 
portant. Much more effective is deliberate practice which                  2010, John Wiley and Sons.
directly targets self-identified weaknesses and requires
a healthy portion of self-criticizing and critical thinking.               Knowledge and skill levels
Additionally, repeating easy tasks does not help you to                    Knowledge falls into several types [3]. Declarative knowl-
become better. Search for challenges and practice annoy-                   edge describes the knowledge of facts and concepts that
ing or difficult tasks with attainable goals. Moreover, a                  can be stated or declared. Procedural knowledge is
better strategy than repetition is elaboration. Elabora-                   knowing how to apply various procedures, methods,
tion deals with the integration of new pieces of informa-                  theories, and styles. Contextual knowledge describes
tion into your existing network of knowledge organiza-                     the ability to know when something has to be applied
tion. Elaboration is more effective with high self-activity                and conceptual knowledge says why something is ap-
(d = 0.7) rather than letting the teacher do it for you                    propriate in a particular situation. See also Figure 5 for
(d = 0.44). Make connections to your previous knowl-                       the stages of mastery and Bloom's Taxonomy in the ap-
edge instead of repeating facts alone and search for tasks                 pendix [6] (Fair Use) for the classification of thinking
which challenge you.                                                       skills.
                                                                           We not only have different knowledge types, but this
Approach to dealing with mistakes                                          knowledge is also organized in different ways. The knowl-
                                                                           edge organization of beginners shows few connections
Learning something new opens up space for opportu-                         between elements and looks like separated knowledge is-
nity, and if you dare to learn something new, mistakes                     lands or a linear sequence of knowledge pieces, whereas
will happen. The more mistakes you make, the more you                      experts' knowledge is densely connected--for example,
will learn in the long term. Embracing new challenges                      in a hierarchical or network form. History facts might be
and thus taking the risk of failure will carry you farther                 memorized along a timeline, but if the question requires
than avoiding challenges to avoid mistakes (d = 0.44).                     knowledge organized along other criteria, or the chain of
This strategy might lead to problems in the learning pe-                   knowledge is interrupted, the knowledge might be not
riod (d = -0.15) but result in better performance after                    accessible. Mind maps might be a good possibility of
the learning period (d = 0.56). This approach is effective                 connecting pieces of knowledge in different ways. Com-
if the test is similar to the practice tasks (d = 0.2) and                 petence can also be classified into four different stages,
superior in applying the learned facts to new problem                      as shown in Figure 6. In the beginning, it is impossi-
types (d = 0.8), which will help you to get even more                      ble to know what one has never learned before. After
out of this course in the future. Inaccurate prior knowl-                  a while, one recognizes knowledge gaps and fills them
edge or even misconceptions (the heart oxygenates the                      until the acquisition process and origin get lost. Profes-
blood, Pluto is a planet, objects of different masses fall at              sors are frequently in the top competence level and may
different rates, blind people hear better) are difficult to                find it difficult to identify the problems with which you
repair if the teacher is unaware of them before the exam.
Be considerate toward others making mistakes, and do
not fear embarrassing moments yourself. Your only duty

    2 English philosopher, scientist, jurist, statesman, and author Fran-
cis Brown 1561--1626. Seen as father of empiricism and scientific
methods.
         Integrating skills

                                                          AQUIRE          8/14

Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching

                                                        Component
                                                            skills

struggle. Participating during lectures and explaining   4 % Intelligence
questions clearly can help your supervisor to help you   3 % Emotional intelligence
become better.                                           2 % Socio-economic status
                                                         <2 % Biological age
                       Unconscious                       <2 % Gender
                       competence                        <2 % Extroversion
                                                         <2 % Self-esteem
      Conscious                                          <2 % Social support
      competence                                         <2 % Stress
                                                         <2 % Depression
1  2  3  4
                                                                         5. Learning checklist
                                 Conscious
                                 incompetence            Check boxes if appropriate. It might help you not to
                                                         forget things and might inspire you to promote your
                Unconscious                              self-directed learning. Try to stay within the script and
                incompetence                             do not lose too much time by finding answers. Use it
                                                         as an inspiration and organization tool. You should ask
Figure 6. Competence levels. Source: [3]. Copyright     yourself the following questions [7]:
2010, John Wiley and Sons.
                                                              What is it and how is it defined? (declarative)
Summary                                                       How is this theory applied in the real world? (pro-

Effect of educational strategies [2]                            cedural)
d = 1.81 Self-efficacy belief                                 Could you provide an example of when this for-
d = 1.39 Preparation and planning by the lecturer
d = 1.35 Clear and understandable lecturer                      mula might be used? (contextual)
d = 1.13 Deliberate practice objectives                       Could you sketch what that (solution, device, etc.)
d = 1.12 Clear learning objectives
d = 0.90 - 0.98 Attending courses regularly                     might look like? (procedural)
d = 0.77 Openness to outsider opinions                        How is this equation applied in practice? (proce-
d = 0.75 Student's regulation of effort
d = 0.68 Group work                                             dural)
d = 0.68 Empathy and warm-heartedness of the teacher          Where did that formula come from? (conceptual)
d = 0.67 Previous skill level                                 Do you understand when that formula is used?
d = 0.65 Teacher-student relationship quality
d = 0.64 Co-operative learning                                  (contextual)
d = 0.57 Teacher's enthusiasm                            Remember [3]: Declarative knowledge describes the
d = 0.49 Diligence                                       knowledge of facts and concepts that can be stated or de-
d = 0.48 Motivation                                      clared. Procedural knowledge is knowing how to apply
d = 0.47 Supportive atmosphere in the classroom          various procedures, methods, theories, and styles. Con-
d = 0.47 Encouragement of learning                       textual knowledge describes the ability to know when
d = 0.43 Solely making notes during oral presentations   and in which context something has to be applied and
d = 0.41 Addressing learning progress                    conceptual knowledge says why something is appropri-
d = 0.41 Organized learning                              ate in a particular situation. Does the concept fit your
d = 0.41 Learning with fellow students                   application? Do you know the concept behind a certain
d = 0.41 Time management                                 definition?
d = 0.34 Disturbances during lessons                     Another definition can be found (trainingindustry.com):
d = 0.32 Critical thinking
d = 0.32 Intrinsic motivation                            Definition 1. Conceptual knowledge refers to the knowl-
d = 0.21 Class size                                      edge of, or understanding of concepts, principles, the-
d = 0.21 Compulsory attendance                           ories, models, classifications, etc. We learn conceptual
d = 0.19 Co-teaching                                     knowledge through reading, viewing, listening, experi-
d = -0.02 Making notes during PowerPoint presenta-       encing, or thoughtful, reflective mental activity.

       tions                                             Definition 2. Declarative knowledge refers to facts or
d = -0.43 Fear exams                                     information stored in the memory, that is considered
Disturbing effects on exam results variability is minor  static in nature. Declarative knowledge, also referred to
(n=403623 students, 911 effects investigated):           as conceptual, propositional or descriptive knowledge,
6 % Procrastination                                      describes things, events, or processes, their attributes,
5 % Diligence                                            and their relation to each other. It is contrary to procedu-
4 % Fear of exams                                        ral, or implicit knowledge, which refers to the knowledge
                                                         of how to perform or operate.
                                                                                                               Introduction -- 9/14

Definition 3. Procedural knowledge refers to the knowl-                          Part 1: Biochemical network in the matrix form
edge of how to perform a specific skill or task, and is
considered knowledge related to methods, procedures,                                      tasks                steps  knowledge
or operation of equipment. Procedural knowledge is                               priority
also referred to as implicit knowledge, or know-how.                                                               first read
                                                                                                                        second read
Definition 4. Implicit knowledge is knowledge that is                                                                       watched YouTube
gained through incidental activities, or without aware-                                                                         solved tasks
ness that learning is occurring. Some examples of im-                                                                                solved extra tasks
plicit knowledge are knowing how to walk, run, ride a                                                                                    declarative
bicycle, or swim.                                                                                                                            procedural
                                                                                                                                                  contextual
Example:                                                                                                                                              conceptual
The determinant of a 2-by-2 matrix is the area between
two linear independent vectors (declarative). It can be                          1 Define systems biology 
computed in the following ways (procedural). The de-
terminant is useful to understand whether a matrix is                            2 Incidence matrix
invertible (contextual) and only works if the matrix is a
square matrix (contextual). The determinant is based on                          2 Adjacency matrix & list
the geometric intuitions and concepts of linear algebra
in the following way (conceptual).                                               3 Graph notation (brack-

                                                                                      ets)

                                                                                 2 Hypergraph

                                                                                 1 PCA, PLSR, VIP

                                                                                 1 Turn linear equation set

                                                                                      to matrix form

                                                                                 1 Matrix indices

                                                                                 1 Augmented coefficient

                                                                                      matrix

                                                                                 2 Solve equations: Rule of

                                                                                      Cramer

                                                                                 1 Gauss and Gauss Jordan

                                                                                      form

                                                                                 3 Reduced      row-echelon

                                                                                      form

Part 0: Introduction and learning                                                3 LU decomposition

                                                                                 1 Rank

tasks                            steps  knowledge                                1 Identity matrix

priority                                                                         1 Zero matrix
                                  first read
                                       second read                               1 Trace
                                           watched YouTube
                                               solved tasks                      1 Matrix multiplication
                                                    solved extra tasks
                                                        declarative              1 Sum and subtract matri-
                                                            procedural
                                                                 contextual           ces
                                                                     conceptual
                                                                                 1 Scalar multiplication

                                                                                 1 Transpose

2 Systems medicine                                                               1 Determinant of a 2-by-2

2 Network medicine                                                                    matrix

2 Self-efficacy belief                                                           2 Determinant of a 3-by-3

2 Regulation of effort                                                                matrix (Rule of Sarrus)

2 Performance           gain-                                                    2 Determinant (Rule of

     practice                                                                         Cramer)

2 Self-directed learner                                                          3 Laplace expansion

2 Critical thinking                                                              1 Inversion of a 2-by-2 ma-

                                                                                      trix

2 Knowledge organization                                                         2 Inversion of a 3-by-3 ma-

2 Elaboration strategy                                                                trix

2 Skill level                                                                    1 Eigenvalues

2 Elements of mastery                                                            2 Eigenvectors

2 Competence level                                                               3 Eigenvalue via fast equa-

                                                                                      tion
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                 10/14

Part 2: Metabolic modeling                                                         tasks                          steps  knowledge
              tasks
priority                        steps  knowledge
                                  first read
                                       second read
                                           watched YouTube
                                               solved tasks
                                                    solved extra tasks
                                                        declarative
                                                            procedural
                                                                 contextual
                                                                     conceptional

                                                                              priority
                                                                                                                first read
                                                                                                                     second read
                                                                                                                         watched YouTube
                                                                                                                             solved tasks
                                                                                                                                  solved extra tasks
                                                                                                                                      declarative
                                                                                                                                           procedural
                                                                                                                                               contextual
                                                                                                                                                   conceptional
                                                                                   1 Feedback loops

1 Classify metabolic mod-                                                          1 State space representa-

     els                                                                                tion

1 Stoichiometric matrix                                                            1 Classify system types

1 Steady state                                                                     2 SISO vs MIMO

1 Rouch-Capelli theorem                                                           3 Laplace transform and

2 Elementary flux modes                                                                 frequency domain

     (EFM)                                                                         3 Fourier transform

2 Conservation relations                                                           2 Time domain vs fre-

3 Left and right null space                                                             quency domain

1 Classify MFA according                                                           2 Controllability

     dynamic and isotope                                                           2 Observability
     tracer
                                                                                   2 Transfer function
2 Metabolic flux analysis
                                                                                   1 Definition steady state
     (MFA)
                                                                                   1 Stability
1 Pros and cons of FBA
                                                                                   1 Damping
2 Flux balance analysis
                                                                                   1 Characteristic      polyno-
     (FBA)
                                                                                        mial
2 Constrained optimization
                                                                                   1 Eigenvalues in the fre-
     cone
                                                                                        quency domain to stabil-
                                                                                        ity classification

                                                                                   2 Phase portrait

                                                                                   2 Definition trajectory

                                                                                   2 Slope field

Part 3: The magic of change and how to find it                                     2 Definition isoclines

       tasks                    steps  knowledge                                   2 Discrete in state and time

priority                                                                           2 Difference equation
                                  first read
                                       second read                                 1 p-q equation
                                           watched YouTube
                                               solved tasks                        1 a-b-c equation
                                                    solved extra tasks
                                                        declarative                1 Complex numbers
                                                            procedural
                                                                 contextual        1 Differentiation
                                                                     conceptional
                                                                                   1 Product rule

                                                                                   1 Quotient rule

1 Black box concept                                                                1 Chain rule

2 Hysteresis                                                                       1 Separation of variables

1 Block diagram                                                                    1 Integration factor

2 Synthetic Biology vs. Sys-                                                       2 Linearization

     tems Biology

1 ODE

2 What is the difference be-

     tween ODE & PDE

2 Change one ODE to a sys-

     tem of ODEs

1 General properties of a

     system

2 Nonlinear dynamic

2 Open loop vs closed loop

1 Feed-forward loops
                                                                                                              Introduction -- 11/14

Part 4: Physical modeling and nonlinear enzyme kinet-                                                6. Further reading

ics                                                                                We suggest reading the great article by Barabasi et al. to
                                                                                   familiarize yourself with the topic of network medicine
         tasks                  steps  knowledge                                   [8].
priority
                                  first read                                                      References
                                       second read
                                           watched Youtube                         [1] Rolf Apweiler, Tim Beissbarth, Michael R
                                               solved tasks                            Berthold, Nils Blthgen, Yvonne Burmeister,
                                                    solved extra tasks                 Olaf Dammann, Andreas Deutsch, Friedrich
                                                        declarative                    Feuerhake, Andre Franke, Jan Hasenauer,
                                                            procedural                 et al. Whither systems medicine? Experi-
                                                                 contextual            mental & Molecular Medicine, 50(3):e453, 2018.
                                                                     conceptional      https://doi.org/10.1038/emm.2017.290.

1 Reality and model           

1 Modeling cycle of Blum

     and Lei

1 Assumptions

1 Model building

f1 Distinguish variable, pa-                                                       [2] Michael Schneider and Maida Mustafi. Gute
                                                                                       Hochschullehre: Eine evidenzbasierte Orientierung-
     rameter, coefficient

3 Dimension analysis                                                               shilfe: Wie man Vorlesungen, Seminare und Pro-

3 Poorly posed problems                                                            jekte effektiv gestaltet. Springer-Verlag, 2015.
                                                                                   https://doi.org/10.1007/978-3-662-45062-8.
1 Sensitivity analysis

1 Model classification                                                             [3] Susan A Ambrose, Michael W Bridges, Michele DiP-
                                                                                       ietro, Marsha C Lovett, and Marie K Norman. How
2 Akaike information crite-
                                                                                       learning works: Seven research-based principles for smart
     rion

2 1st law of thermodynam-                                                          teaching. John Wiley & Sons, 2010.

     ics

2 2nd law of thermodynam-                                                          [4] Scott Freeman, Sarah L Eddy, Miles McDonough,
                                                                                       Michelle K Smith, Nnadozie Okoroafor, Hannah
     ics                                                                               Jordt, and Mary Pat Wenderoth. Active learn-
                                                                                       ing increases student performance in science, en-
3 Noise                                                                                gineering, and mathematics. Proceedings of the Na-
                                                                                       tional Academy of Sciences, 111(23):8410-8415, 2014.
1 Extensive quantities                                                                 https://doi.org/10.1073/pnas.1319030111.

1 Intensive quantities

2 Read SI units

1 Quantity calculus

1 Balancing                                                                        [5] Gerald O Grow. Teaching learners to be self-directed.
                                                                                       Adult Education Quarterly, 41(3):125-149, 1991.
1 Mass balance

3 Volume balance                                                                   [6] Center     Grove,      June           2018.

1 Amount of substance bal-                                                         https://www.centergrove.k12.in.us/Page/7844.

     ance

1 Law of mass-action                                                               [7] Education  Corner,              July  2018.

1 Reaction rate                                                                    https://www.educationcorner.com/engineering-

1 Michaelis-Menten                                                                 study-skills-guide.html.

3 Lineweaver-Burk plot                                                             [8] Albert-Lszl Barabsi, Natali Gulbahce, and Joseph
                                                                                       Loscalzo. Network medicine: a network-based ap-
2 MM for reversible reac-                                                              proach to human disease. Nature Reviews Genetics,
                                                                                       12(1):56, 2011. https://doi.org/10.1038/nrg2918.
     tions

2 MM for inhibition

2 Substrate inhibition

2 Cooperative enzymes

1 Hill kinetic

1 Mathematical analysis ap-

     proaches (Wolkenhauer)
     without equations
             LOW LEVEL THINKING SKILLS                                                                                                         HIGH LEVEL THINKING SKILLS

    Knowledge                          Comprehension                                    Application                                  Analysis                                   Synthesis                                      Evaluation

Recall /regurgitate facts without     To show understanding finding in-             To use in a new situation. Solving         To examine in detail. Examining             To change or create into some-                 To justify. Presenting and defend-
understanding. Exhibits previously    formation from the text. Demonstrating        problems by applying acquired knowl-       and breaking information into parts by      thing new. Compiling information to-
learned material by recalling facts,                                                edge, facts, techniques and rules in a     identifying motives or causes; making                                                      ing opinions by making judgements
terms, basic concepts and answers.    basic understanding of facts and ideas.       different way.                             inferences and finding evidence to sup-     gether in a different way by combining
                                                                                                                               port generalisations.                                                                      about information, validity of ideas or
                                                                                                                                                                           elements in a new pattern or proposing         quality of work based on a set of crite-

                                                                                                                                                                           alternative solutions.                         ria.

Key words:                            Key words:                                    Key words:                                 Key words:                                  Key words:                                     Key words:

Choose       Observe         Show     Ask           Extend      Outline             Act           Employ       Practice        Analyse         Examine      Prioritize     Adapt         Estimate     Plan                Agree           Disprove      Measure
Copy         Omit            Spell    Cite          Generalise  Predict             Administer    Experiment   Relate          Appraise        Find         Question       Add to        Experiment   Predict             Appraise        Dispute       Opinion
Define       Quote           State    Classify      Give exam-  Purpose             Apply         with         Represent       Arrange         Focus        Rank           Build         Extend       Produce             Argue           Effective     Perceive
Duplicate    Read            Tell     Compare       ples        Relate              Associate     Group        Select          Assumption      Function     Reason         Change        Formulate    Propose             Assess          Estimate      Persuade
Find         Recall          Trace    Contrast      Illustrate  Rephrase            Build         Identify     Show            Breakdown       Group        Relation-      Choose        Happen       Reframe             Award           Evaluate      Prioritise
How          Recite          What     Demon-        illustrate  Report              Calculate     Illustrate   Simulate        Categorise      Highlight    ships          Combine       Hypothesise  Revise              Bad             Explain       Prove
Identify     Recognise       When     strate        Indicate    Restate             Categorise    Interpret    Solve           Cause and       In-depth     Reorganise     Compile       Imagine      Rewrite             Choose          Give reasons  Rate
Label        Record          Where    Discuss       Infer       Review              Choose        Interview    Summarise       effect          discussion   Research       Compose       Improve      Simplify            Compare         Good          Recommend
List         Relate          Which    Estimate      Interpret   Show                Classify      Link         Teach           Choose          Inference    See            Construct     Innovate     Solve               Conclude        Grade         Rule on
Listen       Remember        Who      Explain       Match       Summarise           Connect       Make use of  Transfer        Classify        Inspect      Select         Convert       Integrate    Speculate           Consider        How do we     Select
Locate       Repeat          Why      Express       Observe     Translate           Construct     Manipulate   Translate       Differences     Investigate  Separate       Create        Invent       Substitute          Convince        know?         Support
Match        Reproduce       Write                                                  Correlation   Model        Use             Discover        Isolate      Similar to     Delete        Make up      Suppose             Criteria        Importance    Test
Memorise     Retell                                                                 Demonstrate   Organise                     Discriminate    List         Simplify       Design        Maximise     Tabulate            Criticise       Infer         Useful
Name         Select                                                                 Develop       Perform                      Dissect         Motive       Survey         Develop       Minimise     Test                Debate          Influence     Validate
                                                                                    Dramatise     Plan                         Distinction     Omit         Take part in   Devise        Model        Theorise            Decide          Interpret     Value
                                                                                                                               Distinguish     Order        Test for       Discover      Modify       Think               Deduct          Judge         Why
                                                                                                                               Divide          Organise     Theme          Discuss       Original     Transform           Defend          Justify
                                                                                                                               Establish       Point out    Comparing      Elaborate     Originate    Visualise           Determine       Mark

Actions:     Outcomes:                Actions:      Outcomes:                       Actions:      Outcomes:                    Actions:        Outcomes:                   Actions:      Outcomes:                        Actions:        Outcomes:

Describing   Definition               Classifying   Collection                      Carrying out  Demonstration                Attributing     Abstract                    Constructing  Advertisement                    Attributing     Abstract
Finding      Fact                     Comparing     Examples                        Executing     Diary                        Deconstructing  Chart                       Designing     Film                             Checking        Chart
Identifying  Label                    Exemplifying  Explanation                     Implementing  Illustrations                Integrating     Checklist                   Devising      Media product                    Deconstructing  Checklist
Listing      List                     Explaining    Label                           Using         Interview                    Organising      Database                    Inventing     New game                         Integrating     Database
Locating     Quiz                     Inferring     List                                          Journal                      Outlining       Graph                       Making        Painting                         Organising      Graph
Naming       Reproduction             Interpreting  Outline                                       Performance                  Structuring     Mobile                      Planning      Plan                             Outlining       Mobile
Recognising  Test                     Paraphrasing  Quiz                                          Presentation                                 Report                      Producing     Project                          Structuring     Report
Retrieving   Workbook                 Summarising   Show and tell                                 Sculpture                                    Spread sheet                              Song                                             Spread sheet
             Worksheet                              Summary                                       Simulation                                   Survey                                    Story                                            Survey

Questions:                            Questions:                                    Questions:                                 Questions:                                  Questions:                                     Questions:

Can you list three ...?               Can you explain what is happening . . . what  How would you use...?                      What are the parts or features of ...?      What changes would you make to solve...?       Do you agree with the actions/outcomes...?
Can you recall ...?                   is meant . . .?                               What examples can you find to ...?         How is _______ related to ...?              How would you improve ...?                     What is your opinion of...?
Can you select ...?                   How would you classify the type of ...?       How would you solve _______ using what     Why do you think ...?                       What would happen if...?                       How would you prove/disprove...?
How did ______ happen?                How would you compare ...?contrast ...?       you have learned ...?                      What is the theme ...?                      Can you elaborate on the reason...?            Can you assess the value/importance of...?
How is ...?                           How would you rephrase the meaning ...?       How would you organise _______ to          What motive is there ...?                   Can you propose an alternative...?             Would it be better if...?
How would you describe ...?           How would you summarise ...?                  show ...?                                  Can you list the parts ...?                 Can you invent...?                             Why did they (the character) choose...?
How would you explain ...?            What can you say about ...?                   How would you show your understanding      What inference can you make ...?            How would you adapt ________ to create a       What would you recommend...?
How would you show ...?               What facts or ideas show ...?                 of ...?                                    What conclusions can you draw ...?          different...?                                  How would you rate the...?
What is ...?                          What is the main idea of ...?                 What approach would you use to...?         How would you classify ...?                 How could you change (modify) the plot         What would you cite to defend the ac-
When did ...?                         Which is the best answer ...?                 How would you apply what you learned to    How would you categorise ...?               (plan)...?                                     tions...?
When did _______ happen?              Which statements support ...?                 develop ...?                               Can you identify the difference parts ...?  What could be done to minimise                 How would you evaluate ...?
Where is . . . ?                      Will you state or interpret in your own       What other way would you plan to ...?      What evidence can you find ...?             (maximise)...?                                 How could you determine...?
Which one ...?                        words ...?                                    What would result if ...?                  What is the relationship between ...?       What way would you design...?                  What choice would you have made...?
Who was ...?                                                                        Can you make use of the facts to ...?      Can you make a distinction between ...?     Suppose you could _______ what would           What would you select...?
Who were the main . . . ?                                                           What elements would you choose to          What is the function of ...?                you do...?                                     How would you prioritise...?
Why did ...?                                                                        change ...?                                What ideas justify ...?                     How would you test...?                         What judgement would you make about...?
                                                                                    What facts would you select to show ...?                                               Can you formulate a theory for...?             Based on what you know, how would you
Bloom's Taxonomy: Teacher Planning Kit                                              What questions would you ask in an inter-                                              Can you predict the outcome if...?             explain...?
                                                                                    view with ...?                                                                         How would you estimate the results for...?     What information would you use to sup-
                                                                                                                                                                           What facts can you compile...?                 port the view...?
Retrieved from: https://lccfestivaloflearning2012.files.wordpress.com/2012/10/support-document-13-blooms-taxonomy-teacher-planning-kit1.pdf                                Can you construct a model that would           How would you justify...?
                                                                                                                                                                           change...?                                     What data was used to make the conclu-
                                                                                                                                                                           Can you think of an original way for the ...?  sion...?
Notes
Notes
Chapter 1: Biochemical networks in the matrix form

Thomas Sauter, Marco Albrecht

  Motivation
  The biochemistry of the cell is very complex and the available data might overwhelm the abilities of interpretation
  [1]. Reductionist approaches, combined with some intuition, have brought us far, but we need rational approaches
  to better understand the interplay of molecules at the system level. We have to check whether a hypothesis is in
  itself logical and can be aligned with data. In this chapter, we--while reducing biochemical molecules to their
  function--will learn how to interlink several players to acquire a mechanistic understanding of a pathway or a
  complex system. Modeling thereby helps us in the following ways [2]:

      1. Enhancing understanding of otherwise unintelligible systems
     2. Requiring a way of thinking that can be beneficial to the design of experiments

  While, by studying this chapter, you will not become a computational scientist, it will help you to communicate
  with them. Nobody expects that you understand everything immediately. It will take time to digest and it requires
  a lot of practicing to build the skills.
  The mathematical principles introduced here will be applied to biological pathways and networks in the following
  chapters. If you prefer, you could directly jump to Chapter 2 and 3 to see some applications first.

  Keywords
  Matrix -- Graph -- Metabolic network

 Contact: thomas.sauter@uni.lu. Licence: CC BY-NC

                         Contents                          Input Layer       I1            I2

                                                           Intermediate      + -        +
                                                           Layer
1 Lecture summary                  1                                     A+          E+F

1.1  Biological networks and graph theory . 1                            -   B+      +     + +

1.2  Modeling of metabolic networks . . . . 4                            D+      C             G

2 Basics of Mathematics            5                                              +            +

2.1  Linear algebra . . . . . . . . . . . . . . . 5        Output Layer          O1            O2

References                         15                      Figure 1. The interaction graph of a signal transduction
                                                           pathway triggered by the inputs I1 and I2 with subse-
3 Exercises                        17                      quent response in the output layer indicated by O1 and
                                                           O2.

4 Solutions

Do not betray yourself!            20                      Put in another way: we are not interested in dissect-
                                                           ing objects into ever smaller parts and details. Instead,
                 1. Lecture summary                        we look at the elements (nodes, states) we know and
                                                           focus on their interactions (edges, coefficients). The in-
1.1  Biological networks and graph theory                  terplay of a few elements can result in manifold different
Biological phenomena are very complex and systems          phenomena and observations, depending on how the
biology helps us to understand their system's behavior.    elements activate or inhibit each other. The interactions
                                                           between the states in a system are often represented as a
Definition 1. Systems biology is the science that studies  matrix. But the type of matrix used can vary for different
how biological function emerges from the interactions      systems.
between the components of living systems and how these
emergent properties enable and constrain the behaviour                       https://doi.org/10.11647/OBP.0291.01
of the components [2].

 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                           2/24

   Example 1: Signal transduction                                          Graphs are a special case of more general hypergraphs,
                                                                           shown in Figure 3. In a graph, edges connect 2 nodes,
   The example graph in Figure 1 can be written in                         whereas in a hypergraph H = (V, E) there is a set of hy-
   the form of an incidence matrix In                                      peredges E connecting a set of vertices V. In other words,
                                                                           in a hypergraph, a hyperedge can connect any number
          + - + + + + - + + + + + + -1 -1 0 0 0 0 0 0 0 0 0 0 0  I1        of vertices. Hypergraphs are used, for example, used to
           0  0 -1 0   0  0  0  0     0  0  0   0   0     I2               represent metabolic networks where reactions can con-
                                                                           nect multiple substrates and products and sometimes
           0  0  0 -1 0   0  1  0     0  0  0   0   0     A                involve cofactors. Undirected hypergraphs represent set
                                                                           systems, as shown in Figure 4. Directed hypergraphs
           1  0  0  1 -1 0   0  0     0  0  0   0   0      B               have hyperedges e = (S, K) with vertices assigned to the
                                                                           tail/start knot S and vertices assigned to the head/end
           0  0  0  0  1 -1 0   1     0  0  0   -1  0      C               knot K. An example directed graph is shown in Figure 5.
   In =                                                                    One of the hyperedges points from the tail knots A and B
           0  0  0  0  0  1 -1 0      0  0  0   0   0     D                (S = {A, B}) to the head knots C and D (K = {C, D}) writ-
                                                                           ten as e1 = ({A, B}, {C, D}). Pay attention to the brackets.
           0  1  1  0  0  0  0 -1 -1 0      0   0   0      E
                                                        
           0  0  0  0  0  0  0  0     1 -1 1    0   0      F
                                                        
           0  0  0  0  0  0  0  0     0  1  -1  0   -1    G
                                                        
          0 0 0 0 0 0 0 0 0 0 0 1 0  O1
           0 0 0 0 0 0 0 0 0 0 0 0 1 O2

   with interactions as column entries and states as
   row entries.

    Example 1 mimics a signal transduction network                         Case 1: Undirected graph
within a cell (Figure 1), where relevant molecules are
represented as nodes (states) and interactions as edges                    An undirected graph is described by vertices V =
(later resulting in mathematical terms in the balance                      {A, B,C, D, E, F} and edges E = {a, b, c, d, e, f , g} =
equations). The states represent the phosphorylation sta-                  {(A, B), (B,C), (C, D), (D, E), (D, F), (C, F), (F, A)}.
tus or the concentration of a particular molecule, while                   The relevant matrices (see text) are:
the interactions represent binding affinities, regulatory
interactions, or metabolic fluxes etc. If molecule A is                         A B C D E F 0 1 0 0 0 1A         
directly responsible for a higher activity or abundance                         1 0 1 0 0 0B                B, F A
of molecule B, we draw an arrow from A to B, which is                      A = 0 1 0 1 0 1C ,                     B
called a directed edge. Moreover, we write in the related                       0 0 1 0 1 1D                A,C
column of the incidence matrix In (see Example 1) the                           0 0 0 1 0 0E              L = B, D, FC ,
number -1 for A and +1 for B. Molecule B, on the other                                                    C, E, FD
hand, has a positive impact on C. Molecule A would                                1 0 1 1 0 0F             D E
thus indirectly lead to higher levels of activation of C,
but no direct interaction, so this is not represented in                                                    A,C, D F
the network. Edges can also represent inhibitory interac-
tions, which are drawn as a straight line with a transverse                               a b c d e f g 1 0 0 0 0 0 1A
line at the inhibited molecule. The true interactions can                                1 1 0 0 0 0 0B
be figured out through experimental studies or via the                            In = 0 1 1 0 0 1 0C
analysis of the overall behavior of a network. Biologi-                                  0 0 1 1 1 0 0D
cal systems can also be represented in the form of an                                    0 0 0 1 0 0 0E
adjacency matrix A or as an adjacency list L, tackled in
Case Box 1 and 2. The combination of elements and                                          0 0 0 0 1 1 1F
interactions makes up a graph or network. Protein inter-
actions can be represented as undirected networks. One                     whereby the adjacency matrix A is symmetric. It is
valuable source for such networks is, for example, the                     not symmetric for a directed graph.
STRING database [3].
We want to compare a directed network with an undi-
rected network by reference to the cases in Figure 2. We

nuotneddicorwecnttehdegreralaptehd matrices indCicarseecBteoxd1graanpdh2.

A aBbC                             A aBbC

gf               c                 gf                   c

gF e DdE F e Dd E                  g

Figure 2. Left: undirected graph. Right: directed graph.
                                                                            Chapter 1: Biochemical networks in the matrix form -- 3/24

hypergraph       substrate graph                  bipartite graph

      C AC                                        A                                                C e2 E
A     Case 2: Directed graph                                    C                            A e1  D e3
                                                                                             B
   The directed graph is represented by vertiRces V =
   {A, B, C, D, E, F} and by edges E = {a, b, c, d, e, f , g}
B  =D{(A, B), (B,BC), (D, C),D(D, E), (F, D),B(C, F), (F, A)D}.

   The order of vertices in the edge description is rel-

   evant now. The matrices are:                                             Figure 5. Directed hypergraph V = {A, B,C, D, E},
                                                                            E = {e1, e2, e3} = {({A, B}, {C, D}), ({C}, {E}),
                 A B C D E F 0 1 0 0 0 0A               
                 0 0 1 0 0 0B                             BA                ({E, D}, {B})}.
            A = 0 0 0 0 0 1C ,                                   B       A B P E
                 0 0 1 0 1 0D                             C     C ,
                 0 0 0 0 0 0E                           
                                                  L  =    F              1     2             3         4
                   1 0 0 1 0 0F                         C, ED
                                                         - E                Example 2: Simple hypergraph
                 2
                                                        A, D F              5

A  1 A a b c4 d e f g -1B0 0 0 B0 0 1 A                                     The exBample in Figure 5 can be represented by the

                                                                            incidence matr9ix:

                                                                                 8

                                                                            6     e1 e2 e3
                                                                         A     C -1 0P 0 A
            In =3 01  -1       0  0        0         0       0 B                  -110 0 1 B
                         1     1  0        0 -1 0 C
                                                                         7 In =  1 -1 0 C
                   0     0 -1 -1 1                   0       0 D               D  1 0E -1D
               
                0 0 0 1 0 0 0 E
   1               0 1 0 0 0 -21 1 -1 F                                                      0 1 -1 E

   2A 3                A                   A              1                 Another representation of the system in Figure 5
                                                                            can be realized with chemical reaction equations:
     hypergraph                    0.5     1
                      0.5substrate graph             bipartite graph
   AB C                                                                                     e1
                        BA C               BA C                                                    e2 E
   B D                                                                         A + BA-- C + DC
                         B D                       R                                                 e3
                                                                                        e2 e1
                                                     B D                            C -- E

                                                                               D + EB--e3 B D

   Figure 3. A hypergraph can be translated into a substrate

   graph or a bipartite graph. A substrate graph cannot Directed hypergraphs, as mentioned previously, are
   be converted back to the hypergraph because the infor- needed for an important field in systems biology: metabolic
   mation whether A AND B are consumed by the same network modeling. The only difference is that we have
   reaction is lost in the substrate graph. It could also be AadditionBal stoichioPmetric infEormation (coefficients) to
   possible that A is converted into C and D, and that B is 1 weightt2he edges.3                   4

   transformed into C and D by independent reactions. 5                        B 9
                      2
                                                                                 8
   A        1 A B 4                        B
                                                                         A 6 C 10 P
                   e1 v e2                v3
                      3 2
                 v1 7 D E
            1 e 4                 e3 2
                            1
             A
            2 v4 3 0.5      A v5                  A
                                  0.5 v6 1
                                                             1

            B               B v7 B
                      Undirected hypergraph: V =
   Figure 4.

   {v1, v2, v3, v4, v5, v6, v7} and E = {e1, e2, e3, e4} =

   {{v1, v2, v3}, {v2, v3}, {v3, v5, v6}, {v4}}.                Source:

   en.wikipedia.org/wiki/Hypergraph, Fair Use.
                                                     R                                                       e1
             B DBD B D
                                                                                                  B              D e3
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching
                                                                                                                                          4/24

1.2  Modeling of metabolic networks                                                      A B                 P   E
Metabolic networks describe the flux of metabolites within                                  2
                                                                                         1                   3   4
a system. The fluxes are controlled by enzymes. A sim-

plified metabolic network is shown in Figure 6 and Ex-                                      5 B 9
ample 3. A more elaborate exampl2e is shown in Figure 7
                                                                                                  8
and Example 4.           1                           4
        A                    A B                           B                             A 6 C 10 P

Example 3: Simple metabolic network                                                      7
                                  3
                                                                                                 D E
We see in Figure 6, that we have two possible path-

ways here, either via1 v2 or v3. All1 edges can be2
weighted according to the stoichiometric coeffi-
cients so that we do nAot simply havAe an incidenceA                                  Figure 7. A metabolic model with 2 inputs and 3 outputs,
                   entrie2s       1s3or                 0.5                           whereby Molecule B is both. The system is controlled
matrix  (all  the            are         0s0).5 but  a
                                                        stoichio-1                    1

metric matrix: B B B                                                                  by the transport reactions of the external Metabolites A
                                                                                      and B to the cell, which releases Product P but can also
            v1 v2 v3 v4                                                               release B and E.

              1 -1 -1 0 Ain
              0       1      1 -1Bin .
     N  =                                                                                Example 4: Larger metabolic network

           -1 0 0 0 Aout
              0 0 0 1 Bout
                                                                                         Here, we see several possible routes (Figure 7) and

where the reactions determine the columns and                                            also a hyperedge v10. It is quite difficult without

the metabhoypleitregracpohncentrastuibosntradteegtrearpmh ines thbeiparrotiwte graph     mathematics to understand and predict the fluxes,

entries. Often we focus on intracellular metabolites                                     which we will learn in the next learning block. For
only, soAthat we cCan reducAe the sysCtem in thAis case C                                            e2
                                                                                         now we wanAt to set upCthe stoEichiometric matrix:
                                                           R                             v1 v2 v3 e1v4 v5 v6 v7 v8 v9 v10
to:                                                                                      1 0 0 0 -1 -e13 -1 0 0 0 A
                                                        B                                0 1 B0 0 D1 0 0 -1 -1 0 B
        B v1 vD2 v3 Bv4                  D                          D

     N = 1 -1 -1 0 A                                                                     N = 0 0 0 0 0 1 0 1 0 -1C
                                                                                         0 0 0 0 0 0 1 0 0 -1D
              0 1 1 -1 B                                                                 0 0 0 -1 0 0 0 0 0 1 E

This example has only unimolecular reactions.                                         Awith th0Be reversib 0 -1 Plereactio 0 0 Ens: 0 0 0 1 1 P

                                                                                      1  2rev = {R23, R8} 4

     A                      2                        B                                   and5irreversible reactions:

                 1 A B 4                                                                      irBrev ={9R1, R3, R4, R5, R6, R7, R9, R10}

                            3                                                                   8

                                                                                      A 6 C 10 P

Figure 6. A simple model of a metabolic system. The gray                              Aft7er seeing some motivating examples of biological
dotted line represe1nts the system1 boundary. A2 molecule
                                                                                      networks Dand the pEossibility of representing these as
comes from outsiAde to inside Aand turns inAto internal
                                                                                      matrices, we will now revise some basic mathematical
Molecule B via tw2o possib3 le r0e.5action 0w.5ays. M1 olecu1le B
                                                                                      concepts of linear algebra and matrix calculation.

is leaving the system.            B                     B
                   B
                                                             Chapter 1: Biochemical networks in the matrix form -- 5/24

             2. Basics of Mathematics                        10

2.1  Linear algebra                                          8
Linear algebra (Arabic: al-jabr) is one of the most funda-
mental and helpful topics from the realm of mathematics.     6
We recommend watching the following YouTube videos
and more from that channel the channel the videos be-        4
long to, by clicking on the link below:
YouTube: The essence of linear algebra                       2
YouTube: How to read math?
                                                             0

                                                             -2

                                                             -4

                                                             -6

                                                             -8

                                                             -4    -3  -2   -1       0               1    2

 From a set of equations to a matrix                         Figure 8. A linear equation system as vectors. The solu-
                                                             tion of the equation system is the cross-section of both
In science and technology, we frequently encounter sets      vectors.
of linear equations. One equation might be 3x1 + x2 = -2,
which we can write in a general form with a11x1 + a12x2 =    and vectors in bold lowercase letters:
b1 with coefficient a11 = 3, a12 = 1 and constant b1 =                      
-2. The variables, x, can represent molecule concentra-      x1                  b1
tions, and coefficients can represent interactions between   x2             b2 
molecules. If we add at least one other linear equation--    x =  .  and b =  .  .
such as 2x1 +1x2 = 0--with at least one common variable,      ..             .. 
we have a linear equation set:
                                                             xn                  bm

a11x1 + a12x2 = b1                                           This is very convenient and compact. The solution is
a21x1 + a22x2 = b2                                           simply x = A-1b. The exponent -1 indicates the matrix

You see that the first index m of coefficient amn increases  inverse and will be explained later. The matrix A basi-
with the number in rows, while the second index n in-
creases with the number of the variables xm. The example     cally describes n arrows with the arrow tail in the origin
equation set can be solved for x2:
                                                             (zero-point), and the arrowhead on m coordinates in a

                                                             space spanned by the coordinate system. The equation

3x1 + x2 = -2       x2 = -2 - 3x1                            set 2.1 describes an inhomogeneous system. It becomes
2x1 + x2 = 0        x2 = -2x1                                a homogeneous system if b = 0. If the system has a

                                                             solution we have a consistent system, otherwise it is

                                                             inconsistent. A linear equation system is also fully de-

which can be geometrically interpreted as shown in Fig-      termined by the augmented coefficient matrix:
ure 8. The solution is the point x1 = -2 and x2 = -4,
where the vectors cross.You either get one solution, no                a11 a12    a1n b1                   
solution, or an infinite number of solutions for any linear
equation set. The general form, with m equations and n                 a21  a22  렁                 a2n  b2  
variables, is then:                                                                                           
                                                             A b =  .. .. . . ..                              .
                                                                   . . . .                                    

                                                                       am1 am2    amn bm

a11x1 + a12x2 +    + a1nxn = b1              (2.1)        YouTube: From an equation set to a matrix
a21x1 + a22x2 +    + a2nxn = b2
                                                              Simple matrix operations
                                           ..                Let's say we have a matrix B and multiply it by a matrix
                                           .                 A from the left. What does it mean geometrically? It
am1x1 + am2x2 +    + amnxn = bm                           means that we transform the system B in a way that can
                                                             be a rotation, a scaling, or any form of linear deformation
which can be written in a much denser form as:               of the space, which is spanned by the coordinate system
                                                             of B. If the matrix B has p arrows pointing toward n
Ax = b                                                       coordinates within a n dimensional space, the multipli-
                                                             cation of B by A from the left transforms the coordinate
with a matrix in a bold capital letter:                      system from n dimensions to m dimensions. The final
                                                             matrix C represents p arrows pointing to the new coor-
  a11 a12    a1n                                          dinates in a m dimensional space. Have in mind that the

a21 a22    a2n 
A =  ..  .. . .     ..  
        . . ..          

  am1 am2    amn
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                  6/24

order of matrix multiplication matters in contrast to the  the matrix by this number without skewing or rotating it.
multiplication with numbers. Because A transforms the      The scalar multiplication by two doubles all coordinate
coordinates of B from one space to another, the number     values the arrows point to. Do not confuse this with
of columns in A must equal the number of rows in B in      scalar product, which is a form of inner product!
order to have sufficient coupling of two spaces for the    YouTube: Scalar multiplication
transformation or multiplication AB = C.
                                                               Example 3: Scalar multiplication

       n         p            p                                  2  1 8 -3 = 2  1 2  8 2  (-3)
m           n       =m                                                4 -2 5                      2  4 2  (-2) 2  5

                                                                                          = 2 16 -6
                                                                                              8 -4 10

Division by a matrix does not exist, but division of a     Another important operation is transposition (to inter-
matrix by a scalar is possible.                            change columns with rows).
YouTube: Multiplying matrices                              YouTube: Transpose a matrix

Example 1: Multiply matrices                                   Example 4: Transpose

A more detailed scheme is:                                                 1 2 3 4 5

42 matrix                     43 matrix                                    6         7      8   9       10  
a11 a12                        c12 c13                                                                       
            23 matrix                                           M =  11 12 13 14 15 
                            =            
a31 a32      b12 b13          c32 c33                                      16 17 18 19 20
                                                                            1 6 11 16 
             b22 b23

  렁                          렁 

where two c elements are calculated as follows:                              2     7          12  17  
                                                                                                      
       c12 = a11b12 + a12b22                                     MT =  3           8          13  18  
       c33 = a31b13 + a32b23                                                                          
                                                                            4 9 14 19 
                                                                             5 10 15 20

What is the sum of two matrices geometrically? The          Square matrices
matrix A has n arrows originating from the coordinate      Square matrices have as many rows as columns. Some
origin point to the m coordinates. If we sum up with
matrix B, the n arrows of B start from the coordinates of  square matrices are especially secure. One example is
A and land on the coordinates A + B. This is equivalent
to having n arrows starting from the coordinate system     the matrix in diagonal Jordan form, which was the aim
origin and pointing to the coordinates described by A +
B.                                                         of the Gauss-Jordan method:
YouTube: Sum up matrices and scalar multiplication                    a11 . . . 0 
                                                                      ..             ..   
    Example 2: Sum and subtract matrices                   A=           .              .  

   The sum or subtraction of matrices with identical                  0 . . . ann
   size is calculated entry-wise:
                                                           Multiplying a diagonal matrix multiple times from the
      1 3 1 + 0 0 5 = 1+0 3+0 1+5
      1 0 0 7 5 0 1+7 0+5 0+0                              left is the same as using the number of multiplications

                                   = 1 3 6.                as exponents of the diagonal elements:
                                        850
                                                           a11 . . . 0  a11 . . . 0  a11 . . . 0 
The scalar multiplication is also a transformation of the   3    ..          ..           ..          ..      ..        ..   
matrix. If you multiply a matrix by a number, you scale    A B=                                                           .  B
                                                                   .         ..                       ..
                                                                 0 . . . ann 0 . . . ann 0 . . . ann
                                                           3                       
                                                              a11 . . . 0
                                                                 ..           ..   
                                                           =       .         .     B

                                                                 0      ...  a3

                                                                               nn

                                                           This is much better than multiplying non-diagonal ma-
                                                           trices, which can be very frustrating after a while. A
                                                              Chapter 1: Biochemical networks in the matrix form -- 7/24

very important special form of the diagonal matrix is the     split into smaller matrices with the Laplace expansion:
identity matrix, with which has 1s as diagonal elements:
                                                              a bcd
       1 . . . 0                                              e f gh
             ..  .                                            i jkl
I  =:    ..  .                                                mnop
         .
       0 ... 1
                                                              f gh    e gh

YouTube: Identity matrix                                      = + a  j k l -b  i k l
Also frequently mentioned is the zero matrix:
                                                              nop     mo p

       0 . . . 0                                              e fh    e fg

                                                              +c i j l -d i j k

0  =:    ..  ..  .                                            mn p    mno
         .   .

         0 ... 0                                              Please pay attention to the alternating signs (+/-).
                                                              YouTube: Laplace expansion or cofactor expansion
One characteristic specifically of a square matrix is the     Laplace expansion can be coupled with the Gauss method,
trace. The trace is the sum of the diagonal elements:         as shown in Example 5.

                         n

     tr(A) =  aii = a11 + a22 +    + ann

                       i=1

YouTube: See also the symmetric matrix

 Determinant
The determinant gives the area in a 2-by-2 matrix and
the volume in a 3-by-3 matrix. What does it mean when
the determinant is equal to zero for a 2-by-2 matrix? It
means that the area of the matrix is equal to zero and
therefore the vectors that compose the matrix are linear-
dependent. In other words, it means that the vectors
have parallel directions. From high school, we know that
we can describe the position of any point y of a line in a
function as an Origin O and a constant (c) that multiples
a non-zero vector v (y = c  v + 0). For a plane and space,
any point can be described as a linear combination of two
independent vectors, respectively. Consequently, if the
two vectors are linear-dependent, we are no longer able
to describe any point in the plane, but only the points
that are situated on a line that is parallel to the vectors.
For 3-by-3, a determinant of zero indicates that at least 2
of the 3 vectors are linearly dependent and therefore only
the point located on a plane can be described by this set
of vectors. More generally, a matrix with a determinant
of zero describes a transformation of the system that
reduces its dimensions by 1. It is possible to collapse
a system to lower the number of dimensions, but the
opposite is not possible. Therefore, the inverse of matrix
A with the determinant of A equals zero, which would
geometrically result in an expansion of the system to a
higher number of dimensions. This is not possible.

det(A) = a b = ad - bc.
            cd

One possibility for calculating a determinant is via the
initial reduction of the matrix. Larger matrices can be
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                   8/24

Figure 9. Geometrical interpretation of the matrix inverse and determinant impact. Left: |A| = 1. Right: |A| = 3 [4].
Copyright  2021, Stack Exchange Inc, Licence: CC BY SA.

Example 5: Determinant after reduction with Gauss                  Inversion
                                                                  An invertible matrix A has linear-independent rows and
                 I) 1 3 2 -6 1 3 2 -6                             columns. A matrix B is uniquely determined by A, if one
det(A) = II - I) 1 2 -2 -5 = 0 -1 -4 1                            has the symmetric and invertible matrix:

             III - 2I) 2 4 -2 -9 0 -2 -6 3                               AB = BA = I
             IV - 2I) 2 4 -6 -9 0 -2 -10 3
                                                                  with identity matrix I.
The second row minus Row I, and Row III and IV
minus 2 times the first row, gives the right matrix.                  Example 6: Inverse interpreted geometrically
Laplace expansion (see later) gives us the lower
right matrix block. Further reduction and an ad-                  Geometrically one can interpret the matrix [4]
ditional isolation of the lower right block result in:
                                                                  A= 2 1    with related vectors                           a1 = 2 1
    -I) -1 -4 1 1 4 -1 2 1                                              11                                                 a2 = 1 1
  II - 2I) -2 -6 3 = 0 2 1 =
  III - 2I) -2 -10 3 0 -2 1 -2 1                                  as an area in a 2-dimensional (2D) coordinate sys-
                                                                  tem shown in Figure 9 left in red. The shape of the
= 2  1 - 1  (-2) = 4                                            inverse in blue is rotated by 90 degrees and is small
                                                                  in the directions where A is large. The vector a2 is
    A reduction is not always possible. The determinant           at right angles to a1, and a1 is at a right angle to a2.
of a 3-by-3 matrix can be obtained with the the rule of           The determinant |A| describes the area in 2D and
Sarrus,1 where the first two columns can be written be-           the volume in 3D. Here, the determinant |A| = 1 is
side the determinant to facilitate the optical assessment         one, and the area is preserved. If we change the
of the diagonal product:                                          matrix

abc   ab  abc                       ab                            A= 2 1    with related vectors                           a1 = 2 1
de f  de  de f                      de                                  12                                                 a2 = 1 2
      gh
gh i      gh i                      gh

abc                                                               to get another determinant |A| = 3, we see that the
                                                                  area is changed.
d e f = +(a e 톓+b f 톑+c d 톒)
g h i -(c e 톑+a f 톒+b d 톓)

Determinants can also be solved efficiently with the LU           We use Cramer's rule:                  i = 1, . . . , n
decomposition explained in Example 10.                                   xi = det(Ai) det(A) = |Ai| |A|
YouTube: The determinant
                                                                  with the site determinant |Ai| to find the inverse analyt-
    1 French mathematician: Pierre Frdric Sarrus (1798--1861).  ically. The cofactors of the Laplace expansion can be
                                                            Chapter 1: Biochemical networks in the matrix form -- 9/24

saved in the so-called matrix of cofactors or comatrix C.   This equation states that the rank computed on the rows
Its transposed version CT is the adjugate matrix:           is equal to the rank obtained on the columns and there-
                                                            fore, by definition, the rank of a matrix cannot be greater
                             C11 C21 . . . Cn1              than the number of rows and columns in this matrix. In
                                                            other words, if a matrix B has 6 rows and 2 columns, we
-1 1 T 1                     1 C12 C22 . . . Cn2            can deduce that the rank is smaller than or equal to 2 as
A = C = adj(A) =  . . . .                                   the rank cannot be greater than the number of columns.
|A|  |A|                     |A|  .. .. . . ..              Consequently, a non-square matrix has by definition at
                                                            least one linear-dependent column or row. For our ma-
                             C1n C2n . . . Cnn              trix B, we know that we have at least 4 linear- dependent
                                                            rows as we have 6 rows and the rank is smaller or equal
Inversion of a 2 x 2 matrix                                 to 2. The Gauss elimination is used determine the rank
                                                            of a matrix by producing as many zeros as possible in the
A-1 = a b -1 = 1 d -b = 1                  d -b             hope of removing as many rows or columns as possible,
                                                            which results in the reduction of dimensions.
cd   det(A) -c a ad - bc -c a                               YouTube: Rank

Inversion of a 3 x 3 matrix                                  Solving a set of linear equation sets
                                                            Naive solving of a linear equation set can be very time-
     ab c                                                   consuming.
                                                            YouTube: Naive solving of a linear equation set
A = d e f                    A-1 = 1 CT                     We should start to check whether an equation set is solv-
                                      |A|                   able. The set of linear equations is solvable if the rank of
     gh i                                                   the coefficient matrix A equals the rank of the augmented
                                                            coefficient matrix (A|b).
      ef       -d f             d e
     + h i        gi         +g h                               Example 7: Trivial solution only
     
               +a c                      
                  gi                     
C = - b c                                
      hi       -a c          - a b  g h 
                  df                     
                                         
      bc                                 
                             +a b 
       +e f                      de

                             -(di - f g)                                    2x1 + x2 = 0        I
         +(ei - f h)         +(ai - cg)   +(dh - eg)
                             -(a f - cd)  -(ah - bg)                        x1 - x2 = 0         II
 C =  -(bi - ch)
                             -(bi - ch)   +(ae - bd)        gives:                 x1 = x2
         +(b f - ce)         +(ai - cg)                                     2x2 + x2 = 0
                             -(ah - bg)                            II :
                                          +(b f - ce)               in I :         x1 = x2 = 0
         +(ei - f h)                      -(a f - cd)
CT = -(di - f g)
                                          +(ae - bd)
         +(dh - eg)

YouTube: Inverse of a matrix                                This is a trivial solution. Did we have a chance to
YouTube: Solve a linear equation set with the inverse of    find this out earlier?
a Matrix                                                    We have a homogeneous system with as many equa-
                                                            tions m as variables n.
 The rank
Often, matrices derived from linear equation sets can be           rk 2 1 = 2 = n
reduced, as not all equations are necessary to describe                 1 -1
the system. We often search for the minimal matrix,
which is described by the number of linear-independent      which indicates that we only have trivial solutions
rows or columns. Linear- independent rows and columns       according to the Rouch-Capelli theorem. Because
are sets of rows or columns where none of the rows or       the determinant is also non-zero:
columns is a linear combination of the others (example
of linear dependency: Row 1 equals to the sum of Rows              det 2 1 = -2 - 1 = -3 = 0
2, and Row 3 or Column 3 is three times Column 1. The                    1 -1
number of linear-independent rows or columns is the
rank of a matrix:                                           we would also not expect that the system is going
                                                            to lose a dimension. Consequently, we expect only
       rank(A) = rank(AT ) = rk(A)                          trivial solutions.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                               10/24

       rank(A) = rank(A|b)                                            Example 9: Cramer's Rule 2x2 matrix

If the matrix is quadratic with m = n and the determinant             Consider the linear system:
is not zero, then the set of linear equations is solvable.
In a homogeneous system Ax = 0, it only leads to trivial              a11x1 + a12x2 = b1
solutions a11 = a12 . . . amn = 0 or x1 = x2 . . . xn = 0. In an in-  a21x1 + a22x2 = b2
homogeneous system we get a unique solution. If m < n
the the rows or columns are linear-dependent. Thus,                   which in matrix format is:
the related homogeneous system Ax = 0 has non-trivial
solutions, which is good. If m < n, the inhomogeneous                 a11 a12 x1 = b1 .
system has many non-unique solutions. The rules are                   a21 a22 x2             b2
summarized in the Rouch-Campelli theorem. We illus-
trate this with two examples, 7 & 8.                                  The Cramer Rule is then:

    Example 8: Non-trivial solution                                                  b1 a12
                                                                             x1 = b2 a22 = b1a22 - a12b2 ,
                2x1 + 2x2 = 0      I
                                                                                     a11 a12 a11a22 - a12a21
                -x1 - x2 = 0       II                                                a21 a22

gives:                   x1 = -x2                                                    a11 b1
              - 2x2 + 2x2 = 0                                                x2 = a21 b2 = a11b2 - b1a21
          II
       in I                                                                          a11 a12 a11a22 - a12a21
                                                                                     a21 a22

choose x2 =  to get the solution:                                     The denominator (fraction below) is not allowed to
                                                                      become zero which explains why the determinant
                                                                      of A must be non-zero.

x1 = -                                                                The Cramer Rule visualizes the resolvability but it takes
x2            
                                                                      too much effort to get the solution. The solving process

What would we expect? According to the Rouch-                        is faster when one subtracts rows stepwise from each
Capelli theorem we have many non-trivial solu-
tions because we have a homogeneous system with                       other to bring the augmented coefficient matrix into a
fewer equations m than variables n:
                                                                      certain form. Either in the Gauss form (row-echelon
       rk 2 2 = 1 < n
            -1 -1                                                     form):  
                                                                            렁렁
                                                                                                            
                                                                            0                           
                                                                      A b =  0 0 0   .
                                                                            000렁
and the determinant also indicates a loss of one
dimension:                                                            with as many zeros as possible in the lower left-corner,

       det 2 2 = -2 + 2 = 0                                           or in the Gauss-Jordan form:
             -1 -1                                                         0 0 0                           
                                                                            0                       0    
                                                                                                           .
                                                                      A b = 0 0 0                       
                                                                            000
A set of linear equations can be solved with the Rule of
Cramer:                                                               with as many zeros as possible in the lower-left and

       xi = det(Ai) det(A) = |Ai| |A| i = 1, . . . , n                upper-right corner. If one eliminates the elements with

using the site determinant |Ai|. The side determinant |Ai|            the largest absolute value first, one reduces rounding
is the determinant |A| where the ith column is replaced
by column vector b.                                                   mistakes. This is called pivoting. The row-echelon form
YouTube: Cramer's Rule -- 2x2 and 3x3 matrices
                                                                      becomes a reduced row-echelon form if every leading

                                                                      coefficient is 1 and is the only non-zero entry in its col-

                                                                      umn:  
                                                                            1 = 1 = 1 = 1 
                                                                            0             1         = 1  = 1         
                                                                                                                    
                                                                      A b =  0 0 0 1  .
                                                                            00 0 1
                                                           Chapter 1: Biochemical networks in the matrix form -- 11/24

We have three types of elementary row (column) opera-      Additional reading
tions:
                                                           In practice, software usually uses more efficient
     Interchanging two rows (columns)                     algorithms like the LU decomposition.a The LU
                                                           decomposition dissects a matrix A into two fac-
     Multiplying a row (column) by a real number          tors: a lower triangular matrix L and an upper
                                                           triangular matrix U :
     Adding a multiple of one row (column) to another
       row (column).                                                    A = LU
                                                           a11 a12 a13 l11 0 0  u11 u12 u13
If we bring the Gauss form back to the equation set form,  a21 a22 a23 = l21 l22 0   0 u22 u23
we get:                                                                        l31 l32 l33 0 0 u33
                                                           a31 a32 a33
       a11x1 + a12x2 +    + a1nxn = b1
                 a22x2 +    + a2nxn = b2                It resembles the Gauss elimination, whereby the
                                                 ..        upper triangular matrix can be compared with
                                                 .         the Gauss form and the lower triangular ma-
                                     amnxn = bm            trix collects the steps necessary to get the Gauss
                                                           form. The diagonal elements are usually set to
where we can get our x values by working from the bot-     one l11 = l22 = l33 = 1 for convenience and because
tom to the top. If it is in the Gauss-Jordan form, we can  we have more unknowns than equations. As you
directly read the solution.                                already saw in the Gauss elimination, it is practi-
YouTube: Gauss and Gauss-Jordan elimination                cal to change row and column entries. Therefore,
                                                           algorithms use a permutation matrix P to change
                                                           the rows of matrix A and the permutation ma-
                                                           trix Q to change the columns of matrix A. A is
                                                           multiplied by P from the left and by Q from the
                                                           right. A permutation matrix has n 1s and other-
                                                           wise zero entries. Each row and each column has
                                                           only a single 1. It could look like:

                                                           0 1 0                          1 0 0
                                                           P = 1 0 0 or Q = 0 0 1
                                                           001                            010

                                                           The LU decomposition is then:

                                                           PAQ = LU

                                                           The solution of the system with linear equations
                                                           can be obtained with setting the LU decomposi-
                                                           tion into the general equation set form:

                                                                  Ax = b  LU x = b  Ly = b and U x = y

                                                           Solving first Ly = b and then U x = y gives us x
                                                           as shown in the following Example 10 and the
                                                           video:
                                                           YouTube: LU decomposition

                                                               a Polish mathematician: Tadeusz Banachiewicz (1882--
                                                           1954).
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                           12/24

Example 10: LU decomposition of 2-by-2 matrix           Yes, it works.

                                                        Extra:

We have the system:                                     In the Gauss elimination, we would multiply the
         6 1 x1 = 1                                                          2
         4 2 x2 2                                       first  row  by       3     (from        L)    and    subtract  this  from  the

                                                        second row:

                                                                     6                         12 =U =             61
                                                                          2                                            4
We dissect the matrix A into the lower and upper                4- 3 6 2- 3 1                                    03
triangular matrix:
                                                        Determinant:

     6 1 = l11 0 u11 u12 .                              The determinant is easier to solve with the LU de-

     42              l21 l22 0 u22                      composition because it depends only on the diago-
                                                        nal elements. The determinant is det(A) = det(L) det(U ).
                                                        The determinant of the matrix det(A) = (11)(l11l22)
We obtain the original matrix if we multiply the                     1          1        4     6)     8
lower with the upper matrix. We obtain 4 equations      (u11u22)  =                 (  3        =     is  only  dependent  on   the
with 6 unknowns:
                                                        diagonal entries.
           l11  u11 + 0  0 = 6
         l11  u12 + 0  u22 = 1                            The storage demand for the lower and upper coef-
          l21  u11 + l22  0 = 4                       ficient matrix can be huge. Thus one can make use of
       l21  u12 + l22  u22 = 2                        many zero values and use iterative procedures with esti-
                                                        mators. An example is the Gauss-Seidel method,2 which
This underdetermined system allows us to set 2          needs much less storage but cannot be used for paral-
variables to arbitrary non-zero values such as 1 for    lel computing. For matrices larger than n = 1000, the
the diagonal elements of the lower matrix: l11 =        Strassen algorithm3 might be faster with lower numeric
l22 = 1. This is up to you to decide. We would          stability. Only the Coppersmith-Winograd algorithm4
get infinitely many ways as there are also many         is even faster but only for matrices too big for modern
ways to perform a Gauss elimination. We need only       computers.
1 convenient LU decomposition. The following
matrix entries are then:                                 Eigenvectors and Eigenvalues
                                                        Modeling complicated systems can result in very ugly
       u11 = 6, u12 = 1, l21 = 23 , u22 = 43 .          mathematical problems. Instead of solving these kinds
                                                        of problems, mathematicians transform the space until
Substituting these values into the LU decomposi-        the problem becomes easier to solve. The solution of
tion above yields:                                      the nice, beautiful system can then be transformed back
                                                        to the original space. Imagine, you are sitting in your
     61 10 61                                           room, and you damn the authors of this script, the ex-
     42        =2                    4 = LU .           pectations, and math in general. Now, you squeeze and
                     3103                               stretch the dimensions of your room until this sheet of
                                                        paper becomes infinitely small and your head so big that
Solving Ly = b gives:                                   you master its challenges without any problem. After
                                                        you are done, you multiply your entire existence with
     1 0 y1 1                                           the inverse of the transformation matrix and find a fully
     3 1 y22         =    2                             understood and solved script in front of you. How com-
                                                        plicated a problem is also depends on psychology. Forget
and  thus  y1  =  1  and  y2  =  4.  Solving  Ux  =  y  everything around you; allow yourself to make mistakes
                                                        and to be a child on discovery. The exam is not impor-
                                 3                      tant, but the excitement to learn and the willingness to
                                                        improve is. This is my favorite psychologic transforma-
     6 1 x1               1                             tion matrix. Give it a try. So why is this imagination
           4         =4                                 important for the Eigenvectors? Eigenvectors are the
     0 3 x2               3
                                                        directions in space, which are not deformed during
gives us the solution x2 = 1 and x1 = 0. Let's check
whether the solution is correct:                        transformation. Imagine, everything gets squeezed and

         6 1 0=1                                            2 German mathematician: Philipp Ludwig von Seidel (1821--1896).
         42 1 2                                             3 German mathematician Volker Strassen (1936--today).
                                                            4 Israeli American computer scientist Shmuel Winograd (1936--
                                                        today) and American mathematician Don Coppersmith (1950--
                                                        today).
                                                             Chapter 1: Biochemical networks in the matrix form -- 13/24

changes--just not in the directions of these Eigenvectors.   The term det(A -  I) creates a polynomial which
The directions along the Eigenvectors become merely          we call a characteristic polynomial with maximal n
scaled by the Eigenvalue. Would it not be wonderful to       solutions for a nxn matrix. Setting it to zero causes
see a problem related to these vectors, compared to an       it be renamed a characteristic equation. Now we
original unfavorable coordinate system? But how can we       have the Eigenvalues 1 = 6 and 2 = 1 and search
find out which directions are not influenced by a trans-     the related Eigenvectors starting with 1 = 6:
formation? Let's say we have a transformation matrix A
and look for a vector v that can only be scaled by a factor  (A -  I)v = 0
but not deformed by a matrix. Then we could just say
that the matrix is only like a factor. Let us call it  and   3 6-6 0  v=0
imagine the Eigenspace:                                      14 06

       Av = v                                                -3 6 v = 0
                                                              1 -2
The idea is not bad, but the right side does not have the
same structure as the left one. The identity matrix helps:   to obtain the Eigenvector v1 = 2 directly. We can
                                                                                                      1
       (A -  I)v = 0
                                                             also write it in more detail:
The matrix (A -  I) should now be singular, to get non-
zero solutions for the Eigenvector v. The Eigenvector               -3va + 6vb = 0
v = 0 would be trivial and useless. A matrix is singular                va - 2vb = 0
if its determinant is zero:
                                                             resulting in va = 2vb for the first equation. The
       det(A -  I) = 0,                                      second equation gives 2vb - 2vb = 0 which means
                                                             that vb can be everything but the equation set is
which also means that the matrix is not invertible. We are   still solved. We have infinitely many solutions. So
interested in vectors, which are scaled but not deformed     we can set va = 2 with which we know that vb must
by a transformation matrix A multiplied by the left. We      be one vb = 1. We obtain the non-unique solution
calculate first the Eigenvalues and than the Eigenvectors.   v1 = 2 . The reason is that we can only stretch the

Example 11: First Eigenvalues than Eigenvectors                      1

                                                             Eigenvectors.
                                                             We proceed with the second Eigenvalue 2 = 1:

We take the matrix:                                          (A -  I)v = 0
         36
         14                                                  3 6-1 0  v=0
                                                             14 01

and get the Eigenvalues by:                                  2 6 v=0
                                                             13

A -  I = 3 -  1 4 6-                                         to obtain Eigenvector v2 = -3 .
                                                                                                   1

det(A -  I) = 0 = (3 -  )(4 -  ) - 6

0 =  2 - 7 + 6                                               Summary:

0 =  2 + p + q (p-q-equation)                                    1 Use the determinant of (A - I) to get a polynomial
                                                                    of degree n.
           p                 p2
1,2 = - 2                   2 -q                                2 Find the Eigenvalues by identifying the roots of
                                                                    the characteristic equation with det(A -  I) = 0.
   1,2 = 72  -72                     2
                                                                 3 Find to each Eigenvalue the associated Eigenvector
   1,2 = 72  52                       -6                           via (A -  I)v = 0.
   x1 = 1
   x2 = 6                                                    If all Eigenvalues have another value, we call them sim-
0 = ( - 6)( - 1).                                            ple and the associated Eigenvectors are independent. If
                                                             an Eigenvalue appears several times, we say that the
                                                             Eigenvalue has multiplicity k. Software programs like
                                                             MATLAB return normalized Eigenvectors with unit length.
                                                                1st Pr -2 -3                                                                     MM-AN                                                       0
                                                                    incipal C 0 -1                                                                                                                                 K MC -EP Mel yer Wo IGR -RU -A
                                                                                                             ompon 2 -3 1                                                         2
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                           ent                                               1                                       PM-WM- M K- RP RP S Pre Me MM MM M

                                                                                                                              -1 -2 incipal Com 0 ponent                                                14/24
                                                                                                                              2nd Pr

                                                            E                                                                                                                                                         F

                                                                               TRAIL                                                                                                                                              DTIC

YouTube: Eigenvalues and Eigenvectors                       90 2Cell Death [%]                                                                                                         RPM-EP                                   2         3rd Principal Component
                                                                                    3rd Principal Component                                                                                                                   1.5
Fast equation for 2-by-2 matrix                             80                                               1.5            MeWo
For the dimension 2 to 4, we have fast equations to solve                                                                                                                                                                       1
the Eigenvalues. From the matrix:                           70                                               1                                                                                    RPM-MC                      0.5

                                                            60 0.5                                                          Preyer                                                                                              0
                                                                                                             0                                                                                                               -0.5
                                                                                                                                                                                MM-LH
                                                            50                                                                                                                                                                 -1
                                                                                                             -0.5                                                                                    SK-Mel                  -1.5

                                                            40                                               -1                                                                 PM-WK                                          -2
                                                                                                                                                                                                                               -4
ab                                                          30 -1.5                                                                                 A375
cd                                                                                                                                     IGR                                                                               1st Pri -2 -3nc -
                                                                                                                                                                                                                                   ipal C
                                                                                                             -2                                                                 MM-RU
                                                                                                                                                                                                                                  Co
                                                            20                                               -4                                                                                                       Drug clas

                                                            10 1st -2 -3                                                                                                               MM-AN
                                                            0 Principa 0 -1                                                                                                                                        2

we obtain the characteristic polynomial:                                                                                                                                                             1  nent

                                                                                                                                                                                            0
                                                                                                                         l Com 1                                                -2 ipa -1 l Compo
                                                                                                                            ponen 2 -3 2nd Princ
det  - a     -b  =  2 - (a + d)  + (ad - bc)                                                                                        t
       -c    -d  =  2 -  tr(A) + det(A)
                                                            Figure 10. PCA plot of cell lines. Location and sphere size
                                                            indicate which cell lines behave more similar than others. H

                                                                 G

                                                            Cell lines whichScahermeactilcoRseeprbeseehntaavtioen soifmLDiAlarly. Source: [5].

from which we get the Eigenvalues with the equation:        Copyrigh2t  2013, Macmillan Publi2shers Limited.
                                                                2nd Principal Component
                                                                                                                                                2nd Principal Component1 1

                                                                                                                              LDA

            tr2(A) - 4 det(A)                                   0                                                                                                        0
               2.
 = tr(A)                                                    More on biological data as a mat rix                                                                                                                   TRAIL
                                                            Often, the network topology is unkn own (but of course                                                                                                  DTIC

                                                                                                                 0     2                                                                   0        2
                                                            existent). D1est tPreincciptaleCdompomnentolecules change1st wPrinciiptahl Comtpiomnente, and
with the distance between Eigenvalues:
                                                            their behavior depends on their connection to other ele-

 =: tr2(A) - 4 det(A)                                       ments. Among them, interlinked elements correlate or

                                                            anti-correlate with each other. The more different pertur-

which will play a role in the stability theory in Block 3.  bations are applied, the more likely a valid connection
Additional information: for a matrix of higher dimen-
sion, it already seems to be more complicated.              can be detected. This is a property which can be used

       det (I - A) = 0                                      for, e.g., reconstruction of networks and for data-driven
            = 3 - 2 tr(A) -  12 tr(A2) - tr2(A) - det(A)
                                                            modeling. The simultaneous observation of more than
and for Dimension 4 it is not considered overly useful.
                                                            one outcome variable is the definition of multivariate

                                                            statistics. Related data-tables with multiple variables

                                                            are actually nothing other than matrices with molecular

                                                            features as rows and experimental datasets, conditions,

                                                            or organisms as columns:

Example 12: Get Eigenvalue via fast equations                                 Microarray 1
                                                                                   Microarray 2
A= 4 3                                                                                                                                                                                                  ...
       -2 -3                                                                                                      Cell line 1
                                                                                                                       Cell line 2
                                                                                                                         ...           Protein 1                                                         
                                                                                                                                                                                                       
                                                                Gene 1                                                                                                                         
                                                                                                                                       Protein 2   
gives tr(A) = 4-3 = 1, det(A) = 4(-3)-3(-2) = -6                Gene 2                                                                                                ..
and the characteristic equation:                                ..                                                                                                       .             렁
                                                                .                                                  렁
       0 =  2 -  - 6 = ( - 3)( + 2)
                                                            The columns represent the dimensions or coordinate
with Eigenvalues 3 and -2. The Eigenvectors are             axes of the data and the rows contain coordinate val-
worked out using:                                           ues on the given coordinate system. Consequently, each
                                                            gene is a vector in a coordinate system spanned by the
A - 3I = 1 3 ,         A + 2I = 6 3                         matrix columns.
             -2 -6                  -2 -1                   To illustrate the application of matrix calculation, we
                                                            will briefly discuss here the statistical method of Prin-
(3, -1) for Eigenvalue 3 and (1, -2) for Eigenvalue         cipal Component Analysis (PCA): sometimes, we want
-2.                                                         to know whether the columns, with all the row entries
                                                            projecting to them, have subsets that are more similar to
                                                            one another than to other data points. Now, imagine a
                                                            dataset with 40 coordinate axes representing 40 microar-
                                                            rays, and then try to place tens of thousands of points
                                                             Chapter 1: Biochemical networks in the matrix form -- 15/24

representing genes into this coordinate system. Horri-       Additional reading
ble! But maybe we can find another coordinate system
which is visually more inviting and more informative.        The PCA is related to the partial least square
Let's say 40 data points representing microarrays in a       regression (PLSR). Here, we separate our data
3-dimensional coordinate system, where the biggest dif-      matrix in two parts, whereby the upper part rep-
ferences between the microarrays are selected and are        resents phenomenological readouts such as via-
thus pronounced. The variability in each row causes the      bility:
differences between the microarrays. Data analysts use
Principal Component Analysis (PCA) to do exactly this.                  condition 1       ...
One starts with 1 additional coordinate axis which ex-                       condition 2  
plains the most variability in the old dataset. This is the             
first principal component. The algorithm then searches       Viability  렁
for another coordinate axis which is orthogonal (90)
to the first principal component and again describes as      Cell death   
much variability as possible. This procedure goes on                                      
until all genes project to the new coordinate system. Af-    Protein 1   
ter one has all these principle components, one neglects                                  
stepwise the components representing the lowest vari-        Protein 2   
ability until 2 to 4 remain. Ideally, the remaining princi-  ..
pal components explain more than 80% of the variability.     .          렁
Principal Component Analysis is used, e.g., as standard
quality control for microarrays. Are the treated and the     Both blocks are subject to a dimension reduction
untreated samples in two separate groups? Is one repli-      approach but now with the aim to maximize
cate completely different from the others and might it       the co-variance between both blocks. PCA uses
represent an outlier? As an example, PCA also helps us       the variance and PLSR uses co-variance. Such
to understand the microbiome better. Are different bac-      an approach is, e.g., used for systematic drug
teria types more closely related to others and how does      testing and for initial hints for network modeling.
it change if they are exposed to drugs or another diet?      An example is shown in Figure 11. The authors
A collection of micro-organisms might build one cluster.     created an high-dimensional data block with 5
After the diet is changed, the micro-organisms might be      different RAF/MEK inhibitors, 7 doses, 5 time
found in another cluster. Micro-organisms which have         points, 21 protein levels, and 10 other cell lines
not changed might not be affected by the diet change. In     [6]. Here, drug dose is the first and drug type is
Figure 10, you see an example with different cell lines      the second principal component. The adjusted
and their response to TNF-related apoptosis-inducing         variable importance in the projection (VIP)
ligand (TRAIL) [5]. The dataset contains the base level      explains which protein had the most prominent
of 17 core apoptosis proteins in 11 melanoma cell lines      negative or positive impact on the cell viability
under different conditions with 612 measurements in          at which time. This led to the identification of
total. The authors used network information to group         a consistent down-regulation of the JNK/c-Jun
proteins to functional network motifs, which allowed         pathway upon RAF/MEK inhibitor treatment at
a higher accuracy in estimating the apoptosis-inducing       early time points, but an up-regulation of 6 cell
impact of drugs.                                             lines at later time points. In 4 out of 10 cell lines,
YouTube: PCA step for step                                   JNK/c-Jun up-regulation caused a subset of cells
                                                             to become quiescent and apoptosis-resistant [6].

                                                                 We have learned that matrices are used in several
                                                             applications in biology. Matrices can represent biochem-
                                                             ical networks and data caused by them. In the following
                                                             section, we will learn how to work with matrices. These
                                                             basics are fundamental for the remainder of the book and
                                                             very useful for your career, independent of whether you
                                                             want to mainly work with the keyboard or the pipette
                                                             in the future. It will help us to analyze and understand
                                                             what we do.
-Sichani et al c-JIuMnno-hmtaremdomiadtaedduFaacdlltaaiphoti-ivSneichreatsnoisi teaStnacyel sintmce-eJmulann-sommeBadiaitoedloadgapytiv:e WresisotarnkcebinomoelkaMnoofmloeacrulaFr lSiypstepmes dBio-lCogylassrooMmolecTulearaScyhsteimnsgBiology                                                                                                    16/24

                          A Variable Importance in the ProjectioVnar(iVabIPle) bImypCoertllaLnicnee in the Projection (VIP) by Cell Line
                                                                                                                                                    Time (hr)                                                      Time (hr)

                                                                      Correlation with viability                                     1 Co5rrelatio1n0with v2ia4bility 48                         1  5                                  10         24 48

                                                                             -              +                                                       -            +

C32       COLO858         K2                                      LCO3X2IMVI CMOMLOA8C5S8F     MZK72MEL                              LORVXHIM4V2I1      MSMKAMCESLF28 MWZ7MM1E1L5                WRVMH1452512C SKMEL28                            WM115                                        WM1552C

                                p27 Kip1                                                                                                                                                            N/A                                                                                        N/A
                      p-Histone H3(S10)
   N/A                                                                N/A                                                                                   N/A                                                                            N/A
   N/A                            cPARP                               N/A
                                       Bim
   N/A                                                                N/A
   N/A                      p-NFKB(S536)                              N/A
                            p-HSP27(S82)
   N/A                    p-p38(T180/Y182)                            N/A

                               p-cJun(S63)
                              Total cJun
                          p-JNK(T183/Y185)
                            p-AMPK(T172)
                             p-S6(S235/236)
                         p-p70S6K(T389)
                     p-p70S6K(T421/S424)
                          p-mTOR(S2448)
                              p-AKT(S473)
                              p-AKT(T308)
                         p-p90RSK(T573)
                         p-p90RSK(S380)

2 0 2 4 4 2 0 2 4 4 2 0 2 4 44 22 002 24 4 4422002244 4 42 20 022 44 4 42 200 22 44 44 22 002 24 4 44 22002244 44 22002244 4 2 0 2 4 4 2 0 2 4 4 2 0 2 4

 P score  VIP score       VIP score                               VVIPIPscsocorere VVIPIPscsocroere VIVPIPscsocroere VVIPIPscsocroere                   VVIPIPssccoorere  VVIPIPssccoorere       VVIPIPssccoorere                      VIP score  VIP score                                    VIP score

3                    Figure 11. After the perturbation of the system with differ-
2
1                    ent conp27dKiipt1i(2o4,4n8 hs) , wp-ep38s(e1 he) whicp2h7 Kpip1r(2o4,4t8eh)in op-pnS368(t1(10h,h2)4e,48lhe) ft correlates p-S6 (10,24,48 h)
                          B Bim and cPARP (48 h) p-cJun (48 h)                                                 Bim and cPARP (48 h) pTo-ctaJul cn-J(4u8n h(2) 4,48 h)                                              Total c-Jun (24,48 h)

                     positivBiem lanyd                            c  PoARrP  n(24eh)gpa-p9t0iRvSKe(S3l80y) (1  0wh) iBtimha  n  d t  hcPAeRPc(2e4 hl)l  pp--pN9F0KRBS(K4(8S38h0)) (10 h)  y  in  differ-           p-NFKB (48 h)

                                                                                                                                                        variabilit
                                 p-AKT(T308) (24,48 h) p-p70S6K(T421/S424,T389) (1p0-Ah)KT(T308) (24,48 h) pTo-pta7l0cS-6JuKn(T4(211/0S42h4),T389) (10 h)                                                          Total c-Jun (10 h)

                     ent cepl-lp90lRiSnK(Se380)s(48sh)ucp-AhKT(asS473) (24Lh)OXp-Ip9M0RSVK(S38I0) (4o8 hr) Spp-K-AHK3TM(2(S447,34)E8(2h4)Lh) 28. The cell p-H3 (24,48 h)
                                 p-p70S6K(T389) (48 h) p-AMPK (48 h)                                           p-p70S6K(T389) (48 h) p-AMPK (48 h)
                     lines behave quite differently. The importance of each
                                                                  3                                                                                                                                                                                 Average relative resistance to all tested
                                                                                                                                                                                                                                                RAF/MEK inhibitors (normalized AUC)
                                                                                                                                                                                                                                                    1
                                                                                                                                                                                                                                                0.8
                                                                                                                                                                                                                                             0.6
                                                                                                                                                                                                                                         0.4

                                                                                                                                                                                           Average relative resistance to all tested
                                                                                                                                                                                        RAF/MEK inhibitors (normalized AUC)
                                                                                                                                                                                    1
                                                                                                                                                                                0.8
                                                                                                                                                                             0.6
                                                                                                                                                                          0.4
                     player depends on the time, so phospLOhXoIMrVIylated Histone LOXIMVI
                          (VIP > 1) score                         2                                                                                     WM115                                                                          WM115
                     H3 is first correlated with the cell viaWMb1i5l52iCty after 24h or WM1552C
                                                                  1                                                                                     SKMEL28                                                                        SKMEL28
                     48h. Figure source (cropped): [6], LiCc32ence: CC BY 4.0. C32sign (correlation with viability)

                                                                                                                                                        MMACSF                                                                         MMACSF

1                                                                 -1                                                                                    COLO858                                                                        COLO858

2                                                                                                                                                       MZ7MEL                                                                         MZ7MEL

                                                                  -2                        References RVH421                                                                                                                          RVH421

3                                                                 -3                                                                                    K2                N/A                                                          K2         N/A

                     [1]                                              19 signals  5 timepoints                                      19 signals  5 timepoints
                          Robert A Weinberg.
                                                                                                                                           Coming full cir-

ity in the magnitude, dirFeicgtuiorcen,l2a.endV--tairmiaiFbniglirtoyfoisnimgtnhaelimngagchneaitnungdeeds, idnlirreeecsstpiosn,seantdo ctRiAmoFi/nMmgEoKfpisnighlnibeailtixniognic.thyanges introesponsestoimRAF/pMElKiicnhiibtiytion.

and back again. Cell, 157(1):267-271, 2014. iable importance in the proAjecPtLioSnR-(dVeIPri)vsecdorveasriparbeldeicimtinpgorvtiaanbcileitiynftohreeapcrohjeocfttiohne t(VeInP)stsucdoireeds cperelldlicnteins.gVvIPiasbciolirteysfoareeashchowonf tfhoer teeanchstcuedllieldinece-sllpleinciefsic. VIP scores are shown for each cell line-specific

al and measurement time poimnto. dThele, edaircehctsiiognnaolf atnhde bmaeras s(ulerfetmoer nritgthimt) eshpoowinst.wThheethdeirretchtieonchoafntghees binarssig(lneaftl coorrrrieglhat)edshnoewgsatwivheelythoerrptohseitcivhealnygwesithin signal correlated negatively or positively with

 VIP scores of larger than one irnedlaictiavteeviimabpiolirttya.nVtIPvasrcioarbelesso(fsliagrngaelrs tahnadntoimne ipnodiinctast)ethimatpporteadnicttvtahreiarbelsepso(nsisgensa(lvsiaabnidlittyi)m. e points) that predict the responses (viability).

https://doi.org/10.1016/j.cell.2014.03.004. ustering of melanoma cell lBinesUbnassuepderovnistehdecVluIPstsecroinrgeso>f 1mferolamnoemacahcienlldliivnidesuablacseldl loinnethmeoVdIePl (secxocrleusd>in1gfrpoMmEKeaacnhdinpdEiRvKid).uParliocerltlolincleusmteordinegl ,(eVxIcPluding pMEK and pERK). Prior to clustering, VIP

 n 0 and 1 were set to zero andscaormesinoufsbseitgwnewenas0aadndded1 twoeVrIePssectotroeszaersosoacniadteadmwiintuhsssigignnalws athsaatdndeegdatoiveVlIyPcsocrorreelastaesdsowcitahtevdiawbiltihtys. iAgvnearlasgtehat negatively correlated with viability. Average

e of the cell lines to the[f2iv]e terestlaedtivReArFe/sMisEtaKnicnehiobfittohres c(oenll ltihneesritgoht)heis fcivoemtpeusted RbAaFse/Md EoKn ianrheiabiutnordser(otnhethteimrieg-hdto) sies-croemsppountseedcbuarsvedpolonttaerdeafournder the time-dose-response curve plotted for

Olaf Wolkenhauer. Why model? ability measured by single-celnl iomna-agpinogptaoctriocsvsiasebvileitny dmoeseasuarned tbwyositnimgle-pcoelilnitms (a4g8inagnadc7ro2ssh)sefovlelonwdionsgestraenatdmtewnot.tTimhee dpaotiantfsor(4t8heancedll7l2inhe)Kfo2llaorwe ing treatment. The data for the cell line K2 are

use clumping made it difficult ntotscshoroewsninbgelec-acueslel pchluemnoptiynpgesmiandtehits dceiflflicliunlet taoftsecro7r2e shi.ngle-cell phenotypes in this cell line after 72 h.

Fhrtotpnsti:/er/sdoi.oring/10.3P3h8y9s/ifoplohgyys,.2014.050:2012,1. 2014. ilable online for this figure.Source data are available online for this figure.

                  [3]

0.47, P = 0.02; se(eSpbeealroDmwa;na'Ssmupqpil=eam0n.e4n7t,aSrPyz=Fki0g.l0a2;rAscenzeeytbwekloorw,k;pAeSrusnppenlcetmiivkeenoatanryaLdaFpigtGivearAebsnpleoetnws,eosrKk paertspeerctiivne aon aCdaptive responses

e that the combinatSio2nP)o.fWRAe FcoanncdluJdNeKthinathitbhietioconmbination of RAF and JNK inhibition

n) increases apop(toorsisJUNiNn adsoesmptleotiovune)m, uinracfDreenaisabe-sviadpMopatpopsLisnygionVInPsov,maleueRsveomentuboraeafecsncichbe-amaticMKoafpipriminsmgceVhdIiPa,tev-aelauSrelsyaosmingtnoapalinosgchematic of immediate-early signaling
 to a level normalrlyesiosbtasPnertvyceedyllinslinaseeslnostoit,ivaelecNveelllsa,ndorme(azFlilgyh4odAb)saerevveedTalisn tsDheensoditiivnveercscihteylleso, fvaada(,FpitgivM4eAr)easrperovcneaselssLtthoee RgdAievFearasnyitdy, of adaptive responses to RAF and

  up-regulation of JimNKpl/yci-nJugnthiant mtheelanuopm-reaguclealtlison ofMJENKKi/nch-Jibuintioin wmiethlanreosmpeactcetollsmagnMituEdKeinanhdibittiimoningwi(tFhigre4sAp)e.ctInto magnitude and timing (Fig 4A). In

fenib exposure decrfeoallsoews TicnegallvokeimlliunFrgaafaennndibgthea,xtpothPsueree edernceraeraBlsyeoasllcrecklelll,kliilnliLensg,atahrnedsqtuhiaeJtsctehJneecenmsanreekaenrrlyp,a2l7l acaennldl ladinpeosp,tCothseihsqmruaiiersskc--ence marker p27 and apoptosis mark-

RAF and JNK inhicboitmorbsinamtiaoyn hoafveRAthFeraanpdeutJiNc K inehrisbictoPrAsRPmaayndhaBviem thweerraepeuupt-ircegulaetresd caPnAdRPmiatontdic BmimarkwererepHu3p-regulated and mitotic marker pH3
                          tian von Mering. The STRING database in 2021:
                     potential.                                                 down-regulated 24-48 h after drug exdpoowsunr-ree.gWulhateerdea2s4e-x4p8ohsuarfeteorf drug exposure. Whereas exposure of
                          customizable protein-protein networks, and

                      2015 fThue Anuthcorts ional characterization Moolefcular SyustesmseBriol-oguy p11l: o797a| 2d015ed5Molecular Systems Biology 11: 797 | 2015 5

                          gene/measurement sets. Nucleic Acids Res., 49(D1),

                          2021. https://doi.org/10.1093/nar/gkaa1074.

                     [4] math.stackexchange.com/questions/295250/geometric-
                         interpretations-of-matrix-inverses. December 2022.

                     [5] Egle Passante, Maximilian L Wrstle, Chris-
                         tian T Hellwig, Martin Leverkus, and Markus
                         Rehm. Systems analysis of apoptosis protein
                         expression allows the case-specific prediction
                         of cell death responsiveness of melanoma cells.
                         Cell Death and Differentiation, 20(11):1521, 2013.
                         https://doi.org/10.1038/cdd.2013.106.

                     [6] Mohammad Fallahi-Sichani, Nathan J Moerke, Mario
                         Niepel, Tinghu Zhang, Nathanael S Gray, and Pe-
                         ter K Sorger. Systematic analysis of brafv600e
                         melanomas reveals a role for jnk/c-jun pathway
                         in adaptive resistance to drug-induced apopto-
                         sis. Molecular Systems Biology, 11(3):797, 2015.
                         https://doi.org/10.15252/msb.20145877.
                                                         Chapter 1: Biochemical networks in the matrix form -- 17/24

                3. Exercises                              Determinant
                                                         Find the determinants of the following matrices:
 Representation
Write the following systems of equation in matrix form:  3 -2                                              (3.12)
                                                         15
y1 = 2x1 + 3x2
y2 = x2 - 5x1                           (3.1)            3 -2 1
                                                         1 5 0
x = 1 - x - y                                                                                              (3.13)
y = 1 + x - y                                              2 -1 7

                                        (3.2)            3 -2 2
                                                         1 5 0
y1 = 11x1 + 12x2 + 13x3                                                                                    (3.14)
y2 = 22x2 + 21x1 + 23x3                                    2 -1 0
y3 = 33x3 + 32x2 + 31x1                 (3.3)

                                                         3 -2 2 2 
                                                         1 5   1   2             
Write the following matrix equation as a system of dif-                                                    (3.15)
ferential equations:                                     2 -1 -1 -2                                        (3.16)
                                                         12 3 1
d x1 = 3 -2         x1 + 1 u
dt x2          15   x2               0  (3.4)             Rank and inversion
                                                         Determine the rank of:
 Basic operations on matrices
Perform the following calculations:                                3 -2
                                                                  -6 4

3 -2 + 4 -4 =                           (3.5)
15              30                                                3 -2
                                                                  6 -3
3 -2 - 4 -4 =                           (3.6)                   3 -2 1                                     (3.17)
15              30                                              1 5 0                                      (3.18)
                                                                   123                                     (3.19)
5 3 -2 =                                (3.7)                   1 1 -3                                     (3.20)
    15                                                          1 -1 2                                     (3.21)
                                                                   2 0 -1
3 -2   4 -4 =                           (3.8)            Invert the following matrix:
15     30                                                         3 -2
                                                                  63
4 -4   3 -2 =                            (3.9)                  2 1 -1
30     15                               (3.10)                  0 2 1 
                                                                   5 2 -3
Transpose the following matrices:
         3 -2 T =
         15

3 -2 1T                                 (3.11)
1 5 0 =

  2 -1 7
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  18/24

 Linear systems of equations
Solve the following systems of equations (Ax = b). Con-
sider thereby the rank of the coefficient matrix A and of
the augmented coefficient matrix (A|b).

2x1 + x2 - x3 = 0   (3.22)
       x2 + x3 = 0

2x1 + x2 = 0        (3.23)
 x1 - x2 = 0

x1 + 2x2 = 1        (3.24)
x1 + 2x2 = 2

5x1 + x2 = 2        (3.25)
x1 - 2x2 = 7

2x1 + x2 - x3 = -5  (3.26)
       x2 + x3 = 1
Notes
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                         20/24

                        4. Solutions                           Task 3.9

                       Do not betray yourself!                           4 -4    3 -2 =
                                                                         30      15
Exercises
 Representation                                                          12 - 4 -8 - 20 = 8 -28
Task 3.1                                                                 9 + 0 -6 + 0    9 -6

       y1 = 2x1 + 3x2   2x1 + 3x2 = y1                         Task 3.10
       y2 = x2 - 5x1         -5x1 + x2 = y2
                                                               3 -2 T = 3 1
                            23         x1 = y1                 15                -2 5
                           -5 1        x2          y2

Task 3.2                                                       Task 3.11
       x = 1 - x - y
       y = 1 + x - y       -1 -1                x+1    = x     3 -2 1T  3 1 2 
                            1 -1                            y  1 5 0 = -2 5 -1
                                                y  1                     2 -1 7        107

Task 3.3

              y1 = 11x1 + 12x2 + 13x3                           Determinant
                                                               Task 3.12
              y2 = 22x2 + 21x1 + 23x3
                                                               det 3 -2 = 3 -2 = (3  5) - (1  (-2)) = 17
              y3 = 33x3 + 32x2 + 31x1                                     15     15
                              
          y1    11 12 13 x1
y2 = 21 22 23 x2
          y3                                                   Task 3.13
                31 32 33 x3                                               3 -2 1

Task 3.4                                                              det 1 5 0 = (3  5  7) + (-2  0  2) + (1  1  (-1))
                                                                             2 -1 7
d x1 = 3 -2                x1 + 1 u
dt x2           15         x2          0                                                     - (2  5  1) - (-1  0  3) - (7  1  (-2))
                                                                                             = 108

dx1 = 3x1 - 2x2 + u                                            Task 3.14
dt                                                                      3 -2 2
dx2 = x1 + 5x2
dt                                                                  det 1 5 0 = 0 + 0 - 2 - 20 - 0 - 0 = -22 (4.1)
                                                                          2 -1 0
 Basic operations on matrices
Task 3.5                                                       Task 3.15

3 -2 + 4 -4 = 7 -6                                             3 -2 2 2
15                     30      45                              15 1 2
                                                               2 -1 -1 -2
Task 3.6                                                       12 3 1

3 -2 - 4 -4 = -1 2                                                        512            11 2
15                     30      -2 5
                                                               = 3 -1 -1 -2 - (-2) 2 -1 -2
                                                                          231            13 1
Task 3.7

5 3 -2 = 15 -10                                                           15 2         15 1
                                                               + 2 2 -1 -2 - 2 2 -1 -1
          15           5 25                                               12 1         12 3

Task 3.8                                                       = 3(-5 - 4 - 6 + 4 + 30 + 1)

          3 -2  4 -4 =                                         + 2(-1 - 2 + 12 + 2 + 6 - 2)
          15    30
                                                               + 2(-1 - 10 + 8 + 2 + 4 - 10)

          (3  4) + (-2  3) (3  (-4)) + (-2  0) =   6 -12   - 2(-3 - 5 + 4 + 1 + 2 - 30)
           (1  4) + (5  3) (1  (-4)) + (5  0)      19 -4
                                                               = 138
                                                                       Chapter 1: Biochemical networks in the matrix form -- 21/24

 Rank and inversion                                                    Task 3.22
Task 3.16
                                                                              2x1 + x2 - x3 = 0
          3 -2 II + 2  I 3 -2  Rank is 1                                            x2 + x3 = 0
         -6 4 = 0 0

Task 3.17                                                              We start with the first equation:
         3 -2 II - 2  I 3 -2  Rank is 2
         6 -3 = 0 1                                                      I - II :  2x1 - 2x3 = 0
                                                                       x1 =  :     2 - 2x3 = 0

Task 3.18                                                                                         x3 = 
       3 -2 1 I - 3  II 0 -17 1
       1 5 0 = 1 5 0  Rank is 3                                        and use the parametric  . Then we solve the second
          1 2 3 III - II 0 -3 3                                        equation:

Task 3.19                                                                     x3 =  in II : x2 +  = 0
       1 1 -3 II - I 1 1 -3
       1 -1 2  = 0 -2 5                                                                                x2 = - .
          2 0 -1 III - 2  I 0 -2 5
                             III - II 1 1 -3                           and get the parametric solution or general solution (x1, x2, x3) =
                               = 0 -2 5  Rank is 2                     ( , - ,  ). The matrices are:
                                       00 0
                                                                       A = 2 1 -1  Rank is 2
                                                                              01 1

Task 3.20                                                              Ab =                  2 1 -1 0      Rank is 2.
        3 -2 = 9 + 12 = 21                                                                   01 1 0
        63
                                                                       We have 3 variables but only 2 equations. One of the
3 -2 -1 1 3 2                                                          variables has to be chosen (or treated as a parameter)
6 3 = 21 -6 3                                                          and the solution for the 2 other variables will depend on
                                                                       this choice or the parameter. Because we have infinite
Task 3.21   -1                                                         different choices for this parameter (often called lambda
        21   1 = -12 + 5 + 10 - 4 = -1                                  ), we have infinite solutions.
        02  -3
        52                                                             Task 3.23

                                                                              2x1 + x2 = 0
                                                                                x1 - x2 = 0

2 1 -1-1                                                                      I + II :          3x1 = 0
0 2 1  =                                                               x1 = 0 in II :            x1 = 0

  5 2 -3                                                                                     0 - x2 = 0
                                                                                                 x2 = 0
   +[2  (-3) - (1  2)]     -[0  (-3) - (1  5)]  +[0  2 - 2  5]T
- -[1  (-3) - (-1  2)]    +[2  (-3) - (-1  5)]  -[2  2 - 1  5]   The matrices are:
                                                    +[2  2 - 1  0]                     A=
       +[1  1 - (-1  2)]    -[2  1 - (-1  0)]
                                                                                 Ab =
                                 -8 5 -10T                                                   2 1  Rank is 2
                            = -  1 -1 1                                                      1 -1

                                     3 -2 4                                                  210           Rank is 2.
                                  -8 1 3                                                     1 -1 0
                            = -  5 -1 -2
                                                                       We have 2 equations and 2 variables with exactly 1 solu-
                                    -10 1 4                            tion.
                                8 -1 -3
                            = -5 1 2                                   Task 3.24

                                  10 -1 -4                                    x1 + 2x2 = 1
                                                                              x1 + 2x2 = 2
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                           22/24

I - II : 0 = -1                                           and then we solve the second equation:

The equation set is inconsistent. The matrices are:       x2 = -2 -  in II :    -2 -  + x3 = 1
                                                                                            x3 = 3 +  .
A = 1 2  Rank is 1
       12

Ab =                      121              Rank is 2.     Alternative 2:
                          122                             2 equations with 3 unknowns. 1 is flexible. Choose
                                                          x3 =  .
Task 3.25
                                                          I - II :         2x1 - 2x3 = -6
       5x1 + x2 = 2                                                                 x1 = -3 + 
       x1 - 2x2 = 7
                                                                          II : x2 + x3 = 1
Alternative 1:               11x1 = 11                                              x2 = 1 - 
            2  I + II :        x1 = 1
                                                          The matrices are:     2 1 -1  Rank is 2
       x1 = 1 in II :     1 - 2x2 = 7                                       A=  01 1
                                x2 = -3
                                                                    Ab =
The matrices are:         5 1  Rank is 2                                        2 1 -1 5         Rank is 2.
                  A=      1 -2                                                  01 1 1

          Ab =            512              Rank is 2.         More variables than equations. Thus, we have infi-
                          1 -2 7                          nite solutions.

We have 2 equations and 2 variables with exactly 1 solu-  The number of solutions of linear equation sets can also
tion.                                                     be determined with the Rouch-Capelli theorem5 sum-
                                                          marized in Table 1.

Alternative 2:
We use Cramer's Rule now with the determinants:

         det(A) = 5 1 = -10 - 1 = -11
                     1 -2

       det(A1) = 2 1 = -4 - 7 = -11
                     7 -2

          det(A2) = 5 2 = 35 - 2 = 33
                        17

which finally give:

       x1 = det(A1) det(A) = -11 -11 = 1
       x1 = det(A2) det(A) = 33 -11 = -3

Task 3.26

       2x1 + x2 - x3 = -5
              x2 + x3 = 1

Alternative 1:                                                5 French mathematician: Eugne Rouch (1832--1910).
We start with the first equation:                         Italian mathematician: Alfredo Capelli (1855--1910).

           I + II : 2x1 + 2x2 = -4
        x1 =  : 2 + 2x2 = -4

                               x2 = -2 - 
                                                         Chapter 1: Biochemical networks in the matrix form -- 23/24

Table 1. Overview: Solutions of linear equation systems
(Rouch-Capelli theorem)

                              homogeneity

                    Ax = b                       Ax = 0
                                      (homogeneous system)
                 m equations
                 n variables

Rk(A|b) = Rk(A)  system unsolvable    not possible for b = 0
                      Task 3.24       homogeneous systems

                                          always solvable

Rk(A|b) = Rk(A)             system solvable
m=n
                 unique solution      trivial solution
                                           (x = 0)

                 Task 3.25                 Task 3.23

m<n              non-unique solution  non-trivial solutions
                        Task 3.26            Task 3.22
Notes
Chapter 2: Metabolic modeling

Thomas Sauter, Marco Albrecht

  Motivation
  Metabolism is a mirror of many biological processes and extracellular metabolites can be accessed with relatively
  robust measurements. Moreover, basic analysis with a stoichiometric matrix (representing a metabolic network)
  can be adopted by many researchers because it is mainly based on linear algebra. However, well-trained experts are
  needed for the analysis of dynamic behavior, contextualization, and advanced research questions. Metabolism can
  also be analyzed on a large scale, e.g. with graph-theoretical approaches or in more detail with deep, mechanistic,
  and dynamical insights. In this chapter, we introduce Stoichiometric Network Analysis (SNA) which is an
  approach that is somewhere between detailed and large scale. SNA helps to exclude biologically unrealistic
  scenarios and, instead, gives us a variety of possible flux distributions. To thereof identify the biologically
  meaningful solutions, we need to constrain the solution space further, e.g. with measurements. We have two
  possible methods at hand. Either we impose known fluxes and maximize, e.g. the growth rate in a constrained
  model with Flux Balance Analysis (FBA), or we impose measured fluxes and minimize residuals during numeric
  matrix manipulations with Metabolic Flux Analysis (MFA). FBA also helps us to solve genome-wide problems,
  while MFA scrutinizes smaller models and allows the integration of isotope-labelled metabolites. Either way, the
  insight we obtain is crucial to understand the biology of metabolism.

  Keywords
  Metabolic modeling -- Stoichiometric matrix -- Flux Balance Analysis -- Constraint-Based Modeling

 Contact: thomas.sauter@uni.lu. Licence: CC BY-NC

                         Contents                         introduced in Chapter 3). Metabolic models can be built
                                                          with different levels of detail and in various ways. We
1 Lecture summary                  1                      start with the following simple classification, in which
                                                          the capital letters in the reactions are the concentrations
1.1  Stoichiometric Network Analysis . . . . 2            of substances and the reaction arrows or edges define
1.2  Integration of experimental data . . . . 11          the reactions, which can symbolize enzymes, fluxes, and
1.3  Constraint-Based Modeling . . . . . . . 14           other transport systems. Principles of mechanism-based
1.4  Problems & discussion . . . . . . . . . . 18         models and dynamic analysis will be addressed in Chap-
1.5  Metabolic Flux Analysis . . . . . . . . . 19         ters 3 and 4 of this book.

References                         22

2 Exercises                        23                     Table 1. Bottom-up approaches:

3 Solutions                                               interaction-based    graph theory
                                                                                 methods
Do not betray yourself!            26

                 1. Lecture summary                                            (topology)

We learned about the essentials of graph theory and de-   stoichiometry-based  stoichiometric network
rived the first stoichiometric matrix (Chapter 1). Nodes  A + B ---- C                  analysis
and the interaction between them represent the topol-
ogy of networks. Such networks can be written in matrix   mechanism-based      dynamic analysis
form. The introduction to linear algebra was of great
importance to entering the field of metabolic modeling.                 k1
Metabolic networks mainly describe enzyme-controlled
fluxes of metabolites within a system. We can now study   A + B ---- C + D
different methods for the modeling of metabolic net-
works except for dynamical mechanistic models (to be                   k-1

 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0                        https://doi.org/10.11647/OBP.0291.02
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  2/30

1.1  Stoichiometric Network Analysis                           Concentrations are usually written with brackets [], but
The stoichiometric matrix                                      in the context of this chapter we always assume con-
                                                               centrations when using a given molecule name in an
For balancing, we need:                                        equation, and thus write concentrations without brack-
                                                               ets if not stated differently. E.g. we write G6P for the
m . . . number of substances                                   concentration of glucose-6-phosphate instead of [G6P].
r . . . number of reactions                                    Also note that some reactions can be reversible. In this
n . . . stoichiometric coefficients                            case, we can only consider the net reaction rate v f - vb
v j . . . rate of reaction j                                   (from left to right) to create the stoichiometric matrix.
ni j . . . stoichiometric coefficient (conversion) of metabo-  Thus, some fluxes can be negative, if the backward re-
                                                               action vb is larger than the forward reaction v f . Alterna-
       lite i in reaction j                                    tively, we can split a reversible reaction into two elemen-
Si . . . concentration of metabolite i (also: ci)              tary reactions (see Example 1).

These are elements of the following general equation               Example 1: Glucose to fructose
that describes the change of substrate concentration Si
over time:                                                        PGI reaction: G6P ---- F6P
                                                                  Two metabolites m = 2
dSi           r                                                   Case 1: two elementary reactions (r=2):

dt   = Si =  ni jv j     i = 1, . . . , m                                                                   v1

            j=1                                                   PGI reaction: G6P --v-- F6P v=const.

     = ni1v1 + ni2v2 + . . . + nirvr                                                                                         2

The change of substrate concentrations is a consequence           n11 = -1; n21 = 1; n12 = 1; n22 = -1
related to both the general stoichiometry of the reac-
tion network--as indicated in the stoichiometric matrix                   N = -1 1
N --and the given flux vector v. The respective matrix                             1 -1
representation is:
                                                                           S1 = G6P = n11v1 + n12v2 = -v1 + v2
     S = N v             S = (S1, S2, . . . , Sn)                                S2 = F6P = n21v1 + n22v2 = +v1 - v2
                         v = (v1, v2, . . . , vr)
                                                                  Case 2: one net reaction (r=1):
and the stoichiometric matrix is:
                                                                                            v
N = {ni j}       i = 1...m .
                 j = 1...r                                        PGI: G6P ---- F6P v=const.
                                                                  n11 = -1; n21 = 1
The columns of the stoichiometric matrix represent the
reactions and the rows represent the metabolite concen-                   N = -1
trations.                                                                          1
For example, a reconstruction of a "genome-scale net-
work" for E. coli encompasses 1136 unique metabolites                      S1 = G6P = n11v = -v
and 2251 reactions. This results in a stoichiometric ma-                         S2 = F6P = n21v = +v
trix N with 1136 rows and 2251 columns resulting in
2557136 entries. However, the matrix is usually sparse             Example 2: Oxohydrogen reaction
and only >25000 entries are actually non-zero [1].
The stoichiometric matrix:                                                                                     v1

     does not change over time (invariant)                       Reaction: 2 H2 + O2 ---- 2 H2O
                                                                  m = 3; r = 1; n11 = -2; n21 = -1; n31 = +2
     usually has many zero entries
                                                                                  S1 = H 2 = (-2v f + 2vb) = -2v1
     contains pseudo-reactions (uptake, excretion, trans-                 S2 = O 2 = (- v f + vb) = -v1
       port, growth)
                                                                                  S3 = H2O = (+2v f - 2vb) = +2v1
     is crucial for structural analysis with linear algebra.
                                                                                Chapter 2: Metabolic modeling -- 3/30

The stoichiometric matrix is:                                        Example 4: Enzyme kinetics

      reactions                                                                     v1            v2

     v1                                                              Balancing: E + S v-1 ES          E+P

      hy-pe2rgraHph2  substrate graph             bipartite grRaepshulting in:
    hypergraph         substrate graph     bipartite graph
N = -1 O2 metabolites                                                                                      e2
   AA 2 HC2CO A A C C A A C                                          C    A      CAe2 EC                       E
                                                                                                           
                                                                           S      -1 1 0
                                           R R                                  e1                e1 v1
                                                                        E       -1      1         1   
                                                                                                           
with the final representation in matrix and equa-                       ES =  1 -1 e-3 1 v-1 e3
tion set BfBorm: DD B B D D B B D                                    D B DB                           Dv2
                                                                        P 0 0 1 (3x1)
                                                                        (4x1)           (4x3)
H2               -2                   H2 = -2v1

 O2  = -1 v1  O 2 = -v1

H2O                 2                 H2O = +2v1                     A B P E

                                                                     1 2A 3B 4 P                           E

                                                                          5 1 2 3                          4

                       2                                                      B 9

A          1 A B  2 4  B                                                   8 5 B 9
           1 3                          4
A                      A B                 B                          A 6 C 10 8P

Figure 1. A simple metabolicsystem. The grey dotted                  7 DA E 6 C 10 P

                                                  3                             7
line represents the1 system bou1ndary. The A2 Molecule
is transported fromA outside toAinside and iAs then con-                             D E
verted to Molecule2B1 viat3wo 0p.5ossib1le0r.5eactio1ns. Fi2n1ally,
Molecule B is leaving the system.
           B A B  A B A 3 0.5                                         Figure 2. Another metabolic network/system with two
                 2             0.5         1                          inputs and three outputs. The transport of Molecule B is
                                                                     1bi-directional. The system is controlled by the transport
Example 3: Simple metabolic network        B                          of the external concentration of A and B and produces
                 B                 B                                  Product P but can also produce B and E.

As shown in Figure 1, there are two possible ways

to produce Metabolite B, either via v2 or v3. All net-

work edges can be weighted so that we do not have                    Example 5: Larger metabolic network
an incidence matrix, but a stoichiometric matrix:

       v1 v2 v3 v4                                                   A slightly larger metabolic network is shown in
        1 -1 -1 0 Ain                                                Figure 2 with the reversible reactions:
                       1 -1Bin
N  =    0           1                                                         rev = {R2, R8}

      -1 0 0 0 Aout

        0 0 0 1 Bout                                                 and irreversible reactions:

where the reactions determine the columns and                               irrev = {R1, R3, R4, R5, R6, R7, R9, R10}
the metabolite concentration determines the row
entries. External metabolites are not balanced in                    Note that the forward reactions (v2 : Bout  B and
this approach because the steady state of external                   v8 : B  C) were considered in order to create the
metabolites (in our example Aout and Bout ) cannot                   stoichiometric matrix N:
be assumed. Consequently, we can reduce the sys-
tem to:

        v1 v2 v3          v4                                              v1 v2 v3 v4 v5 v6 v7 v8 v9 v10
N = 1 -1 -1                0A                                               1 0 0 0 -1 -1 -1 0 0 0 A
                          -1 B
       01 1                                                               0 1 0 0 1 0 0 -1 -1 0 B
                                                                     N = 0 0 0 0 0 1 0 1 0 -1C

                                                                          0 0 0 0 0 0 1 0 0 -1D
                                                                          0 0 0 -1 0 0 0 0 0 1 E

                                                                            0 0 -1 0 0 0 0 0 1 1 P
                                                                                                2  B 4                B                       B

                                                 A 1 A                                                                   2                        8

Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                         4/30 A 6 C 

                                                                                                3                                       7

                                                                1                                                                             D

Example 6: Branched metabolic network                                                              1

   v1 S1 v2 2S2 v4                                              2A 3 0.5A 0.5 1A 1
           v3
                                                                B                                    B                      B
         S3
                                                           Figure 3. Flux distributions of Example 7. The balance
What does the stoichiometric matrix N and the bal-         of input flux v1 and output flux v3 requires a detour via
ance equation look like?                                   Metabolite B with flux v2.
The stoichiometric matrix is:

              reactions                                    Example 7: Flux in steady state

     v1 v2 v3 v4                  metabolites              The system in Figure 3 can be written as a system
        1 -1 -1 0 S1                                       of elementary reactions:

N =0 2 0 -2S2                                                                     v1
        0 0 1 0 S3
                                                                        0/ ---- A

The balance equation of the system in the matrix                             v2

form is:                        v1                                   A ---- B
                              0 v2
                             -2                                              v3

                                   v3                           A + B ---- 0/
                              0
          S1  1  -1 -1
                  20                  v4
S2 = 0            01                                       and the related equation set:
                                       (4x1)
          S3  0       (4x4)                                     A = v1 - v2 - v3 = 0                                             (1)

(3x1)

                                                                B = v2 - v3 = 0                                                  (2)

and in the equation set form is:                           which can be written in the matrix form:
                                                                        
            S1 = v1 - v2 - v3                                   1 -1 -1 v2 v1 = 0
            S2 = 2v2 - 2v4                                      0 1 -1                                             rk(N ) = 2 < 3 = r
            S3 = v3.
                                                                        v3

                                                                N
                                                                                 v

System in steady state                                     Because the rank of N is smaller than the number of
Usually we would like to look closer at our system and     reactions, we have to deal with an infinite number
see what happens if:                                       of non-trivial solutions.
                                                           Solution: Assume: v1 = a.
     fluxes are constant and do not change over time      Beginning with Equation 1:

     metabolite concentrations are constant and do not         a - v2 - v3 = 0
       change over time (S = 0).                                          v2 = a - v3

Therefore, we look at the steady-state solution:           which is then put in Equation 2:

       Nv = 0                                                   a - v3 - v3 = 0

The steady-state solution is available and appropriate as                  a = 2v3
soon as the states of the system no longer change and                            a
thus time dynamics are not taking place.
See Example 7 with Figure 3. Here, we have the sit-                       v3 = 2
uation as described in the motivation: we have many
non-trivial solutions but we do not yet know which so-     which in turn gives the solution if it is put into the
lution is biologically meaningful. Therefore, we need                                                           a     a2 .
to constrain the system further by integrating experi-     previous  equation                        v2  =  a-  2  =        The  solution
mental data. In the practical work, one rate might be
measured, e.g. v1 = 1 and then the other fluxes (v2, v3)   is:    
can be calculated accordingly.
                                                                v1      1

                                                                v2 = a 0.5 ; a  R

                                                                v3      0.5
                                                                                                                 Chapter 2: Metabolic modeling -- 5/30

                                                                                                                                                      bipartite graph
                                                                                                       A hypergraph
                                                                                                                          substrate graph
                                                                                         hypergraph      substrate graph             bipartite graph                      B
                                                                                                                          A C                         A C
                                                                 A                       CA A C C                                    A     C                              A
Elementary flux modes (EFM)                                                              In our example, another possible kernel matrix woR1uld 2
                                                                                                                                R
If we cannot determine a unique solution of the flux be:                                             B DBD B D                       B     D            5 B
network due to too many unknown rates (see also rank of B                                D B D
                                                                                                                                                                          B
the stoichiometric matrix), then we can study elementary                                 2  
                                                                                                       11                                                                 8
flux modes and the kernel matrix, both of which allow
us to describe all possible solutions. SomeAapplications 1                               A K = 1B 0 4                    B                            A A 6 AC
                                                                                                                                                       B
thereof are:                                                                                0 1                                                                           1

                                                                                          11
 testing a set of enzymes for the production of a 3                                                                                                  1 7 2
                                                                                                                                                                          D5
desired product                                                                          The kernel matrix can provide information about block5ed
                                                                                                                         2                                B
 detecting non-redundant pathways                            1                          reactions.                                  4                                    9
                                                                                                     Bl1oc2ked reactions 2are pathways without a
                                                                                         A                       1                                      8
                                             A metabo1licflux. Rows iAn4the keBrnel matrixBwhich have                                                                        
                                                              only                                   eAntrAies,  eB.g.:   B                 A 6 C A
 analyzing effects of enzyme deficiency                                                 zero
                                                              A                                                             

                                                                                                                          A
                                             2 3 3 . . .0.5. . . . . .0.5 3 1 1   7 710
 identifying drug targets.                                                                                                                                            D

Flux modes describe possible pathways from one metabo-B                                  K =0          0B 01   blockeB1d.1      2        2
                                                                                             1
lite to another if the system is in steady state. Elementary                                ... ... ... A        A                         A  =1
                                                                                         A                        A 3             A 0.5    G1 lc 11                    G6P
flux modes (EFM) are a set of non-unique and linear-                                                             2       0.5 0.5
                                                                                         indicat2e block3ed 0r.e5actions and 1two e1xamples can be
independent basis vectors vk, which can be summarized found in Figure 4aBand 4b. B B
in the kernel matrix K. The kernel matrix also fulfils the    A B0 C0 D                  B                          B             B                                          2
                                                                                                                                                                      1 = 1
steady-state relationship:
                                                                                                                                                      1 = 1 Glc 3 =?
                                                                                                                                           Glc G6P

    NK = 0 B                                                                                           A B0 C0 D                                                       2 =?
ing stoichiometric matrix: 0 Example 3 delivers for the molecules A and B the follow- A    A B0 C0 D

                                                                                           CB D B
                                                   12
                                                                                         0 A C0 A D C D
       N = 1 -1 -1 0  0 1 1 -1  K = 1 1 0 1
                                                                                         (a) Blocked reactions by dead-end or lack of input.

r-rk(N )=4-2=2               12

The kernel matrix K has as many columns as the stoichio-      A                            B CA B                           CA B A B
metric matrix N has linear-dependent columns (number
of columns/reactions r minus the rank of N ). The de-         A                             A B C                                A B
termination of the kernel matrix is shown in Case Box 1.                                                                     C
The EFMs in the kernel matrix are non-unique and can             (b)                                    A
thus consist of all vectors which:                               via                                                      (left) and null-space analysis
                                                                                            A CC
     fulfil the steady-state condition
                                                                                         Coupled reactions reduced
                                                                                         the kernel matrix (right).

     are linear-independent of each other.                                              The kernel matrix also refers to coupled reactions. Cou-

Non-unique means that the kernel matrix can have many                                    pled reactions are reactions which always appear to-
different solutions which fulfil the steady-state relation-
ship NK = 0. Often, we are just interested in getting one                                gether in the same ratio. Their rows only differ--if at
of these possible solutions. Now, you could say, you find
more flux modes than the indicated basis vectors (EFM)                                   all--in a scalar factor:
in the kernel matrix K. Well, the flux modes v can be
reconstructed by the non-unique basis vectors (EFM) in                                               10          
the kernel matrix vk:
                                                                                         K = 0 -1 1 1 

                                                                                                     10

    I II            II -I -I 5II I - 2II                                                 Blocked reactions could be removed and coupled reac-
      12               1 -1 10 -3                                                        tions could be simplified, which would reduce the num-
                                                                                         ber of columns r in the stoichiometric matrix so that we
vk : 1&1         v : 0 ; -1;  5 ; -1; . . .                                              reach another network representation with the property
    0 1              1  0   5  -2                                                        r - rk N = 0. Remember that, depending on the rank of
      12               1 -1 10 -3                                                        the stoichiometric matrix, we have two possibilities for a
                                                                                         solvable homogeneous system according to Table 2.
independent                  dependent
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                 6/30

Table 2. Overview: Resolvability of linear equation sys-        whereby the value 1 is the most frequently used
tems for metabolic models (Rouch-Capelli theorem).             number to simplify follow up calculations. The sim-
                                                                plification and cleanliness of calculation reduces
                           homogeneity                          the risk of errors and is thus a smarter choice. We
                                                                get, for the remaining unknowns, the values:
N has              Nv = b                   Nv = 0
m metabolites
r reactions        (inhomogeneous system) (homogeneous system)

rk(N |b) = rk(N )  system unsolvable    not possible for b = 0                    k13 = 0
                                        homogeneous systems
                                                                                  k14 = 1
                                            always solvable

rk(N |b) = rk(N )          system solvable                      and the basis vector:
m=r
                   unique solution      trivial solution

                                            (v = 0)                                              

                                                                                                    1
                                                                                                 1
                   non-unique solution  non-trivial solutions                     k1       =           
                                                                                                       
m<r                                                                                                 0

                                                                                                    1

We either have the trivial solution or the non-trivial so-      2. Basis vector:
lution:

Trivial solution: thermodynamic equilibrium with all            1 -1 -1                                  Nk2 = 0
       fluxes equal to zero v = 0.                              01 1                                  

Non-trivial solution: under-determined system with rk(N ) < r.                                          k21
                                                                                                  0 k22
Case 1: Calculate the kernel matrix                                                              -1 k23 = 0

                                                                                                        k24

A kernel matrix only contains a linear-independent              which is as an equation set:

subset of flux modes, not all. Thus it is a non-                 k21 - k22 - k23 = 0                              I
unique matrix. Let's start with the example:
                                                                          k22 + k23 - k24 = 0                     II

       N = 1 -1 -1 0                                            We have 4 unknowns and 2 equations. So, we can
               0 1 1 -1                                         set two unknowns to arbitrary values, e.g.:

Nullity = Number of necessary basis vectors:                           k21 = 2; k22 = 1

       r - rk(N ) = 4 - 2 = 2                                   With this choice, we get for the remaining unknowns:

We want to know how many of the reactions r are                                   k23 = 1
not fully determined by the stoichiometric matrix
with rank rk(N ).                                                                 k24 = 2

1. Basis vector:                                                and a second basis vector:
                                                                                                 
                                                                                                    2
                               Nk1 = 0                                                           1
                                                                                  k2       =           
                                                                                                    1  
                               k11
     1 -1 -1 0 k12                                                                                  2
     0 1 1 -1 k13 = 0
                                                                Building a kernel matrix:
                               k14

which is as an equation set:                                                                             
                                                                                                         12          12
                                                                                                    1 1 1 1
                                                                K         =  (k      ,  k     )  =            =        
      k11 - k12 - k13 = 0                   I                                     1        2                           
                                                                                                         01          01

                   k12 + k13 - k14 = 0      II                                                           12          12

We have 4 unknowns and 2 equations. So, we can
set 2 to arbitrary values, e.g.:

     k11 = 1; k12 = 1
                                                             Chapter 2: Metabolic modeling -- 7/30

Conservation relations for metabolites                     With this choice, we get for the remaining variable:
If the number of balanced metabolites exceeds the rank
of the stoichiometric matrix, we can identify conserva-      y14 = 0
tion relations such as:
                                                           and the non-unique elementary flux mode:
          NADH + NAD = const                                                          
          ATP + ADP = const                                                               1

This means that some of the metabolites are dependent               y  1 = -1  0 
on other metabolites and do not act independently. Such                                   0
conservation relations can be identified by calculating:
                                                           2. Basis vector:
       NTY = 0
                                                                                          NT y2 = 0
A linear-independent subset of the conservation rela-                                    
tions build basis vectors in the matrix Y . The construc-
tion is shown in Case Box 2.                                                               y21
                                                                   -1 -1 1 1 y  22 = 0
    Case 2: Calculate the Y matrix
                                                                                           y23
   A given stoichiometric matrix is:                                                       y24
                 
                   -1                                      is the same as the equation:

           N = -1  1                                        -y21 - y22 + y23 + y24 = 0
                    1
                                                           We have 4 unknowns and 1 equation. So, we can
   Nullity = Number of necessary basis vectors:            set 3 to arbitrary values, e.g.:

           m - rk(N ) = 4 - 1 = 3                          y21 = 1; y22 = 0; y23 = 1

   We want to know which metabolites can be seen as        With this choice, we get:
   dependent on other metabolites in our system. In
   our case, we have only 1 reaction but 4 metabolites.      y24 = 0
   Thus, we have only 1 independent metabolite. The
   remaining 3 metabolites depend on the selected          and the non-unique elementary flux mode:
   independent metabolite.
                                                                    
   1. Basis vector:                                                   1
                                                                    0
                                   NT y1 = 0                 y2  =     
                                                                      1

                                    y11                               0
            -1 -1 1 1 y  12 = 0
                                                           3. Basis vector:
                                    y13
                                    y14                                                   NT y3 = 0
                                                                                         
   is the same as the equation:
                                                                                           y31
            -y11 - y12 + y13 + y14 = 0                             -1 -1 1 1 y  32 = 0

   We have 4 unknowns and 1 equation. So, we can                                           y33
   set 3 to arbitrary values, e.g.:                                                        y34

           y11 = 1; y12 = -1; y13 = 0                      is the same as the equation:

                                                            -y31 - y32 + y33 + y34 = 0

                                                           We have 4 unknowns and 1 equation. So, we can
                                                           set 3 to arbitrary values, e.g.:

                                                           y31 = 0; y32 = 1; y33 = 0
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                       8/30

With this choice, we get:                                  even if compared to the initial concentration c(0).
                                                           This is useful when we want to perform a consis-
  y34 = 0                                                  tency check, scrutinized in detail in Example 9.

and the non-unique elementary flux mode:

                                                           Example 9: Consistency check
           0
         1
  y3  =                                                    We have a system with 4 metabolites and 2 reac-
           0                                               tions:
                                                           D  A and 2A + B  C.
           1                                               The initial concentrations are:
                                                           cA(t = 0) = cB(0) = cC(0) = cD(0) = 2.
Building a conservation relation matrix:                   Two hard-working experimental biologists mea-
                                                           sure (independently of each other) the concentra-
                                   1 10                    tions at the same time point, t:
  1 10
 Y =  -1  0    0 1   1 0    = -1 0 1  0 1 0                     Exp1: cA(t) = cB(t) = cD(t) = 1 and cC(t) = 3.
                                                                Exp2: cA(t) = cB(t) = 3 and cC(t) = cD(t) = 1.
  0 01                             0 01                    Can they be right?

Each non-unique but independent conservation relation      1) Stoichiometric matrix:
in matrix Y refers to one linear-dependent row of N . Two
applications can be studied in the Examples 8 and 9.                                

                                                                          1 -2
                                                                   N =  0 -1  0 1 
Example 8: Conservation relations

From the simple hypergraph:                                               -1 0
A + B ---- C + D
we can create the stoichiometric matrix N :                If we apply the calculation of conservation rela-
                                                           tions:
             
               -1                                                  N TY = 0 = 1 0 0 -1 Y = 0
                                                                               -2 -1 1 0                    0
       N = -1  1 
                                                           You have two possibilities. You can either set Y = 0,
                1

We have 3 linear-independent basis vectors (m -            which is the trivial solution no one is interested
rk(N )) because the stoichiometric matrix N has 4
species (rows) and one reaction (rank 1).                  in, or you find non-zero values for this matrix. Af-
In order to find the conservation relations, we cal-
culate the conservation relation matrix using the          ter Gaussian elimination, we obtain the non-trivial
transposition of N , denoted N T . The approach to
calculating Y was shown in a previous section.             solution:                                        

                                                                                                        y1
                                                                            1 0 0 -1 y2 = 2 0
                                                                   TN Y = -2 -1 1 0  y3  = 0

N TY = 0 = -1 -1 1 1 Y = 0                                                                          y4 = 1

                y1 y2      y3                              We can set two unknowns to the arbitrary values
                   11      0A                              y4 = 1, y2 = 2. Consequently, we obtain for the
                           1 B                             remaining unknowns:
   - Y = -1 0              0C
  (4-1)=3  0 1             1D                                      y1 = 1
                                                                   y3 = 21 + 2
                   00

The constraint matrix does not only constrain the                                   y1          y2
network behavior, it also tells us whether a dataset                                                        
is of good quality. The constraint matrix multiplied               1 1 0 1,2=1 1 0
with the metabolite concentrations c(t) is always          y  =    2        =       0   +       1       Y = 0  1
the same:                                                                        1           2  
                                                                 21 + 2 2 1                                 2 1
       Y T c(t = 0) = const = Y T c(t)
                                                                   1                1           0              10

                                                           After we obtain the Y matrix, we can perform the
                                                                                                                  Chapter 2: Metabolic modeling -- 9/30

                     consistency check with:                                                              linear-independent subset of the conservation relations
                                                                                                          is in the left nullspace:
                                                                     Y T c(t) = const
                                                                                                                 Y T N = 0T  N TY = 0.

                                                                  t=0                                     Both matrices contain basis vectors, from which in-
                                                                      Exp1
                                                                             Exp2                         finite many vectors can be generated. The matrix N is
                                                                                        t=0
                                                                                             Exp1
                                                                                                    Exp2
                                        1021 213                        =                                 either multiplied by the kernel K from the right or by the
                                        0110 
                                                                  2 1 3        886                        matrix Y from the left, as shown in Figure 6. This makes

                                                                  2 r3eac1tions 4 4 4                     sense because we know that the stoichiometric matrix N

conservation relations                               metabolites    2 11213 4          elementary fclouxntmaoindsesthe information of the reactions/fluxes in the

   1                                       N                                                     c=olumns and the metabolites in the rows. During matrix
  =  or written differently:2                                                          N is multiplied bymuflrotimptlhiecraigthiton, matrices from the left conserve the row
N is multiplied by    from the left
 left null space                                                  3
                     t0 :y = 2 + 0 + 2  2 + 2 = 8;1                    y2 = 0 + 2 + 2 +0rig=ht n4ull spacsepace of N representing metabolites (conservation rela-

                     Exp1 :y1 = 1 + 0 + 2  3 + 1 = 8; y2 = 0 + 1 + 3 + 0 = 4 tions) and matrices from the right conserve the column
                                                                                                          space of N , representing reactions (stationary fluxes).
                     Exp2 :y1 = 3 + 0 + 2  1 + 1 = 6; y2 = 0 + 3 + 1 + 0 = 4 Remember that the number of columns of the left matrix
                                                                                0
                                                                                                          must equal the number of the rows of the right matrix:
                     This indicates that ExperimenNtal Biologist 2 had a
                                                                                                                              
                     bad day and made a mistake.
                                                                                                                                           

                                                                                                                                        =

                     Conservation relations

                     A=  - B (e.g. ATP= const - ADP)                                                      with ,  , and  representing the number of columns
                     Metabolite A depends on B                                                            and rows.

                                     Left nullspace                                                           Example 10: Demonstration of equivalence
                     rk(N) m-rk(N)
                         Metabolites m  N if square  Right null-        Elementary flux modes             Show that:
                                          and full   space                                                       N T Y = 0  Y T N = 0T
                                           rank                            0 0
                                                                                                          is true for Example 9:
                                                                        A  B  C (blocked)                 The stoichiometric matrix N:
                                                                        Neglectable reaction
                                                                                                                       
                                                                                                                         -1

                                                                        A  B  C (coupled)                        N = -1  1 
                                                                        Reducible reaction
                                                                                                                          1
                                           Reactions r

                                   rk(N) r-rk(N)                                                          and the conservation relation matrix Y are:
                                                                                                                            
                     Figure 5. Nullspace scheme. If the column space is larger                                1 10
                     than the rank, we can obtain elementary flux modes.
                     If the row space is larger than the rank, we can relate
                     some metabolites to the metabolites being considered
                     independent.

                                                                                                            -1 0 1
                                                                                                             0 1 0

                     Nullspace to identify conserved metabolites or coupled and                               0 01

                     blocked reactions:                                                                   Case 1: N TY = 0

                     The nullspace represents linear-dependent vectors that                                                   1 10      
                     fall into the origin of the independent vectors, as shown
                     in Figure 5. An excess of metabolites can be described                               -1 -1 1 1 -1 0 1  
                     as dependent on the core metabolites and then the left                                                   0 10
                     nullspace disappears. An excess of reactions can contain
                     either blocked reactions, which can be ignored, or cou-                                                  0 01
                     pled reactions, which can be pooled. In both cases, the
                     column space can be reduced after the identification of                              = -1 + 1 + 0 + 0 -1 - 0 + 1 + 0  0-1+0+1
                     the elementary flux modes.
                     We learned that a linear-independent subset of elemen-                               =0 0 0
                     tary flux modes is in the right nullspace N K, and that a
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                           10/30

conservation relations                                   metabolites        reactions      elementary flux modes
                                                                          1 2 3 4                      = 
     N  = 
                                                                      1                    N is multiplied by  from the right
N is multiplied by  from the left                                     2                     right nullspace
 left nullspace
                                                                      3

Figure 6. Nullspace scheme: The stoichiometric matrix is either multiplied by the left to obtain the conservation of
metabolites or multiplied by the right to obtain conserved reactions.                  

Case 2: Y T N = 0T                                                                      0
                                                            
                                                                         N

  -1
  1 -1 0 0 -1
1 0 1 0  

                     
0 1 01 1
      Conse1rvation relations
                                                         
   (1  -1) +A(-= 1 - -B 1)(e+.g(.0A 1T)P+= c(o0n s1t)- ADP)
                                                         
=    (1  -1) +M(e0t톋-bo1l)it+e (A1d 1e)p+en(d0s톙1n)  B

     (0  -1) + (1  -1) + (0  1) + (1  1)
                    
   -1 + 1 + 0 + 0

= -1 + 0 + 1 + 0
             rk(N) m-rk(N)
      0-1+0+1    Metabolites m  Left nullspace
   
                                                                            Elementary flux modes
     0
= 0                                                                            0 0

   0                            N if square                                 A  B  C (blocked)
                                                                            Neglectable reaction
                                and full                    Right null-
                                 rank                       space               

                                                                            A  B  C (coupled)
                                                                            Reducible reaction

                                Reactions r

                                rk(N) r-rk(N)
                                                                                                                Chapter 2: Metabolic modeling -- 11/30

             1.2  Integration of experimental data                                                     If we insert the measured values from Figure 7, we
             The balance equation N v = 0 is frequently underdeter-
                                                                                                       obtain:                              

             mined and rates have to be measured. A smart idea to                                                                   0   v21 
                                                                                                                  1 -1 -1 0
             separate the balance equation into a measured part and
ph  bipartite graph
             an unknown part:                                                                             0 0                                   
C   A        C                                A               e2                                                2          -1       0       v3     =   0
                                                       C E
          R                                     e1                                                              0 0 0 1 -1  v4 
                                       Nv = 0
                                                                                                                                            1.4
D B D                                  vu B            D e3
                                N             =0
                                       vm                                                              Now we can calculate:

                     Nuvu + Nmvm = 0                                                                                                   
                                                                                                                 1 -1 -1 0     0   v21 
                                      N uvu = -N mvm
                     A B P-1 E                                                                                0 0 2 -1
                                        vu = N u (-N mvm)                                                        00 0 1        0       v3       =  0.
                     1                           1                                                                                          
                                   2                           4                                                              -1  v4 

             to obtain0a.5n inhomogeneous linear equation set.                                                                         1.4
             As you can seBe, we1 are interested in vu and need the
                                 0.5                                                    N -u 1                                                   
    B        inverse        of         stoichiometric      matrix.     The     inverse          is       -1 -1 0 v2                    10
                                the
       2                    0.5
                                                                                                        0 2 -1 v3 = - 0 0  1
             often nAot availCable, andPthe measured matrix entries are                                 1.4
                                                   10
                                                                                                         0 0 1 v4                      0 -1
             hardly exact in reality due to measurement noise, which
                          7                                                                                        
                                                    E                                                    -1 -1 0 v2                    -1
             leads to inconsDistencies.
             The basic integration of data can be studied in a well-
                                                                                                         0 2 -1 v3 =  0 
0.5 A 1 Example 12 with four typical scenarios. posed Example 11 with Figure 7, and more generally in
                                                                                                         0 0 1 v4                      1.4
           1

    B                                                                                                  We now multiply each side by the inverse from the
                                                                                                       left to obtain the identity matrix:
             Glc1 = 1 G6P3 =? 2DHAP 4 =? PEP 5 = 1.4

D 2 =?                                                                                                          N -1N = I

                     Figure 7. Reduced network of glycolysis from glucose                                1 0 0 v2 -1 -1 0 -1 -1
                                                                                                         0 1 0 v3 =  0 2 -1  0 
                     to phosphoenolpyruvate with measured and unknown
                                                                                                                0 0 1 v4       001                        1.4
                     rates.                                                                                     v2 -1 - 21 - 21  -1

                                                                                                                v3 =  0 1 1 2 2   0 
                                                                                                                v4             0 0 1 1.4
                     Example       11:  Gluco0se       to  phosphoenolpyruvic           acid                      

                                                                                   0

                                        2                  4?          2             3                          v2             0.3
                     For this small meAtaboliBc network anAd modBel (Fig-
    A B                                                                                                         v3 = 0.7
                     ure 7), we assume th3a?t all components o3u?tside the
                                                                                                                v4             1.4

                     system boundary can be neglected. The? system
                                                 2?                               2                    and now we know that the fluxes in Figure 7 are
                     boundary can be freely cho?sen an2d might, in 3this                               v2 = 0.3, v3 = 0.7, and v4 = 1.4.
                     case,  be  t  he  doublAe-lipidBlayer24    of  t  he  ceAll  memBbranCe.

                We are interested inth?e steady-state conc3e?ntratio5?n

                                                          3
                     of glucose-6-phosphate (G6P), dihydroxyacetone-
                phosphate (DHAP) and phosphoenolpyruvate (PEP).

                The balance equation for those metabolites in steady

                     state is:

                                                                    
                                                                        G6P

                                                                    DHAP = 0

                                                                          PEP
                                                                           
                                                                  0  v2 v1
                                   
                                     1 -1 -1 0
                             0 0 2 -1 0  v3 = 0
                                       0 0 0 1 -1 v4

                                                                           v5
           Glc G P 2DMAP 2PEP B 5 B  Glc1 = 1 G6P3 =? 2DMAP4 =? 2PEP 5 = 1
    0      A C D A P 9
                                                  8B  E =?
   4       Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                  12/30

           ABB 0 C 0 D1 6 2                                                                3 P 4          2
                               A C
           Stoichiometric Network Analysis d Measurement scenarios e5livers physiological 10                        0
           B                                               "if-thenB" scenario9s.                                                                           0

            snapshots      and    is  good  for  testi7ng                                  It                 2  A B     4?                       2             3
       also helps us to see how measured fluxr8aDtes influence E                                                                                     A B
      0 4  AAotheB2r raBteCs via  senCsiDtivity           A                                B
                                                                          the
                                                 analysis.H6owever,                        mea-
           sured ratesare often not sufficAient, and loCops and alter-P                                             3?                                      3?
                                                                          10
           native pathways might cause problems.A                                                b) The second case descr2ib?es an underdetermined, 2?
      0.5 The dissection of our stoichiom7 etric matrix into mea-
           Asure1d            1                                 probDlem                         non-redundant2system. 0We knowt4h?at the inpu2t of 0           3
                      and             parts      reveals   the            of  calcu-       E the systems needsAto be equBal to4it?s output, thusA               B3 C
                           unknowCn
           lating with an inverse matrix:                                                                         2
                  B 2                                                                            v1 = v4 = 2. The fluAxes v2 andBv3 do not corres2ponAd         B 5?
           A vu =BN C -u 1(-Nmvm)                               A B                              to a single solution but the3s?um of their fluxes needs 3?
A                     A                          1 = 1          3 =?                             to be equa4l t=o v?2 + v3 =v31 ?= v4 =25. = 1.4         ?
           0.5As the inverse N1-u 1 is often not available6and measure-                                                                                     3

                  1                                                                                                 ?2                                      2?

           ments are never perfectly correct, we use an approxi-
           mated matrix. The Moore-Penrose pseudo2-in=ve?rse123
B     D    AN #u  is  B           forCall   matrices.      Any mathematicians                             4 =? 2 A          4?                    2 A           B3 C

 0                    available                                                                                          B5 = 1.4
           or physicists among you mig1ht=en1joy a review3 o=f ?this
           method [2]; all othersGmilgcht just use tGhe 6MPATLAB com2-DMAP                                    2PEP                                           ? 5?
                                                                                                                    3?                                      3
           mand B = pinv(A). Moreover, we use the kernel matrix
DC 0 DThe final equation might be: Ku with related arbitrary vector a so that Ku2a == ?v.
                                                                                                 c) The third case describes a determined and redun-

                      vu = -N #uN mvm + K ua                                                     dant system, in which v1 and v4 are inconsistent.

                                                                                                 The input v1 = 2 does not correspond to the output

           whereby we have 4 cases, which depend on the number                                   v4 = 3.

D          of unknown reactions x and the number of metabolites0                                                    0

           m. The 4 cases are:                                  2                                4?           2          3
                   deteArmined: Brk(Nu) = x. All rates can be Adeter- B                                         A B

                      mined.                                                               03?                      03?

                   underdetermined: rk(N u) < x. Not all ra2tes can be 4? 2 3
                      determined.                                             A 2? Bd) The last case dAescribes a2Bn?underdetermined and
C                          A B
                                                                                                 redun?dant syste2m, in which v1 and3v4 are inconsis-
                   not redundant: rk(N u) = m.                 2 3? tent4.                                      A3? B C
                                                A B
                                                                                                                    ?    5?
                   redundant: rk(N u) < m. Inconsistencies likely.
                                                                                           2??                      23?
C and are presented in the following matrix as an2example: 4 3  ? 2 3
                                                                              A B                                A BC
                           v1 v2 v3 v4
                                                                                                                               5?
                      N = 1 -1 -1 0 A                                                      3?                       3?

                           0 1 1 -1 B

            Example 12: Principal measurement scenarios                                          Case 1: determined, not redundant (Ex. 12a)

           Here are four different cases for stoichiometric net-                                 -given:
           work analysis. Red fluxes are measured.
           a) The first case describes a determined, non-redundant                               vm = v1 = 2 ; x = 2
           system. We know that the input of the systems                                                  v2     0
           needs to be equal to its output, thus v1 = v4 = 2.
           As v2 = 0, and v2 + v3 = v1 = v4 = 2, we can easily                                            v1 v2          v3 v4
           calculate v3 = 2.
                                                                                                 N m = 1 -1 ; N u = -1 0
           1 American mathematician Eliakim Hastings Moore (1862--1932).                                  01             1 -1
           2 Swedish geodesist Arne Bjerhammar (1917--2011).
           3 English mathematical physicist Roger Penrose (1931--today).                         -check: rk(N u) = x = m = 2  determined, not re-
                                                                                                 dundant
                                                                       Chapter 2: Metabolic modeling -- 13/30

-result:                                               promise between 2 and 3):
       Ku = 0 ;
                0  N u# = N u-1 = -1 -1      0;        vu =     v3     =  -N  #  N  m  v^  m  +  K  u  a  
                                            -1                                u

                                                                                                              2.5
                                                                                           1 -1 0  0  + 0 a
vu = v3 v = -N 4 u#N mvm + K ua = 22                            = - -0.5 0.5 0 1 -1
                                                                                                          2.5

                                                                = 2.5

Case 2: underdetermined, not redundant (Ex. 12b)       With weighted estimator processes, one could thereby
                                                       consider the variance (measurement error).

-given:

vm = v1 = 2 ; x = 3                                    Case 4: underdetermined, redundant (Ex.12d)

          v1                   v2 v3 v4                -given:

N m = 1 ; N u = -1 -1 0                                vm = v1 = 2 ; x = 2
          0                    1 1 -1

-check: rk(N u) = m = 2 < 3 = x  underdetermined,               v4        3

not redundant                                                   v1 v4                            v2 v3

-result:                                               N m = 1 0 ; N u = -1 -1

                                  -0.5 0                        0 -1                             11
             1

K u = -1 ;               N  #  =  -0.5   0 ;           -check: rk(N u) = 1 < m = x = 2  underdetermined,
                            u                          redundant

              0                     -1 -1              -result:

                                              
          v2                                    1  1
                                                       K u = 1-1 ; N u# = -0.25 0.25 -0.25 0.25  get no rate;
vu = v3 = -N #uN mvm + K ua = 1 + -1 a

          v4                                    2  0

Case 3: determined, redundant (Ex. 12c)                Inconsistent, redundant scenarios might be forced
                                                       to consistency with v^1 = v^4 = 2.5 (SSR):

-given:                                                vu = v2 v = -N 3 u#N mv^m + K ua
                                                          = - -0.25 0.25 1 0
                                                                 -0.25 0.25 0 -1
          v1          2                                   = 1.25 + 1 a
                                                               1.25 -1                                    2.5 + 1 a
vm = v2 = 0 ;                     x=1                                                                     2.5 -1

          v4          3

         v1 v2           v4                 v3         An underdetermined and redundant system can
N m = 1 -1                0;        N u = -1           also have rates, which we can calculate. An exam-
                         -1                            ple is rate v5.
        01                                   1

-check: rk(N u) = 1 = x < 2 = m  determined, re-
dundant

-result:

Ku = 0 ;           N  #  =     -0.5  0.5 ;
                      u

Inconsistent and redundant scenarios might be
forced to consistency with v^1 = v^4 = 2.5 (SSR, com-
                        Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                                               14/30

                                                                                                                                                           Lecture 10 https://pdfresizer.com/crop

                        1.3  Constraint-Based Modeling                                                                Case 2:       v3 = 0                            2 Lecture10_2
                        Flux Balance Analysis (FBA) [3] is a widely used method                                       Case 3:                            v2 =11  mark point:(v2 = 1; v3 = 0)
                        within Stoichiometric Network Analysis to determine                                                         v3  =  1               v2  =  1  Amark       point:(v2  =  12 ; v3  =      12 )
                        possible flux distributions. It can be conducted with                                                              2                      2                               Lecture10_1
                        a more general Constraint-Based Modeling approach
                        (CBM), thereby allowing the integration of more infor-                                                                                               3
                        mation beyond the steady-state assumption. Possible
                        applications are:                                                                                                  Lecture10_3     3  Flux space Constraint 2                                                  Real solu
                                                                                                                                                            1

                                                                                                                                                                                                                         Solution space

                                                                                                                                                                                                  Constraint 1

                              Prediction of phenotypes                                                                                                                      1 2                                       

                              Prediction of mutant behavior.

                        We will now step-by-step introduce FBA and CBM. In                                                                                                                                                             3

                                                                                                                                           Lecture10_4                                  Lecture10_5                                    1
ps://pdfrethseizbeer.gcionmni/ncgr,otphe solution space can be considered un- - Reaction reversibility:                                                                                                                   Lecture10_61

      Lecture10_2       A constrained, meaning that any reaction can carry any Irreversible: v j  0                                                                                         0.5
                        flux. Then, we apply constraints, such as the mass bal- Reversible: - inf < v j < inf
                        ance constraints imposed by the stoichiometric matrix S.
://pdfresizer.com/crop                                                                                                                                                                            0.5 1 
                        YouTLuebcteu: reF1B0A_1                                                   Lecture1e0._g7. v2, v3  0 (irreversLiebclteu)re10_3b

  Lecture10_2Flux space                                                                                                                                 LecEtxuerrceise1100 https:E/x/eprcidsef1r0e_1sizer.com/crop
                        The basic idea: start from all possible fluxes and incor-
                                 furtherCocnosntrasitnrt a2ints    to  limit  network   behavio3r         to       a                                        3
                                                                                                                                                           6                     2          Lecture10_26
                        porate                                                                                                                             
                        smaller and thus more infoRremal saotluitvioen solution space.
                                                                                                                         Optimal Lsoelutcio1tnure010_17    1
                              Lecture10_1 Solution space not unique
                                                                                                                                                                                            1  1                                       

                                 Constraint 1                                                                                                                                3   1                                     Lecture10_1

2                                 Flux space

                                                 Constraint 2                                                            132                                                     1 2

                             3 Real solution 3 3 6                                                                                                                                                             6 Con Flux space
                                                                                                                      - Boundary conditionsO:ptimal solutionLecture10_3                                              
           Lecture10_5                                                 1 Solution space not unique                                                      1
                            1                         Lecture10_6                                                     imposed by experimental setup or measurements, e.g.,
                                                                                                                      stationary c6ontinL1eucotuusrec1u0l_ti8vation:                    6  1 - 
                                  Constraint 1

                          0.5                                                                                             =D                                             1                                                       1
                                                                                                                                                        (e.g. = 0.1h-1)                                                Constraint 1
                                                                                                                         v j =2v^j = const. 1 2
                                 0.5 1                                                  1 2                                                                                                                       -

                        The lower vmin and upper vmax bounds of a reaction are                                                                                                   1 2

                   Extherecriesbe1y0a_l1so taken into account.                      3                                 - Enzyme capacities:3

                      

           Lecture10_5  Ma1in applied con6straints                     Lecture10_6  1J                                e.g. v j  v j,max                        (maximal catalysis rate):                       

                                                                                                  6,                                                                         J1
                        - Mass conservation: (N v = 0)                                                                                                               S1  Lecture10_8
                        T1hem1aterial that is enteringvia the influx does not get                                        Lecture10_4                                                    J4 1      Lecture10_5

1 lo0st.5or accumulate (steady-statea1ssumption). The out-                                                                          Exercise10_3                                 J6  J3 =   0
                                                                                                                                                                                                                             1
              going fluxes need to balance the incoming fluxes for each                                                                                    Exercise10_2 J5
                                                                                                                                                                                                               0.5
                        balanced metabolite. However, the fluxes are often given                                                                                     S
                        in  mole  p0e.r5time.    M1etabolites          might        be  split     during   1          2                                              2 2

                                                                                                          bio-
                        chemical reactio6ns and thus the respective m-olJa6r,fluxes
                   ExmeLuerlccttiuspreley11a00c_co1hrtdtpins:g/l/yp.dBfruetsitzheer.cmomas/scrroepmains the same.                                                                                                      0.5 J6 1
                                                                                                                                                                                      
                   6  11 - 2 Lecture10_2
                                  A                                                                                                                     Exercise 10                               Exercise10_1
1 3 6 Lectu1re10_1                                                                                                    - Thermodynamic constraints: based on chemical poten-
                                                                                                                      tiaJls: Lecture10_7
                                                                                                                         6,
                        3  Flux space 6
                        1 1 -                      !                                Constraint 2                         3                                                                                                               6
      Lecture10_3                A = v1 - v2 - v3 = 0                                                                    v v v
                          1                                                                       Real solution             j,min j j,max

                                       v2 + v3 = v1                                     1Solution space not unei.qgue. with: 01                            Optimal solution                                    1 1

                        e.g. v1 = 1:                                   Constraint 1 1                                                                                             1 Exercise10_2

                        Case 1: v2 = 10 2v3 = 1  mark point:(v2 = 0; v3 = 1)                                                 0.5  v1  1 1 2                                  Lecture10_8
 J2
           J4                                    6                                                3 0                 -J6,3
                  J3 =                                                                            1 (1)
      e10_4                                                 1
  J6                                               e10_5               0                                  0
                                                                                     10_6
       1                                                                                               Real solution

                                                                                                   Solution space not unique                                                    Optimal solution

                                   1 2                               Constraint 1                                                                                             Chapter 2: Metabolic modeling -- 15/30

                                                                                                                                                                                 1 2

                                                                                                        3                                               The idea behind this is that biological systems are3
                                                                                                                                                        evolutionarily optimized to maximize a certain be-
Lecture10_4                                                       1                                     1
                                       Lecture10_5                                                                                                      havior such as:
                                                                          Lecture10_6                                                                                                             Lecture10_8

                                                               0.5  maximal growth yield (microorganism)

                                                                                                                                                 1 2        maximal growth rate (microorganism)
                                                                     0.5 1                                                                                                            2
                                                                                                                                                            maximal energy production (mitochondria)

       Exercise 1T0he constraint-bEaxseerdcimseo1d0e_l1:                                                                                                    maximal yield of product (genetic manipula-

                    We end up with a constraint-based model for which                                                                                       tion by human).

   6                  we can use an optimization algorithm--such as linear
                                                                                       6                                                                WJe6o,ptimize the objective function F with:
                      programming--to find the best possible flux combina-

0                     tion to maximize (or m1 inimize) a given objective func-
                   Lectutiroen1F0= ChTttvp. sT:h//1epcdoferfefiscizeenrt.mcoamtr/ixcrCopthereby defines                                                                   F = CT  v  max
                      which1flux(es) shall be optimized. This optimizat1ion is                                                                                                        
                                                                                                                                                                                        v1
                      constraine2d by thLeescytsutreem10in_2the steady state itself N v = 0
                      1but also by all incorporated equality and inequality con-                                                                            e.g. F = 0 1 0 v2 Emxearxcise10_2
                      A straints:
                                                                                                                                                                                           v3

                                                                                       Lecture10_1                                                      -J6, F =Lve2cturme1a0x_7
       6                                    3                                          6
                                                                     T
                                      maximize                       C v = c1v1 + c2v2 + . . . + crvr
                                        vaim                                           Flux space
                   3 subject to  NCvon=str0aint 2 3
 1    Lecture10_3  1                                        6  1 - 
Lecture 10 https://pdfresizer.com/crop 0  vj                                                                                      ; sRoemal seolujtion
                      2 1 Lecture10_2                                                     v j = v^ j = const.So1;lustioonmspeacje
                                                                                                                                                        not unique                         Optimal solution
                                                                                       Cvojn,mstirnaint 1v j  v j,max ; some j
    1              A 1 2                                                               -
                                                                                                      
                      We obtain a system oLef clitnueraer10eq_u1ality and inequality                                                                                        Lecture10_71 2
                      3

                      constraints. This also defines a cone in the v-space, as
                      shown in Figure 8. Fluxspace                                                                                           3          The 1solution is3obtained by linear optimization,
3                                                                 Constraint 2
      Lecture10_4                                                                                                               Lecture10_6  1J         which is fas3t and reliable. We use software for it,
                                             Lecture10_5                          1
1esizer.com/croJ1p                                                                                                                                      although we have the problem that the algorithms
                   S1 Example 13: Apply the constraints and optRiemaliszoelution2                                                                                                                         Lecture10_8

                                                                                                                                                        usually compute only 1 optimal solution. Other
e10_2                                          J4                                 0.5                                                                                  0                   mOpitgimhatl  esoxluisttioannd
                                                                                                       Solution space                            not    eunqiuquaelly           solutions                                  need  to
                                                                                                                                                                       optimal
                                   WLeechtuarvee10thehtstipms:Jp/3/lpe=dsfryesstizeemr.c:om/crop                                                                     (1)
e10_3                                   J6                            Constraint 1                          0                                           be determined by corresponding algorithms (like
                                                                                                   1 1
                                                                  Lecture10_2                                                                           flux v1ar0ia2bility analysis or random2sampling).
       Lecture10_1 1                                        2                          0.5
                                                                                                    Lecture10_7 We could now also 1include an enzyme capacity e.g.
                   SE2xercise2101           A 5J                     ExercisLee1ct0ur_e110_1                                                            v2 Lec0tu.6re:10_7      (0) 1 2

 Conswtrai3tinht:2 Flux space                 3                                                                                                                                 1

                                                                   Constrai Flux space nt 23                                                            3                                                    Exercise10_4

                   6  Lecture10_3  1                                                               6          3                                                             3
                                                                                                                                                            0 JO6p,timal solution
                                                            Real solution                               Real solution
                                       mass constraint: v1 = v2 + v3                                  J6
                                          Solution sp1ace 1 not 1uCnoniqsturaeint 1Lecture10_5         Lecture10_6 Lecture10_6  1 Optimal solu(tion1 )

                                       reaction irreversible: v2  0, v3  0                                                        
   1  0                                                                                               Solution space not unique

                   Constraint 1 1 2                                                                                                              1          -1                                                             Lecture10_8

                                  enzym1 e c0a.p5acity: v1  1                                                                                                            1 2
                                     3 0 3 1
                                   Solutions space? Unique solution?                                                                            1 2                                (0)                                     Exercise10_2

                      Lecture10_4                                    Lecture10_50.51 1  1 0                                                                1 2                     0                     2
                                   
                                                               3                                                                                                  -J6,             Lecture10_8
                   6                                                                                6 3
  Exercise10                                                                      0.5
                                                            Exercise10_1                                                                                TJhen, the optimization does not result in a single
                                                               1                                                                                        1
   1                                           Lecture10_6                             0.5 1                                                     1 2 solution. Instead2 all values 0  v3  0.4 are possi-
 6  1                                                                6  1 - 
                                                                                                                                                        ble. Lecture110_8
6                                  Exercise 10                                  Exercise10_1 6                                                          What would happen if we impose v3 = 0.5?
                                                                                                                                                                       J6,
0.5                           6          1                                                                                                    1
                                                                                                6
                      1 10                                     1  1                                                                                     J6,  v1 = v2 + v3 = 0.6 + 0.5 = 1.1  1
                                                                                  1  1 1 -2                                       
                   0.5 1 1                                                                                                        1 1                    2
                                                                                                                                

xercise10_1                                                                                                                                                                           Exercise10_2                         Exercise10_2

                             6                                                              6                                                       -J6,                   1

6 6  J1                                                                                6  J6,                                                           J2           -J6,
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                    16/30

                  v3                                      v3                              v3

                                    cConosntsrtarianints               maximise
                                                                        optimise
                                    Sv = 0                              max v3
                                    vi,min < vi < vi,max

                                          v v 1 1                                                                       v1

                 unconstrained                           constrained                           optimal solution
      v2 solution space                                solution space
                                          v2                                           v2
            v3                                     v3                                      v3

    v3,max                                       1
                                          v3,max

                                       S                                           v2                               v2
                                                                        1
              max catalysis rate                                                               max v2
              of the enzyme                               v2 + v3 = v1= 1

Figure 8. FBA and constraint-based modeling.
Top: Stoichiometric Network Analysis might leave a large solution space. Due to the mass balance constraints
imposed by the stoichiometric matrix S and the upper and lower bounds of a reaction, one obtains a constrained
solution space (red). This space is used by optimization algorithms to find one optimal solution for biomass (for
example).
Bottom: One constraint captures the maximum turnover velocity of an enzyme v3,max < 1, which is combined with
another constraint v1 = 1 from measuring this rate. We know then that the sum of the v2 and v3 fluxes must be 1 as
well (dark lines). The red area shows the constrained solution space for an alternative v1 constraint: 0  v1  1 .
After maximizing v2, it becomes clear that the enzyme responsible for v3 has to be inactive in order to maximize v2.
Adapted from [3]. Copyright  1969, Nature Publishing Group.

Example 14: FBA example                                       that the influx is fixed:

Given a simple network:                                              v1 = 1

v1         S      v2                                          We can further assume that some fluxes depend
                                                              on enzymes with limited capacity v3  v3,max and
              v3                                              assume that one flux such as through the biomass
                                                              reaction has to be maximized:
with mass conservation N v = 0 leading to:
                                                                                                       
S   =  v1  -  v2  -  v3   !  0                                                                           v1

                         =                                           max F = CT v = 0 1 0 v2 = v2
                                                                                                         v3
                     v1 = v2 + v3.
                                                              The optimal solution is v2 = 1.

We assume that all reactions are irreversible and
the respective rates are thus positive:

v2, v3  0

We can introduce boundary conditions, such as
ate graph      bipartite graph                 substrate graph        e2 bipartite graph
                                hypergraph           A          C                                substrate graph     bipartite ghryappehrgraph        substrate graph        bipartite graph
    C                                                                     E hypergraph                            e2
               A C                                A e1C                 A C                      A A e1C C A E A C C                                  A A C C eA2 E C                                       A C e2 E
    D              RA C                                                e3 R A C                                                                                 e1 Chapter 2: Metabolic modeel1ing -- 17/30
                                                     B          D       B BD D                                       e3 R                                                       R
               B D                                B D                                            BB D D B B D D                                                                                                    D e3
                        B D                                                                                                                           B B D D Be3 D                                         B

                           A B                            P           E             A B               P           E                  A B                        P         E                      A B           P   E
                                            2
                           1                              3           4             1         2       1           4                 1              2            1         4                      1  2          1   4

                             5 B                     9                                  1B 1                                                    5 2B 1                                              0.5 B 1

     4         B        A          8 2                       4     B     A                     2                  B A               1           A1 B1           4         B                               0.5
                           1 6                                                                8
                  2                                  B P                            1 6 4                            2                 A 3C 10 P                             2                   A 0.5 C 10 P
A                          A AC                        10
                 A                                                                   A AC B P                                                                                                    7
          0.5              7                   3                                                                                       7
                  1                                                                                   10                                                                                                 D E
B                                           D             E                         7 3                                             1 D 1 E
C0 D             B
 D                         1                                                                 D E

C                                                    1                2             1            1
 C
                     1  FigureA 9. F3 luxAsolu0.5tionAs                  for    ExamAple15.        AFrom lefAt to        right:     2AThe3origAinal0.p5 athAway1                   model            has  been  modified  to
                           2                         0.5              1             2         3 0.5                      1                            0.5                 1
                                                                             1                               0.5
                        maximize Pout with fixed Aout and no Bout. We obtain two extreme linear-independent solutions: the first solution1

                              B                      B                B             B              B              B                 B                    B                B
                        with1 =d1irectf3lu=?x from A4to=?B and t1h=5e=1s1e.4con3 d=?solution4i=n?directv1=i5a1=C1.4. Th3 e=?last sche4m=?e repre1s=e51n= t1s.4in3fi=n? ite solut4io=n? s
                        Glc G6P 2DMAP 2PEGPlc G6P 2DMAP 2PGElPc G6P 2DMAP 2PGElPc G6P 2DMAP 2PEP                                                                                                                                 5 = 1.4

                        with different ratios of the two extreme pathways from A to B.                                                                                                                   2 =?
                                       2 =?                                                    2 =?                                                   2 =C?
                                                                                                                                     A             B         0     D
                              A B0 C0 D                                             A B0 C0 D                                                         0

                              B                                                        B                                           B
                           Example 15: Opt. flux balance for Pext without Bext
                           0A C D                                                   0A C D                                       0 A C D v1

                           We use the metabolic network shown in Example                                                                                                                                       0             0
                                                                                                      0                          0                              0                             0
                           5 and Figure 2. We search for the op2 timal flu4?x0  0                                                                                         4? nu2ll space 3                         4?
                                                                                                                                                                                                         2  A B          2       3
                                                             ?                                                           2                      3     2                                                                     A B
                           disAtribuBtionACforBblockeAd2           4     2  BAeBxt        3  mBaximCAizedBPext              A B      B A           B       C A         B     A AB B
                                                                                                                      A                                                      0=Nv
               A B                                                                  aBnAd
                                                           ?  ? 3? 3? 3? 3? 3? 3?
                           as shown in F3igure 9 with ob3 jective function F =                                                   ?                                               max v?                        2?            2?
                           C TAv :                                              2? A 2 C 4? 2 2? 2 A 3 2 C 4? 2 3 2 2? 2 1 4? 2 3
                                                  2         2?  4?       2      A BC      3          A B                    A BC A B                                               A BmaCx v1 +Av2 B                        A BC

                                                          C                                                                                                                                                                               ?

                                                     A B                                  5?                                     3? 5? 3? feasible 3? 5? 3?                                                                  3?     5

                                                                T                                     ?                                                                                             max v2
                                            maximiz3e? C v = (0, 0, 13,?0, 0, 0, 0, 0, 0, 0)3v = v3                                                                       space

                           v With constraints: 2

                                  N v = 0, according to Example 5.                                                         Figure 10. FBA constrains the solution space. If we only
                                                                                                                            consider fluxes v1 and v2, we can either optimize for v1
                                  Set fluxes v1 = 1 (uptake) and v2 = 0 (no up-                                            or v2 alone, or we can optimize for the sum of the fluxes
                                    take) according to the available measurement                                            of v1 + v2.
                                    information.

                                  Lower bounds vmin = (1, 0, 0, 0, 0, 0, 0, - inf, 0, 0)
                                    Upper bounds vmax = (1, 0, inf, . . . , inf).

                           The resulting infinite solutions (linear combina-                                                             FBA of knockout                     FBA of wild type
                           tions from the first two solutions) are illustrated in                                                        (optimal)                           (optimal)
                           Figure 9.
                           Always check uniqueness.                                                                              2

                        Optimization after knockout:                                                                                                               a                                Objective function
                                                                                                                                                         b                                          max  = 11 + 22
                        Another optimization example is shown in Figure 10.
                        The central metabolism across different related organ-                                                                  FBA of knockout
                        isms is especially well-conserved while pathways with                                                                   (suboptimal)
                        less evolutionary pressure might be less optimized. One
                        can also assume that organisms optimize their program                                                                                                                    1
                        after knockout experiments, as shown in Figure 11 and
                        studied e.g. by Segre et. al. [4].

                                                                                                                                                   Feasible space of            Feasible space of
                                                                                                                                                   knockout                     wildtype

                                                                                                                            Figure 11. Evolutionary adjustment after knockout of

                                                                                                                            a gene and its respective reactions. After a knockout,
                                                                                                                            the feasible space is reduced and a suboptimal solution
                                                                                                                            might be present. With time, the evolutionary optimiza-
                                                                                                                            tion step b results in a new optimal flux distribution in
                                                                                                                            the reduced solution space. Figure guided by [4].
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  18/30

1.4  Problems & discussion                                           - Unique value of the objective function ('growth')

False positive and false negative prediction of gene/reaction        - Existence of infinitely many optimal solutions
                                                                        with optimal value of objective possible.
knockouts
False positive prediction (the organism does not live in        Without incorporating further constraints often
reality after the knockout although the model states that         poor performance in predicting flux distributions.
it should):

 Kinetics / regulation not considered in the model

     Neglected side-effects, e.g. toxic intermediates.

False negative prediction (the organism does live in re-
ality although the model states that it should not):

     Proof for incorrect network structure  Quality
       control & iterative model refinement possible.

Limited applicability

 Steady-state assumption  no dynamics consid-
   ered, e.g. accumulation of metabolites

     Focus on mass transfer  barely applicable to cel-
       lular information processing.

Objective function

 Strong dependence of results on choice of objective
   function

 Use of 'natural' objective functions such as growth:

- Not applicable to all organisms (e.g. cells in
   multicellular organisms  cancer)

- Not applicable under all conditions (e.g. after
  perturbation of an organism)

     Alternative/ conflicting numerical approaches for
       optimization

     Alternative approach for fluxes: principles of flux
       minimization ( effort for establishing a network).

Alternative optima

     Linear programming problem: finding a solution
       can be guaranteed
                                                                                                                                                       Chapter 2: Metabolic modeling -- 19/30

                                1.5  Metabolic Flux Analysis
                                Metabolic flux analysis (MFA), together with 13C-labelled
                                isotope experiments, improves the characterization of
                                fluxes and is called isotope-based flux analysis. Different
                                experiments using labelled isotopes are summarized in
                                Figure 12 together with the two possibilities of stoichio-
                                metric network analysis without isotopes. We do not go
                                into detail but you are encouraged to study Figure 13
                                and the referenced paper.

                                    Metabolic flux analysis gives us deeper insights into
                                metabolic processes. See also the following reviews
                                [5, 6]. The models remain small. See also Figure 14
                                for a comparison with the previously described Flux
                                Balance Analysis (FBA). FBA returns a larger solution
                                space, which is more helpful for large metabolic net-
                                works. However, these solutions might contain different
                                flux distributions that can all maximize the assumed cel-
                                lular objective, i.e. growth or biomass production [5].
                                The different principles of MFA and FBA are reflected
                                by two major optimization strategies in computational
                                biology shown in Figure 15. Either one imposes the mea-
                                surements and either tries to reduce the sum of squared
                                residuals, or one defines boundaries in which the func-
                                tion is forced to stay.

                                                                                                         J Ind Microbiol Biotechnol (2015) 42:317-325

 1Classification of differ-                                                                                                                            Figure 13. Isotope tracing and 13C-metabolic flux analy-
 methods for metabolic flux
  ysis. The main distinguish-                                                                                                                          sis. "In simple metabolic networks, each pathway pro-
 characteristics between the                                                                                                                           duces a unique labeling pattern in the final product, and
 erent metabolic flux analysis                                                                                                                         the resulting mass isotopomer distribution provides a
 hods are whether stable-                                                                                                                              direct measure of relative flux in the network. Mass iso-
 ope tracers (such as 13C) are                                                                                                                         topomers are molecules with the same chemical formula
  ied, and whether metabolic                                                                                                                           but different molecular weights due to varying incorpo-
 dy state is assumed. a                                                                                                                                ration of heavy isotopes. They are denoted M0, M1, M2,
 A at metabolic steady state                                                                                                                           etc., in order of increasing weight. In complex networks,
 hout isotopic tracers); b                                                                                                                             a computational model is applied to determine fluxes
  MFA at metabolic and iso-                                                                                                                            by minimizing the lack of fit between simulated and
 c steady state; c 13C-NMFA                                                                                                                            measured labeling patterns at multiple pathway nodes.
metabolic steady state and                                                                                                                             The flux parameters in the model are iteratively adjusted
 opic non-steady state; d                                                                                                                              until the optimization converges". Direct quotation: [7].
 FA at metabolic non-steady                                                                                                                            Licence: CC BY-NC-SA 3.0.
 e (without isotopic tracers);
  e 13C-DMFA at metabolic
  isotopic non-steady state

                                Figure 12. Isotope experiments for dynamic and steady-
thods are (1) whether metaboslitcastteeadyM-staFteAis.aTssuhmeedblumein lSiSnRe= rep(rr-ersme)2n/trs2 metabolites an(d3) not
the system, or not; (2) whether stable-isotope tracers
applied, or not; and (3) whetfhleur ixsoetosp.icSstoeaudyr-sctaete [is5]. Copyright  2015, Oxford University
umed for the system, or not.                            s.t. R  v = r
                                Press.
                                                        Sv =0
x analysis at metabolic steadystate: MFA

                                                        Using this approach metabolic fluxes can be esti-

e key to calculating metabolic fluxes in living cells with mated in systems that are fully determined (i.e., con-

ionary (or stoichiometric) MFA (Fig. 1a) is to analyze taining all the necessary external rate measurements),

biological system as an integrated biochemical network and overdetermined (i.e., containing a redundant set

del. MFA relies on balancing fluxes around intracellular of external rate measurements). The main advantage

tabolites within an assumed metabolic network model. of MFA is that it is easy to apply and thus accessible

e first step in the analysis is to express the biochemical to many researchers, since it only requires simple lin-

work model as a stoichiometric matrix in which rows ear algebra and relies on relatively robust measure-

resent balanced intracellular metabolites and columns ments of extracellular metabolites [52]. A limitation of

resent metabolic fluxes in the model. The stoichiomet- MFA for analysis of many biological systems is, how-

model also includes a "biomass reaction" that describes ever, that the number of constraints (i.e., stoichiometric

drain of precursor metabolites needed for cell growth, and rate measurements) is often insufficient to observe

ich is constructed based on the measured biomass com- all important intracellular metabolic pathways. To make

ition [45]. By assuming metabolic (pseudo) steady-state the system fully observable, additional assumptions are

intracellular metabolites, metabolic fluxes (v) are con- needed, for example, leaving out specific pathways that

ined by the stoichiometry matrix (S):                   are assumed to carry little or no flux, or including cofac-

v=0                                              tor balances (e.g., NADH, NADPH, and ATP balances)
                                          (1) as additional constraints. However, the use of cofac-

To estimate metabolic fluxes, the stoichiometric con- tor balances is generally not encouraged. The presence

ints are complemented with measured external meta- of isoenzymes with alternative cofactor specificities,

ic rates (r), such as growth rate, substrate uptake, and e.g., NADH- and NADPH-dependent malic enzyme or

duct accumulation rates:                                isocitrate dehydrogenase, and uncertainties regarding

v=r                                              transhydrogenase activity and other futile cycles ren-
                                          (2) ders cofactor balances often uninformative. In some

The combined system of Eqs. 1 and 2 is then solved by studies, NADH and NADPH were lumped together [15,
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  20/30
  J Ind Microbiol Biotechnol (2015) 42:317-325                             319

Figure 14. Overview on methods. Each of these methods uses mathematical optimization to approach the measured
dFatiga..2STxhrvee=cl0ascsoesrroefsfpluoxnadnsalhyseisreapwpriothachNesv: =(1)0 falunxdbaRlaxncve = rmceoarsureresmpeonntsdtso hqeuarnetiwfyitflhuxNesuvinu t=he-siNmpmlvifmie.d FmBoAde:lsf.lu(3x)esIsoa-re
baanlaalnyscies d(FuBnAt)iilstahneyoprtiemmizaatiinonb-beatswedeaepnprdoaecfhintheadt ulsoews aerla(rgLeB- ) antodpeu-bpapseedrfl(uUx Ban)albysoisuins daasreiteosf.aMdvaFnAce:dnduamta-edrriivcenadapjpursotamcheesnt

  scale model (e.g., genome-scale) and produces a flux solution space that use medium-scale network models and isotopic labeling meas-

to minimize sum of square residuals. DMFA: dynamic metabolic flux analysis. SSR: sum of squared errors of

  that satisfies an assumed cellular objective function (e.g., maximum urements (e.g., GC-MS or NMR) to quantify highly precise metabolic

prceeldl igcrtoiwotnh,).e(i2th) eSrtowichiitohmoeutrticisfolutxopaneasly(sSistoisicahsieotmofetdraitca-Ndrievtewn orkfAluxneasliynsciesn)troarl cwaribtohnimsoettaobpoleissm(isotope-based flux analysis).
Soapuprrcoeac:h[e5s ]t.haCt oupseyrsimgahllt-s쯢al2e0n1e5tw, OorkxfmoroddeUls nainvdeerxstietrynaPl rreastes.

as additional constraints to make the system observable   Flux analysis at metabolic and isotopic steady state:
[59, 96]. Alternatively, flux balance analysis (FBA) can  13CMFA
be applied to quantify fluxes in underdetermined sys-
tems (Fig. 2) [60]. Here, in addition to applying con-    13C-based metabolic flux analysis (13C-MFA) is a more
straints from measured extracellular rates, inequality    advanced technique for estimating metabolic fluxes in sys-
constraints such as upper and lower bounds on fluxes are  tems that are at metabolic steady state (Fig. 1b) [82, 93].
used, and an assumed biological objective is imposed on   This technique makes use of 13C-labeled tracers, combined
the model, for example, maximum growth rate or maxi-      with isotopomer balancing, metabolite balancing, and iso-
mum ATP production [27]. In practice, however, FBA        topic labeling measurements through techniques such as
returns a large solution space consisting of many flux    NMR [48, 72], mass spectrometry [9, 11, 12, 19, 26, 30,
                                                                                                                 Chapter 2: Metabolic modeling -- 21/30

    Measurement-based fit (MFA)

                                      Minimize SSR

                      Minimize SSR

      Constraint-based fit (FBA)

                                                    Maximize gain

Figure 15. Conceptual illustration of fitting a function
to measurement data vs. constraining it: Functions can
be fitted in at least two ways. The most frequent is the
measurement-based fit. Mean values (red dots) are im-
posed and a function (blue line) shall come close enough
to the function in order to fit, usually by minimizing the
sum of squared residuals (SSR). The second possibility
is the imposing of constraints. The function has to stay
within the bounds. The latter can also be based on mea-
surements, e.g. by using mean +/ standard deviation as
the maximum and minimum values.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  22/30

                       References

[1] Jeffrey D Orth, Tom M Conrad, Jessica Na,
    Joshua A Lerman, Hojung Nam, Adam M Feist,
    and Bernhard  Palsson. A comprehensive
    genome-scale reconstruction of Escherichia coli
    metabolism--2011. Molecular Systems Biology,
    7(1):535, 2011. https://doi.org/10.1038/msb.2011.65.

[2] Joo Carlos Alves Barata and Mahir Saleh Hussein.
    The moore-penrose pseudoinverse: A tutorial re-
    view of the theory. Brazilian Journal of Physics, 42(1-
    2):146-165, 2012. https://doi.org/10.1007/s13538-
    011-0052-z.

[3] Jeffrey D Orth, Ines Thiele, and Bernhard  Palsson.
    What is flux balance analysis? Nature Biotechnology,
    28(3):245, 2010. https://doi.org/10.1038/nbt.1614.

[4] Daniel Segre, Dennis Vitkup, and George M
    Church. Analysis of optimality in natural and per-
    turbed metabolic networks. Proceedings of the Na-
    tional Academy of Sciences, 99(23):15112-15117, 2002.
    https://doi.org/10.1073/pnas.232349399.

[5] Maciek R Antoniewicz. Methods and advances in
    metabolic flux analysis: a mini-review. Journal of
    Industrial Microbiology & Biotechnology, 42(3):317-325,
    2015. https://doi.org/10.1007/s10295-015-1585-x.

[6] Maciek R Antoniewicz. A guide to 13 C
    metabolic flux analysis for the cancer biologist.
    Experimental & Molecular Medicine, 50(4):19, 2018.
    https://doi.org/10.1038/s12276-018-0060-y.

[7] Casey Scott Duckwall, Taylor Athanasaw Murphy,
    and Jamey Dale Young. Mapping cancer cell
    metabolism with 13C flux analysis: recent progress
    and future challenges. Journal of Carcinogenesis, 12,
    2013. https://doi.org/10.4103/1477-3163.115422.
                                                                                                             Chapter 2: Metabolic modeling -- 23/30

                                                   2. Exercises                             The kernel matrix K
                                                                                              a) Calculate the kernel matrix K of the following stoi-
                              Stoichiometric matrix N
                                a) Formulate N for the following biochemical system:              chiometric matrix N = 1 1 -2.

                                            v1 : E + S  ES                                 b) Determine dead ends and unbranched reactions
                                            v2 : ES  E + P                                     pathways, given the following kernel matrix K:

                                b) Formulate N for the following biochemical system:                       -1 1 0 0  

                                            v1 : E + S  ES                                                   0     0 -1 2
                                            v2 : ES  E + P                                                 
                                            v3 : E + I  EI                                                 -1 1 0 0
                                            v4 : ES + I  ESI                                           K =  01 0 0 0 2 -1 0
                                            v5 : EI + S  ESI                                                         
                                                                                                             0     0 -1 2
                                c) Formulate N for the following biochemical reaction                      
                                    chain:                                                                 -1 1 0 0

                                                                                                           -2 0 0 1

                                                                                            Constraint-Based Modeling of an example network
                                                                                           An example network is composed of substrates (S1, S2),

                                                                                           intracellular metabolites (A, B, C), and the biomass (X).

                                             v1 v2 v3 v4 v5                                 The following reactions v1 to v6 take place:

                                         ABCDE A

                             d) Extract the biochemical reaction of metabolites S1                     v1 : S1  A

                                        to S5 from the following stoichiometric matrix N:              v2 : S2  B

                                                                                                       v3 : C  X

                                                     1 -1 0 0                              measured    v4 : A  C
                                                  0 -2 0        
    J6, >                                J6, <               0       e1 1 e2 1                         v5 : B  C
                                                                
J6                                  J6      N = 0 1 -1       0       A B                               v6 : A  B

                                                   0 3 -1 0 

                                                     0 0 2 -1        1 e4 e5 0.5           calculated

                      J1  0         J6,                              C 0.5 D                Reactions v1, v2, v3, v4, v5 are irreversible.

                              Flux Balance Analysis (FBA)            e6 1.5 e7 0.5          For v6, a maximal enzyme capacity is given: v6 

0                     0 The following bJiochemical equation system is given:                           v.
                                         1 Exercise09_1 Exercise09_2 6,max

                             -J6,v1 :   A                 1       1                         Due to the experimental setting, v3 is fixes to v3 = D.

-                                       v2 :   B          A B                              Questions:
               J1  0                    v3 : A  C

                      Exercise10_5      v4 : B  C         C D                              a) Draw the biochemical network based on v1 to v6
                                        v5 : B  D                                              and the irreversibility information.

                                        v6 : C   0.5                                       b) Formulate the balance equations for the intracellu-
                                        v7 : D                                                 lar metabolites A, B, and C in steady state.

                             Under the steady-state condition, the following rates         c) Replace v3 by D in the resulting equations. Keep
                             were measured: v1 = 1, v2 = 1, and v7 = 0.5. Calculate            v1 and v6 as variables and solve for v2, v4, and v5.
                             the remaining rates v3 to v6, applying the methodology
                             of Flux Balance Analysis (via N and by dividing the           d) Apply the irreversibility information of v1 to v5 and
                             balance equation into known and unknown parts)! To                extract therefore (several) inequality constraints
                             make your life easier:                                            for the remaining variables v1 and v6.

                                    -1 0 0 0 -1 -1 0 0 0                                   e) Mark the possible solution space using a v6 over v1
                                     0 -1 -1 0   1 1 0 -1   =  0 -1 0 -1  0 0 0 1              plot using the obtained inequality constraints and
                                                                                               the enzyme capacity v6,max. Distinguish thereby
                                         0010                   -1 -1 -1 -1                    two cases:
                                                                                               1) v6,max  D
                                                                                               2) v6,max < D
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  24/30

   f) Give the (unique) solution for the case v6  D while
       optimizing for v6  max (Remember that when
       not otherwise indicated, the maximization of a re-
       versible reaction implies the maximization of the
       production of the metabolites on the right side of
       the equation).
Notes
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                  26/30

                     3. Solutions                                                                          The solution is:

                     Do not betray yourself!

 The stoichiometric matrix N                                                                               v1 :   S1

Task a) Formulate N for the following biochemJ ica>l sys-                                                   v2 : S1 + 2S2  S3 + 3S4                 e1 1  e2 1           measured
tem:                                                                                            6,                                                                       calculated
                                                                                                                     J6, <                          A      B
                                                 J6
                                                                                                            v3 : S3 + S4  2S5
                                                                                              
                                                                                                           J6
      v1 : E + S  ES
                                                                                                            v4 : S5 

      v2 : ES  E + P                                                                                                                                     1 e4 e5 0.5

                                                                                                    J1  0        J6,                                C 0.5 D

The solution is:                                                                                            Flux Balance Analysis (FBA)

      v1 v2                                         0 0                                                    The following biochemical equation systeme6is1.g5ivene7: 0.5
      -1 1 E                                     -
                                                                                                                                       J1 Exercise09_1 Exercise09_2
                                                                J1  0
      N = -1      0    S                                                                                   -J6,v1 :   A              1       1
                     
       1 -1ES                                                                                              v2 :   B
                                                                                                           v3 : A  C                 A B
        0 1P

Task b) Formulate N for the following biochemical syExse-rcise10_5                                         v4 : B  C                 C D
tem:                                                                                                       v5 : B  D
                                                                                                           v6 : C                              0.5
       v1 : E + S  ES                                                                                      v7 : D  
       v2 : ES  E + P

      v3 : E + I  EI                                                                                       Under the steady-state condition, the following rates
      v4 : ES + I  ESI                                                                                     were measured: v1 = 1, v2 = 1, and v7 = 0.5. Calculate
      v5 : EI + S  ESI                                                                                     the remaining rates v3 to v6, applying the methodology of
                                                                                                           flux balance analysis (via N and by dividing the balance
The solution is:                                                                                           equation into known and unknown parts)! To make
                                                                                                           your life easier:
      v1 v2 v3 v4 v5 
      -1 1 -1 0 0 E
      -1 0 0 0 -1 S
      N =  1 -1 0 -1 0  0 1 0 0 0 ESP                                                                      -1 0 0 0 -1 -1 0 0 0 
                                                                                                            0 -1 -1 0   1 1 0 -1   =  0 -1 0 -1  0 0 0 1 
        0         0     -1 -1   0             I
                                   
       0 0 1 0 -1 EI
                                                                                                           0010                              -1 -1 -1 -1

        0 0 0 1 1 ESI

Task c) Formulate N for the following biochemical re-                                                      The solution is:
action chain:                                                                                              From the biochemical equation system we get:

      ABCDE A                                                                                                    v1 v2 v3 v4 v5 v6 v7 
                                                                                                                   1 0 -1 0 0 0 0 A
The solution is:
                                                                                                           N = 0 1 0 -1 -1 0 0  B
      v1 v2 v3 v4 v5                                                                                             0 0 1 1 0 -1 0 C
      -1 0 0 0 1 A                                                                                                 0 0 0 0 1 0 -1 D
      N =  1 -1 0 0 0 1 -1 0 0  0  BC
                                                                                                           Assuming steady state: N  v = 0
       0 0 1 -1 0 D
                                                                                                                  
        0 0 0 1 -1 E                                                                                                 1 0 -1 0 0 0                   

Task d) Extract the biochemical reaction of metabolites                                                           0 1 0 -1 -1 0                     1
S1 to S5 from the following stoichiometric matrix N :                                                             0 0 1 1 0 -1                1   
                                                                                                                                             0            0
                                                                                                                     00 0 0 1 0                   
                                                                                                                                             0   v3  0
      v1 v2 v3 v4                                                                                                                                v4  =  
                                                                                                                                                  
                                                                                                                                             0 v  0
      1 -1 0 0 S1                                                                                                                            -1  5  0
      N = 0 -2 0 0 1 -1   0 S2                                                                                                                       v6 
                          0 S3
                                                                                                                                                    0.5

      0 3 -1 0 S4                                                                                          Removing columns that corresponds to v1, v2, and v7:

      0 0 2 -1 S5
                                                                              Chapter 2: Metabolic modeling -- 27/30

                                  1 0 0                  we calculate:        
  -1 0 0 0 v3                                                     1 1 -2        ki1
                0  v4             0 1 0  1
  0  -1 -1                                                                    ki2 = 0
 1 1 0 -1 v5 = - 0 0 0  1                                                       ki3

  0 0 1 0 v6                         0 0 -1 0.5                  1ki1 + 1ki2 - 2ki3 = 0
                                  
                                     1
                                  1                      In order to solve the system, we first need to determine
                                 = -                     the nullity:
                                  0

                                     -0.5                       r - rk(N ) = 3 - 1 = 2

Let us bring the flux vector to the right and solve the  We have an underdetermined system and 2 kernel vector
system for v3, v4, v5, and v6:                           are necessary to solve the system:
                                                         2 assumptions are necessary, ki2 = c2 and ki3 = c3:
                                  0 -1 -1
     v3       -1 0 0
     v4                                    -1                   ki1 + 1c2 - 2c3 = 0
                0  -1 -1          0  
     v5 =  1 1 0                                                   ki1 = 2c3 - c2
                                  -1  0                                                        

     v6  0 0 1                    0              0.5                                 2c3 - c2
                -1 0 0                                             ki1 =  c2 
                                  0 -1
          =  0 -1 0  0 0 0        -1 -1                                                 c3

                                  1  0                   Let us choose 2 non-identical values for c2 and c3: e.g.
                                                         c2 = 1; c3 = 0
              -1 -1 -1            -1 0.5
                                                                      
                   1                                                     -1
              =  +1 - 0.5   0.5 
                                                                ki =  1 
                   +1 + 1 - 0.5
                                                                          0

                    1                                    e.g. c2 = 0; c3 = 1
              = 0.5 0.5                                               
                                                                         2
              1.5
                                                                ki = 0

                                                                         1

Drawing:                                                 thus,                

                                     measured                     -1 2

              e1 1 e2 1                                         K =  1 0

                                                                  01

              A        B             calculated          Task b) Determine dead ends and unbranched reac-
                                                         tions pathways, given the following Kernel matrix K:
              e3 1 e4  e5 0.5
                                                                -1 1 0 0                
               C 0.5   D
                                                                  0           0 -1 2
              e6 1.5   e7 0.5                                   
                                                                -1 1 0 0
Exercise09_1                                                    K =  01 0 0 0 2 -1 0
              Exercise09_2

 1 The k1ernel matrix K                                                                 
 Task a) Calculate the kernel matrix K of the following           0           0 -1 2
 stoichiometric matrix N :                                      
                                                                -1 1 0 0
A B
                                                                -2 0 0 1
         N = 1 1 -2
                                                         The solution is:
CThe solDution is:                                       Dead ends: v4
                                                         Unbranched reaction pathways:
 With
           0.5                                                v1, v3, v7
                           N  ki = 0
                                                              v2, v6
                                                                  Solution space not unique

Lect                                              Constraint 1

                       1 2                                                                                                       1 2                                     28/30 1 2
           Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching

                                                                                  3                                   3
                 
Lecture10_4 Constraint-Based Modeling of1an example networkLecture10_5Lecture10_6 1for the remaining variables v1 and v6:                            Lecture10_8

           An example network is composed of substrates (S1, S2),                             Lecture 10 https://pdfresizer.com/crop
           intracellular metabolites (A, B, C0).a5nd the biomass (X).
                                                                                                  v1  0          2 Lecture10_2
                                                                                                  v2 =D1 - v1  0
                                                                                                             A
              The following reactions v1 to v6 t0a.k5e plac1e:                                        v11D2 3                   Lecture102_1                                                Lectu
                                   

              Exercvi1se: S110 A     Exercise10_1                                    Lecture10_3  v3=3 D  Flux space Constraint 2 3
                                                                                                  v4 1= v1 - v6  0
                       v2 : S2  B                                                                                                                                        Real solution

             6 v3 : C  X                                    6                                          v6  v1                                        Solution space not unique

                                                                                                                 v6,              Constraint 1
                                                                                                  v5 = D + v6 - v1  0
1  0                   v4 : A  C                  1                                                                1 2                             
                       v5 : B  C                                                                       v6  v1 - D

                                  1                                                  1                                                                                   3                   3
                       v6 : A  B                                                  Task e) Mark the possible solution space using a v6 over
                                                                                     Lecture10_4                          Lecture10_51                                 Exer1cise10_2
                                                                                                                                                            Lecture10_6
                                                                                  v1 plot using the obtained inequality constraints and the

              Reactions v1, v2, v3, v4, v5 are irreversible                      enzyme capacity v6,max. Thereby distinguishing thereby
             6                                              6                                                    -v6,       0.5
                                                                                  two cases:
                                                            
              For v6, a maximal enzyme capacity is given: v6                     Task e.1) v6,max  D                             0.5 1                                                 1 2

6  1 v6,max                          6  1 -                                                           Exercise 10         Exercise10_1

              Due to the experim1 ental setting, v3 is fixed to v3 = D            1 6                                                          6                                       v6,
                                                                                                                               1  
           Questions:                                  -                             1  0                          1                                                     
                                                                                                                                                                             1

           Task a) Draw the biochemical network based on v1 to                                        6            1                    6                                               -v6,
           v6 and the irreversibility information.

                            1                                                                                                           
                       S1  v4
                                                                                  6  1 v2                              0 6  1 -                                           1
                                   v6  v3 =  
Exercise10_3                                                                       0                              1
                       S2  v5                                                     1
                                                                                                                     (1)

                                                                                                                       0                -

                                                                                                                                  1

                                                                                  Help:                                      (0)                                            Exercise10_4 1
                                                                                                                               1
                                                                                  Case 1: v1 = D                                                                                    J2
                                                                                  v6  0 (fix the poiJ1nt)                   J3 =                                                                    0
           Task b) Formulate the balance equations for the intra-                 v6Case                     S1    0 J4
           cellular metabolites A, B and C in steady state:                                       2:  v1  =                      1                                        0 (1) 0
                                                                                                             0                 (0)                                       1
                  A = v1 - v4 - v6 = 0                                                                                          v60
                  B = v2 - v5 + v6 = 0                                            v6  -D (fix the po(in1t))               
                  C = v4 + v5 - v3 = 0                                            Exercise10_3                        J6
                                                                                                                   -1
           Task c) Replace v3 by D in the resulting equations. Keep               Task e.2) v6,max < D J5
           v1 and v6 as variables and solve for v2, v4, and v5:                                              S2    
                                                                                     0
                  A : v4 = v1 - v6                                                                0       v6, >                                 v6, < 
                  C : v4 + v5 - D = 0
                                                                                                  v6                                                                     J6                  0
                         v1 - v6 + v5 - D = 0
                         v5 = D + v6 - v1                                                                                                                                                    (1)
                  B : v2 - D - v6 + v1 + v6 = 0
                         v2 = D - v1                                                                           v1                                                                            -1

                                                                                                                            6, 1                                             0  0

                                                                                                  0                                                                                     J1
                                                                                                                   v1                                                    v1
                                                                                                                                                                                                Ex
                                                                                                                            -v6,
                                                                                                                                                                                                 1

           A Task d) Apply the irreversibility information of v1 to v5

           and extract from there (several) inequality constraints
                                                                                     - v1   v1  

                                                                                                                   Exercise10_5 C
6  1                       1         6  1 -                 1
                           1                          -    1
                                                                         Chapter 2: Metabolic modeling -- 29/30

                                                -

Task f) Give the (unique) solution for the case v6  D                      1

while optimizing for v6  max.                                            1
                          1
                   S1 1  4                                            2       0
                   S1                                                        (1)
Exercise10_3b                 6 4        3 =                         2      0
                                         3 =                 0
Exercise10_3b                  6 5                         1                  0          1
                                                           0              (1)          (0)
                     S2        5                          1                            1
                                                                            0        (0)1
                      S2                                                               1
                                                                                                                     Exerc
                                                           6                    0           1                    Exercise1
                                                          6                  (0 1 )      1(0)
       v1 = v3 = v5 = v6 = D                                               ( 1-)1      (0)0
                    v2 = v4 = 0                                   0          -1          0
                                                                00
Flux cone of an example network                                            1           1
From the previous system, we know that:                           0      1           1

   1. v1 to 5 are irreversible

   2. | v6  v6,max

3. v3 = D

      v1  0                  v1  0

      v2  0                  v2  0

      v3  0 = v1 + v2  0

      v4  0 v1 - v5  0

      v5  0 v2 + v5  0

                                                
                                                  v1
                                               v2
               cA         10    0    -1  0  -1        
                                                      
      cB = 0 1 0                     0 -1 1  v3
                                                        
               cC         0 0 -1 1 1 0 v4
                                                v5

                                                  v6

with quasi-steady-state assumption for A, B, and C (0 =
Nv):

                                   
               v1         10 0
      v2           0 1 1 1      0  
      v3                             v1
       =                        0  
                                    v2
      v4 1 0 -1
      v5 0 1 1  v6

               v6         00 1

Represented in 3D:
Notes
Chapter 3: The magic of change and how to find it

Thomas Sauter, Marco Albrecht

  Motivation
  The world around us is connected and changes all the time. But do we know where things are going? Are they
  on a path to endless infinity or do they find a condition where they are in balance with all their neighbors? In
  reality, we often see mysterious black boxes, and it is not clear why we get a particular outcome for a specific
  input. Sometimes the result depends on the history of movements. If this is the case, we see different final results
  for the same condition. In this block, we strive for answers in the realm of systems science. We will learn to
  model so-called systems in time, and we will ponder on how to bring them to desired states as quickly and
  precisely as possible. Likewise, we will learn how organisms develop an effective control of various regulatory
  biochemical processes forged by the forces of evolution. On this journey, we will also understand the beauty
  of connected things and what they teach us when we address biological problems, a perspective that make us
  better experimental biologists too.
  Keywords
  Modeling -- Hysteresis -- Feedback -- Open and closed loop -- Stability -- Multi-stability -- Phase plot

 Contact: thomas.sauter@uni.lu. Licence: CC BY-NC

                         Contents

1 Lecture summary                            1
1.1  Examples of non-linear dynamics . . . 1
1.2  The impact of network motifs . . . . . . 5
1.3  What is a system? . . . . . . . . . . . . . 8
1.4  How to describe change mathematically 9
1.5  What is a steady state? . . . . . . . . . . 11
1.6  Stability theory: Idle state or explosion 13
1.7  Phase portrait: How elements relate to
each other . . . . . . . . . . . . . . . . . . 17
1.8  Feedback revisited . . . . . . . . . . . . 19     Figure 1. Example where the measurement seems myste-
1.9  Bifurcation: Split it baby! . . . . . . . . 21    rious. The GFP signal depends on the non-metabolizable
1.10  Simulation-based analysis of motifs . . 26       lactose analogue thiomethyl-galactoside (TMG), but
1.11  Additional reading: Cybernetics--The             whether we increase TMG or decrease TMG remarkably
art of creating equilibrium in a world of              changes the outcome, also referred to as hysteresis or
constraints and possibilities . . . . . . . . 29       multistability. What is behind this? See Figure 2. Source:
                                                       [1]. Copyright  2004, Macmillan Magazines Ltd.
2 Basics of mathematics                      32
                                                       of coming to a steady state has been assumed heretofore.
References                                   37        In this chapter we will introduce some of the theoretical
                                                       basics to treating and understanding biological systems
3 Exercises                                  38        which are dynamically changing over time and thus are
                                                       no longer in steady state.
4 Solutions                                            1.1  Examples of non-linear dynamics
                                                       Let us start with a dynamic experiment on the popula-
Do not betray yourself!                      42        tions of cells in Figure 1, which also shows that reality
                                                       cannot always be described with basic linear tools. In
                 1. Lecture summary                    this example, we see that the expression of genes relevant
                                                       for the lactose metabolism (GFP signal) does not merely
In the previous two chapters, we studied systems in
equilibrium and learned about powerful tools for the                                            https://doi.org/10.11647/OBP.0291.03
modeling of metabolic networks. However, the process

 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  2/56

depend on the availability of the non-metabolizable lac-
tate analogue (TMG). It also depends on the previous
amount of TMG in the cellular environment. If 30 킽
TMG were present at the beginning and this concen-
tration was further decreased, gene expression for the
lactose metabolism is measurable down to 5 킽 TMG.
But if, instead, the TMG concentration was increased
starting with a low value of 2 킽 TMG, gene expression
will not set in until 15 킽 TMG. Whether there will be
lactose metabolism or not in the range from 5 to 15 킽
TMG consequently depends on the history of the system,
a phenomena known as hysteresis. Hysteresis can also
be seen as a bistable state which can result in discrete
switch-like outputs from continuous inputs.
Hysteresis increases the resistance to noise as it requires
higher values of the input in order to switch to a par-
ticular state, as compared to the input needed to stay
in a state. The switch also means that a transition is
not continuously reversible after it has been triggered.
The behavior is often hidden and encoded in unknown
connections of biological elements. Here, the regulatory
principles behind the observation in Figure 1 are well
understood and illustrated in Figure 2.

    Other examples of hysteresis can be studied in Figure
3 and 4, where the regulatory network structure (mu-
tual molecule dependency) and the time behavior are
depicted side by side. Take some time to understand
how these schemes relate to each other. In Figure 4 we
have an example from stem cell biology with the home-
obox protein Nanog. Regulatory interconnections are
not restricted to molecular biology. We might also have
physiological and anatomical systems with regulatory in-
terconnections. One example is the control of the blood
sugar level by the liver and pancreas, illustrated in Figure
5. Another anatomical example can be found in Figure 6
on the adaptation of the eye. The restriction of the pupil
compensates for disturbances with different light inten-
sities. The control of this system can be drawn as a block
diagram (see next section and Figure 7). Such regulatory
circuits are also used in synthetic biology, within which
scientist constructs or re-design existing biological sys-
tems for useful purposes. Let us explore the impact of
some basic network motifs on the dynamics of a system
next.
experimendtyanl afminidcisngs (Chazaud et al., 2006; Plusa et al., 2008). inforermacatitvioatne othfecpelulsriwpoitehnincyanne`twunodrkisoturrsbuefdfi'cieennvtliyrohnimghentot.aHctoivwateever,

Thus, the Mmoimdieclkpinrgovtihdeefsirostnelinpeoatgeentsipaelcmifieccahtiaonisotbicseervxepdlainnatthioenemfobrryo,notGaaltlac6e, lwl hpircohp,eirntibeosthincflausens,clienagdsintotera- satanbdleindtirfafecreelnlutilaatriornegstualtaet.ory

the salt-anmdE-pSeCpspecrancedlilffpearettnetrinateobinsteorveepdibilnastthceelIlCs M(E.piH; ogwiveinvger,riiste toproCceosnsseesq,ueen.gtl.y,ctehlel qaudehsetisoinonasrisoesr ams teochhoawnicthse, ccoanncebnetramtioenasraunregde or
involves aermatbhreyrolaprgroepneru)m, bperirmoiftiavrebietrnadroydpearmram(ePtreEr;s tgheantehraatdintgo beextra-deriovfeOdcCdt4hiraeipscttoelryrc3fa:rnoTmbheeinmmaraarggoiiwcnegodfdtcoahtaaenf.fgIicneieatnhntidlsyhcpoarwsoem,toomtfeiunpldtliu-isrticp--aol3tee/n5mc6yo.dels
confined etombaryospnieccimficemrbarnagnees)inanodrdterorphtoectcoadpetrumre(TthEe; gpirveisnegntreisde tocan beCuosmebdintoinegxpqluoarnetsityasttiveemastinicgallel-ycethlleacnoanlysesiqsueanndcesmtahtahtefmuantcictiaol nal

             extra-embryonic tissues), depending on the culture environment. modelling, Muoz-Descalzo et al. pointed out that post-translational

dynamics (i.e. tristability) (the so-called `over-fitting problem', changes at the cellular level might have at the population level. For

                The differentiation into PrE and TE can be forced by ectopic interactions allow the buffering of the differentiation-inducing

discussedefxuprtrhesesriobneloofwt)h.eAlninoethageer idsseuteermcoinmanetsswGitahtat6hefosrtaPtircEn(aFtuurjiekuraexaamctpivleit,y othfeOcmt4u(lMti-uscoazle-Debslcaasltzoocyetsta-lm., o20d1e3l ).oTfheKy rduepminosnkstirateetd al.
of the spaetitaall.d, i2m0e0n2s)iaonnd. TChdxe2ICfoMr TiEs s(Bubecjekcetttoal.d, y1n9a9m5;icStrcuhmanpgf eest aRl.E,dVeImEtWhoant,sturnadteesr hseolwf-regneenweienxgpcroensdsiiotino,nsc,eNllapnrooglifaenrdatio-cnataenndinmpreoctheiannsical
and re-arr2a0n0g5e)m, beunttasls(oe.tghr.oduughe cthoancgeells ipnrothleifeexraptrieosnsioonromf Oeccth4a.nWichaelreasprofpoerrmtiesstajbolientcloymsptrluexcteusrwe iatnh Oeacrtl4y, eamndb,rtyhou.s,Inrepstarirctitciutslalre,vietlsretvoeaaled
forces), whanichaciumtepaGreclpturtehsesieomnTMeorfgGeOnctt4palteteadrns.tHo odwifefevreern,ttiahteiosne cihntaongTeEs, anthatratnhgeefothrmatatfiaocniliotafteTsEpilsurmipotsetnrcoyb. uHstowehveenr,asusnudmerinLgIFa/speorsuimtion-

have beeninncergealescetecdauinsetshidsisffteurdeyn.tiKatirounpininstkoi ePtrEal. (cNoinwsaidertedalt.,he2s0e00)A.basceodnrdeitgiounlast,ioOnct4ofleCvedlxsB2arexhpigrehsesinoonu,gahntdo ctahuastedNifafenroegnbtiiasltaabdilhiteys,ioinnduced

dynamic pTrhoepreefrotirecs,AMOancPtd4 ceoxTemMrtbsGinaeddosae-tdherpeeen-deimntednusaiol nfuanl c(t3ioDn)acsebllo-th astrepnogttehnstiaalrley cdruuectioalthfeoractthiveastioorntionfgFogf4E/EprikaonrdGPatraE6.cAelclcso(rKdirnugptionstkhie entry
based modkeeyl fwacitthorGfoRr NplsurtiopostiemncuylaaLtnaecdtobaseostihgntahledrLsipavcainYtigalcesltlrsutcotwuarerdalnindeageOectt4athl.e, a2u0t1h1or)s.,SSoNixm2aniolagr frleulcatStuitaeomtnioscenhllsipismbpaectwt etheen acmeollunptosoiftiounnboaunndd TstFochasti
      exprsepsescioifnicalteiovne.lsHoofwaevgerro, whmioenwtagbotblihslmeassetodcuyaslt  f(uKnrcutipoinnsskoif eOt catl4.,                                                              state
gene     regulated CreRmPains toLabceI elucidated. LacZ
                                                                                                                               areex+p(r`eascstiivoen')hOavc+et4bpereonteirnesptohrattedtrigbgyeHr deirfbfeerregnteiattiaoln. .(2In01li5n)e.wCiothmthpiasr,inhgypothe
                                                                                                                                          lowering Oct4 levels in pluripotent mESCs has beecn1 shown to an activa
2011). Herein, each cell is represented by an incompressible spatial gene expression patterns of in vitro and in silico mESC colonies
                To describe the dose-dependent function of Oct4, Chickarmane reOdcutc4-eSoxN2anog heterogeneity and to establish a more robust generate                          Nanog
ellipsoid tahnadt Pientteerrsaocntsexwteintdheditstheloircbailsteabnlveicroonremneentwt otrhkro(OugDhE emlaosdteilc; seeon+ pthlueribpaostiesncoyf+sqtuataen(tKitaatriwvaecmki-eNaseuisrieuss reetvaela.,le2d01t3h)a.t cells with a high
adhesion afboorcvee)s.byFuinrttehgerramtinogret,woeamchutucaelllalacZnitsaglacocYhniasrmalcasctA:eorniseedbetbwyeeTn FOct4self-reMneowd+eilnligngcapthaecitmyuatrueallotcraatnesdcriinpttihoneailntaenridorpoofsta-trcaonlsocnriyptsitorunacltuNreanog e
                                                                                                                                                                                                                                                                                                                                   suggeste
concentratainodnsCd[dxe2t,earnmdinoende baectcwoeredninNgantoogthanedGGRatNa6 d(CevheiclokapremdanbeyanddueretgouTlaFti-ornelaotfedpldurifipfeorteennccyesainndplrionleiafegreatfiaocntoarsndpraodvhideesdionpo(sHsiebrlbeerg
                                                                                    GFP                                                   male.,ch2an0i1st5ic).-exBpylansaitmionuslaftionrgthespcd2aotsioe-dteempepnodreanlt     Differentiated double-n
C  hick  armPaneteerasnodn,  P2e0t0e8rs).oTnh(e2s0i0m8p)l,ifdiee dscGriRgbfpNed,                  icneFlligc.y4cAle,  iasnbda  s  e  det                                                                                      apcattictveeilrltnystasotefoOf ctO4 ct4
                                                                lacZ              oaubtloivned],                                          Nanog                B                                                                                                                                                                   explanat

polarity. Boyn caouspeltinogf tehxepienritmrinenstiacl pfrionpdeinrgtisesreoHvficeIRCwedeMd cbeyllsNwiwitah (t2h0e07).exparnedssitosna+sisnocEiaBtiso,nWwhitihtetheet ianls.tasbhioliwtyeodfStthihganeatlpBclourmippoetetinntgceinllflsutaetneces                                                                                                        d
mechanicaAlddfiotirocneasllyp, trheeseanut  hoirns  suthgegiersteHleadccRnZeadvniroovneml menot,if  ttohaisccomunotdfeolr      thebetwehen         ONacnt4o+g  aenxdprOescsti4on-       niseilogwhb. ours  can  account       for                                                                         mESC
                                                                                                                                                                                                                                                                                           experimentally                                                p
frameworknona-lllionFweiagsru(ru`ebse2l.lt-oUshnaadpdeeddrr'ley)sirsnelgagtiteohnneebrhaeylt,wstebeeurnetsstiavsbelirenyNFaiimgnoupgroesrttaatnets,anFFdiigogu.br2se.eC3rvo.erSedtneemctlwucosetrelklrosdfipdffluerriepnnogtteiapntcliuyornriepgnoueteltanwticooynr.kl(.AoBs) sSi,fcuhirencmdaetpiooefnnthddeeinnaetgtlwyroarmokf   Nanog
                                                                                                                                                                                                                                                                                                                                   EB
questions,exsuprcehs1saioissn: tDhooef esOspccet4ecil,fliacpsoreisligltuiusoltnraattodeerdyteinrmeFtiwnigeo. rg4keBnoefatnehdxepdLreeasscsriiobne?d bosytfrsuttcrrutauFcnrretsouscmruregi,tpgesetimiszoteepndoofrrbaayccleCttloohlircdskNpiavaraimtsniiaooon-ntgee(emeWtxapphlo.ri(rte2ae0sl0esd6ityo)a.nnlOa.,acm2ts4i0caa1sn3fdu).Snocxt2iofonrmoaf the by Y), o
         Matoboa peet raol.n(2m00o6d).elI.n LthaicsYmfoatisfc, iOlitcat4teascttihveateins fGluaxta6o,fand bolhtehevteerlosSdooimffesairrg,(dnwoatetleBhd.alivSneoeslfi)odtchulaistneaedcstiovrnaetpetrhseeOseactnn4at,lSsytosaixsb2loaefnsdtteaNmtaepnso,rgdatlarasdnhysencdarimpltiiinocnes.sof Muoz-D
Do geomefatcritcorscTocMnosoGtpr,eawrianhttisivcehalyfifnesutcupt rpsnrpeisansthiaNilbainetsoxgtphrteersarsneispocrnreipsptsiaootrnt.eTr(ndhasis?sheAdrelinreNesapnroeAgisnlretetrnhgatoucleuualgtnleuhssltaitatrhsbeoGlreweRnsaNttrarsaet.necssHuc.roriTrpwethienoevntlebyari,nsodtmnaalEbcytlSievvCaertsereysgdiOofoecnwtn4oiamstnseudhxlStaiisod-txse2cidn.aAlieinnsomglaortaidoyen.l.s tohfat Nan
differentiailn aFdigh.ea4sgAiao)in.nWsintirtcehrnetghatisshesassssauugmfafipicntiioethnn,tetthpoeronfadectuwilcoittriakotenmocoedfleLllasccoaYnrt,ignivge?riBseeximfteurErnScSaailCmstiiigoldnaniarfslf,teootercterhmcneuetiidrraitBani,tovsnsiuivpgaopnvrceaaosilulsaiennbstetlNeerpn,aanstrohittgsei,eiertsxhpiecnrye1sssiasgeinolhfnd-t.os(rcBga2)la.rCneSioasordereuyasrspcionsenpd:dhii[cen2rago]tei.dththerough
The abilittoy thtoreleeadasidsfefiensrsgentttohdeaysnepaomqsiuictesi,vstdeieofpneesenddibinnagcskoilnliocOoocpt4isaenxpdpartrehtsisuciuoslna,rwlyhiCcbhiofiumprcypaarotgiiogrgnthraedntgiac쯠geter2asom0,f1tcoe5for,mNnTasehniddeoegeCrmeioxnbmpgrryepnosaoisdintoynobonaodslfyiaeBtsfiruoa(nlEncostBigocsinr)si,topsfotitLrhoetandraler.lavnebglusetoafinlscoocloenllyul2a0r13) (s
significanits,  aasssuthmisedtytopebeofcoqnutreosltlieodnbiys  asntilelxtcehrnaalllesnigginnagl     Ato(ea.dgd. rBemssp           osirginnatelsBrtar.ucSctoitoulidrnelsisn.ienEs mrtehpbereerdsedegenudt slatiantbioltenhsetosaeftepss,tlruduarcistphuoeredtesl,inncecysel.ulsnsstaebnlde  states. The                                      Recen
                    enabling bistability. Reproduced from: [1].
                                                                                                                                                                                                                                                                                           and receive
                                                                                                                                  bistable region is shaded in grey. Bifurcations occur at signal intensities
         Wnt/   -Ccaotpenyirnigohr tsi쯨n2a0ll0in4g,)M. IfaOcmcti4lleaxnprMesasigoanziisnleoswL, tthde.    stem             cecll    andsicg2n. a  ls  which   might             affect  gene  expression       and,          thus,                                                        establish                               whether

                                                                                                                                 1                                                                                                                                                                                                 culture-d
         switch including Nanog is off and Cdx2 is constantly expressed at spatial patterns or cell type arrangements.

         high levels (TE-like state; Fig. 4B). Enhanced Oct4 expression                                                                                                                                                                                                                                                            2014). m
         initially lAeads to an increase of Nanog and, thBus, to a stable stem ceelxl preSsspiaotnio-stetamtep,orwahl piCcahtteirsnschinareamctberryiosendic bdyevehliogphmeOnctt4 and Nanog and Gsk
         state. However, at a certain threshold, Oct4 induces a low-leveexl preOssnioene,xatmowpalerdosf sapatrieog-itoemnNpaoonfroagllopwatteNrnainnPogrgEc-alikanenbsdetatfevoaurniadbilne thOeceta4rly state cha
                                                                                        Epi-like                      Nanoegxprepsshiaosne.sAosf       nmoosuesceonddev(ealtotrpaGmcattieann6gt) wsthaebnle tshteateinenxeirstsc,elclelmlsasrasp(idIClyM)
         expression          +of  Gata6     -and    both  +factors                                                                                                                                                                                                                                                                 2008;                 W
                                                                      cooperativelsytatreepress
         transcriptionG,alteaa6ding-to biNsatanbogility (FigFg.f44B, region shaded in greyr)e.turnsetgoretghaeteirs oinritgoinNaannodg, +theupsib, laesxthicbeiltlsp(uElspiin)ganNdaGnoagta6d+ynParmE icceslls the authConcentration
         In this range, th+e fate- of a cell is determined by the iICnMit-i(laiFkleigst.a[3treAev,iebwotetodmb)y. TAhritsums oadnedl pHreadijcatnetdonthakatisex(c2u0r1s2io)]n.s Afrfotmer tahne NinHitial existence
         concentrations of the pluripotency factors. If Oct4 is furthsetrate parheasteraonfsiceon-te,xpprroevsisdioinng, baotvherTyFshdoirstpwlayinadomwutoufalolyppexocrtluunsivtye isnalt- a monosNanog                                                                                                                                                DEVELOPMENT

         increased or overexEprrkessed, the autoregulatory capacity of Gataw6hichandp-epretpuprbeartipoanttsernca(nChabzeacuodmeet acl.o,n2s0o0li6d)ataendd fintaollyaarrlaingeaegiento with Fig
         is switched on and Nanog transcription is efficiently suppressecdommtwitmo elPanyrtEe-drlieske,ciwsiiothn P(CrEhacmelblseroscectuaply.,in2g00t7h)e. outer layer that faces the particula
         (PrE-like state; Fig. 4B,C). According to the model prediction that Exbpllaosrtioncsgotaetthel e(Rsaomsseantotpainc,dGTlamuc,h2e0e0t9a)l.. sTuhgisgepsatettdertnwinogaldterpneantdivseon is only o
                                                                                                                               FSgDf4E models (Glauche et al., 2010). ITnimthee first model (model 1 in state, net
                                     Fgf4

                                  A                                                      B                                        Fig. 3B) mESCs areCbistable with respect to Nanog expression induce

Fig. 5. Cell-cell interactions via Fgf4 can direct lineage specification in Svtievmoc(.ec(lAol sm)taStpecahreemweiothf thFeigG.R2NBs,uggrgeeystseOhdcat4bdyedBersesgoinonnPa)r.rEd-Sliektetaatsetla.te(t2ra0n1s4i)t.io(Bn)sSacrheemaptiocpulati
                                                             A                                                                                                                          Cdx2
bifurcation diagram of Nanog states as a function of Fgf4. Solid lines represent stable states, dashed lines unstableNasntaogtes. The tristable region is shaded in greyx.pressio

(C) Schematic time course for PrE differenti+ation adapted from Bessonnard et al. (2014).                                                                         Concentration         Gata6                                                                                                 generate
                                                                                                                                                                                                                                                                                              Fig. 3C,
                                  +                 -           +                        Nanog                                       Box 3. The state space formalism: a model to                                                                                                          2257Altho
                                                                                                                                                                                                                                                                                              dynamic
                                     Cdx2           -     Oct4                                                                       quantitatively describe cell fate decisions                                                                                                              populati                                      DEVELOPMENT
                                                                                                                                                                                                                                                                                              row), th
                                                                   +                                                                 The gene expression state S of a cell is defined by the expression values                                                                                mechani

                                            +                -                    +               TE-like                            of a set of genPerEs-laiktea certain time point. This state is a point in an abstract
                                                                                                   state                             space compossetadteof all possible expression states, termed state space.
                                            Nanog - Gata6
                                                                                                                                     As gene expression changes due to stochastic fluctuations or

                                                                                                                               Oct4developmental processes, the position Toifmsetate S in the state space

                    Figure 4. Stem cell differentiation network. A progenicthoarncgeelsl. cTahne dpiafrfteicruelanrtipaatthe ithnattoisantakeepnibisladsetncoetelld(aEspai)t,rapjercitmoryit.ive                                                                                                                                   experim
         Fig.   4.  Mutual antagonisms              can direct lineage specification in                    mviterom. (bAr)aSnBceheescm)aueasnoefdothfterreoGgpRuhNlaetsocurtgyogdiensetetrermdacbtyi(oTCnsEhi;cbkgeatiwrvmeiaennngegraeinsndeePst,eotneeorstxotanrlla(2e-0exp0m8re)b.srsTyihoeonnic                                (Box 2).
                                                                                                                                                                                                                                                                                                                                   fluctuati
                    endoderm (PrE;                  generating extra-embryonic                                                                                                                                                                                                                                                     on the dy
         interactions between Oct4, Gata6 and Nanog lead to the `bell-shaped' activatiostnatoefsNaarneoagcstuhaowllynrienaBch. Aabnlee.xternal signal, termed A, positively regulates Oct4                                                                                                                                         sorting (
         expresstiiosns. u(Be)sS)c,hedmeaptiecnbidfuirncagtioonndiatghraemcouf Nltaunroeg setantvesiraosnamfunecntiot.n oTf Ohcits4.iSsolaid bliniefus rrecparetsioennt sdtaibalegsrtaamtes,odfasthreadnlisncersiupntsitoabnlefsatactteosr. TNheabnisotagble                                                                       revealed
                                                                                                                                          Differential equations can be used to describe mathematically how                                                                                                                        the NH
         region iesxsphardeesdsiinongreays. a(Cf)uSncchetimoanticotfimtheecoleurvseelfsoroPf rFEgdfi4ffeorernOtiactito4n wadiatphteddiffrfoemreCnhticnkeartmwaonrekamndoPteiftesr.sSonol(2id00l8in). es represent stable states,                                                                                                   from bis
                                                                                                                                     gene expression evolves over time. Thus, the solutions of a system of                                                                                                                         both Na
                    dashed lines represent unstable states. The bistable reegquioatnioniss shdeasdceridbeincgorrraeysp. oTnEdi-nlgiketrasjteacttoer:iesst.emStacteelsl, swtoitcwhhicwhith                                                                                                                                          typical
                                                                                                                                                                                                                                                                                                                                   whereas
         2256 Nanog is off. PrE-like state: Gata6 expression is presenttrabjeucttoNrieasnmogovteraonvesrcrtiimpet,ioanreisteermffeicdiestnatbllye sfiuxepdpproeisnstsed(o.rIsCteMad-ylike                                                                                                                                          revert b

                    state: co-expression of Nanog and Gata6. Epi-like stastteat:eNs),abneocaguesexponrceessthioesne. pSooinutsrchea:ve[2b]e.enCroeapcyhreidg,hthte쯵ta2t0e1d5o,eTs he
                                                                                                                                     not change anymore without external stimulation. Unstable fixed points,
                    Company of Biologists Ltd.
                                                                                                                                      by contrast, are transient, because infinitesimally small                               perturbations
                    Think         about     the     following      question:                      Could    one        use      a
                                                                                                                                     linear regression approach between Nanog and                                             Fgf4 or Oct4?
                                                                                                                                     lead to a movement away from these points. Alterations in gene

                                                                                                                                     regulation can change stable expression patterns (fixed points)

                                                                                                                                     quantitatively and qualitatively. Qualitative changes, termed

                                                                                                                                     bifurcations, occur when fixed points emerge, disappear or change

                                                                                                                                     their stability.                                                                                                                                                                              Intriguin

                                                                                                                                          If two or more stable fixed points coexist at a given time, the system is                                                                                                                dynamic

                                                                                                                                     termed bistable or multistable, respectively. In a deterministic situation,                                                                                                                   a comb
                                                                                                                                     the initial conditions, i.e. the starting point of the trajectory, determine to                                                                                                               gene ex
                                                                                                                                     which stable state the trajectory moves. Changes between stable states
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching               4/56

Figure 5. Blood sugar regulation. If the sugar concen-
tration is too high in the blood, the pancreas releases
insulin. Insulin makes tissue cells and the liver store
or consume more sugar. If the sugar concentration is
too low in the blood, the pancreas releases glucagon to
cleave glycogen with subsequent up-regulation of blood
sugar. Licence: CC BY-NC-ND 4.0 (Fair Use).

               retina                     iris muscle (actuator)
              (sensor)                                                disturbance

  brain
(control)

brain (control)         eye                              disturbance

set point       brightness                  iris           eye            photo
                  control                 muscle          inside         receptor
     +-
              correction factor           actuator      control route  measuring unit
actual value
                                 setting            control loop
     +                           signal
       +

Figure 6. Adaptation of the eye to adjust to various light
intensities. The light source disturbs the retina. The
retina detects the light intensity and gives the actual
value to the brain. The brain compares this value with
the setpoint. If the light intensity is higher than accept-
able, the brain gives the signal to reduce the light. If the
light intensity is too low, the brain provides the signal
to increase the light intensity. The actual adjustment is
achieved via the pupil constriction by the iris muscle.
Credit to Greyson Orlando, wikimedia. Fair Use.
system                             feedbacks f(x) Chapter 3: The magic of change and how to find it -- 5/56
environment

system                    1        2                                  a
1.2  The impact of network motifs
Weeledmisteinngtusisxh two main types of loops in networks: the  sysCtoehmerent FFL          Coherent    Coherent    Coherent
                                                                 outpCouhetreynt             type 2      type 3      type 4
feedback loop and the feed-forward loop (FFL).
                             4 system 3                                 type 1                      X          X            X
system
                                                                              X                                Y            Y

Definition 1. Feedback: Processes which influence their
oiwnpnucatuuse or input.
                                                                         Y                   Y

Feedback is a type of closed loop regulatory unit, as                    Z                           Z          Z           Z
sdhioswtunrbinaFnicgeusrez7. Such control structures are widseylystem boIuncnohderaenrtyFFL
                          system structure f(x)                                              Incoherent  Incoherent  Incoherent
used in engineering in many applications too--for ex-            Incoherent                  type 2      type 3      type 4

ample, to keep the output y at the desired level.                type 1

                                                                 X                           X           X           X

r       e                 C u       y
                               x
+-                                                               Y                           Y           Y           Y
+
                                                                         Z                   Z           Z           Z

Figure 7. Block diagram of control loop (negative feed-          Figure 8. Feed-forward loops (FFL) split from one node
back).                                                           and fall together at another node. Thereby information
                                                                 is transmitted in the forward direction via two parallel
    A controller C uses the error e, which is the difference     branches (pathways). The multiplication of the signs
between the desired steady state r (set point) and the           along the interactions of each branch gives the overall
system output y, to adjust the control u. The control u          sign of a specific branch. A coherent FFL results in an
acts on the system states x.                                     end node which receives either only positive or only
The feedback loop can encode negative and positive feed-         negative signals. An incoherent FFL end node receives
back, and occurs often in biology, as shown in Figure            both sign types. Source: [4]. Copyright  1969, Nature
10 with some examples. Negative feedback occurs fre-             Publishing Group.
quently among repressors, which repress their own tran-
scription. This allows a strong maximal promoter activ-          The dynamic consequence of the Type 1 feed-forward
ity with a fast response, but at the same time strong            loop with AND gate is shown in Figure 9 and Example
repression once the desired product's steady state is            1. The output Z requires both activated X and activated
achieved.                                                        Y. Once X is activated, Y begins to increase and is consid-
                                                                 ered active as soon as it trespasses a certain threshold.
A variety of examples of network motifs have been iden-          If Y is active, it does not mean that Z is activated, as
tified in biological systems and analyzed. We can distin-        it requires maintained activation of X at the same time.
guish motifs with 1, 2, 3 and more than 3 nodes.                 This motif can be seen as a noise reducer in fluctuating
One node: In the E. coli. transcriptional network, 85% of        environments. Only a signal that is present over a longer
the auto-regulative self-edges are negative and 10% are          period can trigger a response, which arises then after a
positive [3]. There are many cases where all edges start         certain delay. An interruption of the input leads to in-
and come back to the same node.                                  stantaneous shutdown of the signal without delay. The
Two-node networks with feedback occur in e.g. develop-           Type 1 coherent FFL with an OR gate would activate
mental networks and can be seen as memory elements.              Z instantaneously, and Y would have no relevance for
Once this motif is triggered, a mutual inhibition or acti-       the activation. Instead, the OR gate would make Y into a
vation is conserved and remains independent of further           sustained activator of Z until it falls below the threshold.
input under certain circumstances. A decision for the            This motif would activate Z immediately and keep the
subsequent development has been made. For an exam-               response activation longer even if the original input was
ple, see Figure 26 at the top with the toggle-switch motif.      removed. The Type 1 incoherent FFL with AND gate
Coming to three-node network motifs, feed-forward loops          would create a peak. We would see short activation of Z
are more than 30-fold enriched in the E. coli transcription      during long time-input activation. Once the level of Y
network than random networks. Feed-forward loops can             trespasses the threshold, it inhibits the activation with
be split into coherent FFL, where the indirect path has          different levels of strength, determined by the repression
the same overall sign as the direct path, and incoherent         coefficient. The Type 1 incoherent FFL with OR gate
FFL, where the indirect path sign is the opposite to the         would be activated instantaneously, but would acceler-
sign of the direct path, shown in Figure 8.                      ate the off-signal in Y. The acceleration increases with an
                                                                 increased repression coefficient.
    Type I of both coherent and incoherent FFL are much
more enriched in the E. coli network than the other types.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                           6/56

Reminder: Logical operators such as OR and AND                      were arbitrarily chosen. The activation cutoff for Y
                                                                    matches the dashed line in Figure 9. Only above
help us to define rules:                                            this threshold, Y transmits a positive signal (Yeff).
                                                                    The chosen initial conditions are matching the val-
                           A B A AND B A OR B                       ues of the states at t = 0.

                           00       0            0                  ********** MODEL NAME
                                                                    FFL
                           01       0            1

                           10       0            1

                           11       1            1

      Input Sx  1 SX          X

                0.5                                                 ********** MODEL STATES
                                                                    d/dt(X) = k1*Sx - k1*X
                     0                                              d/dt(Y) = k2*X - k2*Y
      SX                                                            d/dt(Z) = k3*Yeff*X - k3*Z

   X

                1             Y

   Y  Y         0.5

                0

AND Delay

Z               1             Z                                     X(0) = 0
                                                                    Y(0) = 0
      Z         0.5                                                 Z(0) = 0

                0

                        0  2  4  6  8  10    12     14  16  18  20

                                       Time

Figure 9. The coherent Type 1 feed-forward loop. The                **********  MODEL  PARAMETERS
output Z shows delay after Sx addition in the input, but            Sx = 0
no delay after Sx removal. The network motif is a sign-             k1 = 1
sensitive filter, which responds only to persistent stim-           k2 = 1
uli. Source: [4]. Copyright  1969, Nature Publishing               k3 = 1
Group.                                                              thrY = 0.5

    Example 1: Simulation of coherent Type 1 FFL                       ********** MODEL VARIABLES

   Referring to the dynamic feed-forward loop with                     Yeff = piecewiseIQM(Y-thrY,Y>thrY,0)
   AND gate and its dynamic behavior shown in Fig-
   ure 9, we show here the underlying computational                     All motifs are possible considering networks with
   model which allows us to obtain such time course                 more than 3 nodes. It is imaginable that one element
   plots. This requires the formulation of balance                  in a signaling branch might inhibit the first element of
   equations for each of the modeled molecule con-                  that branch in a negative feedback loop. This section
   centrations (states), which include mathematical                 builds upon the work of Uri Alon. His book is a classic
   terms describing how the different effects change                in systems biology and highly recommended to help you
   that specific concentration. This concept of balance             understand regulatory network motifs [3].
   equations will be explained in more detail and with              We will revisit feedbacks again within this Chapter (Ex-
   more examples later in this chapter (Section 1.4,                ample 9 & Figures 23/24/25 and the respective text),
   page 9) and in Chapter 4. So consider coming back                once we have learned about characteristics of systems
   to this example after reading more about balance                 and useful mathematical approaches which will help us
   equations.                                                       to formally analyze such motif structures.
   This balance equation can then either be solved
   analytically--which we will discuss later in this                For further deepening of knowledge around this topic
   chapter--or with the help of computer simulations.               we also recommend:
   But these equations can also be solved with the help             YouTube: Network motifs
   of computer simulations. Such simulations are usu-
   ally used if the equation system is too complex to               Summary: Mode of action of network motifs
   be solved analytically. Below, we give the com-                         positive feedback = self-potentiating
   puter model in the IQM toolbox format [5]. Other                                                    (often) destabilizing
   tools use similar but slightly different formats. This                                              bifurcations
   model is used within computational frameworks                                                       bistabilities
   for numerical integration. This allows us to obtain                                                 switching behavior
   usually very accurate approximations of the sys-                                                    hysteresis
   tem behavior for a specific set of initial conditions                   negative feedback = self-degrading
   and parameters. The parameters in this example                                                      stabilizing
                                                                                                       oscillating
                                                                                                       regulating
                                                                                                                                           Chapter 3: The magic of change and how to find it -- 7/56

                                                                                                                                                                                                                                                                   liberates the

                                                                                                                                                                                                                                                                   cause cell dea

                                                                                                                                                                                                                                                                   a direct pathw

               Triggers:                                                    [Progesterone]                                                                                                                                                                         pases/death
                                                                                                            No. cells No. cells No. cells
               Progesterone-stimulated                     MEK  p42 MAPK    100x -                                                                                                                                                                                 types, but in
                           Eg2-dependent Mos synthesis +  +                  10x -                                                                                                                                                                                 pathway in wh
                                                                        +      1x -                                                                                                                                                                                tion (MOMP) is
                                                      -    Mos      Rsk                                                                                                                                                                                            tion (Scaffidi e
                 Fertilization-dependent                  +                                                                                                                                                                                                        pores in the
                 decrease in Mos synthesis                               -                                                                                                                                                                                         controlled by t
                                                                   Myt1

                                                                       -             0  max                                                                                                                                                                        can be roughl
                                                                  Cdc2                                                                                                                                                                                             Bak whose o
                                                                Cyclin B             MAPK activity                                                                                                                                                                 and Bak asso

               (a) Naturally occurring bistable system: The p42 MAPK                                                                       (b) Switch-like activation and bistability in the apoptosis                                                             tors'' of Bax a
               cascade of a frog oocyte depends on the progesterone stim-                                                                  signaling network. Source: [7]. Copyright  2011, Elsevier                                                              such as Bad,
               ulation. The more progesterone, the more the cells shift                                                                    Inc.                                                                                                                    2-like proteins
               to MAPK active differentiation. Source: [6]. Copyright                                                                                                                                                                                             pases that hav
                                                                                                                                                                                                                                                                   which in turn p
               2002, Elsevier Science Ltd.ARTICLE IN PRESS                                                                                                                                                                                                         leading to olig

                          J.W. Schmid et al. / Metabolic Engineering 6 (2004) 364-377                                                      369                                                                                                                     the mitochon
                                                                                                                                                                                                                                                                   translocation o

                                                                                                                                                                                                                                                                   c and Smac/D

                                                                                                                                                                                                                                                                   the outer and

                                                                                                                                                                                                                                                                   occur until pro

                                                                                                                                                                                                                                                                   poptotic Bcl-2

                                                                                                                                                                                                                                                                   meyer et al.,

                                                                                                                                                                                                                                                                   a sudden proc

                                                                                                                                                                                                                                                                   of no return

                                                                                                                                                                                                                                                                   2006; Tait et a

                                                                                                                                                                                                                                                                   chrome c co

                                                                                                                                                                                                                                                                   apoptosome,

                                                                                                                                                                                                                                                                   (Fuentes-Prior

                                                                                                                                                                                                                                                                   catalytic pock

                                                                                                                                                                                                                                                                   protease act

                                                                                                                                                                                                                                                                   degradation. B

                                                                                                                                                                                                                                                                   lowing effecto

                                                                                                                                                                                                                                                                   cell death (Fu

                                                                                                                                                                                                                                                                   In this Revi

                                                                                                                                                                                                                                                                   computationa

                                                                                                                                                                                                                                                                   tive biochemic

                                                                                                                                                                                                                                                                   nisms control

                                                                                                                                                                                                                                                                   with a brief de

                                                                                                                                                                                                                                                                   vant to apopto

                                                                                                                                                                                                                                                                   Modeling apo

                                                                                                                                                                                                                                                                   signal transdu

                                                                                                                                                                                                                                                                   with many te

Fig. 1. Metabolic netw(co)rkNofetgryapttiovpehatnrbyiopstyontphhesaisnfrofmeegdlubcoasce kas:cNarbuomn sboeurrcse.iMndoliacrafltuexems aorelagrivefnluaxs enusmnboerrsmneaxlt-to the enzyme symbols.                                                               a subset of th
                                                                                                                                                                                                                                                                   been subject
They are normalized to glucose uptake flux (100). The first number results from the assumption that isocitraFteigduerheyd1r.oMgenoadseeli(nICgDR)eucseespNtoAr-DMaesdiated Apoptosis                                                                               has been per
                                                                                                                                                                                                                                                                   such as diffe
cofactor (Model A), foizr ethde tsoecothndengulmubceorsNeAuDpPtaiskaessfulmuexd(to10b0e )th.eEcaofcahctoorfotfhIeCD3 n(Muomdebl eBr)s. Tbheeltohnirgd(An)touSmaimbneporlirtfiehesdeulrtscfhroemafltuicx aonfalryescies pfotorr-mediated apoptosis signaling, with
the strain NST100 (TrmibeoadnedlPvitatarrida,n19t.79S)oasusurmcein:g[N8A].DCPoaspcyorfaigcthort o쯦 I2C0D0(4M, oEdlesleCv).ieCrolIonrecd. metaboflluitoesrersecperensternetpiomrpteorrstafonrt initteiarntoarl lcinaksps ases (IC FRET) and effector caspases

of the reaction network. Except for E4P and DAHP, these metabolites are displayed more than once to allo(EwCfoFrRaEcTl)eainredricaartreadn.geTmheentM. OMP reporter measures mitochondrial outer

               Figure 10. Naturally occurring feedback in biology: (a) Posmietmivberanfeeepderbmaeacbklizoatniont.he genetic level. (b) Positive feedbachkave not yet
                                                                                                                                  (B) Steps involved in converting a biochemical cartoon into a reaction diagram                                                   This Review,

               on the protein level.(c) Negative feedback on the metaboliacndlevoredlin.ary differential equations. C8* indicates active caspase-8.
                                                                                                                                           Lower panels show a model-based 12 hr simulation of the increase in tBid which modeli
chorismate synthesis did not change significantly. Thus,                    (1) glucose transport: Not only the transport system PTS
                                                                                                              relative to the time of MOMP and analysis of the sensitivity of MOMP time to include: (1) H
according to our flux analysis, the main improvement in                     itself comes into focuBs,idbleuvtelasl.sTohethsiemsuulaptiopnlyinw(Bi)thwatshaedapted from Albeck et al. (2008b).
                                                                                                                                                                                                                                                                   activity achiev
the tryptophan overproducing strain NST 100 is the                          co-substrate phosphoenolpyruvate (negative control
                                                                                                                                                                                                                                                                   hibited during
successful channeling of all chorismate to tryptophan, as                   by PK and PEPCxylase), as well as removal of the
                                                                                                                                                                                                                                                                   activity rises?
well as avoiding feedback phenomena due to product                          products of glucose transport (PFK removing G6P
                                                                                                                                                                                                                                                                   interact to de
accumulation.                                                               via the very fast reaction of PGI, PDH removing

                                                                            pyruvate).

                                                                            (2) tryptophan biosynthesis: Especially branch point

3.2. Effects of changes in flux distribution on control                     reactions (DAHPS, Trp) exert high control, whereas

hierarchy                                                                   control by the reaction Cho is negligible in all

                                                                            models.
         Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                                                        8/56

         1.3  What is a system?                                             sand pile. One grain of sand is also not a system, as it
         Next, we are moving into the formal description of such            is only one element. A chair or a building is a system
         networks as systems.                                               because the removal of one particular element destroys
                                                                            its integrity. These are static systems. Dynamic sys-
         Definition 2. System: A system is a group of interde-              tems show changes over time. We do not have to restrict
         pendent items which are interacting with each other in             ourselves to observable behaviors. Relevant state vari-
         a way that forms an integrated whole.                              ables are of functional importance but not necessarily
                                                                            observable. Furthermore, the non-linearity of biological
         One can also say: a system is a set of interrelated ob-            systems (non-additivity) is prevalent.
         jects (elements, parts) which all have certain general
         properties [9].                                                    Linear: v[S1] + v[S2] = v[S1 + S2]

         1. The system fulfils a certain function, i.e. it can be           Non-linear: v[S1] + v[S2] = v[S1 + S2]
            defined by a system purpose recognizable by an
            observer.                                                       v linear

         2. It has a characteristic constellation of (essential)                              nonlinear
            system elements and an (essential) system struc-
            ture which determines its function, purpose, and
            identity.

         3. It loses its identity if its integrity is destroyed. A

         system is therefore not divisible, i.e. the system                                                                                                                              [S]

         purpose can no longer be fulfilled if one or several

         (essential) elements are removed.

         system                         feedbacks f(x)                      As we have seen so far already, non-linear dynamics
         environment                                                        can lead to a variety of phenomena like:

                                                                                 oscillations

         system                1     2                     system            amplification
                                                           output y
feedbackselfe(mxe)nts x                                                      adaptation (see Figure 13)                                                                                      Cell Systems                                                                 iris
                                                3
                                  4 system                                                                                                                                                    Commentary(sensor) retina
         system                                   system boundary            switching, bistability, hysteresis (see Figures 1,3,4).

         input u                                                                                                                                                                              brain

2                 system                                                                                                                                                                      (control)

         disturbances z
                  outpustysytem structure f(x)                                                                                                                                                brain (control)                                                     eye
                                                                                                                                                                                                               retina
         Figure 11. A system consists of system elements and the                                                                                  input   output (A) feedback (B) Input       set point                                                                ir
                                                                                                                                                                                                                    brightness
tem      co3nnections between them [9].
                                                                                                                                                                                                         -+ (sensocorn)trol                                                mu

                                                                                                                                                                                              actual value correction factor                                               actu
         r               e        u      y              u                   y                                                                                                                 brain + +
                               C     x                     black box                                                                                                                                                                                              setting
         +                                                                                                                                     B  A                                                                                                               signal

         As a+ s- ide note, the system structure might be (par-                                                                                                                               (control)

         tially) hidden, i.e. we do not know what is underlying

re f(x)  the observed system dynamic. We might refer to the sys-                                                                                  output                                      brain (control)                                                              e
 y
         tesmy,sttheemn, absoaubnladckarbyox--and we could try to decipher
                                                Figure 2. Near-Perfect Adaptation frFomigNuergeativ1e3F.eeNdbaecak r-perfect adaptation to varying input levels
         the system behavior by analysis of the(A)rAesilmaplteinoegnativsehfeeidpbacok sfystem caopabblteaofigneneerdatingfnreoar-mperfenct eadgapatattioinv. e feedback. Other exasemt ppoilnets and
                                                (B) Rate equations and parameters for the system. Note that Ma and co-workers (2009) used Michaelis-Menten terms for all four rate terms. For simplicity we have brightness
         + inputs u and outputs y, as illustrated inasFsuimgeud mraess a1c2tio.n kinetics for the first rate equation.
                                                                                                                                                                                                                                                         control
                                                        D (C) The response of the system to steps uspoanud drocwen i:n t[he1in0pu]t .levCel. Tohepnyegratiivge fheetdb쯠ck (2mi0dd1le6pa,neEl, glrseeenvcuirvee)rlagIsnbechi.nd the input stimulus (top
                                                - panel, blue curve), allowing the output (bottom panel, red curve) to go up and then come back down. Note that the return toward baseline is not always monotonic;
                                                                                                                                                                                              actual value correction factor
                            u                   the system sometimes exhibits damped oscillations as it is adapting.                                                                          + +
                                     +  1 y 
                                                                            + See also                                                                                                                                                                            settin
                         black box  B +  A and B wereCbeing syn+thesized and Evidently the various negative feedbacks To model this process, Friedlander and
                                                degraded rather than activated andYinoaucti-Tudbesec:ribeTd habeovbe eaareuntoyt osuffficaiencthtao otBircendneor aussbumleedptheatnsidgnual ltruanmsduction                                                      signal

                                                vated (Tyson et al., 2003). The resulting allow RTK signaling to be terminated nor- protein A can exist in three states: an initial
         Figure 12. The black box concept. WAe knmoodwel adlaiptttslpeerfaecbtlyotouatny step in stim- mally without an intact Ras-Sos-GAP off state (Aoff), which is ready to receive a
                                                ulus, irrespective of parameter choWice.e wiilnlcoehxerpenltoferedefotrwhaerdsseystiemm.portantstbimeulhusa; avnioonrsstatoe n(Aotn)h, wehenreeitxptro-
         the system, but we can learn about its behInacovhieorernt frfeoedmforwtahrde regulation is                                                                                           duces an output; and an inactivated state
                                                important for adaptation in receptporatygroe- s,Sstattaer-DtienpegndwenittInhactthivaetioinn troduc(Atiino) tnhatoisfinacampabalethof eremspoantdiincgatlo a
         input u to the output y.
                                                sine kinase (RTK) signaling. The raelpevpanrt oaAcs hmefnotiornedd,eMsacretibali. nidgentdifieydnhuanm- isctsimuoluvse(Frigtuirem4Ae).. The inactivation is
                                                proteins are the famous Ras, Sos, and dreds of circuits that could generate assumed to be either intrinsic to the acti-

                                                                                                  GAP proteins (Figure 1). Activated EGFR di-  adaptive pulsatile responses. However,         vated protein (as is the case for the sodium
                                                                                                                                               all of these generally more complicated        channel) or to depend only upon constitu-
             Let us look at some examples. A msaerns adutopphiolsephoirsylante ototproduce dock-                                               circuits turned out to be elaborations of      tively active downregulators (which in
                                                                                                                                               either a negative feedback loop or an          some cases is true in GPCR desensitiza-
                                                                                                  ing sites for the guanine nucleotide

         a system, as after the removal of a sub-part it is still a

                                                                                                  exchange factor Sos via the intermediacy

                                                of the Grb2 adaptor protein. The docking incoherent feedforward system. This sug- tion and RTK internalization).

                                                of the Grb2-Sos complexes at the phos- gested that the two motifs might be the Initially, we assume that the conversion

                                                phorylated EGFR brings Sos into proximity only simple mechanisms for generating back to the Aoff form is relatively slow

                                                of its target, the plasma membrane-bound near perfect adaptation (Artyukhin et al., compared to the activation and inactiva-

                                                Ras protein, allowing Ras to drop its bound 2009; Ma et al., 2009).                                                                           tion reactions, and we assume simple

                                                GDP, pick up a GTP, and become acti- This proved not to be the case. Shortly mass action kinetics for the activation

                                                vated. EGFR->Grb2-Sos->Ras represents after the publication of the comprehen- and inactivation reactions (Figure 4B)
                                                                    Chapter 3: The magic of change and how to find it -- 9/56

1.4  How to describe change mathematically                          visualized in Figure 14. The calculation of the time
The change of a variable is described by a derivative--a            response x(t) is:

concept from calculus. The most widely used mathe-                                 dx
                                                                                   dt = 탘
matical approach to capture such changes in models                                                |  dt : x

is done with Ordinary Differential Equations (ODE).                         1dx = 킺t |
                                                                            x
Such ODEs have a dependent variable y which is a func-

tion y(t) of 1 independent variable such as time t. The                     x1                 t

derivatives of the dependent variable are found with re-                           dx =  1dt
spect to the independent variable dtdy . If the independent
                                                                         x0 x               0

variable is time, we can use the dot above the dependent                 [ln(x)]xx0 = (t - 0)
          dy
variable  dt  =  y  to  indicate  derivatives,  otherwise  we  use      ln(x) - ln(x0) = 탏

a prime symbol: y. The dependent and independent                                     x            |e to both sides
                                                                                ln( ) = 탏
variable appear in the explicit:
                                                                                    x0
y = f (t, y)                                                                          x = e탏
                                                                                     x0
or implicit equation form:
        f (t, y, y) = 0.                                                            x(t) = x0e탏

Important: In the context of models of biological sys-                                               >0
tems, often only 1st order ODEs are applied, as illus-                   
trated in Example 2. We have therefore included an in-
troduction to these cases only. ODEs might also contain                  0                                    =0
higher derivatives, i.e. derivatives of derivatives. Fur-
thermore, Partial Differential Equations (PDE) have                                                                         <0
a dependent variable y, which is a function y(z1, z2, . . . ,
zn) of at least 2 independent variables zi, such as time                                                                            
(e.g.: z1 = t) and 3 room coordinates (e.g.: z2, z3, & z4).
While an ODE is frequently used for processes over time,            Figure 14. Population growth x depending on time and
a PDE is often used to describe processes over time and             the specific growth rate . See Example 2.
space. These advanced cases are not discussed here but
are the subject of further reading if you are interested.                                    ( + )

                                                                        A set of non-linear ODEs of n-th order can be written
                                                                    as:

                                                                    dxi            ()                                 ,i = 1...n
                                                                         = xi = fi(x1, . . . , xn, p1, . . . , pn,t)
                                                                    dt                            

A simple ODE model can be studied in Example 2 to-                  and in vector notation as:   + 
gether with Figure 14.                                                     dx
                                                                                = x = f(x, p,t)
    Example 2: Simple ODE for biomass growth                                dt

Another example of what x and its time derivative                   with the independent variable t, the time-dependent
x might represent is biomass and its growth.                        states x = (x1, . . . , xn)T , mostly time-invariant parame-
                                                                    ters p = (p1, . . . , pn)T , and the functions f = ( f1, . . . , fn)T .
x . . . population size                                             Although the system states are time-dependent, they
                                                                    should still be linearly independent of each other. The
x. . . growth rate                                                  order of an ODE equals the number states within the
 = xx . . . specific growth rate                                   set of 1st order ODEs.
With the assumption  = const, we can write the
following ODE:                                                      Reactions depend on changing substrate concentrations

       x = 탘                                                       In the last chapter, we considered constant substrate
                                                                    concentration in the steady state:

                                                                    S = N  v = 0

with initial condition x(t = 0) = x0 and                            and we looked mainly at the fluxes v, which can also
 > 0: exponential growth                                           be dissected into forward v f and backward vb reaction
 < 0: asymptotic decay                                             fluxes. If the substrate concentrations are constant, it is
                                                                    possible to combine these with the constant parameters
                                                                    to a flux value for a given reaction.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                  10/56

With the study of the time behavior of each substrate's               One can also derive the equations directly from the
concentrations in our system with:                                reaction schemes without using the stoichiometric ma-
                                                                  trix. This might be error-prone for larger biochemical
       S = N  v                                                  systems and molecularities of 2 and above. For the given
                                                                  scheme, the ODE system is:
we cannot do this anymore. We have to dissect the flux
vectors into constant parameters k and now variable               S1 = -k1S1S2 + k-1P2
substrate concentrations Si. Therefore, we usually use
the very important Law of Mass Action formulated by               S2 = -k1S1S2 + k-1P2
Waage1 and Guldberg2 in 1864 [11]. For each reaction
j, we can define the concentrations of substrates Si and          P = 2k1S1S2 - 2k-1P2
products Pi:
                                                                  = 2  (k1S1S2 - k-1P2)

                                                                  N       v

  kj
 m j S j ----  m j Pj                                             This modeling principle can equivalently by applied for
  k- j                                                            protein-binding reactions where the parameters k repre-
                                                                  sent the affinity between proteins--for example, between
with indexes  and  being subsets of the metabolite in-            ligand and receptor:
dexes i = 1, . . . , m and molecularities m j , m j for reaction
j and participating substances ,   i. The molecularity                                   k1
is often 1 or 2.
We can say that the reaction rate is proportional to the                 L + R ---- LR
probability of collision of the reactants. The probability
of collision, in turn, is proportional to the concentration                             k-1
of reactants to the power of molecularity (stoichiometric
coefficient). The general mass action kinetics for chemi-         with the net reaction rate (from left to right):
cal reaction networks is:
                                                                         v = vbind - vunbind = k1  L  R - k-1  LR

v j = v j, f - v j,b = k+ j  S j m j - k- j  Pjm j                We could, for example, use this equation to see how
                                                                  much ligand-receptor complex LR will be present for
                                                                  certain initial concentrations of ligand L and receptor R.
                                                                  High affinity with a large constant Ka = k1/k-1 shifts the
with the product of sequence operator  which indicates            equilibrium towards the complex, and low affinity shifts
that the following elements are multiplied (same princi-          this equilibrium to the monomers. After we have mod-
ple as for the operator  to sum up the following terms).          eled a reaction network, an equilibrium can be found
The equilibrium constant:                                         for the whole system. Trying to derive such an equi-
                                                                  librium for many coupled reactions by intuition alone
                     k+ j  P j ,eq m j                            might be too challenging. Thus, we need mathematical
        K j,eq = k- j  = S j,eq m j                               models. The ODE modeling framework gives the highest
                                                                  quality of mechanistic insight among all tools in systems
for reaction j can be obtained if the substances are in           biology--but only if we have enough data to adjust this
equilibrium v j, f = v j,b. In contrast to Chapter 2, here        kind of model properly.
we do not have a dynamic equilibrium of metabolites'
production and consumption.
For the biochemical reaction:

                                     k1

                S1 + S2 ---- 2 P

                                    k-1

we get the net reaction rate:
       v = v f - vb = k1  S1  S2 - k-1  P2

with S1, S2 and P denoting the respective concentrations
and k1 and k-1 being the rate constants of the forward
and backward reactions.

    1 Norwegian chemist Peter Waage (1833-1900).
    2 Norwegian mathematician and chemist Cato Maximilian Guld-
berg (1836--1902).
                                                             Chapter 3: The magic of change and how to find it -- 11/56

1.5  What is a steady state?                                 which gives the steady-state solution:
A steady state is characterized by the absence of change
in the variable values while time progresses.                x = 4 , y = - 2
Definition 3. Steady state: In systems theory, a system      3             3
or a process is in a steady state if the variables (called
state variables) which define the behavior of the system     Example 5: Steady states of a non-linear system
or the process are not changing over time.
                                                             We work on a non-linear system and will thereby
This definition is referring to macro-scale changes over     often obtain multiple steady states, like in this ex-
time. Back reactions equal forward reactions at the molec-   ample:
ular scale in a closed system. In an open system, a dy-
namic equilibrium occurs in which fluxes and reactions              x = (y + 2x - 2)x = 0
are constant. We have a steady state if all derivatives of
all state variables xi become zero:                                 y = (y - x + 2)y = 0

                   ...                                       This set of equations is already in the factored form.
       xi = x쮑 = x i = . . . = 0                            1 of the 2 factors in each single equation must be
                                                             zero so that the whole term is zero. We have 2
for all i. Moreover, specifically for the 1st-order systems  equations with 2 factors each. Thus, we expect 4
we consider in this chapter, we have a steady state if the   steady states, whereby a subset can be the same.
(1st-order) derivatives of all state variables xi become     To simplify our approach, we will look at different
zero:                                                        cases.
                                                             Case 1
       xi = 0                                                Let's say the first variable x shall be zero:

for all i.                                                                                        x1,2 =0
Consider the following Examples 3, 4, and 5:
                                                                    x = (y + 2x - 2) x = 0
    Example 3: Balance equation in steady state
                                                                    y = (y - x + 2) y = 0
           d 
                =  = J -P                                                            y2 y1

            dt                                               Then Equation 1 is zero as well. The second equa-
                                                             tion is then:
   Steady state?
                                                                    0 = (y + 2)y
               = J - P = 0
           J=P                                               which results in two allocated y values:

    Example 4: One steady state of a linear system                  y1 = 0, y2 = -2

   The derivatives of all states shall be zero:              with which we get our first 2 steady states (0,0)
                                                             and (0,-2).
           x = y + 2x - 2 = 0                                Case 2
           y = y - x + 2 = 0                                 We now take the other factor (y + 2x - 2) in the first
                                                             equation and set it to zero:
   Subsequently, we mark all state values with a star
    to indicate that these are steady-state values and       !=0  y3,4
   re-order the equations above as follows:
                                                             x = (y + 2x - 2) x = 0
           y = 2 - 2x                                        y = (y - x + 2)y = 0
           y = x - 2
                                                                x1,2
   Eliminating y by setting both of the right-hand
   sides to be equal delivers:                               Therefore, y has to be:

           2 - 2x = x - 2                                    y = 2(1 - x)
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  12/56

with which the second equation becomes:
       0 = 2(1 - x)(4 - 3x)

which results in:

         x3 = 1, x4 = 4
                           3

and two allocated y values with which we get our
                                         4        2
last  2  steady  states  (1,0)   and  (  3  ,  -  3  ).

Case 3 (redundant)

Ansatz: y = 0

with the solutions (1,0) and (0,0).

Case 4 (redundant)

Ansatz: y = x - 2                        4        2
                                         3        3
with  the  solutions     (0,-2)  and  (     ,  -     ).
                                                                     Chapter 3: The magic of change and how to find it -- 13/56

x2        trajectory
1.6  Stability theory: Idle sta[xt1e(0o),rxe2(x0p)]losion
Stability is a system-intrinsic property and is character-
                                                                        unstable           stable             metastable
ized withxout external inpstaubtleust=ead0y.stAatenon-linear system  (system leaves   (system returns         (behavior is
                                                                      steady state)   to steady state)        indifferent)
               2

can have several steady states. The system's steady state

might be slightly deflected by  x:

x0 = x +x       x             x1

                  1

and the subsequent behavior indicates whether a system               Figure 16. Assessing stability with an x over x plot. For
is stable, unstable, or metastable--as illustrated in Figure         the unst>ab0le steady state,>if0|xis dev<ia0t|in g inthe positiv<e0
15.                                                                                   

                                                                                       > 0               > 0
                                                                     direction from steady state, the resulting derivative will

                                                                     also be positive and thus make x even more positive--
                                                                     and vic<e 0v|ersa for negative deviations.                
                                                                                                                 Contrarily, for           
                                                                                                                                     < 0|
                                                                      > 0
                                                                     the stable steady state the der=ivative (change) willb>e0

unstable              stable        metastable                       negative if x isunpsotasbilteive and positive if x is negative. This
                                                                     will outbalance deviations and stabilize the steady state.

(system leaves  (system returns     (behavior is

steady state)   to steady state)    indifferent)                     () ,  > 0        ()  =  = 0 ()                         ,  < 0
                                                                                                  0 = 1                       0
Figure 15. To get an initial intuition, imagine a ball on
different surfaces. If you poke it a bit, what will happen?                                1

To test this, we linearize around the steady state of the ex-                                                                     
ample system x = mx and can see by the slope m whether
the steady state is stable or not. Linearization is scruti-          unstable           meta stable                   stable
nized in the mathematics section. Ponder on Figure 16.                                                           (type 0 system)
The linearization:                                                                    (type 1 system)

       x = Jx                                                        Figure 17. Behavior over time for the unstable, metastable,
                                                                     and stable system of the form x = mx with different pa-
with the Jacobian matrix J is explained in the mathemat-             rameter values m.
ics section. The formal approach employs the exponen-
tial function starting from the system equation:                     ansatz:

       x = mx                                                                 x = est
                                                                              x = sest
with the ansatz x(t) = est and its derivative x(t) = s                       x = s2est
est , and consequently we transform the system into the                      ... 3 st
Laplace Domain. It results in:                                               x =s e

       sest = mest  s = m                                                      (4) 4 st

with s being the Eigenvalue of system x = mx. See also                       x =s e
Figure 17.
                                                                     to transform our problem into the frequency domain
The characteristic polynomial and Eigenvalues for higher             and get:
order systems
In general, the characteristic polynomial allows us to                      sn + . . . + a2s2 + a1s + a0 = 0
determine the Eigenvalues of the system and thereof the
stability of the steady states.
An ordinary differential equation in the non-matrix rep-
resentation

          (4)

        x + . . . + a2x + a1x + a0x = b0u

is the base for the characteristic polynomial without con-

                                                    !

sideration of the control (u = 0). We use the Laplace
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                       14/56

 Example 6: 2nd-order system                                  we get:

       x + a1x + a0x = 0                                              sx1 = a11x1 + a12x2
ansatz:                                                                sx2 = a21x1 + a22x2
                                                                       
       x = est
       x = sest                                               s x1 = a11 a12                x1 = 0
       x = s2est                                                      x2     a21 a22       x2

                                                                       x              A        x

                   s2est + a1sest + a0est = 0  | : est (= 0)           s 1 0 - a11 a12                x1 = 0
                      s2 + a1 s + a0 = 0                                                              x2
                                                                          01          a21 a22
                                                                                                      =0
                            tr     det                                            =0

                  -a1  a21 - 4a0                             sI - A = s 1 0 - a11 a12
        s1,2 = 2                                                              0 1 a21 a22

    The linear x = Ax or linearized system x = Jx in the               = s 0 - a11 a12
matrix form can also be treated with the same ansatz:                       0 s a21 a22

       x = I est                                                       = s - a11 -a12 = 0
       x = sI est                                                           -a21 s - a22

and the identity matrix I to get:                                       (s - a11)(s - a22) - a12a21 = 0
               sI est = AI est = Aest                          s2 - a11s - a22s + a11a22 - a12a21 = 0
                                                              s2 - (a11 + a22) s + a11a22 - a12a21 = 0
       (sI - A)est = 0
         (sI - A)x = 0

                                                                           tr(A)               det A

We only obtain non-trivial solutions (x = 0) of the homo-                             s2 - tr(A)s + det A = 0
geneous system if we look for:

       det(sI - A) = 0,                                                    tr(A)  tr2(A) - 4 det(A)
                                                              s1,2 =                                      .
                                                                                         2

which is another form of the characteristic polynomial.       s1, s2 can be real numbers but alsocomplex numbers of
However, if the system matrix is a square matrix, and         the form s = Re(s)+iIm(s) with i = -1. If the number is
the rank equals the number of variables (rk(A) = n), we       complex, the system has oscillating behavior. See Figure
only obtain the trivial solutions (x = 0).                    18 for different Eigenvalue pairings and the consequen-
                                                              tial systems behavior. Additionally, we can also classify
Eigenvalues of the 2x2 matrix (fast equation)                 the systems according to the Final Value Theorem (FVT).
                                                              Eigenvalues on the imaginary axis and the right half of
The characteristic polynomial of a 2nd-order system (n =      the plane indicate that the system does not converge to a
2) is introduced in Example 7 and can be obtained by          value and is thus not classified with the FVT. We classify
the following procedure:                                      the system type according to the number of Eigenval-
                                                              ues in the origin. If the real part of the Eigenvalues is
          x1 = a11x1 + a12x2                                  on the left-hand side, we have a Type 0 system. If one
          x2 = a21x1 + a22x2                                  Eigenvalue is on the origin and the rest is in the left-half
                                                              plane, we have a Type 1 system that is going to have a
                                                              real finite number, as shown in Figure 17 middle. With
       x1 = a11 a12             x1 = 0                        each additional Eigenvalue at the origin, we increase the
       x2          a21 a22      x2                            system type order and get unstable behavior.
                                                              YouTube: Final Value Theorem (up to 8:17).
       x           A            x

with:

       x = I est
       x = sI est
                                                               Chapter 3: The magic of change and how to find it -- 15/56

    Im(s)                            Im(s)                     b)

                          Re(s)                       Re(s)                        x1 =  -1 4 x1
                                                                                   x2     0 -3 x2
     stable (Type 0), no         unstable, no oscillations          s1 = -1; s2 = -3
oscillations  stable node             unstable node                                        stable node
                                      Im(s)
         Im(s)                                                 c)

                                                                                     x1 = 3 8 x1
                                                                                     x2      1 1 x2
                        Re(s)                        Re(s)
                                                                    s1 = 5; s2 = -1  unstable saddle
       stable (Type 0),          unstable, oscillations
oscillations  stable focus          unstable focus             d)
                                     Im(s)
        Im(s)

                                                                                         x1 = -1 3 x1
                                                                                         x2      -1 1 x2
                                                      Re(s)                        
                      Re(s)      unstable, no oscillations          s1,2 = 0  2i     metastable limit cycle

      metastable,                      saddle point            Stability classification
conserved oscillations
                                      Im(s)                    We can classify the stability properties via the Eigenval-
      limit cycle                                              ues, as summarized in Figure 18. For 2x2 matrices, we
      Im(s)                                                    can also use the trace and the determinant of the system
                                                               matrix as shown in the Poincar diagram in Figure 21:
           Re(s)                            Re(s)

metastable (Type 1)              unstable (Type 2 and higher)

Figure 18. Eigenvalues in the frequency domain are             =   tr(A)  tr2(A) - 4 det(A)  .
shown in the s-plane. Each Eigenvalue has a real and
imaginary part: s =  +i with Im(s) = i, and Re(s) =                2

                                                               with the distance between Eigenvalues:

Example 7: Eigenvalues and stability                                   =: tr2(A) - 4 det(A) = 0

a)                                                                                          det(A) = 1 tr2(A)
                                                                                                        4
    x1 = 3 -2                    x1 + 1 u
    x2     15                    x2  0                         to get the threshold above which we gain imaginary
                                                               numbers.
We search for the Eigenvalues with:
                                                                    1, 2 < 0 then det(A) > 0, tr(A) < 0  stable node
           det(A - sI) = 0
                                                                    1, 2 > 0 then det(A) > 0, tr(A) > 0  unstable
    det 3 - s -2 = 0                                                  node
            1 5-s
                                                                    1 < 0, 2 > 0 then det(A) < 0  saddle node with
    (3 - s)(5 - s) + 2 = 0                                            one stable and one unstable direction
          s2 - 8s + 17 = 0
                                                                    Re(1) = Re(2) < 0 with no vanishing imaginary
                               -8           -8 2                      part. Then det(A) > 0, tr(A) < 0, tr2(A) < 4 det(A) stable
                     s1,2 = - 2                    - 17              spiral

                                             2                      Re(1) = Re(2) > 0 with no vanishing imaginary
                                                                      part. then det(A) > 0, tr(A) > 0, tr2(A) < 4 det(A) unstable
            s1,2 = 4  i  unstable focus                              spiral

                                                               Slopefield
                                                               A slopefield describes the slope at each point in the phase
                                                               plot and thereby is an informative visual representation
                                                               of the system dynamics.
                                                               YouTube: Slope fields
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  16/56

                      overdampedamplitude

                                       critically damped

                      underdamped

                                       time

Figure 19. An ODE system can show various behavior de-
pending on the damping ratio. The higher the damping
ratio is, the more the oscillatory behaviour is reduced.
See Example 8.

    Example 8: Damping

   For a deeper understanding of the origin of real
   and imaginary Eigenvalues and the respective sys-
   tem behavior, it is beneficial to look at damping, as
   shown in Figure 19. Damping reduces the impact
   of the oscillatory behavior. In physical systems it
   is achieved by the dissipation of energy stored in
   the oscillatory system. Let's assume a system has
   the following characteristic equation:

           s2 + 2s +  = 0.

   The quadratic equation can be solved with the p-q-
   equation:

           s1,2 = -1  1 - 

   We see that the first term indicates negative Eigen-
   values at the first glimpse. This remains the case
   as long 0    1. If we have  < 0 we have one
   positive Eigenvalue and thus an unstable saddle. If
    > 1, we obtain a negative value below the square
   root and the term turns into the imaginary part
   켲 of the complex number s. Consequently, we
   have oscillatory behaviour. Thus  has a damping
   function with:

   0    1 overdamped

    = 1 critically damped

    > 1 underdamped

   The smooth transition within the p-q equation and
   the symbol  explains why the imaginary parts of
   the complex Eigenvalues arise pairwise with the
   same real part in Figure 18. This only applies to
   simple systems with a 2x2 system matrix A.
                                                               Chapter 3: The magic of change and how to find it -- 17/56

1.7  Phase portrait: How elements relate to each other             Interestingly, not all initial points might lead to the
Let's assume we have a stable system with two elements         same steady state. Depending on your initial point, the
x1 and x2.                                                     trajectories might be shaped differently and might land
                                                               at different steady states, given that you have multiple
x1(t) = f1(x1(t), x2(t))                                       stable points. Thus, it is interesting to look at several
x2(t) = f2(x1(t), x2(t))                                       trajectories which start at different initial points.
                                                               If we want to draw a phase plot by hand, we would
We do not only want to know how the elements change            greatly benefit from orientation lines. Therefore, we
over time. We also want to know how the elements relate        determine asymptotes with the most simple cases as
to each other:                                                 being:

        dx2(t) = f2(x1(t), x2(t))                                   Vertical asymptotes (vertical tangents)
        dx1(t) f1(x1(t), x2(t))
                                                                    Horizontal asymptotes (horizontal tangents)
by making use of the relationship:
                                                                    Oblique asymptotes.
x2(t) dt dx2 dx2 dt dx2                                        What horizontal and vertical means depends on which
    = dx1 =               =.                                   element you want to study in dependence on the other.
x1(t) dt dt dx1 dx1                                            We remain in the general equations shown above (see
                                                               also Figure 20). We obtain the horizontal and vertical
Put in simple terms, the time derivative has been can-         tangents with the following ansatz:
celled out and we have no time axis anymore, as illus-
trated in Figure 20. But time is still present, because             Horizontal tangent ("no change in the x2-direction"):
at each time point and for each state magnitude x2 has
                                                               f2(x1, x2) = 0                          (1.1)
an allocated state magnitude x1. For the whole time, it
could be that the system has passed different magni-            Vertical tangent ("no change in the x1-direction"):
tudes of x2 at a particular magnitude of x1. Moreover,
there might be several different values for x1 at the mag-     f1(x1, x2) = 0                          (1.2)
nitude x2. But let us go back to the start. You can now
choose which initial values you would like to start with           For the oblique asymptote, we introduce the general
[x1(t = 0), x2(t = 0)]. From this point on, the system will    linear equation into our phase plot equation:
move in the phase plot until it reaches a stable state
where it will remain forever [x1(t  ), x2(t  )]. The
path which the system takes until it arrives a stable point
is called a trajectory.

x2  trajectory                                                 d(x2 = mx1) = m = f2(x1, (x2 = mx1)) .
                                                               dx1             f1(x1, (x2 = mx1))
                                     [x1(0), x2(0)]

x2                        stable steady state                  The obtained values for m are set back in the linear equa-
                                                               tion x2 = mx1 and represent the oblique asymptotes. For
             x                       x1                        a deeper discussion of this topic, please refer to the exer-
                                                               cises at the end of this chapter.
               1
                                                               Definition 5. Nullclines: Curves on which the trajecto-
                                                               ries have the derivative 0.

Figure 20. Phase portrait. The axes represent the mag-

nitude of the elements x1, x2. The trajectories start from

[x1(t = 0), x2(t = 0)] and move over time to a stable steady

state [x1(t  ), x2(t  )]. In this way, we can plot our

system as the change of element x2 over the change of

the element x1. One could also decide to show the rela-

tionship the other way around, e.g., the phase plot as the

change of x1 over the change of x2.

Definition 4. Trajectory: Set of all state points (x1, x2) in
the state plane starting from t0 or t = 0.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                        18/56

Poincar큖 Diagram: Classification of Phase Portaits in the (det(A), tr(A))-plane

                                              det(A)                      =0:

=0                                                                        det(  A)=  1  (tr(  A))2
                                                                                     4

                                 spiral sink          spiral source

degenerate sink                                                                              degenerate source
                           sink
                                 uniform              center
                                 motion

                                                                                source        tr(A)

line of stable fixed points                   saddle          line of unstable fixed points

Figure 21. Poincar diagram for 2x2 matrices: Classification of phase portraits in the (det(A), tr(A)) plane. Credit to
Gernot Salzer, No rights reserved.
                                                          Chapter 3: The magic of change and how to find it -- 19/56

1.8  Feedback revisited                                   tem for the concentrations of A and B:
In the next step we will use the introduced mathematical                                
concepts and analyze the systemic properties of some                                         u
network motifs discussed earlier. We will thereby see     A  1 -1 0 1 k2A
how and when these motifs give rise to characteristic     B = 0 1 -1 0 k3B
non-linear dynamic phenomena.
                                                          S     N                            k4B
                          Sequential
                                                                                             v
                    1 A 2 B 3
                                                             = -1 0 1 k3B k2A + 1 u
                          Positive feedback                  1 -1 0                                  0
                                           4 > 0                                        k4B
                                                                                        
                     1 A 2 B 3                                                          A
                                                             = -k2 0 k4 B + 1 u
                          Negative feedback                  k2 -k3 0 B 0
                                          4 < 0
                                                          A = -k2 k4                 A + 1u
                     1 A 2 B 3                            B  k2 -k3                  B          0

Figure 22. Network structures of the feedback examples    x  A                       x            u
as analyzed in Example 9.
                                                          which is the ODE system:
    Example 9: Feedback
                                                                 A = -k2A + k4B + u
   In this example we will perform a detailed, mathe-            B = k2A - k3B
   matical analysis of the effects of negative and posi-
   tive feedback in a simple metabolic pathway (Fig-      Let's interpret these equations: We have an influx
   ure 22). We start with the general stoichiometric      u, which positively influences the change of A. A
   matrix:                                                part of the substance A turns into B with reaction
                                                          rate k2. If term k2A is subtracted from the first equa-
                  v1 v2 v3 v4                             tion, it negatively influences the change of A. The
           N = 1 -1 0 1 A                                 same term appears in the equation for the change
                                                          of B. This ensures that no mass is lost. Thus, the
                  0 1 -1 0 B                              term k2A positively influences the change of B as it
                                                          negatively influences the change of A, which makes
   We have 2 equations (m = 2) and 4 reactions (r = 4).   sense because we want to turn substance A into sub-
   The rank is 2 (rk(N ) = 2). This means, we can set     stance B. The substance B leaves the system with
   2 unknowns k to arbitrary numbers to find 1 of         rate k3. One can see that the loss of substance of B
   the many possible solutions. We decide to take         increases with the abundance of B. The feedback
   the influx k1 as control u and to set k4 to different  via k4B influences A depending on the abundance
   values:                                                of B. This interaction is modeled as signaling flow.
                                                          B "only" transmits a signal but is not converted.
   k4 < 0: negative feedback                              This means that it does not preserve the mass con-
   k4 = 0: sequential (no feedback)                       servation at this point and it does not reduce B by
   k4 > 0: positive feedback                              k4B.

   We use mass action kinetics to set up an ODE sys-      This is a fundamental and important difference:

                                                               Preserve mass conservation  substrate flow

                                                               Not preserve mass conservation  informa-
                                                                 tion flow.

                                                          We will now look at the stability of system matrix
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  20/56

A via the Eigenvalues:

    -k2 k4 - s 0        = -(k2 + s)       k4 = 0
    k2 -k3      0s              k2    -(k3 + s)

    (k2 + s)(k3 + s) - k2k4 = 0

s2 + (k2 + k3)s + k2(k3 - k4) = 0

We study the case k2 = k3 = 1:
            s2 + 2s + (1 - k4) = 0

The related p-q equation is:

    s1,2 = -1  1 - (1 - k4) = -1  k4

Sequential setting k4 = 0:

Both Eigenvalues are negative

 s1 = -1; s2 = -1                   stable (Type 0)

Positive feedback (k4 = 2):

 S1 = 0.4142; S2 = -2.41            unstable saddle

Positive feedback (k4 = 1):

 S1 = 0; S2 = -2                    metastable (Type

1)

Negative feedback (k4 = -1):

 S1,2 = -1  i

Damped oscillations, stable (Type 0)

The following video show the simulation of the
dynamic behavior of this pathway with different
strengths of negative or positive feedback:
YouTube: Example simulated
                           critically damped                                                                     0        stable                                              0 stable          unstable         stable
          underdamped
          am                                                                                                                                                                            3                                1

                                               amplitude        time                                                Chapter 3: The magic of change and how to find it -- 21/56

                                                        time domain                                                              frequency domain

          1.9  Bifurcatoisocni:llSatpiloint itb-aby !                                                       decay -             Michaelsis--pMleannteen           Imaginary (frequency)                       steady
                                                                                                                                                                                                              states
          Adding to Example 9, we will now tackle the mathemat- 6 ()                                                                                                                         2
                                                                                                                                                                                                            
          ical analysis of another example model of feedback. We                                                                                                                              1.5
                                                                                                                                                                                    Real (exponential)
          will, in addition, analyze how the obtained steady states                                                                                                                  = 1
                                                                                                                                                                                      0.75
          and dynamic properties depend on the value of a system
                                                                                                                                                                                             0
          ptiamreameter. Simple feedback catinmealso be modeled as:
                                                                                                                    time           

          original x = -knFeog u xrier transkfnoergm> 0, x(t = 0) = 1                                                               2                            

                         Laplace transform -- = -(+) = -                                                                        0.25 -2

          which turns out to be a stable steady state, as shown in                                                              0.5 0
          Figure 16.
          The time-course is:                                                                                                   1    1                            0
                                                                                                                                                                          stable
                                                                                                                                2    1.5                                                        unstable

                                                                                                                                                                                        0.5     

             x(t) = x0  e-kneg톞                                                                                   Figure 24. Feedback with saturation: The Michaelis-
                                                                                                                    Menten equation stabilizes the system, so that we get a
 = 0                                                                                    = 3                         stable state for each kpos. Compare with Figure 23.
          as sh-ownin Figure 23 left. Positive feedback(, how-ever,)
() = m0 ight destabilize a system. Let's(ha)ve=a lo0ok at combined

          negative and positive feedback                                                                         5              

                                                                                                                                                                                                    1, 1.5, 5.5
             x = -kneg톥 +=k0pos  x                                                   kneg, kpos > 0; x(0) =1 = 3 2                                                                            5.5
                                                                                                                                                                                                1.5
                                                                                                                                                                                                1

          whereby the variable x is the cause and the change x is2                                                              1 5.5
                        1

          the consequence within the feedback loop. The related
       5        3                                                                                                0        0.5
0                   of                                  thisodveridfamfeperd ential  equation  is:                                                                                              0.5 0, 0.5
          solution                                                                                                                                0, 0.5, 1, 1.5                                0

                                                                  critically damped                                                                                                              
                      un(dkerpdaomsp-edkneg )톞
                                                                                                                    frequency domain                                                    stable
             x(t) = x0  e
                                                                  time

                                                                  time domain
          As you see in Figure 23 right below, the system becomes
                                                                   oscillation -                       decay -               Imaginary (frequency)
          unstable if the parameter exceeds certain values. How-                                                    s-plane     

          ever, healthy biological systems are never globally un-                                                                  Real (exponential)

          stable, because they run into saturation. Malignancies                                                                   
          sltiakeblceancer antdimevirus prod0uctionst,itmahe bowleever, can beunstimeseetanble
                                                                                                                                   stable

          as biologoircigainlalsystemsFtohuarietrmtraingsfhortmlead to global system
          failure, if outbalancingLafpeleacdebtraacnksfo(rmmed-ic-am =e3n-(t,+im) =mu-ne                                                                          1                     4 

          system) are too weak to control the disease.                                                              Figure 25. Feedback with complex behavior: Here we

                                                                                                                    get several stable states, but also hysteresis. Compare

                                                                                        = 3                         with Figure 23 and 24.
                                                                                       () = 0  (-)
                 = 0
                () = 0  -

                                                                   =0                                      = 3 5  We can use the Mic5.5h1,1.a5,5e.5 lis-Menten function to mimic a
                                                                    2 steady 1.5 1
          () Michaelis-Menten                                                                               2 2     saturation for the positive feedback:
                                                                                                                    1 5.5 states
                                                       1
          65 3                                                                                            01.5 0.5
                                                                                                                                                                  0.5 0, 0.5
                                                                                                                                                                  0
               = 1   x = -knesgta톌xle+ 6 0, 0.5, 1,1.5 kpos  x kpos  x + 1
                                                                   0.75 vmax
                                                                                                            0                                                                 6 톥
                                                                                                                                = -kneg  x +
          0                                                                            0 stable                     stable                                        x + 1/kpos
                                                          stable                                          unstable
                                                          
                                                                                                    3                        1         4  Km
                                                            2
          Figure 23. Feedback: On the left-hand side the behavior
          of sim0.p2l5e nega-t2ive feedback is shown. On the right-hand The solution for the steady state(s) is:
          side 0th.5e behav0ior of a system with fixed negative feed-

          back1kneg = 3 is1shown with different strengths of positive                                                        -kneg  kpos(x)2 - kneg  x + 6kpos  x = 0
          feedback. () Michaelis-Ment0en                                                               2 steady                   x(-kneg  kpos  x - kneg + 6kpos) = 0
             2                                            61.5                         stable 1.5 unstastbatlees

                                                                                                = 1                 

                                                                                                   00.5.75

                                                                                                       0

                                                           2                         

                                                               0.25 -2
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching       22/56

Steady states:                                                  Neg. feedback   stabilizing
                                                                Pos. feedback   oscillating (not shown here)
Case 1)         x1 = 0                                                          (often) destabilizing
Case 2)         - knegkposx + 6kpos - kneg = 0                                  bifurcations
                                                                                bistability, switching behavior
          x2 = 6kpos - kneg                                                     hysteresis
                     kpos  kneg

For kneg = 3 :  x2 = 6kpos - 3 = 2kpos - 1 = 2 - 1               Contains no information about how long the sys-
                     3kpos             kpos     kpos               tem needs to reach steady states

Stability: Linearization                                         Hysteresis: influence of history. Consequence per-
                                                                   sists after cause vanishes.

      x = -kneg  x + 6  kpos  x                                  The plot at the bottom of Figure 23 shows the change
                            kpos  x + 1                        of a system's steady state depending on parameter value.
                            kpos(kposx + 1) - kpos(kposX )      In the bottom right part of the figure, we see that the
                                                                system suddenly changes to an unstable steady state,
 x = -kneg  x + 6 (kposx - 1)2 x                               although the previous behavior was approaching an
Which roughly gives the steady state x1 = 0                     equilibrium. This unstable steady state can lead to differ-
                                                                ent directions--the trajectories split up. The trajectories
       x = -knegx + 6kposx = (6kpos - kneg)x                    could split up several times until we, with certain param-
                                                                eter sets, reach chaotic system behavior (not shown).
For kneg = 3:
                                                                Definition 6. Bifurcation: Qualitative change of system
       x = (6kpos - 3)x                                         behavior with parameter displacement.
           < 0 for kpos < 1/2
           > 0 for kpos > 1/2                                   This is relevant if:

Stability of this steady state?                                      parameter unknown (welcome to Systems Biol-
                                                                       ogy)
s = 6kpos - 3             kpos > 1/2
x1 unstable for           kpos < 1/2                                 parameter is influenceable (drug target?)

         stable for                                             A double negative feedback loop, the toggle switch, is
                                                                a common motif in differentiation biology, as shown in
For an illustration of how the steady state(s) and their        Figure 26. Waddington's3 epigenetic landscape is a visu-
stability depends on parameter value kpos (bifurcation          alization of the bifurcation valleys and laid a cornerstone
plot), see Figure 24. The system is not simply unstable         of systems biology, epigenetics, and developmental bi-
beyond a parameter threshold. It changes to the closest         ology. A change of parameters changes the landscape
stable steady state.                                            shape. Look back also to Figures 3 and 4 where a dotted
When combining negative feedback and positive feed-             line marks the unstable regions. The individual trajec-
back with saturation and some basal activation, a bistable      tories might go to the adjacent stable stem cell states. If
system can be obtained (Figure 25). Here, which steady          you are as excited and curious as we are, read this paper
state is reached depends on the parameter value kpos as         about bistability, bifurcations, and Waddington's epige-
well as on the initial conditions:                              netic landscape [12].

x = 0.2 -knegx +6        (kposx)5           x(t = 0) = x0 = 1      Mathematically, a local bifurcation (x0, 0) appears
                                                                to be a continuous dynamic system:
                          (kposx) + 15
                                                                       x = f (x,  )
basal level
                                                                is linearized around a certain fixed point, and the ob-
                          f pos (x)                             tained Jacobian reveals an Eigenvalue with a zero real

Summary of key points here:                                         3 British biologist and philosopher Conrad Hal Waddington (1905--
                                                                1975).
     Two stable steady states  bistability

     Increase of steady state with kpos not continuous
       anymore, but step-like. (See next section on bifur-
       cation for more details.)
                                                                                       Chapter 3: The magic of change and how to find it -- 23/56

                                                                                                          al

                                                                                      unstable

Figure 26. Bifurcation example: (A) depending on the initial values of the protein level states in the toggle switch
motif, we can have a stable or unstable situation. An unstable state can fall into the one or the other direction. (B)
Developmental trajectories follow the imaginary epigenetic landscape of Conrad Waddington. Adapted from [13].
Copyright  2009, Elsevier Ltd.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching   24/56

part. If you get stuck here, do not worry. Come back
later after you have worked through the rest of the doc-
ument. The Poincar-Andronov-Hopf bifurcation,456
or (in short) Hopf bifurcation, is an interesting case
because, beyond this point, the solution becomes os-
cillatory (complex Eigenvalues). Biological examples
are the Lotka-Volterra model for the interplay of preda-
tors and prey, the Hodgkin- Huxley model of neuro-
electrophysiology, and the Selkov model of glycolysis
[14].
Also check out the time profiles and bifurcations as oc-
curring in a cancer-signaling network (Figure 27).

    4 Austrian-Hungarian mathematician and astronomer Eberhard
Frederich Ferdinand Hopf (1902--1983).

    5 French mathematician, theoretical physicist, engineer, and philoso-
pher Henri Poincar (1854--1912).

    6 Soviet physicist Aleksandr Aleksandrovich Andronov (1901--
1952).
                                                           Chapter 3: The magic of change and how to find it -- 25/56

40 Cancer and systemic diseases (2017)
Figure 1

Figure 27. Time profiles in cancer: "Intracellular signaling regulating cancer associated phenotypes and dynamic

Intracellular signaling regulating cancer associated phenotypes and dynamic properties of key signaling proteins. The main signaling cascades regulating

properties of key signaling proteins. The main signaling cascades regulating cancer hallmarks focused on in this

cancer hallmarks focused on in this review are depicted. Key signaling proteins in each signaling pathway have various dynamic properties. Cell cycle

drreivverisewsucahraes dCeycpDi/cCtDedK4. aKnedyCsycigEn/CaDlKin2gshporwootseciinllastoirny deyancahmiscisg, nwahelirneags pRab,twhhwicahyishinavvoelvevdainrieonutrsy fdorySnaphmasiec,pshroowpsesrwtiitecsh.-liCkeerlelscpyoncslee.

Cdarsipvaesres3s, uwchhichasmeCdyiacteDs/pCroDgrKam4maenddceCllydceEat/hC(aDlsKo 2knsohwonwasoaspcoipltloastios)r,yaldsoysnhaomwsicssw,itwchh-liekereaacstivRatbio,nw. Thhiechtumisorinsuvpoplrveessdoringeennetpr5y3for
dSispplahyassvea,risohusowdysnasmwicist,ceh.-gl.i,koescrilelastipono,ninsere. sCpoansspeatoseD3N,Awdahmicahgem(Deedtaiailsteasrepsrhoogwrnaimn Fmigeudre c2e).llRdace1aathnd(RahlsooA,kwnhoicwh anreaisnvaoplvoedptinosis),

epithelial-mesenchymal transition (EMT) and cell motility show bistability. Akt and ERK, which play a key role in multiple cellular processes such as

also shows switch-like activation. The tumor suppressor gene p53 displays various dynamics, e.g., oscillation, in

proliferation, differentiation and cell death display sustained and transient dynamics, respectively.

response to DNA damage [...]. Rac1 and RhoA, which are involved in epithelial-mesenchymal transition (EMT) and

cell motility show bistability. Akt and ERK, which play a key role in multiple cellular processes such as proliferation,

differentiation and cell death display sustained and transient dynamics, respectively". Direct quote and source: [15].

Copyright  2017, Elsevier Ltd.                            have identified key regulators for cell cycle entry at the
feedback regulation plays important roles for both oscil-

lation as well as switch-like activation of CDKs which restriction point, e.g., the CycE-CDK2 complex and the

accounts for the threshold [6,7]. As for cancers, onco- CDK inhibitor p27, and further found that network-level

genes such as CycD and CycE, and tumor suppressor features such as self-organization of the CDK network

genes such as p16, retinoblastoma (Rb) and p53 also and a bistable switch of the Rb-E2F pathway tightly

participate in the cell cycle network to make the system regulate the G1/S transition [11e13]. Recently, mathe-

behaviors more complex and robust [8,9]. Mathematical matical modeling in conjunction with high-throughput

models of cell cycle have mainly been focused on the single cell imaging revealed that the switch-like G1/S

restriction point or G1/S transition, at which cells commit transition is driven by double negative feedback loops

to entering S phase and completing the cell cycle. Such between Cyc-CDK2 and the CDK inhibitor p27 in which

regulation is lost in cancer cells, resulting in abnormal cell increasing the level of early mitotic inhibitor (Emi) 1,
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                            26/56

1.10  Simulation-based analysis of motifs                   ********** MODEL NAME
As mentioned earlier in Example 1 to 6, computer simu-      Sniffer
lation is the method of choice to analyze large or com-
plex dynamical systems. For such systems, analytical        ********** MODEL STATES
solutions cannot usually be obtained anymore. For the       d/dt(P) = k1p*S - k1d*P
simulation within a computational framework, the set        d/dt(R) = k2p*S - k2d*R - k2dp*R*P
of balance equations (ODEs) has to be supplied in a
specific form. These equations will then be numerically     P(0) = 0
integrated and the time-course behavior for a given set of  R(0) = 0
initial conditions and parameters will be approximated.
By repeatedly simulating a system with different initial    **********    MODEL      PARAMETERS
conditions and parameters, an overview on the overall       S=0
system behavior can be obtained. We will not introduce      k1p = 1
more advanced methods like Parameter Identification or      k1d = 1
Sensitivity Analysis here (further reading e.g. [16]), but  k2p = 1
will illustrate the basic simulation approach with two      k2d = 0
examples:                                                   k2dp = 1

Figure 28. Network structure of the Sniffer motif. Stimu-   Figure 29. Dynamics of the Sniffer motif. The time
lus S activates the production of proteins P and R which    course of output R is depicted (right) as a consequence
both also get degraded. The degradation of P also de-       of the varying input S (left).
pends on P. The respective parameter names are given
in italics.                                                  Example 11: Toggle switch

    Example 10: Change detection & adaptation               The toggle switch motif is depicted in Figure 26
                                                            and consists of two proteins which are mutually re-
   The Sniffer motif as depicted in Figure 28 is a small    pressing each other's activity, resulting in a double-
   motif consisting of two proteins and an activat-         negative feedback loop. This motif was nicely an-
   ing input stimulus [17]. The respective balance          alyzed by Huang et al. [18] and we recommend
   equations are incorporated in the computer model         reading the paper. One of the variants of the motifs
   which is given below in the IQM toolbox format           is modeled with the following ODEs:
   [5]. Other tools use similar but slightly different
   formats. This model allows to simulate the system                      xn1        t hbn1
   behavior, i.e. the behavior of the output as a func-     x1 = a1      n n + b1  n n - k1  x1
   tion of the input (Figure 29). From this we can see                    tha1 + x1  thb1 + x2
   that the response shows perfect adaptation to vary-
   ing inputs, signaling that there is change but then      x2 = a2      xn2        t hbn2
   resettling at the same steady state and being ready                    n n + b2  n n - k2  x2
   to newly respond to another change. Understand-                        tha2 + x2  thb2 + x2
   ing this function of the motif is on a different level
   compared to just drawing the network interactions.
   For further reading we recommend the full paper
   that this extract comes from [17].
                                                           Chapter 3: The magic of change and how to find it -- 27/56

    With the MATLAB code below, using this model           Figure 31. Toggle switch motif. Phase plot for the tog-
and analyzing (with repeated simulations) the ef-          gle switch motif (Example 11) with slopefield. For pa-
fect of the degradation parameter value k = k1 = k2        rameter values k = k1 = k2 = 1 the system is showing a
on the number and exact value of the steady states,        bistability. Stable steady states are plotted in blue and
one obtains the bifurcation plot as shown in Fig-          unstable in red.
ure 30. The system is bistable for parameter values
k < 1.8. This results in a phase plot with two stable
steady states and one unstable steady state (Figure
31). The slopefield indicates the regions of attrac-
tion towards one or the other stable steady state.
For parameter values k > 1.8 the bistability disap-
pears and the system has only one stable steady
state (Figure 32). The respective phase plot shows
only that steady state with all the slopefields point-
ing towards it. This motif plays an important role
in many developmental processes (see Figure 26
and [18]).

Figure 30. Toggle switch motif. Bifurcation plot for the   Figure 32. Toggle switch motif. Phase plot for the toggle
toggle switch motif (Example 11). The dependency of        switch motif (Example 11) with slopefield. For parame-
the steady state(s) for X2 as a function of parameter      ter values k = k1 = k2 = 2 the system is having only one
k = k1 = k2 is depicted. Stable steady states are plotted  (stable) steady state (indicated in blue).
in blue and unstable in red.

                                                           1 %% Toggle switch motif
                                                           2 %Thomas Sauter, University of Luxembourg
                                                           3 clear all
                                                           4 syms X1 X2
                                                           5 syms a1 a2 tha1 tha2 n b1 b2 thb1 thb2 k1 k2
                                                           6 eqX1_gen=a1*X1^n/(tha1^n+X1^n) + ...

                                                                       b1*thb1^n/(thb1^n+X2^n) - k1*X1
                                                           7 eqX2_gen=a2*X2^n/(tha2^n+X2^n) + ...

                                                                       b2*thb2^n/(thb2^n+X1^n) - k2*X2
                                                           8 % parameters for model A
                                                           9 n=4
                                                           10 k1=1 %1 %2
                                                           11 k2=1 %1 %2
                                                           12 tha1=0.5
                                                           13 tha2=0.5
                                                           14 thb1=0.5
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                              28/56

15 thb2=0.5                                          78            if (imag(eval(X1_vt(i)))==0) && ...

16 a1=0 %2de: 1                                                           (imag(eval(X2_vt(i)))==0)

17 a2=0 %2de: 1                                      79                   plot(eval(X1_vt(i)),eval(X2_vt...

18 b1=1 %4a: 0.5                                     80                   (i)),'r.','MarkerSize',10)

19 b2=1 %4a: 0.5                                     81                   %      end

20 eqX1=eval(eqX1_gen)                               82            end

21 eqX2=eval(eqX2_gen)                               83       end

22 pretty(eqX1)                                      84 end

23 pretty(eqX2)                                      85 for i=1:size(X1_ht)

24 %% step 3                                         86       for k=1:numel(X2_range)

25 [X1_ss_sym,X2_ss_sym]=vpasolve(eqX1,eqX2,X1,X2);  87            z=X2_range(k);

26 X1_ss_tmp=X1_ss_sym; %eval(X1_ss_sym)             88            %         for l=1:numel(X2_range)

27 X2_ss_tmp=X2_ss_sym; %eval(X2_ss_sym)             89            %             X2=X2_range(l);

28 X1_ss=[]; X2_ss=[];                               90            if (imag(eval(X1_ht(i)))==0) && ...

29 for k=1:numel(X1_ss_tmp) %remove complex roots                         (imag(eval(X2_ht(i)))==0)

30      if (imag(X1_ss_tmp(k))==0) && ...            91                   plot(eval(X1_ht(i)),eval(X2_ht(i))...

              (imag(X2_ss_tmp(k))==0)                92                   ,'g.','MarkerSize',10)

31            X1_ss=[X1_ss; X1_ss_tmp(k)];           93            end

32            X2_ss=[X2_ss; X2_ss_tmp(k)];           94       end

33      end                                          95 end

34 end                                               96

35 X1_ss                                             97 % numerical computation of example ...
                                                                 trajectories
36 X2_ss

37 %% step 4 using a for loop                        98 X1_ic=[0:0.1:1.5]' %initial conditions on ...
                                                                 the x-axis (X1)
38 syms X1 X2

39 %general linearization                            99 X2_ic=[0:0.1:1.5]' %initial conditions on ...
                                                                 the y-axis (X2)
40 Lin = jacobian([eqX1; eqX2],[X1 X2])

41 %around steady states: using for loop             100

42 for i=1:size(X1_ss)                               101 syms X1 X2
                                                     102 eqX1=subs(eqX1,X1,str2sym('x(1)'));
43      X1=X1_ss(i)                                  103 eqX1=subs(eqX1,X2,str2sym('x(2)'))
                                                     104 eqX2=subs(eqX2,X1,str2sym('x(1)'));
44      X2=X2_ss(i)                                  105 eqX2=subs(eqX2,X2,str2sym('x(2)'))
                                                     106 eval(['dxdt=@(t,x,tmp) ([' char(eqX1) ';' ...
45      eval([['Lin' num2str(i)] '= eval(Lin);'])
                                                                  char(eqX2) '])'])
46      eval([['eig' num2str(i)] '= ...

              eig(eval(Lin))'])

47 end

48 %% ht and vt tangents                             107 t_int=[0 .1] %vectorfield tend=0.1 %full ...
                                                                  trajectories tend=1
49 syms X1 X2

50 [X1_ht,X2_ht,params_ht,conditions_ht] ...         108 options=[]; % =tmp

51 =solve(eqX2,X1,X2,'MaxDegree',5,...               109 for i=1:size(X1_ic)

52 'ReturnConditions',true)                          110      for k=1:size(X2_ic)

53 [X1_vt,X2_vt,params_vt,conditions_vt] ...         111           [t, x] = ...

54 =solve(eqX1,X1,X2,'MaxDegree',5,...                                    ode45(dxdt,t_int,[X1_ic(i); ...

55 'ReturnConditions',true)                                               X2_ic(k)],options);

56 %% plotting the phase portrait + numerical ...    112           plot(x(:,1),x(:,2),'k')

        simulation of vector field                   113           plot(X1_ic(i),X2_ic(k),'k.',...

57 figure; hold on                                   114           'MarkerSize',5)

58 axis([-0.1 1.5 -0.1 1.5]) %Plot range             115      end

59 X1_range=linspace(0,1.5,50); %Evaluate all ...    116 end

        results in the same range                    117 hold off

60 X2_range=linspace(0,1.5,50);                      118 title({'phase portrait: X2(t) = ...

61 % plot steady states                                       f(X1(t))','blue,red: ...

62 for k=1:numel(X1_ss)                              119 stable & unstable steady states, dotted ...
                                                                  lines: ...
63      ss_plot = plot(X1_ss(k),X2_ss(k),'*',...

64      'MarkerSize',20,'LineWidth',4);              120 horizontal & vertical tangents'})
                                                     121 xlabel('X1(t)')
65      eig_check=['eig' num2str(k)]; %check ...     122 ylabel('X2(t)')

              stability

66      if max(real(eval(eig_check)))0

67           set(ss_plot,'Color','r') %red for ...

                 unstable (0)

68      else

69           set(ss_plot,'Color','b') %blue for ...

                 stable (<0)

70      end

71 end

72 % plot vertical and horizontal tangents

73 for i=1:size(X1_vt)

74      for k=1:numel(X2_range)

75           z=X2_range(k);

76           %           for l=1:numel(X2_range)

77           %            X2=z;
                                                             Chapter 3: The magic of change and how to find it -- 29/56

1.11  Additional reading: Cybernetics--The art of            A() is the "state (or system) matrix", dim[A()] = n  n,
      creating equilibrium in a world of constraints and
                                                             B() is the "input matrix", dim[B()] = n  p,
      possibilities
                                                             C() is the "output matrix", dim[C()] = q  n,
Cybernetics or control engineering enables us to under-
stand systems and to design the optimal control. The         D() is the "feedthrough (or feedforward) matrix" (in
optimal control brings and keeps the system in a favor-             cases where the system model does not have a di-
able state. We can assume that the evolutionary pressure            rect feedthrough, D() is the zero matrix), dim[D()] =
forced living systems to develop elegant control systems.           q  p,

    Let's start with the general state-space representation  and the vector function:
with a multi-input multi-output (MIMO) system with
the block diagram in Figure 33. We are not only inter-              f(x, u) = f1(x, u)
ested in the actual system x = Ax itself, but also in how                         f2(x, u)
to control and how to observe our system. Often we do
not know the real state values of our system. We have to     YouTube: State-space representation (all relevant)
measure the states and get an observed output y, such
as the pERK level change in a cell culture experiment.       Systems often show oscillations and subsiding behav-
Measurements, e.g. with western blot, can bias the real      iors over time as shown in Figure 19. The calculation
data of an untouched system. The observation matrix C        is very difficult as we have to deal with complex inte-
describes which real states are pooled to our output and     gral convolutions. As discussed in linear algebra, we
how the experimental analysis modifies the information       might facilitate our problem by changing the coordinate
of the true state values. Besides the analysis, we also      system. The transfer to a frequency-based coordinate
know that it is very hard to precisely perform an experi-    system is indeed a very good idea and has become the
ment e.g. in cell culture. The pipette might have not been   main tool of cybernetics. The transfer from the time do-
calibrated for a while and who knows what the clumsy         main to the frequency domain allows us to treat control
intern from the computational department did with it.        problems, for the most part, with simple algebraic oper-
Thus, all the bias related to the control u is accounted     ations. The Laplace transform7 splits our function into
for in the input matrix B. Additionally, not everything      harmonic sinusoids and exponential decay terms, and is
that we put into the cell culture (fetal calf serum, DMSO,   an extension of the Fourier transform,8 which dissects
stains) influences our system x = Ax, but might directly     periodic functions into harmonic sinusoids only, as ani-
influence the observed output. Such bias is considered       mated in Figure 34. The sinusoid can either occur with
with the feedthrough matrix D. After we have explained       different phase shifts or in combination with the cosines.
the principle ideas behind the state-space representation,   The Laplace transform transfers our mathematical prob-
we can look at the equations for a simpler single-input      lem from the time-dependent space into the frequency-
single-output (SISO) system of Order Two:                    dependent space (Figure 35) with the complex variable
                                                             s =  + i, as shown in Figure 36. The easily obtained so-
   linear system          non-linear system                  lution in the frequency domain can be transformed back
                                                             into the time domain by the inverse Laplace transform,
x  Ax             bu                x  f (x,u)               as shown in Figure 35. The discrete time equivalent of
                                                             the Laplace transform is the Z-transform.
x1 = a11x1 + a12x2 + b1u            x1 = f1(x1, x2, u)
x2 = a21x1 + a22x2 + b2u            x2 = f2(x1, x2, u)       Some other important concepts in control theory are:

y = c1x1 + c2x2 + du                y = g(x1, x2, u)         Definition 7. Controllability describes the ability of an
                                                             external input u to shift the internal state of a system
   cT x                                g(x,u)                from any initial state x0 to any other final state x in a
                                                             finite time interval.
   x = Ax + bu                         x = f(x, u)
   y = cT x +du                        y = g(x, u)           Definition 8. Observability is a measure of how well in-
                                                             ternal states of a system can be inferred from knowledge
with the matrices and vectors:                               of its external outputs.

   A = a11 a12 ; b = b1 ; c = c1                                 7 French astronomer and mathematician Pierre-Simon Laplace
   a21 a22                      b2     c2                    (1749--1827).

x() is called the "state vector", x(t)  Rn;                     8 French mathematician and physicist Jean-Baptiste Joseph Fourier
y() is called the "output vector", y(t)  Rq;                (1768--1830).
u() is called the "input (or control) vector", u(t)  Rp;
               r             e       C  u           x    y                 u black box y

               +
               + -
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                  30/56

                    Every input, which influences the output without influencing the system

                                                             D                                         pERK
                                        B ++  1  
                  Drug                                                                       Result

                                                                           C         + +     

                                                            A                        pERK

                                 Pipetting and               pERK          Measurement
                                 experimental                              error or pooling
                                 error modify            cell culture      of state values
                                 control
                                                          (the system)

Figure 33. Block diagram of a multi-input multi-output (MIMO) system with associations to experimental cell
                          1
biology.  The  operation  S  is  an  integral   in  the  frequency  space  (Laplace  transform)  that  turns  the  state  derivatives

into state values. See text for explanation.

Definition 9. Transfer function: A transfer function is
a mathematical function which gives for each possible
input value the corresponding output value.

Two types of principal design can be distinguished: open
loop and a closed loop. An open loop design requires
a complete understanding of all physics involved. An
open loop system approaches the desired state after a
certain time, but might not exactly reach it due to dis-
turbances. A closed system compares the system output
with a set point and permanently tries to reduce the
error. A closed system reaches the set point despite dis-
turbances and can reach the desired state faster with
oscillations around the target. A good control system
brings our system into the desired state in a short time
with high precision despite possible disturbances. Watch
the first five videos on control theory here:
YouTube: Control theory lectures (videos 1-5).
                                                               Chapter 3: The magic of change and how to find it -- 31/56

                                                               Time domain

                                                               Laplace  Laplace  Inverse
                                                                                 Laplace

                                                               Frequency domain

Figure 34. Fourier transform: a periodic func-                 Figure 35. Time and frequency domain. In-
                                                               put x(t), impulse-response h(t), and output
tion in the time domain ( f , red, magnitude                   y(t) in the time domain, and their analogues
                                                               (X(s), H(s),Y (s)) in the frequency domain. We
over time) can be split into several sinus and co-             have complicated convolution operations ()
                                                               in the time domain, and we have simple alge-
sinus functions or several sinus functions with                braic operations () in the frequency domain.
                                                               Picture source: Wikimedia, Licence: CC0 1.0
phase shift. These are peaks in the frequency                  Universal Public Domain Dedication.
           f^,  amplitude     overdamped
domain  (       blue,                     over  frequency).
                           amplitude

Credit to Lucas V Barbosa, Wickritiimcalleyddaimap,eLdicence:

Public Domain Deduincdaetrdioamnp.ed

                                          time

                                 time domain                            frequency domain

                                  oscillation -                decay -           Imaginary (frequency)
                                                                                    
                                                                        s-plane

                                                                                 Real (exponential)
                                                                                  

                           time                 time           time

           original                       Fourier transform

                                    Laplace transform -- = -(+) = -

Figure 36. Time and frequency domain: an ODE can be described by a number of sinusoids with phase shift or
sinusoids and cosinoids. The process is known as the Fourier transform. This is not enough for control engineering,
but if we represent the original ODE as a sum of sinusoids and exponential decay functions, it is sufficient. This
process is called the Laplace transform, which allow us to work in the s-plane and frequency domain.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                    32/56

             2. Basics of mathematics                        Derivative
                                                            The derivative is defined as:
Before you go through the following chapter, consider
watching this series of YouTube videos on calculus (3       f (a) = lim f (a + h) - f (a) .
h):                                                                        h0            h
YouTube: Essence of calculus
                                                            where the distance h becomes infinitesimally small. The
 Solving quadratic equations                                derivative symbolizes the tangent at a function, as shown
p-q formula                                                 in Figure 37.
The solution of:
                                                            ( + )
       x2 + px + q = 0

is:                      p2                                                ()
                  p           -q.                                                                      

       x1,2 = - 2       2

a-b-c formula                                                                                            +
The solution of
                                                            Figure 37. Derivative. Illustration of the derivative of a
       ax2 + bx + c = 0
                                                            function is obtained.

is:                                                         Differentiation
                       
                                                                           y = xn
                -b  b2 - 4ac                                      dy = y = n  xn-1
       x1,2 = 2a                                                   dx

 Complex numbers                                            Example 1: Differentiation
Scientists had huge difficulties calculating the roots of
                                                            y = x3                          y = 4x4
negative numbers for a long time. The situation im-
                                                            y = 3x2                         y = 16x3
proved after defining i as the solution of the equation
x2 = -1 resulting in i2 = -1 and i = -1. We get a com-

plex number:

z = a + bi

with a real part a and an imaginary part b. This is needed  Product rule
in this course, when you apply the p-q-equation. More-
over, it is important to know that the imaginary part is            y = u(x)  v(x)
directly linked to the sine function via Euler's formula           y = u(x)  v(x) + u(x)  v(x)
ei = cos( ) + i  sin( ):
                                                            Example 2: Product rule
       z = rei                                                    y = x2ex
                                                                  y = 2x  ex + x2  ex
         = r(cos( ) + i  sin( ))

est = e[Re(s)t+iIm(s)t]                                     Quotient rule
   = eRe(s)t  eiIm(s)t]
   = eRe(s)t [cos(Im(s)t) + i  sin(Im(s)t)]                y = u(x) = numerator
                                                                 v(x) denominator

Watch Part 1 to 10 of this series on imaginary numbers       u(x)  v(x) - u(x)  v(x)
to get a feeling:                                           y=
YouTube: Series on imaginary numbers                                           v(x)   2
                                                          Chapter 3: The magic of change and how to find it -- 33/56

Example 3: Quotient rule                                      

    d ex d = dx ex (x2) - (ex) ddx x2                         
                                                                                Ca. 63% 1 - -1 = 0.63

    dx x2                   (x2)2

               (ex)(x2) - (ex)(2x)                                            =            
            = x4
                                                          Figure 38. Time course behavior of an inhomogeneous
               ex(x - 2)
            = x3 .                                        ODE, given as T x+ x = u. The Euler number is e = 2.718.

(Source: Wikipedia)                                       2. Write (n - 1) equations of the form:
                                                                 xi = xi+1 ; i = 1 . . . (n - 1)
Chain rule

            y = u(v(x))                                   3. Transform original ODE into 1 ODE of 1st-order by
                                                          replacing the derivatives with xi.
with y = u(z) and z = v(x)
                                                              Example 5: Converting an ODE of nth to n 1st order
dy = y = dy  dz = u(z)v(x) = f (v(x))v(x).
dx          dz dx

Example 4: Chain rule                                     The equation of 2nd order is:
      y = (2x + 1)2                                              x + 4x + 5x = 0 (n = 2)
      y = 2(2x + 1)  2 = 4(2x + 1)
                                                          With the ansatz
 Basic integrals
An integral is basically the area under the curve (AUC).         x  x1
The term AUC is often used, e.g., in pharmarcokinetics.          x  x2 = x1
                                                                 x  x3 = x2

    xn dx = 1 xn+1,                forn = -1              we obtain for our system:
              n+1
                                                                 x1 = x2
    u dv = uv - vdu                                              x2 = -4x2 - 5x1

 ex dx = ex                                               with the matrix form:

 ax dx = 1 ax                                             x1 = 0 1 x1
           ln a                                           x2    -5 -4 x2

  1 dx = ln |x|                                           Transform two ODEs of 1st order into one ODE
  x                                                       of 2nd order
ln x dx = x ln x - x                                      Approach: 1. Solve one ODE for the other state variable:

Transform one ODE of nth order into n ODEs                       x1 = f (x1, x2, u)  solve for x2
of 1st order
Approach                                                  2. Differentiate the solution.
1. Introduce n new variables:                             3. Insert into other ODEs.

         x1 = x
         x2 = x
         x3 = x

                ..
                .

                  (n)

       xn = x
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                         34/56

 Example 6: Converting ODEs from 1st to 2nd order              around a point of interest x, which can be written as
                                                                       f (x) - g(x) = x = g(x)x
We begin with the equation set:
                                                               whereby the difference between original function g(x)
       x1 = a11x1 + a12x2 + b1u                                and its approximation f (x) is emphasized. A set of
       x2 = a21x1 + a22x2 + b2u                                non-linear equations:

The first equation is differentiated with respect to                                
time t:                                                                               g1(x)

               1                                                       x = g(x) = g  2(x) . 
       x2 = (x1 - a11x1 - b1u)                                                       .. 
                                                                                      gn(x)
              a12
               1                                               can be approximated by the general form:
       x2 = (x1 - a11x1 - b1u)
              a12                                              f(x) = g(x) +  fg(x)  x
                                                                                     x x
Transfer of the functions x2(x1, u) and x2(x1, u) to
the second equation delivers:                                  with the Jacobian matrix:

         1                                                                  g1                  g1 
            (x1 - a11x1 - b1u) =a21x1 + b2u                                x1     xn 
                                                                    g(x)    .             .    .    
        a12                                                    J=         =  .. . . ..              
                                     + a22 (x1 - a11x1 - b1u)       x x   gm
                                         a12                                              렁   gm 

which in a nicer form gives:                                                 x1                 xn

       x1 = (a11 + a22)x1 - (a11a22 - a12a21)x1               A linearized system in the general form is then:
                      +b1u + (a12b2 - a22b1)u

 Linearization                                                 x = Jx.
Biological systems are usually non-linear and the mea-
sured effects rarely follow the law of additivity (Figure      The Taylor approximation is a very important concept.
39). Still, the linearization of equations helps us for the    It delivers a function that, with increasing terms, aligns
following reasons:                                             with any continuous, smooth function around a certain
                                                               point. However, if one moves too far away from the point
 Linear equations are mathematically easier to solve/         of interest, the differences can be extreme.
   treat                                                       YouTube: Taylor series explained

 Linear system properties are transferable to non-                Because we are only interested in a linear tangent at
   linear systems around the approximated area                 a steady state x, we neglect all higher order terms and
                                                               look only at the function value plus the first term of the
 A unique steady-state exists                                 Taylor approximation:

 They have a simple controller design                                 f (x) = g(x) + (x - x)g(x)

 The response to a variety of simuli can be separated         of x = x + x with x = (x - x).
   into linear combinations of the system down to
   individual stimuli.

 Additivity f (x1, x2) = f (x1) + f (x2) (Figure 39)

 Scalability c  f (x1) = f (c  x1) (Figure 39)

For the linearization, we can use the Taylor approxima-
tion:

f (x) =g(x) + g(x) (x - x)
                    1!

+ g(x) (x - x)2 + g(x) (x - x)3 +   
2!                              3!

    higher order terms often neglected
                                                           Chapter 3: The magic of change and how to find it -- 35/56

()           linear          ()      non-linear            linear function f (x) at this point:
                                                                   f (x) = x = (2x - 1) + 2x
            ( + ) = () + ()          ( + )  () + ()                     = x = (2 1 - 1) + 2x = 2x
                                                                                   2
(1 + 2)                        (2)
       (2)                     (1)
       (1)
            1 2 (1 + 2)              1 2                   Example 8: Linearization 2
  ()
            linear             () linearisation            First, we determine the steady state:
     3(1)
             () = ()

                               ()                          g(x) = x = x2 + 2x - 1
                                                           g(x) = x = 2x + 2
(1)

            1 31                                           x  =    (x  )2  +  2x   -   1   !  0  
                                                                           
                                                                                          =

                                                                                                     
                                                            -b  b2 - 4ac -2  4 + 4
Figure 39. Linear vs non-linear behavior. Linear systems   x1,2 =                             =
show additivity and scalability.                                            2a                       2
                                                                           

                                                              = -1  2

Figure 40. Linearization of a multi-dimensional equation   Second, we approximate the function g(x) with a
at one point with a plane. Source: LibreTexts Library for  linear function f (x) at this point:
mathematics. If the point is an equilibrium point, the
plane is horizontal. Source: LibreTexts Library. Licence:          f (x) = x =((x)2 + 2x - 1) + (2x + 2)x
CC BY-NC-SA 4.0 (Fair Use).
                                                           For x1 = -1 + 2:
                                                                         = x =((-1 + 2)2  + 2(-1 + 2) - 1)
                                                                                              
                                                                                + (2(-1 + 2) + 2)x
                                                                                 
                                                                             =2 2x

                                                           For x2 = -1 - 2:
                                                                         = x =((-1 - 2)2  + 2(-1 - 2) - 1)
                                                                                              
                                                                                + (2(-1 - 2) + 2)x
                                                                                    
                                                                             = - 2 2x

                                                           The steadystate at x1 = -1 + 2 is unstable and at
                                                           x2 = -1 - 2 is stable. See Figure 16.

Example 7: Linearization 1                                 Example 9: Linearization 3

First, we determine the steady state:                      First, we determine the steady state

            g(x) = x = 2x - 1                              g(x) = x = 2x2 - 2x - 12
            g(x) = x = 2                                  g(x) = x = 4x - 2

                     x = 2x - 1 = 0   x = 1                x  =    2(x  )2  -  2x      -  12   !  0
                                               2
                                                                                              =

                                                                                                     
                                                            -b  b2 - 4ac 2  4 + 96
Second, we approximate the function g(x) with a            x1,2 =                             =
                                                                            2a                       4

                                                              = 15
                                                                 22

                                                           and obtain the steady states at: x1 = 3 ; x2 = -2
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                              36/56

Second, we approximate the function g(x) with a                    Example 10: Linearization 4
linear function f (x) at this point:
                                                                   If we linearize a system with two non-linear equa-
        f (x) = x =(2(x)2 - 2x - 12) + (4x - 2)x                   tions:
             = x =0 + (4x - 2)x
                                                                      g1(x, y) = x = (1 - x - y)x
For x1 = 3:                                                                          = -x2 + (1 - y)x
                                                                                     = -x2 + x - xy
                  =10x
                                                                          g1(x, y)x = -2x + 1 - y
For x2 = -2:                                                              g1(x, y)y = -x
                                                                      g2(x, y) = y = (1 - x - y)y
                  = - 10x
                                                                                     = -y2 + (1 - x)y
The steady state at x1 = 3 is unstable and at x2 = -2                                = -y2 + y - xy
is stable. See Figure 16.                                                 g2(x, y)x = -y
                                                                          g2(x, y)y = -2y + 1 - x

        (, )     Slope                                             we approximate it with a plane at a particular point
                                                                         f (x, y) = g(x, y) + gx(x, y)  x + gy(x, y)  y

Slope                                                              such as shown in Figure 40. But our points of inter-
                                                                   est are, as usual, steady-state solutions. For these
                                                                   steady-state solutions, the linearized system is:

                                                                             f1(x, y) = x                  = 0 + (1 - 2x - y)x - xy
                                                                             f2(x, y) = x                  = 0 + (1 - 2y - x)y - yx

                                         (, )                      Example 11: Linearization 5

                                                                   We want a linear approximation on a higher-order
                                                                   ODE

                                                                          x + x + x = 1

Figure 41. Linearization of a function (hanging carpet)            on the steady state x = 1. The equation is rewrit-
in respect to two directions. The blue plane is horizontal         ten:
at the steady state of function f . The red plane gives the
slopes if shifted slightly moving away from the steady                    g(x, x, x) = x + x + x - 1 = 0,
state point P.
                                                                   and we treat any derivative as an independent vari-
                                                                   able. For:

                                                                   f  (x  ,  x,  x)  =  g  (x    )  +  g     (x    )    x  +  g     (x    )    x  +  gx  (x    )    x
                                                                                                           x                       x

                                                                   with

                                                                             gx(x) = 1
                                                                             gx(x) = 1
                                                                             gx(x) = 1
                                                                                                          Chapter 3: The magic of change and how to find it -- 37/56

we simply get:                                                                                            [7] Sabrina L Spencer and Peter K Sorger.
        f (x, x, x) = x + x + x = 0
                                                                                                          Measuring and modeling apoptosis in

                                                                                                          single cells.         Cell, 144(6):926-939, 2011.

                                                                                                          https://doi.org/10.1016/j.cell.2011.03.002.

Example 12: Linearization 6                                                                               [8] Joachim W Schmid, Klaus Mauch, Matthias

                                                                                                          Reuss, Ernst D Gilles, and Andreas Krem-

We aim for a linear approximation of a higher order                                                       ling. Metabolic design based on a coupled
non-linear ODE:
                                                                                                          gene expression--metabolic network model
       g(x, x, x) = x + x + x2 + 5 = 0
                                                                                                          of tryptophan production in Escherichia coli.

                                                                                                          Metabolic Engineering, 6(4):364-377, 2004.

                                                                                                          https://doi.org/10.1016/j.ymben.2004.06.003.

With                                                                                                      [9] Hartmut Bossel. Modeling and Simulation. 1994.

                                   gx                                                                     https://doi.org/10.1201/9781315275574.
                                                            x                       x
f  (x  ,  x,  x)  =  g(x    )  +      (x    )    x  +  g     (x    )    x  +  g      (x    )      x  [10] James E Ferrell Jr. Perfect and near-perfect adapta-

and with                                                                                                  tion in cell signaling. Cell Systems, 2(2):62-67, 2016.

                                                                                                          https://doi.org/10.1016/j.cels.2016.02.006.

          gx(x) = 2x                                                                                      [11] Robin E Ferner and Jeffrey K Aronson. Cato Guld-
          gx(x) = 1
          gx(x) = 1                                                                                      berg and Peter Waage, the history of the law of mass

                                                                                                          action, and its relevance to clinical pharmacology.

                                                                                                          British Journal of Clinical Pharmacology, 81(1):52-55,

we get:                                                                                                   2016. https://doi.org/10.1111/bcp.12721.

       f (x, x, x) = x + x + (x)2 + 5 +2x + x + x = 0                                                  [12] James E Ferrell Jr. Bistability, bifurcations,

                                      =0                                                                  and waddington's epigenetic landscape.

                                                                                                          Current Biology, 22(11):R458-R466, 2012.

                                                                                                          https://doi.org/10.1016/j.cub.2012.03.045.

                                                                                                          [13] Sui Huang, Ingemar Ernberg, and Stuart Kauff-

                      References                                                                          man. Cancer attractors: a systems view of tumors

[1] Ertugrul M Ozbudak, Mukund Thattai, Han N Lim,                                                        from a gene network dynamics and developmen-
    Boris I Shraiman, and Alexander Van Oudenaar-
    den. Multistability in the lactose utilization net-                                                   tal perspective. In Seminars in Cell & Developmental
    work of Escherichia coli. Nature, 427(6976):737, 2004.
    https://doi.org/10.1038/nature02298.                                                                  Biology, volume 20, pages 869-876. Elsevier, 2009.

[2] Maria Herberg and Ingo Roeder. Compu-                                                                 https://doi.org/10.1016/j.semcdb.2009.07.003.
    tational modelling of embryonic stem-cell fate
    control. Development, 142(13):2250-2260, 2015.                                                        [14] EE Sel'Kov. Self-oscillations in glycolysis 1. a sim-
    https://doi.org/10.1242/dev.116343.
                                                                                                          ple kinetic model. European Journal of Biochemistry,
[3] Uri Alon. An introduction to systems biology: de-
    sign principles of biological circuits. CRC Press, 2006.                                              4(1):79-86, 1968. https://doi.org/10.1111/j.1432-
    https://doi.org/10.1201/9781420011432.
                                                                                                          1033.1968.tb00175.x.
[4] Uri Alon. Network motifs: Theory and experimental
    approaches. Nature Reviews Genetics, 8(6):450, 2007.                                                  [15] Shigeyuki Magi, Kazunari Iwamoto, and
    https://doi.org/10.1038/nrg2102.
                                                                                                          Mariko Okada-Hatakeyama. Current status
[5] M. Sunnaker and H. Schmidt. IQM Tools - Efficient
    state of the art modeling across pharmacometrics                                                      of mathematical modeling of cancer-from
    and systems pharmacology. Pharmocokin Pharmaco-
    dyn, 43:69-70, 2016.                                                                                  the viewpoint of cancer hallmarks.             Cur-

[6] James E Ferrell Jr. Self-perpetuating states in                                                       rent Opinion in Systems Biology, 2:39-48, 2017.
    signal transduction: Positive feedback, double-
    negative feedback and bistability. Current                                                            https://doi.org/10.1016/j.coisb.2017.02.008.
    Opinion in Cell Biology, 14(2):140-148, 2002.
    https://doi.org/10.1016/S0955-0674(02)00314-9.                                                        [16] Edda Klipp, Wolfram Liebermeister, Christoph

                                                                                                          Wierling, and Axel Kowald. Systems Biology. Wiley-

                                                                                                          VCH Verlag, Weinheim, Germany, 2016.

                                                                                                          [17] J. J. Tyson, K. C. Chen, and B. Novak. Snif-

                                                                                                          fers, buzzers, toggles and blinkers: Dynamics

                                                                                                          of regulatory and signaling pathways in the

                                                                                                          cell. Curr Opin Cell Biol, 15(2):221-231, 2003.

                                                                                                          https://doi.org/10.1016/S0955-0674(03)00017-6.

                                                                                                          [18] S. Huang, Y. P. Guo, G. May, and T. Enver. Bifur-

                                                                                                          cation dynamics in lineage-commitment in bipo-

                                                                                                          tent progenitor cells. Dev Biol, 305(2):695-713, 2007.

                                                                                                          https://doi.org/10.1016/j.ydbio.2007.02.036.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                  38/56

                3. Exercises                                     c) Calculate the Eigenvalues of the linearized system
                                                                     in the steady states and determine thereof the sta-
 Steady states                                                       bility of the individual steady states. For which
Calculate the steady states for systems (3.1) to (3.8):              values of k do you get stable steady states?

       x = 2x - 1                           (3.1)             In the following, k = 5 holds:
                                            (3.2)
       x = x2 + 2x - 1                      (3.3)               d) Mark within a X-over-t diagram the domains where
                                            (3.4)                    dX is positive, then respectively negative.
       x = sin(x)                           (3.5)                     dt

x + x + x = 1                              (3.6)                e) Draw X(t) in a diagram using the results of parts
                                                                     a)-d) for different initial conditions of X.
x + 2x + x2 - 5x + 6 = 0

d x1 = 3 -2                    x1 + 1 u
dt x2                      15  x2       0

                x = (1 - x - y)x            (3.7)              1st-order system
                y = (1 - x - y)y
                                                              The growth of a specific population is described with
                                                              the following model:

                u = a - (b + 1)u + u2v      (3.8)             dN                      (with r > 0 and N(0) = N0)
                v = bu - u2v                                      = rN(2 - N)(N - 1)

                                                              dt

 Stability                                                    a) Derive the steady states of the system.
Test the following systems for the stability of their steady
state(s). Draw, therefore, x over x.                          b) Linearize the differential equation around the steady
                                                                  states.

x = 3x                                       (3.9)            c) Calculate the Eigenvalues of the linearized system
x = -5x                                     (3.10)                in the steady states and test for stability of the in-
x = -x2 + 0.5                               (3.11)                dividual steady states.
x = -x3 + x
                                            (3.12)            d) Mark within a t, N diagram the domains where
             2                                                     dN is positive, then respectively negative.
                                                                   dt
 Eigenvalues and stability of the steady state
Determine the Eigenvalues and the stability of steady         e) Draw N(t) in a diagram using the results of parts
states of following tasks:                                        a)-d) for different initial conditions of N. Also
                                                                  Calculate the position of the inflection points.
d x1 = -1 4 x1                              (3.13)
dt x2           0 -3 x2

d x1 = 3 8 x1                               (3.14)             Characteristic equation of a 2nd-order system
dt x2  1 1 x2
                                                              The following characteristic equation of a 2nd-order sys-
                                                              tem is given:

d x1 = -1 3 x1                              (3.15)                (s - a + T )(s - 1 + aT ) = 0 (a, T are real)
dt x2  -1 1 x2
                                                              a) What is the corresponding homogeneous differen-
Population growth                                                 tial equation?
The growth of a specific population is described with
the following model:                                          b) For which values of the parameters a and T do we
                                                                  have one single Eigenvalue on the stability bound?
dX                             (with k > 0 and X(0) = X0)
    = (2-X)(X -1)(X -k)                                       c) For which values of the parameters a and T is the
                                                                  system stable, metastable, or unstable?
dt
                                                              d) Draw the results of c) in a stability diagram with
a) Derive the steady states of the system.                        abscissa T and ordinate a.

b) Linearize the differential equation around the steady
    states.
                                                                            Chapter 3: The magic of change and how to find it -- 39/56

 Biomass growth in a bioreactor                                              Prey-Predator Model 2
A batch fermentation is carried out in an ideally mixed                     In the following, a more complex Lotka-Voltera model
tank reactor. At the beginning, substrate and biomass                       shall be investigated. The growth rate of the prey is in-
is provided with concentrations S0 = S(t = 0) and X0 =                      cluded with a parameter  > 0 and the predator's growth
X(t = 0).                                                                   rate is modeled with a yield coefficient  > 0. Further-
The reaction volume of the reactor (VR) is considered                       more an influx of predators into the system is assumed.
to be constant. The specific growth rate of the microor-                    The resulting model description is:
ganisms shall be . The yield coefficient9 shall be YXS.
The biomass is linearly proportional to the decline in                      X = X( -Y )       I
substrate X = -YXSS and this anti-correlating behavior
is thus a measurement of efficiency.                                        Y = Y (X - 1) + 1  II

   a) Set up balance equations for biomass (X) and sub-                     a) Assign the facts described above to the individual
       strate (S) concentrations.                                               model terms in this system.

   b) Derive S(t) as a function of X(t), X0 und S0.                         b) Calculate the steady states of system as a function
                                                                                of parameters  and .
   c) Derive a differential equation for X which does not
       depend on the substrate concentration anymore                        c) Which condition has to be fulfilled for parame-
       [X = f (X)] using the assumption  = cS.                                 ter  to obtain only biologically reasonable steady
                                                                                states?
  d) Repeat this while assuming a logistic growth rate
        = a - bX with (a, b > 0).                                          d) Draw the steady states for  = 2 and  = [1/5; 1/4; 1/3; 1/2; 1]
                                                                                in a diagram (x-axis: X, y-axis: Y ).
   e) Compare the differential equations obtained for X
       in c) and d). What would a and b have to be in                        Prey-Predator Model 3 (fish)
       order to obtain identical differential equations?                    Small and big fishes are living in a lake. The small fishes
                                                                            (X) depend on plankton which is available in excess. Big
   f) Calculate the steady states (X, S) of system d)                       fishes (Y ) feed on the small ones. If only small fishes
                                                                            were present, it would grow exponentially, i.e. their num-
   g) Show that the following ansatz is a solution for X(t):                ber grows with a constant specific growth rate  ( > 0).
                                                                            In the absence of small fishes, the big fishes would die
              X                                (3.16)                       out with a decay rate  ( > 0). The following sim-
X (t) = 1 + c1e-c2t                                                         ple equations describe these facts using the parameters
                                                                            ,  , ,  > 0:
How do you have to choose c1 and c2 (c1, c2 = 0)?
                                                                                    d
 Prey-Predator Model 1                                                              dt X = ( - Y )X I
We have two versions of the Prey-Predator Model of                                  d
Lotka and Volterra. Prey X grows independently of                                   dt Y = -( -  X)Y II
Predator Y and is depleted by interacting with Y . Thereby
Predator Y grows and, in turn, is depleted by a natural                        a) Determine the steady states of this simple ecologi-
death rate. The most simple differential equation model                            cal model.
reflecting these relations is:
                                                                               b) Linearize the differential equations around the steady
X = X(1 -Y )         I                                                             states and transform the linearized equations into
                                                                                   state-space description (states, inputs, outputs in
Y = Y (X - 1)        II                                                            matrix/vector representation).

a) Assign the facts described above to the individual                          c) Determine for every steady state the Eigenvalues of
    model terms in the system.                                                     the linearized system and deduce from that the sta-
                                                                                   bility of the system in the vicinity of the respective
b) Calculate the steady states of the system.                                      steady state.

   c) How can the behavior in vicinity of the steady                         Prey-Predator Model 4 (fish)
       states be approximated (without calculations)?                       The previously introduced fish population model is mod-
                                                                            ified as follows: it is assumed that the small fishes (X) are
    9 "Yield based on substrate (Yx/s) or oxygen consumption (Yx/o)         furthermore depleted via social attrition effects within
is a very important parameter. This parameter indicates how efficient       their own population. This depletion depends on the
a fermentation is. At the same time it is very closely related with
the maintenance coefficient (m). By means of yield and maintenance
coefficient it is possible to estimate the proportion of energy that cells
consume in biomass and metabolites synthesis and the proportion
of energy that allows the cells to maintain their capability for their
biological performance." Direct quote [?].
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  40/56

probability that two small fishes meet. It is therefore       e) Determine the equations of the vertical and hori-
modeled proportional to X2. The extended population               zontal tangents.
model reads as follows with  =  =  =  = 1;  = 0.5:
                                                              f) Optional: Determine the rectilinear trajectories.
        d X = ( - Y )X - X2 I
        dt                                                    g) Sketch the phase portrait.
        d
        dt Y = -( -  X)Y II

   a) Determine the steady states of the system.

   b) Linearize the differential equations around the steady
       state and transform them into state-space descrip-
       tion (states, inputs, outputs in matrix/vector rep-
       resentation).

   c) Calculate the Eigenvalues of the linearized system
       at the steady states and determine thereof the be-
       havior of the system in the vicinity of the steady
       states.

  d) Determine the equations of the vertical and hori-
       zontal tangents.

   e) Optional: Determine the rectilinear trajectories.

   f) Sketch the phase portrait.

 Reaction system
The following reaction system is given:

                          k1

       A + X - 2X

                          k2

       X +Y - 2Y

                          k3

           2Y - B

The concentration of substance A shall be constant. The
reactions take place in an ideally mixed enclosed reactor
with constant volume.

   a) Give the balance equations for the amount of sub-
       stance (mol) of the reaction partners X and Y .

One obtains the following differential equation system
by specifically choosing the reaction constants k1, k2, k3:

        dcX = cX (1 - cY )
         dt
        dcY = cY (cX - cY )
         dt

   b) Determine the steady states of the system.

   c) Linearize the differential equations around the steady
       state and transform them into state-space descrip-
       tion (states, inputs, outputs in matrix/vector rep-
       resentation).

  d) Calculate the Eigenvalues of the linearized system
       at the steady states and determine thereof the be-
       havior of the system in the vicinity of the steady
       states.
Notes
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                     42/56

                      4. Solutions                                   Task 3.6

                                    Do not betray yourself!               d x1 = 3 -2                 x1 + 1 u
                                                                          dt x2         15            x2     0
Exercises
 Steady states                                                       is:
Calculate the steady states for systems 3.1 to 3.8:
                                                                          3x1 - 2x2 + u = 0 I
Task 3.1                                                                        x1 + 5x2 = 0 II

        x = 2x - 1                                                          II :     x1 = -5x2
        0 = 2x - 1                                                   in I:
       x = 1
                                                                          -15x2 - 2x2 + u = 0
              2                                                                       -17x2 = -u
                                                                                           x2 = 1 u
Task 3.2                                                                                          17

          x = x2 + 2x - 1
          0 = x2 + 2x - 1

You need the p-q equation (learn it by heart!) and then              Back in II:
you get:
                                                                                   5
x1,2  = - 2               22                                               x1 + u = 0
          2
                           2   + 1 = -1  2                                       17
                                                                                              5

                                                                                     x1 = - u
                                                                                              17

Task 3.3                                                             Thus, we have:

         x = sin(x)                                                       x1       -5/17
        0 = sin(x)                                                             = 1        u
       x = n for: n  Z                                                    x2         /17

Works for integers Z.          Z = {. . . ; -2; -1; 0; 1; 2; . . .}  or the steady state (-5/12u, -1/17u).
Task 3.4
                                                                     Task 3.7
       x + x + x = 1
               x = 1                                                      x = (1 - x - y)x I
                                                                          y = (1 - x - y)y II

                                                                             I:      0 = (1 - x - y)x
                                                                          Case 1:
Task 3.5
                                                                                x1 = 0
       x + 2x + x2 - 5x + 6 = 0
                  x2 - 5x + 6 = 0                                         in II :

              (x - 2)(x - 3) = 0                                                   (1 - y)y = 0   Y    =  0  and  Y    =  1
                             x1 = 3
                             x2 = 2                                                                 1               2

Alternatively, with p-q equation:                                    The steady states are (0; 0) & (0; 1).

                                                                          Case 2:

               x1,2  = 5            52                                   (1 - x - y) = 0
                       2                  -6                                         x = 1-y
                                                                                     y = 1-x
                    = 51            2
                       22
                                                             Chapter 3: The magic of change and how to find it -- 43/56

in II :                                                      5                               5

          (1 - 1 + y - y)y              =0                              unstable                             stable

          0  y = 0  always true                             0                               0
           y = c any desired value

                                                             -5                              -5

With this we have the steady states (1 - y; c) & (c; 1 - x)  -1    -0.5   0         0.5  1   -1    -0.5  0  0.5      1
which includes the steady state (0; 1).
                                                                          = -  +                    = -  + 
Task 3.8                                                      0.5                             0.5
                                                              0                              0
u = a - (b + 1)u + u2v
v = bu - u2v                                                 -0.5 -0.5 0 0.5 1 -0.5 -0.5 0 0.5 1

becomes:                                                                                                 
       u = vu2 - (b + 1)u + a = 0 I
                  v = u(vu - b) = 0 II                       Figure 42. Plot of change of x over state x. Stable: if the

                                                             state x is positive, the change x makes it more negative.

                                                             Unstable: if the state x is positive, the change x makes it

                                                             even more positive.

Case 1:                                                      Case 2: Unstable

    II if u = 0             if a = 0                                    if x > x
in I  a = 0                                                         then x > 0

Case 2:                                                      or

                  II if u = 0                                           if x < x
                                  b                                 then x < 0

                      v=                                      Eigenvalues and stability of the steady state
                                  u                          Task 3.13

        bu - u - bu + a = 0                                        d x1 = -1 4 x1
                                                                   dt x2            0 -3 x2
with the two solutions:
                           u = a                             s1 = -1; s2 = -3: stable
                           v = b
                                  a                          Task 3.14

 Stability                                                         d x1 = 3 8 x1
Test the following systems for stability of their steady           dt x2            1 1 x2
state(s). Draw, therefore, x over x. See Figure 42.
Case 1: Stable                                               s1 = -1; s2 = 5: unstable

           if x > x                                          Task 3.15
       then x < 0
                                                                   d x1 = -1 3 x1
or                                                                 dt x2            -1 1 x2
           if x < x
                                                                                  
       than x > 0                                            s1 = i 2; s2 = -i 2: metastable oscillations

                                                             Population growth
                                                             The growth of a specific population is described with
                                                             the following model:

                                                             dX                             (with k > 0 and X(0) = X0)
                                                                 = (2-X)(X -1)(X -k)

                                                             dt
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                   44/56

Task a) Derive the steady states of the system.           Task d) and Task e) Mark within a X-over-t diagram the
                                                          domains where dX is positive, then respectively nega-
         (2 - X)(X - 1)(X - k) = 0
        X 1 = 1 , X 2 = 2 , X 3 = k                                             dt
                                                          tive. One parameter is fixed k = 5. Draw X(t) in a dia-
Task b) Linearize the differential equation around the    gram using the results of parts a)-d) for different initial
steady states.                                            conditions of X. One parameter is fixed k = 5.

         X = (2X - 2 - X2 + X)(X - k)                                                 < 0
            = (3X - 2 - X2)(X - k)
            = (3X2 - 3kX - 2X + 2k - X3 + kX2)            5
            = -X3 + X2(3 + k) + X(-3k - 2) + 2k
                                                                                      > 0
       X = -3(X)2 + 2X(3 + k) - 3k - 2  X
                                                          2  < 0
Task c) Calculate the Eigenvalues of the linearized sys-  1
tem in the steady states and determine thereof the sta-
bility of the individual steady states. For which values                                           > 0
of k do you get stable steady states?
                                                                                                                   t
Steady State 1 (X = 1):
                                                           0.5            1.5        2.5    5.5
        s = -3 + 2(3 + k) - 3k - 2
                = -3 + 6 + 2k - 3k - 2 = 1 - k             > 0            < 0        > 0    < 0

 stable for k > 1.                                         1st-order system
Steady State 2 (X = 2):                                   The growth of a specific population is described with
                                                          the following model:
        s = -12 + 4(3 + k) - 3k - 2
                = k-2                                     dN                         (with r > 0 and N(0) = N0)
                                                              = rN(2 - N)(N - 1)
 stable for k < 2.
Steady State 3 (X = k):                                   dt

        s = -3k2 + 2k(3 + k) - 3k - 2                     Task a) Derive the steady states of the system.
                = -3k2 + 6k + 2k2 - 3k - 2
                = -k2 + 3k - 2                            dN  = rN(2-N)(N -1) = 0  N1 = 0 ; N2 = 1 ; N3 = 2!

 stable                                                   dt

                            s = -k2 + 3k - 2 < 0          Task b) Linearize the differential equation around the
           k2 - 3k + 2 > 0                                steady states.
       (k - 1)(k - 2) > 0                                 The equation can also be written in the following form:

                                                              N = rN(2N - 2 - N2 + N)

                                                              = rN(-N2 + 3N - 2)

                                                              = -rN3 + 3rN2 - 2rN.

Solution 1:  k-1 > 0 OR  k-2 > 0                          With only small deflections n, one can linearize ODEs
Solution 2:      k>2     k-2 < 0                          around the steady states:

             k-1 < 0 OR                                          N = Ni + n for i = 1, 2, 3
                 k<1
                                                          According to Taylor:

                                                                  ddt (N + n) = f (N) |Ni +  f (N)  N |Ni 톘 + . . .

                                                                                                 =0

                                                          After the implementation of the non-linear equation into
                                                          the Taylor equation, one obtains:

                                                                  d (N + n) = -r(N)3 + 3r(N)2 - 2rN
                                                                  dt

                                                                                                                 0

                                                                                         + ((-3(N)2 + 6N - 2)r)  n
                                                                              Chapter 3: The magic of change and how to find it -- 45/56

         d n = (-3(N)2 + 6N - 2)rn                                            derivative is zero for equilibrium points. To sketch the
         dt                                                                   curves we are only interested in the solutions:

    Steady State 1:       N1 = 0  d n = -2rn                                                                                                                !
    Steady State 2:                    dt
    Steady State 3:                                                                  r [(2 - N)(N - 1) - N(N - 1) + N(2 - N)] = 0
                          N2 = 1  d n = rn                                                                           -3N2 + 6N - 2 = 0
                                       dt                                                                           N2 - 2rN + 2/3r = 0
                                                                                                                       N2 - 2N + 2/3 = 0
                          N3 = 2  d n = -2rn
                                       dt                                     With:

Task c) Calculate the Eigenvalues of the linearized sys-                                         2  4 - 8/3      3
tem in the steady states and test for stability of the indi-                          N1,2 =
vidual steady states.                                                                                2 = 1  3
                                                                              ()

Steady State 1: The Eigenvalue is s=-2r and is negative                                     n1 = 1.58, n2 = 0.42
       because r > 0. The Steady State 1 is thus asymptot-
       ically stable.                                                                 < 

                                                                              we2obtain the solution:

                                                                                      >              0
                                                                                     N =1 3
Steady State 2: Because the Eigenvalue s=r is always                          1        3                      12 
       positive, the Steady State 2 is unstable.
                                                                                         < 
Steady State 3: Similar to Steady State 1 and thus asymp-
       totically stable.                                                      Now one can sketch some solutions for the time-course

                                                                              behavior with N(t) over t.
                                                                              0      

Task d) Mark within a t - N-diagram the domains ()
         dN
where is positive, then respectively negative.
         dt                                                                      2

()                                                                                                                                                              = 
                                                                                                                                                                = 
                                                                                 1

          < 

2

        >                 0                                                      0                                                                             
1                                       12 

        <                                                                      Characteristic equation of a 2nd-order system
                                                                              The following characteristic equation of a 2nd-order sys-
0                                                                             tem is given:

                 

                                                                                     (s - a + T )(s - 1 + aT ) = 0 (a, T are real)                             I

()                        
In the second plot (N over N) one can see very well
                                                                              Task a) What is the corresponding homogeneous dif-
where    the  derivative  becomes  negative  or  positive.                    ferential equation? Characteristic equation with formal
      2                                                                       ansatz:

Task e) Draw N(t) in a diagram using the results of                                  y(t) = est
                                                                           =         y(t) = sest = sy(t)

parts a)-d) for different initial conditions of N. Calculate

also 1the position of the turning points.
For the turning points, we need the second derivative:

d2                                                           = 

              d    d
   2 N = f (N)  N                                                                   s2 + (T - a + aT - 1)s + (T - a)(aT - 1) = 0
dt 0 dN            dt                                                                  s2 + (T - 1)(1 + a)s + (T - a)(aT - 1) = 0

         = r [(2 - N)(N - 1) - N(N - 1) + N(2 - N)] N = 0

This solution of the equation gives us only trivial solu-                     Homogeneous ODE:
tions N = 0. This does not mean that the steady states                               x + (T - 1)(1 + a)x + (T - a)(aT - 1)x = 0
are inflection points at the same time, because the third
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                       46/56

Task b) For which values of the parameters a and T do    Biomass growth in a bioreactor
we have one single Eigenvalue on the stability bound?   Task a) Set up balance equations for biomass (X) and
                                                        substrate (S) concentrations.

From Equation I we get:                                 X = 킰                                 I

s1 = a - T                                              S = - 1 X
s2 = 1 - aT                                                    YX S

An Eigenvalue lays on the stability margin, if:         S = - 1 킰                             II
                                                        YX S

1.) a = T  s1 = 0, s2 = 1 - T 2 = 0  T = 1             Task b) Derive S(t) as a function of X(t), X0, and S0.

       1                     1
2.) a =  s2 = 0, s1 = = 0               T = 1
       T                     T
                                                        X Equation I  dX t = 킺t
Task c) For which values of the parameters a and T is                     X0 X      0
the system stable, metastable, or unstable?
                                                                      [ln(X )]XX0 = [  t]t0
1.) Asymptotic stability exists for s1 < 0 and s2 < 0.          ln(X) - ln(X0) = [  t]t0

a-T <0         and 1 - aT < 0  aT > 1                                     ln(X/X0) = 탏
   a<T              Case 1: a > 1 AND T > 0
                                     T                                        X = X0  e탏

                                                        Equation II  dS = - 1  킰0  e탏
                                                                              dt    YX S
                       Case 2: a < 1 AND T < 0
                                        T                                     dS = - 1  킰0  e탏  dt
                                                                                       YX S

2.) Metastability exists if one Eigenvalue lies on the                    S dS = - 킰0 t  e탏  dt
stability margin and the rest is negative.                                               YXS 0
                                                                          S0

)      a=T     and T 2 > 1  T < -1 OR T > 1                               [S]S0 S = - 킰0 Y  1 e XS  0 탏 t
    )  a= 1    and 1 - T < 0  aT > 1
                                                                          S - S0 = - X0 e탏 - 1
            T          T                                                               YX S
                    Case 1: T > 0 AND T > 1
                    Case 2: T < 0 AND T > -1                                              1
                                                                              S = S0 - [X(t) - X0]

                                                                                         YX S

3.) In the remaining cases we have no stability.        or simply:

Task d) Draw the results of c) in a stability diagram                         dS = - 1  킰
with abscissa T and ordinate a.

                                                                              dt    YX S

                                                                                    = - 1  dX
                                                                                         YXS dt
          unstable
                          1                   =                               dS = - 1 톎X
                                                                                       YX S
                                       stable
                                                                              S(t)       1     X (t )

                                                                                    =-                dX
                                                                                    YXS X0
                                                                          S0

                                                                              S(t)       1      X (t )
                                                                          [S]S0 = -  [X ]X0
                                                                                    YX S

                             0 1                                                            1
                             unstable                                     S(t) - S0 = -  [X(t) - X0]

                                                                                           YX S

                                  meta stable                                                1
                                                                           S(t) = S0 -  [X(t) - X0]

                                                                                            YX S

               stable

                                                        Task c) Derive a differential equation for X which does
                                                        not depend on the substrate concentration anymore [X =
                                                              Chapter 3: The magic of change and how to find it -- 47/56

f (X)] using the assumption  = cS.                           Task g) Show that the following ansatz is a solution for
                                                              X (t ):
dX
dt = 킰 = cSX                                                                       X
                                                                     X (t) = 1 + c1e-c2t
                 1
    = c[S0 - [X(t) - X0]]X                                    What values would you have to choose for c1 and c2?

                YX S

Task d) Repeat this while assuming a logistic growth          The equation:
rate  = a - bX with (a, b > 0).
                                                                      dX
dX = 킰 = X(a - bX) = aX - bX2                         (4.1)              = (a - bX) X
dt                                                     (4.2)
                                                                      dt
dS = - 1  X(a - bX)
dt       YX S                                                 has X itself and its derivative. We do not have the deriva-
                                                              tive of the ansatz yet. Let's do it! Therefore, we need the
Task e) Compare the differential equations obtained for       quotient rule:
X in c) and d). What values would you have to choose for
a and b in order to obtain identical differential equations?            f  f g - f g
                                                                        g = g2

                                                              which is applied on our ansatz:

dX      S0 - X + X0                                2!         d X (t )   0  X 1+c1e-c2t - (X (0 + c1c2e-c2t ))
    =c        YXS YXS                                                 =              (1 + c1e-c2t )2
                             X = aX - bX = 0
dt              Task c)                                         dt
  0=X                                  Task d)

         cS0 + cX0 - cX = X [a - bX]                                        X c1c2e-c2t
                YXS YXS                                                 = (1 + c1e-c2t )2

A comparison of coefficients delivers:                        Now we have an equation for X and X . We can insert the
                                                              ansatz into Equation 4.1.

 a = c S0 + X0                                                           dX
                   YX S                                                      = (a - bX) X

          c                                                              dt
b=
                                                               X c1c2e-c2t                        X           X
         YX S                                                 (1 + c1e-c2t )2 =        a - b 1 + c1e-c2t  1 + c1e-c2t

Task f) Calculate the steady states (X, S) in task d).        and multiply with (1 + c1e-c2t )2:

0 = (a - bX)X                                          (4.3)            X c1c2e-c2t =             X       X (1 + c1e-c2t )2
                                                       (4.4)                           a - b 1 + c1e-c2t     1 +$c$1e-$c$2t
0=-     a - bX  X                                                                                            $

         YX S                                                           X c1c2e-c2t = (a(1 + c1e-c2t ) - b)X 

Equation 4.3 delivers two solutions:                                     0 = (a(1 + c1e-c2t ) - bX  - c1c2e-c2t )X 

                         X2 = a                                          = a - bX  + (a - c2)c1e-c2t X 
                                b
X 1 = 0                                                       Check the steady states
                                                              Let's test the first steady state X = 0 :
Inserting into Equation 4.4
                                                                     0 = a - b  0 + (a - c2)c1e-c2t  0
0 = - a - b0 0 and 0 = - a - b ba a = - 0 a
         YX S                      YXS b               YXS b  Well, this equation is always true. But we are rather
                                                              interested in the time response.

shows that the substrate does not matter and that the          = 
steady-state values for X are valid for any substrate con-           
centration. The solution does not say anything about the
dynamic until the steady state. One could say that either            0
the reactor content is dead at the end or the growth and       = 0
death rate balances the amount of individuals. Have
in mind that the logistic growth equation does not de-
pend on the "substrate" and it is the responsibility of the
modeler to set up realistic but still simple equations.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                               48/56

We could try to get more out of the ansatz by checking       Prey-Predator Model
what happens at time point zero t = 0.                      We have 2 versions of the Prey-Predator Model of Lotka
                                                            and Volterra. Prey X grows independently of Predator Y
                       X             X            (4.5)     and is depleted by interacting with Y . Thereby Predator
        X (t = 0) = X0 = 1 + c1e-c20 = 1 + c1               Y grows and, in turn, is depleted by a natural death rate.
                                                            The most simple differential equation model reflecting
which tells us that with the steady state X = 0:            these relations is:

                          0                                    X = X(1 -Y )                              I
                X0 =
                                                               Y = Y (X - 1)                             II
                       1 + c1

the equation is only valid if X0 = 0: So it means that      Task a) Assign the facts described above to the individ-
                                                            ual model terms in the system.
if we do not have any micro-organisms in the tank at

the beginning, we will also have no micro-organisms at                                            birth  Predator eats prey

the end and stay in the steady state X = 0. Not really           Prey number change:       X = X              -Y X
                                                            Predator number change:
interesting, is it? Remark: this steady state is unstable.                                 Y = Y X               -Y

Let's do something useful by checking the second steady                                          growth on prey death

state.          a                                           Task b) Calculate the steady states of the system.

We introduce X = b :                                           X  =  X (1  -Y )     !   0                    I

                                                                                   =

                Ŀa            -c2t a                                Y (X           !
        0 = a -쮊  + (a - c2)c1e                             Y  =         - 1)        0                    II
        쮊                           b                                             =

with which we know that:                                    Case differentiation:

        c2 = a                                                 Equation I  X1 = 0

                                                                               in Eq. II:     Y (0 - 1) = 0      Y     =     0

We insert this into Equation 4.5:                                                                                  1

                              a                                Equation I          Y    =  1

            X0 = b                                                                   2
                   1 + c1
                                                                               in Eq. II: 1  (X - 1) = 0  X = 1
                           a
                                                            Task c) How can the behavior in vicinity of the steady
       1 + c1 = b                                           states be approximated (without calculations)? Calcu-
                   X0
                    a                                                  Cases               0<Y<1         Y>1
                                                                     0<X<1                   X > 0       X < 0
            c1 = bX0 - 1                                                                     Y < 0       Y < 0
                                                                       X>1                   X > 0       X < 0
Inserting this into our ansatz                                                               Y > 0       Y > 0

                      X                                     lation close to the steady state at the zero point: (0.1 |
       X (t) = 1 + c1e-c2t                                  0.1):

we obtain a final solution:                                         X = 0.1(1 - 0.1) = 0.09
                                                                       Y = 0.1(0.1 - 1) = -0.09
                          a/b
       X(t) =                                               Phase plot with oscillating system

                 1 + a bX0 - 1 e-at                          Y

Isn't this beautiful?

                                                            1 stable

                                                               unstable

                                                            0               1                 X
                                                                            Chapter 3: The magic of change and how to find it -- 49/56

 Prey-Predator Model 2                                                                   =    X  = 럿 -1 = 21  Y = 
                                                                                                      5/2
In the following, a more complex Lotka-Voltera model                                       1          2            2
shall be investigated. The growth rate of the prey is in-                                  5          3/2          2
cluded with a parameter  > 0 and the predator's growth                                    1          1            2
rate is modeled with a yield coefficient  > 0. Further-                                    4          1/2          2
more, an influx of predators into the system is assumed.                                   1                       2
The resulting model description is:                                                        3
                                                                                           1
                                                                                           2

                                                                                          1

    X = X( -Y )                                                     (4.6)    Plot with parameter-dependent shift of the steady state:
                                                                     (4.7)
Y Y = Y (X - 1) + 1                                                         Y

Task a) Assign the facts described above to the individ-

ual model terms in this system.                                                  2
                                                                                 1
1 stable                                birth     predation
                                                                            +1
 Prey number change:             X = 킰            -Y X
                                                                        immigration
Predator number change: Y = Y X                              -Y
                                          growth on prey death

         unstable

Task b) Calculate the steady states of system as a func-
   0                 1 and                                                               1234 X
         parameters                .     X
tion of

X        =  X (   -Y )   !   0                      I                       Prey-Predator Model 3 (fish)
                                                                            Small and big fishes are living in a lake. The small fishes
                         =                                                  (X) depend on plankton which is available in excess. Big
                                                                            fishes (Y ) feed on the small ones. If only small fishes
Y        =  Y (X   - 1) + 1       !    0             II                     would be present, it would grow exponentially, i.e. their
                                                                            number grows with a constant specific growth rate 
                                 =                                          ( > 0). In the absence of small fishes, the big fishes
                                                                            would die out with a decay rate  ( > 0). The following
Case differentiation:                                                       simple equations describe these facts using the parame-
                                                                            ters ,  , ,  > 0:
Equation I  X1 = 0

                  in Eq. II:     Y (0 - 1) + 1 = 0           Y    =  1

                                                               1

Equation I  ( -Y ) = 0                   Y    =  

                                            2

                  in Eq. II:   (X - 1) + 1 = 0                                     d   X = ( - Y )X = 0!                 I
                                  킰 - +1 = 0
                                                                                     dt

                                                X =  -1                             d   Y = -( -  X)Y = 0!                II
                                                            
                                                                                     dt

Task c) Which condition has to be fulfilled for parame-                     Task a) Determine the steady states of this simple eco-
ter  to obtain only biologically reasonable steady states?                 logical model.
We assume it is reasonable to always have enough of each
                                                                            Equation I    X 1 = 0
                                               !                            Equation I
                                                                                         in Eq. II:  - (    -  0)Y  =0     Y    =0
species in in the system X ,Y  0 then:
                                                                                                                             1

Y 0                                0                                                    ( - Y ) = 0  Y2 = 
X  0                         -1 0                                                                                       
                             럿
                              -1  0                                                     in Eq. II:  - ( -  X)  = 0
                                                                                                                    
                                   1
                                                                                                               X = 
                                                                                                                   

                                                                                                             X = 
                                                                                                                        

Task d) Draw the steady states for  = 2 and  = [1/5;                       Task b) Linearize the differential equations around the
1/4; 1/3; 1/2; 1] in a diagram (x-axis: X, y-axis: Y ).                     steady states and transform the linearized equations into
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                           50/56

state-space description (states, inputs, outputs in ma-        Prey-Predator Model 4 (fish)
trix/vector representation).
We assume:                                                                                    12              12!
                                                              g1(x, y) = x = (1 - y)x - x = x - xy - x = 0 I
                                                                                              2               2

X = X+x                                                       g2(x, y) = y = (x - 1)y             = -y + xy       !
Y =Y+y
                                                                                                                 = 0 II

The right-hand side of the non-linear equation system         Task a) Determine the steady state.
will be linearized around the steady states. If one de-       From II:
notes the right-hand side of the first ordinary differential
equation (ODE) as function of X and Y, one can use the               (x - 1)y = 0  y1 = 0
Taylor approximation:                                                                    x2 = 1

d X = d (X + x)                                               y1 = 0 in I:
dt dt
                                                                     x(1 - 1 x) = 0  x1 = 0
= g(X,Y ) +  g(X,Y ) |XS  x +  g(X,Y ) |YS  y + . . .                      2
                           X              Y                                                x3 = 2  y3 = 0

Applied on our system, we obtain:                             x2 = 1 in I:

         d x = ( - Y )  x - X  y                               1 - y - 1 = 0  y2 = 1
        dt                                                                   2                       2
        d y = Y   x - ( -  X)  y
        dt

The related state-space representation is:

        x           - Y  -X               x                    Task b) Linearize around the steady state with the equa-
        y = Y  - +  X y                                        tion

Steady State 1: X1 = 0,Y1 = 0. The steady-state values                 f (x, y) = g(x, y) + gx(x, y)x + gy(x, y)y
are inserted into the state-space representation:              using x = x + x with x = (x - x).

        x =  0 x                               (4.8)          x = f1(x, y) = (x - xy - 1 (x)2) + (1 - y - x)x + (-x)y
        y          0 - y                                                                         2

Steady  State  1:  X 2  =    ,Y2  =                           y = f2(x, y) = (-y + xy) + (y)x + (x - 1)y
                                     

        yx = 0 -   x                   y       (4.9)          which is in the general state-space representation:
                   -  0

Task c) Determine for every steady state the Eigenval-        x          1 - y - x -x                   x     x - xy - 1 (x)2
ues of the linearized system and deduce from that the         y =                                          +               2
stability of the system in the vicinity of the respective                    y                x - 1     y           
steady state.                                                                                                    -y + x y
Steady State 1:
                                                                                J =  x  g(x)
Eigenvalues directly from the related state-space repre-
sentation 4.8: s1 = , s2 = -  steady state is unstable        and for Steady State 1 (x = 0|y = 0)  (0|0):
Steady State 2:
                                                                      x = 1 0                    x ,
We use the state-space representation 4.9 to get the char-            y         0 -1             y
acteristic equation:
                                                              Steady  State  2  (1|  1  ):
                                                                                     2

sI - A =  0                   -  = s2 +  = 0                          yx = -121 -1                   x ,
             -                  0                                                                    y

Thus, we obtain the complex Eigenvalues:                                        20

       s1,2 =  - = 켲                                        Steady State 3 (2|0):

Thus, we have a metastable steady state with conserved                x = -1 -2                   x ,
oscillations, also known as a limit cycle.                            y         01                y
                                                                           Chapter 3: The magic of change and how to find it -- 51/56

Task c) Determine the stability with the Eigenvalues:                      and consequently is an unstable saddle.
                                                                           Asymptote:
sI - A = s - a11 a12                                                       We start with the equation in the state plane
               a21 s - a22
                                                                                   y = dy = y
                                                             !                     x dx -x - 2y

         = (s - a11)(s - a22) - a12a21 = 0                                 and introduce the linear equation y = mx and obtain a
                                                                           equation
For Steady State 1 (0|0):
                                                                                                           mx
                        !                                                                        m=

(s - 1)(s + 1) = 0                                                                                     -x - 2mx
                                                                                    -mx - 2m2x = mx
This characteristic polynomial delivers s1 = 1, s2 = -1,                          -2mx - 2m2x = 0
which indicates an unstable saddle point.
Asymptote:                                                                           2mx(1 + m) = 0
We start with the equation in the state plane:
                                                                           which result in the slope values m1 = 0 and m2 = -1
        y = dy = -y
        x dx x                                                             Task d) Tangents
                                                                           To draw our phase plot, we calculate horizontal and
and introduce the linear equation y = mx and obtain a                      vertical asymptotes with:
equation
                                                                                                                              !
             -mx
       m=                                                                       horizontal tangents: y = 0 in Equation II:
                                                                                   x = 1, y = 0
                x

that only works for m = 0

Steady  State  2  (1|  1  )  delivers  the  characteristic      equation:   vertical tangents: x = 0 in Equation I:!
                       2

           (s + 1 )  s + 1 = s2 + 1 s - 1 = 0                                 x = 0,        y   =     -  1  x  +  1
                                                                                                          2

                  2             2      22                                  Task e) Rectilinear tangents
                                                                           Ansatz10 11: y = mx + b
                                   2s2 + s + 1 = 0
                                            
               -1  1 - 8 1 7                                              dy                    -y + xy -mx - b + mx2 + bx
                                                                               =m=                           1 2=                               1 2 (4.10)
s1/2 = 4 = - 4  i 4                                                       dx                x - xy - 2 x x - mx - bx - 2 x         2

which indicates a stable focus.                                            10 Ansatz: x = my + b
Asymptote:
We start with the equation in the state plane                              dx = m = x - xy - 12 x2

                                                                           dy                -y + xy

y dy                      12 x                                                               my  +  b  -  my2   -  by  -  1  [m2y2  +  2mby  +  b2]
        = =1                                                                                                              2
                                                                                          =
x dx - 2 x - y                                                                                                  -y + my + by 2

and introduce the linear equation y = mx and obtain the                     -my + m2y2 + mby - my - b + my2 + by + 1 m2y2 + mby + 1 b2 = 0
equation                                                                                                                               2             2

                                                                            (m2 + m + 1 m2) y2 + (b) y + ( 1 b2 - b) = 0
                                                                                             2                               2

                  1 m = 2 x                                                                  0! 0! 0!
                        - 12 x - mx
                                                                           Coefficients:

- 1 mx - m2x = 1 x                                                         b1 = 0  m1 = 0  x = 0

                                                                                                          3            5
        2                    2                                             b2 = 2  m2 = 1  + 1 = = 0 .
                                                                                                          2            2
                     0 = m2 + 1 m + 1
                                   22                                      11 Ansatz: x = b

                                1      1 1 -1  -7
               m1,2 = - 4  16 - 2 = 4                                     x=b

                                                                           x = 0

which delivers imaginary slope values.                                                              12                          x!
Steady State 3 (2|0) result in the characteristic equation                  x = (1 - y)x - x = x(1 - y - ) = 0
                                                                                                    2                           2

                              !                                                            b                     b = 0 (for all y)               x=0.
                                                                            b(1 - y - ) = 0
(s + 1)(s - 1) - 0 = 0                  s1 = 1; s2 = -1
                                                                                           2
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                               52/56

        mx - m2x2 - bmx - 1 mx2 = -mx - b + mx2 + bx             Reaction system
                                   2                            Task a) Balance equations for X and Y.
                                                                The balance equation can be written directly
         - m2x2 - 1 mx2 - mx2 + mx - bmx + mx - bx + b = 0
                       2                                               A = 0
                                                                       X = -k1AX + 2k1AX - k2XY = X(k1A - k2Y )
         (- 3 m - m2) x2 + (2m - bm - b) x + b = 0                     Y = -k2XY + 2k2XY - 2k3Y 2 = Y (k2X - 2k3Y )
           2                                                           B = +k3Y 2
                                                    0!
                               0!
               0!

Coefficients:

        b=0                                                     whereby one has to carefully pay attention to the coeffi-
                                                                cients. Or one uses the network approach learned in the
        2m - 0  m - 0 = 0  2m = 0  m = 0                       previous section:

                    3                            3                            v1                 v2     v3 

        m(m + ) = 0  m1 = 0; m2 = -                                            -1  0                 0  0A
                    2                            2
                                                                       N  =    -1       +  2        -1 0 X
                                                                             
                                                                             0                   -1 + 2 -2Y
Inserted in Equation 4.10:
                                                                                        0            0  1B

        for m1 = 0  y = 0                                       which results in:
                                                                                                             
                                                                          A                          0 0 0 
                                                                       X                            1 -1 0  k1AX
                                                                               =  S     =  N  v  =            k2XY  .
                                                                       Y                             0 1 -2
                      3                                                                              0 0 1 k3Y  2
        for m1 = -                                                        B

                      2

                         - 3 3 = 2 x - 32 x2                    This way might be less error prone in praxis. In both
                           2 x + x2                             cases we obtain:

                         -3 = 3                                        X = X(k1A - k2Y )
                           22                                          Y = Y (k2X - 2k3Y )

Task f) Draw the phase plot.                                    where A is kept constant, and B does not influence the
The phase plot can be seen in Figure 43.                        behavior of X or Y . Because A is constant, we could also
                                                                combine it with k1 to another constant k1A = C. Also
       2                                                        k3 could be updated 2k3 = k3 . In the following we do
     1.8                                                        not want to drag the parameters on and only study the
     1.6                                                        system:
     1.4
                                                                       X = X(1 -Y )

                                                                       Y = Y (X -Y )

   1.2                                                          Task b) Determine the steady states of the system.

Y  1

   0.8                                                                 g1(X,Y ) = X = X(1 - k2Y )             !

                                                                                                             =0 I

   0.6                                                                 g2(X,Y ) = Y = Y (X -Y )               !

                                                                                                             = 0 II

   0.4

   0.2                                                          Steady State 1:

   0                                                                    x1 = 0  y1 = 0
                                                                Steady State 2:
        0      0.5       1  1.5               2         2.5  3

                            X

Figure 43. Phase plot: Red dots are steady states of                   y2 = 1
the system. Dotted lines are the vertical and horizon-
tal tangents. Initial values are: (x = 0.2, y = 2) and          in II
(x = 2, y = 0.2).

                                                                       1(x - 1) = 0  x2 = 1!     
                                                                            Chapter 3: The magic of change and how to find it -- 53/56

Task c) Linearize the differential equations around the                     with the Eigenvalues:
steady state and transform them into state-space descrip-
tions (states, inputs, outputs in matrix/vector represen-                          s1 = 1
tation).                                                                           s2 = 0
The general form is:
                                                                            The positive Eigenvalue indicates an unstable steady
f (X ,Y ) = g(X ,Y ) + gx(X ,Y )X + gy(X ,Y )Y                              state. Steady State 2:

 sometimes also written as:                                                 sI - A = s 1
                                                                                         -1 s + 1
     X = f1(X,Y ) - g1(X,Y )
         = g1x (X ,Y )X + g1y(X ,Y )Y                                                                            !

     Y = f2(X,Y ) - g2(X,Y )                                                         = s(s + 1) + 1 = 0
         = g2x (X ,Y )X + g2y(X ,Y )Y                                                = s2 + s + 1

 using X = X + X with X = (X - X). In our example,                          The quadratic equation is solved:
we obtain:
                                                                                                         1 i
X = f1(X,Y ) = X(1 -Y ) + (1 -Y )x + (-X)y                                        1 1-4
Y = f2(X,Y ) = Y (X -Y ) + (Y )x + (X - 2Y )y                               s1,2 = 2 = - 2  2 3

                                                                            and results in 2 complex numbers with negative real part.
                                                                            Thus, we have a stable focus.

which is in the general state-space representation:                         Task e) Determine the equations of the vertical and
                                                                            horizontal tangents.
x  1 -Y  -X                       x  X (1 -Y )
y = Y  X  - 2Y                    y + Y (X  -Y )
                                                                            Horizontal tangent:
                 J =  x  g(x)

Steady State 1 (X = 0,Y  = 0):                                              Y  =  Y (X  -Y)        !  0

                                                                                                  =

                                                                                                   Y =0;            X =Y

X                1 0 x
Y = 0 0 y                                                                   Vertical tangent:

Steady State 2 (X = 1,Y  = 1):                                              X  =  X (1  -Y     )   !  0

                                                                                                  =

X                0 -1 x                                                                            X=0;             Y =1
Y = 1 -1 y
                                                                            Task f) Optional: Determine the rectilinear trajectories.
                                                                            Ansatz1213: y = mx + b

                                                                               12 Ansatz: X = mY + b

Task d) Calculate the Eigenvalues of the linearized sys-                    dX          mY + b - (mY + b)Y
tem at the steady states and determine thereof the be-                      dY = m = (mY + b)Y -Y 2
havior of the system in the vicinity of the steady states.
                                                                                     mY + b - mY 2 - bY
        sI - A = s - a11 a12                                                      = mY 2 + bY -Y 2
                       a21 s - a22
                                                                             m2Y 2 + bmY - mY 2 - mY - b + mY 2 + bY = 0
                                                                         !           Y 2(m2 - m + m) +Y (bm - m + b) - b = 0

                 = (s - a11)(s - a22) - a12a21 = 0                           b=0, m=0, X=0.

Steady State 1:                                                             13 Ansatz: X = b

sI - A = s - 1 0                                                                b = 0,               X = 0
               0s                                                                                    X = 0 = X(1 -Y ) = b(1 -Y )

                               !                                                               X =0 .

         = (s - 1)s = 0
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                    54/56

   2.5

                                                          1 function PhasePlot2

                                                          2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

   2                                                      3 % Title: phase plot

                                                          4 % Author: Marco Albrecht

                                                          5 % Licence: EUPL v1.2

                                                          6 % Last change: 01.09.2018

   1.5                                                    7 clear global ;close all ; clc ;

                                                          8 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Y                                                         9 %% Parameters

   1                                                      10 p.a= 1;%

                                                          11 p.b= 1;%

                                                          12 %% Trajectories

                                                          13 %Trajectory 1

   0.5                                                    14 tspan=0:0.01:150;%[t_start t_end]

                                                          15      c0=[0.2; 2];%[initial conditions]

                                                          16      [,c1] = ode15s(@system,tspan,c0,[],p);

   0                                                      17 %Trajectory 2

        0   0.5  1     1.5               2  2.5           18      tspan=0:0.01:150;%[t_start t_end]

                    X                                     19      c0=[2.5;2];%[initial conditions]

Figure 44. Phase plot: Red dots are steady states of      20      [,c2] = ode15s(@system,tspan,c0,[],p);
the system. Dotted lines are the vertical and horizon-
tal tangents. Initial values are: (x = 0.2, y = 2) and    21
(x = 2.5, y = 2).
                                                          22 %% Plot

                                                          23      figure(1)

                                                          24      set(gcf,'color','w');

                                                          25      hold on

                                                          26      % trajectories

                                                          27      plot(c1(:,1),c1(:,2),'Color', [0.4 ...

                                                                          0.75 0.75],'Linewidth',2)

                 X(mX + b) - (mX + b)2                    28      plot(c2(:,1),c2(:,2),'Color', [0.85 ...

        dY  =m=                                                           0.6 0.85],'Linewidth',2)

        dX       X - X(mX + b)                            29      % Asymptotes

            mX2 + bX - m2X2 - 2bmX - b2                   30      plot([0 2.5],[0 2.5],'k--')

                                                          31      plot([0 2.5],[1 1],'k--')

                 X - mX2 - bX                             32      % steady states

                                                          33      plot(0,0,'ro','MarkerSize',3,'LineWidth',5)

                                                          34      plot(1,1,'ro','MarkerSize',3,'LineWidth',5)

 mX - m2X2 - bmX - mX2 - bX + m2X2 + 2bmX + b2 = 0        35      % arrows
         X2(-m2 - m + m2) + X(m - bm - b + 2bm) + b2 = 0
                                                          36      annotation('arrow',[0.54/2.5 ...
         b=0, m=0, Y =0
 Task g) Sketch the phase portrait.                                       0.52/2.5],[1.8/2.5 ...
We try to help our drawing with additional point tests:
                                                                          1.6/2.5],'Color', [0.4 0.75 ...
     Test at (X = 2,Y = 1):
                                                                          0.75],'Linewidth',2)
        X = 2(1 - 1) = 0
        Y = 1(2 - 1) = 1                                  37      annotation('arrow',[1.2/2.5 ...

 Test at (X = 1,Y = 2):                                                   1.3/2.5],[0.8/2.5 ...

        X = 1(1 - 2) = -1                                                 0.87/2.5],'Color', [0.4 0.75 ...
        Y = 2(1 - 2) = -2
                                                                          0.75],'Linewidth',2)
The phase plot can be seen in Figure 44 and the corre-
 sponding MATLAB code is shown below:                     38      annotation('arrow',[1.5/2.5 ...

                                                                          1.3/2.5],[1.9/2.5 ...

                                                                          1.78/2.5],'Color', [0.85 0.6 ...

                                                                          0.85],'Linewidth',2)

                                                          39      % etc

                                                          40      ylabel('Y')

                                                          41      xlabel('X')

                                                          42 end
                                                          43 function dcdt=system(,c,p)

                                                          44 %% Load parameters

                                                          45 % p.a=1

                                                          46 % p.b=1

                                                          47 %% System dxdt=A*x

                                                          48 dcdt(1) = p.a*c(1)*(1-c(2))             ;% x

                                                          49 dcdt(2) = p.b*c(2)*(c(1)-c(2)) ;% y

                                                          50 dcdt = dcdt'; % important! - transposes ...

                                                                  the solution vector

                                                          51 end
Notes
Notes
Chapter 4: Physical modeling and non-linear enzyme

kinetics

Thomas Sauter, Marco Albrecht

  Motivation
  Reality can be difficult to grasp. Philosophers puzzle their heads over the true nature of reality and our image of
  it. Accordingly, modeling is the art of coming close enough to reality to give valuable insights, without actually
  being reality. Sometimes we have to include more details. The reaction rates v, with which you are already
  familiar, can be replaced by more complicated non-linear enzyme kinetics under certain circumstances. Moreover,
  mathematical equations might be too flexible initially because they are entirely virtual. We have to actively
  include physical constraints to let the model behave more like reality and to force the model behavior into realistic
  paths. Different modeling techniques can require the application of different physical laws. But instead of making
  our models more and more complicated, we have to ask ourselves: what is essential and thus has to be included
  in a model and what only distracts us from the real kernel? But what is the real kernel? Which criterion can help
  us to choose an appropriate approximation of our problem? We can neither ignore reality nor can we ever fully
  represent it. Join us in finding a healthy distance from reality and in exploring the fascinating and comprehensive
  field of enzyme kinetics. Modeling is a wonderful tool for thinking deeply about the origin of all these superficial
  observations which we encounter in private life and our professional existence. Let's make this tool sharp!

  Keywords
  Model classification -- Model building -- Assumptions -- SI units -- Akaike information criterion -- Balance
  equation -- Enzyme kinetics

 Contact: thomas.sauter@uni.lu. Licence: CC BY-NC

                         Contents                         already, the graph alone can give us insight. However,
                                                          we have not modeled physical systems. In order to model
1 Lecture summary                  1                      physical systems, we need to think about physical laws
                                                          in thermodynamics, include physical relevant param-
1.1  What is a model? . . . . . . . . . . . . . 1         eters, think about reaction laws, and get familiar with
                                                          unit calculus. However, we begin with the question of
1.2  Modeling procedure . . . . . . . . . . . 2           what distinguishes reality from its approximation.
                                                          If you prefer, you could also jump directly to balancing
1.3  Mathematical analysis of models . . . . 3            (page 10)--an approach which enables us to formulate
                                                          mathematical models of physical and biological systems.
1.4  Model classification . . . . . . . . . . . 5
                                                          1.1  What is a model?
1.5  Akaike Information Criterion . . . . . . 7           "Un cercle n'est pas absurde,[..] Mais aussi un cercle
                                                          n'existe pas" / "A circle is not absurd; it is clearly ex-
1.6  Extensive properties & SI units . . . . . 7          plained by the rotation of a straight segment around one
                                                          of its extremities. But neither does a circle exist." This
1.7  Balancing . . . . . . . . . . . . . . . . . 10       citation is from the work La Nause written by Jean-Paul
                                                          Sartre1 [1, 2]. Sartre was desperate because whenever he
1.8  Enzyme kinetics . . . . . . . . . . . . . 12         had a word for or a model of something, it would never
                                                          be the reality he wanted to describe. Because we are
2 Basics of Mathematics            19                     unable to name something appropriately, the real things
                                                          remain nameless. The difference between the beauty of
References                         20                     abstract description and the imperfection of real-world

3 Exercises                        22                         1 French philosopher, novelist, political activist, playwright, literary
                                                          critic, and biographer Jean-Paul Charles Aymard Sartre (1905--1980).
4 Solutions
                                                                                                  https://doi.org/10.11647/OBP.0291.04
Do not betray yourself!            26

                 1. Lecture summary

We learned in the previous chapters how to set up system
equations and understand their dynamics. This is espe-
cially helpful for Metabolic Network Analysis. There,

 2023 Thomas Sauter and Marco Albrecht, CC BY-NC 4.0
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  2/36

phenomena nauseated him because it revealed to him the             characteristics, and the underlying assumptions. Con-
uselessness of existence. In the world of mathematics, ev-         sequentially, the interpretation of the model's result de-
erything seems to be perfect and pure--like a circle. But          pends on one's modeling strategy and the considered
you will never find a perfect circle in reality. Thus, the va-     assumptions, and is restricted to the considered concep-
riety of human existence might suggest that something              tualization. This applies to the modeling framework
perfect--or a higher power which leads us--cannot exist.           itself and to the content of the model. Modeling helps us
Instead, it is up to us to turn our existence into essence.        to dive into a deeper understanding of what we observe
Independent of our opinion of the European movement                and to find out what does not work or maybe why our
of existentialism, this movement urges us to get a bal-            conception of reality fails. Modeling is not a tool to con-
anced feeling for what models are. We have to bring                firm our premature beliefs about what is helpful in order
them close enough to reality to be useful, but one has to          to seem successful. The less we know, the more careful
stop the refinement if this stops helping us answering             we should be with interpretation. Modeling is a tool
real-world questions. George Box2 once wrote: "Remem-              to helps us understand biology, but it does not replace
ber that all models are wrong; the practical question              experiments. Bottom-up modeling helps us to develop
is how wrong do they have to be to not be useful" [3].             a consistent theory on what we observe and top-down
This pragmatic view helps us navigate the process of               modeling help us to extract the most likely relationships,
understanding reality with useful models, but it spares            but modeling cannot magically generate new data from
us depression caused by exaggerated perfectionism.                 nothing. Never fall in love with your model and always
Mechanistic models have the following advantages [3]:              be sceptical and aware of its shortages. Moreover, it is
                                                                   not an excuse to oversimplify a model until it shows the
     They contribute to our scientific understanding of           obvious and thus becomes useless. Useful modeling is
       the phenomena under study.                                  the art of representing reality to a degree that goes be-
                                                                   yond what you can understand on your own and find
     They usually provide a better basis for extrapola-           the limits of what the mathematical framework can han-
       tion (at least to conditions worthy of further ex-          dle with given data. Therefore, you need to master the
       perimental investigation, if not through the entire         mathematical framework, its physical interpretation, and
       range of all input variables).                              the biology of what your model represents. You need
                                                                   the knowledge on how experimental data has been de-
     They tend to be parsimonious (i.e. frugal) in the            rived, how data can be interpreted, and whether you can
       use of parameters and provide better estimates of           use this data in the context of your model. The general
       the response.                                               modeling approach is part of the next section.

We want to address what the reality is in our specific case.       1.2  Modeling procedure
Biologists know that experimental models in biology                A mathematical model uses mathematical descriptions
should resemble--but usually do not fully represent--              and computer simulations. A model can be defined as:
real-world phenomena in vivo. However, the biologist
does not really need to think about characteristics he or          Definition 1. Model: A model is the representation of
she does not care about. We biologists have enough trou-           the essential aspects of a system which represents knowl-
ble ensuring that one's experimental setting allows one's          edge of that system in usable form (Eykhoff, 1974) [4].
living system to operate in the desired states and that
the observations (measurements) indeed show what the               The modeling procedure is an iterative approach and fol-
real system states look like in principle. It is also the          lows a cycle such as that shown in Figure 1 and usually
pragmatic realization that it is just impossible to mea-           requires an iterative procedure of computational and ex-
sure all possible players at any time under any condition.         perimental analysis (Figure 2). The next section is based
But, many things in biologists' system of interest are al-         on a textbook in German language [5].
ready true because they work on a real system. If they
model something, they work on an entirely virtual sys-             Specify the question of interest
tem which they think represents what they care about.
This does not mean it is true. It is an abstraction. One           The question of interest is of utmost importance. It will
has to actively ensure that one's mathematical model               hardly ever be the case that you have a universal model
is physically correct, to figure out which elements one            with which you can explain all kind of questions. With
can neglect and which not, and to iteratively compare              the main question in mind, you can start with the sim-
one's simulation result with experimental data. Which              plest model that can roughly represent your system. As
constraints one must take into account depends on one's            soon as it works, you can refine it iteratively. Modeling
chosen modeling framework, its inherent mathematical               scopes can be:

    2 British statistician George Edward Pelham Box (1919--2013).       Scientific understanding
                                                                        Validation or falsification
Chapter 4: Physical modeling and non-linear enzyme kinetics -- 3/36

Figure 1. Modeling cycle of Blum and Lei. 1: under-             Model building
standing 2: simplifying/structuring 3: mathematizing
4: working mathematically 5: interpreting 6: validating          The modeling procedure starts with a verbal model
[6]. Copyright  2007 Authors (Blum, Lei), Fair Use.            which is the initial model concept. It helps us to de-
                                                                 termine what belongs to the model and what does not,
     Prediction                                                 and is specified by the expert of the system. Defining
     Decision-making, strategy planning                         the system's purpose is a part of this process. The verbal
     Design of a controller                                     model is written in the everyday language of the mod-
     Virtual prototype or material simulation                   eler and the experts. It is also the starting point for the
     Pattern recognition.                                       influential structure of a given system. The following
                                                                 steps are necessary to build a model in order to answer
    The modeling scope determines the level of detail of         the question of interest:
the model. An experienced modeler can plan the mod-
eling strategy with the mathematical implementation                   Specify model and system parameters
and numerical issues in mind. Numerical analysis3 is a                Specify model variables and system states
mathematical discipline which tends to solve problems                 Specify the interdependencies between the states
approximately. Thereby, errors can occur which have to
be minimized. Not all numerical methods can be applied                  with auxiliary conditions and physical laws
to any problem, and sometimes the solving process can                 Formulate the mathematical procedures, such as
go completely wrong.
                                                                        optimization, sensitivity analysis etc.
Assumptions
                                                                 The system variables represent the states which change
Assumptions about reality help us to make the real-              during the simulation. The system variables span the
world problem abstract and solvable. There are, for              phase space and should fulfil the following criteria:
example, assumptions for simplifying the description
of inter-dependencies or assumptions for constraining                 Independence: No system variable can be described
the number of states to investigate. Assumptions should                 as a function of another.
not contain the obvious, should enable a useful model,
and should not lead to infeasible models. Assumptions                 Completeness: The state of the system is fully ex-
build the foundation of the model and determine the                     plained by all state variables.
interpretation of the outcome. Each assumption has to
be justified and checked for the qualitative and quan-           The auxiliary conditions describe the interdependencies
titative impact on the model. The assumptions should             between the system variables and are adjusted by the
not contradict one another. Assumptions might change             system parameter. Modelers use concept maps to draw
during the modeling process. The following questions             potential cause-effect relationships and to reason about
help us to identify appropriate assumptions:                     what has to be modeled and how. Engineers are, like
                                                                 biologists, very visual scientists and need drawings for
     Which effects can be neglected?                            fruitful communication.
     Which scenario might be a good starting case?              A system parameter is a number that does not change
     Which parts of a system are necessary and which            with time. In the previous chapters, we mainly talked
                                                                 about rates. These rate terms represent equations by
       are not relevant?                                         themselves and include parameters. Only in the most
     Can a part of the system be prescribed?                    simple case are rates represented by a single parameter.
                                                                 A typical procedure in modeling is the search for param-
    3 Earliest mathematical writings from Babylon 1800--1600 BC  eters which are able to let the model behave comparably
(Iraq).                                                          to reality.
                                                                 A good procedure to get good models is to ensure that
                                                                 one has as many equations as variables (remember the
                                                                 Rouch-Capelli theorem).

                                                                 1.3  Mathematical analysis of models
                                                                 Mathematical methods can be used to make models fea-
                                                                 sible, to solve them and to understand their properties.
                                                                 This section is based on the same textbook in German
                                                                 language [5].

                                                                 Dimension analysis

                                                                 The model variables might have physical meaning and
                                                                 units. A reformulation can be helpful to get rid of the
                                                                 units with a proper unit calculus. This process is called
 con-   can be improved iteratively and interactively. All these steps can be a combination of approaches;
nto
 ar to  for example, simultaneously using gene expression levels (continuous) and discretized
obal
hes     Ipnrtorotdeuinc-tipornottoeSinysintetmersaBcitoiolongiyn:fWoromrkabtiooonk. fTohrrFeleipepxeadm-CpllaesssroofosmucTceeacshsfiungl modelling approaches are  4/36
ol-
 ) can  provided in the figure and the table. Other diverse models have been used in eukaryotic
y of
most    organisms58 and can be adapted for the system of interest.

 is                                         Graph      Discrete                        Static
biol-                                     Equations  Continuous                    Deterministic
hole
ol-                                                                                 Stochastic
gh-
ve                                        Topology                    State        Dynamic
ously
 ns of                                                                                                           Data
er-                                                                   Model
nd
                                                                                                                       Computational
 obal
 e      Quantitative    Validation                                                       Inference                     Statistical
 data   Qualitative                                                                (learning and fitting)
ogy
 c-               Data                                                                                                 Literature
 ess,
 find                                                                 Prediction
 ted
s       Figure 2. The principle of iteration in modeling. We usually start with a hypothesis and choose an appropriate
sion
-       modeling strategy (graph, discrete, continuous, static, stochastic, deterministic). We integrate data and adjust the
 lly
ed,     mo/deGl VuJnQtiFl it fits/. TQhFeGnNwe perfo&rmCVaCprediction a+PnHdGsTeGePwEhGether the2mTGoFdKeElViKsQqPualitat8ivCeNlKyFaCnVdKQqPuantitatively good
unc-
nter-   enough. If not, the cycle is repeated until we sufficiently understand the system. More information and source: [7].
 and    +PHGTGNCVQT r6QRQNQI[ )GPG                                    5VCVKUVKECN  )GPG                    'ZRTGUUKQP
 m-     Copyright  2009, Nature Publishing Group.
                        FKGTGPVKCN GZRTGUUKQP UVCPFCTF                             GZRTGUUKQP NGXGNUHQT
bot-                    GSWCVKQPU RTQNGUHTQO TGITGUUKQP                            NGXGNUKPPGY IGPGUKPPGY
 odel   non-dimensionarliz5aVtCiVoGn. MoreoOveKEr,TrQeClTeTvCa[nt lengCtPhFsOorQFGsNimplifieGdPmXKoTQdPeOl (GpPeVrUturbGaPtXioKTnQtPhOeoGrPyV)U.Karl Popper 4
sses    magnitude rangEeQs PoVfKPthWeQWvUariabFlCeVvCalues mightUbGeNGdEeVK-QP once saidC:P"FSNcGiCenTPce may bMePdQeEsMcQrWibVeUd as the art of sys-
d       fined to determinGeZwRThGaUtUKrQePlevanDtKEinNWflUuVGenTGcFes are. Ques- tematic oEvCeWr-UsCiNm plificationR--JGtPhQeVa[rRt KoEf discerning what
 able   tions of scale areNGrXeGleNvUant. Multi-scale models can con- we may wTGiNtChVKaQdPvUaJnKRtaUg e omCUiUtC."[U
e       tain different relerv&an[tPmCOagKEnitude orders of interest.              LinearizaFtiKoTGnEaVGroFu nd spe%ciJfi+c2psEoJinKRtsCmPiFght help inves-
 bac-                   FGVGTOKPKUVKE                                             tigate thVeQmRQoNdQeIl'[s behaviRouTQrVaGnKPdsRacTQquVGirKPeinformation
 ani-                                                                             about the non-linear modeKPl VaGtTsCpEeVcKQifPicUpoints.
al      Inverse and poorly posed problems
onal
ples    On%e .m4ight perforrm6QRceQrNtQaIin[step)sGtoPGcheck wheth5eVrCVtKhUeVKECNC heck qu+aPlVitGaTtCivEeVKpQrPoUperties%J+2sEJKR
        model is matheWmPaFtiKcTGaEllVyGFwell-GpZoRseTGdUUinKQPitself. OIfWnVWoCt,N One runsDtGhVeYmGGoPdel and gSetWsCcPoVnKVcCluVKsXioGn s on asymptotic
 the    mathematical proIcTeCdRuJrUes mightRpTeQrfoNGrmUHTpQoOorCly. AKPVwGeTCllE-VKQPbUehaviorR, CsyTVsUtem stability,2a%n4dif oscillations can occur,
 ism,   posed problem rha5sVCaVGun ique sEoQluOtiRoGnP. FTKWhOis solution among other qualitative pRroJpGePrQtiVe[sR. KE
        changes continuFoKuUsElTyGVwGith conQtiHnOuoKEuTsQlyCTcThC[anging pa-                              CUUC[UCPF
        rameters. A systrem&[mPCaOtriKExwhiFchCViCs not invertible can Sensitivity analysis                RTQVGKPsRTQVGKP
        cause numericalUpVCroVKbElems. Matrices with a high condi- After one has found a soluKPtiVoGnTCwEViKtQhPaUgiven set of opti-
        tion number are ill-conditioned. A condition number mal parameters, one wants to know how small changes
        mea/suGVrCesDhQoNKwE mruc6hQRanQNoQuIt[pu t v)alGuPeQchOaGnges with%sQmOaRllWVCVoKQf PpCaNram0eGteYrvalues influ)enTQceYtVhJeCsUoUClu[tUio n. This is an
        chaTnGgEeQsPoUfVTtWhe inEpJuGtOnKuEmCNb er. CPPQVCVKQP EQPUVTCKPVim portanTtGCtyEpVKeQoPfUanalysisOtoGVcCaDrrQyNKVoGut.
        EVKQPUs  GSWCVKQPU NKVGTCVWTG DCUGFNKVGTCVWTG CPPQVCVKQPQH NGXGNUCPF
                        r5VCVG            RJ[NQIGPGVKE                            InterpretaQtTiRonJCanPdIvGaPliGdUatioCnFCRVCVKXG
        Investigate special problems                                              The interCpPrFetIaTtQioYnVoJf the rGeXsQuNlWtsVKmQPight happen in light

                           EQPVKPWQWU KPHQTOCVKQP
        One might first sro&lv[ePsCpOecKEial casCePsFbefore investigating of previoTuCsVGeUxpectations and requires the consideration
        the more compliFcaGtVeGdTOgeKPnKeUrVaKEl caRsJe[. UKQNQIKECN              of all assumptions. The simulation might give us a pre-

                                          FCVC                                    diction which is then subjected to a validation process.

        Simplification and linearization                                          If experimental data can be generated, one has to deter-
            %J+2sEJKREJTQOCVKPKOOWPQRTGEKRKVCVKQPYKVJOKETQCTTC[mJi[nDeTKhFoK\wCVtKQoPler%a.n4toEnQePViGsZrVeNKaMdGyNKJtQoQbFeQ. HHow well does
        One might neglect terms with minor impact to see if the
        TGNCVGFPGUU
        simplified model behaves similarly to the original model.
                                                                                   4 Austrian and British philosopher Sir Karl Raimund Popper (1902--
        The neglected terms are called small disturbances of the 1994).
                                                                                            Nature Reviews | Microbiology
        as RegulonDB50 (see Further information), verification of predictive global models

        house many experimental and in silico data that integrate known and novel regulatory

        that are common entry points for further interactions to broaden our view of tran-
                                                         Chapter 4: Physical modeling and non-linear enzyme kinetics -- 5/36

the model fit the new data? Sometimes no data can be discretize continuous models to obtain and handle a

generated. In this case, check the plausibility with the simpler and reduced discrete model in the hope it suffi-

experts of the given system. Surprising simulation re- ciently resembles the original continuous model.

sults might lead to a deeper investigation of subsystems                Deterministic or stochastic models: A deterministic model
or checking whether parameters and variables remained                   always comes to the same solution with given parame-
in physically meaningful ranges after the previous opti-                ters and initial variable values. Stochastic models oper-
mization. One cannot prove the 'correctness' of a model,                ate with random events and are used for models with
and a model cannot be 'verified'. Correct settings in a                 certain likelihoods. Stochastic models are also used for
simulation cannot constitute proof of accurate behavior                 very complex models where the structure is not fully
under all possible circumstances. The only thing it can                 understood.
do is falsify the theories and models, e.g. if observations

and simulations disagree. Consequently, we always say                   Sometimes we have models with mixed elements; how-

     svyalsidtaetema model in light of the model's purpose
that we                                                                 ever, it helps to understand the character of each in or-
and in the following aspects:
       environment                                                      der to make wise choices and to be aware of the conse-
Structural validity: The model has an influencefseterudcb- acqkusefn(cxe)s.
       ture which resembles the influence structure of
       the original. The number of essential states and Level of description
       thseyfseteedmback structures h1ave counterparts in the 1st-principlseymstoedmels, white-box models Models can be
       original system.                           2                     assembled from known laws or well-understood 1st prin-

       elements x                                                       ciples.  output y

Behavioral validity: The model shows qualitatively the

       same dynamic behavior, e.g., oscillations or not.                Heuristic models, gray-box models Models based on more

Empiricsaylsvtaelimdity: Within the model's4consstyrasinttes,mthe        o3r less justified assumptions for the cause and effect

     siminupluattioun result follows experimental data and,              inter-relationships. Often for complicated systems with-
                                                                         out stringent rules, such as ecologic systems and the
       if no observable data is available, the results are at            Predator-Prey Model.
       least consistent and plausible, and the parameter
                                                                         Dseyscsrtipetmive bmooduenlsd, balrayck-box models Models generated
     radnigsetsuarrbeaenmcpeirsiczally justified.
Application validity: The mosdyelsftuelmfilssittsrpuucrtpuorse afn(xd)   on the basis of data without system knowledge. Typically
                                                                         input-output relationships, as illustrated in Figure 6.
       can be applied to make decisions, to control pro-
       cesses etc.

1.4  Model rclassificateion      u                       y                            u black box y
Usually you do not have to reinvCent a modelinxg strategy.
Often  you  can  +use  previous  procedures  and  apply  these          Figure 6. The black-box concept. We know little about
                   -                                                    the system, but we can learn from the input u - output y
to your proble+m of interest. How often which method                    behavior.
type is used can be seen in Figure 3. The spectrum of

some methods in systems biology can be seen in Figure

4. Mathematical approaches are listed in Figure 16 in

the section on mathematical basics. Here, we give an

overview on model types. This section is based on the

same textbook [5].

Mathematical structure

We can distinguish the following contrasting pairs:

Static or dynamic models: Dynamic models change over
time. Static models are time-independent or are in the
steady state of a dynamic model. The time can be con-
tinuous or discrete.

Discrete or continuous models: If the variable values can
be counted, one is dealing with a discrete model. See
Figure 5 for an illustration of continuous and discrete sig-
nals in time and state. Each class requires fundamentally
different modeling strategies. Discrete models require
methods of graph theory and the theory of finite-state
machines. Continuous models require higher mathe-
matical models of calculus. However, it is possible to
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                                               6/36
                                                  Physical length scales

MeldModel Cclassification                                                     Molecular Protein                        Network           Cellular     Population

                                                                                                                                                                       Boolean networks
                                                                                                                                                                       Molecular dynamics

                                                                                                                                                                       Algebraic equations
                                                                                                                                                                       Differential equations
                                                                                                                                                                       Markov models
                                                                                                                                                                       Boolean networks
                                                                                                                                                                       Differential equations

Rule-based                                                                                                                                                             Cellular automata
                                                                                                                                                                       Agent-based models
                                                                                                                                                                       BioNetGen

                                                                                                                                                                       Cellular automata
                                                                                                                                                                       Agent-based models
                                                                                                                                                                       BioNetGen

                                                                                                                                Number of Hits 0              334 n/a

Figure 3. Model types: Number of PubMed `hits' of a model class for a given biological problem. Adapted from [8].

Copyright  2016, Elsevier Ltd.

                                                     Influences and connections                           Information flow      Mechanism and structure

                               Abstract & empirical  Larger                                               Network Size                             Smaller    Specified & mechanistic
                                                     Broad                                                Data required                            Focused

                                                     Less                                                 Mechanistic Insight                      Greater

                                                     Easier                                               Calibration                              Harder

                                                     Little                                               Prior Knowledge                          Extensive

                                                                Partial Least                                Bayesian          Boolean   Fuzzy Logic  Kinetic (ODE)
                                                     PCA Squares Regression (PLSR)                           Networks          Networks  Models       Models
                                                     Multiregression

Figure 4. Spectrum of modeling methods: Reproduced picture from source: [9]. Licence: CC BY-SA 4.0

                                                             interpolate      sampling

                               continuous in time                                       discrete in time

smoothing                   x                        continuous signal     x  discrete-time signal
       continuous in state
                                                                        t     1 234                       k

                                                                              or 1 2 3

sampling                    x  discrete-event signal                       x            digital signal
        discrete in state
                                                                        t                                 k
                                                     events

Figure 5. From continuous to discrete time intervals and
discrete states.
                                                                                                                                      Chapter 4: Physical modeling and non-linear enzyme kinetics -- 7/36

       1.5  Akaike Information Criterion                                                                                                                                          With the following correction:

      "Whenever a theory appears to you as the only possible                                                                                                                                                 2k2 + 2k
      one, take this as a sign that you have neither understood                                                                                                                          AICc = AIC +
      the theory nor the problem which it was intended to
768 Systesmos lbvioleog,y" said Karl Popper. Therefore, we usually have                                                                                                                                      n-k-1
      several candidate models and ask ourselves which model
      might be the best. A scheme is shown in Figure 7.                                                                                                                           you increase the impact of the parameters. A large sam-
                                                                                                                                                                                  ple size n can reduce the impact of this correction factor.
Figure 1                                                                                                                                                                          For those of you who want to learn more, there is also the
                                                                                                                                                                                  Bayesian Information Criterion (BIC), the Takeu-chi's
                    1.5                          Data                                                                                                                             Information Criterion (TIC), and the Widely Applicable
                       1                                                                                                                                                          Information Criterion (WAIC) [10]. The model selec-
          Species X                                                                                                 Hypothesis                                                    tion can thereby depend on the experimental design [11].
                    0.5                                                                                             generation                                                    Minimizing the AIC is effectively equivalent to maximiz-
                       0                                                                                                                                                          ing entropy in a thermodynamic system according to the
                           2              t   4        6                                                                                                                          second law of thermodynamics.
                   -0.5
                     -1

                   -1.5
                        0

                                          M1                                   M2                                   M3

                     1.5                                             1.5                                       1.5

                     1                                               1                                         1                                                                  1.6  Extensive properties & SI units
                                                                                                                                                                                  Besides continuous macro-scale and stochastic micro-
          Species X  0.5                                  Species X  0.5                            Species X  0.5

                     0                                               0                                         0

                     -0.5                                          -0.5                                      -0.5                                                                 scale thermodynamics, we have to differentiate between

                     -1                                              -1                                        -1                                                                 extensive quantities5 and intensive quantities, if it comes

                     -1.5                                          -1.5                                      -1.5

                           0 2 t 4 6 0 2 t 4 6 0 2 t 4 6 to transporting from one system to another. Intensive

                                                                                                                    Model complexity quantities such as temperature, concentration, pressure,

                                                                          Model ranking                                                                                           and density are independent of the system size or amount

                                                                          f (M2) > f (M3) > f (M1)                                                                                of material. Thus they cannot be physically transported

                                                                          Model selection                                                                                         through a system boundary. Extensive quantities, how-
                                                                                                                                                                                  ever, are defined quantities whose magnitude is additive

                                                                               M2                                                                                                 for subsystems, according to the International Union

                                                                                                                    Current Opinion in Biotechnology of Pure and Applied Chemistry IUPEC. Around 30 ex-

Model selecFtioinginusyrsetem7s.anMd synothedticebilolosgey. Tlhee cfirsttisotepnin:anWy moedelglingetnaskeisrtoagteenerdateihfyfpoethreesesn(wthihchymipghtobetihnfoerm-ed by atseet onf sive quantities are listed in Table 1 and are grouped
observations, or derived from fundamental biophysical principles) in an attempt to explain a given biological process. These are then formalised and

represented as a set of candidate mathematical models, fMigi1 n . The different models may be of              varying complexities,  and the process  of  moadecl cording           to  their  relationship      to  mass.

      ses and select the best-balanced model.                                                                  Model M                 is too
selection requires us to find models that are of sufficient complexity to explain the observed behaviour, while avoiding ov1er-fitting. There are a variety

of ways of ranking models, and in the present article we consider likelihood based approaches and Bayesian methods, as well as touching upon a
variety of msodieml (in)pvallideatiotnoanmd chiemckingicprorceeduarelsitthayt ca(nnbeoustedetonaosseussgwhhethper aa mroademl is egotode(rrasthe)r .thaMn beottedr theanla given
competitor). On the strength of a ranking, it might be possible to select a single best candidate, which may then be further tested and refined.
       M3 fits the noise rather than the underlying system and The old SI units (International System of Units) in Figure
       is thus not robust (too many parameters, overfitting). 8 are currently under reformulation. We mention the
data. Under these conditions, the ratio of the maximum improvement is significant. By calculating p-values under
log likelihMoodos dof ethle Mmod2elsries appprreoxsimeantetlysdaistgriboutoedd fitth.e aSpporouprriacteec:hi[-s1qu0ar]e.d dCistoribpuytiorniigt ihs thten possnibelewest proposals:
as a chi-squared distribution,                                                 to use classical hypothesis testing to determine if the null
      ㈒ 2013, Elsevier Ltd.
                                                                               model can be rejected.                                                                             Definition 2. Second: The second, symbol s, is the SI
       lu ; y
2log  1                   $ xn2 2 픫1 ;                                  (1)
       홯u2; y

                                                                               This approach becomes fragile or clumsy when consider-
with degrees of freedom n2  n1, where n1 and n2 are the ing multiple, and especially non-nested moudenls,it of time. It is defined by taking the fixed numerical
number of freeAparcamoemtersmanod nu1;luy2 aurestheedmadxiemcumisioInM =to{Mo1,l.f. o., rMnt}.hTehemn oonde peolsssibeleleapcp-roach vis atolue of the caesium frequency Cs, the unperturbed
likelihoodtiopanramiestetrheestimAatkesafiokr emIodneflso1rmandat2i,oncoCmprairteetrheiomnby(aAsseIssCing),thaemamoounntgosf tinformation
respectively. For two nested models the more complex lost in approximating the true data generating mechangisrmound-state hyperfine transition frequency of the cae-
model wioll talhwaeyrs bseiambleitloabrettcerreixtpelariniath.e oTbsherevedAICwithtaeakchemsodienl,tuosincg moenthsoidds freomraintfioormnation theory.
data, so a statistical test is required to determine if the Of course we do not typically know the true msodieul m 133 atom, to be 9192631770 when expressed in the
       the goodness of fit L^ and the number of parameters k:                                                                                                                     6             -1
                                                                                                                                      www.sciencedirecut.conmit Hz , which is equal to s .
Current Opinion in Biotechnology 2013, 24:767-774

              AICi = 2k - 2 ln(L^ ).                                                                                                                                              Definition 3. Meter: The meter, symbol m, is the SI unit
                                                                                                                                                                                  of length. It is defined by taking the fixed numerical
       The model with the minimal AIC should be preferred.                                                                                                                        value of the speed of light in vacuum c to be 299792458
       This criterion says nothing about whether a model is                                                                                                                       when expressed in the unit m  s-1, where the second is
       good or bad. It simply says that a model is capable                                                                                                                        defined in terms of the caesium frequency Cs.
       of generating behavior in line with data. The relative
       likelihood of a subordinate model i to the minimal model                                                                                                                   Definition 4. Kilogram: The kilogram, symbol kg, is the
       AICi can be calculated with:                                                                                                                                               SI unit of mass. It is defined by taking the fixed numerical
                                                                                                                                                                                  value of the Planck7 constant h to be 6.62607015  10-34
              exp((AICmin - AICi)/2)
                                                                                                                                                                                      5 Most textbooks use the term "extensive properties"; however, this
       For small models, the AIC might point to models with                                                                                                                       term is impure in this context because properties like color are not
       too many parameters. The model is overfitting then. It                                                                                                                     quantitative, and some extensive quantities such as heat and work are
       means that you fit noise instead of the model dynamic,                                                                                                                     not properties [12].
       which increases the likelihood of giving false predictions.
                                                                                                                                                                                      6 German physicist Heinrich Rudolf Hertz (1857--1894).
                                                                                                                                                                                      7 German theoretical physicist Max Karl Ernst Ludwig Planck
                                                                                                                                                                                  (1858--1947).
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                        8/36

Table 1. Extensive properties: This table gives you a feeling for different extensive properties. You do not need
to learn this by heart--you simply need to understand the principle. Z: extensive property. m: mass. z: intensive
property.

Symbol Quantity               Unit        Conditions Formula                           Notes

                                                                     (Z/m = )

Z1                                        proportional to mass

m     mass                    kg          nonea                      m/m = 1           g = 9.81 m s-2
Fgb   weight                  J m-1
Z2                                        g constant Fg/m = g

Cp            proportional to mass under constant composition (Z/m = k), else Z2 = Z3,c
n
VSL   heat capacity           J K-1       ni constant                Cp/m = cp         cp = specif c heat cap.
N     amount of substance     mol         ni constant                n/m = 1/M         M = molar mass
                              m3          ni constant                VSL/m =            = density
Z3    volume (solid, liquid)  -           ni constant
      number of particles
Ek
Eg               mass is constant of proportionality, or conditional proportional (Z/m = z)

p     kinetic energy          J                                      Ek/m  =  12       v = velocity
Fb    gravitational           J
U     energy                                                                  2v       h = height,
G     momentum                kg  m s-1                             Eg/m = gh
      force                   J m-1                                                    g = 9.81m/s2
H     internal energy         J                                      p/m = v
S     free enthalpy           J                                      F/m = a           v = velocity
VG                                                                   U/m = u(T)
V     enthalpy                J                                      G/m = g(T,p)      a = accelaration
      entropy                 J K-1                                                    T = temperature
Z4    volume (gas)            m3                                     H/m = h           g = specif c free
      volume                  m3                                     S/m = s           enthalpy
A     (all phases)                                                   VG/m = M.vG(T,p)  h = specif c enthalpy
Eel
Esp                                                                  V = VSL + VG      s = specif c entropy
Epv
Esur                                                                                   vG = molar volume
i
P                             extensive quantities independent of mass
Q
q     area (interface)        m2                                     -                 k = spring constant
W     electric energy         J                                      -                 p = ambient pressure
                                                                     Esp = 12 k.x2      = surface tension
      spring energy           J                                      Epv = p.V
d/dt  displacement energy                                            Esur = .A         -
      surface energy          J                                      -                 -
                              J
      current (electric-)     C s-1                                  -                 -
                              J s-1                                  -                 conjugate to aff nity
      power (most forms)      J                                      -
      heatt                   C                                      -
      charge (electric)       J
      work                    eqd                                    -
                              eq s-1 d
      extent of reaction      kg s-1                                 -

      reaction rate                                                  -

      f ow (f uid)

      total quantities = 29 total

when expressed in the unit J  s, which is equal to kg              fixed numerical value of the elementary charge e to be
m2  s-1, where the meter and the second are defined in              1.602176634  10-19 when expressed in the unit C, which
terms of c and Cs.                                                   is equal to A  s, where the second is defined in terms of
Definition 5. Ampere: The ampere,8 symbol A, is the                  Cs.
SI unit of electric current. It is defined by taking the
                                                                     1836).
    8 French physicist and mathematician Andr-Marie Ampre (1775--
                      Arrowp1, p3, 1.05, 1.2,                                                                              Arrowp6, p3, 1.05, 1.2,
                      Arrowp1, p5, 1.05, 1.2                                                                               Arrowp6, p4, 1.05, 1.2
                     ~ Join ~                                                                                              ~ Join ~ 
                      Arrow{q[#], p[#]}, 1.05, 1.2 & /@ Range0, 6                                                          Arrow{q[#], p[#]}, 1.05, 1.2 & /@ Range0, 6
                    ,
                GraphicsTextStyle"Old SI", Bold, 30, 0, 10                 Chapter 4: Physicalm,odeling and non-linear enzyme kinetics -- 9/36
              
              , ImageSize  500                                                                                        GraphicsTextStyle"New SI", Bold, 30, 0, 10
                                                                                                                    
                                                                                                                    , ImageSize  500
                                Old SI                                                                            

                                                  Cs                                                           New SI

                                                                                                                                            Cs

                    c s MIPK                                                                cs h

                            m                      kg                                           m          kg

    Out[6]=                                                                Out[13]=

                      A                          mol               m(12C)                    A             mol

             0                           cd                                          e                                               NA

                             K                                                                      K  cd

                            TTPW                   Kcd                                          kB         Kcd

Figure 8. Old SI units: s: second, kg: kilogram, mol: Figure 9. Proposed SI units: s: second, kg: kilogram,
    In[7]:= Export                                                         In[14]:= Export
mole, Fcidle:NamceJaonindNeoltaeb,ooKkDi:rekcteolrvy[i]n, ",UnAit:realmatipones rien .themol:d SmI.sevgt"er,. oldSIm; ol: mFiolelNea,mecJdoi:ncNaotnedboeoklDair,eKcto:rky[e],lv"Uinnit, rAel:ataiomnspien rtehe. nmew :SIm.svegt"er,.newSI;
Source: Wikipedia, Emilio Pisanty, 2016, Licence: CC Source: Wikipedia, Emilio Pisanty, 2016, Licence: CC
BY-SA 4.0.
                                                                           BY-SA 4.0.

Definition 6. Mole: The mole, symbol mol, is the SI                        unit J  K-1, which is equal to kg  m2  s-2  K-1, where the
unit of amount of substance. One mole contains exactly                     kilogram, meter, and second are defined in terms of h, c
6.02214076  1023 elementary entities. This number is the                  and Cs.
fixed numerical value of the Avogadro constant,9 NA,                       Definition 10. Candela: The candela,13, symbol cd, is
when expressed in mol-1, and is called the Avogadro                        the SI unit of luminous intensity in a given direction.
number (IUPEC, 2018, [13]).                                                It is defined by taking the fixed numerical value of the
                                                                           luminous efficacy of monochromatic radiation of fre-
Definition 7. Amount of substance: The amount of                           quency 540  1012 Hz, Kcd, to be 683 when expressed in
substance, symbol n, of a system is a measure of the                       the unit lm  W-1, which is equal to14 cd  sr  W-1, or
number of specified elementary entities. An elementary                     cd  sr  kg-1  m-2  s3, where the kilogram, meter, and
entity may be an atom, a molecule, an ion, an electron, or                 second are defined in terms of h, c and Cs.
any other particle or specified group of particles (IUPEC,                 With this new SI set, the relationships between the SI
2018, [13]).                                                               units might change according to the scheme in Figure 9.

Definition 8. Dalton: The 1971 definition of the mole                         13 From candle.
                                                                              14 sr: The steradian or square radian is the SI unit of solid angle.
implies that the Avogadro number equals the ratio of the
gram to the Dalton10 (mu = 1 u = 1 Da), with the value of

the Dalton (Da) expressed in grams. The historical conti-

nuity of the present definition preserves this relation, not
exactly, but to within an uncertainty 10-10 negligible for

practical purposes (IUPEC, 2018, [13]). The relationship

of Dalton to the Avogadro constant might be redefined
                                      g   mol-1.
to  a  scaling      factor  NA    =  Da

Definition 9. Kelvin: The kelvin,11 symbol K, is the
SI unit of thermodynamic temperature. It is defined
by taking the fixed numerical value of the Boltzmann12
constant K to be 1.380649  10-23 when expressed in the

    9 Italian scientist Amedeo Carlo Avogadro (1776--1856).
   10 English chemist, physicist, and meteorologist John Dalton (1766--
1844).
   11 Scots-Irish mathematical physicist and engineer William Thomson
Kelvin (1824--1907).
   12 Austrian physicist and philosopher Ludwig Eduard Boltzmann
(1844--1906).
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                 10/36

1.7  Balancing                                                   3     
After this detailed introduction to modeling concepts             [  ] ;  [3]
and other relevant background information, we are now
coming back to the question on how to formulate mathe-                          []
matical models of biological systems. We will introduce
the approach of balancing here, which is an extension of
the ODE equations derived for biochemical reactions in
the previous chapters. The general concept of balancing
for describing system behavior over time is:

  temporal change     = + inflow  - outflow            + source                              3
  of state variables
                                                                                                
- sink                                                                                     [  ] ;  [3]

Inflows and outflows are exchanges across the system             Figure 10. Mass balance of a liquid container.
boundary. In contrast, sources and sinks are system
internal processes.                                               Example 2: Mass balance
Continuous changes are described with differential equa-
tions.                                                           The mass balance of a liquid container is as shown
                                                                 in Figure 10:
       d 
            == J+P                                                                                               kg
                                                                        m = qin  in - qex  ex s
        dt

                             Rates of change

In a (time) discrete form this would be:

   = (t + 1) - (t) = J + P                                        Example 3: Volume balance

                                           Changes               The volume balance can be derived from the mass
                                                                 balance:
   (t + 1) = (t) + J + P
                                                                        m = ( 톅 ) =  톅 +  톅 =  톅
Example 1: Population balance
                                                                 with the product rule, and with the assumption
A continuous population balance with population                  that the density is constant and does not change
size N [-].                                                       = const.

N =+   immigration emigration-                      +  birth  -          = 0

                      rate        rate                 rate

death                                                            Example 4: Amount of substance balance
 rate

                                                                 The amount of substance balance is a type of mass
                                                                 balance which is especially suited for chemical reac-
                                                                 tions. It is also known as mole balance. The change
                                                                 of the amount of substance is n with the unit mols .
                                                                 The rate constant is k and can have different units.
                                                                 Let us look at the following reaction:

                                                                               k

                                                                 A + B -- P
                                                                 with the balance equation:

                                                                        -nA = -nB = nP = k 텰A 텰B 톅

                                                                 The unit calculus is

                                                                    mol = X  mol  mol  l
                                                                    s                  l  l
                                                            Chapter 4: Physical modeling and non-linear enzyme kinetics -- 11/36

    The missing unit X for the rate constant k is there-                     k1
            l
    fore  s톗ol  . Remember: nA = CA 톅                        A + B ---- P      dnA  =  -k1  cA  cB 톅  + k-1  cP 톅
                                                                                  dt
                                                                            k-1
           nA = (CAV ) = CAV +CAV = CAV                                     k1        dnA  =  -k1  cA  cB 톅  + k-1  cP  cS 톅
                                                                                       dt
                                                               A + B ---- P + S
    with the product rule and constant volume V =
    const:                                                                 k-1

           V = 0

    We moreover obtain the following relationships:

           -nA = -CA 톅 = k 텰A 텰B 톅

                              CA = -k 텰A 텰B

    .
        We might also point to the rate of mole change:

            ni = q  ci

           mol        m3 mol
            s = s  m3

Some useful equations
The molar mass is:

       Mi = mi = i  mi = Mi  ni
               ni ci

The mass flow m i        kg   is:
                         s

         m i = q  i

with volume flow rate q sm3 and mass density  m3 kg .

The molar flow ni        mol  is:
                          s

         ni = q  ci

with volume flow rate q sm3           and molar concentration

ci  mol   . The conversion is:
    m3

        m3 mol = 10-3 mol L = 10-3M = 1mM
with the unit molar M and millimolar mM.

Reactions

We repeat some reactions and their respective balance

equations:

      k1         - dt dnA = dt dnP    dnA dt = -k  cA  V

A -- P

      k1         dnA  =  -k1  cA 톅  + k-1  cP 톅
                  dt
A ---- P

     k-1
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                                                                           12/36

1.8  Enzyme kinetics                                                                                                                                                                               concentrate on the enzyme kinetic for biochemical net-
                                                                                                                                                                                                   works. In Systems Biology, we are often more interested
Enzymes are very important proteins and good drug                                                                                                                                                  in the interplay of an enzyme with other molecules and
targets. For example, the BRAF kinase15 can be inhib-                                                                                                                                              the role of an enzyme in a network. We might thereby
ited by the drug dabrafenib. Dabrafenib in turn can be                                                                                                                                             ignore the chemical complexity as well as the structural
degraded by another enzyme class named cytochrome                                                                                                                                                  geometry of the enzymes and ask e.g. only the following
P450. The CYP450 enzyme class accounts for 75% of                                                                                                                                                  questions:
drug metabolism and five of the 57 human CYPP450s
are involved in 95% of these reactions [14]. Enzymes                                                                                                                                                    Which molecules can bind the enzyme?
are sometimes very unspecific and share similar targets.
Thus when an enzyme is inhibited, this can result in                                                                                                                                                    Which molecules will be released?
undesired off-target effects also on other enzymes. Have
a look at the phylogenetic tree of the human kinome in                                                                                                                                                  Which molecule-enzyme affinities appear?
Figure 11.
                                                                                                                                                                                                        Is the binding reversible?
                                                       TRKC FGFR2 FGFR3
                                                                                                                                                                                                        Does the molecule inhibit or activate the enzyme
                                  TRKB                        FGFR1         FGFR4                                                                                                                         function?
                                                                            FLT1
          EphB1                                        TRKA   ROR2ROR1                                                                                                                                  Does the molecule bind the catalytic side or an
EphA5                                                              MERRET       KDFRMS                                                                                                                    allosteric side?
EphA3                                                  DDR2        AXL                 KIT
                                                       DDR1                                                                                                                                             Is the enzyme specific?
      EphA4                                            IGF1R                  FLT4
                                                                                FLT3PPDDGGFRFRa b                                                                                                  YouTube: Enzyme kinetics series (7 videos by Khan
       YES                                                          MET              EGFR ErbB2                                                                                                    Academy)
      SRC
 LYN                       EphA7                         ROS                      TIE2TIE1                                               MLK1                                                      The reaction from substrate to product is usually pro-
HCK                   FYN                              ALK                  RYK                                                                                                                    moted by enzymes. Enzymes split the reaction into less
      LCK                                                                                                                                                                                          energy-intensive subreactions and thereby have a bind-
                          FGR                                 CCK4                      ErbB3  ErbB4                                                                                               ing phase and a catalytic phase, as shown in Figure 12.
                                                                                               JAKJA1K2                                                                                            You learned in Chapter 2 that we can model biochemical
TK BLK                            EphA2                                                                                                   TKL                                                      networks with the stoichiometric matrix:
                                                                                                      JAK3
                                                                                                         ANKRD3                      LZK                                                                  S = N  v

                   ITK                                        FAK                              LMR1                                                                                                which we often scrutinize in the steady state (dynamic
         TXK                                                                                                                                                                                       equilibrium) with:
                                  FRK                                                                                                RAF1       TGFbR1
            BTK                   SRM                                                                                                     BRAF                                                            0 =N 톢
                                  BRK
                                                                                                                                                BMPR1B                                             The non-trivial solution gave us the fluxes and interest-
                                                                                                                  LIMK1                                                                            ing properties such as dead ends, linear paths, and the
                      AABBLL21                                                                                         LIMK2ILTKAK1      ALK2                                                      kernel matrix K. We repeat the balancing of a biochemi-
                                                                                                                             TESK2                                                                 cal reaction in Example 5. In this section we will focus
                                                                                                                                         ACTR2B                                                    on the reaction vector v.
                                                                                                   IRAK2                             TGFbR2
                                                                  JAK3_b                                 RIPK1                           MAP3K2                               STE
                                                                JAK2_b                                            LRRK2              BMPR2
                                                              JAK1_b             SuRTK106                                                           MAP3K5                   MST1
                                                                                                                                                                           KHS2MST2
                                                                                               SgK496                             Wnk1
                                                                                                  PBK                                                                                     HGK
                                                                                                                          MAP3K1                                                    TNIKMINK
                                                                                                 MLKL              Wnk4

         HIPK1          HIPK3     PRP4                           PKR                                                                                           SLK
         HIPK2        CLK1                                                                               NIK
                                                                                   SCYL2
CMGC SRPK2                                                       IRE1                                                    MYT1                                 MAP2K1
                                                                  RNAseL                                                                                     MAP2K2
            GSK3B                                                                                                Haspin                                   MAP2K3
                                                                  TTK                                                                Wee1MAP2MKA4P2K6
                                                                   KIS
                                                              CK2a1 CDC7                                                                              TTBK2

          CDKL5                                                                                                                                     CK1g2
         NLK
                                                                                                         Slob                                                       CK1

Erk2                                                                IKKb                                                               BUB1            VRK1                     GPRK5
   p38b                                                                                                                        BUBR1
         JNK1         CDK10                                                      MPSK1                                   PLK4                       PLK3
         CDK4                                                                                                                                       PLK2
          CDK6                                                                                                                                PLK1

                                                                           ULK2

PCTAIRE2              CRK7CHED                                        NEK7                     LKB1                                                    MSK1                      RSK3
            PCTAIRE3                                            NEK9                           CHK1                                      LATS2 PKG1                           RSK4RSK2
                                                             NEK2                                                                                                          RSK1        AKT2
             CDC2                                      NEK11                                             AurA                                                                 AKT3 AKT1
         CDK2                                                                                                    AurB                                                                  SGK1
                                                                                                                                                                                       SGK3
                                                                  Trb3      PIM1 PIM2                                       YANK1
                                                              Trb2                                                                MASTL
                                  NEK1                         Trb1                                                              YANK2                                           PKCh

                                                                            Obscn

                                                                                   Trio                                                                             PKACb
                                                                                   Trad
                                  ADCK3                             smMLCK                                                                                                                   PKCa
                                                                                                                                                                    ROCK2              PKCb
                                                                                                                                    MAST4 CRIK
                                                                 DRAK2                             NIM1                                  DCAMKL1                           AGC
                                                                  DRAK1
                                                ChaK2         DAPK3 DAPK1                               PKD1             CaMK2g                                        MRCKb
                                AlphaK3                                                        MELK PKD3                            CaMK4                           MRCKa

                                            AlphaK2                                AMPKa2                MAPKAPK3
                                                                                    AMPKa1
                                         BRD3                                                            CAMK
                                             BRD4                                          NNuauKaK21
                                                                                             QSK
                                 PDHK2
                                  PDHK1                                                    SIK

                                        PDHK4

                                                ATM
                                                ATR

                                   DNAPK
                                       SMG1
                                       TRRAP

         RIOK3

                      TIF1a
                      TIF1g

                                                              "Illustration reproduced courtesy of Cell Signaling Technology, Inc. (www.cellsignal.com)"

Figure 11. Kinase tree: The maps shows the phylogenetic
tree of the human kinome using the KinMap software.
Sky-blue annotations are kinases which are melanoma-
specific. Red dots indicate kinases for which drugs are
available. Source: [15], Licence: CC BY-SA 4.0.

    Chemoinformatics can analyze the molecular struc-
ture of both enzyme pockets and drugs together. 3D
pockets of key targets and off-target kinases thereby al-
low the design of more specific drugs [16]. This helps us
to predict off-target effects, enzyme-drug affinities, and
support the improvement of drug structures. We will

   15 Kinases catalyses the transfer of the phosphate group to specific
substrates. The opponent is the phosphatase.
                                     Chapter 4: Physical modeling and non-linear enzyme kinetics -- 13/36

                                                                 the concentration of reactants to the power of molecu-
                                                                 larity (stoichiometric coefficient). Refer once again to
                                                                 Example 5. The net rate of the product is:

                                                                        v = v f - vb = k1  S1  S2 - k-1  P2

                                                                 with the related unit calculus:

                                                                 mol = L mol mol - L                              mol 2
                                                                 L톝            mol  s L         L      mol  s   L

                                                                 v              k1          S1    S2     k-1        P2

                                                                 The unit of the kinetic parameters ki, in the reaction
                                                                 rate v, depends on the number of reaction partners. This
                                                                 unit changes from reaction to reaction.
                                                                 The general mass action rate law for a single reaction is:

                                                                 v = v f - vb = k+1  Simi - k-1  Pjm j
                                                                                        i             j

Figure 12. Energy profile during an enzymatic reaction:          mi . . . molecularities of substrates

The bigger the energy difference, the lower the probabil-        m j . . . molecularities of products
ity of transformation to the products. Consequently, the
reaction rate is lower as well. Source: Thomas Shafee            Reactions in equilibrium =^ concentrations in equilibrium
& Smokefoot, Wikimedia, Licence: CC BY 4.0 (upper                (Seq, Peq).
figure) & CC0 1.0 Universal Public Domain Dedication
(lower).                                                         v f = vb

                                                                  Kea =                       mj

                                                                           k+1  j Peq
                                                                                =
                                                                                            mi
                                                                           k-1 i Seq

                                                                 The free energy difference of a reaction:

Example 5: Balancing a biochemical reaction                      G = -RT ln Keq

The substrates are catalyzed to form 2 product                   depends on the temperature T and the gas constant
molecules:                                                       R = 8.314 moJl텸 . The free energy is indicated in Figure 12.

                vf                                               The Law of Mass Action might result in a lot of equations,
                                                                 and simplifications are often used. These are based on
S1 + S2 ---- 2 P                                                 certain assumptions, such as those illustrated in the fol-
                                                                 lowing for the kinetic rate law of, e.g., Michaelis-Menten.
                vb                                               One standard textbook on enzyme kinetics is from Cornish-
                                                                 Bowden18 [18]. We will derive some of the kinetics and
The overall (net) reaction rate is calculated by the             will provide, at the end a summary in Table 2.
forward reaction rate v f minus the backward reac-
tion rate vb. The ODE equation set is:

S1 = S2 = - k1  S1  S2 + k-1  P2

vf  vb

P = 2 k1  S1  S2 -2 k-1  P2                                   Michaelis-Menten kinetics

vf  vb                                                           The Michaelis-Menten kinetic [19] is based on the most

                                                                 common known enzyme reaction scheme:

    The reaction coefficients v f and vb are based on the                  k1       k2
Law of Mass Action formulated by Waage16 and Guld-               E + S ---- ES -- E + P
berg17 in 1864 [17]. We say that the reaction rate is pro-                 k-1
portional to the probability of a collision of the reactants.    An enzyme E binds a substrate S to form an enzyme sub-
The probability of a collision in turn is proportional to
                                                                 strate product ES. This enzyme substrate complex can
   16 Norwegian chemist Peter Waage (1833--1900).
   17 Norwegian mathematician and chemist Cato Maximilian Guld-  break down either back to the substrate or into the prod-
berg (1836--1902).
                                                                 uct. In both cases the enzyme is recovered, as expected

                                                                   18 British biochemist Athelstan John Cornish-Bowden (1943--
                                                                 today).
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                               14/36

                                                                           with which:

Reaction rate v  1                   Almost all enzyme molecules occupied          dE = 0
                 2   Competition for enzyme molecules                              dt

                     Lots of enzyme molecules available                    is obtained. But if neither enzyme levels nor the levels of
                                                                           enzyme substrate change, there must be a total amount
                                                                           of enzyme which we can consider as a constant:

                     Substrate concentration S

                                                                           Etotal = E + ES                                     E = Etotal - ES

                     Figure 13. Michaelis-Menten kinetic.

for a catalyst. The balance equations of the reaction net-                 Putting everything together
work are:
                                                                           Reformulation of the differential equation of the enzyme
         dS                                                                substrate complex gives:
              = -k1  E  S + k-1  ES
                                                                           dES                    = k1  E  S - (k-1 + k2)  ES = 0                !
          dt
        dES                                                                                   dt

              = k1  E  S - (k-1 + k2)  ES                               k1  (Etotal - ES)  S - (k-1 + k2)  ES = 0
         dt
         dE                                                                k1  Etotal  S - k1  ES  S - (k-1 + k2)  ES = 0

              = -k1  E  S + (k-1 + k2)  ES                              and:
          dt                                                                      ES = k1  S + (k-1 + k2) k1  Etotal  S = S + k-1+k2 Etotal  S
         dP
                                                                                                                                              k1
              = k2  ES
          dt                                                               We are interested in the generation rate of the product
                                                                           depending on the substrate availability:
The overall reaction rate is:
                                                                           v = dP = k2  ES
       v = -dS = dP                                                             dt
               dt dt
                                                                           which is finally:
The substrate decrease is equal to the product increase.
The enzyme is recovered. Because our equation set can-                     v = k-1+k2 k2  Etotal  S = k + S Km + S vmax  S
not be solved analytically, we will make some assump-
tions:                                                                                     1

1.) Quasi-equilibrium assumption                                           with the Michaelis-Menten parameter Km and the max-
Michaelis19 and Menten20 stated that the forward and                       imal catalysis velocity vmax. The Michaelis-Menten pa-
backward reactions between the substrate and the en-                       rameter indicates the substrate concentration with which
zyme substrate complex are much faster than the final                      one can obtain the half-maximal reaction velocity. You
reaction to the product:                                                   will need to be able to distinguish between the parameter
                                                                           types!
       k1, k-1  k2
                                                                           Mechanistic parameters: k1, k-1, . . . (based on mecha-
2.) Quasi-steady-state assumption                                          nisms)
Briggs21 and Haldane 22 stated that if and only if the
substrate is in much higher abundance than the enzyme                                        
S(t = 0)  E, then the ES complex has constant concen-
tration levels, or more generally:                                         Phenomenological parameters: vmax, Km, . . . (based on
                                                                           systemic behavior)
        dES = 0
         dt                                                                Lineweaver-Burk plot
                                                                           Lineweaver23 and Burk24 established a linear represen-
   19 German biochemist, physical chemist, and physician Leonor            tation of the function in Figure 14 to more easily access
Michaelis (1875--1949).                                                    the parameters. This was of great importance before the
                                                                           appearance of appropriate computer programs. How-
   20 Female Canadian physician and scientist Maud Leonora Menten
(1879--1960).                                                                23 American physical chemist Hans Lineweaver (1907--2009).
                                                                             24 American biochemist Dean Burk (1904--1988).
   21 English scientist John Burdon Sanderson Haldane (1892--1964).
   22 English professor for Botany George Edward Briggs (1893--1985).
                                                  Chapter 4: Physical modeling and non-linear enzyme kinetics -- 15/36

                                                                E + S k1 ES k2 E + P
                                                                + k-1 +

                                                                I              I

                                                                k-3 k3     k-4 k4

                                                                EI + S k5 ESI k6             E+P+I
                                                                           k-5

                                                                We distinguish the following cases considering the re-
                                                                lated reaction numbers 1-6:

                                                                1,2 Michaelis-Menten

Figure 14. Lineweaver-Burk plot. Source: Wikimedia,             1,2,3 Competitive inhibition
Licence: CC BY SA 3.0.
                                                                1,2,4 Uncompetitive inhibition

ever, modern methods are available to experimentally            1-5 Noncompetitive inhibition
determine more physical parameters without the quasi-
steady-state assumption [20]. The research is still on-         1-6 Partial inhibition
going (for example, taking substrate inhibition into ac-
count [21]). Unfortunately, many publications use the           We can assume the following binding equilibria between
kinetic laws although their underlying assumptions are          the entities and the complexes:
violated--e.g. drugs might lead to enzyme induction
of the CYP450 class leading to a changing total enzyme                   k-1 E  S
concentration Etotal.                                              Km = =

Michaelis-Menten kinetic for reversible reaction                            k1 ES
                                                                   KI,3 = k-3 = E  I
The reaction scheme for the reversible Michalis-Menten
                                                                            k3 EI
kinetic is: k1 k2                                                  KI,4 = k-4 = ES  I
E + S ---- ES ---- E + P
                                                                            k4 ESI
                                                                   KI,5 = k-5 = EI  S

                                                                            k5 ESI

          k-1          k-2                                      The respective reaction kinetics are listed in Table 2.

where the product concentration changes accordingly:

     dP                                                         Substrate inhibition
v = = k2ES - k-2P  E.                                          The reaction network for substrate inhibition is:

     dt

The rate equation is:                                           E+S        ES      E+P

                                                                           +

                      q톁-P                       ; q = k1k2               S
k-1k-2 v =Etotal Sk1 + k-2 1 + k-1k-2 k2 + k-1 P        k-1k-2

      f        vb                                                               ESS
                                                                which leads to the kinetic:
    vmax        max
    K S- K P
v=  mS         mP

    1 + KmS + KmPSP

                                                                   v = k2ES =      vmaxS        ; KI = k-I = ES  S
                                                                                                        kI ESS
The phenomenological parameters are related in the fol-                        Km + S 1 + KSI
lowing way:
                                                                with the optimal substrate concentration:
                       f                                                     

               vmaxKmP                                                 S = KmKI
       Keq = b
                                                                and the optimal velocity:
               vmaxKmS
according to Haldene (1930).                                       vopt =      vmax .

General Michaelis-Menten kinetic for inhibition                            1 + 2 Km/KI
We look at the general reaction scheme:
                                                                An example for substrate inhibition of CYP1A2 (CYP450
                                                                enzyme class) can be found e.g. here [23]. The CYP450
16/36

                                                                          Table 2. Types of inhibition for irreversible and reversible Michaelis-Menten kinetics, so you can see that one needs different kinetic laws for different
                                                                          approaches. It is not necessary to learn this information by heart, but you might ponder on it for a while. Reproduced from source: [22]. Copyright  2016,
                                                                          John Wiley and Sons.

                                                                          Name            Implementation                  Equation - irreversible Equation - reversible             Characteristics

                                                                                          I binds only to free E;                                           fS     rP               Km changes, vmax remains;
                                                                          Competitive     P-release only from ES          v = vmaxS                         vmax KmS - vmax KmP     S and I compete for the binding
                                                                          inhibition                                           Km  i3 + S              v= S                        place; high S may out compete I
                                                                                          k4 = k5 = k6 = 0                                                KmS + KmP + i3P
                                                                                                                          v = vmaxS                                                 Km and vmax change, but their
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                  I binds only to ES;                  Km + S  i4                  fS     rP               ratio remains; S may not out
                                                                          Uncompetitive   P-release only from ES                                            vmax KmS - vmax KmP     compete I
                                                                          inhibition                                      v = vmaxS                     v=
                                                                                          k3 = k5 = k6 = 0                   (Km + S)  i3                1 + S KmS + P KmP  i4  Km remains, vmax changes;
                                                                                                                                                                                    S may not out compete I
                                                                                          I binds to E and ES;            v = vmaxS                         fS     rP
                                                                          Noncompetitive  P-release only from ES               Km  i4 + S  i3             vmax KmS - vmax KmP     Km and vmax change;
                                                                          inhibition                                                                    v=                          KI,3 > KI,4 : competitive-
                                                                                          KI,3 = KI,4, k6 = 0                                               1 + S KmS + P KmP  i4  noncompetitive inhibition;
                                                                                                                                                                                    KI,3 < KI,4 : noncompetitive-
                                                                          Mixed           I binds to E and ES;                                                                      competitive inhibition
                                                                          inhibition      P-release only from ES

                                                                                          KI,3 = KI,4, k6 = 0

                                                                          Partial         I may bind to E and ES;              vmaxS 1 + k2KI,3 k6텶                                Km and vmax change; if k6 > k2,
                                                                          inhibition      P-release only from ES and ESI  v=                                                        activation instead of inhibition.

                                                                                          KI,3 = KI,4, k6 = 0                     Km  i4 + S  i3

                                                                          Abbreviations: KI,3 = kk-33 , KI,4 = kk-44 , i3 = 1 + KII,3 , i4 = 1 + KII,4
                                                                        curve may be fitted by an Adair-Klotz equation with four parameters.                                             ble qual
                                                                                                                                                                                         underdete
                                                                        Therefore, any model implying more than four parameters is obviously                                             obtain a p
                                                                                                                                                                                         least 15 p
                                                                        an underdetermined system and some assumptions have to be made on                                                generic fo
                                                                                                                                                                                         responds
                                                 parameters.                                                                                                                             to the the
                                                                                                                                                                                         for such a
                               Chapter 4: Physical modeling and non-linear enzyme kinetics -- 17/36                                                                                      models, li
                                                                                                                                                                                         complexit
                                                     For the cooperative model used by Crouch and Klee, the number of                                                                    alized and
                                                                                                                                                                                         extraction
                                                                        degrees of freedom is reduced by assuming that calmodulin has two                                                can be un
                                                                                                                                                                                         well as a g
                                                                        strong sites with a high binding affinity for the calcium ions and two                                           system. In
                                                                                                                                                                                         for the sec
enzyme class is unspecific and thus sensitive to substrate              weak sites with a low affinity. The affinity of the two latter sites increase                                    under stu
inhibition. Another consequence might be a drug-drug                                                                                                                                     Such pert
interaction where another drug is processed by the same                 Table 3. Calmodulin model. Different approaches to                                                               concentra
enzyme as the main drug. This is why we talk about                                                                                                                                       reporter g
perpetrator and victim drugs--because of the influence                  model cooperativity with and without simplifying as-
of the pharmacokinetics over the other drug.                            sTuabmle 3ptions. Source: [24]. Copyright  2014, Elsevier                                                           In all c
                                                                                                                                                                                         majority
                                                                        Comparison of actual and effective (after assumptions) number of parameters for the

                                                                        Bdi.ffVer.ent approaches modeling calcium binding to calmodulin.

                                                                        Model                       Actual number                Effective number
                                                                                                    of parameters                of parameters
                                                                                                    (generated by framework)     (after assumptions)

Cooperative enzymes                                                     Induced fit (generic)       15                           15

Regulatory enzymes often have more complicated ki-                      Cooperative model           15                           5
netics and their sub-units display cooperative behavior.
Cooperativity is the property whereby an enzyme can                     (strong and weak sites)
have a steep dependence on the substrate or inhibitor
[18]. The positive25 homotropic26 cooperativity can be                  Sequential                  15                           4
formulated on the following base for a dimeric enzyme
E2 [22]:                                                                Allosteric                  31                           7

          E2 + S -- E2S                                                 Macroscopic                 4                            4

                           slow                                         Hill's equation             2                            2

         E2S + S -- E2S2                                                The kinetic dependence on the Hill coefficient is visual-
                                                                        ized in Figure 15.
                            fast
                                                                               1
Because the second reaction is faster, one can assume
that we have complete cooperativity. This means that                                                            h=9 h=7          h=5
the dimeric enzyme is either empty or full:
                                                                        0.9
         E2 + 2 S -- E2S2
The binding constant:                                                   0.8
                                                                                                                                                                   h=3
       KB = E2  S2 E2S2
                                                                        0.7
represents the equilibrium of concentration levels, and
the fractional saturation of the enzyme is:                             0.6

                                                                        0.5

Y=  2E2S2    =        KBS2                                              0.4 h=1
                                                                        0.3
    2E2,total 1 + KBS       2
                                                                                                                                                                               h=0.5
                                                                        0.2

However, this Hill27 equation should be written with the                0.1
parameter h (no integer) instead of n

                                                                               0

h < 1 First ligand reduces affinity for the second ligand                           0          0.5      1  1.5                2       2.5                                             3

                                                                                                           Substrat S

h = 1 Quasi Michaelis-Menten                                            Figure 15. Hill kinetic. Factural saturation Y with KB =
h > 1 First ligand increases affinity for the second ligand             0.3 and different Hill coefficients.

It is incorrect to treat h as an estimate of the number of              The Hill equation is a pseudo-mechanistic equation which
substrate-binding sites on the enzyme, though for some                  Hill himself saw as purely empirical. However, the use
models it does provide a lower limit for this number [18].              of the cooperativity index Ra of Taketa and Pogell is more
Hemoglobin has 4 sub-units with a lower Hill coefficient,               empiric (experimentally meaningful) as it focusses on
h = 2.7. Thus we reformulate our equation to:                           the 10-90% range of full activity. A mechanistic formu-
                                                                        lation is the Adair28 equation, which is most often used
Y=  KBSh                                                                for positive cooperativity in practice. Moreover, we have
                                                                        the allosteric model or symmetric model293031 with the
    1 + KBS  h                                                          assumption that the subunits of cooperative oligomeric
                                                                        proteins are independent of the ligand and all sub-units
We assume that the fractional enzyme saturation scales                  are in the same conformation at any time, while the se-
with the substrate turnover:

v = vmax  KBSh

          1 + KBS  h

   25 Ligand facilitates binding of the next ligand. h > 1.               28 British protein scientist Gilbert Smithson Adair (1896--1979).
   26 Homotropic means that the allosteric modulator is the substrate.    29 French biochemist Jacques Lucien Monod (1910--1976). Nobel
When the modulator is not the substrate it is called heterotropic.      Prize in Medicine for genetic control of enzyme and virus synthesis.
   27 English physiologist Archibald Vivian Hill (1886--1977). Nobel    Lac-operon-model.
Prize in medicine for his work on physical properties of muscles in       30 American biologist and biophysicist Jeffries Wyman (1901--1995).
1922.                                                                     31 French neuroscientist Jean-Pierre Changeux (1936--today).
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  18/36

quential model32 considers ligand-induced changes in
a sub-unit with possible consequences to others. Thus,
the sequential model assumes that sub-units show in-
dependent conformations in contrast to the allosteric
MWC33 model. Monomeric enzyme can show kinetic
cooperativity if the different conformational states relax
slowly. The section is based on the textbook found in
[18]. Table 3 might give an impression of the model sizes
for reflecting cooperativity.

   32 American biochemist Daniel Edward Koshland Jr. (1920--2007).
Together with G. Nmethy and D. Filmer in 1966.

   33 Author names: Monod-Wyman-Changeux.
                                                                 Chapter 4: Physical modeling and non-linear enzyme kinetics -- 19/36

Wolkenhauer  2. Basics of Mathematics                                                                                                  Why model?

We have a collection of mathematical methods to help us tackle biological questions. They are listed in Figure 16.
                                        We recommend this review for further reading [25].

Figure 16. Mathematical analysis approaches. More information and source: [25]. Copyright  Frontiers Physiol,

LiFcIGeUnRcEe:1 C| ACnsBwYer-inSgAb4io.l0o.gical questions through mathematical  but little more than establishing a difference is possible. At the other end

analyses. The table illustrates a selection of approaches available in           of the spectrum models of dynamical systems allow investigations about

systems biology. In practice, the vast majority of questions in                  causal mechanisms underlying complex interaction networks. These very

experimental biology concern "differences." Given that experimental              powerful explanatory models do however require sufficiently rich

observations vary, statistical testing will establish the significance of a      quantitative time course experiments, which in many cases are

difference. The experiments for this type of question are easy to conduct time-consuming, expensive and technically more challenging.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  20/36

                       References                                 Stohner. Definition of the mole (iupac recommen-
                                                                  dation 2017). Pure and Applied Chemistry, 90(1):175-
 [1] Sartre Jean-Paul. La nause. 1938.                           180, 2018. https://doi.org/10.1515/pac-2017-0106.

 [2] Gregor Nickel, Markus Helmerich, Ralf Krmer,           [14] F Peter Guengerich. Cytochrome p450 and chemical
     Katja Lengnink, and Martin Rathgeb. Mathe-                   toxicology. Chemical Research in Toxicology, 21(1):70-
     matik und Gesellschaft: Historische, philosophische          83, 2007. https://doi.org/10.1021/tx700079z.

     und didaktische Perspektiven. Springer-Verlag, 2018.    [15] Sameh Eid, Samo Turk, Andrea Volkamer, Friedrich
     https://doi.org/10.4000/essais.10180.                        Rippmann, and Simone Fulle. Kinmap: A web-
                                                                  based tool for interactive navigation through human
 [3] George EP Box and Norman R Draper. Empirical                 kinome data. BMC Bioinformatics, 18(1):16, 2017.
     model-building and response surfaces. John Wiley &           https://doi.org/10.1186/s12859-016-1433-7.
     Sons, 1987.
                                                             [16] Andrea Volkamer, Sameh Eid, Samo Turk, Friedrich
 [4] Pieter Eykhoff. System identification. John Wiley &          Rippmann, and Simone Fulle. Identification and
     Sons, 1974.                                                  visualization of kinase-specific subpockets. Journal
                                                                  of Chemical Information and Modeling, 56(2):335-346,
 [5] Frank Hauer and Yury Luchko. Mathematische                  2016. https://doi.org/10.1021/acs.jcim.5b00627.
     Modellierung mit MATLAB: Eine praxisorientierte Ein-
                                                             [17] Robin E Ferner and Jeffrey K Aronson. Cato guld-
     fhrung. Springer-Verlag, 2010.                              berg and peter waage, the history of the law of mass
                                                                  action, and its relevance to clinical pharmacology.
 [6] Werner Blum and Dominik Leiss. ,,Filling up"-                British Journal of Clinical Pharmacology, 81(1):52-55,
     the problem of independence-preserving teacher               2016. https://doi.org/10.1111/bcp.12721.
     interventions in lessons with demanding modelling
     tasks. In CERME 4-Proceedings of the Fourth Congress    [18] Athel Cornish-Bowden. Fundamentals of enzyme ki-
     of the European Society for Research in Mathematics          netics, 510. Wiley-Blackwell Weinheim, Germany,
                                                                  2014.
     Education, 2005.
                                                             [19] Kenneth A Johnson and Roger S Goody. The orig-
 [7] Tie Koide, Wyming Lee Pang, and Nitin S                      inal michaelis constant: Translation of the 1913
     Baliga. The role of predictive modelling in                  michaelis-menten paper. Biochemistry, 50(39):8264-
     rationally re-engineering biological systems.                8269, 2011. https://doi.org/10.1021/bi201284u.
     Nature Reviews Microbiology, 7(4):297, 2009.
     https://doi.org/10.1038/nrmicro2107.                    [20] Boseung Choi, Grzegorz A Rempala, and Jae Ky-
                                                                  oung Kim. Beyond the Michaelis-Menten equa-
 [8] S Yu Jessica and Neda Bagheri. Multi-class and               tion: Accurate and efficient estimation of enzyme
     multi-scale models of complex biological phenom-             kinetic parameters. Scientific Reports, 7(1):17018,
     ena. Current Opinion in Biotechnology, 39:167-173,           2017. https://doi.org/10.1038/s41598-017-17072-z.
     2016. https://doi.org/10.1016/j.copbio.2016.04.002.
                                                             [21] Sascha Schuble, Anne Kristin Stavrum, Pl Pun-
 [9] Stefano Schivo, Jetse Scholma, Paul E van der                tervoll, Stefan Schuster, and Ines Heiland. Effect of
     Vet, Marcel Karperien, Janine N Post, Jaco van de            substrate competition in kinetic models of metabolic
     Pol, and Rom Langerak. Modelling with an-                    networks. FEBS Letters, 587(17):2818-2824, 2013.
     imo: Between fuzzy logic and differential equa-              https://doi.org/10.1016/j.febslet.2013.06.025.
     tions. BMC Systems Biology, 10(1):56, 2016.
     https://doi.org/10.1186/s12918-016-0286-z.              [22] Edda Klipp, Wolfram Liebermeister, Christoph
                                                                  Wierling, Axel Kowald, and Ralf Herwig. Systems
[10] Paul Kirk, Thomas Thorne, and Michael PH Stumpf.             biology: A textbook. John Wiley & Sons, 2016.
     Model selection in systems and synthetic biology.
     Current Opinion in Biotechnology, 24(4):767-774, 2013.  [23] Yuh Lin, Ping Lu, Cuyue Tang, Qin Mei, Grit Sandig,
     https://doi.org/10.1016/j.copbio.2013.03.012.                A David Rodrigues, Thomas H Rushmore, and Ma-
                                                                  gang Shou. Substrate inhibition kinetics for cy-
[11] Daniel Silk, Paul DW Kirk, Chris P Barnes, Tina              tochrome p450-catalyzed reactions. Drug Metabolism
     Toni, and Michael PH Stumpf. Model selection in              and Disposition, 29(4):368-374, 2001.
     systems biology depends on experimental design.
     PLoS Computational Biology, 10(6):e1003650, 2014.       [24] Jacques Haiech, Yves Gendrault, Marie-Claude
     https://doi.org/10.1371/journal.pcbi.1003650.                Kilhoffer, Raoul Ranjeva, Morgan Madec, and
                                                                  Christophe Lallement. A general framework
[12] Sebastiaan H Mannaerts. Extensive quantities                 improving teaching ligand binding to a macro-
     in thermodynamics. European Journal of Physics,              molecule. Biochimica et Biophysica Acta (BBA)-
     35(3):035017, 2014. https://doi.org/10.1088/0143-            Molecular Cell Research, 1843(10):2348-2355, 2014.
     0807/35/3/035017.                                            https://doi.org/10.1016/j.bbamcr.2014.03.013.

[13] Roberto Marquardt, Juris Meija, Zoltn Mester,
     Marcy Towns, Ron Weir, Richard Davis, and Jrgen
                                           Chapter 4: Physical modeling and non-linear enzyme kinetics -- 21/36

[25] Olaf Wolkenhauer.  Why model?

Frontiers in Physiology, 5:21, 2014.

https://doi.org/10.3389/fphys.2014.00021.
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                  22/36

                   ,                     1               ,                      2  ,                            3

                           

                                                                   A      1  B                          1
                                                                                                  A -1 B
                                        ,                                 , , 
                                                                                                       , , 

                   ,                     4               ,                   5     ,                             6

                                                                                                        1
                                                                                                  2A -1 B
                               2A 1 B                              2A 1 B                         B 2 2C + A
                                     -1                             B 2 3C
                                                                                                       -2
                                        , ,                               , , , 
                                                                                                         , , , 

                   3. Exercises                                           For the questions below, the following simplifying as-
                                                                          sumptions shall apply: q = qin = qout and V =const.
 Balance equations
                                                                             b) Which simplified amount of substance balances
Set up balance equations for the volume and for the                              can you achieve? Which variable are you balancing
                                                                                 now?
amount of substance (in mol) of every reaction partner
                                                                             c) Which concentrations cA, cB do you obtain in steady
for the systems depicted below. The reactionstake place
                                                      ,  ,  , 
in an ideally mixed and closed reactor.

 CSTR                                                                              state?

In the following, a Continuous StirredTank Reactor  Balancing a CSTR
(CSTR) is investigated. A substance A with concentraA- 1CeBll-free,medium (substrate S, influx concentration cinS ,
tion cinA and temperature T in is pumped into the reactor volume flow rate q) is added to a Continuous Stirred
with  the  volume  flow  rate  qin.  A  1st-order        reaction  takes
                                                                          TankReactor (CSTR) in continuous cultivation mode.
                                                                        
place, during which Substance A is converted irreversibly ,                 ,  , 
                                                                          The reaction volume within the reactor (VR) is kept con-
into Substance B with a reaction rate constant k1. To in- stant. Micro-organisms are growing on the substrate
crease the conversion rate, heat flow Qheat is fed into the within the CSTR. The specific growth rate  of the micro-
CSTR. The change in reaction enthalpy is neglectable. organisms is approximated with a Michaelis-Menten
The volume flow rate qout (temperature T out ; concentra- kinetic. The yield coefficient shall be YXS.
tions cout A , cout B ) is removed from the CSTR.
                                                                             a) Set up mass balance equations for the concentra-

                                                                                   tions of the biomass (X) and the substrate (S).

                                                                             b)    Derive  t  he  steady-state  concentration  values  (  c     ,  c     )
                                                                                                                                             S        X
                                                                                   as a function of the dilution rate D = D = q .
                                                                                                                                       VR

                                                                           Intracellular reaction
                                                                          We will now focus on enzyme-catalyzed reactions in the
                                                                          interior of a bacterial cell with a constant cell volume VC.
                                                                          Thereby a substrate S is converted into Product P:

a) Set up the balance equations for the amounts of                                             k1
    Substance A and Substance B.
                                                                                   S + E ---- ES

                                                                                              k-1
                                                                                               k2

                                                                                      ES -- P + E
                                                     Chapter 4: Physical modeling and non-linear enzyme kinetics -- 23/36

The reaction is regulated via a feedback repression of the         e) Derive a single 2nd-order differential equation for
enzyme synthesis. A simplified mechanism is assumed
as follows:                                                            the product concentration cP from Equation I and
                                                                       II while applying the assumption cS = cS and con-
                 k3                enzyme synthesis                    sidering a time variable rate rP(t).

    C + D -- E + D

                 k4                repression of enzyme synthesis f) Linearize this differential equation around the steady
                                                                                  state (cP, rP ) with cP = cP - cP and rP = rP - rP .
    D + P ---- DP
                                   enzyme degradation
                k-4
                k5

         E -- F

Within the cell, ideal mixing is assumed. Reaction orders           Mixed population
are according to the stoichiometric coefficients.
                                                                   In the following we will focus on a mixed population in

a) Set up balance equations for the concentrations of              a CSTR in continuous cultivation. The reaction volume

    reaction partners E, ES, S, P, D, and DP in the form           V is kept constant. The mixed population consists of

    d   (V c).  The  bacterial  cell  is  thereby  considered  as  two species of micro-organisms: prey (P) and predator
    dt
    a closed system.                                               (R). Prey grows with a specific growth rate  and de-

                                                                   creases proportionally with the number of predator and

b) Show that the overall concentration of substance                the number of prey. (The more prey is available, the
    D is constant, i.e. cD + cDP =const= cD0
                                                                   more will be depredated). Ideal mixing and a constant
                                                                                                                       q
                                                                   growth  rate    (with    =  dilution  rate  D  =  V  )  is  assumed.

c) Determine ,  and  in:                                           a) Describe the occurring processes in the population.

        dcS = -  cS  cE                                          b) Assign the individual terms within the following
         dt                                                            equations to the occurring population processes:
        dcE =  - k5  cE
         dt 1 +   cP

    using the result of part b) and applying the follow-                        d
    ing assumptions:                                                           dt cP = 킸P - k1cPcR - DcP
                                                                                d
      1. The concentration of the enzyme substrate                             dt cR = k2cRcP - DcR
          complex cES is considered to be constant, i.e.
           d                                                       c) Determine the steady state(s) and characterize it
              cES = 0.                                                 (them) qualitatively.
           dt
                                                                   d) Linearize the system around the steady state(s).
      2. Reaction 4 is considered to be in equilibrium
          (quasi-steady state).

      3. Concentration cC is constant (cC = cC ).

    Remark: The results of points a) to c) are not                 e) Calculate the Eigenvalues for the cases:
                                                                       1. D = 2
    needed for us to solve the following parts. For the                2. D = 1 
    remaining parts of this exercise, it is assumed that                        2
    a constant substrate concentration cS is achieved
    within the cell via regulation of the substrate trans-         f) What can generally be stated on the stability of the
    port:                                                              steady states? Focus therefore on 3 cases ( > D,
                                                                        = D and  < D) for every steady state.
           cS(t) = cS

d)  Which  concentrations       c     and cP do you get in steady   Deriving rate parameters from biological data
                                   E                               A cartoon model for gene regulation via an extracellular
                                                                   signaling molecule (also called a ligand) is given as fol-
    state, if Product P is further converted with rate             lows:
    rP(t) = rP ? This conversion results in the following          L is the signaling molecule, R the membrane receptor,
                                                                   A an adaptor protein, and TF the transcription factor
    equations:                                                     involved in the regulation.

        dcE =  - k5  cE I                                         From the cartoon model, one derives the biochemical
         dt 1 +   cP
        dcP =   cS  cE - rP II
         dt
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                            24/36

                                  L                           The parameter k3 has been measured directly as
                         1                                                               1
                                                                      k3  =   0.01     nM톝  .
                                             R
  A       2                                                  The following assumptions, done by the modeler, are
                A        6 
 TF                                                          needed to determine all parameter values uniquely: k-1 =
Cytosol  3                     5                                   1                   10-3     1                       10-5  1
                       TF                                    0.01  s  ,  k-2  =  1             s  ,  and  k4  =  1          s  .
         4
                                Nucleus                      a) Convert the unit molar M to molecules per cell for
                                                                 ligand and transcription factor states TF and TFn.

                                                             b) Calculate the degradation rate constant (k6) from
                                                                 the half-life time T1/2.

reaction network as follows:                                 c) Construct an ODE model for the sub-network in-
                                                                 volving the reactions IV - VI, i.e., the unstimulated
         k1                                                      case. Use, therefore, the law of mass action.

L + R ---- Ri                        I                       d) Use the biological measurements in the unstimu-
         k-1                                                     lated case (steady-state condition) and the assump-
                                                                 tions to determine all parameters in reactions IV -
         k2                                                      VI. Use units such that state variables are given as
Ri + A ---- Ra                       II                          numbers of molecules per cell.
         k-2

         k3
Ra + TF -- TFn                       III

         k4
TF ---- TFn                          IV                      e) Determine the parameters for reactions I - III from
         k-4                                                     the biological measurements and the assumptions,
                                                                 using the same units as before.
         k5
TFn -- TFn + A                       V

         k6
         A --                        VI

The following information is known from biological mea-
surements:

     Experiments are done with 2 mL of medium and
       6  105 cells, using a ligand concentration of 1 nM.

     The volume of a cell is 1  10-12L, with the nucleus
       taking 1/5 of the total volume.

     The concentration of the transcription factor in
       whole cell extracts (TF + TFn) was measured as
       0.1 M.

     The concentration of the transcription factor with-
       out stimulus in nuclear extracts was measured as
       5nM.

     The concentration of the adaptor protein without
       stimulus in whole cell extracts is 1킡.

     The adaptor protein has a half-life time of 1 h.

     A cell has a total of 10000 membrane receptors.

     The associated constant Ka for the ligand-receptor
       binding is 0.01 n1M . Hint:

                 k1[L][R] = k-1[Ri]
                k1 = [Ri] = Ka

                      k-1 [L][R]

 The associated constant for the receptor-adaptor
                               1
protein  binding   is  0.01   킡  .
Notes
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                         26/36

           ,                            1  ,                                       2         ,                 3

                   

                                                                 A       1      B                               1
                                                                                                          A -1 B
                          ,                                              , , 
                                                                                                               , , 

           ,                            4  ,                                      5          ,                  6

                                                                                                       1
                                                                                                 2A -1 B
                          2A 1 B                               2A 1 B                            B 2 2C + A
                                -1                              B 2 3C
                                                                                                      -2
                          , ,                                         , , , 
                                                                                                        , , , 

           4. Solutions                                                    Reactor 4

           Do not betray yourself!                                                       dV = qin - qout
                                                                                         dt
Exercises

 Balance equations                                                                    dnA = -qout cA - 2k1cA2V + 2k-1cBV
                                                                                       dt
Concentrations in the extraction pipe,are,ass,um ed to                                dnB = qincBin - qout cB + k1cA2V - k-1cBV
correspond to the concentrations within the tank. Thus,                                dt

we have omitted the specific indication with the indices

out.                                                                                     
                                                                           Reactor 5

Reactor 1                                                        A     1 B               , 

dV = qin - qout                                                                          dV = qin - qout
 dt                                                                                      dt
dnA = nAin - nAout                                                  ,        ,        ,  
 dt                                                                              dnA in in out
                                                                                             = q cA - q cA - 2k1cAV2
     = qincinA - qout cA
                                                                                         dt

                                                                                      dnB = -qabcB + k1cA2V - k2cBV
                                                                                       dt

Reactor 2                                                                             dnC = -qout cC + 3k2cBV
                                                                                       dt

dV = qin - qout                                                            Reactor 6
dt

       dnA = qincAin - qout cA - k1cAV                                                dV =qin - qout
        dt                                                                             dt
       dnB = -qout cB + k1cAV                                                         dnA =qincAin - qout cA - 2k1cA2V + 2k-1cBV + k2cBV
        dt                                                                             dt

Reactor 3                                                                                     - k-2cC2 cAV

dV = qin - qout                                                                       dnB = - qout cB + k1cA2V - k-1cBV - k2cBV + k-2cC2 cAV
dt                                                                                     dt

dnA = qincAin - qout cA - k1cAV + k-1cBV                                              dnC = - qout cC + 2k2cBV - 2k-2cC2 cAV
 dt                                                                                    dt

dnB = -qout cB + k1cAV - k-1cBV
 dt
                                              Chapter 4: Physical modeling and non-linear enzyme kinetics -- 27/36

 CSTR                                                    Balancing a CSTR
Task a) Amount of substance balances:                   Cell-free medium (substrate S, influx concentration cinS ,
                                                        volume flow rate q) is added to a Continuous Stirred
                                                        Tank Reactor (CSTR) in continuous cultivation mode.
                                                        The reaction volume within the reactor (VR) is kept con-
                                                        stant. Micro-organisms are growing on the substrate
                                                        within the CSTR. The specific growth rate  of the micro-
                                                        organisms is approximated with a Michaelis-Menten
                                                        kinetics. The yield coefficient shall be YXS.

                                                        Task a) Set up mass balance equations for the biomass
                                                        (X) and the substrate (S) concentrations.

dnA = qincAin - qout cA - k1cAV                         [ mol h ]  [ lh ][ moll ]  [  1  ][  mol  ][l  ]
 dt                                                                                   h       l
dnB = 0 - qout cB + k1cAV                               d(cXVR) = -qcX + 킸XVR = -qcX + 탆ax cS cXVR
 dt                                                         dt                                                         KS +CS

                                                        d(cSVR) = q cSzu -Cs - 1 킸XVR
                                                            dt                                 YX S
Task b) Applying the simplifying assumptions q = qin =
qout und V = const.:                                    With VR = const. we get

dnA d                                                   dcX = cX ( - q ) = cX ( - D) I
   = (cA 톅 ) = V cA +V cA = 0 +V cA
dt dt                                                   dt              V

Applying the product rule and assume that a CSTR does   dcS = q (cSzu - cS) - 1 킸X = D(cSzu - cS) - 1 킸X II
not change the volume in the tank during the process    dt V                          YX S                              YX S
(derivative of constant V is zero):
                                                        Task b) Derive the steady-state concentration values
     V  cA = qcinA - qcA - k1cAV                       (cS, cX ) as a function of the dilution rate D = D = q .
           cA = q  (cAin - cA) - k1  cA
                  V                                                                                                        VR
                     q
           cB = -V  cB + k1cA                (4.1)                dcX                            !
                                              (4.2)     Eq. I : = cX ( - D) = 0
                                                                   dt

Task c) From the equation (4.1) with cA = 0:                            Case 1:  cX = 0

q in      !                                                              in II:             !                       cS = czuS
   (cA - cA) - k1cA = 0
                                                                                         D (cS - cS) = 0

V                                                                       Case 2:  = 탆ax                       cs  = D
q cAin - q cA ) - k1cA = 0
VV                                                                                                        cS + KS

       q  c = V (cinA                                                      cS탆ax = DcS + KSD

          A    k1 + V          q                                                                          KSD

          cA = q cAin                                                               cS =          탆ax - D                     III
                q + k1V
                                                                         in II: D                  zu KSD
and for Substance B based on the equation (4.2) with                             D                cS -
cB = 0:
                                                                                                         탆ax - D

                                                                                                      1            KS D
                                                                                                  - 탆ax           탆ax -D
                                                                                                                               !
                            q                                                                                          K D cX = 0
                                  !                                                                       YXS KS + S 탆ax-D
          cB = -  cB + k1cA = 0
                            V
       q  cB = k1cA                                                                               zu KSD
       V                                                                                          cS -

                                                                                                         탆ax - D

          cB = k1V cA                                                                             -       탆ax KS D 
                  q                                                                                                    cX = 0
                                                                                                          YXS KS 탆ax
          cB = k1V  q cAin
                  q q + k1V                                                                               zu       KSD
                                                                                    cX = YXS cS -                              IV
                                                                                                                   탆ax - D  
          c k1V ci B = An
                (q + k1V )                              Conditions:
                                                        The substrate concentration cannot be negative (CS  0),
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                      28/36

so that Equation III tells us that:                           The reaction is regulated via a feedback repression of the
                                                              enzyme synthesis. A simplified mechanism is assumed
 탆ax > D                                        V            as follows:

If 탆ax < D we get a wash-out of the biomass, which is                                k3  enzyme synthesis
usually not desired in a CSTR.
Biomass should also be positive (cX > 0):                                C + D -- E + D

                                                                                      k4  repression of enzyme synthesis

                                                                         D + P ---- DP

                                                                                     k-4

                                                                                   k5     enzyme degradation

                                                                              E -- F

 cszu -         KSD                                           Within the cell, ideal mixing is assumed. Reaction orders
                         >0                                   are according to the stoichiometric coefficients.
         탆ax - D

with 탆ax > D:                                                1st Part

cSzu탆ax - czuS D - KSD > 0                                   Task a) Set up balance equations for the concentrations

                cSzu + KS                                     of reaction partners E, ES, S, P, D, and DP in the form
                                                              d
탆ax > zu D                                      VI           dt  (V    c).  The bacterial cell is thereby considered as a
                cS
                                                              closed system.

whereby Equation V is contained in Equation VI, be-            d
cause:                                                         dt (VC  cE ) = (-k1cE cS + k-1cES + k2cES + k3cDcC - k5cE )VC
                                                              d
czSu + KS > 1.                                         (4.3)  dt (VC  cES) = (k1cE cS - k-1cES - k2cES)VC
   cSzu                                                         d
                                                               dt (VC  cS) = (-k1cE cS + k-1cES)VC
for practical considerations one uses 탆ax > D.                 d
    In summary:                                                dt (VC  cP) = (k2cES - k4cDcp + k-4cDP)VC
                                                               d
Case 1:           CSzu + KS                                    dt (VC  cD) = (-k4cDcP + k-4cDP)VC
Case 2:  탆ax > zu D                                          d
                                                              dt (VC  cDP) = (k4cDcP - k-4cDP)VC
Case 3:              CS

                 Two steady states

                  CSzu + KS                                   with:
         탆ax = zu D
                                                              dn = d(cV ) = VC dc + c dVC = VC dc  with VC = const.
                     CS

                                KSD                           dt dt           dt dt       dt
                 CS = czu+KS
                         S      D - D                         Thus we get:
                            zu
                            cS

                      = KSDCzuS                = CzuS          d
                         (czuS + KS)D - DczuS                  dt cE = -k1cE cS + k-1cES + k2cES + k3cDcC - k5cE I
                                                              d
                 cX = 0                                       dt cES = k1cE cS - k-1cES - k2cES II
                                                                d
          Both steady states are equal.                        dt cS = -k1cE cS + k-1cES III
                  CSzu + KS                                     d
                                                               dt cP = k2cES - k4cDcp + k-4cDP IV
         탆ax < zu D                                           d
                     CS                                        dt cD = -k4cDcP + k-4cDP V
                                                              d
                 It exists only the first steady state        dt cDP = k4cDcP - k-4cDP VI
                       cX = 0; cS = cSzu

 Intracellular reaction                                       which works only if the volume remains constant.
We will now focus on enzyme-catalyzed reactions in the
interior of a bacterial cell with a constant cell volume VC.  Task b) Show that the overall concentration of Sub-
Thereby a substrate S is converted into Product P:            stance D is constant, i.e. cD + cDP =const= cD0
                                                              If you look at the balances of cD and cDP, you see that
                       k1                                     the sum is zero:

        S + E ---- ES                                         d          d
                                                              dt cD + dt cDP = -k4cDcP +k-4cDP +k4cDcP -k-4cDcP = 0.
                       k-1

                       k2

           ES -- P + E
                                               Chapter 4: Physical modeling and non-linear enzyme kinetics -- 29/36

By integrating this equation, one obtains:                 task description. Let's use the equilibrium equa-
                                                           tion (IV):
cD + cDP = const.

Task c) Determine ,  , and  in:                            d   cP = k2cES - k4cDcP + k-4cDP = 0!

                                                           dt

dcS = -  cS  cE VII                                      k4cDcP = k-4cDP + k2cES
 dt
dcE =  - k5  cE VIII                                      We got another hint from task b) where we define
 dt 1 +   cP                                              a total concentration of enzyme-regulating protein
                                                           cD0 with cD + cDP = cD0 = const. Using this gives:
using the result of part b) and applying the following
assumptions:                                                        k4cDcP = k-4(cD0 - cD) + k2cES
                                                           (k4cP + k-4)cD = k-4cD0 + k2cES
   1. The concentration of the enzyme substrate complex
                                                        d                 cD = k-4cD0 + k2cES
                                                                                   (k4cP + k-4)
       cES is considered to be constant, i.e. cES = 0:
                                                       dt                        cD0 + kk2-4 cES
                                                                              = ( kk4 cP + 1)
d   cES = k1cE  cS - k-1cES - k2cES = 0    !
                                                                                                      -4
dt

    cES = k1 cE cS IX
            k-1 + k2

in Equation III:

    dS = -k1cE cS + k-1k1 cE cS                                           cDP = k4 cDcP
    dt                      k-1 + k2                                              k-4

        = -k1k-1 - k1k2 + k-1k1 cE cS                         3. Concentration cC is constant (cC = cC ).
                    k-1 + k2
                                                           Finally, we obtain the parameters:
 dS = - k1k2 cE cS
    dt            k-1 + k2                                         = k1k2
                                                                        k-1 + k2
      = k1k2
              k-1 + k2                                              = k4
                                                                        k-4
2. Reaction IV is considered to be in equilibrium (quasi-
   steady state).                                                  = k3cC cD0
   We already have  and still need  and  . These 2
   parameters can be found in Equation VIII, because       2nd Part
   this equation contains the derivative of cE . We        We assume now that we give as much substrate as the
   might tinker something together that looks similar.     cells consume so that:
   Let's use Reaction I:
                                                                  cS(t) = cS.
dcE = -k1cE cS + (k-1 + k2)cES + k3cDcC - k5cE
 dt                                                        Task d) Which concentrations cE and cP do you get
                                                           in steady state, if Product P is further converted with
Now, we have the problem that we have the terms            rate rP(t) = rP ? This conversion results in the following
cE and cS, and cES (which we do not want). If we           equations:
put Equation IX in we get:
                                                                   dcE =  - k5  cE I
dcE  = - k1cE cS +  k1(k-1 + k2)                                    dt 1 +   cP
                                  cE cS                            dcP =   cS  cE - rP II
dt                          k-1 + k2                                dt

        + k3cDcC - k5cE

dcE =k3cDcC - k5cE
 dt

Well, that is some progress. Now, we take care of
cD, cC and therefore we have another hint in the
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                                                30/36

In the stationary case:                                                  Mixed population
                                                                        In the following we will focus on a mixed population in

                dcP                       !      cE = rP                a CSTR in continuous cultivation. The reaction volume
                                                             cS
                dt   =   cS  cE - rP = 0                              V is kept constant. The mixed population consists of

                                                                        two species of micro-organisms: prey (P) and predator

                dcE  =             - k5  cE = 0!                       (R). Prey grows with a specific growth rate  and de-

                dt 1 +   cP                                            creases proportionally with the number of predator and

                                 rP                                     the number of prey. (The more prey is available, the

         1 +   cP   = k5  cE = k5                                    more will be depredated). Ideal mixing and a constant
                                        cS                                                                                   q
                                                                        growth   rate    (with    =  dilution  rate   D  =  V  )  is  assumed.
                    cS
         1 +   cP =                                                    Task a) Describe the occurring processes in the popu-
                                                                        lation.
                       k5  rP
                                                                            Birth, prey-predator interaction, extraction
                  cS 1  cS - k5  rP
               cP =             - =
                         k5  rP             k5  rP 

Task e) Derive a single 2nd-order differential equation                 Task b) Assign the individual terms within the follow-
for the product concentration cP from Equation I and II                 ing equations to the occurring population processes:
while applying the assumption cS = cS and considering
a time variable rate rP(t). Assume cS(t) = cS.                               prey concentration:       d         birth      predation extraction
                                                                        predator concentration:            cP = 킸P
                                                                                                       dt                  -k1cRcP -DcP

From the system equations I and II we get:                                                             d   cR = k2cPcR                   -DcR

                                                                                                       dt        growth on prey         extraction

         d   cE + k5cE =                                                Task c) Determine the steady state(s) and characterize
                                                                        it (them) qualitatively.
         dt                  1 + cP

                             1     d                                       0 = ( - k1cR - D)cP                            I
                     cE =          dt cp + rp

                             cS

We use this to obtain:                                                     0 = (k2cB - D)cR                             II

         1 d2                d     +  k5     d            =
         cS dt2 cP + dt rP             cS    dt cP + rP      1 + cP
                                                                           Steady State 1:  cP1  = 0, cR1  = 0

or                                                                         Steady State 2:  cP2  = D , cR1  =  - D

         d2 c d c P + k5 cP - S = - d rP - k5rP .                                                          k2                 k1

         dt2             dt 1 + cP dt                                   Steady State 1 basically says that neither prey nor preda-
                                                                        tors are present because they are washed out.
Task f) Linearize this differential equation around the                 Steady State 2 exists only if cR2  0 is. Therefore, the
steady state (cP, rP ) with cP = cP - cP and rP = rP - rP .             growth rate has to compensate at least the dilution rate
Assume cS(t) = cS.                                                        D. If   D, we have Steady state 1.

The  linearization       of  f  =     1   delivers:                     Task d) Linearize the system around the steady state(s).
                                   1+ cP

    f (cP ) +  f     c cP =        1  +      f  c cP                    From Equation I:
               cP                                                                cP = 킸B - k1cPcR - DcP
                      P         1 + cP  cP P

                            =      1-           1
                                                    2     cP . . . ,
                                1 + cP (1 + cP)
                                                                        we get:

with which we get:                                                      cP +cP = f (cB, c2R) +( - D)  cP - k1cP  cR - k1cR  cP

         d2              d             (k5  rP)2
              cP + k5 cP - k5rP +                  cP                   0                 0(ss)
         dt2
                         dt                   cS                           cP = ( - k1cR - D)  cP - k1cP  cR

                                 = - d rP - k5(rP + rP),                with cP = cP + cB and cR = cR + cR.
                                      dt

and finally:

    d2               d          (k5  rP)2             d                From Equation II:
         cP + k5 cP +                  cP = - rP - k5rP .                        cR = k2cPcR - DcR
    dt2              dt             cS               dt
                                                   Chapter 4: Physical modeling and non-linear enzyme kinetics -- 31/36

we get:                                                1.) D = 2 Because the growth rate is just the half of the
                                                       dilution rate we will have a wash-out. See task c).
       cR = -D  cR + k2cR  cP + k2cP  cR            2.) D = 1 
       cR = k2cR  cP + (k2cP - D)  cR
                                                                  2
Steady State 1 (0, 0):
                                                                     1
    cP = ( - D)  cP                                         s1 = 

    cR = -D  cR                                                     2
                                                                       1
    cP =  - D 0 cP
    cR          0 -D cR                                       s2 = - 
                                                                       2

                                                        unstable saddle
                                                       Steady State 2 kD2 , k -D 1 :

Steady State 2 kD2 , k -D 1 :                                         11                  1
                                                        s1,2 =  -    = 켲   
                                                                       22                  2

cP = ( -  + D - D)  cP - k1 DcR = - k1 DcR           metastable circle (limit circle).
                                   k2          k2

cR = k2 ( - D)cP + (D - D)  cR = k2 ( - D)  cP     Task f) What can generally be stated on the stability
    k1                                     k1          of the steady states? Focus therefore on 3 cases ( > D,
                                                        = D and  < D) for every steady state.
cP              0 - kk12 D cP
cR = k2 ( - D) 0
            k1                     cR

Task e) Calculate the Eigenvalues for the cases:       Steady State 1      >D   =D             <D
1. D = 2                                                                   X
2. D = 1                                                 unstable                X                X
                                                            stable         >D   =D
         2                                                                                       <D
Steady State 1 (0, 0):                                   metastable         X     X           not exists
                                                                                              not exists
                   |sI - A| = 0                        Steady State 2                         not exists
    [s - ( - D)](s + D) = 0  s1 =  - D; s2 = -D
                                                          unstable
                                                            stable

                                                         metastable

1.) D = 2                                              Deriving rate parameters from biological data
                                                       A cartoon model for gene regulation via an extracellular
       s1 = -                                         signaling molecule (also called a ligand) is given as fol-
       s2 = -2                                        lows:

 stable                                                                                                      L
2.) D = 1                                                                                              1

           2                                             A       2                               R
              1                                                        A
                                                        TF                   6 
       s1 =                                           Cytosol  3
              2                                                                    5
                1                                               4          TF

       s2 = -                                                                      Nucleus
                2

 unstable saddle

Steady State 2 kD2 , k -D 1 :

            |sI - A| = | s      0 - -D 0s - k1 D !    L is the signaling molecule, R the membrane receptor,
                            0      k2 k1     k2 | = 0  A an adaptor protein, and TF the transcription factor
                                             0         involved in the regulation.
    s2 + D( - D) = 0
                                                       From the cartoon model, one derives the biochemical
                s1,2 =  -D( - D)
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching                                            32/36

reaction network:                                                Task a) Convert the unit molar M to molecules per cell
                                                                 for ligand and transcription factor TF and TFn.
                          k1                                     Ligand:
             L + R ---- Ri                                  I
                       k-1

                          k2                                     [L] = 1nM = 10-9 mol = 6  1014 molecules
            Ri + A ---- Ra                                  II
                       k-2
                                                                                        L                 L

                          k3                                      nL = c 톅 = 6  1014 molecules  2  10-3L
         Ra + TF -- TFn                                     III                                   L

                          k4
                 TF ---- TFn                                IV     = 1.2  1012 molecules in 2 mL
                       k-4

                          k5                                       1.2  1012molecules                 6 molecules
             TFn -- TFn + A                                 V                                = 2  10
                                                                   6  10 cells5                          cell

                          k6
                 A --                                       VI

                                                                 Transcription factor:

The following information is known from biological mea-          [T Fn] = 5nM = 5 nmol = 5  10-9 mol
surements:                                                                         L                   L

     Experiments are done with 2 mL of medium and                  5  10-9 mol  NA 톅
       6  105 cells, using a ligand concentration of 1 nM.                      L

     The volume of a cell is 1  10-12L, with the nucleus         = 5  10-9 mol  6.022  1023 molecules  0.2  10-12L
       taking 1/5 of the total volume.                                          L                         mol

     The concentration of the transcription factor in             = 602 molecules
       whole cell extracts (TF + TFn) was measured as                          cell
       0.1 M.
                                                                 Task b) Calculate the degradation rate constant k6 from
     The concentration of the transcription factor with-        the half-life time T1/2:
       out stimulus in nuclear extracts was measured as
       5nM.                                                                       A = -k6  A
                                                                            A(t) = A0  e-k6톞
     The concentration of the adaptor protein without
       stimulus in whole cell extracts is 1킡.                     T1,2 :  A(t  )   !  A0/2

     The adaptor protein has a half-life time of 1 h.                             =

     A cell has a total of 10000 membrane receptors.                       A0 = A0  e-k6톂1/2
                                                                               2
     The associated constant Ka for the ligand-receptor                        1 = e-k6톂1/2
       binding is 0.01 n1M . Hint:                                              2

                 k1[L][R] = k-1[Ri]                                ln      1       = -k6  T1/2
                k1 = [Ri] = Ka
                                                                           2
                      k-1 [L][R]
                                                                   ln(1) -ln(2) = -k6  T1/2

                                                                   0

                                                                                   ln(2)
                                                                          k6 = T1/2

 The associated constant for the receptor-adaptor               Task c) Construct an ODE model for the sub-network
                                                 1               involving the reactions IV - VI, i.e. the unstimulated case.
         protein    binding           is  0.01  킡  .            Use, therefore, the law of mass action.

 The parameter k3 has been measured directly as:                  cL = -k1cLcR + k-1cRi                            I

         k3  =   0.01       1                                      cR = -k1cLcR + k-1cRi                            II
                          nM톝
                                                                   cRi = +k1cLcR - k-1cRi - k2cRicA + k-2cRa III

The following assumptions, done by the modeler, are                cRa = +k2cRicA - k-2cRa - k3cRacT F              IV

needed to determine all parameter values uniquely: k-1 =           cA = -k2cRicA + k-2cRa + k5cT Fn - k6cA          V
      1                   10-3  1                  10-5  1
0.01  s  ,  k-2  =  1          s  ,  k4  =  1          s

                                                                   cT F = -k3cRacT F - k4cT F + k-4cT Fn            VI

                                                                   cT Fn = +k3cRacT F + k4cT F - k-4cT Fn           VII
                                                         Chapter 4: Physical modeling and non-linear enzyme kinetics -- 33/36

Task d) Use the biological measurements in the unstim-           given: T1/2(A) = 1h = 3600s
ulated case (steady-state condition) and the assumptions
to determine all parameters in reactions IV - VI. Use                     k6 = ln(2) = ln(2) = 1.9  10-4 1
units such that state variables are given as numbers of                                  T1/2(A) 3600s                          s
molecules per cell.

       I = II : -k1  0  cR + k-1cRi = 0

                                         cRi = 0                 given:  k4  =  10-5  1
                k1  0  cR - k-1  0 - k2  0 + k-2  cRa  = 0                       s

III :                                    cRa  = 0                   V.2 :       k5 = k6  cA
                                                                                           cT Fn
IV :            k2  0  cA - k-2  0 - k3  0  cTF = 0
V.2 :           cA = -k2cRicA + k-2cRa + k5cTFn - k6cA = 0                      = 1.9  10-4 1  602000 = 0.19 1
                                                                                                      s 602                  s

       VI.2 :   cTF = -k3cRacTF - k4cTF + k-4cTFn = 0            Task e) Determine the parameters for reactions I - III
       VII.2 :  cTFn = +k3cRacTF + k4cTF - k-4cTFn = 0           from the biological measurements and the assumptions,
Volume:                                                          using the same units as before.

given: VCell = 10-12L

                 Vnucl = 1  10-12L = 0.2  10-12L               given:  ka(L - R)    =  0.01   1  ,  k-1  =  0.01 1s
                              5                                                                nM

                 Vcyto = 4  10-12L = 0.8  10-12L                       Ka = k1 = 0.01 1                  Lig.:1nM=^ 2  106 molec.
                              5                                                                                                   cell

                                                                                k-1              nM

Concentrations:                                                          Ka = k1 = 5  10-9 cell
                                                                                k-1                   molecules

given: cT F + cT Fn = 0.1킡                                              k1 = k-1  5  10-9 cell
                                                                                              molecules

            = 0.1  10-6 mol  NA 톅cell                                     = 0.01 1  5  10-9 cell
                                   L                                                     s            molecules

        cT F +cT Fn                                                          = 5  10-11 cell
                                                                                          molecules
                = 0.1  10-6 mol  6.022  1023 molecules  10-12L
                                  L              cell

                   = 60220 molecules                             given:  Ka(Ri  -  A)    =  0.1   1   considerd        only  in    the  cyto-
                                  cell                                                           킡

given: cTFn = 5nM                                                plasma Vcyto. k-2 = 10-3 1s .

                 = 5  10-9 mol  NA 톅nucl                              Ka = k2 k = 0.1 -2 10-6Lmol  1 NA 톅cyto
                                 L

                = 5  10-9 mol  6.022  1023 molecules  0.2  10-12L       = 0.1  10 6.022  1023  0.8  10-12 6 1  L mol  mol molecules  cell L
                               L             cell

                = 602 molecules                                              = 2.1  10-7 cell
                           cell                                                            molecules

                                              molecules                  k2 = Ka  k-2 = 2.1  10-7 cell  10-3 1
         cTF = 60220 - 602 = 59618                                                                         molecules               s

                                                  cell

given: cA = 1킡                                                                = 2.1  10-10 cell
                                                                                               s  molecules
             cA = 1  10-6 mol  NA 톅cell = 602200 molecules
                               L                         cell    given: k3 = 0.01 nM1톝 considered only in the cytoplasma.

given:  k4  =  10-5  1
                     s

VI.2 :      k-4 = k4  cT F                                              k3 = 0.01 -9       L                   mol                      cell
                        cT Fn
                                                                                                                       23                      -12
                                                                                         10 mol  s 6.022  10 molecules 0.8  10 L
                = 10-5 1  59618 = 9.9  10-4 1
                        s 602                s                               = 2.1  10-5 cell
                                                                                           molecules  s
Introduction to Systems Biology: Workbook for Flipped-Classroom Teaching  34/36

Parameter    Value         Unit
     Ka    2.1  10-7   cell/molecules
     k1     5  10-11    cell/s톗olec
    k-1
     k2       0.01           1/s
    k-2    2.1  10-10   cell/s톗olec
     k3
     k4       10-3           1/s
    k-4    2.1  10-5    cell/s톗olec
     k5
     k6       10-5           1/s
              10-3           1/s
                             1/s
              0.19           1/s
           1.9  10-4
Notes
Notes
               This book need not end here...

                                                   Share

All our books -- including the one you have just read -- are free to access online so that students, researchers and members of
the public who can't afford a printed edition will have access to the same ideas. This title will be accessed online by hundreds
of readers each month across the globe: why not share the link so that someone you know is one of them?
This book and additional content is available at:
https://doi.org/10.11647/OBP.291

                                                  Donate

Open Book Publishers is an award-winning, scholar-led, not-for-profit press making knowledge freely available one book at
a time. We don't charge authors to publish with us: instead, our work is supported by our library members and by donations
from people who believe that research shouldn't be locked behind paywalls.
Why not join them in freeing knowledge by supporting us: https://www.openbookpublishers.com/support-us

                                                                      Follow @OpenBookPublish
                                                    Read more at the Open Book Publishers
   You may also be interested in:

Making up Numbers

A History of Invention in Mathematics
Ekkehard Kopp
https://doi.org/10.11647/OBP.0236

Animals and Medicine

The Contribution of Animal Experiments to the Control
of Disease
Jack Bottin
https://doi.org/10.11647/OBP.0055

B C, Before Computers

On Information Technology from Writing to the Age of
Digital Data
Stephen Robertson
https://doi.org/10.11647OBP.0225
INTRODUCTION TO SYSTEMS BIOLOGY
Workbook for Flipped-Classroom Teaching

Thomas sauTer and marco albrechT

A clear, concise and easy-to-read textbook with plenty of examples, superb graphics and
helpful links. An excellent text for a future generation of interdisciplinary researchers in the
area of biomedical sciences and network medicine.

                                  Jan Rychtar, co-author of Game-theoretical Models in Biology

This volume provides an introduction to the language of systems biology, which
is spoken among many disciplines, from biology to engineering. Authors Thomas
Sauter and Marco Albrecht draw on a multidisciplinary background and evidence-
based learning to facilitate the understanding of biochemical networks, metabolic
modeling and system dynamics.

Their pedagogic approach briefly highlights core ideas of concepts in a broader
interdisciplinary framework to guide a more effective deep dive thereafter. The
learning journey starts with the purity of mathematical concepts, reveals its
power to connect biological entities in structure and time, and finally introduces
physics concepts to tightly align abstraction with reality.

This workbook is all about self-paced learning, supports the flipped-classroom
concept, and kick-starts with scientific evidence on studying. Each chapter comes
with links to external YouTube videos, learning checklists, and Integrated real-
world examples to gain confidence in thinking across scientific perspectives. The
result is an integrated approach that opens a line of communication between
theory and application, enabling readers to actively learn as they read.

This book will interest adherers of systems biology and network analysis, as well
as related fields such as bioinformatics, biology, cybernetics, and data science.

This is the author-approved edition of this Open Access title. As with all Open
Book publications, this entire book is available to download for free on the
publisher's website. Printed and digital editions, together with supplementary
digital material, can also be found at http://www.openbookpublishers.com

Cover image: photo by Vlado Paunovic on Unsplash
Cover design by Anna Gatti

ebook ebook and OA editions
       also available

                                     OPEN

                                                  ACCESS
