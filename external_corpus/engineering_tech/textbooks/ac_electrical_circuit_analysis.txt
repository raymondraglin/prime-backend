AC Electrical Circuit Analysis

A Practical Approach

                                    James M. Fiore
2
       AC Electrical Circuit Analysis

                             A Practical Approach

                                                             by
                                                      James M. Fiore
                                            Version 1.1.13, 02 October 2025

3
 This AC Electrical Circuit Analysis, by James M. Fiore is copyright James M. Fiore, and released under the
                                            terms of a Creative Commons license:

               This work is freely redistributable for non-commercial use, share-alike with attribution

              Device data sheets and other product information are copyright by their respective owners
                     and have been obtained through publicly accessible manufacturer's web sites.
                                         Published by James M. Fiore via dissidents
                                                     ISBN13: 979-8605022282

For more information or feedback, contact:
James Fiore, Professor Emeritus
oer@jimfiore.org
jfiore@mvcc.edu
For the latest revisions, related titles, and links to low cost print versions, go to:
www.mvcc.edu/jfiore or my mirror sites www.dissidents.com and www.jimfiore.org
YouTube Channel: Electronics with Professor Fiore
Cover art, Chapman's Contribution Redux, by the author

4
Introduction

Welcome to the AC Electrical Circuit Analysis, an open educational resource (OER). The goal of this text is to
introduce the theory and practical application of analysis of AC electrical circuits. It assumes familiarity with DC
circuit analysis. If you have not studied DC circuit analysis, it is strongly recommended that you read the
companion OER text, DC Electrical Circuit Analysis before continuing. Both texts are offered free of charge
under a Creative Commons non-commercial, share-alike with attribution license. For your convenience, along
with the free pdf and odt files, print copies are available at a very modest charge. Check my web sites for links.

This text is based on the earlier Workbook for AC Electrical Circuits, which it replaces. The original expository
text has been greatly expanded and includes many examples along with computer simulations. For the
convenience of those who used the Workbook, many of the problem sets are the same, with some re-ordering
depending on the chapter.

If you are already familiar with DC Electrical Circuit Analysis, the format of this title is similar. This text picks
up where the DC text leaves off; beginning with AC concepts such as sinusoidal waveforms, basic Fourier
decomposition of complex waveforms, complex numbers and the like. Also, reactance and impedance are
introduced along with phasor diagrams. Chapters on series, parallel and series-parallel RLC circuits commence.
Following these, network theorems along with nodal and mesh analysis are discussed for the AC case. The text
completes with chapters on AC power, resonance, and introductions to polyphase systems and magnetic circuits.
Each chapter begins with a set of learning objectives and concludes with practice exercises that are generally
divided into four major types: analysis, design, challenge and simulation. Many SPICE-based circuit simulators
are available, both free and commercial, that can be used with this text. The answers to most odd-numbered
exercises can be found in the Appendix. A table of standard resistor sizes is also in the Appendix, which is useful
for real-world design problems. If you have any questions regarding this workbook, or are interested in
contributing to the project, do not hesitate to contact me.

This text is part of a series of OER titles in the areas of electricity, electronics, audio and computer
programming. It includes three other textbooks covering semiconductor devices, operational amplifiers, and
embedded programming using the C language with the Arduino platform. There is a text covering DC electrical
circuits similar to this one, and also seven laboratory manuals; one for each of the five texts plus individual titles
covering computer programming using the Python language, and the science of sound. The most recent versions
of all of my OER texts and manuals may be found at my MVCC web site as well as my mirror site:
www.dissidents.com

This text was created using several free and open software applications including Open Office, Dia, SciDAVis,
and XnView.

Special thanks to the following individuals for their efforts in reviewing and proofreading the DC and AC
Electrical Circuit Analysis texts: Glenn Ballard, John Markham, João Nuno Carvalho, Mark Steffka and Jim
Noon.

5
                                             For the Have-nots and the Has-beens

                                           

                    "Well, the people, I would say. There is no patent. Could you patent the sun?"
                                         -- Jonas Salk, inventor of the polio vaccine,
                                             when asked who owns the patent to it.

6
Table of Contents

Chapter 1: Fundamentals . . . . . . . 10

1.0 Chapter Objectives .            .   .  .  .  .  .  .  10

1.1 Introduction .  .               .   .  .  .  .  .  .  10

1.2 Sinusoidal Waveforms            .   .  .  .  .  .  .  11

1.3 Basic Fourier Analysis .        .   .  .  .  .  .  .  25

1.4 Complex Numbers .               .   .  .  .  .  .  .  29

1.5 Reactance and Impedance .           .  .  .  .  .  .  31

1.6 Phasor Diagrams .               .   .  .  .  .  .  .  37

Summary    .        .               .   .  .  .  .  .  .  38

Exercises  .        .               .   .  .  .  .  .  .  39

Chapter 2: Series RLC Circuits . .            .  .  ..    44

2.0 Chapter Objectives .            .   .  .  .  .  .  .  44

2.1 Introduction .  .               .   .  .  .  .  .  .  44

2.2 The Series Connection           .   .  .  .  .  .  .  44

2.3 Series Impedance .              .   .  .  .  .  .  .  45

2.4 Series Circuit Analysis .       .   .  .  .  .  .  .  48

2.5 Concerning Practical Inductors      .  .  .  .  .  .  61

Summary    .        .               .   .  .  .  .  .  .  63

Exercises  .        .               .   .  .  .  .  .  .  64

Chapter 3: Parallel RLC Circuits           .  .  .  ..    80

3.0 Chapter Objectives .            .   .  .  .  .  .  .  80

3.1 Introduction .  .               .   .  .  .  .  .  .  80

3.2 The Parallel Connection         .   .  .  .  .     .  81

3.3 Parallel Impedance .            .   .  .  .  .  .  .  81

3.4 Parallel Circuit Analysis       .   .  .  .  .  .  .  85

Summary    .        .               .   .  .  .  .  .  .  100

Exercises  .        .               .   .  .  .  .  .  .  101

Chapter 4: Series-Parallel RLC Circuits       . . . . 110

4.0 Chapter Objectives .            .   .  .  .  .  .  .  110

4.1 Introduction .  .               .   .  .  .  .  .  .  110

4.3 The Series-Parallel Connection      .  .  .  .  .  .  110

4.4 Series-Parallel Impedance .         .  .  .  .  .  .  111

4.5 Series-Parallel Circuit Analysis .  .  .  .  .  .  .  114

Summary    .        .               .   .  .  .  .  .  .  132

Exercises  .        .               .   .  .  .  .  .  .  133

7
Chapter 5: Analysis Theorems and Techniques . . . . 144

5.0 Chapter Objectives .   .      .     .  .  .  .  .  144

5.1 Introduction .  .      .      .     .  .  .  .  .  144

5.2 Source Conversions .   .      .     .  .  .  .  .  145

5.3 Superposition Theorem  .      .     .  .  .  .  .  153

5.4 Thévenin's and Norton's Theorems .  .  .  .  .  .  160

5.5 Maximum Power Transfer Theorem .    .  .  .  .  .  170

5.6 Delta-Y (Pi-T) Conversions .  .     .  .  .  .  .  179

Summary    .        .      .      .     .  .  .  .  .  185

Exercises  .        .      .      .     .  .  .  .  .  187

Chapter 6: Nodal and Mesh Analysis . . . . . 204

6.0 Chapter Objectives .   .      .     .  .  .  .  .  204

6.1 Introduction .  .      .      .     .  .  .  .  .  204

6.2 Nodal Analysis  .      .      .     .  .  .  .  .  205

6.3 Mesh Analysis   .      .      .     .  .  .  .  .  222

6.4 Dependent Sources .    .      .     .  .  .  .  .  234

Summary    .        .      .      .     .  .  .  .  .  240

Exercises  .        .      .      .     .  .  .  .  .  242

Chapter 7: AC Power . . . . . . . 260

7.0 Chapter Objectives .   .      .     .  .  .  .  .  260

7.1 Introduction .  .      .      .     .  .  .  .  .  260

7.2 Power Waveforms .      .      .     .  .  .  .  .  261

7.3 Power Triangle  .      .      .     .  .  .  .  .  273

7.4 Power Systems   .      .      .     .  .  .  .  .  280

Summary    .        .      .      .     .  .  .  .  .  286

Exercises  .        .      .      .     .  .  .  .  .  287

Chapter 8: Resonance . . . . . . . 294

8.0 Chapter Objectives .   .      .     .  .  .  .  .  294

8.1 Introduction .  .      .      .     .  .  .  .  .  294

8.2 Series Resonance .     .      .     .  .  .  .  .  295

8.3 Parallel Resonance .   .      .     .  .  .  .  .  310

Summary    .        .      .      .     .  .  .  .  .  329

Exercises  .        .      .      .     .  .  .  .  .  331

8
Chapter 9: Polyphase Power . . . . . . 338

9.0 Chapter Objectives .    .          .  .          .  .  .  .  338

9.1 Introduction .  .       .          .  .          .  .  .  .  338

9.2 Polyphase Definition .  .          .  .          .  .  .  .  339

9.3 Three-Phase Connections .          .  .          .  .  .  .  341

9.4 Power Factor Correction .          .  .          .  .  .  .  354

Summary     .       .       .          .  .          .  .  .  .  364

Exercises   .       .       .          .  .          .  .  .  .  365

Chapter 10: Decibels and Bode Plots . . . . . 372

10.0 Chapter Objectives .   .          .  .          .  .  .  .  372

10.1 Introduction   .       .          .  .          .  .  .  .  372

10.2 The Decibel .  .       .          .  .          .  .  .  .  372

10.3 Bode Plots .   .       .          .  .          .  .  .  .  383

10.4 Combining the Elements - Multi-Stage Effects .  .  .  .  .  393

Summary     .       .       .          .  .          .  .  .  .  395

Exercises   .       .       .          .  .          .  .  .  .  396

Appendices

A: Standard Component Sizes .          .  .          .  .  .  .  399

B: Methods of Solution of Linear Simultaneous Equations .  .  .  400

C: Equation Proofs .        .          .  .          .  .  .  .  405

D: Answers to Selected Odd-Numbered Problems .          .  .  .  408

E: Questions for Selected Odd Answers     . . . . . 422

9
1 Fundamentals

1.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Describe sinusoidal waveforms in mathematical terms.
    · Express complex waveforms using basic Fourier analysis.
    · Perform mathematical operations using complex numbers.
    · Draw phasor diagrams for complex numbers.
    · Compute and plot capacitive and inductive reactance as a function of frequency.
    · Compute and plot complex impedance as a function of frequency.
    · Describe the relationships between resistance, reactance, impedance, conductance, susceptance and

         admittance

1.1 Introduction

In this chapter we begin our study of alternating current, or AC, electrical circuit analysis. As such, this chapter
is filled with foundational material that will be used in the remainder of this text. It is critical that the concepts
presented here be fully understood in order to achieve success in later chapters. We start with the mathematical
description of the most simple AC waveform, the sine wave. This includes parameters such as amplitude,
frequency, period, phase and DC offset. From there we discover how to describe other waveforms in terms of
combinations of sine waves, and also how to determine the effective, or DC equivalent, value of a sine wave. AC
analysis is practically impossible to perform without the use of complex numbers, and discussion follows with
their description and proper manipulation. Finally, we introduce the concepts of reactance and impedance, and
how they relate to resistance. This includes examination using both frequency domain plots and phasor
diagrams. Phasor diagrams are vector plots and can be used to show the relationships between various voltages
in a circuit, as well as between currents or resistive/reactive values.

Many of the topics in this text will echo your studies in DC circuit analysis, such as Ohm's law, Kirchhoff's
voltage and current laws, series-parallel analysis, nodal analysis, and the like. Thus many concepts will be
familiar. The major practical difference is that all quantities in DC systems are scalars, that is, they have only
magnitude. In contrast, AC quantities are vectors, and thus have both magnitude and direction (or more properly,
phase). Consequent;y, mathematical operations such as addition or multiplication have to follow vector rules
instead of scalar rules. Forgetting to do so is a common error for students new to the subject and one that will
bring no end of grief. These rules will be reviewed in the section covering complex numbers. Make sure that
you have this material mastered before proceeding.

10
1.2 Sinusoidal Waveforms

AC, or alternating current, is so named because the current alternates or flips back
and forth between two polarities. In other words, the current (and consequently the
voltage) is a function of time. This is fundamentally different from direct current that
is fixed in polarity and generally constant over time. A laboratory DC voltage source,
for example, ideally maintains a set voltage across its terminals and does not vary
over time. In contrast, as an AC waveform swings back and forth through time, its
shape can exhibit wide variations ranging from the simple, regular paths of
laboratory standards such as sine waves, triangle waves and square waves, to the far
more complex and undulating waveforms produced by musical instruments and the
human voice.

The sine wave is the simplest wave that may be created. It represents the motion of a
simple vector rotating at a constant speed, such as the vertical displacement of the
second hand of a clock. An example is shown in Figure 1.1. The horizontal axis plots
time. It increases as we move from left to right (i.e., if point A is to the right of point
B, then A occurs later in time than does B). The vertical axis is represented here in
general as a percentage of maximum but would ordinarily be a measurement of
voltage, current, sound pressure, or the like.

                                   Sine Wave

                     100                                                                     Figure 1.1
                      80                                                                     A sine wave.
                      60
Percentage of Peak    40
                      20
                        0    0.25  0.5            0.75  1
                     -20
                     -40
                     -60
                     -80

                    -100
                          0

                                   Time (cycles)

Note the smooth variation that starts at zero, rises to a positive peak one quarter way
through, falls back to zero when halfway through, continues to a negative peak three
quarters through, and then rises again to where it started. This process then repeats.
Each repeat is referred to as a cycle. In Figure 1.1, one complete cycle is shown.

11
Sine waves exhibit quarter wave symmetry. That is, each quarter (in time) of the
wave is identical to any other if you simply flip it around the horizontal axis and/or
rotate it upright about its peak. The time it takes to complete one cycle is called the
period and is denoted with the symbol T (for Time). The reciprocal of the period is
the frequency, f.

                       f = 1T (1.1)

The frequency indicates how many cycles exist in one second. To honor one of the
19th century researchers in the field, instead of calling the unit "cycles per second",
we use Hertz, named after Heinrich Hertz and abbreviated Hz. In Figure 1.2 three
sine waves are shown with different frequencies; the initial wave (green), a wave at
twice the frequency (blue), and a third at half the frequency or twice the period (red).

                                              Variation in Frequency                      Figure 1.2
                                                                                          Sine wave frequency variation.
                    100

                    80

                    60                                                Double period

Percentage of Peak  40
                    20 Initial

                    0

                    -20
                              Double frequency

                    -40

                    -60

                    -80

                    -100    0.2                 0.4        0.6        0.8            1
                         0

                                                     Time

The amplitude (vertical) of the wave can be expressed as a peak quantity, which is
the change from the center zero line up to the most positive value. Amplitude may
also be expressed as peak-to-peak; the distance from the most negative to the most
positive. For a sine wave this will always be twice the peak value, although that
might not be the case for other waves which may be asymmetrical. A series of three
sine waves with differing amplitudes are shown in Figure 1.3. Along side the initial
(green) are double amplitude (blue) and half amplitude (red) versions.

12
                                      Variation in Amplitude

                        200                                                                     Figure 1.3
                                                                                                Sine wave amplitude variation.
                                                               Double amplitude
                                                                                                Figure 1.4
                        150                                                                     Basic sine wave example.

                                                      Initial
                        100

    Percentage of Peak      50
                             0 One half amplitude

                            -50

                        -100

                        -150

                        -200     0.2                           0.4        0.6         0.8  1
                            0

                                                                    Time

Combining these parameters, consider the voltage waveform shown in Figure 1.4.
Here we see two cycles of an AC voltage waveform.

                        5

                        4

                        3

                        2

                        1

Volts                   0

                        -1

                        -2

                        -3

                        -4

                        -5

                        0        0.1                                0.2          0.3       0.4

                                                               Time (seconds)

13
The peak value is 4 volts and the peak-to-peak value is 8 volts (typically abbreviated
as "8 V pp"). The period of one cycle is 0.2 seconds, or T = 200 milliseconds.
Further, the frequency, f = 1/200 milliseconds, or 5 Hz (5 cycles in one second).

AC waveforms may also be combined with a DC offset. Adding a positive DC level
shifts the wave up vertically, while a negative DC level shifts the wave down
vertically. This does not alter the frequency or AC portion of the amplitude (although
the absolute peaks would shift by the DC value). Figure 1.5 shows the effect of
various DC offsets. Above the initial wave (green) is an otherwise identical wave
with a positive DC offset equal to 20% of the original peak value (blue). Below the
original is a third wave (red) that exhibits a negative DC offset equal to half of the
peak value of the original.

                                                Effect of DC Offset                       Figure 1.5
                                                                                          Sine wave DC offset variation.
                    150

                                   Positive DC offset, 20%

                    100

                          Initial

Percentage of Peak  50

                      0 Negative DC offset, 50%
                    -50

                    -100

                    -150  0.2      0.4                 0.6           0.8  1
                    0

                                                 Time

Further, it is possible for a sine wave to be shifted in time compared to some other
sine wave or reference. While it is possible to indicate this shift as an absolute time,
it is more common to do so as a phase shift, that is, the time expressed as a portion
of the period in degrees. For example, if one sine is ahead of another by one quarter
of the period, it is said to be leading by 90° (i.e., ¼ of 360°). If it is behind by
½ of the period, it is said to be lagging by 180° (i.e., later in time by ½ cycle).
Another way of stating this is that leading waveforms start earlier in time and thus
are drawn to the left of the reference, while lagging waveforms start later in time and
are drawn to the right.

14
Figure 1.6 illustrates the effect of phase shift. Note that in this plot, t = 0 has been
moved to the center of the horizontal axis. The middle curve is the initial, or
reference, wave (green). To the left (red) is a wave leading the initial wave by one-
eighth cycle, or 45°. To the right (blue), is a lagging wave of half as much, or
-22.5°.

                                                   Effect of Phase Shift                    Figure 1.6
                                                                                            Sine wave phase variation.
                    100
                     80 Lagging by 22.5 degrees                                       1
                     60

                    40       Initial

Percentage of Peak  20

                    0

                    -20

                    -40
                    -60 Leading by 45 degrees
                    -80

                    -100                       -0.5  0                    0.5
                         -1

                                                     Time

Combining the foregoing elements allows us to develop a general format for a sine
wave (voltage shown):

                             v (t )=V DC +V P sin(2  f t +)                    (1.2)

                    Where
                    v(t) is the voltage at some time t,
                    VDC is the DC offset, if any,
                    VP is the peak value,
                    f is the frequency,
                     is the phase shift (+ if leading and drawn to the left, - if lagging and drawn
                    to the right).

For a quick and practical example, the waveform shown in Figure 1.4 has an
amplitude of 4 volts peak, a frequency of 5 Hz, and no DC offset or phase shift.
Thus, its expression is v (t )=4 sin(2 5 t )

15
To compute a phase shift, first determine the time differential between the waveform
and the reference, which we'll call t. The reference may be a fixed point in time
(e.g., t = 0) or another waveform. Generally, the easy way to do this is to measure
the difference at the zero-crossings, assuming there is no DC offset. If there is an
offset, make the measurement where the zero crossing has been shifted to (i.e., at the
DC offset level). Once the difference is found, divide it by the period to represent the
shift as a fraction of a period. As one cycle represents one rotation of the vector, or
360 degrees, simply multiply the fraction by 360 degrees to find the phase shift in
degrees. Expressed as a formula:

                      = 360° tT (1.3)

Remember, if the wave is shifted to the left then it is leading and positive, while a
shift to the right is lagging or delayed in time, and thus negative.

Example 1.1

          Write the expression for the waveform shown in Figure 1.7.

          5

          4                                                                                 Figure 1.7
                                                                                            Waveform for Example 1.1.

          3

          2

    Amps  1

          0

          -1

          -2

          -3

          0   5  10                   15                              20

                 Time (milliseconds)

          This waveform superficially may look like the one in Figure 1.4 but don't
          let this fool you. First of all, the time scale is different. For this waveform,
          one cycle completes in 10 milliseconds. Therefore, the frequency is

16
                       f = 1T
                       f= 1

                            10 ms
                       f = 100 Hz

           The second issue is the DC offset. Note that the positive peak occurs at 4
           amps while the negative peak occurs at -2 amps. This indicates a peak-to-
           peak value of 6 amps. Without an offset, the positive peak would be at 3
           amps, therefore there is a +1 amp DC offset. The vertical center of the
           waveform is shifted up from 0 amps to +1 amp. This point is at t = 0,
           therefore, there is no phase shift. The resulting expression is:

                       i(t )=1+3 sin(2 100 t )

Example 1.2

           Write the expression for the waveform shown in Figure 1.8.

           3

                                                                                               Figure 1.8

           2                                                                                   Waveform for Example 1.2.

           1

    Volts  0

           -1

           -2

           -3

           0   1  2                    3                               4

                  Time (milliseconds)

           First off, the positive peak is 2 volts and the peak-to-peak value is 4 volts.
           Therefore there is no DC offset. The vertical center of the wave does not
           start at t = 0, thus there must be a phase shift. The value at t = 0 is 1.2 volts.
           The wave hits this same amplitude at t = 2 milliseconds and begins to repeat
           another cycle. Consequently the period must be 2 milliseconds. The
           frequency is the reciprocal of this value, and thus f = 500 Hz.

17
         The waveform is shifted to the left which indicates a positive or leading
         phase shift. If we examine the second cycle, we see that it hits zero volts at
         1.8 milliseconds. Therefore the shift is 0.2 milliseconds. Expressed in
         degrees this is:

                      = 360°  tT
                      = 360° 0.2 ms

                                   2 ms
                      = 36°

         The final expression is:

                      v (t )=2 sin(2  500 t+36 °)

Example 1.3

         Draw the waveform corresponding to the following expression.
            v (t ) =-3+5 sin (2  40000 t-72° )

         First, note that the -3 volt offset pushes the positive peak down from 5 volts
         to 2 volts, and the negative peak down from -5 volts to -8 volts. The
         frequency of 40 kHz dictates a period of:

                     T = 1f
                     T= 1

                           40 kHz
                     T = 25s

         The phase shift of -72° represents 72/360, or 0.2 cycles. This corresponds to
         a time delay (shifted right because it's negative) of 0.2 times 25 s, or 5 s.

         Initially, it is often best to construct the plot via a series of discrete steps
         rather than trying to draw the entire thing in one go. First, draw a sine wave
         with a 5 volt peak amplitude and a period of 25 s. Now, push the waveform
         down 3 volts so that the positive peak is only 2 volts and the negative peak
         is down at -8 volts. Finally, push the newly shifted waveform to the right by
         5 s. The result is shown in Figure 1.9.

18
           3                                                                         Figure 1.9
                                                                                     Waveform for Example 1.3.
           2

           1

           0

           -1

           -2

    Volts  -3

           -4

           -5

           -6

           -7

           -8

           -9

           0   5  10  15  20  25  30           35  40  45  50

                          Time (microseconds)

Laboratory Measurements

In the laboratory, a function generator is used to generate sines and other          Figure 1.10
waveshapes. These devices will allow precise control over both the amplitude and     Laboratory signal generator.
frequency of the wave along with adding a DC offset, if desired. An example is
shown in Figure 1.10. The corresponding measurement tool is the oscilloscope, or
just scope, for short.

The oscilloscope is perhaps the most useful and versatile measurement device in
the laboratory. Typically, they feature either two or four input channels, although
more are possible. Each input channel has its own sensitivity adjustment and all
channels share a common time reference. The display draws waveforms in the
same manner as those seen in Figures 1.1 - 1.9. Also, they can plot one voltage
versus another (X - Y mode). Modern oscilloscopes have additional features such as
the automatic measurement of frequency, amplitude, phase shift, etc., cursor-based
measurements, and the ability to save display images as graphics files. An example
of a four channel digital oscilloscope is shown in Figure 1.11.

19
                                                                                                                   Figure 1.11
                                                                                                                   A digital oscilloscope.

Schematic Symbols

As far as schematics are concerned, the symbols for AC voltage and current sources
are shown in Figure 1.12. The polarity and direction markings are not absolute; after
all, these are AC sources whose polarity and directions flip back and forth. The
markers are instead used to establish a timing reference, especially in circuits
employing multiple sources.

                                                                                                                   Figure 1.12
                                                                                                                   Schematic symbols for AC
                                                                                                                   voltage source (left) and
                                                                                                                   current source (right).
It is worth remembering that negating a source is the same as flipping its polarity.
This was true for DC sources and remains true for AC sources. This is illustrated in
Figure 1.13. Sometimes flipping or negating source will make analysis a little more
obvious or easier to visualize.
                                                                                                                   Figure 1.13
                                                                                                                   Polarity/sign equivalence.

20
Example 1.4

           Assume an oscilloscope displays two waves as depicted in Figure 1.14.
           Determine the phase shift of the smaller 20 volt peak (blue) waveform
           relative to the larger 25 volt peak (red) waveform.

           25

           20                                                                              Figure 1.14

           15                                                                              Waveforms for Example 1.4.

           10

           5

    Volts  0

           -5

           -10

           -15

           -20

           -25

           0    0.5  1                    1.5  2

                     Time (milliseconds)

           First, note that neither wave exhibits a DC offset. If one or both them had an
           offset, the wave(s) would have to be shifted vertically so that their normal
           zero-crossing points would be at the same level. Measuring either wave, the
           period is found to be 1 millisecond. The time shift most easily can be found
           at any of the zero-crossings (there are four locations to choose from). The
           delay is one small deviation, or 0.1 milliseconds, with the smaller wave
           delayed in time, or lagging the larger wave. This indicates a negative phase
           shift.

                        = 360 ° tT
                        = 360° -0.1 ms

                                     1 ms
                        =-36 °

21
Sines and Cosines

There are a handful of specific phase shifts that are worth a closer look. If a sine
wave is inverted, that is, flipped upside down, it is indistinguishable from a sine
wave that has been shifted either +180 or -180 degrees. In other words, such a wave
can be written three different ways: -sin(2ft), sin(2ft - 180°), or sin(2ft + 180°).
Further, if a sine wave is shifted by +90 degrees (i.e., leading and to the left), it may
also be referred to as a cosine wave. Thus sin(2ft + 90°) = cos(2ft). Finally, if a
sine wave is shifted by -90 degrees (i.e., lagging and to the right), it may be referred
to as a negative or inverted cosine wave. Thus sin(2ft - 90°) = -cos(2ft). The
relationships of these four waves are illustrated in Figure 1.15.

                                                            Sines and Cosines

                    100                                                                              Figure 1.15
                                                                                                     Time relationships between
                    80                                                                               sines and cosines.

Percentage of Peak  60                                                                        1
                                               Cosine

                    40

                    20 Sine

                    0

                    -20 -Sine

                    -40
                                            -Cosine

                    -60

                    -80

                    -100     0.1  0.2                  0.3  0.4  0.5   0.6     0.7  0.8  0.9
                          0

                                                                 Time

It is also worth noting that the cosine wave represents the first derivative, or slope,
of the sine wave. As you may recall from other studies, the slope or "steepness" of a
line is the ratio of the vertical change to the horizontal change, sometimes called
"the rise over the run". For a voltage, it would be the change in voltage over the
change in time, or V/t. For a smooth, continuously changing curve like a sine
wave, the slope at a given point is defined properly as the first derivative, or dv/dt in
this case. To verify that this is true visually, note that the steepest part of the sine
wave (green) is where it crosses zero amplitude. As it crosses zero while moving
positive (at t = 0 or t = 1 in Figure 1.15), the cosine (blue) is at its positive peak. As
the sine cross zero while moving negative (at t = 0.5), the cosine is at its negative
peak. Further, the sine wave is flat with a slope of zero at its positive and negative
peaks (at at t = 0.25 and t = 0.75, respectively), and at those times the cosine's

22
amplitude is also zero. It is also true that the sine wave is the slope of the negative
cosine wave, the negative cosine is the slope of the negative sine, and the negative
sine is the slope of the cosine. Moving in the reverse direction, we can say that the
anti-derivative (indefinite integral) of a cosine wave is a sine wave, the integral of a
sine wave is a negative cosine wave, and so forth. These relationships will prove
most useful when we turn our attention to the response of capacitors and inductors in
AC circuits.

RMS - Root Mean Square Measurement

Along with peak and peak-to-peak, amplitude may be given as an RMS (Root Mean
Square) value. In fact, if peak or peak-to-peak is not specified, the measurement
is assumed to be RMS. RMS is a special calculation used for finding equivalent DC
power (very common, for example, with audio power amplifiers). In other words, if
we are interested in finding the power in a resistor, the calculation must be
performed using RMS values for voltage or current, not peak or peak-to-peak values.
Failure to do so will result in erroneous powers. This is true regardless of the
waveshape; be it a sine wave, triangle wave or the complex waves of music signals.
If a voltage is specified as RMS, it can be treated for power calculations just like an
equivalently sized DC voltage. For example, a 1 volt RMS sine will produce the
same power dissipation and heating in a given resistor as will 1 volt DC. For this
reason, RMS is sometimes referred to as the effective value (i.e., effective DC value).

The name root-mean-square describes the process of determining the effective
value. First, recall that power is proportional to the square of the voltage or current.
Thus, our first step will be to square the input waveform. Of course, the waveform is
a function of time and its square will yield some new shape. At this point, we need to
find the average value of this new shape. The reason for this is simple, yet not
necessarily obvious. Electrical and electronic components have mass, and thus do
not heat or cool instantly. They exhibit a thermal time constant. Therefore, they
respond to the average input over time. While we could compute some manner of
"instantaneous peak power" at some specific instant in time, it does not represent the
equivalent DC power. Once we have obtained the mean value of this squared
waveform, the corresponding DC value is just the square root of the mean. The result
is a fractional value between zero and one that is used as a scaling factor to turn a
peak value into an RMS value. The value will be unique to the specific waveshape.
That is, all sines (regardless of phase) have the same factor, all regular triangle
waves have the same factor, and so on. As we mostly concern ourselves with sines,
let's take a closer look at determining the RMS factor for them.

We begin with the basic expression for a sine wave without DC offset or phase shift,
and with an amplitude of one:

                      v (t )=sin (2  f t )

23
The first step is to square this waveform. A useful trigonometric identity is

                     (sin x)2=12 -12 cos 2 x

Applying this to our wave yields:

                          21 1
                     v (t ) = - cos (2  2 f t)

                              22

This expression describes an inverted cosine wave at twice the original frequency
and half of the original amplitude, riding on a DC offset equal to its peak value. In
other words, the negative peak of the cosine is at zero and the positive peak is at 1.
The next step is to find the average or mean value of this intermediate result. The
mean is equal to the offset of 0.5. This can be visualized as the area above the offset
perfectly filling the "dip" below the offset. The final step is to take the square root of
the mean. The square root of 0.5 is equal to one over the square root of two, or
approximately 0.707. Therefore the RMS value is 0.707 times the peak. Alternately,
you could divide the peak by square root of two, or approximately 1.414. This
process is shown graphically in Figure 1.16.

                  1.00                                                                      Figure 1.16
                  0.75                                                                      Process to find RMS factor for
                  0.50                                                                      sines.
                  0.25
                  0.00                                Mean

Fraction of Peak         Sine squared

                  -0.25

                  -0.50                Original sine
                  -0.75

                  -1.00

                  0      0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9  1

                                       Time

In summation, for sine waves, RMS is always the peak value times 0.707. We could
also say the RMS value of any sine wave is its peak divided by approximately 1.414.
Again, these ratios would not necessarily be true of non-sine waves. Details
regarding other common shapes can be found in Appendix C. Finally, the ratio of the
peak value to the RMS value is called the crest ratio. This is a fixed value for sine
waves (again, about 1.414), but can be over 10:1 for some kinds of audio signals.

24
Wavelength

Another item of interest is the speed of propagation of the wave. This varies widely.
In the case of light in a vacuum (or to a close approximation, an electrical current in
a wire), the velocity is about 3E8 meters per second (i.e., 300,000 km/s) or about
186,000 miles per second.

Given a velocity and a period, we can imagine how far apart the peaks of the wave
are. This distance is called the wavelength and is denoted by the Greek letter lambda
. Wavelength is equal to the velocity divided by the frequency,  = v/f. Thus, for a
loudspeaker producing a 100 Hz sine, as the velocity of sound in air is 344 m/s, then
 = 344 m/s / 100 Hz, or 3.44 meters (a little over 11 feet). Notice that the higher the
frequency, the shorter the wavelength. Also, note that the faster the velocity, the
longer the wavelength. Wavelength calculations are of particular importance in the
fields of telecommunications and acoustics.

1.3 Basic Fourier Analysis

The Fourier theorem, named after the French mathematician Jean-Baptiste Joseph
Fourier, states that any repetitive waveform can be represented as a collection of sine
and cosine waves of the proper amplitude and frequency. Alternately, it may be
represented as a series of sine waves each with the proper amplitude, frequency and
phase. This includes complex signals such as the human voice and musical
instruments. Consequently, if a system is linear, the response of a system to a
complex wave may be understood in terms of its response to individual sine waves,
via superposition.

In this collection of waves, each component is known as a partial with the lowest
frequency component known as the fundamental. All other partials are grouped
together and referred to as overtones. "Regular" waveforms such as square waves
and triangle waves feature a harmonic overtone sequence meaning that these
overtones are integer multiples of the fundamental. As a shortcut, they are often
referred to as just harmonics.

It might be hard to visualize initially, but like all waves, waves in the shape of a
square or triangle are made up of a series of sines. The equation for a square wave is:

             v(t)  n1  1 2n 1 sin((2n 1)2ft) (1.4)

This says that a square wave of frequency f is made up of an infinite series of sines
at odd integer multiples of f, with an inverse amplitude characteristic. For example, a
100 Hz square consists of a 100 Hz sine, plus a 300 Hz sine at 1/3 amplitude, plus a
500 Hz sine at 1/5 amplitude, plus a 700 Hz sine at 1/7 amplitude, and so on.

25
A triangle wave is similar:

             v(t)  n1 (2n 1)2  1 cos((2n 1)2ft) (1.5)

Thus a triangle wave of frequency f is made up of an infinite series of cosines (sines
with a 90 degree or one quarter cycle phase shift) at odd integer multiples of f, with
an inverse square amplitude characteristic. For example, a 100 Hz triangle consists
of a 100 Hz cosine, plus a 300 Hz cosine at 1/9 amplitude, plus a 500 Hz cosine at
1/25 amplitude, plus a 700 Hz cosine at 1/49 amplitude, and so on.

A series of graphs showing the construction of a square wave and a triangle wave
follow. The square wave sequence begins with the fundamental and the first
harmonic in Figure 1.17. The result is an oddly bumpy wave. The second graph of
Figure 1.18 adds the next two harmonics. As more harmonics are added, the sides
get steeper and the top/bottom start to flatten. They flatten because each additional
harmonic partially cancels some of the peaks and valleys from the previous
summation. This gives rise to a greater number of undulations with each undulation
being smaller in amplitude. The sequence finishes with Figure 1.19 showing seven
harmonics being added with the result approaching a reasonable square wave. As
ever more harmonics are added, the wave would approach a flat top and bottom with
vertical sides, the idealized square wave.

                     Building a Square Wave

              1.0                      Fundamental plus third harmonic                  Figure 1.17
              0.8                                                                       Building a square wave, part 1.
              0.6    Fundamental
              0.4
    Voltage   0.2
              0.0
             -0.2    Third harmonic
             -0.4
             -0.6    0.2          0.4        0.6  0.8  1
             -0.8
             -1.0

                  0

                                       Time

26
                     Building a Square Wave

              1.0    Fundamental                Fundamental plus third,         Figure 1.18
              0.8         Fifth harmonic        fifth and seventh harmonics     Building a square wave, part 2.
              0.6
    Voltage   0.4                                                               Figure 1.19
              0.2                                                               Building a square wave, part 3.
              0.0                                          Seventh harmonic
             -0.2
             -0.4    Third harmonic
             -0.6
             -0.8    0.2                   0.4        0.6  0.8               1
             -1.0

                  0

                                                Time

                     Building a Square Wave

             1.0                                Fundamental plus
                              Fundamental
                                                seven harmonics:
             0.5                                3, 5, 7, 9, 11, 13, 15

    Voltage  0.0

             -0.5

             -1.0

             0       0.2                   0.4        0.6  0.8               1

                                                Time

27
The triangle sequence begins with a fundamental and the first harmonic as shown in
Figure 1.20. The resulting combination is already trending away from a simple sine
shape. The second and final graph, Figure 1.21, shows a total of seven harmonics.
The result is very close to a triangle, the only obvious deviation is the slight
rounding at the very peaks. The addition of more harmonics would cause these to
sharpen further.

                                          Building a Triangle Wave                                             Figure 1.20
                                                                                                               Building a triangle wave,
                                                 One Harmonic                                                  part 1.

         1.5
                                                                                          Fundamental plus
                                                                                          one harmonic

         1.0

                           Fundamental
         0.5

Voltage   0.0                Harmonic at three
         -0.5                times fundamental

         -1.0

         -1.5   0.5          1                         1.5
         0                                                                                                  2

                             Time

                             Building a Triangle Wave
                                 Seven Harmonics

         1.5                       Fundamental plus                                                                   Figure 1.21
         1.0                       seven harmonics                                                                    Building a triangle wave,
         0.5                                                                                                          part 2.
         0.0    Fundamental
        -0.5                                                                                                2
Voltage -1.0
        -1.5
                0.5          1                         1.5
             0
                             Time
28
1.4 Complex Numbers

In AC circuits, parameters such as voltage and current are vectors, that is, they have
both a magnitude and a phase shift or angle. For example, a voltage might be "12
volts at an angle of 30 degrees" (or more compactly, 1230º). This is known as
polar form or magnitude-angle form. Alternately, a vector can be broken into
rectangular form, that is, its right angle components.

This can be visualized as a right triangle where the magnitude is the hypotenuse, the
angle is the rotation above or below the horizontal, the horizontal component is the
side adjacent to the angle and the vertical component is the side opposite of the
angle. This is shown in Figure 1.22.

        Magnitude                                                   Vertical            Figure 1.22
                                                                    component           Polar and rectangular forms.
           
       Horizontal component

Properly, voltage and current vectors are complex numbers that lay on a complex
plane consisting of a real part and an imaginary part. The horizontal axis is the real
number axis and the vertical axis is the imaginary number axis. The imaginary axis
denotes values times the imaginary operator j (and often referred to as i outside of
electrical analysis). The j operator is the square root of -1. An example of such a
value is 3 + j4, in other words, 3 units along the horizontal real axis and 4 units up
the vertical imaginary axis. This is depicted in Figure 1.23.

       +Imaginary (+j)

                                                  Magnitude         Imaginary           Figure 1.23
                                                                    component           Polar and rectangular forms on
                                                                                        the complex plane.
                                                    Real component  +Real
-Real

                                 -Imaginary (-j)

29
Converting from one form to another relies on basic trigonometric relations. For
convenience, the relationships between the magnitude, angle, real component and
imaginary component are reproduced below:

    Magnitude = Real 2+Imaginary2                                    (1.6a - d)

                 = tan-1 Imaginary Real
           Real = Magnitude cos 
    jImaginary = Magnitude sin 

To add or subtract complex quantities, first put them into rectangular form and then
combine the reals with the reals and the j terms with the j terms as in (3 + j5) +
(13 - j1) = 16 + j4. These real and imaginary terms must be kept separate. 3 + j5
does not equal 8 (or even j8). That would be like saying that moving 3 feet to your
right and 5 feet forward puts you in the same location as moving 8 feet to your right
(or 8 feet forward).

The direct way to multiply or divide complex values is to first put them in polar
form and then multiply or divide the magnitudes. The angles are added together for
multiplication and subtracted for division. For example, 1230º times 245º is
2475º while dividing them yields 6-15º. The need for complex numbers will
become more obvious as we move through the upcoming material. It is imperative
that you have mastered the manipulation of complex values before moving on to
subsequent chapters.

Example 1.5

    Convert 15 + j20 and 1 k - j2 k into polar form, and 1045º and 0.2-30º
    into rectangular form.

    For the first two conversions, use Equations 1.6a and 1.6b.

    ( ) Magnitude = 152+202 = 25
                = tan-1 20 = 53.1º
                             15

       1  k2+(-2      2     2.236        k
    =( ) Magnitude       =
                  k)

     = tan-1 -2 k 1 k = -63.4º

    The answers for the first part are 2553.1º and 2.236 k-63.4º.

    For the second pair of conversions use Equations 1.6c and 1.6d.

30
                              Real = 10 cos 45º = 7.07
                      jImaginary = 10sin 45º = j 7.07

                              Real = 0.2 cos-30º = 0.173
                      jImaginary = 0.2 sin-30º =- j 0.1

         The answers for the second part are 7.07 + j7.07 and 0.173 - j0.1.

Example 1.6

         Perform the following: a) Add 7 + j8 to + j6, b) Subtract 553.1º from
         10-45º, c) Divide 2090º by 4-50º, d) Multiply 90 + j75 by 6 + j10.

         a) Add real to real and imaginary to imaginary: 7 + j14.

         b) First convert the values into rectangular: 3 + j4 and 7.07 - j7.07. Now
         subtract the first pair from the second pair: 4.07 - j11.07 (or 11.8-69.8º).

         c) Divide the magnitudes and subtract the angles: 5140º.

         d) First convert the values into polar: 117.1539.8º and 11.6659º. Now
         multiply the magnitudes and add the angles: 1.366 k98.8º.

1.5 Reactance and Impedance

Unlike a resistor, the voltage and current will not be in phase for an ideal capacitor
or for an ideal inductor. For the capacitor, the current leads the voltage across the
capacitor by 90 degrees. Recall that the voltage across a capacitor cannot change
instantaneously, i = C dv/dt. For an inductor, the voltage leads the current by 90
degrees. Similarly, the current through an inductor cannot change instantaneously
due to v = L di/dt. While ideal capacitors and inductors do not exhibit resistance, the
voltage does react to the current. Unsurprisingly, we call this characteristic
reactance and denote it with the letter X. Reactance, like resistance, is a ratio of
voltage to current. We define capacitive reactance as:

    X C = vc                 (1.7)
            ic

Using a simple sine wave with a peak value of unity, vc = sin 2 f t, ic can be found
from i = C dv/dt. Recall from our prior work that the derivative or slope of a sine
wave is a cosine wave, which is in turn equivalent to a sine wave shifted by +90º.

31
                   ic = C dvc dt
                   ic = C d sin(2  f t ) dt
                   ic = C sin (2  f t +90º)

Substituting this result into Equation 1.7 yields:

                   X C = vc
                           ic

                   X C = sin (2  f t ) 2  f C sin (2  f t+90º)
                   X C = 1 2  f C  -90º

Or more directly:

                   X C = - j 1 2  f C (1.8)

In summation, if we divide the capacitor's sinusoidal voltage by its current (Ohm's
law), we obtain a value with a phase angle of -90°. While the resultant is an ohmic
value, it cannot be classified as a resistance. Instead, it is referred to as a reactance
and denoted with the letter X. Thus we can refer to a capacitor's reactance, XC, as
some number at an angle of -90º, or more conveniently, we simply prepend -j, as in
XC = -j75 .

The case for the inductor is similar and left as an exercise. The inductive reactance,
XL, can be found using:

                   X L=+j 2  f L                                (1.9)

An example would be XL = j68 . As stated, while a resistance cannot be added
directly to a reactance, reactances can be added together so long as we heed the
signs. For example, if we have a capacitive reactance of -j60  in series with an
inductive reactance of j100 , the result is j40 . This is due to the fact that these
two items are 180 degrees out of phase with each other, and so they partially cancel.
Remember, always add or subtract like items: real (resistance) to real, and imaginary
(reactance) to imaginary.

Equations 1.8 and 1.9 are notable because the reactance is not just a function of the
capacitance or inductance, but also a function of frequency. The reactance of an
inductor is directly proportional to frequency while the reactance of a capacitor is
inversely proportional to frequency. The ohmic variations of a 20  resistor, a
500 F capacitor and a 500 H inductor across frequency are shown in Figure 1.24.

32
We can see that the value of resistance does not change with frequency while the
inductive reactance increases with frequency and the capacitive reactance decreases.

Resistance or Reactance (ohms)                            Resistance & Reactance vs. Frequency                                 Figure 1.24
                                                                                                                               Resistance and reactance
                                35                                                                                             versus frequency (linear axis).

                                30

                                25
                                                                 20 ohm resistor

                                20

                                15
                                                                                                  500H Inductor

                                10

                                5

                                    500 F capacitor

                                0   2,000       4,000  6,000                                                     8,000  1e+04

                                                     Frequency (Hz)

The linear frequency scale makes the capacitor change difficult to see. If this is
plotted again but using a logarithmic frequency scale as in Figure 1.25, the
symmetry becomes apparent.

Resistance or Reactance (ohms)                            Resistance & Reactance vs. Frequency                                 Figure 1.25
                                                                                                                               Resistance and reactance
                                35                                                                                             versus frequency (log axis).
                                30
                                25

                                20
                                                                                        20 ohm resistor

                                15

                                10 500F capacitor 500H Inductor
                                 5

                                0          100                                                           1,000          1e+04
                                10

                                                     Frequency (Hz)

33
The effect of both capacitor size and frequency is shown in Figure 1.26 using a log
frequency axis: the smaller the capacitor, the larger the capacitive reactance at any
particular frequency.

                                            Capacitive Reactance vs. Frequency

                  40

                                                                                                                               Figure 1.26

                  35                                                                            Variation of capacitive

                                                                                                reactance with capacitance and

                  30                                                            100 nF          frequency.

Reactance (ohms)  25                                               1 F

                  20                        10 F

                  15                 50 F

                  10

                              200 F
                   5

                  0                                                1e+04
                  100                       1,000                                       1e+05

                                                   Frequency (Hz)

Similarly, the effect of both inductor size and frequency is shown in Figure 1.27
using a linear frequency axis: the larger the inductor, the larger the inductive
reactance at any given frequency.

                                            Inductive Reactance vs. Frequency

                  50

                                                                                                                               Figure 1.27
                  45 Variation of inductive reactance

                  40                                                                            with inductance and frequency.

Reactance (ohms)  35 3 mH
                  30
                  25 1 mH

                  20

                  15                               400 H

                  10

                  5                                                50 H

                  0                  2,000  4,000         6,000                 8,000   10,000
                  0

                                                   Frequency (Hz)

34
It is worth noting that the plots of Figures 1.26 and 1.27 are for ideal components. In
reality, all components exhibit some resistive, capacitive and inductive effects due to
their construction. For example, eventually, inductive and resistive effects will cause
the capacitive reactance curves of Figure 1.26 to begin to rise at high frequencies.
Similarly, resistive and capacitive effects will cause the curves Figure 1.27 to flatten
at very low and very high frequencies.

An interesting observation to remember is that capacitors and inductors are a bit like
a Chimera. That is, they look like different things to different sources, all mashed
together at once. It would be improper to think of, say, a particular inductor as being
"so many ohms". If the source signal is comprised of multiple sine waves, such as a
square wave or a music waveform, the inductor "looks like" a different ohmic value
to each of the different frequency components, simultaneously. This is an important
concept and one that we can take great advantage of, for example, in the design of
filter circuits.

Impedance

We now arrive at impedance. Impedance is a mixture of resistance and reactance,
and is denoted by Z. This can be visualized as a series combination of a resistor and
either a capacitor or an inductor. Examples include Z = 100 - j50 , i.e., 100 ohms
of resistance in series with 50 ohms of capacitive reactance; and Z = 60045º ,
i.e., a magnitude of 600 ohms that includes resistance and inductive reactance (it
must be inductive reactance and not capacitive reactance because the sign of the
angle is positive).

To complete this system, we have susceptance and admittance. Susceptance, B, is
the reciprocal of reactance. Admittance, Y, is the reciprocal of impedance. These are
similar to the relation between conductance and resistance, and are convenient for
parallel circuit combinations.

Example 1.7

         Determine the reactances of a 1 mH inductor and a 2 F capacitor to a sine
         wave of 2 kHz. Repeat for a frequency of 50 kHz.

         Use Equations 1.8 and 1.9. For the capacitor at 2 kHz we have:

                      X C = - j 1 2  f C
                      X C =- j 1 2  2 kHz 2 F
                      X C = - j 39.8 

35
         For the second source, 50 kHz is 25 times larger than the original and
         capacitive reactance is inversely proportional to frequency. Therefore XC is
         25 times smaller, or -j1.59 .

         For the inductor at 2 kHz,

                      X L = +j 2 f L
                      X L = +j 2  2 kHz 1 mH
                      X L = +j 12.57

         Inductive reactance is directly proportional to frequency. Thus, increasing f
         by a factor of 25 increases XL by the same factor, resulting in j314.2 .

Example 1.8

         Determine the susceptance of an inductor whose reactance is j400 .
         Further, if this inductor is placed in series with a 1000  resistor, determine
         the resulting impedance in polar form, as well as the admittance.

         Susceptance is the reciprocal of reactance.

                      BL = 1
                             XL

                      BL = 1 j 400
                      BL =- j 2.5 millisiemens

         The impedance, Z, is the vector sum, or 1000 + j400 . Converting this to
         polar form:

               Magnitude = Real2 +Imaginary2
               Magnitude = 10002+4002

                     Magnitude = 1077

        ( )  = tan-1 Imaginary Real
        ( )  = tan-1 400 1000

                      = 21.8º

         The result is Z = 107721.8º . The admittance is the reciprocal, yielding
         Y = 928E-6-21.8º S.

36
1.6 Phasor Diagrams

A time domain representation of sine waves as drawn earlier tells us everything we
need to know about the waves, however it is not the most compact method of
displaying them, nor are they easy to sketch by hand. Consider the the plot of Figure
1.28. Here, two sine waves (green and red) combine to create a third sine wave
(blue). While the general idea of the two waves adding is apparent in the graph, it
takes a moment of inspection to determine the wave magnitudes and the precise
phase relationships between them. In contrast, phasor diagrams can be used to show
the relationships of multiple sines waves in a simple and easy to read format. They
can also be used to show how various voltages or currents combine.

                                                          Adding Sines

                    150

                                       Resultant wave                                      Figure 1.28
                          Initial                                                          A time domain plot.

Percentage of Peak  100
                     50

                                                               Additional wave
                    0

                    -50

                    -100

                    -150

                    -1    -0.5                                                  0  0.5  1

                                                       Time

The phasor diagram is based on the complex plane discussed previously where the
horizontal is the real axis and the vertical is the imaginary (j) axis. The magnitude
and phase of each wave can then be drawn as a vector, and the relationships between
the waves is shown directly. For manual plotting, it is convenient to convert from
polar form to rectangular form. In the example phasor diagram of Figure 1.29, two

vectors are shown: 8 + j6 and 5 - j3 (equivalent to 1036.9º and 5.83-31º).
Phasor diagrams can be used to plot voltages, currents and impedances. We shall
make considerable use of them in upcoming chapters.

37
                                                                                                                   Figure 1.29
                                                                                                                   A phasor diagram.

1.7 Summary

The most simple of AC waveforms is the sine wave. It can be thought of as the
vertical displacement of a vector rotating at a constant speed, like the second hand of
a clock. The length of the second hand represents the height or amplitude of the sine
wave and the speed of rotation represents its period. As the speed tends to be very
fast, it is more convenient for us to use frequency, which is just the reciprocal of the
period. Sines can be displaced vertically, which is also called a DC offset, as well as
having a horizontal or time shift. When expressed relative to a single cycle, this
change is referred to as the phase shift. Finally, waveforms such as square waves,
triangle waves and even more complex waveforms such as voice or music can be
described in terms of combinations of sounds. Indeed, Fourier analysis tells us that
any repeating waveform can be described as a series of sines each with the
appropriate frequency, amplitude and phase shift. In order to determine the
"effective DC value" of a sine wave, that is, the value that produces the same power
dissipation, RMS values are used. The RMS value of a sine wave is its peak value
divided by the square root of two (approximately equal to 0.707 of peak).

Complex numbers are used to describe AC voltages and currents, among other
things. They consist of two parts: a real part and an imaginary part that is plotted
perpendicular to the real part. All mathematical operations on complex numbers
must follow vector rules. This includes basic trigonometric operations.

Reactance can be thought of as the imaginary axis version of resistance. That is, it
restricts current flow. The difference is that there is a 90 degree phase shift between
the current and voltage through a reactive element while the two are in phase for
resistive elements. Capacitive reactance is inversely proportional to frequency while
inductive reactance is directly proportional to frequency. The combination of
resistance and reactance is known as impedance. Phasor diagrams may be used to
plot the components of a complex impedance as well as show the relations between
voltages or currents in a circuit.

38
Review Questions

    1. What is a sine wave? Describe its constituent parameters (amplitude,
         frequency, offset, etc.).

    2. What is the relationship between the frequency, period and phase of a sine
         wave?

    3. What is the mathematical relationship between a sine wave and a cosine
         wave?

    4. What is meant by the term RMS (root-mean-square) and what does it have to
         do with AC versus DC voltages, currents and powers?

    5. Describe the difference between a scalar and a vector.
    6. What is a complex number?
    7. Detail the relationships between resistance, reactance, impedance,

         conductance, susceptance and admittance.
    8. Describe how capacitive reactance varies with frequency.
    9. Describe how inductive reactance varies with frequency.
    10. Describe a phasor diagram.

1.8 Exercises

Analysis

    1. Determine the AC peak and RMS voltages, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 10 sin 2 1000 t

    2. Determine the AC peak and RMS voltages, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 0.4 sin 2 5000 t

    3. Determine the peak AC portion voltage, DC offset, frequency, period and
         phase shift for the following expression: v(t) = -3 + 20 sin 2 50 t

    4. Determine the peak AC portion voltage, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 12 + 2 sin 2 20000 t

    5. Determine the AC peak and RMS voltages, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 10 sin (2 100 t + 45°)

    6. Determine the AC peak and RMS voltages, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 5 sin (2 1000 t - 90°)

    7. Determine the peak AC portion voltage, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 10 + 1 sin (2 400 t - 45°)

    8. Determine the peak AC portion voltage, DC offset, frequency, period and
         phase shift for the following expression: v(t) = 10 + 10 sin (2 5000 t + 30°)

39
    9. A 1 kHz sine wave has a phase of 72°. Determine the time delay. Repeat for
         a 20 kHz sine wave.

    10. A 2 kHz sine wave has a phase of 18°. Determine the time delay. Repeat for
         a 100 kHz sine wave.

    11. An oscilloscope measures a time delay of 0.2 milliseconds between a pair of
         500 Hz sine waves. Determine the phase shift.

    12. An oscilloscope measures a time delay of -10 microseconds between a pair
         of 20 kHz sine waves. Determine the phase shift.

    13. Convert the following from rectangular to polar form: a) 10 + j10 b) 5 - j10
         c) -100 + j20 d) 3k + j4k

    14. Convert the following from rectangular to polar form: a) 2k + j1.5k
         b) 8 - j8 c) -300 + j300 d) -1k - j1k

    15. Convert these from polar to rectangular form: a) 1045° b) 0.490°
         c) -960° d) 100-45°

    16. Convert these from polar to rectangular form: a) -460° b) -0.930°
         c) 5120° d) 6-135°

    17. Perform the following computations: a) (10 + j10) + (5 + j20)
         b) (5 + j2) + (-5 + j2) c) (80 - j2) - (100 + j2) d) (-65 + j50) - (5 - j200)

    18. Perform the following computations: a) (100 + j200) + (75 + j210)
         b) (-35 + j25) + (15 + j8) c) (500 - j70) - (200 + j30)
         d) (-105 + j540) - (5- j200)

    19. Perform the following computations: a) (100 + j200)  (75 + j210)
         b) (-35 + j25)  (15 + j8) c) (500 - j70) / (200 + j30)
         d) (-105 + j540) / (5- j200)

    20. Perform the following computations: a) (10 + j10)  (5 + j20)
         b) (5 + j2)  (-5 + j2) c) (80 - j2) / (100 + j2) d) (-65 + j50) / (5- j200)

    21. Perform the following computations: a) (100°)  (100°)
         b) (545°)  (-220°) c) (20135°) / (40-10°) d) (80°) / (3245°)

    22. Perform the following computations: a) (0.30°)  (3180°)
         b) (5-45°)  (-420°) c) (0.0595°) / (0.04-20°)
         d) (5000°) / (60225°)

    23. Perform the following computations: a) (0.30°) + (3180°)
         b) (5-45°) + (-420°) c) (0.0595°) - (0.04-20°)
         d) (5000°) - (60225°)

    24. Perform the following computations: a) (100°) + (100°)
         b) (545°) + (-220°) c) (20135°) - (40-10°)
         d) (80°) - (3245°)

40
    25. Determine the capacitive reactance of a 1 F capacitor at the following
         frequencies: a) 10 Hz b) 500 Hz c) 10 kHz d) 400 kHz e) 10 MHz

    26. Determine the capacitive reactance of a 220 pF capacitor at the following
         frequencies: a) 10 Hz b) 500 Hz c) 10 kHz d) 400 kHz e) 10 MHz

    27. Determine the capacitive reactance at 50 Hz for the following capacitors:
         a) 10 pF b) 470 pF c) 22 nF d) 33 F

    28. Determine the capacitive reactance at 1 MHz for the following capacitors:
         a) 22 pF b) 560 pF c) 33 nF d) 4.7 F

    29. Determine the inductive reactance of a 100 mH inductor at the following
         frequencies: a) 10 Hz b) 500 Hz c) 10 kHz d) 400 kHz e) 10 MHz

    30. Determine the inductive reactance of a 100 mH inductor at the following
         frequencies: a) 10 Hz b) 500 Hz c) 10 kHz d) 400 kHz e) 10 MHz

    31. Determine the inductive reactance at 1 kHz for the following inductors:
         a) 10 mH b) 500 mH c) 10 H d) 400 H

    32. Determine the inductive reactance at 500 kHz for the following inductors:
         a) 1 mH b) 40 mH c) 2 H d) 50 H

    33. Draw phasor diagrams for the following: a) 5 + j2 b) -10 -j20 c) 845°
         d) 2-35°

    34. Draw phasor diagrams for the following: a) 60j-20 b) -40 + j500
         c) 0.05-45° d) -1560°

    35. The fundamental of a certain square wave is a 5 volt peak, 1 kHz sine.
         Determine the amplitude and frequency of each of the next five harmonics.

    36. The fundamental of a certain triangle wave is a 10 volt peak, 100 Hz sine.
         Determine the amplitude and frequency of each of the next five harmonics.

Design

    37. Determine the capacitance required for the following reactance values at
         1 kHz: a) 560  b) 330 k c) 470 k d) 1.2 k e) 750 

    38. Determine the capacitance required for the following reactance values at
         20 Hz: a) 56 k b) 330 k c) 470 k d) 1.2 k e) 750 

    39. Determine the inductance required for the following reactance values at
         100 MHz: a) 560  b) 330 k c) 470 k d) 1.2 k e) 750 

    40. Determine the inductance required for the following reactance values at
         25 kHz: a) 56  b) 33 k c) 470 k d) 1.2 k e) 750 

41
    41. Which of the following have a reactance of less than 100  for all
         frequencies below 1 kHz? a) 2 mH b) 99 mH c) 470 pF d) 10000 F

    42. Which of the following have a reactance of less than 8  for all frequencies
         above 10 kHz? a) 10 nH b) 5 mH c) 56 pF d) 470 F

    43. Which of the following have a reactance of at least 1k  for all frequencies
         above 20 kHz? a) 2 mH b) 200 mH c) 680 pF d) 33 F

    44. Which of the following have a reactance of at least 75  for all frequencies
         below 5 kHz? a) 680 H b) 10 mH c) 82 pF d) 33 nF

Challenge

    45. Determine the negative and positive peak voltages, RMS voltage, DC offset,
         frequency, period and phase shift for the following expression:
         v(t) = -10 sin (2 250 t + 180°)

    46. Determine the negative and positive peak voltages, DC offset, frequency,
         period and phase shift for the following expression:
         v(t) = 1 - 100 sin 2 50000 t

    47. Assume you have a DC coupled oscilloscope set as follows:
         time base = 100 microseconds/division, vertical sensitivity = 1 volt/division.
         Sketch the display of this waveform: v(t) = 2 + 3 sin 2 2000 t

    48. Assume you have a DC coupled oscilloscope set to the following:
         time base = 20 microseconds/division, vertical sensitivity = 200
         millivolts/division. Sketch the display of this waveform:
         v(t) = -0.2 + 0.4 sin 2 10000 t

    49. A 200  resistor is in series with a 1 mH inductor. Determine the impedance
         of this combination at 200 Hz and at 20 kHz.

    50. A 1 k resistor is in series with an inductor. If the combined impedance at
         10 kHz is 1.41 k45°, determine the inductance in mH.

42
Notes

                                                                                                                                    
43
2 Series RLC Circuits

2.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Utilize Kirchhoff's voltage law, the voltage divider rule and Ohm's law to find node and component
         voltages in series RLC networks that utilize voltage sources or a single current source.

    · Compute complex impedance and system current in series RLC circuits.
    · Draw phasor diagrams for impedance and component voltages in series RLC circuits.

2.1 Introduction

In this chapter we introduce series RLC circuits for the AC case. There is much here that will be familiar from
your prior studies with DC series circuits, however, there will be a few notable changes and perhaps a surprise or
two lurking. The key to most of this is to remember that all computations involve vector quantities. In fact, DC
can be thought of as a special case of AC; namely, the frequency drops to zero hertz causing XC to approach an
open and XL to drop to zero. This leaves us with just resistors and scalar quantities because the phase angles in
the remainder of the circuit collapse to zero for DC steady state.

Many of the solution techniques from DC analysis will be applicable here. This includes the use of Ohm's law
and Kirchhoff's voltage law, along with the voltage divider rule. Generally, reactance values will need to be
computed from capacitor and inductor values before the main analysis may begin. In this chapter, as in the most
of the remaining chapters, we shall be concerned with determining the circuit response based on a source with a
single frequency of excitation, in other words, a simple sine wave.

To clarify our analyses, we shall make considerable use of both time domain voltage plots as well as phasor
diagrams.

2.2 The Series Connection

A series connection is always characterized by a single loop or path for current flow. There are no junctions
from which current can flow out of or into. Consequently,

    The current is the same everywhere in a series connection.  (2.1)

Each component in such a loop will see the same current, regardless of whether it is a resistor, capacitor or
inductor. Before component voltages can be determined, the capacitive and inductive reactance values must be

44
computed from the capacitor and inductor values, based on the frequency of the
driving source. Consequently, if this frequency were to change, the reactances would
change, and this would in turn cause changes in the circulating current and
component voltages.

2.3 Series Impedance

Perhaps the first practical issue we face is determining the effective impedance of an
RLC series loop. For starters, resistors in series simply add. Reactances also add but
we must be careful of the sign. Inductive reactance and capacitive reactance will
partially cancel each other. Thus, the impedance in rectangular form is the sum of
the resistive components for the real portion, plus the sum of the reactances for the
imaginary (j) portion. We will often find it convenient to express this value in polar
form.

Example 2.1                                                                             Figure 2.1
                                                                                        Circuit for Example 2.1.
         What is the impedance of the network shown in Figure 2.1 at a frequency
         of 15 kHz?

    First we need to find the capacitive reactance value.

    X C = - j 1 2  f C
    X C =- j 1 2  15kHz 910 pF
    X C = - j 11.66 k 

    As there is only one resistor and one capacitor, the result in rectangular form
    is 47 k -j11.66 k. In polar form this is:

    Magnitude = Real2+Imaginary2
    Magnitude = 47k 2+(-11.66 k )2

    Magnitude = 48.42 k

    ( )  = tan-1 Imaginary Real
    ( )  = tan-1 -11.66 k 47 k

     =-13.9º

    That is, in polar form Z = 48.42E3-13.9° .

45
Example 2.2                                                                             Figure 2.2
                                                                                        Circuit for Example 2.2.
         Determine the effective impedance of the circuit shown in Figure 2.2 if the
         source frequency is 2 kHz. Repeat this for source frequencies of 200 Hz
         and 20 kHz. Finally, express the results in both rectangular and polar form.

         The first step is to find the reactance values at 2 kHz.

                      X L= j2 f L
                      X L = j 2  2000 Hz 15mH
                      X L = j 188.5

                      X C = - j 1 2  f C
                      X C =- j 1 2  2000 Hz 270 nF
                      X C = - j 294.7 

         Combine reals with reals and j terms with j terms.

                      Z = R+ j X L - j X C
                      Z = 500+ j 188.5 - j 294.7
                      Z  500- j 106.2 = 511.2 -12° 

         At 200 Hz XC will ten times larger and XL will be ten times smaller.

                   XC = -j2947 
                   XL = j18.85 
                   Z = 500 + j18.85 -j2947 
                   Z  500 -j2928  = 2970-80.3° 

         At 20 kHz XC will ten times smaller and XL will be ten times larger.

                   XC = -j29.47 
                   XL = j1885 
                   Z = 500 + j1885 -j29.47 
                   Z  500 + j1856  = 192274.9° 

To help visualize this complex impedance, it is useful to construct a phasor plot as
shown in Figure 2.3. We will do this for the initial case of 2 kHz. The resistive
component is the horizontal vector of length 500 (yellow). XL is straight up (blue) at
188.590°, and XC is straight down (red) at 294.7-90°. By copying the XL vector
and then shifting it down and next to XC, the difference between the two reactive
components can be seen (purple component directly above the XL copy). This

46
reactive sum is then copied and shifted right to join the resistive component to show
the final result. This is 511.2-12°  (green), as expected.

                           jX

                        300

                         jX L               R 600                                      Figure 2.3
                                                                                       Construction of the impedance
    -jX C+ jXL                                    R                                    plot for the network of
            jXL                                                                        Figure 2.2.
                         -jXC               Z

             -400-jX

Example 2.3

    Determine the impedance of the network shown in Figure 2.4. If the input           Figure 2.4
    frequency is 1 kHz, determine the capacitor and inductor values.                   Circuit for Example 2.3.

    The reactance values are already given, so we simply add them to determine
    the impedance in rectangular form. Combine reals with reals and j terms
    with j terms, and then convert to polar form.

             Z = R+j X L - j X C
             Z = 750+j 600 - j 200 

             Z = 750+j 400  = 850  28.1 ° 

    To find the capacitance and inductance, we simply rearrange the reactance
    formulas and solve. First, the inductor:

             X L= j2 f L

             L = |XL|
                   2 f

             L = 600 2  1 kHz
             L  95.5 mH

47
         And now for the capacitor:
                      X C =- j 1 2  f C
                     C= 1
                           2 f |XC|
                     C = 1 2  1 kHz 200 
                     C = 796 nF

         A plot of the impedance vector summation is shown in Figure 2.5. Note how
         the three components combine graphically to arrive at Z.

                                                                                                                   Figure 2.5
                                                                                                                   Impedance plot for the network
                                                                                                                   of Example 2.3.

2.4 Series Circuit Analysis

The techniques employed for series AC circuit analysis are the same as those used
for DC. The key item to remember for series circuits, whether AC or DC, as that the
current will be the same everywhere in a series connection. The major analysis tools
are Ohm's law, Kirchhoff's voltage law (KVL), and optionally, the voltage divider
rule.

48
KVL states that the sum of voltages around a loop must be zero, or that the sum of
voltage rises around a loop must equal the sum of voltage drops:

              v =  v                                                  (2.2)

The voltage divider rule for AC states that the voltage across any component or
group of components is proportional to the ratio of the impedance of said component
and the total series impedance. For some component A driven by source e,

             vA = e ZA                                                (2.3)
                     Z Total

If current is the desired quantity, the equivalent impedance of the network is found
and then divided into the equivalent source voltage. If the voltages across specific
components are desired, they can be found using the circulating current and Ohm's
law. Alternately, they can be computed using the voltage divider rule. If a current
source is driving the series circuit then the circulating current is the source current.
Individual component voltages may be found using the source current and Ohm's
law. The source voltage may be found by summing the component voltages via KVL,
or by determining the equivalent series impedance and multiplying it by the source
current.

Example 2.4

    For the circuit of Figure 2.6, find the circulating current and the voltages          Figure 2.6
    across the capacitor and resistor.                                                    Circuit for Example 2.4.

    The first step is to determine XC and then find Ztotal. Then use
    Ohm's law to find the circulating current.

             X C = - j 1 2  f C
             X C =- j 1 2  1000 Hz 33nF
             X C = - j 4823 

             ZTotal = R+( - j X C)

             ZTotal = 2200  - j 4823 
             ZTotal = 5301  -65.5 ° 

             i = vZ
             i = 1V

                  5301  -65.5 ° 
             i = 188.6  65.5°  A

49
         Now use Ohm's law to find the component voltages.
                     vR = i×R
                     v R = 188.6  65.5°  A×2200  0 ° 
                     v R = 0.4149  65.5 ° V
                     vC = i× X C
                     vC = 188.6  65.5°  A×4823  -90° 
                     vC = 0.9098  -24.5 ° V

         To complete this Example, we shall generate a series of plots: First off, an
         impedance plot showing the vector combination of R and XC leading to ZTotal.
         This is shown in Figure 2.7.

                                                                                                                   Figure 2.7
                                                                                                                   Impedance plot for
                                                                                                                   Example 2.4.

         Next, Figure 2.8 illustrates the phasor diagram of the three voltages. It may
         not be immediately apparent but an examination of this plot shows that it is
         just a counterclockwise rotation of the impedance plot. In fact, it is rotated
         by 65.5 degrees, the phase angle of the current. This should come as no
         surprise as the current is multiplied by each resistance, reactance or
         impedance to develop the voltage, and a vector multiplication simply adds
         the angles.
         Also, note that if we simply summed the magnitudes of the component
         voltages, the result would be considerably larger than the input voltage,
         seeming to violate KVL. In contrast, once a proper vector summation is
         performed, all is right in paradise.

50
                                                                                              Figure 2.8
                                                                                              Voltage phasor diagram for
                                                                                              Example 2.4.

                 For further clarity, Figure 2.9 plots the voltages in the time domain. Note
                 how the component voltages add graphically resulting in the input voltage.

                  1.00              Time Domain Graph                                         Figure 2.9
                                                                                              Time domain response for
                        vin              vc                                                   Example 2.4.

Voltage (volts)   0.75          vR

                  0.50       0.25   0.5  0.75                 1  1.25  1.5
                  0.25

                  0.00

                 -0.25

                 -0.50
                 -0.75

                 -1.00
                       0

                                         Time (milliseconds)

51
         The time shifts may be computed for verification as follows:
                         = 360° tT

                      tR = T R 360 °
                     t R = 1 ms 65.5° 360°
                     t R = 181.9 s
                     t C = T C 360 °
                     tC = 1 ms -24.5 ° 360°
                     tC = -68 s
         Thus we verify the resistor voltage leading (to the left) by 181.9 s and the
         capacitor voltage lagging (to the right) by 68 s, as seen in Figure 2.9.

Computer Simulation

The circuit of Example 2.4 is captured into a simulator as shown in Figure 2.10.
Node voltage 1 corresponds to the input voltage and node 2 corresponds to the
capacitor voltage. The resistor voltage is merely the difference between these two, or
node 1 minus node 2.

                                                                                                                   Figure 2.10
                                                                                                                   The circuit of Example 2.4 in a
                                                                                                                   simulator.

A transient or time domain simulation is performed. The results of the simulation are
shown in Figure 2.11. Note the tight agreement with the computed results as plotted
in Figure 2.9.

52
                                                                                       Figure 2.11
                                                                                       Time domain response of
                                                                                       Example 2.4 from a simulator.

We will now examine a variety of different series circuits. To ease the computations,
we will simply state values for the component reactances rather than specify a
frequency along with inductor and/or capacitor values.

Example 2.5

    Determine the component voltages for the circuit shown in Figure 2.12.             Figure 2.12
                                                                                       Circuit for Example 2.5.

    Given the reference direction of the source (which produces a
    counterclockwise reference current), the voltage across the resistor will be
    defined as vb - va. The first step is to find the equivalent series impedance.
    By inspection, this is 180 + j360 , which is equivalent to 402.563.4° .

    The voltages can be found via the voltage divider rule.

             v L = e X L Z
             v L = 6  0° V 360  90°  402.5 63.4° 
             v L = 5.366  26.6 ° Vp

53
                     v R = e RZ
                     v R = 6  0 ° V 180  0 °  402.5  63.4 ° 
                     v R = 2.683 -63.4° Vp
         The rectangular versions of vL and vR are 4.8 + j2.4 and 1.2 - j2.4
         respectively, summing up to the source of 60°. This is illustrated in the
         phasor voltage plot of Figure 2.13.

                                                                                                                   Figure 2.13
                                                                                                                   Voltage phasor diagram for
                                                                                                                   Example 2.5.

         Compare the plot of Figure 2.13 to that of the RC circuit in Figure 2.8. In
         this circuit, the impedance is inductive. This causes the current to lag the
         voltage, the opposite of the case for the RC circuit. Thus, the resistor voltage
         winds up below the real axis instead of above it (remember, the current and
         voltage for a resistor are in phase, and therefore the voltage across the
         resistor will have the same phase angle as the current through it). Once
         again, simply summing the magnitudes of the voltages yields a greater value
         than the source, however, a proper vector addition shows that KVL is
         satisfied.
         A time domain plot of the source and component voltages is shown in
         Figure 2.14. Note the similarity with the plot of Figure 2.9. Further, note
         how the time positions of the component voltages have swapped.

54
                                                   Time Domain Graph                          Figure 2.14
                                                                                              Time domain response for
                  6.0                                                                         Example 2.5.

Voltage (volts)                        vin

                  4.0

                 2.0 vR

                  0.0

                                      vL

                 -2.0

                 -4.0

                 -6.0

                 0     0.5                                            1  1.5

                            Time (cycles)

                 Finally, as a source frequency was not specified for this circuit, the time
                 scale of Figure 2.14 is calibrated in terms of cycles rather than seconds.

Example 2.6                                                                                   Figure 2.15
                                                                                              Circuit for Example 2.6.
         Find the voltages va and vb in the circuit of Figure 2.15. Assume the current
         source is the reference of 0°.

         Ohm's law may be used directly as the current is set by the source. Given
         the reference direction of the 20 mA source, the reference polarity for the
         capacitor voltage will be + to - from bottom to top. Thus, va is negative.

                     va = vC = -i×X C
                     v a =-20E-3 0 ° A×1000  -90° 
                     v a =-20 -90° V

         Recalling that a negative magnitude is the same as a 180° phase shift, we
         may remove the magnitude's negative sign by adding 180° to the phase
         angle. Therefore, va may also be written as 2090°.

         The node b voltage is found by multiplying the current by the impedance
         seen from node b to ground.

55
                     vb = i×(R+jX L)
                     vb = 20  0 ° mA×(4300+j 150)
                     vb = 86.05 2° V
         Notice the small size of the phase angle. This is expected given that the
         inductive reactance is so much smaller than the resistive component. Finally,
         these voltage are RMS as the current is assumed to be RMS (not having been
         labeled as peak or peak-to-peak).

Example 2.7

         Find the voltage vbd in the circuit of Figure 2.16. E1 = 20° volts peak and
         E2 = 560° volts peak.

                                                                                                                   Figure 2.16
                                                                                                                   Circuit for Example 2.7.

         The first step is to find the equivalent source voltage. Voltage sources in
         series add, however, note the reference polarity for E2. If we take E1 as the
         system reference, then the combined source is E1 - E2. Using E1 as the
         reference source creates a clockwise reference current and thus a positive
         reference polarity for vbd. If E2 was taken as the reference then vbd would be
         assumed to be negative due to the assumed counterclockwise reference
         direction of the resulting current. Either way will work.

                      E Total = E1 - E2
                      ETotal = 2  0 ° Vp -5  60 ° Vp
                      ETotal = 4.359  -96.6 ° Vp
         We can now use a voltage divider between the impedance seen from node b
         to node d versus the total series impedance. The impedance of the circuit is
         2 k + j7.5 k - j800 , or 2 k + j6.7 k . This is equivalent to 699273.4° .
         The impedance between nodes b and d is j7.5 k - j800 , or j6.7 k . In
         polar form this is 670090° .

56
         The voltage divider yields:
                     vbd = e Z bd
                                Z Total
                     vbd = 4.359  -96.6 ° V 6700  90°  6992 73.4 ° 
                     vbd = 4.177 -80 ° Vp

         Although we have answered the question, at this point attempting to
         visualize the waveforms in your head to verify the results may be a little
         challenging. No problem! If we also find the voltage across the resistor, we
         can check to see if KVL is verified using a phasor diagram. First, the resistor
         voltage may be found using the voltage divider rule.

                     vR = e R
                               Z Total

                     v R = 4.359  -96.6 ° V 2000  0 °  6992  73.4 ° 
                     v R = 1.247  -170° Vp

         We now plot all four voltages as seen in Figure 2.17 (note the unequal
         horizontal versus vertical scaling for ease of visual analysis).

                                                                                                                   Figure 2.17
                                                                                                                   Voltage phasor diagram for
                                                                                                                   Example 2.7.

57
    KVL tells us that the sum of the voltage rises must equal the sum of the
    voltage drops. We had used E1 as the reference and treated it as a rise. This
    made the reference direction clockwise for the circulating current. As a
    consequence, vR and vbd are voltage drops. E2 is also seen as a drop given its
    reference polarity markings. In other words, E1 should equal the sum of vR,
    vbd and E2. Let's see if this is borne out graphically in the phasor diagram.

    Looking at imaginary parts first, E1 is strictly real so the other three vectors
    should sum to zero for their imaginary parts. The imaginary part of E2 is
    about +4.3 while the other two come in around -4.1 and -0.2, so they do
    balance. For the real parts, E2 is +2.5, vbd is about +0.7 and vR is about -1.2.
    These add up to +2, the real component of E1. Everything balances. For
    more exacting results, you could convert each of the polar form results into
    rectangular form and add the reals to the reals, and the imaginaries to the
    imaginaries, and get the same result. In fact, using the prior recorded values,
    the three drops sum to 1.9970.0013° volts versus precisely 20° volts.
    This small deviation is due to the accumulated rounding and truncation
    errors of the intermediate results.

Sometimes a problem concerns determining resistance or reactance values. The             Figure 2.18
solution paths will require use of the analysis rules in reverse. For example, if a      A two-way bookshelf
resistor value is needed to set a specific current, the total required impedance can be  loudspeaker system with
determined from this current and the given voltage supply. The values of the other       tweeter (top) and woofer
series components can then be subtracted from the total (using rectangular form),        (bottom).
yielding the required resistor or reactance value.

Another possibility is determining a specific capacitance or inductance to meet
certain requirements. An example of this would be a simple crossover network for
a loudspeaker system. Generally, a single transducer is incapable of reproducing
music signals of all frequencies at sufficiently loud levels while maintaining low
distortion. Consequently, the frequency range is split into two or more bands with
each being covered by a transducer optimized to reproduce those frequencies. These
transducers, along with a few electrical components, are then packaged into an
appropriate enclosure commonly referred to as a loudspeaker1. In a basic system, the
audible spectrum is split into two parts, as seen in Figure 2.18. The low frequencies
are handled by a large transducer called a woofer, while the high frequencies are
handled by a small, light transducer called a tweeter that can follow the rapidly
changing high frequency content with accuracy. Woofers are not capable of
reproducing high frequencies, and excessive low frequency content can physically
damage a tweeter. Thus, some means of "steering" the high frequency content to the
tweeter and the low frequency content to the woofer must be employed. One way to
do this is to place an inductor or capacitor in series with the transducer.

1 To add some confusion, the term "loudspeaker" can refer to either the individual
    transducers (engineer-speak) or the entire finished system (audiophile-speak).

58
Figure 2.19 shows a simple way to block low frequencies from a tweeter. In this
diagram, the loudspeaker is modeled as a resistor. Although this is not perfectly
accurate, it is sufficient to illustrate the idea.

                                                                                                                   Figure 2.19
                                                                                                                   A basic loudspeaker crossover
                                                                                                                   network.

To understand this concept, simply think of the circuit as a voltage divider between
the loudspeaker and the reactance of the capacitor. Capacitive reactance is inversely
proportional to frequency. The circuit is designed such that XC is much larger than
than the impedance of the loudspeaker at very low frequencies. This means that very
little of a low frequency signal will reach the loudspeaker as most of that voltage
will drop across the capacitor. In contrast, at high frequencies XC is much smaller
than the tweeter's impedance and thus virtually all of the source signal reaches the
loudspeaker. The transition point between these two regions is called the crossover
frequency and is usually defined as the point where XC equals the magnitude of the
loudspeaker impedance. For a woofer, the capacitor would be replaced by an
inductor. At low frequencies the inductive reactance would be minimal, thereby
allowing all of the low frequency content to reach the woofer. The opposite happens
at high frequencies. The inductive reactance would rise with frequency and
eventually prevent or "choke off" the signal to the woofer (hence, the slang term
"choke" for an inductor).

Example 2.8

         Referring to the circuit of Figure 2.19, assume the loudspeaker impedance is
         80° . Determine a capacitor value for a crossover frequency of 2.5 kHz.
         At this frequency the magnitude of XC should be the same as that of the
         loudspeaker. For a 10 volt RMS input signal, determine the loudspeaker
         voltage at frequencies of 100 Hz, 2.5 kHz and 15 kHz.

         The first step is to determine the value of the capacitor such that at 2.5 kHz
         XC equals 8 . To do this, simply rearrange the capacitive reactance formula:

59
                      X C = - j 1 2  f C
                       C= 1

                             2 f | XC|
                       C = 1 2  2500 Hz 8 
                       C = 7.96  F

         To find the loudspeaker voltage at the three specified frequencies, first find
         the reactance at that frequency and then use the voltage divider rule. We
         already know that at 2.5 kHz the reactance is -j8 .

                     vloudspeaker = e Z Load
                                       Z Total

                     vloudspeaker = 10  0 ° Vrms 8  8 - j 8 
                     vloudspeaker = 7.07  45 ° Vrms

         At 100 Hz, the frequency has decreased by a factor of 25 so the reactance
         goes up by the same factor yielding -j200 .

                     vloudspeaker = e Z Load
                                       Z Total

                     vloudspeaker = 10  0 ° Vrms 8  8 - j 200 
                     vloudspeaker = 0.4  87.7 ° Vrms

         At 15 kHz, the frequency has increased by a factor of 6 so the reactance
         goes down by the same factor yielding -j1.333 .

                     vloudspeaker = e Z Load
                                       Z Total

                     vloudspeaker = 10  0 ° Vrms 8  8 - j 1.333
                     vloudspeaker = 9.86  9.5 ° Vrms

         From this tally, it should be obvious that the lowest bass frequencies will
         experience attenuation while the highest frequencies will see little reduction
         in amplitude. This is just what we want.

         The concept of a variation in output voltage with respect to frequency, or
         frequency response, will be examined in much greater detail in upcoming
         chapters.

60
2.5 Concerning Practical Inductors

Up to this point, inductors have been treated as ideal components, that is, pure
inductance. In reality, all inductors have some resistance associated with them due to
the resistance of the wire used to make the coil. This is called ESR, or Equivalent
Series Resistance. It is also denoted as Rcoil. Ideally, this resistance will be small
enough to ignore, but ultimately it will place a limit on the performance of any
circuit that utilizes an inductor.
While it is possible to measure the resistance of an inductor using a DMM, this will
not yield an accurate value at all frequencies. In fact, as frequency increases, ESR
will also increase. This is due to skin effect. At higher frequencies, current is not
distributed equally throughout the cross-section of a conductor. In fact, it tends to
"hug" the outer surface or "skin" of the conductor. This reduces the effective cross-
sectional area and thereby increases the resistance2. In general, as frequency rises, so
does Rcoil. Unfortunately, the situation is further complicated by distributed
capacitance that will become an issue at still higher frequencies. As a consequence,
manufacturers will give a "Q plot", such as the one shown in Figure 2.20.

                                                                                                                   Figure 2.20
                                                                                                                   Inductor Q graph.
                                                                                                                                Courtesy of TDK

2 Recall that R =  l / A. A decrease in area A results in increased resistance, R.
61
The Q, or quality factor, of an inductor can be defined in terms of the peak energy
stored in the device versus the energy dissipated per cycle. Keeping time constant,
we can relate this to the power via the relation i2R. The current necessarily is the
same for both the reactive and resistive components, therefore the Q of the coil is
equal to the ratio of its reactance to its resistance at the frequency of interest.

             Qcoil = X L                     (2.4)
                      R coil

    Where
    Qcoil is the quality factor of the inductor,
    XL is the magnitude of the inductive reactance at the frequency of interest,
    Rcoil is the resistance of the inductor at the frequency of interest.

In general, the higher the Qcoil, the better. As can be seen in Figure 2.20, Qcoil is not a
constant. Indeed, it increases with frequency until a peak is reached, at which point it
begins to fall.

When dealing with practical inductors, the effective Qcoil can be determined from a
graph if the operating frequency is known. Once the Qcoil is found, the effective
value of Rcoil can be found from Equation 2.4. This value can then be placed in series
with the ideal inductor to create a more accurate result. For analysis, this pair is
sometimes drawn with a box around it to denote that Rcoil is not a separate physical
resistor, but is the effective resistance of the inductor.

Example 2.9

    Find the voltage across the inductor in the circuit of Figure 2.21. Assume               Figure 2.21
    the source voltage is 200° peak-to-peak at a frequency of 20 kHz. L is                   Circuit for Example 2.9.
    equal to 10 mH, Qcoil is 50, and R1 is 600 .

    Remember, the inductor consists of both elements within the dashed
    box. First, find the magnitude of the inductive reactance.

             |XL|= 2 f L
             | X L | = 2  20 kHz 10 mH
             | X L | = 1257 

    We can now find Rcoil via Equation 2.4:

             Qcoil = X L
                      R coil

    Therefore,

62
                       Rcoil = X L
                                Qcoil

                       Rcoil = 1257 50
                      Rcoil = 25.1 

         The impedance of the inductor is 25.1 + j1257  , or 125788.9° . The
         total impedance is 600 + 25.1 + j1257  , or 140463.6° . We can use a
         voltage divider to find the inductor's voltage.

                     vind = e Z ind
                                Z Total

                     vind = 20  0 ° Vpp 1257  88.9 °  1404  63.6 ° 
                     vind = 17.9  25.3 ° Vpp

         It is worth noting that, due to the coil resistance, the inductor's current and
         voltage are not precisely 90° out of phase, but rather 88.9°. That's a small
         but measurable deviation.

2.6 Summary

A series connection is any connection in which the current through one component
must be identical to the current flowing through any other component in that
connection. This remains true for AC circuits employing resistors, capacitors and
inductors. The equivalent impedance of a set of resistors, inductors and capacitors
placed in series is the vector sum of their resistance and reactance values. Inductive
and capacitive reactance have opposing signs and will partially cancel each other.
While resistance remains constant across frequency, reactance does not. Capacitive
reactance decreases with frequency while inductive reactance increases. Therefore,
the precise impedance value will vary with frequency. If the impedance angle is
positive, the circuit is said to be inductive. If the impedance angle is negative, the
circuit is said to be capacitive.

Once inductance and capacitance values have been turned into their corresponding
reactances at the frequency of interest, Ohm's law can be used to find the voltage
across any component. The voltage will equal the product of the resistance or
reactance and the current flowing through it. This is a vector computation. The
current through a resistor will be in phase with the voltage across it. In contrast, the
inductor voltage will lead the current and the resistor voltage by 90 degrees. Also,
the capacitor voltage will lag the current and the resistor voltage by 90 degrees.
From these observations it is apparent that the inductor and capacitor voltages in a
series connection must be 180 degrees out of phase.

63
Kirchhoff's voltage law (KVL) states that the sum of voltage rises around any series
loop must equal the sum of voltage drops around that loop. This remains true for AC
analysis, however, it is imperative that a vector summation is performed and not just
a simple summation of the magnitudes. If the phase angles are ignored, it is possible
for the voltage magnitudes to sum to considerably more than the source voltage.
The voltage divider rule (VDR) remains true for AC analysis, but again, it is a vector
computation. Thus, a rendering using just magnitudes will not produce a correct
result. For example, a divider between a resistor and inductive reactance of equal
value will not yield the source voltage splitting in half across each component.

For highest accuracy, the coil resistance, or Rcoil, of inductors should not be ignored.
It is treated as a small resistance in series with and integral to the inductor. Coil
resistance is computed from the inductor's Q, or quality factor. Q is defined as the
ratio of XL to Rcoil.

Review Questions

    1. How is the equivalent impedance for a string of series connected resistors,
         capacitors and inductors computed?

    2. Will the impedance of an RLC circuit be the same at all frequencies?
         Why/why not?

    3. How are series connected AC voltage sources combined?
    4. Does Kirchhoff's voltage law change for AC circuit analysis?
    5. Is it possible for the voltage magnitudes of an AC RLC circuit to sum to

         more than the source voltage? Why/why not?
    6. How is a phasor impedance plot for a series network related to its phasor

         voltage plot?

2.7 Exercises

Analysis

    1. Determine the impedance of the circuit of Figure 2.22 for a 1 kHz sine.

                                                                                Figure 2.22

    2. Determine the impedance of the circuit of Figure 2.22 for a 5 kHz sine.

64
    3. Determine the impedance of the circuit of Figure 2.23 for a 10 kHz sine.
                                                                                Figure 2.23

    4. Determine the impedance of the circuit of Figure 2.23 for a 50 kHz sine.
    5. Determine the impedance of the circuit of Figure 2.24 for a 1 kHz sine.

                                                                                Figure 2.24

    6. Determine the impedance of the circuit of Figure 2.24 for a 500 Hz sine.
    7. Determine the impedance of the circuit of Figure 2.25.

                                                                                Figure 2.25

    8. In the circuit of Figure 2.25, if the input frequency is 100 Hz, what is the
         value of the inductor, in mH?

    9. In the circuit of Figure 2.25, if the input frequency is 200 Hz, what is the
         value of the capacitor, in F?

    10. Draw the voltage and current waveforms for the circuit of Figure 2.26.
                                                                                Figure 2.26

65
    11. Draw the voltage and current waveforms for the circuit of Figure 2.27.
                                                                                Figure 2.27

    12. Draw the voltage and current waveforms for the circuit of Figure 2.28 if E is
         a one volt peak sine at a frequency of 10 kHz and C = 3.3 nF.
                                                                                Figure 2.28

    13. Draw the voltage and current waveforms for the circuit of Figure 2.29 if E is
         a two volt peak-peak sine at a frequency of 40 Hz and L = 33 mH.
                                                                                Figure 2.29

    14. Draw the voltage and current waveforms for the circuit of Figure 2.30 if I is
         a 10 A peak sine at a frequency of 2 kHz and C = 6.8 nF.
                                                                                Figure 2.30

66
    15. Draw the voltage and current waveforms for the circuit of Figure 2.31 if I is
         a two amp peak-peak sine at a frequency of 40 Hz and L = 33 mH.
                                                                                Figure 2.31

    16. Determine the impedance of the circuit of Figure 2.32.
                                                                                Figure 2.32

    17. Determine the impedance of the circuit of Figure 2.32 using a frequency of
         10 kHz.

    18. For the circuit of Figure 2.32, determine the circulating current and the
         voltages across each component. Draw a phasor diagram of the three
         component voltages. Also find the time delay between the voltages of the
         components.

    19. For the circuit of Figure 2.32 using a frequency of 10 kHz, determine the
         circulating current and the voltages across each component. Draw a phasor
         diagram of the three component voltages and determine the time delay
         between the capacitor and resistor voltages.

    20. Determine the impedance of the circuit of Figure 2.33.
                                                                                Figure 2.33

    21. Determine the impedance of the circuit of Figure 2.33 using a frequency of
         10 kHz.

67
    22. For the circuit of Figure 2.33, determine the circulating current and the
         voltages across each component. Also find the time delay between the
         voltages of the components.

    23. For the circuit of Figure 2.33 with a frequency of 3 kHz, determine the
         circulating current and the voltages across each component. Also find the
         time delay between the voltages of the components.

    24. For the circuit of Figure 2.34, determine the circulating current.
                                                                                Figure 2.34

    25. Determine the impedance of the circuit of Figure 2.34 using a frequency of
         1.5 kHz.

    26. For the circuit of Figure 2.34, determine the circulating current and the
         voltages across each component. Also find the time delay between the
         voltages of the components.

    27. For the circuit of Figure 2.34 with a frequency of 1.5 kHz, determine the
         circulating current and the voltages across each component. Also find the
         time delay between the voltages of the components.

    28. For the circuit of Figure 2.35, determine the circulating current and the
         voltages across each component. Draw a phasor diagram of the three
         component voltages and determine the time delay between the inductor and
         resistor voltages..
                                                                                Figure 2.35

68
    29. For the circuit of Figure 2.36, determine the circulating current and the
         voltages across each component.
                                                                                Figure 2.36

    30. For the circuit of Figure 2.37, determine the circulating current and the
         voltages across each component.
                                                                                Figure 2.37

    31. For the circuit of Figure 2.38, determine the applied voltage and the voltages
         across each component.
                                                                                Figure 2.38

    32. For the circuit of Figure 2.39, determine the applied voltage and the voltages
         across each component.
                                                                                Figure 2.39

69
    33. For the circuit of Figure 2.40, determine the circulating current and the
         voltages across each component.
                                                                                Figure 2.40

    34. Repeat the previous problem using an input frequency of 10 kHz.
    35. For the circuit of Figure 2.41, determine the circulating current and the

         voltages across each component. The source is a 10 volt peak sine at
         20 kHz, R = 200 , C = 100 nF and L = 1 mH.

                                                                                Figure 2.41

    36. For the circuit of Figure 2.41, find vb and vac.
    37. For the circuit of Figure 2.42, find vb and vac. The source is a 50 volt peak-

         peak sine at 10 kHz, R = 100 , C = 200 nF and L = 1 mH.
                                                                                Figure 2.42

    38. For the circuit of preceding problem, determine the circulating current and
         the voltages across each component.

70
    39. For the circuit of Figure 2.43, determine the circulating current and the
         voltages across each component. E is a 1 volt peak 2 kHz sine. Also, draw a
         phasor diagram of the four component voltages.
                                                                                Figure 2.43

    40. For the circuit of Figure 2.43, find vb and vca. E is a 1 volt peak 2 kHz sine.
    41. For the circuit of Figure 2.44, determine vb, vc and vac. E is a 10 volt peak

         15 kHz sine.
                                                                                Figure 2.44

    42. For the circuit of Figure 2.45, determine the circulating current and the
         voltages across each component. E is a 100 millivolt peak 250 Hz sine.
         Further, draw a phasor diagram of the four component voltages.
                                                                                Figure 2.45

71
    43. For the circuit of Figure 2.46, determine the circulating current and the
         voltages across each component. E is a 2 volt RMS 1 kHz sine. Also, draw a
         phasor diagram of the four component voltages.
                                                                                Figure 2.46

    44. For the circuit of Figure 2.47, determine vb, vc and vac. E is a 1 volt peak
         25 kHz sine.
                                                                                Figure 2.47

    45. For the circuit of Figure 2.48, determine the voltages across each
         component. The source is a 50 mA peak sine at 15 kHz, R = 200 ,
         C = 100 nF and L = 1.5 mH.
                                                                                Figure 2.48

72
    46. For the circuit of Figure 2.49, determine vac, vb and vc. The source is a 10 mA
         peak-peak sine at 50 kHz, R = 2 k, C = 10 nF and L = 800 H.
                                                                                Figure 2.49

    47. For the circuit of Figure 2.50, determine the voltages across each
         component. The source is a 2 mA RMS sine at 1 kHz, R = 1.2 k,
         C = 750 nF and L = 6.8 mH.
                                                                                Figure 2.50

    48. For the circuit of Figure 2.51, determine vac, vb and va. The source is a 2 mA
         peak-peak sine at 300 kHz, R = 560 , C = 6.8 nF and L = 400 H.
                                                                                Figure 2.51

73
    49. For the circuit of Figure 2.52, determine the voltages across each
         component.
                                                                                Figure 2.52

    50. For the circuit of Figure 2.53, determine the voltages across each
         component. Further, draw a phasor diagram of the four component voltages.
                                                                                Figure 2.53

    51. For the circuit of Figure 2.54, find vac, vb and vc. The source is 5 mA peak at
         8 kHz.
                                                                                Figure 2.54

74
    52. For the circuit of Figure 2.55, determine the voltages across each
         component. The source is 20 mA peak at 100 kHz.
                                                                                Figure 2.55

    53. For the circuit of Figure 2.56, determine the voltages across each
         component.
                                                                                Figure 2.56

    54. For the circuit of Figure 2.57, determine the voltages vb and vdb. E1 = 20º
         and E2 = 590º.
                                                                                Figure 2.57

    55. Determine the inductance and capacitance values for the circuit of
         problem 52.

    56. For the circuit of Figure 2.57, determine the inductor and capacitor values if
         the source frequency is 12 kHz.

75
    57. For the circuit of Figure 2.58, determine the voltages across each
         component. E1 = 10º and E2 = 860º.

                                                                                Figure 2.58

Design

    58. Redesign the circuit of Figure 2.32 using a new capacitor such that the
         current magnitude from the source is 100 A.

    59. Redesign the circuit of Figure 2.33 using a new frequency such that the
         current magnitude from the source is 200 A.

    60. For the circuit of Figure 2.32, determine a new capacitor such that |XC| = R.
    61. For the circuit of Figure 2.33, determine a new frequency such that |XL| = R.

Challenge

    62. For the circuit of Figure 2.40, determine a new frequency such that
         |XC| = |XL|.

    63. Determine the output voltage across the capacitor of Figure 2.32 at
         frequencies of 100 Hz, 5 kHz and 20 kHz. In light of this, if the input signal
         was a 1 kHz square wave instead of a sine wave as pictured, how would this
         circuit affect the shape of the output waveform (hint: consider
         superposition)?

    64. Assume that you are troubleshooting a circuit like the one shown in
         Figure 2.41. E is a 2 volt peak sine at 2 kHz, R = 390 , C = 100 nF and
         L = 25 mH. The circulating current measures approximately 4 mA with a
         lagging phase angle of just under -40 degrees. What is the likely problem?

    65. Given the circuit shown in Figure 2.41, find the values for C and L if the
         source is a 6 volt sine wave at 1 kHz, R = 2 k, vR = 4 V and vL = 5 V.

76
    66. The circuit of Figure 2.59 can be used as part of a loudspeaker crossover
         network. The goal of this circuit is to steer the low frequency tones to the
         low frequency transducer (labeled here as "Loudspeaker" and often referred
         to as a woofer). A similar network substitutes a capacitor for the inductor to
         steer the high frequency tones to the high frequency transducer (AKA
         tweeter). These networks can be pictured as frequency sensitive voltage
         dividers. At very low frequencies, XC is very large and blocks low frequency
         tones from reaching the tweeter. A mirror situation occurs with the
         inductor/woofer variant. The crossover frequency is the frequency at which
         the reactance magnitude equals the resistance. Assuming simple 8 
         resistances for the woofer and tweeter, determine capacitor and inductor
         values that would yield a 1.5 kHz crossover frequency. How might this
         concept be extended to a mid-range loudspeaker that only produces tones in
         the middle of the musical frequency spectrum? (Note, this concept will be
         revisited in the final simulation problem, below, and also in the Simulation
         portion of Chapter 4 which covers series-parallel circuits.)

                                                                                Figure 2.59

Simulation

    67. Simulate the solution of design problem 58 and determine if the values
         produce the required results.

    68. Simulate the solution of design problem 59 and determine if the values
         produce the required results.

    69. Simulate the solution of design problem 60 and determine if the values
         produce the required results. Hint: if the reactance/resistance magnitudes are
         the same, then the voltage magnitudes will be identical.

    70. Simulate the solution of design problem 61 and determine if the values
         produce the required results. Hint: if the reactance/resistance magnitudes are
         the same, then the voltage magnitudes will be identical.

77
    71. Simulate the solution of challenge problem 62 and determine if the new
         frequency produces the required results. Hint: if the reactance magnitudes
         are the same, then the voltage magnitudes will be identical. Further, their
         phases will cause these voltages to cancel, leaving the resistor voltage equal
         to the source voltage.

    72. Using a transient analysis, crosscheck the crossover design of the final
         challenge problem, above. Plot the resistor (loudspeaker) voltage across the
         range of 100 Hz to 20 kHz for both sections.

78
Notes

                                                                                                                                    
79
3 Parallel RLC Circuits

3.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Utilize Kirchhoff's current law, the current divider rule and Ohm's law to find branch currents in parallel
         RLC networks that utilize current sources or a single voltage source.

    · Compute complex impedance and system voltage in parallel RLC circuits.
    · Determine the equivalent value of multiple AC current sources in parallel.
    · Draw phasor diagrams for impedance/susceptance and component currents in parallel RLC circuits.

3.1 Introduction

In this chapter we introduce the analysis of AC RLC circuits configured in parallel. AC parallel circuits echo the
characteristic of their DC counterpart and many of the solution techniques from DC analysis will be applicable
here. This includes the use of Ohm's law and Kirchhoff's current law, along with the current divider rule.
Generally, as with the series circuits presented in the previous chapter, reactance values will need to be
computed from capacitor and inductor values before the main analysis may begin. Here, as in the most of the
remaining chapters, we shall be concerned with determining the circuit response based on a source with a single
frequency of excitation, in other words, a simple sine wave.

Parallel circuits are in many ways the complement of series circuits. The most notable characteristic of a parallel
circuit is that it has only two nodes and each component is connected from one node to the other. There are no
other connections with which to create a voltage divider. Consequently, all components see the same voltage.
Currents divide among the components in proportion to their conductance/susceptance (i.e., in inverse
proportion to their resistance/reactance).

The key to this is to remember that all computations involve vector quantities. This can lead to some surprising
results for the uninitiated. For example, due to the 180 degree phase differential between inductors and
capacitors, it is possible for an individual branch current to be greater than the source current. This does not
violate Kirchhoff's current law, as we shall see. Indeed, it is reminiscent of a similar situation in AC series
circuits where an individual component voltage can be greater than the source voltage without violating
Kirchhoff's voltage law.

To clarify our analyses, we shall make considerable use of both time domain plots of currents as well as phasor
diagrams.

80
3.2 The Parallel Connection

A parallel connection is always characterized by having all components share just
two nodes. There are no other junctions from which current can flow out of or into,
or for voltage to split. Consequently,

         The voltage is the same everywhere in a parallel connection. (3.1)

Each component in such a connection will see the same voltage, regardless of
whether it is a resistor, capacitor or inductor. Before the branch currents can be
determined, the capacitive and inductive reactance values must be computed. As
seen from prior work, these are obtained from the capacitor and inductor values, and
based on the frequency of the driving source. Consequently, if this frequency were to
change, the reactances would change, and this would in turn cause changes in the
various component currents as well as the total current delivered by the source.

3.3 Parallel Impedance

Perhaps the first order of business is to determine equivalent impedance values for
some collection of parallel components. Recall that the reciprocal of reactance is
susceptance,

    B = 1X (3.2)

and that the reciprocal of impedance is admittance,

    Y = 1Z (3.3)

The units are siemens for each. It is also worth noting that, due to the division, the
signs reverse. For example, a capacitive susceptance has an angle of +90 degrees
and if a complex admittance has a negative angle, then the associated impedance is
inductive.

The "conductance rule" for parallel combinations studied in the DC case remains
valid for the AC case, although we generalize it for impedances:

    Ztotal = 1 1 1 1 1                               (3.4)

    + + +...+           ZN
    Z1 Z2 Z3

81
Each of the individual impedances presented in Equation 3.4 (i.e., Z1, Z2, etc) can
represent a simple resistance, a pure reactance or a complex impedance. Further, the
product-sum rule shortcut for two components also remains valid for AC
components:

    Ztotal = Z 1× Z 2                                                 (3.5)
             Z 1+Z 2

There is one special case where Equation 3.5 can be "troublesome", and that's when
the two impedances consist of a pure capacitive reactance and a pure inductive
reactance, both of the same magnitude. The two items will effectively cancel each
other leaving a denominator of zero and an undefined result. While the theoretical
combination "blows up" and approaches infinity, in reality it is limited by associated
resistances such as Rcoil, and arrives at some finite value This situation is studied in
great depth in Chapter 8, which covers the concept of resonance.

Example 3.1                                                                               Figure 3.1
         Determine the impedance of the network shown in Figure 3.1.                      Circuit for Example 3.1.

    Equation 3.4 would be best here.

    Ztotal =         1                +1
    Z total =  1 +1 +1                  - j 48 k 
               Z1 Z2 Z3

                                1
                  1 +1
               j 12 k  20 k 

    Ztotal = 12.49E3  51.3 ° 

    This result might be a little surprising to the sharp-eyed. Notice that the
    magnitude of the total is larger than the magnitude of the smallest
    component (the inductor at j12 k). This would never be the case if these
    three components were all resistors: the result would have to be smaller than
    the smallest element in the group.

    The reason for this is that the capacitive reactance partially cancels the
    inductive reactance. If the product-sum rule (Equation 3.5) is used with

    these two components, the result is 16E390° or j16 k. Placing that in
    parallel with the 20 k resistor (again using Equation 3.5) leads to the result
    computed above.

    An admittance diagram is illustrated in Figure 3.2. The vector summation of
    the component conductance and susceptances is verified nicely.

82
    The individual component values are:
                BL = 1 j 12 k  - j 83.33E-6 S
                BC = 1 - j 48k   j 20.83E-6S
                G = 1 20 k  = 50E-6 S
                Y total = 1 12.49E3  51.3 °   80.1E-6 -51.3 ° S

    In rectangular form Ytotal = 50E-6 - j62.5E-6 S.

                                                                 Figure 3.2
                                                                 Admittance diagram for the
                                                                 network of Figure 3.1.

83
Example 3.2

    Determine the impedance of the network shown in Figure 3.3 at a                Figure 3.3
    frequency of 10 kHz. Repeat this for a frequency of 1 kHz.                     Circuit for Example 3.2.

    First, find the reactances at 10 kHz. For the inductor we find:

             X L= j2 f L
             X L = j 2  10 kHz 680 H
             X L  j 42.73

    And for the capacitor:

             X C =- j 1 2  f C
             X C =- j 1 2  10kHz 470 nF
             X C - j 33.86

    Now use Equation 3.4 to combine the elements.

              Z total = 1 1 1 1
                            ++

                        Z1 Z2 Z3
             Ztotal = 1 1 1 1

                       j 42.73 + 1.8 k  +- j 33.86

             Ztotal = 162.6  -84.8 ° 

    In rectangular form this is 14.68 - j161.9 . As the capacitor's reactance is
    the smallest of the three components, it dominates the equivalent impedance
    at this frequency. By working the capacitive reactance formula in reverse, it
    can be shown that the reactive portion of - j161.9  can achieved at this
    frequency by using a capacitance of 98.3 nF. That means that at 10 kHz, this
    parallel network has the same impedance as a 14.68  resistor in series with
    a 98.3 nF capacitor. At any other frequency this will no longer be true, as
    will be illustrated momentarily.

    At 1 kHz, the frequency is reduced by a factor of ten. Therefore, XL will be
    ten times lower, or approximately j4.273 . Further, XC will be ten times
    higher, or about - j338.6 . The inductive reactance will now dominate.

    The new impedance is:

84
    Ztotal =        1
    Ztotal =  1 +1 +1
              Z1 Z2 Z3

                                 1
                  1 +1 + 1
              j 4.273 1.8 k  - j 338.6

    Ztotal = 4.328  89.9 ° 

    In rectangular form this is 10.4E-3 + j4.328 . The result is inductive, the
    opposite of what we saw at 10 kHz. Using the inductive reactance formula,
    it can be shown that at 1 kHz this parallel network has the same impedance
    as a 10.4 milliohm resistor in series with a 689 H inductor.

3.4 Parallel Circuit Analysis

Kirchhoff's current law (KCL) is the operative rule for parallel circuits. It states that
the sum of all currents entering and exiting a node must equal zero. Alternately, it
can be stated as the sum of currents entering a node must equal the sum of currents
exiting that node. As a pseudo formula:

     I =  I                             (3.6)

A similar situation occurs in AC parallel circuits to that seen AC series circuits;
namely that it appears that KCL (like KVL) is "broken". That is, a simplistic
summing of the magnitudes of the currents might not balance. Once again, this is
because the summation must be a vector summation, paying attention to the phase
angles of each separate current.

It is possible to drive a parallel circuit with multiple current sources. These sources
will add in much the same way that voltage sources in series add, that is, polarity
and phase must be considered. Ordinarily, voltage sources with differing values are
not placed in parallel as this violates the basic rule of parallel circuits (voltage being
the same across all components).

The current divider rule remains valid for AC parallel circuits. Given two
components, Z1 and Z2, and a current feeding them, IT, the current through one of the
components will equal the total current times the ratio of the opposite component
over the sum of the impedance of the pair.

    i1 = iT Z2                          (3.7)
            Z 1+Z 2

85
This rule is convenient in that the parallel equivalent impedance need not be
computed, but remember, it is valid only when there are just two components
involved.

When analyzing a parallel circuit, if it is being driven by a voltage source, then this     Figure 3.4
same voltage must appear across each of the individual components. Ohm's law can            A simple parallel RL circuit.
then be used to determine the individual currents. According to KCL, the total
current exiting the source must be equal to the sum of these individual currents. For
example, in the circuit shown in Figure 3.4, the voltage E must appear across both
R and L. Therefore, the currents must be iL = E / XL and iR = E / R, and itotal = iL + iR.
itotal can also be found be determining the parallel equivalent impedance of R and
XL, and then dividing this into E. This technique can also be used in reverse in order
to determine a resistance or reactance value that will produce a given total current:
dividing the source by the current yields the equivalent parallel impedance. As one
of the two is already known, the known component can be used to determine the
value of the unknown component via Equation 3.4.

Example 3.3

    Determine the currents in the circuit shown in Figure 3.4 if the source is
    100º volts peak, XL = j2 k and R = 1 k

    The same voltage must appear across all elements in a parallel connection.
    In this case that's 100º volts peak. The two branch currents are found via
    Ohm's law:

                iL = vZ
                iL = 10 0 ° V j 2 k 
                iL = 5E-3  -90° A

                iR = vZ
                iR = 10 0 ° V 1 k 
                iR = 10E-3 0 ° A

    The source current is the sum of the these two currents, or 11.18E-3-26.6º
    amps. This can be verified by determining the equivalent parallel impedance
    and then applying Ohm's law:

86
                      ZT = Z 1× Z 2
                             Z 1+Z 2

                      ZT = 1 k × j 2 k  1 k +j 2 k 
                      ZT = 894  26.6 ° 
         As a side note, in rectangular form this is 800 + j400, meaning that this
         parallel combination is equivalent to a series combination of an 800 ohm
         resistance and a 400 ohm inductive reactance. Continuing with Ohm's law,
         we have:
                     iSource = v

                                ZT
                     iSource = 10  0 ° V 894  26.6 ° 
                     iSource = 11.18E-3  -26.6 ° A
         A phasor diagram of the currents is shown in Figure 3.5, below.

                                                                                                                   Figure 3.5
                                                                                                                   Phasor diagram of currents in
                                                                                                                   the circuit of Figure 3.4.

Current Measurement in the Laboratory

At this point, a practical question arises; how do we verify these currents in the
laboratory? After all, the preeminent measurement tool is the oscilloscope, and these
are designed to measure voltage, not current. While it is possible to obtain current
measurement probes, a simple method to measure current is to use a small current
sensing resistor with a standard oscilloscope setup. We have seen already that the
voltage across a resistor must be in phase with the current through it. Therefore,

87
whatever phase angle we see on a resistor's voltage, its current phase angle must be
the same. The idea is to simply insert a resistor into the branch of which we wish to
measure the current. As long as the resistance is much smaller than the impedance
seen in the rest of that branch, it will have little impact on the precise value of the
current. We can then place a probe across this sensing resistor to read its voltage.
Ohm's law is then be used to determine the current's magnitude, while the phase
angle is obtained directly from the oscilloscope (again, because the sensing resistor's
voltage must be in phase with its current, and thus the voltage phase angle is equal to
the current phase angle). This technique will be illustrated in the simulation portion
of the next example problem.

Example 3.4                                                                              Figure 3.6
         Determine the branch currents in the circuit of Figure 3.6.                     Circuit for Example 3.4.

    The first step is to determine the capacitive reactance.

    X C = - j 1 2  f C
    X C =- j 1 2  500 Hz 250 nF
    X C - j 1273 

    Both the resistor and capacitor will see 20 volts peak from the source. Their
    currents can be determined via Ohm's law:

    iC = v
           XC

    iC = 20 V 1273  - 90° 
    iC 15.71E-3 90° A

    iR = vR
    iR = 20 V 220  0 ° 
    iR 90.91E-3  0 ° A

    The source current is the sum of these two currents, or 92.26E-39.8°
    amps. The source current may also be determined by dividing the source
    voltage by the equivalent parallel impedance, as follows.

88
                                    ZT = Z 1× Z 2
                                           Z 1+Z 2

                                    ZT = 220 ×(- j 1273 ) 220  - j 1273 k 
                                    ZT = 216.8 -9.8 ° 

                                    iSource = v
                                              ZT

                                    iSource = 20  0 ° V 216.8  -9.8° 
                                    iSource = 92.26E-3 9.8 ° A

                         A time domain plot of the currents is illustrated in Figure 3.7 along with a
                         phasor plot in Figure 3.8. Note that the source current is close in both
                         amplitude and phase to the resistor current. By comparison, the capacitor
                         current is considerably smaller and with an obvious leading phase shift.

                                         Time Domain Graph

                         100.0                                                                         Figure 3.7
                                                                                                       Current waveforms for the
                                                                                                       circuit of Figure 3.6.

    Current (milliamps)  50.0 ir

                                                    isource
                         0.0 ic

                         -50.0

                         -100.0     0.5                                     1  1.5  2
                                 0
                                                                                               Figure 3.8
                                         Time (milliseconds)                                   Phasor diagram for the circuit
                                                                                               of Figure 3.6.

89
Computer Simulation

The circuit of Figure 3.6 is captured in a simulator as shown in Figure 3.9.
Individual 2 ohm resistors are used to sense the currents in the resistor and capacitor
branches. These sensing resistors are inserted directly above ground for convenience
of measure. In this way a differential measurement is not needed.

                                                                                                                   Figure 3.9
                                                                                                                   Circuit of Figure 3.6 in a
                                                                                                                   simulator with added current
                                                                                                                   sensing resistors.

The value of a sensing resistor needs to be considerably smaller than the impedance
of the branch in which it is inserted. Two orders of magnitude (i.e., less than 1 %)
would be a good place to start. While even smaller values will increase accuracy,
from a practical standpoint in the lab, such tiny resistor values would produce
extremely small voltages that would be difficult to measure with great accuracy.

                                                                                                                   Figure 3.10
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 3.9.

90
A basic transient analysis is then performed as shown in Figure 3.10. The results of
the simulation are in tight agreement with the plot of Figure 3.7. Note that the
plotted resistor and capacitor "currents" are, in fact, the voltages across the
associated sensing resistors (nodes 2 and 3) divided by 2 (ohms), in direct
application of Ohm's law. Not only does the simulation verify the results computed
earlier, it also validates the concept of using small current sensing resistors in the
laboratory.

Example 3.5                                                                             Figure 3.11
                                                                                        Circuit for Example 3.5.
         Determine the the branch currents in the circuit of Figure 3.11. Use the
         source voltage as the reference (0° ).

    Although this circuit is drawn a little differently than the prior examples, it
    remains a simple parallel circuit with just two nodes. Therefore, each
    element sees a 2 volt peak potential. Ohm's law will suffice to find the three
    component currents. These are then added to find the source current. Their
    reference directions are right-to-left given the source's polarity.

    iC = v
           XC

    iC = 2  0 ° V 12  -90° 
    iC 0.1667  90° A

    iL = v
          XL

    iL = 2  0 ° V 8  90 ° 
    iL = 0.25  -90 ° A

    iR = vR
    iR = 2  0 ° V 10 0 ° 
    iR = 0.2  0 ° A

    The sum of these three currents is approximately 0.2167-22.6° amps. This
    value can be verified by finding the combined parallel impedance. Using
    Equation 3.4 it can be shown that this impedance is 9.23122.6° . Thus,

91
                     iSource = vZ
                     iSource = 2  0 ° V 9.231  22.6 ° 
                     iSource 0.2167  -22.6 ° A
         A phasor diagram showing the vector summation of the currents is
         illustrated in Figure 3.12.

                                                                                                                   Figure 3.12
                                                                                                                   Current phasor diagram for
                                                                                                                   the circuit of Figure 3.11.

         Note that iC and iL are in perfect opposition as expected. Subtracting the
         magnitude of iC from iL leaves us with the precise vertical component of the
         source current.

92
If a parallel circuit is driven by a current source, as shown in Figure 3.13, there are  Figure 3.13
two basic methods of solving for the component currents. The first method is to use      Parallel network driven by a
the current divider rule. If desired, the component voltage can then be found using      current source.
Ohm's law. An alternate method involves finding the parallel equivalent impedance
first and then using Ohm's law to determine the voltage (remember, being a parallel
circuit, there is only one common voltage). Given the voltage, Ohm's law can be
used to find the current through one component. To find the current through the
other, either Ohm's law can be applied a second time or KCL may be used;
subtracting the current through the first component from the source current. If there
are more than two components, usually the second method would be the most
efficient course of action.

It is worth noting that both methods described above will yield the correct answers.
One is not "more correct" than the other. We can consider each of these as a separate
solution path; that is, a method of arriving at the desired end point. In general, the
more complex the circuit, the more solution paths there will be. This is good because
one path may be more obvious to you than another. It also allows you a means of
crosschecking your work.

Example 3.6

    Determine the currents in the circuit of Figure 3.13 if the source is 300
    milliamps peak at 10 kHz, R is 750  and L is 15 mH.

    The first step is to determine the inductive reactance.

                X L= j2 f L
                X L = j 2  10 kHz 15 mH
                X L  j 942.4

    The current divider rule can be used to find the current through the resistor.

                iR = iSource X L
                             R+X L

                iR = 0.3  0° A 942.4  90 °  750  0 °  +942.4  90° 
                iR = 0.2347  38.5 ° A

    KVL can be used to find the remaining current through the inductor as the
    source current must equal the sum of the inductor and resistor currents.
    Therefore:

93
                              iL = iSource-i R                                                  Figure 3.14
                              iL = 0.3  0 ° A -0.2347  38.5° A                                  Current waveforms for the
                              iL = 0.1868  -51.5 ° A                                            circuit of Example 3.6.

Current (amps)    This value could also have been obtained by applying the current divider
                  rule a second time:

                              iL = iSource R
                                           R+X L

                              iL = 0.3  0 ° A 750 0 °  750  0 °  +942.4  90 ° 
                              iL = 0.1868  -51.5 ° A

                  A time domain plot of the current waveforms is shown in Figure 3.14.

                                                  Time Domain Graph

                 0.3

                                             isource

                 0.2

                 0.1

                             il

                 0.0

                                              ir

                -0.1

                -0.2

                -0.3    20  40  60               80  100
                     0

                            Time (microseconds)

                From the plot it is apparent that the inductor and resistor currents do indeed
                add up to the source current. Further, the current through the inductor is
                lagging, as expected.

94
Computer Simulation

The circuit of Example 3.6 is captured in a simulator as shown in Figure 3.15. A pair
of 1 ohm current sensing resistors have been added. By using 1 ohm, the sensing
voltage will have the same magnitude as the current, with no scaling required.

                                                                                                                   Figure 3.15
                                                                                                                   Circuit of Example 3.6 in a
                                                                                                                   simulator.

A transient analysis is performed, plotting the voltages at nodes 2 and 3 along with
their sum (the source current). The results are shown in Figure 3.16. The plot is
delayed for a millisecond in order to avoid the initial power-up transient. The results
are in full agreement with the plot of Figure 3.14.

                                                                                                                   Figure 3.16
                                                                                                                   Results of the transient
                                                                                                                   response simulation for the
                                                                                                                   circuit of Example 3.6.

95
Example 3.7

         Determine the branch currents in the circuit of Figure 3.17. Use the current
         source as the time reference (i.e., 0°).

                                                                                                                   Figure 3.17
                                                                                                                   Circuit for Example 3.7.

         Instead of using repeated current dividers here, we can instead find the
         equivalent impedance and then apply Ohm's law to determine the system
         voltage. Each branch current may be obtained by dividing this voltage by the
         impedance of that branch; a quick application of Ohm's law.

         The system impedance is computed through Equation 3.4 as follows:

                      Z total = 1 1 1 1
                                   ++

                                Z1 Z2 Z3
                      Ztotal = 1 1 1 1

                               - j 12 + j 8  + 10 
                      Ztotal = 9.231  22.6 ° 

         The system voltage is found using Ohm's law. As the reference direction of
         the current source is flowing down into ground, the branch currents will be
         flowing up. This makes their voltage reference negative with respect to
         ground (i.e., + to - from bottom to top). We can deal with this by describing
         the current source as negative (i.e., flowing out of the top node). The source
         can be written as either -10° or as 1180°, it makes no difference.

                     v = i source× Z total
                     v =-1  0 ° A×9.231  22.6°
                     v -9.231 22.6 ° V

         This potential may also be written as 9.231-157.4° volts (remember, an
         inversion is the same as a 180 degree phase shift).

         And now for the branch currents:

96
                     iC = v
                            XC

                     iC = 9.231 -157.4° V 12 - 90° 
                     iC 0.7692  -67.4 ° A
                     iL = v

                            XL
                     iL = 9.231 -157.40 ° V 8  90° 
                     iL = 1.154  112.6° A
                     iR = vR
                     iR = 9.231  -157.4 ° V 10 0 ° 
                     iR = 0.9231  -157.4 ° A
         The sum of these three currents is approximately 1180° amps (i.e.,
         -10°), the value of the current source, as expected.
         A phasor diagram of the currents is plotted in Figure 3.18.

                                                                                                                   Figure 3.18
                                                                                                                   Current phasor diagram for
                                                                                                                   the circuit of Figure 3.16.

97
         Now for the sneaky bit. In case you didn't notice, the components in this
         circuit are identical to those of Figure 3.11 with the exception of the source.
         As a consequence, the phase angles and magnitudes of the branch currents
         through the three components will remain unchanged relative to each other.
         Due to the change in both magnitude and direction of the source, the entire
         phasor plot has been rotated clockwise by 154.7 degrees and all of the
         magnitudes have been lengthened by the ratio of the voltages (9.231 / 2).
         This is perhaps easiest to see by focusing on the vector for isource in Figure
         3.12. Rotate that vector clockwise, along with every other vector, until isource
         lines up with the negative real axis. The result is the plot of Figure 3.18,
         albeit with newly lengthened magnitudes.

If a parallel circuit contains multiple current sources, they may be added together (a
vector sum, of course) to generate an equivalent single current source. The analysis
then proceeds as before. This is demonstrated in the following example.

Example 3.8

         For the circuit of Figure 3.19, determine the currents through the capacitor,
         inductor and resistor, and also determine the system voltage. i1 is 0.50°
         amps and i2 is 345° amps.

                                                                                                                   Figure 3.19
                                                                                                                   Circuit for Example 3.8.

         The first step here is to determine the effective current driving the circuit. If
         we treat the top node as positive, i2 is entering (positive) while i1 is exiting
         (negative). The combination is:

                     itotal = i1 +i2
                     itotal = -0.5  0 ° A +3  45° A
                     itotal = 2.67  52.6 ° A

         This current has the same reference direction as source two. A phasor
         diagram of the process is illustrated in Figure 3.20 to help visualize the
         vector addition.

98
                                                                                                                   Figure 3.20
                                                                                                                   Phasor diagram of the
                                                                                                                   combined current sources for
                                                                                                                   the circuit for Example 3.8.

         The next step is to find the combined impedance so that we can find the
         applied voltage.

                      Ztotal = 1 1 1 1
                                   ++

                                Z1 Z2 Z3
                      Ztotal = 1 1 1 1

                               - j 100  + j 50 + 40 
                      Ztotal = 37.14  21.8 ° 
                     v = i source× Z total
                     v = 2.67 52.6° A×37.14  21.8 °
                     v 99.16  74.4° V

         We now apply Ohm's law to each of the components to determine the branch
         currents.

                     iC = v
                            XC

                     iC = 99.16  74.4 ° V 100 - 90° 
                     iC 0.9916  164.4° A
                     iL = v

                            XL
                     iL = 99.16 74.4 ° V 50  90° 
                     iL = 1.983  -15.6 ° A

99
                     iR = vR
                     iR = 99.16  74.4° V 40  0 ° 
                     iR = 2.479  74.4 ° A

         The sum of these three currents is approximately 2.6752.6° amps. This
         balances the net entering current from the two sources, verifying KVL.

3.5 Summary

In this chapter we have examined parallel circuits using either a single voltage
source, or one or more AC current sources, along with two or more resistors,
capacitors and inductors. The defining characteristic of a parallel configuration is
that all components are connected to just two nodes and that all elements in this
configuration see the same voltage. If multiple AC current sources are present, they
may be combined into a single equivalent current source via vector addition.

Unlike the purely resistive case, the equivalent impedance of a group of parallel RLC
components will not always be smaller than the smallest resistance or reactance in
the group due to cancellations between the inductance and capacitance. As voltage is
identical for all components, then the currents through the capacitors must be 180
degrees out of phase with the currents through the inductors. Thus it is quite possible
that the current through one of the reactance branches could be larger than the
current supplied by the source. In general, the effective impedance is found by
summing the individual conductances and susceptances to find the total admittance
of the group, and then taking the reciprocal of this value. The product-sum rule may
be used so long as the angles are taken into account (i.e., a vector process).

Kirchhoff's current law (KCL) states that the sum of currents entering a node must
equal the sum of currents leaving that node. This remains true for AC circuit
analysis, however, it must be remembered to always use a vector summation. A
simple summation of current magnitudes will not achieve proper results.

Individual branch currents in a circuit driven by a voltage source may be determined
by using Ohm's law: simply divide the source voltage by the individual resistance
and reactance values. These branch currents must sum to the total current delivered
by the voltage source thanks to KCL. If the parallel network is driven by current
sources, the individual branch currents can be found by first determining the
effective parallel impedance and then using Ohm's law to find the system voltage.
Once the voltage is known, Ohm's law is used again on each component to find the
associated branch current. Alternately, the current divider rule may be used
repeatedly on successive pairings of components.

100
Review Questions

    1. How is the equivalent impedance for a group of parallel connected resistors,
         inductors and capacitors computed?

    2. How is the equivalent value for parallel connected AC current sources
         computed?

    3. Is the product-sum rule still applicable for AC analysis? Can it be used for
         reactance and/or complex impedance?

    4. Define Kirchhoff's current law for AC circuit analysis.
    5. Is it possible for a branch current to be larger than the source current in an

         AC parallel circuit? Explain why/why not.

3.6 Exercises

Analysis

    1. Determine the effective impedance of the network shown in Figure 3.21 at
         10 MHz.
                                                                                Figure 3.21

    2. Determine the effective impedance of the network shown in Figure 3.22 at
         100 Hz.
                                                                                Figure 3.22

    3. Determine the effective impedance of the network shown in Figure 3.23 at
         5 kHz.
                                                                                Figure 3.23

101
    4. Determine the effective impedance of the network shown in Figure 3.24 at
         20 kHz.
                                                                                Figure 3.24

    5. Determine the effective impedance of the network shown in Figure 3.25.
                                                                                Figure 3.25

    6. Determine the effective impedance of the network shown in Figure 3.25 if
         the frequency is halved and if the frequency is doubled.

    7. For the network shown in Figure 3.21, determine the frequency below which
         the impedance is mostly resistive.

    8. For the network shown in Figure 3.22, determine the frequency below which
         the impedance is mostly inductive.

    9. Draw phasor impedance plot for problem 1.
    10. Draw phasor impedance plot for problem 2.
    11. Determine the three branch currents for the circuit shown in Figure 3.26 and

         draw their phasor diagram.
                                                                                Figure 3.26

    12. Determine the three branch currents for the circuit shown in Figure 3.27 and
         draw their phasor diagram.
                                                                                Figure 3.27

102
    13. Determine the four branch currents for the circuit shown in Figure 3.28 and
         draw their phasor diagram.
                                                                                Figure 3.28

    14. Determine all of the branch currents for the circuit shown in Figure 3.29
         assuming E is a 1 volt RMS sine.
                                                                                Figure 3.29

    15. Determine all of the branch currents for the circuit shown in Figure 3.30
         given E = 10 volt peak sine, R = 220, XC = -j500. and XL = j1.5 k.
                                                                                Figure 3.30

    16. Determine all of the branch currents for the circuit shown in Figure 3.31
         given E = 2 volt peak sine, R = 1 k, XC = -j2 k. and XL = j3 k.
                                                                                Figure 3.31

103
    17. Determine the component currents for the circuit shown in Figure 3.32.
         Draw phasor diagram of the source and branch currents.
                                                                                Figure 3.32

    18. Determine the resistor and capacitor voltages for the circuit shown in
         Figure 3.32.

    19. Determine the resistor and inductor voltages for the circuit shown in
         Figure 3.33.
                                                                                Figure 3.33

    20. Determine the component currents for the circuit shown in Figure 3.33.
         Draw phasor diagram of the source and branch currents.

    21. Determine the source voltage for the circuit shown in Figure 3.34.
                                                                                Figure 3.34

    22. Determine the component currents for the circuit shown in Figure 3.34.
         Draw the phasor diagram of the source and branch currents.

    23. Determine the component currents for the circuit shown in Figure 3.35. I is
         20 mA at 0 degrees.
                                                                                Figure 3.35

104
    24. Determine the source voltage for the circuit shown in Figure 3.35. I is
         20 mA at 0 degrees.

    25. Determine the source voltage for the circuit shown in Figure 3.36. Assume
         I1 is 1 mA at 0 degrees and I2 is 2 mA at +90 degrees.
                                                                                Figure 3.36

    26. Determine the capacitor and inductor currents in the circuit of Figure 3.36.
         Assume I1 is 1 mA at 0 degrees and I2 is 2 mA at +90 degrees.

    27. Determine the resistor and capacitor currents in the circuit of Figure 3.37.
         Assume I1 is 20° amps and I2 is 0.545°.
                                                                                Figure 3.37

    28. Determine the source voltage for the circuit shown in Figure 3.37. Assume
         I1 is 20° A and I2 is 0.545°.

Design

    29. For the network shown in Figure 3.38, determine a value of C such that the
         impedance magnitude of the circuit is 1 k. The source is a 50 Hz sine and
         R is 2.2 k.
                                                                                Figure 3.38

105
    30. For the network shown in Figure 3.39, determine a value of L such that the
         impedance magnitude of the circuit is 2 k. The source is a 2 MHz sine and
         R is 3.3 k.

                                                                                Figure 3.39

    31. For the circuit shown in Figure 3.38, determine a value for C such that the
         magnitude of the source current is 1 mA. E is a 2 volt 10 kHz sine and
         R = 8 k.

    32. For the network shown in Figure 3.39, determine a value for L such that the
         magnitude of the source current is 10 mA. E is a 25 volt 100 kHz sine and
         R = 4 k.

    33. For the network shown in Figure 3.40, determine a value of C such that the
         impedance magnitude of the circuit is 10 k . The source is a 440 Hz sine
         and R is 33 k.

                                                                                Figure 3.40

    34. For the network shown in Figure 3.41, determine a value of L such that the
         impedance magnitude of the circuit is 200 . The source is a 60 Hz sine and
         R is 680 .

                                                                                Figure 3.41

    35. For the circuit shown in Figure 3.40, determine a value for C such that the
         magnitude of the circuit voltage is 200 volts. The source current is a 100 mA
         1200 Hz sine and R = 15 k.

    36. For the circuit shown in Figure 3.41, determine a value for L such that the
         magnitude of the circuit voltage is 50 volts. The source current is a 2.3 A
         60 Hz sine and R = 330 .

106
    37. Given the circuit shown in Figure 3.38, determine a value for C such that the
         impedance angle is -45 degrees. The source a 1 volt peak sine at 600 Hz and
         R = 680 .

    38. Given the circuit shown in Figure 3.39, determine a value for L such that the
         impedance angle is 45 degrees. The source a 10 volt peak sine at 100 kHz
         and R = 1.2 k.

    39. Determine a value for C such |XC| = |XL| for the circuit shown in Figure 3.42.
         The source frequency is 1 kHz, R = 200  and L = 50 mH.

                                                                                Figure 3.42

    40. Determine a value for L such |XC| = |XL| for the circuit shown in Figure 3.43.
         The source frequency is 22 kHz, R = 18 k and C = 5 nF.

                                                                                Figure 3.43

    41. Add one or more components in parallel with the circuit of Figure 3.22 such
         that the resulting impedance at 20 Hz is 10  with a phase angle of at least
         +30°.

Challenge

    42. Determine a value for C such that the impedance angle for the circuit shown
         in Figure 3.42 is purely resistive (0 degrees). The source frequency is 1 kHz,
         R = 200  and L = 50 mH.

    43. Is it possible to change the value of the resistor in Figure 3.34 so that the
         system voltage is 4 volts? If so, what is the value? If not, why not?

    44. Is it possible to change the value of the inductor and/or capacitor in Figure
         3.34 so that the system voltage is 4 volts? If so, what is/are the values? If
         not, why not?

107
    45. Assume you are troubleshooting a circuit like the one shown in Figure 3.43.
         I is a 10 mA peak sine at 2 kHz, R = 390 , C = 200 nF and L = 25 mH. The
         measured resistor voltage is a little under 2.5 volts. What is the likely
         culprit?

    46. Given the circuit shown in Figure 3.43, find the values for C and L if the
         source is a sine wave at 1 kHz, R = 4 k, iSource = 3 mA, iR = 2 mA,
         iL = 5 mA,

Simulation

    47. Using a transient analysis simulation, verify that the source current
         magnitude is 1 mA using the capacitor value determined in design
         problem 31.

    48. Using a transient analysis simulation, verify that the source current
         magnitude is 10 mA using the inductor value determined in design
         problem 32.

    49. Using a transient analysis simulation, verify that the source voltage
         magnitude is 200 volts using the capacitor value determined in design
         problem 35.

    50. Using a transient analysis simulation, verify that the source voltage
         magnitude is 50 volts using the inductor value determined in design
         problem 36.

    51. Using a transient analysis simulation, verify the design solution for
         problem 39. This can be checked by seeing if the current magnitudes in C
         and L are identical.

    52. Using a transient analysis simulation, verify the design solution for
         problem 40. This can be checked by seeing if the current magnitudes in C
         and L are identical.

    53. Impedance magnitude as a function of frequency can be investigated by
         driving the circuit with a fixed amplitude current source across a range of
         frequencies. The resulting voltage will be proportional to the effective
         impedance. Investigate this effect by performing an AC analysis on the
         circuits shown in Figures 3.32 and 3.33. Use a frequency range of 10 Hz to
         1 MHz. Before running the simulations, sketch your expected results.

    54. Following the idea presented in the previous problem, investigate the
         impedance as a function of frequency of the circuit shown in Figure 3.43.
         Use R = 1 k, C = 10 nF, and L = 1 mH. Run the simulation from 100 Hz to
         10 MHz. Make sure to sketch your expected results first.

108
Notes

                                                                                                                                    
109
4 Series-Parallel RLC Circuits

4.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Identify series-only and parallel-only sub-groups in series-parallel RLC networks.
    · Compute complex equivalent impedance for series-parallel RLC circuits.
    · Simplify an entire RLC network into a simple series or parallel equivalent comprised of complex

         impedances.
    · Utilize KVL, KCL and other techniques to find various voltages and currents in series-parallel RLC

         networks driven by a single effective voltage or current source.
    · Interpret phasor diagrams and time domain plots for component voltages and/or currents in series-

         parallel RLC circuits.

4.1 Introduction

Having completed our examination of strictly series and strictly parallel AC circuits, we turn our attention now
to somewhat more complex circuits, namely those circuits comprised of components in mixed series-parallel
arrangements. This chapter deals with a subset of series-parallel RLC circuits, specifically those that are driven
by a single effective current or voltage source, and which may be simplified using series and parallel component
combinations. The rules and techniques explored for strictly series networks are still applicable to series
connected subsections of larger circuits. The same is true for the rules and techniques established for strictly
parallel circuits regarding parallel subsections. Thus, the key to analyzing series-parallel circuits is in
recognizing those portions of the circuit that form series or parallel sub-circuits, and then applying the series and
parallel analysis rules to those sections. Ohm's law, KVL and KCL may be used in turn to solve portions of the
problem until all currents and voltages are found. As individual voltages and currents are determined, this makes
it easier to apply these rules to determine other values.

It is often useful to determine the effective impedance of individual sections at the outset in order to facilitate
circuit analysis. Indeed, continuing the process until the entire network is reduced to a series-only or parallel-
only simplified version is a good starting point. That is, each of the complex impedances that make up the
series-only or parallel-only simplified equivalent is made up from a sub-circuit which in turn potentially is made
up of other sub-circuits, and so on. The art of examining a complex series-parallel network and being able to
immediately determine which elements constitute a series connection and which constitute a parallel connection
is an essential skill and worthy of practice.

110
4.2 The Series-Parallel Connection

Consider the circuit of Figure 4.1. This circuit is neither just a series circuit nor just
a parallel circuit. If it was a series circuit then the current through all components
would have to be same, that is, there would no nodes where the current could divide.
This is clearly not the case as the current flowing through the capacitor can divide at
node b, with one portion flowing down through the resistor and the remainder
through the inductor. On the other hand, if it was strictly parallel, then all of the
components would have to exhibit the same voltage and therefore there would be
only two connection points in the circuit. This is also not the case as there are three
such points: a, b and ground.

                                                                                                                   Figure 4.1
                                                                                                                   A simple series-parallel RLC
                                                                                                                   circuit.

What is true for the circuit of Figure 4.1 is that the resistor and the inductor are in
parallel. We know this because both components are attached to the same two nodes;
b and ground, and must exhibit the same voltage, vb. As such, we can find the
equivalent impedance of this pair and treat the result as a single value, let's call it ZP.
In this newly simplified circuit, ZP is in series with the capacitor and the source. We
have simplified the original circuit into a series circuit and thus the series circuit
analysis rules may be applied.

4.3 Series-Parallel Impedance

The rules for combining resistors, capacitors and inductors in AC series-parallel
circuits are similar to those established for combining resistors in DC circuits.
Obviously, the first item is to determine the reactances of the capacitors and
inductors. At that point, simple series and parallel combinations can be identified.
These combinations are each reduced to a complex impedance. Once this is
completed, the network is examined again to see if these new complex impedances
can be identified as parts of new series or parallel sub-circuits, and simplified. This
process is repeated until we are left with a single complex impedance. Again, it is
useful to remember that the phase angles of the reactive components can sometimes
lead to surprising results, such as a series sub-circuit having an impedance
magnitude smaller than its largest component -- something that would never happen
with a network comprised of just resistors. The importance of using vector
computations cannot be over stressed.

111
Let's begin with a relatively simple series-parallel RLC network where the reactance
values have already been found.

Example 4.1

     Determine the equivalent impedance of the network shown in Figure 4.2.              Figure 4.2
                                                                                         Network for Example 4.1.

     Looking in from the left side, we note that the inductor and 33 k resistor
     are in parallel as they are both tied to the same two nodes. Also, we can
     see that the capacitor is in series with the 8.2 k resistor. This series
     combination is, in turn, in parallel with the other two parallel components.
     Thus, it would make sense to find the series combination first.

             Z series = R+(- jX C )
             Z series = 8.2 k  - j 2 k 
             Z series = 8440  -13.7 ° 

     We now place this new complex impedance in parallel with the inductor and
     the 33 k resistor.

             Z total =        1       1
             Ztotal =   1 +1 +1       +1
                        Z1 Z2 Z3
                                        8440  -13.7° 
                           1 +1
                        j 550  33 k 

             Ztotal = 556.8 85.4 ° 

     Clearly, the inductor dominates here. The parallel resistor is roughly two
     orders of magnitude larger than the inductive reactance and has minimal
     impact on a parallel combination. Further, the complex impedance derived
     from the capacitor/resistor combination is also considerably larger, and
     given that it has a negative (capacitive) phase angle, it partly cancels the
     inductive reactance. This leaves us with a magnitude a little higher than that
     of the inductive reactance alone, and with a phase angle shifted toward the
     resistive side.

The series and parallel combinations can be much more complicated than that of the
prior network. Ladder networks, for example, feature a set of sections that load other
sections, resulting in repeated series and then parallel simplifications. In this
situation, it is best to start work at the end farthest from the nodes of interest. The
following example will illustrate this on a modest scale.

112
Example 4.2
         Determine the equivalent impedance of the network shown in Figure 4.3.

                                                                                                                   Figure 4.3
                                                                                                                   Network for Example 4.2.

     Looking in from the right side, we see immediately the 750  resistor. This
     is in series with the sub-circuit comprised of the remaining five components.
     This sub-circuit can be seen as the -j800  capacitor in parallel with another
     sub-circuit containing the other four components. This four component sub-
     circuit consists of the inductor in series with yet another sub-circuit
     consisting of the final two resistors and capacitor. This three element sub-
     circuit consists of the 2.2 k  resistor in parallel with the series combination
     of the 1 k  resistor and the -j400  capacitor.

     The most sensible way to approach this is to start at the left end with the
     simple RC series combination and then work right, toward the nodes of
     interest. We'll number the components from left to right for identification.

     Zleft2 = R1+(- jX C1)
     Zleft2 = 1 k  - j 400 
     Zleft2 = 1077  -21.8 ° 

     We now place this complex impedance in parallel with the 2.2 k resistor.
     This creates a three element sub-circuit which is in series with the inductor.

     Z left3 =      1
     Zleft3 =   1+ 1
                R2 Zleft2

                               1
                   1+ 1
                2.2 k  1077  -21.8° 

     Zleft3 = 734.7  -14.7 ° 

     Zleft4 = Z left3 + jX L
     Zleft4 = 734.7  -14.7 °  +j 600
     Zleft4 = 822.5  30.2 ° 

113
     This group of four is in parallel with the second capacitor of -j800 .
     Finally, we arrive at the equivalent total value by placing the resulting group
     of five in series with the 750  resistor.

     Z left5 =       1
                 1+1
                X C2 Z left4

     Zleft5 = 1               1
                                     1
                - j 800  +822.5  30.2° 

     Zleft5 = 813.4  -31.3 ° 

     Ztotal = Z left5 +R3
     Ztotal = 813.4  - 31.3 °  +750 
     Ztotal = 1506  -16.3 ° 

     In rectangular form this is 1443 -j422.3 , meaning that this network is
     equivalent to a 1443  resistor in series with a capacitive reactance of
     -j422.3 .

Series-parallel simplification techniques will not work for all circuits. Some
networks such as delta or bridge configurations require other techniques that will be
addressed in later chapters.

4.4 Series-Parallel Analysis

Given the infinite variety of series-parallel configurations, there are myriad ways of
solving any given circuit for a particular current or voltage. Many solution paths
exist. This is good, because while you might not see a particular path, there are
others that will also provide correct results. The only issue is which path is most
efficient or convenient for you. Suppose we are trying to find vb in the circuit of
Figure 4.4. How might we approach this problem?

                                                                                        Figure 4.4
                                                                                        A series-parallel RLC circuit.

114
One path would be to find the total impedance seen by the voltage source, Ztotal.
Dividing the source voltage by this impedance gives us the source current. We could
then perform a current divider between the capacitor and inductor-resistor branches
to find the inductor current. Once that current is found, it can be multiplied by the
inductive reactance to find vb. Alternately, having found the total impedance, we
could compute the voltage divider between the three components on the right and R1
to find va. Knowing va, a second voltage divider between XL and R2 gives us vb. A
third possibility would be to find the source current and use that to find va, perhaps
by finding the drop across R1 and subtracting that from the source, E. Once va is
found, a voltage divider can be used to find vb. Undoubtedly there are other solution
paths that will work here. Some are more "computationally expensive" than others,
but as long as you can identify one of them, the answers are within reach.
Remember, the larger the circuit becomes, the greater the number of possible
solution paths. Don't fall into the trap of relying on the same "trick" for every
circuit, though. It is useful to solve these circuits using a variety of techniques as a
means of cross-checking the results and sharpening your skill set.

Example 4.3

     Determine vb for the circuit of Figure 4.5 if the source frequency is 100 Hz.        Figure 4.5
                                                                                          Circuit for Example 4.3.

     The first thing to do is to find the capacitive reactance.

             X C = - j 1 2  f C
             X C =- j 1 2  100 Hz 75 nF
             X C - j 21.22 k 

     This reactance is in parallel with the 27 k resistor. Their combination is:

             Zrc = R×(- jX C)
                     R +(- jX C)

             Zrc = 27 k ×(- j 21.22 k ) 27 k  - j 21.22 k 
             Zrc  16.68E3  -51.8° 

     This impedance forms a voltage divider with the 47 k resistor to create vb.

             vb = e source Z rc
                           R+Z rc

             vb = 90  0 ° V 16.68E3  - 51.8  47k  +16.68E3 -51.8 ° 
             vb  25.5  -38.9° V

115
                 A time domain plot of vb and the source voltage is shown in Figure 4.6.  Figure 4.6
                                                                                          Time domain plot of voltages
                                                     Time Domain Graph                    for the circuit of Figure 4.5.

Voltage (volts)    100

                                esource

                     50

                    0 vb

                 -50

                 -100

                 0     2  4  6                 8  10

                          Time (milliseconds)

Computer Simulation

To verify the results of the prior example, the circuit of Figure 4.5 is entered into a
simulator as shown in Figure 4.7.

                                                                                          Figure 4.7
                                                                                          The circuit of Example 4.3 in
                                                                                          the simulator.

A time domain or transient analysis is run, examining vb and the source voltage.
Node 2 corresponds to vb. The results are shown in Figure 4.8.

116
                                                                                         Figure 4.8
                                                                                         Transient analysis of the circuit
                                                                                         of Example 4.3.

The plot is delayed one full cycle in order to get past the initial turn-on transient.
The resulting amplitudes and phase shift line up perfectly with the plot of theoretical
values in Figure 4.6.

Example 4.4

     For the circuit of Figure 4.5, determine vab.                                       Figure 4.9
                                                                                         Circuit for Example 4.4.

     This circuit can be analyzed as a pair of voltage dividers. By
     definition, vab = va - vb. Numbering the resistors from top to bottom
     gives us:

             v a = esource R 2
                          R1+ R2

             v a = 100  0 ° V 40 k  10k  + 40 k 
             v a = 80  0 ° V

117
     vb = e source - j X C
                 - jX C +jX L

     vb = 100  0 ° V - j 800 - j 800  + j 1 k 
     vb = 400  180° V

     This may also be written as -4000°. Now we subtract the two voltages to
     find vab.

     v ab = va -vb
     v ab = 80  0 ° V -400  180° V
     v ab = 480  0 ° V

     Note that vab is nearly five times larger than the source voltage. This is
     mostly due to the fact that vb itself is four times the source magnitude. Due
     to the fact that XL and XC are relatively close in size, they largely cancel each
     other when placed in series. This produces a small net reactance which
     creates a large current. This considerable current then produces large
     voltages across these components. The closer the magnitudes of XL and XC,
     the higher the L and C component voltages. We will examine this effect in
     detail when we discuss resonance in Chapter 8.

     To verify this result, we can calculate the voltage across the inductor and
     check to see if KVL is satisfied.

     vinductor = esource  jXL

                          - jX C+ jX L

     vinductor = 100 0 ° V j 1 k  - j 800  + j 1 k 

     vinductor = 500 0 ° V

     Adding the vb of -4000° volts to vinductor does indeed yield the source
     voltage of 1000° volts.

     This can be seen graphically in Figure 4.10. First, note that the inductor
     voltage is in phase with the source voltage. This is because the LC branch
     appears to be net inductive, producing a current lagging the source voltage
     by 90 degrees. This same current flows through the inductor, meaning its
     voltage leads this current by 90 degrees, and thus the inductor voltage is in
     phase with the source voltage. The lagging current also flows through the
     capacitor which produces a further 90 degree lag for the capacitor voltage
     (i.e., vb) or 180 degrees total. Combining the large inductor voltage with a
     capacitor voltage that is nearly as large but effectively inverted yields the
     smaller source voltage.

118
Voltage (volts)   500                Time Domain Graph                Figure 4.10
                  400                                                 Time domain plot of the circuit
                  300     vinductor                                   of Figure 4.9.
                  200     esource
                  100                                        1
                               vb
                     0
                 -100     0.2      0.4            0.6   0.8
                 -200
                 -300
                 -400
                 -500

                       0

                                   Time (cycles)

Example 4.5

         In the circuit of Figure 4.11, determine the current flowing down through the
         inductor. Use the source as the reference (0°).

                                                                                        Figure 4.11
                                                                                        Circuit for Example 4.5.

         One possible approach for this is to find the equivalent total impedance that
         the source drives in order to find the source current. A current divider can
         then be used between the inductor and the pair of capacitors (all three being
         in parallel). Another option would be to find the impedance of the three
         reactive components and then use the voltage divider rule to find va.

119
     Once va is found, the inductor current can be found using Ohm's law. Each
     of these solution paths requires about as much work as the other so there is
     no clear preference. As we just used the voltage divider rule in the prior
     example, let's use the current divider rule this time.

     We are going to need the combined capacitive reactance for the current
     divider, and we will also need it to find the total impedance, so let's do that
     first.

     X Ctotal =       1
                  1+1
                 X C1 X C2

     X Ctotal = 1 1 1
                -j4k + -j8k

     X Ctotal = 2667  -90 ° 

     This value is in parallel with the inductive reactance, and that combo is in
     series with the resistor, yielding the total impedance.

     Z CL =       1
               1 +1
             X Ctotal X L

     ZCL =             1      1
                 1          j1k 
             - j 2667  +

     ZCL = 1600  90° 

     Ztotal = R+ Z CL
     Ztotal = 2 k +1600  90 ° 
     Ztotal = 2561  38.7 ° 

     The source current is found using Ohm's law.

     isource = esource
               Z total

     isource = 40 0 ° V 2561  38.7 ° 

     isource = 15.6E-3  -38.7 ° A

     We now apply a current divider between XCtotal and the inductor.

120
                 iinductor = isource X Ctotal
                                   X Ctotal+X L

                 iinductor = 15.6E-3 -38.7° A - j 2667  - j 2667 +j 1000

                 iinductor = 24.99E-3  -38.7 ° A

     Once again we see a branch current that is larger in magnitude than the
     source current. This current should produce an inductor voltage of

                 vinductor = iinductor × X L
                 vinductor = 24.99E-3  -38.7 ° A ×1000  90 ° 
                 vinductor = 24.99  51.3 ° V

     The voltage across the resistor is

                 v R = i source× R
                 v R = 15.6E-3  -38.7 ° A ×2000  0 ° 
                 v R = 31.2 -38.7 ° V

     KVL indicates that the sum of vR and vinductor should equal the source of
     400° volts, and it does (within rounding limits).

It is now time for some examples that use current sources.                              Figure 4.12
                                                                                        Circuit for Example 4.6.
Example 4.6

         Determine va, vb and vab in the circuit of Figure 4.12. Use the source as the
         reference angle of 0 degrees.

         To find vb we can determine the equivalent impedance of the two
         resistors and the inductor and multiply it by the source current. The
         rightmost resistor and inductor are in series, yielding 10 + j20 . This
         is in parallel with the 18  resistor.

                      Z b = R1× Z LR
                             R1 +Z LR

                      Zb = 18×(10+ j 20) 18+(10+ j 20)
                      Zb = 11.7  27.9 ° 

121
                     vb = isource× Zb
                     vb = 2  0 ° A×11.7  27.9° 
                     vb = 23.4  27.9 ° V
         The voltage across the capacitor is vab. We can find this through Ohm's law.
         Given the reference direction of the current source, the capacitor's voltage
         reference polarity is + to - from left to right.
                     v ab = i source× X C
                     v ab = 2  0 ° A ×18 -90° 
                     v ab = 36 -90° V
         Finally, va is just vab plus vb based on KVL.
                     v a = vab+v b
                     v a = 36  -90° V+23.4  27.9° V
                     v a = 32.48  -50.5° V
         A phasor diagram is shown in Figure 4.13. Graphically, it can be seen that
         subtracting vb from va yields vab, as expected. Remember, this is a series-
         parallel circuit and therefore we do not see necessarily 0 degree or 90 degree
         angles between the various voltages as found in simple series-only circuits.

                                                                                                                   Figure 4.13
                                                                                                                   Phasor voltage plot for the
                                                                                                                   circuit of Figure 4.12.

122
Example 4.7

         For the circuit of Figure 4.14, determine vb if the 1 amp source is used as the
         reference (0°) and the 3 amp source has a 30° lagging phase angle.

                                                                                                                   Figure 4.14
                                                                                                                   Circuit for Example 4.7.

         The two current sources are in parallel and can be combined together. We
         must be a little careful regarding polarity, though. First of all, a "30° lagging
         phase angle" means that the second source is 3-30° amps. Along with this,
         its reference direction is opposite that of the first source. This means that the
         second source is negative or inverted by 180 degrees relative to source one.
         Thus, we can treat it as a downward source of -3-30° amps, or 3150°
         amps, whichever we prefer. Now that they're both configured as having a
         downward reference direction, we simply add them together.

                     itotal = i1+i2
                     itotal = 1  0 ° A +3  150° A
                     itotal = 2.192 136.8° A

         Alternately, we could subtract 3-30° amps from the first source based on
         the reference directions, and note that the resulting direction of the
         combination is the same as that of the first source. Another option would be
         to reverse the reference direction of the first source. This would yield an
         upward direction with a value of 2.192-43.2° amps.

         Having simplified the circuit to a single current source, it should be obvious
         that the inductor is in series with the 22  resistor, and that combination is
         in parallel with both the capacitor and the 33  resistor. Finding that parallel
         impedance would allow us to find va. Knowing va, a voltage divider between
         the series inductor/resistor combo will yield vb. An important thing to note is
         that, given the downward reference direction of the equivalent current
         source, KCL indicates that the current direction through the other
         components must be upward, meaning that both va and vb are negative with
         respect to ground.

123
     Z total = 1 1 1 1
     +            +
     X C R1+X L R2

     Ztotal = 1           1

                              1      1
     - j 80 + 22 +j 50 +33

     Ztotal = 26.38  6.45 ° 

     v a = -itotal× Ztotal
     v a =-2.192 136.8° A× 26.38 6.45° 
     v a = 57.8 -36.8° V

     If we had reversed the reference direction of the current source, using
     2.192-43.2° amps instead, the leading minus sign would not be required
     and we would arrive at the same result. Continuing,

     ( ) vb = va
        R1
     R1+X L

     vb = 57.8 -36.8 ° V 22 22+j 50

     vb = 23.29  -103° V

Analysis Across the Frequency Domain

For the most part, we have examined the response of a circuit to a single frequency
of excitation. In many electronic systems, such as in the field of communications,
numerous frequencies are present simultaneously. Recall from Chapter 1 how
complex wave shapes such as square waves, triangle waves or music signals can be
built from a series of sine waves. In such systems, the reactive components behave
as different values to the various frequencies simultaneously. For example, a
capacitor may have a reactance of -j400  for a 100 Hz signal while at the same
time offering a reactance of -j40  for a 1 kHz signal. It is this dynamic quality that
allows us to design circuits to suppress or block certain frequency components, or to
select specific frequencies from a large range or spectrum of frequency components.

We shall introduce this concept by first analyzing the circuit at a couple of specific
frequencies and then employ a simulator to perform a frequency domain analysis
(sometimes called an AC analysis) to plot complex response curves of voltage versus
frequency. The concept of frequency domain response will be expanded in upcoming
work, particularly in Chapter 10.

124
Example 4.8

         Consider the circuit shown in Figure 4.15. Assume the source is a one volt
         peak sine wave. Determine voltages va, vb and vc if the source frequency is
         10 kHz. Repeat this for an input frequency of 10 Hz.

                                                                                                                   Figure 4.15
                                                                                                                   Circuit for Example 4.8.

         If we treat E as the input and vc as the final output, this circuit behaves as a
         series of cascading frequency-dependent voltage dividers. Generally
         speaking, at low frequencies the capacitive reactances will be larger than the
         associated resistors, and most of the input voltage will make it to node c. At
         high frequencies, the capacitive reactances will be small resulting in
         considerable voltage division at each node. Thus, only a small percentage of
         the input will make it to the final output. In other words, this circuit will
         filter out or remove high frequencies from the input with considerable effect,
         much more so than a single RC network.

         First, we need to find the three capacitive reactances at 10 kHz. Starting at
         the left, we find

                      X C =- j 1 2  f C
                      X C =- j 1 2  10Hz 1  F
                      X C - j 15.92 

         The other capacitive reactances work out to -j31.83  and -j79.58 . The
         voltage va can be determined by a voltage divider between the 1 k resistor
         and the series-parallel combination of the remaining five components. First,
         the 5 k is in series with the 200 nF. That combination is in parallel with the
         500 nF, which is in turn in series with the 2 k resistor. Finally, that group
         of four is in parallel with the 1 F capacitor.

         The resistors and capacitors are numbered from left to right in the equations
         following. We will need each of the segment impedances for subsequent
         calculations.

125
     Z right3 =        1
                  1+ 1
                 X C2 Z right2

     Zright3 = 1                 1
               - j 31.83 +                1

                                5000  - j 79.58

     Zright3 = 31.83 -89.6 ° 

     Zright4 = R 2+Z right3
     Zright4 = 2000 +31.83 -89.6 ° 
     Zright4 = 2000  -0.91 ° 

     Zright5 =         1
                  1+1
                 X C1 Z right4

     Z right5 = 1               1
                                        1
                 - j 15.92  + 2000  -.91 ° 

     Zright5 = 15.92  -89.5 ° 

     At last we come to va:

     v a = esource Z right5
                  R1+Z right5

     v a = 1  0 ° V 15.92 -89.5°  1000  +15.92 -89.5 ° 

     v a = 15.92  -88.6° mV

     To find vb we perform a voltage divider between the 2 k resistor and Zright3
     using va as the input.

     vb = v a Z right3
              R2+Z right3

     vb = 15.92  -88.6° mV 31.83 -89.6 °  2000  +31.83 -89.6° 

     vb = 253.3  -177.3 ° V

126
         Finally, to find vc we perform a voltage divider between the 5 k resistor
         and 200 nF capacitor using vb as the input.

                     v c = vb X C3
                               R3 +X C3

                     v c = 253.3  -177.3°  V - j 79.58 5000  - j 79.58

                     v c = 4.03 93.6°  V

         Obviously, only a tiny percentage of the source signal is found at node c at
         this frequency.

         Repeating this process at 10 Hz yields capacitive reactances of -j15.92 k,
         -j31.83 k and -j79.58 k. At this level, the amount of signal lost through
         each segment is inconsequential. For example, for the final segment the
         voltage divider ratio works out to:

                     v c = X C3
                     vb R3+X C3
                      vc = - j 79.58 k 
                      vb 5000  - j 79.58 k 
                     v c = 0.998 -3.6 °
                     vb

         In other words, a mere 0.2% of the signal is lost and there is a modest -3.6°
         phase shift. The results at the other nodes are similar and left as an exercise.
         Thus we see that that the low frequencies are allowed through this network
         while the high frequencies are attenuated.

Computer Simulation

While the results of Example 4.8 should be convincing as to the performance of the
circuit, it should also be obvious that determining the voltages for any set of source
frequencies would be a tedious exercise. Fortunately, there are other techniques that
may be employed, such as those examined in Chapter 10. For now, though, we will
turn our attention to a simulator. Most simulators offer an AC analysis or frequency
domain analysis that will create two linked graphs; one for the voltage magnitude
and another for the phase. We begin by entering the circuit of Figure 4.15 into a
simulator as shown in Figure 4.16. Even though the schematic shows a 1 kHz source
frequency, the AC analysis will allow us to specify the starting and ending
frequencies for the plots. In this case, we'll use the 10 Hz and 10 kHz points
specified in the example. The results are shown in Figure 4.17.

127
                                                                                                                   Figure 4.16
                                                                                                                   The circuit of Figure 4.15 in a
                                                                                                                   simulator.

                                                                                                                   Figure 4.17
                                                                                                                   Frequency domain plots of
                                                                                                                   voltage for the circuit of
                                                                                                                   Figure 4.15.

The top graph plots the voltages at nodes a, b and c across frequency. It is obvious
that, as the frequency increases, the voltage at each node decreases. The lower graph
plots the phase shift at each of the nodes and it is apparent that the phase shift
increases in the negative direction as frequency is increased. This is expected
because, as the frequency increases, the capacitive reactance decreases, making each
128
parallel combination appear more capacitive, and approaching -90 degrees each. A
quick check of the voltage magnitudes and phases at 10 Hz indicates that very little
signal is lost at the three node and that the phase shifts are close to zero. Further, at
10 kHz, there is considerable signal loss through each section, with each section
producing nearly -90 degrees, just as calculated. Perhaps the only curious bit here is
the abrupt change in phase shift shown at node c around 300 Hz (red trace). This is
just an artifact of the plotting software. If an angle goes beyond ±180 degrees, the
value is rotated back the other way to keep the value within ±180. For instance,
-185 degrees is the same as +175 degrees.

Combining reactive elements can be a very effective means of selecting out a certain
range of frequencies, as further illustrated in the following example.

Example 4.9

         In Chapter 2 we introduced the concept of a loudspeaker crossover network.
         The idea was to "steer" low frequencies to the woofer (low frequency
         transducer) and high frequencies to the tweeter (high frequency transducer).
         An advancement on that simple system is to use a combination of capacitors
         and inductors in place of a simple RC or RL network. One possible
         configuration is illustrated in Figure 4.18. At high frequencies, the capacitive
         reactance will be small while the inductive reactance will be large. Thus,
         virtually all of the input signal will reach the loudspeaker. In contrast, at low
         frequencies the capacitive reactances will be large and the inductive
         reactance small, resulting in hardly any of the input signal reaching the
         loudspeaker. Somewhere in the middle, a significant portion of the signal
         will make it through. This point is referred to as the crossover frequency. If
         the source voltage is 1 volt peak, determine the voltage developed across an
         8  loudspeaker at a frequency of 2.6 kHz for this circuit.

                                                                                                                   Figure 4.18
                                                                                                                   Circuit for Example 4.9.

         First, we need to determine the reactances at the frequency of interest.

                      X C1 = - j 1 2  f C
                      X C1 = - j 1 2  2.6 kHz 5  F
                      X C1  - j 12.24 

129
     The second capacitor is three times as large and therefore its reactance will
     be one-third as much, or -j4.08 . For the inductor,

     X L= j2 f L
     X L = j 2  2.6 kHz 360 H
     X L  j 5.88 

     Now that we have the reactances, the loudspeaker voltage can be computed
     via a pair of voltage dividers. In order find the loudspeaker voltage we'll first
     find the voltage developed across the inductor. To find that, we need to find
     the combined impedance of the three components on the right.

     Zright3 =       1
     Zright3 =  1+ 1
                X L Z right2

                              1
                   1+ 1
                j 5.88 8 - j 4.08

     Zright3 = 6.44  50.3 ° 

     Now for the voltage divider to find vinductor.

     vinductor = esource Z right3
                        Z right3+X C1

     vinductor = 1  0 ° V 6.44 50.3°  6.44  50.3 °  - j 12.24 

     vinductor = 0.77  110.8° V

     And now the final voltage divider to find vloudspeaker.

     vloudspeaker = vinductor Zloudspeaker
                           Z loudspeaker +X C2

     vloudspeaker = 0.77  110.8°  V 8  8 - j 4.08 

     vloudspeaker = 0.686  137.9 ° V

     At this particular frequency the loudspeaker sees about 2/3rds of the source
     voltage. For any higher frequency, the loudspeaker will see a larger share of
     the 1 volt source and for any lower frequency, the loudspeaker see less. At
     very low frequencies, only a few microvolts may get through.

130
Computer Simulation

In order to get a better sense of the loudspeaker voltage as a function of frequency,
the circuit of Figure 4.18 is captured in a simulator as shown in Figure 4.19.

                                                                                                                   Figure 4.19
                                                                                                                   The circuit of Figure 4.18 in a
                                                                                                                   simulator.

An AC analysis simulation is performed with the output shown in Figure 4.20.
                                                                                                                   Figure 4.20
                                                                                                                   Frequency domain plot of the
                                                                                                                   loudspeaker voltage for the
                                                                                                                   circuit of Figure 4.18.

131
Both the magnitude and phase plots corroborate the calculated loudspeaker voltage
at 2.6 kHz. The magnitude plot shows that the loudspeaker voltage is very close to
the input level at frequencies above about 3 kHz. Below this frequency, the
loudspeaker voltage rolls off considerably. Down at 100 Hz, well into the bass
region, less than 100 microvolts, or under 0.01% of the input, reaches the
loudspeaker. This circuit would make for an effective crossover network to a high
frequency tweeter.

In closing, it is worth noting that a loudspeaker exhibits a complex impedance
instead of simple resistive value, however, modeling it as an 8  resistor is sufficient
to illustrate the operation of this circuit. We will take a closer look at the impedance
of loudspeakers and other devices in upcoming chapters.

4.5 Summary

In this chapter we have determined how to identify basic series-parallel RLC
networks driven by a single effective voltage or current source. The key to this is to
identify sub-circuits or subgroups of components that are comprised of either series-
only or parallel-only configurations within themselves. These groupings can then be
reduced to equivalent impedances using the series and parallel combination
techniques examined in prior chapters. This process may be repeated until the entire
circuit is simplified down to either a single series loop or parallel arrangement of
components driven by a voltage or current source.

Once a circuit has been simplified, series and parallel analysis techniques, and laws
such as Ohm's law, Kirchhoff's voltage and current laws, and the voltage and current
divider rules, may be employed to determine various voltages and currents in the
simplified equivalent. Given these results, the circuit may be expanded back into its
original form in stages, reapplying these rules and techniques to determine voltages
and currents within the sub-circuits. The process may be iterated until every current
and voltage in the original circuit is discovered, if desired.

As the impedances of the individual sub-circuits can be anywhere between +90 and
-90 degrees, phasor diagrams of the various component voltages or currents will no
longer exhibit the strict right angles seen in series-only and parallel-only circuits.
What is true is that this perpendicular relationship will still exist among the RLC
components that comprise a specific series or parallel sub-circuit.

There are infinite varieties of series-parallel RLC configurations and consequently no
single solution technique will work for all of them. In fact, the more complex the
circuit, the more solution paths that exist for said circuit. Consequently it is prudent
to plan out a solution path instead of just randomly "diving in" as this will lessen the
ultimate effort.

132
Review Questions

    1. In general, describe the process of reducing an AC series-parallel RLC
         network down to a single equivalent impedance.

    2. Do Ohm's law, KVL and KCL still apply in AC series-parallel RLC networks?
         Why?

    3. Is there a finite number of variations of AC series-parallel RLC networks?
         Why/why not?

    4. Describe a general procedure to find the voltage between two arbitrary
         points in a series-parallel circuit.

    5. In an AC series-parallel RLC circuit, will it always be the case that voltage
         across any resistor is in phase with that resistor's current? Why/why not?

    6. In an AC series-parallel RLC circuit, will it always be the case that voltage
         across any inductor leads any resistor's voltage by 90 degrees? Why/why
         not?

4.6 Exercises

Analysis

Assume the source's angle is 0 degrees unless specified otherwise.

    1. Determine the impedance of the circuit of Figure 4.21 at frequencies of
         100 Hz, 10 kHz and 1 MHz.

                                                                                Figure 4.21

    2. Determine the impedance of the circuit of Figure 4.22 at frequencies of
         20 Hz, 1 kHz and 20 kHz.

                                                                                Figure 4.22

133
    3. Determine the impedance of the circuit of Figure 4.23 at frequencies of
         300 Hz, 30 kHz and 3 MHz.
                                                                                Figure 4.23

    4. Determine the impedance of the circuit of Figure 4.24 at frequencies of
         1 kHz, 20 kHz and 1 MHz.
                                                                                Figure 4.24

    5. Determine the impedance of the circuit of Figure 4.25.
                                                                                Figure 4.25

    6. Determine the impedance of the circuit of Figure 4.26.
                                                                                Figure 4.26

134
    7. For the circuit of Figure 4.27, determine the source current and the current
         through each of the components.
                                                                                Figure 4.27

    8. For the circuit of Figure 4.27, determine voltages vab and vb.
    9. For the circuit of Figure 4.28, determine voltages across R, L and C if the

         source is 7 volts RMS.
                                                                                Figure 4.28

    10. For the circuit of Figure 4.28, determine the source current and the current
         through each of the three components. Also, draw a phasor diagram of E, vL
         and vR.

    11. For the circuit of Figure 4.29, determine the source current and the current
         through each of the components.
                                                                                Figure 4.29

    12. For the circuit of Figure 4.29, determine voltages vab and vb. Also, draw a
         phasor diagram of E, vab and vb.

135
    13. For the circuit of Figure 4.30, determine voltages vab and vb if the source is
         20 volts peak.
                                                                                Figure 4.30

    14. For the circuit of Figure 4.30, determine the source current and the current
         through each of the four components if the source is 20 volts peak.

    15. For the circuit of Figure 4.31, determine the source current and the current
         through each of the four components.
                                                                                Figure 4.31

    16. For the circuit of Figure 4.31, determine voltages vab and vb.
    17. For the circuit of Figure 4.32, determine voltages vab and vb if the source is

         100 volts peak.
    18. For the circuit of Figure 4.32, determine the currents through the two

         resistors.
                                                                                Figure 4.32

136
    19. For the circuit of Figure 4.33, determine the currents each of the three
         components.
                                                                                Figure 4.33

    20. For the circuit of Figure 4.33, determine voltages va and vb.
    21. For the circuit of Figure 4.34, determine voltages va and vb.

                                                                                Figure 4.34

    22. For the circuit of Figure 4.34, determine the middle and right branch
         currents and draw a phasor diagram of three circuit currents.

    23. For the circuit of Figure 4.35, determine voltages va and vb.
    24. For the circuit of Figure 4.35, determine the currents through the two

         resistors.
                                                                                Figure 4.35

137
    25. For the circuit of Figure 4.36, determine voltages va and vb. isource = 25 mA.
                                                                                Figure 4.36

    26. For the circuit of Figure 4.36, determine the currents through the two
         capacitors.

    27. For the circuit of Figure 4.37, determine the current through the capacitor.
         i1 = 10E-30° A and i2 = 3E-390° A.
                                                                                Figure 4.37

    28. For the circuit of Figure 4.37, determine voltages va and vb.
         I1 = 10E-30° A and I2 = 3E-390° A.

    29. For the circuit of Figure 4.38, determine voltages va and vb. i1 = 245° A and
         i2 = 0.50° A.
                                                                                Figure 4.38

    30. For the circuit of Figure 4.38, determine the currents through the two
         resistors. i1 = 245° A and i2 = 0.50° A.

138
    31. For the bridge circuit of Figure 4.39, determine vab. The source is 50 volts
         peak.
                                                                                Figure 4.39

    32. For the bridge circuit of Figure 4.40, determine vab. The source is 6 amps
         peak.
                                                                                Figure 4.40

Design

    33. Determine a new value for the capacitor in Figure 4.27 such that vb is
         1.5 volts.

    34. Determine the required inductive reactance in Figure 4.28 to shift the
         capacitor voltage to half of the source voltage.

    35. Determine a new value for the 20 nF capacitor in Figure 4.29 such that the
         resistor current is 2 mA.

139
    36. In the circuit of Figure 4.41, determine a value for L such that the magnitude
         of vb equals va/2 if the source frequency is 10 kHz, R = 2.7 k and
         C = 10 nF.
                                                                                Figure 4.41

    37. Given the circuit of Figure 4.41, determine a value for C such that the
         source current is in phase with the source voltage. The source frequency is
         1 kHz, R = 68  and L = 22 mH.

    38. Given the circuit of Figure 4.42, determine a value for L such that vb is
         1 volt. The source is a 6 volt peak sine at 50 kHz, R1 = 510  and
         R2 = 220 .
                                                                                Figure 4.42

    39. Given the circuit of Figure 4.39, determine a new value for the inductor such
         that the magnitude of vb equals the magnitude of va. Assume that the source
         frequency is 20 kHz.

140
Challenge

    40. Consider the circuit drawn in Figure 4.43. Using only the available
         components of 1 k, 2.2 k, 1 mH, 5 mH, 10 nF, 75 nF and 560 nF, is it
         possible to configure a circuit such that va is half the magnitude of vb for a
         source frequency of 1 kHz? If so, indicate which values could be used for
         the four components. If not, explain your reasoning.
                                                                                Figure 4.43

    41. Given the circuit of Figure 4.29, determine the frequency at which vb is half
         of the source voltage.

    42. For the circuit of Figure 4.44, determine voltages va, vb , and vc. i1 = 50° A
         and i2 = 390° A.
                                                                                Figure 4.44

    43. Given the circuit of Figure 4.39, is it possible to change the values of the
         two resistors such that the phase angle of va is the same as that of vb? If so,
         what are the new values, and if not, explain why it is not possible.

141
Simulation

    44. Perform a transient analysis to verify the node voltages computed for
         problem 8.

    45. Perform a transient analysis to verify the node voltages computed for
         problem 12.

    46. Perform a transient analysis to verify the node voltages computed for
         problem 20.

    47. Perform a transient analysis to verify the node voltages computed for
         problem 21.

    48. Consider the circuit of problem 17. Assuming the source frequency is
         10 kHz, determine values for the capacitors and inductors. Then, use a
         transient analysis to verify the results of problem 17.

    49. Perform a transient analysis on the result of problem 33 to verify the
         accuracy of the design.

    50. Perform a transient analysis on the result of problem 34 to verify the
         accuracy of the design.

    51. Use an AC frequency response simulation to verify the results of
         problem 41.

    52. The concept of a loudspeaker crossover network was presented originally in
         Chapter 2, Series RLC Circuits. In this chapter, we noted that by adding
         more components, it is possible to increase the rate of attenuation. In doing
         so the undesired signals are further reduced in amplitude. The circuits of
         Figure 4.45 and 4.46 (following page) show improved crossovers for a
         woofer and tweeter, respectively. Assuming standard 8  loudspeakers, use
         an AC frequency domain simulation to determine the crossover frequency of
         each network. Also, compare the curves at node a to those at node b. Finally,
         compare the attenuation slopes to those generated by the simpler crossover
         network presented at the end of Chapter 2. Component values for the
         woofer: L1 = 760 H, L2 = 250 H, C = 10.6 F. Component values for the
         tweeter: C1 = 5.3 F, C2 = 16 F, L = 380 H.

142
                                                                                Figure 4.45
                                                                                Figure 4.46

143
5 Analysis Theorems and Techniques

5.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Find the voltage source equivalent of a current source and vice versa.
    · Compute voltages and currents in multi-source RLC networks using superposition.
    · Simplify RLC networks using Thévenin's and Norton's theorems.
    · Determine conditions for maximum power transfer and compute the maximum power.
    · Utilize delta-Y and Y-delta conversions for circuit simplification.

5.1 Introduction

In this chapter we shall examine a number of theorems and techniques to help us analyze complex circuits and
address specialized applications. We will begin by examining the concept of source impedance in order to make
more accurate models of our idealized constant voltage and current sources. This will be a step beyond using a
simple resistance as found in the DC case. From there we will investigate how to convert from one type of
source to another, such as creating a voltage source that is the functional equivalent of a current source. A
functional equivalent is a source that can be swapped out for another while leaving all of the other circuit
currents and voltages intact. In other words, all of the circuit's component voltage drops and branch currents will
be identical to those found in the original configuration. This technique is useful in a number of ways,
particularly in that it can help reduce more complex circuits to simplify analysis.

The concept of equivalence can be extended beyond just a single source to an entire network. For this we will
examine Thévenin's and Norton's theorems. Using these theorems, entire circuits utilizing dozens of components
can be modeled as a single source with an associated complex impedance. When coupled with the maximum
power transfer theorem, these tools will allow us to determine component values that produce the maximum
amount of load power.

We will also address a method of analyzing circuits that contain multiple current and/or voltage sources that are
connected in a non-trivial fashion (i.e., not just series voltage sources or parallel current sources). This is called
the superposition theorem and it can be applied to any circuit or parameter that meets certain requirements,
including circuits that have a mix of current sources and voltage sources. Superposition can also be used to
determine voltages and currents when sources use different frequencies. In fact, one of way of imagining a
complex waveshape is to treat it as a series of connected sources, each with a unique frequency, phase and
amplitude. Superposition we give us a means to handle this new situation.

144
Finally, we will examine how to find equivalent circuits for certain component
arrangements that use three connecting points, in other words, RLC combinations
shaped like a triangle or like the letter Y. These are known as delta and Y
configurations. These configurations are difficult to address with basic series-
parallel simplification techniques. Converting from one configuration to the other
will help solve that issue.

5.2 Source Conversions

In DC analysis, we noted that real world sources have practical limits: voltage
sources cannot produce infinite current and current sources cannot produce infinite
voltage. A simple way of creating a more accurate model for independent sources is
to include an internal resistance. For DC voltage sources, a resistance is added in
series with the source, and for DC current sources a resistance is added in parallel
with the source. While this works well enough for typical DC sources, the AC
situation is a little more complicated.

Models for AC Sources

Just as we added a simple resistance to the DC sources to make improved models,
we can add a complex impedance to AC sources to do likewise. Once again, it is
possible to make even more involved models that will be more accurate, but for
most work, this addition will suffice. Generally, there are wider variations in values
for the AC case than the DC case.

We can think of AC sources as belonging in one of two broad categories. First, there
are power generators, that is, systems designed to generate and deliver power for
other electrical devices. This would include the AC mains system in a residence or a
portable power generator. At the other end of the spectrum are signal sources such as
transducers and sensors. These devices are generally low power and are not designed
to produce particularly high currents, quite the opposite of generators.

The model for an AC voltage source adds an impedance in series, as shown in               Figure 5.1
Figure 5.1. This impedance sets an upper limit on the source's current output. Even       Practical AC voltage source
if the output terminals are shorted, the maximum current will be dictated via Ohm's       model.
law to be the source voltage divided by the internal impedance, or E/Zinternal.
Obviously, this internal impedance will create some voltage divider effect with the
attached load. To minimize this effect, the impedance should be as small as
practicably possible. Thus,

     The ideal internal impedance of a voltage source is zero ohms (a short).

It is not always possible to get close to this ideal. In fact, in some situations the AC
source is far removed from the ideal.

145
Consider the signal source shown in Figure 5.2. This is a pickup for an electric bass
guitar. This device is used to translate the motions of guitar strings into a voltage
that can be fed to an amplifier. It consists of a few thousand turns of very fine
magnet wire wrapped around a magnet.

                                                                                                                   Figure 5.2
                                                                                                                   An electric bass guitar pickup
                                                                                                                   (cover removed).

When the metal guitar strings vibrate, they alter the surrounding magnetic field. As
the magnetic field changes, it induces a current, and hence a voltage, in the coil. The
resulting signal is an electrical analog of the string vibrations. It is, quite literally, an
AC signal source. But what of its internal impedance? The coil is made of wire
between AWG 40 and 45, and may be in excess of 1000 feet (300 meters) in length.
Consulting an AWG table3, we find that this will yield 1000 or more ohms of
resistance. Of course, a few thousand turns of wire will also create a hefty
inductance and pickups such as this may exhibit an inductance of a few henries.
Putting these pieces together, the equivalent internal impedance might look
something like that shown in Figure 5.3.

Clearly, values like these are a far cry from the fractional ohm values found in               Figure 5.3
power generation sources, and they present unique challenges. In the circuit of                Example of internal
Figure 5.3, the component labeled Zin represents the input impedance of the                    impedance of guitar pickup.
associated amplifier. Typically, it would be highly resistive but the magnitude can
vary quite a bit depending on the application. A guitar or bass amplifier may exhibit
1 M or more, while an auxiliary input on a home stereo might be 10 k. What
happens if you plug a guitar into your hi-fi? Obviously, this system creates a voltage
divider between the internal impedance of the pickup and the input impedance of the
amplifier, but more importantly, the divider is a function of frequency. At low
frequencies like 100 Hz, the inductive reactance is small, around j600 , and the
signal loss to a 10 k input is not that great. On the other hand, at a high frequency
such as 10 kHz, the inductive reactance will be over j60 k resulting in considerable
signal loss. Thus, the high frequencies are reduced relative to the low frequencies.
The sonic effect is akin to turning down the treble control -- everything will seem
muffled. If the input impedance is increased considerably, say by a factor of 100,
then the voltage divider effect at all audible frequencies will be negligible and the
the instrument will sound true to form. Finally, although this example shows a
substantial inductance, it is possible for AC sources to have an associated
capacitance, or even have negligible reactance (i.e., be purely resistive).

3 Such as the one found in Chapter 2 of the companion text, DC Electrical Circuit Analysis,
    a companion free OER text by the author.

146
For a current source, the improved model adds an impedance in parallel, as shown        Figure 5.4
in Figure 5.4. This impedance sets an upper limit on the source's voltage output. If    Practical AC current source
the output terminals are opened, the maximum voltage will no longer produce a           model.
huge voltage. Instead, it is dictated by Ohm's law to be the source current times
the internal impedance, or IZinternal. This internal impedance will create some
current divider effect with the attached load. To minimize this effect, the internal
impedance should be as large as practicably possible. Thus,

The ideal internal impedance of a current source is infinite ohms.

From here on, whenever we deal with practical voltage and current sources, we
understand that these sources have some associated internal resistance, even if
they're not shown explicitly in a schematic diagram. Further, whenever we talk about
ideal sources, we simply use a short for the internal impedance of a voltage source
and an open for the internal impedance of a current source.

Source Equivalences

For any voltage source consisting of an ideal voltage source with a series internal
impedance, an equivalent current source may be created. Similarly, for any current
source consisting of an ideal current source with a parallel internal impedance, an
equivalent voltage source may be created. By "equivalent", we mean that both
circuits will produce the same voltage and current to identical loads. Consider the
simple voltage source on the left side of Figure 5.5. Its equivalent current source is
shown on the right.

                                                                                        Figure 5.5
                                                                                        A simple AC voltage source
                                                                                        (left) and corresponding
                                                                                        current source (right).

For reasons that will become apparent under the section on Thévenin's theorem
following, the internal impedances of these two circuits must be identical if they are
to behave identically. Knowing that, it is a straightforward process to find the
required values of the other source. The current/voltage characteristic is linear for
these circuits, and a straight plot line can be defined by just two points. The two
obvious points to use are the opened and shorted load cases. In other words, if the
circuit is equivalent for these two situations, it must work for any load. The shorted
load case produces a large load current with zero load voltage, and the opened load
case produces a large load voltage with zero load current. It would not make sense if
the equivalent source could produce a greater current or voltage under the same
extreme conditions as the original.

147
For example, given a voltage source, the current that can be developed when the
load is shorted is E/Zinternal. Under that same load condition, all of the current from
the current source version must be flowing through the load (otherwise the load isn't
shorted). Therefore, the value of the equivalent current source must be the current of
E/Zinternal. Note that the resulting source normally will not have the same phase angle
as the original source due to the phase angle of the associated impedance.

To continue, if we look at the open load case for the voltage source, the load current
would be zero and the load voltage would be the entire source voltage of E. For the
current source, the load would also see no current and its voltage would be the
voltage appearing across its internal resistance which is Zinternal times the current
E/Zinternal, or just E. Thus, the two behave identically at the load limits.

Similarly, if we start with a current source, an open load produces a load voltage of
IZinternal. Therefore, the equivalent voltage source must have a value of IZinternal. For
the current source, a shorted load would produce a load current equal to the source
value, or I. The voltage source version would produce a current of E/Zinternal, where
the value of E was just found to be equal to IZinternal, and thus the load current would
be IZinternal/Zinternal, or just I. Once again, the two versions behave identically at the
load limits.

Changing the source frequency results in different values for both the reactance and
the converted source voltage or current, thus the equivalent is valid only for the
frequency in question.

To summarize the process of source conversion:

    · The internal impedance will be the same for both versions.
    · If converting from a voltage source to a current source, the value of the

         current source will be the short circuit current available from the voltage
         source (i.e., shorted load case), and is equal to E/Zinternal.
    · If converting from a current source to a voltage source, the value of the
         voltage source will be the open circuit voltage available from the current
         source (i.e., opened load case), and is equal to IZinternal.
    · The equivalent is unique to the frequency of the source.

If a multi-source is being converted (i.e., voltage sources in series or current sources
in parallel), first combine the sources to arrive at the simplest source and then do the
conversion. Do not convert the sources first and then try to combine them as you
will wind up with series-parallel configurations rather than simple sources.

Judicious use of source conversions can sometimes simplify multi-source circuits by
allowing converted sources to be combined, resulting in a single source.

148
Example 5.1                                                                            Figure 5.6
                                                                                       Circuit for Example 5.1.
         Convert the source of Figure 5.6 into its current source equivalent.
         E = 2 0° volts RMS.

         First, the existing impedance of 80 - j60  does not change, it is simply
         moved to a parallel position. To find the value of the current source,
         compute the short circuit current the existing source is capable of
         producing.

                      I = EZ
                      I = 2 0°V

                           80 - j 60
                      I = 0.02 36.9 ° A

         The result is shown in Figure 5.7. The current source is 20 mA RMS with a
         leading phase angle of 36.9 degrees.

                                                                                       Figure 5.7
                                                                                       Current source equivalent of
                                                                                       the source of Figure 5.6.

Example 5.2                                                                            Figure 5.8
                                                                                       Circuit for Example 5.2.
         Convert the source of Figure 5.8 into its voltage source equivalent.
         I = 0.10° amps peak.

         Again, the internal impedance of 100 + j20  does not change and we
         simply place it in series. To find the value of the voltage source, find the
         open circuit voltage the existing source is capable of producing.

                      E = I×Z
                      E = 0.1  0 ° A×(100 +j 20)
                      E  10.2  11.3° V

         The equivalent is shown in Figure 5.9. The voltage source E is 10.2 volts
         peak with a leading phase angle of 11.3 degrees.

149
                                                                                                                   Figure 5.9
                                                                                                                   Voltage source equivalent of the
                                                                                                                   source of Figure 5.8.

Computer Simulation

To verify this process, the circuits of Figures 5.8 and 5.9 are entered into a simulator.
The original circuit simply specified an inductive reactance so a convenient
frequency of 1 kHz was used and then an appropriate inductor was created that
would yield the desired reactance of j20 . This turned out to 3.183 mH. Further, a
random load resistor (200 ) was picked and applied to both circuits. The result is
shown in Figure 5.10.

                                                                                                                   Figure 5.10
                                                                                                                   The circuits of Figures 5.8 and
                                                                                                                   5.9 in a simulator.

If these two circuits are equivalent, then the voltages seen across the 200  load
resistors should be identical. These voltages correspond to node voltages 12 and 8. A
quick voltage divider computation shows that the load voltage should be
approximately 6.7857.5° volts peak.
A transient analysis is performed, plotting the load voltages. The results are shown
in Figure 5.11. The plot itself is delayed by one millisecond in order to get past the
initial turn-on transient. Further, the current source circuit is shifted by
approximately 2 microseconds. Without this slight shift in time, the two voltages
perfectly overlap so that it appears there is only one trace. By looking carefully at
the graph it can be seen that there are indeed two traces. The amplitudes of these
waveforms match each other perfectly and also match the computed result.

150
                                                                                                                   Figure 5.11
                                                                                                                   Simulation results for the
                                                                                                                   source conversion.

Now let's turn our attention to using source conversion to simplify and solve a multi-
source circuit.
Example 5.3

         For the circuit of Figure 5.12, determine vb. I = 2E-390° amps peak and
         E = 100° volts peak.

                                                                                                                   Figure 5.12
                                                                                                                   Circuit for Example 5.3.

         One method of solution is to transform the voltage source into a current
         source. By doing so, the entire circuit is reduced to a parallel network. The
         two current sources can then be summed and the remaining three
         components can be combined into one equivalent parallel impedance. At that
         point Ohm's law can be used to find vb.
151
         The value of the current source is:

                      I c = EZ
                      I c = 10 0 ° V 27 k 
                      I c = 0.3704E-3  0 ° A

         The converted circuit is shown in Figure 5.13 (in blue).

                                                                                                                   Figure 5.13
                                                                                                                   Circuit of Figure 5.12 with
                                                                                                                   converted source.

         Combining the two current sources and using an upward reference direction
         yields:

                      I total = Ic- I
                      I total = 0.3704E-3  0 ° A-2E-3  90° A
                      I total = 2.034E-3 - 79.5 ° A

         The combined impedance is:

                      Ztotal = 1 1 1 1
                                    ++

                                X C R1 R2
                      Ztotal = 1 1 1 1

                               - j 10 k  + 27k  + 5.6 k 
                      Ztotal = 4208  -24.9 ° 

         And finally we compute vb:
                     vb = I total× Ztotal
                     vb = 2.034E-3  -79.5 ° A×4208  -24.9 ° 
                     vb = 8.56 -104.4 ° V

         We can perform a KCL crosscheck at node b to verify the results in the
         original circuit. Given the reference directions, all currents are flowing out
         of the node except for the current supplied by the voltage source.

152
                     iEsource = E-vb
                                   R1

                     iEsource = 10 0 ° V-8.56  -104.4 ° V 27 k 
                     iEsource = 0.544E-3  34.4 ° A

         The remaining three currents should add up to this value.

                     icapacitor = v b
                                  XC

                     icapacitor = 8.56  -104.4 ° V - j 10 k 
                     icapacitor = 0.856E-3  -14.4 ° A

                     iR2 = vb
                             R2

                     iR2 = 8.56  -104.4 ° V 5.6 k 
                     iR2 = 1.53E-3 -104.4° A

         Finally, 0.856E-3-14.4° + 1.53E-3-104.4° + 2E-390° amps does
         indeed equal 0.544E-334.4° amps, within carried rounding error.

5.3 Superposition Theorem

Superposition allows the analysis of multi-source AC series-parallel circuits.
Superposition can only be applied to networks that are linear and bilateral.
Fortunately, all of components we have discussed; resistors, capacitors and
inductors, fall into that category. Further, superposition cannot be used to find values
for non-linear functions, such as power, directly. This is not a limitation though
because power can be computed from the resulting voltage or current values.

The basic idea is to determine the contribution of each source by itself, and then
combine the results to get the final answer. The contributions are either all voltages
or all currents, depending on need. We can state the superposition theorem as:

         Any voltage or current in a multi-source linear bilateral network may be
         determined by summing the contributions caused by each source acting
         alone, with all other source replaced by their internal impedance.

The process generates a series of new single-source circuits, one for each source.
These new circuits are then analyzed for the parameter(s) of interest.

153
Consider the circuit depicted in Figure 5.14.

                                                                                          Figure 5.14
                                                                                          A basic multi-source circuit.

Here we see two voltage sources, E1 and E2, driving a three element series-parallel
network. As there are two sources, two derived circuits must be created; one using
only E1 and the other using only E2. When considering a given source, all other
sources are replaced by their ideal internal impedance: for a voltage source, that's a
short; and for a current source, an open. We start by considering E1. In the new
circuit E2 is replaced with a short. This leaves a fairly simple network where XC and
XL are in parallel. This combination is in series with R and E1. Using basic series-
parallel techniques, we can solve for desired quantities such as the current flowing
through R or the voltage vb. It is important to indicate the reference current direction
and voltage polarity with respect to the source being considered (here, that's left-to-
right and positive, respectively). The process is then repeated for E2, shorting E1
and leaving us with R in parallel with XC, which is in turn in series with XL and E2.
Note that although in this version Vb is still positive, the reference current direction
for R is now right-to-left. The numerical results from this version are added to those
of the E1 version (minding polarities and directions) to achieve the final result. If
power is needed, it can be computed from these currents or voltages. Note that
superposition can work with a mix of current sources and voltage sources. The
practical downside is that for large circuits using many sources, numerous derived
circuits will need to be analyzed. For example, if there are three voltage sources and
two current sources, then a total of five derived circuits will be created.

It is also possible to use superposition to find the resulting currents or voltages in a
circuit that uses sources with different frequencies. In this instance, the equivalent
circuits will have different reactance values. In fact, a single non-sinusoidal source
can be analyzed using this method by treating the source as a series of superimposed
sine waves with each sine source producing a new circuit with its own unique
reactance values.

To summarize the superposition technique:

    · For every voltage or current source in the original circuit, create a new sub-
         circuit. The sub-circuits will be identical to the original except that all
         sources other than the one under consideration will be replaced by their
         ideal internal impedance. This means that all remaining voltage sources will
         be shorted and all remaining current sources will be opened.

154
    · Indicate the reference current directions and voltage polarities on each of the
         new sub-circuits, as generated by the source under consideration.

    · Solve each of the sub-circuits for the desired voltages and/or currents using
         standard series-parallel analysis techniques. Make sure to note the reference
         voltage polarities and current directions for these items.

    · Add all of the contributions from each of the sub-circuits to arrive at the
         final values, being sure to account for current directions and voltage
         polarities in the process.

To illustrate the superposition technique, let's reexamine the dual source circuit
shown in Figure 5.12 (repeated in Figure 5.15 for ease of reference). We will solve
this using superposition and compare the results to those of Example 5.3 which used
source conversion.
Example 5.4

         For the circuit of Figure 5.15, determine vb using superposition.
         I = 2E-390° amps peak and E = 100° volts peak.

                                                                                                                   Figure 5.15
                                                                                                                   Circuit for Example 5.4.

         As the circuit has two sources, it will require two sub-circuits. For the
         voltage source, the current source will be replaced with an open. For the
         second circuit utilizing the current source, the voltage source will be
         replaced with a short. First, using the voltage source we find:

                                                                                                                   Figure 5.16
                                                                                                                   Circuit of Figure 5.15
                                                                                                                   considering voltage source.

155
         For this circuit, vb may be determined via a voltage divider. To proceed, we
         need the impedance of the parallel combo on the right.

                      Z right2 = R × jX C
                                 R - jX C

                      Zright2 = 5.6 k ×(- j 10 k ) 5.6 k  - j 2 k 
                      Zright2 = 4886  - 29.2 ° 

         Now for the voltage divider to find the contribution of the first source to vb.
                     vb1 = E Z right2
                               Z right2 + R1
                     vb1 = 10  0° V 4886  -29.2 °  4886  -29.2°  +27 k 
                     vb1 = 1.558  -24.88° V

         We turn our attention to the current source's contribution. We short the
         voltage source and redraw:

                                                                                                                   Figure 5.17
                                                                                                                   Circuit of Figure 5.17
                                                                                                                   considering current source.

         This is a simple parallel circuit. We can find vb by placing the resistors and
         capacitors in parallel, and then using Ohm's law. Note that the reference
         direction of the current source is downward, meaning that the component
         current is upward, which makes vb negative (i.e., + to - bottom to top). The
         parallel impedance is:

                      Ztotal = 1 1 1 1
                                    ++

                                X C R1 R2
                      Ztotal = 1 1 1 1

                               - j 10 k  + 27k  + 5.6 k 
                      Ztotal = 4208  -24.9 ° 

156
         We apply Ohm's law to find this source's contribution to vb.
                     vb2 = I × Z total
                     vb2 =-2E-3  90° A×4208  -24.9° 
                     vb2 = 8.416  -114.9° V

         The final result is the sum of the two parts:
                     vb = v b1 +v b2
                     vb = 1.558 - 24.88° V +8.416 -114.9 ° V
                     vb = 8.558 -104.4 ° V

         This is virtually the same value obtained using the source conversion
         technique in the prior example.

As mentioned previously, superposition can be used to determine the results even
when the sources use different frequencies. This will be explored in the next
example.
Example 5.5

         For the circuit of Figure 5.18, determine vb.

                                                                                                                   Figure 5.18
                                                                                                                   Circuit for Example 5.5.

         Using superposition, we derive two new circuits, each with unique reactance
         values. The first circuit is shown in Figure 5.19.

                                                                                                                   Figure 5.19
                                                                                                                   Circuit for Example 5.5,
                                                                                                                   first source only.

157
         The reactance values are:

                      X L= j2 f L
                      X L = j 2  1 kHz 50 mH
                      X L  j 314.2

                      X C = - j 1 2  f C
                      X C =- j 1 2  1 kHz 750 nF
                      X C - j 212.2

         A voltage divider can be used to find this portion of vb. The parallel combo
         of the 2 k resistor and capacitor is 211-83.9° .

                     vb1 = E Z right2
                               Z right2 + X L

                     vb1 = 10  0° V 211  -83.9°  211 -83.9°  +314.2  90 ° 
                     vb1 = 19.78  -161.9 ° V

         Remember, this waveform is at a frequency of 1 kHz. We can repeat this
         process for the second source which uses 10 kHz. At this new frequency the
         inductive reactance will be ten times larger, or j3142 , and the capacitive
         reactance will be ten times smaller, or -j21.22 . The new circuit is shown
         in Figure 5.20.

                                                                                                                   Figure 5.20
                                                                                                                   Circuit for Example 5.5,
                                                                                                                   second source only.

         Once again, a voltage divider can be used to find this portion of vb. The
         parallel combo of the 2 k resistor and inductor is 168732.5° .

                     vb2 = E Z left2
                               Zleft2 + X C

                     vb2 = 2  0 ° V 1687  32.5 °  1687  32.5 °  +21.22 -90° 
                     vb2 = 2.01 0.6 ° V

158
                 This contribution is at a frequency of 10 kHz. Thus, the combination is a
                 relatively small 10 kHz sine at about 2 volts peak riding on a 1 kHz sine that
                 is nearly ten times larger in amplitude. This is shown in Figure 5.21.

                                     Time Domain Graph

                 25 vb

                 20        vb1                                                       Figure 5.21
                                                                                     Voltage plot for Example 5.5.
                 15
                                                                              2
                 10

Voltage (volts)  5    vb2

                 0

                 -5

                 -10

                 -15

                 -20

                 -25

                 0              0.5  1                  1.5

                                     Time (msec)

Computer Simulation

In order to verify the two-component waveform of Example 5.5, the circuit of
Figure 5.18 is captured in a simulator as shown in Figure 5.22.

                                                                                                 Figure 5.22
                                                                                                 Circuit of Example 5.5 in a
                                                                                                 simulator.

159
A transient analysis is performed. The results are illustrated in Figure 5.23.

                                                                                     Figure 5.23
                                                                                     Simulation results for the
                                                                                     circuit of Example 5.5.

The results match the computed values nicely. We can see the small amplitude high
frequency sine wave effectively following the contour of the much larger 1 kHz sine
wave.

5.4 Thévenin's and Norton's Theorems

These theorems are related in that they allow complex linear networks to be
simplified down to a single source with an associated internal impedance. They
simplify analysis when checking a circuit with multiple possible loads.

Thévenin's Theorem

Thévenin's theorem is named after Léon Charles Thévenin. It states that:

         Any single port linear network can be reduced to a simple voltage source,
         Eth, in series with an internal impedance Zth.

160
It is important to note that a Thévenin equivalent is valid only at a particular
frequency. If the system frequency is changed, the reactance and impedance values
will change and the resulting Eth and Zth values will be altered. Consequently, these
equivalents are generally not appropriate for a circuit using multiple sources with
differing frequencies4. A generic example of a Thévenin equivalent is shown in
Figure 5.24.

                                                                                                                   Figure 5.24
                                                                                                                   Generic Thévenin equivalent
                                                                                                                   circuit.

The phrase "single port network" means that the original circuit is cut in such a way
that only two connections exist to the remainder of the circuit. That remainder may
be a single component or a large multi-component sub-circuit. Eth is the open circuit
voltage at the port and Zth is the impedance looking back into the port (i.e., the
equivalent that now drives the remainder). As there are many ways to cut a typical
circuit, there are many possible Thévenin equivalents. Consider the circuit shown in
Figure 5.25.

                                                                                                                   Figure 5.25
                                                                                                                   Circuit under consideration for
                                                                                                                   a Thévenin equivalent.

Suppose we want to find the Thévenin equivalent that drives R2. We cut the circuit
immediately to the left of R2. That is, The first step is to make the cut, removing the
remainder of the circuit. In this case the remainder is just R2. We then determine the
open circuit output voltage at the cut points (i.e., at the open port). This voltage is
called the Thévenin voltage, Eth. This is shown in Figure 5.26. In a circuit such as
this, basic series-parallel analysis techniques may be used to find Eth. In this circuit,
due to the open, no current flows through the inductor, L, and thus no voltage is
developed across it. Therefore, Eth must equal the voltage developed across the
capacitor, C.

4 It is possible that an equivalent can be valid across a specified range of frequencies, but it
    will not hold for all frequencies.

161
                                                                                                                   Figure 5.26
                                                                                                                   Eth,the open circuit output
                                                                                                                   voltage.

The second part is finding the Thévenin impedance, Zth. Beginning with the "cut"
circuit, replace all sources with their ideal internal impedance (thus shorting voltage
sources and opening current sources). From the perspective of the cut point, look
back into the circuit and simplify to determine its equivalent impedance. This is
shown in Figure 5.27. Looking in from where the cut was made (right side), we see
that R1 and XC are in parallel, and this combination is then in series with XL. Thus, Zth
is equal to jXL + (R1 || -jXC).

                                                                                                                   Figure 5.27
                                                                                                                   Finding Zth.

As noted earlier, the original circuit could be cut in a number of different ways. We
might, for example, want to determine the Thévenin equivalent that drives C in the
original circuit of Figure 5.25. The new port location appears in Figure 5.28.

                                                                                                                   Figure 5.28
                                                                                                                   An alternate port location.

Clearly, this will result in different values for both Eth and Zth. For example, Zth is
now R1 || (R2 + jXL).
A common error is to find Zth from the wrong perspective, namely, finding the
impedance that the source drives. This is flatly incorrect. Remember, Zth is found by
looking into the port and simplifying whatever is seen from there. One way to
remember this is that it is possible to create equivalents for multi-source circuits. In
that instance, there isn't a single driving source, so finding its load impedance is
nonsensical.

162
Measuring the Thévenin Equivalent in the Laboratory

In a laboratory situation, the Thévenin equivalent can be found quickly and
efficiently with the proper tools. First, the circuit is "cut", leaving just the portion to
be Thévenized. The voltage at the cut points is measured with an oscilloscope. This
is Eth. All of the sources are then replaced with their internal impedance, ideally
shorting voltage sources and opening current sources5. An LCR impedance meter can
then be connected to the port to read Zth. If an impedance meter is not available, then
the source(s) are left in place and an LCR substitution box is placed at the cut points.
The box is adjusted so that the voltage across it is equal to half of Eth. By the voltage
divider rule, the value of the substitution box must be equal to Zth. In this case, the
substitution box will yield either an inductance or capacitance value which can then
be turned into a reactance given the frequency.
Example 5.6

         For the circuit of Figure 5.29, determine the Thévenin equivalent that drives
         the 300  resistor and find vc. Assume the source angle is 0°.

                                                                                                                   Figure 5.29
                                                                                                                   Circuit for Example 5.6.

         First, let's find Eth, the open circuit output voltage. We cut the circuit so that
         the 300  resistor is removed. Then we determine the voltage at the cut
         points. This circuit is shown in Figure 5.30.

                                                                                                                   Figure 5.30
                                                                                                                   Circuit for finding Eth for
                                                                                                                   Example 5.6.

5 A typical laboratory signal generator has a 50  internal impedance, and using this value
    would be more accurate than just replacing the source with a shorting wire.

163
     There is no current flowing through the inductor due to the open. Therefore,
     the voltage across the inductor is zero. Consequently, Eth is the voltage
     across the capacitor, and that can be found with a voltage divider.

                 Eth = E X C
                           X C +R1

                  Eth = 10  0 ° V - j 200 - j 200 +100 

                 Eth = 8.944  -26.6° V or 8 - j 4 V

     To find Zth, we replace the source with a short and then look back in from the
     cut points. The equivalent circuit is shown in Figure 5.31. The inductor is in
     series with the parallel combination of the resistor and capacitor.

                                                                                                             Figure 5.31
                                                                                                             Circuit for finding Zth for
                                                                                                             Example 5.6.

                 Zleft2 = R× jX C
                           R - jX C

                 Zleft2 = 100 ×(- j 200 ) 100  - j 200 
                 Zleft2 = 89.44  - 26.6 ° 

                 Zth = Z left2 + X L
                 Zth = 89.44  -26.6 °  + j 50
                 Zth = 80.62  7.12 °  or 80 +j 10 

     The completed equivalent is shown in Figure 5.32.

                                                         Figure 5.32
                                                         Completed equivalent for
                                                         Example 5.6.

164
         The voltage across the 300  resistor can be found directly:
                     v R2 = Eth R2
                                 Z th + R2
                     v R2 = 8 - j 4 V 300 80+ j 10  + 300 
                     v R2 = 7.06  -28.1 ° V

         This value can be verified by following a standard series-parallel
         simplification. For example, the impedance of the three rightmost
         components (181.4-53.97° ) forms a voltage divider with the 100 
         resistor and the 10 volt source. This leads to vb (7.156-18.61° volts ). A
         second divider can then be used between vb, the inductor and the 300 
         resistor to find vc, which is 7.06-28.1° volts as expected. The big
         advantage of using the Thévenin equivalent is that we can easily find vc for
         any other value of load because we need only analyze the simpler equivalent
         circuit rather than the original.

Thévenin's theorem can also be used on multi-source circuits. The technique for
finding Zth does not change, however, finding Eth is a little more involved, as
illustrated in the next example.
Example 5.7

         Find vb for the circuit of Figure 5.33 using Thévenin's theorem.

                                                                                                                   Figure 5.33
                                                                                                                   Circuit for Example 5.7.

         This circuit is similar to the one used in Example 5.5 (Figure 5.18). The
         difference here is that the second source uses the same frequency as the first
         source. The reactance values are:

                   XL = j314.2 
                   XC = -j212.2 

165
         The voltage across the 2 k is vb, so we'll treat that resistor as the load in
         order to define the equivalent circuit. This is redrawn in Figure 5.34.

                                                                                                                   Figure 5.34
                                                                                                                   Circuit for finding equivalents
                                                                                                                   for Figure 5.33.

         To find Zth, we short the two sources. We're left with the inductor and
         capacitor in parallel. If this is confusing, remember that we are looking from
         node b to ground (the cut points), so they are not in series. That is, if a
         sensing current entered at node b, it could split left and right, indicating
         parallel paths, not a series connection.

                      Z th = - jX C× jX L
                             - jX C +jX L

                      Zth = - j 212.2× j 314.2  - j 212.2  + j 314.2 
                      Zth = - j 653.7

         We have a few options to find Eth. Superposition could be used, each circuit
         requiring a voltage divider. Alternately, the equivalent is basically a series
         loop as far as finding vb is concerned. Thus, we could find the voltage across
         the inductor and subtract that from the left source (assuming a reference
         current direction of clockwise). Finding the inductor voltage requires either
         a voltage divider or finding the current. Neither approach is considerably
         less work than the other, and it's probably a good idea to get in a little more
         practice using superposition, so...

         Considering the left source, we short the right source and find vb.

                      vbR = E1 X C
                                 XC +X L

                      v bR = 10  0 ° V - j 212.2 - j 212.2 +j 314.2 

                      vbR = 20.84 180 ° V or -20.84  0 ° V

         For the right source, we short the left source and find vb. Then we add the
         two contributions to find the final voltage. Note that both sources will
         produce a reference polarity of + to - from top to bottom.

166
                     vbL = E2 X C
                                 XC +X L

                     vbL = 2  0 ° V j 314.2 - j 212.2  +j 314.2 
                     vbL = 6.16  0 ° V
         The sum of the two is -20.840° + 6.160°, or 14.68180° volts. The
         Thévenin equivalent is a source of 14.68180° volts in series with an
         impedance of -j653.7 .
         To find the voltage across the 2 k  resistor, we apply it to the equivalent
         circuit and solve.
                     vb = Eth R

                                R + Z th
                     vb = 14.68 180 ° V 2 k  2 k  +(- j 653.7)
                     vb = 13.95 -161.9° V

Computer Simulation

To verify the results of the preceding example, the circuit of Figure 5.33 is captured
in a simulator, as shown in Figure 5.35.

                                                                                                                   Figure 5.35
                                                                                                                   The circuit of Figure 5.33
                                                                                                                   captured in a simulator.

Next, a transient analysis is run, plotting the voltage at node 2, which corresponds to
vb in the original circuit. The result is shown in Figure 5.36. The plot is delayed by
0.1 seconds in order to get past the initial turn-on transient.

167
                                                                                                                   Figure 5.36
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 5.33.

Both the amplitude and phase of the simulation waveform match the computed
results.

Norton's Theorem

Norton's theorem is named after Edward Lawry Norton. It is the current source
version of Thévenin's theorem. In other words, complex networks can be reduced to
a single current source with a parallel internal impedance. Formally, Norton's
theorem states:

         Any single port linear network can be reduced to a simple voltage source,
         In, in parallel with an internal impedance Zn.
The process of finding a Norton equivalent is very similar to finding a Thévenin
equivalent. First, the Norton impedance is the same as the Thévenin impedance.
Second, instead of finding the open circuit output voltage, the short circuit output
current is found. This is the Norton current. Due to the equivalence afforded by
source conversions, if a Thévenin equivalent for a network can be created, then it
must be possible to create a Norton equivalent. Indeed, if a Thévenin equivalent is
found, a source conversion can be performed on it to yield the Norton equivalent.

168
Example 5.8

         Let's reexamine Example 5.6, this time creating a Norton equivalent circuit.
         For convenience, the original circuit of Figure 5.29 is repeated in Figure
         5.37. Once again, the goal will be to determine the equivalent that drives the
         300  resistor and to find vc.

                                                                                                                   Figure 5.37
                                                                                                                   Circuit for Example 5.8.

         As noted, the Norton impedance, Zn, is the same as Zth. That was 80 + j10 .
         The Norton current, In, is the short-circuit current through the cut points. We
         can think of this as replacing the load resistor with an ammeter. This is the
         same as the current through the inductor. In this situation, the capacitor and
         inductor are in parallel and yield an impedance of j66.67 . Thus, the source
         current is:

                     isource = E
                                R +Z LC

                     i source = 10  0 ° 100 +j 66.67
                     isource = 83.2E-3  -33.7 ° A

         This splits between the capacitor and inductor. Using the current divider rule
         we find:

                     in = iinductor = I source X C
                                              X C +X L

                     in = 83.2  - 33.7 ° A - j 200 - j 200  +j 50
                     in = 0.1109  -33.7 ° A

         A source conversion can be applied to verify this value. The resulting
         voltage source is 8 - j4 volts, precisely the value of the Thévenin equivalent.

Ultimately, deciding between using the Thévenin or Norton equivalents is a matter
of personal taste and convenience. They work equally well.

169
5.5 Maximum Power Transfer Theorem

The concept of maximum power transfer in DC resistive circuits was presented in         Figure 5.38
earlier work. While maximizing load power is not a goal of all circuit designs, it is   Defining maximum power
a goal of a portion of them and thus worth a closer look. In short, given an AC         transfer.
voltage source with internal impedance, as seen in Figure 5.38, a useful question to
ask is "What value of load impedance will yield the maximum amount of power in
the load?" In the DC case, it was discovered that the load resistance must equal the
source resistance in order to achieve maximum load power. In the AC case things
appear to be much more complicated by the possible presence of reactances in both
the source and load.

As a refresher of prior study, consider the basic circuit depicted in Figure 5.38 with
source E, source internal resistance Zi and load impedance Z. For the moment, we
shall ignore the reactive portions and just describe the load power in terms of the
load's resistive portion, R. To make the job easier, we may normalize the source
resistance Ri to 1 . By doing this, R also becomes a normalized value, that is, it no
longer represents a simple resistance value but rather represents a ratio in
comparison to Ri. In this way the analysis will work for any set of source values.
Note that the value of E will equally scale the power in both Ri and R, so a precise
value is not needed, and thus, we may as well chose 1 volt for convenience.

The power in the load can be determined by using I2R where I = E / (Ri+R), yielding

     ( ) P = E 2 R
            Ri+R

Using our normalized values of 1 volt and 1 ,

              12

     P =(1+R ) R

After expanding we arrive at:

     P= 2 R                                    (5.1)
     R +2 R+1

We now have an equation that describes the load power in terms of the load
resistance. Before we go any further, take a look at what this equation tells you, in
general. It is obvious that maximum power will not occur at the extremes. If R = 0 or
R =  (i.e., shorted or opened load) the load power is zero. The maximizing case
occurs somewhere in the middle. To find the precise value that produces the
maximum load power, the proof can be divided into two portions. The first involves
graphing the function and the second requires differential calculus to solve for a

170
precise value. We shall proceed with the graphing portion which will lead us to the
answer. The more rigorous proof of the second portion is detailed in Appendix C.

The curve of Equation 5.1 is plotted in Figure 5.39. The normalized load resistance
is set along the horizontal and the normalized power (i.e., for a source of 1 volt) is
set along the vertical.

                                     R/(R2+2R+1)

                       0.30

                       0.25                                                             Figure 5.39

                                                                                        The resistive portion of the

Normalized Load Power                                                                   power equation plotted.

                       0.20

                       0.15

                       0.10

                       0.05

                       0.00  0.5
                       0          1  1.5                      2  2.5

                                  Normalized Load Resistance

An examination of the power curve shows that the peak occurs at R = 1. In other
words, the load must be equal to the source resistance. Thus, we can say that if no
reactances are involved, maximum load power occurs when the load resistance
equals the source resistance. It does not matter if the source is DC or AC.

The graph shown in Figure 5.39 is asymmetric but the concept of resistance ratios is
key here. This is easier to see if we plot the completed power curve using a
logarithmic horizontal axis and also scale the vertical axis to 100%, as shown in
Figure 5.40. The peak is more apparent and the curve is symmetrical in shape rather
than lopsided. This reinforces the idea that the ratio of the resistances is what
matters.

171
Load Power as a Percentage of Maximum                                                           R/(R2+2R +1)                  Figure 5.40
                                       100                                                                                    The load power curve with
                                                                                                                              logarithmic axis showing
                                        80                                                                                    symmetry.

                                        60

                                       40

                                       20

                                       0                         1                                            10         100
                                       0.01        0.1

                                                                 Normalized Load Resistance

At this point we may turn our attention to the possible presence of reactances in both
the source and load. It turns out that this is not nearly as complicated as it might
look. The key is that only resistors dissipate power, not inductors or capacitors6.
Load power is proportional to iload2, so our immediate goal is to maximize load
current for any set of source and load resistances.

We can modify the original power equation by adding a new term, X, which
represents the net reactance in the circuit. In other words, X is equal to the sum of
the reactances in the source impedance and load impedance. The power in the load is
still determined by using I2R, however, we must now include the X term when
computing the current:

                                             I= E
                                                 (( Ri +R) +X )22

This leads is to a new load power expression:

                                             P=  ( ) E 2                                                          (5.2)
                                                      2 2R
                                                 (( Ri+R) +X )

A cursory look at Equation 5.2 shows that to maximize P, X must be zero. A
normalized plot of this equation is shown in Figure 5.41 for R = Ri.

6 Power in AC circuits is examined in great detail in Chapter 7.
172
                                       100

                                                                                        Figure 5.41

Load Power as a Percentage of Maximum  80                                               The reactive portion of the

                                                                                        power equation plotted using

                                                                                        matched resistance.

                                       60

                                       40

                                       20

                                       0    -5  0                           5  10
                                       -10

                                                Normalized Total Reactance

A single peak is evident when X is 0. This can be achieved by setting the load          Figure 5.42
reactance equal in magnitude to the source reactance but with the opposite sign. In     The load power surface
this manner, the reactances will cancel out, leaving a purely resistive circuit with a  showing variations with both
minimal value, and thus producing maximal current for that set of resistors.            load resistance and total
                                                                                        reactance.

173
Two variables are involved here, so to further clarify the situation, a 3D surface plot  Figure 5.43
of normalized power is shown in Figure 5.42. The vertical axis represents the            An alternate view of the load
percentage of maximum power while the front and side axes are the normalized total       power surface.
reactance and load resistance, respectively. A single peak is evident here and
coincides with X = 0 and R = 1. This is more easily seen by viewing the surface
from the back as shown in Figure 5.43. Note that the highest isocontour encircles
the intersection of X = 0 and R = 1 (i.e., Rload = Ri ).

In sum, we have verified that the resistive portions of the source and load impedance
must be identical and that the reactive portions must be of the same magnitude but of
opposite sign. This configuration is also known as the complex conjugate. Finally,
we can state:

         Maximum load power will be achieved when the load impedance is equal to
         the complex conjugate of the internal impedance of the driving source.

No other value of load impedance will produce a higher load power. We can imagine
two general cases, one with an inductive source impedance and another with a
capacitive source impedance. These are shown with the proper loads in Figure 5.44.

174
                                                                                                                   Figure 5.44
                                                                                                                   Configurations for complex
                                                                                                                   conjugate loads.

To achieve maximum load power in these circuits, Rload = Ri and |jXL| = |-jXC|. Note
that XL and XC do not have to have the same magnitude as Ri.
While using the complex conjugate produces the maximum load power, it does not
produce the largest possible load current or load voltage. In fact, this condition
produces a load voltage and a load current that are half of their maximums. Their
product, however, is at the maximum. Further, efficiency at maximum load power is
only 50% (i.e., only half of all generated power goes to the load with the other half
being wasted internally). Values of R greater than Ri will achieve higher efficiency
but at reduced load power. Sometimes we favor efficiency over maximal load power.
As any linear single port network can be reduced to something like Figure 5.44 by
using Thévenin's theorem, combining the two theorems allows us to determine
maximum power conditions for any impedance in a complex circuit.
Example 5.9

         Consider the circuit of Figure 5.45. What is the power generated in the load
         if it is equal to 40 ? Further, is that the maximum power that can be
         attained, and if not, what is the maximum load power and what value of load
         would be needed?

                                                                                                                   Figure 5.45
                                                                                                                   Circuit for Example 5.9.

         To find the load power, first find the circulating current, then use power law.
         The total impedance seen by the source is 20 + j10  + 40 , or 60 + j10 .

175
                     i= E
                           Z total

                     i = 70V 60 +j 10
                     i = 1.151  -9.5 ° A

         As the voltage and current are in phase for a resistor, we can ignore the
         angle for the power calculation.

                      Pload = i2× Rload
                      Pload = (1.151 A )2×40 
                      Pload 53 W

         This is not the maximum load power that can be achieved because this load
         is not the complex conjugate of the source impedance. The required load for
         maximum load power is shown in Figure 5.46.

                                                                                                                   Figure 5.46
                                                                                                                   Circuit of Figure 5.45 with
                                                                                                                   proper load configuration.

         We shall repeat the process to find the new load power.

                     i= E
                           Z total

                     i = 70 V 40
                     i = 1.75  0° A

                      P load = i2× Rload

                                                                    2

                      Pload = (1.75 A ) ×20 
                      Pload = 61.25 W

         An alternate method notes that the new circuit's total impedance is purely
         resistive and that the source and load resistances are identical. Therefore the
         voltage source must split evenly across them. In this case that's 35 volts
         RMS each.

176
                                v R2
                      Pload =

                                R load
                               (35 V)2
                      Pload =

                                 20 
                      Pload = 61.25 W

Example 5.10

         For the circuit of Figure 5.47, determine the value of Zload that will achieve
         maximum load power and also determine that power. The current source is
         0.10° amps RMS at 50 kHz.

                                                                                                                   Figure 5.47
                                                                                                                   Circuit for Example 5.10.

         The first job is determine the inductive reactance at 50 kHz. Recalling that
         XL = j2fL, this works out to j157 . We now need to find the Thévenin
         equivalent. To find Zth we open the current source and look back in from the
         load. We see the 50  resistor in series with the parallel combination of the
         200  resistor and the inductor. The parallel combination is:

                      Z = R × jX L
                            R +jX L

                      Z = 200 ×( j 157 )
                             200 +j 157

                      Z = 76.3+j 97.2

         Therefore, Zth = 126.3 + j97.2 . The complex conjugate is 126.3 - j97.2 .
         The capacitive reactance formula may be used to determine the appropriate
         capacitance value to achieve -j97.2 .

                     C= 1
                            2 f XC

                     C = 1 2  50 kHz 97.2
                     C = 32.8 nF

177
The resulting circuit is shown in Figure 5.48.

                                                                                         Figure 5.48
                                                                                         Thévenin equivalent of the
                                                                                         circuit of Figure 5.47 with
                                                                                         appropriate load.

         To find the load power we need to find Eth. The open circuit output voltage is
         the potential appearing across the inductor/resistor pair in Figure 5.47. This
         is because there is no current flowing through the 50  resistor, and
         therefore there is no voltage across it. Eth can be found via Ohm's law as we
         already know the impedance of the parallel branch.

                      Eth = i×Z
                      Eth = 0.1  0 ° A×(76.3+ j 97.2)
                      Eth = 12.4  51.9° V

         Again, using the complex conjugate, the voltage source splits evenly
         between the resistive components. As the current source was specified as
         RMS, so too will be the equivalent voltage.

                                 v R2
                       Pload =

                                 Rload

                                                                    2

                                (6.2 V )
                      Pload = 126.3
                      Pload = 304.4 mW

         This represents the maximum load power that can be achieved in this circuit.
         Do not forgot, though, that an equal amount of power is dissipated by the
         source. This produces an efficiency of just 50%.

In summation, we can say that maximum load power is achieved when the load
impedance is equal to the complex conjugate of the internal impedance of the
circuitry driving the load. Usually, this requires the application of either a Thévenin
or Norton equivalent. Finally, although maximum power transfer is a desired
outcome in some situations, it is not desirable in all situations. The reason is one of
efficiency. At the maximum load power, efficiency is only 50%. In contrast, for load
impedances that are greater than the source impedance, the load power will
decrease, however, the efficiency will increase. Increased efficiency is particularly
important when striving to minimize heat and extend battery life.

178
5.6 Delta-Y (Pi-T) Conversions

Certain component configurations, such as bridged networks, cannot be reduced to a
single impedance using basic series-parallel conversion techniques. One method for
simplification involves converting sections into more convenient forms. The
configurations in question are networks with three external connection points. Due
to the manner in which they drawn, they are referred to as delta networks and Y
networks7. These configurations are shown in Figure 5.49. Note that the terminal
designation of the delta version are upside down compared to those of the Y
configuration.

                                                                                                                   Figure 5.49
                                                                                                                   Delta and Y (-Y) networks.

These networks can be redrawn without angles. In this form they are known as pi
(also called "") networks and T (also called "tee") networks. These configurations
are shown in Figure 5.50.

                                                                                                                   Figure 5.50
                                                                                                                   Alternate form: Pi and T
                                                                                                                   (-T) networks.

It is possible to convert back and forth between delta and Y networks in many cases.
That is, for a given delta network, there may exist a Y network such that the
impedances seen between the X, Y and Z terminals are identical, and vice versa.
Consequently, one configuration can replace another in order to simplify a larger
circuit. Unlike the DC version, certain AC networks cannot be converted using the
following technique (see the final Challenge problem for an investigation of this).

7 In some sources the capital Greek letter delta () is used instead of spelling out "delta"
    and the letter Y is spelled out as "wye". Thus, you may come across discussion of "-Y ",
    "-wye" or "delta-wye" networks. It's all the same stuff.

179
-Y Conversion

A true equivalent circuit would present the same impedance between any two
terminals as the original circuit. Consider the circuits of Figure 5.49 for the unloaded
case (i.e., just these networks with nothing else connected to them). The equivalent
impedances seen between each pair of terminals for the delta and the Y respectively
are:

     ZXY = Za || (Zb+Zc) = Zd + Ze                       (5.3)
     ZXZ = Zb || (Za+Zc) = Zd + Zf                       (5.4)
     ZZY = Zc || (Zb+Za) = Ze + Zf                       (5.5)

Let's assume that we have the delta network and are looking for the Y network
equivalent. We start by focusing on the final set of terms for each of the three
expressions (e.g., ZXY = Zd + Ze). Note that we have three equations with three
unknowns (Zd, Ze and Zf). Thus, they can be solved using a term elimination process.
If we subtract Equation 5.5 from Equation 5.3, we can eliminate the second
impedance (Ze) and arrive at a difference between the first and third unknown
impedance s (Zd - Zf). This quantity can then be added to Equation 5.4 to eliminate
the third impedance (Zf), leaving just the first unknown impedance (Zd).

     (Zd + Ze) - (Ze + Zf) = (Zd - Zf) = Za || (Zb+Zc) - Zb || (Za+Zc)
     (Zd + Zf) + (Zd - Zf) = 2Zd = 2( Zb || (Za+Zc) + Za || (Zb+Zc) - Zc || (Za+Zb) )

Therefore,

     Zd = Zb || (Za+Zc) + Za || (Zb+Zc) - Zc || (Za+Zb)

which, after simplifying8, is:

     Zd = Za Zb                                          (5.6)
            Z a+Z b+Zc

Similarly, we can show that

     Ze = Za Zc                                          (5.7)
            Z a+Z b+Z c                                  (5.8)

     Z f = ZbZc
            Z a+Z b+Z c

Note that if the magnitudes and angles of three original impedances are identical, the
magnitudes of the Y equivalent impedances will all be one-third of the original
magnitude, and with the original phase angle.

8 This process, though not particularly difficult, is somewhat tedious. It is, as they say, "left
    as an exercise for the student".

180
Y- Conversion

For the reverse process of converting from Y to delta, start by noting the similarities
of the expressions for Zd, Ze and Zf (i.e., Equations 5.6 through 5.8). If two of these
expressions are divided, a single equation for Za, Zb or Zc will result. For example,
using Equations 5.6 and 5.7:

     Zd =         ZaZb
     Ze        Z a +Zb +Z c

                  ZaZc
               Z a +Zb +Z c

            Zd = Za Zb
            Ze Za Z c
            Zd = Zb
            Ze Zc

Therefore,

     Zb = Zd
     Zc Ze
     Zb = Zc Zd

              Ze

This process can be repeated for Equations 5.6 and 5.8 to obtain an expression for
Za. The two expressions for Za and Zb can then be substituted into Equation 5.6 to
obtain an expression for Zc that utilizes only Zd, Ze and Zf. A similar process is
followed for Za and Zb resulting in:

     Za = Z d Z e+Z e Z f +Z d Z f  (5.9)
                      Zf            (5.10)
                                    (5.11)
     Zb = Z d Ze+Z e Z f +Z d Z f
                      Ze

     Zc = Z d Z e+Z e Z f +Z d Z f
                      Zd

If the Y network consists of three identical impedances, then the values of the delta
equivalent will all be three times the original magnitude, the inverse of the situation
when converting from delta to Y.

In summation, equations 5.6, 5.7 and 5.8 can be used to convert a delta network into
a Y network, and equations 5.9, 5.10 and 5.11 can be used to convert a Y network
into a delta network. Examples of how to apply this technique to tame up-to-now
intractable series-parallel networks follow.

181
Example 5.11
         Convert the network of Figure 5.51 into its delta configuration equivalent.

                                                                                                                   Figure 5.51
                                                                                                                   Network for Example 5.11.

         Referring back to Figure 5.50, use Equation 5.9 to determine Za.
            Za = Z d Z e+Z e Z f +Z d Z f
                             Zf
            Za = (50 + j 20 )(10)+(10)(40 - j 30)+(50 + j 20 )(40  - j 30) (40 - j 30)
            Za = 65.6 + j 29.2

         Zb and Zc may be determined in similar manner using Equations 5.10 and
         5.11:

                   Zb = 350 - j80 
                   Zc = 54.8 - j37.9 
         The equivalent is shown in Figure 5.52.

                                                                                                                   Figure 5.52
                                                                                                                   Equivalent delta network for
                                                                                                                   the Y network of Figure 5.51.

182
Remember, a complex impedance can always be expressed in rectangular form.
Rectangular form can be expressed directly as a series combination of a resistor and
either an inductive or capacitive reactance. Even if the original impedances of a
network are in a parallel form (or even a more complex form), the equivalent can be
expressed as a series combination.
Example 5.12

         Determine va in the circuit of Figure 5.53. Assume the source has a phase
         angle of zero degrees.

                                                                                                                   Figure 5.53
                                                                                                                   Circuit for Example 5.12.

         This circuit cannot be simplified sufficiently using basic series-parallel
         techniques due to the bridge section. The components between and below
         nodes a and b comprise a delta network, as shown in Figure 5.54. If this
         network is replaced with a Y equivalent, the resulting circuit reduces to a
         simple series-parallel system.

                                                                                                                   Figure 5.54
                                                                                                                   Delta network within the
                                                                                                                   circuit of Figure 5.53.

         Before continuing, it would be helpful to determine the impedance of each
         of the parallel sections. For the leftmost pair:

                      Zleft2 = R× jX L
                                R + jX L

                      Z left2 = 10× j 100  10 + j 100
                      Zleft2 = 9.9 + j 0.99 

183
         In similar manner, the top pair is determined to be 19.8 + j1.98  and the
         rightmost pair is 29.7 + j2.97 . Referring back to Figure 5.50, we can use
         Equation 5.6 to determine Zd.

            Zd = Za Zb
                   Za+Z b+Z c

            Zd = (19.8 + j 1.98)×(9.9+ j 0.99) (19.8 + j 1.98 )+(9.9+ j 0.99 )+(29.7+ j 2.97 )
            Zd = 3.3 + j 0.33 
         Likewise, we can use Equations 5.7 and 5.8 to determine Ze and Zf.

                   Ze = 9.9  + j0.99 
                   Zf = 4.95  + j0.495 
         Swapping the equivalent Y network into the original circuit leads us to the
         circuit of Figure 5.55 (Y network shown in blue). This circuit can be
         simplified directly to find va.

                                                                                                                   Figure 5.55
                                                                                                                   Equivalent circuit for the
                                                                                                                   circuit of Figure 5.53.

         In this equivalent circuit, va is simply the source voltage of 10° minus the
         voltage across the 2  resistor. The immediate goal, then, is to find the
         current through that resistor. This can be achieved via a current divider once
         the source current is known. To find the source current, we need to find the
         total impedance of the network. On the upper left side, Zd is in series with
         the 2  resistor for a total of 5.3  + j0.33 . This is in parallel with the
         upper right side total of 15.9  + j0.99 .

184
Zupper = Z upperleft× Z upperright
          Z upperleft + Z upperright

Zupper = (5.3  + j 0.33)×(15.9 + j 0.99) (5.3 + j 0.33 ) +(15.9 + j 0.99 )
Zupper = 3.975  + j 0.2475 

This is in series with the lower section of 4.95 + j0.495  for a total of
8.9564.76° . Using Ohm's law, we find the source current:

isource = E
          Z total

isource = 1  0 ° V 8.956  4.76 ° 
isource = 0.1117  -4.76 ° A

Now for the current divider and also Ohm's law for the 2  resistor.

i2 = isource  Z upperright

              Zupperright +Z upperleft

i2 = 0.1117  -4.76° A 15.9+j 0.99 (15.9+j 0.99)+(5.3+j 0.33 )

i2 = 83.7E-3 -4.76 ° A

v 2 = i2× R
v 2 = 83.7E-3 -4.76 ° A×2
v 2 = 0.1675  -4.76 ° V

Finally, we subtract that potential from the source to find va.

va = E -v 2
v a = 1  0 ° V -0.1675  -4.76° V
v a = 0.833  0.95° V

5.7 Summary

In this chapter we have examined several techniques and theorems to assist with the
analysis of AC electrical circuits. We began with more practical models for voltage
and current sources by adding an internal impedance to set limits on the source's
maximum output and make it sensitive to output frequency. For a voltage source,
this impedance is in series, its ideal value being a short, just as it was for the DC
case. For current sources, the impedance is in parallel, its ideal value being an open.

185
Source conversions allow us to create an equivalent voltage source for any practical
current source and vice versa. An equivalent source is one that will create the same
voltage across (and current into) the remaining circuit as did the original source. In
some cases, this swap allows multiple sources to be combined into a single source,
simplifying analysis. If the associated impedance does not have a zero degree phase
angle, then the converted source will not be in phase with the original, but will
instead be shifted by the impedance angle.

The superposition theorem states that, for any multi-source linear bilateral network,
the contributions of each source may be determined independent of all other sources,
the final result being the summation of the contributions. This remains true in the AC
case, however, care must be taken regarding phase shifts when combining the
various contributions. The original circuit of N sources generates N new circuits, one
for each source under consideration and with all other sources replaced by their ideal
internal impedance.

Thévenin's and Norton's theorems allow the simplification of complex linear single
port (i.e., two connecting points) networks. The AC Thévenin equivalent consists of
a voltage source with a series impedance while the AC Norton equivalent consists of
a current source with a parallel impedance. These impedances can be represented in
general as a resistance in series with a reactance, and given an operating frequency,
the reactance can be turned into a capacitance or inductance. These equivalents,
when replacing the original sub-circuit, will create the same voltage across the
remainder of the circuit with the same current draw. In other words, the remainder of
the circuit will see no difference between being driven by the original sub-circuit or
by either the Thévenin or Norton equivalents.

The maximum power transfer theorem states that for a simple voltage source with an
internal impedance driving a simple load, the maximum load power will be achieved
when the load impedance equals the complex conjugate of the internal impedance.
The complex conjugate has the same real or resistive value, however, the reactive
portion is of the opposite sign. This results in a cancellation of the reactive
components, leaving just the resistive portions and maximizing load current. At this
point, efficiency will be 50%. If the load impedance is higher than the internal
impedance, the load power will not be as great, however, the system efficiency may
improve, depending on the phase angle.

Delta-Y conversions allow the generation of equivalent "three connection point"
impedance networks. RLC networks with three elements in the shape of a triangle or
delta (with one connection point at each corner) may be converted into a three
element network in the shape of a Y or T, or vice versa. The two versions will
behave identically to the remainder of the circuit. This allows the simplification of
some circuits and eases analysis.

186
Review Questions

    1. What are the ideal internal impedances of AC voltage and current sources?
    2. Outline the process of converting an AC voltage source into an AC current

         source, and vice versa.
    3. In general, describe the process of using superposition to analyze a multi-

         source circuit.
    4. What do Thévenin's and Norton's theorems state? How are they related?
    5. What are the conditions to achieve maximum power transfer for AC circuits?

         How does this differ from the DC version?
    6. What are delta and Y configurations? How are they related?

5.8 Exercises

Analysis

    1. For the circuit shown in Figure 5.56, use superposition to find vb.
                                                                                Figure 5.56

    2. For the circuit shown in Figure 5.56, use superposition to find the current
         through the capacitor.

    3. Use superposition to find the current through the 82  resistor. For the
         circuit shown in Figure 5.57.
                                                                                Figure 5.57

    4. Use superposition to find vb and vcd for the circuit shown in Figure 5.57.

187
    5. In the circuit of Figure 5.58, use superposition to find vb. Source one is one
         volt peak and source two is two volts peak.
                                                                                Figure 5.58

    6. In the circuit of Figure 5.58, use superposition to find the currents through
         the two inductors. Source one is two volts peak and source two is three volts
         peak.
                                                                                Figure 5.59

    7. Use superposition to find the current through the 2.2 k resistor for the
         circuit of Figure 5.59. E1 = 10° and E2 = 1090°.

    8. Use superposition to find vab for In the circuit of Figure 5.59. E1 = 10° and
         E2 = 245°.

    9. In the circuit of Figure 5.60, use superposition to find vb and vcd. The sources
         are in phase.
                                                                                Figure 5.60

188
    10. In the circuit of Figure 5.60, use superposition to find the current through
         the capacitor. The sources are in phase.

    11. Use superposition to find the two source currents for In the circuit of
         Figure 5.61. Source one is 100 mV peak and source two is 500 mV peak (in
         phase).
                                                                                Figure 5.61

    12. Use superposition to find vcd for the circuit of Figure 5.61. Source one is
         100 mV peak and source two is 1 V peak (in phase).

    13. In the circuit of Figure 5.62, use superposition to find vab.
                                                                                Figure 5.62

    14. In the circuit of Figure 5.62, use superposition to find the current through
         the 15 k resistor.

    15. In the circuit of Figure 5.63, use superposition to find vab.
                                                                                Figure 5.63

189
    16. In the circuit of Figure 5.63, use superposition to find the current flowing
         through the resistor.

    17. For the circuit of Figure 5.64, use superposition to find va and vb. The
         sources are in phase.
                                                                                Figure 5.64

    18. For the circuit of Figure 5.64, use superposition to find the currents through
         the inductor and capacitor. The sources are in phase.

    19. Use superposition in the circuit of Figure 5.65 to find the currents through
         the inductor and capacitor. I1 = 145° and I2 = 245°.
                                                                                Figure 5.65

    20. Use superposition in the circuit of Figure 5.65 to find vab and vbc. I1 = 10°
         and I2 = 290°.

    21. In the circuit of Figure 5.66, Use superposition to find vbc. I1 = 100° and
         I2 = 60°.
                                                                                Figure 5.66

    22. In the circuit of Figure 5.66, Use superposition to find the current flowing
         through the 2  resistor. I1 = 4120° and I2 = 60°.

190
    23. Use superposition to determine the current of source E in the circuit of
         Figure 5.67. E = 40180° and I = 20E-30°.
                                                                                Figure 5.67

    24. Use superposition to determine vac in the circuit of Figure 5.67. E = 280°
         and I = 8E-3-180°.

    25. Use superposition to determine vb in the circuit of Figure 5.68. I = 3E-30°
         and E = 90°.
                                                                                Figure 5.68

    26. Use superposition to determine the inductor current in the circuit of
         Figure 5.68. I = 4E-30° and E = 18-45°.

    27. For the circuit of Figure 5.69, use superposition to determine the inductor
         current. I = 100E-30° and E = 260°.
                                                                                Figure 5.69

    28. For the circuit of Figure 5.69, use superposition to determine vab.
         I = 50E-30° and E = 1890°.

191
    29. Use superposition to determine vab in the circuit of Figure 5.70.
         I = 10E-30° and E = 120°.
                                                                                Figure 5.70

    30. Use superposition to determine the capacitor current in the circuit of
         Figure 5.70. I = 5E-30° and E = 18120°.

    31. For the circuit of Figure 5.71, determine the Thévenin equivalent that drives
         the 20 nF capacitor.
                                                                                Figure 5.71

    32. Given the circuit of Figure 5.71, determine the Norton equivalent that drives
         the 20 nF capacitor.

    33. For the circuit of Figure 5.72, determine the Thévenin and Norton
         equivalents that drive the 600  resistor if the source E = 120°.
                                                                                Figure 5.72

    34. Given the circuit of Figure 5.72, determine the Thévenin equivalent that
         drives the j1 k inductive reactance if E = 90°.

    35. Given the circuit of Figure 5.72, determine the Norton equivalent that drives
         the j2.5 k inductive reactance if E = 2445°.

192
    36. Use Thévenin's theorem to find vb in the circuit of Figure 5.72 if
         E = 180°.

    37. Use Thévenin's theorem to find vb in the circuit of Figure 5.73.
                                                                                Figure 5.73

    38. Determine the Thévenin equivalent that drives the 3.9 k + j1 k combo in
         the circuit of Figure 5.73. Does this combo's impedance achieve maximum
         load power? If not, what combo will achieve maximum power and what is
         the resulting power?

    39. Determine the Norton equivalent that drives the 500  resistor in the circuit
         of Figure 5.73. Determine the value of component(s) that when placed in
         series with the 500  resistor will achieve maximum load power (i.e., for
         the combo as the load).

    40. For the circuit of Figure 5.74, determine the Thévenin and Norton
         equivalents that drive the combo of 36  + j100 . Does this combo achieve
         maximum load power? If not, what combo will achieve maximum power
         and what is the resulting power?
                                                                                Figure 5.74

193
    41. For the circuit of Figure 5.75, determine the Thévenin and Norton
         equivalents that drive the combo of 300  in parallel with -j1500 . Does
         this combo achieve maximum load power? If not, what combo will achieve
         maximum power and what is the resulting power? E = 1200°.
                                                                                Figure 5.75

    42. For the circuit of Figure 5.76, determine the Thévenin and Norton
         equivalents that drive the combo of 4.7 k in parallel with j300 . Does this
         combo achieve maximum load power? If not, what combo will achieve
         maximum power and what is the resulting power? I = 200E-30°.
                                                                                Figure 5.76

    43. Determine the equivalent Y (T) network for the circuit of Figure 5.77.
         R1 = R2 = R3 = 10 k and XL1 = XL2 = XL3 = j10 k.
                                                                                Figure 5.77

194
    44. Determine the equivalent Y (T) network for the circuit of Figure 5.78.
                                                                                Figure 5.78

    45. Determine the equivalent Y (T) network for the circuit of Figure 5.79.
         R1 = R2 = R3 = 4 k and XC1 = XC2 = XC3 = -j3 k.
                                                                                Figure 5.79

    46. Determine the equivalent Y (T) network for the circuit of Figure 5.80.
                                                                                Figure 5.80

    47. Determine the equivalent delta (pi) network for the circuit of Figure 5.81.
                                                                                Figure 5.81

195
    48. Determine the equivalent delta (pi) network for the circuit of Figure 5.82.
                                                                                Figure 5.82

    49. Determine the equivalent delta (pi) network for the circuit of Figure 5.83.
                                                                                Figure 5.83

    50. Determine the equivalent delta (pi) network for the circuit of Figure 5.84.
                                                                                Figure 5.84

196
    51. Find voltage vbc in the circuit of Figure 5.85 through the use of one or more
         delta-Y conversions. E = 100°, R1 = 1 k, R2 = 2 k, R3 = 3 k,
         XC = -j4 k and XL = j8 k.
                                                                                Figure 5.85

    52. Find voltage vbc in the circuit of Figure 5.86 through the use of one or more
         delta-Y conversions. E = 200°, R1 = 1 k, R2 = 8 k, R3 = 3 k,
         XC = -j4 k and XL = j2 k.
                                                                                Figure 5.86

Design

    53. Design an equivalent current source for Figure 5.87. E = 1290°, R = 1 k
         and XC = - j200 . The source frequency is 10 kHz.
                                                                                Figure 5. 87

197
    54. Design an equivalent current source for Figure 5.87 if E = 100°,
         R = 2.2 k and C = 100 nF. The source frequency is 1 kHz.

    55. Design an equivalent current source for Figure 5.88 if E = 10°, R = 600 
         and L = 2 mH. The source frequency is 20 kHz.
                                                                                Figure 5.88

    56. Design an equivalent current source for Figure 5.88. E = 290°, R = 10 k
         and XL = j900 .

    57. Design an equivalent voltage source for Figure 5.89. I = 300E-30°,
         R = 4.3 k and XC = -j5 k.
                                                                                Figure 5.89

    58. Design an equivalent voltage source for Figure 5.89 if I = 100E-3120°,
         R = 75  and L = 1 mH. The source frequency is 10 kHz.

    59. Design an equivalent voltage source for Figure 5.90 if I = 10E-30°,
         R = 9.1 k and L = 5 mH. The source frequency is 100 kHz.
                                                                                Figure 5.90

    60. Design an equivalent voltage source for Figure 5.90 if I = 50E-30°,
         R = 560  and XL = j350 .

198
    61. Reconfigure the circuit of Figure 5.91 so that it uses only voltage sources.
         Express all new component and source values in terms of the original labels.
                                                                                Figure 5.91

    62. Reconfigure the circuit of Figure 5.92 so that it uses only current sources.
         Express all new component and source values in terms of the original labels.
                                                                                Figure 5.92

    63. Redesign the circuit of Figure 5.56 so that it uses only current sources and
         produces the same node voltages as the original circuit.

    64. Consider the 600  resistor to be the load in Figure 5.72. Determine a new
         value for the load in order to achieve maximum load power. Also determine
         the maximum load power.

    65. Using Thévenin's theorem with the circuit of Figure 5.73, determine a new
         value of capacitive reactance such that it cancels the Thévenin reactance.

    66. Using Norton's theorem with the circuit of Figure 5.74, determine a new
         value of inductive reactance such that the inductor current is 1 mA in
         magnitude.

199
Challenge

    67. Redesign the circuit of problem 7 (Figure 5.59) so that it uses only current
         sources and produces the same node voltages as the original circuit.

    68. In the circuit of Figure 5.93, use any method or combination of methods to
         determine vab. I1 = 0.050°, I2 = 0.10° and I3 = 0.290°.
                                                                                Figure 5.93

    69. In the circuit of Figure 5.94, use any method or combination of methods to
         determine vab. E1 = 50°, E2 = 1090° and E3 = 150°.
                                                                                Figure 5.94

    70. In the circuit of Figure 5.94, use any method or combination of methods to
         determine vce. E1 = 150°, E2 = 3090° and E3 = 450°.

200
    71. Use any method or combination of methods in the circuit of Figure 5.95 to
         determine vad. E1 = 900°, E2 = 1200° and I = 400E-3180°.
                                                                                Figure 5.95

    72. Consider the 2.7 k + j4 k combo to be the load in Figure 5.60. Determine
         if this value achieves maximum load power. If not, determine a new value
         for the load in order to achieve maximum load power. Also determine the
         maximum load power.

    73. In the circuit of Figure 5.96, assume the source E is 120 volts RMS at 60 Hz.
         Determine the value for the load, Z, that will produce maximum load power.
         Express Z in terms of a resistor and either an inductor or capacitor. Further,
         specify both the series and parallel equivalents for the load.
                                                                                Figure 5.96

    74. Convert the circuit of Figure 5.97 into the equivalent delta configuration.
                                                                                Figure 5.97

201
    75. Find the Thévenin equivalent looking into nodes a and b for the circuit of
         Figure 5.98. I = 40°.
                                                                                Figure 5.98

    76. Find voltage vbc in the circuit of Figure 5.99 through the use of one or more
         delta-Y conversions. E = 1000°, R1 = R2 = 2 k, R3 = 3 k, R4 = 10 k,
         R5 = 5 k, XC1 = XC2 = -j2 k.
                                                                                Figure 5.99

    77. Given the circuit of Figure 5.100, determine an equivalent circuit using a
         single voltage source. E1 = 1000°, E2 = 60180°, E3 = 4090°,
         E4 = 750°.
                                                                                Figure 5.100

202
    78. As mentioned earlier, it is possible that certain AC Y and delta networks
         cannot be converted. Consider the circuit of Figure 5.101. Can this circuit be
         converted with a practical outcome? Why/why not?
                                                                                Figure 5.101

Simulation

    79. Verify the voltage computed for problem 1 by running a transient analysis.
    80. Verify the voltage computed for problem 4 by running a transient analysis.
    81. Using multiple transient analysis simulations, compare the original circuit of

         problem 54 to its converted equivalent. Do this by connecting various
         components to the output terminals, trying several different impedance
         values and checking to see if the two circuits always produce the same
         voltage across this impedance.
    82. Using multiple transient analysis simulations, compare the original circuit of
         problem 59 to its converted equivalent. Do this by connecting various
         components to the output terminals, trying several different impedance
         values and checking to see if the two circuits always produce the same
         voltage across this impedance.
    83. Run a transient analysis to verify the design of problem 70.
    84. Run a transient analysis to verify the design of problem 71.

203
6 Nodal and Mesh Analysis

6.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Utilize nodal analysis techniques to solve for voltages in multi-source series-parallel RLC networks.
    · Utilize mesh analysis techniques to solve for currents in multi-source series-parallel RLC networks.
    · Analyze networks that use dependent voltage and/or current sources.

6.1 Introduction

This chapter presents methods for the analysis of AC circuits that employ resistors, capacitors and inductors
along with any number of voltage and/or current sources. The methods of interest are nodal analysis and mesh
analysis. Nodal analysis is the most general technique and can be applied to virtually any circuit. Mesh analysis
is nearly as versatile and works well if only voltage sources are present. Both analysis methods generate a
system of simultaneous linear equations that are used to solve the circuit for desired voltages or currents. That is,
the system generates a set of values, either currents or node voltages, rather than individual currents or voltages.
There are several methods that can be used to solve the simultaneous equations. These include substitution,
Gauss-Jordan elimination and expansion by minors. These methods are reviewed in Appendix B and are not
covered in this chapter. Instead, to focus on the circuit analysis aspects with minimal distraction, the
explanations and examples will simply detail the process of examining the circuit and developing the system of
equations. The specific technique employed to solve these simultaneous equations depends solely on your
personal preferences.

At this point in the study of AC circuits, it is particularly efficient to obtain an advanced scientific calculator that
can solve the system of equations directly versus working through the solution manually. By doing so, you can
spend your time more effectively; meaning, mastering the process of circuit analysis and creating the equations.
Manual solution techniques, though not necessarily difficult, can be tedious, time consuming and error prone.
Indeed, on larger circuits, there can be a 10:1 differential in time when using a capable calculator versus a
standard scientific calculator9. If you have not already done so, you should consider obtaining a calculator that
can solve simultaneous equations with complex coefficients (i.e., the complex real/imaginary quantities we have
been using). Such calculators can be expensive when purchased new, such as the Texas Instruments TI-89 and
Nspire models. On the used market, perfectly satisfactory older models such as the TI-85 and TI-86 can be
found at considerable discount. Another model to consider is the Casio FX-9750GII, although it is not quite as
powerful as some of the other units mentioned.

9 That's like doing three times as many problems in one-third the time. We don't often get these kinds of opportunities.

204
Along with nodal and mesh, we shall also introduce the concept of dependent AC
sources. Dependent sources do not exhibit a fixed value, but rather the current or
voltage is dependent on some other current or voltage in the circuit. What makes this
interesting is that this controlling current or voltage may itself be affected by the
value produced by the dependent source. Dependent sources are not lab instruments,
like signal or function generators. Instead, they are used to model the behavior of
active electronic devices such as bipolar and field effect transistors. Mastering the
analysis of circuits using dependent sources is critical to the understanding of active
circuitry that use transistors and similar devices10.

6.2 Nodal Analysis

Nodal analysis can be considered a universal solution technique as there are no
practical circuit configurations that it cannot handle. It does not matter if there are
multiple sources or if there are complex configurations that cannot be reduced using
series-parallel simplification techniques, nodal analysis can handle them all. Further,
nodal analysis tends to "give us what we want", namely, a set of node voltages for
the circuit. Once the node voltages are obtained, finding any branch currents or
component powers becomes an almost trivial exercise. Nodal analysis relies on the
application of Kirchhoff's current law to create a series of node equations that can be
solved for node voltages. These equations are based on Ohm's law and will be of the
form i = v/Z, or more generally, i = (1/ZX)vA + (1/ZY)vB + (1/ZZ)vC...

We will examine two variations on the theme; first, a general version that can be
used with both voltage and current sources, and a second somewhat quicker version
that can be used with circuits only driven by current sources.

General Method

Consider the circuit shown in Figure 6.1. We begin by labeling connection nodes.
We are interested in identifying current junctions, that is, places where currents can
combine or split. These are also known as summing nodes and are circled in blue on
the figure. We do not concern ourselves with points where just two components
connect without any other connection, such as points a and c. Once the proper nodes
are identified, reference current directions are assigned. The reference current
directions are chosen arbitrarily and for convenience. They may be the opposite of
reality. This is not a problem. If we assign directions that are reversed, we'll simply
wind up with a current version of a double negative, and the computed node voltages
will work out just fine.

10 For more on transistors and other semiconductors, see Semiconductor Devices: Theory
    and Application. Another free OER text by the author.

205
One node is chosen as the reference. This is the point to which all other node
voltages are measured against. Typically, the reference node is ground, although it
does not have to be.

                                                                                         Figure 6.1
                                                                                         A simple dual voltage source
                                                                                         circuit with the currents and
                                                                                         nodes defined.

We now write a current summation equation for each summing node, except for the
reference node. In this circuit there is only one node where currents combine (other
than ground) and that's node b. Points a and c are places where components connect,
but they are not summing nodes, so we can ignore them for now. Using KCL on
node b we can say:

     i1 + i2 = i3

Now we'll describe these currents in terms of the source and node voltages, and
associated components. For example, i3 is the node b voltage divided by -jXC while
i1 is the voltage across R divided by R. This voltage is va - vb.

     va -v b + v c -v b = v b
     R             jX L - jX C

Noting that va = E1 and vc = E2, with a little algebra this can be reduced to:

     ( ) ( ) ( ) 1 E1 + 1 E2 = 1 + 1 + 1 vb
     R             jX L        R jX L - jX C

All quantities are known except for vb and thus it is easily found with a little more
algebra. If there had been more nodes, there would have been more equations and
more unknowns, one for each node. As we shall see, this conductance-voltage
product format turns out to be a convenient way of writing these equations. Also,
note that the first two terms on the left reduce to fixed current values.

For current sources, the process is similar but a bit more direct. Consider the circuit
of Figure 6.2. We start as before, identifying nodes and labeling currents. We then
write the current summation equations at each node (except for ground). We
consider currents entering a node as positive and exiting as negative. There are two
nodes of interest here, and thus, two equations each with two unknowns will be
generated.

206
                                                                                       Figure 6.2
                                                                                       A dual current source circuit
                                                                                       with the currents and nodes
                                                                                       defined.

     Node a: I1 = i3 + i4
     Node b: i3 + I2 = i5, and rearranging in terms of the fixed source,
     Node b: I2 = -i3 + i5

The currents are then described by their Ohm's law equivalents:

     Node a:  I 1 = va -vb + va
     Node b:  R2                        R1

              I 2 = -va -vb + vb
              R2                        jX L

Expanding and collecting terms yields:

     Node a:  ( ) ( ) I 1 = 1 + 1 va - 1 vb   R2
     Node b:  R1 R2

              ( ) ( ) I 2 = - 1 va + 1 + 1 vb
              R2                            R2 jX L

As the impedance values and currents are known, simultaneous equation solution
techniques may be used to solve for the node voltages. Once again, there are as
many equations as node voltages.

One practical point before continuing: It is very important that the coefficients for  Figure 6.3
the various node voltage terms "line up" when the final system of equations is         Diagonal symmetry.
written out. That is, there should be a column for the va terms, a column for the vb
terms, and so on. They should not be written out in random order, but rather           (1+j2)va -(-j2)vb -(1)vc
following the style shown in Figure 6.3. This format will make it much it easier to    -(-j2)va (2-j3)vb -(-j3)vc
enter the coefficients into a calculator or solve manually. Further, the set of
coefficients must show diagonal symmetry. That is, if we draw a major diagonal           -(1)va -(-j3)vb (5-j3)vc
from upper-left to lower-right (red), whatever coefficients are above-right from the
diagonal should be mirrored below-left of the diagonal (blue, purple, green). If the
set of values does not show diagonal symmetry, an error has been made. You must
go back and recheck the original node summations. Simple as that. Even the simple
2x2 of Figure 6.2 shows this symmetry (namely, the coefficient of -1/R2 for vb in the
first equation and va in the second).

207
Example 6.1

         Determine the voltage across the inductor in the circuit of Figure 6.4. Source
         one is 50° volts RMS and source two 290° volts RMS.

                                                                                                                   Figure 6.4
                                                                                                                   Circuit for Example 6.1.

     Other than ground, there is only one current summing node in this circuit,
     and that's the junction at the top of the inductor. We will refer to this junction
     as node a. Following the outline of Figure 6.1, we define three currents; i1
     entering from the left, i2 entering from the right, and i3 exiting down through
     the inductor.

     i1 + i2 = i3

     Next, these currents are described in terms of the voltages and components.
     We'll number the resistors from left to right.

     E1 -v a + E2 -v a = va
     R1 - jX C              R2       jX L

     This can be rearranged as:

     ( ) ( ) ( ) 1 E1 + 1 E2 = 1 + 1 + 1 va
     R1 - jX C                   R2        R1 - jX C R2 jX L

     Populate with values:

     ( ) ( ) ( ) 1 500 - j 300 5  0 ° V + 1 400  2 90° V = 1 500 - j 300 + 1 400  + 1 j 200 va

     This simplifies to:

     8.575E-3 31° A +5E-3  90° A = (5.72E-3 -46 ° S) va

     Solving for the unknown, we find that va = 2.08798° volts RMS.

208
Example 6.2

         In the circuit of Figure 6.5, determine va and vb. E is 200° volts peak while
         I is 0.10° amps peak. The system frequency is 2 kHz.

                                                                                                                   Figure 6.5
                                                                                                                   Circuit for Example 6.2.

     There are two nodes of interest here, other than ground. This means we will
     generate two equations with two unknowns (va and vb). Using the standard
     reactance formulas, the inductive and capacitive reactances are found to be
     j125.7  and -j159.2 , respectively. If we assume the reference direction
     for current is from node a to node b, and that the current flow through the
     two center resistors is downward, the equations are:

     Node a:   20  0 ° V -v a = va + v a -vb
     Node b:  100 + j 125.7 250  - j 159.2 

              va -vb +0.1  0 ° A = vb
              - j 159.2                      400 

     Expanding and collecting terms yields:

     Node a:

     ( ) ( ) 0.1245  -51.5° A = 1 250 + 1 100+ j 125.7 + 1 - j 159.2 va - 1 - j 159.2 vb

     Node b:

     ( ) ( ) 0.1  0° A = - 1 - j 159.2 va + 1 400 + 1 - j 159.2  vb

     These are simplified, ready for manipulation (note diagonal symmetry).

     0.1245  -51.5° A = ( 8E-3  10.1 ° S) va - (6.281E-3  90° S) vb

     0.1  0 ° A = - (6.281E-3  90 ° S)va +(6.76E-3  68.3 ° S)vb

     After solving the system of equations, we see that va = 16.240.09° volts
     and vb = 20.99-22.3° volts.

209
Computer Simulation

To verify the results of the preceding example, the circuit of Figure 6.5 is captured in
a simulator as shown in Figure 6.6.

                                                                                                                   Figure 6.6
                                                                                                                   The circuit of Example 6.2
                                                                                                                   captured in a simulator.

A transient analysis is performed on the circuit. Node voltages 1, 3 and 4 are plotted,
corresponding to the voltage source and nodes a and b, respectively, in Figure 6.7.

                                                                                                                   Figure 6.7
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 6.6.

210
The amplitudes are just as computed. Node voltage a appears to be nearly in phase
with the voltage source, as expected. Node voltage b lags the source by between
one-quarter to one-third of a division, or some 30 microseconds. For a 2 kHz source,
this translates to around -22 degrees, verifying the calculated result.

Example 6.3

         For the circuit of Figure 6.8, find va and vb. The system frequency is 1 kHz.
         I1 = 2.50° A and I2 = 10° A.

                                                                                                                   Figure 6.8
                                                                                                                   Circuit for Example 6.3.

     We will generate two equations with two unknowns, va and vb. The reactance
     formulas yield j6.28  and -j15.9  for the inductor and capacitor. If we
     assume the reference direction for current is from node a to node b, and that
     the current flow through the capacitor and inductor is from nodes a and b
     downward, the equations are:

     Node a:  2.5  0 ° A = va + va -vb
     Node b:                   - j 15.9  10 

              va -v b = 1 0 ° A + vb
              10   4 + j 6.28

     Expanding and collecting terms yields (note diagonal symmetry):

     ( ) ( ) 2.5  0 ° A = 1 10 + 1 - j 15.9 va - 1 10 vb
     ( ) ( ) -1  0 ° A =- 1 10 va + 1 10 + 1 4 + j 6.28 vb

     2.5  0 ° A = (0.118  32.2 ° S) va - (0.1  0 ° S) v b
     -1  0 ° A = - (0.1  0 ° S) va +(0.206  -33.3° S) vb

     The results are: va = 30.39-38.7° volts and vb = 11.37-20.8° volts.

211
Computer Simulation

To verify the results of the preceding example, the circuit of Figure 6.8 is captured in
a simulator as shown in Figure 6.9.

                                                                                                                   Figure 6.9
                                                                                                                   The circuit of Example 6.3
                                                                                                                   captured in a simulator.

A transient analysis is performed on the circuit. Node voltages 1 and 2 (i.e., nodes a
and b, respectively) are plotted in Figure 6.10.

                                                                                                                   Figure 6.10
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 6.9.

212
The simulation results agree nicely with the computed values in terms of both
amplitude and phase.

Inspection Method

The system of equations can be obtained directly through inspection if the circuit
contains current sources and no voltage sources. Let's take another look at the
equations developed in the preceding example. For convenience, the circuit is
reproduced in Figure 6.11 with reactance values. I1 = 2.50° A and I2 = 10° A.

                                                                                                                   Figure 6.11
                                                                                                                   Circuit of Example 6.3 with
                                                                                                                   reactances.

    ( ) ( ) 2.5  0 ° A = 1 10 + 1 - j 15.9 va - 1 10 vb
    ( ) ( ) -1  0 ° A =- 1 10 va + 1 10 + 1 4 + j 6.28 vb

The top equation was built around a current summation at node a while the bottom
was built around a summation at node b. The first thing that might be apparent is
that on the left of the equals signs are the current sources connected to these nodes.
Positive means the current is entering while negative denotes an exiting current. The
second thing is that, for the node of interest (node a for the top equation, node b for
the bottom), the coefficients represent the items connected to that particular node.
For example, in the top equation, the components connected to node a are the 10 
resistor and the - j15.9  reactance. Likewise, in the bottom equation, the
components connected to node b are the 10  resistor and the 4 + j6.28 
impedance. The third thing is that the remaining coefficients consist of the
components that are in common between the node of interest and the other node
(i.e., 10  connects a to b for the first equation, and also connects b to a for the
second equation). These other connections always show up as negative. The reason
for this should be apparent if you examine the structure of the original equations
from Example 6.3.

If there is no bridging element between a node and the node of interest, then that
coefficient will be zero. If voltage sources exist in the circuit, source conversions
can be used to obtain an equivalent circuit that uses only current sources.

213
The huge advantage of the inspection method is that it cuts out a time consuming
and error prone section of the process, namely converting the original KCL
summations into a set of simplified equations with coefficients for each unknown.
The inspection method generates the equations directly. To further speed the process,
it can be useful to turn each impedance value into a corresponding admittance value
before creating the equations. In this way, the reciprocals are computed once for
each item rather than multiple times in multiple equations. Finally, remember that
the resulting set of equations must exhibit diagonal symmetry, as shown back in
Figure 6.3.

The inspection method is summarized as follows:

    1. Verify that the circuit uses only current sources and no voltage sources. If
         voltage sources exist, they must be converted to current sources before
         proceeding.

    2. Find all of the current summing nodes and number (or letter) them. Also
         decide on the reference node (usually ground).

    3. To generate an equation, locate the first node. This is the node of interest and
         the next few steps will be associated with it.

    4. Sum the current sources feeding the node of interest. Entering is deemed
         positive while exiting is deemed negative. The sum is placed on one side of
         the equals sign.

    5. Next, find all of the impedances connected to the node of interest and write
         them as a sum of admittances on the other side of the equals sign, the group
         being multiplied by this node's voltage (e.g., v1). That makes one term.

    6. Now for the other terms. Find all of the admittances that are connected
         between the node of interest and the next node (e.g., node 2). Sum these
         together and multiply the group by this other node's voltage (e.g., v2).
         Subtract that product from the equation built so far. Repeat this process until
         all of the other nodes have been examined (except ground). If there are no
         common impedances between the node of interest and the other node, use
         zero for the coefficient of that node's voltage. Once all other nodes are
         considered, this equation is finished.

    7. Go to the next node and treat this as the new node of interest.
    8. Repeat steps 4 through 7 until all nodes have been treated as the node of

         interest. Each iteration creates a new equation. There will be as many
         equations as there are nodes, less the reference node. Check for diagonal
         symmetry and solve.

The inspection method is best observed in action, and is used in the following
example.

214
Example 6.4

         Write the system of equations for the circuit of Figure 6.12. I1 = 100° A
         and I2 = 490° A.

                                                                                                                   Figure 6.12
                                                                                                                   Circuit for Example 6.4.

         We begin at node a, the first node of interest. Find all of the current sources
         connected to this node. All we have is I1. It is exiting, and thus negative.

                     -10  0 ° A = ...
         Now find all of the items connected to this node and create a sum of
         admittances.

        ( ) -10  0° A = 14 + 12  + 18 va...

         Include the terms that are common between node a and node b. This is
         negative.

        ( ) ( ) -10  0° A = 14  + 12  + 18 va - 12 vb ...

         And finally, include the terms common between node a and node c. This is
         also negative.

        ( ) ( ) ( ) -10  0° A = 14 + 12 + 18 va - 12 vb - 18 vc

         The first equation is done. We now make node b the node of interest and
         repeat the process.

215
         Find all of the current sources connected to this node. There are none.

                     0 = ...

         Find all of the items connected to this node and create a sum of admittances.

        ( ) 0 = ...+ 11  + 12  + 1 - j 5  vb...

         Include the terms that are common between node a and node b. This is
         negative and goes into the lead (a before b) to keep everything nicely lined
         up.

        ( ) ( ) 0 =- 12 va + 11  + 12 + 1 - j 5 vb...

         Now include the terms common between node b and node c. This is also
         negative and is inserted at the tail (c after b).

        ( ) ( ) ( ) 0 =- 12 va + 11 + 12 + 1 - j 5 vb - 11 vc

         The second equation is finished. We now make node c the node of interest
         and repeat the process for the final time.

         Find all of the current sources connected to node c. We have both I1 and I2
         entering.

                     10 0 ° A+4  90 ° A = ...

         This current is equivalent to 10.7721.8°. Now find all of the items
         connected to this node and create a sum of admittances.

        ( ) 10.77 21.8° A = ... 11 + 18  + 1 j 10 vc

         Include the terms that are common between node c and node a. This is
         negative and goes into the lead (a before c).

        ( ) ( ) 10.77 21.8° A =- 18 va... + 11 + 18  + 1 j 10  vc

         Now include the terms common between node b and node c. This is also
         negative and is inserted in the middle (b before c).

216
    ( ) ( ) ( ) 10.77 21.8° A =- 18 va - 11 vb + 11  + 18  + 1 j 10  vc

         The third and final equation is finished. The completed set of equations is:

       ( ) ( ) ( ) -10 0° A = 14 + 12 + 18 va - 12 vb - 18 vc
            ( ) ( ) ( ) 0 =- 12 va + 11 + 12 + 1 - j 5 vb - 11 vc

     ( ) ( ) ( ) 10.77  21.8° A =- 18 va - 11 vb + 11  + 18 + 1 j 10 vc

         Note that the set exhibits diagonal symmetry and that all coefficient groups
         are negative except for those along the major diagonal. Consequently, the
         coefficient groups may now be simplified to obtain single coefficients for
         the unknowns, and the equations are ready for solution. The results are:
         va = 10.972.8° volts, vb = 23.634.7° volts and vc = 31.237.3° volts.
         These values can be crosschecked by using them to find the currents through
         each component, and then verifying KCL for each node.

         Although this example may appear to be somewhat long winded, with a little
         practice the process will become second nature. At that point, the set of
         equations can be created quickly and with little possibility of error, even for
         large circuits with many nodes.

Using Source Conversions

As mentioned previously, given circuits with voltage sources, it may be easier to
convert them to current sources and then apply the inspection technique rather than
using the general approach outlined initially. There is one trap to watch out for when
using source conversions: the voltage across or current through a converted
component will most likely not be the same as the voltage or current in the
original circuit. This is because the location of the converted component will have
changed. For example, the circuit of Figure 6.5 (Example 6.2) could be solved using
the inspection method of nodal analysis by converting the voltage source and its
associated impedance of the 100  resistor in series with the 10 mH inductor into a
current source. Although the associated impedance still connects to the converted
source, the other end no longer connects to node a. Rather, it would connect to
ground. Therefore, the voltage drop across this impedance in the converted circuit is
not likely to equal the voltage drop seen across it in the original circuit (the only way
they would be equal is if the voltage source E turned out to be 0).

217
Supernode

From time to time you may see a circuit utilizing an ideal voltage source like the        Figure 6.13
one shown in Figure 6.13. That is, this voltage source does not have a series             Bridging voltage source
impedance associated with it. Without that impedance, it becomes impossible to            without an internal
create an expression for the current passing through the source using the general         impedance.
method, and impossible to convert the voltage source into a current source in
order to use the inspection method. There are a few of ways out of this quandary.
The first way is to recognize that all realistic sources have some internal
impedance, so we simply add a very small resistor in series with the source so
that a source conversion is possible. Of course, not just any resistor will do. In
order to maintain accuracy, the newly added resistance has to be much smaller
than any surrounding resistances or reactances. A reduction by two orders of
magnitude generally yields a variation smaller than that produced by component
tolerances in all but high precision circuits and will usually do the trick. Still
smaller values will further increase accuracy. Another way out is to use a
supernode.

A supernode is, in effect, the combination of two nodes. It relies on a simple
observation. If we examine the circuit of Figure 6.13, the path of the voltage source
produces identical currents flowing into and out of nodes a and b. As a consequence,
if we treat the two nodes as one big node, then when we write a KCL summation,
these two terms will cancel. To see just how this works, refer to Figure 6.14.

In this version we have replaced the voltage source with its ideal internal impedance;
a short. We have also labeled the two nodes of interest, a and b, and labeled the
currents, drawn with convenient reference directions. The specific choice of
direction will not matter, just use whatever scheme seems appropriate.

                                                                                          Figure 6.14
                                                                                          Circuit modified for supernode
                                                                                          analysis.

Due to the shorted voltage source, nodes a and b are now the same node. Take a look
at the currents entering and exiting this combined "super" node. On the left side
(formerly node a) we see a constant current Ix entering while i1, i2 and i3 are exiting.
On the right side (formerly node b) we see the Iy entering along with i1 and i2, and

218
exiting we see i4. At this point we'll create an expression where all of currents
entering the super node are on the left side of the equals sign and all of the exiting
currents are on the right:

              iin =  iout
             I x+ I y+i1+ i2 = i1+i2+i3+i4

This can be simplified to:

             I x+ I y = i3 + i4

Writing this in terms of Ohm's law we have:

             I x+I y = 1 va + 1 vb
                            -jXC  j XL

We also know that va - vb = E from the original circuit. We know this because the
reference polarity of the source is + toward the a node and - toward the b node.
Therefore it must be va - vb and not vb - va. Assuming all sources and components
are known, that makes two equations with two unknowns, solvable using
simultaneous equation techniques. This is illustrated in the following example.

Example 6.5

     Find va and vb for the circuit of Figure 6.15. E = 160° volts, Ix = 0.10°          Figure 6.15
     amps and Iy = 0.2590° amps.                                                        Circuit for Example 6.5.

     The circuit is redrawn in Figure 6.16 with nodes and currents labeled.
     We short the 16 volt source and write a current summation at the a:b
     supernode:

                  iin =  iout
                 0.1  0 ° A +0.25  90 ° A +i1+i2 = i1+i2+i3+i4

     This can be simplified to:

                 0.2693  68.2° A = i3 +i4

     Writing this in terms of Ohm's law we have:

                 0.2693  68.2° A = 1 - j 100  va + 1 j 500 vb
                 0.2693  68.2° A = j 10 mS v a - j 2 mS vb

219
     We also know that va - vb = 160° volts. Therefore vb = va - 160° volts.           Figure 6.16
     Substituting this into the prior equation yields:                                 Circuit modified for supernode
                                                                                       analysis.
       0.2693  68.2 ° A = j 10 mS v a - j 2 mS(va -16 0 ° V)
       0.2693  68.2 ° A = j 10 mS v a - j 2 mS va +32E-3  90 ° A
       0.2394  67.9 ° A = j 8 mS va

                          va = 29.92  -22.1° V

     We know that vb is 160° volts below va, and thus after subtracting,
     we find vb = 16.24-43.8° volts.

     To verify, we will perform a KCL summation at each node. For node
     a, assuming i1 exits as drawn:

     i1 = 0.1  0 ° A - v a - j 100 -v a-v b 200 
     i1 = 0.1  0 ° A- 29.92 -22.1° V - j 100  -29.92  -22.1° V-16.24  -43.8 ° V 200 
     i1 = 0.292  -108 ° A

     Doing likewise for node b, and assuming i1 enters as drawn:

     i1 =-0.25  90° A + vb j 500  -v a-vb 20 
     i1 =-0.25  90° A+16.24 -43.8 ° V j 500  - 29.92 -22.1° V-16.24  -43.8 ° V 200
     i1 = 0.292  -110 ° A

     Other than the small deviation due to accumulated rounding, these currents
     match. That means that the current through the voltage source is verified to
     be the same at both terminals, as it must be.

An alternative to the basic supernode technique is to recognize that the two nodes on
either side of the voltage source are effectively locked together by the source
voltage. That is, if one of the node voltages is found, then the other may be
determined by adding or subtracting the source voltage to or from the known node
voltage, depending on the reference polarity. This idea is exploited by simply
describing one node voltage in terms of the other at the outset. This will reduce the
total number of unknowns by one and reduce the system of equations by one. The
technique is illustrated in the example following.

220
Example 6.6                                                                            Figure 6.17
                                                                                       Circuit for Example 6.6.
         Find node voltages va, vb and vc for the circuit of Figure 6.17. The sources
         are: E = 200° volts and I = 245° amps.

     Once again we have a situation of a voltage source lacking a series
     impedance which makes a source conversion impossible. Without having to
     short it and thus treating nodes a and c as an explicit supernode, we can take
     an alternate route. We begin by noting that the currents entering and exiting
     the voltage source must be identical.

     The circuit is redrawn in Figure 6.18 with the nodes and convenient current
     directions labeled. The circuit also uses equivalent conductances and
     susceptances in place of the original resistances and reactances in order to
     speed the process of simplifying the equations. Unlike the basic supernode
     technique, this time the voltage source is left in.

     The key observation is that vc = va - 200° V. In other words, vc is locked to
     va and if we find one of them, we can determine the other. Therefore, instead
     of writing three equations using three unknowns, we shall instead refer to
     node c in reference to node a. In other words, wherever we need vc we

     instead shall write va - 200° V. Thus, this three node circuit will only need
     two equations.

     We begin at node a and apply KCL as usual.                                        Figure 6.18
                  iin =  iout                                                          Circuit of Example 6.6 with
                 i1+i3 = i2                                                            currents labeled and using
                                                                                       conductances.

     This is expanded using Ohm's law and we solve for i1:

     i1 = i2 -i3

     i1 = j 0.5 S v a -0.25 S(vb -v a)
     i1 = (0.25 +j 0.5)S va -0.25 S v b

     On to node b:

                I = i3 +i4
     2  45 ° A = 0.25S (v b -va ) +0.1 S(vb -v c)
     2  45 ° A = 0.25S (v b -va ) +0.1 S(vb -(v a -20  0 ° V ))
     2  45 ° A = 0.25S (v b -va ) +0.1 S(vb -v a +20 0 ° V)
     2  45 ° A = 0.25S (v b -va ) +0.1 S(vb -v a) +2  0 ° A

     1.531 112.5° A =-0.35 S v a +0.35S vb

221
         And finally node c:

                     i4 = i1 +i5
                     i1 = i4 -i5
                     i1 = 0.1 S(vb -v c) -(- j 0.2 S)vc
                     i1 = 0.1 S(vb -(v a-20  0 ° V)) +j 0.2 S(va -20  0 ° V)
                     i1 = 0.1 S(vb -v a +20  0 ° V ) + j 0.2 S(va -20 0 ° V)
                     i1 = 0.1 S(vb -v a) +j 0.2 S va +(2 - j 4)A

                     i1 = (-0.1 +j 0.2)S v a +0.1 S vb +4.472  -63.4° A

         The equations for nodes a and c both equal i1, thus they equal each other.

            (0.25+j 0.5)Sv a -0.25 S vb = (-0.1 +j 0.2)S v a +0.1 S vb +4.472  -63.4° A
                       4.472  -63.4 ° A = (0.35 +j 0.3)S v a - 0.35S vb

         The final equations are:

                     4.472  -63.4 ° A = (0.35 +j 0.3)S va - 0.35S vb
                      1.531  112.5 ° A =-0.35S v a +0.35 S vb

         The solution is va = 9.823-151.3° volts and vb = 10.31-176.2° volts. As
         vc is 200° volts less than va, then vc = 29-170.6° volts. KCL summations
         at each of the three nodes will verify these values.

6.3 Mesh Analysis

Mesh analysis is similar to nodal analysis in that it can handle complex multi-source
circuits. In some ways it is the mirror image of nodal analysis. While nodal analysis
uses Kirchhoff's current law to create a series of current summations at various
nodes, mesh analysis uses Kirchhoff's voltage law to create a series of loop
equations that can be solved for mesh currents. The current through any particular
component may be a mesh current or a combination of mesh currents. Of course,
once those currents are found, it is a short hop to find any desired voltage. Mesh
does have one limitation that nodal doesn't: Mesh analysis requires that the circuit
be planar. That is, the circuit must be able to be drawn on a flat surface without any
wires crossing each other. Another way of looking at it is that planar circuits can be
drawn to appear as a series of boxes butting up against each other. To get a visceral
idea of this notion, grab a piece of paper and place four dots on it. Try to draw a line
from each dot to every other dot but without crossing any lines. After a few tries,
you should be successful. Now try it with five dots. You can't do it unless you "draw
in the air" and hop over other lines. Obviously, that's possible with real circuits
because they're 3D. Therefore there are circuits that cannot be solved using mesh.

222
Consider the circuit of Figure 6.19. This circuit has two voltage sources and              Figure 6.19
cannot be simplified further, although it can be solved using either superposition         A simple two-source circuit.
or nodal analysis. For mesh analysis, we begin by designating a set of current
loops. These loops should be minimal in size and together cover all components
at least once. By convention, the loops are drawn with a clockwise reference
direction. There is nothing magical about them being clockwise, it is just a
matter of consistency. The annotated version of the circuit is redrawn in
Figure 6.20.

Here we have two loop currents, i1 and i2. Note that all components exist in at
least one loop (and sometimes in more than one loop, like capacitor C).
Depending on circuit values, one or more of these loop directions may in fact be
opposite of reality. This is not a problem. If the true reference direction is opposite,
then the currents will show up as negative values, and thus we know that the real
reference direction is counterclockwise. Just remember that a positive result means a
clockwise direction and negative indicates counterclockwise.

                                                                                           Figure 6.20
                                                                                           Circuit with mesh loops and
                                                                                           voltage polarities drawn.

We begin by writing KVL equations for each loop.

                   Loop 1: E1 = voltage across R + voltage across XC
                   Loop 2: -E2 = voltage across XC + voltage across XL

Note that E2 is negative as i2 is drawn flowing out of its negative terminal. Now
expand the voltage terms using Ohm's law. The resistor and inductor each see a
single current, i1 and i2, respectively. The capacitor experiences both currents. From
the perspective of loop 1, i2 is flowing in the opposite direction. Thus, the net current
is i1 - i2. From the perspective of loop 2, i1 is flowing in the opposing direction and
thus the net current is i2 - i1. The reference voltage polarities reinforce this notion.

                   Loop 1: E1 = i1 R + (i1 - i2)(-jXC)
                   Loop 2: -E2 = i2 (jXL) + (i2 - i1)(-jXC)

Multiplying out and collecting terms yields:

                   Loop 1: E1 = (R -jXC) i1 - (-jXC) i2
                   Loop 2: -E2 = - (-jXC) i1 + (jXL -jXC) i2

223
As the component values and source voltages are known, we have two equations
with two unknowns. These can be solved for i1 and i2 using the simultaneous
equation solution techniques of your choice.
Example 6.7

         For the circuit of Figure 6.21, determine vb and vc. The sources are:
         E1 = 90° volts and E2 = 12-90° volts.

                                                                                                                   Figure 6.21
                                                                                                                   Circuit for Example 6.7.

         We begin by labeling our loops, as shown in Figure 6.22. Each loop will
         generate an equation based on a KVL summation around that loop. We will
         number the components from left to right, as usual.

                                                                                                                   Figure 6.22
                                                                                                                   Circuit of Figure 6.21 with
                                                                                                                   current loops drawn.

         For loop 1:
                                E1 - E2 = ( jX L1+ R1)i1+ R2(i1 -i2)
                                E1 - E2 = (R1+ R2+ jX L1)i1 - R2 i2

            9  0 ° V -12 -90 ° V = (20+80+ j 20)i1 -20i2
                          15 53.1 ° V = (100+ j 20)i1 -20 i2

         Repeat for loop 2:

224
                                  E2 = (- jX C+ jX L2)i2+R2(i2 -i1)
                                   E 2 = - R2 i1+( R2 - jX C+ jX L2)i2
                     12 -90 ° V = -20i1 +(20 - j 75+ j 50)i2
                     12 -90 ° V = -20i1 +(20 - j 25)i2

         The two loop equations are:

                     15 53.1° V = (100 + j 20)i1 -20i2
                     12 -90 ° V = -20i1 +(20 - j 25)i2

         The equations show diagonal symmetry. The currents are i1 = 0.178519.9°
         amps and i2 = 0.3529-21.4° amps. To find the voltages vb and vc, we just
         need to apply Ohm's law. The voltage vc is the potential across the j50 
         inductor.

                      v c = i2× jX L2
                      v c = 0.3529  - 21.4° A × j 50 
                      v c=17.64  68.6 ° V

         The potential vb is found similarly.

                      vb = i2×(- jX C+ jX L2)
                      vb = 0.3529  -21.4 °×(- j 75 +j 50 )
                      vb=8.823  -111.4 ° V

         For verification, we can also find vb by subtracting the voltage developed
         across the series inductor/resistor pair from the first source.

                      vb = E1 - i1×( R1+ jX L1)
                      vb = 9  0 ° V - 0.1785  19.9 ° A ×(80 + j 20 )
                      vb=8.823  -111.4 ° V

Example 6.8

         In the circuit of Figure 6.23, find vb. E = 100° volts peak at a frequency of
         10 kHz.

         The circuit is a bridge network. Even though it has only a single voltage
         source, basic series-parallel techniques will not work here. Nodal analysis
         can also work here as can delta-Y conversion, however, mesh is an excellent
         choice for this layout.

225
                                                                                                                   Figure 6.23
                                                                                                                   Circuit for Example 6.8.

         We start by finding the reactance values. Using the standard reactance
         formulas we find that XL = j628.3  and XC = -j318.3 . After substituting
         these into the original circuit and defining the loops, we have Figure 6.24.

                                                                                                                   Figure 6.24
                                                                                                                   Circuit of Figure 6.23 with
                                                                                                                   reactance values and current
                                                                                                                   loops drawn.

         We have three loops with three unknown currents, and therefore three
         equations. We'll number the resistors from left to right. For loop 1:

                      E = vC+v R1
                      E = - jX C (i1 -i2)+R1 (i1 -i3)
                      E = ( R1 - jX C)i1 -(- jX C)i2 -R1 i3
            10 0 ° V = (1 k  - j 318.3)i1+ j 318.3 i2 -1 k i3
         For loop 2:
                     0 = vC+v L+ vR2
                     0 = - jX C (i2 -i1)+ jX L(i2 -i3)+ jX Li3
                     0 = -(- jX C)i1+(R2+ X L - jX C )i2 -R2i3
                     0 =-(- j 318.3)i1+(500 + j 628.3 - j 318.3)i2 -500 i3
                     0 = j 318.3i1+(500+ j 310)i2 -500 i3

226
         For loop 3:
                     0 = v R1+v R2+v R3
                     0 = R1(i3 -i1)+R2(i3 -i2)+R3i3
                     0 = -R1i1 - R2 i2+( R1+R2+R3)i3
                     0 = -1 k i1 -500 i2+(1 k +500+2 k )i3
                     0 = -1 k i1 -500 i2+3.5 k i3

         The final set of equations is:
            10 0 ° V = (1 k  - j 318.3)i1+ j 318.3 i2 -1 k i3
                       0 = j 318.3 i1+(500+ j 310)i2 -500 i3
                       0 =-1 k i1 -500i2+3.5 k i3

         The system of equations has diagonal symmetry. The results are:
         i1 = 10.24E-316° amps, i2 = 6.754E-3-85.7° amps and
         i3 = 2.888E-3-3.13° amps.
         For vb, this is just the voltage across the 1 k resistor. Note that a pair of
         meshing currents (i1 and i3) are flowing through that resistor, so we must
         determine the net value of current. If we assume the reference polarity for vb
         is positive, that coincides with the direction of i1, and thus the net current
         must be i1 - i3. The result is inet = 7.57E-323.2° amps. Therefore,
         vb = 7.5723.2° volts.

Computer Simulation

Figure 6.25 shows the bridge circuit of Example 6.8 captured in a simulator. This
will be used to verify the computed result.

                                                                                                                   Figure 6.25
                                                                                                                   Circuit of Figure 6.23 in a
                                                                                                                   simulator.

227
A transient analysis is run on the circuit, plotting node 2 which corresponds to vb,
and node 1, the input voltage, which is handy for phase reference.

                                                                                                                   Figure 6.26
                                                                                                                   Transient analysis for the
                                                                                                                   circuit of Figure 6.25.

Examining the plot, we can see that the node 2 voltage is just above 7.5 volts peak,
as calculated. Further, this waveform leads the the input waveform by just over a
quarter of a division. As this plot shows four divisions per cycle, each division is 90
degrees. This indicates a leading or positive phase shift in the low 20 degree range,
and that corroborates nicely the computed value of 23.2 degrees.

Inspection Method

Like nodal analysis, it is possible that the system of equations can be obtained
directly through inspection. This is true only if the circuit contains no current
sources. Look at the final set of equations derived in Example 6.8 from Figure 6.24.
A clear pattern will emerge. To generate an equation for a given loop, simply focus
on that loop and ask the following questions: What is the total source voltage in this
loop? This yields the voltage constant on the left side of the equals sign. Next, sum
the resistance and reactance values in the loop under inspection. This yields the
coefficient for that current term. For the other current coefficients, sum the
resistances and reactances that are in common between the loop under inspection
and the other loops (e.g., for loop 1, XC is in common with loop 2). These values will
always be negative (an exception arises with a "double negative", as seen with the

228
capacitor). As usual, the set of equations produced must exhibit diagonal symmetry.
While it is possible to extend this technique to include current sources, usually it is
easier and less error-prone to convert the current sources into voltage sources. Then
the process can continue with the direct inspection method outlined above. Finally, it
is important to remember that the number of loops determines the number of
equations to be solved. This method will be illustrated in the example following.
Example 6.9

         For the circuit of Figure 6.27, find vb and the current through the 15 
         resistor. E1 = 100° volts peak and E2 = 2090° volts peak.

                                                                                                                   Figure 6.27
                                                                                                                   Circuit for Example 6.9.

         We identify and label three loops, as shown in Figure 6.28. This circuit
         utilizes only voltage sources and no current sources. Therefore, we can
         apply the inspection method without extra effort.

                                                                                                                   Figure 6.28
                                                                                                                   Circuit of Figure 6.27 with
                                                                                                                   current loops drawn.

         We start at loop 1 and sum all of the voltage sources. The sole source is E1.
                     10 0 ° V = ...

         Now we sum all of the resistances and reactances in this loop. This is the
         coefficient for the first current term.

                     10 0 ° V = (20+6 +j 8 )i1 ...
229
         We continue the process by determining the components that are in common
         between this loop and the next loop. Remember, this coefficient is negative.

                     10 0 ° V = (20+6 +j 8 )i1 -(6 +j 8)i2 ...

         We repeat the process by determining the common components with the
         next loop. This coefficient is negative. In this situation, no components are
         in common between loops 1 and 3. We shall leave in placeholder with a
         coefficient of zero, just as a reminder that we didn't forget anything and also
         to ensure that the coefficients in the final set of equations line up nicely.

                     10 0 ° V = (26+ j 8)i1 -(6 + j 8 )i2 -0 i3

         We now move to loop 2 and repeat the sequence of steps. There is only one
         source, E2, and it shows up negative as mesh current i2 is flowing out of its
         negative terminal. The result is:

            -20 90° V =-(6 + j 8 )i1+(6 +10+ j 8 - j 14)i2 -10i3
            -20 90° V =-(6 + j 8 )i1+(16 - j 6 )i2 -10i3

         And finally the third loop. Here the second source shows up as positive.

                     20  90° V = -0 i1-10i2 -(10+15- j 12)i3
                     20  90° V = -0 i1-10i2 -(25 - j 12)i3

         The completed system of equations is:

                          10 0 ° V = (26 + j 8 )i1 -(6 + j 8 )i2 -0 i3
                      -20 90° V =-(6 + j 8 )i1+(16 - j 6 )i2 -10i3

                        20  90 ° V =-0i1-10i2 -(25 - j 12)i3

         The system has diagonal symmetry. The resulting currents are:
         i1 = 0.6131-15.5° amps, i2 = 0.6687-49.2° amps and
         i3 = 0.561199.3° amps.

         The current through the 15  resistor is i3, so that much is done. Regarding
         vb, it can be found using Ohm's law as vb is the series connection of the 6 
         resistor and j8  inductor times the current through them. This current is the
         pair of meshing currents i1 and i2. Assuming the reference polarity for vb is
         positive, that is the direction of i1, and thus the net current must be i1 - i2.
         The result is 0.37565.8° amps. Therefore, vb = 3.75119° volts. To
         crosscheck this, we can subtract the voltage across the 20  resistor from E1.
         That's 100° volts minus 20  times 0.6131-15.5° amps, or 3.75119°
         volts, as expected.

230
Supermesh

On occasion you may find a current source which has no associated internal
impedance, such as the one in the circuit of Figure 6.29. This is similar to the
situation discussed previously with nodal analysis where a voltage source does not
have a specified internal impedance. As with nodal, there are two ways of solving
this predicament. The first technique is to add a very large impedance in parallel
with the current source and then perform a source conversion on the pair so that the
inspection method of mesh can be used. The larger the value of this impedance, the
greater the accuracy. As a general rule it should be at least a couple of orders of
magnitude larger than any surrounding impedance, and preferably larger. The second
technique is to use supermesh. A supermesh is a larger mesh loop than contains other
mesh loops inside of it.

Refer to the circuit shown in Figure 6.29. In the center we have a current source, Is,
which lacks an associated internal impedance. Two traditional mesh loops, i1 and i2,
are labeled as usual. The problem here is that we cannot use an Ohm's law-based iZ
voltage drop for vb. We have no way to express this as the voltage across Is is an
unknown. On the other hand, what we do know is that Is must equal the combination
of the original mesh currents i1 and i2. That is, from the perspective of the first loop,
Is = i2 - i1. Remember, one or both of the mesh currents could be negative, and thus
rotating counterclockwise.

                                                                                                                   Figure 6.29
                                                                                                                   Circuit for supermesh.

At this point we invoke the idea of a supermesh loop. First, we replace the
problematic current source with its ideal internal impedance, an open. Second, a
supermesh loop is drawn which encompasses the original two loops. This is shown
in Figure 6.30. The supermesh loop is shown in red and labeled.

                                                                                                                   Figure 6.30
                                                                                                                   Supermesh labeled.

231
We now perform a KVL summation around the supermesh loop, similar to what we
have done in prior work. The difference this time around is that we need to
recognize that components each see one of the original mesh currents; namely i1 or
i2 here. We do not solve for a supermesh current. Instead, we just use the supermesh
loop to define the KVL summation. The summation follows:

      v rises =  vdrops
         E1 = v R+v XL+ E2

The voltage drops across the resistor and inductor can be expanded using Ohm's law,
using the original mesh current associated with each component.

     E1 -E 2 = i1 R +i2 jX L

Also, by inspection,

     I s = i2 -i1 or
     i2 = i1 +I s

We now have two equations with two unknowns and can solve for i1 and i2. This
procedure is illustrated in the following example.

Example 6.10                                                                          Figure 6.31
                                                                                      Circuit for Example 6.10.
         Find vb for the circuit of Figure 6.31. E1 = 200° volts, E1 = 1890° volts
         and IS = 10E-30° amps.

     First, we label the loops, as shown in Figure 6.32.

     Now we perform a KVL summation around the supermesh loop.

           v rises =  vdrops
     20  0 ° V = vR +v XL+18 90° V

     Expand using Ohm's law and rearrange:

     20  0 ° V -18 90 ° V = 1 k i1+j 400 i2
               26.9  -42 ° V = 1 k i1+j 400 i2

232
By inspection we can see that:                                                            Figure 6.32
                                                                                          Circuit of Figure 6.31 with
            10E-3 0 ° A = i2 -i1 or                                                       supermesh labeled.
                          i2 = i1 +10E-3 0 ° A

We can substitute this expression into the prior supermesh
expression and solve for i1:

              26.9  -42° V = 1 k i1+ j 400i2
              26.9  -42° V = 1 k i1+ j 400(i1+10E-3 0 ° A)
              26.9  -42° V = 1 k i1+ j 400i1+4  90° V
            29.7 -44.7° V = (1 k + j 400 )i1

                               i1  27.6E-3  -69.5° A

Thus, i2 = 27.6E-3-69.5° amps + 10E-30° amps, or 32.5E-3-52.8°
amps. To determine vb we simply subtract the drop across the 1 k resistor
from E1:

            vb = 20  0 ° V - i1 1 k 
            vb = 20  0 ° V - 27.6E-3 -69.5 ° A1 k 
            vb  27.85  68.2 ° V

As a crosscheck, we could also add the voltage across the inductor to E2:

            vb = 18 90° V +i2 j 400
            vb = 18 90° V +32.5E-3 -52.8° A j 400 
            vb 27.85  68.2° V

Comparison of Nodal and Mesh

Having covered both nodal and mesh in some detail, it is fair to look at the two
techniques to gauge their strengths and weaknesses. Compared to nodal analysis,
mesh analysis has the advantage of dealing with impedances rather than admittances
when writing the system of equations. Further, the mesh inspection method works
with voltage sources, which tends to be convenient for many circuits, while the
nodal inspection method requires current sources. On the down side, the resulting set
of mesh currents requires further processing in order to find either branch currents or
node voltages. In contrast, nodal analysis produces node voltages directly with no
further processing. Mesh also has the disadvantage of being limited to planar circuits
while there is no such limit to nodal. Ultimately, instead of thinking in terms of
which technique is "better" overall, it is more efficient to use the proper tool for the
job at hand. For example, if a circuit is populated with voltage sources, mesh might
be the more efficient route, especially if specific currents are desired. On the other

233
hand, if you need to find voltages in a circuit that contains numerous current
sources, nodal would be more effective.

6.4 Dependent Sources

A dependent source is a current or voltage source whose value is not fixed. Instead,
the value depends on some other circuit current or voltage. The general form for the
value of a dependent source is N = kM where M and N are currents and/or voltages
and k is the proportionality constant. For example, the value of a dependent voltage
source may be a function of a current, so instead of the source being equal to, say, 10
volts, it could be equal to twenty times the current passing through a particular
resistor, or v = 20i.

There are four possible dependent sources: They are the voltage-controlled voltage
source (VCVS), the voltage-controlled current source (VCCS), the current-controlled
voltage source (CCVS), and the current-controlled current source (CCCS). The
source and control parameters are the same for both the VCVS and the CCCS so k has
no units, although it may be given as volts/volt and amps/amp, respectively. For the
VCCS and CCVS, k has units of amps/volt and volts/amp, respectively. These are
referred to as the transresistance and transconductance of the sources with units of
ohms and siemens.

The schematic symbols for dependent or controlled sources are usually drawn using
a diamond instead of a circle. Also, for simulators, there will be a secondary
connection for the controlling current or voltage. Examples of voltage-controlled
and current-controlled sources are shown in Figure 6.33. On each of these symbols,
the control element is shown to the left of the source.

                                                                                                                   Figure 6.33
                                                                                                                   Dependent source symbols as
                                                                                                                   used in common simulators (left
                                                                                                                   to right): VCVS, CCVS, VCCS,
                                                                                                                   and CCCS.

The control portion can be thought of as a connection for a voltmeter or ammeter      Figure 6.34
which senses the control parameter. These sensing connections are not always          Generic symbols for
drawn on a schematic. Instead, the source simply may be labeled as a function, as     dependent voltage source (left)
in v = 0.02 iX where iX is the controlling current. These simpler controlled sources  and current source (right).
are shown in Figure 6.34 and are typical in electronic schematics and texts. In some
cases, these sources are drawn with a circle instead of a diamond. Also, the sine
wave shape shown here is often omitted from the inside of symbol, however, current
sources are always drawn with an arrow pointing in the reference direction and
voltages sources always include the reference polarity.

234
Dependent sources are not "off-the-shelf" items in the same way that a battery or
signal generator are. Rather, dependent sources are used to model the behavior of
more complex devices. For example, a bipolar junction transistor commonly is
modeled as a CCCS while a field effect transistor may be modeled as a VCCS.
Similarly, many amplifier circuits are modeled as VCVS systems. Solutions for
circuits using dependent sources follow along the lines of those established for
independent sources (i.e., the application of Ohm's law, KVL, KCL, etc.), however,
the sources are now dependent on the remainder of the circuit which tends to
complicate the analysis. In general, there are two possible circuit configurations for
dependent sources: isolated and coupled. An example of the isolated form is shown
in Figure 6.35.

                                                                                                                   Figure 6.35
                                                                                                                   Dependent source circuit:
                                                                                                                   isolated.

In this example, the dependent source (center, a CCVS) does not interact with the
sub-circuit on the left driven by the independent source E. Thus it can be analyzed as
two separate circuits as shown in Figure 6.36.

                                                                                                                   Figure 6.36
                                                                                                                   Dependent source circuit:
                                                                                                                   isolated treated as two circuits.

Solutions for this form are relatively straightforward. The control value for the
dependent source can be computed directly using standard techniques. Then this
value is substituted into the dependent source and the analysis continues as normal.
Sometimes it is convenient if the solution for a particular voltage or current is
defined in terms of the control parameter rather than as a specific value (e.g., the
current through a particular component might be 75 i1 instead of just 1 milliamp).

The second type of circuit (coupled) is somewhat more complex in that the
dependent source can affect the parameter that controls the dependent source. An
example is shown in Figure 6.37.

235
                                                                                          Figure 6.37
                                                                                          Dependent source circuit:
                                                                                          coupled.

In this example it should be obvious that the voltage from the dependent source can
affect the voltage at node a, and it is this very voltage that defines ix, which in turn
sets up the value of the dependent source. As far as analysis is concerned, either
mesh or nodal can be used. The dependent source(s) will contribute terms that
include the controlling parameter(s) so some additional effort will be required. To
illustrate the technique, consider the circuit of Figure 6.38. We shall use the general
method of nodal analysis.

We begin by defining current directions. Assume that the currents through R1 and C        Figure 6.38
are flowing into node a, the current through R2 is flowing out of node a, and the         Circuit with a voltage-
current through L is flowing out of node b. We shall number the branch currents to        controlled current source.
reflect the associated components, from left to right. The resulting KCL
equations are:

            iin =  iout
     Node a : i1 +i3 = i2
     Nodeb : k va = i3 +i4

The currents are then described by their Ohm's law equivalents:

     Node a : E-v a + v b-va = va
                  R1 - jX C R2

     Node b : k v a = v b-va + vb
                         R2  jX L

Expanding terms yields:

     Node a : E - va + vb - va = v a
                R1 R1 - jX C - jX C R2

     Node b : k va = vb - va + v b
                        R2 R2 jX L

236
Collecting terms and simplifying yields:

              ( ) Node a : E = 1 + 1 + 1 va - 1 vb
              R1 R1 R2 - jX C             - jX C

              ( ) ( ) Nodeb:
              0 =- k + 1 va + 1 + 1 vb
              R2                          R2 jX L

At this point, the component values and independent source value would be inserted
into the equations and the system solved.

Finally, referring back to the prior chapter, it is possible to perform source
conversions on dependent sources, within limits. The new source will remain a
dependent source (e.g., VCVS to VCCS). This process is not applicable if the control
parameter directly involves the internal impedance (i.e., is its voltage or current).

Example 6.11

For the circuit shown in Figure 6.39, determine vc if the source is 10° volt
peak.

                                                                                       Figure 6.39
                                                                                       Circuit for Example 6.11.

         This is an example of the isolated or uncoupled dependent source. The value
         of the dependent current source is 30 times the value of the current labeled
         ix, which is the current flowing through the -j2 k capacitive reactance. We
         can find this current first and then determine the resulting value of the
         dependent source. The analysis will require nothing beyond basic series-
         parallel techniques. We will number the components from left to right.

         The current ix is found via Ohm's law:

                     ix = E
                           - jX C1

                     ix = 1  0 ° V - j 2 k 
                     ix = 0.5E-3  90 ° A

237
         The dependent source is 30 times this value, or 15E-390° amps. Given the
         reference direction of this source, the current is flowing upwards through the
         65 k resistor and parallel -j50 k capacitor. This establishes vc as
         negative. Multiplying ix by the parallel impedance yields the desired voltage.

                      Z RC = R3× jX C2
                               R3 - jX C2

                      Z RC = 65k ×(- j 50 k ) 65 k  - j 50 k 
                      Z RC = 39.6E3 -52.4 ° 
                     v c = -ix×Z RC
                     v c =-15E-3 90° ×39.6E3 -52.4° 
                     v c = 594 -142.4 ° V

The next example features a coupled configuration solved using nodal analysis.
Example 6.12

         In the circuit of Figure 6.40, determine va. E =200° volts peak at 50 kHz.

                                                                                                                   Figure 6.40
                                                                                                                   Circuit for Example 6.12.

         In this circuit we have a current controlled voltage source, or CCVS. The
         proper unit for the constant of 1000 is ohms (volts over amps). First, we
         need to determine the reactance value for the inductor.

                      X L = 2 f L
                      X L = 2  50 kHz 4 mH
                      X L = j 1257 
         There is only one node of interest here (a) so we will only need one KCL
         equation. The sole unknown is va. Let's assume that the reference directions
         of the currents flowing through the 1 k and 3 k resistors are entering
         node a. We'll call these i1 and i2, respectively. The exiting current is ix.

238
     The KCL summation is:

       iin =  iout
     i1+i2 = i x

     This is expanded using Ohm's law (in several steps, for clarity).

     ix = i1+i2

     va = E -v a + 1000 ()i x-va
     R2 R1+ jX L            R3

     va = 20  0 ° V-v a + 1000 ()i x-va
     2 k  1 k + j 1257                       3k

        20  0 ° V = va + v a + va -1000 ()i x
     1 k + j 1257  1 k + j 1257  2 k  3 k  3 k 

     12.45 -51.5 ° A = v a + va + va - 1000()va
                              1 k + j 1257  2 k  3 k  2 k ×3 k 

     12.45 -51.5° A = v a + va + v a - v a
                              1 k + j 1257  2 k  3 k  6 k 

     ( ) 12.45 -51.5° A = 1 1 k + j 1257 + 1 2 k  + 1 3 k  - 1 6 k  va

     12.45 -51.5 ° A = 1.161E-3 -24.8° S va

     va = 10.7 -26.7° V

Computer Simulation

For verification, the dependent source circuit of Example 6.12 is entered into a
simulator as shown in Figure 6.41. The results are shown in Figure 6.42.

                                                                                  Figure 6.41
                                                                                  Circuit of Figure 6.40 in a
                                                                                  simulator.

239
Note the connection to sense the current ix. It is inserted just like an ammeter. As
mentioned previously, the constant for the dependent source is a transresistance and
has units of ohms. A transient analysis is run the circuit, plotting the independent
source, E, as node 1 (blue), and va as node 3 (red). Both the amplitude and lagging
phase shift line up nicely with the computed result. The voltage of the dependent
source is also plotted as node 5 (green). Verifying this potential is left as an exercise.

                                                                                                                   Figure 6.42
                                                                                                                   Transient analysis for the
                                                                                                                   circuit of Figure 6.41.

6.5 Summary

Nodal analysis can be used to solve virtually any complex multi-source AC electrical
circuit. It is based on KCL, writing expressions involving each node in the circuit. A
system of equations results, there being as many equations as there are nodes in the
circuit, minus the reference node (typically taken as ground). The set of equations
will exhibit diagonal symmetry, which can be used as a crosscheck before setting out
to solve them. The solution will be a complete set of node voltages. From these, any
branch current may be determined as needed.
There are two different methods of creating the system of equations. The first
method is deemed the general method and will work for a mix of current sources and
voltage sources. Individual currents are defined based on the node voltages and any
known current sources. KCL is then applied at each node, followed by simplification

240
and combination of terms to arrive at the end equations. The second approach is
referred to as the inspection method. If the circuit contains only current sources (or if
the voltage sources are converted to equivalent current sources), this method allows
direct generation of the system of equations without the need for simplification and
thus is less prone to error.

Mesh analysis can be used to solve any planar complex multi-source AC electrical
circuit. In some respects it is the mirror of nodal analysis. It is based on KVL,
writing expressions involving each closed loop in the circuit. The loops are
minimally sized and the set of loops must cover every component in the circuit. A
system of equations results, there being as many equations as there are loops. As
with nodal analysis, the set of equations will exhibit diagonal symmetry. The
solution will be a complete set of mesh currents. From these, any branch current and
node voltage may be determined.

Like nodal, mesh offers two different methods of creating the system of equations.
The general method will work for a mix of current sources and voltage sources.
Individual loops are defined based on the meshing currents passing through each
component. KVL is then applied around each loop, followed by simplification and
combination of terms to arrive at the end equations. In contrast, if the circuit
contains only voltage sources (or if the current sources are converted), then the
inspection method may be used. This method allows direct generation of the system
of equations and is faster and less error prone.

Dependent sources are current or voltage sources whose value depends on the
current or voltage developed in some other part of the circuit. There are four types:
current controlled current source (CCCS), current controlled voltage source (CCVS),
voltage controlled current source (VCCS) and voltage controlled voltage source
(VCVS). These sources are used commonly to model the characteristics of active
devices such bipolar and field effect transistors. Techniques for solution tend to be a
bit more involved than when using constant sources, however, nodal analysis in
particular tends to work well.

Review Questions

    1. Describe the practical differences between nodal analysis and mesh analysis.
    2. What is diagonal symmetry? Of what use is it?
    3. What are the differences between the general method and the inspection

         method of nodal analysis?
    4. What are the differences between the general method and the inspection

         method of mesh analysis?
    5. What is a supernode?
    6. What is a supermesh?
    7. Describe the concept of dependent sources and how they differ from

         independent or constant sources.

241
6.6 Exercises

Analysis (All source values are in amps or volts unless specified otherwise)

    1. Given the circuit in Figure 6.43, use nodal analysis to determine vc.
         I1 = 30°, I2 = 0.90°.
                                                                                Figure 6.43

    2. Use nodal analysis to find the current through the 120  resistor in the
         circuit of Figure 6.44. I1 = 0.590°, I2 = 1.60°.

    3. Use nodal analysis to find the current through the 43  resistor in the circuit
         of Figure 6.44. The sources are in phase.
                                                                                Figure 6.44

    4. Given the circuit in Figure 6.44, use nodal analysis to determine vb. The
         sources are in phase.

    5. Given the circuit in Figure 6.45, determine vc. I1 = 30°, I2 = 20°.
                                                                                Figure 6.45

242
    6. Use nodal analysis to find the current through the j45  inductor in the
         circuit of Figure 6.45. I1 = 20°, I2 = 1.560°.

    7. Use nodal analysis to find the current through the 4  resistor in the circuit
         of Figure 6.46. I1 = 145°, I2 = 245°.
                                                                                Figure 6.46

    8. Given the circuit in Figure 6.46, use nodal analysis to determine vc.
         I1 = 630°, I2 = 40°.

    9. Given the circuit in Figure 6.47, use nodal analysis to determine vac.
         I1 = 100°, I2 = 60°.
                                                                                Figure 6.47

    10. Use nodal analysis to find the current through the j8  inductor in the circuit
         of Figure 6.47. I1 = 30°, I2 = 530°.

    11. Use nodal analysis to find the current through the 22  resistor in the circuit
         of Figure 6.48. I1 = 800E-30°, I2 = 2.50°, I3 = 220°.
                                                                                Figure 6.48

243
    12. Given the circuit in Figure 6.48, use nodal analysis to determine vc.
         I1 = 490°, I2 = 10120°, I3 = 50°.

    13. Given the circuit in Figure 6.49, use nodal analysis to determine vc.
         I1 = 3E-30°, I2 = 10E-30°, I3 = 2E-30°.
                                                                                Figure 6.49

    14. Use nodal analysis to find the current through the -j2 k capacitor in the
         circuit of Figure 6.49. I1 = 1E-30°, I2 = 5E-30°, I3 = 6E-3-90°.

    15. Use nodal analysis to find the current through the 3.3 k resistor in the
         circuit of Figure 6.50. E = 360°, I = 4E-3-120°.
                                                                                Figure 6.50

    16. Given the circuit in Figure 6.50, write the node equations and determine vc.
         E = 180°, I = 7.5E-3-30°.

    17. Given the circuit in Figure 6.51, use nodal analysis to determine vc.
         E = 40180°, I = 20E-30°.
                                                                                Figure 6.51

244
    18. Use nodal analysis to find the current through the 2.2 k resistor in
         Figure 6.51. E = 2400°, I = 100E-30°.

    19. Use nodal analysis to find vbc in the circuit of Figure 6.52.
                                                                                Figure 6.52

    20. Use nodal analysis to find the current through the 2.7 k resistor in the
         circuit of Figure 6.53.
                                                                                Figure 6.53

    21. Given the circuit in Figure 6.54, use nodal analysis to determine vba.
         E1 = 10°, E2 = 20°.
                                                                                Figure 6.54

245
    22. Given the circuit in Figure 6.55, use nodal analysis to determine vad.
         E1 = 90°, E2 = 540°.
                                                                                Figure 6.55

    23. Use nodal analysis to find vcb in the circuit of Figure 6.56. E1 = 10-180°,
         E2 = 250°.
                                                                                Figure 6.56

    24. Given the circuit in Figure 6.57, use nodal analysis to determine vbc.
         E = 200°, R1 = 10 k, R2 = 30 k, R3 = 1 k, XC = -j15 k,
         XL = j20 k.
                                                                                Figure 6.57

246
    25. Given the circuit in Figure 6.58, write the mesh loop equations and
         determine vb.
                                                                                Figure 6.58

    26. Use mesh analysis to find the current through the 2.7 k resistor in the
         circuit of Figure 6.58.

    27. Use mesh analysis to find the current through the 75  resistor in the circuit
         of Figure 6.52.

    28. Given the circuit in Figure 6.52, write the mesh loop equations and
         determine vc.

    29. Given the circuit in Figure 6.53, write the mesh loop equations and
         determine vb.

    30. Use mesh analysis to find the current through the 1.8 k resistor in the
         circuit of Figure 6.53.

    31. Use mesh analysis to find the current through the j200  inductor in
         Figure 6.54. E1 = 10°, E2 = 20°.

    32. Given the circuit in Figure 6.54, write the mesh loop equations and
         determine vb. Consider using parallel simplification first. E1 = 36-90°,
         E2 = 24-90°.

    33. Given the circuit in Figure 6.55, use mesh analysis to determine vcd.
         E1 = 0.10°, E2 = 0.50°.

    34. Use mesh analysis to find the current through the 600  resistor in the
         circuit of Figure 6.55. E1 = 90°, E2 = 540°.

247
    35. Use mesh analysis to find the current through the -j200  capacitor in the
         circuit of Figure 6.59. E1 = 180°, E2 = 1290°.
                                                                                Figure 6.59

    36. Given the circuit in Figure 6.59, use mesh analysis to determine vac.
         E1 = 10°, E2 = 500E-30°.

    37. Given the circuit in Figure 6.56, use mesh analysis to determine vc.
         E1 = 10-180°, E2 = 250°.

    38. Use mesh analysis to find the current through the 22 k resistor in the
         circuit of Figure 6.56. E1 = 240°, E2 = 360°.

    39. Use mesh analysis to find the current through the j300  inductor in
         Figure 6.60. E1 = 10°, E2 = 1090°.
                                                                                Figure 6.60

    40. Given the circuit in Figure 6.60, use mesh analysis to determine va.
         E1 = 1000°, E2 = 900°.

    41. Given the circuit in Figure 6.57, use mesh analysis to determine vbc.
         E = 100°, R1 = 1 k, R2 = 2 k, R3 = 3 k, XC = -j4 k, XL = j8 k.

    42. Use mesh analysis to find the current through resistor R3 in the circuit of
         Figure 6.57. E = 200°, R1 = 10 k, R2 = 30 k, R3 = 1 k, XC = -j15 k,
         XL = j20 k.

248
    43. Use mesh analysis to find the current through resistor R3 in Figure 6.61.
         E = 600°, R1 = 1 k, R2 = 2 k, R3 = 3 k, XC = -j10 k, XL = j20 k.
                                                                                Figure 6.61

    44. Given the circuit in Figure 6.61, use mesh analysis to determine vbc.
         E = 12090°, R1 = 100 k, R2 = 20 k, R3 = 10 k, XC = -j5 k,
         XL = j20 k.

    45. Given the circuit in Figure 6.62, use mesh analysis to determine vb. Consider
         using source conversion. E = 120°, I = 10E-30°.
                                                                                Figure 6.62

    46. Use mesh analysis to find the current through the 3  resistor in the circuit
         in Figure 6.62. Consider using source conversion. E = 1590°,
         I = 10E-30°.

    47. Use mesh analysis to find the current through the 2.2 k resistor in the
         circuit in Figure 6.63. E = 3.30°, I = 2.1E-30°.
                                                                                Figure 6.63

    48. Given the circuit in Figure 6.63, use mesh analysis to determine vb.
         E = 100°, I = 30E-390°.

249
    49. Given the circuit in Figure 6.64, use nodal analysis to determine vab.
                                                                                Figure 6.64

    50. Use nodal analysis to find the current through the 100 mH inductor in the
         circuit of Figure 6.64.

    51. Use nodal analysis to find the current through the 330  resistor in the
         circuit of Figure 6.65.
                                                                                Figure 6.65

    52. Given the circuit in Figure 6.65, write the node equations and determine vb.
    53. Given the circuit in Figure 6.61, use nodal analysis to determine vbc.

         E = 1200°, R1 = 1 k, R2 = 2 k, R3 = 3 k, XC = -j10 k,
         XL = j20 k.
    54. Determine the current through the 10 k resistor in the circuit of
         Figure 6.66 if I1 = 10E-3-90°.

                                                                                Figure 6.66

    55. Determine vb in the circuit of Figure 6.66 if the source I1 = 20E-30°.
250
    56. Determine vc in the circuit of Figure 6.67 if the source E = 3120°.
                                                                                Figure 6.67

    57. Determine the current through the 5 k resistor in the circuit of Figure 6.67
         if E = 100°.

    58. In the circuit of Figure 6.68, determine the capacitor current if the source
         E = 120°.
                                                                                Figure 6.68

    59. In the circuit of Figure 6.68, determine vc if the source E = 890°.
    60. In the circuit of Figure 6.69, determine vb if the source E = 12-90°.

                                                                                Figure 6.69

    61. In the circuit of Figure 6.69, determine the current flowing into the 1 k
         resistor if the source E = 60°.

251
    62. In the circuit of Figure 6.70, determine the current flowing into the 600 
         resistor if I1 = 1E-3180°.
                                                                                Figure 6.70

    63. Determine va and vb in the circuit of Figure 6.70 if the source I1 = 2E-30°.
    64. Determine va in the circuit of Figure 6.71 if the source E = 20°.

                                                                                Figure 6.71

    65. Given the circuit in Figure 6.71, determine the current flowing through the
         1 k resistor. Assume that E = 1545°.

    66. Given the circuit in Figure 6.72, determine the current flowing through the
         3 k resistor if the source E = 2533°.
                                                                                Figure 6.72

    67. Given the circuit in Figure 6.72, determine vab. Assume the source
         E = 15-112°.

252
68. In the circuit of Figure 6.73, determine vd.

                                                  Figure 6.73

    69. Given the circuit in Figure 6.73, determine the current flowing through the
         1 k resistor.

    70. Given the circuit in Figure 6.74, determine the current flowing through the
         100  resistor.
                                                                                Figure 6.74

    71. Determine vd in the circuit of Figure 6.74.
    72. Determine vab in the circuit of Figure 6.75. E = 100°

                                                                                Figure 6.75

253
Challenge

    73. Given the circuit in Figure 6.76, write the node equations. E1 = 500°,
         E2 = 35120°, I = 500E-390°.
                                                                                Figure 6.76

    74. Given the circuit in Figure 6.76, use either mesh or nodal analysis to
         determine ved. E1 = 90°, E2 = 120°, I = 50E-30°.

    75. Given the circuit in Figure 6.77, use mesh analysis to determine vfc.
         E1 = 120°, E2 = 480°, E3 = 3670°.
                                                                                Figure 6.77

254
    76. Find voltage vbc in the circuit of Figure 6.78 using either mesh or nodal
         analysis. E = 1000°, R1 = R2 = 2 k, R3 = 3 k, R4 = 10 k, R5 = 5 k,
         XC1 = XC2 = -j2 k.
                                                                                Figure 6.78

    77. Given the circuit in Figure 6.79, use nodal analysis to find vac.
         I1 = 8E-30°, I2 = 12E-30°, E = 500°.
                                                                                Figure 6.79

255
    78. Given the circuit in Figure 6.80, use nodal analysis to determine vad.
         I1 = 0.10°, I2 = 0.20°, I3 = 0.30°.
                                                                                Figure 6.80

    79. Given the circuit in Figure 6.81, determine vad. E1 = 150°, E2 = 60°,
         I = 100E-30°.
                                                                                Figure 6.81

    80. Given the circuit in Figure 6.82, determine vad. E1 = 220°, E2 = -100°,
         I = 2E-30°.
                                                                                Figure 6.82

256
    81. Given the circuit in Figure 6.83, determine vab. I1 = 1.20°, I2 = 2120°,
         E = 750°.
                                                                                Figure 6.83

    82. Given the circuit in Figure 6.84, determine vad. I1 = 0.80°, I2 = 0.2180°,
         I3 = 0.10°, E = 150°.
                                                                                Figure 6.84

Simulation

    83. Perform a transient analysis simulation on the circuit of problem 25
         (Figure 6.58) to verify the results for vb.

    84. Investigate the variation of vb due to frequency in problem 25 (Figure 6.58)
         by performing an AC simulation. Run the simulation from 10 Hz up to
         100 kHz.

    85. Investigate the variation of vb due to component tolerance in problem 25
         (Figure 6.58) by performing a Monte Carlo simulation. Apply a 10%
         tolerance to the resistors and capacitor.

    86. Perform a transient analysis simulation on the circuit of problem 28
         (Figure 6.52) to verify the results for vc.

257
    87. Investigate the variation of vb due to frequency in problem 28 (Figure 6.52)
         by performing an AC simulation. Run the simulation from 1 Hz up to
         10 kHz.

    88. Investigate the variation of vb due to component tolerance in problem 28
         (Figure 6.52) by performing a Monte Carlo simulation. Apply a 10%
         tolerance to the resistors and capacitors.

258
Notes

                                                                                                                                    
259
7 AC Power

After completing this chapter, you should be able to:

    · Describe current, voltage and power relationships in AC RLC networks.
    · Plot and make use of the power triangle to determine real, apparent and reactive power components in

         an AC power system.
    · Compute the power factor of an RLC network.
    · Determine necessary components for basic power factor correction.
    · Perform basic power calculations for systems involving power factor and efficiency.

7.1 Introduction

This chapter introduces the concept of power and power waveforms in AC systems. This is an important part of
AC circuit analysis and turns out to have striking differences compared to the DC counterpart. While it remains
true that power is the product of current and voltage, a naive application of that definition can lead to erroneous
conclusions for the AC case. In Chapter One, RMS (i.e., root-mean-square) values were defined and explained.
As a general rule, RMS values are used for power calculations, not peak or peak-to-peak values. Further, while
complex non-sinusoidal waveshapes are a decided possibility in electronic systems, we shall limit ourselves here
to sinusoids.

One of the tools we shall use is the power triangle. This is a simple trigonometric device designed to illustrate
the power relations between resistive and reactive components in a complex impedance. One of its parameters is
the power factor, PF. As we shall see, ordinarily we like the power factor to be unity as this implies best use of
the available current. It turns out that this is not the case in many systems. As a consequence, we shall also
investigate a simple means of compensating or shifting the power factor back to unity. This is known as power
factor correction.

As part of our discussion involving power factor, we shall examine typical applications such as motors. Here we
shall consider the power factor of a motor along with its efficiency. The efficiency is defined as the useful output
power relative to the supplied power and is always less than 100%. Finally, we shall consider basic power factor
correction for this application.

One practical item to remember here is that, while the instantaneous power changes over time due to the
sinusoidal cycling of the voltage and current, what matters to most electrical and electronic devices is the
production of internal heat. Devices such as resistors, transistors and so forth, have mass, and thus exhibit a
thermal time constant. That time constant tends to be much longer than the period of the wave. The effect is an
averaging of the power waveform. In other words, components do not heat up and cool down instantaneously,
any more than a hot fry pan would drop to room temperature the moment it was removed from its burner.

260
7.2 Power Waveforms

Computation of power in AC systems is somewhat more involved than the DC case
due to the phase between the current and voltage. It has been stated in prior work
that power dissipation is characteristic of resistors, and that ideal inductors and
capacitors do not dissipate power. We shall show precisely why this is the case by
examining three distinct cases for AC circuits: purely resistive, purely reactive and
complex impedance.

Resistive Load

First, consider the case of the purely resistive load, that is, a load with a phase angle
of 0 degrees. To determine the power, we simply multiply the voltage by the current.
Recall that the basic expression for a sine wave voltage without a DC offset is:

                      v (t )=V sin (2  f t +)

         Where
         v(t) is the voltage at some time t,
         V is the peak value,
         f is the frequency,
          is the phase shift.

We know that the current and voltage are always in phase for a resistor, and thus  is
zero degrees. Thus, the expression for a sinusoidal current is similar, using I in place
of V for the peak current. We multiply the current and voltage together to arrive at an
expression for power:11

            P (t )=v (t)×i (t )
            P (t )=V sin (2  ft )×I sin (2  ft )

    ( ) P (t )=VI 12 - 12 cos(2  2 ft )

            P (t )= VI2 - VI2 cos (2  2 ft ) (7.1)

The final expression is made of two parts; the first portion which is fixed (not a
function of time) and the second portion which consists of a negative cosine wave at
twice the original frequency. This can be visualized as a time shifted sine wave that
is riding on a DC level which is equal to the peak value of the new sinusoid. This is
shown in Figure 7.1 using current and voltage peaks normalized to unity. In this
figure, the current waveform (green) is drawn just slightly above its true value so
that it may be seen easily next to the otherwise identical red voltage waveform.

11 A useful trigonometric identity here is (sin x)2 = ½ - ½ cos 2x

261
The power product is shown in blue. Unless the frequency is ridiculously low, the
resistor's heating will respond to the average value of this waveform thanks to the
device's thermal time constant. Due to the fact that sinusoids are symmetrical around
zero, the effective power dissipation averaged over time will be the offset value, or
VI/2. For example, a one volt peak source delivering a current of one amp peak, as
shown here, should generate VI/2, or 0.5 watts. This crosschecks nicely with the RMS
calculation of roughly 0.707 volts RMS times 0.707 amps RMS also yielding 0.5
watts.

      1.2         AC Power - Resistive
      1.0
      0.8         Current                                    Figure 7.1
      0.6                                                    Waveforms for a resistive load
      0.4                               Power                 (the current is shifted slightly
      0.2                                                     positive to ease viewing).
      0.0              Voltage
     -0.2                                           1
     -0.4    0.2  0.4            0.6           0.8
     -0.6
     -0.8
     -1.0

          0

                           Time

Reactive Load

The situation is considerably different if the load is purely reactive. For a load
consisting of just an inductor, the voltage leads the current by 90 degrees. This is
equivalent to a cosine wave. Once again, we multiply the voltage by the current to
arrive at an expression for power:

            P (t )=V cos 2  ft ×I sin 2  ft

    ( ) P (t )=VI 12 sin 2 2 ft

            P (t )= VI sin 2  2 ft (7.2)
                     2

262
Note that this expression does not contain a constant term and only contains a time-
varying term. Consequently, without an offset, there is no net power dissipation. The
result is shown in Figure 7.2. Here power is being alternately generated and
dissipated (i.e., positive values indicate dissipation while negative values indicate
generation). In this respect, the reactive element can be thought of as alternately
storing and releasing energy in the manner of an ideal spring being compressed and
then released.

      1.0                   AC Power - Reactive                                        Figure 7.2
      0.8                                                                              Waveforms for a purely reactive
      0.6                                         Current                              load.
      0.4    Voltage
      0.2                                                       Power
      0.0
     -0.2       0.2     0.4                       0.6      0.8                     1
     -0.4
     -0.6
     -0.8
     -1.0

          0

                             Time

Complex Impedance Load

Finally, we come to the case of a complex load, part resistive and part reactive.
Given some phase angle, , we have:

             P (t )=V sin 2  ft ×I sin (2  ft +)

             ( ) P (t )=VI 12 cos - 12 cos(2 2 ft +)

             P (t )= VI cos  - VI cos (2  2 ft +) (7.3)
             2       2

This expression contains both a constant term and a time varying term, like the case
for the purely resistive load shown in Equation 7.1. There is, however, an important
distinction. The constant term is multiplied by the cosine of the impedance angle, a

263
value whose magnitude ranges from 0 up to 1. Therefore, unless  is zero, the offset
will not equal the peak value of the sinusoidal portion. This is a particularly
important point which shall be amplified in a moment.

Example waveforms using  = 45° are shown graphically in Figure 7.3. The power
waveform dips slightly below zero but is not symmetrical around the time axis.
Consequently, there is some power dissipation but not as much as in the purely
resistive case. In short, the long term power average is now a function of the phase
angle, . As cosine  may range between 0 and 1, the power for the complex
impedance case will never be more than that of the purely resistive version. Indeed,
we can see that Equation 7.3 is the general case. If the load is purely resistive then 
is zero, and Equation 7.3 reduces to Equation 7.1. Similarly, if the load is purely
reactive then  is ±90 degrees, and Equation 7.3 reduces to Equation 7.2.

While this analysis used an inductive load, the same can be said regarding the
capacitive case (simply swap the labels for the current and voltage waveforms).
Finally, in the equations above, V and I are peak values. If RMS values are used,
there is no need to divide VI by 2.

      1.0             AC Power - Complex
      0.8
      0.6    Voltage       Current                        Figure 7.3
      0.4                                                 Waveforms for a complex
      0.2    0.2      0.4        0.6      Power            impedance load.
      0.0                                 0.8
     -0.2                                        1
     -0.4
     -0.6
     -0.8
     -1.0

          0

                           Time

264
At this point we can see that resistors dissipate true power but that reactive
components do not. This raises a practical problem, namely, what to call the current-
voltage product for purely reactive or complex loads. That is, we can't lump together
the current-voltage values for an inductor with those of a resistor any more than we
would simply add the magnitudes of resistance and reactance. The practical solution
is that we refer to the "power" in reactive components as reactive power. Reactive
power uses the symbol Q. Further, the units are not watts, but volt-amps reactive, or
more commonly, VAR12. Continuing, for a complex impedance we refer to apparent
power. It uses the symbol S and has units of volt-amps, abbreviated VA. It is called
apparent power because it appears to be the power if you naively multiply the value
obtained from a voltmeter by the value obtained from an ammeter. Those devices
would not account for the phase angle between the voltage and current, unlike a
proper power meter, and their product would not be the true power. The various
power terms are summarized in Figure 7.4.

    Quantity    Symbol     Unit, Abbreviation                                             Figure 7.4
      Power        P             watts, W                                                 Symbols and units for power
Apparent Power     S                                                                      quantities.
Reactive Power     Q          volt-amps, VA
                        volt-amps reactive, VAR

A few examples are in order to help solidify these concepts.                              Figure 7.5
                                                                                          Circuit for Example 7.1.
Example 7.1

         Determine the power dissipated by the resistor in the circuit of Figure 7.5.
         Also find the apparent power drawn by the circuit and the reactive power
         of the inductor. The source frequency is 1 kHz.

         The first item is to find the reactance of the inductor.

                      X L= 2 f L
                      X L = 2  1 kHz 1 mH
                      X L = j 6.283 

         There are several ways to find power. In a series loop like this, the most
         direct is to use the i2R forms. The source current can be found via Ohm's
         law. As power calculations utilize RMS values, first find the RMS value of
         the source voltage.

12 For the plural form, some sources use "VARs" while others use "VAR". We shall use the
    latter.

265
              v RMS = v peak 2

                 v RMS = 10 V

                      2

                 v RMS  7.07 V

                 i = vZ
                 i = 7.07 V

                      10+j 6.283
                 i = 0.5986  - 32.1° A

     For the power calculations, we shall only use the magnitudes of the voltage
     and current. Here, the symbol "| |" refers to just the magnitude of the
     reactance or impedance.

                 P = i2R
                 P = (0.5986 A)2 10 
                 P 3.58 W

                 Q = i2| X |
                 Q = (0.5986 A)2 6.283
                 Q 2.25 VAR, inductive

                 S = i2|Z |
                 S = (0.5986 A)2 |10+j 6.283|
                 S 4.23 VA, inductive

Computer Simulation

The circuit of Figure 7.5 is captured in a simulator as shown in Figure 7.6. Three
different transient analysis simulations are run.

                                                                                    Figure 7.6
                                                                                    The circuit of Figure 7.5 in a
                                                                                    simulator.

266
The first simulation plots the circulating current (green), the resistor voltage (red)
and their product (the power, in blue). This is shown in Figure 7.7. We can see that
current and voltage are perfectly in phase, as expected. Also, the power waveform
ranges from zero up to about 7 watts. The average of this is approximately half of
the peak-to-peak, or about 3.5 watts, just as calculated.

                                                                                                                   Figure 7.7
                                                                                                                   Transient analysis for the
                                                                                                                   resistor of Figure 7.5.

The power value can also be computed from voltage times current as a crosscheck.
The voltage across the resistor can be found via the voltage rule, and its magnitude
is approximately 5.986 volts RMS. Multiplying this by the RMS current will also
yield 3.58 watts.
It is instructive to compare these curves to those generated in Figure 7.1 for the
general resistive case. The current and voltage values in Figure 7.1 were normalized
to unity so they do not appear to be identical to those of Figure 7.7, however, the
important part is that the phase relationships are the same along with the position of
the power waveform. In both cases the power waveform ranges from a minimum of
zero up to some maximum value. Consequently, its average value must be half of its
peak-to-peak value.

267
A second set of plots is generated for the inductor. This is shown in Figure 7.8.
Again, compare this set against the curves seen in Figure 7.2 for the general reactive
case. We can see that the current (green) is 90 degrees out of phase with the
inductor's voltage (red) and lagging, as expected. More importantly, we see that the
power waveform (blue) is centered around zero. The full cycle average of this is
zero, meaning that no power is dissipated. But how does this square with the 2.25
VAR reactive power that was calculated for the inductor? A close look at the power
plot shows that that value corresponds to the maximum value of the reactive power
waveform (i.e., half of its peak-to-peak value).

                                                                                                                   Figure 7.8
                                                                                                                   Transient analysis for the
                                                                                                                   inductor of Figure 7.5.

Finally, a third set of curves are created for the circuit as a whole. In other words,
now we're treating the series combination of the inductor and resistor as the load.
The results are illustrated in Figure 7.9.
The computed impedance phase angle was lagging at 32.1 degrees. We can see this
same shift between the voltage (red) and current (green) waveforms. The interesting
bit here is the offset and amplitude of the power waveform (blue). The waveform
has a peak-to-peak value of about 8.5 VA. Once again, the computed value for
apparent power, S, works out to one-half of the plotted peak-to-peak value. This will
be the case for P, Q and S. Further, it turns out that if we find the full cycle average
of this waveform, those small negative peaks would subtract from the total area and
reduce the value. The result would be the true power of 3.58 watts. We'll look at this
more closely following another example.

268
                                                                                      Figure 7.9
                                                                                      Transient analysis for the
                                                                                      resistor and inductor together
                                                                                      in Figure 7.5.

Example 7.2

     Determine the power dissipated by the resistor in the circuit of Figure 7.10.    Figure 7.10
     Also find the apparent power drawn by the circuit and the reactive power         Circuit for Example 7.2.
     of the capacitor. The source frequency is 1 kHz.

     The first item is to find the reactance of the capacitor.

             X C = 1 2  f C
             X C = 1 2  1 kHz 1 F
             X C =- j 15.92

     Unlike the the previous example, we shall use the v2/R forms for power as an
     alternative. The RMS value of the source voltage is 7.07 volts. First, find vR.

                 vR = E R
                           R - jX C

                 v R = 7.07V 10 10  - j 15.92
                 v R = 3.761 57.9 ° V

269
         The capacitor voltage is found via KVL:
                     vC = E -vR
                     vC = 7.07 0 ° -3.761  57.9 ° V
                     vC = 5.99 -32.1 ° V

         For the powers, we just use the magnitude of the voltage.
                      P = v2
                            R

                                                                  2

                           (3.761 V)
                      P = 10
                      P 1.414 W
                     Q = i2

                            |X |

                                                                2

                            (5.99 V )
                     Q = 15.92
                     Q 2.25 VAR, capacitive
                     S = E2

                            |Z|
                     S = (7.07 V)2

                           | 10 - j 15.92 |
                     S 2.66 VA, capacitive

Computer Simulation

In order to verify the results, the circuit of Figure 7.10 is captured in a simulator as
shown in Figure 7.11. Once again, three different transient analysis simulations are
run; one each for the resistor, the capacitor, and the pair together.

                                                                                                                   Figure 7.11
                                                                                                                   The circuit of Figure 7.10 in a
                                                                                                                   simulator.

270
In Figure 7.12 we see the results of a transient analysis run on the resistor. We can
see that the voltage and current are in phase. Also, the power waveform swings from
zero up to around 2.8 watts or so. This corresponds to an average value of just under
1.5 watts, and this agrees nicely with the computed result.

                                                                                                                   Figure 7.12
                                                                                                                   Transient analysis for the
                                                                                                                   resistor of Figure 7.11.

Figure 7.13 illustrates the results from a transient analysis run on the capacitor. As
expected, the current is leading the voltage by 90 degrees. We can also see that the
power waveform is swinging symmetrically around zero, meaning that there is no
net power dissipation. The peak value is just under 2.5 VAR, aligning nicely with the
calculated value.
Finally, in Figure 7.14 we have the results of a transient analysis using both the
capacitor and the resistor as the load. The current waveform is still leading the
voltage, but by less than 90 degrees. In fact, it leads by about 2/3rds of a division,
some 60° or so, which conforms nicely to the expected impedance angle of -57.9°
(i.e. from 10 - j15.92 ). The power waveform sits slightly below the horizontal
axis indicating it is neither true power nor reactive power, but a combination. The
peak-to-peak value is somewhat over 5 units, indicating an apparent power of just
over 2.5 VA, again, just as expected.

271
                                                                                                                   Figure 7.13
                                                                                                                   Transient analysis for the
                                                                                                                   capacitor of Figure 7.11.

                                                                                                                   Figure 7.14
                                                                                                                   Transient analysis for the
                                                                                                                   resistor and capacitor together
                                                                                                                   in Figure 7.11.

272
7.3 Power Triangle

The prior section revealed that the phase angle between the current and voltage
cannot be ignored when computing power. For example, if a 120 volt RMS source
delivers 2 amps of current, it appears that it delivers 240 watts. This is only true if
the load is purely resistive. For a complex load, the true power is somewhat less. In
fact, as we've just seen, if the load is purely reactive, there will be no true load
power at all.

Although plotting the current, voltage and power waveforms is instructive, it can be
somewhat cumbersome. Instead, we use a power triangle as shown in Figure 7.15.
The horizontal axis represents true power, P, in watts. The vertical axis represents
reactive power, Q, in VAR. The vector combination of P and Q results in the
apparent power, S, in VA. Remember, the apparent power is the product of the
magnitudes of the current and voltage. This is what the power "appears to be" based
on simple current and voltage measurements from a DMM, versus a proper power
meter. In the resistive case, there is no reactive power and thus S and P are the same.
Consequently, the S vector collapses onto the P vector. In a purely reactive case,
there is no true power and S and Q are the same; both vectors identical and vertical.
For the complex case, S is the vector sum of P and Q. This simple graphic nicely
encapsulates the relationship between the three vectors. Further, given any two of
the four parts (three vector magnitudes and ) and with just a little trigonometry, the
other two parts may be found.

     Reactive
     Power

                                                                                         Figure 7.15
                                                                                         The power triangle.

     Apparent Power, S

                               Reactive Power, Q

                               Real
                Real Power, P  Power

For example, knowing the real and reactive powers, the apparent power can be
found via the Pythagorean theorem. Similarly, if the apparent power and angle are
known, the real and reactive powers may be found using sine and cosine.
Remember, apparent power can be found from the product of the RMS voltage and
current magnitudes for any complex impedance, and  is the same as the impedance
angle (i.e., the voltage angle minus the current angle). For your convenience, some
useful power triangle relationships are listed following.

273
S = v RMS×iRMS                                               (7.4)
                                                             (7.5)
S =  P2+Q 2
                                                             (7.6)
 = tan-1 QP (i.e., the impedance angle)
                                                             (7.7)
P = S cos                                                    (7.8)
                                                             (7.9)
P = S 2-Q2                                                  (7.10)

Q = S sin 

Q = S2-P2

Power Factor

As we are often interested in the true power, it is worth noting that a rearrangement
of Equation 7.7 shows that the ratio of true power to apparent power is the cosine of
the impedance angle, P/S = cos . This is known as the power factor and is
abbreviated PF. Thus, PF = cos . Knowing the phase angle and the apparent power,
true power can be calculated. If PF is positive it is said to be a lagging power factor.
This is the case for inductive loads where the current is lagging the voltage. In
contrast, a capacitive load results in a negative or leading PF. Recall that for
capacitors, current leads the voltage. The sign is only used to indicate leading or
lagging and will be useful when we examine power factor correction, shortly. For
example, if a 100 volt RMS source delivers 1 amp for an apparent power of 100 VA
and the phase angle is -30°, PF is cos(-30°) or 0.866 leading and the true power is
P = 100 cos(-30°) = 86.6 watts.

PF = PS = cos  (positive is lagging and inductive)          (7.11)

We'll illustrate the use of the power triangle and the power factor in the next thrilling
and action-packed example.13

Example 7.3                                                                                Figure 7.16
                                                                                           Circuit for Example 7.3.
         Find S, P and Q in the circuit of Figure 7.16. E = 120 volts RMS. The
         source frequency is 60 Hz.

The first step is to determine the inductive reactance.

              X L= 2 f L

              X L = 2  60 Hz 150 mH
              X L = j 56.55

13 Hyperbole seems to work for the movie industry, anyway.
274
     From here we can determine the system impedance which will, in turn,
     allow us to determine the source current.

     Z = R× jX L
           R + jX L

     Z = 160×( j 56.55 )
           160  + j 56.55

     Z = 53.3 70.5° 

     isource = esource Z
     i source = 120  0 ° V 53.3  70.5 ° 
     isource = 2.252  - 70.5 ° A

     The apparent power is the product of the magnitudes of circuit voltage and
     current.

     S = E×isource                                                               Figure 7.17
     S = 120 V×2.252 A                                                           Power triangle for the circuit
     S = 270.1 VA, inductive                                                     of Figure 7.16.

     P = S cos 
     P = 270.1 VA cos 70.5 °
     P = 90 W

     Q = S sin                                                                   270.1 VA
     Q = 270.1 VA sin 70.5 °
     Q = 254.7 VAR, inductive

     As a crosscheck, the true power can also be determined by squaring the RMS
     voltage and then dividing by the 160  resistance. Similarly, dividing the
     squared voltage by XL will generate Q.

                 P = vR2                                                             254.7 VAR
                        R
                                                                                 70.5°
                 P = 120 V 2                                                               90 W
                       160 

                 P = 90 W

     The power triangle for this circuit is shown in Figure 7.17.

275
Power Factor Correction

One issue with a reactive load is that the current is higher than it needs to be in order
to achieve a certain true load power. This is wasteful and would require larger
conductors. To alleviate these issues, an opposite reactance can be added to the load
such that the resulting load is purely resistive. This can be realized by determining
the original Q value and then adding a sufficient reactance to produce an additional
Q of the opposite sign resulting in cancellation. From there, it is short step to
determine the required impedance. Then, knowing the frequency, the required
capacitance or inductance can then be found using the appropriate reactance
formula. This is illustrated in the following example.

Example 7.4

     Find circuit PF, S, P and Q for Figure 7.18. E = 200° volts peak at a                 Figure 7.18
     frequency of 10 kHz. Also find an appropriate component which when                    Circuit for Example 7.4.
     placed from node a to ground brings PF to unity.

     The inductive reactance of 1 mH at 10 kHz is j62.83 . This is in parallel
     with the 100  resistor, which is then in series with the 20  resistor.

             Z = 20 + (100 || j 62.83)

             Z = 20 + (28.3+ j 45)
             Z = 66  43° 

     This time we shall use peak values to illustrate the difference compared to
     using RMS values as in the previous example. The source current is:

             isource = EZ
             isource = 20  0 ° V 66  43 ° 
             isource = 0.303 - 43 ° A peak

     To find S, multiply the magnitudes of source voltage and current. As these
     are peak values, multiply each by 0.707 to arrive at RMS, or just cut the
     answer in half (i.e., 0.7072 is 0.5). This is the apparent power of the whole
     circuit.

             S = E×isource
                       2

             S = 20 V×0.303 A 2
             S = 3.03 VA, inductive

276
                 P = S cos                                                            Figure 7.19
                 P = 3.03VA cos 43°                                                   Power triangle for the circuit
                 P = 2.22 W                                                           of Figure 7.18.

     To be clear, 2.22 watts is the combined power dissipation between the two                    3.03 VA
     resistors.                                                                                                 2.07 VAR

                 Q = S sin                                                                     43 degrees 2.22 W
                 Q = 3.03 VA sin 43 °
                 Q = 2.07 VAR, inductive

     The power triangle for this circuit is shown in Figure 7.19.

     For the second part involving power factor correction, we need to add a          Figure 7.20
     reactive power equal in magnitude to the existing value but of the opposite      Power triangle for the circuit
     sign. This means we need to add 2.07 VAR capacitive. The new power               of Figure 7.18 with power
     triangle is shown in Figure 7.20. The vertical components cancel, resulting      factor correction.
     in the apparent power equaling the true power with PF = 1.
                                                                                      Before
     We can place the correction capacitor where it's convenient in physical
     terms, just as long as we add 2.07 VAR capacitive. We don't have a physical              2.07 VAR
     circuit, so that's not a consideration here. A convenient location would be to           Inductive
     place it across the existing resistor-inductor combo. Our goal then is to first
     find the required reactance, and from that, determined the required                       2.22 W
     capacitance. We shall do this two different ways. In the first case, we note     After, S=P
     that the capacitor appears across the only other reactive element in the
     circuit. Therefore, in order for them to cancel they must have the same                   2.07 VAR
     reactance magnitude, and thus XC must equal -j62.8 . But what if there                    Capacitive
     were multiple reactive elements in the circuit or if it was impractical to
     locate the component there, for example, due to space restrictions? In that
     case, we would simply work the power relation backwards. For comparison,
     suppose we place the capacitor in the same location; from node a to ground.
     A voltage divider can be used to determine the present value of va. This
     works out to 11.4 volts RMS. Using the voltage form of the power rule:

     Q = vX2
            X

     X = vX2
            Q

     X = 11.4V 2
           2.07 VAR

     X = 62.8 

     Either way we derive XC, now we just solve the capacitive reactance formula
     to find C.

277
            C= 1
                  2 f XC

            C = 1 2  10 kHz 62.8 
            C = 253.3 nF

The resulting circuit is shown in Figure 7.21.

                                                                                        Figure 7.21
                                                                                        The circuit of Figure 7.18 with
                                                                                        power factor correction.

Computer Simulation

It is useful to see the reduction in current demand caused by using power factor
correction. To so so, the circuit of Figure 7.21 is captured in a simulator as shown in
Figure 7.22.

                                                                                                                   Figure 7.22
                                                                                                                   The circuit of Figure 7.21 in a
                                                                                                                   simulator.

We will run two transient analyses to find the source current. The first version will
be run using the original circuit configuration without the capacitor. The second run
will include the capacitor. To plot the currents, we will make use of Ohm's law. First
we obtain the voltages at nodes 1 and 2. Then, using the simulator's post processor,
we subtract v1 from v2 which yields the voltage across the 20  resistor. This
quantity is then divided by 20  to arrive at the input current. This is similar to the
current sense resistor technique used in earlier chapters.

278
The resulting current for the original circuit is shown in Figure 7.23. Note that the
peak current is just over 300 milliamps, as calculated in step two of the example.

                                                                                                                   Figure 7.23
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 7.22 without
                                                                                                                   power factor correction.

The second simulation is shown in Figure 7.24, now with power factor correction.
                                                                                                                   Figure 7.24
                                                                                                                   Simulation results for the
                                                                                                                   circuit of Figure 7.22 with
                                                                                                                   power factor correction.

279
The amplitude here is much reduced, in the range of 160 to 170 milliamps peak. By
adding the capacitor, the two reactive currents cancel, leaving a parallel impedance
of just 100 . This is in series with the 20  resistor. Dividing 120  into the 20 volt
peak source yields a peak current of approximately 167 mA, in agreement with the
simulation. The cancellation of the reactive currents is also shown by the fact that
the source current is no longer out of phase. In Figure 7.24 the current waveform is
in phase and starts at zero, as expected. This implies a load that is the equivalent of a
pure resistance. In contrast, the plot of Figure 7.23 shows a current that is lagging by
around one-half division, or about 45 degrees, which unsurprisingly is the
approximate value of the circuit's impedance angle. Obviously then, this combined
impedance must be inductive.

To sum up, power factor correction is used to lower current demand while keeping
load power constant. If the load is fixed, this can be achieved through the use of a
capacitor (for inductive loads) or an inductor (for capacitive loads). If the load
demand is dynamic, then a more complex system is required, for example, switching
through a bank of capacitors to get a value close to the precise value needed for that
particular load. More examples of power factor correction are in the next section.

7.4 Power Systems

In this section we shall change our focus and consider power systems at a more
functional or abstract level rather than at the component level. Specifically, we
would like to consider common loads such as motors, heating elements, lighting
devices and the like, and how to analyze a system consisting of a variety of different
loads. For the most part, we shall stick with the basic scheme of multiple loads being
supplied by a common and ideally constant voltage source with each load
configured in parallel with the others. Systems do not have to be configured this way
but it is typical of residential and commercial applications.

Typical Loads

Three common loads are heating elements, lighting devices and motors or                    Figure 7.25
compressors. The first two are fairly obvious, but the the latter are also quite           A small boxer fan for cooling
common, although often hidden from view inside devices such as refrigerators, air          electronic components.
conditioners and heat pumps. We can classify loads in terms of their typical
impedance. Devices such as baseboard electrical heating units, toasters, coffee
makers and electric ovens are classified as resistive heating devices. The load they
present is easily approximated as a simple resistance. The same is true for
incandescent lights, however, there can be a very large change in resistance between
the on and off states of incandescent lights. Motors, and other devices integrating
motors such as compressors, present an inductive impedance. This is due to the large
coils of wire, or windings, inside the motor. Any motorized electrical device falls
into this category, such as a washing machine, drill press or the fan of Figure 7.25.

280
Purely capacitive loads are not nearly as common but some everyday devices exhibit
highly complex impedances that can vary widely in both amplitude and angle. A
standard moving coil dynamic loudspeaker falls into this category. While you would
never plug a loudspeaker directly into an AC power system14, the amplifier that
drives it must be designed to meet the challenges of an impedance whose magnitude
can change by a factor of ten across the audible range of frequencies. To complicate
matters, while the phase typically is inductive, at some frequencies it can be purely
resistive or even capacitive.

Efficiency

Efficiency is defined as usable power output divided by applied power input and is
denoted by the Greek letter eta, . Normally it is expressed as a percentage and it
can never be over 100%.

      = Poutput     (7.12)
           P input

Some loads, such as typical heating elements, can be thought of as being 100%
efficient, meaning that all of the electrical input is turned into useful output (in this
case that's heat, although there are more effective ways of using that electrical input
to generate heat, such as a heat pump15). In contrast, incandescent light bulbs turn
very little of their input into the desired quantity (light) and thus suffer from low
efficiency. Just a few percent of the electrical energy fed into an incandescent bulb
turns into light while the vast majority turns into heat. From that perspective,
incandescent lights are more efficient at producing heat than light. LED lighting, on
the other hand, is perhaps an order of magnitude more efficient than incandescent
lighting, meaning that we can get the same light output for a much smaller electrical
power input while simultaneously producing less heat.

Motors lose power in the form of mechanical losses (e.g., friction) and electrical
losses (e.g., resistance of windings). Motors are rated in terms of their output power,
not the power they draw from the source. For example, a motor with a 1 HP rating
might be said to generate 1 HP (approximately 745.7 W) at the shaft. If the motor is
90% efficient, the electrical draw would be 745.7 W/0.9 or 829 W. This situation is
further complicated by the phase angle (i.e., power factor) of the motor due to
reactive elements, as noted in the previous sections. Compared to motors, home

14 That is, unless you enjoy hearing a short-lived blast of sound which is followed by a burst
    of flames. Plugging a nominal 8  loudspeaker into a 120 VAC outlet would generate
    1800 watts of power, well beyond the design limits of any common loudspeaker.

15 A heat pump moves heat from one place to another. In a properly designed system it takes
    less energy to move heat than it takes to generate it, and thus it's much more effective
    than simple resistive heating when it comes to warming the interior of a building.

281
loudspeakers are particularly inefficient, typically converting only about 1% of the
electrical input into usable acoustic output.

Example 7.5

     A certain 120 VAC RMS 60 Hz 1.2 HP motor has an efficiency of 90% and a
     lagging power factor of 0.85. Determine the apparent power and the current
     drawn from the system. Also draw the power triangle. 1 HP  745.7 watts.

     The motor output is 1.2 horsepower which is equivalent to:

     Pwatts 1.2 HP×745.7 W/HP
     Pwatts 895 W

     The input required to achieve this is computed with Equation 7.12.

               P output
     Pinput = 
     Pinput = 895 W 0.9
     Pinput = 994 W

     From Equations 7.10 and 7.11, the remaining powers are:                          Figure 7.26
                                                                                      Power triangle for the motor
     S = PPF                                                                          described in Example 7.5.
     S = 994 W
                                                                                      1170 VA  617 VAR
            0.85                                                                               Inductive
     S = 1170 VA

     Q = S2-P2
           (              2            )2
     Q  =     1170  VA       -(994  W                                                          994 W
                         )

     Q = 617 VAR

     The current is found via Equation 7.4, essentially power law:

        S = vRMS ×i RMS
     iRMS = S

              v RMS

     iRMS = 1170 VA 120 V
     iRMS = 9.75 A

     The power triangle is shown in Figure 7.26.

282
Example 7.6

     For the motor described in Example 7.5, determine an appropriate
     component that when placed in parallel will produce unity power factor.
     Draw the complete power triangle for the system and determine the new
     current draw.

     In Example 7.5 the reactive power was determined to be 617 VAR and was
     inductive, so we'll need 617 VAR capacitive to compensate. The new power
     triangle is shown in Figure 7.27. The source voltage was stated to be 120 V.
     We can use a variation on power law to determine the required reactance.

              Q = v RMS2                                                           Figure 7.27
                      XC                                                           Power triangle for the
                     v RMS 2                                                       corrected system of
                                                                                   Example 7.6.
             XC =
                       Q
                      120 V2

             XC =
                     617 VAR

             X C = - j 23.34 

     Now use the capacitive reactance formula to determine the capacitance         Before  617 VAR
     value. The line frequency was specified as 60 Hz.                                     Inductive

                 C= 1                                                                        994 W
                       2 f XC                                                      After, S=P

                 C = 1 2  60 Hz 23.34                                                      617 VAR
                 C = 114 F                                                                 Capacitive

     After correction, the apparent power and real power are the same.
     Thus,

             iRMS = S
                      v RMS

             iRMS = 994 VA 120 V
             iRMS = 8.28 A

     The current draw has been reduced by nearly 1.5 amps, a considerable
     savings. The new current is 85% of what it used to be.

Now let's consider a larger system that contains several devices.

283
Example 7.7

         The system shown in Figure 7.28 is supplied by a 240 VAC RMS 60 Hz
         source. Load 1 is 1000 watts of resistive heating elements. Load 2 is a 3 HP
         motor with an efficiency of 92% and a lagging power factor of 0.75. Load 3
         is a capacitor bank equivalent to 75 F. Draw the system power triangle and
         determine whether or not load 3 is appropriate to bring the system power
         factor to unity.

                                                                                                                   Figure 7.28
                                                                                                                   System block diagram for
                                                                                                                   Example 7.7.

     First, determine the power triangle for the motor. Then we can add the other
     loads to it to create a system power triangle. The motor output is 3 HP which
     is equivalent to:

     Pwatts 3 HP×745.7 W/HP
     Pwatts  2237 W

     The required input power is.                                                   Figure 7.29
                                                                                    Power triangle for the motor
                            P output                                                of Example 7.7.
                  P input = 
                 Pinput = 2237 W 0.92
                 Pinput = 2432 W

     The computations for apparent and reactive power follow.

                                                                                    3242 VA

      S = PPF                                                                                        2144 VAR
     S = 2432 W                                                                                      Inductive

             0.75
     S = 3242 VA

                                                                                             2432 W

     Q = S2-P2
           (             2                      )2
     Q  =     3242  VA      -(         2432  W
                        )

     Q = 2144 VAR, inductive

     The power triangle for the motor is shown in Figure 7.29.

284
     Now for the capacitor. First, we need to determine the reactance, then we
     can use the v2/Z form of power law to determine Q.

                 X C = 1 2  f C
                 X C = 1 2 60 Hz 75 F
                 X C = - j 35.37

                 Q = v2
                       X

                 Q = (240 V )2
                       35.37 

                 Q = 1629 VAR, capacitive

     There are no other reactive elements in the system to consider. We have 515
     fewer capacitive VAR than inductive VAR, so the correction will not be ideal.
     We would need to increase the total capacitance by about 24 F to achieve a
     power factor of unity. The system power diagram with all of the individual
     parts is shown in Figure 7.30. This is then simplified to the final system
     power triangle as shown in Figure 7.31. The system PF is 0.989 lagging.

                    2144 VAR                                                        Figure 7.30
                    Inductive                                                       Power components for the
                                                                                    system of Example 7.7.
             2432 W
     1000 W
                    1629 VAR
                    Capacitive

             3470 VA     515 VAR                                                    Figure 7.31
                 3432 W  Inductive                                                  Final power triangle for the
                                                                                    system of Example 7.7.

285
7.5 Summary

Power is the product of current and voltage, however, the phase relationship between
the two has a major impact on the result. The most simple and straightforward case
is when the current and voltage are in phase, meaning the load is a pure resistance.
In this case, the true power can be computed directly as the product of RMS current
and voltage. At the other extreme, when the voltage and current are 90 degrees out
of phase, as in the case of a purely capacitive or inductive load, power is alternately
generated and dissipated. That is, in a reactive load, true power dissipation is zero. A
mechanical analogy is the storage and release of energy in an ideal spring as it is
alternately compressed and then allowed to expand. In between these two extremes,
that is, when the load is a complex impedance, the true power dissipation is
somewhere between zero and the resistive maximum.

The power triangle is used to make visual sense of this situation. It is a right triangle
comprised of three legs. The horizontal leg represents the true, or resistive, power
and is denoted by the letter P. It is measured in watts. The vertical leg represents the
so-called "reactive power". It is denoted by the letter Q and has units of VAR (volt-
amps-reactive). Q can be either inductive or capacitive. The third leg, the
hypotenuse, is the apparent power, S. It is measured in VA (volt-amps). It is called
apparent power because that is what the power appears to be if it is naively
measured with a voltmeter and an ammeter, ignoring the phase difference between
them. The angle between the real and apparent powers,  (theta), is the phase angle
between the voltage and current. In other words, theta is the impedance angle.
Knowing theta, real power can be determined using right angle trigonometry,
namely, P = S cos . The cosine of theta is also know as the power factor, PF. It
ranges from 0 (purely reactive) to 1 (purely resistive). Positive or inductive
impedance angles are said to have lagging power factor while negative or capacitive
impedance angles produce leading power factor.

Ideally, loads are purely resistive and have a power factor of unity. If this is not the
case, then for a given voltage, a higher current is needed to create the same real
power as in the purely resistive case. This is not advantageous. Power factor
correction is the process of shifting the power factor back to unity for complex
loads. This is done by inserting a reactance of the opposite sign to counterbalance
the reactive portion of the load, for example, adding capacitive reactance to a system
that is inductive. The added reactive power must have the same magnitude as the
original reactive power but be of the opposite sign, resulting in cancellation.

Efficiency is the measure of usable output power to applied power. Ideally,
electromechanical systems such as motors would be 100% efficient, meaning that
there is no power loss, but this is not a practical possibility. For example, there will
always be frictional losses and power losses in wires.

286
Review Questions

    1. Define apparent power, real power and reactive power.
    2. Describe the power triangle.
    3. What is power factor, PF?
    4. Describe the difference between leading and lagging power factor.
    5. What is power factor correction?
    6. Give examples of resistive loads and inductive loads.

7.6 Exercises

Analysis

    1. For the circuit shown in Figure 7.32, determine apparent power S, real
         power P, reactive power Q and power factor PF. Also, draw the power
         triangle.
                                                                                Figure 7.32

    2. For the circuit shown in Figure 7.33, determine apparent power S, real
         power P, reactive power Q and power factor PF. Also, draw the power
         triangle.
                                                                                Figure 7.33

287
    3. For the circuit shown in Figure 7.34, determine apparent power S, real
         power P, reactive power Q and power factor PF. Also, draw the power
         triangle. The source is 120 volts.
                                                                                Figure 7.34

    4. For the circuit shown in Figure 7.35, determine apparent power S, real
         power P, reactive power Q and power factor PF. Also, draw the power
         triangle. The source is 120 volts.
                                                                                Figure 7.35

    5. For the circuit shown in Figure 7.36, determine apparent power S, real
         power P, reactive power Q and power factor PF. The source is 90 volts,
         XL = j30 , R = 50 .
                                                                                Figure 7.36

288
    6. For the circuit shown in Figure 7.37, determine apparent power S, real
         power P, reactive power Q and power factor PF. Also, draw the power
         triangle. The source is 240 volts, XC = -j200 , R = 75 .

                                                                                Figure 7.37

    7. For the circuit shown in Figure 7.38, determine apparent power S, real
         power P, reactive power Q and power factor PF. The source is 120 volts,
         XL = j40 , XC = -j25 , R = 20 .

                                                                                Figure 7.38

    8. For the circuit shown in Figure 7.38, determine apparent power S, real
         power P, reactive power Q and power factor PF. The source is 120 volts,
         60 Hz. R = 80 , C = 20 F, L = 400 mH.

    9. An audio power amplifier delivers a 30 volt RMS 1 kHz sine to a
         loudspeaker. If the loudspeaker impedance at this frequency is 745°,
         determine the RMS current delivered to the load and the true power.

    10. An audio power amplifier delivers an 80 volt peak 35 Hz sine to a
         subwoofer. If the subwoofer impedance at this frequency is 4-30°,
         determine the peak current delivered to the load and the true power.

    11. A certain load is specified as drawing 8 kVA with a lagging power factor of
         0.8. Determine the real power P, and the reactive power Q. Further, if the
         source is 120 volts at 60 Hz, determine the effective impedance of the load
         in both polar and rectangular form, and the requisite
         resistance/inductance/capacitance values.

    12. A certain load is specified as drawing 20 kVA with a leading power factor of
         0.9. Determine the real power P, the reactive power Q and draw the power
         triangle. If the source is 240 volts at 60 Hz, determine the effective
         impedance of the load in both polar and rectangular form, and the requisite
         resistance/inductance/capacitance values.

289
    13. Consider the system shown in Figure 7.39. E is a standard 120 V input. If
         the three loads are 45 W, 60 W and 75 W incandescent light bulbs,
         respectively, determine the apparent power delivered to the system, the
         source current, the reactive power and the real power.

                                                                                Figure 7.39

    14. Given the system shown in Figure 7.39, determine the apparent power
         delivered to the system, the source current, the real power, the reactive
         power and the efficiency. E is 120 V. The three loads are resistive heating
         elements of 500 W, 1200 W and 1500 W, respectively.

    15. Consider the system shown in Figure 7.40. E is 240 V. If the three loads are
         200 W, 400 W and 1000 W resistive, respectively, determine the apparent
         power delivered to the system, the real power and the reactive power.

                                                                                Figure 7.40

    16. Given the system shown in Figure 7.40, determine the apparent power
         delivered to the system, the real power, the reactive power and the
         efficiency. E is 480 V. The three loads are resistive heating elements of
         1500 W, 2000 W and 3500 W, respectively.

    17. Consider the system shown in Figure 7.39. E is 120 V. Load 1 is 1 kW
         resistive, load 2 is 400 W resistive and load 3 is 600 VAR inductive.
         Determine the apparent power delivered to the system, the source current,
         the reactive power, the real power and the power factor.

    18. Consider the system shown in Figure 7.39. E is 240 V. Load 1 is 2 kW
         resistive, load 2 is 800 W resistive and load 3 is 1200 VAR capacitive.
         Determine the apparent power delivered to the system, the source current,
         the real power, the reactive power and the power factor.

    19. Given the system shown in Figure 7.39, determine the apparent power
         delivered to the system, the source current, the real power, the reactive
         power and the power factor. E is 120 V. Load 1 is 600 W of incandescent
         lighting, load 2 is 1200 W of heating elements and load 3 is 200 VAR
         capacitive.

290
    20. Given the system shown in Figure 7.39, determine the apparent power
         delivered to the system, the source current, the real power, the reactive
         power and the power factor. E is 60 V. Load 1 is 90 W of incandescent
         lighting, load 2 is 800 W of heating elements from a dryer and load 3
         200 VAR inductive.

    21. A 120 V 3 HP motor draws a real power of 2500 W from the source.
         Determine its efficiency.

    22. A 120 V 12 HP motor draws a real power of 10 kW from the source.
         Determine its efficiency.

    23. An ideal 120 V 2 HP motor draws an apparent power of 1800 W from the
         source. Determine its power factor.

    24. An ideal 120 V 0.3 HP motor draws an apparent power of 270 W from the
         source. Determine its power factor.

    25. A 120 V motor is rated at 0.5 HP. It has an efficiency of 78% and a lagging
         power factor of 0.7. Determine the apparent power drawn from the source
         (S), the real power (P), and the reactive power (Q) supplied. Also draw the
         power triangle and find the delivered current.

    26. A motor is rated at 10 HP. It has an efficiency of 92% and a lagging power
         factor of 0.8. Determine the apparent power drawn from the source (S), the
         real power (P), and the reactive power (Q) supplied. Also draw the power
         triangle. Finally, determined the current drawn from the 120 V source.

    27. Consider the system shown in Figure 7.39. E is 120 V. Load 1 is 1 kW
         resistive, load 2 is 400 W resistive and load 3 is a 1 HP motor that is 80%
         efficient and has a 0.85 lagging power factor. For the system, determine the
         apparent power delivered, the source current, the real power, the reactive
         power and the power factor.

    28. Consider the system shown in Figure 7.39. E is 120 V. Load 1 is 2.5 kW
         resistive, load 2 is 500 VAR capacitive and load 3 is a 2 HP motor that is
         85% efficient and has a 0.9 lagging power factor. For the system, determine
         the total power delivered, the source current, the apparent power, the real
         power and the power factor.

291
    29. For the system shown in Figure 7.41, E is 240 V. Load 1 is 1.2 kW resistive
         heating, load 2 is 400 W resistive lighting, load 3 is a 0.5 HP motor that is
         80% efficient with a 0.7 lagging power factor, and load 4 is a 1 HP motor
         that is 85% efficient with a 0.8 lagging power factor. For the system,
         determine the apparent power delivered, the source current, the real power,
         the reactive power and the power factor.

                                                                                Figure 7.41

Design

    30. A 120 V 60 Hz source drives a load equivalent to a 75  resistor in parallel
         with a 25 F capacitor. Determine the appropriate capacitance or inductance
         value to place across this load to produce unity power factor.

    31. A 240 V 60 Hz source drives a load equivalent to a 10  resistor in parallel
         with a 50 mH inductor. Determine the appropriate capacitance or inductance
         value to place across this load to produce unity power factor.

    32. A load of 5030° is driven by a 120 V 60 Hz source. Determine the
         appropriate capacitance or inductance value to place across this load to
         produce unity power factor.

    33. A load of 50-50° is driven by a 240 V 60 Hz source. Determine the
         appropriate capacitance or inductance value to place across this load to
         produce unity power factor.

    34. A certain load is specified as drawing 8 kVA with a lagging power factor of
         0.8. The source is 120 volts at 60 Hz. Determine the appropriate capacitor or
         inductor to place in parallel with this load to produce unity power factor.

    35. A certain load is specified as drawing 20 kVA with a leading power factor of
         0.9. The source is 240 volts at 60 Hz. Determine the appropriate capacitor or
         inductor to place in parallel with this load to produce unity power factor.

    36. A 240 V 60 Hz source is connected to a load consisting of heating elements
         of 10 kW along with a 15 HP motor with =90%, PF=0.85. Determine an
         appropriate capacitor or inductor to place in parallel to produce unity power
         factor.

    37. A 120 V 60 Hz source is connected to a load consisting of 350 W of resistive
         lighting along with a 1.5 HP motor with =70%, PF=0.75. Determine an
         appropriate component to place in parallel to produce unity power factor.

292
Challenge

    38. A power distribution system for a concert has the following specifications:
         Ten class D audio power amplifiers rated at 2 kW output each with 90%
         efficiency and unity power factor, 10 kW worth of resistive stage lighting to
         illuminate the musicians alongside a troupe of trained dancing kangaroos, a
         3 HP motor used to continuously rotate the drum riser throughout the
         performance (=80%, PF=0.75) and a 2 HP compressor which inflates and
         deflates a giant rubber T. rex during particularly exciting parts of the show
         (=85%, PF=0.8). For the system, determine the total power delivered, the
         source current, the apparent power, the real power, and the power factor.
         Finally, make a sketch of this extravaganza with its entertainers in full
         regalia singing their latest tune "Maximum Volume".

Simulation

    39. Verify the design of problem 28 by performing a transient analysis. The
         design will have been successful if the source current and voltage are in
         phase.

    40. Verify the design of problem 29 by performing a transient analysis. The
         design will have been successful if the source current and voltage are in
         phase.

293
8 Resonance

8.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Describe series resonance and plot impedance, voltage and current as a function of frequency.
    · Describe parallel resonance and plot impedance, voltage and current as a function of frequency.
    · Determine system resonant frequency, Q and bandwidth in series and parallel resonant networks.
    · Perform series-to-parallel transforms for practical inductors.

8.1 Introduction

Resonance can be thought of as a preferred frequency of vibration. In other words, it is a frequency at which a
system operates with reduced limitation. It is exploited in a variety of areas, for example, a good mechanical
resonance can be used for the construction of acoustic musical instruments. In this case, we strive to maintain
the resonant oscillation in order to enhance the instrument's sustain. On the other hand, we might want to control
or limit the resonance, as in an automotive suspension system. In electrical systems, resonance tends to produce
either a maximum or a minimum response to current or voltage. As a result, resonant systems can be used to
filter out or select specific frequencies across the spectrum. Obvious uses include tuning circuits, oscillators,
filters and the like.

There are two basic forms of resonance for electrical circuits: series RLC resonance and parallel RLC resonance.
Series resonance tends to be the less complicated of the two. Both types share many similarities but in some
respects they are mirror images of each other. Series and parallel resonant circuits both exhibit wide fluctuations
in impedance magnitude and phase across the frequency spectrum. In the case of series resonance, the
impedance is at a minimum at the resonance frequency. This implies a current maximum if the circuit is driven
by a voltage source. In contrast, parallel resonance produces an impedance peak at resonance. This implies a
voltage maximum if the circuit is driven by a current source.

Much of the initial circuit analysis in this chapter concentrates on the response of the circuits across a range of
frequencies rather than at some random specific frequency. Consequently, we will be making considerable use
of frequency domain plots; that is, plots of impedance, voltage and current magnitude and phase as they vary
across the frequency spectrum. Once that is established we can zero in on the area of resonance and determine
precisely the shape of these curves in the region around the resonant frequency. Along the way we will define
and utilize new circuit parameters such as Q, bandwidth, half-power frequencies and more.16

16 "Q" as used in this chapter is not to be confused with the Q used to represent reactive power, although it is related to the
    Q, or quality factor, of an inductor.

294
8.2 Series Resonance

Let's begin with the simplest RLC circuit; one consisting of a single voltage source
in series with a single resistor, inductor and capacitor, as shown in Figure 8.1. Of
particular interest is how the total impedance varies across the frequency spectrum
and what impact this has on the current and the three component voltages.

                                                                                                                   Figure 8.1
                                                                                                                   A series RLC circuit.

The impedance as seen by the source is simply the sum of the three components, or

                      Z = R+ jX L - j X C

This can be expanded into

                      Z= = R+ j 2  f L - j 1 2  f C

The interesting part here is that the first term is not a function of frequency, the
second term is directly proportional to frequency and the third is inversely
proportional to frequency. Further, given that the positive and negative reactances
behave oppositely, it appears that at some frequency they may cancel out, leaving
just the resistance.

To refine this, we expect that at low frequencies the capacitor will dominate the
impedance. In other words, XC will be the largest of the three ohmic values. This
means that the overall impedance will tend to mimic both the magnitude and phase
of the capacitive reactance. On the other hand, at very high frequencies the inductor
will tend to dominate the impedance. XL will be the largest of the three values. In this
region, the combined impedance will echo that of the inductor. In short, at low
frequencies the impedance magnitude will be large and the circuit will appear
capacitive while at high frequencies the impedance magnitude will be large and the
circuit will appear inductive. In the middle is where things get interesting.

A plot of the resistance or reactance of the three elements is shown in Figure 8.2.
The sum of the three is also shown (red). The frequency axis is uses a logarithmic
scale to show the symmetrical nature of the combined impedance curve.

295
                        0.1  Series Resonance Impedance Plot                         10
                     10                                                                10
                                                          1                            8
                      8
                      6                                                                         Figure 8.2
                                                                                                Series impedance variation
                                                                                                across frequency.

Impedance Magnitude                                                                  6

                     4                                                               4

                                  R+jXL-jXC                                             2
                                                                                        0
                     2                                                               10.0

                             R                                                   XC
                                    XL
                                                          1.0
                     0                       Normalized Frequency
                      0.1

The dip in the center corresponds to an impedance equal to R. At this frequency the
capacitive and inductive reactances are equal in magnitude and effectively cancel
each other. All that's left is the resistive component, R. This frequency is known as
the resonant frequency and is denoted by f0.

                        The series resonant frequency, f0, is the frequency at which the
                        magnitudes of the inductive and capacitive reactances are equal. (8.1)

This implies that the power factor is unity at resonance. Also, in a real world circuit
R is the combination of the series resistance plus any resistance from the inductor's
coil. We can derive a formula for f0 as follows. The definition declares that the
magnitude of XL must equal the magnitude of XC. Therefore, we can set the
capacitive and inductive reactance formulas equal to each other and then solve for
the resulting frequency.

                           X C = 1 2  f C

                           X L = 2 f L

296
                               XL= XC                          (8.2)
                          2 f 0L = 1

                                       2 f0C
                               f 02 = (2 )21 LC

                               f 0 = 1 2   L C

Note that a particular resonant frequency can be obtained through a variety of LC
pairs. This, along with the value of R, will alter the specific shape of the impedance
curve in terms of how narrow or broad the dip is. These components will also affect
how quickly the phase response shifts from fully capacitive (-90°) to fully inductive
(+90°). This shape factor is described by the parameter, Q. The tighter or more
narrow the curve, the higher the Q.

Given a constant voltage source, it should be no surprise that a plot of the resulting
current will be an inversion of the impedance curve. This is shown in Figure 8.3.

                          Series Resonance Current Plot

                     0.1                                  1           10
                  10

                                                                                        Figure 8.3

                  8                                                                     Series current versus frequency.

Relative Current  6

                                                  High Q

                  4

                  2

                                           Low Q

                  0                                       1.0
                  0.1                                          10.0
                          Normalized Frequency

If we scale the curves such that they both have a normalized peak of unity, the
difference in the shapes may be a little easier to see. This is shown in Figure 8.4.

297
                        0.1  Series Resonance Current Plot              10
                      1
                    0.8                               1                             Figure 8.4
                    0.6                                                             Normalized series current
                              Low Q                                                 versus frequency.

Normalized Current  0.4

                                                    High Q

                    0.2

                    0
                    0.1                                     1.0  10.0
                             Normalized Frequency

At this point we can more precisely define Q. Specifically, the "sharpness" of the
curve is related to the half-power or "-3 dB" frequencies, f1 and f2.17 These are the
frequencies at which the current (assuming voltage source drive) falls off to 0.707 of
the maximum value at resonance. Therefore, they represent the frequencies at which
power will have fallen to one-half of the maximum value seen at resonance (recall
that power varies as the square of current and that 0.707 squared is approximately
0.5). f1 is below f0 and f2 is found above. The difference between these two
frequencies is called the bandwidth, BW.

                             BW = f 2 - f 1                      (8.3)
                             Qcircuit = f 0 BW                   (8.4)

The relationship between these variables is illustrated in Figure 8.5. The vertical axis
is shown as a percentage of maximum. For a series resonant circuit driven by a
voltage source, this axis is current; however, it can be voltage in the the case of a
parallel resonant circuit, as we shall see. If this plot is compared to the curves in
Figure 8.4, it should be apparent that for lower Q circuits, f1 and f2 spread apart,
moving away from the resonant frequency, f0. Thus, for any given f0, a lower Q
means a wider (larger) bandwidth.

17 Decibels are covered in detail in Chapter 10.

298
                        0.1                   Resonance Frequencies        10
                    100                                                                 Figure 8.5
                                                                 1                      Location of f1 and f2, and
                     90                                                                 definition of bandwidth (BW).
Percent of Maximum   80                               BW
                                                                          10.0
                             70.7%                f1              f0  f2
                     70
                     60                                       1.0
                     50                           Normalized Frequency
                     40
                     30
                     20
                     10

                       0
                        0.1

The resonant frequency, f0, in general is not located evenly between f1 and f2. It is, in
fact, located at their geometric mean. In other words,

                                    f0= f1 f2                             (8.5)

From Equation 8.5 we may derive:

                                    f0= f2                                (8.6)
                                    f1 f0

To find accurate values for f1 and f2 we can define a factor, k0. The derivation of k0 is
found in Appendix C.

                                     k0 = 1 + 2 1 +1                      (8.7)
                                    2Q circuit        4 Qcircuit          (8.8)
                                                                          (8.9)
                                    f 1= f0
                                          k0

                                    f 2 = f 0×k0

299
For higher Q circuits (Qcircuit  10), we can approximate symmetry, and thus

                                     f 1  f 0 - BW 2       (8.10)
                                     f 2  f 0+ BW 2        (8.11)

As mentioned previously, the Q can be a function of either R or the L/C ratio. In
Figures 8.6 and 8.7 we have impedance curves for the two cases. The frequency axis
is normalized to f0 (i.e., f0 is unity). In Figure 8.6 we vary the resistance value to see
how it affects both the magnitude and phase of the impedance across frequency.
Figure 8.7 is similar except we vary the inductor/capacitor ratio.

                                     Series Resonance Impedance Variation with Q: R Value

                           1000.1                     1    10                10

Impedance Phase (degrees)                                                                                                          8                                 Figure 8.6
                           50                                                                                                                                        Magnitude and phase of
                                                                                                                                                                     impedance for a variation of
                                                                                                                                                                     resistance.

                                                    Dashed: Lower Q 6                                                                  Relative Impedance Magnitude
                                                    via higher R value
                           0

                                                                                                                                  4

                           -50
                                                                                                                                    2

                           -100                   1.0         0
                                0.1  Normalized Frequency  10.0

Looking first at the phase (blue, left axis), we see in both cases that high Q circuits
exhibit a quick transition from a negative (capacitive) phase angle to a positive
(inductive) phase angle. We also notice that the phase shift hits zero at f0, implying
unity power factor.

The impedance magnitude plots show a slightly different story. While it is true that
the higher Q plots are sharper, they get that way through different mechanisms. In
the case of the resistor, a lower Q is achieved via a larger resistance. This has the
effect of blunting the tip of the curve and lowering current flow at f0 when compared
to the high Q case (as seen in Figure 8.3). In contrast, reducing Q by reducing the

300
inductor/capacitor ratio broadens the entire curve. The impedance magnitude at the
dip does not change, and thus the current at f0 does not change. In practical terms,
the Q for a series circuit, Qseries, may also be defined by the ratio of circuit reactance
to the total series resistance at resonance.

                                     Qseries = X 0                        (8.12)
                                               RT

                              Where
                              Qseries is the Q of the series resonant circuit (i.e., Qcircuit for series),
                              RT is the total series resistance (Rseries + Rcoil),
                              X0 is the reactance (either XL or XC) at f0.

                                Series Resonance Impedance Variation with Q: L/C Ratio

                           1000.1                   1                                                       1010

Impedance Phase (degrees)                                                                                                          8                                 Figure 8.7
                           50                                                                                                                                        Magnitude and phase of
                                                                                                                                                                     impedance for a variation of
                                                                                                                                                                     inductor/capacitor ratio.

                                                   Dashed: Lower Q 6                                                                   Relative Impedance Magnitude
                           0 via lower L/C ratio

                                                                                                                                  4

                           -50
                                                                                                                                    2

                           -100                                  1.0                                           0
                                0.1                 Normalized Frequency                                    10.0

From Equation 8.12 we can derive an expression for Qseries in terms of R, L and C as
follows:

                     Q series = X 0
                                 RT

              Qseries =  X 02

                                  RT

301
At resonance XL and XC have the same magnitude, thus we can also say:

     Q series =  X L X C

                   RT

     Qseries = 1  X L X C

               RT

      Q series = 1    2 f L
               RT     2 f C

Which simplifies to:

      Qseries = 1 L                                                    (8.13)
               RT C

Effect of Q on Component Voltages

Q will create a multiplying effect on the inductor and capacitor voltages at
resonance. At f0, the current through the circuit will equal the source voltage divided
by R because XC and XL cancel. This current is also flowing through the capacitor
and inductor. Equation 8.12 shows that their reactances are Q times higher than R,
and therefore their voltages will be Q times higher than the source voltage. KVL is
not violated because the voltages across L and C are 180 degrees out of phase and
cancel each other. As the circuit Q is increased, the voltage multiplying effect
becomes more pronounced. In extreme cases it is possible to produce inductor and
capacitor voltages that are more than 100 times larger than the source voltage. As we
move away from the resonant frequency, the multiplying effect decreases. At
frequencies much lower than f0, almost all of the source voltage will appear across
the capacitor with little for the resistor and inductor. At much higher frequencies,
nearly all of the source potential appears across the inductor with nothing seen
across the capacitor or resistor. This can be seen in Figure 8.8, where the source
voltage is unity.

As Q decreases, not only do the capacitor and inductor voltages decrease, but
another effect comes into play. At relatively high Q values, say 10 or more, the
capacitor and inductor maximum voltages occur at approximately f0. At lower Q
values the peaks tend to spread apart, with the capacitor's peak below f0 and that of
the inductor above f0. This is illustrated in Figure 8.9 (again, the source is unity).

302
                               Series Resonance Voltage Plot: High Q

                       0.1                               1              10
                    12
Normalized Voltage  10                                                         Figure 8.8
                                                                               Series resonance: component
                     8                                                         voltages for high Q.
                     6
                     4              VR
                     2
                     0         VC                                 VL
                       0.1
                                                1.0                     10.0
                         0.01       Normalized Frequency
                      1.5
                               Series Resonance Voltage Plot: Low Q
                        1
                               0.1                       1        10    100

                                    VC                        VL               Figure 8.9
                                                                               Series resonance: component
                                                                               voltages for low Q

Normalized Voltage                                   VR

                    0.5

         0                     0.1                       1.0      10.0  100.0
           0.0                      Normalized Frequency

303
Example 8.1                                                                         Figure 8.10
                                                                                    Circuit for Example 8.1.
         Consider the series circuit of Figure 8.10 with the following parameters:
         the source is 10 volts peak, L = 1 mH, C = 1 nF and R = 50 . Find the
         resonant frequency, the system Q and bandwidth, and the half-power
         frequencies f1 and f2.

         We begin by finding the resonant frequency.

                  f 0 = 1 2   L C

                      f0= 1

                       2  1e-31e-9

                      f 0 = 159 kHz

         We now find the magnitude of the inductive reactance, and from that, the
         system Qseries via Equation 8.12.

                      X L = 2 f 0L
                      X L = 2  159 kHz 1 mH
                      X L = 1000 

                     Q series = X L
                                 RT

                     Qseries = 1000 50 
                     Qseries = 20

         Knowing the Q, the bandwidth and corner frequencies can be found via
         Equations 8.4, 8.10 and 8.11.

                      BW = f 0
                               Q

                      BW = 159 kHz 20
                      BW = 7.95 kHz

                      f 1 = f 0 - BW 2
                      f 1 = 159 kHz -7.95kHz 2
                      f 1 155 kHz

304
                 f 2 = f 0 + BW2
                 f 2 = 159 kHz + 7.95kHz 2
                 f 2 163 kHz

     Given the 10 volt peak source, the voltages across the capacitor and inductor
     at the resonance frequency of 159 kHz would be Q times greater, or 200
     volts. At higher or lower frequencies, the increased impedance lowers the
     current and also lowers the voltages across the components. At low
     frequencies, most of the source will appear across the capacitor while at high
     frequencies the inductor voltage will approach the source voltage.

Refining Series Q

As noted in Chapter 2, all inductors have some series resistance associated with
them, usually called Rcoil. This resistance needs to be included as part of the overall
circuit resistance, adding to whatever other series resistance exists. While it is
possible to measure the DC resistance of a coil using a DMM, this will not
necessarily give an accurate value at high frequencies. Thus, a preferred method is to
determine Qcoil at the desired frequency from the inductor's spec sheet, and using the
calculated reactance at that frequency, determine the value of Rcoil. An example of
such a curve is shown in Figure 8.11.

     120

     Q coil                       B

     100

                                              A                                          Figure 8.11
     80                                                                                  Inductor Q graph.

     60

     40

             1 k  10 k  100 k 1 M

                  Frequency (Hz)

305
For instance, using curve A, Qcoil at 100 kHz is approximately 90. If XL is 450  at
this frequency, then Rcoil would be 450 /90, or 5 .
Effectively, Qcoil sets the ceiling for the Q of the series resonant circuit, Qseries. That
is, the system Q can never be higher than the coil Q. To do so would require less
resistance in the loop than Rcoil, which is a practical impossibility. It is also worth
noting that Rcoil will create a deviation in the inductor voltage compared to the ideal
case. This is because vL covers the combination of the inductive reactance in series
with Rcoil, thus the magnitude will be somewhat larger than expected and the angle
will be less than 90 degrees. These deviations tend to be quite small unless the
inductor's Q is fairly low and the remaining circuit resistance is not very much larger
than Rcoil.
Example 8.2

         For the circuit of Figure 8.11, determine the resonant frequency, the system
         Q, the bandwidth, and the ideal maximum voltage across each of the three
         components. Use curve A from Figure 8.11 for the inductor.

                                                                                                                   Figure 8.12
                                                                                                                   Circuit for Example 8.2.

         The first item of importance is finding the resonant frequency.

                  f 0 = 1 2  L C

                      f0= 1

                       2  22e-3 H 50e-9 F

                      f 0 = 4.8 kHz
         The inductive reactance is:

                      X L = 2 f 0L
                      X L = 2  4.8 kHz 22 mH
                      X L = 663.3

         From the graph, Qcoil is approximately 95, meaning Rcoil is:

306
                      Rcoil = X L
                              Qcoil

                      Rcoil = 663.3  95
                      Rcoil = 7 

         Combined with the 140  resistor, we are left with 147 , some 5% higher
         than if we had ignored it. The system Q is:

                     Q series = X L
                                 RT

                     Qseries = 663.3 147
                     Qseries = 4.51

         The Q is on the low side but not extremely so. Now for the bandwidth:

                      BW = f 0
                               Q

                      BW = 4.8 kHz 4.51
                      BW = 1.06 kHz

         Ideally, at f0 we expect vR will be equal to the source of 1 volt peak while the
         inductor and capacitor voltages will be Q times larger, or approximately 4.5
         volts peak. In reality Rcoil will create a voltage divider, reducing the drop
         across the 140  resistor to about 0.95 volts. The change in vL will be
         negligible due to ZL being 663.3489.4°  versus the ideal 663.390° .
         The system Q is relatively low (<10), so the vC and vL peaks will shift a little
         from f0, with vC peaking at a slightly lower frequency and vL slightly higher.

Computer Simulation

Of particular interest in the prior example is the precise shape of the component
responses versus frequency. This can be produced via an AC or frequency domain
simulation. The circuit of Figure 8.12 is captured in a simulator as shown in Figure
8.13, and is modified by adding the inductor's coil resistance below the inductor.

The items of interest are the net resistor voltage which appears between nodes 1 and
2, the capacitor voltage between nodes 2 and 3, and the inductor voltage which
appears from node 3 to ground. The analysis is run from 500 Hz to 50 kHz giving us
a factor of 10 in frequency on either side of f0, as seen in Figure 8.14. First, the peaks
are just below 5 kHz, as expected. The resistor voltage (blue) is about 0.95 volts, and
the inductor (red) and capacitor (green) voltages are about 4.5 volts, as calculated.

307
                                                                                                                   Figure 8.13
                                                                                                                   The circuit of Example 8.2 in a
                                                                                                                   simulator.

Also, note that there is a slight spread between the peaks of the capacitor and
inductor voltages, with vC slightly below f0 and vL slightly above, again just as
expected. At the lowest frequencies, all of the source appears across the capacitor
while at the highest frequencies all of the source appears across the inductor. Note
the similarity between these curves and those of Figures 8.8 and 8.9

                                                                                                                   Figure 8.14
                                                                                                                   Voltage versus frequency for
                                                                                                                   each of the three components of
                                                                                                                   the circuit of Figure 8.13.

And now for a change of pace; a design problem.
308
Example 8.3

         Design a series resonant circuit with a resonant frequency of 100 kHz and a
         bandwidth of 2 kHz using a 10 mH inductor. Assumes the inductor follows
         curve B in Figure 8.14.

         We can find the value for the capacitance by rearranging the resonance
         frequency equation:

                     f 0 = 1 2   L C
                 LC = 1

                                2 f 0
                          C = 2 1

                                (2 f 0) L
                          C = (2  100 kHz )2 1 10 mH
                          C = 253.3 pF

         Knowing the bandwidth and resonant frequency, we can find the system Q:

                     Q series = f 0 BW
                     Qseries = 100 kHz 2 kHz
                     Qseries = 50

         At resonance, the inductive reactance will be:

                      X L = 2 f 0L
                      X L = 2  100 kHz 10 mH
                      X L = 6283

         The preceding tells us that the total series resistance must be:

                      Rseries = X L
                                Q series

                      Rseries = 6283  50
                      Rseries = 125.7

         Curve B indicates that Qcoil is approximately 115 at 100 kHz. Thus, Rcoil is:

309
                 Rcoil = X L
                          Qcoil

                 Rcoil = 6283  115
                 Rcoil = 54.6 

     Consequently, we must add 125.7  - 54.6 , or 71.1 , to the series
     network to achieve the desired system Q. Failure to do so will yield a much
     higher Q than specified, resulting in a much reduced bandwidth. The
     completed design is shown in Figure 8.15.

                                                                                                             Figure 8.15
                                                                                                             Completed circuit design for
                                                                                                             Example 8.3.

8.3 Parallel Resonance                                                                    Figure 8.16
                                                                                          Ideal parallel resonant circuit.
If the three RLC components are placed in parallel, as in Figure 8.16, a parallel
resonant circuit can result. Typically, it would be driven by a current source as         Figure 8.17
shown, although this is not a requirement for resonance. Parallel resonance is            Realistic parallel resonant
slightly more complicated than series resonance due to the fact that the series coil      circuit.
resistance cannot be lumped in with the remaining circuit resistance as it can with
the series case. In other words, the practical reality is that we have a series-parallel
circuit where the inductor is, in fact, a series combination of the inductance and
the coil resistance. It turns out that usually this resistance cannot be ignored, even
if it is very small. To alleviate this problem, it is possible to find a parallel
equivalent for the series inductive reactance and associated coil resistance. That is,
we need a series to parallel transform.

Series to Parallel Inductor Transform

First, let's take a look at what we have in practical terms. A realistic parallel
resonant circuit is illustrated in Figure 8.17. This circuit adds the internal coil
resistance of the inductor to the ideal circuit shown in Figure 8.16. What we
would like to do is derive a means of finding the parallel equivalent of the
inductor with its coil resistance. Certainly, this should be possible to do. After all,
it is a trivial exercise to do the reverse; namely, taking a parallel combination of

310
an inductor and resistor and finding its series equivalent (i.e., expressing the
resulting impedance in rectangular form). After completing the process we should
have an equivalent circuit like that shown in Figure 8.18. In this equivalent circuit, R
and C are the values from the original circuit while L(p) and Rcoil(p) are the parallel
equivalent transformed values derived from the original inductor. In this version, it
is easy to combine R in parallel with Rcoil(p) to create a single resistor and thus wind
up back at our ideal circuit of Figure 8.16.

                                                                                                                   Figure 8.18
                                                                                                                   Transformed (equivalent)
                                                                                                                   version of a realistic parallel
                                                                                                                   resonant circuit.

For the equivalent transform, refer to Figure 8.19. We start with a practical coil
consisting of a series combination of resistance and inductive reactance, Rs + jXs.
We will find the parallel equivalent, Rp || jXp.

                                                                                                                   Figure 8.19
                                                                                                                   Series and equivalent parallel
                                                                                                                   RL combinations.

We begin with the reciprocal conductance/resistance rule:

     Rs+jX s = 1 1 1                                       (8.14)
                       +

                   R p jX p
         1 =1+1
     Rs+jX s R p jX p

The next step is to isolate the real and imaginary parts of the series version. We can
do this by multiplying the left term of Equation 8.10 by the complex conjugate to
arrive at an equivalent:

        1 Rs - jX s = 2 2 Rs + 2 2 - jX s
     Rs+ jX s Rs - jX s Rs +X s Rs +X s

311
Substituting this equivalent back into Equation 8.14 yields,

              2 2 Rs + 2 2 - jX s = 1 + 1
            Rs +X s Rs +X s R p jX p

Therefore,

            1=     Rs

            Rp Rs +X s2            2

             1 = 2 2 - jX s
            jX p Rs+X s

Taking the reciprocal results in:

                   Rs2+X s2                                              (8.15)
            Rp =

                      Rs

                      Rs2+X s2                                           (8.16)
            jX p = j

                         Xs

For high Q coils (Qcoil  10), Xs >> Rs, so we can approximate these as:

                  X s 2 2                                                (8.17)
            Rp  = Q coil X s = Q coil Rs

                   Rs

                      X s2                                               (8.18)
            jX p  j = jX s

                      Xs

Thus, for a high Qcoil, the parallel equivalent reactance is unchanged from the series
value and the parallel equivalent resistance is the series resistance times the Q of the
coil squared. Interestingly, Equation 8.17 shows that a smaller RS (which yields a
proportionally larger Qcoil) results in a larger RP. Thus, the ideal inductor which
would have no coil resistance results in an Rp of infinity. Due to this resistive
"inversion" of the series-parallel transform, parallel circuit Q is defined as:

            Qparallel = RT                                               (8.19)
                        XL

     Where
     Qparallel is the Q of the parallel resonant circuit (i.e., Qcircuit for parallel),
     RT is the total parallel resistance (Rp || R),
     XL is the reactance at f0.

312
Based on Equation 8.19 and the development of Equation 8.13, it can be shown that:

                                     Qparallel = RT CL                 (8.20)

For higher Q circuits (Qparallel  10), f0 is found as in the series case (repeating):

                                    f 0= 1 2   LC (8.2)

For lower Q circuits, f0 will be reduced slightly due to the fact that the transformed
resistance is frequency dependent. More on this in an upcoming section.

Parallel Resonance Impedance

A parallel impedance plot is shown in Figure 8.20. The effect is the inverse of the
series case. At low frequencies the small inductive reactance results in a low
impedance magnitude with a positive (inductive) phase angle. At high frequencies
the small capacitive reactance results in a low impedance magnitude with a negative
(capacitive) phase angle. At resonance the reactive values cancel. This leaves just the
parallel resistive value which produces the characteristic peak in impedance. The
phase angle is zero, corresponding to a power factor of unity.

                                    Parallel Resonance Impedance Plot

                              0.01  0.1                 1      10      100
                           100                                         1
                                                                                                                                                                Figure 8.20
                            50                                                                                                                                  Impedance plot for parallel
                                                                                                                                                                resonant circuit.

                                                                       0.8                                                      Normalized Impedance Magnitude

Impedance Phase (degrees)                                                                                                  0.6
                           0

                                                                                                                           0.4

      -50                           Dashed: Lower Q                        0.2
    -100                                                                   0
                                    0.1                 1.0  10.0      100.0
          0.0                            Normalized Frequency

313
If the parallel resonant circuit is driven by a current source, then the voltage
produced across the resonant circuit (sometimes referred to as a tank circuit) will
echo the shape of the impedance magnitude. In other words, it will effectively
discriminate against high and low frequencies and keep only those signals in the
vicinity of the resonant frequency. This is one method of making a bandpass filter.
The lower and upper half-power frequencies, f1 and f2, are found in the same manner
as in series resonance.

Repeating for convenience:

     BW = f 2 - f 1                     (8.3)
     Qcircuit = f 0 BW                  (8.4)

     f0= f1 f2                          (8.5)

     f0= f2                             (8.6)
     f1 f0

      k0 = 1 + 2 1 +1                   (8.7)
     2Q circuit             4 Qcircuit  (8.8)

     f 1= f0
           k0

     f 2 = f 0×k0                       (8.9)

For higher Q circuits (Qcircuit  10), we can approximate symmetry, and thus

     f 1  f 0 - BW 2                    (8.10)
     f 2  f 0+ BW 2                     (8.11)

Finally, it is worth repeating that for relatively low Q values there will be some
shifting of the resonant and half-power frequencies from the equations presented
above.

There are some similarities between parallel and series resonance. Like series, as the
parallel Q increases, the impedance curve becomes sharper and the phase change is
more abrupt. Further, we also see an apparent "Q amplification" effect in parallel
resonant circuits, however, here it will be the reactive currents that will be increased
relative to the source current instead of the series component voltages.

314
Note that the parallel resistor can be used to lower the system Q and thus broaden
the bandwidth, however, the system Q can never be higher than the Q of the inductor
itself. The inductor sets the upper limit on system Q and therefore, how tight the
bandwidth can be. In other words, Qcircuit  Qcoil. This is the same situation we saw for
series resonance.

Example 8.4

     For the circuit of Figure 8.21, determine the resonant frequency, the corner         Figure 8.21
     frequencies of f1 and f2, the bandwidth and the system Q. Also find the              Circuit for Example 8.4.
     circuit voltage at the resonant frequency. Rcoil = 100 .

     First, we'll assume this is a high Q ( 10) circuit.

             f 0= 1 2   L C

             f 0= 1

                 2  50 mH 910 pF

             f 0=23.6 kHz

             X L = 2 f L
             X L = 2  23.6 kHz 50 mH
             X L = 7.41 k 

             Qcoil = X L
                      Rcoil

             Qcoil = 7.41 k  100 
             Qcoil = 74.1

     The parallel equivalent of the coil resistance is:

             R p = Rcoil Qcoil 2
             Rp = 10074.12
             Rp = 549.5 k 

     There is no other resistor in parallel with the inductor and capacitor,
     therefore the equivalent parallel resistance, Rp, is the total resistance of the
     circuit, RT. Consequently, the Q of the circuit must be the same as Qcoil. We
     can verify this as follows:

315
                 Qparallel = RT
                             XL

                 Qparallel = 549.5 k  7.41 k 
                 Qparallel = 74.1

     Our initial assumption of high circuit Q is met.

                 BW = f 0
                          Qparallel

                 BW = 23.6 kHz 74.1
                 BW = 318 Hz

                 f 1  f 0 - BW 2
                 f 1 23.6 kHz - 318Hz 2
                 f 1 23.44 kHz

                 f 2  f 0 + BW 2
                 f 2 23.6 kHz +318 Hz 2
                 f 2 23.76 kHz

     To find the circuit voltage at f0, simply multiply the resonant impedance of
     549.5 k times the source of 2 mA. This yields approximately 1100 volts.

Computer Simulation

The circuit of Example 8.4 is captured in a simulator as shown in Figure 8.22.

                                                                                   Figure 8.22
                                                                                   The circuit of Figure 8.21 in a
                                                                                   simulator.

316
A frequency domain or AC analysis is run on the circuit, plotting the magnitude of
the source voltage (node 1) from 2 kHz to 200 kHz. This will give us roughly a
factor of ten on either side of the resonant frequency. The result is shown in Figure
8.23. The plot shows a clear and sharp peak in the low 20 kHz region. Note that the
peak voltage is just over 1000 volts, as predicted. Figure 8.24 shows a magnified
version of this plot so that we can accurately verify the peak voltage along with f1
and f2.

                                                                                                                   Figure 8.23
                                                                                                                   Source voltage of the circuit of
                                                                                                                   Figure 8.22.

Figure 8.24 shows that the peak is indeed approximately 1100volts. The f1 and f2
frequencies are found at 0.707 times this peak, or some 778 volts. Two measurement
cursors are employed for this task. The Y values are the voltages at the cursor's
intersection with the curve and the X values are the corresponding frequencies. We
can see that the results are in tight agreement with the calculations. At levels of
about 777 to 780 volts we obtain f1 and f2 values of approximately 23.44 kHz and
23.75 kHz, respectively.

317
                                                                                                                   Figure 8.24
                                                                                                                   Magnified peak of the plot of
                                                                                                                   Figure 8.23.

Example 8.5
         For the circuit of Figure 8.25, determine the resonant frequency, the corner
         frequencies of f1 and f2, the bandwidth and the system Q. Also find the
         circuit voltage at the resonant frequency. Rcoil = 100 .

                                                                                                                   Figure 8.25
                                                                                                                   Circuit for Example 8.5.

         This circuit is identical to the one in the previous example with the
         exception of an added 100 k  load resistor. This should lower the system Q
         and thus widen the bandwidth. The peak impedance will also be reduced
         which will cause a decrease in the system voltage at resonance. Some
         parameters will not change. They include:

                   f0 = 23.6 kHz
                   XL = 7.41 k 

318
                   Qcoil = 74.1
                   Rp = 549.5 k 

         We'll assume this is a high Q ( 10) circuit.

         Rp is in parallel with the load resistance of R yielding an effective parallel
         resistance of 549.5 k || 100 k, or 84.6 k.

                     Qparallel = RT
                                  XL

                     Qparallel = 84.6 k  7.41 k 
                     Qparallel = 11.4

         The circuit Q is much reduced but our initial assumption of high circuit Q is
         still met. Now we can find the bandwidth and corner frequencies.

                      BW = f 0
                               Qparallel

                      BW = 23.6 kHz 11.4
                      BW = 2.07kHz

                      f 1  f 0 - BW 2
                      f 1 23.6 kHz - 2.07 kHz 2
                      f 1 22.56 kHz

                      f 2  f 0 + BW 2
                      f 2 23.6 kHz + 2.07 kHz 2
                      f 2 24.64 kHz

         The circuit voltage at f0 is reduced to 84.6 k times 2 mA, or 169.2 volts.

Computer Simulation

The simulation results follow those of Example 8.4 and are shown in Figure 8.26.
The results agree with the computed values. The peak voltage has been reduced to
about 170 volts, and f1 and f2 (found at 0.707 times the peak, or approximately 120
volts) are about 22.5 kHz and 24.6 kHz, respectively.

319
                                                                                   Figure 8.26
                                                                                   Simulation results for the
                                                                                   circuit of Example 8.5.

Example 8.6                                                                        Figure 8.27
                                                                                   Circuit for Example 8.6.
         Consider the circuit of Figure 8.27 with the following parameters:
         L=2 mH, C=10 nF, and Qcoil = 25. Determine the resonant frequency
         and a value for R such that the system bandwidth is 3 kHz.

         As usual, we'll assume this is a high Q ( 10) circuit. This is certainly
         true of the coil, although we have to determine the resonant frequency
         in order to determine the Q of the circuit.

                  f 0= 1 2   L C

                      f 0= 1

                      2  2 mH 10 nF

                      f 0=35.59 kHz

                     Qparallel = f 0 BW
                     Qparallel = 35.59 kHz 3 kHz
                     Qparallel = 11.86

320
We have high Q and can continue18. Ultimately, we need to determine the
total parallel resistance required to achieve this Q. Before we can do that we
need to determine XL.

X L= 2 f L
X L = 2  35.59 kHz 2 mH
X L = 447 

RT = Q parallel× X L
RT = 11.86×447
RT = 5.3 k 

RT is the parallel combination of R and Rp (the parallel equivalent of Rcoil), so
first we need to find Rcoil.

Rcoil = X L
         Qcoil

Rcoil = 447 25
Rcoil = 17.9 

The parallel equivalent resistance of Rcoil is:

R p = Rcoil Qcoil 2

                              2

Rp = 17.9 25
Rp = 11.18 k 

Using the conductance rule, we can find the requisite value of R.

R = 1 1 1
          -

      RT R p

R= 1            1
                      1
5.3 k  -11.18 k 

R = 10.08 k 

Thus, we need to use a 10.08 k resistor in order to lower the circuit Q
enough to achieve a 3 kHz bandwidth. Without this resistor, the bandwidth
will be less than half of what is required.

18 Note that if this value had been greater than 25 we'd be stuck for a different reason;
    namely that we'd need to obtain a higher quality inductor because Qcircuit can't be any
    higher than Qcoil.

321
Computer Simulation

Figure 8.28 shows the completed design of the previous example captured in a
simulator. A 1 mA current source is used for convenience of calculation.

                                                                              Figure 8.28
                                                                              Circuit design of Example 8.6
                                                                              in a simulator.

Given that RT is 5.3 k , the 1 mA current source should produce 5.3 volts at the
resonance frequency of 35.59 kHz. The results of an AC analysis are shown in
Figure 8.29.

                                                                                                                   Figure 8.29
                                                                                                                   Frequency response of the
                                                                                                                   design from Example 8.6.

322
First off, the f0 of approximately 35.6 kHz is verified by both the peak in voltage and
the phase angle reaching 0° at this frequency, the latter indicating perfect
cancellation between the inductor and capacitor (i.e., the circuit impedance is purely
resistive and achieving unity power factor). The cursors are used to obtain accurate
values for f1 and f2. These frequencies are reached at 0.707 of the peak of 5.3 volts,
or about 3.75 volts. The frequencies are approximately 34.15 kHz and 37.15 kHz,
achieving the desired bandwidth of 3 kHz.

Low Q Parallel Resonance

There are some changes in the computations when Qparallel is low. Generally, this
means values below 10, although we might think of values between 5 and 10 to be a
transition region where deviations of two percentage points or less come into play.
Once the circuit Q falls below 5, the deviations from the high Q equations grow
rapidly and quickly rise into double digit percentages. The main item of interest here
is the shift in f0.

These deviations are caused by the fact that the approximations used for Equations       Figure 8.30
8.17 and 8.18 are no longer true. That is, with low Qcoil values, we can no longer       Parallel RLC network with
assume that the transformed XL is the same as the original XL (i.e., Xp and Xs in        exact series transform
Figure 8.19). Given this fact, we can revisit the basic parallel RLC circuit, but this   equivalent.
time using the exact value from the series-to-parallel inductor transform. This is
shown in Figure 8.30. RLoad is the combined resistance of the parallel network while
Xp is the equivalent value obtained from Equation 8.16 (slightly modified and
repeated for convenience):

                           X 2+R2
                   Xp=

                              X

X and R in this equation are the original series values for the inductor. At f0, the
magnitudes of the reactances are equal, or XC = Xp, therefore,

                           X 2+R2
                   XC =

                              X

Expanding yields:

                   1 = (2  f 0 L)2+R2
                   2 f 0C          2 f 0L

Now rearrange and simplify.

                   2 f0L           22
                           = (2  f 0 L) +R
                   2 f 0C

323
                         L       22
                            = (2  f 0 L) +R
                         C

       (2  f 0 L)2 = LC -R2

        2 f 0 L = LC -R2
        2 f 0 =              1 R2
                                 -2

                            LC L

       2 f 0 = 1 1 - C R2    LC
                                     L

And finally we come to:

        f 0 = 1 1 - C R2         L                 (8.21)
       2   LC

If desired, we can treat the first term as the ordinary series resonant frequency and
the second term as a fractional coefficient, as in:

       f 0 = f series k p                          (8.22)

Where

          C R2                                     (8.23)

                     kp= 1-
                                     L

Using Equation 8.20, kp may also be expressed as:

       k p = 1 - 2 1                               (8.24)
                    Q

Examining Equation 8.23 might lead to some concern, namely, what happens if the
second term is greater than or equal to 1? Remember, the definition we're using for
resonance is the frequency at which the reactances cancel, which means the phase
angle is 0° (unity power factor). If the second term is greater than or equal to 1, the
phase shift will never reach 0°, and by that definition, we don't really have a
resonant circuit anymore.

We will explore the reality of this situation by starting with a simple high Q parallel
circuit and then investigate the changes in the magnitude and phase response as the
Q is decreased. We begin with the circuit of Figure 8.31.

324
Assuming we have high circuit Q, the resonant frequency is:                                Figure 8.31
                                                                                           A basic parallel network.
                  f 0= 1 2   L C

                      f 0= 1

                      2  1 mH 100 nF

                      f 0=15.92 kHz

                      X L= 2 f L
                      X L = 2  15.92 kHz 1 mH
                      X L = 100

                     Qcoil = X L
                               Rcoil

                     Qcoil = 100  5 
                     Qcoil = 20

There are no other resistances in the circuit, therefore Qcircuit = Qcoil and our initial
assumption is correct. The circuit is captured in a simulator and an AC analysis is
performed. The resulting plots are shown in Figure 8.32.

                                                                                           Figure 8.32
                                                                                           Simulation results using a coil
                                                                                           resistance of 5  (Q of 20).

325
The resonant frequency appears to be just under 16 kHz, as predicted. Cursor-based
measurement of the frequency at which the phase crosses 0° yields 15.89 kHz. This
turns out to be even closer than it seems. In spite of the high circuit Q, kp was
calculated and as expected is very close to unity, namely 0.99875. When multiplied
by the ideal f0 (i.e., using Equation 8.22), we arrive at 15.90 kHz. Splitting hairs
perhaps, but it's good to know the deviation is shrinking.
Next, the coil resistance is raised to 50 , yielding a Q of only 2. The simulation is
run a second time. kp drops to 0.866 with this lowered Q and should produce an f0 of
approximately 13.77 kHz. The plots are shown in Figure 8.33, and zoomed in for a
better view. From the lower graph it is obvious that the frequency where the curve
reaches 0° is just below 14 kHz. Accurate measurement yields 13.78 kHz, right in
line with the theoretical computation.

                                                                                                                   Figure 8.33
                                                                                                                   Simulation results using a coil
                                                                                                                   resistance of 50  (Q of 2).

Finally, the coil resistance is increased to 100 . This drops the circuit Q to 1 and
more importantly, brings kp down to 0. The resulting simulation plots are shown in
Figure 8.34. At first glance the phase plot looks similar to that of Figure 8.32,
however, notice that the phase scale has changed with 0° as the maximum. In fact,
the phase shift never quite reaches 0°. In this regard we can still say that the kp
equation remains an accurate predictor.

326
                                                                                            Figure 8.34
                                                                                            Simulation results using a coil
                                                                                            resistance of 100  (Q of 1).

Alternate Definition for Parallel Resonant Frequency

Instead of defining the parallel resonant frequency as the point where the power
factor is unity, i.e., where XL and XC have the same magnitude, it can be defined in
terms of the frequency where the magnitude of the impedance is maximum. For high
Q circuits the two definitions produce essentially the same frequency, however, as
the circuit Q decreases into the single digits, the frequency of maximum impedance
begins to deviate from both the high Q idealization and the general unity power
factor definition. In fact, the frequency of maximum magnitude is situated between
the two. We shall refer to this frequency as fZ-max to avoid confusion. The formula is:19

 f Z-max = f 0  2 2 +1 - 2 1                          (8.25)
                Qcircuit  Q circuit

19 For a non-calculus proof, see K. Cartwright, E. Joseph, E. Kaminsky, "Finding the Exact
Maximum Impedance Resonant Frequency of a Practical Parallel Resonant Circuit Without
Calculus", Technology Interface International Journal, vol. 11, no. 1, Fall/Winter 2010.
[Online Serial]. Available: http://tiij.org/issues/issues/winter2010/fall_winter_2010.htm
[Accessed February 15, 2020 ].

327
This equation will yield a value between the ideal high Q case and the unity power
factor case. This can be seen in Figure 8.34 where there is still an impedance peak
(as evidenced by the voltage peak) in spite of the fact that a phase angle of 0° is not
reached. Furthermore, the frequency of the peak is below that of the high Q case.
Equation 8.25 predicts a peak at 13.6 kHz which agrees with the value obtained
from the simulation.

Combination Series and Parallel Resonance

In closing our discussion on resonance we might ask whether or not there are
practical, everyday examples of systems exhibiting series and parallel resonance in
series-parallel circuits. The answer is yes. A good example is that of a basic dynamic
moving coil loudspeaker of the type seen in Chapter 2. This is an electro-mechanical
system and thus a proper model has to include the effects of such items as the
mechanical losses in the system, the mass of the cone, and the like. One possibility
is shown in Figure 8.35. Lvc and Rvc are the inductance and resistance of the voice
coil. The remaining components model other aspects of the electro-mechanical
system. An impedance plot of a typical loudspeaker is shown in Figure 8.36.

                                                                                                                   Figure 8.35
                                                                                                                   Equivalent electrical network
                                                                                                                   of a single dynamic
                                                                                                                   loudspeaker.

                                                                                                                                                Adapted from R.H.Small, "Direct-
                                                                                                                                                Radiator Loudspeaker System
                                                                                                                                                Analysis", Journal of the Audio
                                                                                                                                                Engineering Society, June 1972

                                                                                                                   Figure 8.36
                                                                                                                   Impedance magnitude and
                                                                                                                   phase of a typical dynamic
                                                                                                                   loudspeaker.

                                                                                                                                                Courtesy Dayton Audio

328
The loudspeaker of Figure 8.36 is a medium-size woofer with a nominal impedance
of 8 . First, note the large variation on both the phase and magnitude of the
impedance. The parallel items from the model produce an obvious peak in
impedance just below 30 Hz. This is referred to as the free air resonance and is
denoted by fs. For this device, the magnitude is over three times the nominal value.
Also note that the phase angle is 0° at fs, and that the phase is positive (inductive)
below the resonant frequency and negative (capacitive) above it. This behavior is
expected from a parallel resonant system. The series elements of the model create
the rising impedance that is seen following the dip. Note that the phase angle
continues to increase as frequency rises, indicating the growing dominance of the
series inductive element.

8.4 Summary

Resonance can be described as a preferred mode of vibration, or a frequency at
which a system operates particularly well. Resonant systems can be used to filter out
or select specific frequencies across the spectrum. Obvious uses include tuning
circuits, oscillators, filters and the like. In electrical systems there are two basic
forms; series RLC resonance and parallel RLC resonance. Series resonance tends to
be the less complicated of the two.

For series resonance, the resonant frequency, f0, is defined as the frequency at which
the magnitude of XL equals the magnitude of XC. In this instance, the reactances
cancel, leaving the series impedance as R. This creates a U-shaped curve for the
impedance as it varies across the frequency spectrum. At low frequencies, the
capacitive reactance dominates and the series impedance is high in magnitude and
capacitive. At frequencies above the resonant frequency, the inductive reactance
dominates and the series impedance is again high in magnitude but it is inductive. If
this circuit is driven with a constant voltage source, the current will be maximum at
resonance and tail off at lower and higher frequencies. The sharpness of the current
curve across frequency is a function of the system Q, or quality factor. A high Q
circuit is one with a very sharp and narrow curve. The "shoulders" of the curve are
defined as the frequencies at which the power has dropped to one half of the value at
resonance. This corresponds to 0.707 times the current at resonance. The lower
frequency is f1 and the upper frequency is f2. The difference between the two is
called the bandwidth, BW. The ratio of resonant frequency to the bandwidth yields
the circuit Q. Circuit Q can also be found by dividing the magnitude of reactance at
resonance to the total circuit resistance. In high Q circuits it is possible for the
voltage across the inductor or capacitor to be many times higher than the source
voltage, higher in fact, by a factor of Q.

329
Parallel resonance is similar to series resonance but in some ways is like its mirror
image. In a parallel resonant circuit the inductor will dominate at low frequencies
and produce a small net impedance. At high frequencies, the capacitor will dominate
and also produce a small net impedance. At resonance, the two effectively will
cancel and yield a large impedance. In other words, the impedance versus frequency
curve will appear like an upside down U, producing maximum impedance at
resonance, and the opposite of the series impedance curve. If this system is driven
by a constant current source, the resulting voltage will echo the shape of the
impedance curve, producing maximum voltage at resonance. The upper and lower
frequencies, along with the bandwidth and system Q, are defined in the same manner
as they are in the series case (with one exception regarding finding Q via resistance
and reactance).

There is one important caveat regarding parallel resonant circuits. Practical inductors
contain a non-trivial series coil resistance. This can play a dominant role in the
system response. Analysis is generally handled by performing a series to parallel
transform which creates a parallel resistance out of the inductor's series resistance.
As a result, system Q can be found as the ratio of effective parallel resistance to
maximum reactive magnitude, the opposite of the series case. For high Q systems,
generally taken as 10 or higher, the resonant frequency can use the same equation as
the series case. For low Q systems, the series to parallel transform creates a shift in
resonant frequency, making it somewhat lower than the value obtained from the
basic series equation. Also, the inductor and capacitor currents will be approximately
Q times higher than the source current, made possible because they are 180 degrees
out of phase with each other and effectively cancel.

In both series and parallel systems, for high Q, f1 and f2 are assumed to lie
equidistant from f0, splitting BW in half on either side. This is just an approximation
and errors will grow as the Q decreases. More accurately, the two frequencies lie
where the ratio of f1/f0 is the same as the ratio of f0/f2.

Review Questions

    1. Describe the concept of resonance. How is resonance defined in a series
         RLC network?

    2. Sketch the impedance versus frequency plot for series resonance.
    3. Sketch the impedance versus frequency plot for parallel resonance.
    4. Define the terms resonant frequency, bandwidth and Q.
    5. How does inductor Q impact system Q in resonant circuits?

330
8.5 Exercises                               A

      Q                                     B
  50                             C

  40                                         D

  30

  20

10

                                                                 Frequency (Hz)

          1 k  10 k  100 k  1 M  10 M

          Inductor Q curves to be used with the exercises below

Analysis

     1. A circuit has a resonant frequency of 440 kHz and a system Q of 30.
         Determine the bandwidth and the approximate values for f1 and f2.

     2. A circuit has a resonant frequency of 19 kHz and a bandwidth of 500 Hz.
         Determine the system Q and the approximate values for f1 and f2.

     3. Find the Qcoil and coil resistance of a 150 H inductor at 100 kHz using
         device curve A.

     4. Find the Qcoil and coil resistance of a 2.2 mH inductor at 50 kHz using
         device curve D.

     5. At a certain frequency, an inductor's impedance is 24 + j600 . Determine
         the parallel resistance and reactance that produces the same value.

331
    6. At a certain frequency, an inductor's impedance is 3 + j150 . Determine the
         parallel resistance and reactance that produces the same value.

    7. A certain 75 H inductor is described by curve B. Determine the equivalent
         parallel inductor/resistor combination at 1 MHz.

    8. A certain 3.3 mH inductor is described by curve C. Determine the equivalent
         parallel inductor/resistor combination at 20 kHz.

    9. Consider a series circuit consisting of a 2 nF capacitor, an ideal 33 H
         inductor and a 5  resistor. Determine the resonant frequency, system Q,
         and bandwidth.

    10. Consider a series circuit consisting of a 20 nF capacitor, an ideal 100 H
         inductor and a 2.7  resistor. Determine the resonant frequency, system Q,
         and bandwidth.

    11. Consider a series circuit consisting of a 50 nF capacitor, a 20 mH inductor
         with Qcoil of 50 and a 63  resistor. Determine the resonant frequency,
         system Q, and bandwidth.

    12. Consider a series circuit consisting of a 200 nF capacitor, a 1 mH inductor
         with Qcoil of 65 and a 72  resistor. Determine the resonant frequency,
         system Q, and bandwidth.

    13. For the circuit shown in Figure 8.37, determine the resonant frequency,
         system Q and bandwidth. Assume Rcoil = 0 . If the source is 1 volt peak,
         determine the capacitor voltage at resonance.

                                                                                Figure 8.37

    14. For the circuit shown in Figure 8.38, determine the resonant frequency,
         system Q and bandwidth. Assume Rcoil = 0 . If the source is 10 volts,
         determine the capacitor voltage at resonance.

                                                                                Figure 8.38

332
    15. Repeat problem 13 but assume instead that the inductor's Rcoil = 15 .
    16. Repeat problem 12 but assume instead that the inductor follows curve D.
    17. For the circuit shown in Figure 8.39, determine the resonant frequency,

         system Q and bandwidth. If the source is 20 mA peak, determine the resistor
         and capacitor voltages at resonance.

                                                                                Figure 8.39

    18. For the circuit shown in Figure 8.40, determine the resonant frequency,
         system Q and bandwidth. If the source is 100 mA, determine the resistor and
         capacitor voltages at resonance.
                                                                                Figure 8.40

    19. For the circuit shown in Figure 8.41, determine the resonant frequency,
         system Q and bandwidth. If the source is 15 volts, determine the inductor
         and capacitor currents at resonance. Assume the inductor's coil resistance is
         3.2 .
                                                                                Figure 8.41

333
    20. For the circuit shown in Figure 8.42, determine the resonant frequency,
         system Q and bandwidth. If the source is 3 volts, determine the inductor and
         capacitor currents at resonance. Assume the inductor's Q is 30.
                                                                                Figure 8.42

    21. For the circuit shown in Figure 8.43, determine the resonant frequency,
         system Q and bandwidth. If the source is 15 volts, determine the resistor,
         inductor and capacitor currents at resonance.
                                                                                Figure 8.43

    22. Given the circuit shown in Figure 8.44, determine the resonant frequency,
         system Q and bandwidth. If the source is 2 volts, determine the resistor,
         inductor and capacitor currents at resonance. Assume the inductor's coil
         resistance is 2.5 .
                                                                                Figure 8.44

    23. For the circuit shown in Figure 8.45, determine the resonant frequency,
         system Q and bandwidth. If the source is 5 volts, determine the resistor,
         inductor and capacitor currents at resonance. Assume the inductor's Q is 40.
                                                                                Figure 8.45

334
    24. Given the circuit shown in Figure 8.46, determine the resonant frequency,
         system Q and bandwidth. If the source is 2.5 mA, determine the resistor
         voltage and the three branch currents at resonance.
                                                                                Figure 8.46

    25. For the circuit shown in Figure 8.47, determine the resonant frequency,
         system Q and bandwidth. If the source is 500 A, determine the resistor
         voltage and the three branch currents at resonance. Assume the inductor's Q
         is given by curve C.
                                                                                Figure 8.47

    26. Given the circuit shown in Figure 8.48, determine the resonant frequency,
         system Q and bandwidth. If the source is 10 mA, determine the resistor
         voltage and the three branch currents at resonance. Assume the inductor's Q
         is given by curve B.
                                                                                Figure 8.48

Design

    27. A series resonant circuit has a required f0 of 50 kHz. If a 75 nF capacitor is
         used, determine the required inductance.

    28. A series resonant circuit has a required f0 of 210 kHz. If a 22 H inductor is
         used, determine the required capacitance.

335
    29. A parallel resonant circuit consists of a 12 nF capacitor and a 27 H inductor
         with a Qcoil of 55. Determine the required additional parallel resistance to
         achieve a system Q of 40.

    30. A series resonant circuit has a design target of f0=200 kHz with a bandwidth
         of 5 kHz. Which of the inductor curves above (A, B, C, D) represent
         possible candidates, if any, and why/why not?

    31. A parallel resonant circuit has a design target of f0=1 MHz with a bandwidth
         of 20 kHz. Which of the inductor curves above (A, B, C, D) represent
         possible candidates, if any, and why/why not?

Challenge

    32. A parallel resonant circuit has a required f0 of 50 kHz and a bandwidth of
         4 kHz. If a 75 nF capacitor is used and the load impedance is 100 k,
         determine the required inductance and minimum acceptable Qcoil.

    33. A parallel resonant circuit consists of a 150 nF capacitor and a 200 H
         inductor that has a coil resistance of 1 . The desired bandwidth for the
         network is 2 kHz. Determine the value of resistance to be placed in parallel
         with the network in order to achieve this goal.

    34. A resonant circuit consists of a 4 nF capacitor in parallel with a 100 H coil
         that has a coil resistance of 5 . Determine the resonant frequency and
         bandwidth. Further, assume that this circuit is now loaded by an amplifier
         that has an input impedance equivalent to 10 k resistive in parallel with
         500 pF of input capacitance. Also, the amplifier is connected via 25 feet of
         coaxial cable that exhibits a capacitance of 33 pF per foot. Determine the
         changes in resonant frequency and bandwidth, if any, with this load.

Simulation

    35. Use an AC frequency domain analysis to verify the results of problem 13.
         Plot the resistor voltage from 0.1 f0 to 10 f0.

    36. Use an AC frequency domain analysis to verify the results of problem 19.
         Do this by overlapping plots of the resistor, capacitor and inductor voltages
         across a range of 0.1 f0 to 10 f0.

336
    37. Investigate the effects of inductor Q on the system bandwidth of problem
         21. Plot the system voltage from 0.01 f0 to 100 f0 three times, the first using
         the specified coil resistance and then using values ten times larger and ten
         times smaller.

    38. Investigate the effects of component tolerance on the system frequency
         response of problem 21. Plot the system voltage from 0.1 f0 to 10 f0 using a
         Monte Carlo variation on the AC frequency domain response. Set a 10%
         tolerance on the capacitor, inductor and resistor but do not alter the coil
         resistance.

    39. Use an AC frequency domain analysis to verify the design of problem 27.
         Plot the resistor voltage from 0.1 f0 to 10 f0.

    40. Use an AC frequency domain analysis to verify the design of problem 29.
         Plot the system voltage from 0.1 f0 to 10 f0.

    41. At high Q values (>10) the capacitor and inductor voltages of series
         resonant circuits will tend to reach maximum very close to the resonant
         frequency. At lower Qs, these peaks tend to diverge. A similar situation
         occurs with the currents in parallel resonant circuits. Investigate this effect
         by performing an AC frequency domain analysis on problem 14. Overlay
         plots of vab, vbc and vc for successively larger values of resistance.

    42. Investigate the "Q increase" in reactive currents compared to source and
         resistive currents in a parallel resonant circuit. A simple way to verify this is
         by placing AC ammeters in each of the branches of the circuit shown in
         Figure 8.49. Use R = 630 , C = 40 nF, L = 10 H and i = 1 mA. It is
         worthwhile to compare sets of simulations for different resistor values to see
         the current changes relative to the system Q. Slight variations of the source
         frequency may be required to reach the peak.
                                                                                Figure 8.49

337
9 Polyphase Power

9.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Define the differences between polyphase and single phase systems and detail their advantages.
    · Determine line voltage, line current, phase voltage and phase current in three-phase systems.
    · Analyze three-phase systems in both delta () and Y (wye) configurations.

9.1 Introduction

In this chapter we shall introduce the concept of polyphase systems. Polyphase systems can be visualized as a
group of individual sources of the same magnitude that are separated by a certain phase angle such that they are
evenly divided across a single period. The polyphase load is similarly divided into individual sections or legs.
By dividing the sources, the application of power can be much more smooth. Further, for the same total load
power, the current delivered by each of the segments is reduced compared to a single phase system. For an
analogy we could look at a bicycle. A single phase system is like pedaling with only one leg. That is, power is
applied in a single burst per revolution of the pedal. Having two pedals is like a two-phase system; power is
delivered twice per revolution, once for the right leg and once for the left. Because there are two pedals, it
makes sense to separate them physically by 180 degrees or one half of a revolution, otherwise the power
delivery will not be smooth. It should obvious to anyone who has pedaled a bike that you must pump a single
pedal much harder using only one leg to achieve the same speed obtained when pumping with both legs.

Polyphase loads can be balanced or unbalanced. A balanced load means that all legs or sections of the load
exhibit the same impedance. Consequently, the currents supplied by the sources will be the same except for the
phase shifts between them. It is possible to create a polyphase system using any number of phases, however, the
more phases we add, the more complex the construction of the polyphase source and load. Also, the number of
required conductors between the source and load increases (one per phase). These all increase construction,
installation and maintenance costs. Polyphase systems using three sections (hereafter simply referred to as
three-phase systems) are popular because they deliver the benefits of polyphase while limiting the complexity
and minimizing the costs. Therefore, we shall our limit our discussion to three-phase systems utilizing balanced
loads.

Three-phase systems can be wired in either delta or Y configurations, or a combination. These are reminiscent of
the delta and Y constructs seen in earlier chapters. We shall investigate all of the combinations to determine
system parameters such as line voltage, line current and load power. We will also investigate power factor
correction for balanced loads that have a non-negligible phase angle.

338
9.2 Polyphase Definition

A polyphase system uses multiple current-carrying wires with multiple sub-
generators, each with their own unique phase. This allows for considerable delivery
of power to the load. The most popular scheme is the three-phase configuration. This
can be visualized as three individual sine generators that are interconnected as
shown in Figure 9.1. To the left is a Y (also known as wye or T) connected generator.
To the right is a delta (i.e. , and also known as  when drawn upside down)
connected generator.

     A     B                 A

                                                                                       Figure 9.1
                                                                                       Three-phase generators:Y-
                                                                                       connected (left) and delta-
                                                                                       connected (right).

        C                 B     C

There are multiple ways of reproducing these generators on schematics. Some
alternate forms for Y-connected generators are shown in Figure 9.2. The lone "tail"
shown on the version to the right is a connection back to the common center of the
three sub-generators. This is called the neutral line. It is not always used.

                                                                                       Figure 9.2
                                                                                       Alternate schematic symbols
                                                                                       for Y-connected generators.

In Figure 9.3 we have some alternate forms for delta-connected generators. Delta
generators do not have the optional fourth connection as there is no common center
point. Also, note that the version on the left is drawn upside down (i.e., in the 
configuration).

                                                                                                                   Figure 9.3
                                                                                                                   Alternate schematic symbols
                                                                                                                   for delta-connected generators.

339
Of particular importance is the relative phase of each source. As the load will also
have three segments or legs (a three-phase load), a consistent delivery of power
demands that the three sources be spread equally over time. This means that each
source is one-third of a cycle, or 120 degrees, out of phase with the other legs (i.e.,
leading one and lagging the other). This is shown in Figure 9.4. We shall only
consider the case of balanced loads, that is, where each leg of the load is identical to
the other legs.

                                         Three Phase

1.0

0.8                                                              Figure 9.4
                                                                 Relative phases of the three
0.6     Phase 1  Phase 2  Phase 3                                sub-generators.

0.4                                                        2

0.2

0.0

-0.2

-0.4

-0.6

-0.8

-1.0             0.5      1                           1.5
     0

                          Time

Notice the effectiveness of using the 120 degree stagger. At any time there is always
either a peak or the shoulders of two adjacent peaks. These peaks can be either
positive or negative polarity. This makes for a total of six peaks across the
waveform's period. Therefore, a null is never more than 30 degrees away from the
nearest peak. Indeed, when it is 30 degrees away, then it's precisely in between two
peaks, and the value from each is the sine of 60 degrees (i.e., 30 degrees off of the
peak at 90 degrees) or 86.6% of the peak value. Thus, it should be obvious that
consistent power can be applied by this system. The inevitable car analogy is that we
have gone from a two cylinder engine to a six cylinder engine when moving from
single phase to three-phase.

There are several ways to connect three-phase generators to three-phase loads, as we
shall see in the next section.

340
9.2 Three-Phase Connections

It is possible to configure systems using delta- or Y-connected sources with either
delta- or Y-connected loads. One item to note is that delta-connected systems are
always three wire systems while Y-connected systems can make use of a fourth
neutral wire (the common point to which all three sources connect).

Homogeneous Systems

The most straightforward systems are delta-to-delta and Y-to-Y. We shall refer to
these as homogeneous systems as the structures of the generator and load are similar.
Examples are shown in Figures 9.5 and 9.6, respectively.

            A                        A'

        +        -             Z           Z                                              Figure 9.5
                                                                                          A delta-connected generator
    -                +                                                                    with a delta-connected load
B                       C                                                                 (delta-delta).

         +     -           B'        Z             C'

A                  B       A'                  B'                                         Figure 9.6
    +          +                                                                          A Y-connected generator with
         --                       Z        Z                                              a Y-connected load (Y-Y).
                                                                                          Optional fourth neutral wire
      -                              Z                                                    from center to center shown.

      +                                C'
       C

In these configurations, each leg of the load matches up with a corresponding leg of
the generator. In the delta-delta configuration of Figure 9.5, it should be obvious just
by inspection that the voltage across any load leg must equal the voltage of the
corresponding generator leg. For example, the load impedance connected between A'
and B' must see the voltage presented by the generator situated between A and B
because A is directly connected to A' as is B to B'. Similarly, for the Y-Y
configuration of Figure 9.6, the current through any load leg must equal the current
flowing through the associated generator leg as there are no other paths for current
between A and A', B and B', and C and C'.

As the load is balanced and the legs of the generator are identical except for their
phase, it must be the case that the voltages and currents (and hence the powers) for

341
each leg of the load must be the same, with the exception of the phase. This is true
for both the Y-Y configuration as well as the delta-delta configuration. The tricky bit
here is the difference between a source (or load) current or voltage, and the line
current or voltage.

         Line voltage is the voltage magnitude between any two conductors
         connecting the source to the load, excluding ground or common.

         Line current is the current magnitude flowing in any conductor connecting
         the source to the load, excluding ground or common.

Consider the delta-delta system of Figure 9.5. We have already established that the
voltage developed by generator A,B must be the same as the voltage across the load
A',B'. Thus, the voltage measured from the A, A' conductor to the B,B' conductor
must be the same as source and and load voltages. In other words, in the delta-delta
configuration, the source, load, and line voltages are all the same.

We also found that the source and load currents must be the same for the delta-delta
configuration, however, this does not imply that the current flowing through the
wire connecting A to A' must be the same as the current flowing through either the
generator or the load. After all, two load wires connect to A', not just one. By
definition, the current flowing through that wire is the line current, and therefore in a
delta-delta configuration, the line current is not the same as the source or load
currents. To avoid confusion, the voltage or current associated with a single leg is
referred to as the phase voltage or current versus the line voltage or current.

Turning to the Y-Y configuration of Figure 9.6, we see an opposite situation. The
source, load, and line currents will all be the same. On the other hand, the line
voltage comprises two generators, not one (e.g., from A to B or from B to C). Thus,
for a Y-Y configuration the source and load voltages are the same, but they are not
equal to the line voltage (nor is twice, thanks to the phase shift).

Determining Line Voltage and Current

In order to determine the line voltage for a Y-connected generator (and similarly, the
line current for a delta connected generator), it is useful to examine a phasor plot of
the individual generator voltages. This is shown in Figure 9.7. We have three
voltages of identical amplitude, the only difference between them being their phase.
Each vector is separated from the others by 120 degrees. Further, each individual
generator is connected from the common point to one of the external points of A, B
and C. Line voltage is defined as the potential existing between any two if these
three points. While it's possible to simply subtract one generator voltage from
another to arrive at the difference, there is a nice graphical solution from which we
can derive a precise formula for the line voltage given the generator voltage.

342
B

                                                                                          Figure 9.7
                                                                                          Phasor diagram of Y-connected
                                                                                          generator.

   120°  120°            A

         120°

C

We begin by focusing on quadrants two and three of the phasor plot. This section is
redrawn in Figure 9.8. In reality, any two vectors can be used for the following
proof, but this pair turns out to be particularly convenient in its orientation.

   B                                                                                      Figure 9.8
                                                                                          Solving for the line voltage of
        30°                                                                               a Y-connected generator.
                     1

   X

                    60°
                0.5

   X

                                             C

For ease of use we shall normalize the magnitude of the generator voltage to unity.
What we see is that the B and C vectors are split perfectly by the horizontal axis; that
which is above the axis is perfectly mirrored below it. In the upper portion we find a
right triangle with a hypotenuse of unity (dark red). The angle it makes with the
horizontal must be half of the angle between it and the C vector. That's half of 120

343
degrees, or 60 degrees. As the sum of the interior angles of a triangle must be 180
degrees, this means that the third angle must be 30 degrees. The horizontal leg of the
triangle (dark yellow or maybe "spicy mustard") can be determined because we
know both the hypotenuse and the opposite angle.

            opposite = hypotenuse×sin 

The sine of 30 degrees is exactly 0.5, therefore, the horizontal leg of the triangle
must be 0.5 times the magnitude of unity, or 0.5. We can use the Pythagorean
theorem to find the remaining vertical leg (purple).

     vertical = hypotenuse2-horizontal2

        vertical = 12-0.52

            vertical = 34

         vertical = 12 3

The vertical leg is perfectly mirrored below the horizontal axis. Therefore, the span
from B to C must be twice this value, or 3. As the voltage developed across each
leg of the generator is referred to as the generator's phase voltage, we can state:

The line voltage for a Y-connected generator is 3 times its phase voltage. (9.1)

For example, if the phase voltage of a Y-connected generator is 120 volts, the line
voltage would be 3 times larger, or approximately 208 volts.

For a delta-connected generator, the same holds true for the phase and line currents,
with the proof left as an exercise. That is,

The line current for a delta-connected generator is 3 times its phase current. (9.2)

These same relationships hold for the loads as well as the sources, e.g., the current in
a leg of a Y-connected load will be the same as the line current and its phase voltage
will be 3 times smaller than the line voltage.

         In summation: For delta configurations (generator or load), the phase
         voltage is equal to the line voltage while the line current is larger than the
         phase current by 3. For Y configurations, the phase current is equal to the
         line current while the line voltage is 3 larger than the phase voltage.

For homogenous systems, as the generator and load share the same configuration,
the phase voltages and currents of the load must be identical to those of the
generator. A useful memory aid is that the power dissipated in the system must equal
the power generated.

344
Example 9.1

         A three-phase delta-connected generator feeds a three-phase delta-connected
         load like the system shown in Figure 9.5. Assume the generator phase
         voltage is 120 VAC RMS. The load consists of three identical legs of 50 
         each. Determine the line voltage, load phase voltage, generator phase
         current, line current, load phase current and the total power delivered to the
         load.

         As this is a homogenous (delta-delta) system, the load phase voltage and
         current are the same as those of the generator. Therefore, the load phase
         voltage must also be 120 volts. Second, in a delta configuration, the line
         voltage equals the phase voltage, again 120 volts. The load phase current is
         found via Ohm's law and will be an RMS value because the voltage is RMS:

                     i phase = v phase
                                Z load

                     i phase = 120 V 50 
                     i phase = 2.4 A

         The generator's phase current must be the same because the generator and
         load have the same configuration. For delta configurations, the line current
         is 3 times larger than the phase current, thus,

                 iline = 3×i phase
                 iline = 3×2.4 A

                     iline  4.157 A

         Finally, total power can be found with a straight application of power law as
         the load is purely resistive and we have RMS values. Remember, this is three
         times the power dissipated in one leg.

                      Ptotal = 3×i phase2× R

                                                                         2

                      Ptotal = 3×(2.4 A) ×50 
                      Ptotal = 864 W

         This is equivalent to about 1.2 HP. We could have also computed the load
         phase power by using the squared phase voltage divided by the load
         resistance, or by multiplying the phase voltage by the phase current. As this
         is a purely resistive load, there is no phase angle, and thus no power factor
         with which to concern ourselves.

345
Example 9.2

         A three-phase Y-connected generator feeds a three-phase Y-connected load
         similar to the system shown in Figure 9.6. Assume the generator phase
         voltage is 220 VAC RMS. The load consists of three identical legs of 100 
         each. Determine the line voltage, load phase voltage, generator phase
         current, line current, load phase current and the total power delivered to the
         load.

         This is a homogenous (Y-Y) system, therefore the load phase voltage and
         current are the same as those of the generator. Consequently, the load phase
         voltage must be 220 volts. In a Y configuration, the line voltage equals the
         phase voltage times 3.

                 vline =  3× v phase
                 vline = 3× 220 V

                     vline  381 V

         The load phase current is found via Ohm's law and will be an RMS value
         because the voltage is RMS. This is the same as the generator phase current
         and also the line current.

                      i phase = v phase
                                Z load

                     i phase = 220 V 100 
                     i phase = 2.2 A

         Total power can be found using basic power law as the load is purely
         resistive and we have RMS values. In this case we'll use current times
         voltage for a change of pace.

                      P total = 3×i phase× v phase
                      Ptotal = 3×2.2 A× 220 V
                      Ptotal = 1452 W

         This is just shy of 2 HP. Once again, this is a purely resistive load and there
         is no phase angle. Thus, the power factor is unity with the real and apparent
         powers being the same.

346
Example 9.3

         For the the system shown in Figure 9.9, determine the total apparent and real
         power delivered to the load. Also find the line voltage. The phase voltage of
         the source is 240 volts RMS at 60 Hz.

                                                                                                                   Figure 9.9
                                                                                                                   Circuit for Example 9.3.

         Given the fact that the three load legs are all together at one common point
         (ground), this must be a Y-Y system. Consequently, we know that the line
         voltage must be 3 times the phase voltage of the generator.

                 vline = 3× v phase
                 vline = 3× 240 V

                     vline  416 V RMS
         This is a homogenous system (Y-Y) so we also know that the load voltage is
         equal to the generator voltage, or 240 volts RMS. From that we can find the
         load current (the line current must be the same value because this is a Y-
         connected load).

                     i phase = v phase
                                Z load

                     i phase = 240 V 40+j 30 
                     i phase = 4.8  -36.87 ° A
         The phase angle is appropriate for the 0° reference generator. The other two
         angles will be off of this by ±120°. The apparent power is simply the
         product of the load current and voltage magnitudes.
                     S = 3×iload × vload
                     S = 3×4.8 A×240 V
                     S = 3456 VA

347
         The real power can be found a few different ways:
                      P = S ×cos 
                      P = 3456 VA×cos (-36.87 °)
                      P = 2765 W
                      P = 3×iload 2× Rload
                      P = 3×4.8 A2×40
                      P = 2765 W

Computer Simulation

The circuit of Example 9.3 is worthy of a simulation. The first thing to do is to
determine an appropriate value of inductance to achieve a reactance of j40 . Given
the 60 Hz source frequency, this turns out to be approximately 80 mH. The circuit is
constructed as shown in Figure 9.10. The 240 volt RMS source phase voltage is
equivalent to approximately 340 volts peak. The positions of the inductor and
resistor in each leg have been swapped for a reason that will be apparent shortly.

                                                                                                                   Figure 9.10
                                                                                                                   The equivalent system of
                                                                                                                   Figure 9.9 in a simulator.

The immediate item of interest is to verify the time shifts and amplitudes of the
phase voltages. These correspond to nodes 1, 2 and 3. In this configuration, the load
phase voltage equals the generator phase voltage, thus they should be 340 volts peak
and separated by 120 degrees or 1/3rd of a cycle.
A transient analysis is performed, plotting the node voltages of interest. The result is
shown in Figure 9.11. The voltages are precisely as expected and the plot compares
perfectly to the theoretical plot of Figure 9.4.

348
                                                                                                                   Figure 9.11
                                                                                                                   The three load voltages
                                                                                                                   simulated from Figure 9.10.

Now we check the line voltage. This was calculated to be 416 volts RMS, or
approximately 588 volts peak. The post processor is used to display the result of
node voltage 1 minus node voltage 2. This is shown in Figure 9.12. Again, the
results are as expected with a peak just under 600 volts.
Finally, we will investigate the true load power. Perhaps the easiest way to do this is
to determine the voltage across the resistive portion of the load. From prior work we
know that true power is only associated with resistance, not reactance. Thus, all we
need to do is measure the peak voltage across the resistor. From there, we find its
RMS equivalent, square it, and divide by the resistor value. This gives us the true
load power in one leg. For the total power we simply triple the result. Obtaining the
voltage across the resistor is easy if the resistor is attached to ground. In that case,
it's just the voltage at the node to which the resistor is connected. This is why the
inductor and resistor positions were swapped in the simulation. As they are in series,
it makes no difference to the overall load impedance, however, the new arrangement
allows us to obtain the resistor voltage directly instead of having to rely on a
differential voltage obtained through the post processor.
Another transient analysis is performed, this time plotting the voltage across one of
the load resistors; namely node 4. The result is shown in Figure 9.13. The peak of
this waveform is measured to be 271.5 volts, or about 192 volts RMS. Squaring this
and dividing by 40  yields a little over 921 watts per leg, for a total of about 2765
watts, as expected.

349
                                                                                                                   Figure 9.12
                                                                                                                   One of the line voltages
                                                                                                                   simulated from Figure 9.10.

                                                                                                                   Figure 9.13
                                                                                                                   Simulated voltage across one
                                                                                                                   of the load resistors in
                                                                                                                   Figure 9.10.

350
Heterogeneous Systems

Systems configured as delta-to-Y and Y-to-delta appear to be a bit more complex
than homogeneous systems. We shall refer to these as heterogeneous systems as the
structures of the generator and load are of opposite kind. Examples are shown in
Figures 9.14 and 9.15, respectively.

                 A              A'                    B'

     +              -                  Z          Z

         -                +                  Z                                            Figure 9.14
                                                                                          A delta-connected generator
     B                       C                C'                                          with a Y-connected load
              +     -                                                                     (delta-Y).

     A                  B                         A'                                      Figure 9.15
         +          +                                                                     A Y-connected generator with
              --                                                                          a delta-connected load (Y-
                                          Z           Z                                   delta).
           -
                                B' Z                      C'
           +
            C

These systems are not nearly so difficult as some people think; all you have to do is
remember statements 9.1 and 9.2. Indeed, the summation is worth repeating here:

         For delta configurations (generator or load), the phase voltage is equal to the
         line voltage while the line current is larger than the phase current by 3. For
         Y configurations, the phase current is equal to the line current while the line
         voltage is 3 larger than the phase voltage.

You can think of analyzing these systems as a two-step process. First, determine the
line voltage and current from either the generator or load; and second, transition
from the line to the other side (load or generator). If confusion sets in, remember that
power generated must equal power dissipated or delivered.

In Figure 9.14, the line voltage equals the generator phase voltage. The load is Y-
connected, so each leg sees the line voltage divided by 3. Based on this, each leg of
the load current can be computed. Note that the line current equals the load current.
The generator phase current will be the line current divided by 3.

351
In Figure 9.15, the line voltage equals 3 times the generator phase voltage. The
load is delta-connected, so each leg sees the line voltage. Knowing this, each leg of
the load current can be computed. Also, the line current equals the generator phase
current, and the load phase current will equal the line current divided by 3.

Example 9.4

         A delta-Y system like the one shown in Figure 9.14 has a generator phase
         voltage of 230 volts RMS at 50 Hz. If the load is 2000° , determine the
         generator phase current, the line voltage, the load phase voltage, the load
         phase current and the total power delivered to the load.

         The generator is delta connected so the line voltage equals the generator
         phase voltage, or 230 volts. The load, being Y-connected, will see a phase
         voltage that is reduced by a factor of 3.

                 vload = v line 3

                     vload = 230 V

                          3

                     vload  132.8V RMS

         We can use Ohm's law to determine the load phase current.

                     iload = v phase
                              Z load

                     iload = 132.8 V 200  0 ° 
                     iload 0.664 A RMS

         Being Y-connected, the line current must be the same as the load phase
         current, or 0.664 amps. For delta connections, the line current is 3 times
         larger than the phase current, therefore the generator phase current must be
         3 times smaller.

                 igen = iline 3

                     igen = 0.664 A

                          3

                     igen  0.383A RMS

         The load is purely resistive and we have RMS values so the total power can
         be found via power law (apparent power equals true power in this case).

352
                      Ptotal = 3×iload 2×R
                      Ptotal = 3×(0.664 A )2×200
                      Ptotal = 264 W

         As a crosscheck, the power generated is:

                      P total = 3×igen× v gen
                      Ptotal = 3×0.383 A ×230 V
                      Ptotal = 264 W

         Power generated equals power dissipated.

Example 9.5

         A Y-delta system like the one shown in Figure 9.15 has a generator phase
         voltage of 100 volts RMS at 60 Hz. If the load has a magnitude of 50  with
         a lagging power factor of 0.8, determine the generator phase current, the line
         voltage, the load phase voltage, the load phase current and the total true
         power delivered to the load.

         The Y-connected generator creates a line voltage equal to the generator
         phase voltage times 3. This is also the load phase voltage as it is delta-
         connected.

                 vline = 3× v phase
                 vline = 3×100 V

                     vline  173.2 V RMS

         The delta-connected load will see a phase voltage that is the same as the line
         voltage, or 173.2 volts. From this we can determine the load current.

                     iload = v phase
                              Z load

                     iload = 173.2 V 50 
                     iload 3.464 A RMS

         As the load is delta-connected, the line current is the load current times 3.
         The generator phase current will be the same as the line current.

                 iline = 3×i phase
                 iline = 3×3.464 A

                     iline = 6 A RMS

353
         The true load power can be found several ways. First, we can use the i2 R
         form. To do this we need to find the resistive portion of the load. Recall that
         the power factor is equal to cosine . Therefore the impedance angle is:

                      = cos-1 PF
                      = cos-1 0.8
                       36.9°

         The real part is:

                      R = Z cos 
                      R = 50cos 36.9°
                      R = 40 

         Alternately, we could've just multiplied Z by PF to obtain this. Continuing:

                      Ptotal = 3×iload 2×R
                      Ptotal = 3×(3.464 A )2×40 
                      Ptotal = 1440 W

         We could also find the apparent power and use the power factor.

                      Ptotal = 3×v load ×iload PF
                      Ptotal = 3×173.2 V×3.464 A×0.8
                      Ptotal = 1440 W

         As a crosscheck, compare the power dissipated to the power generated.

                      Ptotal = 3×v gen×i gen× PF
                      Ptotal = 3×100 V ×6 A× 0.8
                      Ptotal = 1440 W

9.3 Power Factor Correction

As we saw in earlier work, reactive loads demand higher currents than purely
resistive loads for a given true load power. The ratio between apparent power, S, and
true power, P, is the power factor, PF. Power factor may also be computed as the
cosine of the load impedance angle. This situation remains for three-phase systems.
If a balanced three-phase load has a large reactive component, the line current and
generator phase current will be higher than necessary. The solution to this is power
factor correction; the introduction of reactive elements that will counterbalance the
reactive power of the load, essentially providing an opposing current such that the
reactive currents cancel.

354
In three-phase systems the situation is potentially complicated by the fact that the
load is split into three parts and can be either Y-connected or delta-connected.

The process for three phase is essentially the same as it is for single phase, but with
a couple slight twists. The first course of action is to determine the reactive power,
Q, of the load. As we are dealing with balanced loads, it is usually easiest to just
concentrate on a single leg. There are two basic possibilities. First, if the load
reactance is known, it is a simple matter to determine the reactive power by finding
the load phase current, squaring it, and then multiplying by the load reactance. In
contrast, if the load is described in terms of a power factor, the apparent power can
be computed from the generator phase voltage and current, and then the power
factor can be used to find the reactive power (e.g., finding true power and then using
the Pythagorean theorem). Once the reactive power is known, the required reactance
can be found using power law and either the phase voltage or current. Finally, the
reactance value is used to determine the component value. As many loads are
inductive, the compensating component usually will be capacitive. There will three
units, one for each leg of the load.

For practical purposes, the compensating device is placed across the load terminals
rather than in series with it. This is true whether the load is Y-connected or delta-
connected. In other words, the compensating devices always will be placed in a delta
configuration. This is true even if the load is Y-connected. We shall look at both
situations in the next two examples.

Example 9.6

         The Y-delta system shown in Figure 9.16 has a generator phase voltage of
         120 volts RMS at 60 Hz. Determine the power factor, the generator phase
         current, and the total real and apparent power delivered to the load. Also
         determine components to correct the power factor and the new generator
         phase current.

                                                                                                                   Figure 9.16
                                                                                                                   Circuit for Example 9.6.

355
         First, the power factor is the cosine of the impedance angle. At 60 Hz, the
         reactance of the 100 mH inductor is -j37.7 . This is in series with the
         resistance for a load impedance of 100 -j37.7  or 106.920.66° per leg.
         The cosine of this angle is 0.9357.

         The voltage across each leg of the load will equal the line voltage.

                 vline = 3× v phase
                 vline = 3×120 V

                     vline  207.8 V RMS

         This will produce a load phase current magnitude of:

                     iload = v phase
                              Z load

                     iload = 207.8 V 106.9 
                     iload 1.944 A RMS

         Now we can find the load powers.

                     S = 3×v phase×i phase
                     S = 3×207.8 V×1.944 A
                     S  1212 VA

                      P = S ×PF
                      P = 1212 VA×0.9357
                      P  1134 W

                     Q = S sin 
                     Q = 1212 VA sin 20.66 °
                     Q  427.6 VAR

         The load is inductive so the compensation components need to be
         capacitors. Each capacitor needs to create 427.6/3 VAR, or 142.5 VAR. The
         required reactance is:

                                  v phase2
                      XC =- j

                                    Q
                                  (207.8V )2
                      X C =- j
                                 142.5 VAR
                      X C - j 303 

         And finally, the capacitance value:

356
                     C= 1
                            2 f XC

                     C = 1 2  60 Hz 303
                     C 8.75  F

         These capacitors would be placed directly in parallel with each leg of the
         load and should result in a reduction of the generator and line currents.

Computer Simulation

To see the effect of power factor correction, the circuit used in Example 9.6 is
captured in a simulator, as illustrated in Figure 9.17. The goal here is to show the
reduction in supplied current. To facilitate this, the normal Y-connected three-phase
source is not used. Instead, three individual sine sources are used, each with a proper
phase shift. A small 1  sensing resistor is inserted in series with one of the sources.
The voltage across this resistor is easily measured (node 7) and serves as a proxy for
the generator phase current. Compared to the sizes of the other components, this
extra resistance will have minimal impact on overall circuit behavior, perhaps
shifting current values around 1% or so. Reducing the resistance to 0.1  will reduce
errors to negligible levels, but 1  is convenient as no scaling is needed and will be
sufficient to show the effect of power factor correction on source current.

                                                                                                                   Figure 9.17
                                                                                                                   Circuit of Figure 9.16 in a
                                                                                                                   simulator.

A transient simulation is run on the circuit, plotting the voltage at node 7. This is
shown in Figure 9.18. Due to the 1  sensing resistance, the voltage value is the
same as the current value in amps. The peak value of the current is approximately
4.7 amps. This agrees with the calculated value of 4.76 amps (1.944 amps RMS
times 2 times 3). Now that a baseline for the current has been established, we turn
our attention to the modified version of the circuit with power factor correction.

357
                                                                                                                   Figure 9.18
                                                                                                                   Generator phase current for the
                                                                                                                   original circuit of Figure 9.17.

The three power factor correction capacitors are added in parallel with the existing
load legs (i.e., from line to line). This is illustrated in Figure 9.19.

                                                                                                                   Figure 9.19
                                                                                                                   Power factor corrected circuit
                                                                                                                   of Figure 9.16 in a simulator.

The transient simulation is repeated. The results are shown in Figure 9.20. The peak
current in this version of the circuit is approximately 4.4 amps. Theoretically, the
current should be scaled by the power factor, or 0.9357. As previously calculated,
the value of the original generator phase current is 4.76 amps peak. Multiplying that
by the power factor yields approximately 4.45 amps peak. The small deviation
between this result and the simulation is due to the effect of the 1  sensing resistor.
358
                                                                                                                   Figure 9.20
                                                                                                                   Generator phase current for the
                                                                                                                   power factor corrected circuit
                                                                                                                   of Figure 9.19.

Example 9.7
         The Y-Y system shown in Figure 9.21 has a generator phase voltage of 230
         volts RMS at 50 Hz. The load draws 900 VA with a power factor of 0.85
         lagging. Determine the generator phase current. Also determine components
         to correct the power factor and the new generator phase current once the
         system is corrected.

                                                                                                                   Figure 9.21
                                                                                                                   Circuit for Example 9.7.

359
         We're looking for the generator phase current so let's break this down to a
         single leg, first. The total apparent power, S, is 900 VA. For a single leg that's
         300 VA. This is a Y-Y system so the generator phase current and voltage are
         the same as the load phase current and voltage. The current can be found via
         the apparent power.

                     i = Sv
                     i = 300 VA

                          230 V RMS
                     i  1.304 A RMS

         Given a power factor of 0.85, we can determine the real and reactive
         powers.

                      P = S ×PF
                      P = 300 VA×0.85
                      P = 255 W

               Q = S2-P2
               Q = (300 VA)2-(255 W)2

                     Q  158 VAR inductive

         For power factor correction, we need 158 VAR capacitive per leg to
         counteract this. These capacitors will be placed across the load terminals in a
         delta configuration. As such, they will see the line voltage. For a Y-
         connected generator, the line voltage is the phase voltage times 3. The
         result here is 230 volts times 3, or 398.4 volts RMS. From this we may
         determine the required reactance.

                                  v phase2
                      X C =- j

                                    Q
                                  (398.4 V )2
                      X C =- j
                                   158 VAR
                      X C - j 1004.6 

         The corresponding capacitance value is:

                      C= 1
                            2 f XC

                     C = 1 2  50Hz 1004.6 
                     C 3.17 F

360
Computer Simulation

In Example 9.7 we computed the generator phase current to be 1.304 amps RMS,
which is equivalent to 1.844 amps peak. If the corrected circuit is proper, then the
apparent power should fall to the real power, or 255 watts. The resulting generator
phase current should be this power divided by the generator phase voltage, 255/230,
or 1.109 amps RMS. This is equivalent to 1.568 amps peak. (Alternately, we could
multiply the original current by the power factor because the voltage is constant.)

To verify the effectiveness of the circuit modification, we start by capturing the
circuit in a simulator, as shown in Figure 9.22.

                                                                                                                   Figure 9.22
                                                                                                                   Generator phase current for the
                                                                                                                   original circuit of Figure 9.21.

As in the prior example, the source is built from three discrete sine generators at
appropriate phases. Beneath one of them, a 1  current sensing resistor is added
(node 7). This value should produce no more than about 1% deviation as it is a full
two orders of magnitude smaller than the other circuit resistances.

An interesting question for the sharp-eyed observer is how the load resistor and
inductor values were obtained. This turns out to be not so difficult. We have already
computed the true and reactive powers for each leg. We also know the load phase
voltage (it's the same as the generator, 230 volts, as it's a Y-Y connection).
Therefore, we can find the R and XL values as we have already computed the load
current and can use this to determine the load impedance, Z. The power factor is
known, and from this the real and reactive parts can be deduced.

            Z = v phase
                    i

            Z = 230 V 1.304 A
            Z 176

This is the magnitude. For the sake of completeness, the angle is the arccosine of the

361
power factor, or cos-1(0.85), which is 31.8 degrees. The fastest way to determine R is
to recognize that the real portion is the impedance magnitude times the power factor:

            R = Z ×PF
            R = 176×0.85
            R 150
The reactive portion can be found via the Pythagorean theorem or by using the
power relation. Then we apply the reactance formula to find the inductance.
            X L = 2 Q

                    i
            X L = (1.304 A RMS)2 158 VAR
            X L  92.9
            L= XL

                  2 f
            L = 92.9 2  50 Hz
            L 296 mH
The result of a transient analysis is shown in Figure 9.23. The measured peak phase
current is 1.837 amps. This compares nicely with the expected value of 1.844 amps.

                                                                                                                   Figure 9.23
                                                                                                                   Generator phase current for the
                                                                                                                   original circuit of Figure 9.22.

362
For the comparison, the power factor correction capacitors are added in a delta
configuration (across the lines) as shown in Figure 9.24.

                                                                                                                   Figure 9.24
                                                                                                                   Power factor corrected circuit
                                                                                                                   of Figure 9.21 in a simulator.

Another simulation is run, the result shown in Figure 9.25. The peak current has
decreased to 1.56 amps. This is just slightly lower than the expected value of 1.568
amps peak. Again, this small deviation is due to the effect of the sense resistor.

                                                                                                                   Figure 9.25
                                                                                                                   Generator phase current for the
                                                                                                                   power factor corrected circuit
                                                                                                                   of Figure 9.24.

363
9.4 Summary

Polyphase systems can be thought of as a group of individual sources of the same
magnitude that are synced together and where the load is similarly divided into
sections or legs. By spreading out the source currents across the waveform's period,
a smooth application of power to the load can be achieved. Also, for the same line
current, more power can be delivered to the load than that of a single phase system.
Loads can be balanced or unbalanced. A balanced load means that all legs of the
load exhibit an identical impedance. Thus, the currents coming out of the source will
be the same except for the phase shifts spreading them across a single period. While
any number of phases is possible, three-phase systems are popular as they deliver
the benefits of polyphase while limiting complexity.

A three-phase source produces currents that are 120 degrees apart. That is, if the first
signal is taken as the reference, or 0°, then the other two are at 120° and 240°. Both
the source and the load can be configured in one of two ways: delta or Y. This makes
four possible combinations for the source-load connection; namely Y-Y, delta-delta,
Y-delta, and delta-Y. In a Y-Y connection the source phase current and load current
will be the same. The voltage from one line to another will be 3 times larger than
the phase voltage. In a delta-delta connection the phase and line voltages will be the
same, but the line current will be 3 times larger than the phase current of the
generator or load. In delta-Y and Y-delta connections, the source and load no longer
match configuration so neither the phase voltages nor currents are the same. For the
portion that is Y-connected, the line current and phase current will be the same. For
the portion that is delta-connected, the line voltage and phase voltage will be the
same. For those configurations, the other parameter (voltage or current) will be
scaled by 3.

In a system with a balanced load, the system power will simply be three times the
power of one leg. If the load has a non-negligible phase angle, power factor
correction can be used to reduce the required line current. The compensating items
are arranged in a delta configuration, even if the load is Y-connected.

Review Questions

    1. Describe the advantages and disadvantages of polyphase versus single phase
         systems.

    2. Define the terms delta-connected and Y-connected.
    3. How are line and load voltages related for Y-connected loads?
    4. How are line and load currents related for Y-connected loads?
    5. How are line and load voltages related for delta-connected loads?
    6. How are line and load currents related for delta-connected loads?
    7. Describe a practical connection for power factor correction of a Y-connected

         load.

364
9.5 Exercises

Unless specified otherwise, assume generator frequencies are 60 Hz for all
problems.

Analysis

    1. As depicted in Figure 9.26, a three-phase delta-connected generator feeds a
         delta-connected load. The generator phase voltage is 120 volts and the load
         consists of three legs of 10  each. Find the voltage across each load leg,
         the line current through the wires connecting the load to to the generator and
         the power drawn by the load.
                                                                                Figure 9.26

    2. Referring to the delta-delta system of Figure 9.26, if the generator phase
         voltage is 230 volts and the load is balanced with each leg at 2 , determine
         the line voltage, line current, generator phase current and load current.

    3. The system of Figure 9.27 shows a three-phase Y-connected generator
         feeding a Y-connected load. If the generator phase voltage is 120 volts and
         the load consists of three legs of 20  each, find the line voltage, the line
         current, voltage across each load leg and the total power drawn by the load.
                                                                                Figure 9.27

365
    4. Referring to Figure 9.27, if the generator phase voltage is 230 volts and the
         load is balanced with each leg at 12 , determine the line voltage, line
         current, generator phase current, load current, load voltage and total load
         power.

    5. As depicted in Figure 9.28, a three-phase delta-connected generator feeds a
         Y-connected load. The generator phase voltage is 120 volts and the load
         consists of balanced legs of 5  each. Find the voltage across each load leg,
         the line current, the line voltage, the generator phase current and the total
         load power.

                                                                                Figure 9.28

    6. Referring to Figure 9.28, if the generator phase voltage is 400 volts and the
         load is balanced with each leg at 10 , determine the line voltage, line
         current, generator phase current, load current and the voltage across each
         load leg.

    7. The system of Figure 9.29 shows a three-phase Y-connected generator
         feeding a delta-connected load. If the generator phase voltage is 120 volts
         and the load consists of three legs of 60  each, find the line voltage, the
         line current, voltage across each load leg and the total power drawn by the
         load.

                                                                                Figure 9.29

    8. Referring to the Y-delta system of Figure 9.28, if the generator phase voltage
         is 120 volts and the load is balanced with each leg at 20 , determine the
         line voltage, line current, generator phase current, load current, the voltage
         across each load leg and the total load power.

366
    9. A three-phase delta-connected generator feeds a delta-connected load
         consisting of three legs of 10  in series with j4  of inductive reactance, as
         shown in Figure 9.30. If the line voltage is 208 volts, find the voltage across
         each load leg, the current through the wires connecting the load to to the
         generator, and the apparent and real powers drawn by the load.
                                                                                Figure 9.30

    10. Given the delta-delta system of Figure 9.30, if the generator phase voltage is
         120 volts and the load is balanced with each leg at 20 + j10 , determine the
         line voltage, line current, generator phase current, load current, the voltage
         across each load leg, and the total real and apparent load powers.

    11. A three-phase Y-connected generator feeds a Y-connected load consisting of
         three legs of 10  in series with j4  of inductive reactance, as shown in
         Figure 9.31. If the line voltage is 208 volts, find the voltage across each load
         leg, the line current, and the apparent and real powers drawn by the load.
                                                                                Figure 9.31

    12. Given the Y-Y system of Figure 9.31, if the line voltage is 400 volts and the
         load is balanced with each leg at 100 + j20 , determine the generator phase
         voltage, line current, generator phase current, load current, the voltage
         across each load leg, and the total real and apparent load powers.

367
    13. The three-phase system of Figure 9.7 uses a Y-connected generator feeding a
         delta-connected load. The load consists of three legs of 40  in series with
         j30  of inductive reactance, as shown in Figure 9.32. If the generator phase
         voltage is 230 volts, find the line voltage, the voltage across each load leg,
         the line current, the load current, and the apparent and real powers drawn by
         the load.
                                                                                Figure 9.32

    14. Given the Y-delta system of Figure 9.32, if the line voltage is 400 volts and
         the load is balanced with each leg at 80 + j20 , determine the generator
         phase voltage, line current, generator phase current, load current, the voltage
         across each load leg, and the total real and apparent load powers.

    15. A 208 three-phase delta-connected generator feeds a Y-connected load
         consisting of three legs of 10  in series with j4  of inductive reactance as
         shown in Figure 9.33. Find the voltage across each load leg, the current
         through the wires connecting the load to to the generator, and the apparent
         and real powers drawn by the load.
                                                                                Figure 9.33

    16. Given the delta-Y system of Figure 9.33, if the line voltage is 400 volts and
         the load is balanced with each leg at 120 + j30 , determine the line current,
         generator phase current, load current, the voltage across each load leg, and
         the total real and apparent load powers.

368
    17. A 120 volt three-phase delta-connected generator feeds a delta-connected
         load consisting of three legs of 75  in series with -j10  of capacitive
         reactance as shown in Figure 9.34. Find the voltage across each load leg, the
         current through the wires connecting the load to to the generator, and the
         apparent and real powers drawn by the load.
                                                                                Figure 9.34

    18. A three-phase Y-connected generator feeds a Y-connected load consisting of
         three legs of 150  in series with -j20  of capacitive reactance as shown in
         Figure 9.35. If the generator phase voltage is 120 volts, find the line voltage,
         the voltage across each load leg, the line current, and the apparent and real
         powers drawn by the load.
                                                                                Figure 9.35

Design

    19. Using the delta-delta system of problem 9 and assuming the source
         frequency is 60 Hz, determine appropriate component values to place in
         parallel with each load leg in order to shift the power factor to unity.

    20. Using the Y-Y system of problem 11 and assuming the source frequency is
         60 Hz, determine appropriate component values to place in parallel with
         each load leg in order to shift the power factor to unity.

369
Challenge

    21. Using the Y-Y system of problem 11 and assuming the source frequency is
         60 Hz, determine appropriate component values to be added to the load in
         order to shift the power factor to unity. These new components should be in
         a delta configuration.

Simulation

    22. Use a transient analysis to verify the phase and line voltage phase
         relationships in problem 1.

    23. Use a transient analysis to verify the results computed for problem 15.
    24. Use a transient analysis to verify the design solution to problem 19. This can

         be achieved by ensuring that the voltage and current in each load leg (with
         added correction components) are in phase.
    25. Use a transient analysis to verify the design solution to problem 20. This can
         be achieved by ensuring that the voltage and current in each load leg (with
         added correction components) are in phase.

370
Notes

                                                                                                                                    
371
10 Decibels and Bode Plots

10.0 Chapter Learning Objectives

After completing this chapter, you should be able to:

    · Convert between ordinary and decibel based power and voltage gains.
    · Utilize decibel-based voltage and power measurements during circuit analysis.
    · Define and graph a general Bode plot.
    · Detail the differences between lead and lag networks, and graph Bode plots for each.
    · Combine the effects of several lead and lag networks together in order to determine a system Bode plot.

10.1 Introduction

This chapter introduces two related items; the decibel and Bode plots. The decibel measurement scheme is in
wide use, particularly in the fields of audio and communications. We will be examining its advantages over the
ordinary system of measurement used up to now and how to convert values of one form into the other. One of
the more important parameters of a circuit is its frequency response, that is, the way in which the circuit
responds to input signals over a range of frequencies. While we have investigated this to some extent in prior
work, in this chapter we shall take it to its logical conclusion, namely the Bode plot. A Bode plot is, in fact, a
pair of plots; one of relative signal magnitude or gain with respect to frequency and a second detailing the phase
response with respect to frequency. Bode plots are of particular importance in the study of circuits such as
amplifiers and filters, as well as in systems that make use of negative feedback. The gain magnitude plot makes
use of a decibel scale and thus it makes sense to begin our study looking at the decibel system: specifically how
it is defined and its practical use.

10.2 The Decibel

Most people are familiar with the term "decibel" in reference to sound pressure. It's not uncommon to hear
someone say something such as "It was 110 decibels at the concert last night and my ears are still ringing." This
popular use is somewhat inaccurate, but does show that decibels indicate some sort of quantity or relative level;
in this case, sound pressure level.

Decibel Representation of Power and Voltage Gains

In its simplest form, the decibel is used to measure system gain, such as power or voltage gain, where gain is
simply the ratio of an output signal to an input signal. For an amplifying circuit, the gain would be greater than

372
one, but for purely passive systems it will likely be fractional (i.e., the output
quantity is smaller than the input quantity). For example, a simple voltage divider
might be said to have a "gain" of 0.2, or some such, meaning that the output signal is
only 20% of the input signal. Unlike the ordinary gain measurements, the decibel
form is logarithmic. Because of this, it can be very useful for showing ratios of
change, as well as absolute change. The base unit is the bel, named after Alexander
Graham Bell, the noted American scientist and inventor. To convert an ordinary gain
to its bel counterpart, just take the common log (base 10) of the gain. In equation
form:

     bel gain = log10( ordinary gain )                  (10.1)

Note that on most hand calculators common log is denoted as "log" while the natural
log is given as "ln". Unfortunately, some programming languages use "log" to
indicate natural log and "log10" for common log. More than one student has been
bitten by this bug, so be forewarned! As an example, if an amplifier circuit produces
an output power of 200 milliwatts for an input of 10 milliwatts, we would normally
say that it has a power gain of:

     G= Pout
         Pin

     G=200 mW 10 mW
     G= 20

For the bel version, just take the log of this result.

     G '=log10G
     G '=log1020
     G '=1.301

The bel gain is 1.3 bels. The term "bels" is not a unit in the strict sense of the word
(as in "watts"), but is simply used to indicate that this is not an ordinary gain. In
contrast, ordinary power and voltage gains are sometimes given units of W/W and
V/V to distinguish them from bel gains. Also, note that the symbol for bel power
gain is G' and not G. All bel gains are denoted with the following prime (') notation
to avoid confusion. Because bels tend to be rather large, we typically use one-tenth
of a bel as the norm. The result is the decibel (one-tenth bel). To convert to decibels,
simply multiply the number of bels by 10. Our gain of 1.3 bels is equivalent to 13
decibels. The units are commonly shortened to dB. Consequently, we may say:

     G '=10 log10G                                              (10.2)

     Where the result is in dB.

373
At this point, you may be wondering what the big advantage of the decibel system
is. To answer this, recall a few log identities. Normal multiplication becomes
addition in the log system, and division becomes subtraction. Likewise, powers and
roots become multiplication and division. Because of this, two important things
show up. First, ratios of change become constant offsets in the decibel system, and
second, the entire range of values diminishes in size. The result is that a very wide
range of gains may be represented within a fairly small scope of values, and the
corresponding calculations can become quicker.

There are a couple of dB values that are useful to remember, and are illustrated in
Figure 10.1. With the aid of your calculator, it is very easy to show the following:

     Factor    dB Value using                                                            Figure 10.1
              G'= 10 log10 G                                                             Positive dB factors.
           1
           2               0 dB
           4           3.01 dB
           8           6.02 dB
         10            9.03 dB

                         10 dB

We can also look at fractional factors (i.e., losses instead of gains, Figure 10.2):

     Factor               dB Value                                                       Figure 10.2
                                                                                         Negative dB factors.
        0.5               -3.01 dB
       0.25               -6.02 dB
     0.125                -9.03 dB
        0.1
                            -10 dB

If you look carefully, you will notice that a doubling is represented by an increase of
approximately 3 dB. A factor of 4 is in essence, two doublings. Therefore, it is
equivalent to 3 dB + 3 dB, or 6 dB. Remember, because we are using logs,
multiplication turns into simple addition. In a similar manner, a halving is
represented by approximately -3 dB. The negative sign indicates a reduction. To
simplify things a bit, think of factors of 2 as ±3 dB, the sign indicating whether you
are increasing (multiplying), or decreasing (dividing). As you can see, factors of 10
work out to a very convenient 10 dB. By remembering these two factors, you can
often estimate a dB conversion without the use of your calculator. For instance, we
could rework our initial conversion problem as follows:

     · The amplifier has a gain of 20.
     · 20 can be written as 2 times 10.
     · The factor of 2 is 3 dB, the factor of 10 is 10 dB.
     · The answer must be 3 dB + 10 dB, or 13 dB.

Time for a few examples.

374
Example 10.1

         An amplifier has a power gain of 800. What is the decibel power gain?

                    G '=10 log10G
                    G '=10 log10800
                    G '=10×2.903
                    G '=29.03dB

         We could also use our estimation technique:

         · G = 800 = 8102
         · 8 is equivalent to 3 factors of 2, or 222, and can be expressed as 3 dB +

              3 dB + 3 dB, which is, of course, 9 dB
         · 102 is equivalent to 2 factors of 10, or 10 dB + 10 dB = 20 dB.

              Alternately, the power of 2 literally represents 2 bels, and thus 20 dB.
         · The result is 9 dB + 20 dB, or 29 dB

         Note that if the leading digit is not a power of 2, the estimation will not be
         as precise. For example, if the gain is 850, you know that the decibel gain is
         just a bit over 29 dB. You also know that it must be less than 30 dB
         (1000=103 which is 3 factors of 10, or 30 dB.) As you can see, by using the
         dB form, you tend to concentrate on the magnitude of gain, and not so much
         on trailing digits.

Example 10.2

         An attenuator reduces signal power by a factor of 10,000. What is this loss
         expressed in dB?

                    G '=10 log10 1 10,000
                    G '=10×(-4 )
                    G '=-40 dB

         By using the approximation, we can say,

                    1 10,000 =1 0-4

         The negative exponent tells us we have a loss (negative dB value), and 4
         factors of 10 (i.e., 4 bels).

375
               G '= -10 dB -10dB -10dB -10 dB
               G '= -40dB

     Remember, if an increase in signal is produced, the result will be a positive
     dB value. A decrease in signal will always result in a negative dB value. A
     signal that is unchanged indicates a gain of unity, or 0 dB.

To convert from dB to ordinary form, just invert the steps; that is, divide by ten and
then take the antilog.

                      -1 G '  (10.3)
              G= log10

                          10

On most hand calculators, base 10 antilog is denoted as 10x. In most computer
languages, you just raise 10 to the appropriate power, as in G = 10.0**(Gprime /
10.0) (Python), or use an exponent function, as in pow(10.0, Gprime / 10.0) (C).

Example 10.3

     An amplifier has a power gain of 23 dB. If the input is 1 mW, what is the
     output?

     In order find the output power, we need to find the ordinary power gain, G.

                        -1 G '
               G= log10

                           10
                        -1 23
               G =log10

                           10
               G=199.5

     Therefore, Pout =199.5  1 mW, or 199.5 mW

     You could also use the approximation technique in reverse. To do this, break
     up the dB gain in 10 dB and 3 dB chunks:

               23dB=3 dB+10dB+10dB

     Now replace each chunk with the appropriate factor, and multiply them
     together (remember, when going from log to ordinary form, addition turns
     into multiplication.)

               3dB=2X ,10dB=10X , so,

376
     G= 2×10×10
     G= 200

While the approximation technique appears to be slower than the calculator, practice
will show otherwise. Being able to quickly estimate dB values can prove to be a
very handy skill in the electronics field. This is particularly true in larger, multi-stage
designs.

Example 10.4

         A three-stage amplifier has gains of 10 dB, 16 dB, and 14 dB per section.
         What is the total dB gain?

         Because dB gains are a log form, just add the individual stage gains to arrive
         at the system gain.

                    G 'total =G ' 1+G ' 2+G ' 3
                    G 'total =10 dB+16 dB+14dB
                    G 'total =40 dB

As you may have noticed, all of the examples up to this point have used power gain
and not voltage gain. You may be tempted to use the same equations for voltage
gain. In a word, don't. If you think back for a moment, you will recall that power
varies as the square of voltage. In other words, a doubling of voltage will produce a
quadrupling of power. If you were to use the same dB conversions, a doubling of
voltage would be 3 dB, yet, because the power has quadrupled, this would indicate a
6 dB rise. Consequently, voltage gain (and current gain as well) are treated in a
slightly different fashion. We would rather have our doubling of voltage work out to
6 dB, so that it matches the power calculation. The correction factor is very simple.
Because power varies as the second power of voltage, the dB form should be twice
as large for voltage (remember, exponentiation turns into multiplication when using
logs). Applying this factor to equation 10.2 yields:

     A 'v=20 log10 Av  (10.4)

Be careful though, the decibel voltage gain only equals the decibel power gain if the
input and output impedances of the system are matched (you may recall from your
other work that it is quite possible to design a circuit with vastly different voltage
and power gains). If we were to recalculate our earlier table of common factors, we
would find that a doubling of voltage gain is equivalent to a 6 dB rise, and a ten fold
increase is equivalent to a 20 dB rise, twice the number of decibels of their power
gain counterparts.

377
Note that current gain may be treated in the same manner as voltage gain (although
this is less commonly done in practice).

Example 10.5

         A circuit has an output signal of 2 V for an input of 50 mV. What is A'v?
         First find the ordinary gain.

                    Av= 2 0.05 =40
         Now convert to dB form.

                    A 'v=20 log10 40
                    A 'v=20×1.602
                    A 'v=32.04 dB

         The approximation technique yields 40=2210, or 6 dB + 6 dB + 20 dB, or
         32 dB.

To convert A'v to A, reverse the process.  (10.5)
                    Av=log10 -1 A 'v 20

Example 10.6

     An amplifier has a gain of 26 dB. If the input signal is 10 mV, what is the
     output?

               Av=log10 -1 A' v 20
               Av=log10 -1 2620
               Av =19.95
               V out= Av V i n
               V out=19.95×10 mV

The final point to note in this section is that, as in the case of power gain, a negative
decibel value indicates a loss. Therefore, a 2:1 voltage divider would have a gain of
-6 dB.

378
Signal Representation in dBW and dBV

As you can see from the preceding section, it is possible to spend considerable time
converting between decibel gains and ordinary voltages and powers. Because the
decibel form does offer advantages for gain measurement, it would make sense to
use a decibel form for power and voltage levels as well. This is a relatively
straightforward process. There is no reason why we can't express a power or voltage
in a logarithmic form. Because a dB value just indicates a ratio, all we need to do is
decide on a reference (i.e., a comparative base for the ratio). For power
measurements, a likely choice would be 1 watt. In other words, we can describe a
power as being a certain number of dB above or below 1 watt. Positive values will
indicate powers greater than 1 watt, while negative values will indicate powers less
than 1 watt. In general equation form:

              P ' =10log 10 P reference                                   (10.6)

The answer will have units of dBW, that is, decibels relative to 1 watt.

Example 10.7

A power amplifier has a maximum output of 120 W. What is this power in

dBW?

          P ' =10log 10 P 1 Watt
          P ' =10log 10 120 W 1 W
          P ' =20.8 dBW

There is nothing sacred about the 1 watt reference, short of its convenience. We
could just as easily choose a different reference. Other common reference points are
1 milliwatt (dBm) and 1 femtowatt (dBf). Obviously, dBf is used for very low signal
levels, such as those coming from an antenna. dBm is in very wide use in the
communications industry. To use these other references, just divide the given power
by the new reference.

Example 10.8

         A small personal audio music player delivers 200 mW to its headphones.
         What is this output power in dBW, and in dBm?

         For an answer in units of dBW, use the 1 watt reference.

379
                 P ' =10 log10 P 1 Watt
                 P ' =10 log10 200 mW 1 W
                 P ' =-7 dBW

     For units of dBm, use a 1 milliwatt reference.

                 P ' =10 log10 P 1 Watt
                 P ' =10 log10 200 mW 1 mW
                 P ' =23 dBm

     200 mW, -7 dBW, and 23 dBm are three ways of saying the same thing.
     Note that the dBW and dBm values are 30 dB apart. This will always be
     true, because the references are a factor of 1000 (30 dB) apart.

In order to transfer a dBW or similar value into watts, reverse the process.

              P=log10-1 P '10 ×reference  (10.7)

Example 10.9

     A studio microphone produces a 12 dBm signal while recording normal
     speech. What is the output power in watts?

                  P=log10 -1 P '10 ×reference
                  P=log10 -1 12dBm 10 ×1 mW
                 P=15.8mW=0.0158 W

For voltages, we can use a similar system. A logical reference is 1 V, with the
resulting units being dBV. As before, these voltage measurements will use a
multiplier of 20 instead of 10.

              V '=20log10 V reference     (10.8)

380
Example 10.10

         A test oscillator produces a 2 volt signal. What is this value in dBV?

                    V '=20log10 V reference
                    V '=20log10 2 V 1 V
                    V '= 6.02 dB

When both circuit gains and signal levels are specified in decibel form, analysis can
be very quick. Given an input level, simply add the gain to it in order to find the
output level. Given input and output levels, subtract them in order to find the gain.

Example 10.11

         A computer hard drive read/write amplifier exhibits a gain of 35 dB. If the
         input signal is -42 dBV, what is the output signal?

                    V 'out=V ' i n+A ' v
                    V 'out=-42 dBV+35 dB
                    V 'out=-7 dBV

         Note that the final units are dBV and not dB, thus indicating a voltage and
         not merely a gain.

Example 10.12

         A guitar power amp needs an input of 20 dBm to achieve an output of 25
         dBW. What is the gain of the amplifier in dB?

         First, it is necessary to convert the power readings so that they share the
         same reference unit. Because dBm represents a reference 30 dB smaller than
         the dBW reference, just subtract 30 dB to compensate.

                    20 dBm=-10 dBW
                    G '= P 'out- P 'i n
                    G '=25dBW-(-10 dBW)
                    G '=35 dB

381
         Note that the units are dB and not dBW. This is very important! Saying that
         the gain is "so many" dBW is the same as saying the gain is "so many"
         watts. Obviously, gains are "pure" numbers and do not carry units such as
         watts or volts.

The usage of a dB-based system is shown graphically in Figure 10.3. Note how the
stage gains are added to the input signal to form the output. Even large circuits can
be quickly analyzed in this form. To make life in the lab even easier, it is possible to
take measurements directly in dB form. By doing this, you need never convert while
troubleshooting a design. For general-purpose work, voltage measurements are the
norm, and therefore a dBV scale is often used.

       10 dB          -6 dB          15 dB                                                Figure 10.3
                                                                                          Multistage dB application.

8 dBm         18 dBm         12 dBm         27 dBm

Items Of Interest In The Laboratory

When using a digital meter on a dBV scale it is possible to "underflow" the meter if
the signal is too weak. This will happen if you try to measure around zero volts, for
example. If you attempt to calculate the corresponding dBV value, your calculator
will probably show "error". The effective value is negative infinite dBV. The meter
will certainly have a hard time showing this value! Another item of interest revolves
around the use of dBm measurements. It is common to use a voltmeter to make dBm
measurements, in lieu of a wattmeter. While the connections are considerably
simpler, a voltmeter cannot measure power. How is this accomplished then? Well, as
long as the circuit impedance is known, power can be derived from a voltage
measurement. A common impedance in communication systems (such as recording
studios) is 600 , so a meter can be calibrated to give correct dBm readings by using
Power Law. If this meter is used on a non-600  circuit, the readings will no longer
reflect accurate dBm values (but will still properly reflect relative changes in dB).

Finally, recalling the chapter introduction regarding "110 dB" concert levels,
properly, that would read "110 dB-SPL", referring to "Sound Pressure Level". The
reference level corresponding to 0 dB-SPL is the quietest sound the average person
can hear; the threshold of hearing (20 micropascals for young healthy humans).
Thus, 110 dB-SPL refers to a sound pressure that is 110 dB greater than the threshold
of hearing. Typically, 1 dB represents a "just noticeable difference" in loudness for
humans, although this depends on the precise frequency and sound pressure.

382
10.3 Bode Plots

The Bode plot is a graphical response prediction technique that is useful for both
circuit design and analysis. It is named after Hendrik Wade Bode, an American
engineer known for his work in control systems theory and telecommunications. A
Bode plot is, in actuality, a pair of plots: One graphs the signal gain or loss of a
system versus frequency, while the other details the circuit phase versus frequency.
Both of these items are very important in the design of well-behaved, optimal
circuits.

Generally, Bode plots are drawn with logarithmic frequency axes, a decibel gain
axis, and a phase axis in degrees. First, let's take a look at the gain plot. A typical
gain plot is shown Figure 10.4. Remember, "gains" can be fractional, as with a
voltage divider.

              A' v                                                                        Figure 10.4
     A' midband                                                                           Generic gain plot.

                    f1  midband  f2  f

Note how the plot is relatively flat in the middle, or midband, region. The gain value
in this region is known as the midband gain. In purely passive circuits this value
may be fractional (i.e., a negative dB value). At either extreme of the midband
region, the gain begins to decrease. The gain plot shows two important frequencies,
f1 and f2. f1 is the lower break frequency while f2 is the upper break frequency. The
gain at the break frequencies is 3 dB less than the midband gain. These frequencies
are also known as the half-power points, or corner frequencies. Normally, amplifiers
are only used for signals between f1 and f2. The exact shape of the rolloff regions will
depend on the design of the circuit. For example, it is possible to design amplifiers
with no lower break frequency (i.e., a DC amplifier), however, all amplifiers will
exhibit an upper break. The break points are caused by the presence of circuit
reactances, typically coupling and stray capacitances. The gain plot is a summation
of the midband response with the upper and lower frequency limiting networks.
Let's take a look at the lower break, f1.

383
Lead Network Gain Response

Reduction in low frequency gain is caused by lead networks. A generic lead network                     Figure 10.5
is shown in Figure 10.5. It gets its name from the fact that the output voltage                        Lead network.
developed across R leads the input. At very high frequencies the circuit will be
essentially resistive. Conceptually, think of this as a simple voltage divider. The
divider ratio depends on the reactance of C. As the input frequency drops, Xc
increases. This makes Vout decrease. At very high frequencies, where Xc<<R, Vout is
approximately equal to Vin. This can be seen graphically in Figure 10.6, where the
frequency axis is normalized to fc. The break frequency (i.e., the frequency at which
the signal has decreased by 3 dB) is found via the standard equation,

                         f c= 1 2  R C

                         Lead Network Magnitude Response

                  0.01                                  0.1                        1           10
                10                                                                               10

                  0                                          Approximate                Exact         Figure 10.6
                -10                                                                                   Lead network gain plot.
Amplitude (dB)  -20 Slope: 6 dB/octave or 20 dB/decade
                -30                                                                              0

                                                                                                 -10

                                                                                                 -20

                                                                                                 -30

                -40                                     0.1  Normalized frequency  1.0            -40
                    0.0                                                                        10.0

The response below fc will be a straight line if a decibel gain axis and a logarithmic
frequency axis are used. This makes for very quick and convenient sketching of
circuit response. The slope of this line is 6 dB per octave (an octave is a doubling or
halving of frequency, e.g., 800 Hz is 3 octaves above 100 Hz).20 This range covers a
factor of two in frequency. This slope may also be expressed as 20 dB per decade,
where a decade is a factor of 10 in frequency. With reasonable accuracy, this curve
may be approximated as two line segments, called asymptotes, shown in Figure 10.6
(blue). The shape of this curve is the same for any lead network. Because of this, it is

20 The term octave is borrowed from the field of music. It gets its name from the fact that
there are eight notes in the standard western scale: do-re-mi-fa-sol-la-ti-do.

384
very easy to find the approximate gain at any given frequency as long as fc is known.
It is not necessary to go through reactance and phasor calculations. To create a
general response equation, start with the voltage divider rule to find the gain:

                 V out = R
                 V i n R- j X c

                 V out =               R0
                 V i n  R2+X c2 -arctan X c R

The magnitude of this is,

                  Av=      R

                       R +X c2      2

                 Av=         1                       (10.9)
                               X c2

                           1+ 2
                               R

Recalling that,

                 f c= 1 2  R C

we may say,

                 R= 1
                     2 f cC

For any frequency of interest, f,

                 X c= 1 2  f C

Equating the two preceding equations yields,

                 fc= Xc                              (10.10)
                 fR

Substituting equation 10.10 in equation 10.9 gives,

                 Av=        1                        (10.11)
                              f c2

                          1+ 2
                              f

385
To express Av in dB, substitute equation 10.11 into equation 10.5.

                A 'v=20 log10   1
                                   f c2

                               1+ 2
                                   f

After simplification, the final result is:

                     ( )f c2                                        (10.12)

               A 'v=-10 log10 1+ 2
                                       f

     Where
     fc is the critical frequency,
     f is the frequency of interest,
     A'v is the decibel gain at the frequency of interest.

Example 10.13

     A circuit has a lower break frequency of 40 Hz. How much signal is lost at
     10 Hz?

              ( )f c2

               A 'v=-10 log10 1+ 2
                                       f

               ( )402

               A 'v=-10 log10 1+ 2
                                      10

               A 'v=-12.3 dB

     In other words, the signal level is 12.3 dB lower than it is in the midband.
     Note that 10 Hz is 2 octaves below the break frequency. Because the cutoff
     slope is 6 dB per octave, each octave loses 6 dB. Therefore, the approximate
     result is -12 dB, which double-checks the exact result. Without the lead
     network, the gain would stay at 0 dB all the way down to DC (0 Hz.)

Lead Network Phase Response

At very low frequencies, the circuit of Figure 10.5 is largely capacitive. Because of
this, the output voltage developed across R leads by 90 degrees. At very high
frequencies the circuit will be largely resistive. At this point Vout will be in phase with
Vin. At the critical frequency, Vout will lead by 45 degrees. A general phase graph is
shown in Figure 10.7. As with the gain plot, the phase plot shape is the same for any
lead network. The general phase equation may be obtained from the voltage divider:

386
                         V out = R
                         V i n R- j X c

                         V out =         R0
                         V i n  R2+X c2 -arctan X c R

The phase portion of this is,

                         =arctan X c
                                      R

By using equation 10.6, this simplifies to,

                         =arctan f c                                              (10.13)
                                      f

                         Where
                         fc is the critical frequency,
                         f is the frequency of interest,
                          is the phase angle at the frequency of interest.

                                     Lead Network Phase Response

                   0.01         0.1               1                         10              100
                 90                                                                            90
                 80      Exact       Approximate
                 70                                                                                Figure 10.7
Phase (degrees)  60                                                                           80 Lead network phase response.
                 50
                 40             0.1               1.0                       10.0               70
                 30                      Normalized frequency                                  60
                 20                                                                            50
                 10                                                                            40
                                                                                               30
                  0                                                                            20
                    0.0                                                                        10
                                                                                               0
                                                                                           100.0

Often, an approximation, such as the blue line in Figure 10.7, is sufficient. By using
Equation 10.13, you can show that this approximation is off by no more than 6
degrees at the corners.

387
Example 10.14

         A telephone amplifier has a lower break frequency of 120 Hz. What is the
         phase response one decade below and one decade above?

         One decade below 120 Hz is 12 Hz, while one decade above is 1.2 kHz.
                    =arctan f c
                                 f
                    =arctan 120 Hz 12Hz

          =84.3degrees one decade below f c (i.e, approaching 90 degrees)
                    =arctan 120 Hz 1.2 kHz

          =5.71degrees one decade above f c (i.e., approaching 0 degrees)

         Remember, if a circuit or amplifier is direct-coupled, and has no lead
         networks, the phase will remain at 0 degrees right back to 0 Hz (DC).

Lag Network Response

Unlike its lead network counterpart, all systems will contain lag networks. In           Figure 10.8
essence, it is little more than an inverted lead network. As you can see from Figure     Lag network.
10.8, it simply transposes the R and C locations. Because of this, the response tends
to be inverted as well. In terms of gain, Xc is very large at low frequencies, and thus
Vout equals Vin. At high frequencies, Xc decreases, and Vout falls. The break point
occurs when Xc equals R. The general gain plot is shown in Figure 10.9. Like the
lead network response, the slope of this curve is -6 dB per octave (or -20 dB per
decade.) Note that the slope is negative instead of positive. We can derive a general
gain equation for this circuit in virtually the same manner as we did for the lead
network. The derivation is left as an exercise.

           ( )f 2                                           (10.14)

     A 'v=-10 log10 1+ 2
                             fc

     Where
     fc is the critical frequency,
     f is the frequency of interest,
     A'v is the decibel gain at the frequency of interest.

388
Note that this equation is almost the same as Equation 10.12. The only difference is
that f and fc have been transposed.

                         Lag Network Magnitude Response

                    0.1         1                            10                      100
                 10                                                                     10
                         Exact                  Approximate
                  0                                                                          Figure 10.9
Amplitude (dB)  -10                                                                          Lag network gain plot.

                                                                                        0

                                                                                        -10

                -20                                                                  -20

                                                Slope: -6dB/octave
                                                or -20dB/decade

                -30                                                                  -30

                -40             1.0  Normalized frequency    10.0                        -40
                    0.1                                                              100.0

In a similar vein, we may examine the phase response. At very low frequencies, the
circuit is basically capacitive. Because the output is taken across C, Vout will be in
phase with Vin. At very high frequencies, the circuit is essentially resistive.
Consequently, the output voltage across C will lag by 90 degrees. At the break
frequency the phase will be -45 degrees. A general phase plot is shown in Figure
10.10. As with the lead network,we may derive a phase equation. Again, the exact
steps are very similar, and left as an exercise.

                         =-90+arctan f c                                    (10.15)
                                             f

                         Where
                         fc is the critical frequency,
                         f is the frequency of interest,
                          is the phase angle at the frequency of interest.

389
                                           Lag Network Phase Response

                         0.01         0.1                   1               10                                                 100
                        0                                                                                                         0
                      -10      Exact       Approximate                                                                            -10  Figure 10.10
                      -20                                                                                                         -20  Lag network phase response.
                      -30                                                                                                         -30
     Phase (degrees)  -40                                                                                                         -40
                      -50                                                                                                         -50
                      -60             0.1                   1.0             10.0                                                  -60
                      -70                             Normalized frequency                                                        -70
                      -80                                                                                                         -80
                      -90                                                                                                         -90
                          0.0
                                                                                                                              100.0

Example 10.15

                      A medical ultra sound transducer feeds a lag network with an upper break
                      frequency of 150 kHz. What are the gain and phase values at 1.6 MHz?

                      Because this represents a little more than a 1 decade increase, the                                              Figure 10.11
                      approximate values are -20 dB and -90 degrees, from                                                              Bode plot for 150 kHz lag.
                      Figures 10.7 and 10.8, respectively. The exact values are:

                                                                                                                         A'v

                                     ( )f 2                                       0 dB                                                 150 kHz

                               A 'v=-10 log10 1+ 2                                                                                                                  f
                                                      fc

                               A 'v=-10 log10 1+( ) 1.6 MHz2   2                                                                       -6 dB/octave
                                                      150 kHz

                               A 'v=-20.6dB

                               =-90+arctan f c
                                                   f

                               =-90+arctan 150 kHz 1.6 MHz                        

                                =-84.6 degrees                                    0°                                                   15 kHz  150 kHz 1.5 MHz

                                                                                                                                                                    f

                      The complete Bode plot for this network is shown in Figure
                      10.11. It is very useful to examine both plots simultaneously. -45°
                      In this manner you can find the exact phase change for a
                      given gain quite easily. For example, if you look carefully at -90°
                      the plots of Figure 10.11, you will note that at the critical
                      frequency of 150 kHz, the total phase change is -45 degrees.

390
Because this circuit involved the use of a single lag network, this is exactly
what you would expect.

Rise Time versus Bandwidth

For pulse-type signals, the "speed" of a circuit is often expressed in terms of its rise
time. If a square pulse such as Figure 10.12a is passed into a simple lag network, the
capacitor charging effect will produce a rounded variation, as seen in Figure 10.12b.
This effect places an upper limit on the duration of pulses that a given circuit can
handle without producing excessive distortion.

Vpeak                                                                                     Figure 10.12a
                                                                                          Pulse rise time effect:
                                                                                          Input to network.

         t0                  t

By definition, rise time is the amount of time it takes for the signal to traverse from
10% to 90% of the peak value of the pulse. The shape of this pulse is defined by the
standard capacitor charge equation examined in earlier course work, and is valid for
any system with a single clearly dominant lag network.

               ( )-t               (10.16)

         V out=V peak 1- RC

  Vpeak                                                                                   Figure 10.12b
.9Vpeak                                                                                   Pulse rise time effect:
                                                                                          Output of network.

.1Vpeak

         t0 t1 t2               t

In order to find the time internal from the initial starting point to the 10% point, set
Vout to 0.1Vpeak in Equation 10.16 and solve for t1.

391
              ( )-t1                                         (10.17)

     0.1 V peak = V peak 1- RC

                                                       -t 1

     0.1 V peak = V peak -V peak  RC

                                         -t1

     0.9 V peak = V peak  RC

                              -t1

           0.9 =  RC
       log 0.9 = -t1

                   RC

             t1=0.105 RC

To find the interval up to the 90% point, follow the same technique using 0.9Vpeak .
Doing so yields:

     t2=2.303 RC                                             (10.18)

The rise time, Tr, is the difference between t1 and t2

     T r=t 1-t 2                                             (10.19)
     T r=2.303 R C-0.105 RC
     T r  2.2 R C

Equation 10.19 ties the rise time to the lag network's R and C values. These same
values also set the critical frequency f2. By combining equation 10.15 with the basic
critical frequency relationship, we can derive an equation relating f2 to Tr.

     f 2= 1 2  RC

Solving 10.19 in terms of RC, and substituting yields

     f 2= 2.2                                                (10.20)
          2 T r

      f 2=0.35
             Tr

     Where
     f2 is the upper critical frequency,
     Tr is the rise time of the output pulse.

392
Example 10.16

         Determine the rise time for a lag network critical at 100 kHz.

                     f 2=0.35
                           Tr

                    T r=0.35
                            f2

                    T r= 0.35 100 kHz
                    T r=3.5 s

10.4 Combining the Elements - Multi-Stage Effects

A complete gain or phase plot combines three elements: (1) the midband response,
(2) the lead response, and (3) the lag response. Normally, a particular design will
contain multiple lead and lag networks. The complete response is the summation of
the individual responses. For this reason, it is useful to find the dominant lead and
lag networks. These are the networks that affect the midband response first. For lead
networks, the dominant one will be the one with the highest fc . Conversely, the
dominant lag network will be the one with the lowest fc . It is very common to
approximate the complete system response by drawing straight-line segments such
as those given in Figures 10.5 and 10.7. The process goes something like this:

    · Locate all fc s on the frequency axis.
    · Draw a straight line between the dominant lag and lead fc s at the midband

         gain. If the system does not contain any lead networks, continue the
         midband gain line down to DC.
    · Draw a 6 dB per octave slope between the dominant lead and the next lower
         lead network.
    · Because the effects of the networks are cumulative, draw a 12 dB per octave
         slope between the second lead fc and the third fc. After the third fc, the slope
         should be 18 dB per octave, after the fourth, 24 dB per octave, and so on.
    · Draw a -6 dB per octave slope between the dominant lag fc and the next
         highest fc. Again, the effects are cumulative, so increase the slope by -6 dB
         at every new fc .

393
Example 10.17

     Draw the Bode gain plot for the following amplifier: A'v midband = 26 dB,
     one lead network critical at 200 Hz, one lag network critical at 10 kHz, and
     another lag network critical at 30 kHz.

     The dominant lag network is 10 kHz. There is only one lead network, so it's
     dominant by default.

     · Draw a straight line between 200 Hz and 10 kHz at an amplitude of
         26 dB.

     · Draw a 6 dB per octave slope below 200 Hz. To do this, drop down
         one octave (100 Hz) and subtract 6 dB from the present gain (26 dB
         - 6dB = 20 dB.) The line will start at the point 200 Hz/26 dB, and
         pass through the point 100 Hz/20 dB. Because there are no other
         lead networks, this line may be extended to the left edge of the
         graph.

     · Draw a -6 dB per octave slope between 10 kHz and 30 kHz. The
         construction point will be 20 kHz/20 dB. Continue this line to
         30 kHz. The gain at the 30 kHz intersection should be around
         16 dB. The slope above this second fc will be -12 dB per octave.
         Therefore, the second construction point should be at 60 kHz/4 dB
         (one octave above 30 kHz, and 12 dB down from the 30 kHz gain).
         Because this is the final lag network, this line may be extended to
         the right edge of the graph.

     A completed graph is shown in Figure 10.13.                                   Figure 10.13
                                                                                   Gain plot of complete amplifier.
          A'v
                                                  -6 dB/octave
       26 dB

               6 dB/octave                        -12 dB/octave

     0 dB                    10 k 30 k                          f
                        200

394
There is one item that should be noted before we leave this section, and that is the
concept of narrowing. Narrowing occurs when two or more networks share similar
critical frequencies, and one of them is a dominant network. The result is that the
true -3 dB breakpoints may be altered. Here is an extreme example. Assume that a
circuit has two lag networks, both critical at 1 MHz. A Bode plot would indicate that
the breakpoint is 1 MHz. This is not really true. Remember, the effects of lead and
lag networks are cumulative. Because each network produces a 3 dB loss at 1 MHz,
the net loss at this frequency is actually 6 dB. The true -3 dB point will have been
shifted. The Bode plot only gives you the approximate shape of the response.

10.6 Summary

We have seen how to convert gains and signals into a decibel form for both powers
and voltages. This is convenient because what would require multiplication and
division under the ordinary scheme only requires simple addition and subtraction in
the dB scheme. Along with this, dB measurement is used almost exclusively for
Bode gain plots. A Bode plot details a system's gain magnitude and phase response.
For gain, the amplitude is measured in dB, while the frequency is normally
presented in log form. For a phase plot, phase is measured in degrees, and again, the
frequency axis is logarithmic. The changes in gain and phase at the frequency
extremes are caused by lead and lag networks. Lead networks cause the low
frequency gain to roll off. The roll off rate is 6 dB per octave per network. The phase
will change from +90 degrees to 0 degrees per network. Lag networks cause the high
frequency gain to roll off at a rate of -6 dB per octave per network. The phase
change per lag network is from 0 degrees to -90 degrees.

Review Questions

    1. What are the advantages of using decibels over the ordinary scheme?
    2. How do decibel power and voltage gain calculations differ?
    3. Define the differences between dB, dBW, dBm, dBV and dBu.
    4. Describe a Bode plot.
    5. What is a lead network? What general response does it yield?
    6. What is a lag network? What general response does it yield?
    7. What do the terms f1 and f2 indicate about a system's response?
    8. What are the rolloff slopes for lead and lag networks?
    9. What are the phase changes produced by individual lead and lag networks?
    10. How is rise time related to upper break frequency?
    11. How do multiple lead or lag networks interact to form an overall system

         response?
    12. How does the decibel measurement scheme differ from the ordinary method

         of indicating gains and signal level?

395
10.7 Exercises

Analysis

dB emphasis

    1. Convert the following power gains into dB form: a) 10 b) 80 c) 500 d) 1
         e) 0.2 f) 0.03.

    2. Convert the following dB power gains into ordinary form: a) 0 dB b) 12 dB
         c) 33.1 dB d) 0.2 dB e) -5.4 dB f) -20 dB.

    3. An amplifier has an input signal of 1 mW, and produces a 2 W output. What
         is the power gain in dB?

    4. A Hi-Fi power amplifier has a maximum output of 50 W and a power gain
         of 19 dB. What is the maximum input signal power?

    5. An amplifier with a power gain of 27 dB is driven by a 25 mW source.
         Assuming the amplifier doesn't clip, what is the output signal in watts?

    6. Convert the following voltage gains into dB form: a) 10 b) 40 c) 250 d) 1
         e) 0.5 f) 0.004

    7. Convert the following dB voltage gains into ordinary form: a) 0.5 dB
         b) 0 dB c) 46 dB d) 10.7 dB e) -8 dB f) -14.5 dB

    8. A guitar pre-amp has a gain of 44 dB. If the input signal is 12 mV, what is
         the output signal?

    9. A video amplifier has a 140 mV input and a 1.2 V output. What is the
         voltage gain in dB?

    10. The pre-amp in a particular tape deck can output a maximum signal of 4 V.
         If this amplifier has a gain of 18 dB, what is the maximum input signal?

    11. Convert the following powers into dBW: a) 1 W b) 23 W c) 6.5 W
         d) 0.2W e) 2.3 mW f) 1.2 kW g) 0.045 mW h) 0.3 W i) 5.6E-18 W.

    12. Repeat Problem 11 for units of dBm.
    13. Repeat Problem 11 for units of dBf.
    14. Convert the following voltages into dBV: a) 12.4 V b) 1 V c) 0.25 V

         d) 1.414 V e) 0.1 V f) 10.6 kV g) 13 mV h) 2.78 V.
    15. A two stage power amplifier has power gains of 12 dB and 16 dB. What is

         the total gain in dB and in ordinary form?
    16. If the amplifier of Problem 15 has an input of -18 dBW, what is the final

         output in dBW? in dBm? in watts?
    17. Referring to Figure 10.3, what are the various stages' outputs if the input is

         changed to -4 dBm? to -34 dBW?

396
    18. Which amplifier has the greatest power output? a) 50 watts b) 18 dBW
         c) 50 dBm.

    19. Which amplifier has the greatest power output? a) 200 mW b) -10 dBW
         c) 22 dBm.

    20. A three stage amplifier has voltage gains of 20 dB, 5 dB, and 12 dB
         respectively. What is the total voltage gain in dB and in ordinary form?

    21. If the circuit of Problem 20 has an input voltage of -16 dBV, what are the
         outputs of the various stages in dBV? In volts?

    22. Repeat Problem 21 for an input of 12 mV.
    23. Which amplifier produces the largest output voltage? a) 15 V b) 16 dBV

Bode plot emphasis

    24. Given a lead network critical at 3 kHz, what are the gain and phase values at
         100 Hz, 3 kHz, and 40 kHz?

    25. Given a lag network tuned to 700 kHz, what are the gain and phase values at
         50 kHz, 700 kHz, and 10 MHz? What is the rise time?

    26. A noninverting amplifier has a midband voltage gain of 18 dB and a single
         lag network at 200 kHz. What are the gain and phase values at 30 kHz,
         200 kHz, and 1 MHz. What is the rise time?

    27. Repeat Problem 26 for an inverting (-180 degrees) amplifier.
    28. Draw the Bode plot for the circuit of Problem 26.
    29. Draw the Bode plot for the circuit of Problem 27.
    30. An inverting (-180 degrees) amplifier has a midband gain of 32 dB and a

         single lead network critical at 20 Hz (assume the lag network fc is high
         enough to ignore for low frequency calculations). What are the gain and
         phase values at 4 Hz, 20Hz, and 100 Hz?
    31. Repeat Problem 29 with a noninverting amplifier.
    32. Draw the Bode plot for the circuit of Problem 30.
    33. Draw the Bode plot for the circuit of Problem 31.
    34. A noninverting amplifier used for ultrasonic applications has a midband gain
         of 41 dB, a lag network critical at 250 kHz, and a lead network critical at
         30 kHz. Draw its gain Bode plot.
    35. Find the gain and phase at 20 kHz, 100 kHz, and 800 kHz for the circuit of
         Problem 34.
    36. If the circuit of Problem 34 has a second lag network added at 300 kHz,
         What are the new gain and phase values at 20 kHz, 100 kHz, and 800 kHz?
    37. Draw the gain Bode plot for the circuit of Problem 36.

397
    38. What are the maximum and minimum phase shifts across the entire
         frequency spectrum for the circuit of Problem 36?

    39. A noninverting DC amplifier has a midband gain of 36 dB, and lag networks
         at 100 kHz, 750 kHz, and 1.2 MHz. Draw its gain Bode plot.

    40. What are the maximum and minimum phase shifts across the entire
         frequency spectrum for the circuit of Problem 39?

    41. What is the maximum rate of high frequency attenuation for the circuit of
         Problem 39 in dB/Decade?

    42. If an amplifier has two lead networks, what is the maximum rate of low
         frequency attenuation in dB/Octave?

Challenge

    43. You would like to use a voltmeter to take dBm readings in a 600  system.
         What voltage should produce 0 dBm?

    44. Assuming that it takes about an 8 dB increase in sound pressure level in
         order to produce a sound that is subjectively "twice as loud" to the human
         ear, can a Hi-Fi using a 100 W amplifier sound twice as loud as one with a
         40 W amplifier (assuming the same loudspeakers)?

    45. Hi-Fi amplifiers are often rated with a "headroom factor" in dB. This
         indicates how much extra power the amplifier can produce for short periods
         of time, over and above its nominal rating. What is the maximum output
         power of a 250 W amplifier with 1.6 dB headroom?

    46. If the amplifier of Problem 34 picks up an extraneous signal that is a -10
         dBV sine wave at 15 kHz, what is the output?

    47. If the amplifier of Problem 39 picks up a high frequency interference signal
         at 30 MHz, how much is it attenuated over a normal signal? If this input
         signal is measured at 2 dBV, what should the output be?

    48. If an amplifier has two lag networks, and both are critical at 2 MHz, is the
         resulting f2 less than, equal to, or greater than 2 MHz?

    49. If an amplifier has two lead networks, and both are critical at 30 Hz, is the
         resulting f1 less than, equal to, or greater than 30 Hz?

Simulation

    50. Use a simulator to plot the Bode gain response of the circuit in Problem 39.
    51. Use a simulator to plot the Bode phase response of the circuit in Problem 34.
    52. Use a simulation program to generate a Bode plot for a lead network

         comprised of a 1 k resistor and a 100 nF capacitor.

398
Appendix A

                          Standard Component Sizes

Passive components (resistors, capacitors and inductors) are available in standard sizes. The tables below are for
resistors. The same digits are used in subsequent decades up to at least 1 Meg ohm (higher decades are not
shown). Capacitors and inductors are generally not available in as many standard values as are resistors.
Capacitors below 10 nF (.01 F) are usually available at the 5% standard digits while larger capacitances tend to
be available at the 20% standards.

                         5% and 10% standard values, EIA E24 and EIA E12

                                                 10% values (EIA E12) are bold
                            20% values (seldom used) are every fourth value starting from 10

                                                   (i.e., every other 10% value)
             10 11 12 13 15 16 18 20 22 24 27 30
             33 36 39 43 47 51 56 62 68 75 82 91

                         1% and 2% standard values, EIA E96 and EIA E48

                                                  2% values (EIA E48) are bold
            10.0 10.2 10.5 10.7 11.0 11.3 11.5 11.8 12.1 12.4 12.7 13.0
            13.3 13.7 14.0 14.3 14.7 15.0 15.4 15.8 16.2 16.5 16.9 17.4
            17.8 18.2 18.7 19.1 19.6 20.0 20.5 21.0 21.5 22.1 22.6 23.2
            23.7 24.3 24.9 25.5 26.1 26.7 27.4 28.0 28.7 29.4 30.1 30.9
            31.6 32.4 33.2 34.0 34.8 35.7 36.5 37.4 38.3 39.2 40.2 41.2
            42.2 43.2 44.2 45.3 46.4 47.5 48.7 49.9 51.1 52.3 53.6 54.9
            56.2 57.6 59.0 60.4 61.9 63.4 64.9 66.5 68.1 69.8 71.5 73.2
            75.0 76.8 78.7 80.6 82.5 84.5 86.6 88.7 90.9 93.1 95.3 97.6

399
Appendix B

          Methods of Solution of Linear Simultaneous Equations

Some circuit analysis methods, such as nodal analysis and mesh analysis, yield a set of linear simultaneous
equations. There will be as many equations as there are unknowns. For example, a particular circuit might yield
three equations with three unknown currents (often referred to as a "3 by 3" for the matrix it creates). There are
several techniques that may be used to solve this system of equations. The methods include graphical,
substitution, Guass-Jordan elimination and determinants (determinants may be solved via Cramer's Rule/Sarrus'
Rule or via expansion by minors).

Graphical

Graphical solutions involve plotting the individual equations on graph paper. The location of where the lines
cross is the solution to the system (i.e., values that satisfy all of the equations). This technique will not be
discussed further because it is only practical for two unknowns. It would be very difficult to draw something
like a four dimensional graph for four equations with four unknowns!

Substitution

The idea here is to write one of the equations in terms of one of the unknowns and then substitute this back into
one of the other equations resulting in a simplified version. This process is iterated for as many unknowns as the
system includes. Take for example the following 2x2:

10 = 20I1 + 8I2
 2 = 8I1 + 4I2

Solve the second equation for I2.

 2 = 8I1 + 4I2
4I2 = 2 - 8I1

 I2 = 0.5 - 2I1

Substitute this back into the first equation and expand/simplify/solve.

10 = 20I1 + 8I2
10 = 20I1 + 8(.5 - 2I1)
10 = 20I1 + 4 - 16I1
10 = 4I1 + 4
I1 = 1.5

Finally, substitute this value back into one of the two original equations to determine I2.

400
   2 = 8I1 + 4I2
   2 = 8(1.5) + 4I2
   2 = 12 + 4I2
4I2 = -10
 I2 = -2.5

For a 3x3, this process is iterated as follows: Equation 2 would be solved for I3 and this would be substituted
back into equation 1 yielding a new equation (let's call it A) with only I1 and I2 terms. Similarly, Equation 3
would be solved for I3 and this would be substituted back into equation 2 yielding a new equation (let's call it B)
with only I1 and I2 terms. Equations A and B now make a 2x2 with I1 and I2 as the unknowns and can be solved
as outlined above. This would yield values for I1 and I2 which could then be substituted into one of the three
original equations to obtain I3. While the substitution method is perfectly valid for an arbitrarily sized system, it
proves cumbersome as the system gets larger.

Gauss-Jordan Elimination

In some respects, Gauss-Jordan is similar to substitution but it tends to involve less overhead for larger systems
and thus is generally preferred. This method involves multiplying one equation by a constant such that when it is
subtracted from another equation, one of the unknown terms disappears. The process is then iterated for as many
unknowns exist in the system. Using the same example from before:

10 = 20I1 + 8I2
 2 = 8I1 + 4I2

Multiply the second equation by the ratio of the coefficients for I2 (8/4 = 2).

 2 = 8I1 + 4I2
 4 = 16I1 + 8I2

Subtract this new equation from the first equation. The I2 terms will cancel leaving just I1.

10 = 20I1 + 8I2
 4 = 16I1 + 8I2
 6 = 4I1
I1 = 1.5

Substitute this result back into one of the original equations to obtain I2. For a 3x3, iterate as follows: Using
equations 1 and 2, multiply equation 2 by the ratio of the coefficients for I3. Subtract this equation from equation
1 to generate a new equation (let's call it equation A) that only has I1 and I2 as unknowns. Using equations 2 and
3, multiply equation 3 by the ratio of the coefficients for I3. Subtract this equation from equation 2 to generate a
new equation (let's call it equation B) that only has I1 and I2 as unknowns. Equations A and B now make a 2x2
with I1 and I2 as the unknowns and can be solved as outlined previously. This would yield values for I1 and I2
which could then be substituted into one of the three original equations to obtain I3. Like the substitution
method, Gauss-Jordan grows rapidly as the system size increases. The process tends to be formulaic though, and
thus easier to handle.

401
Determinants

Determinants revolve around the concept of a matrix which itself is little more than an ordered collection of
coefficients and/or constants. It is imperative that the unknowns be in the same order in each equation (i.e., I1
ascending to IX left to right) A simple coefficient matrix for the original 2x2 example is:

20 8
 8 4

The resultant value (properly referred to as the determinant) for a 2x2 matrix such as this may be solved using
Sarrus' Rule: Simply multiply the two values along the upper right-lower left diagonal and then subtract that
product from the product of the two values found along on the upper left-lower right diagonal. In this example
that's:

20*4 - 8*8 = 16

A solution involves dividing one determinant by another determinant (Cramer's Rule). That is, each matrix is
solved for its resultant value and then these two values are divided to determine the final answer. One of these
matrices will be the coefficient matrix just discussed. This will be placed in the denominator. The numerator
matrix is a modified version of the basic coefficient matrix. It is created by replacing one column of coefficients
with the constant values from the original system of equations. For example, the numerator matrix used to find
I1 would replace the first column (the I1 coefficients 20 and 8) with the constants 10 and 2:

10 8
 2 4

The resultant value is 40 - 16 or 24.

Similarly, the numerator matrix for I2 would replace the I2 coefficients in the second column (8 and 4) with the
constants 10 and 2:

20 10
 8 2

The resultant value is 40 - 80 or -40. To find any particular unknown, simply divide the modified matrix by the
basic coefficient matrix.

          10 8
            2 4

I1 = --------
          20 8
            8 4

          24
I1 = -----

          16

402
I1 = 1.5

In like fashion I2 is found:

          20 10
            8 2

I2 = --------
          20 8
            8 4

        -40
I2 = -----

          16

I2 = -2.5

Sarrus' Rule may also be used with a 3x3 matrix. This is achieved by extending the matrix. Fourth and fifth
columns are added to the right of the 3x3 matrix by simply making copies of the first two columns. This creates
three right to left diagonals with three values each and three left to right diagonals with three values each. The
three values along each diagonal are multiplied together. The three right to left products are then subtracted from
the sum of the three left to right products yielding a single resultant value (the determinant). To create the
modified numerator matrix, replace the coefficient column of interest with the constant terms and then replicate
columns one and two. For example, given these three equations:

10 = 20I1 + 8I2 + 3I3
 2 = 8I1 + 4I2 + 5I3
 7 = 3I1 + 5I2 + 6I3

The basic coefficient matrix (i.e., denominator) is:

20 8 3
 8 4 5
 3 5 6

The extended matrix is:
20 8 3 20 8

 845 84
 356 35

The result is:

20*4*6 + 8*5*3 + 3*8*5 - 3*4*3 - 20*5*5 - 8*8*6

Sarrus' Rule does not work beyond 3x3.

403
Expansion by Minors

Expansion by Minors is another method that may be used to generate a determinant solution. This involves
breaking the matrix into a series of smaller matrices (minors) that are combined using row-column coefficients.
The position of these coefficients will also indicate whether the determinant of any particular sub-matrix is
added or subtracted to the total.

The first step is to establish a single row or column from which to derive the coefficients. This can be any
horizontal row or vertical column (no diagonals). Each element of the chosen row or column determines the
associated minor (essentially, that which is left over). Consider the 3x3 used previously:

20 8 3
 8 4 5
 3 5 6

Choosing the top row yields coefficients of 20, 8 and 3. For each of these, blot out its row and column and see
what is left. This leaves three 2x2 matrices, one for each coefficient. Multiply each coefficient by the
determinant of its 2x2 matrix. To determine whether this result is added or subtracted to the others, the sign may
be found using the following map for the coefficients:

+ - + - etc.
- + - + etc.
+ - + - etc.

The origin in the upper left is positive and the signs continually alternate across from it and down from it. The
result using the top row for the coefficients is found thus (the 2x2 matrices are bold red for clarity):

     4 5  8 5        8 4

20 * 5 6 - 8 * 3 6 + 3 * 3 5

If the second column was used instead (8, 4, 5), the result is found like so:

     8 5  20 3       20 3

-8 * 3 6 + 4 * 3 6 - 5 * 8 5

In closing, whichever method is used, always look for null coefficient terms (that is, places in the equations and
matrices where the coefficients are zero). Smart use of these can considerably simplify the computations as there
are few mathematical operations easier than multiplying by zero. For example, if a particular row of a matrix
contains a few zeros, that would be a good candidate for the coefficient row when using expansion by minors
because some 2x2 minors need not be computed (they will just be multiplied by the zero coefficient).

404
Appendix C

                                Equation Proofs

RMS Equivalents for Non-Sines

For any waveform, the root-mean-square equivalence factor is computed by normalizing the peak value to unity,
squaring the waveform, finding the mean value of that intermediate result, and then taking the square root of the
mean. This value can never be more than unity.

The RMS value of a square wave is equal to its peak value. This can be proven by observation. Normalize the
square wave's peak value to unity. Its negative peak will be -1. Squaring these values results in the constant
value 1 at any time (assuming the rise and fall times are negligible). Obviously, the mean of this is 1 as is its
square root. Thus the RMS equivalence factor is unity.

For a rectangular pulse that is always positive (i.e., traversing from zero volts to some positive peak and back to
zero), the RMS value is equal to its peak value times the square root of its duty cycle. As there is no negative
portion to this waveform, we need only examine the positive portion. First, its normalized amplitude is always
unity, as is its squared value. The mean is simply the time for this positive pulse divided by the period of the
wave. By definition, that's equivalent to the duty cycle (i.e., the percentage of time the pulse is positive out of a
full cycle). Thus, the RMS equivalence factor is the square root of the duty cycle.

For a triangle wave, the RMS value is equal to its peak value times one over the square root of three. This can be
proven by first noting that a triangle wave has quarter wave symmetry. Consequently, we need examine only the
first quarter of a cycle because the other three will produce identical numerical results.

To ease computation, normalize the amplitude and the time for the first quarter cycle to unity. The result is a
straight line that starts at the origin and reaches an amplitude of 1 when time also reaches 1. Written as a
function of time, the expression for such a voltage is:

          v(t)= t

Squaring this gives us t2. To find the mean, we integrate this function:

                          t

     mean = t2 dt
                          0

      mean = 13 t3 |t=0 t=1

          mean = 1
                     3

Finally, taking the square root results in a factor of one over the square root of three. QED.

405
Maximum Power Transfer: Finding the Maximizing Value of P = R/(R2+2R+1)

While the algebraic and graphing technique explored in Chapter 5 leads to a proper answer, it is incomplete. A
more rigorous treatment using differential calculus follows. We have already determined that the reactive
portion of the load must have the same magnitude but opposite sign of the internal reactance in order to
maximize load current, and therefore maximize load power. Thus, we need only examine the resistive portion
which is described by the equation P = R/(R2+2R+1). This function exhibits a single peak and thus we may find
the corresponding value by taking the first derivative of the function, setting it to zero (i.e., find the point where
the slope goes to zero), and solving for R. Chain rule can be used to solve this. Chain rule states:

                                    dx  dx  du
                                    dy du dy

One way to apply the chain rule is first to rewrite the main equation to remove the numerator R. This effectively
removes the issues of having a quotient or product. We divide through by R and arrive at:

                                    P 1 1
                                         R2 R

or in a somewhat more convenient form:

                                    P  (R  2  R 1 )1

Using the chain rule the derivative of this is:

                        dP  (R  2  R1 )2 (1  R2 )
                        dR

or in "prettier" form:

                        dP                       1 R2

                                                               1 2
                        dR (R  2  R )

Multiply through by R2

                        dP  2  1 R2

                        dR (R  2R 1)                2

Which, for a really anal retentive sort of completeness, can be rewritten as:

                        dP 1 R2
                            
                        dR (R 1)                 4

For dP/dR to be zero, R must equal 1. In other words, it must match the internal resistance. QED.

406
Finding k0 : Determining f1 and f2 in Resonant Circuits

The coefficient k0 was defined such that: f 1 = f 0 k and f 0 2 = f 0×k 0

We start with the definition of circuit Q based on bandwidth and resonant frequency, and expand, solving in
terms of f2.

     Qcircuit = f 0 = f 0
                BW f 2 - f 1

     f 2 = f 0 +f 1                                                        (EQ 1)
           Qcircuit

The resonant frequency is equal to the geometric mean of f1 and f2.

     f0= f1 f2

            f 02                                                           (EQ 2)
     f 1=

            f2

Substituting EQ 2 into EQ 1 yields:

     f 2 = f 0 + f 02                                                      (EQ 3)
           Qcircuit f 2

We normalize f0, taking it as unity. This means that f2 is now equivalent to k0. Rewriting EQ 3 yields:

     k0 = 1 + 1
           Q circuit k 0

     0 = k 02 - 1 k0 -1
                Q circuit

We can solve this using the quadratic formula where a = 1, b = 1/Qcircuit and c = -1.

     -b±b2 -4 ac

            2a

Substituting and simplifying results in the equation for k0 :

      k0 = 1 + 2 1 +1
     2Q circuit                      4 Qcircuit

407
Appendix D

              Answers to Selected Odd-Numbered Problems

                                            1 Fundamentals

 1. 10, 7.07, 0, 1 kHz, 1 ms, 0°                  3. 20, -3, 50 Hz, 20 ms, 0°
 5. 10, 7.07, 0, 100 Hz, 10 ms, 45°               7. 1, 10, 400 Hz, 2.5 ms, -45°
 9. 200 s, 10 s                                   11. 36°
13. 14.1445°, 11.2-63.4°, 102169°, 5k53.1°        15. 7.07 + j7.07, j0.4, -4.5 + j7.79, 70.7 - j70.7
17. 15 + j30, j4, -20-j4, -70 + j250
                                                  19. -34.5k + j36k, -725 + j95, 2.39 -j0.709,
21. 1000°, 10-115°, 0.5145°, 0.25-45°             -2.71 -j0.457
25. -j15.9 k, -j318, -j15.9, -j0.398, -j15.9E-3 
29. j6.28, j314, j6.28 k, j251 k, j6.28 M         23. 2.7180°, 4.91-92.7°, 0.076123°, 5444.5°
33.                                               27. -j318 M, -j6.77 M, -j144.7 k, -j96.5 
                                                  31. j62.8, j3.14 k, j62.8E-3, j2.51 
                                                  35. 1.67 @ 3 kHz, 1 @ 5 kHz, 0.714 @ 7 kHz,
                                                  0.555 @ 9 kHz, 0.455 @ 11 kHz

408
37. 284 nF, 482 pF, 339 pF, 132.6 nF, 212 nF  39. 892 nH, 525 H, 748 H, 1.91 H, 1.19 H
41. a                                         43. b

409
 1. 2k - j1.94 k                     2 Series RLC Circuits
 5. 1 k - j1.278 k 
 9. 1.447 F                                          3. 270 + j125.7 
13. i is 241 mA p-p and lags by 90°                  7. 300 - j400
17. 1 k - j318                                      11. v(t)=0.1sin21000t (i and v are in phase)
                                                    15. v is 16.6 V p-p and leads by 90°
                                                    19. i = 953E-617.6° amps, vR = 953E-317.6°
                                                    volts, vC = 303E-3-72.4° volts, delay = 25 s

21. 1 k + j3.14 k                                23. 1 k + j942 

25. 2 k - j33.4                                  27. i = 0.4999E-3.957° amps, vR = 0.998.957°
                                                 volts, vC = 16.7E-3-89° volts, delay = 167 s
29. i = 21.2E-345° amps, vR = 4.2445° volts,
vC = 4.24-45° volts                              31. vS = 60.9-23.2° volts, vR = 560° volts,
                                                 vC = 24-90° volts
33. i = 329E-670.8° amps, vR = 329E-370.8°
volts, vC = 1.05-19.2° volts, vL = 103E-3160.8°  35. i = 48.7E-3-13° amps, vR = 9.745-13° volts,
volts                                            vC = 3.88-103° volts, vL = 6.12577° volts

37. i = 493E-39.52° amps, vB = 58.241.6° volts,  39. i = 1E-30° amps, vR = 10° volts,
vAC = 63-29° volts                               vC = 200E-3-90° volts, vL = 200E-390° volts

410
41. i = 2.24E-363.4° amps, vB = 8.94-26.6° volts, 43. i = 35.36E-3-45° amps, vC = 2.12-135° volts,

vC = 2.24153.4° volts, vAC = 12-4.8° volts        vR = 1.414-45° volts, vL = 3.5445° volts

45. vR = 100° volts, vC = 5.3-90° volts,          47. vR = 2.40° volts, vL = 85.4E-390° volts,
vL = 7.0790° volts                                vC = 424E-390° volts

49. vR = 1100° volts, vC = 88-90° volts,          51. vAC = 6087.8° volts, vB = 20.1-83.3° volts,
vL = 22090° volts                                 vC = 20-90° volts

53. vR = 0.32970.8° volts, vL = 0.1034160.8° volts, 55. L = 79.6 H, C = 7.24 nF
vC = 1.048-19.2° volts

57. vR = 7.23-130° volts, vL = 3.62-40.1° volts,  59. f = 15.594 kHz
vC = 1.45139.9° volts

61. f = 3.185 kHz

                                          3 Parallel RLC Circuits

  1. 73.2-12.5° (71.4 -j15.8)                     3. 99-8.04° (98 -j13.8)
411
5. 182.952.4° (111.5 + j145)                7. f = 45.2 MHz
9.
                                            11. is = 0.1200010.18°, iR = 0.120°,
                                            iC = 377E-690°

13. is = 9.43E-3-58°, iR = 5E-30°,          iC 15. is = 47.4E-316.3°, iR = 45.5E-30°,
= 2E-390°, iL = 10E-3-90°                       iC = 20E-390°, iL = 6.667E-3-90° (all peak)

17. iR = 19.99E-3-1.73°, iC = 603E-688.27°  19. vR = vL = 627E-387° volts

21. vs = 2.82-28.1° volts                   23. i2.2k = 5.06E-3-68.2°, i4.7k = 2.37E-3-68.2°,
                                            iC = 55.7E-321.8°, iL = 37.1E-3-158.2°
25. iC = 670E-6150°, iL = 536E-6-30°,
iR = 2.23E-360°                             27. iR = 1.67E-3-5°, iC = 835E-685°,
29. 2.84 F                                  iL = 1.044E-3-95°

412                                         31. 7.7 nF
33. 34.5 nF                               35. 65.7 nF
37. 390 nF                                39. 507 nF
41. 128 mH

             4 Series-Parallel RLC Circuits

 1. Z10k  1250°, Z1M  125-0.8°,           3. Z300  0.7590°, Z30k  77.589.4°,
Z100M  68.8-24.2°                         Z3M  9075.4° 
 5. Z = 18051.6° 
                                          7. is = 9.64E-3-85.6°, iR = 740.7E-60°,
 9. vR = vC = 3.45-80.5°, vL = 7.2827.9°  iC = iL = 9.62E-3-90°,

13. vb = 9.19-50°, vab = 15.826.5°        11. i50 = 31.4E-690°, i91 = i20 = 12.6E-689.9°,
                                          is  44E-690°
17. vb = 1200.7°, vab = 20-175.6°
21. va = 4.814.1°, vb = 6.6214.1°         15. ij4k = 5E-3-90°, i2.7k = 7.41E-30°,
25. va = 19.85127.2°, vb = 23.8127.9°     i3.9k = i-j1k = 4.97E-314.4°, is = 12.8E-3-17.1°
29. va = 7.3261.5°, vb = 7.175.6°
33. 217 nF                                19. i15k = iL = 887E-6-4°, i12k = 1.12E-33.17°
37. 5.9 F
                                          23. va = 571E-3-26.5°, vb = 537E-3-6.68°

                                          27. ic = 12.83E-3136.9°

                                          31. vab = -133.30°

                                          35. 3.24 F

                                          39. 19.1 mH

413
     5 Analysis Theorems and Techniques

1. vb = 2.993.5°                                        3. i82 = 13.3E-359.8°
5. vb = 1.08165°                                        7. i2.2k = 1.3E-349.2° (or -130.8°)
9. vb = 7.8498.9°, vcd = 10.2-44.2°                     11. iS1 = 337E-6-73.6°, iS2 = 401E-6152°
13. vab = 14.3-25.4°                                    15. vab = 972E-3-166°
17. va = 1.31-174°, vb = 2.58-154°                      19. iC = 103E-3101°, iL = 369E-3171°
21. vbc = 19.65-102.5°                                  23. iE = 14.8E-3177°
25. vb = 10.748.4°                                      27. iL = 286.7E-340.6°
29. vab = 7.18-115°                                     31. ZTH = 910°, ETH = 10°
33. ZTH = ZN = j714.3, ETH = 8.5710°,                   35. ZN = 514.531°, IN = 24E-3-45°
IN = 12E-3-90°
37. vb = 5.69-71.5°                                     39. ZN = 156417.1°, IN = 19.2E-3-17.1°,
                                                        ZL = 1495 - j461
41. ZTH = ZN = 64.418.8°, ETH = 113.618.8°,             43. All three pair = 3.33 k + j3.33 k
IN = 1.7650°, Combo needed = 61 - j20.7,
P = 52.9 W                                              47. Za = Zxy = 3.667 k + j3.667 k,
45. All three pair = 1.33 k - j1 k                      Zb = Zxz = 5.5 k + j5.5 k, Zc = Zyz = 11 k + j11 k
                                                        51. vbc = 4.554565.4°
49. Za = Zxy = 1.83 k - j1.83 k,
Zb = Zxz = 2.75 k - j2.75 k, Zc = Zyz = 5.5 k - j5.5 k  55. iS = 1.54E-3-22.7°, in parallel with a series
53. iS = 11.8E-3101°, in parallel with a series         combination of 600  and 2 mH
combination of 1 k and 79.6 nF                          59. eS = 96.319°, in parallel with a series
57. eS = 1.98E3-49.3°, in series with 4.3 k and a       combination of 9.1 k and 5 mH
capacitive reactance of -j5 k

414
61.          63.

65. -j43.8 

415
6 Nodal and Mesh Analysis

 1. vc = 34.437.7°                                3. i43 = 33.2E-344.4°
 5. vc = 180-106°                                 7. i4 = 772E-347.1°
 9. vac = 18.35-80.8°                             11. i22 = 3.07-153°
13. vc = 6.09-3.68°                               15. i3.3k = 9.86E-318.8°
17. vc = 1838.9°                                  19. vbc = 1.0959.8°
21. vba = 285E-398°                               23. vcb = 15.2149°
25. Loop ordering is left to right                27. i75 = 8.22E-3-138.5°

     20° = (4.9 k)i1 - (2.2 k)i2                  31. ij200 = 4.36E-3-28.5°
    -30° = - (2.2 k)i1 + (2.2 k - j106)i2
    vb = 2.99-3.5°                                35. i-j200 = 49.5E-3-44.8° (up)
29. Loop ordering is left to right                39. ij300 = 11.7E-3138° (up)
     200° = (6.6 k + j4 k)i1 - (2.7 k + j4 k)i2   43. iR3 = 9.81E-3175°
    -50° = - (2.7 k + j4 k)i1 + (4.5 k + j3 k)i2  47. i2.2k = 1.51E-3-2.04°
vb = 7.8498.9°                                    51. i330 = 7.76E-314.1°
33. vcd = 218E-3-153°                             55. vb = 2.6842.3°
37. vc = 14.4133.3°                               59. vc = 106.790.6°
41. vbc = 4.54565.4°                              63. va = 9.776°, vb = 0.273-12.3°
45. vb = 9.24-8.7°                                67. vab = 90.6-112°
49. vab = 14.3-25.4°                              71. vd = 16.670.191°
53. vbc = 58.9175°
57. i5k = 49.9E-6-29.9°
61. i1k = 17.8E-321.8°
65. i1k = 5.24E-332.9°
69. i1k = 99.95E-60°

416
                                              7 AC Power

1. S = 6.25 mVA, P = 4.88 mW, Q = 3.9 mVAR (ind), 3. S = 64.4 VA, P = 57.7 W, Q = 28.8 VAR (ind), PF =

PF = 0.781                                    0.894

5. S = 315 VA, P = 162 W, Q = 270 VAR (ind),  7. S = 751 VA, P = 720 W, Q = 216 VAR (cap),
PF = 0.515                                    PF = 0.958

9. i = 4.286 A, P = 90.9 W                    11. P = 6.4 kW, Q = 4.8 kVAR, L = 2.86 mH

13. S = P = 180 W, Q = 0 VAR, i = 1.5 A       15. S = P = 1600 W, Q = 0 VAR

17. S = 1523 VA, P = 1400 W, Q = 600 VAR,     19. S = 1811 VA, P = 1800 W, Q = 200 VAR,
PF = 0.919, i = 12.7 A                        PF = 0.994, i = 15.09 A

21. 89.5%                                     23. 0.829

25. S = 683 VA, P = 478 W, Q = 488 VAR,       27. S = 2403 VA, P = 2332 W, PF = 0.971, i = 20 A
i = 5.69 A

29. S = 3154 VA, P = 2943 W, Q = 1135 VAR,    31. 141 F
PF = 0.933                                    35. 17.6 mH
33. 102 mH
37. 260 F

417
                                                    8 Resonance

1. BW = 14.67 kHz, f1 = 432.7 kHz, f2 = 447.3 kHz    3. Qcoil = 50, Rcoil = 1.88 

5. 15 k || j600                                      7. Rp = 20.36 k, Lp = 75 H

9. f0 = 247 kHz, Q = 10.2                            11. f0 = 5.03 kHz, Qsys = 8.35, BW = 602 Hz

13. f0 = 10.07 kHz, Qsys = 4.22, BW = 2.39 kHz,      15. f0 = 10.07 kHz, Qsys = 3.51, BW = 2.87 kHz,
vC = 4.22                                            vC = 3.51
17. f0 = 10.07 kHz, Qsys = 4.22, BW = 2.39 Hz,       19. f0 = 136.8 kHz, Qsys = 11, BW = 12.4 kHz,
vR= 1.5, vC = 6.32                                   iL = 424E-3-84.8°, iC = 425.5E-390°
21. f0 = 360.4 kHz, Qsys = 24.1, BW = 14.9 kHz,      23. f0 = 142.4 kHz, Qsys = 14.35, BW = 9.92 kHz,
iR = 3.19E-30°, iC = 169.8E-390°,                    iR = 5E-30°, iC = 111.9E-390°,
iL = 169.8E-3-88.7°                                  iL = 111.8E-3-88.6°

25. f0 = 225 kHz, Qsys = 25.3, BW = 8.9 kHz,         27. 135 H
iR = 149E-60°, iC = 12.6E-390°,
iL = 12.6E-3-88.4°, vR = 1.787                       31. Qsys = 50, however, none of the inductors exhibit
                                                     Qcoil  50 at 1 MHz. Therefore there are no viable
29. 6.94 k                                           candidates because Qsys can be no larger than Qcoil.

                                   9 Polyphase Power

1. vLINE = 1200° V (with 120° and 240°, other        3. vLINE = 208 V, iLINE = iLOAD = 10.4 A, PLOAD = 6490 W
phases not shown from here on), iLINE = 20.8 A,
iLOAD = 12 A, PLOAD = 4320 W

5. vLINE = 120 V, vLOAD = 69.3 V, iLINE = 13.86 A,   7. vLINE = vLOAD = 208 V, iLINE = 6 A, PLOAD = 2160 W
iGEN-PHASE = 8 A, PTOTAL = 2880 W

9. vLINE = 208 V, iLINE = 33.4 A, SLOAD = 12 kVA,    11. vLINE = 120 V, iLINE = iLOAD = 11.14 A, SLOAD = 4 kVA,
PLOAD = 11.1 kW                                      PLOAD = 3.72 kW

13. vLINE = vLOAD = 398 V, iLINE = 13.8 A, iLOAD = 7.97 A, 15. vLINE = 120 V, iLINE = iLOAD = 11. A, SLOAD = 4 kVA,

SLOAD = 9.52 kVA, PLOAD = 7.61 kW                    PLOAD = 3.72 kW

17. vLINE = 120 V, iLINE = 2.747 A, SLOAD = 571 VA,  19. 91.5 F
PLOAD = 566 W

418
                                      10 Decibels and Bode Plots

1) A) 10 dB B) 19 dB C) 26.99 dB D) 0 dB E) -6.99 dB F) -15.23 dB
3) 33 dB
5) G = 501, Pout = 12.53 W
7) A) 1.06 B) 1 C) 199.5 D) 3.43 E) 0.398 F) 0.188
9) A = 8.57 A' = 18.66 dB
11) A) 0 dBW B) 13.6 dBW C) 8.13 dBW D) -7 dBW E) -26.4 dBW F)30.8 dBW
G) -43.5 dBW H) -65.2 dBW I) -172.5 dBW
13) A) 150 dBf B) 163.6 dBf C) 158.1 dBf D) 143 dBf E) 123.6 dBf F) 180.8 dBf
G) 106.5 dBf H) 84.8 dBf I) -22.5 dBf
15) G'total = 28 dB, G = 631
17) For P'in = 4 dBm: output stage 1 = 6 dBm, stage 2 = 0 dBm, stage 3 = 15 dBm.
For P'in = -34 dBm: output stage 1 = - 24 dBW, stage 2 = -30 dBW, stage 3 = -15 dBW.
19) a. 200 mW
21) V'out = 21 dBV, 21 dBV = 11.2 V (final output)
For stage 1: 4 dBV = 1.58 V
For stage 2: 9 dBV = 2.82 V
23) a. 15 V
25) At 50 kHz: -0.022 dB, -4.09 degrees
At 700 kHz: -3 dB, -45 degrees
At 10 MHz: -23.1 dB, -86 degrees
Tr = 500 sec
27) The amplitude portion does not change. Phases are: At 30 kHz -188.5 degrees, at 200 kHz -225 degrees,
at 1 MHz -258.7 degrees

419
29)                                                                             20 kHz  2 MHz

                   A'v                                                      0°                    f
                                                                       -180°
                  18 dB
                                                                       -270°
                                                  200 kHz
                                                           f

31) At 4 kHz: 78.7 degrees, at 20 Hz: 45 degrees, at 100 Hz: 11.3 degrees

33)

     A'v                                                   

     32 dB                                                 90°

                                                           45°

            20 Hz                                                          0°   2 Hz 20 Hz 200 Hz f

                                                           f

35) Net gain at 20 kHz = 35.87 dB
Net phase at 20 kHz = 51.7 degrees
At 100 kHz: phase = -5.1 degrees, A'v = 40 dB
At 800 kHz: phase = -70.5 degrees, A'v = 30.5 dB

37)

       A'v

                     30 kHz 250 kHz 300 kHz f

420
39)

             A'v

           36 dB

                       100 kHz 750 kHz 1.2 MHz f
41) Each lag network rolls off at 20 dB/decade for a 60 dB/decade total (i.e., above 1.2 MHz).
43) 0.775 V
45) 360 W
47) 71.5 dBV
49) Greater than 30 Hz.

421
Appendix E

A Closing Observation

This title is the twelfth in a series of free open educational resources, now at five texts and seven laboratory
manuals. People occasionally ask why these titles have not gone through the typical route of using a traditional
publisher (indeed, the Operational Amplifiers & Linear Integrated Circuits text went that route originally and
then reverted to OER for its third edition). Surely, money is to be made, and after all, this is the culture that
invented the modern use of the word "monetize". In a culture that seeks to monetize everything, creating
something of value and then giving it away is a subversive act. Some people do not see the incessant search for
profit as necessarily a societal good.

422
