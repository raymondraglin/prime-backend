                  Introduction to
Linear, Time-Invariant, Dynamic Systems

         for Students of Engineering

                     William L. Hallauer, Jr.
                          INTRODUCTION TO
     LINEAR, TIME-INVARIANT, DYNAMIC SYSTEMS

               FOR STUDENTS OF ENGINEERING

                         William L. Hallauer, Jr.

Permission of the author is granted for reproduction in any form of this book or any part
of this book, provided that there is appropriate attribution, for example, by a citation in
the References section of a technical article, and provided that the reproduction is not
made for the purpose of charging a fee to users (e.g., students in a class) beyond the cost
of reproduction.

However, plagiarism from this book is prohibited, and any use of the material in this
book to produce profit or income beyond the cost of reproduction is prohibited.

                                 © 2016 by William L. Hallauer, Jr.

                          Introduction to Linear, Time-Invariant, Dynamic Systems for
                          Students of Engineering is licensed under a Creative Commons
                          Attribution-NonCommercial 4.0 International License. For details
of use requirements, please see https://creativecommons.org/licenses/by-nc/4.0/.

Trademark Notice: Product or corporate names printed herein may be trademarks or
registered trademarks. They are printed only for unique identification and for explana-
tion, without intent to infringe.
                                INTRODUCTION TO
           LINEAR, TIME-INVARIANT DYNAMIC SYSTEMS

                     FOR STUDENTS OF ENGINEERING

                                      William L. Hallauer, Jr.

                               AUTHOR'S PREFACE

         I taught many times the college undergraduate, junior-level, one-semester course
entitled "AOE 3034, Vehicle Vibration and Control" in the Department of Aerospace and
Ocean Engineering (AOE) at Virginia Polytechnic Institute and State University (VPI &
SU). I was dissatisfied using commercially available textbooks for AOE 3034, so I began
writing my own course notes, and those notes grew into this book. Although this project
began with preparation of informal handout notes, the completed book is a formal college
engineering textbook, complete with homework problems at the end of each chapter, a
detailed Table of Contents, a list of References, and a detailed Index. I hope that this
book will be understandable and enlightening for students of engineering system dynam-
ics, a valuable teaching resource for course instructors, and a useful reference for self-
study and review.

         The content of this book is based primarily on topics that the faculty of AOE and
VPI & SU elected to include in AOE 3034 during the 1990s and early 2000s. The con-
cise course description is: "Free and forced motions of first-order systems. Free and
forced motions of second-order systems, both undamped and damped. Frequency and
time responses. Introduction to control, transfer functions, block diagrams, and closed-
loop system characteristics. Higher-order systems." A more detailed course description
is provided by the following list of primary learning objectives, which were developed to
satisfy requirements of the agency that accredits engineering college degrees in the
United States:

                  At the completion of AOE 3034, the student should be able to:

         1. Solve first-, second-, and higher-order, linear, time-invariant (LTI) or-
         dinary differential equations (ODEs) with forcing, using both time-domain
         and Laplace-transform methods.

         2. Solve for the frequency response of an LTI system to periodic sinusoi-
         dal excitation and plot this response in standard form (log magnitude and
         phase versus frequency).

         3. Explain the role of the "time constant" in the response of a first-order
         LTI system, and the roles of "natural frequency", "damping ratio", and
         "resonance" in the response of a second-order LTI system.

                                                   AP-1
                                                      Author's Preface

         4. Derive and analyze mathematical models (ODEs) for low-order me-
         chanical systems, both translational and rotational systems, that are com-
         posed of inertial elements, spring elements, and damping devices.

         5. Derive and analyze mathematical models (ODEs) for low-order electri-
         cal systems (circuits) composed of resistors, capacitors, inductors, and op-
         erational amplifiers.

         6. Derive (from ODEs) and manipulate Laplace transfer functions and
         block diagrams representing output-to-input relationships of discrete ele-
         ments and of systems.

         7. Define and evaluate "stability" for an LTI system.

         8. Explain "proportional", "integral", and "derivative" types of feedback
         control for single-input, single-output (SISO), LTI systems.

         9. Sketch the locus of characteristic values, as a control parameter varies,
         for a feedback-controlled SISO, LTI system.

         10. Use MATLAB1 as a tool to study the time and frequency responses of
         LTI systems.

         Rather that summarizing the contents of this book chapter by chapter, I invite the
reader of this preface to peruse the detailed Table of Contents. However, the book's gen-
eral organization is the following: Chapters 1-10 deal primarily with the ODEs and be-
haviors of first-order and second-order dynamic systems; Chapters 11 and 12 touch on
the ODEs and behaviors of mechanical systems having two degrees of freedom, i.e.,
fourth-order systems; Chapters 13 and 14 introduce classical feedback control, motivat-
ing the concept with what I believe is a unique approach based on the standard ODE of a
second-order dynamic system; Chapter 15 presents the basic features of proportional, in-
tegral, and derivative types of classical control; and Chapters 16 and 17 discuss methods
for analyzing the stability of classical control systems. The principal parts of Chapters 1-
16 are focused on the ten primary learning objectives listed above. I added Chapter 17 on
frequency-response stability analysis because I feel that an introduction to classical con-
trol theory and design is incomplete without that subject, even though it was not included
in AOE 3034.

         The general minimum prerequisite for studying this book is the intellectual matur-
ity of a junior-level (third-year) college student in an accredited four-year engineering
curriculum. More specifically, a reader of this book should already have passed standard
first courses in engineering dynamics and ODEs. It will be helpful if, but probably is not

1 MATLAB ® is a registered trademark of The MathWorks, Inc. MATLAB is widely available to engi-
neers in practice and to engineering colleges. Furthermore, MATLAB-like software that uses command-
line language similar to MATLAB's, and functions similarly to MATLAB in many respects, is available
for download from the Internet, for example, GNU Octave (http://www.gnu.org/software/octave/).

                                                 AP-2
                                                      Author's Preface

mandatory that, the reader has studied basic electrical circuits, perhaps in an introductory
college physics course. It is necessary that the reader has studied basic computer pro-
gramming. MATLAB computer programs and commands appear throughout this book,
so the reader should be able to understand MATLAB commands. However, MATLAB
commands are generally clearly expressed in standard English and standard arithmetic
notation, so a person who has done any computer programming, even if that was not with
MATLAB, probably can follow the computer commands and command sequences in this
book. Familiarity with matrix notation and matrix arithmetic operations also will be
helpful, especially for Chapters 11 and 12. My students who took at the same time AOE
3034 and a mathematics course on operational methods (primarily Laplace transforms)
often found that the combination of those courses was unusually complementary and
beneficial to their comprehension of the material.

         A mathematical second-order system is represented in this book primarily by a
single second-order ODE, not in the state-space form by a pair of coupled first-order
ODEs. Similarly, a two-degrees-of-freedom (fourth-order) system is represented in
Chapters 11 and 12 by a pair of coupled second-order ODEs, not in the state-space form
by four coupled first-order ODEs. A reader who can understand the mathematics and
dynamics of relatively simple systems expressed here in classical second-order form
probably will have little trouble making the transition in more advanced literature to the
general state-space representation of higher order systems.

         This book deals mostly with specific idealized models of basic physical systems,
such as mass-damper-spring mechanisms and single-loop electrical circuits. The empha-
ses are on fundamental ODEs and fundamental system response characteristics. I have
chosen, therefore, not to burden the reader with bond graph modeling, the general and
powerful, but complicated, modern tool for analysis of dynamic systems. However, the
material in this book is an appropriate preparation for the bond graph approach presented
in, for example, System Dynamics: Modeling, Simulation, and Control of Mechatronic
Systems, 5th edition, by Dean C. Karnopp, Donald L. Margolis, and Ronald C. Rosenberg,
published by John Wiley & Sons, 2012.

         I intended originally that Chapters 1-16 of the course notes (before they grew into
a book) could be covered in a normally-paced course of three fifty-minute lessons per
week in a standard college semester of fourteen weeks duration. Even so, instructors of
AOE 3034, including myself, had difficulty squeezing all of that content into forty-two
lessons. Furthermore, in the process of converting the course notes into a complete text-
book, I added material that is relevant and interesting (to me, at least) in many complete
"new" sections to the ends of Chapters 12, 7, 8, 10, 14, and 16. And, as mentioned
above, I also added a complete "new" Chapter 17. Consequently, I doubt that even the

2 I added Section 1-10, which deals with mass-spring systems, after working with several graduate students
whose research subjects were design, analysis, and testing of aerodynamic sensors that include mechanical
components. These graduate students had not recently reviewed elementary system dynamics, and so were
unfamiliar with fundamental concepts such as natural frequency and resonance. I decided, therefore, to
make Chapter 1 a succinct summary of basic mechanical-system dynamics (excluding feedback control),
suitable for quick review by graduate students or any engineers who specialize in other areas but need to
understand at least the most basic of this book's lessons.

                                                 AP-3
                                                      Author's Preface

most demanding course instructor can, while still treating the students fairly, cover this
entire book in a three-credit, one-semester course. Therefore, instructors who wish to use
this as a one-semester course textbook should decide in advance which parts of the book
are essential to the course and which parts they cannot cover in the time allotted for the
course. If, for example, it is essential to cover all of Chapters 13-17 on classical control,
an instructor might elect to skip some or all of the "new" sections in Chapters 1, 7, 8, and
10, and to skip Chapters 11 and 12 on systems with two degrees of freedom, but to cover
most everything else in the book. Sections 6-4, 6-5, and 8-11 deal primarily with compu-
tational methods for calculating approximate time-response solutions of first- and second-
order ODEs; the contents of these sections are nicely compatible with the chapters in
which they reside; but they are not essential to the reader's understanding of system dy-
namics, so they can be omitted from course coverage without great loss. On the other
hand, I discourage the omission of Chapter 5 on basic electrical systems, not only be-
cause I believe the material is important to most engineers, but also because such systems
provide many examples and homework problems later in the book.

         The homework problems at the ends of chapters are very important to the learning
objectives of this book. I wrote each problem statement while at the same time preparing
the solution, in order to help make the statements as clear, correct, and unambiguous as
possible. In many cases, I stated a result, such as a Laplace transform, in a chapter's text
but left as a homework problem the proof or other development of that result. When
teaching a lesson from the course notes that grew into this book, I would often not lecture
on the material of the reading that I had assigned for the lesson. Instead, I would assume
that the students had, in fact, completed and understood the assigned reading, summarize
the main results of that reading and ask if there were questions about it, then, after re-
sponding to any questions, spend most remaining lesson time discussing some of the re-
lated homework problems.

         A major focus of this book is computer calculation of system characteristics and
responses and display of the results graphically, with use of MATLAB commands and
programs. However, the book employs, for the most part, basic MATLAB commands
and operations (aside from array operations), such as those on hand calculators; there is
very little use of advanced MATLAB operations and functions, because these can pro-
duce results without the user having to understand the processes of production. For this
introductory material, I think it is important that the computer and software function as a
"super calculator", which relieves the user of the drudgery of calculations, especially
complex and/or repetitive calculations, but still requires the user to understand the pro-
cess well enough to be able to design and program the calculations and graphical dis-
plays.

         Since 1967 with the publication of Dynamics of Physical Systems by Robert H.
Cannon, Jr., most textbooks on introductory system dynamics have included very few, if
any, applications specifically relevant to aerospace engineering. Therefore, I have tried
to include in this book at least some relevant examples and homework problems. These
include rolling dynamics of flight vehicles in Chapter 3, spacecraft actuators in Chapters
3, 10, and 12, aerospace motion sensors in Chapters 9 and 10, aeroelasticity in Chapters

                                                 AP-4
                                                      Author's Preface

11 and 12, attitude control of spacecraft and aircraft in Chapters 14-16, and an analysis of
aeroelastic flutter in the final homework problem of Chapter 16.

         I favor illustrating and validating theory, whenever possible, with measured data.
I also favor using measured data to identify system dynamic characteristics based on
mathematical models (e.g., time constants and natural frequencies), and system basic
properties (e.g., mass, stiffness, and damping). Accordingly, I included quite a lot of ma-
terial in this book about identification of first- and second-order systems, especially in
Chapters 9 and 10. Photographs of instructional laboratory structures and motion data
measured from those structures are included, for examples, in Section 7-6 on distributed-
parameter structures, and in homework Problems 7.10 and 12.5. Other applications of
real and simulated experimental data appear in several homework problems.

         I welcome feedback about this book from anyone who reads it. Please send your
comments to my VPI & SU email address, whallaue@vt.edu. I will be grateful to learn
of any errors that readers detect and report to me. I retain all of the source word-
processor files, so I am able to correct errors and replace any defective file with the cor-
rected version. I regard the basic organization of the book as fixed, so that, except to cor-
rect major, serious errors, I will not revise the chapters and appendices so extensively as
to disrupt the original page numbering, equation numbering, Table of Contents, and In-
dex. I am ready and willing, however, to add files that supplement chapter and appendix
contents, when such additions will improve the book. In particular, I would welcome
new examples and homework problems that are clearly relevant to aerospace engineering,
while still being compatible with the introductory level of the book. If you send to me
any such educational and motivational gem and if I decide that it satisfies my criteria,
then I will be most pleased to add it as a supplementary file and to acknowledge your
contribution.

                                           Acknowledgments

         I am grateful to my colleagues who developed the course content of AOE 3034,
and/or who joined me in teaching sections of AOE 3034, and/or who used early versions
of my AOE 3034 course notes from which this book grew: Scott Bland, Eugene Cliff,
Rafael Haftka, Rakesh Kapania, Frederick Lutze, and Craig Woolsey. Professor Ka-
pania, in particular, suggested topics to include, used the early versions in his teaching,
and encouraged me to finish and publish the book.

         With this book, I have aspired to approach the high quality, if not the breadth and
depth, of Dynamics of Physical Systems (DPS), which was written by Robert H. Cannon,
Jr., published first in hardback by McGraw-Hill in 1967, and subsequently re-published
in paperback by Dover. I have been instructed, guided, and inspired by DPS, so the at-
tentive reader of this book will observe throughout more citations of DPS than of any
other reference. DPS was designed to serve many different university courses, from
sophomore level to advanced graduate level, so its length is three to four times that of this
book. I highly recommend DPS as a complement to this book and as a source of addi-
tional material both at and beyond this book's level. Professor Cannon's book is a clearly

                                                 AP-5
                                                      Author's Preface

written and beautifully illustrated textbook of basic and more advanced theory of system
dynamics and of interesting applications to many fields, classical aerospace engineering
in particular. DPS is surely one of the two or three finest textbooks I have encountered in
my entire career as student, practicing engineer, and instructor.3

         I thank The MathWorks, Inc. for developing MATLAB, and for distributing it
broadly to the engineering and educational communities, and, in particular, for making
MATLAB available to me as an essential instructional resource in AOE 3034 and other
courses, and as a tool in research as well. One of the principal differences between this
book and Dynamics of Physical Systems is the emphasis I have been enabled by modern
personal computers and MATLAB to place on computer calculation of numerical system
characteristics and response solutions, in both the instructional content and the homework
problems. Professor Cannon had no such luxuries: when Dynamics of Physical Systems
was published, the primary calculator used by engineering students was still the slide
rule, the concept of a small personal computer was just the hopeful dream of a few vi-
sionaries, and undergraduates generally had little or no access to mainframe computers
and peripheral equipment for printing and plotting. In order to calculate and graph the
system characteristics and responses that can be produced now so easily with MATLAB,
students then who did have access to mainframe computers would need to write a pro-
gram in an inflexible language such as FORTRAN or BASIC, then enter the program
onto cards with keypunch machines at a computer center, one line of program per card,
then submit the card deck of the complete program to a computer operator, then wait,
sometimes several days, for the card deck to reach the front of the queue and be run on
the mainframe computer to produce printed and/or plotted output, then find and debug
errors in the programming that prevented correct execution, then repeat the whole process
as many times as was required until the program would finally succeed and deliver the
desired results.

                                                                                William L. Hallauer, Jr.
                                                                                             June 2, 2016

                                                                                       whallaue@vt.edu

3 There is considerable irony in my admiration now for Dynamics of Physical Systems. As a college junior
at Stanford University during the Winter Quarter of 1964, I was enrolled in the course Engineering 104,
Dynamic Response. The required course reference was part of a preliminary, pre-publication version of
Dynamics of Physical Systems, which had apparently been chosen by someone other than the instructor
who was assigned to teach the course. That version was an extremely rough draft full of typographical
errors and other mistakes, with figures that seemed to have been sketched in great haste, and it was badly
reproduced. My memory is that we students and the instructor tolerated it, but only barely. The quality of
Dynamics of Physical Systems improved tremendously between that time and the formal publication in
1967.

                                                 AP-6
                         INTRODUCTION TO
     LINEAR, TIME-INVARIANT DYNAMIC SYSTEMS

              FOR STUDENTS OF ENGINEERING

                       © 2016 by William L. Hallauer, Jr.

                   TABLE OF CONTENTS

Section Title                                                            Page

Chapter Introduction; examples of 1st and 2nd order systems; example
    1 analysis and MATLAB1 graphing

1-1  Introduction                                                        1-1

1-2  Linear, time-invariant (LTI) systems and ordinary differential equations 1-1

     (ODEs)

1-3  The mass-damper system: example of 1st order, linear, time-invariant 1-3

     (LTI) system and ordinary differential equation (ODE)

1-4  A short discussion of engineering models                            1-5

1-5  The mass-damper system (continued): example of solving the 1st order, 1-6

     LTI ODE for time-history response, given a pulse excitation and an

     initial condition (IC)

1-6  The mass-damper system (continued): numerical/graphical evaluation 1-9

     of time-history response using MATLAB

1-7  Some notes regarding good engineering graphical practice, with      1-10

     reference to Figure 1-2

1-8  Plausibility checks of system response equations and calculations   1-11

1-9  The mass-damper-spring system: example of 2nd order LTI system and 1-12

     ODE

1-10 The mass-damper-spring system: example of solving a 2nd order LTI 1-13
            ODE for time response

1-11 Homework problems for Chapter 1                                     1-18

1 MATLAB ® is a registered trademark of The MathWorks, Inc.

                                                   TC-1
                        Table of Contents

Section Title                                                   Page

Chapter Complex numbers and arithmetic; Laplace transforms;
    2 partial-fraction expansion

2-1  Review of complex numbers and arithmetic                   2-1

2-2  Introduction to application of Laplace transforms          2-5

2-3  More about partial-fraction expansion                      2-11

2-4  Additional useful functions and Laplace transforms: step, sine, cosine, 2-12

     definite integral

2-5  Homework problems for Chapter 2                            2-15

Chapter Mechanical units; low-order mechanical systems; simple
    3 transient responses of 1st order systems

3-1  Common mechanical units                                    3-1

3-2  Calculation of mass from measured weight                   3-2

3-3  Reaction wheel: a rotational 1st order system              3-3

3-4  Simple transient responses of 1st order systems, 1st order time constant 3-4

     and settling time

3-5  Aileron-induced rolling of an airplane or missile          3-8

3-6  Translational spring and viscous damper (dashpot)          3-11

3-7  More examples of damped mechanical systems                 3-13

3-8  Homework problems for Chapter 3                            3-17

                              TC-2
                          Table of Contents

Section Title                                                             Page

Chapter Frequency response of 1st order systems; transfer function;
    4 general method for derivation of frequency response

4-1  Definition of frequency response                                     4-1

4-2  Response of a 1st order system to a suddenly applied cosine, cos t   4-1

4-3  Frequency response of the 1st order damper-spring system             4-4

4-4  Period, frequency, and phase of periodic signals                     4-8

4-5  Easy derivation of the complex frequency-response function for       4-10

     standard stable 1st order systems

4-6  Transfer function, general definition                                4-11

4-7  Frequency-response function from transfer function, general derivation 4-12

4-8  Homework problems for Chapter 4                                      4-15

Chapter 5 Basic electrical components and circuits

5-1  Introduction                                                         5-1

5-2  Passive components: resistor, capacitor, and inductor                5-1

5-3  Operational amplifier (op-amp) and op-amp circuits                   5-9

5-4  RC band-pass filter                                                  5-12

5-5  Homework problems for Chapter 5                                      5-13

Chapter General time response of 1st order systems by application of
    6 the convolution integral

6-1  The convolution transform and its inverse, the convolution integral  6-1

                          TC-3
                 Table of Contents

Section Title                                                                Page
                                                                             6-2
6-2  General solution of the standard stable 1st order ODE + IC by           6-3
                                                                             6-6
     application of the convolution integral                                 6-7
                                                                             6-11
6-3  Examples of 1st order system response

6-4  General solution of the standard 1st order problem: an alternate

     derivation

6-5  Numerical algorithm for the general solution of the standard 1st order

     problem

6-6  Homework problems for Chapter 6

Chapter Undamped 2nd order systems: general time response;
    7 undamped vibration

7-1  Standard form for undamped 2nd order systems; natural frequency n 7-1

7-2  General solution for output x(t) of undamped 2nd order systems          7-3

7-3  Simple IC response and step response of undamped 2nd order systems 7-4

7-4  Discussion of the physical applicability of step-response solutions     7-6

7-5  Dynamic motion of a mechanical system relative to a non-trivial static 7-7

     equilibrium position; dynamic free-body diagram

7-6  Introduction to vibrations of distributed-parameter systems             7-9

7-7  Homework problems for Chapter 7                                         7-17

Chapter Pulse inputs; Dirac delta function; impulse response; initial-
    8 value theorem; convolution sum

8-1  Flat pulse                                                              8-1

                 TC-4
                      Table of Contents

Section Title                                                                 Page
                                                                              8-2
8-2   Impulse-momentum theorem for a mass particle translating in one
                                                                              8-3
      direction                                                               8-3
                                                                              8-5
8-3   Flat impulse                                                            8-7
                                                                              8-9
8-4   Dirac delta function, ideal impulse                                     8-10
                                                                              8-12
8-5   Ideal impulse response of a standard stable 1st order system            8-14
                                                                              8-15
8-6   Derivation of the initial-value theorem
                                                                              8-28
8-7   Ideal impulse response of an undamped 2nd order system

8-8   Ideal impulse response vs. real response of systems

8-9   Unit-step-response function and unit-impulse-response function (IRF)

8-10  The convolution integral as a superposition of ideal impulse responses

8-11  Approximate numerical solutions for 1st and 2nd order LTI systems

      based on the convolution sum

8-12  Homework problems for Chapter 8

Chapter 9 Damped 2nd order systems: general time response

9-1   Homogeneous solutions for damped 2nd order systems; viscous             9-1

      damping ratio 

9-2   Standard form of ODE for damped 2nd order systems                       9-3

9-3   General solution for output x(t) of underdamped 2nd order systems       9-6

9-4   Initial-condition transient response of underdamped 2nd order systems 9-8

9-5   Calculation of viscous damping ratio  from free-vibration response 9-9

9-6   Step response of underdamped 2nd order systems                          9-12

9-7   Ideal impulse response of underdamped 2nd order systems                 9-13

                      TC-5
                              Table of Contents

Section Title                                                           Page

9-8   Step-response specifications for underdamped systems              9-14

9-9   Identification of a mass-damper-spring system from measured response 9-18

      to a short force pulse

9-10  Deriving response equations for overdamped 2nd order systems      9-20

9-11  Homework problems for Chapter 9                                   9-23

Chapter 2nd order systems: frequency response; beating response to
    10 suddenly applied sinusoidal (SAS) excitation

10-1  Frequency response of undamped 2nd order systems; resonance       10-1

10-2  Frequency response of damped 2nd order systems                    10-2

10-3  Frequency response of mass-damper-spring systems, and system      10-7

      identification by sinusoidal vibration testing

10-4  Frequency-response function of an RC band-pass filter             10-10

10-5  Common frequency-response functions for electrical and mechanical- 10-11

      structural systems

10-6  Beating response of 2nd order systems to suddenly applied sinusoidal 10-14

      excitation

10-7  Homework problems for Chapter 10                                  10-19

Chapter Mechanical systems with rigid-body plane translation and
    11 rotation

11-1  Equations of motion for a rigid body in general plane motion      11-1

11-2  Equation of motion for a rigid body in pure plane rotation        11-3

11-3  Examples of equations of motion for rigid bodies in plane motion  11-5

                              TC-6
                            Table of Contents

Section Title                                                         Page
                                                                     11-13
11-4  Homework problems for Chapter 11

Chapter Vibration modes of undamped mechanical systems with two
   12 degrees of freedom

12-1 Introduction: undamped mass-spring system                       12-1

12-2 Undamped two-mass-two-spring system                             12-2

12-3 Vibration modes of an undamped 2-DOF typical-section model of a 12-9
            wing

12-4 Homework problems for Chapter 12                                12-13

Chapter Laplace block diagrams, and additional background material
   13 for the study of feedback-control systems

13-1  Laplace block diagrams for an RC band-pass filter              13-1

13-2  Laplace block diagram with feedback branches for an m-c-k system 13-2

      with base excitation

13-3  Forced response of an m-c-k system with base excitation        13-4

13-4  Homework problems for Chapter 13                               13-7

Chapter Introduction to feedback control: output operations for
   14 control of rotational position

14-1  Initial definitions and terminology                            14-1

14-2  More definitions, and examples of open-loop control systems    14-2

14-3  Closed-loop control of rotor position using position feedback  14-6

                            TC-7
                Table of Contents

Section Title                                                              Page

14-4  Transfer function of a single closed loop                            14-9

14-5  Closed-loop control of rotor position using position feedback plus rate 14-11

      feedback

14-6  Comments regarding classical control theory and modern control theory 14-17

14-7  Homework problems for Chapter 14                                     14-18

Chapter Input-error operations: proportional, integral, and derivative
   15 types of control

15-1 Initial definitions; proportional-integral-derivative (PID) control   15-1

15-2 Examples of proportional (P) and proportional-integral (PI) control 15-2

15-3 Derivation of the final-value theorem                                 15-12

15-4 Example of proportional-derivative (PD) control                       15-13

15-5 Homework problems for Chapter 15                                      15-16

Chapter Introduction to system stability: time-response criteria
   16

16-1 General time-response stability criterion for linear, time-invariant  16-1

      systems

16-2 Stable and unstable PD-controlled-rotor systems                       16-6

16-3 Routh's stability criteria                                            16-12
16-4 Loci of roots for 2nd order systems                                   16-18
16-5 Loci of roots for 3rd order systems                                   16-22

16-6 Open-loop transfer functions and loci of roots                        16-31

                TC-8
                                                     Table of Contents  Page
                                                                        16-34
Section Title
16-7 Homework problems for Chapter 16

Chapter Introduction to system stability: frequency-response criteria
   17

17-1 Gain margins, phase margins, and Bode diagrams                     17-1

17-2 Nyquist plots                                                      17-9

17-3 The practical effects of an open-loop transfer-function pole at s = 0 + 17-12
            j0

17-4 The Nyquist stability criterion                                    17-15

17-5 Homework problems for Chapter 17                                   17-23

References                                                              Refs-1

Appendix A: Table and derivations of Laplace transform pairs

A-1  Table of Laplace transform pairs used in this book                 A-1

A-2  Laplace transform of a ratio of two polynomials, with only simple  A-4

     poles

A-3  Derivation of the Laplace transform of a definite integral         A-5

A-4  Applications of the Laplace transform of a definite integral       A-6

A-5  Derivation of the Laplace transform of the convolution integral    A-7

                    TC-9
                 Table of Contents

Section Title                                                          Page

Appendix B: Notes on work, energy, and power in mechanical
systems and electrical circuits

B-1  Definitions of work and power                                     B-1

B-2  Mechanical work, energy, and power (complementary to Chapter 3)   B-2

B-3  Work, energy, and power in electrical circuits (complementary to  B-4

     Chapter 5)

B-4  Analogies between an m-c-k mechanical system and an LRC electrical B-8

     circuit

B-5  Hysteresis and dissipation of mechanical energy by damping        B-9

Index for all Chapters and Appendices                                  Index-1

                 TC1- 0
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

  Chapter 1 Introduction; examples of 1st and 2nd order systems, time-
               response analysis and graphing with MATLAB1

                                 © 2016 by William L. Hallauer, Jr.

1-1 Introduction

         The subject of this book is the dynamic behavior of physical systems, with some
emphasis on simple mechanical and electrical systems representative of or analogous to
those often encountered in aerospace and mechanical engineering. A system, as defined
in this book, is a combination of two or more simple physical elements or components,
these being connected together in such a way that they all influence the dynamic behavior
of the entire system. An element or component, as defined in this book, is usually a
discrete object, such as a mechanical spring or an electrical resistor. This object usually
produces a discrete effect, such as a motion-induced force or a voltage drop. Dynamic
behavior is the variation in time of some physical response quantity of the system, for
example, the position of a mass, or the voltage at some location in an electrical circuit.

         The general subject of this book is relevant to courses that are offered in most
engineering colleges for students who major in aerospace engineering, mechanical
engineering, engineering mechanics, ocean engineering or naval architecture, electrical
engineering, and chemical engineering. Many of the specific topics addressed within
chapters and in homework problems following chapters are relevant especially to the
study and practice of aerospace engineering.

1-2 Linear, time-invariant (LTI) systems and ordinary differential equations
(ODEs)

         We consider physical systems that can be modeled with reasonable engineering
fidelity as linear, time-invariant (LTI) systems. Such a system is represented mathe-
matically by an ordinary differential equation (ODE), or by a set of coupled ODEs, for
which the single independent variable is time, denoted as t. These ODEs are linear, and
they have constant coefficients, so we describe them as linear, time-invariant (LTI), the
same as the systems they represent.2 For example, suppose we denote a dependent vari-
able as x(t), here a general symbol representing some physical dynamic response quantity
for which we want to solve. Then an LTI ODE that models an LTI physical system
might have the form

                                            dx - a x = b u(t) (1-1)
                                            dt

1 MATLAB ® is a registered trademark of The MathWorks, Inc.
2 LTI ODEs are also sometimes described as linear, constant-coefficient, or LCC.

                                                    1-1
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

in which a and b are constant multiplying coefficients, and known function u(t) is the ex-
citation and is independent of the response.3 In the study of systems, an independent

excitation u(t) is often called an input, and a dependent response x(t) is often called an

output.

Hereafter, we will usually employ the common shorthand dot notation for denot-

                                        dx  d2x
ing derivatives with respect to time:  x& , 2  &x&, etc., so that Eq. (1-1) can be writ-
                                        dt       dt

ten more simply as x& - a x = b u(t) .

         The linearity of Eq. (1-1) is manifested by the linear appearance of x(t) and all of
its derivatives in the ODE. The following are some similar ODEs that are not linear (they
are nonlinear) for obvious reasons: x& - a x2 = b u(t) ; sin(x&) - a x = b u(t) ; x& - a tan(x)
= b u(t) . Linear ODEs are almost always easier to solve (at least in closed form, i.e., as

equations involving standard functions) than nonlinear ODEs. Moreover, the important
principle of superposition applies to linear ODEs, but not to nonlinear ODEs. An exam-
ple of the application of this principle is: let the response to input u1(t) be x1(t) , and let
the response to another input u2 (t) be x2 (t) ; if a third input is the sum of multiplied
terms u3 (t) = c1u1 (t) + c2 u2 (t) , in which c1 and c2 are constants, then the response to
u3 (t) is x3 (t) = c1 x1 (t) + c2 x2 (t) . This result is easy to derive just by multiplying two
ODEs such as (1-1) by the constants, then adding the multiplied ODEs. The principle of
superposition allows us to solve accurately for the responses of linear systems to any
physically realistic inputs. (See Section 8-10 for a derivation of system response to an
arbitrary physically realistic input by direct application of superposition.)

         The time invariance of Eq. (1-1) is manifested by the constant coefficients of x(t)
and all of its derivatives in the ODE. ODEs with time-invariant coefficients model the
behavior of systems assumed to have physical properties that either remain constant in
time or vary so slowly and/or slightly that the variation is negligible for engineering pur-
poses. But many practically important systems have time-varying physical properties.
For example, a vehicle such as a space shuttle between liftoff and achievement of orbital
position has rapidly varying (decreasing) mass as propellant is burned and external fuel
tanks and boosters are released. The following is a linear equation somewhat similar to
Eq.(1-1), but with an obviously time-varying coefficient: x& - 3(1 - e-2t ) x = b u(t) . The
study of systems with time-varying physical properties is generally more complicated,
not fundamental, so only time-invariant systems and ODEs are considered in this book.

         The form of Eq. (1-1), x& - a x = b u(t) , is widely regarded as the standard form
for a 1st order LTI ODE, and we will use it as such in this book. Beginning in the next
section, we will study idealized physical systems whose dynamic behaviors are described
by equations that are directly analogous to Eq. (1-1). We will express the mathematical

3 Some synonyms for excitation in this book are stimulus, stimulation, and forcing function for systems in
general, and command and disturbance specifically for controlled systems.

                                            1-2
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

constants a and b in terms of specific physical constants. Also, the roles of input u(t) and
output x(t) in Eq. (1-1) will be assumed by some specific physical quantities, such as
force, velocity, voltage, etc., and we will denote them with relevant symbols [often dif-
ferent than u(t) and x(t)] when appropriate.

         Although only 1st order ODEs are discussed in this section, we certainly will en-
counter and study systems and ODEs of 2nd and higher orders.

1-3 The mass-damper system: example of 1st order LTI system and ODE

         Consider a rigid body of mass m that is constrained to sliding translation x(t) in
only one direction, Fig. 1-1. The mass is subjected to an externally applied, arbitrary

Idealized physical model                        Free-body diagram (FBD)
                                                                           x(t)
         x(t)
                                                 fx(t) m
fx(t) m  Liquid layer with viscous
         damping constant c

                 Figure 1-1 1st cv(t) order mass-damper mechanical system

force fx(t), and it can slide on a thin, viscous liquid layer such as water or oil. The vis-
cous force acting on the mass due to sliding on the liquid layer is opposite to the direction
of velocity, v(t)  x&(t) , and we assume that the magnitude of viscous force is propor-
tional to velocity with constant of proportionality c, called the viscous damping constant.
Mass m and viscous damping constant c are positive physical quantities. All of the forces
acting on the mass are as shown on the free-body diagram (FBD) of Fig. 1-1.

         Next, we use (from your engineering dynamics course) the FBD of Fig. 1-1 and
Newton's 2nd law of motion (after English physicist and mathematician Isaac Newton,

1642-1727) for translation in a single direction, to write the equation of motion for the

mass:

 (Forces)x = mass × (acceleration)x, where (acceleration)x = dv = v& ;
                                                                          dt

                                f x (t) - c v = m v& .

As is customary in writing ODEs, we collect all terms involving the dependent variable
and its derivatives on the left-hand side, and put all independent input functions on the
right-hand side:

                          m v& + c v = f x (t)                                   (1-2)

                          1-3
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

         ODE (1-2) is clearly linear in the single dependent variable, velocity v(t), and
time-invariant, assuming that m and c are constants. The highest derivative of v(t) in the
ODE is the first derivative, so this is called a 1st order ODE, and the mass-damper system
is called a 1st order system. If fx(t) is defined explicitly, and if we also know some initial
condition (IC) of the velocity, v0  v(t0 ) at time t = t0 , then we can, at least in principle,
solve ODE (1-2) for velocity v(t) at all times t > t0 . (In this book, we will usually define

the initial time as t0 = 0 second.)

         Equation (1-2) expressed in the form of the standard 1st order LTI ODE (1-1) be-
comes v& - a v = b f x (t) , where a = - c m and b = 1 m . Since m and c are positive physi-
cal constants, a is clearly negative. This negative polarity is characteristic of most physi-
cal systems that we will study; we shall see that it has an important influence on the gen-
eral nature of the transient response of systems.

         Note that after solving for velocity v(t), we can solve by direct integration another
ODE for position x(t), provided that we know the initial position x0  x(t0 ) at time t =

t0 . One systematic method for finding x(t) is based upon the derivative definition:

        ODE: x&(t)  dx(t) = v(t)
                          dt

The following shows careful definite integration of both sides of the ODE, using  as the
"dummy" variable of integration to distinguish it from the upper limit, time t:

 =t dx( )  =t  =t
        d =  v( ) d  x(t) - x(t0 ) =  v( ) d
 =t0 d   =t0                                    =t0

                                           =t        (1-3)

         x(t) = x0 +  v( ) d
                                          =t0

Another popular method of solution is to find the antiderivative (indefinite integral) of
the ODE and add a constant of integration C, which then must be determined in terms of
the initial condition:

x(t) =  v(t) dt + C  x(t0 ) = [  v(t) dt]t=t0 + C  C = x0 - [  v(t) dt]t=t0

   x(t) = x0 +  v(t) dt - [  v(t) dt]t=t0            (1-4)

              1-4
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

1-4 A short discussion of engineering models

         The mass-damper of Fig. 1-1 can be used to represent approximately (i.e., to
model) some actual physical systems. One such system is a surface ship moving over the
water under its own propulsion or being pushed/pulled by a tugboat. Another is an auto-
mobile hydroplaning on a wet road. You can probably think of other similar real sys-
tems. However, it is important for us, as engineers, to recognize that the mass-damper
system is not the actual system, but only an approximate idealized physical model of the
actual system. We are able to derive from this idealized physical model the solvable
mathematical model, which consists of ODE (1-2) and known values for fx(t) and v0 .
The actual physical system, on the other hand, might be so complicated that it cannot be
characterized mathematically with absolute precision. For example, the ideal viscous
damping model used in the derivation of ODE (1-2) is almost certainly not an exact rep-
resentation of the liquid drag forces acting on either a surface ship or a hydroplaning car.

         The same general observation applies for almost any idealized physical model and
associated mathematical model developed for engineering purposes: the physical model
is, at best, a reasonably accurate approximation of the actual physical system. The fidel-
ity of a model usually depends on a number of factors, including system complexity, un-
certainties, the costs of modeling and mathematical/computational solutions, time con-
straints, modeling skills of the engineer, etc.

         But a reasonably accurate approximate model often suffices for engineering pur-
poses. Engineering systems are usually designed conservatively, with redundancies and
factors of safety to compensate for severe overloads, unexpected material flaws, operator
error, and the many other unpredictable influences that can arise in the functioning of a
system. As engineers, we almost never require 100% accuracy; we are usually satisfied if
our mathematical/computational predictions of system behavior are qualitatively correct
and are quantitatively within around ±10% (in a general sense) of the actual behavior.

         The main point of this discussion is to emphasize that any idealized physical
model used for engineering analysis and design is only an approximation of an actual
physical system. Moreover, the primary subjects of this book are the fundamental dyna-
mic characteristics of idealized physical models, because a great deal of practical experi-
ence has shown that these are also the characteristics of many real engineering systems.
Therefore, this book does not consider in depth the development of idealized physical
models to represent actual systems; rather, we shall focus on deriving mathematical
models (mostly ODEs) that describe idealized physical models, and on solving the
mathematical equations and exploring the characteristics of the solutions.

         The process of developing idealized physical models to represent real systems in-
volves both science (theory and experimental data) and "art" (experience and intuition);
you probably will encounter this process in laboratory and design courses, and later in
your professional practice of engineering.

                                                    1-5
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

1-5 The mass-damper system (continued): example of solving the 1st order LTI
ODE for time response, given a pulse excitation and an IC

         An input of limited duration, typically called a pulse, is a very common type of
excitation imposed onto systems. For example, when a hammer strikes a nail, the force
imposed on the nail by the hammer is a pulse. A real pulse such as hammer impact force
is often modeled as a half-sine pulse. Let the force acting on the mass in Fig. 1-1 be the
half-sine pulse described by the following figure and Eq. (1-5):

fx(t)                   t                                                    (1-5)
  F                  F sin , 0  t  td
       td  t            td 
  0 0         fx (t) = 
                      0, td < t
                      
                      

In Eq. (1-5) for fx(t), td denotes the pulse duration. The notation will be more manage-
able in this problem if we express the time-varying sinusoid in the form sin t , where 
denotes the circular frequency of oscillation, in radians per second. In this case, clearly
the circular frequency is expressed in terms of the pulse duration as  =  td . Let's
specify that the initial velocity of the mass at time t = 0 is some known value v0 . The
mathematical statement of the problem for finding the velocity time-history is:

              ODE: m v& + c v = f x (t)                               (1-2, repeated)

              IC: v(0) = v0

              Find: v(t) for all t > 0.

         To solve this problem in closed form, we will use a method with which you
should be familiar from your previous study of ODEs. First, we find the homogeneous
(also called complementary) solution vh (t) , which is the solution of the homogeneous
ODE, the version of Eq. (1-2) with zero right-hand side:

              m v&h + c vh = 0                                               (1-6)

A homogeneous LTI ODE always has solutions in time-linear powers of e = 2.71828...
(the base of natural logarithms), with some initially unknown constant coefficients:

       vh (t) = C et , in which constants C and  are unknown at this stage.

To find , we substitute the solution into the homogeneous ODE (1-6):

              1-6
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

mC e t + c C e t = (m + c) C e t = 0

If C et = 0, we get the useless trivial solution vh (t) = 0, so a useful solution requires that
m + c = 0, which is known as the characteristic equation of the ODE. Solution of this
equation gives the so-called characteristic value,  = - c m , leading to:

vh (t) = C e - (c m)t                   (1-7)

         Note that we still have not solved for constant C. We can find C only after we
have determined a particular solution, also known as the non-homogeneous solution be-
cause it is a solution that satisfies the complete ODE (1-2) for the given right-hand side
fx(t). For this problem, we will need two particular solutions, because fx(t) is defined dif-
ferently over two different intervals of time, Eq. (1-5). First, we find a particular solution
v p (t) valid over the pulse duration, 0  t  td , for which the ODE is:

m v&p + c v p = F sin t , where  =  td  (1-8)

To find a particular v p (t) that satisfies ODE (1-8), we apply the method of undetermined
coefficients, which entails making an educated guess of the functional character of the
solution, using multiplicative coefficients that will be determined by substituting the can-
didate solution back into ODE (1-8). The right-hand-side sine function of ODE (1-8) has
a finite set of derivatives: the derivative of a sine is a cosine, the derivative of a cosine is
a sine, etc. Therefore, we assume a form of solution consisting of a linear sum of the
function and all of its derivatives:

   v p (t) = P1 sin t + P2 cost , with coefficients P1 and P2 undetermined at this stage.

Substitute this candidate solution back into ODE (1-8):

             m(P1 cost - P2 sin t) + c(P1 sin t + P2 cost) = F sin t

Collect terms that multiply sin t and cost on both sides of the equation:

         (- m P2 + c P1 )sin t + (m P1 + c P2 )cost = (F ) sin t + (0) cost

Functions sin t and cost are linearly independent of each other, which requires that
the left-hand-side and right-hand-side terms multiplying sin t must equal each other,
and the same for the terms multiplying cost , leading to two algebraic equations for the
coefficients P1 and P2 :

c P1 - m P2 = F and m P1 + c P2 = 0

1-7
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

The second equation gives P2 = -(m c)P1 , and substituting this into the first equation to
eliminate P2 leads to:

P1 = 2 2 c F and P2 = - m P1                                                       (1-9)
(m) + c                          c

Rather than write out messy algebraic formulas for all the coefficients in this problem, it
is convenient to express all others in terms of P1 , as is P2 in Eq. (1-9).

         To obtain the complete solution for the pulse duration, 0  t  td , we now com-
bine the homogeneous and particular solutions:

             v(t) = vh (t) + v p (t) = C e- (c m)t + P1 sin t + P2 cost , for 0  t  td (1-10)

Coefficient C in Eq. (1-10) is still not known; but now, finally, we can apply the initial
condition (IC) to determine C:

           v(0) = v0 = C (1) + P1 (0) + P2 (1)  C = v0 - P2 = v0 + (m c)P1 (1-11)

         Equations (1-9) through (1-11) describe the velocity response during the pulse
duration, 0  t  td , so we still need to find the post-pulse response, for td < t. To do so,
we should recognize two facts: (1) fx(t) = 0 for td < t; and (2) velocity v(t) cannot sud-
denly change at t = td (because acceleration cannot be infinite), rather, velocity must
equal Eq. (1-10) evaluated at t = td . Fact 1 means that the ODE for td < t is homogene-
ous; hence, the particular solution is zero, and we have only a homogeneous solution, but
now with a different coefficient, D, than before:

v(t) = D e- (c m)t , for td < t                                                    (1-12)

To find D, we use Fact 2, which essentially is the IC for td < t, and Eq. (1-10):

D e- (c m)td = v(td ) = C e- (c m)td + P1 sin td + P2 costd                        (1-13)

 D = v(td ) e(c m)td

                             - c (t-td )                                           (1-14)

 v(t) = v(td ) e m , for td < t

Equation (1-14), with Eq. (1-13) for v( td ), combined with Eq. (1-9) and Eq. (1-11) for
coefficients P1 , P2 and C, represents the response for td < t. Because mass m and vis-

         1-8
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

cous damping constant c are positive physical quantities, Eq. (1-14) is a pure exponential
decay, which approaches zero as t  .

1-6 The mass-damper system (continued): numerical/graphical evaluation of time
response using MATLAB

         For the mass-damper response solution developed in the previous section, con-
sider the following numerical case, with all quantities expressed in SI units: m = 5 kg, c
= 2 N-sec/m, F = 18 N, td = 7.5 sec, v0 = 3.3 m/sec. A MATLAB script M-file, named
MATLABdemo11.m, to calculate and graph the response from 0 to 25 seconds is given
below. The MATLAB commands are supplemented with explanatory comments, so you
should be able to follow and understand the M-file without much difficulty. Writing
comments in this manner is good practice for your own programs; comments added while
you are writing a computer program are especially helpful if you need to revise or refer
back to the program long after you have forgotten the details.

MATLAB script:

%MATLABdemo11.m
%Mass-damper system response to IC + half-sine pulse forcing
m=5;c=2; %system mass & viscous damping coefficient, SI units
F=18;td=7.5; %half-sine pulse, amplitude (N), pulse duration (sec)
vo=3.3; %initial velocity (m/sec)
w=pi/td; %circular frequency of half-sine pulse (rad/sec)
t1=0:0.05:td; %time instants for forced response
f1=F*sin(w*t1); %force pulse
P1=c*F/((w*m)^2+c^2);P2=P1*(-w*m/c);C=vo-P2; %constants
v1=C*exp(-c/m*t1)+P1*sin(w*t1)+P2*cos(w*t1);%time series of forced velocity
nt1end=length(t1);v2o=v1(nt1end);%initial velocity for post-pulse response
t2=td:0.1:25; %time instants for post-pulse unforced response
v2=v2o*exp(-c/m*(t2-td));%time series of post-pulse unforced velocity
f2=zeros(1,length(t2)); %null force after pulse
plot(t1,f1/10,'k',t1,v1,'k',t2,f2,'k',t2,v2,'k'),grid,xlabel('Time t (sec)')
ylabel('Force f_x(t) (daN), and Velocity v(t) (m/sec)')
title('Response of mass-damper system to IC + half-sine pulse forcing')

To execute in MATLAB an M-file that is stored on a folder (directory) of your com-
puter's hard disk, you must have added that folder to the so-called MATLABpath. In
Versions 6 and higher of MATLAB, you can add the folder to the MATLABpath by
specifying the folder as the "Current Directory" in the formatting toolbar above the
MATLAB command window. The command line below executes the script M-file.

MATLAB command:

>> MATLABdemo11

The resulting MATLAB (Versions 6 and higher) graph, Fig. 1-2, is on the next page. The
graph was edited in the MATLAB figure window, mainly to reduce the size and to add
curve labels and arrows.

                                                    1-9
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

         Note that the unit of force "daN" on Fig. 1-2 is a deka-newton, which means 10
newtons. All of the mechanical units used in this book are described in Chapter 3.

              Figure 1-2 Excitation and response of a mass-damper system

1-7 Some notes regarding good engineering graphical practice, with reference to
Figure 1-2
* Always label both axes, and always include the units of physical quantities.
* Always write an explanatory one-line title. Such a short title cannot explain everything
about the graph, but any title you use will almost certainly help the reader to understand
the graph.
* It is usually good practice to add grids to a graph. Grids help the reader to perceive
values correctly. For example, the grids on Fig. 1-2 show clearly that the peak velocity
response is just above 7 m/sec at a little after 5 sec.
* The commands in the script file that specify the densities of computed points are, first,
t1=0:0.05:td while the pulse acts and, second, t2=td:0.1:25 following the pulse. For
example, the first line directs MATLAB to compute the response at 0.05-sec intervals;
then plot(...,t1,v1,'k',...) directs MATLAB to plot small points for those instants, and
to connect each two adjacent points with a straight line. If you use high point densities,
then the overall plotted line will capture all important features of the response (extreme
values, for example), and will appear to be a smooth curve. Indeed, the overall line
should look like a smooth curve, because it represents a continuous physical response;
neither the response itself nor its low-order derivatives should be discontinuous. On the
other hand, if you use low point densities, then you might miss important features of the
response, and the overall line will be unnaturally piecewise linear, with kinks (slope dis-

                                                   1-10
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

continuities). To visualize an extreme example of low point density, suppose that for the
mass-damper system you were to compute and plot the velocity response at 4-sec inter-
vals; the velocity graph in Fig. 1-2 would consist only of straight lines connecting the
computed points at 0, 4, 8, 12, 16, and 20 seconds, which would badly represent the ac-
tual response. So always specify high point density on graphs of continuous physical re-
sponse. You might not know initially what point density you should use, especially if
you are analyzing an unfamiliar system. But try some plausible point density. If your
plotted response curve appears unnaturally kinky, then increase the point density appro-
priately and run the M-file again. It will cost you nothing more than the little time re-
quired to edit and re-run the M-file (or any other graphing computer program).

1-8 Plausibility checks of system response equations and calculations

         We all make mistakes in the process of analyzing engineering problems. Most
common are mistakes in arithmetic, algebra, calculus, theory, and calculation algorithms
(usually computer programming). Also, sometimes we simply use incorrect data. It
seems that there are countless ways to make mistakes. Therefore, it is important always
to check your mathematical, numerical, and computational operations and results in every
way possible. An important type of check for any problem with physical results is the
plausibility check, known more colloquially as reality check and sanity test. Essentially
you examine the results to determine if they are physically plausible (believable, credible,
reasonable). Do the results make sense physically? A classic example of implausible
result that often appears on exam papers in structures courses is the structural deforma-
tion on the order of 103 or 106 inches, when it ought to be on the order of 10-3 inches.

         To illustrate a plausibility check, let's examine Fig. 1-2 for the velocity response
of the mass-damper system to an initial condition and half-sine pulse excitation. First,
the specified initial velocity is v0 = 3.3 m/sec, and the response curve at time t = 0 cor-
rectly reflects that initial condition. Next, for about the first half-second of response, the
velocity decreases due to viscous drag force cv. But then, as the applied force fx(t) in-
creases, the velocity dips to a local minimum and subsequently increases. Applied force
fx(t) peaks at t = 12 td = 3.75 sec, and the graph shows that the slope of the velocity curve,
acceleration v& , is maximum at about the same time. The velocity itself peaks at a bit past
5 sec. Because velocity is the integral of acceleration (area under the acceleration curve),
this lag of the velocity peak behind the force pulse peak is quite plausible. After the ve-
locity peaks, it decreases monotonically toward zero as the applied force decreases to
zero at t = td = 7.50 sec and remains at zero thereafter. So the entire response, as de-
picted graphically, is physically plausible.

         Plausibility of a calculated response does not guarantee that it is correct, although
it is reassuring. On the other hand, implausibility of a calculated response almost cer-
tainly guarantees that it is wrong. The primary justification for conducting a plausibility
check is to catch incorrect engineering predictions before they cause trouble (which can
vary from point loss on homework or exams, to a major disaster, the unpredicted failure
of an engineering system).

                                                   1-11
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

1-9 The mass-damper-spring system: example of 2nd order LTI system and ODE

         Consider a rigid body of mass m that is constrained to sliding translation x(t) in
only one direction, Fig. 1-3. The mass is subjected to an externally applied, arbitrary

Idealized physical model                         Free-body diagram (FBD)
                                                                           x(t)
Linear spring,

constant k      x(t)

            m fx(t)                              kx(t) m fx(t)

                          Liquid layer, viscous

                          damping constant c cv(t)

Figure 1-3 2nd order mass-damper-spring mechanical system

force fx(t), and it slides on a thin, viscous, liquid layer that has linear viscous damping
constant c. Additionally, the mass is restrained by a linear spring. The force exerted by
the spring on the mass is proportional to translation x(t) relative to the undeformed state
of the spring, the constant of proportionality being k. Parameters m, c, and k are positive
physical quantities. All of the horizontal forces acting on the mass are shown on the FBD
of Fig. 1-3.

         From the FBD of Fig. 1-3 and Newton's 2nd law for translation in a single direc-
tion, we write the equation of motion for the mass:

 (Forces)x = mass × (acceleration)x, where (acceleration)x = v& = &x&;
                             f x (t) - cv - kx = mv& .

Re-arrange this equation, and add the relationship between x(t) and v(t), x& = v :  (1-15a)
                                         m v& + c v + k x = f x (t)

                          x& - v = 0                                                (1-15b)

Equations (1-15a) and (1-15b) are a pair of 1st order ODEs in the dependent variables v(t)

and x(t). The two ODEs are said to be coupled, because each equation contains both de-

pendent variables and neither equation can be solved independently of the other. Such a
pair of coupled 1st order ODEs is called a 2nd order set of ODEs.

         Solving 1st order ODE (1-2) in the single dependent variable v(t) for all times t >
t0 requires knowledge of a single IC, which we previously expressed as v0 = v(t0 ) . Simi-
larly, solving the coupled pair of 1st order ODEs, Eqs. (1-15a) and (1-15b), in dependent
variables v(t) and x(t) for all times t > t0 , requires a known IC for each of the dependent

variables:

                          1-12
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

v0  v(t0 ) = x&(t0 ) and x0 = x(t0 )  (1-16)

         In this book, the mathematical problem is expressed in a form different from Eqs.

(1-15a) and (1-15b): we eliminate v from (1-15a) by substituting for it from (1-15b) with
v = x& and the associated derivative v& = &x&, which gives4

m &x& + c x& + k x = f x (t)          (1-17)

         ODE (1-17) is clearly linear in the single dependent variable, position x(t), and
time-invariant, assuming that m, c, and k are constants. The highest derivative of x(t) in
the ODE is the second derivative, so this is a 2nd order ODE, and the mass-damper-spring
mechanical system is called a 2nd order system. If fx(t) is defined explicitly, and if we also
know ICs (1-16) for both the velocity x&(t0 ) and the position x(t0 ) , then we can, at least
in principle, solve ODE (1-17) for position x(t) at all times t > t0 . We shall study the re-
sponse of 2nd order systems in considerable detail, beginning in Chapter 7, for which the
following section is a preview.

1-10 The mass-spring system: example of solving a 2nd order LTI ODE for time
response

         Suppose that we have a system of the type depicted on Fig. 1-3 for which the
damping force, cx& in Eq. (1-17), is negligibly small in comparison with inertial force
m&x& and structural force k x . Figure 1-4
is a photograph of a real system5 with so
little damping that, under some circum-
stances, we may neglect the damping
force. The mass carriage of this system
rides back and forth on low-friction lin-
ear ball bearings, which are enclosed
underneath the carriage and not visible
in the photograph. The entire length of
this system, from the left (fixed) end of Figure 1-4 Laboratory mass-spring system
the spring, to the rightmost edge of the
mass carriage is 8½ inches (21.6 cm), and each of the three light-colored metal slabs at-
tached to the carriage has mass of ½ kilogram.

         If we may neglect the damping force in a system such as that of Fig. 1-4, then the
term cx& drops out of Eq. (1-17), and we are left with the simpler 2nd order ODE,

4 An alternative derivation of ODE (1-17) is presented in Appendix B, Section B-2. The rate of change of
system energy is equated with the power supplied to the system.
5 This is part of a Model 210a Rectilinear Plant designed and fabricated by Educational Control Products of
Bell Canyon, California, USA.

                                                   1-13
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

m &x& + k x = f x (t)                                                   (1-18)

If we know ICs (1-16) and excitation force f x (t) , then we can solve Eq. (1-18) for x(t).
For future reference, note that mass quantity m and spring stiffness constant k are intrin-
sically positive values. Also, observe that f x (t) may be applied to the system of Fig. 1-4
through the link visible at the right-hand side of the mass carriage.

         It will be instructive to determine a time response for this 2nd order mass-spring
(m-k) system, by applying the standard ODE solution procedure described in Section 1-5.
We shall find the complete algebraic solution as the sum of homogeneous and particular
solutions, x(t) = xh (t) + x p (t) . Suppose that at time t = 0 the spring is undeformed and

the mass is at rest, so that ICs (1-16) are

x&(0) = 0 and x(0) = 0                                                  (1-19)

Suppose also that the excitation is a force pulse described by the equation f x (t) =
Fm (t tm )e(1-t tm ) ; by applying calculus to this function, you can easily prove that it rises
from zero at t = 0 to the maximum value Fm at time t = tm , and, thereafter, it gradually
drops back to zero (see Fig. 1-5). In dynamics, a linear function of time such as t tm is
often called a "ramp" function; since our excitation consists of a declining exponential
function multiplied by a ramp function, we call this excitation a "ramped exponential"
force pulse.

         The homogeneous ODE associated with Eq. (1-18) is m &x&h + k xh = 0 . We cast
this equation into a familiar form by dividing through by mass m and defining the posi-
tive quantity n 2 = k m , giving the ODE

&x&h + n 2 xh = 0                                                       (1-20)

The positive root n = k m is called the natural frequency of this m-k system, and n

has physical significance that will be discussed below with the final solution. You might
remember from your previous study of ODEs, or you can easily verify by substitution in-
to Eq. (1-20), that the solution can be expressed as

xh (t) = C1 sin nt + C2 cosnt                                           (1-21)

Constants C1 and C2 are unknown at this point in the solution process.

         With excitation by the ramped exponential pulse defined above, any particular so-
lution x p (t) must satisfy the non-homogeneous ODE

1-14
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

     m &x&p + k x p = Fm (t tm )e(1-t tm )                    (1-22)

To find a particular x p (t) that satisfies ODE (1-22), we apply the method of undeter-

mined coefficients, just as in Section 1-5. It is easy to show by successive differentia-
tions that all derivatives with respect to time of the function (t tm )e(1-t tm ) produce only
constant multiples of (t tm )e(1-t tm ) itself, and of e(1-t tm ) . Therefore, we seek a particular
solution that consists of a linear sum of these two functions:

x p (t) = P1 (t tm )e(1-t tm ) + P2e(1-t tm )                 (1-23)

We determine constants P1 and P2 by substituting Eq. (1-23) into Eq. (1-22), equating
the coefficients of (t tm )e(1-t tm ) and e(1-t tm ) on the two sides of the resulting algebraic

equation, and then solving for P1 and P2 [homework Problem 1.10(a)]. This process
produces the results

P1 = 2 Fm  and P2 =                           2m tm 2   P1    (1-24)

m tm + k                                      m tm + k2

The complete (but not yet final) solution is

x(t) = xh (t) + x p (t) = C1 sin nt + C2 cosnt + P1 (t tm )e(1-t tm ) + P2e(1-t tm ) (1-25)

We now can determine the remaining unknown constants by substituting Eq. (1-25) into
ICs (1-19), x&(0) = 0 and x(0) = 0 , and solving algebraically for constants C1 and C2
[homework Problem 1.10(b)]. The results are

C1 = P2 - P1 e1 , with n = k                  and C2 = -P2e1  (1-26)
ntm              m

         The complete and final solution is Eq. (1-25), with constants C1 , C2 , P1 , and P2
defined in terms of the basic parameters m, k, Fm , and tm by Eqs. (1-24) and (1-26).
Let's calculate and plot a time response for the system of Fig. 1-4. The total mass of the
carriage plus the three ½-kilogram attached metal slabs is m = 2.20 kg, and the stiffness
of the spring is k = 770 N/m. Suppose that the ramped exponential force pulse has maxi-
mum value Fm = 6 N at the instant tm = 1/12 sec. The MATLAB command lines on the
next page calculate and print out the frequency quantity fn = n 2 , and they calculate
and plot the time response over the interval 0  t  2 sec. Note that it was not necessary
to assemble these command lines into a formal M-file; rather, the lines were composed in
a text-editing program, then the entire group of lines was copied together and pasted onto
the prompt ">> " on the MATLAB command window. Also, since solution Eq. (1-25)

           1-15
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

includes the product of two functions of time in the term (t tm )e(1-t tm ) , it is necessary to
implement this product using MATLAB array multiplication (.*) in the operation
prod=tt.*efun.

>> %Mass-spring response: rest ICs; ramped exponential pulse input
m=2.20;k=770; %system mass and stiffness, SI units
wn=sqrt(k/m);fn=wn/2/pi;
disp('Natural frequency (cycles/sec) fn ='),disp(fn)
Fm=6.0;tm=1/12; %excitation parameters
t=0:.005:2; %time sequence for excitation/response
tt=t/tm;efun=exp(1-tt);prod=tt.*efun;f=Fm*prod; %excitation
a1=m/tm^2;a2=a1+k;P1=Fm/a2;P2=2*a1*P1/a2; %P constants
C1=(P2-P1)*exp(1)/wn/tm;C2=-P2*exp(1); %C constants
wt=wn*t;x=C1*sin(wt)+C2*cos(wt)+P1*prod+P2*efun; %response
plot(t,100*f/k,'k.',t,100*x,'k'),grid,xlabel('Time t [sec]'),...

       ylabel('Translations reference f_x(t)/k and actual x(t) [cm]'),...
       title('Response of mass-spring system to ramped exponential pulse')
Natural frequency (cycles/sec) fn =
       2.9775

Figure 1-5 is the MATLAB graph produced by the sequence of commands above. The
graph was edited in the MATLAB figure window, mainly to reduce the size and to add
the legend.

               Figure 1-5 Excitation and response of a mass-spring system
         The reference quantity f x (t) k plotted on Fig. 1-5 represents the excitation force,
but divided by k, so that it has the units of translation. You can see from the basic ODE
(1-18), m &x& + k x = f x (t) , that the plotted quantity physically represents the spring defor-
mation that dynamic excitation f x (t) would produce if mass m were zero or negligible.

                                                   1-16
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

Because this reference quantity is calculated by neglect of the entire dynamic inertial
force, m &x&, it is often called the pseudo-static response.

         Observe on Fig. 1-5 that the actual dynamic translation x(t) of the mass greatly
overshoots the pseudo-static translation initially (with peak response of about +1.4 cm at
about 0.18 sec), and that the actual response persists as significant vibration after the
pulse excitation has died away. These are important dynamic characteristics of many
systems that we encounter in engineering practice. In reality, all mechanical systems that
consist of purely passive masses and passive structural members have some degree of
positive damping; but, if the damping forces are low in comparison with inertial and
structural forces, then these real systems will respond to excitation similarly, at least in a
qualitative sense, to the "actual" response of Fig. 1-5. For example, the real system of
Fig. 1-4 is positively but lightly damped; in response to the given force pulse, this system
would experience just about the same initial response and overshoot as shown on Fig. 1-
5, but the vibration would die away gradually, and motion would cease completely after
three or four seconds.

         The terms in Eq. (1-25) that primarily represent vibration are the sinusoidal func-
tions sin nt and cosnt , with the angle (in radians) argument of these periodic func-
tions being  (t) = nt . The period of such a function is the time required for the func-
tion to complete a full cycle and begin repeating itself. In this case, let's denote that pe-
riod as Tn and observe that its natural physical units are seconds/cycle. The associated
frequency fn , in the units cycles/second,6 is obviously just the inverse of the period,
 fn = 1 Tn . Thus, the angle (in radians) argument of the periodic sinusoidal functions can
be written in the following equivalent forms:  (t) = nt = 2 (t Tn ) = 2 fnt . The im-
portant relationship between circular natural frequency n , in radians/second, and cyclic
natural frequency fn , in cycles/second, is fn = n 2 . For the values of mass m and
stiffness k used in the MATLAB calculations above, the printed-out value of fn is 2.98
cycles per second, and this is the frequency that is most obvious in Fig. 1-5; for example,
as closely as we can detect by eye, almost exactly three complete cycles of vibration oc-
cur between t = 0.7 sec and t = 1.7 sec.

6 More commonly in modern terminology, a cycle/second is designated as a hertz, with the abbreviation
Hz.

                                                   1-17
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

1-11 Homework problems for Chapter 1

1.1(a) Super hero Dynaman is cruising along at 126 km/hr when the Dynamobile sud-
denly encounters wet pavement and begins hydroplaning. Naturally, Dynamobile is
headed straight for a thick, solid steel barrier and will crash if it can't stop. Also natu-
rally, Dynamobile is equipped not only with conventional brakes (useless against hydro-
planing) but also with jet reverse thrusters that can provide emergency braking in the
form of a half-sine pulse. Dynaman hits the panic button, which activates all sensors and
the onboard computer. The sensors instantly detect initial velocity v0 = 35.0 m/sec, Dy-
namobile total mass m = 1,500 kg, and hydroplaning viscous damping constant c = 7.70
N-sec/m. The computer calculates that a possible disaster-avoidance action is to deploy
the maximum available braking thrust amplitude of F = -7,200 N (-7.2 kN) in a half-sine
pulse extending over 10.0 sec [ fx(t) = F sin(0.100 t) for 0  t  10.0 sec]. Your task is
to demonstrate the effectiveness of this braking thrust by making a MATLAB graph that
shows the velocity of Dynamobile over 15 seconds (the 10-sec braking period plus an-
other 5 seconds of coasting). Be sure to use good engineering graphical practice: pro-
vide grids, a title, appropriate labels, and high point density. Submit your MATLAB
script as well as your graph.

(b) Consider the same scenario as in part (a), but with the following different data: v0 =
40.0 m/sec, m = 1,700 kg, c = 130 N-sec/m, with braking force amplitude F = -30,000 N
(-30.0 kN) in the pulse fx(t) = F sin(0.250 t) for 0  t  4.00 sec. Make a MATLAB
graph that shows the velocity of Dynamobile over 8 seconds (the 4-sec braking period
plus another 4 seconds of coasting).

(c) Consider the same scenario as in part (a), but with the following different data: v0 =
60.0 m/sec, m = 1,700 kg, c = 1,100 N-sec/m, with braking force amplitude F = -120,000
N (-120 kN) in the pulse fx(t) = F sin( t) for 0  t  1.00 sec. Make a MATLAB graph
that shows the velocity of Dynamobile over 3 seconds (the 1-sec braking period plus an-
other 2 seconds of coasting).

1.2 Consider again the hydroplaning Dynamobile of Problem 1.1 with total mass m, hy-
droplaning viscous damping constant c, and initial velocity v(0)  v0 .

(a) Integrate x& = v(t) given in Eq. (1-10) to derive an algebraic equation for position x(t)
while the braking pulse is active. In order to keep the equation algebraically simple
(relatively, anyway), leave it in terms of constants C, P1, and P2 (don't write those con-
stants in terms of m, c, v0 , F, and td ). Make sure that your x(t) equation gives the initial
position as zero, x(0) = 0, by either (i) carefully evaluating the definite integral of v(t)
between the limits 0 and t [see Eq. (1-3)], or (ii) taking the antiderivative of the v(t)
equation and adding an appropriate constant of integration [see Eq. (1-4)]. Using the
numerical data of Problem 1.1 [part (a) or (b) or (c), whichever you solved before], calcu-
late the distance traveled by Dynamobile at the end of the braking (pulse) period. (Com-

                                                   1-18
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

ment: in reality, to prevent collision with the barrier, wouldn't you need to know Dyna-
mobile's initial distance from the barrier as well as its initial velocity?)

(b) Differentiate v(t) given in Eq. (1-10) to derive an algebraic equation for acceleration
a(t) = v& while the braking pulse is active. In order to keep the equation algebraically

simple, leave it in terms of constants C, P1, and P2 . Using the numerical data of Problem

1.1 [part (a) or (b) or (c), whichever you solved before], make a MATLAB graph that

shows the acceleration in G's of Dynamobile over the braking (pulse) period. To calcu-
late acceleration in G's, divide acceleration in m/sec2 by the nominal SI acceleration of
gravity, g = 9.807 m/sec2. [Comment: we presume that Dynaman would not survive the

collision if there were no braking, but, in fact, would he survive the deceleration (perhaps

many G's) required to prevent the collision?]

1.3 Consider again the hydroplaning Dynamobile of Problems 1.1 and 1.2. Suppose that
all parameters are known except F, the pulse magnitude. Now we want to find the opti-
mum pulse magnitude, F  Fopt , defined here as the value that will bring Dynamobile to a

dead stop at the end of the pulse duration, v( td ) = 0.

(a) Use Eqs. (1-9)-(1-11) for v(t) to derive an algebraic equation for Fopt in terms of the
parameters m, c, v0 , and td . Next, evaluate your equation numerically for m = 1,700 kg,
c = 130 N/m/sec, v0 = 40.0 m/sec, and td = 4.00 sec. (answer: Fopt = -22.87 kN)

(b) Use the algebraic equation for position x(t) from Problem 1.2(a), and the value
F  Fopt from Problem 1.3(a) to calculate how far Dynamobile would travel after activa-

tion of thrust braking before coming to a dead stop. (answer: x( td ) = 75.18 m)

1.4 Consider a mass-damper system with a cosine forcing function, as described by the
1st order, LTI ODE m v& + c v = F cost , in which velocity v(t) is the dependent variable,
and the known constant parameters are mass m, viscous damping constant c, force am-
plitude F, and circular frequency of forcing . Use the method of undetermined coeffi-
cients to derive an algebraic equation (in terms of the given constants) for the particular
solution vp(t) of this ODE and forcing function.

1.5 The "standard" 1st order ODE is x& - a x = b u(t) .

(a) Suppose that u(t) = U sin t , t > 0, where U is a constant amplitude, and that x(0) =
0. Derive the following solution of the standard 1st order ODE:

- abU   at       
x(t) = 2 2  - e + sin t + cost  , t  0
 +a  a        a  

        1-19
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

(b) Suppose that u(t) = U cost , t > 0, where U is a constant amplitude, and that x(0) =
0. Derive the following solution of the standard 1st order ODE:

                            - abU  at        
                x(t) = 2 2  - e - sin t + cost  , t  0
                             +a   a          

1.6 Symbolic software such as Mathematica7 and MATLAB (the Symbolic Math Tool-
box) can solve some ODEs, including those discussed in Chapter 1. For an introduction
to this type of solution, solve Problem 1.5(a) in MATLAB. Begin with the following
MATLAB commands:

>> syms a b U w t
>> x=dsolve('Dx-a*x=b*U*sin(w*t)','x(0)=0')

The MATLAB response will probably be a long, algebraically undisciplined equation for
x(t) . In order to express the equation in a more economical form, type the command

>> x=simple(x)

The simplified equation will still be in rather awkward computer notation, so, to express
the equation in a more conventional form, type the command:

>> pretty(x)

A few words of warning about symbolic software are appropriate. For more complex
ODEs, symbolic software might give algebraic solutions that are correct, but are ex-
pressed in an unfamiliar form, or in an algebraic form that must be simplified by hand in
order to be useful. For this reason and others, engineers often regard symbolic software
as useful mainly for providing checks on mathematical results that have been derived the
old-fashioned way, by hand.

1.7 Imagine a spherical cannon ball having the diameter d and mass m of a regulation

baseball, but with a very smooth surface (not somewhat                  v(t)

rough, like a baseball's stitched cowhide cover). Suppose

that we launch this ball vertically upward from sea level        y(t)         g

against Earth's gravity, with known launch (muzzle) vertical

velocity v0 being sufficiently low that the acceleration of

gravity g remains essentially constant over the entire ascent y(0) = 0  v(0) = v0

and descent of the ball. Denote the varying altitude (vertical

position) of the ball as y(t) , positive upwards, so the ball's

velocity is v(t) = y&(t) .

(a) First, let's idealize the aerodynamic drag force as being linearly viscous with
damping constant c, D1 = c v (subscript 1 denotes this mathematical model of drag as

7 Mathematica ® is a registered trademark of Wolfram Research, Inc.

                                  1-20
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

proportional to the 1st power of velocity, v1). Draw and label an appropriate free-body
diagram (FBD), showing the direction of drag force, by convention in analysis of
aerodynamics, as being opposite to the direction of velocity v(t) . Using your FBD, apply
Newton's 2nd law to derive the ODE of motion, m v& + c v = - m g .8

(b) Solve the ODE of part (a) to determine an equation for velocity v(t) , t  0, given the
known IC, v(0) = v0 . First, observe that the homogeneous ODE is the same as Eq. (1-6),
so that Eq. (1-7) is the homogeneous solution. Next, find the simplest possible particular
solution, v p , a constant. Next, enforce the initial condition to determine the unknown
constant of the homogeneous solution. From your v(t) equation, show that v p = vt1, the
constant terminal velocity of the ball's descent for drag D1 . Also, derive an equation for
the instant of time tz1 when velocity is zero, which, of course, corresponds to the peak
altitude, ymax_1 of the ball. (Partial answers: vt1 = - mg c ; tz1 = (m c) ln(1 - v0 vt1 ) , in
which ln denotes the natural logarithm, i.e., the logarithm to base e.)

1.7(c) Integrate v(t) of part (b) to derive an equation for the ball's altitude, y(t) , t  0;
define the launch point to be the reference position, i.e., set the IC as y(0)  0. (Answer:
y(t) = (m c)(v0 - vt1 )(1 - e-(c m)t ) + vt1 t .)

(d) Next, let's consider the mathematical model for the aerodynamic drag force that is
generally considered most appropriate for a smooth ball: D2 = ± q S CD , with the plus
sign for ascent ( v  0 ), and the minus sign for descent ( v < 0 ). The terms in this equa-
tion are: q = 12  v2 , the dynamic pressure, with sea-level air density  = 0.002377
slug/ft3 = 0.002377 lb-sec2/ft4; S =  d 2 4 , the ball's projected area, with baseball
diameter about d = 2.90 inches; and CD , the dimensionless drag coefficient, which is
about CD = 0.50 for the smooth ball, provided its airspeed is less than about 140 mph
(miles/hour). Write two 1st order ODEs for v(t) with drag model D2 , one ODE applying
to ascent, the other to descent. Explain what it is about these ODEs that makes them
nonlinear. Do not attempt to solve these ODEs in general, but use the appropriately sim-
plified form of the descent ODE to find an algebraic equation for vt2 , the constant termi-
nal velocity of the ball's descent for drag D2 ; and then calculate the value of vt2 in mph.
Use the average weight of baseballs, m g = 5 18 ounces, with g = 32.17 ft/sec2. Note: 60
mph = 88 ft/sec, 1 foot = 12 inches, and 1 lb = 16 ounces. (Partial answer: vt2 = -74.91
mph. It might seem counterintuitive that the terminal velocity of a stitched baseball is
-95 mph, a much greater speed than that of an otherwise equivalent smooth ball; see
Adair, 1994, pages 5-12.9)

8 In Appendix B, Section B-2, this ODE is derived by an alternative method using energy and power.
9 Literature references such as this are described in detail in the References section following Chapter 17.

                                                   1-21
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

(e) Let's attempt to establish some sort of "equivalent" linear mathematical model rela-
tive to the nonlinear model of part (d). The only comparable results that we have deter-
mined for this purpose are the equations for terminal velocity. Therefore, calculate an
"equivalent" linear viscous damping constant c by equating vt1 = vt2 . Suppose that v0 =

110 mph, the average speed at which a baseball rebounds from a bat on the ball's way to
a 400-foot major league home run. Calculate the total ascent time tz1 (in seconds) and
the peak altitude y(tz1 )  ymax_1 (in feet), quantities that are defined in parts (b) and (c).

It happens that both nonlinear ODEs of part (d) can be solved in terms of standard mathe-
matical functions.10 In particular, solution of the nonlinear ODE for ascent leads to the

equation for total ascent time, tz2 = [(-vt2 ) g]tan -1[v0 (-vt2 )], and the equation for peak

altitude, y(t z2 )  ymax_ 2 = (vt2 2 g) ln 1 + (v0 vt2 )2 . Calculate t z2 and ymax_ 2 , and

compare them, respectively, with tz1 and ymax_1 ; note, however, that we cannot infer

from this limited comparison the general quality of the "equivalent" linear model relative
to the nonlinear model. (Partial answers: c = 2.955 × 10-3 lb-sec/ft; ymax_1 = 210.7 ft;

tz2 = 3.299 sec)

1.8 The ODE solution procedure illustrated in Section 1-5 for a 1st order ODE can be
used to solve any LTI ODE or system of LTI ODEs. Consider, for example, the 2nd order
ODE (1-17) for a mass-damper-spring system, m &x& + c x& + k x = f x (t) . The physical pa-

rameters m, c, and k are known constants.

(a) Seek a homogeneous solution in the form xh (t) = C e t as follows. First, show that

the characteristic equation is a quadratic polynomial in the unknown  . Next, solve the
polynomial equation and show in detail that there are two characteristic values (roots),

c  c 2 k     c 2 k
1,2 = - ±   - . Assume that   > . Therefore, the general homoge-
2m  2m  m    2m  m

neous solution must have the form xh (t) = C1 e1t + C2 e2 t , with two initially unknown

constants.

(b) Suppose that the excitation force has the sinusoidal form f x (t) = F sin t , in which

force amplitude F and circular frequency  (in radians/second) are considered to be
known. Seek a particular solution by using the method of undetermined coefficients.
First, express the solution as x p (t) = P1 sin t + P2 cost . Now, substitute this x p (t)

into the non-homogeneous ODE to find algebraic equations for P1 and P2 in terms of the

constants that m, c, k, F, and . (Partial answer: P2 =  - c             2 F)

                                                         22
                                                        (k - m ) + (c)

10 For examples of these solutions, see: an ascent solution in Greenwood, 1965, Problem 3-4 on pages 128
and 503; and a descent solution in Sommerfeld, 1964, pages 21-22.

                                                   1-22
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

(c) Express the complete solution as x(t) = xh (t) + x p (t) . Suppose that the mass m is

initially at rest with ICs: initial position x(0) = 0 and initial velocity x&(0) = 0 . Use

these ICs to write two linear equations with unknowns C1 and C2 . Solve for C1 and C2 ;

show that they can be written as C1 = P22 - P1 and C2 = P1 - P21 .
1 - 2  1 - 2

Note that a reasonably efficient algebraic equation for the final result x(t) is derived by
defining constants C1 and C2 in terms of the previously defined i and Pi , rather than
writing them in terms of all the basic parameters, m, c, k, F, and .

1.9 Solve Problem 1.8 in MATLAB. Begin with the following MATLAB commands:

>> syms x t m c k F w
>> x=dsolve('D2x+c/m*Dx+k/m*x=F/m*sin(w*t)','x(0)=0','Dx(0)=0')

The MATLAB response will probably be an equation for x(t) of truly breathtaking

length. You can try simplification operations such as x=simple(x) and pretty(x) and
the subexpr command, but they will not necessarily lead to a more useful equation for
x(t) . At some point, you might decide that, rather than continuing to flail away at the

symbolic software, your time is used more efficiently if you just solve by hand and define
intermediate symbols in terms of the basic parameters, as is done in Problem 1.8.

1.10 This problem relates to the details of the mass-spring-system ODE solution pre-
sented in Section 1-10.

(a) Substitute the assumed particular solution Eq. (1-23) into non-homogeneous ODE (1-
22), then carry out the process in all algebraic detail to verify Eqs. (1-24) for P1 and P2 .

(b) Substitute ICs (1-19), x&(0) = 0 and x(0) = 0 into complete solution Eq. (1-25), then
carry out the process in all algebraic detail to verify Eqs. (1-26) for C1 and C2 .

1.11 Consider a mass-spring system with an "exponential step" forcing function, as de-
scribed by the 2nd order LTI ODE m &x& + k x = f x (t) = F (1 - e-t tc ) , in which position x(t)

is the dependent variable, and the known constant parameters are mass m, spring stiffness
constant k, force amplitude F, and time constant tc. The time constant is the time required
for the "exponential unit-step" function, 1 - e-t tc , to rise from 0 at t = 0 to the value
1 - e-1 = 0.6321, on its way to the asymptotic value 1 as t  .

(a) Use the method of undetermined coefficients to derive an algebraic equation (in
terms of the given constants) for the particular solution xp(t) of this ODE and forcing
function.

1-23
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

(b) Let the ICs for this m-k system be x&(0) = 0 and x(0) = 0 . Use the result of part (a)
and whatever else is required to derive in all detail the following complete algebraic so-

lution for x(t), t  0, in which n = k m :

F           1    2 [e + (1 ntc ) sin nt + (1 ntc ) cosnt]-t tc2
x(t) = 1 -
k  1 + (1 ntc )                  

1.11 (c) Consider the specific numerical case of mass m = 8.03 kg, spring stiffness con-
stant k = 317 N/m, and force amplitude F = 4.50 N. Calculate the circular natural fre-
quency n and the cyclic natural frequency fn . Let excitation time constant tc = 1 n , a
much shorter interval than the m-k system's natural period Tn = 2 n . Compose and
run a MATLAB program that does the following: calculate the actual dynamic response
x(t) and the pseudo-static response f x (t) k over the time interval 0  t  2.5 sec; plot

both x(t) and f x (t) k on the same graph in units of either centimeters or millimeters.
Explain in a sentence or two what feature of your plot of x(t) demonstrates and conforms
with your calculation of fn .

1.12 Consider a mass-spring system with a sinusoidal forcing function, as described by
the 2nd order LTI ODE m &x& + k x = f x (t) = F sin t , in which position x(t) is the depend-
ent variable, and the known constant parameters are mass m, spring stiffness constant k,
force amplitude F, and excitation frequency  .

(a) Use the method of undetermined coefficients to derive an algebraic equation (in
terms of the given constants) for the particular solution xp(t) of this ODE and forcing
function, a solution that is valid provided  2  k m .

(b) Let the ICs for this m-k system be x&(0) = 0 and x(0) = 0 . Use the result of part (a)
and whatever else is required to derive in all detail the following complete algebraic so-
lution for x(t), t  0, in which n = k m :

           x(t) = F 2 1 [sin t - ( n ) sin nt], valid for   n

                       k 1 - ( n )

(c) Consider the specific numerical case of mass m = 0.230 lb-sec2/inch (which weighs
about 88.8 lb), spring stiffness constant k = 227 lb/inch, and force amplitude F = 45.0 lb.
Calculate the circular natural frequency n and the cyclic natural frequency fn . For
excitation frequency  = 1.2n , compose and run a MATLAB program that does the
following: calculate the actual dynamic response x(t) and the pseudo-static response
 f x (t) k over the time interval 0  t  2 sec; plot both x(t) and f x (t) k on the same
graph. Your x(t) plot should exhibit the phenomenon of beating, which is analyzed more
completely in Section 10-6.

                        1-24
Chapter 1 Introduction; examples of 1st and 2nd order systems; MATLAB calculations and graphics

(d) The x(t) equation derived in part (b) is not valid if excitation frequency  equals
natural frequency n , but note that in this case the x(t) equation has the indeterminate
form 0/0, so that we can apply l'Hospital's rule (which is described in any calculus text-
book) to find the limit-case response solution. Define  =  n , so that t = n t .
Now, hold n constant and take the limit as   1 of the x(t) equation in order to deter-
mine the correct response x(t) equation for the case  = n .

                                                   1-25
Chapter 2 Complex numbers and arithmetic; Laplace transforms;
                          partial-fraction expansion

© 2016 by William L. Hallauer, Jr.

2-1 Review of complex numbers and arithmetic

         We will find many uses in system dynamics for analysis with complex numbers

and variables. It is instructive first to imagine how complex numbers might have been

developed historically. It seems likely that they appeared first in solutions for roots of
polynomial equations. To see how, let's examine the 2nd degree polynomial, the standard

quadratic equation, and its solutions. The quadratic equation is

az2 +bz +c = 0                                          (2-1)

where z is the unknown and a, b, and c are known constants. The standard solution for
roots z is

z = - b ± 1 b2 - 4ac                                    (2-2)
      2a 2a

Provided that b2 - 4ac  0, solution (2-2) can be calculated easily. But suppose the con-
stants have values such that b2 - 4ac < 0, so that Eq. (2-2) indicates the square root of a

negative number. That must have seemed strange to early mathematicians. Nevertheless,
(2-2) is the correct solution regardless of the sign of b2 - 4ac, which you can verify sim-

ply by substituting (2-2) back into (2-1). So it was necessary to recognize the existence

of the square root of a negative number and to invent notation and terminology for de-

scribing such a number.

For b2 - 4ac < 0, we can write

b2 - 4ac = (-1)(4ac - b2 ) = -1 × 4ac - b2  j 4ac - b2

in which we define the unit imaginary number as j  -1 . Perhaps early mathemati-
cians used the adjective "imaginary" because such a number seemed unreal to them.
With this definition, we can write (2-2) in the form

                                      z = - b ± j 1 4ac - b2
                                             2a 2a

This is called a complex number, which is the sum of a normal, or real number and an
imaginary number (j times a real number being a general imaginary number).

                                2-1
     Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

         If x and y are reals, then any complex number can be written in the rectangular
form:

            z = x + j y , with real part x  Re(z) , and imaginary part y  Im(z) (2-3)

This form is called "rectangular" because it expresses the complex number in terms of its

rectangular, or Cartesian components, x and y. Equation (2-3) is similar mathematically

to a two-dimensional vector v expressed in terms of Cartesian components and unit vec-

tors 1x and 1y : v = vx 1x + vy 1y . Therefore, we can represent a complex number

z = x + j y graphically in the Cartesian form similar to that used for two-dimensional

vectors, as shown in Fig. 2-1.

                                                             Im(z) length r

     From Fig. 2-1, we can infer another useful way to                       z

represent a complex number. By defining the magnitude y
(length, absolute value, modulus) of z as the positive num-
                                                                
ber

                                                             x               Re(z)

              r = x2 + y2                        (2-4) Figure 2-1

we can write

                                x y
              z = x + j y = r + j  = r(cos + j sin )                         (2-5)
                                r r

In Eq. (2-5), we employ the standard trigonometric functions of angle  originating on
the positive real axis and defined positive in the counterclockwise (CCW) sense, Fig. 2-1.
Angle  is often called the argument of z. The general definition is

                                         -1  y                               (2-6)
                                 = tan  

                                           x

It is necessary to recognize Eq. (2-6) as the four-quadrant inverse tangent (or arctan-
gent). For example, if y is positive and x is negative, then (2-6) should give angle  in
the second quadrant, 90° <  < 180°; or, if both y and x are negative, then (2-6) should
give angle  in the 3rd quadrant, -180° <  < -90° (which also can be written as 180° < 
< 270°). Unfortunately, the tan-1 or arctan function on hand calculators does not calcu-

late the four-quadrant inverse tangent, but only considers the sign of the quotient y/x, and
produces a  value in the 1st or 4th quadrants, -90° <  < +90°. So, if you are evaluating

(2-6) on your hand calculator, you need to account for the signs of both y and x, and you

need to modify appropriately the answer given by your calculator. If you are evaluating

(2-6) in MATLAB, then you should use MATLAB's four-quadrant inverse tangent func-

tion, atan2(y,x).

                                2-2
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

         Equation (2-5) is just an intermediate result. To achieve the desired final form,
we rewrite (2-5) using the well-known Taylor power series expansions for sine, cosine
and exponential functions:

                             2  4    3  5 

z = r(cos + j sin ) = r1 - + - ... + j - + - ...

                             2! 4!   3! 5! 

z = r(cos + j sin ) = r1 + ( j ) +  ( j )2 ( j )3 ( j )4 ( j )5  j
                                         +         +          +          + ...  r e
                                    2!         3!         4!         5!
                                                                         

                                    z = r e j                                        (2-7)

The important result

                        cos + j sin = e j                                            (2-8)

is known as Euler's equation (after Leonhard Euler, 1707-1783, Swiss mathematician
and physicist). See homework Problem 2.1 for other equations closely related to Eq. (2-
8).

         A complex number in the form z = r e j is called the polar form because it em-

ploys polar coordinates r and . We can visualize the complex exponential term e j it-
self as a clock hand in the complex plane, Fig. 2-1; the clock hand has unit length, and it
is rotated CCW by angle  from the 3 o'clock position. Similarly, the full complex num-
ber z = r e j represents a clock hand of length r that is rotated CCW by angle  from the

3 o'clock position, so the notation z = r is often used, where the symbol  stands for
"angle."

         We will occasionally need to convert a complex number from rectangular form
into polar form using Eqs. (2-4) and (2-6). The MATLAB functions abs and angle are
especially useful for this task, as is illustrated in Complex-arithmetic Example 2 below.

         We also will need to use complex arithmetic, so let's review (from your mathe-
matics courses) some of the basics, supposing that we have two complex numbers z and
w expressed in both rectangular and polar forms:

z = x + j y = r e j and w = u + j v = q e j , where x, y, r, , u, v, q, and  all are real.

Addition or subtraction, rectangular: z ± w = (x ± u) + j( y ± v) .

Addition or subtraction, polar: r e j ± q e j  Z  Re j .

                      Z = r cos + q cos ± j(r sin + q sin)

                                    2-3
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

   R = [Re(Z )]2 + [Im(Z )]2 = r 2 + q 2 + 2rq cos( - )

 = tan -1[Im(Z ) Re(Z )] = tan -1[± (r sin + q sin) (r cos + q cos)]

Multiplication, rectangular: z × w = xu + j(xv + yu) + j 2 ( yv) = (xu - yv) + j(xv + yu) .

Multiplication, polar: z × w = rq e j( +) .

The complex conjugate of z = x + j y = r e j is defined as z = x - j y = r e- j , so that the

product of a complex number and its conjugate is real, and equal to the square of the
magnitude: z z = x2 + j(-xy + yx) - j 2 y 2 = x2 + y 2 = r 2 , or more easily in polar form,
z z = r e j × r e- j = r 2e j( - ) = r 2 . Suppose that we have the quotient of two complex

numbers z by w, both in rectangular form, and we wish to cast the result into standard
rectangular form; it is common practice first to multiply both denominator and numerator
by the conjugate of the denominator, thus forming a real denominator:

Division, rectangular: z = x + jy = (x + jy)(u - jv) = 2 2 xu + yv + j 2 2 - xv + yu
   w u + jv (u + jv)(u - jv) u + v                       u +v

Division, polar, z = r e j( - )
                    wq

Complex-arithmetic Example 1 Cast the following complex fraction into standard rec-
tangular form, then convert it into polar form:

z = 3 - j4 = (3 - j4)(1 - j2) = 3 - 8 + j(-6 - 4) = -1 - j2
   1 + j2 (1 + j2)(1 - j2)                            5

2  2                                         -1 - 2       rad
r = (-1) + (-2) = 2.236,  = tan   = -116.6° ×                  = -2.034 rad
                                              -1         180°

               z = 3 - j4 = -1 - j2 = 2.236e j(-116.6°)  2.236(-2.034 rad)
                          1+ j2

Note that when you take tan-1(2) on your hand calculator, it gives 63.43°. Because you
are really trying to find tan-1(-2/-1), you must recognize that the correct angle is in the
3rd quadrant and, therefore, add +180° or -180° to the calculator's solution in order to
obtain the correct result, +243.4° or -116.6°.

Complex-arithmetic Example 2 Cast the following complex fraction into standard rec-
tangular form, then convert it into polar form:

                                             2-4
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

z = (3 - j2)(4 + j) - 7 + j4 = (14 - j5)(2 + j3) - 7 + j4 = 43 + j32 - 7 + j4
2 - j3     (2 - j3)(2 + j3)                  13

             43   32 
        z =  - 7 + j + 4 = -3.692 + j 6.462

             13   13 

2       2       -1 6.462 
r = (-3.692) + (6.462) = 7.442,  = tan    = -60.255° + 180° = 119.7°
                 - 3.692 

 z = (3 - j2)(4 + j) - 7 + j4 = -3.692 + j6.462 = 7.442 e j119.7°
                 2 - j3

A solution of Complex-arithmetic Example 2 in terms of MATLAB operations follows:

>> z=(3-2j)*(4+j)/(2-3j)-7+4j
z =

   -3.6923 + 6.4615i
>> r=abs(z),theta=angle(z)
r =

       7.4421
theta =

       2.0899
>> thetadeg=theta*180/pi
thetadeg =

   119.7449

Note that MATLAB prefers, and gives results in terms of the unit imaginary number de-
noted as i, but it recognizes our notation of j. Note also that the radian is MATLAB's
default unit for angles: if you want a MATLAB angle result in degrees, you must convert
from radians; also, if you wish to calculate a trigonometric function of an angle, you must
express that angle in radians.

2-2 Introduction to application of Laplace transforms

         The Laplace transform (after French mathematician and celestial mechanician
Pierre Simon Laplace, 1749-1827) is a mathematical tool primarily for solving ODEs, but
with other important applications in system dynamics that we will study later. In Laplace

           2-5
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

transformation, we deal with a complex variable denoted as s, which is usually expressed
in terms of its real and imaginary parts as

                s =  + j                                                      (2-9)

in which  and  both are real. We define a complex function of s, F(s). The type of
function that we will encounter often takes the form of a ratio of two polynomials:

       Num (s) b1s m + b2 s m-1 + ... + bm+1 b1 (s - z1 )(s - z2 )L(s - zm )
F(s)   = n n-1        =                                                       (2-10)
       Den (s) a1s + a2 s + ... + an+1 a1 (s - p1 )(s - p2 )L(s - pn )

In the first polynomial form of Eq. (2-10), a1 , ... , an+1 and b1 , ... , bm+1 are real con-
stants (with the symbols and numbering system keyed to MATLAB notation); numerator
Num(s) is an mth degree polynomial in s, and denominator Den(s) is an nth degree poly-
nomial in s, with m  n in general. In the second polynomial form, with factored Num(s)
and Den(s), complex constants z1, z2 , ... , zm are called zeros of F(s) because F(s) is

zero if s equals any one of them, and complex constants p1, p2 , ... , pn are called poles
of F(s) because F(s) is infinite if s equals any one of them. If m < n, F(s) in Eq. (2-10)
also goes to zero as s  .

         Solving a simple ODE problem with Laplace transforms is a gentle introduction
to the subject. Consider the 1st order LTI ODE written in standard form: x& - a x = b u(t) ,
Eq. (1-1). Let's solve this ODE with a known IC, x(0) = x0 , and with a specific expo-
nential input function, u(t) = U e-wt , U being a dimensional magnitude; in any physically

realistic problem, constant w would be a real number, but for generality here we allow it
to be a complex number. So the complete problem statement is:

       x& - a x = bU e-wt , x(0) = x0 , solve for x(t), t > 0                 (2-11)

To begin the solution, we multiply the ODE by a complex exponential, e-st , then take
the definite integral over time from t = 0 to t =  of the entire multiplied ODE:

t=              t=        t=   t=
     (x& - a x = bU e-wt ) dt  e-st x& dt - a e-st x dt = bU e-st e-wt dt
 e-st                                                                         (2-12)

t=0             t =0      t=0  t =0

In (2-12), s is a complex variable that must have values for which the integrals exist.
Based upon (2-12), we define the forward Laplace transform of dependent variable x(t)1:

1 In Section 8-4 we develop a more general definition, Eq. (8-12), in order to accommodate the ideal unit-
impulse function, which is important in linear-system theory and applications.

                                                    2-6
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

                                                 t=                                      (2-13)

               L[x(t)]  X (s)   e-st x(t) dt
                                                  t=0

In (2-13), the function x of time t is transformed by the definite integration into a function
X of Laplace variable s. Also, the ODE of (2-11) is transformed into (2-12), which, as we
will find, becomes an easily solvable algebraic equation in the unknown X (s). After we
solve that algebraic equation for X(s), then we will reverse the process to find the original
unknown x(t) by applying the inverse Laplace transform, denoted as L-1[X(s)]  x(t). For
any Laplace-transformable function f (t) , and its transform F(s), the companion equa-

tions L[ f (t) ] = F(s) and L-1 [F(s)] = f (t) are called a Laplace transform pair.

         In order to transform Eq. (2-12) into an algebraic equation, let's carefully consider
each integration in (2-12), beginning with that on the right-hand side:

     t =                 1 -(s+w) t t =
            -(s+w) t
[ ] [ ]    t=                                                1
       -st -w t
e e dt = e dt =                    de    =                                e  -(s+w)t t=

                      - (s + w) t=0                    - (s + w)             t=0

t=0  t=0

     = 1 [e-(s+w) -1] = 1
     - (s + w)                  s+w

An important step in this derivation involves the complex exponential, with use of Eqs.
(2-3) and (2-8): e z = e(x+ j y) = e x (cos y + j sin y) . Since sin y and cos y vary periodi-

cally as y varies, the only way for e z to  0 + j0 for all values of y is for x  - .
Thus, in the last step of the integration, we assume that Re(s + w) > 0, or Re(s) >
- Re(w) , so that e-(s+w) = 0 + j0. The integration above establishes the following La-
place transform pair, which is one of the most important of all pairs for applications:

          -wt         1              -1  1  -wt
          L[e ] =          and L   = e                                                   (2-14)
                      s+w              s + w

         For your convenience, transform pair (2-14) and all other fundamental Laplace
transform pairs used in this book are tabulated in Appendix A at the end of the book.
Appendix A also includes some of the longer but less instructive transform derivations,
should you wish to study them.

Next, let's evaluate the first term on the left-hand side of (2-12) by the standard

                           t=                          t=
method of integration by parts in the form  u dv = [u v]t=0 t= -  v du :
                           t=0                         t =0

                           2-7
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

t= }u }dv                    t=
 e x& dt = [e x(t)]t=0 -  x(t)× (-s)e dt = [e x() - e x(0)]+ s X (s)t=
     -st   -st                         -st     -s×                   -0

t=0                          t=0

                                                                              (2-15a)

          = -x(0) + s X (s)

To obtain this result, we assume that e-(s×) x() = 0, which generally means Re(s ) > 0.
This result is the important general Laplace transform of the first derivative of any trans-
formable function f (t) :

                                  L[f&(t)] = s F(s) - f (0)                   (2-15b)

Equation (2-15b) is the basis for derivation of the Laplace transform of a derivative of
any order n, which we will use later (Ogata2, 1998, pp. 25-26):

                 d n n-1 n-2 n  & (n-1)
           L n f (t) = s F (s) - s f (0) - s f (0) - L - f (0)                (2-16)
                 dt
                             

For example, the Laplace transform of the 2nd derivative is (homework Problem 2.7):

                         L[&f&(t)] = s2 F(s) - s f (0) - f& (0)               (2-17)

         Proceeding with the solution of ODE + IC (2-11), we now substitute Eqs. (2-13),
(2-14), and (2-15a) back into (2-12) to obtain an algebraic equation for transform X (s) ,
which is easily solved:

          s X (s) - x(0) - a X (s) = bU  (s - a) X (s) = x0 + bU
                                  s+w                                    s+w

                      X (s) = 1 x0 + bU                                       (2-18)
                                     (s - a) (s - a)(s + w)

         To solve for the ultimate unknown x(t), we now need to find the inverse transform
of X (s) in (2-18). Using (2-14) easily gives us the inverse of the first term on the right-
hand side:

                     -1  1                  -1  1  = x0 e        at
                     L            x0  = x0 L 
                          s - a              s -a                             (2-19)

2 Literature sources such as this are described in detail in the References section following Chapter 17.

                                                    2-8
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

         Inverting the second term on the right-hand side of (2-18) is a greater challenge,
which requires us to use partial-fraction expansion in order to expand that term into two
simpler terms, each of which has the easily invertible form of a constant divided by a sin-
gle factor of the form (s - p). We first write the troublesome term as two simpler frac-
tions with unknown constant numerators, C1 and C2 , which are called residues of the
partial-fraction expansion. (A more detailed justification for this form is derived in the
next section.):

  1 = C1 + C2  C1 + C2 = 1                                                           (2-20)
(s - a)(s + w) s - a s + w                       s - a s + w (s - a)(s + w)

There are two common methods for finding C1 and C2 , which we shall call the "labor-
saving" method and the "brute-force" method.

         Consider first the labor-saving method. Let's go in great detail through the steps
required to find C1 , for example. First, multiply both sides of Eq. (2-20) by s - a , the
denominator of the C1 term:

        C1 C2                                     C2                   1         
(s - a)  +          = C1 + (s - a)                      = (s - a)                
       s-a s+w                                    s + w           (s - a)(s + w) 

Isolate C1 on the left-hand side:

                                    C2                    1          
         C1 = -(s - a)  + (s - a)                                    
                                    s + w         (s - a)(s + w) 

Now, in order to eliminate the C2 term on the right-hand side, set s = a . Note that this
does not eliminate the second right-hand-side term because (s - a) is in both the denomi-

nator and the numerator.

          C2                               1                              1        
C1 = - (s - a)  + (s - a)                         = (s - a)                        
          s + w                     (s - a)(s + w)  s=a             (s - a)(s + w)  s=a

Thus, we obtain the required equation for C1 :

                                              1              1
         C1 = (s - a)                             =
                                      (s - a)(s + w)  s=a a + w

Now that we see the logic of the labor-saving method, we can dispense with most of the
intermediate steps and quickly write the corresponding equation for C2 directly from Eq.
(2-20):

                                           2-9
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

                                1                           1        1
C2 = (s + w)                           =                       =-
             (s - a)(s + w)  s=-w - w - a a + w


         Next, the brute-force method begins with use of the traditional algebraic method
for combining the two fractions of Eq. (2-20) into a single fraction:

1 = C1 + C2 = C1 (s + w) + C2 (s - a) = s(C1 + C2 ) + (C1w - C2a)
(s - a)(s + w) s - a s + w         (s - a)(s + w)                  (s - a)(s + w)

Equate coefficients of like powers of s in the numerators:

  s1 : 0 = C1 + C2  C2 = - C1

s 0 : 1 = C1w - C2a = C1 (w + a)                   C1 = 1 = -C2
                                                         a+w

         In this simple problem, the brute-force method is not much more demanding al-
gebraically than the labor-saving method. However, for a slightly more complex original
fraction, say, one with three denominator polynomial factors instead of just two, the
brute-force method can require orders of magnitude more algebra than the labor-saving
method. The point of this discussion: exert the mental energy to understand the labor-
saving method, and always use it rather than the brute-force method [see homework
Problem 2.9(b)].

         Using the partial-fraction expansion developed above, we now express the com-
plete second term on the right-hand side of Eq. (2-18) in the easily invertible form

                            bU        bU  1                    1
F(s) =                             =     -                         
        (s - a)(s + w) a + w  s - a s + w 

Using the fundamental inverse transform from Eq. (2-14) gives

              f (t) = bU (eat - e-wt )                                             (2-21)

                      a+w

         Finally, combining Eqs. (2-19) and (2-21) gives the inverse of (2-18) and the final
desired solution of ODE + IC (2-11):

  x(t) = x0eat + bU (eat - e-wt ), for t  0                                        (2-22)

                   a+w

         The introduction to Laplace transformation in this section is not mathematically
rigorous. The focus in introductory system dynamics is more with applying Laplace
transforms than with the detailed theory. It is relevant, however, to comment on the exis-
tence of Laplace transforms: a transform generally exists (i.e., the defining integral Eq.

                                   2-10
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

(2-13) can be evaluated, in principle) for any function f (t) for which the product
e-at f (t)  0 as t  , where a is some finite, positive, real constant (Hildebrand,

1962, Section 2.2). Practically speaking, this means that any physically realizable func-
tion, the type of function that we encounter in engineering, has a Laplace transform.

2-3 More about partial-fraction expansion

         Let's examine in more detail the justification for the form of the partial-fraction
expansion presented in Eq. (2-20). As an example, consider the following sum of three
fractional terms:

            3 Ck     C1        C2             C3
F3 (s) =          =         +              +
            k=1 s - pk s - p1 s - p2 s - p3

                                                                                     (2-23)

            = C1 (s - p2 )(s - p3 ) + C2 (s - p1 )(s - p3 ) + C3 (s - p1 )(s - p2 )
                                    (s - p1 )(s - p2 )(s - p3 )

In the combination of the three fractional terms into a single fraction, the denominator is
a cubic polynomial (n = 3), and the degree of the numerator polynomial is, at most, m =
2. Depending upon the values of constants Ck , the degree of the numerator polynomial
can be from 0 to 2, so that 0  m < n.

         Next, let's generalize the observation of the previous paragraph by considering a
general sum of fractional terms in the form

                                   n Ck                                              (2-24)

                         Fn (s) = 

                                   k =1 s - pk

If we combine all n of these terms into a single ratio using the traditional algebraic
method illustrated in Eq. (2-23), then the result will have the following general form:

                             c1s m + c2 s m-1 + ... + cm+1
                  Fn (s) =

                           (s - p1 )(s - p2 )L(s - pn )

The denominator is a polynomial of degree n, and the numerator is a polynomial of, at
most, degree m = (n - 1). We therefore can conclude the following: a ratio of polyno-
mials, in which the numerator has a lower degree than that of the denominator, can usu-
ally be expanded into the simple partial-fraction form (2-24). In other words, provided
that 0  m < n, we can usually find finite residues Ck in the partial-fraction expansion:

b1s m + b2 s m-1 + ... + bm+1 b1 (s - z1 )(s - z2 )L(s - zm ) n Ck
Fn (s) = n               =                                  =                        (2-25a)
            n-1
a1s + a2 s + ... + an+1 a1 (s - p1 )(s - p2 )L(s - pn ) k=1 s - pk

                               2-11
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

with the residues given by the labor-saving method as3                                     (2-25b)

                        Ck = [(s - pk ) Fn (s)]s= pk , k = 1, 2, ..., n

         Consider, for example, part of the partial-fraction expansion of a quadratic di-
vided by a cubic:

      F3 (s) =  b1s 2 + b2 s + b3        = C1 + C2 + C3

                (s - p1 )(s - p2 )(s - p3 ) s - p1 s - p2 s - p3

Using Eq. (2-25b), to determine, for example, residue C1 gives:

                                               b1 p12 + b2 p1 + b3

               C1 = [(s - p1 ) F3 (s)]s= p1 =

                                              ( p1 - p2 )( p1 - p3 )

This equation for C1 reveals an exception to the rule: this equation clearly would not be
valid if the denominator polynomial were to have repeated roots, p1 = p2 or p1 = p3 ; in
that case, a form different than Eqs. (2-25) would be appropriate (Ogata, 1998, pp. 33-
34). That is a special case which we shall address in this book only as the need arises.

         Finally, observe that it is easy to check the validity/correctness of a partial-frac-
tion expansion after we have solved for residues Ck . Simply combine the individual
fractions into a single ratio, as is illustrated in Eq. (2-23); the resulting ratio should equal
the original ratio of polynomials that we expanded into partial fractions.

2-4 Additional useful functions and Laplace transforms: step, sine, cosine, definite
integral

We shall describe and transform several different useful mathematical functions.

A common feature of most of these functions is that they are defined to have non-zero

values only for positive time, i.e., they are zero before t = 0. The fundamental function of

this type is the basic Heaviside unit-step function (after English electrical engineer,

H(t) physicist, and applied mathematician Oliver Heaviside,
                                 1850-1925) shown in Fig. 2-2:

1

                                         0 for t < 0
                                         H (t) =                                           (2-26)
                                         1 for t > 0
0
   0
                t  H (t) is dimensionless, and it is undefined mathemati-

   Figure 2-2      cally at the discontinuity at t = 0. If we wish to write

3 An interesting alternative form of Eq. (2-25b) is developed in Appendix A, Section A-2.

                                   2-12
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

an equation for a physical input quantity that is applied quickly and remains constant
thereafter, we can use H (t) to represent it approximately; for example, a "step" force

 f x (t) can be described with the equation f x (t) = F × H (t)  F H (t) , where F is the di-
mensional force magnitude. For many physical input quantities, a step function is an ide-
alized approximation; such a quantity increases quickly but continuously, not as a discon-
tinuous pure step, from zero to a constant value. [The notation H (t) used here for the

unit-step function is common but not standard; in fact, there is no standard symbol in en-
gineering literature.]

A more general unit-step function describes a step that occurs at some time ts dif-

H(t - ts )                ferent than the instant defined to be t = 0. This func-
                          tion (Fig. 2-3) is:

1

                                                                 0 for t < ts
                                                   H(t - ts ) =                 (2-27)
                                                                 1 for t > ts
0
   0
            t s        t

   Figure 2-3             If the time of discontinuity is ts = 0, then this more

                          general function becomes the basic function of (2-26).

The Laplace transform of H(t - ts ) is

            t=                          t=             1 -s t t =  1 -s× -s ts
                  -st                         -st
L[H (t - ts )] =  e H (t - ts ) dt =  e dt =  d (e ) = - (e - e )
            t =0                        t =ts          - s t-ts    s

                          L[H (t - ts )] = e-sts                                (2-28)

                                             s

Note, in particular, the version of Eq. (2-28) for the basic unit-step function with ts = 0:

                                        L[H (t)] = 1                            (2-29)

                                                    s

         We will frequently use sine and cosine functions of time with circular frequency
, the functions being non-zero only for positive time, t  0. Using precise notation, such
a sine function, for example, should be denoted H(t) × sin  t ; however, with few excep-

tions, we will consider mostly t  0, so we can almost always omit the "H(t) ×" part of
the equation, with the implicit understanding that the analysis applies only for t  0.

         Next we derive the Laplace transform of the sine function by expressing the sine
in terms of complex exponential functions (homework Problem 2.1) and using the basic
forward transform of Eq. (2-14):

                                        2-13
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

L[sin  t] = L e j t - e - j t  1  1     1  1  s + j - (s - j) 
                      =              -          =        
              2 j  2 j  s - j s + j  2 j  (s - j)(s + j) 

                             1  2 j                             (2-30)

               L[sin  t] =  2 2  = 2 2

                            2js +  s +

Using a similar process, you can derive (homework Problem 2.10) the following Laplace
transform of the cosine function:

                     L[cos t] = s 2 +  2 s                      (2-31)

         Another useful Laplace transform is that of a definite integral. Suppose that a
physically realistic function f (t) has Laplace transform F(s) = L[ f (t) ], and that we need

                                                                          =t0

the transform of the definite integral  f ( ) d . Note the lower limit of  = -; we will
                                                                          =-

usually consider f (t) only for t  0, but occasionally the integral of f (t) over previous

time, t < 0, is also needed. The general transform, which is derived in Appendix A, Sec-
tion A-3, is:

                =t0  1                  1  =0
               L  f ( ) d  = F (s) +  f ( ) d                   (2-32)
                     s                  s  =-
                =-

For most applications, we will have f (t) = 0 for t < 0, for which the simpler transform is:

                      =t0            1
                     L  f ( ) d  = F (s)                        (2-33)
                                     s
                       =0

If we regard the integral of f (t) as being the first "negative" derivative (antiderivative),

then we see that transform (2-32) is logically consistent with transform (2-15b) for a
"positive" derivative, with respect to both power of s and the initial value term.

                           2-14
     Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

2-5 Homework problems for Chapter 2

2.1 Refer to Euler's equation, Eq. (2-8), which is e j = cos + j sin . The cosine is an
even (symmetric) function, cos(- ) = cos , and the sine is an odd (antisymmetric) func-
tion, sin(- ) = - sin , so the conjugate to Euler's equation is

                            e- j = e j(- ) = cos(- ) + j sin(- ) = cos - j sin

(a) Add the conjugate to Euler's equation to prove cos = e j + e- j . Subtract the con-
                                                                              2

jugate from Euler's equation to prove sin = e j - e- j .
                                                            2j

(b)  Use  the  results      of   part  (a)  to  prove  the  trigonometric   identities   cos2      =  1  (1  +  cos  2  )
                                                                                                      2

and  sin 2     =  1  (1  -  cos  2  )  .  Use these results to prove  cos2   - sin 2     = cos 2 .
                  2

(c)  Use  the  results      of  part   (a)  to  prove  the  identity  sin   × cos  =  1  sin 2  .
                                                                                      2

2.2 Given the following complex numbers:

(a) 1                            (b) 5j × (2 - j)           (c) 0.7 - j2.4               (d) -10 + j5
     - 0.4 - j0.3                                                0.5 + j1.2                   0.6 + j0.8

First, express the complex number in rectangular form, z = Re(z) + j Im(z), where Re(z)
and Im(z) are real numbers. Next, express the complex number in polar form re j , that
is, calculate by hand and calculator the radius r and the phase angle , where  is in de-
grees, -180°   < +180°. You may check your hand calculations by using the abs and
angle commands appropriately in MATLAB.

2.3 Given: two complex numbers expressed in polar form z1 = r1 e j1 and z2 = r2 e j2 ,
with r1, r2 , 1, and 2 all real numbers.

(a) Use complex arithmetic with complex numbers in polar form to show that the conju-
gate of a product equals the product of conjugates, which is expressed in equation form as

(z1 × z2 ) = z1 × z2 .

(b) Use complex arithmetic with complex numbers in polar form to show that the conju-
gate of a quotient equals the quotient of conjugates, which is expressed in equation form

as (z1 z2 ) = z1 z2 .

                                                            2-15
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

2.4 Express a complex number in rectangular form, z = x + jy, and prove the following
identity: z + z = 2 Re(z) = 2x .

2.5 Given: complex numbers A = Ar + jAi and B = Br + jBi (Ar, Ai, Br, Bi all real) and
complex variable z = x + jy (with real, non-zero values of x and y, which are independent
of each other), in the equation C = Az + Bz .

Prove: use complex arithmetic with complex values in rectangular form to show that C

can be real, C = Cr + j0, only if B = A . (Note that you can also prove this by applying
the results of homework Problems 2.3(a) and 2.4.)

2.6 The following complex function will arise when we study the frequency response of

a 2nd order system: Z ( ) = 2 1    , in which  is a positive, real, dimensionless
                       (1-  )+ j2

forcing frequency (not dimensional frequency  ), and  is a positive, real, dimen-

sionless ratio that represents viscous damping.

(a) Convert the Z() equation above into polar form Z() = r( ) e j ( ) . In particular,

carry out the detailed algebraic steps to show that the magnitude and phase angle are

r() =       1          and  ( ) = tan-1 2   - 2  .
                                           1-  
       22(1-  ) + (2 )2

(b) Calculate values of the magnitude and phase angle for several values of forcing fre-
quency  and for two values of damping ratio  (specifics below). Make these calcula-
tions with a hand calculator, not with MATLAB or some other computer software (al-
though you may check your hand calculations with computer software). These calcula-
tions will give you a small preview of frequency response, and (especially) they should
help you to understand the care required when you evaluate the four-quadrant arctangent.
Specifically, for each of the damping ratios  = 0 and  = 0.1 (or another value assigned
by your instructor), calculate the quantities in the empty cells of the table below (to at
least three significant figures, preferably four, but no more); also, calculate phase angles
using the standard engineering convention, -180°   < +180°, not 0°   < +360°.

Hints for the  = 0 case: (1) for the r() calculations, recognize that the equation re-
quires r() > 0, even if  > 1; (2) for the () calculations, imagine that  has an ex-
tremely small, positive value, say  = +1 × 10-10.

                       r()          ()               ()
                                   degrees          radians

        0
       0.5
        1
        2
        5

                                 2-16
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

2.7 Prove Eq. (2-17), L[&f&(t)] = s 2 F(s) - s f (0) - f& (0) : first define g(t) = f& (t) ; now use
the fundamental equation (2-15b) twice, first as G(s) = L[f& ] = s F (s) - f (0) , and then as

L[g& ] = s G(s) - g(0) .

2.8 Consider the Laplace transform shown below, both in the first form, which is derived
directly from an ODE, and in a partial-fraction expansion,

 1  1                             1  C1        C2                          C3
F (s) =                        +         =  +                           +
 s - a  s - j s + j  s - a s - j s + j

in which a and  are real constants. Find residues C1, C2 , and C3 in terms of a and  ,
and show that C1 is real. Use the labor-saving method directly, without first completing
the products in the form derived from an ODE.

2.9 Find the inverse Laplace transform f (t) , t  0, for the given function F(s) below.

First use partial-fraction expansion to express F(s) as a sum of simple quotients, and then
apply the appropriate inverse transformation equations. Also, find the values of any ze-
ros and poles of F(s).

(a) F (s) = s + 3              [Answer: f (t) = 1 (e-t + e-5t ), t  0]
              (s + 1)(s + 5)
                                                    2

(b) F (s) = 2(s + 1)           [Answer: f (t) = 1 + 4 e-3t - 3 e-4t , t  0]
              s(s + 3)(s + 4)           63     2

2.10 Derive the Laplace transform L[cos t] = s 2 +  2 s . Follow the same procedure,
with appropriate changes in details, as the derivation of L[sin t], Eq. (2-30). Show all

steps, just as in the derivation of L[sin  t].

2.11 Solution (2-22) of ODE problem (2-11) was derived by Laplace transformation, a
technique that is probably new to you, so you might be a little skeptical. To convince
yourself that (2-22) is indeed the correct solution of (2-11), substitute (2-22) back into the
ODE and IC of (2-11), and show that the original equations are satisfied. This method
can always be used to check the correctness of an ODE solution.

2.12 Consider the standard 1st order ODE x& - a x = b u(t) with IC x(0)  x0 . Use
Laplace transformation to solve for x(t) with the u(t) functions given below. It will ease
your algebraic burden greatly if you will make liberal use of the identities involving
complex numbers proved in homework Problems 2.3 and 2.4. Also, use where appropri-
ate the transforms of sin  t from Eq. (2-30) and cos t from Eq. (2-31) or homework
Problem 2.10.

                                  2-17
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

(a) Let u(t) = U sint , t > 0, where U is a constant amplitude.

at bU  at a                                                         
[Answer: x(t) = x0e + 2 2  e - sin t - cost  , t  0]
 +a                                                                 

(b) Let u(t) = U cost , t > 0, where U is a constant amplitude.

         [Answer: x(t) = x0eat +  2 + a 2 bU (aeat - a cost +  sint), t  0]

2.13 Suppose that t is a real number representing time, and that  is imaginary,  = j,
where  is real. Use the results of homework Problem 2.1 and, from calculus, the defini-
tions of the hyperbolic cosine, cosh  t , and the hyperbolic sine, sinh  t , to prove the
following: cos t = cosh  t , and sin  t  = sinh  t  .

2.14 For a mass-spring system with negligible damping, the appropriate ODE is Eq. (1-
18), m &x& + k x = f x (t) . Consider the case of this mass-spring system having imposed ini-
tial conditions at time t = 0, x(0) = x0 and x&(0) = v0 , and then after t = 0 being subjected
to constant force F, which we can express mathematically as f x (t) = F H (t) , or equiva-
lently, f (t) = F for t > 0 . In this application, unit-step function H (t) is used to remind

you that the Laplace transform is L[ f x (t)] = F s . (In fact, force F could have been ap-

plied even before t = 0, but that would be irrelevant because the initial conditions estab-
lish the state of the system at t = 0, regardless of whatever force acts before t = 0.) Your
task is to solve the problem by using Laplace transformation.

(a) First take the Laplace transform of the ODE, accounting for the ICs, and solve for the
transform of the output to find

L[x(t)]  X (s) = x0 2 2 s + 2 2 v0 n + F                            1
s + n n s + n m s(s + n )
                                                                 2     2

In this equation, we define the natural frequency of vibration, n = k m , from Eq. (1-
20). (See Section 1-10 for an explanation of the physical significance of n .) Show all
of your work leading to your result, as if the correct answer above were not given.

(b) In order to derive the inverse transform, L-1[ X (s)] = x(t) , you could, of course, find
partial-fraction expansions for each of the three terms in X (s) , then use the inverse
transform of the fundamental transform pair (2-15b), and, after much algebra, finally de-
rive an acceptable final algebraic equation for x(t). But this would be equivalent to re-
inventing the wheel, because people have been evaluating exactly the same inverse trans-
forms for the two centuries since Laplace developed the method. To preclude the neces-

2-18
Chapter 2 Complex numbers and arithmetic; Laplace transforms; partial-fraction expansion

sity for starting from scratch every time the same Laplace transform appears, the techni-
cal community has assembled tables of Laplace transform pairs in many handbooks and
textbooks, in symbolic software, and even on the Internet. Your assignment is to invert
X (s) and derive the complete algebraic equation for x(t), t  0. You can find explicitly

in Section 2-4 two of the three transform pairs in X (s) , but you are required to look up

the third pair in some source other than Chapter 2.

2.15 Apply MATLAB's residue operation to determine the partial-fraction expansion

of F (s) =     3s3 - 2s 2 + s        . Submit a copy of your MATLAB session, and also

            4- 2s + 3s + 4s + 5s + 632

write out the partial-fraction expansion in equation form (as in the example below). The

following example illustrates the residue operation for the polynomial ratio of Problem

2.9(b), F (s) = 2(s + 1) = 3 2 2(s + 1) . On the MATLAB command window,
                   s(s + 3)(s + 4) s + 7s + 12s

enter as arrays the coefficients of the numerator and denominator polynomials in de-

scending powers of s. Then enter the residue command to calculate the residues, poles,

and direct term (a constant or a term proportional to s raised to some positive power,

which appears only if m  n) of the expansion:

>> num=2*[1 1];den=[1 7 12 0]; [resids poles dterm]=residue(num,den)

resids =                       poles =         dterm =

-1.5000                        -4              []

1.3333                         -3

0.1667                               0

In equation form, F (s) =  -1.5 1.3333 0.1667 3  1  4  1  1  1 
                               +        +      = -  +  +  .
                           s - (-4) s - (-3) s - 0 2  s + 4  3  s + 3  6  s 

                                        2-19
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

   Chapter 3 Mechanical units; low-order mechanical systems; simple
                     transient responses of 1st order systems

                                 © 2016 by William L. Hallauer, Jr.

3-1 Common mechanical units

         We shall evaluate mechanical systems numerically using three different systems
of units that are common in the United States: International System, SI (based on kilo-
gram mass, meter, and second; kg-m-sec), traditional aeronautical (based on pound
force, foot, and second; lb-ft-sec), and traditional structural (based on pound force, inch,
and second; lb-inch-sec). Table 3-1 summarizes the units of mechanical quantities that
arise most often in this book.

Table 3-1 Common units of mechanical quantities

         Unit System   International System  Traditional aero-     Traditional struc-
Quantity               SI (kg-m-sec)         nautical (lb-ft-sec)  tural (lb-inch-sec)
                       kilogram mass (kg)    slug                  lb-sec2/inch
Mass (translational                          = lb-sec2/ft
inertia), m            meter (m)             foot (ft)             inch (in.)
Length, translational
motion                 second (sec)          second (sec)          second (sec)
Time, t

Force, translational   newton (N)            pound force (lb)      pound force (lb)
action                 = kg-m/sec2
Translational stiff-   N/m                   lb/ft                 lb/inch
ness constant, k
Translational damp-    N/(m/sec)             lb/(ft/sec)           lb/(inch/sec)
ing constant, c        = N-sec/m             = lb-sec/ft           = lb-sec/inch
Angle, rotational      radian (rad), which   radian (rad), which   radian (rad), which
motion                 is dimensionless      is dimensionless      is dimensionless
Rotational inertia, J  kg-m2                 slug-ft2              lb-sec2-inch
                                             = lb-sec2-ft
Moment or torque,      N-m                   lb-ft                 lb-inch
rotational action
Rotational stiffness   (N-m)/rad             (lb-ft)/rad           (lb-inch)/rad
constant, k            = N-m                 = lb-ft               = lb-inch
Rotational damping     (N-m)/(rad/sec)       (lb-ft)/(rad/sec)     (lb-inch)/(rad/sec)
constant, c            = N-m-sec             = lb-ft-sec           = lb-inch-sec

         SI is called an absolute system of units, and the other two are called gravitational

systems. Absolute and gravitational systems differ fundamentally in their primary and
derived units as defined in the context of Newton's 2nd law. In any absolute system, mass

                                            3-1
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

is a primary unit, along with length, and time, but force is a unit derived from those of

mass, length, and time. Thus, the SI force unit, the newton (N), is precisely defined from
F = ma, as a kilogram-meter/second2 (kg-m/s2). In any gravitational unit system, force is

considered to be a primary unit, and mass is a derived unit. Thus, from m = F/a, the mass

unit in the traditional aeronautical system, commonly called a slug, is precisely defined as
a pound-second2/foot (lb-sec2/ft). In all of these systems, the weight of an object on Earth

(in the force units) is defined as the mass times the standard sea-level gravitational accel-

eration, which is denoted as g, so W = mg. Table 3-2 includes the relevant values of g.

          Table 3-2 Standard sea-level gravitational acceleration

         Unit System  International System  Traditional aero-      Traditional struc-
Quantity
                      SI (kg-m-sec)         nautical (lb-ft-sec)   tural (lb-inch-sec)
Standard accelera-    9.807 m/sec2          32.17 ft/sec2          386.1 inch/sec2
tion of gravity, g

Table 3-3 Prefixes for units

Multiple  Prefix  Letter prefix           It is often convenient in technical notation to
   109    giga          G        use prefixes that indicate powers of ten. For example,
   106    mega          M        a force of 456,700 N can also be written as 456.7 ×
   103    kilo           k       103 N, or in more economical form as 456.7 kN,
   102    hecto          h       where kN denotes a kilo-newton = 103 N. Table 3-3
          deka          da       includes a standard set of prefixes used in dynamics
   10     deci           d       of mechanical systems. We also use the "e" notation
  10-1    centi          c       that is becoming standard for input to and output from
  10-2    milli         m        computer programs. Thus, for examples, the 456.7
  10-3    micro                  kN force can be expressed as 456.7e3 (or e03, e+03,
  10-6    nano           n       e+003, etc.) N, and a length of 4.321 mm can be
  10-9                           expressed as 4.321e-3 (or e-03, e-003, etc.) m.

3-2 Calculation of mass from measured weight

         This practically important process is straightforward for the traditional aeronauti-
cal and structural unit systems, but we can be confused when working in the SI system if
the particular sensor used measures weight in the kilogram force (kgf) unit. Let's con-
sider an example: suppose we have a laboratory scale with two different modes of
weight measurement, pound force (lb) and kilogram force (kgf). We place an object on
the scale with the display set to the lb mode, and the reading is W = 15.50 lb. We next
change the display to the kgf mode, and the reading changes to W = 7.031 kgf. Let's cal-
culate the mass in the three different unit systems using m = W g .

lb-inch-sec system: m =  15.50 lb          2 = 0.04015  lb - sec2   4.015e-2  lb - sec2

                         386.1 inch / sec               inch                  inch

                                           3-2
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

lb-ft-sec system: m = 2 15.50 lb = 0.4818 slug  4.818e-1 slug  4.818 deci-slug
                           32.17 ft / sec

For the SI calculation, we need to recognize that the kgf is not a consistent SI force unit,
even though many weight scales sold and used in the United States have been calibrated
in this unit since the 19th century. The only consistent SI force unit is the newton (N). So

let's ignore the W = 7.031 kgf reading for now and use, instead, the W = 15.50 lb reading
in association with the well-known conversion, 1 lb = 4.448 N:

                15.50 lb × 4.448 N
                               2 lb = 2 68.95 N = 7.031 kg
SI system: m =  9.807 m / sec       9.807 m / sec

So, in the SI system, the mass in kg has the same numerical value as the weight in kgf,
which, in the future, will relieve us from having to calculate a conversion. This equality
is precisely true only at elevations on Earth where g is exactly 9.807 m/sec2, but it is
close enough for most engineering calculations using weights measured anywhere on
Earth's surface.

3-3 Reaction wheel: a rotational 1st order system

         Reaction wheels are used for attitude control of spacecraft. The principal compo-
nent of a reaction wheel is a rotor, the "wheel," which is normally either not spinning or
spinning at a constant nonzero rotational velocity. When a motor increases or decreases
the rotational velocity from the normal value, a control moment is imposed upon the ve-
hicle to which the reaction wheel is attached.

                                       Bearings             W heel
                Electric motor                                   Shaft

                                                                        Rotation
                                                                        angle (t)

                                                                        Bearings

                                    Frame

Figure 3-1 Laboratory reaction-wheel assembly: photograph at left, schematic
drawing at right

         The reaction-wheel assembly drawn in Fig. 3-1 is a small laboratory device used
in experimental research. Its basic functioning is the same as that of a flight-qualified
reaction-wheel assembly. The rotating members are the wheel, the shaft, and the rotor of
the motor. We denote their combined rotational inertia about the shaft axis as J, also
called moment of inertia. The shaft is held in bearings, which are lubricated, but

                                    3-3
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

nevertheless impose a drag moment. The rotation angle of the rotating members is
denoted  (t) , and it is represented graphically in Fig. 3-1 by a double-headed arrow and

the right-hand rule giving the polarity of rotation. The rotational velocity (angular
velocity, spin rate) is denoted &(t)  p(t) , a symbol commonly used for angular velocity

in aeronautical applications.

         We will idealize the drag moment as having the linear viscous form c × p(t) ,

where c is the rotational viscous damping constant, which can be measured on real
hardware. Also, we will denote as Mm(t) the torque imposed on the rotating members by
the electric motor, this torque being an independent input quantity.

         The drawing below is the free-body diagram (FBD) of all moments (torques in
this case) acting on the rotating members, with the bearing drag shown as a single torque,
even though it is actually distributed over all bearing surfaces:

                                                    Rotational inertia J

Motor torque Mm(t)

                                                         (t), p(t)

                                                                  Bearing drag
                                                                  torque c × p(t)

In order to derive the equation of motion, we write Newton's 2nd law for rotation about
the shaft axis, based upon the FBD:

(Moments)about shaft axis = (rotational inertia) × (rotational acceleration)about shaft axis;

       M m (t) - c p = J p&  J p& + c p = M m (t)                                 (3-1)

Converting (3-1) into the standard 1st order form gives

 c  1                                                    c          1
p& -  -  p = M m (t)  p& - a p = bM m (t) where a = - and b =                     (3-2)
 J J                                                     J          J

3-4 Simple transient responses of 1st order systems, 1st order time constant and
settling time

         The adjective transient applies to system response that is dynamic for a finite time
interval (often called the settling time), but is essentially static thereafter.

         Consider the 1st order problem presented in Chapter 2,

                    3-4
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

                x& - a x = bU e-wt , x(0) = x0 , solve for x(t), t > 0 (2-11, repeated)

with solution,

                x(t) = x0eat + bU (eat - e-wt ), for t  0            (2-22, repeated)

                                 a+w

     If we let w = 0, then the input term becomes the step function, U [e-wt ] w=0 =

U H (t) = U for t > 0 , H (t) being the Heaviside unit-step function defined in Section 2-

4. So the problem and solution become:

                x& - ax = bU , x(0) = x0 , solve for x(t), t > 0

                x(t) = bU (1 - e-(-a)t )+ x0e-(-a)t , for t  0       (3-3)

                       (-a)

In Eq. (3-3), we write a = -(-a) because usually a < 0 for engineering systems, as in Eq.
(3-2). We want to consider two special cases of solution (3-3): (1) pure initial condition
response for U = 0; and (2) pure step response for x0 = 0.

Stable initial condition (IC) response                               (3-4)
                                        x(t) = x0e-(-a)t , for t  0

Define the 1st order-system time constant,

                1  1                                                 (3-5)
                      (-a)

For example, the time constant for the reaction wheel from (3-2) is 1  J . You should
                                                                                        c

satisfy yourself, using Table 3-1 if necessary, that the quantity J c has the dimension of
time (unit of second). With this definition of time constant 1 , solution (3-4) becomes:

                x(t) = x0e- t 1  x0 exp(- t 1 ) , for t  0           (3-6)

                3-5
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

         Figure 3-2 is a graph of exponential decay indicated in Eq. (3-6).

      x0                    0.368x0
x(t)
                                     0.135x0
                                               0.050x0                 0.018x0

0                     0  1           21        31       41             t

                      Figure 3-2 1st order initial-condition response

At the time constant, t = 1 , the response has decayed to e-1 = 37% of the initial value.
The other time "milestone" to which we shall often refer is t = 41 , which we call the set-
tling time, at which time the response has decayed to e-4 = 2% of the initial value. For
most practical engineering purposes, this settling time is considered to be the time re-
quired for the response essentially to reach its final steady-state value, which is x = 0 in
this case of IC response. Mathematically, x  0 only as t  .

         If the constant a is positive, then we write IC solution (3-4) as x(t) = x0eat . The
mathematical response represented by this solution is unbounded: x   as t  . In
reality, no engineering variable will ever become infinite: as the variable becomes large,
something in the system will fail or overload, or the system will become nonlinear, or the
response will be limited by a governor, etc. Even though the actual response will not be-
come infinite, an exponentially increasing linear mathematical response such as this is
usually undesirable for practical purposes; an engineering system that exhibits this kind
of response is considered to be unstable. On the other hand, an engineering system with
negative constant a is stable.

        The time constant 1 is such an important quantity for stable 1st order systems that
we shall re-cast the standard 1st order system ODE in terms of 1 , rather than constant a,
using Eq. (3-5). Thus, rather than analyzing Eq. (1-1), x& - a x = b u(t) , hereafter we shall
usually consider the following standard stable form for 1st order systems:

                            x& + 1 x = b u(t)                                   (3-7)
                               1

Stable step response

In Eq. (3-3), we set x0 = 0 and use time constant definition (3-5) to obtain    (3-8)

       x(t) = bU1 (1 - e- t 1 )  bU1[1 - exp(- t 1 )], for t  0

                                     3-6
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

         Figure 3-3 is a graph of the exponential rise to a positive final value that is indi-
cated in Eq. (3-8).

   bU1                                 0.950bU1 0.982bU1
x(t)                     0.865bU1
            0.632bU1
      0
         0  1       21   31                     41                   t

            Figure 3-3 1st order step response

The final value of unit-step response is bU1 , and it is approached asymptotically as
t  . At the time constant, t = 1 , the response has risen from the IC of zero to 1 - e-1
= 63% of the final value. At t = 41 , the settling time, the response has risen to 1 - e-4 =
98% of the final value.

         Step response solutions such as (3-8) are usually an approximation to the actual
response since, in reality, a pure, discontinuous step change in a physical input quantity is
rarely achievable. Nevertheless, step input is a sufficiently close approximation to many
real physical inputs that step response solutions such as (3-8) are close approximations to
actual physical responses.

         Consider again the reaction wheel of the previous section. Let's denote a step in-
put from the motor as Mm(t) = M × H(t). Then ODE (3-2) becomes

p& - a p = bM m (t) = bM H (t) = bM for t > 0, where a = - c = - 1 and b = 1   (3-9)
                                                J 1                     J

So the time constant is 1 = -1 a = J c , and solution (3-8) becomes

p(t) = bM1(1- e- t 1 ) = 1 M J (1- e- t 1 ) = M (1- e- t 1 )rad/sec, for t  0  (3-10)
               J c       c

Note that in this case we adapt the "standard" mathematical solution (3-8) to a particular
physical problem. This approach is common in system dynamics. In other words, it is
not always necessary to solve an ODE for every new physical problem; if a standard
ODE solution has already been derived, you may just adapt that standard solution to the
physical problem at hand, rather than re-deriving the ODE solution.

                    3-7
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

3-5 Aileron-induced rolling of an airplane or missile

         The principal source for the aerodynamic theory of this section is Nelson, 1989,
pages 19-20, 153-156 and 250-260. The aerodynamic rolling moment on an airplane or
missile is written in standard aeronautical notation as

                       L(t) = L  (t) + L p(t)  L  (t) + Lp p(t)                          (3-11)
                                             p

(There is a notational ambiguity between moment L(t) and the Laplace transform operator
L[ f (t) ] introduced in Chapter 2; such ambiguities are unavoidable in technical work, so

you should become accustomed to them.) The roll (bank) angle (in radians) is  (t) , de-

fined here as being positive clockwise as seen by an observer behind the vehicle, in other
words, rightward rolling (Fig. 3-4). In Eq. (3-11),  (t) is the input aileron deflection

angle (in radians) to produce rolling, the right aileron being deflected upward and the left
aileron being deflected downward to produce a positive roll rate, p(t)  & (rad/sec).

                                             L(t), roll moment

                                             (t), roll angle                 (t), aileron angle
                                             p(t), roll rate

                  ½ b

                                                A                              View A-A

                                 View from aft A
                       Figure 3-4 Aileron-induced rolling of an airplane

         The dimensional aerodynamic derivatives in (3-11) are related to dimensionless
coefficients by:

                       L = qSbC > 0                lb - ft N - m                         (3-12)
                                                                or         
                                                   rad rad 

                       b              qSb2              lb - ft N - m 
                  Lp = qSb Cp =              Cp < 0                 or                   (3-13)
                       2V             2V                rad/sec rad/sec 

The constants in Eqs. (3-12) and (3-13) are defined as:

q  =  1  V 2  is  the  free-stream  dynamic  pressure  (lb/ft2  or  N/m2)
      2

                                             3-8
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

 is air density (slug/ft3 or kg/m3)

V is the free-stream airspeed (ft/sec or m/sec)
S is the wing planform area (ft2 or m2)

b is the full wing span (ft or m)
C > 0 is the dimensionless aerodynamic stability moment coefficient (rad-1), rolling
moment due to aileron deflection (a function of Mach number)
C p < 0 is the dimensionless aerodynamic stability moment coefficient (rad-1), roll damp-
ing due to roll rate (a function of Mach number).

         The term b 2V in Eq. (3-13), the damping moment due to roll rate, merits some
explanation. The clockwise rolling velocity of the right wingtip is p × b 2 , so the addi-

                                               V, airstream velocity

 Right-hand wing          Total velocity vector
 tip, viewed looking
 toward the root        pb
                        2 V
pb/2, rolling velocity

Figure 3-5 Angle of attack induced by rolling velocity

                                                                                     -1  pb / 2  pb
tional angle of attack induced at the wingtip by the roll rate is tan    , a

                                                                                        V  2V
small angle (the magnitude of the angle is exaggerated in Fig. 3-5, just to improve clar-
ity). Thus, b p(t) in Eqs. (3-13) and (3-11) plays the same role as that of  (t) in Eqs.

              2V

(3-12) and (3-11).

        Newton's 2nd law equation of motion for rolling is J&&  J p& = L(t) , in which J
(slug-ft2 or kg-m2) is the rotational inertia of the vehicle about its rolling axis. This
equation is based upon the assumption that the vehicle can only roll (i.e., no coupling
with other degrees of freedom such as sideslip and yaw). Substituting Eqs. (3-11)-(3-13)
into Newton's law gives:

J p& = L  + Lp p  J p& - Lp p = L 

                        3-9
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

                 - Lp             - Lp  L               - Lp  2V  C 
                                                                    
          p& +   p =    (t) =     (t)                                           (3-14)
                 J   J  - Lp                            J  b  -Cp 

Writing (3-14) in 1st order standard form (3-7) gives [with b in (3-7) temporarily replaced
by B to reduce notational ambiguity]:

                                         p& + 1 p = B (t)                       (3-15)
                                             1

in which we have, respectively, time constant 1 and constant B:

                     1 = J = 22VJ = 2 4 J > 0                                   (3-16)
                          - Lp qSb (-C p ) VSb (-C p )

                    - Lp  2V  C  1 2V  C  q SbC
             B=   =                                   =                    > 0  (3-17)
                      J        b      -  Cp    1  b    -  Cp     J
                                                               

Example 3-1: Use the results of this section and the general 1st order step response Eq.
(3-8) to calculate rolling response to a  (t) = 2.5° H (t) step aileron input for a hypotheti-

cal medium-sized civilian transport airplane. The following are representative data: ro-
tational inertia about the rolling axis is J = 4.0e5 slug-ft2, wing planform area is S = 1,100
ft2, and wing span is b = 90 ft; for flight at 10,000 ft altitude and free-stream airspeed V =

350 ft/sec, aerodynamic dimensionless rolling-moment coefficients are C = 0.061 per

radian and C p = -0.34 per radian. At 10,000 ft altitude, standard air density is  =
0.001755 slug/ft3 (Nelson, 1989, p. 248).

                      V  2                       slug  ft 2 lb
             q  =  1        =    1  ×1.755e - 3   3 × 350         = 107.5 2
                   2             2               ft  sec                   ft

Lp = qSb C p = × 2 107.5 lb ft 2 ×1,100 ft 2 × (90 ft)2 (- 0.34 rad-1 ) = -4.65e5 lb - ft
         2V                    2 × 350 ft sec                                   rad/sec

                     1 =      J     =    4.0e5 lb - sec2 - ft  = 0.86 sec

                            - Lp 4.65e5 lb - sec - ft rad

(Comments regarding units: Angle is a dimensionless quantity, so the radian, which is

the fundamental metric of angle, is unitless. In the calculation above for Lp , all of the

units shown, including radian, balance in the final result to give the correct resulting unit,

lb - ft ; it is important to recognize this unit as opposed, for example, to lb - ft ,
rad/sec                                                                         deg/sec

                                               3-10
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

which would be the case if C p were given per degree. However, in calculations that pro-

duce results which are not angular quantities, such as 1 above, the radian must be recog-
nized as unitless, and it should not appear in the units of the final numerical result. This
is a general characteristic that can confuse us when we check to make certain that units of
numerical answers are correct.)

           1 2V  C                     1     2 × 350 ft sec 0.061 rad-1
       B=          =                      ×         ×                          -1 = 1.62 sec  -2

           1   b      -  Cp    0.86 sec      90 ft                   0.34 rad
                             

From Eq. (3-8), the roll-rate response to the 2.5° step input is

     p(t) = BU1[1 - exp(- t 1 )] = 1.62 sec-2 × 2.5 deg × 0.86 sec × (1 - e- t (0.86 sec) )

                             p(t) = 3.5 [1 - exp(-1.16t)]degrees

                                                                sec

The time constant is 1 = 0.86 sec , and the steady-state roll rate of 3.5 deg sec is essen-
tially achieved in the settling time of 41 = 3.44 sec .

3-6 Translational spring and viscous damper (dashpot)

       The linear translation spring was introduced in Section 1-9 as the mechanical ele-

ment connecting a mass to a rigid wall; for that simple case, the end of the spring at-

       xa (t)                  xb (t)        tached to the wall was stationary. Now,
                                             let's consider the more general case in

                                             which both ends of the spring can move,

                                             as indicated in Fig. 3.7. The force f x (t)
fx(t)                        fx (t) = k(xb - xa ) required to deform the spring by the

Figure 3-7 Ideal linear spring with          amount xb (t) - xa (t) , relative to the unde-

stiffness constant k                         formed length of the spring, is propor-

                                             tional to the deformation. With the con-

stant of proportionality denoted as k, the more general spring law is

                                       f x (t) = k[xb (t) - xa (t)]                               (3-18)

The standard sign convention defines stretching of the spring as positive, xb - xa > 0 ,
corresponding to tensile force, f x (t) > 0 ; accordingly, compression is negative in the
standard convention. Equation (3-18) clearly accommodates both tension and compres-
sion of the spring. Occasionally, however, it is convenient to define compression as
positive, as is illustrated in Example 3-4 in the next section.

                                             3-11
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

         With the spring end forces equal and opposite as shown in Fig. 3-7, we have ne-
glected the inertial force of the spring. Inertial forces are terms such as m × a , mass
times acceleration, in Newton's 2nd law. In this case, the inertial force of the spring is
ms × &x&s , in which ms is the mass of the spring, and &x&s is acceleration of the spring's cen-

ter of mass. So neglecting inertial forces means we assume they are negligibly small in
comparison with the force of Eq. (3-18). Notice that this does not strictly mean we are
neglecting the mass, because even a tiny mass, when multiplied by a large acceleration,
can produce a non-negligible inertial force. It is common to neglect the inertial forces of
springs, but we should remember when doing so that we are really assuming both the in-
ertias are small and the accelerations are sufficiently slow.

       A dashpot (mechanical viscous damper) is a discrete component that resists trans-

lational velocity. An idealized linear, viscous damper is represented graphically by a

piston-cylinder assembly, Fig. 3-8. This device opposes relative velocity between piston

and cylinder. With the forces on the dashpot defined to be positive in tension, as shown

       xp (t), x&p (t)  xc (t), x&c (t)         on Fig. 3-8, the linear damping law is

                                                f x (t) = c[x&c (t) - x& p (t)] (3-19)

fx(t)                   fx (t) = c(x&c - x&p )

                                                in which c is the damping constant. The

piston cylinder                                 damping constant plays the same role for a

Figure 3-8 Ideal linear, viscous dashpot        dashpot here that it plays in Chapter 1
with damping constant c                         [Fig. 1-1 and Eq. (1-2)] for a block sliding
                                                on a viscous liquid film. If we were to

define the forces to be positive in compression, then we would have to reverse the signs

in the damping law, Eq. (3-19); it is sometimes appropriate to do so, as in Example 3-4 in

the next section.

         With the cylinder and piston forces equal and opposite as shown in Fig. 3-8, we
have neglected the inertial forces of the cylinder and piston. It is common to neglect the
inertial forces of dashpots, but we should remember when doing so that we are really as-
suming that both the inertias are small and the accelerations are sufficiently slow. On the
other hand, in Example 3-4 of the next section, inertial forces of a piston-cylinder
assembly are not neglected.

         The idealized dashpot model of Fig. 3-8 and Eq. (3-19) is convenient for linear
mathematical analysis because of its simplicity. It is assumed to resist motion between
piston and cylinder by means of the drag force produced by a viscous fluid boundary
layer between the two solid objects. We can use the simple dashpot to model approxi-
mately real devices such as door dampers and shock absorbers. However, it is not a pre-
cise model for most real damping devices. In most real translational dampers, a piston
forces fluid through an orifice within a cylinder, and this generates a major portion of the
resisting force. Unfortunately for the purposes of linear mathematical analysis, the re-
sisting force is a complex and highly nonlinear function of the relative motion between
piston and cylinder.

                                         3-12
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

3-7 More examples of damped mechanical systems

         Let's consider next some combinations of dashpots with springs and masses. In
each case, we will draw the physical device, draw appropriate free-body diagrams, and
then derive the equations of motion. Force f x (t) is considered to be an independent in-
put quantity in all of these examples.

Example 3-2: Mass-damper-spring system, Fig. 3-9

Newton's 2nd law for translation of the mass: m &x& = f x (t) - c x& - k x

    ODE : m &x& + c x& + k x = f x (t)                                           (3-20)

   x(t)                                                     FBD of mass

k                               kx

                   fx(t)                                                  fx(t)
   m                                                        m

                                                       cx&
c

   Figure 3-9 Mass-damper-spring system

Example 3-3: Ideal shock strut, parallel damper-spring system, Fig. 3-10

         This combination is very similar to the mass-damper-spring system, except the
inertial force of the mass (now considered just a rigid link) is assumed to be negligible.

   k x(t)                            FBD of link
                  fx(t)
                                kx
                                                     fx(t)

                                               cx&
           c
   Figure 3-10 Parallel damper-spring system

Newton's 2nd law for translation of the link: m&x&  0 = f x (t) - c x& - k x

    ODE : c x& + k x = f x (t)                                                   (3-21)

Note that Eq. (3-21) is a typical 1st order LTI ODE, but now the unknown quantity is
translation (position) x(t) of the rigid link.

                          3-13
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

Example 3-4: Series combination of mass, dashpot, and spring, Fig. 3-11

         For the examples above, it is not necessary to draw separate FBDs of the spring
and of the dashpot's piston and cylinder. However, it is necessary to draw separate FBDs
for systems such as that of Fig. 3-11, where dashpot and spring are arranged in series, not
in parallel, and, for variety and generality, the inertial forces of the dashpot's piston and
cylinder are considered to be significant, not negligible. Take notice of the component
interaction forces fc and fk; note especially that piston-cylinder interaction force fc is
shown as an equal and opposite pair, as required by Newton's 3rd law.

Mechanical system                Component FBDs
                                                 xc(t)
xp(t)  xc(t)                                                                     xc(t)
                                                                                  k fk
             mp        fx(t) mp                             mc
fx(t) c mc k
                                 fc                                        fk

       Figure 3-11 Example series mass-dashpot-spring

Newton's 2nd law for translation of the dashpot piston: m p &x&p = f x (t) - fc
Newton's 2nd law for translation of the dashpot cylinder: mc &x&c = fc - fk

Damper law: fc = c (x& p - x&c )

Spring law: fk = k xc

Combining equations of motion and damper/spring laws gives:                      (3-22a)
                                      m p &x&p + c x& p - c x&c = f x (t)

                       mc &x&c - c x& p + c x&c + k xc = 0                       (3-22b)

Equations (3-22) are a pair of coupled 2nd order ODEs in the two dependent variables
xp(t) and xc(t). Thus, the system of Fig. 3-11 is a 4th order system. The dynamic response
of a particular class of 4th order systems is discussed Chapter 12. However, this book
does not address the dynamic response of general 4th order and higher-order systems; that

is a subject of more advanced textbooks such as Ogata, 1998, Chapter 10.

Example 3-5: Series damper-spring systems--idealized mechanical filters, Fig. 3-12

         For both of the series damper-spring combinations in Fig. 3-12, we specify the
known input quantity to be translation xi(t), which is produced by an idealized motor that
is capable of dictating a commanded displacement regardless of the force required. The

                       3-14
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

output quantity in each case is translation xo(t). The damper and spring masses are as-
sumed here to be negligible, which cannot be valid for all practical circumstances; there-
fore, these are idealized, not real, mechanical systems. But these idealized systems are
worth studying because they have significant dynamic characteristics that will be the
subjects of subsequent parts of this book.

Low-pass filter                                              High-pass filter

xi(t)  xo(t)                                                 xi(t) xo(t)

fx(t) k c                 fx(t) c k

Figure 3-12 Series damper-spring idealized mechanical filters

         The governing ODE for the low-pass filter,                 xi(t)      xo(t)
with spring and damper masses idealized to be negli-      k(xo - xi)            c(0 - x&o )
gible, is derived easily from the FBD at right of the
series combination consisting of the spring and the
damper piston: k(xo - xi ) = c(0 - x&o ) . Therefore the
ODE for the low-pass filter is

       x&o + 1 xo = 1 xi (t), 1  c                                             (3-23)
                 1  1                                     k

The mathematical derivation and description of low-pass-filter characteristics will follow
in later chapters, but it is appropriate here to describe the practical nature of the low-pass
filter with use of the low-pass filter drawing in Fig. 3-12 and physical intuition. Imagine
that the input translation xi(t) is a steady oscillation at a fixed frequency. If that fre-
quency is very low, so that translational velocity is low, then the damper resisting force
cx&o will be very small and, consequently, both the spring and the damper piston will
move slowly back and forth in unison by about the same distance as the input translation,
xo(t)  xi(t). On the other hand, if the frequency of oscillation is very high, then the
damper resisting force cx&o will be great, so the input oscillatory translation xi(t) will com-
press and stretch the spring but the damper piston will act almost like a rigid wall, i.e.,
xo(t)  0. For frequencies of oscillation between very low and very high, our intuition
suggests that the output motion amplitude [the maximum of oscillatory xo(t)] will be
between the two extremes of the input motion amplitude and zero motion. The low-pass
filter is so named because it "passes" through, without much alteration, low-frequency in-
puts, but it "blocks" high-frequency inputs.

         Derivation of the governing ODE for the damper-spring high-pass filter is left for
homework Problem 3.7. The result is:

                    3-15
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

   x&o + 1 xo = x&i (t), 1  c                      (3-24)
   1                         k

As is done above for the damper-spring low-pass-filter, it is appropriate to describe the
practical nature of the high-pass filter with use of the high-pass filter drawing in Fig. 3-12
and physical intuition. Imagine that the input translation xi(t) is a steady oscillation at a
fixed frequency. If that frequency is very low, so that translational velocity is low, then
the damper resisting force c(x&i - x&o ) will be very small; consequently, the damper piston
will move slowly back and forth within the cylinder by about the same distance as the
input translation; but very little force will be imposed upon the cylinder and spring, so the
spring will be deformed hardly at all, xo(t)  0. On the other hand, if the frequency of os-
cillation is very high, then the damper resisting force c(x&i - x&o ) will be great, so the pis-
ton and cylinder will appear to become a single rigid body, and most of the input transla-
tion will be transmitted through the damper, xo(t)  xi(t), to compress and stretch the
spring. For frequencies of oscillation between very low and very high, our intuition sug-
gests that the output motion amplitude will be between the two extremes of zero motion
and the input motion amplitude. The high-pass filter is so named because it "blocks"
low-frequency inputs, but it "passes" through, without much alteration, high-frequency
inputs.

         The damper-spring high-pass filter system is said to have right-hand-side (RHS)
dynamics due to the explicit derivative of the input translation, x&i , on the RHS of ODE
(3-24). Therefore, Eq. (3-24) does not have the standard stable 1st order form of Eq. (3-
7), x& + (1 1)x = bu(t) , with the input u(t) on the RHS, but none of its derivatives. For
standard forms such as Eq. (3-7), many readily available mathematical response solutions

exist, e.g., step response Eq. (3-8). But that is not the case for non-standard forms, so the

non-standard character might be considered inconvenient. However, there is a process
that converts non-standard ODE (3-24) into standard form.1 We define the difference

variable xd(t):

   xd (t) = xo (t) - xi (t)                        (3-25)

Differentiating Eq. (3-25) and substituting the result into Eq. (3-24) leads to the following
standard-form ODE for xd(t) plus the auxiliary equation required to retrieve the desired
output xo(t) from solution xd(t) of the ODE:

x&d + 1 xd = - 1 xi (t), xo (t) = xd (t) + xi (t)  (3-26)
1  1

1 The process shown here for a 1st order ODE is the simplest form of a more general process that can be
applied to system ODEs of any order having RHS dynamics; see the textbook by Brogan, 1974, pages 174-
177.

                                                   3-16
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

3-8 Homework problems for Chapter 3
3.1 Consider the reaction-wheel assembly described in Section 3-3. The rotor has been
carefully machined to have rotational inertia J = 2.56e-3 lb-sec2-inch. We wish to de-
termine the viscous damping constant c of the bearings by indirect experimental
measurement. We feed electric current into the motor and spin up the rotor to a high
speed. Then we shut off the motor, allowing the wheel to spin down freely. With an op-
tical tachometer, we measure the spin-down rotational speed at one instant to be 4,000
revolutions per minute (rpm). Exactly 20.0 seconds later, we measure the speed to be
1,010 rpm. From these data, calculate c in consistent lb-sec-inch units.
3.2 Given: an LTI reaction-wheel assembly, with unknown rotational inertia J and un-
known rotational viscous damping constant c associated with drag of the bearings.
Your task is to calculate J and c from experimental measurement. Starting with the
wheel at rest (motionless), a motor torque in the form of a step is imposed upon the
wheel, M m (t) = M × H (t) , where M = 1.5 N-m. The resulting spin rate p(t) of the wheel
is measured, in radians/second, and its time history for the first 10 seconds of spin-up is
recorded on the following graph.

Use the data from the graph to calculate (with as much precision as possible, given the
graphical nature of the data) the values of J and c in consistent SI units.
3.3 The weight of an ocean surface ship is denoted as W, and the acceleration of gravity
in consistent units is g. The resistance to low-velocity motion of the ship is modeled as
being proportional to velocity, with viscous damping constant c. The ship is initially at
rest when, at time t = 0, a tugboat begins pushing it with constant force F. Write alge-
braic equations (in terms of the given parameters, all assumed to be in consistent units)
for velocity v(t) and distance traveled x(t).

                                                   3-17
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

3.4 Nominal data (Nelson, 1989, p. 260) for the Boeing 747 civilian transport airplane
are: rotational inertia about the rolling axis J = 18.2e6 slug-ft2, wing planform area S =
5,500 ft2, and wing span b = 195.68 ft. For flight at Mach number 0.25 and at sea level

altitude, nominal aerodynamic dimensionless coefficients relevant to uncoupled rolling

are C = 0.0461 per radian and C p = -0.450 per radian. At sea level, air density is  =

0.002377 slug/ft3, and Mach number 0.25 corresponds to free-stream airspeed V = 279.0

ft/sec.

(a) Calculate the dimensional aerodynamic derivatives L (in lb-ft/rad) and Lp (in lb-ft
per rad/sec), then calculate the 1st order system time constant 1 .

(b) Suppose that the 747 is in level flight with zero initial roll rate, p(0) = 0, when the
pilot cycles the ailerons through one complete sinusoid with amplitude 10° over a period

of 5 seconds:  (t) = 10°sin(0.4 t), 0  t  5 sec. Calculate the roll rate p (in degrees

per sec) at the end of the 5-second period. Don't develop any new theoretical solutions
for this problem; just adapt to this problem the result of Problem 1.5(a). Your intuition
might suggest that roll rate is zero at the end of the aileron cycling, since the total aileron
"impulse" is zero, but you should find that roll rate is not zero.

3.5 The A-4 Skyhawk was a durable and versatile small (17.5-24.5 klb) fighter-bomber-

                                         trainer that first flew in 1954

Wing planform      Wingspan              and was still used in military
area, S = 260 ft2                        operations, with updated tech-

                   b = 27.5 ft           nology, in the 1990s (Light-

                                         body et al., 1990, pp. 104-111).

                                         The relevant mass and geome-

                                         try data for one model are:

                                         rolling rotational inertia J =
                                         8,090 slug-ft2; wing planform
                                         area S = 260 ft2; wing span b =

                                         27.5 ft. A flight test of this air-

                                         plane is conducted at sea level

Planform sketch of A4D fighter airplane  and Mach number 0.4, for
                                         which the air density is  =

0.002377 slug/ft3 and the free-stream velocity is V = 446.6 ft/sec. Starting from straight

and level flight, the pilot at time t = 0 sec abruptly actuates the ailerons to +5° deflection,

producing a step input that rolls the airplane clockwise. The resulting roll rate is sensed

by a rate gyroscope, digitized, and recorded. The data are analyzed, and it is found that

the following equation fits the data very well: &(t) = p(t) = 50.0(1 - e-1.667t ) degrees/sec.

(a) Use the measured roll rate to perform parameter identification, specifically to deter-
mine values for the two roll aerodynamic stability coefficients C p and C , both dimen-
sionless. Begin by calculating time constant 1 of the response, then use that to calculate
aerodynamic derivative Lp , then use that to calculate C p . Having these values, you can

                   3-18
Chapter 3 Mechanical units; low-order mechanical systems; transient responses of 1st order systems

now use the steady-state roll rate to calculate C . Check the units of your calculations to
make certain that your final calculated coefficients are, in fact, dimensionless.

(b) Given that  (0) = 0 (level flight), derive an equation for  (t) in degrees, t  0.
Evaluate that equation to calculate the bank angles at t = 1 (one time constant) and at t
= 41 ( steady-state roll rate).

3.6 Sketch (carefully) the appropriate free-body diagrams for the mechanical system

drawn below. The dashpot's damping coefficient is c, its cylinder is fixed to the wall,

         xp(t) x(t) and its piston has mass mp. Next, use the
                                          FBDs and appropriate linear laws for the

mp                          m  spring and dashpot to derive the ODEs that
  c mc k
                               fx(t) describe the motion of this system in terms of
                               dependent variables xp(t) and x(t). Note that

                               the spring stretch is x - xp, so the tensile force

Series mass-dashpot-spring system developed in the spring is k(x - xp). Do not

                               neglect the inertial forces of the dashpot's

piston and of the block with mass m, which rolls without friction. Force fx(t) is an inde-

pendent input quantity.

3.7 The LTI damper-spring high-pass filter of Fig. 3-12 is repeated below. In this

xi(t) xo(t)                    problem, neglect inertial forces of the damper and the
                               spring. Input xi(t) is translation of the damper piston,

                               generated by some displacement-controlling motor.

fx(t) c                  k     Output xo(t) is translation of the damper cylinder and

                               spring end. Sketch an appropriate free-body diagram

(or more than one), then write equilibrium equation(s) from which you derive the ODE

1x&o + xo = 1x&i , which has right-hand-side (RHS) dynamics. Express time constant 1

in terms of damper constant c and spring constant k. (Hint: recognize that piston force

fx(t) shown is a dependent variable, related to independent input xi(t) and output xo(t), but

fx(t) should not appear in the equation of motion.)

                               3-19
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

Chapter 4 Frequency response of 1st order systems; transfer functions;
           general method for derivation of frequency response

© 2016 by William L. Hallauer, Jr.

4-1 Definition of frequency response

         We now consider system excitation that varies with time sinusoidally, as either
sin t or cost , and persists for an indefinitely long duration. The frequency of excita-

tion is  radians/sec, or  2 Hz (for hertz, which means cycles/sec, named for German

physicist and engineer Heinrich Rudolf Hertz, 1857-1894). After any transients due to
initial conditions have decayed away, a stable linear system responds in the same
sinusoidal fashion. That is, the steady-state response of a stable linear system to sinusoi-

dal excitation also varies sinusoidally, as either sin(t +  ) or cos(t +  ), where the fre-

quency  is the same as the excitation frequency, and  is a phase angle. This steady-
state sinusoidal response is generally called frequency response. Although the frequency
of response is the same as that of excitation, the magnitude of response can vary greatly
for different excitation frequencies; therefore, in order to prevent the overloading of a
system, it is important to know the frequencies of excitation to which the system is most
sensitive.

         Both mathematical and experimental analyses of system frequency response are
common in engineering practice. We shall study the basic methods of mathematical
analysis. The two primary unknowns in the analysis are the magnitude and phase of re-
sponse as functions of excitation frequency. We can consider the excitation to vary as
either sin t or cost ; the steady-state frequency response magnitude and phase are the

same in either case. For consistency, we will consider primarily cost excitation.

4-2 Response of a 1st order system to a suddenly applied cosine, cos  t

         First, we derive a complete solution in the conventional manner for the original
standard 1st order ODE x& - a x = bu(t) [Eq. (1-1)], with IC x(0) = x0 , and with the sud-
denly applied (at t = 0) cosine input u(t) = U cost , t > 0, where U is a constant ampli-

tude [Problem 2.12(b)].

ODE + IC: x& - ax = bU cost = bU      e jt + e - jt  , x(0) = x0 , find x(t) for t > 0  (4-1)

                                      2

Laplace transformation of ODE + IC: sX (s) - x0 - aX (s) =  bU  1 +  1 
                                                                       2  s - j s + j 

                                      4-1
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

                Solve for X(s): X (s) = x0 +  bU 1  1 +  1 
                                           s - a 2 (s - a)  s - j s + j 

Completed partial-fraction expansion (Problem 2.8):

X (s) = x0 + 2 2  bU 1  2a + - a - j +  - a + j 
        s - a 2 a +   s - a s - j s + j 

                           bU  at 1                                               - j t 
Inverse transform: x(t) = x0e + 2 2 ae + ((-a - j)e + (-a + j)e )atj t

                        a +                 2                                     

     at  bU  at 1                              j t  - j t        e jt - e - jt 
 x(t) = x0e + 2 2 ae +  (-a)(e + e ) +                                         
         a +                  2                                  j 

 x(t) = x0eat + a 2 +  2 bU (aeat - a cost +  sin t ), t  0

     at  b                 U       at                        
 x(t) = x0e +                 2 - e + cost +  sin t , t  0                        (4-2)
         -a                                                 -a 
                 1 +   
                   - a  

         Next, we adapt solution (4-2) of general 1st order problem (4-1) to the damper-
spring system (ideal shock strut) of Fig. 3-9 with suddenly applied cosine force input
f x (t) = F cost , for which the comparable ODE + IC problem is

cx& + k x = F cost , x(0) = x0 , find position x(t) for t > 0                     (4-3)

Comparing (4-3) with (4-1), we define U  F, then the other constants of the standard
equation become

a = - k  - 1  time constant 1  1 = c and b = 1 and b = 1
c 1                                 -a k                    c             -a k

 x(t) = x0 e- t 1 + F      1          e- t  1  +    cos  t  + 1  sin t),  t    0  (4-4)

         k            1 +  (1 )2  (-
                                  

         It is instructive to study the physical nature of response (4-4) in the context of a
specific numerical example. Consider an ideal shock strut with the initial condition x0 =
-2 m, and with the system parameters c = 1  N/(m/sec) = 0.3183 N-sec/m and k = 1
N/m, so that time constant 1 = 1  sec = 0.3183 sec. Let the magnitude of the cosine

                              4-2
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

force be F = 1.5 N, and let the period of the cosine be Tp = 1 sec/cycle. Therefore, the
cyclic frequency is f = 1 Hz (cycle/sec), and the circular frequency is  = 2 radians/sec.
(Period, frequency, and phase of periodic signals are discussed more generally in Section
4-4.) The numerical solution of Eq. (4-4) with these parameters for time 0  t  3 sec is
calculated and graphed in the following MATLAB operations.
MATLAB M-file script:

%MATLABdemo41.m
%Damper-spring ideal shock strut response to IC + cosine forcing
c=1/pi;k=1; %system viscous damping & stiffness constants, SI units
F=1.5;Tp=1; %cosine forcing: amplitude (N), period (sec)
xo=-2; %initial displacement (m)
w=2*pi/Tp; %circular frequency of cosine forcing (rad/sec)
t1=c/k;denom=1+(w*t1)^2;
t=0:0.01:3*Tp; %time instants for forced response
fx=F*cos(w*t);
x=(xo-(F/k)/denom)*exp(-t/t1)+(F/k)/denom*(cos(w*t)+w*t1*sin(w*t));
plot(t,fx,'k',t,x,'k.'),grid,xlabel('Time t (sec)'),...

 ylabel('Force input f_x(t) (N) and displacement output x(t) (m)'),...
 title('Time response of an ideal shock strut to IC + cosine input')

MATLAB command/responses:

>> MATLABdemo41

         The graph of input f x (t) and response x(t) is below (after figure editing in MAT-
LAB,Version 6 or later, to flatten the aspect ratio and to distinguish the two curves).

                                                    4-3
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

Let's observe from the graph some important features of the response:

* As calculated above, the time constant of the exponential decay terms in Eq. (4-4) [the
two terms involving exp(- t 1) ] is 1 = 0.3183 sec, so the settling time for those terms
is 41 = 1.273 sec. In other words, the exponential decay terms in x(t) have essentially
vanished after about 1.3 sec of response, and this is clear from the graph. Because the
exponential decay terms are relatively short-lived, we often refer to them as the "tran-
sient" part of the total solution.

* After the exponential decay terms have vanished, only the cost and sin t terms of
Eq. (4-4) remain. It appears from the graph that those two terms combine to make a sin-
gle sinusoid at frequency , and that the remaining steady-state x(t) sinusoid is displaced
in time by a constant time lag from the f x (t) sinusoid. This steady-state sinusoidal re-
sponse is what we call the frequency response, and we will derive equations that describe
it explicitly in the remainder of the chapter.

4-3 Frequency response of the 1st order damper-spring system

         To extract the steady-state sinusoidal response xss (t) from total response equation
(4-4), we drop the transient, exponential decay terms:

xss (t) =  F  2  1 (cost + 1 sin t)                                         (4-5)

         k 1 + (1 ) 

         We can write (4-5) in a form that is more physically expressive by using some al-
gebraic manipulation and the general trigonometric identity,

cos × cos - sin × sin = cos( +  )                                           (4-6)

The algebraic manipulation involves the sinusoidally varying terms of (4-5). For gener-
ality, let's assume that each term is multiplied by a general coefficient, C or -S, so that
those terms can be written and manipulated as

2 2                                                   C                S
C cost - S sin t = C + S cost                               - sin t     
                                                                       2 2
                                              C +S    2  2           C +S 

Now we identify the coefficients of cost and sin t inside parentheses as themselves

representing trigonometric functions:    C  cos and            S  sin , where
                                       C2 + S2              C2 + S2

angle  is given by a four-quadrant tangent function,

                                         4-4
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

                                                        -1  S 
C2 + S2                       = tan                                      (4-7)
                 S C
      
     C                  These trigonometric relations are illustrated at left on the draw-
                        ing of a right triangle.

So, with identity (4-6), the trigonometric sum becomes

C cost - S sin t = C 2 + S 2 (cost cos - sin t sin  ) = C 2 + S 2 cos(t +  ) (4-8)

Associating (4-5) with (4-8), we have C = 1, S = -1 . Therefore, (4-5) becomes

                 xss (t) =  F  2  1  1 + (1 )2 cos(t +  )

                          k 1 + (1 ) 

           F  1                                                 -1 - 1 
xss (t) =               cos(t +  )  X () cos(t + ()), () = tan          (4-9)
           k 1 + (1 )2                                          1

Let's compare the steady-state response (output), xss (t) of Eq. (4-9), with the excitation
(input), f x (t) = F cost . The magnitude of response, which is a function of excitation
frequency , is

                        X () = F 1                                       (4-10)
                                 k 1 + (1 )2

We will often deal with the magnitude ratio, defined as the magnitude of response di-
vided by the magnitude of excitation,

                        X () = 1 1                                       (4-11)
                          F k 1 + (1 )2

The phase (or phase angle, since it is an angle in radians or degrees) of response relative
to the phase of the excitation is also a function of excitation frequency :

                         () = tan -1 (-1 )                               (4-12)

In general, if phase angle  is positive, 0° <  < 180°, it is called a phase lead, because
the peaks and zeros of the response occur in time before those of the excitation. If phase
angle  is negative, -180°   < 0°, it is called a phase lag, because the peaks and zeros
of the response occur in time after those of the excitation. The response is said to be in-

                        4-5
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

phase if  = 0° exactly, and out-of-phase if  = -180° exactly. For the standard stable 1st
order system considered presently,  () = tan -1 (-1 ) , which is a phase lag, always
negative in the 4th quadrant, -90° <  < 0°, with   0° for very small  and   -90°
for very large .

         The frequency-response function (abbreviated FRF) is considered to consist of
both the magnitude ratio, Eq. (4-11) in this case, and the phase angle, Eq. (4-12) in this
case. We will see later that both of these functions can be expressed together in a
mathematical equation as a single complex function of frequency. It is common in engi-
neering practice to plot these two real functions of frequency  on a pair of over-and-un-
der graphs in the format of Fig. 4-1, which represents Eqs. (4-11) and (4-12) specifically.
This format is a type of Bode diagram (after Hendrik Wade Bode, American mathemati-
cian, physicist, and control-system engineer, 1905-1982).

               1
               k
           11
 X () 2 k
   F

0      b  1 1  

    0

0°

  () -45°

           -90°

  Figure 4-1 Frequency-response function of 1st order damper-spring system

The break frequency b  1 1 is shown explicitly on Fig. 4-1. There is no obvious
"break" in the curves of Fig. 4-1; but a break does indeed exist, the form of which will be
revealed in the following discussion.

         To represent frequency response over broad bands of frequency, the magnitude
ratio and phase are often plotted versus the logarithm of frequency. Moreover, to allow
the possibility of very large dynamic ranges of magnitude response, the magnitude ratio
itself is often plotted on a logarithmic scale, making the magnitude ratio a log-log graph,
where "log" denotes logarithm to the base 10. On such a graph, it is often possible to
construct straight-line asymptotes that are useful for describing the variation with fre-
quency of the magnitude. To illustrate this for the 1st order system, we re-write (4-11) as

       4-6
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

a dimensionless ratio and, for clarity of expression, use the definition b  1 1 , and then
take the logarithm:

        X () = 1 = 1 = 1                                   (4-13a)
        F / k 1 + (1 )2 1 + ( / b )2 1 + ( f / fb )2

 X ()           1              1    2 1   f 2
                              
log    = log                    = - log1 +    = - log1 +    (4-13b)
 F/k            1 + (  /b )2    2   b            2   fb  

In the last versions on the right-hand sides of Eqs. (4-13a and b), we have used   2 f
and b  2 fb in order to express the equation in terms of cyclic frequency. The low-
frequency asymptote is the limit of (4-13b) as the frequency  0 from above:

                         X ()  1
                limlog           = - log(1) = 0            (4-14)
                0  F / k  2

The high-frequency asymptote is the limit of (4-13b) as the frequency   from below:

          X ()  1   2                            f
     lim log     = - log   = - log  = - log                (4-15)
       F / k  2  b                    b           fb 

Figure 4-2 on the next page is a log-log graph of Eqs. (4-13) that shows the asymptotes
(4-14) and (4-15). Notice that on the log-log scale, the low-frequency asymptote is a
good approximation for the actual function at frequencies f < fb, and the high-frequency
asymptote is a good approximation for the actual function at frequencies f > fb. The
intersection of the two asymptotes is called the break (or corner) because it is a change in
slope of the asymptotic approximations to the actual function. The break (or corner)
frequency is denoted fb. For this 1st order system at fb = b 2 = 1 (21 ) , the

magnitude of response is reduced to 1 2 of its static (f = 0) value, and the phase is -45°

(see also Fig. 4-1).

         The high-frequency asymptote on Fig. 4-2 merits some additional comment. Note
that its slope on the log-log scale equals -1, i.e., the magnitude shrinks one decade (order
of magnitude) for each decade increase in the frequency. Frequency response magnitude
ratios are often given in decibels (dB), especially in acoustics for sound pressure level. A
magnitude ratio in decibels is defined to be 20 × log(magnitude ratio). If the magnitude
ratio on Fig. 4-2 had been plotted in decibels versus log(frequency), then the slope of the
high-frequency asymptote would be -20; this is often referred to as a 20 dB/decade roll-
off of the magnitude ratio.

                                4-7
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

         Another observation worth making, especially from Fig. 4-2, is that the standard
1st order system considered here behaves like a mild low-pass filter: the system responds
most sensitively to excitation at frequencies below the break frequency, the magnitude of
response being about equal to the static response. However, at excitation frequencies
above the break frequency, the system responds much less sensitively, and the magnitude
of response diminishes progressively as the excitation frequency increases.

   X          X Low-frequency asymptote                    Break point
log         F / k Eq. (4-14)
             1 0.707                                          High-frequency asymptote
   F /k                                                       Eq. (4-15)
-0.151 0                                   Eq. (4-13)

        -1  0.1

-2 0.01

-3 0.001                                               fb  10fb  100fb f (Hz)
                0.001fb 0.01fb 0.1fb

                  -3 -2 -1 0 1 2 log   f 
                                                   st  fb 

Figure 4-2 Log-log magnitude ratio of 1 order damper-spring system

4-4 Period, frequency, and phase of periodic signals

         Let's consider more generally the temporal quantities of periodic signals, repre-
sented in our applications by sinusoids. Period Tp is normally measured in seconds per
cycle, so the cyclic frequency f in cycles per second is the inverse of period, f = 1 Tp .
Also, the period is related to the circular frequency  by Tp = 2 radians, so that

            2   rad                                                cycles 
circular frequency =  2 f , and cyclicfrequency f = Hz            (4-16)
            Tp  sec                                              2  sec 

These relationships between period and frequency are worth understanding completely
and even memorizing, as we use them a great deal in system dynamics.

         It is important also to understand how FRF phase is manifested in time history
plots of input and output. This discussion is general, applicable for any LTI system. Sup-
pose that there are plotted on the same graph steady-state sinusoidal time histories of both
the input u(t) and the output x(t), as in Fig. 4-3 on the next page. We want to calculate

                     4-8
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

the FRF phase from measurements on the time-history plots. First, find the nearest posi-
tive x(t) crest to the left of a reference positive u(t) crest, as shown on Fig. 4-3. Measure
the positive time interval Tlead in seconds that x(t) leads u(t). (Note that you can measure
Tlead also by comparing troughs or positive-going or negative-going zeros, as shown on
Fig. 4-3.)

                                                        Tp
                          Tlead

                                                       u(t) = U cost

            Tlead                  Tlead

    tcrest                                                    time t

                                                Tlead
     x(t) = X cos( t + )

Figure 4-3 Frequency response phase measurement from time-history graphs

         Now, referring to the positive crests, let's denote as tcrest the instant corresponding
to a positive crest of input u(t). Then we see from the drawing that

                cos tcrest = +1   tcrest = 2 n, where n is some integer

               cos( [tcrest - Tlead] + ) = +1   [ tcrest - Tlead] +  = 2 n

Comparing these two equations shows that [- Tlead] +  = 0, which gives the basic
equation for phase angle (defined positive as a lead, negative as a lag):

 = Tlead = 2 Tlead = 2 Tlead rad × 360 deg = 360 × Tlead deg  (4-17a)
Tp                 Tp       2 rad  Tp

where Tp (= 2  = 1 f ) is the period of the input and the steady-state output, as shown
on Fig. 4-3.

         If you choose to select the nearest positive x(t) crest to the right of a reference
u(t) crest, then you are finding time lag Tlag , which is a negative lead. In this case, you
can find the phase angle, with the correct sign, from

     = -Tlag = -360 × Tlag deg                                (4-17b)
                             Tp

                       4-9
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

        Equations (4-17) give  in the range 0°   < 360°, which is correct but not com-
mon. It is not common because the four-quadrant arctangent is conventionally expressed
(in MATLAB, for example) in the range -180°   < +180°. Therefore, if you measure
and calculate by the procedure above a phase   +180°, then it is conventional to re-
place that  with ( - 360°). For example, if you were to measure and calculate the
phase  = 262°, then it would be conventional to express it as a phase lag,  = (262° -
360°) = -98°, rather than a phase lead of 262°.

4-5 Easy derivation of the complex frequency-response function for standard stable
1st order systems

         This section is an example of a much easier method (than that of Sections 4-2 and
4-3) for deriving the frequency-response function of a system. Let's find the frequency
response of standard stable 1st order systems. From Eq. (3-7) the standard stable ODE
with sinusoidal excitation is

                                 x& + (1 1 ) x = b u(t) = bU cost

We seek steady-state sinusoidal response xss (t) = X () cos(t + ()), in which X ()

and () are functions to be found. The first step in the method is to take the general
[for arbitrary u(t)] Laplace transform, setting the IC to zero:

(s + 1 1 )L[x(t)] x =0 = bL[u(t)]
                                                 0

Next, we form the system general transfer function, TF (s) , defined as the ratio of the
output transform to the input transform, with zero IC:

TF (s)  L[x(t)] x0 =0 = b
            L[u(t)] s + 1 1

         The Laplace independent variable s is complex in general. However, in order to
analyze frequency response, we let s in TF(s) be purely imaginary, s = j ( being the
real circular frequency), producing the complex frequency-response function FRF():

TF (s) s= j  TF ( j)  FRF () = b = b1 1                     (4-18a)
      1 1 + j                                       1 + j1

Next, with use of Eqs. (2-4)-(2-7), we convert TF(j)  FRF() algebraically into polar
form:

4-10
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

FRF () = b1  1 1 - j1       = b1           1 + (1 )2  -1 -  1 
             ×                                       2 exp j tan   
             1 + j1 1 - j1                 1 + (1 )               1 
                                                                      (4-18b)

 FRF () e jFRF () =     b 1 e j ()
                     1 + (1 )2

in which phase angle () = tan -1 (- 1 1) = tan -1 (-1 ) .

        Equations (4-18) define the complex frequency-response function, FRF(), of
standard stable 1st order systems. It is proved in Sections 4-6 and 4-7 for LTI systems in
general that the real magnitude FRF() of function FRF() is the magnitude ratio of

system frequency response, and the phase angle () of function FRF() is the phase

angle of system frequency response. For example, let's adapt standard solution (4-18b)
to the damper-spring system, for which [from Eq. (4-3)] b = 1 c and 1 = c k . Thus, the
magnitude of FRF() from (4-18b) is

             FRF () = X () = b1 = 1 1                                 (4-19)
                 U          1 + (1 )2 k 1 + (1 )2

which is identical to damper-spring system FRF magnitude ratio X () F of Eq. (4-11).
Also, the phase angle of FRF() from (4-18b) is

                 FRF () = () = tan -1 (-1 )                           (4-20)

which is identical to damper-spring system FRF phase () of Eq. (4-12). Thus, with
FRF() of Eq. (4-18b), we have obtained here the same final results as before for the
damper-spring system, but much more easily.

4-6 Transfer function, general definition

         For any LTI, single-input-single-output (SISO) physical system, we denote the
input as u(t) and the output as x(t). For an nth order system, in general, the input and out-

put are related by an ODE of the form

d n x d n-1 x                              d mu      d m-1u
a1 n + a2 n-1 + K + an+1 x = b1 m + b2 m-1 + K + bm+1u                (4-21)
dt           dt                            dt        dt

a1,K, an+1 and b1,K,bm+1 are constants (with the numbering system keyed to MATLAB
notation), and m  n. Also, we assume that the system is stable, which is defined more
precisely in Section 4-7. Taking the Laplace transform of the ODE, with all ICs equal to
zero, gives

                            4-11
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

(a1s n + a2 s n-1 + K + an+1 )L[x(t)] ICs=0 = (b1s m + b2 s m-1 + K + bm+1 )L[u(t)] (4-22)

Then, from (4-22), the system transfer function, defined to be the ratio of the output
transform to the input transform, with zero ICs, is the ratio of two polynomials,

TF (s)   L[x(t)] ICs=0 b1s m + b2 s m-1 + K + bm+1
         = n n-1                                                            (4-23)
         L[u(t)] a1s + a2s + K + an+1

         It is appropriate to state here (without proof) that the transfer function of any
physically realizable system has m  n, i.e., the degree of the numerator polynomial is
less than or equal to the degree of the denominator polynomial. The condition m  n
makes the transfer function causal, which means that the current (in time) output of the
system is dependent only upon past and present (not future) values of the input. In gen-
eral, the future values of an input cannot be predicted, so it is logical that a real system
and its transfer function must be causal. See Bélanger, 1995, page 440.

         Note also from Eq. (4-23) that, if given TF(s) and input u(t), we can express the
transform of the output with zero initial conditions as

         L[x(t)] ICs=0 = TF (s) × L[u(t)]                                   (4-24)

4-7 Frequency-response function from transfer function, general derivation

         For frequency response of a general LTI SISO stable system, we define the input
to be a time-varying cosine, with amplitude U and circular frequency ,

u(t) = U cost = U (e jt + e- jt )                                           (4-25)

                     2

in which we apply the complex exponential form for the cosine that is derived from
Euler's equation (Problem 2.1). The Laplace transform of input (4-25) is

         L[u(t)] =  U  1 +  1                                               (4-26)

                    2  s - j s + j 

Substituting (4-23) and (4-26) into (4-24) gives

L[x(t)] ICs=0 =  n n-1   b1s   +  m + b2 s m-1 + K + bm+1  U  1 1           (4-27)

                a1s + a2 s + K + an+1  2  s - j s + j 

By expanding into partial fractions, we will usually be able to cast (4-27) into the form

         4-12
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

L[x(t)] ICs=0 =                     A        B  n Ck
                                       +        +                (4-28)
                                    s - j s + j k=1 s - pk

in which A, B, Ck , and pk [the poles of TF(s)] all are constants. Taking the inverse
transform of (4-28) gives

                                                  n              (4-29)

x(t) = Ae jt + Be- jt +  Ck e pk t
                                                 k =1

         The first two right-hand-side terms of (4-29) are associated with steady-state
forced sinusoidal response, and the third term is associated with response bounded by real
exponential functions. The nature of system stability is determined by the poles pk , in
particular, by their real parts. If Re[ pk ] < 0 for all k = 1, 2, ..., n, then each of the e pk t
terms is bounded by a decaying exponential, that is, e pk t  0 as t  . A system for
which Re[ pk ] < 0 for all k is said to be stable. Therefore, for steady-state sinusoidal
response (after all exponentially bounded transients have decayed) of a stable system,
only the first two right-hand-side terms of (4-29) remain,

xss (t) = Ae jt + Be- jt                                         (4-30)

         Our objective now is to find the complex constants A and B in (4-30). The first
step is to recognize that xss (t) must be a real function mathematically; that is, in order to
represent actual physical behavior, (4-30) cannot have any imaginary component. From
Problem 2.5, we conclude that B must be the complex conjugate of A, i.e., B = A .
Therefore, (4-30) becomes

xss (t) = Ae jt + Ae- jt                                         (4-31)

The Laplace transform of (4-31) is

L[xss (t)] = A + A                                               (4-32)

            s - j s + j

Recognizing that we seek only constant A for the steady-state sinusoidal response (not
any of the Ck constants associated with transient response), we now combine (4-32) and
(4-26) into (4-24),

L[xss (t)] = A + A = TF (s)  U  1 +  1                           (4-33)
s - j s + j                                     2  s - j s + j 

                                       4-13
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

To find complex constant A and its conjugate, we use the labor-saving method for partial-
fraction expansion from Chapter 2,

    U 1                    1                               U
A = (s - j )TF (s)   +                                      = TF ( j)     (4-34)
    2  s - j s + j  s= j 2
  

    U 1                    1                               U
A = (s + j )TF (s)   +      = TF (- j)                                    (4-35)
    2  s - j s + j  s=- j 2


Comparing (4-34) and (4-35) shows that                                    (4-36)
                                       TF (- j) = TF ( j)

So now we can denote the transfer function terms in general polar form:   (4-37)

           TF ( j) = TF ( j) e j() , where the phase is  () = [TF ( j )]

    TF (- j ) = TF ( j ) e- j ( )                                         (4-38)

Substituting (4-37), (4-38), (4-34), and (4-35) back into (4-31) gives

xss (t) = Ae jt + Ae - jt = U TF ( j) {e j(t+ ()) + e- j(t+ ())}          (4-39)

                               2

Applying again the formula from Euler's equation that relates the cosine to complex ex-
ponentials gives the desired final result,

    xss (t) = U TF ( j) cos(t + ())                                       (4-40)
          X () cos(t + ())

in which X () and () are, respectively, the amplitude (magnitude) and phase of the
steady-state sinusoidal response. Note that TF ( j) = X () U , the magnitude ratio.

        Therefore, we define the complex frequency-response function FRF() to be
TF(j), (4-37). Expressing FRF() in polar form gives us the FRF magnitude ratio and
phase directly, and relatively easily (without all the work of finding the particular solu-
tion of the ODE by the method of undetermined coefficients, or of finding the complete
time response by forward and inverse Laplace transformation, etc.):

    FRF ( )  TF ( j ) = X ( ) e j()                                       (4-41)
                                U

         This result is general for LTI SISO systems, it is valid for all of the systems con-
sidered in this book, and it is widely used in engineering practice.

                     4-14
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

4-8 Homework problems for Chapter 4
4.1 This problem involves the data and results for the 1st order damper-spring system that
is analyzed in Section 4-2 with use of MATLAB program MATLABdemo41.
(a) Substitute the damper-spring data and the given values of F and  into Eqs. (4-10)
and (4-12) in order to calculate the magnitude X and phase angle  (in degrees, in the
range -180°   < +180°) of the frequency response.
(b) Examine the time history graph generated by MATLAB program MATLABdemo41.
The purpose of this problem is for you to evaluate that graph as if it were recorded from
an experiment. Consider, in particular, the time after about t = 1.3 sec, when the output
has settled into steady-state sinusoidal response. Measure from the graph the steady-state
output magnitude X. Measure whatever information is required from the graph, then cal-
culate phase angle  (in degrees, in the range -180°   < +180°) of the steady-state state
response. These simulated experimental results for X and  should be equal to (or at least
close to, since it is not possible to make precise measurements from a graph) the compa-
rable results calculated in part (a) from theoretical formulas.
4.2 An experimental frequency response test is conducted on an LTI system (not neces-
sarily a 1st order system), with input u(t) = U cost and output x(t) = X cos(t + ) . A
simulated graph [(a) or (b) or (c), whichever is assigned] of the steady-state input and
output quantities at one particular frequency is shown below or on the next page. Cal-
culate from the graph, with as much accuracy as the data permits, the following values:
(i) the sinusoidal period Tp, and then the frequency (in both Hz and rad/sec), (ii) the FRF
magnitude ratio X U (assume consistent physical units), and (iii) the FRF phase  (in
degrees, in the range -180°   < +180°).
(a)

                                                   4-15
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

(b)

(c)

4.3 The governing ODE of the series damper-spring low-pass filter in Fig. 3-12 is Eq. (3-
23), 1x&o + xo = xi (t) . Show that the associated 1st order complex frequency-response
function is FRF () = TF ( j) = 1 (1 + j1) . The following MATLAB script graphs
from this equation the FRF magnitude ratio and phase in one conventional format (log-
log for magnitude ratio, semilog for phase in degrees, magnitude ratio graph directly over
phase graph), for the case of time constant 1 = 0.0145 sec, with excitation frequencies
ranging from 1 Hz to 1,000 Hz. Note that MATLAB does most of the work for you if
you start with the complex FRF, and then use MATLAB's capability for performing
complex arithmetic. In particular, the MATLAB function abs calculates the absolute
value (magnitude) of a complex number, and the MATLAB function angle calculates the
angle in radians of a complex number.

                                                   4-16
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

t1=0.0145; % First-order system time constant (sec)
f=logspace(0,3,200);w=2*pi*f; % 200 pts. 1 Hz-1 kHz evenly spaced on log scale
FRF=1./(1+j*w*t1); % complex FRF; note necessity of array operation ./
magrat=abs(FRF);fazdeg=angle(FRF)*180/pi; % magnitude ratio and phase in deg
subplot(2,1,1),loglog(f,magrat,'k'),grid,ylabel('FRF magnitude ratio'), ...
title('FRF of 1st order system with time constant = 0.0145 sec')
subplot(2,1,2),semilogx(f,fazdeg,'k'),grid, ...
ylabel('FRF phase (deg)'),xlabel('Frequency (Hz)')

Run this script on your computer, and submit the graphs that it produces. Additionally,
(a) calculate the break frequency fb = 1/(21 ) and show that it matches the break fre-

quency inferred from the MATLAB graphs; (b) use complex arithmetic to evaluate by
hand (and hand calculator) the complex FRF, FRF () = 1 , at frequency f = 30

                                                                    1 + j1
Hz, and show that your hand-calculated magnitude ratio and phase match those of MAT-
LAB. You might have occasion to do more graphing of FRFs, so, for your future refer-
ence, make sure that you understand the operations of all the MATLAB commands in the
above script.

4.4 The governing ODE of the series damper-spring high-pass filter in Fig. 3-12 is Eq.
(3-24), x&o + (1 1 )xo = x&i (t) [see also homework Problem 3.7].

(a) Show that the associated 1st order high-pass filter complex frequency-response func-
tion is FRF () = j1 (1 + j1 ) .

(b) For frequency response, we are evaluating the input in the form xi (t) = X i cost
and the output in the form xo (t) = X o cos(t + ) . Use the FRF of part (a) to show that
the equations for FRF magnitude ratio and phase are

X o () = 1 , () =  - tan -1(1 ) = tan -1   1 
Xi  1 + (1 )2  2      1 

Use this magnitude ratio equation to derive equations for the low-frequency and high-fre-
quency asymptotes, and sketch those asymptotes on a log-log graph such as Fig. 4-2.
You may use the definition of break frequency, b = 1 1 , so that 1 =  b = f fb .

This system has the character of a mild high-pass filter, so your sketch of the asymptotes
should have the appearance appropriate to that name.

(c) Let the time constant 1 = 1 sec, and consider the excitation frequency range 0.01 
  100 rad/sec (10-2    10+2 rad/sec). Adapt the MATLAB program, and use the
graphical format provided in homework Problem 4.3 to graph with MATLAB the FRF
magnitude ratio and phase (in degrees). As is done in Problem 4.3, program directly the
complex FRF, in this case FRF () = j1 (1 + j1) , not the equations of part (c).

               4-17
Chapter 4 Frequency response of 1st order systems; transfer functions; derivation of freq. response

4.5 A standard LTI mass-damper-spring system has the ordinary differential equation of
motion m&x& + cx& + k x = f x (t) , in which f x (t) is the input and x(t) is the output.

(a) Use the ODE to derive the transfer function TF (s)  L[x(t)] ICs=0 L[ f x (t)] for the m-

c-k system. This transfer function is an algebraic equation in terms of independent
variable s and constants m, c, and k.
(b) Use transfer function TF(s) to derive the complex frequency-response function
FRF() for the m-c-k system in terms of independent variable frequency  and constants
m, c, and k.
(c) From FRF() for the m-c-k system, write equations in terms of independent variable
frequency  and constants m, c, and k for the real magnitude ratio FRF () and the real
phase angle FRF() = () .

                                                   4-18
                     Chapter 5 Basic electrical components and circuits

     Chapter 5 Basic electrical components and circuits

                     © 2016 by William L. Hallauer, Jr.

5-1 Introduction

         Electrical circuits are systems that have many dynamic response characteristics in
common with mechanical systems. But electrical variables (voltage, current, charge) and
circuits are quite different physically than mechanical variables and systems, and the
physical laws and methods for deriving ordinary differential equations that describe be-
haviors of electrical circuits also are entirely different. This chapter is an introduction to
the theory of electrical circuits and basic analog electronics, and to some common but
simple practical applications of the theory. The material presented here provides the ba-
sis for many examples of system dynamic behavior in later chapters.

         Many engineering students in fields other than electrical engineering are exposed
to electrical theory only in a required introductory physics course. This presentation is
designed for such engineers who, nevertheless, have applications for simple circuits and
electronics. For example, almost every engineer who works with electromechanical sys-
tems will at some time require at least the background in circuits and electronics that is
presented in this chapter. The same is true for almost every engineer who uses sensors of
any kind, or is involved with testing of prototypes or products in the laboratory or in the
field. Even the process of logically evaluating for possible purchase the capabilities and
specifications of modern electronic instrumentation requires more sophistication with cir-
cuits and electronics than a student can acquire from an introductory physics course.

5-2 Passive components: resistor, capacitor, and inductor

         We denote the electrical potential, the voltage in volts (V) SI units, at a point in a
circuit as e(t), and the flow of positively charged particles, the electrical current in amps
(A) SI units, as i(t). These two electrical quantities are the principal variables that will
appear in derivations of the ODEs describing the dynamic behavior of circuits.

   The circuit drawn in Fig. 5-1 depicts an ideal linear resistor, with resistance R

ohms (usually denoted by the upper-case omega, ) in SI units. The voltage difference

   e1 R e2           e1 - e2 between the positive and negative terminals of a battery
                     causes current i to flow through the resistor. The material of the

+                    resistor is an electrical conductor, but a poor conductor that

                     provides much more resistance to current flow than a good con-

- i                  ductor such as copper wire. This resistance converts part of the
                     electrical energy into heat energy, causing the resistor's tem-

Figure 5-1 Resistor  perature to rise slightly. For a standard, commercially pro-
in a simple circuit  duced resistor, the relationship between e1 - e2 and i is linear,
                     with resistance R defined as the constant of proportionality

(Halliday and Resnick, 1960, Sections 31-2 and 31-3). This relationship is known as

                     5-1
                Chapter 5 Basic electrical components and circuits

Ohm's law (after German physicist Georg Simon Ohm, 1787-1854), and it is usually
expressed in one of the following two forms:

                   e1 - e2 = iR  i = e1 - e2                                       (5-1)
                                                R

Equation (5-1) applies at each instant, even if the voltages and the current are varying
with time.

         Note from Ohm's law the unit equivalence  = V/A; this relation giving the ohm
in terms of the volt and the amp is useful for establishing correct units in calculations.
Suppose, for example, that a 10-volt difference is imposed across a 5 k resistor, typical
numbers for instrumentation circuits. Then, from (5-1), the current through the resistor is
i = 3 10 V = 2e-3 A  2 mA.

    5 ×10 V A

         The following two examples serve to introduce a fundamental physical principle
for electrical circuits, Kirchhoff's current law (abbreviated "KCL", after German
physicist Gustav Robert Kirchhoff, 1824-1887), and to illustrate applications of KCL.

Electricity Example 5-1: Given resistors R1 and R2 arranged in series, as in the figure

below, find the equivalent single resistance Req.

e1 R1 e2 R2 e3     e1 Req e3                       From the figure and Eq. (5-1),

                =                                  i1 = e1 - e2 , i2 = e2 - e3 , i = e1 - e3

i1  i2             i                               R1               R2             Req

The form of KCL relevant to this situation is: the quantity of current is continuous in a
series arrangement, so that i1 = i2  i . [This continuity condition for electrical current is
directly analogous to the continuity condition for an incompressible fluid: the volume
flow rate (average velocity × cross-sectional area) remains constant at all points along a
flow tube or channel.] The total voltage change is the sum of the individual changes,

                e1 - e3 = (e1 - e2 ) + (e2 - e3 ) = i1R1 + i2 R2 = i(R1 + R2 )

                 i = e1 - e3  Req = R1 + R2
                           R1 + R2

The resistance of a series combination of resistors is the sum of the individual resistances.

                              5-2
                      Chapter 5 Basic electrical components and circuits

Electricity Example 5-2: Given resistors R1 and R2 arranged in parallel, as in the figure

below, find the equivalent single resistance Req.

            R1                                     In this case, there are circuit junctions

                                                   on both sides of the parallel resistors.
       e1 i1 e2 e1 Req e2 The more general KCL applicable here
                              =                    is: the quantity of current leaving a
i               i2    i
                                     i             junction equals the quantity of current

            R2                                     entering the junction, so that i1 + i2 = i .

                                                   The voltage difference is the same

across each of the parallel resistors, so KCL in terms of voltage differences is

       e1 - e2 + e1 - e2 = e1 - e2  1 + 1 = 1 = R1 + R2  Req = R1R2
       R1       R2       Req         R1 R2 Req R1R2                       R1 + R2

The equivalent (effective) resistance is less than the smaller of the two parallel resis-
tances.

       The circuit drawn in Fig. 5-2 depicts a linear capacitor, with capacitance C farad

(F) in SI units. A voltage generator produces the possibly time-varying voltage differ-

       e1(t) C e2(t)     ence e1 - e2 across the capacitor. The graphical symbol
                         representing the capacitor depicts two plates separated by a

e1(t)                    dielectric (insulating) material. If there is a voltage difference

                         between the plates of such a component, a positive electrical

e2(t) i(t)               charge +q coulombs (SI unit) appears on one plate, and a
                         negative electrical charge -q coulombs appears on the other

Figure 5-2 Capacitor     plate (Halliday and Resnick, 1960, Section 30-2). The quan-
in a simple circuit      tity of charge q is proportional to the voltage difference, with
                         capacitance C defined as the constant of proportionality:

                                     q = C(e1 - e2 )                               (5-2)

         If the voltage difference is constant, then the charge on the plates remains con-
stant, so that there is no flow of charged particles, i.e., no current, which is the variation
with time of the charge: i(t) = dq . However, if the voltage varies with time, then cur-

                                       dt
rent flows through the circuit in proportion with the derivative of the voltage difference:

                         i(t) = dq = C d (e1 - e2 ) = C(e&1 - e&2 )                (5-3)
                                 dt     dt

Conversely, the voltage difference across the capacitor can be expressed in terms of the
current by integrating (5-3) from initial time t0 (when ICs are assumed to be known) to
arbitrary time t > t0 :

                                        5-3
Chapter 5 Basic electrical components and circuits

[ ]  =t  =t d (e1 - e2 )
 i( ) d = C                              d = C (e1 - e2 ) t - (e1 - e2 ) t
 =t0  =t0 d 0

                                           1  =t                                   (5-4)

 e1 (t) - e2 (t) = e1 (t0 ) - e2 (t0 ) +  i( ) d

                                          C  =t0

Note from Eq. (5-3) the unit equivalence A = F × V  F = A - sec ; this
                                                                sec             V

relation for the farad in terms of the amp, the volt, and the second is useful for clarifying

units in calculations. Suppose, for example, that an instrumentation circuit contains a ca-

pacitor with C = 0.25 F = 0.25e-6 F, a typical value. If, at a particular instant, the volt-

age across the capacitor is changing at the rate 6,000 V/sec, then the current through the

                                         -6 A - sec       3 V               -3
capacitor is, from (5-3), i =  0.25 ×10        ×  6 ×10  = 1.5×10 A  1.5 mA.
                                         V                sec 

Electricity Example 5-3: 1st order, RC low-pass filter circuit

         This is a circuit containing both a resistor and a capacitor. The input voltage sig-
nal produced by some source is denoted ei(t), and the output, filtered signal is denoted
eo(t). Figure 5-3 depicts this filter graphically in both the simple closed-circuit form on

          R eo(t)                                      R

ei(t)              C  ei(t)                                        C eo(t)
0 V i(t)                                                  i(t)

                                                Ground

                                                 = 0 volts
Figure 5-3 RC low-pass filter circuit

the left, and the more modern form on the right, in which the common ground (reference)
potential is denoted by a special symbol and is assigned the value zero volts, to which all
other circuit voltages are referenced. The input and output terminals are denoted by
small circles. Note, in particular, that the output terminals are isolated away from the
current-carrying portion of the circuit; this represents the realistic situation in which the
filter output voltage is the input to some other circuit that has a very high input resistance,
thereby essentially preventing any input current. This downstream circuit could be some
measuring instrument (oscilloscope, voltmeter, etc.), or another stage of a larger circuit of
which the RC circuit is just one part. Note also that this RC circuit, and any upstream cir-
cuit at its input, and any downstream circuit at its output, all must be referenced to the
same ground voltage, which is constant and is the "zero" voltage relative to the other
voltages in the circuit; this is an important requirement for practical circuits.

                                         5-4
                    Chapter 5 Basic electrical components and circuits

         In order to derive the ODE describing the dynamics of this RC low-pass filter, we
use Eq. (5-1) for current iR through the resistor, and Eq. (5-3) for current iC through the

capacitor: iR = ei - eo , iC = C(e&o - 0& ) = Ce&o . The resistor and capacitor are in series, so

                       R
Kirchhoff's current law relevant to this situation is iC = iR :

ei - eo = Ce&o  e&o + 1 eo = 1 ei  e&o + 1 eo = 1 ei                                 (5-5)
            R                  RC RC                       1               1

in which 1  RC is the 1st order time constant.

         Given ICs on output voltage eo(t) and given input voltage ei(t), we can in principle
solve Eq. (5-5) for eo(t) using the mathematical methods discussed previously. In par-
ticular, frequency response is the dynamic behavior that is of greatest practical interest
for any circuit designed to be a filter. For frequency response, the input voltage is
ei (t) = Ei cost and the steady-state sinusoidal output voltage is eo (t) = Eo () ×

cos(t + ()) . Let's find the frequency response simply by adapting a previously

derived standard solution. First, we compare Eq. (5-5) with Eq. (3-7), x& + (1 1) x =
b u(t) , which is the standard ODE for stable 1st order systems. If we define u(t) =

U cost  ei (t)  U  Ei , then the other constant of the standard equation becomes

b = 1 1. Therefore, the standard FRF magnitude ratio (4-19) is adapted as

X () =                  b1 = Eo () =                1=          1                    (5-5.5)
 U                  1 + (1 )2  Ei               1 + (1 )2  1 + ( b )2

and the standard FRF phase (4-20) is adapted as  () = tan -1 (-1 ) = tan -1(- /b ) ,
in which the break frequency is b = 1/1 = 1/ RC = 2 fb . Figure 5-4 (adapted from
Fig. 4-2) is the log-log graph of magnitude ratio versus frequency, which clearly shows
the low-pass character of the frequency response.

log   Eo       E o  Low-frequency asymptote         Break point
    Ei                                                 High-frequency asymptote
               Ei
-0.151 0
               1 0.707
        -1
                               Eq. (5-5.5)

               0.1

-2 0.01

-3 0.001                                        fb  10fb   100fb             f (Hz)
                0.001fb 0.01fb 0.1fb                                          f

                    -3  -2         -1           0   1                   2  log 
                                                                               fb 
Figure 5-4 Log-log magnitude ratio of 1st order RC low-pass filter

                                  5-5
                  Chapter 5 Basic electrical components and circuits

         The governing ODE of the mechanical series damper-spring low-pass filter in Fig.
3-12 is Eq. (3-23), 1x&o + xo = xi (t) (see also homework Problem 4.3), which has exactly

the same form as Eq. (5-5). Accordingly, the electrical low-pass filter is an exact electri-
cal analog of the mechanical low-pass filter, input voltage ei(t) being directly analogous
to input translation xi(t), output voltage eo(t) to output translation xo(t), and electrical time
constant 1 = RC to mechanical time constant 1 = c / k.

The passive electrical component drawn in Fig. 5-5 represents an ideal linear

inductor, with inductance L henry (H) in SI units. A time-varying current i(t) is shown

e1(t)      L      e2(t)    flowing through the inductor. The graphical symbol de-
                           noting the inductor depicts a coil of conducting wire. If
                           the current is changing with time in such a coil, then a

i(t), di                   voltage difference appears across the coil, a voltage dif-
     dt                    ference that opposes the current change (Halliday and
                           Resnick, 1960, Sections 36-1 and 36-3). This voltage

Figure 5-5 Ideal inductor difference is called a self-induced emf (electromotive
                                     force); it is a manifestation of the interaction between

electricity and magnetism that is described by Maxwell's equations of electromagnetism

(after Scottish physicist James Clerk Maxwell, 1831-1879). The self-induced emf is pro-

portional to the rate of change of current, with inductance L defined as the constant of

proportionality:

                                         e1 - e2 = L di               (5-6)
                                                      dt

         You might find it difficult to perceive how Eq. (5-6) represents physically a volt-
age difference that opposes current change di dt . If so, then the following example
should illustrate this characteristic more understandably.

Electricity Example 5-4: 1st order LR circuit

Real inductors are not used in instrumentation circuits nearly as often as resistors

and capacitors. Moreover, there is no such thing as the ideal inductor instrumentation

component of Fig. 5-5. Because an inductor component consists primarily of coiled wire,

                                         and because a considerable length of very fine

ei(t) c S         L em RL          wire accumulates resistance, a real inductor usu-
                           eo(t) ally has non-negligible resistance as well as in-

                                         ductance. A common, simple, approximate cir-

Ei R combination of an ideal inductor and a resistor, L cuit model for such a real inductor is a series
                              i(t) and RL in the circuit of Fig. 5-6. In this circuit,

Figure 5-6 LR circuit                    ei(t) is the input voltage (after switch S is closed
                                         to position c), and eo(t) is the output voltage. R

                                         is a resistor placed between the inductor and

ground to permit sensing (by an oscilloscope, for example) of eo(t), which is directly re-

lated to the current by eo(t) = R i(t).

                                         5-6
Chapter 5 Basic electrical components and circuits

         Next, we derive an ODE governing the dynamic behavior of the LR circuit in Fig.
5-6. Observe that the derivative of current, di dt , appears in Eq. (5-6), unlike Eq. (5-1)

for a resistor and Eq. (5-3) for capacitor, in which equations current i(t) appears directly.
Because of this, it is usually not convenient to apply Kirchhoff's current law for a circuit
containing an inductor. It is usually better for such a circuit to apply Kirchhoff's voltage
law (abbreviated "KVL"): the sum of all voltage rises around a circuit loop is zero. If
we proceed around the circuit loop in the direction of defined positive current flow, then
the "voltage rise" across any component (including the input voltage generator and every
passive component) is defined to be the upstream voltage minus the downstream voltage.
To write KVL for this LR circuit, we start at the input voltage generator and proceed
clockwise:

(ei - 0) + (em - ei ) + (eo - em ) + (0 - eo ) = 0                (5-7)

Kirchhoff's voltage law is a fundamental law of circuits, but note that it also is just an
algebraic identity. Next, we substitute Eq. (5-6) and Ohm's law into Eq. (5-7):

 di                di
(ei - 0) +  - L  + (-RL i) + (-R i) = 0  L + (RL + R) i = ei (t)  (5-8)
 dt                dt

         Equation (5-8) is a stable 1st order LTI ODE solvable for arbitrary input voltage
ei (t) . For example, suppose that all ICs = 0 and that the input voltage is a step, ei (t) =

Ei H(t), which is accomplished with use of a battery and a switch, as shown in Fig. 5-6.
Comparing (5-8) with standard stable 1st order ODE (3-7), we adapt the standard step-
response solution (3-8), with ei(t)  u(t) so that Ei  U, to write the electrical response
quantities as

i(t) = Ei (1- e- t 1 ), 0  t in which 1 = L                       (5-9a)
RL + R                 RL + R

 eo (t) = R i(t) = R Ei (1- e- t 1 )  Eo (1- e- t 1 ), Eo  R Ei   (5-9b)
      RL + R                                        RL + R

Step response Eqs. (5-9) clearly show the effect of the inductance in opposing and de-
laying the rise of current flow. If the inductor were not present (i.e., if L = 0) in the cir-
cuit of Fig. 5-6, then the circuit would be a simple voltage divider (Problem 5.1), and the
full step-response output voltage would be achieved instantly, eo (t) = Eo H (t) , instead of

rising gradually as in (5-9b).

         The response of this circuit illustrates the physical effect of the inductor's self-in-
duced emf, Eq. (5-6). In this circuit, the inductor's upstream voltage is constrained to be
the input, ei (t) , so the self-induced emf must act in em (t) , the voltage at the inductor's
downstream terminal. It is helpful to derive from Eqs. (5-7)-(5-9) the equation for that

              5-7
                 Chapter 5 Basic electrical components and circuits

voltage, em (t) = eo (t) + RL i(t) = Ei (1- e- t 1 ), and the equation for the rate of change of

current, di dt = (Ei L)e- t 1 . At time t = 0+ (just after switch S is closed to position c),

we have di dt (0+) = Ei L > 0 but em (0+) = 0 and i(0+) = 0. Thus, at this instant, the

inductor holds its downstream voltage at zero and prevents the current from rising in-
stantaneously as a step function, which it would do if the inductor were not present. Af-
ter time t = 0+, the current gradually rises, but at a declining rate, and the current increase
is still opposed by the inductor downstream voltage, which also rises at the same declin-
ing rate.

From Eq. (5-6), we have the unit equivalence V = H × A  H = V - sec ;
                                                         sec               A

this relation for the henry is useful for clarifying units in calculations, as shown in the

following example. A particular "voice coil" is to be used in an electromagnetic force

actuator; this is the type of wire coil found in the speakers of consumer sound systems.

We wish to identify experimentally for this coil the parameters L and RL (based upon the

series model of Electricity Example 4) by measuring the step response of the circuit of

Fig. 5-6. For this particular circuit, the sensing resistor has R = 17.5 , and the battery

voltage is 9.00 V. We close switch S, then record the subsequent time-history graphical

response onto the screen of a digital oscilloscope, which stores the data for analysis. The

response graph (below) has the appearance of Fig. 3-3, and we measure from it the time

Eo = 7.26 V                                    0.950 Eo  0.982 Eo
    eo(t)
                                     0.865 Eo
          0
              0            0.632 Eo

                     1 = 0.0530 msec 21        31        41             t

constant 1 = 0.0530 msec and the final value of output voltage Eo = 7.26 V. From the
equations for 1 in (5-9a) and Eo in (5-9b), we derive the following equations for the re-
quired parameters L and RL, and then the subsequent calculated values:

L = (RL + R)1 =  R Ei 1
                      Eo 

Ei      9.00 V  V                                        -3 V - sec
= R1 =               17.5 (0.0530 ×10 sec) = 1.15 ×10-3                     1.15 mH

Eo      7.26 V  A                                                    A

                 R          Ei                  9.00 V 
    RL = Ei - R = R  -1 = (17.5)                   -1 = 4.19 
                 Eo         Eo                  7.26 V 

                                     5-8
                    Chapter 5 Basic electrical components and circuits

5-3 Operational amplifier (op-amp) and op-amp circuits

Figure 5-7 is the standard graphical symbol for an operational amplifier (op-amp).

An op-amp has a "positive" input port that accepts input voltage eip, and a "negative" in-

                    put port that accepts input voltage ein. The symbols eip and

ein                        ein are merely labels; they are not meant to restrict the po-
            +              larities of these input voltages, each of which can be either

     eip            eo positive or negative relative to the ground potential. An op-
                           amp has a single output voltage, labeled eo on Fig. 5-7. The

                    fundamental ideal output-to-input relationship of an op-amp

Figure 5-7 Operational is (Horowitz and Hill, 1980, Chapter 3)

amplifier (op-amp)       eo = K (eip - ein )                            (5-10)

In Eq. (5-10), gain K is a very large positive number, on the order of 105 to 106 for com-

mon, commercially available op-amps. The exact value of K varies gradually with the

frequency of signals eip and ein, but this variation is not important provided that frequency
is below a known upper value; as we shall see, a very important characteristic is that K is
large, K  O(105). (This equation is a common mathematical expression meaning "K is
on the order of or greater than 105.") Another important characteristic of an op-amp is
the extremely high resistance of the input ports, on the order of 106  to 1012 . The

practical consequence of this high resistance is that essentially zero current can flow

through the input ports.

         An op-amp is an active device, requiring external power to produce high gain,
unlike the simple passive elements (resistor, capacitor, and inductor) of Section 5-2. An
energy source (e.g., a ±15-volt power supply, or a pair of 9-volt batteries) is usually
connected to an op-amp, but this connection is normally not indicated on graphical
representations such as Fig. 5-7. An op-amp itself is a complex integrated circuit, full of
miniaturized transistors and other electrical components. The physical form of op-amp
seen most commonly on circuit boards is approximately the size and similar in
appearance to a basement centipede with a black body (actually, more like a 8-legged or
16-legged insect, because it has on each side four or eight metal connectors that look like
legs).

         Op-amps are not often used in the open-loop configuration of Fig. 5-7. Most op-
amps can operate linearly according to Eq. (5-10) only over a limited range of ±Elim on
output voltage eo. The range depends upon the energy source, but typically Elim is on the
order of 10 V. If the input voltages eip and ein are such that (5-10) leads numerically to eo
greater than +Elim or less than -Elim, then a real op-amp will limit and stick nonlinearly on
either +Elim or -Elim, respectively. When this happens, the op-amp is said to be
overloaded or saturated. Since gain K in (5-10) is so high, the input voltage difference
eip - ein clearly must be very small in order for the op-amp to operate in the linear range
for which it is primarily designed.

                    5-9
                 Chapter 5 Basic electrical components and circuits

         To operate an op-amp in its linear range, we almost always use feedback. When
there is an electrical connection between the output port and the negative input port, the
op-amp is said to be wired in a closed-loop manner, with feedback from output to input,
specifically in this case, negative feedback. This negative feedback acts to make the in-
put voltage difference eip - ein so small that for practical purposes there is no difference,
eip  ein.

    We can illustrate the practical functioning of an op-amp by analyzing in detail

what is probably the most common basic circuit consisting of an op-amp and resistors,

                    R f             the inverting amplifier depicted in Fig. 5-8.

                                    Note that there is an input resistor Ri , and that

    R i                             there is negative feedback through feedback

             ein             if     resistor R f . These resistances are chosen to
             eip
         ii                         be on the order of 101-104 , at least two
                 +
ei                                  eo orders of magnitude less than the input
                                          resistances of the op-amp ports. Note also that

                                    the positive input port is grounded, eip = 0 V.

    Figure 5-8 Inverting amplifier  Hence, from Eq. (5-10),

                                          eo = K (0 - ein )  ein = - eo         (5-11)

                                                                             K

Due to the extremely high resistance of the negative input port relative to Ri and R f , the

current through that port is essentially zero, so Kirchhoff's current law in this case re-
quires the feedback current to equal the input current, ii = if . Using Ohm's law to write
this condition of current continuity in terms of voltages gives

             ei - ein = ein - eo     ei - (- eo K ) = (- eo K ) - eo            (5-12)
             Ri          Rf               Ri              Rf

With a little algebra (which you should verify on your own), the solution of Eq. (5-12) for
circuit output voltage in terms of input voltage is found to be

                             eo = - R f ei 1                                    (5-13a)
                                     Ri 1 +  1 1 +  R f 
                                                K  Ri 

Let's evaluate the denominator of the large fraction in Eq. (5-13a). In typical applica-
tions of this circuit, the resistance ratio R f Ri is on the order of 102 at most. Therefore,
with gain K = O(105), the denominator is very, very close to 1: 1 + O(10-3)  1. (This
validates the earlier statement that only the large magnitude of K matters, the exact value
being unimportant.) So, the entire large fraction is essentially equal to one, and (5-13a)
simplifies considerably to

                                    5-10
              Chapter 5 Basic electrical components and circuits

                      eo = - R f ei                                   (5-13b)
                              Ri

The output voltage equals the input voltage amplified by the ratio R f Ri , and the sign is
inverted; hence the name inverting amplifier.

         Note also, from (5-11), that the voltage at the negative input port is negligibly
small relative to the output (and input) voltages:

              ein = - eo  0 = eip (the voltage of the grounded port)  (5-14)
                      K

In other words, the op-amp's high gain drives the voltage ein at the negative input port to
be essentially equal to the voltage eip at the positive input port. Equation (5-14) is just a
special case of the simplifying assumption that we can use in general, from Eq. (5-10),

                  eip - ein = eo  0  ein = eip                        (5-15)
                              K

In circuit analysis, Eq. (5-15) is considered a useful "rule" or "axiom" rather than just an
assumption. In the future (unless directed otherwise, as for a homework or exam prob-
lem), you should always apply rule (5-15) right from the very beginning of the derivation
for an op-amp circuit with negative feedback, because it simplifies the derivation so
much. For example, if we use (5-15) from the beginning for the inverting amplifier, then
the derivation becomes two easy steps [using ein = eip = 0 in (5-12)]:

                  ei - 0 = 0 - eo  eo = - R f ei
                  Ri  Rf             Ri

Figure 5-9 depicts an extremely simple, closed-loop op-amp circuit that is useful

in practice. The input voltage signal is directed into the positive input port, and this

                      port's high resistance prevents the flow of any current

                      from the input source. Rule (5-15) in combination with

           +          the feedback connection states that the output voltage
ei
              eo      exactly equals the input voltage, eo = ei . This op-amp

                      circuit functions as a current isolator and voltage

                      transmitter, and it is usually called a voltage follower.

Figure 5-9 Voltage follower Its main value is in providing a buffer between two dif-

                      ferent stages of a more complex circuit: the buffer al-

lows the output voltage of the upstream stage to be the input voltage of the downstream

stage, without permitting any current flow between the two stages. Any such interstage

                          5-11
              Chapter 5 Basic electrical components and circuits

current flow would usually cause malfunctioning of both stages. The application of a
voltage follower as a buffer between circuit stages is illustrated in the next section.

5-4 RC band-pass filter

       The circuit shown in Fig. 5-10 consists of a low-pass filter stage to the left of the

voltage follower, and a high-pass filter stage to the right. [The functioning of a high-pass

                                              filter is illustrated in homework

       RL - CH                                Problem 5.4(b)]. As indicated on
                   em(t) + em(t)              Fig. 5-10, the currents in the two
                                              stages are independent of each

ei(t)         CL                        RH eo(t) other, by virtue of the buffering
                                              due to the voltage follower.
       iL(t)             iH(t)
                                              Therefore, the simple ODEs for

                                              each type of 1st order filter are still

       Figure 5-10 RC band-pass filter        valid for the two-stage circuit of
                                              Fig. 5-10, with mid-circuit voltage

em(t) being the quantity shared by the two stages, as the output from the low-pass stage

and the input to the high-pass stage. These ODEs are Eq. (5-5) for the low-pass filter,

                          L e&m + em = ei ,  L = RLCL                     (5-16)

and the ODE derived in homework Problem 5.4(a) for the high-pass filter,

                          H e&o + eo =  H e&m ,  H = RH CH                (5-17)

         An equation such as (5-17) is described as having "right-hand-side (RHS) dyna-
mics" because the right-hand-side includes a derivative of the input ( e&m in this case),
rather than just the undifferentiated input itself.

         The combination of these two 1st order circuits turns out to be a 2nd order system,
and we shall re-visit this subject in Sections 9-10 and 10-4. We consider the RC band-
pass filter circuit now because it illustrates (1) application of a voltage follower, and (2)
the important physical characteristic of op-amps that is described next.

         Note in Fig. 5-10 that the feedback wire across the op-amp connects directly to
the negative input port; this port has essentially infinite resistance, so there cannot be any
current in the feedback wire. But Fig. 5-10 also shows the non-zero, second-stage current
iH(t) downstream of the op-amp; this appears to contradict the claim of zero feedback cur-
rent in the op-amp, since the graphical representation of the op-amp suggests that the
feedback wire is continuous electrically with the downstream circuit. In fact, the stan-
dard graphical representation of an op-amp with negative feedback, such as that in
Fig. 5-10, is oversimplified to the point of being misleading. For an actual op-amp
(as opposed to the standard graphical representation), the downstream current is
not continuous with the feedback current, but instead, is completely independent. In
fact, the current downstream of an op-amp is determined only by the output voltage of the

                                        5-12
                                Chapter 5 Basic electrical components and circuits

op-amp and the downstream electrical components, for example, the second-stage ca-
pacitor and resistor in Fig. 5-10. The technical characteristic of an op-amp that permits
this independence of currents is very low output impedance (Horowitz and Hill, 1980,
pages 25, 92-95, and 105). For another example of the independence of feedback and
downstream currents, see homework Problem 5.10.

                                                   5-13
                        Chapter 5 Basic electrical components and circuits

5-5 Homework problems for Chapter 5

5.1 The simple series circuit represented graphically below is a voltage divider, which is

       R1                      widely used in practical applications. Show that the

                               voltage output-to-input ratio is

   ei                   R2 eo              eo = R2
                                           ei R1 + R2
                i

5.2 Two capacitors are arranged in series, as shown below.

       C1           C2         (a) Use the current-voltage equation for capacitor C1

                em      h to show that e&m = e&i - i , where the e's are the volt-
h               h

ei i eo C1

h                       h ages indicated on the drawing and i is the current.

(b) Use the result of part (a) and the capacitor current-voltage equation for capacitor C2
in order to derive an algebraic formula for the equivalent series capacitance Ceq (in terms
of C1 and C2) in the equation i = Ceq (e&i - e&o ) .

5.3 Given capacitors C1 and C2 arranged in parallel, as shown below, find the equivalent
single capacitance Ceq.

                                        C1
                              e1 i1 e2 e1 Ceq e2
                             i i2 i =

                                                                         i
                                        C2

5.4 The simple circuit represented graphically below is a 1st order RC high-pass filter.

             C                  (a) Use current continuity and the formulas relating current
ei(t)                   eo(t) to voltage-difference for resistors and capacitors to derive in

                               all detail the following ODE with right-hand-side (RHS)
                               dynamics, which governs the output voltage eo(t) in terms of
                          R input voltage ei(t):

                                           e&o + 1 eo = e&i , 1 = RC
                                                1

Explain why this circuit is considered to be an exact electrical analog of the mechanical
series damper-spring high-pass filter described in Fig. 3-12 and Eq. (3-24).

                                     5-14
         Chapter 5 Basic electrical components and circuits

(b) For frequency response, the input voltage is ei (t) = Ei cost and the steady-state
output voltage is eo (t) = Eo cos(t + ) . Use the governing equation from part (a) to de-
rive the algebraic equations for FRF of the 1st order high-pass filter: the magnitude ratio
Eo () Ei and the phase () (in radians) as functions of excitation frequency  . (par-

tial answer: Eo () Ei = 1 1 + (1 )2 .) Suppose that R = 40 k and C = 0.25 F

(recall that  = 10-6). Calculate the break frequency fb = 1 (21 ) in Hz. To get some
feeling for the functioning of a high-pass filter, calculate the FRF magnitude ratio
Eo () Ei for driving frequency ratios f fb = 0.01, 0.1, 1, 10, and 100. (See also

homework Problem 4.4.)

(c) Suppose that the input voltage is a ramp, ei (t) = er (t tr )H (t) , where er is a reference

voltage and tr is a reference time such that ei(tr) = er. For IC eo(0) = 0 volt, solve the gov-
erning ODE from part (a) for the algebraic equation for eo(t) in terms of the given
algebraic parameters. Note that the derivative of the input voltage in this case is a step
function, e&i (t) = (er tr )H (t) .

5.5 The circuit drawn below is a series combination of a voltage source ei (t) , a coil

L em RL         (having both inductance L and resistance RL), and a capaci-
         eo(t) tor C; this is known as an LRC circuit. The input voltage is

                applied at time t = 0, at which time there is a non-zero volt-

ei(t) C age on the capacitor, eo (0) . Apply Kirchhoff's voltage law,
                    as in Electricity Example 4, and show that the equation for
i(t)
                                                       =t
                    current i(t) is L di + RL i + 1  i( ) d = ei (t) - eo (0) .
                                             dt       C  =0

5.6 For the op-amp circuit represented                       C

graphically at right, an integrator, derive

the algebraic equation for the transfer            R

function between input and output

voltages, TF (s) = L[eo (t)] . Assume that                   +
         L[ei (t)]                                                                   eo
                                             ei

there is no initial charge on the capacitor

at time t = 0. To simplify the derivation,
apply rule (5-15).1

1 This integrator seems simple on paper, but design of a real integrator that functions properly is difficult,
requiring expensive, precision components and many subtle refinements of the basic circuit. Integrators
based upon this circuit are essential components of the electronic analog computer (EAC), an elegant
instrument dating from the 1940s for solving coupled ODEs, but one that has now almost completely been
replaced by digital computers. Fifer's 1961 four-volume set is probably the most complete description of
all types of analog computers; Peterson's 1967 textbook includes standard instructional material on EACs;
and Lang's 2000 article is an interesting, more modern discussion of EACs.

                                             5-15
                         Chapter 5 Basic electrical components and circuits

5.7 For the op-amp circuit represented graphically below, a summing inverting amplifier,
derive the algebraic equation for output voltage eo(t) in terms of resistances R1, R2, and
Rf, and input voltages e1(t) and e2(t). To simplify the derivation, apply rule (5-15).

                                                                       Rf

                                 R1

                     e1                                  +                   eo

                             e2  R2

5.8 (a) For the op-amp circuit represented graphically below, a non-inverting amplifier,

                         R2                        derive the algebraic equation for output volt-

                                                   age eo(t) in terms of resistances R1 and R2, and

                                                   input voltage ei(t). To simplify the derivation,

R1 ein i2                                          apply rule (5-15).

 i1 iin                                     (b) Suppose that ei = 1.6 V, R1 = 5 k, and R2
           +                         eo = 15 k. Determine the values of ein (in V), iin

ei                                          (in milliamps, mA), i1 (in mA), i2 (in mA), and
                                            eo (in V).

5.9 The circuit drawing below shows an inverting amplifier, from Fig. 5-8, and, at the

input of the amplifier, a variable resistor with a sliding contact, often called a wiper. The

                                              R f           maximum useable resistance of

                                                            the variable resistor is Rp ; how-

      eim                    R i ein                        ever, by moving the wiper along
wiper 0    1                       iim eip +
                                                   if       the surface of the resistor (ad-

                                                            justed by turning a dial or a

ei  R p (1 -  )R p                                             screw), we can connect between
                                                         eo ei and eim any portion  Rp ,

                                                            where 0    1. The purpose of

Inverting amplifier with coefficient-setting potentiometer  this particular circuit configura-
                                                            tion is to allow the gain constant

                                                            of the amplifier to be adjusted

continuously to any value between zero and R f Ri , rather than being constrained to the

value R f Ri of Eq. (5-13b). Your assignment is to derive the following voltage output-

to-input equations:

                                                   5-16
Chapter 5 Basic electrical components and circuits

eim = (1 -  )                                   (1 -  ) R f
ei 1 +  (1 -  ) Rp              eo = - Ri

                      Ri              ei 1 +  (1 -  ) Rp
                                                              Ri

In your derivation, do not neglect the current to ground through the side of the variable
resistor with resistance (1 -  )Rp . For applications in electronic analog computers (see

the footnote to homework Problem 5.6), this arrangement of a variable resistor is called a
coefficient-setting potentiometer or just a pot for short.

5.10 The circuit represented graphically below consists of two stages, each stage being
built around an op-amp.

                                           C

R2                                                             R4

R1
                                                  R3

ei + em                                                     +      eo

(a) Derive from the left-hand stage the following ODE for interstage voltage em (t) :

e&m + 1 em = - 1 ei
    R2C                         R1C

(b) Combine the result of part (a) with the effect of the right-hand stage to show that the

ODE for output voltage eo (t) is e&o + 1 eo = R4 1 ei . (Note: This circuit is essen-
                          R2C   R3 R1C

tially the electronic analog computer (see the footnote to homework Problem 5.6) for

solving the standard stable 1st order ODE (3-7), x& + (1 1 )x = b u(t) . Input voltage ei (t)

is analogous to standard input u(t) , output voltage eo (t) is analogous to response x(t) ,

time constant 1 = R2C , and constant b = R4 1 .)
                                                    R3 R1C

5.11 The circuit represented graphically on the next page is the basic, ideal form of
electronic analog proportional-integral (PI) controller, one of the subjects of Chapter 15.
(In practice, a great deal of electronic refinement and conditioning is required to produce
a circuit that behaves even close to ideally.) The input voltage signal is ee(t), the
intermediate voltage between the two stages is em(t), and the output voltage from the PI
controller is w(t).

                          5-17
              Chapter 5 Basic electrical components and circuits

          C1     C2 R3
ee(t) R1
                        R2

              +

                 em(t)      +                                     w(t)

(a) By applying the methods of circuit analysis described in Chapter 5, show that the
ODE relating PI-controller output w(t) to input ee(t), expressed in terms of the capacitor
and resistor parameters of the circuit diagram, is:

                                       w& =  R3C1  e&e + 1 ee 
                                             R2C2  R1C1 

(b) Derive the PI-controller transfer function TF (s)  , expressed in terms L[w(t)] w0=0
                                                                  L[ee (t)] e =0

                                                                                                                                                                                         e0

of the capacitor and resistor parameters of the circuit diagram.

                 5-18
Chapter 6 General time response of 1st order systems by application of the convolution integral

Chapter 6 General time response of 1st order systems by application of
                              the convolution integral

                                 © 2016 by William L. Hallauer, Jr.

         Up to this point in the book, we have derived time response solutions of LTI sys-
tems only for relatively simple input functions u(t). The convolution integral will permit
us to derive time response solutions for any physically realistic input function u(t), and
even to compute time response solutions if u(t) is given in numerical form rather than
equation form. The general convolution transform and its inverse, the convolution inte-
gral, are defined and described in this chapter, and application of the convolution integral
is illustrated specifically for 1st order systems.

6-1 The convolution transform and its inverse, the convolution integral

         Suppose that we have two physically realistic functions of time, f1(t) and f2 (t) ,
that are zero for all time t < 0 and non-zero only for t  0. The convolution integral is
defined (Meirovitch, 1967, pp. 16-17, 534) to be another function of time in terms of a
definite integral involving f1 (t) and f2 (t) :

                                                                             =t

                         CI (t)   f1 ( ) f2 (t -  ) d
                                                                             =0

In this definite integral,  is the dummy variable of integration, and time t appears both in
the upper limit of the integral and in argument (t - ) of the integrand. We can express
the integral differently by making the change of integration variable  = t -  , so that
 = t -  and d = -d , since t is regarded as a constant within the integration:

 =t        =0             =t

 f1( ) f2 (t -  ) d =  f1(t - ) f2 ()(- d) =  f1(t - ) f2 () d
 =0        =t             =0

The final right-hand-side form results because exchanging the limits of a definite integral
changes its sign. In the final right-hand-side integral,  is just the dummy variable of in-
tegration, which might as well be , so we can write the convolution integral in either of
the following forms:

      =t             =t

     CI (t) =  f1 ( ) f2 (t -  ) d =  f1(t -  ) f2 ( ) d        (6-1)

      =0             =0

         The Laplace transform L[CI(t)] is called the convolution transform. Let's suppose
that the Laplace transforms of functions f1 (t) and f 2 (t) exist: F1 (s) = L[ f1 (t) ] and

               6-1
Chapter 6 General time response of 1st order systems by application of the convolution integral

F2 (s) = L[ f2 (t) ]. Then, as is derived in Appendix A, Section A-5, the product of these
two transforms equals the convolution transform:

                                 =t   =t 
F1(s) × F2 (s) = L[CI (t)] = L  f1( ) f2 (t -  ) d  = L  f1(t -  ) f2 ( ) d                        (6-2)

                                 =0                    =0                                        

It follows that the inverse transform of the product is the convolution integral:

  -1               (s)]                  =t                            =t

L [F1  (s)  ×  F2        =  CI  (t)  =       f1 ( )  f2 (t -  ) d  =       f1 (t -  )  f2 ( ) d    (6-3)

                                         =0                            =0

For LTI systems in general, the convolution integral (6-3) will permit us to derive time
response solutions for any physically realistic input function u(t).

         It is of interest to note that in MATLAB, the most common definition of convolu-
tion is a type of multiplication of two vectors. If the vectors are the coefficients of two
polynomials, then MATLAB convolution amounts to the multiplication of the two poly-
nomials. Consider, for example, the following product of two polynomials in s:

          F1(s) × F2 (s) = (2s 2 + 3s + 5)× (4s + 6) = 8s3 + 24s 2 + 38s + 30

The following are MATLAB operations that execute this multiplication, using the conv
command, and the result1:

>> F1=[2 3 5];F2=[4 6];F3=conv(F1,F2)
F3 =

         8 24 38 30

Similarly, MATLAB defines deconvolution as a type of division of two vectors. If the
vectors are the coefficients of two polynomials, then deconvolution amounts to the divi-
sion of one polynomial by the other. The MATLAB command is deconv.

6-2 General solution of the standard stable 1st order ODE + IC by application of the
convolution integral

         From Eq. (3-7), we have for stable 1st order systems:

ODE + IC: x& + (1 1)x = b u(t), x(0) = x0 , find x(t) for t > 0                                    (6-4)

Solve by first taking the Laplace transform,

1 See also the description at the end of Section 8-11 of the relationship between the convolution sum and
multiplication of polynomials.

                                             6-2
Chapter 6 General time response of 1st order systems by application of the convolution integral

                L[ODE]: sX (s) - x0 + (1 1 ) X (s) = bU (s)

                                                                       F1 ( s)

                                            64748

                                                                                      F2 ( s)

                                                        }
                 X (s) = x0 + b   1  U (s)

                              s +1 1  s +1 1 

Take the inverse transform, using Eq. (2-14) and convolution integral (6-3):

                         =t                              =t

x(t) = x0 e- t 1 + b  e- t 1 u(t -  ) d = x0 e- t 1 + b  e- (t- ) 1 u( ) d                            (6-5)

                         =0                              =0

Equations (6-5) are general solutions of problem (6-4) applicable for any input u(t).2 For
both forms, the first term is obviously the initial-condition (IC) response and the second
term is the forced response. In applications with specific u(t) functions, the second form
of the forced-response integral on the right-hand side of (6-5) is used more commonly
than the first. The first form is also valid, but the functional nature of u(t - ) can
sometimes be difficult to interpret correctly.

         The forced-response integrals in (6-5) are called convolution integrals, as in (6-1).
They are also sometimes known as superposition integrals, because, as is shown in
Section 8-10, they can be derived as the linear superposition of responses to differentially
small inputs.

        In Eqs. (6-5), constants 1 and b should be expressed in terms of the physical con-
stants of the actual system analyzed, such as mass m, damping constant c, etc.

6-3 Examples of 1st order system response

Example 6-1: response of a 1st order system to piecewise continuous input functions

         It is often the case that the input to a system is described by different functions,
each function in effect over a different time period for t > 0. For example, the following
equation and drawing represent an input consisting of two different general functions:

 0, t < 0                              u(t)  u1(t)                                             u2(t)


u(t) = u1 (t), 0 < t < t1

  u  2  (t  ),  t1 < t

                                       0
The general forced response to this 0               t1                                                t

type of input can be expressed nicely

2 Note, however, that solutions (6-5) are not valid for a non-standard 1st order ODE, e.g., one with right-
hand-side dynamics such as Eq. (5-17).

                                       6-3
Chapter 6 General time response of 1st order systems by application of the convolution integral

in terms of convolution integrals, but we must recognize that it requires two different
equations, and we must consider carefully the limits of the definite integrals. First, for
the time interval 0  t  t1 , it is clear that the second form of Eqs. (6-5) is directly appli-
cable, with u(t)  u1 (t) :

                                   =t                     , for 0  t  t1  (6-6a)

x(t) = x0 e- t 1 + b  e- (t- ) 1 u1 ( ) d
                                  =0

For the response during the second time interval, t  t1 , the definite integral in the second
form of (6-5) still must be evaluated over the limits  = 0 to  = t > t1 , which means that
both u1 and u2 need to be integrated, but each only over the time interval for which it is
defined:

             =t1                         =t               

- t 1               - (t - ) 1  u1( ) d +  e  - (t - ) 1  u2 ( ) d 
x(t) = x0 e + b   e                                                  , for t  t1 (6-6b)
             =0                                           
                                         =t1

Note especially in (6-6b) that  = t1 is both the upper limit of the integral that involves u1
and the lower limit of the integral that involves u2 . Equations (6-6) are especially useful
for response to a pulse of limited duration, as is illustrated in the next example.

Example 6-2: response of a mass-damper system to a half-sine pulse

         We consider again the problem for velocity of a mass moving on a viscous film,
which is solved by basic ODE methods in Section 1-5:

ODE + IC: m v& + c v = f x (t), v(0) = v0 , find v(t) for t > 0           (6-7)

       F sin( t td )  F sin t where  =  td , 0  t  td
       
f x (t) = 
       
                                0, td < t

Here we have u(t) = f x (t) , 1 = m c , and b = 1 m . Relative to the notation of Example
6-1 above, u1 is the half-sine pulse, and u2 is zero.

While the pulse is active, 0  t  td, Eq. (6-6a) becomes

                       - t 1 F - t 1  1  =t                               (6-8)

            v(t) = v0e + e  e sin  d
                                m        =0

                                   6-4
Chapter 6 General time response of 1st order systems by application of the convolution integral

We can evaluate the definite integral by several different methods: find it in a table of
definite integrals (or indefinite integrals, but don't forget the lower limit of integration);
or integrate by parts twice; or evaluate it with software that does symbolic manipulation,
such as Mathematica or recent versions of MATLAB. The result is

     =t
     e 1 sin  d = 1 2 [et 1 (sin t - 1 cost )+ 1]
                   1+ (1)                                                             (6-9)

     =0

Combining (6-8) and (6-9) gives the velocity during the pulse duration:

 F 1  - t 1 F 1                        2 (sin t - 1 cost ), 0  t  td
v(t) = v0 +     2e +                                                                  (6-10)
 c 1+ (1)                   c 1+ (1)

At the instant t = td when the pulse goes to zero,  td = , so the velocity then is

                 F 1  - td 1 F 1
             v(td ) = v0 +        2 e +                                               (6-11)
                 c 1+ (1)                c 1+ (1)2

For the time after the pulse goes to zero, td  t, Eq. (6-6b) becomes

                             =td          =t                             
    v(t) = v e- t 1 + F e- t 1  e 1 sin  d + e 1 × 0 d 
             0     m                                                                  (6-12)

                              =0          =td                            

With use again of Eq. (6-9), and of some algebra, (6-12) becomes                      (6-13)

       v(t) = v0 e- t 1 + F e- t 1 2 1 (1+ etd 1 ) = v(td ) e- (t-td ) 1 , for t  td

                       c 1+ (1)

The final form on the right-hand side of (6-13) uses Eq. (6-11), and it shows that the post-
pulse response is a pure exponential decay, which we would expect physically.

Example 6-3: response of reaction wheel spin velocity to a ramp input moment

         From Section 3-3, we have the equation of motion for spin velocity p(t) of a reac-
tion wheel (Fig. 3-1) with rotational inertia J, bearing viscous damping constant c , and
applied motor torque M m (t) :

p& + c p = 1 M m (t)  p& + 1 p = b M m (t) where 1 = J and b = 1            (3-2) repeated
JJ              1                        c                               J

                                  6-5
Chapter 6 General time response of 1st order systems by application of the convolution integral

Let the initial velocity be zero, p(0)  p0 = 0. Let the motor torque have the form of a
ramp:

      Mr                                                          M m (t) = M r t, t  0
Mm(t)                                                                         tr

      0 0 tr t
Then the second form of general solution (6-5) becomes

               - t 1               =t                             1 - (t- ) 1  =t M r
                                        - (t - ) 1  M m ( ) d =  e                      d
          p(t) = p0 e + b  e
                                   =0                             J  =0       tr

                      p(t) = 1 M r e- t 1  e 1  =t  d
                                               J tr           =0

We can evaluate the integral easily using integration by parts:

          [ ] ( )  =t }u 647dv48                     =t
                       1
                                        1  =t             1              t 1  2 t 1
            e d =  ×1 e  =0 - 1 e d = 1 t e -1 e -1
           =0                                        =0

Therefore, the total solution is

          p(t) = 1 M r [ e- t 1 1 t e t 1 -12 (e t 1 -1)]= M r [t -1(1- e- t 1 )]          (6-14)
               J tr                                               c tr

By sketching a plot versus time of the dimensionless spin velocity p(t) , you can eas-
                                                                                  M r c

ily show that, as t  , this quantity is asymptotic to the ramp function (t -1) tr .

6-4 General solution of the standard 1st order problem: an alternate derivation

         Consider again the general standard 1st order problem, Eq. (1-1), in which u(t) is
the known input (excitation), x(t) is the output (response) that we seek, and a and b are
constants, with a not necessarily negative:

          x& - a x = b u(t) , with IC x(t1) assumed known, find x(t) for t1  t             (6-15)

(We revert to the more general form now, rather than our stable standard 1st order ODE,
(3-7) or (6-4), in order to make this derivation more general, applicable for any physically

                                                    6-6
Chapter 6 General time response of 1st order systems by application of the convolution integral

realistic value or polarity of the constant a.) This problem is a bit more general than we
have considered previously, since we allow the initial time t1 to be different from zero.
In order to expedite indexing of array quantities in computer algorithms, we use subscript
1, instead of 0, to denote the initial time and the initial value: x(t1)  x1 .

         To find a general solution of this 1st order problem (ODE plus IC), we use the ex-
ponential function eat and closely related functions, for which we have the following ba-
sic identities:

           eat × e-at1 = ea(t -t1 ) and eat × e-at = e0 = 1                          (6-16)

We begin the general solution by multiplying the ODE by the integrating factor e-at ,
recognizing that this will make the left-hand side a perfect derivative:

  e-at (x& - a x = bu)             -at & -at -at                d (e-at x) = e-atbu
                                  e x -e ax = e bu              dt

Now we integrate the multiplied equation from the initial time t1 to an arbitrary time in-
stant t > t1 , using  as the variable of integration:

 =t d -a                 =t                                          =t
                              -a
        [e x( )] d = e b u( ) d  e x(t) - e x(t1) = e b u( ) d-at- a t1   -a

 =t1 d                   =t1                                         =t1

Finally, we multiply through by eat , apply identities (6-16), move the IC term to the
right-hand side, and arrive at the exact, general solution:

                                                  =t                                 (6-17)

           x(t) = ea (t-t1) x(t1 ) +  ea (t- ) b u( ) d , t1  t
                                                 =t1

The term eat need not be inside the integral, since it is not a function of the integration
variable  . Constant b also need not remain inside the integral. Solution (6-17) is com-
parable to, but more general than, the second form of convolution solution (6-5).

6-5 Numerical algorithm for the general solution of the standard 1st order problem

         We seek solutions of (6-17) in time-series form, that is, at discrete, equally spaced
instants in time. Accordingly, we define the following notation that employs descriptive
subscripts:

  t = t1 t2 = t1 + t t3 = t2 + t ... tn = tn - 1 + t tn + 1 = tn + t ...

x(t) = x1  x2                     x3  ...           xn              xn + 1           ...

u(t) = u1  u2                     u3  ...           un              un + 1           ...

                                      6-7
Chapter 6 General time response of 1st order systems by application of the convolution integral

Conceptually, we begin with the known values at t = t1, then integrate (6-17) from t1 to t2
= t1 + t, in which we define t as the constant time step; we now have known values at
t = t2, so we can integrate again to go from t2 to t3 = t2 + t. We proceed in this manner
from one time to the next until we have determined values of x(t) at discrete instants in
time over the complete time interval of interest. From (6-17), the exact, general equation

for stepping from time instant tn - 1 to the next instant tn is

                                     =tn                               (6-18)

 xn = ea(tn -tn-1) xn-1 + ea(tn - )b u( ) d
                                    =tn-1

By comparing Eq. (6-18) with Eq. (6-5), observe that the integral in (6-18) is clearly a
forced-response convolution integral.

         Up to this point, the solution is exact. But now we introduce what, in general, is
an approximation. We assume that u() varies so little over the integration time step t
that it introduces only small error to approximate u() as being constant over t, with its
value remaining that at the beginning of the integration time:

u()  u(tn - 1)  un - 1 for tn - 1   < tn                               (6-19)

Using approximation (6-19) and tn = tn - 1 + t, we rewrite (6-18) with the convolution
integral expressed in a more easily integrable form:

     a t    =tn-1+ta (tn-1 +t - )  
xn = e xn-1 +  e                   d  b un-1
            =tn-1                  

We change the variable of integration,  = tn-1 + t - , so that the integral becomes

 =0        =t        1 a t
 ea (- d ) =  ea d = (e -1)
 =t        =0        a

Finally, with approximation (6-19), solution (6-18) can be written as

xn = ea t xn-1 + 1 (ea t - 1) b un-1   xn-1 +  un-1                    (6-20)

                 a

Equation (6-20) is a recurrence formula that is easy to evaluate numerically from one

time instant to the next, especially since coefficients   ea t and   (ea t -1) b a =

( -1) b a are invariant once t has been selected. Note that if the input u(t) is a con-

stant, as for a step function, then un = constant for all n = 1, 2, ... , in which case (6-20) is
an exact solution because Eq. (6-19) is exact, not an approximation. Furthermore, if the
actual u(t) is piecewise-constant, then (6-20) can be applied to produce exact results,

          6-8
   Chapter 6 General time response of 1st order systems by application of the convolution integral

provided that t is chosen individually for each interval of constant u(t) such that the
interval is an integer multiple of its own t.

         To illustrate the application of Eq. (6-20), we re-visit the numerical solution of
Section 1-6, the velocity response of a mass-damper system to a half-sine force pulse.
M-file MATLABdemo11.m of Section 1-6, which calculates the response exactly, provides
the benchmark for evaluating the approximate response calculation. The MATLAB
script M-file to calculate and graph the approximate response is:

%MATLABdemo61.m
%Mass-damper system approximate response to IC + half-sine pulse forcing
m=5;c=2; %system mass & viscous damping coefficient, SI units
a=-c/m;b=1/m;
F=18;td=7.5; %half-sine pulse, amplitude (N), pulse duration (sec)
w=pi/td; %circular frequency of half-sine pulse (rad/sec)
Dt=1.5; %time step for recurrence calculations
t=0:Dt:24;Lt=length(t); %array of time instants for recurrence calculations
phi=exp(a*Dt);gam=(phi-1)/a*b; %constants in recurrence formula
for n=1:Lt %time series array of input force pulse

       if t(n)<=7.5
              fx(n)=F*sin(pi*t(n)/td);

       else
              fx(n)=0;

       end
end
v=zeros(1,Lt);v(1)=3.3; %initialize velocity array, initial velocity (m/sec)
for n=2:Lt

       v(n)=phi*v(n-1)+gam*fx(n-1);
end
plot(t,v,'k'),bar(t+Dt/2,fx/10,1,'k')

Note that the implementation of recurrence formula (6-20) in MATLABdemo61.m is a
simple three-line for-loop.

         The figure on the next page was produced by combining the results of M-files
MATLABdemo11.m and MATLABdemo61.m, and then adding explanatory labels and editing
the bar graph. For this example, time step t was intentionally chosen to be unreasonably
large, t = 1.5 sec (compared with system time constant 1 = 2.5 sec), in order to
produce clear distinctions between the exact and approximate dynamic variables.
Nevertheless, the approximate calculation of velocity shows the correct trends
qualitatively and is not highly inaccurate quantitatively. If the calculations were repeated
with a more reasonable time step, t  0.11 , then the results would be much more
accurate (homework Problem 6.4).

         Observe also in the figure on the next page the bar graph of approximate force
 f x (t) used in Eq. (6-20), which is the graphical representation of approximation (6.19).
Because of its piecewise-constant character, this is sometimes called a stairstep
approximation. This approximation introduces a time delay or lag on the order of t into
the approximate input. This artificial time delay is obviously transmitted to the
calculated approximate response.

                                                    6-9
   Chapter 6 General time response of 1st order systems by application of the convolution integral

        It is interesting and possibly useful to observe that, due to approximating u() as
being constant over each time step t, Eq. (6-20) is essentially IC + step response over
each t. Suppose that we were to seek an even more accurate recurrence formula than
(6-20) by approximating u() as varying linearly with time over each time step. In that
case, the solution would be essentially IC + step response + ramp response over each t.
(Example 6-3 in Section 6-3 illustrates ramp response.) So the more refined approximate
recurrence formula would be (6-20) supplemented with an additional term that represents
ramp response, and we would expect that additional term to include both un-1 and un as a
consequence of the approximated linear variation of u(); see homework Problem 6.5.

                                                   6-10
Chapter 6 General time response of 1st order systems by application of the convolution integral

6-6 Homework problems for Chapter 6

6.1 Consider a mass-damper system with a suddenly applied cosine forcing function be-
ginning at t = 0, and let the mass have a known initial velocity. The complete problem
for velocity v(t) is described by the 1st order, LTI ODE m v& + c v = F cost , t > 0, and
the IC v(0) = v0 . Use the general solution Eq. (6-5) to write an algebraic equation for the

complete solution v(t) of this problem. It will be necessary to evaluate the convolution
integral. You may use integration by parts and/or published tables of integrals, which are
highly recommended. Symbolic software (Mathematica, MATLAB, etc.) is also a po-
tential source of assistance with difficult integrals.

 F 1  -t 1 F 1                               2 (cost + 1 sin t ), t  0
Answer: v(t) = v0 -          2e +
 c 1+ (1)                            c 1+ (1)

6.2 Consider the standard 1st order LTI ODE (of a stable physical system) for dependent
variable x(t): x& + (1 1) x = b u(t) , with IC x(0) = 0. Let the input function be the follow-
ing flat pulse of duration td:

0, t < 0

u(t) = U , 0 < t < td          , in which amplitude U is constant

  0,                 td < t


(a) Use solutions (6-6) to write two algebraic equations for the complete response x(t) of
this problem. One equation should apply for the time during which the pulse is active
(including initial and final times), 0  t  td, and the other equation should apply for the
time after the pulse ceases, td  t. It will be necessary to evaluate the convolution inte-
gral.

                             bU1(1- e-t 1 ), 0  t  td
                             
Answer:              x(t) = 

                             bU (e-(t-td ) 1 - e-t 1 ), t  t
                             1                                d

Note that the result for td  t can be written also as

                   x(t) = bU1(1- e-td 1 )e-(t-td ) 1 , td  t

(b) Suppose that td = 1 . Sketch by hand (not by computer) a reasonably accurate time-
history plot of the nondimensionalized output x(t) versus time over the time interval

                                                       bU 1
0  t  51 .

                                     6-11
Chapter 6 General time response of 1st order systems by application of the convolution integral

6.3 Consider the equation of motion for spin velocity p(t) of a reaction wheel (from Ex-
ample 6-3 in Section 6-3): p& + (c J ) p = (1 J ) M m (t) , with IC p(0) = 0. Let the

applied motor torque be the following sawtooth pulse:

            0, t < 0           Mr
            M r          Mm(t)
M m (t) =  t, 0  t < tr
            tr                 00
            0, tr < t

                                   tr                                               t

Use solutions (6-6) to write two algebraic equations for the complete solution p(t) of this
problem. One equation should apply for the time during which the pulse is active (in-
cluding initial and final times), 0  t  tr, and the other equation should apply for the time
after the pulse ceases, tr  t. You may and should use without re-derivation the appropri-
ate results from Example 6-3 in Section 6-3, in which the applied moment is a per-
manently increasing ramp.

6.4 Use MATLABdemo61.m in Section 6-5 as a template (which must be revised and sup-
plemented with labels, grids, etc.) to calculate approximately and graph the velocity re-
sponse of the same mass-damper system with the same IC, but now specifying smaller
(than in Section 6-5) calculation time steps: t = 0.5 sec and t = 0.25 sec. You should
find that the calculated dynamic response becomes progressively more accurate as you
reduce t .

6.5 (a) Derive a more accurate recurrence formula than Eq. (6-20) by approximating
u() as varying linearly with time over each time step. In other words, use in Eq. (6-18)
the linear approximation

u( )  un-1 +  - tn-1 (un - un-1 ) for tn-1    tn

                  t

instead of the simpler approximation (6-19). By completing the integration, show (in all
detail, as if the answer were not given) that the refined version of Eq. (6-20) is

                          xn =  xn-1 +  un-1 +  (un - un-1 )

in which  and  are the constants defined in (6-20), and    - b .
                                                                             a t a

(b) Revise M-file MATLABdemo61.m of Section 6-5 to implement the refined recurrence
formula of part (a). Using exactly the same numerical data as in the original program,
run the revised program and plot the approximate time history v(t) . The approximate

time history calculated by the refined recurrence formula should be substantially more
accurate than that calculated by Eq. (6-20).

                         6-12
   Chapter 6 General time response of 1st order systems by application of the convolution integral

6.6 Consider the standard 1st order LTI-ODE of a stable system, Eq. (3-7), for dependent
variable x(t): x& + (1 1)x = b u(t) . Let the initial condition be zero, x(0) = 0, and let the
input function be a declining ramp, u(t) = c(tz - t) , in which c, a dimensional constant, is
the downward slope of the ramp, and tz is the time at which the input passes through zero.
(a) Evaluate in all detail the convolution integral in Eq. (6-5) to show that the exact

response solution is x(t) = bc1[(tz + 1)(1 - e-t 1 ) - t] = bc1[tz + 1 - t - (tz + 1)e-t 1 ] .

(b) Let the numerical parameters be 1 = 2.5 sec, tz = 10 sec, b = 3.5, and c = 1 (b and c
in consistent units). Write a MATLAB program, or adapt the code in Section 6-5 that
executes the recurrence formula, to calculate and plot an approximate numerical solution
for x(t) over the time interval 0  t  10 sec. Adjust the time-step size t and the number
of time steps over the 10-sec interval in your code until the graph of your approximate
solution appears very similar to that of the corresponding exact solution from part (a).
Submit your MATLAB code and your final graph of response.

                                                   6-13
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

Chapter 7 Undamped 2nd order systems: general time response;
                            undamped vibration

                                 © 2016 by William L. Hallauer, Jr.

         The ideal 2nd order mass-damper-spring system was introduced in Section 1-9,
and a theoretical response solution for an undamped system by elementary ODE methods
was demonstrated in Section 1-10. In this chapter, we explore ideal undamped 2nd order
systems in greater detail, deriving theoretical response solutions by means of Laplace
transformation with application of the inverse convolution transform from Chapter 6.
The final section of this chapter is an introduction to vibration of real structures,
including actual laboratory data.

7-1 Standard form for undamped 2nd order systems; natural frequency n

For the mass-damper-spring (m-c-k) system of Fig. 7-1, the ODE of motion (3-20)

derived from Newton's 2nd law, with use of                x(t)

the FBD in Fig. 3-9, is                           k

m &x& + c x& + k x = f x (t)  (7-1)                                      fx(t)
                                                         m

If we neglect damping by setting c x&             c

= 0 in Eq. (7-1), then we have an ideal (not

real) undamped mass-spring (m-k) system. Figure 7-1 Mass-damper-spring system
This undamped passive system is not fully

realistic because every passive physical system is afflicted with some type and degree of
energy dissipation, albeit very small in some systems.1 Nevertheless, it is useful to study

the undamped system because it reveals some important fundamental characteristics of
2nd order systems. From Eq. (7-1), the ODE for the m-k system is:

m &x& + k x = f x (t)  &x& + k x = 1 f x (t) = k f x (t)                         (7-2)
                                              mm     mk

         Let's use Eq. (7-2) to develop the standard form that will apply for undamped 2nd
order systems more generally. First, we define algebraically the natural frequency of
undamped vibration as the positive square root of the quotient of the stiffness and mass
values (both of which are positive in most passive systems):

                              n  k                                               (7-3)
                                       m

1 In an active system with an external source of energy and feedback control, it is possible that the damping
might be nullified; active systems are analyzed later, beginning in Chapter 14.

                                                    7-1
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

The natural frequency is very important physically: it is shown in the next section that an
undamped 2nd order system tends to vibrate (oscillate, pulsate, shake, quiver, ...)
periodically at circular frequency n radians per second. Next, we define the standard

input quantity

                    u(t)  1 f x (t)                                              (7-4)
                            k

So now we define x(t) as representing any appropriate output quantity (not necessarily
just position as in Fig. 7-1), and we re-write (7-2) in standard form ( standard in this
book, at least, and mostly standard in engineering literature):

                    &x& +  n 2 x =  n 2u(t)                                      (7-5)

         From Eq. (7-5) we see that input u(t) has exactly the same physical dimensions as
output x(t). In fact, we can identify u(t) as being the pseudo-static output, xps(t); that is, if
x(t) varies slowly enough that &x& is negligible in comparison with  n2 x , then ODE (7-5)
reduces to a simple algebraic equation, n 2 x  n 2u(t) , the solution of which is the
pseudo-static response, x(t) = u(t)  xps(t). This response is called pseudo-static because
it is not necessarily static (constant over time), but it varies slowly enough that the second
derivative of response is negligible.

Example: the simple pendulum, a rotational 2nd order system

You have probably seen the pendulum of a grandfather clock. The ideal simple

pendulum is very similar: there is a bob of mass m attached to the lower end of a rod of

H                   length l , the upper end of the rod being supported at frictionless
          M(t)      hinge H. We assume the rod to be rigid and to have negligible

                    inertial moment. The pendulum hangs downward and swings

length l            side-to-side with angle (t) in the plane of the paper, subject to
                    the acceleration of gravity, g. For completeness, we include an

g                     agent that can impose onto the pendulum an arbitrary applied
      (t)             moment M(t) about H. Because we neglect the inertia of the
                m rod, the rotational inertia of the pendulum about H is J = ml2 .
      lsin 

                mg  Newton's 2nd law for rotation about H is

(all applied moments about H) = J × rotational acceleration = ml2&&

 M (t) - mg × l sin = ml2&&  ml2&& + mgl sin = M (t)

                    7-2
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

Due to the sin  term, the exact ODE is nonlinear. However, let's consider only small
rotational angles,  <  10° , for which sin    in radians. This restriction linearizes

the ODE:

ml2&& + mgl = M (t)  && + gl  = g M (t) l mgl  && + n 2 = n 2u(t)

In the standardized form of the linearized ODE, the natural frequency is n = g l , and
the standard input quantity (also the pseudo-static response) is u(t) =  ps (t) = M (t) mgl .
For the pendulum at small rotational angles, the term mgl is the restoring moment that
opposes motion from the unforced static equilibrium position,  = 0; essentially, gravity
plays the role of a rotation spring. See homework Problem 7.4 for another interesting
pendulous rotational system, a balloon carrying a basket.

7-2 General solution for output x(t) of undamped 2nd order systems

         Let's solve Eq. (7-5) for output x(t), given any physically realistic input u(t), for
time t > 0, and given appropriate initial conditions at t = 0. We use Laplace transforma-
tion with application of the inverse convolution transform from Chapter 6. To simplify
the notation, we denote X(s)  L[x(t)]. Transforming (7-5) with use of Eq. (2-17) gives

s 2 X (s) - sx(0) - x&(0) +  n 2 X (s) =  n 2 L[u(t)]                            (7-6)

Equation (7-6) tells us that we need two initial conditions, one on the output and one on
the derivative of the output, for this 2nd order ODE. Accordingly, we simplify the writing
with the definitions

  ICs for 2nd order ODE: x0  x(0) , initial "position"; x&0  x&(0) , initial "velocity" (7-7)

Solving Eq. (7-6) for X(s) with the use of notation (7-7) gives

                            F1 ( s)

                       64748 F2 (s)
                                 678
X (s) = x0 2 2 s + 2 2 x&0 n + n 2 2 n L[u(t)]                                   (7-8)
s + n n s + n          s + n

We invert Eq. (7-8) using transforms (2-30) and (2-31), and the inverse convolution

transform (6-3), to find the two equivalent general solution equations for the standard
undamped 2nd order ODE, Eq. (7-5), with ICs x(0)  x0 and x&(0)  x&0 :

IC response                       forced response
64444744448
                  64444744448
                   =t
x(t) = x0 cosnt + x&0 sin nt + n  sin n × u(t - ) d
n                                                                                (7-9a)

                   =0

             7-3
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

IC response                    forced response
64444744448
             64444744448
                      =t
x(t) = x0 cosnt + x&0 sin nt + n  sin n (t - ) × u( ) d
  n                                                                              (7-9b)

                      =0

7-3 Simple IC response and step response of undamped 2nd order systems

         We find in this section two important special case solutions of Eqs. (7-9a,b): (1)
pure initial condition response for zero input, u(t) = 0; and (2) pure step response with
both initial conditions being zero.

         For the case of pure initial condition response (also called free vibration), with
u(t) = 0, Eqs. (7-9a,b) become

x(t) = x0 cos nt + x&0 sin  nt , 0  t                                            (7-10)
                     n

Let's use a trigonometric identity [see Eqs. (4-6)-(4-8)] to combine the two sinusoids of
(7-10) into a single term. The following definition will reduce the writing required and
also will turn out to be physically meaningful:

xmax  x0 2 + (x&0 n )2                                                           (7-11)

              x0                   - x&0 / n 
 x(t) = xmax cosnt ×   - sin nt ×      
              xmax                 xmax 

 x(t) = xmax cos(nt +  ), 0  t,  = tan -1   - x&0 / n                            (7-12)

                                                        x0 

         Figure 7-2 is an annotated graph of response (7-11)-(7-12) for positive values of
the ICs, x0 > 0 and x&0 > 0. Clearly, the output is a pure sinusoid of amplitude xmax and

Figure 7-2 IC response of an undamped 2nd order system
                              7-4
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

phase angle . This form of response is called free vibration, because it occurs without
any forcing input, u(t) = 0. The circular frequency of vibration is n rad/sec, the natural
frequency defined in Eq. (7-3). The cyclic natural frequency is fn = n/2 cycles/sec
(Hz), and the natural period annotated on Fig. 7-2 is Tn = 1/ fn = 2/n sec/cycle. Free

vibration at the natural frequency is one of the most important characteristics of un-
damped systems and, more realistically, of lightly damped systems. Damped 2nd order

systems are discussed in Chapter 9.

         For the case of pure step response, we set the ICs to zero, and we define the input
to be a step function at time t = 0, with step magnitude U:

     u(t) = U H(t)                                                               (7-13)

The appropriate form of the general solution to use in this case is Eq. (7-9a),

 =t   =t                            =t

x(t) = n  sin n × u(t - ) d = n  sin n ×U H (t - ) d = nU  sin n d
 =0   =0                            =0

Here we used the property of the unit-step function that H(t - ) = 1 for t -  > 0 (from
Eq. (2-27) and Fig. 2-3); this inequality obviously is satisfied for  over the limits of the
definite integral. For most applications of the convolution integrals in Eqs. (7-9a,b), the
form in (7-9b) is preferable because the integrand term u(t - ) in (7-9a) is usually diffi-
cult to interpret and/or awkward to handle in the integration. This case, however, is an
exception since u(t - ) is easy to interpret and is extremely simple. Completing the inte-
gration gives

 =t  =t  - 1  t
x(t) =  nU  sin  n d =  nU   d (cosn ) = -U [cos n ]0 = -U (cos nt -1)
 =0   =0  n 

      x(t) = U (1 - cosnt) , 0  t                                                (7-14)

         Equation (7-14) is graphed for a few cycles of response in Fig. 7-3. The response
is sinusoidal and periodic with the system natural period Tn, as is the free-vibration IC

     Figure 7-3 Step response of an undamped 2nd order system
                                    7-5
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

response. However, (7-14) is forced response, and the input u(t) is non-zero and constant
for t > 0, so this step response vibrates around a non-zero mean value (the pseudo-static
output value xps = U ), oscillating between 0 and 2U. In contrast, the free-vibration IC
response of Eq. (7-12) and Fig. 7-2 vibrates around the zero mean value, oscillating
between -xmax and +xmax.

7-4 Discussion of the physical applicability of step-response solutions

The concept of step response in physical applications can be bothersome if one

harbors the misconception that step response is valid only if the input is applied in an

u(t)     abrupt, discontinuous manner, as on the drawing at left.

U        This misconception is natural and honest because of

         the mathematical definition of the step function, Eq.

0        (2-26) and Fig. 2-2. If we apply that strict definition to

      0  t the step input analyzed in Section 7-3, without any

         recognition of the nature of the initial conditions, then

the time history of the input would have to be a discontinuous step function.

However, it is instructive to consider also the role of initial conditions in step re-

sponse. Step response solution (7-14) is derived for zero ICs, x0 = 0 and x&0 = 0. Imag-

ine that some powerful external agent enforces these ICs for time t < 0, then at t = 0, the

external agent abruptly releases its hold on the system. Under this circumstance, it does

not matter whether the input u(t) jumps discontinuously from 0 to U at t = 0, as in the

         drawing above, or the input has value U both after and

u(t)     before t = 0, as in the drawing at left. An input value

U        of U before t = 0 could not produce any effect on out-

         put x(t), because it could not overpower the external

0        agent that enforces the initial conditions before and

      0  t right up to the instant t = 0. A practical example to

         which we can relate is an airplane sitting on a runway,

preparing to taxi for takeoff. With the brakes firmly engaged, the pilot increases engine

thrust, but the airplane is held motionless by the brakes. In this example, the brakes play

the role of "powerful external agent" that enforces the initial position and zero initial ve-

locity, and the engine thrust plays the role of input quantity. After engine thrust has

reached acceptable takeoff level, the pilot releases the brakes (at t = 0), and the airplane

accelerates into takeoff taxi. The engine thrust exists before t = 0, but it produces no

taxiing motion then because the brakes completely restrain the airplane.

         The conclusion of this discussion is that step response is a valid physical solution
even if the input is constant before and after the initiation of motion (i.e., is not applied
strictly like a mathematical step function), provided that initial conditions enforce the
motion prior to the instant (usually t = 0) when the input becomes effective.

         7-6
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

7-5 Dynamic motion of a mechanical system relative to a non-trivial static equilib-
rium position; dynamic free-body diagram

         Consider the mass-spring system depicted in Fig. 7-4 (on the next page), which is
representative in many respects of some real mechanical systems. The system is oriented
vertically in a gravity field with acceleration of gravity g. Moreover, let's suppose that
the spring is close-wound: a helical extension spring which, in its unstretched state, is
wound with its coils forced into contact with each other, such that an initial tension force
Fi is required to break the coil contact and allow the spring to begin stretching (Shigley
and Mitchell, 1983, p. 449). Figure 7-4 illustrates three possible states of such a system.
The weight of mass m is W = mg, and it is a constant force vector acting downward
through the center of gravity of the mass. The spring has stiffness constant k and initial
tension Fi , so that the spring law is f y = Fi + k y for f y  Fi , where y is spring stretch

vertically downward. State 1 of Fig. 7-4 shows the mass supported statically by an exter-
nally applied force W acting upward, with the spring unstretched and therefore exerting
no force on the mass. We define yt (t) as the total vertical motion of the mass (positive
downward in this example, but not necessarily always so) relative to the unstretched-
spring position. Now, if the externally applied upward force is slowly reduced, the
weight of the mass is gradually transferred to the spring, and the spring stretches (pro-
vided that W > Fi ), lowering the mass. State 2 of Fig. 7-4 is the static equilibrium state
that results after the externally applied upward force shrinks to zero, with the spring
stretched by the amount ys from the State 1 position. From the FBD of State 2, the equa-
tion of vertical static force equilibrium is

Fi + k ys = W  ys = W - Fi , for W  Fi                                           (7-15)
                                  k

         State 3 of Fig. 7-4 is a condition of dynamic response, with the dynamic force
 f y (t) acting on the mass. We define the dynamic position yd (t) as the motion relative

to the static equilibrium position, ys of Eq. (7-15). We see from Fig. 7-4 that the total
translation (from the unstretched-spring position) and the associated acceleration are

yt (t) = ys + yd (t)  &y&t (t) = &y&d (t)                                        (7-16)

The acceleration equation reflects the constancy of ys . Let's use the FBD for State 3 to
write Newton's 2nd law for vertical translation:

   (Forces)y = m &y&t = f y (t) + W - (Fi + k yt )  m &y&t + k yt = f y (t) + W - Fi (7-17)

Now use Eq. (7-16) to eliminate yt (t) from Eq. (7-17):                          (7-18)

                         m &y&d + k (ys + yd ) = f y (t) + W - Fi

7-7
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

1. Spring            2. Static                     3. Dynamic
   unstretched          equilibrium                   response

                k                    k                           k

m g

   W                     m g                       m g
                           W                         W
   W                 ys               yd(t) yt(t)     fy(t)

FREE-BODY DIAGRAMS:        Fi + k ys               Fi + k yt(t)

m                        m                         m

   W                        W                         W

                          W fy(t)

             Figure 7-4 Static and dynamic positions of a hanging, spring-supported
             weight

Next, eliminate k ys = W - Fi , Eq. (7-15), from Eq. (7-18) in order to express the ODE in
terms of the motion relative to the static equilibrium position, the single dependent vari-
able, yd (t) :

                   m &y&d + k yd = f y (t)                                       (7-19)

It is obvious physically that Eq. (7-19) is valid provided the upward dynamic motion does
not exceed the static spring stretch: yt (t) = ys + yd (t) > 0 , i.e., yd (t) > - ys .

         Equation (7-19) is identical in form to Eq. (7-2), which applies for a mass-spring
system oriented horizontally, with no involvement of a close-wound spring or gravity.
The only difference is that the unknown in (7-19) is not the total motion, but, instead, the
motion relative to the static equilibrium position established by gravity and the spring
initial tension. Consider the dynamic free-body diagram (DFBD) shown in Fig. 7-5 on
the next page, which is similar to that of State 3 in Fig. 7-4, but without weight W and
with only the spring force relative to the static equilibrium position. These changes from

                         7-8
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

the FBD of State 3 in Fig. 7-4 are equivalent to eliminating                    k yd
k ys = W - Fi from Eq. (7-18) in order to obtain Eq. (7-19). Clearly,
applying Newton's 2nd law to the DFBD Fig. 7-5 leads again, and much         m
more easily, to Eq. (7-19). The important conclusion here: if we want
to solve only for the dynamic motion yd(t) relative to the static               fy(t)
equilibrium position, not the total motion relative to the spring-     Figure 7-5
undeformed position, then we should use a DFBD from which all static   Dynamic free-
influences (weight and spring initial tension in this case) have been  body diagram
eliminated. The DFBD should include only dynamic forces (and/or
moments) relative to the static equilibrium position.

         This conclusion is useful more generally because, in many situations, we are, in-
deed, interested primarily in the dynamic response relative to the static equilibrium posi-
tion. Homework Problem 7.3 is one example. Moreover, this conclusion based upon the
simple mass-spring system of Fig. 7-4 has broad applicability to other mechanical sys-
tems. The subjects of Chapters 11 and 12 are more complex rotational systems and
higher-order mechanical systems. It is usually convenient when analyzing those systems
to deal only with the simpler DFBDs and ODEs that we use when we solve only for the
dynamic motion relative to the static equilibrium position.

         However, there are at least two classes of mechanical systems for which we must
include (in FBDs and ODEs of motion) the weights of massive components: (1) pendu-
lous systems for which gravity provides a spring effect, such as the simple pendulum ex-
ample in Section 7-1 and the balloon-basket vehicle of homework Problem 7.4; (2)
systems for which initial conditions and/or dynamic inputs (forces, moments) are defined
relative to the undeformed-spring state, for example, the airplane landing contact of
homework Problem 7.5.

Section 7-6 Introduction to vibrations of distributed-parameter systems

         A system such as the mechanical mass-dashpot-spring system of Fig. 7-1 is often
called a lumped-parameter system. This descriptive term is used because the essential
physical features are idealized to be spatially concentrated: in Fig. 7-1, all of the mass is
idealized to reside in one physical element, all of the damping in another, and all of the
stiffness in yet another. Some engineering systems can be modeled accurately using
idealized lumped elements; but many real systems cannot, and these latter are called
distributed-parameter systems. A structural beam, such as that shown in Fig. 7-6 on the
next page, is a prototypical distributed-parameter mechanical system. It is obvious that
the mass of this beam is not concentrated at a single point in space, but instead is
distributed throughout the beam's volume. Similarly, the flexibility of the beam does not
reside in a discrete spring, but also is distributed over the entire spring. Finally, although
there is very little damping in this particular system, it also is distributed throughout the
beam in the forms of molecular "friction" within the deforming beam and fluid dynamic
drag on the beam's surface if the beam is immersed in air, another gas, or liquid.

7-9
         Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

Figure 7-6 Clamped uniform aluminum beam with nominal cross section 2 inch ×
1 8 inch. Test configuration: beam clamped at left between thick steel plates,
leaving 10.0 inches of overhang; non-contacting proximity (displacement) sensor
over right tip; bonded onto the beam's right tip is a small, thin, steel plate, the
"target" in which the proximity sensor induces eddy currents.

         Figure 7-7 is an actual record of motion of the beam in Fig. 7-6 in response to a
particular initial condition: the tip of the beam was bent upward statically, then
released. 2

Figure 7-7 Initial-translation dynamic response of the beam in Fig. 7-6, as detected
by the proximity sensor.
The subsequent time response was directly analogous to the theoretical IC response
shown in Fig. 7-2, with positive initial deflection, y0 > 0 , but zero initial velocity,
y&0 = 0 , y(t) being vertical translation, positive upward, of the beam tip relative to the
static equilibrium position under gravity loading. Note in Fig. 7-7 that the character of
the measured response appears very close to that predicted theoretically in Eq. (7-10) for
an undamped 2nd order system, y(t) = y0 cosnt . However, we can detect by detailed
analysis of the data in Fig. 7-7 the following very small differences between actual and

2 In practice, this procedure is often called twang testing (also snapback, step-relaxation, and pluck test-
ing)--see homework Problem 9.4 for a more detailed discussion.

                                                   7-10
         Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

theoretical responses: (i) slight reductions in amplitude from one cycle to the next, due to
the very light system damping and to an imperfect release of the beam from its static
initial deformation; (ii) a slight eccentricity of the vibration relative to the zero-translation
position, due to a small instrumentation error, which is almost unavoidable in
experimental measurements; and (iii) almost imperceptibly small distortion of the wave-
form shape relative to a perfect cosine. (More easily observed distortion appears in Fig.
7-9, which is discussed below.) This small waveform distortion occurs because the beam
is not a perfect 2nd order, lumped-parameter system; in reality, the beam is, mathemati-
cally, a much more complicated distributed-parameter system. Nevertheless, it turns out
that in many circumstances, including this particular one, we can approximately model
distributed-parameter structures as 2nd order systems, with acceptable accuracy for many
engineering purposes.

         Careful study of the experimental data in Fig. 7-7 shows that the time between
any two successive peaks of the response signal, the "period" of damped vibration, is Td
 0.0294 sec. The system of Fig. 7-6 is damped, so Td is not a true undamped "natural"
period. However, theoretical solutions for mathematical models predict that a measured
period such as this for a very lightly damped system is almost equal, for all practical
purposes, to the true natural period. Therefore, in the example problems below, we shall
assume that the measured period is the system's natural period, and so the undamped
natural frequency is fn  1 Td = 34.0 Hz.

         Figure 7-8 illustrates the spatial distribution of the beam vibrating after the same
type of initial condition as that of Fig. 7-7, but with a much greater magnitude of defor-
mation. For this edge-on photo, the shutter of the digital camera was open for ¼ second,
during which time the beam vibrated through 8+ complete cycles. The upper and lower
limits of dynamic deformation appear as fairly distinct curved lines against the dark
background in the photo, whereas the intermediate states of deformation appear as a blur.
This occurs because the velocity of motion was zero at the extreme deformations;
therefore the digital camera's photosites were exposed during disproportionately longer
times to the extreme deformations than to the intermediate deformations.

Figure 7-8 Edge-on, ¼-second exposure photo of the beam of Fig. 7-6 vibrating af-
ter an initial static deformation and release of the beam tip.

Example Problem 7-1: a calculation of the "effective" tip mass of the vibrating beam.

         Consider the system of Fig. 7-6. By loading the beam statically with small cali-
brated weights hanging from the beam tip, and by measuring the resulting beam-tip
downward vertical deflection with the proximity sensor, students determined a beam-tip

                                                   7-11
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

average "effective" stiffness constant to be kE = 7.86 lb/inch. With this stiffness and the
measured natural frequency fn = 34.0 Hz, we can infer a value for the "effective" tip
mass from Eq. (7-3) in the form

mE = 2 kE = 2 kE = -1 2 7.86 lb/inch = 1.72e-4 lb-sec2/inch
      n (2 fn ) (2 × 34.0 sec )

         It is appropriate to conduct a plausibility check of this result, especially since
most of us find it difficult to relate intuitively to values of mass that are expressed in the
traditional structural system of units (see Section 3-1). Students measured the 10.00-inch
overhang of the uniform aluminum beam in Fig. 7-6 to weigh Wb = 0.230 lb, and they
measured the weight of the small steel target at the beam tip as 0.13 oz = 0.0081 lb.
Therefore, the total mass of the beam plus the steel target is

              mT = WT g = (0.238 lb) ÷ (386.1 inch/sec2) = 6.16e-4 lb-sec2/inch

The mass ratio is mE mT = 0.28. In view of the photo of the vibrating beam, Fig. 7-8, it
seems physically plausible that roughly 28% of the total structural mass is effectively
involved in the vibration. This ends Example Problem 7-1.

Example Problem 7-2: calculations based upon ideal theory, nominal dimensions, and
standard material constants

         Let's calculate an estimate of the natural frequency of the beam system of Fig. 7-6

using Eq. (7-3) in the form fn = 12 kE mE . In this calculation, let's assume that we do
not have measured data from actual hardware or instrumentation, i.e., that we have only
the type of information that would normally be available in the preliminary-design phase
of an engineering project, before even a prototype is fabricated.

First, let's calculate the theoretical effective stiffness constant kE . From your

courses and textbooks on static structural behavior, you might be familiar with the

deformation under loading of structural members such as uniform (prismatic) beams and

shafts that are fabricated from homogeneous, isotropic, linearly elastic materials. The

theory relevant to the present situation is that for a cantilever (ideally clamped-free)

beam. From any textbook with the words "mechanics of materials" or "strength of
materials" in its title3, you can find that the effective stiffness at the tip of a uniform

cantilever beam is  k E  =  3EI    3  ,  in  which  E  is  the  material  modulus  of  elasticity,  I  is  the

                                 L

2nd area moment (also called area moment of inertia) of the beam cross section, and L is

the overhanging length of the beam. For the beam of Fig. 7-6, let's use the standard (in
preliminary-design calculations) elastic modulus for aluminum: E = 10.0e+6 lb/inch2.

The nominal rectangular cross-sectional dimensions of the beam are width b = 2.00

3 Examples of such textbooks, listed in the References section: Beer and Johnston, 1992; Hibbeler, 1997;
and Timoshenko and Young, 1962.

                                             7-12
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

inches and depth h = 1/8 inch, for which the theoretical 2nd area moment is I = bh3 12 =
3.255e-4 inch4. Using the overhang length of 10.00 inches, we calculate the effective
beam-tip stiffness to be

kE =  3 × (10.00 ×106 lb/inch 2 ) × (3.255 ×10-4 inch 4 )  = 9.766 lb/inch

              (10.00 inch)  3

         Next, let's calculate an effective tip mass mE . Consider first the vibration of an
ideal uniform cantilever beam alone (i.e., without a concentrated tip mass such as the
steel target shown on Fig. 7-6). More advanced theory4 shows that, for such a bare beam,
the effective tip mass vibrating at the fundamental natural frequency is 0.242672 of the
total beam mass, which we determine next. The weight of a uniform beam is Wb = wAL,
in which w is the weight density (weight per unit volume), and the cross-sectional area of
a rectangular beam is A = bh. Let's use the standard (in preliminary-design calculations)
weight density of aluminum, w = 0.1000 lb/inch3, so that the weight of our ideal canti-
lever beam is Wb = (0.1000 lb/inch3)×(¼ inch2)×(10.00 inches) = 0.2500 lb. Hence, the
effective tip mass of the bare beam alone is mbE = 0.242672 ×Wb g = 0.242672 ×
(0.2500 lb) ÷ (386.1 inch/sec2) = 1.571e-4 lb-sec2/inch. To obtain an intuitively logical

estimate of the total effective tip mass, we add to mbE the mass of the steel target that is
bonded to the beam tip on Fig. 7-6: mE = mbE + (0.0081 lb) ÷ (386.1 inch/sec2) =
1.78e-4 lb-sec2/inch.

         Finally, the natural frequency based upon ideal theory, nominal dimensions, and
standard material constants is

      fn = 1  kE = 1  9.77 lb/inch                         = 37.3 Hz
           2  mE 2
                      1.78 ×10-4 lb  sec2 /inch

See homework Problem 7.8 for an analysis of the discrepancy between this calculated
natural frequency and the measured value of 34.0 Hz. This ends Example Problem 7-2.

         The clamped-beam system of Fig. 7-6 appears to behave very much like a 2nd or-
der system when it responds dynamically to a simple initial static deflection of the beam
tip. However, when it is subjected to most other possible types of excitation, its dynamic
response is more complicated. For example, when the beam tip was tapped lightly up-
ward with a small hammer, the tip moved vertically as shown on Fig. 7-9, next page.

4 Theory from, among many possible sources, the following textbooks on structural dynamics that are list-
ed in the References section: Bisplinghoff, et al., 1955, Example 3-1; Craig, 1981, Example 10.3; Meiro-
vitch, 1967, Section 5-10; and Meirovitch, 2001, Example 8.4.

                                                   7-13
         Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

Figure 7-9 Dynamic response to a hammer tap at time t = 0 sec of the beam on Fig.
7-6, as detected by the proximity sensor.

         The input force that stimulated the response of Fig. 7-9 was approximately a half-
sine pulse (as described in Sections 1-5 and 1-6) of very short duration relative to the
lightly damped period of this system, Td  0.0294 sec. In Chapter 8, theory is developed
showing that, if the system were a true undamped 2nd order system, then the time re-
sponse to such a pulse would have almost a perfect sine waveform, starting at time t = 0
sec. However, the waveform in Fig. 7-9 is quite different from a perfect sine waveform;
in fact, it is closer to being the sum of many sinusoids, in the general spirit of a Fourier
series, but without the property of Fourier series that all higher series sinusoids have fre-
quencies that are integer multiples of the frequency of the first (fundamental) sinusoid.5
In the case of Fig. 7-9, the total motion consists primarily of a first sinusoid with fre-
quency 34.0 Hz, plus a second, lower-amplitude sinusoid with frequency approximately
215 Hz. The motion at 34.0 Hz represents the first (fundamental) mode of vibration, and
the motion at 215 Hz represents the second mode of vibration.

         In fact, the beam system of Fig. 7-6 has many more than two modes of vibration,
each with a characteristic frequency higher than that of the previous mode. The third and
higher modes are not evident in Fig. 7-9 only because the particular pulse stimulus ap-
plied in this case did not noticeably excite those higher modes; however, they could be
excited by any number of other stimuli, such as sharp pulses applied at particular loca-
tions, high-frequency sound-pressure waves, etc. In reality, every distributed-parameter
system is a higher-than-2nd-order system, and, if only lightly to moderately damped, has
many modes of vibration. For example, every acoustic musical instrument is a fluid or
structural distributed-parameter system whose distinctive sound quality is a direct conse-
quence of its particular modes of vibration.6 However, except for this short descriptive
introduction, the subject of distributed-parameter systems is beyond the scope of this

5 The subject of Fourier series is developed in most textbooks on advanced calculus (for example, Hilde-
brand, 1962, pages 216-226) and in most textbooks on elementary partial differential equations.
6 If you are interested in the physics of musical instruments, see Cannon, 1967, Sections 13.2-13.6, for an
excellent introduction written by an engineer for students of engineering.

                                                   7-14
         Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

book. The subject of vibration modes appears again in Chapter 12, which deals with un-
damped, 4th order, lumped-parameter systems that have two modes of vibration.

         Observe from Fig. 7-9 that the translation response of the beam system of Fig. 7-6
was still dominated by the first vibration mode, even though the tip-pulse stimulus also
excited the second mode, but to a much lower amplitude than that of the first mode.
Hereafter in this book, the only response of any distributed-parameter system that we
shall consider is the contribution of the first mode, and we shall assume that it dominates
the total response. Indeed, this is often a good engineering approximation for distributed-
parameter structural systems that include relatively large, spatially concentrated masses.
Consider, for example, the system of Fig. 7-10, which is the same as that of Fig. 7-6 but
with the addition at the beam tip of a concentrated-mass assembly that consists of two
ceramic magnets and an aluminum spacer, and weighs 0.254 lb.

Figure 7-10 Structural system of Fig. 7-6, with the addition at the beam tip of two
ceramic magnets and an aluminum spacer. Note the same steel-plate tip-target for
the proximity sensor as on Fig. 7-6.

         When the beam tip of Fig. 7-10 was tapped lightly upward with a small hammer,
the tip moved vertically as shown on Fig. 7-11. The tip-translation response curve is a
very clean sine waveform with almost no discernible distortion. The absence of
significant distortion in the waveform means that, for our purposes, this beam-mass
system behaves like a 2nd order system, even though it is a distributed-parameter system.

Figure 7-11 Dynamic response to a hammer tap at time t = 0 sec of the beam on Fig.
7-10, as detected by the proximity sensor.

                                                   7-15
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

         The addition of a relatively large quantity of mass at the beam tip reduces consid-
erably the frequency of the waveform on Fig. 7-11 relative to the 34.0-Hz frequency of
the fundamental waveform on Figs. 7-7 and 7-9; a careful analysis of the data in Fig. 7-11
shows that the frequency of vibration is f = 15.85 Hz.

Example Problem 7-3: a predictive calculation of the vibration frequency of the beam-
mass system of Fig. 7-10.

         Suppose that we had wanted to predict the frequency of the beam-mass system of
Fig. 7-10 before actually assembling the system and measuring the frequency. The
following is an intuitively logical approach, though not necessarily theoretically rigorous.
Providing that the clamped beam deforms linearly under load, the addition of mass and
weight to the beam tip should not alter the beam's stiffness constant, so we use the same
measured beam-tip effective stiffness as that of Example Problem 7-1, kE = 7.86 lb/inch.
As stated previously, the concentrated-mass assembly that was added to the beam tip
weighs 0.254 lb. To obtain the total effective vibrating tip mass, it seems reasonable to
add together this value and the effective tip mass of the bare beam plus the steel target, as
determined in Example Problem 7-1. Thus, we find the total effective mass mE =
0.254 lb (386.1 inch/sec2 ) + 1.72e-4 lbsec2/inch = 8.30e-4 lbsec2/inch. Finally, we
calculate the predicted natural frequency to be

fn = 1  kE = 1  7.86 lb/inch                                    = 15.5 Hz
     2  mE 2
                8.30 ×10-4 lb  sec2 /inch

This predicted natural frequency is lower than the actual measured value of 15.85

Hz by a margin that is unexpectedly large, presuming that all assumptions underlying the

theory are valid. This suggests that the actual effective stiffness during the dynamic re-

sponse of Fig. 7-11 was greater than 7.86 lb/inch. This is quite possible, because the

students measured the beam-tip average effective stiffness constant to be 7.86 lb/inch

over a range of very small downward deformation of the beam, but they also observed

that the local stiffness (slope of the curve of load versus deflection) increased pro-

gressively as the downward deformation increased. Observe on Figs. 7-6 and 7-10 at the

clamped end of the beam that there appears to be a small gap between the edge of the

upper steel clamping plate and the beam top surface; although not clearly visible on these

photos, there is a similar gap between the lower clamping steel plate and the beam lower

surface. These gaps are widest when the beam is undeformed, but as the beam is de-

formed downward, the lower gap gradually closes, thus slightly reducing the beam's ef-

fective length L and thereby more significantly increasing its tip stiffness, kE  =  3EI    3

                                                                                          L,

from Example Problem 7-2. The static gravity load of the concentrated-mass assembly

shown on Fig. 7-10 closed the lower gap, relative to its width on Fig. 7-6 without the

concentrated-mass assembly. Thus, it is indeed likely that the average beam-tip stiffness

during the response recorded on Fig. 7-11 was greater than that during the responses re-

corded on Figs. 7-7 and 7-9. The actual clamping support and restraint of the aluminum

beam in this experiment is clearly not the ideal, perfectly sharp edge and completely rigid

wall that the elementary theory assumes for a cantilever beam.

                7-16
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

7-7 Homework problems for Chapter 7

7.1 A particular device is known to be an LTI mass-spring system having negligible

damping. It is required that stiffness constant k and mass m be identified experimentally.

Stretched spring       x0 Taut string              First, a static force of 100 N is ap-
before t = 0                   before t = 0        plied through a string tied to the
                                                   mass, producing a static translation
        k             m                            of the mass. Next, the string is cut

                                                   cleanly, allowing the system to vi-

Position of mass for                Accelerometer  brate freely from the initial static
unstretched spring                                 translation (with zero initial veloc-
                                                   ity). The subsequent motion is

measured by an accelerometer, a sensor that is attached to the system mass and measures,

of course, translational acceleration of the mass. The measured acceleration is described

with good accuracy by the equation

               a(t)  &x&(t) = -4.93cos(10 t) 2 m , for 0 < t, with t in seconds
                                                     sec

(a) Differentiate twice Eq. (7-12) for displacement, x(t) = xmax cos(nt +  ): first, to de-

rive the associated equation for velocity, v(t) = x&(t) ; and second, to derive the associated
equation for acceleration, a(t) = v&(t) = &x&(t) .

(b) From the experimental data given previously and your results in part (a), infer values
(with units) for stiffness constant k and mass m.

7.2 Consider again the reaction wheel assembly introduced in Section 3-3 (Fig. 3-1), but
now suppose that there is a rotational spring with stiffness constant k connecting the
shaft to a rigid wall. Also, for this problem only, assume that the bearing viscous
damping torque is negligible.

Motor                 Rotational    (a) Sketch a rotational FBD (similar to that in Sec-
torque Mm(t)          inertia J
                                    tion 3-3, but with appropriate differences), then ap-
               (t)            k     ply Newton's 2nd law for rotation to derive the 2nd
                                    order ODE for wheel rotation (t). This ODE
                                    should have the form of Eq. (7-2), but with the

                                    notation appropriate for this system.

(b) Convert the ODE of part (a) into the standard form (7-5), && +  n 2 =  n 2u(t) . Write

specific equations (in terms of this system's parameters and notation) for natural fre-
quency n and input quantity u(t).

(c) The electric torque motor that drives the rotor generates 4.00 oz-inch of torque per
amp of electrical current (1 lb = 16 oz). According to the motor manufacturer, the current
should be limited to 5.00 A or less in order to avoid toasting the motor, so the maximum

                                     7-17
   Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

motor torque is 20.0 oz-inch. Suppose that this maximum torque is applied to the rotor as
a step function. It is required that the subsequent rotation angle (t) of the rotor not ex-

ceed 45°. Calculate the minimum stiffness constant k (units of lb-inch/rad) that will
limit the step response (t) to 45° or less. Also, calculate the natural frequency in Hz of
the system with this value of k. The rotor has rotational inertia J = 2.56e-3 lb-sec2-inch.

7.3 In the test laboratory of a spacecraft manufacturer, a vibration-isolation platform is

supported on a flexible foundation so that the vibration induced by traffic on a busy

nearby freeway will not disturb functional testing of delicate space-qualified components.

   y(t)              The platform weighs 907 kgf , and the flexible foundation has

                     nominal stiffness constant k = 3,440 kN/m.

     Platform        (a) Calculate the predicted values of system natural frequency
Flexible foundation  in rad/sec and Hz, and system natural period Tn. Recall from
                     Section 3-2 that the kgf is not a consistent unit in the SI sys-
                     tem. (partial answer: n = 61.6 rad/sec)

(b) In a test to determine precisely the dynamic characteristics of this mass-spring

system (having negligible damping), the platform is to be given initial downward
displacement y(0) = -0.104 mm (relative to the static equilibrium position) and initial
upward velocity y&(0) = +7.20 mm/sec. The platform will then be allowed to vibrate
freely. Write the numerical algebraic equation for the predicted response y(t) in mm.

7.4 Consider the rolling motion of a balloon carrying a basket, with the vehicle neither
ascending nor descending.7 Weight W of the vehicle acts downward through the

                            vehicle's center of gravity G, and buoyancy force W acts

   W                        upward through center of buoyancy M, which is the

                            center of gravity of the volume of air displaced by the

   M (t)                    vehicle. We denote as R the separation of G and M in
                            the vehicle's plane of symmetry. Note that with M

R                           above G, weight and buoyancy form a stabilizing couple

                            moment, the moment arm being R sin . Suppose that

                            wind, gusts, and possibly other forms of disturbance and

                     Mr(t)  control exert an externally applied rolling moment about
                            G, which is denoted as Mr(t). Denote the vehicle's

          G                 rotational inertia about G as JG. Assume that the vehicle

                            rolls about point G, as if there were a frictionless hinge

          W at G, and neglect all sources of damping.

(a) Apply Newton's 2nd law for rotation to derive the linearized 2nd order ODE for roll
angle (t), assumed to be sufficiently small that sin   radians . This ODE should

have the form of Eq. (7-2), but with the notation appropriate for this system.

7 The same basic principles of dynamics and fluid statics apply if the vehicle is a submerged submarine.

                                                   7-18
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

(b) Convert the ODE of part (a) into the standard form (7-5), && +  n 2 =  n 2u(t) . Write
specific equations (in terms of this system's parameters and notation) for rolling natural
frequency n and standard input variable u(t). (partial answer: n = WR JG )

7.5 (adapted from Craig, 1981, Problem 5.1 on page 120) In             Fuselage
single-engine, high-wing, general-aviation airplanes, the structures   cross-
of the main landing gears are usually simple tilted cantilever         section
beams, as illustrated in the drawing at right. When this type of
airplane touches down in a landing, the beams, in combination           Landing
with the flexible tires, constitute a structural spring that cushions  gear beams
the landing impact.

The drawings below show a    simplified    model used to study landing impact of a light
airplane, with mass m being  that of the   airplane body, and stiffness k being that of the

before contact      t        = 0               landing gear beams and tires. (The model
                             m                 also represents a person bouncing passively
m                                              on a pogo stick.) The airplane's sinking
                                     y(t)      speed just before touchdown is denoted as
                 V              k              V, and g is the acceleration of gravity. Let's
                g                              call the instant of tire contact t = 0 and
                                               measure the airplane's downward vertical
                                               motion y(t) relative to its position at that in-
                                               stant, as indicated on the right-hand draw-
                                               ing. Hence, the initial conditions are y(0) =
                                               0 and y&(0) = V.

(a) Sketch a FBD of the forces acting upon m during the time of tire contact with the
ground, and use that FBD and Newton's 2nd law to write the 2nd order ODE of motion for

y(t). Note in this case that we measure motion relative to the spring-undeformed position,

not relative to the static equilibrium position, so it is necessary to include the body weight

W = mg on the FBD.

(b) Put the ODE of motion into standard form. Now combine both the IC solution (since
y&(0) = V > 0) and the step-response solution (since W is essentially a step input) that are
derived in Section 7-3 to write the algebraic equation for the response y(t) during the time
of tire contact. Express this equation in the form y(t) = C1 + C2 sin(nt - C3), where the
Ci and n are positive constants that you should define in terms of the given algebraic
parameters. You should find useful the trigonometric identity sinA cosB ± cosA sinB =
sin(A ± B). If necessary, review the procedure in Section 4-3, Eqs. (4-6)-(4-8), for com-

bining sines and cosines.

(c) Use the correct result from part (b) above to sketch a time history of the response y(t)

during the time of tire contact. To make it relatively easy to sketch, suppose that the

landing is hard, with V n = 3W k , and show that y(t) = (W k)[1 + 2sin(nt - 30°)].

                                           7-19
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

From your y(t) equation and sketch, infer general algebraic equations (not applicable only
for V n = 3W k ) for the maximum value ymax, the time at which y(t) = ymax, and the
time at which the tires loses contact with the ground upon rebound. For what range of
landing impact velocities V does this theory predict that the tires will lose ground contact
upon rebound? Is this theory completely realistic?

7.6 The ideal LC circuit8 drawn below is a series combination of a voltage source ei (t) ,

an ideal inductor (having only inductance L, no resistance), and a capacitor with

capacitance C. Recall that the current is the rate of change of charge q(t) on the

            capacitor, i = dq dt . Apply Kirchhoff's voltage law, as in

L           Electricity Example 4 of Section 5-2, and show that the ODE for

            eo(t) q(t) is L q&& + (1 C)q = ei (t) . Convert this ODE into the standard

ei(t) i(t)  C 2nd order form (7-5), q&& + n 2q = n 2u(t) ; write specific equations
                 [in terms of L, C, and ei (t) ] for natural frequency n and input

            quantity u(t).

7.7 The circuit9 drawn at             C1               C2                  R

right consists of three stages,

each built around an op-amp, R1f                   R2                   R

and there is feedback of vol-

tage ef(t) from the last (right- R1i        em(t)                eo(t)           ef(t)

hand) stage to the first (left-
hand) stage, where the input ei(t)

voltage ei(t) is applied. The
circuit output voltage, eo(t), is
the output of the middle stage. For the first stage, a summing, inverting integrator, use
the methods of Chapter 5 to derive the first ODE, e f R1 f + ei R1i = -C1 e&m . Next, for

the middle stage, an inverting integrator, derive the second ODE, em R2 = - C2 e&o

(homework Problem 5.6). Now differentiate the second ODE and use the result to
substitute for e&m in the first ODE. The last stage is a simple sign inverter, for which ef =

- eo from Eq. (5-13b). Substitute for ef and show that the ODE relating output voltage

eo(t) to input voltage ei(t) for the entire circuit is e&&o + 1 eo = 1 R1 f ei .
                                                   R2C2 R1 f C1         R2C2 R1 f C1 R1i

Convert this ODE into the standard 2nd order form Eq. (7-5), e&&o + n 2eo = n 2u(t) ; write

specific equations (in terms of this circuit's resistances, capacitances, and input voltage)
for natural frequency n and input quantity u(t).

8 The LC circuit is a simplified model for devices such as antennas and cavity resonators that transmit and
receive electromagnetic energy (Halliday and Resnick, 1960, Chapters 38 and 39). Also, cascades of LC
pairs are often used as passive filters in radiofrequency, 100 kHz and above, applications (Horowitz and
Hill, 1980, pages 654-656).
9 This circuit with op-amps, capacitors, and resistors is essentially the electronic analog computer (see the
footnote to Problem 5.6) for solving ODE (7-5).

                                      7-20
     Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

7.8 If you compare the experimental results for a beam that are presented in Example
Problem 7-1 (page 7-11) with the ideal theoretical results presented in Example Problem
7-2 (page 7-12), you will observe that there are some significant differences between the
two sets of results. In this problem, you will investigate some reasons for those
differences.

(a) The beam of Fig. 7-6 is an extruded aluminum "flat". Due to manufacturing imper-
fections, its cross section is not completely uniform (constant) along the length; however,
students made the following careful measurements of average cross-sectional dimen-
sions: width b = 2.00 inches, depth h = 0.120 inch. The students also measured the
average weight per unit length of 0.0230 lb/inch. Using this information, calculate the
"actual" average weight density w in lb/inch3, and compare your value with the standard
(in preliminary-design calculations) value for aluminum, 0.1000 lb/inch3, which is used

in Example Problem 7-2. Also, calculate the total weight of the beam, Wb in lb, based

upon the lengthwise weight density 0.0230 lb/inch, and assuming L = 10.00 inches.

(b) In a series of independent tests on aluminum flats from the same manufactured lot as

the beam of Fig. 7-6, students measured the average modulus of elasticity in bending E =
9.43e+6 lb/inch2, which is about 6% lower than the standard (in preliminary-design cal-
culations) value of 10.0e+6 lb/inch2. Use this measured value, along with the measured

dimensions from part (a) to calculate the effective beam-tip stiffness constant kE =

3EI    3  ,  assuming  that  the  beam  overhang  length  is  precisely  L  =  10.00  inches.  Also,

     L

compare this calculated value of kE with the measured value of 7.86 lb/inch from

Example Problem 7-1 and with the ideal theoretical value of 9.766 lb/inch from Example
Problem 7-2.10 [NOTE: It can be shown, by evaluation of propagation of error,11 that a

small error in the value of depth h produces three times that error in the calculated

stiffness constant kE (for example, a 2% error in h produces a 6% error in kE ); similarly,

a small error in the value of length L produces three times that error in kE .]

(c) Use the weight Wb that you calculated in part (a) to calculate the effective tip mass of
the bare beam alone from mbE = 0.242672 ×Wb g , in which 0.242762 is the theoretical
factor introduced in Example Problem 7-2. Next, calculate the total effective tip mass,
including the mass of the steel target that is bonded to the beam tip on Fig. 7-6, from mE
= mbE + (0.0081 lb) ÷ (386.1 inch/sec2). Finally, use this mE and the kE that you calcu-
lated in part (b) to determine a corrected estimate (relative to that of Example Problem 7-
2) for natural frequency fn in Hz.

10 Example Problem 7-3 (page 7-16) describes how tiny gaps between the thick steel clamping plates and
the aluminum beam surfaces might change the effective beam length L. It is worth observing also that an-
other possible source of stiffness error, which is difficult to assess quantitatively, is some significant flexi-
bility in the steel clamping plates. The theoretical equation for beam-tip stiffness is based on the assump-
tion that the clamping medium is completely rigid.
11 Propagation of error is discussed in textbooks on experimental instrumentation and measurements, for
example, Dally, Riley, and McConnell, 1984, pages 544-545.

                                        7-21
   Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

7.9 For the undamped (or lightly damped) mass-spring system drawn below at left, Eq.
(7-3) gives the natural frequency as n = k m . If we attach an additional mass ma to
the original mass, as drawn below at right, then the natural frequency of the modified
system is an  k (m + ma ) .

                         x(t)                           x(t)

      k                              k

                      m                 m ma

      Original system                Added-mass system

(a) Suppose that the parameters m and k of the original system are unknown, but that we

know the value of the added mass ma , and that we are able to measure experimentally

the natural frequencies n and an . Derive algebraically the following equation for the

unknown mass m: m = 2 ma . The traditional method described here may be
                             (n an ) - 1

called the added-mass or added-inertia method.12

(b) Apply the added-mass method of part (a) to calculate both the 2nd order effective tip-
mass quantity mE and the 2nd order effective tip-stiffness constant kE of the beam struc-
tural system shown on Fig. 7-6. The data that you will need is stated in Example Prob-
lems 1 and 3: the measured natural frequency of the original system is fn = 34.0 Hz; the

concentrated-mass assembly that was added to the beam tip (Fig. 7-10) weighs 0.254 lb;
and the measured natural frequency of the added-mass system is fan = 15.85 Hz.

7.10 A distributed-parameter structural system13 is shown in the drawing; the "snapshot"

            m            x(t) of a dynamic deformation state (with exaggerated
                                 magnitude) is drawn in dashed lines. This system
b        h
                         fx(t) consists of an essentially rigid block of mass m and
                                 two parallel cantilever beams. The two flexible (in

                               bending) beams are nominally uniform and identi-

   L                           cal to each other, with rectangular cross section of

                               width b, depth h, and cross-sectional area A = bh.

                               The beams are embedded into the mass, just as

                               they are embedded into the foundation below. In-

Side view Front view           plane rotation of mass m is suppressed by the very

12 The added-mass method is an elegantly simple technique for finding experimentally the unknown para-
meters of a 2nd order, or approximately 2nd order, linear mechanical system. The method requires only that

we be able to measure accurately the free-vibration frequencies; otherwise, the motion sensors and other

instrumentation can be uncalibrated. Use of the added-mass method is a simple example of system identifi-

cation, which is discussed at greater length in Section 9-9.
13 This structure is a rudimentary form of one-story shear building that is used for studying the structural

dynamics of buildings (Craig, 1981, pages 42, 265, 346, etc.; Clough and Penzien, 1974, pages 226-227).

The rigid mass represents a floor slab/girder, and the flexible beams represent structural columns.

                               7-22
Chapter 7 Undamped 2nd order systems: general time response; undamped vibration

high axial stiffness of the beams and the separation of the two beams. The bending

slopes of the beams where they join mass m are essentially zero due to the rigidity of

mass m and of the beam-to-mass joints. Provided that forcing [such as fx(t) on the

drawing] and/or initial conditions are in the plane of the paper, motion of the mass is

restricted to one-dimensional translation, x(t). You should be able to verify from a

textbook on mechanics of materials that the total effective stiffness constant of the two

beams that restrain motion of mass m is kE  ( f x  x) static = 2 ×12EI    3  We can account

                                                                        L.

for the contribution of the beams' mass to the approximately 2nd order dynamics of this

system by using what is known in more advanced theory as the consistent mass of a

distributed-parameter structure. We denote the weight per unit volume of the beam

material as w and the mass density as   w g . Then the total consistent mass from the

two beams, which effectively moves with mass m through translation x(t), is 2 mc =
2 × (156 420) AL (Craig, 1981, page 387); thus, the total effective mass of the struc-

tural system is mE = m + 2 mc .

(a) Write an algebraic equation for the natural frequency n in rad/sec of this structural
system in terms of the system parameters E, I, L, m, w, A, and g.

(b) Consider an actual fabricated version of this structural system, shown in the photo-

graph, which is used in an instructional laboratory
experiment.14 The beams are extruded aluminum

"flats", from which students made the following

careful measurements of average dimensions and

properties: L = 12.00 inches, b = 2.010 inches, h =
0.1259 inch; w = 0.0965 lb/inch3; E = 9.40e+6 lb/
inch2. The relatively rigid mass m was machined

from an aluminum block; the students measured its

weight as 1.61 lb. Calculate the natural frequency

 fn in Hz of this laboratory apparatus.

14 The principal plane of the actual laboratory apparatus is horizontal relative to gravity. The photograph is
rotated 90° to make the plane appear vertical, in order to match the drawing on the previous page.

                                                   7-23
Chapter 8 Pulse inputs; Dirac delta function; impulse response;
                initial-value theorem; convolution sum

                © 2016 by William L. Hallauer, Jr.

         We analyzed previously the response of systems to a half-sine pulse input (e.g., in
Sections 1-5 and 1-6). In this chapter, we will continue analysis of pulse excitation and
subsequent dynamic response. Most importantly, we will extend the analysis to the con-
cept of the impulse, which in its simplest form is u × td, the product of excitation and the
duration of excitation. In particular, the Dirac delta or ideal unit-impulse function is es-
sential in the theory of linear systems and also useful in practical applications.

8-1 Flat pulse

This is probably the simplest form of limited-duration input. We define the flat

pulse initially in the form of a general (standard) input quantity u(t) that can be used with

standard forms of system ODEs such as x& + (1 1)x = b u(t) for a stable 1st order system

and &x& + 2n x& + n 2 x = n 2u(t) for 2nd order systems. u(t)

Figure 8-1 illustrates a flat pulse of duration td. It can be U

described mathematically with use of two unit-step func-

tions, as defined in Section 2-4:                           0 0 td t

                u(t) = U [H (t) - H (t - td )]  (8-1) Figure 8-1 Flat pulse

The Laplace transform of Eq. (8-1), from Eqs. (2-28) and (2-29), is

                L[u(t)] = U  1 -  e  = -std  U (1- e-std )           (8-2)

                             s s  s

Example: response to a flat pulse of an undamped 2nd order system1

        The ODE for an undamped 2nd order system is &x& +  n 2 x =  n 2u(t) . Let the initial
conditions be zero: x0 = 0 , x&0 = 0 . The general solution then is either of the two convo-
lution integral forms, Eqs. (7-9a) and (7-9b). Of those two, the easier one to interpret for
the discontinuous flat pulse is Eq. (7-9b), which with zero ICs becomes

                                   =t                                (8-3)

                x(t) =  n  sin  n (t -  ) × u( ) d
                                   =0

1 See also homework Problem 8.3 for a simple yet elegant direct Laplace-transform solution of this problem
and a physically meaningful response equation.

                                                    8-1
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

Rather than use Eq. (8-1) explicitly, we can observe the form of Fig. 8-1 and write Eq. (8-
3) for two different time intervals:

       =t
     n  sin n (t - ) ×U d , 0  t  td
       =0
     x(t) =   =td                                                                                 (8-4)
                                                         =t

     n  sin n (t - ) ×U d + n  sin n (t - ) × 0 d ,                              td  t

       =0                                                =td

The second integral for td  t is obviously zero. This leaves us with a single integral for
each time interval, each integral having the same integrand and lower limit. However,
the integrals have different upper limits, so let's denote a general upper limit as T, and
evaluate that common integral with use of the change of integration variable  = t -  
d = - d :

 =T  =t-T 1  =t-T 1

 sinn (t -  ) d =  sinn(- d) =  d (cosn ) = [cosn (t - T ) - cosnt]
 =0     =t                            n =t                                n

Upper limit T  t for 0  t  td of Eq. (8-4), and T  td for td  t , so substituting the in-
tegration result into (8-4) gives the final equations,

                   U (1 - cosnt), 0  t  td
                   
                   x(t) =                                                                         (8-5)

                            U  [cos  n  (t  -  t  d  )  -  cos  n  t  ],  td  t
                   

Equation (8-5) for 0  t  td is just the simple step response of Eq. (7-14), as it logically

should be. Inspection of Eq. (8-5) shows that the response x(t) is continuous at t = td ; by
differentiating both response equations, we could show that the velocity term x&(t) also is
continuous at t = td . Indeed, these response quantities should be continuous, because Eq.

(8-5) describes a physical response (e.g., of a mass-spring system). In fact, we could
solve this problem differently from the beginning by using the requirement of continuity
along with step-response (7-14) and IC response (7-12). Step response (7-14) is valid
from t = 0 to t = td ; then we could find x(td ) and x&(td ) from the step response and use
those values as initial conditions for the IC solution to be valid for t  td .

8-2 Impulse-momentum theorem for a mass particle                                      x(t), v(t)
translating in one direction                                              fx(t)

                                                                                 m

         An unrestrained mass particle subjected to force                        Area = IF (td)
acting only in the x direction is shown in the drawing at fx(t)
right. The equation of motion is

                                                                      0 0 td t
                                            8-2
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

                              m&x& = f x (t)  mv& = f x (t)

Integrating the equation of motion from time zero to any time t > 0 gives

                     =t dv  =t                                                    (8-6)

                  m  d = mv(t) - mv(0) =  f x ( ) d  I F (t)
                   =0 d                        =0

in which I F (t) is the area under the force time history and is called the impulse of the
force, with dimensions of force × time. Equation (8-6), the impulse-momentum theorem
for a mass particle, states that the change of momentum equals the impulse. For a pulse,
a force of limited duration as in the drawing on the previous page, we are generally inter-
ested in the total impulse I F (td ) , which remains unchanged for t > td.

8-3 Flat impulse

The flat impulse, Fig. 8-2, is defined almost identically with the flat pulse, the

only difference being that we specify the magnitude of the generalized impulse, IU, which

is the area under the time history of the flat pulse, then we          u(t)    Area IU
define the magnitude of the input function in terms of the        U = IU
impulse and duration, U = IU td . Thus, for the flat im-
                                                                        td
pulse, from Eq. (8-1),

u(t) = IU [H (t) - H (t - td )]                     (8-7)              0 0 td t
                                                                  Figure 8-2 Flat impulse
        td

8-4 Dirac delta function, ideal impulse

Consider a limit process with the flat impulse of Fig. 8-2, in which process we

progressively shorten the pulse duration while maintaining constant the impulse magni-

tude (the shaded area), thereby progressively increasing the input magnitude, IU td . If

we carry the process to the limit as td  0 while maintaining IU constant, then magni-

tude IU td  . The limit process is illustrated on Fig. 8-3. The function that results is

called an ideal impulse with magnitude IU , and it  u(t)          u(t) = IU  (t)
is denoted as u(t) = IU ×  (t) , in which  (t) is   I U           Area IU
called the Dirac delta function (after English      td
mathematical physicist Paul Dirac, 1902-1984) or

the unit-impulse function. The ideal impulse func-             0             

tion IU  (t) is usually depicted graphically by a

thick picket at t = 0, as on Fig. 8-3. With IU = 1  0 0 td t                   00 t
in Eq. (8-7), a formal mathematical definition of

the unit-impulse function is                        Figure 8-3 Ideal impulse

                                         8-3
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

 (t) = lim 1 [H (t) - H (t - td )]                                                 (8-8)

        td 0 td

Observe from Eq. (8-8) that the dimension of  (t) is time-1, since the unit-step is dimen-
sionless, so the typical unit of  (t) is sec-1.

By definition, the area under u(t) = IU  (t) equals IU , so the area under  (t)

equals 1 (hence the name unit-impulse function). This unit area under an infinitely short

impulse suggests an important effect of the Dirac delta function in integrands. In order to
describe this effect, we define a more general unit-impulse function,  (t - t ) , which

peaks infinitely at some arbitrary time t that is not                 (t - t )
necessarily zero; otherwise, the nature of  (t - t ) is

identical to that of  (t) [in fact,  (t) =  (t - t ) for             Area 1

t = 0]. Now suppose that we have some realistic                      f (t) f (t)
physical function f (t) that is defined over the time

interval t1  t2 , and suppose that time t is within

this interval, as in the figure at right. Then the useful  t1  0  0             t  t2 t

integration effect of  (t - t ) is:

t =t2                                                                              (8-9)

 f (t)  (t - t ) dt = f (t )

t =t1

Equation (8-9) states that, as a multiplier within the integrand,  (t - t ) essentially "se-
lects" the value of f (t) at t = t . Result (8-9) is intuitively clear, and it can be proved
more rigorously with the theory of so-called generalized functions (Lighthill, 1958).

         If the upper limit of integration in Eq. (8-9) is an arbitrary time t > t , then the re-
sult is a step function:

 =t >t                                                                             (8-10)

  f ( )  ( - t ) d = f (t ) H (t - t )

  =t1

Setting f ( ) = 1 in Eq. (8-10) leads to a fundamental integral relationship between the
unit-impulse function and the unit-step function:

 =t >t                                                                             (8-11)

  ( - t ) d = H (t - t )

  =t1

                                     8-4
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

Next, we use Eq. (8-9) to derive the Laplace transform of delta function  (t) =

 (t - 0) . According to the definition of Eq. (2-13), this transform would

be written as L[ (t) ] =  t= t=0 e-st (t - 0) dt ; however, there is a problem   (t - 0)

with this particular definition: at t = 0, which is the lower limit of the

integrand (and the initial-value instant for most ODEs that we solve us-
ing Laplace transforms), the function  (t - 0) is nominally infinite, so 0- 0+ t
the meaning of the integral is uncertain. We choose to remove the un- 0
certainty by specifying that  (t - 0) must lie within the limits of the inte-

gration. In order to indicate this clearly in notation, we now define three different refer-
ence instants, as depicted on the drawing at right: (1) t = 0- , the instant just before activ-
ity of the ideal impulse function, at and before which  (t - 0) = 0; (2) t = 0, the instant

when  (t - 0) acts and is nominally infinite; and (3) t = 0+ , the instant just after activity

of the ideal impulse function, at and after which  (t - 0) = 0. Accordingly, we re-define

the Laplace transform, more generally than in Eq. (2-13), as

                       t =                                                      (8-12)

L[ f (t) ] =  e-st f (t) dt
                      t =0-

The distinction between t = 0 and t = 0- in the lower limits of Eqs. (2-13) and (8-12), re-
spectively, is meaningless for all problems considered in this book except those in which
 f (t) involves an ideal impulse function. Application of Eqs. (8-9) and (8-12) now leads

to the Laplace transform of the basic ideal impulse function:

                       t=                                                       (8-13)

L[ (t) ] =  e-st (t - 0) dt = e-s×0 = 1
                      t=0-

8-5 Ideal impulse response of a standard stable 1st order system

From Eq. (3-7), the problem statement for a standard stable 1st order system is

ODE + IC: x& + (1 1)x = b u(t), x(0) = x0 , find x(t) for t > 0 (6-4, repeated)

Let the input function be the ideal impulse, u(t) = IU  (t) . Although there are several

methods for finding response to an ideal impulse, the conventional Laplace-transform
approach is relatively simple and probably the most instructive, so we will use this
method. With L[ (t)] = 1 from Eq. (8-13), the steps of the solution are:

L[ODE]: s X (s) - x0 + (1 1 ) X (s) = bU (s) = b IU ×1

8-5
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

         X (s) = x0 + b IU                                                (8-14)
                       s +11

         x(t) = (x0 + b IU ) e- t 1                                       (8-15)

As a check, we evaluate the solution at t = 0:                            (8-16)
                              x(0) = (x0 + b IU ) e- 0 1 = x0 + b IU  x0

It appears that something is wrong with response solution Eq. (8-15), because Eq. (8-16)
for x(0) contradicts the original IC, x(0) = x0 . In order to explain this discrepancy, we
must account more carefully for the nature of response to an ideal impulse, and for the
distinction between the three different reference instants that are defined in the previous
section: (1) t = 0- , the instant just before activity of the ideal impulse function; (2) t = 0,
the instant when  (t - 0) acts; and (3) t = 0+ , the instant just after activity of the ideal
impulse function. The more detailed analysis follows.

        We begin by integrating the basic ODE, x& + (1 1)x = b IU  (t) , across the ideal
impulse function, just from t = 0- to t = 0+ :

 =0+ dx 1  =0+  =0+
 d +  x d = b  IU  ( - 0) d                                               (8-17)
 =0- d  1  =0-
                      =0-

The first left-hand-side term of Eq. (8-17) is identically equal to x(0+ ) - x(0- ) ; this re-
sult introduces the new quantity x(0+ ) , which apparently is the post-impulse initial value
at t = 0+ ; the pre-impulse initial value, x(0- )  x0 , is the original IC specified in Eq. (6-
4), but now understood to exist at t = 0- . The right-hand-side integral of Eq. (8-17) gives
the finite area IU under the infinite ideal impulse function. In contrast, the second left-
hand-side term of Eq. (8-17) has a finite integrand; we can use the trapezoid rule to ap-
proximate the value of the integral and find that it is zero:

 =0+                                                                      (8-18)

 x d  lim{12 [x(0+ ) + x(0- )]t} = 0
     - t0
 =0

In Eq. (8-18), t  0+ - 0-  0 , in the spirit of the idealization that the ideal impulse
function acts over an infinitesimal time interval. Therefore, Eq. (8-17) gives x(0+ ) - x0
+ 1 1 × 0 = b × IU , or

        x(0+ ) = x0 + b IU                                                (8-19)

                8-6
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

Comparing Eqs. (8-16) and (8-19) shows that the term x(0) in the former equation really
should be the post-impulse initial value, x(0+ ) .

         Equation (8-19) can also be found directly from the Laplace transform X (s) by
application of the initial-value theorem:

      +lim f (t)  f (0+ ) = lim[sF (s)]                                         (8-20)
      t0 from t >0                           s

We present only the relevant application of the initial-value theorem here; derivation of
the theorem itself is postponed to Section 8-6. Applying Eq. (8-20) to Laplace transform
solution (8-14) gives

       x0 + b IU                             s                          
x(0 ) = lim[s X (s)] = lim s ×+               = lim × (x0 + b IU ) = x0 + b IU

   s  s s + 1 1  s s                                                    

This consequence of the initial-value theorem is identical to Eq. (8-19), which was de-
rived by a different method.

Finally, we present an application of Eq. (8-19) to a mechanical system, and we

show that the result conforms with a principle of mechanics. Consider a mass-damper

system with mass m and viscous damping constant c, as drawn                     x(t)

at right. The mass is initially moving with velocity v(0- ) = v0          c  m
                                                                                       fx(t)
when, at t = 0- , the mass is disturbed by an ideal force impulse,

f x (t) = I F  (t) . The equation of motion is mv& + cv = f x (t) , or

in terms of a standard stable 1st order system, v& + (1 1 )v = b u(t) , in which 1 = m c ,

b = 1 m , and u(t) = f x (t) = I F  (t) , so that IU = I F . The initial (pre-impulse) momen-

tum of the mass is m v0 . According to Eq. (8-19), the post-impulse velocity of the mass

is v(0+ ) = v0 + (1 m) × I F = v0 + I F m , so that the post-impulse momentum of the

mass is m v(0+ ) = m v0 + I F . In words, the momentum of the mass is increased exactly

by the magnitude of the ideal impulse, in agreement with the impulse-momentum theo-
rem, Eq. (8-6). Force impulse I F  (t) is a mathematically ideal impulse, not a physically

realizable excitation, so the mathematical change in momentum occurs instantly, and the

viscous dashpot has no influence on this instantaneous response. From Eq. (8-15), the
post-impulse response of the mass is v(t) = (v0 + I F m) e- t 1 , t > 0.

8-6 Derivation of the initial-value theorem

         Consider a physical function f (t) , with derivative df dt , and with Laplace trans-
form L[ f (t)] = F (s) . The initial-value theorem is:

                                8-7
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

       +lim f (t)  f (0+ ) = lim[sF (s)]                        (8-20, repeated)
       t0 from t >0                   s

In general, Eq. (8-20) gives the initial value f (0+ ) of a time function f (t) based only on
the Laplace transform L[ f (t) ] = F(s), without requiring that the equation for f (t) be
available. If f (t) is dynamic response to excitation that involves the ideal unit-impulse
function  (t - 0) , then f (0+ ) is the post-impulse initial value, as defined in Section 8-5;
otherwise, f (0+ )  f (0)  f (0- ) , which is the standard initial value known to exist
before excitation occurs.

         Our derivation of the initial-value theorem (from a more detailed proof in Can-

non, 1967, p. 569) is based upon the form of Laplace transform that can accommodate the
ideal impulse function  (t - 0) :

                                      t =                       (8-12, repeated)

               L[ f (t) ] =  e-st f (t) dt
                                      t =0-

First, we need the following Laplace transform of a derivative, the transform that is asso-
ciated with definition (8-12):

       d  -s t t = df -                                            (8-21)

     L f (t) =  e dt = sF (s) - f (0 )

       dt  t =0- dt

The derivation of Eq. (8-21) using integration by parts is almost identical to the deriva-
tion shown in Eq. (2-15a), the only difference being the lower limit of the integral at t =
0- instead of t = 0. We don't need the corresponding formula for higher-order deriva-
tives right now, but it is appropriate here to state that the initial conditions at t = 0 in gen-
eral formula (2-16) may similarly be replaced by values at t = 0- :

dn   n               n-1           -  n-2 & -   ( n -1)
                                                           -
L n f (t) = s F (s) - s f (0 ) - s f (0 ) - L - f (0 )             (8-22)
 dt
     

Next, taking the limit of all terms in Eq. (8-21) as s   gives

 df     t =0+  df         t=          -s t df 
                                        dt = lim[sF(s)]- f (0 )
lim L  = lim  1× dt +  e                                        -  (8-23)
                                      dt  s
s  dt  s - dt                                 
        t =0              t =0  +

In Eq. (8-23), we separate the definite integral into two parts: (1) a part over the interval
from t = 0- to t = 0+ , during which we set e-s t = 1 (and during which an ideal impulse
including  (t - 0) could be acting); and (2) a part over the interval from t = 0+ to t =  .

The integrand of the second part includes e-s t , and since s  , we set this integral to

                          8-8
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

zero: lim  + t= e-s t (df dt) dt = 0 . Furthermore, the first integral, which now is inde-
               s t=0

                                      t =0+                   +         -
pendent of s , is evaluated identically as  - (df dt) dt = f (0 ) - f (0 ) . Therefore,
                                      t=0

Eq. (8-23) becomes

                     df 
                    lim L  = f (0 ) - f (0 ) = lim[sF (s)]- f (0 )+--         (8-24)

                    s  dt                    s

                             f (0+ ) = lim[sF (s)]
                                                           s

This is the version of initial-value theorem that was applied in Section 8-5 to re-derive
result (8-19).

         If f (t) is dynamic response to excitation that does not involves an ideal unit-im-
pulse function  (t - 0) , then there is no discontinuous jump at t = 0, i.e., f (0+ ) - f (0- )
= 0. For this case, therefore, Eq. (8-24) gives the more common (but less general) ver-
sion of initial-value theorem:

                               f (0- ) = lim[sF (s)]
                                                                                            s

8-7 Ideal impulse response of an undamped 2nd order system

        The ODE for a standard undamped 2nd order system is &x& +  n 2 x =  n 2u(t) . Let
the input function be the ideal impulse, u(t) = IU  (t) , and let the pre-impulse initial
conditions be x(0- )  x0 , x&(0- )  x&0 . Just as for the 1st order system with ideal-impulse
excitation in Section 8-5, we will solve the present problem by the conventional Laplace-
transform approach. Note that we will use the second-derivative form of Eq. (8-22):
L[ &f&] = s 2 F (s) - s f (0- ) - f& (0- ) . With L[ (t)] = 1 from Eq. (8-13), the steps of the

solution are:

L[ODE]: s 2 X (s) - s x0 - x&0 + n 2 X (s) = bU (s) = n 2 IU ×1

                    n 2 IU + x&0 + s x0  x&0  n s
 X (s) =                            = n IU +                  2 + x0 2        (8-25)
                              2                 2                          2
                    2s + n                    n  s + n              s + n

                                    x&0                             +
 x(t) = n IU +  sin nt + x0 cosnt , t  0                                      (8-26)
                                    n 
                            

         At the risk of being excessively repetitive, we emphasize that the discussions in
Sections 8-5 and 8-6 show that response (8-26) is the post-impulse solution, certainly

                                    8-9
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

valid mathematically for t  0+ , but not necessarily correct, in particular, for the pre-
impulse initial conditions at t = 0- .

         Solution (8-26) holds for a general undamped 2nd order system; let's adapt it spe-
cifically to a mass-spring system, with zero initial conditions, that is hit by an ideal im-
pulse of force having magnitude I F , with units, for example, of N-sec or lb-sec. From
Eq. (7-4), we find

         u(t) = f x (t) k  IU  (t) = I F  (t) k  IU = I F k          (8-27)

So, for translational motion x(t) of the mass, Eq. (8-26) with zero initial conditions be-
comes (recall k = mn 2 )

             x(t) = n I F sin nt = I F sin nt                        (8-28)
             k        mn

Figure 8-4 shows a few cycles of response Eq. (8-28).

+ IF
mn

x(t) 0

- IF      n  2 n = Tn 3 n                              4 n   time t
mn

      0

         Figure 8-4 Ideal impulse response of a mass-spring system

8-8 Ideal impulse response vs. real response of systems

         Section 8-5 shows that, for a 1st order system subjected to excitation by an ideal
impulse function, the post-impulse initial value at t = 0+ of output x(t) differs from the
pre-impulse initial value at t = 0- . Let's now investigate the initial values in x(t) and
x&(t) that are associated with the 2nd order system of Section 8-7. The output itself is
given by Eq. (8-26): x(t) = (n IU + x&0 n ) sin nt + x0 cosnt , t  0+ . Evaluating this
equation at t = 0+ shows that the post-impulse value is x(0+ ) = x0 ; this is exactly the
same value as the given initial value at t = 0- , so there is no discontinuous change in the
initial value of x(t) itself for the 2nd order system. Differentiating Eq. (8-26) gives the
"velocity" function:

                8-10
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

x&(t) = (n 2 IU + x&0 ) cosnt - n x0 sin nt , t  0+  (8-29)

Evaluating Eq. (8-29) at t = 0+ gives

x&(0+ ) = n 2 IU + x&0  x&0 = x&(0- )                (8-30)

Thus, for the 2nd order system, there is a discontinuous change in the initial value of the
"velocity" function.

         The discontinuous changes that we observe in initial values for both 1st and 2nd
order systems violate physical laws governing real systems, so ideal impulse response
solutions appear to be defective and perhaps not applicable to real systems. The reason
for this defectiveness is the ideal, not real, nature of the Dirac delta function  (t) . In

physical reality, there is no such thing as a pulse of infinitely short duration and infinitely
great magnitude; so  (t) and IU  (t) are mathematical functions that do not represent

exactly any real physical quantities.

         However, the ideal impulse responses that we find can still be useful in applica-
tions to real systems, because the ideal impulse function IU  (t) can approximate the ef-

fect of a real, time-limited pulse that has the same impulse magnitude, IU ; therefore, the

ideal impulse response can approximate the actual physical response. Why would we use
the approximate ideal impulse response rather than just determining the more precise re-
sponse solution based upon the actual pulse? We would do this because it is always
much easier to derive and compute the ideal impulse response than the actual pulse re-
sponse; moreover, the equation for the ideal impulse response is always simpler and more
amenable to practical purposes (such as system identification, a form of which is dis-
cussed in Section 9-9) than the equation(s) for the actual pulse response.

         When is ideal impulse response a good approximation of real pulse response, and
when is it not? It depends on the duration td of the actual input pulse relative to the short-
est characteristic time Tc of the system that is being analyzed. The characteristic time is
defined loosely as the time interval required for system response to change substantially.
The system characteristic times that we know from previous chapters are time constant
1 for a 1st order system and about one quarter of a natural period Tn for a 2nd order sys-

tem. If td is brief relative to the system characteristic time, td << Tc, then the ideal im-
pulse response [Eq. (8-15) for a standard stable 1st order system, Eq. (8-26) for a standard
undamped 2nd order system, other equations for other types of systems] will be a good
approximation to the actual pulse response; on the other hand, if td is on the order of or
greater than the system characteristic time, O(td)  O(Tc), then the ideal impulse response
would be a poor approximation, and we should solve for the response using the actual
physical pulse. There is no hard and fast rule as to how small the ratio td/Tc should be to
justify use of the ideal impulse response solution.

                                       8-11
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

         In what manner would ideal impulse response differ from the actual pulse re-
sponse? Let's consider, for example, an undamped 2nd order system with zero ICs. Sup-

pose that the duration of the actual pulse satisfies td << ¼Tn, so that, according to the dis-

cussion above, the ideal impulse response should be a good approximation to the actual

response. But we already know from Eq. (8-30) that the initial velocity of the ideal im-

pulse response will be wrong, with value n 2 IU when it ought to be zero. How will the

remainder of the ideal impulse response compare with the actual response? Figure 8-5

depicts conceptually the       u(t) IU (t), ideal impulse
nature of both ideal im-
pulse response and the

comparable real response            Actual pulse
for a 2nd order system dur-        Area IU

ing the initial portion of

response. The real re-

sponse shows the correct
initial zero slope, x&0 = 0 . 0 0 td
                                                                          t

For a brief period after t =   x(t)
                                     Ideal impulse
0, the slope of real re-             response

sponse increases rapidly                                   Real pulse
                                                           response
until both the response x
and the slope x& essentially
match the comparable val-

ues of the ideal response,

but with a short time lag                          Short artificial time lead of ideal vs. real
relative to the ideal re-
sponse. In other words, the      00 t
ideal response has a short,
artificial time lead relative  Figure 8-5 Conceptual ideal impulse response and real
                               pulse response for an undamped 2nd order system

to the real response. After

the pulse ends, td < t, the real response is essentially identical to the ideal response, but

the ideal response maintains the same artificial time lead for all of the remaining dynamic

response. If the pulse duration is very short relative to the system quarter-period, then the

artificial time lead will be very small, perhaps not even detectable on a graph of the re-

sponse. In this case, ideal impulse response will clearly be an excellent approximation to

the actual response, and the ideal impulse response will be much easier to derive and

compute than the actual response.

         Note that the previous paragraph applies specifically for a 2nd order system, but
not necessarily for other system types. In particular, for a 1st order system, the differ-

ences between a real pulse response and the approximating ideal impulse response have a

different character (see, for example, homework Problem 8.5).

8-9 Unit-step-response function and unit-impulse-response function (IRF)

         From Chapter 4, Eq. (4-24), the general equation that relates the output Laplace
transform to the input transform through the system transfer function is

                                   8-12
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

L[x(t)] ICs=0 = TF (s) × L[u(t)]                                           (8-31)

Equation (8-31) is valid for any LTI SISO system. Suppose that the input to such a sys-
tem is the unit-step function, u(t) = U H (t) with step magnitude U = 1:

u(t) = H (t)  from Eq. (2-29), L[u(t)] = L[H (t)] = 1                      (8-32)
                                                                        s

We denote the unit-step-response function as xH (t) ; as usual for unit-step response and
unit-impulse response, we specify zero ICs. Substituting Eq. (8-32) into Eq. (8-31) gives

L[xH (t)] = TF (s) × 1                                                     (8-33)
                       s

        Next, suppose that the input is the ideal unit-impulse function, u(t) = IU  (t) with
impulse magnitude IU = 1:

u(t) =  (t)  from Eq. (8-13), L[u(t)] = L[(t)] = 1                         (8-34)

We denote the unit-impulse-response function, with zero ICs, as h(t), and we abbreviate
this important function in text as IRF.2 Substituting Eq. (8-34) into Eq. (8-31) gives

L[h(t)] = TF (s) ×1  TF (s)                                                (8-35)

Equation (8-35) is an important relationship in linear-system theory: The Laplace trans-
form of the unit-impulse-response function (IRF) equals the transfer function (TF).

Comparing Eqs. (8-32) and (8-34) shows that

                                     sL[H (t)] = L[ (t)]                   (8-36)

Next, applying Eq. (8-21), with H (0- ) = 0, then Eq. (8-36), gives

 dH                                  -  dH 
sL[H (t)] = L (t) + H (0 ) = L (t) = L[ (t)]                               (8-37)
 dt                                           dt 

Thus, we infer from Eq. (8-37) that

2 It would be consistent with notation xH (t) to denote the IRF as x (t), but the symbol h(t) is traditional and
very common. For examples, see Cannon, 1967, pp. 210, 293 and Meirovitch, 1967, p. 14.

                                                   8-13
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

dH (t) =  (t)                                                                   (8-38)
dt

We can also derive Eq. (8-38) formally by differentiating with respect to time t the fol-

                                                                                                      =t>0

lowing specific form of Eq. (8-11): H (t - 0) =  -  ( - 0) d . Expressed in words,
                                                                                                      =0

the time derivative of the unit-step function is the unit-impulse function. These deriva-
tions of Eq. (8-38) are not mathematically rigorous, and the result might seem implausi-
ble since both H (t) and  (t) are strongly discontinuous functions. However, Eq. (8-38)

can be proved with the theory of generalized functions (Lighthill, 1958), and it can also
be demonstrated plausibly with the use of limiting processes on functions other than the
flat impulse of Section 8-3 (e.g., homework Problem 8.6).

Comparing Eqs. (8-33) and (8-35) shows that

TF (s) = sL[xH (t)] = L[h(t)]                                                   (8-39)

Applying Eq. (8-21) again, with xH (0- ) = 0 by definition, gives

dxH (t) = h(t)                                                                  (8-40)
 dt

In words, the velocity of unit-step response equals the unit-impulse response. Equation
(8-40) for responses (outputs) is directly analogous to Eq. (8-38) for excitations (inputs).
The identical form of the two equations is a consequence of system linearity. Equation
(8-40) is another important relationship in linear-system theory, for which we shall have a
convenient application in Section 9-8.

8-10 The convolution integral as a superposition of ideal impulse responses

Suppose that an LTI system has zero ICs and that the input is an arbitrary physi-

cally realistic function, u(t) for t > 0. Let's apply directly the principle of superposition

to derive an equation for response x(t) at some arbitrary instant of time t > 0. At any in-

stant  less than t, 0 <  < t, the input u( ) imposes onto the system a differentially

small impulse of magnitude dIU = u( ) d , as is indicated conceptually on the figure at

right. Then the differentially small response at time t >          u()d
due to this impulse at  is dx(t) = dIU × h(t - ) = u
u( ) h(t - ) d , in which h(t - ) is the IRF due to a unit

impulse acting at instant  . Because this system is linear, 0      d
                                                                             dx(t)
we can express the total response as the superposition of re- dx
sponses due to all separate inputs, as is stated in Section 1-

2. In this case, there are an infinite number of separate in- 0
puts from the infinite number of instants  between time 0 
zero and time t, so the superposition, or summation, be-                     t

8-14
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

comes a definite integral:

                             =t   =t

                            x(t) ICs=0 =  dx(t) =  u( ) h(t - ) d  (8-41)

                             =0   =0

Equations such as (8-41) and its versions for specific systems [with explicit functions for
h(t - ) ] are often called Duhamel integrals (after Jean-Marie Duhamel, 1797-1872,

French mathematician and physicist), especially in the literature of structural dynamics
(e.g., Craig, 1981, p. 124).

         Equation (8-41) is general, valid for any LTI system. To see a specific applica-
tion, let's re-visit the standard undamped 2nd order system. With IU = 1, Eq. (8-26) gives

the IRF as h(t) = n sin nt , so Eq. (8-41) becomes

                                                        =t         (8-42)

                            x(t) ICs=0 = n  u( ) sin n (t - ) d
                                                        =0

Equation (8-42) is the Duhamel integral response solution for the standard undamped 2nd
order system, and it is identical to convolution integral response solution Eq. (7-9b) with
zero ICs. Recall that Eq. (7-9b) was derived mostly from the mathematics of convolution
integrals and transforms in Chapter 6. On the other hand, the derivation of Eq. (8-42)
above is primarily physical, based upon the IRF and the principle of superposition for
linear systems.

8-11 Approximate numerical solutions for 1st and 2nd order LTI systems based on
the convolution sum

         In Section 6-5, we developed a recurrence formula for the approximate numerical
solution of an LTI 1st order ODE with any IC and any physically plausible input function
u(t). It is possible to generalize the recurrence-formula approach to 2nd and higher order

LTI ODEs, but it would require development of theory and detail that are beyond the ob-

jectives of this book (see, for examples: Craig, 1982, Section 7.1; and Meirovitch, 2001,

Section 4.10). There is, however, an alternative, relatively simple approach based upon

the convolution integral, and this approach is readily applicable to calculating approxi-
mate numerical solutions for forced response of 1st and 2nd order LTI systems.

         To describe this approach, we begin with the general convolution (Duhamel) inte-
gral for forced response, which is valid for any LTI system:

                                                  =t               (8-41, repeated)

                            x(t) ICs=0 =  u( ) h(t -  ) d
                                                  =0

                                 8-15
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

If initial conditions (ICs) are not zero, then appropriate IC-response solutions must be
added to the convolution integral, which represents only the forced response. Examples
of such IC-response solutions are given explicitly in Eqs. (6-5), (7-9), and, later, (9-20).
Hereafter in this section, we will consider only the forced response, so it will be conven-
ient to omit the "ICs = 0" subscript from the output variable and denote it simply as x(t),
and later as x with subscripts, x5 for example.

         We seek approximate evaluations of Eq. (8-41) in time-series form, that is, at
discrete, equally spaced instants in time. Accordingly, just as in Section 6-5, we define
the following notation that employs descriptive subscripts, with the initial instant defined
as time zero:

t = t1  0 t2 = t1 + t t3 = t2 + t ... tn = tn - 1 + t ...

           = t   = 2t       = (n - 1)t

x(t) = x1   x2   x3    ...                    xn        ...

u(t) = u1   u2   u3    ...                    un        ...

h(t) = h1   h2   h3    ...                    hn        ...

Let's designate as a sequence of length N any series of N numbers such as t1, t2, ... , tN ,
or x1, x2, ... , xN, and let's denote the entire sequence as {t}N, or {x}N. If time t is the
independent variable, and quantity f(t) is any time-dependent function, let's denote the
values of f(t) at times t1, t2, ... , tN as {f(t)}N.

         Forced-response solution Eq. (8-41) is exact. But now we introduce what, in
general, is an approximation. We assume that the integrand product u() h(t - ) varies
so little over the integration time step t that it introduces only small error to approximate
u() h(t - ) as being constant over t, with its value remaining that at the beginning of
the time step:

u() h(t - )  u(tk - 1) h(t - tk - 1) for tk - 1   < tk       (8-42)

In Eq. (8-42), k is an index that varies, just as  varies over the integration limits in Eq.
(8-41).

         Suppose that we have matching sequences of time {t}N, input {u(t)}N, and IRF
{h(t)}N, and we wish to calculate the corresponding forced-response output sequence,
{x(t)}N. Then, using approximation (8-42), we express Eq. (8-41) as follows, with the
convolution integral approximated as a summation:

x(t1 ) = 0                  
                            
           n-1                                               (8-43)
x(tn ) =  u (tk ) h (tn - tk ) t, for 2  n  N 
           k =1                               

Additional explanation of Eq. (8-43) might be helpful, because the extrapolation of Eq.
(8-41) from continuous time to discrete time is not completely obvious. Physically, the

                 8-16
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

forced response must be zero at the instant t = t1 = 0 when forcing is begun, even if the
initial input value u(0) is nonzero; also, the exact convolution integral Eq. (8-41) gives
the same result for the upper limit  = t1 = 0; hence, x(t1) = 0. Regarding summation over
only n - 1 values of product u(tk) h(tn - tk) t in order to obtain x(tn), consider again
approximation (8-42). Equation (8-42) means that the very last term in the summation of
Eq. (8-43) that approximates the integral for x(tn) is the product u(tn - 1) h(tn - tn - 1) t.

         Equation (8-43) can be written in the following simpler form, using subscript
notation and the constancy of time step t:

x1 = 0                                                    
                                                          
        n-1                                                 (8-44)
xn = t  uk hn-k , for 2  n  N 
        k =1                                              

The summation in Eq. (8-44) is called a convolution sum.

         It is instructive to write out explicitly a few terms of Eq. (8-44), and then to study
a graphical interpretation of the process. Suppose that we have sequences of input values
{u(t)}N and IRF values {h(t)}N, with length N  4, and we wish to find the corresponding
sequence of responses {x(t)}N. Then the first five terms in the response sequence, from
Eq. (8-44), are:

x1 = 0                                                      (8-45a)

x2 = t (u1h1 )                                              (8-45b)

x3 = t (u1h2 + u2h1 )                                       (8-45c)

x4 = t (u1h3 + u2h2 + u3h1 )                                (8-45d)

x5 = t (u1h4 + u2h3 + u3h2 + u4h1 )                         (8-45e)

         Figure 8-6 on the next page is a graphical representation of many aspects of the

previous discussion. The figure consists of three graphs of conceptual time-dependent

functions, with the three time axes aligned. The top graph is a typical input function,
u(t); and one plot on the middle graph is a unit-impulse-response function (IRF), h(t),
which was chosen to resemble the exponential IRF of a 1st order system, with, in particu-
lar, h(0)  0. The second (dashed) plot on the middle graph is the function h(t4 - t), and it
was chosen to illustrate Eq. (8-45e) for output quantity x5.

         Observe on the middle graph of Fig. 8-6 that h(t4 - t) is derived from h(t) by
"folding" h(t) about a vertical line through time t4/2 and then setting to zero the folded
function for all times t < 0. One of the dictionary definitions for the word "convolution"
as a noun is "a fold", and this is apparently the reason for the use of "convolution" as the

                8-17
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

Figure 8-6 Graphical representation of the convolution sum for a conceptual problem
with input function u(t) and impulse-response function h(t), with h(0)  0

                                                   8-18
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

name of a transform, integral, or sum (Evans, 1954, pp. 199-204). It seems that "convo-
lution sum", for example, sounds more elegant in English than "folding sum"; however,
the German noun for mathematical convolution is Faltung, meaning "folding" or "bend-
ing", and Faltung was often used interchangeably with "convolution" in older English-
language textbooks and other technical literature.

         The plot on the bottom graph of Fig. 8-6 is the product u(t) h(t4 - t). At the times
t1, t2, t3, and t4, the discrete products uk h5-k are marked, and approximation (8-42) of
piecewise constancy is illustrated by straight horizontal lines, each representing the time
step t. This is a stairstep approximation similar to that used in Section 6-5. The bottom
graph shows that Eq. (8-45e) for x5 is the area under all the cross-hatched rectangles (the
entire "staircase"); that area is an approximation of the integral from Eq. (8-41),

 =t5

  u( ) h(t5 - ) d . It is obvious from this graphical interpretation of the convolution

 =0

sum that smaller values of time step t will produce more accurate numerical inte-
grations, at the expense of longer calculations.

For the conceptual example of Fig. 8-6, which resembles a 1st order system that

has initial IRF value h(0) = h1  0, and also initial input value u(0) = u1  0, Eq. (8-45b)

gives x2 = t (u1h1)  0 . This is noted because it is easy to make the mistake of calcu-

lating approximate time response by applying directly the MATLAB function conv, as in

the command line X = conv(u,h), and then by taking the first N elements of the result-

ing sequence {X}2N-1 to be the desired forced response, {x(t)}N ; this process executes the

n                                              n
incorrect equation x(tn ) =  u (tk ) h (tn+1 - tk ) t = xn = t uk hn+1-k , for 1  n  N.
k =1                                           k =1

This incorrect equation calculates a sequence with N - 1 elements the same as those of

the correct forced-response sequence, but the incorrect sequence is shifted backward in

time by a single time step, t. In particular, the incorrect process sets x1 = t (u1h1 ) ,

which would be nonzero for the conceptual problem of Fig. 8-6, and might alert the

analyst that something is wrong. (Recall from the discussion above that the initial
forced-response value x1 must be zero.) But for most systems other than standard 1st

order systems, the initial value of the IRF is zero, h1 = 0, so the error in x1 = t (u1h1 )

would not be obvious in the calculated results. The lessons from this discussion are: (1)

use of the incorrect convolution sum might produce results that are not obviously incor-

rect; in fact, for very small t, the incorrect and correct plots of approximate response

versus time might be almost indistinguishable visually; and (2) if you apply directly

MATLAB's function conv, then, in order to obtain the correct approximate forced-

response sequence, be sure to shift the sequence calculated by conv forward in time by a

single time step, t, and to set x1 = 0.

         The following are two numerical examples of the application of Eq. (8-44), first
for a 1st order ODE, next for an undamped 2nd order ODE.

                                         8-19
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

Convolution-sum Example 1: 1st order system Consider the standard 1st order LTI-ODE
of a stable system, Eq. (3-7), for dependent variable x(t): x& + (1 1)x = b u(t) , with IC
x(0) = 0. From Section 8-5 and homework Problem 8.5(a), the unit-impulse-response
function (IRF) is h (t) = be- t 1 . Let's set the input function to be a declining ramp, u(t) =

c(a - t) , in which c, a dimensional constant, is the downward slope of the ramp, and a is

the time at which the input passes through zero. For reference, the exact solution for this
problem is derived from Eqs. (6-5) or (8-41):3

 =t   =t

x(t) = be- t 1  e  1 u( ) d = be- t 1  e  1 c(a -  ) d
 =0   =0

= bc1[(a + 1 )(1 - e-t 1 ) - t]

With parameters 1 = 2.5 sec, a = 10 sec, b = 3.5, and c = 1 (b and c in consistent units),
the MATLAB commands to calculate and plot the exact solution x(t), and the approxi-
mate solution from Eq. (8-44), for the relatively large time step t = 1 sec, are given next,
followed by the resulting graph, which was edited later to add labels, title, and legend.
Observe in the MATLAB code that the declining-ramp is entered into the input sequence
{u(t)}N , as is the IRF sequence {h(t)}N. Note that the simple code to calculate the con-

                                                                       x n-1

volution sums over the entire forced-response sequence, n =  uk hn-k for 2  n  N,

                                                                       t k =1

consists of a for loop over index k nested within a for loop over index n.

>> a=10;b=3.5;c=1;tau=2.5;
dt=1;t=0:dt:10;
N=length(t); %sequence length
u=c*(a*ones(1,N)-t); %declining-ramp excitation
plot(t,tau*b*u,'k--'),grid %pseudo-static response
h=b*exp(-t/tau); %IRF, impulse-response function
xc(1)=0; %zero initial value
for n=2:N

       sum=0;
       for k=1:(n-1)

                  sum=sum+u(k)*h(n-k);
       end
       xc(n)=sum;
end
xc=dt*xc;
hold,plot(t,xc,'ko-')
te=0:0.05:10;
xe=c*b*tau*((a+tau)*(1-exp(-te/tau))-te); %exact solution
plot(te,xe,'k')

3 Details of the integration process are not shown. Note, however, that you can easily verify the validity of
the given solution by substituting it into the ODE and IC and finding that they are satisfied.

                                                   8-20
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

The graph above shows that Eq. (8-44) with the relatively large time step t = 1 sec pro-
duces a poor approximation to the exact solution of the 1st order ODE in this problem.
The following MATLAB command lines evaluate Eq. (8-44) and plot the results for three
progressively smaller values of t.

>> a=10;b=3.5;c=1;tau=2.5;
tend=10;
m=[2 8 16]; %inverses of time steps for convolution
maxln=tend*max(m)+1;
t=zeros(3,maxln);xc=zeros(3,maxln); %initialize oversized arrays
for j=1:3

       dt=1/m(j);tj=0:dt:tend;N(j)=length(tj);t(j,1:N(j))=tj;
       u=c*(a*ones(1,N(j))- tj); %excitation
       h=b*exp(-tj/tau); %IRF
       xc(j,1)=0; %zero initial value
       for n=2:N(j)

              sum=0;
              for k=1:(n-1)

                         sum=sum+u(k)*h(n-k);
              end
       xc(j,n)=dt*sum;
       end
end
plot(t(1,1:N(1)),xc(1,1:N(1)),'ko',t(2,1:N(2)),xc(2,1:N(2)),'ks')
hold,plot(t(3,1:N(3)),xc(3,1:N(3)),'k.')
te=0:0.05:tend;
xe=c*b*tau*((a+tau)*(1-exp(-te/tau))-te); %exact solution

                                                   8-21
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum
plot(te,xe,'k'),grid

The results above demonstrate for this 1st order system that the approximate solution
calculated from the convolution sum approaches the exact solution as t  0. This
concludes Convolution-sum Example 1.
Convolution-sum Example 2: undamped 2nd order system Consider the LTI-ODE Eq.
(7-5) for a standard undamped 2nd order system, &x& +  n 2 x =  n 2u(t) , with ICs x(0) = 0
and x&(0) = 0. From Sections 8-7 and 8-10 [Eqs. (8-26) and (8-42)], the unit-impulse-
response function (IRF) is h(t) = n sin nt . Let's set the input function to be a declin-
ing-ramp pulse,

                                              c(a - t) , 0  t < td
                                      u(t) = 

                                               0 , td < t
in which c, a dimensional constant, is the downward slope of the ramp, ca is the input at t
= 0, and td is the pulse duration. For reference, the exact solution equations for this prob-
lem are derived next from Eqs. (7-9), without details of the integration processes. For the
interval during which the pulse is active, 0  t  td , we apply Eq. (7-9a), although Eq. (7-
9b) would serve just as well:

                                                   8-22
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

      =t                                                       =t

x(t) = n  sin n × u(t - ) d = n  sin n × c[a - (t - )] d
      =0                                                       =0

     = c[a - t - a cosnt + (1 n ) sin nt], valid for 0  t  td

For the time after the pulse ceases, td < t, Eq. (7-9b) is preferable since the input u(t) is
zero for td < t, so that the upper limit of integration is clearly td :

 =t        =td

x(t) = n  sin n (t - ) × u( ) d = n  sin n (t - ) × c(a - ) d
 =0        =0

  =td                                                          =td 
= ncsin nt  cosn × (a - ) d - cosnt  sin n × (a - ) d 
      =0                                                       =0  

= c{sin nt[a sin ntd - (1/ n )(ntd sin ntd + cosntd - 1)] 

                                                                             , valid for td < t

 - cosnt[a(1 - cosntd ) - (1/ n )(-ntd cosntd + sin ntd )]}

Let the parameters be: undamped natural frequency n =  /4.5 rad/sec (making the asso-
ciated period 9 sec), a = 10 sec, c = 1 (in consistent units), and pulse period td = 10 sec.4
The MATLAB commands to calculate and plot the exact solution x(t), and the approxi-
mate solution from Eq. (8-44), for the relatively large time step t = 1 sec, are given next,
followed by the resulting graph of response, which was edited later to add labels, title,
and legend. Observe in the MATLAB code that the entire declining-ramp pulse, includ-
ing zeros, is entered into the input sequence {u(t)}N , as is the IRF sequence {h(t)}N.
Also, just as in Convolution-sum Example 1, the simple code to calculate the convolution

                                                           x n-1

sums over the entire forced-response sequence, n = uk hn-k for 2  n  N, consists of

                                                           t k =1

a for loop over index k nested within a for loop over index n.

>> a=10;c=1;wn=pi/4.5;td=10;
tend=25; %time range (sec)
dt=1;t=0:dt:tend;
nd=td/dt+1; %warning: not necessarily an integer for arbitrary td
N=length(t); %sequence length
u=zeros(1,N);
u(1:nd)=c*(a*ones(1,nd)-t(1:nd)); %declining-ramp pulse
plot(t(1:nd),u(1:nd),'k--'),grid %pseudo-static response
hold,plot(t(nd:N),zeros(1,(N-nd+1)),'k--')
h=wn*sin(wn*t); %IRF, impulse-response function
xc(1)=0; %zero initial value
for n=2:N

       sum=0;
       for k=1:(n-1)

                  sum=sum+u(k)*h(n-k);

4 With td = a, the pulse is continuous at zero when it ends.

                                                   8-23
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

       end
       xc(n)=sum;
end
xc=dt*xc;
plot(t,xc,'ko-')
t1=0:0.1:td;t2=(td+0.1):0.1:tend;te=[t1 t2];
wt1=wn*t1;wt2=wn*t2;
x1=c*(a-t1-a*cos(wt1)+sin(wt1)/wn);
arg=wn*td;sn=sin(arg);cn=cos(arg);
S=a*sn-(arg*sn+cn-1)/wn;C=a*(1-cn)-(-arg*cn+sn)/wn;
x2=c*(S*sin(wt2)-C*cos(wt2));
xe=[x1 x2]; %exact solution
plot(te,xe,'k')

The graph above shows that Eq. (8-44) with the relatively large time step t = 1 sec
produces only a mediocre approximation to the exact solution of the 2nd order ODE in

this problem. But the plot of the convolution-sum solution also illustrates an important

point: not only is x1 = 0, the requirement discussed previously, but also x2 = u1h1 = 0 be-
cause the initial IRF value h1 = 0 for the 2nd order ODE, regardless of the initial value u1

of the input. The appropriate approximation in this case for the initial time derivative of

response is dx (t = 0)  x2 - x1 = 0 . The necessary initial conditions (ICs) for a 2nd order
dt  t

ODE are both x(0) and x&(0) . As is stated at the beginning of this section, any nonzero

ICs must be accounted for by separate IC-response solutions, as these ICs cannot be in-

cluded in the forced-response solution, which is the convolution sum. This means that

       8-24
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

we must have x1 = x2 = 0 for this, or, in fact, any correct convolution-sum approximate
solution of a standard 2nd order ODE. The plot above of the convolution-sum solution
also demonstrates a negative (relative to numerical accuracy) consequence of the neces-
sary condition x2 = 0: a consistent time lag, of the approximate solution relative to the
exact solution, on the order of t. The following MATLAB command lines evaluate Eq.
(8-44) and plot the results (on the next page) for two progressively smaller values of t.

>> a=10;c=1;wn=pi/4.5;td=10;
tend=25; %time range (sec)
m=[2 8]; %inverses of time steps for convolution
maxln=tend*max(m)+1;
t=zeros(2,maxln);xc=zeros(2,maxln); %initialize oversized arrays
for j=1:2

       dt=1/m(j);tj=0:dt:tend;N(j)=length(tj);t(j,1:N(j))=tj;
       nd=td/dt+1; %warning: not an integer for arbitrary td
       u=zeros(1,N(j));
       u(1:nd)=c*(a*ones(1,nd)-tj(1:nd)); %declining-ramp pulse
       h=wn*sin(wn*tj); %IRF, impulse-response function
       xc(j,1)=0; %zero initial value
       for n=2:N(j)

              sum=0;
              for k=1:(n-1)

                         sum=sum+u(k)*h(n-k);
              end
       xc(j,n)=dt*sum;
       end
end
plot(t(1,1:N(1)),xc(1,1:N(1)),'ks')
hold,plot(t(2,1:N(2)),xc(2,1:N(2)),'k.'),grid
t1=0:0.1:td;t2=(td+0.1):0.1:tend;te=[t1 t2];
wt1=wn*t1;wt2=wn*t2;
x1=c*(a-t1-a*cos(wt1)+sin(wt1)/wn);
arg=wn*td;sn=sin(arg);cn=cos(arg);
S=a*sn-(arg*sn+cn-1)/wn;C=a*(1-cn)-(-arg*cn+sn)/wn;
x2=c*(S*sin(wt2)-C*cos(wt2));
xe=[x1 x2]; %exact solution
plot(te,xe,'k')

                                                   8-25
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

The numerical solution for time step t = ½ sec is a fair approximate solution, but still
with a noticeable time lag, relative to the exact solution, on the order of t. However, the
numerical solution for time step t =  sec is almost indistinguishable from the exact so-
lution by eye on the graph. This concludes Convolution-sum Example 2.

         Finally, we note a curious intersection of two seemingly unrelated mathematical
operations, convolution sum and multiplication of polynomials. Suppose that we have
two arbitrary sequences of numbers, {u}N and {h}M. Consider the convolution sum in the
form applied by the MATLAB command line X = conv(u,h), which produces the

                                   n

sequence X n =  uk hn+1-k for 1  n  (N + M - 1): X 1 = u1h1 , X 2 = u1h2 + u2h1 , X 3 =
                                 k =1

u1h3 + u2h2 + u3h1 , X 4 = u1h4 + u2h3 + u3h2 + u4h1 , etc. Evans (1954, pp. 201-203) ob-

served that the convolution-sum process can be executed with use of tables in a "process
similar to multiplication." First, we define the table of sequences {h}M and {u}N :

{h}M =  h1  h2  h3    h4  ...

{u}N =  u1  u2  u3    u4  ...

                                                                                     n

In order to execute the operation X n =  uk hn+1-k using the sequences {h}M and {u}N ,
                                                                                    k =1

we construct the table of products below. The first row of the table consists of the prod-

                8-26
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

ucts u1 × {h}M , the second row consists of the products u2 × {h}M and this sequence is
offset by one column toward the right, the third row consists of the products u3 × {h}M
and this sequence is offset by two columns toward the right, etc.

       n = 1                    n = 2           n = 3          n = 4       ...

k = 1  u1h1                       u1h2             u1h3        u1h4        ...

k = 2                             u2h1             u2h2        u2h3        ...

k = 3                                              u3h1        u3h2        ...

k = 4                                                          u4h1        ...

...                                                                        ...

Then each element Xn of the sequence {X}N+M-1 is the sum of the products in the corres-
ponding nth column of the table of products above:

{X}N+M-1 = X1 = u1h1     X2 = u1h2 +         X3 = u1h3 +  X4 = u1h4 + ...
                         u2h1                u2h2 + u3h1  u2h3 + u3h2 +
                                                          u4h1

         A numerical example applying MATLAB's conv function to multiplication of

two polynomials was given in Section 6-1. Here is another example of the process using
the notation in the tables above, the product of a 1st degree polynomial, P1, with a 2nd
degree polynomial, P2:

P1 × P2 = (u1s + u2 ) × (h1s 2 + h2 s + h3 ) = u1h1s3 + (u1h2 + u2h1 )s 2 + (u1h3 + u2h2 )s + u2h3

With zero input polynomial coefficients ui = 0 for i > 2 and hj = 0 for j > 3, the coef-
ficients of the product cubic polynomial (in descending order of powers of s) are the
coefficients X1, X2, X3, and X4 from the last table above.

         If you wished to execute product P1 × P2 , you would probably use the basic alge-
bra below for multiplication of two polynomials, which, although less general, is essen-
tially the same as the tabular process described above.

Polynomial P2 =          h1s 2 +        h2 s +            h 3
Polynomial P1 =
                         u1s +          u 2
u1s × P2 =
u2 × P2 (offset) =       ---------------------------------------------

P1 × P2 = column sums =  u1h1s3 + u1h2 s 2 +              u1h3 s

                                        u2h1s 2 +         u2h2 s +         u 2 h3

                         ---------------------------------------------

                         u1h1s3 + (u1h2 + u2h1 )s 2 + (u1h3 + u1h3 )s + u2h3

                                        8-27
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

8-12 Homework problems for Chapter 8

                                                                                                               50

8.1 A "shaped", 10-millisecond force pulse in
pounds is described by the equation 45

                                                                      40

f x (t) = [50sin 2 (100 t)] lb                                        35

× [H (t) - H (t - 0.01 sec)]                                          30

which is graphed at right. In a calculation of sys-    Force f (lbf)  25
tem response to this input force, we wish to ap-
proximate the force as an ideal impulse function,                     20
f x (t)  I F  (t) . What is the value (with units) of
                                                                      15
I F ? (Hint: before embarking on a long integra-
tion, examine the graph carefully for symmetries                      10
that will make the calculation almost trivial.)
                                                                      5

                                                                      0

                                                                                                                   0  0.005  0.01          0.015

                                                                                                                             Time t (sec)

8.2 Consider an undamped mass-spring system. The mass weighs 20.0 lb including an
air-jet thruster that is attached to it, and the spring is calibrated to stretch 0.279 inch when
subjected to 100 lb of tension. The air-jet thruster has been designed and calibrated to
provide 0.767 lb of thrust in a nearly perfect flat pulse. Let's study the dynamic position
response x(t) of the mass, starting from zero ICs, to this force input from the thruster.

(a) Calculate the natural frequency of the mass-spring system in rad/sec and Hz, and the
natural period of the system in seconds and milliseconds. Calculate the impulse magni-

tude I F delivered by the air-jet thruster in a blast of duration td = 4.00 milliseconds.
(Partial answers: Tn = 75.53 msec, I F = 3.068 × 10-3 lb-sec)

(b) Model the 4.00-msec air-jet blast as a perfect flat pulse of force. For this input, write
equations that describe the real pulse response x(t) (in inches); for help, see Eq. (8-5) and
Eq. (7-4); don't re-derive anything that is already available. Use MATLAB to make an
accurate time history plot of this real pulse response x(t) (in inches) over the time interval
0  t  40 msec.

(c) Approximate the air-jet force input as an ideal impulse with the same impulse mag-
nitude I F as calculated in part (a). Use Eq. (8-28) to write the numerical equation for the
ideal impulse response x(t) in inches.

(d) Use MATLAB to make two accurate time history plots, on the same graph, of x(t) (in
inches) over the time span 0  t  40 msec: the real pulse response of part (b) and the
ideal impulse response of part (c).

                                8-28
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

8.3 Consider the mass-spring system drawn below with m = 8.03 kg and k = 317 N/m.
This system is initially at rest in the static equilibrium position when it is hit by a flat

force pulse f y (t) = F[H (t) - H (t - td )] of magnitude F = 4.50 N and short duration td =

0.05 sec. In this problem, we analyze the dynamic displacement of the mass relative to
the initial static equilibrium position.

             (a) The following succinct response equation can be derived easily with

             use of transform Eq. (8-2) and the general Laplace transform of a func-

k            tion that is translated in time: L [ f (t - td ) H (t - td )] = e-std F (s) .

m                   y(t) = F [(1 - cosnt)H (t) - (1 - cosn (t - td ))H (t - td )]
 fy(t) y(t)
                               k

             Show that this equation is fully equivalent to the response equations in
             the two-part solution Eq. (8-5). Note from Eq. (7-4) that U = F k .

Next, use MATLAB to plot the response curve of y(t) versus t from t = 0 to t = 1 sec, the
period of the mass-spring system.

(b) In order to compare with the real response, plot [on the same graph as part (a)] the
ideal impulse response of the system, y(t) = (I F mn ) sin nt , Eq. (8-28), using for I F

the value of the actual impulse from given data. Label clearly which curve is the real re-
sponse and which is the ideal impulse response; title and label your graph appropriately.

8.4 In this exercise, let's apply the initial-value theorem to the problem of Section 8-7:
the standard undamped 2nd order system that has non-zero initial conditions and is dis-

turbed by an ideal impulse, u(t) = IU  (t) .

(a) Determine the post-impulse initial value, x(0+ ) , by using Eq. (8-25) for X (s) in the
initial-value theorem. Is your result the same as that found directly from Eq. (8-26)?

(b) Use Eq. (8-25) for L[x(t)] to find the Laplace transform L[x&(t)] of the "velocity"
function; be sure to include both terms of Eq. (8-21) for the transform of a derivative.

(c) Determine the post-impulse initial "velocity", x&(0+ ) , by using your L[x&(t)] from
part (b) in the initial-value theorem. Is your result the same as that of Eq. (8-30)?

8.5 Consider the standard 1st order LTI-ODE (of a stable physical system) for dependent
variable x(t): x& + (1 1)x = b u(t) , with IC x(0) = 0, and with excitation by an ideal im-
pulse, u(t) = IU  (t) .

(a) Infer from the results of Section 8-5 the unit-impulse-response function (IRF), h(t).

             8-29
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

(b) Use the result from part (a) to write the Duhamel integral response solution for the
standard stable 1st order system, which is comparable to Eq. (8-42) for the standard un-
damped 2nd order system.

(c) The object of this part is to compare numerically the ideal impulse response derived
in Section 8-5 with the response to a real, flat pulse that has the same impulse magnitude
as the ideal impulse and a pulse duration that is short relative to the system time constant.
Use MATLAB to make two accurate time history plots, on the same graph, of the dimen-
sionless output x(t) bIU versus dimensionless time t 1 over the time interval 0  t 1

 1. One plot will be the response to the ideal impulse. The other plot will be the re-
sponse to a flat pulse having dimensionless duration td 1 = 0.2; for this plot, use the

response equations derived in homework Problem 6.2. You should find that the ideal im-
pulse response is much easier to calculate than the real-pulse response. However, is the
ideal impulse response a sufficiently accurate approximation to the real response, and, if
so, is it accurate over all time, or over just some portion of the response time?

8.6 If you compare Fig. 2-2 for the Heaviside unit-step function H(t) with Fig. 3-3 for
step response of a stable 1st order system, you can see that as time constant 1 becomes
progressively smaller, the 1st order step response looks progressively more like the unit-
step function. Using Eq. (2-26) for H (t) as a model, let's define the "exponential-unit-

step" function H e (t) :

0 for t < 0                    0 for t < 0
H (t) =         H e (t)   -t 1
1 for t > 0                   1 - e for t > 0

It is clear that H (t) can be defined as a limit of H e (t) : H (t) = lim H e (t) . Now, let's

                                                                                                                                    1 0

define the "exponential-unit-impulse" function  e (t) :

           0 for t < 0
          
          d
          e (t)  (1- e ) = e-t 11 -t 1for t > 0

           dt        1

Sketch by hand an over-and-under pair of graphs, the upper graph being H e (t) vs. t and
the lower graph being  e (t) vs. t. Sketch conceptually the two exponential functions for
a few values of time constant 1 ; show in particular how H e (t) and  e (t) evolve as 1
becomes progressively smaller. Describe the character of  e (t) as 1  0 . Is it plausi-
ble physically to define the Dirac delta function as  (t) = lim  e (t) , which, with the defi-

                                                                                                                   1 0

nition H(t) = lim H e (t) , is equivalent to  (t) = dH dt ? [This is one of many possible

                            1 0

limit-process definitions of  (t) ; Eq. (8-8) is a more commonly used definition.]

               8-30
Chapter 8 Pulse inputs; Dirac delta function; impulse response; initial-value thm.; convolution sum

8.7 Consider the mass-spring system (with damping neglected) of Fig. 1-4, for which the
ODE of motion is m&x& + kx = f x (t) , and the system parameters are m = 2.20 kg and k =

770 N/m. Initial conditions are zero: x(0) = 0 and x&(0) = 0. The excitation is a ramped

exponential force pulse, fx(t) = Fm (t / tm) exp(1 - t / tm), with Fm = 6.0 N and tm = 1/12 sec.
Write a MATLAB program, or adapt the code of Convolution-sum Example 2 in Section
8-11, to calculate and plot an approximate numerical solution for x(t) over the time inter-
val 0  t  1 sec. Adjust the time-step size t and number of time steps over the 1-sec
interval in your code until the graph of your approximate solution appears very similar to
that on Fig. 1-5 of the corresponding exact solution. Submit your MATLAB code and
your final graph of response.

                                                   8-31
   Chapter 9 Damped 2nd order systems: general time response

Chapter 9 Damped 2nd order systems: general time response

       © 2016 by William L. Hallauer, Jr.

9-1 Homogeneous solutions for damped 2nd order systems; viscous damping ratio 

         For the mass-dashpot-spring (m-c-k) system of Fig. 9-1, the equation of motion
(3-20) derived from Newton's 2nd law, with

use of the FBD in Fig. 3-9, is                                           x(t)

                                                           k

m &x& + c x& + k x = f x (t)    (9-1)                                         fx(t)
                                                              m

Although 2nd order systems appear in many              c
different mechanical and electrical forms,  Figure 9-1 Mass-dashpot-spring system
the m-c-k system of Fig. 9-1 is generally
considered to be the prototype.

         To provide direction for developing a standard form of damped 2nd order ODE,
let's consider the homogeneous form of Eq. (9-1) and seek a homogeneous solution
xh (t) using the conventional method that is described in Section 1-5 [Eq. (1-6) and the
subsequent discussion]:

                                m &x&h + c x&h + k xh = 0                (9-2)

We seek xh (t) = C e t , in which C and  are unknown:

                        (m2 + c + k )C e t = 0

Now xh (t) = C e t  0 for a non-trivial solution, leading to the characteristic equation:

                                m2 + c + k = 0                           (9-3)

We solve Eq. (9-3) for characteristic values  using the quadratic formula, recognizing
k/m = n2 from Eq. (7-3):

   - c ± c 2 - 4mk              c  c 2 k                      c c  2

=                               = - ±   - = - ±   -n                  2

   2m                           2m  2m  m 2m  2m 

The dimensionless viscous damping ratio  and the critical viscous damping constant cc
are defined as follows:

                                9-1
Chapter 9 Damped 2nd order systems: general time response

 c = c c                                where cc  2mn = 2 mk                      (9-4)
     2m n 2 mk cc

Recall that constants m, c, and k are normally positive for a passive, stable system, so that
 and cc also are normally positive. With definitions (9-4), the characteristic values take
the form

 = -   c  n ±                           2
       2m n    c 2
                                          n -  n = - n ±  n2  2 -1                (9-5)

                2m n 

Depending upon the value of  relative to 1, there are three possible distinct solution
types for characteristic value  and the associated homogeneous solution xh (t) :

Type 1:  > 1, overdamped or supercritically damped system
         Both roots are real and negative:

I ,II = - n ±  n  2 - 1                                                           (9-6)

The corresponding homogeneous solution is an exponentially decaying response with two
distinct time constants:

xh (t) = CI eI t + CII eII t = CI e - t  I + CII e -t  II where  I ,II  -1 I ,II  (9-7)

If we were given initial conditions xh (0) and x&h (0) , we could now solve for constants CI
and CII in terms of the ICs, and thus obtain an IC solution for the overdamped m-c-k sys-
tem. We will obtain such a solution in Section 9-10, using different methods.

Type 2:  = 1, critically damped system

The two roots (9-5) are equal and negative:

                 I ,II = -n                                                       (9-8)

Due to the existence of repeated roots, the homogeneous solution involves both a pure
exponential decay term and a term multiplied by time t that also decays, but more slowly
than exponential:

xh (t) = CI e-n t + CII te -n t                                                   (9-9)

                                        9-2
Chapter 9 Damped 2nd order systems: general time response

The case of critical damping is more of academic than practical interest, since it is rare in
practice that physical parameters lead to the exact value  = 1. (see homework Problem
9.11)

Type 3: 0   < 1, underdamped or subcritically damped system

         In this case, the terms in Eq. (9-5) within the square root are negative, so we have
two complex characteristic values, each with a negative real part:

I ,II = - n ± j n 1 -  2  - n ± j d where  d   n 1 -  2 (9-10)

Frequency d is called the damped natural frequency. The corresponding homogeneous
solution is

  ( ) xh (t) = CI eI t + CII eII t = CI e(- n + jd ) t + CII e(- n - jd ) t = e- n t CI e jd t + CII e- jd t

By applying Euler's equation (2-8) and combining constants CI and CII appropriately to
form two new constants DI and DII , we can re-write this homogeneous solution in the
form of an exponentially decaying sinusoid:

xh (t) = e-n t (DI cosdt + DII sin dt )                                            (9-11)

If we were given initial conditions xh (0) and x&h (0) , we could now solve for real constants
DI and DII in terms of the ICs, and thus obtain an IC solution for the underdamped m-c-
k system. We will obtain this solution in Section 9-4, using the general solution for x(t)
obtained from Laplace transformation. Underdamped systems are the most important and
common in practical applications and the most interesting, so we will devote more atten-
tion to them than to the other two types of damped 2nd order systems.

9-2 Standard form of ODE for damped 2nd order systems

         Using the concepts and notation developed in the previous section, we now derive
the "standard" form of ODE governing response of damped 2nd order systems, beginning

with ODE (9-1) for an m-c-k system:

m &x& + c x& + k x = f x (t)  &x& + 2 c        k x& + k x = 1 f x (t) = k f x (t)  (9-12)
                                         2 mk  mmm         mk

Using the definitions from the previous section and the standard input quantity (7-4),
u(t)  f x (t) k , we re-write Eq. (9-12) in the standard form:

&x& + 2 n x& +  n 2 x =  n 2u(t)                                                   (9-13)

9-3
              Chapter 9 Damped 2nd order systems: general time response

In Eq. (9-13), x(t) represents any appropriate output quantity (not necessarily just position
as in Fig. 9-1) for a damped 2nd order system. Recall from Chapter 7 that we can identify
u(t) as being the pseudo-static output, xps(t); if x(t) varies slowly enough that the terms &x&
and 2n x& are negligible in comparison with  n2 x , then ODE (9-13) reduces to a
simple algebraic equation, n 2 x  n 2u(t) , the solution of which is the pseudo-static
response, x(t) = u(t)  xps(t).

Example 9-1: the LRC circuit, a 2nd order electrical system

Let's derive an ODE governing the dynamic behavior of the LRC circuit in the

figure below. To write Kirchhoff's voltage law for this circuit, we start at the input volt-

      L em R             age generator and proceed clockwise [see Eq. (5-7)]:
ei(t)
                  eo(t)  (ei - 0) + (em - ei ) + (eo - em ) + (0 - eo ) = 0

                  C Next, we substitute in Eq. (5-6) for the inductor and Ohm's

i(t)                     law (5-1) for the resistor:

                          di                                    di
                         ei +  - L  + (-R i) - eo = 0  L + R i + eo = ei (t)
                          dt                                    dt

For the capacitor, we use (5-3), then differentiate the result and substitute into the ODE:

i = C d (eo - 0) = C e&o  d i = C e&&o  LC e&&o + RC e&o + eo = ei (t)
              dt         dt

Therefore, we can write the ODE in the standard 2nd order form (9-13) as1

                         &e&o + R e&o + 1 eo = 1 ei (t)
                               L LC LC

From this standard form, we see that the undamped natural frequency is n = 1 LC ,
and the viscous damping ratio is  = (1 2n )(R L) = 12 R C L .

Example 9-2: the rate gyroscope, a 2nd order mechanical system

         The schematic three-view engineering sketch on the next page represents the ba-
sic functional form of a single-axis rate gyroscope (gyro), a sensor of rotational velocity.2

The supporting turntable in the sketch could be a fixture in a laboratory setup for cali-

1 In Appendix B, Section B-3, this ODE is derived by an alternative method using energy and power. The
rate of change of system energy is equated with the power supplied to the system.
2 Gyroscopes have been used in sensors and actuators for both aerospace vehicles and water-borne vehicles.

Some examples are described by Cannon, 1967, pages 159-163, 617-626, 696-697, and by Den Hartog,
1956, pages 108-112.

                             9-4
Chapter 9 Damped 2nd order systems: general time response

                                                                          brating the sensor; the
                                                                          turntable rotates clockwise
                                                                          (as viewed from above)
                                                                          with rotational velocity
                                                                          (rate) p(t). At the heart of
                                                                          the rate gyro is a spinning
                                                                          rotor with polar rotational
                                                                          inertia Jr about its spin axis;
                                                                          it is driven by a motor to
                                                                          spin counterclockwise (as
                                                                          viewed from the front) at
                                                                          the high constant spin rate
                                                                          (rotational speed) r, which
                                                                          is usually orders of magni-
                                                                          tude greater than p(t).
                                                                          The motor and spinning
                                                                          rotor are attached to a gim-
                                                                          bal (rotating frame) and
                                                                          shaft segments that fit into
                                                                          bearings within brackets
                                                                          projecting from the turn-
                                                                          table. The gimbal-shaft as-
                                                                          sembly (including the mo-
                                                                          tor and spinning rotor) can
                                                                          rotate through small angle
                                                                          (t) about the so-called
                                                                          "gimbal axis". This (t) ro-
                                                                          tation is resisted by a rota-
tional spring with constant k, and by a rotational viscous damper with constant c. (Drag
is imposed by viscous liquid within a gap between the outer surface of the shaft segment
and the inner surface of the sleeve, which is attached to the bracket.) The polar rotational
inertia of the gimbal-shaft assembly about the gimbal axis is J. Due to the inertia Jr and
high speed r of the spinning rotor, turntable rotation p(t) induces an inertial moment
about the gimbal axis, M(t) = Jr r p(t) cos (t) [as derived from Newton's laws of rigid-
body dynamics by, e.g., Cannon, 1967, pages 152-163]; we assume that (t) is small
enough that cos (t)  1, so that M(t)  Jr r p(t), as labeled on the sketch.. From Eq. (3-
1), Newton's 2nd law for rotation of the gimbal-shaft assembly about the gimbal axis is

   (Moments)about gimbal axis = (rotational inertia) × (rotational acceleration)about gimbal axis
                 M  (t) - c& - k = J&&  J&& + c& + k = J r r p(t)

Therefore, we can write the ODE in the standard 2nd order form (9-13) as

&& c & k  J r r          k J r r
+ + =            p(t) =           p(t)
J  J      J              J k

          9-5
Chapter 9 Damped 2nd order systems: general time response

From this standard form, we see that the undamped natural frequency is n = k J ,

and the viscous damping ratio is  = (c / J) / (2n), and the standard input quantity, with
the same dimensions as rotation-angle output (t), is u(t) = (Jr r / k) p(t)  ps(t), the
pseudo-static output.

         In practical application of a rate gyro, a transducer detects the rotation of the gim-
bal-shaft assembly and generates an electrical signal proportional to (t), which might be
displayed and/or recorded by a data-acquisition-and-processing system, and might also
serve as an input to a control system. Spinning-rotor rate gyros come in various sizes and
shapes; typical units are around the size of a one- or two-pound can of vegetables, and
their cases can be cylindrical or box-shaped.3

9-3 General solution for output x(t) of underdamped 2nd order systems

         We want to solve Eq. (9-13) for output x(t) during positive time t > 0, given any
input u(t), and given appropriate initial conditions at t = 0. We will use Laplace trans-
formation with application of the inverse convolution transform. To simplify the nota-
tion, let's denote X(s)  L[x(t)]. Transforming Eq. (9-13) with use of Eq. (2-17) gives

          s 2 X (s) - sx(0) - x&(0) + 2 n [sX (s) - x(0)]+  n 2 X (s) =  n 2 L[u(t)]

We denote the two initial conditions, x0  x(0) initial "position" and x&0  x&(0) initial
"velocity". Collecting terms algebraically and rearranging the equation gives

(s 2 + 2n s + n 2 )X (s) = (s + 2n ) x0 + x&0 + n 2 L[u(t)]          (9-14)

Note that up to this point in the derivation, no restriction has been placed on the value of
damping ratio  .

         To cast Eq. (9-14) into an easily solvable form, we use two algebraic tricks that
are not obvious a priori. The first trick is to re-write the left-hand-side quadratic term
[which, essentially, is the same as the quadratic term in characteristic equation (9-3)]:

s 2 + 2 n s +  n 2 = (s +  n )2 +  n 2 - ( n )2 = (s +  n )2 +  d 2  (9-15)

We shall regard d 2 as a positive parameter in the following, so Eq. (9-15) is nominally
valid only for an underdamped system (0   < 1). The second trick is to split into a
particular form the IC terms on the right-hand side of Eq. (9-14):

(s + 2n ) x0 + x&0 = (s + n ) x0 + (x&0 + n x0 )                     (9-16)

3 This type of spinning-rotor gyro can be considered a "legacy" design, not necessarily the most modern or
the best for current applications. Rotation sensors using laser optics and microelectromechanics (MEMS)
have been developed more recently.

9-6
       Chapter 9 Damped 2nd order systems: general time response

Applying Eqs. (9-15) and (9-16) to Eq. (9-14), then solving for X(s) gives:

       X (s) =         s + n         2 x0 +        2 2  d    x&0 + n x0 
                                             (s + n ) + d  d 
                                2
                (s + n ) + d

                            F1 ( s)                                                         (9-17)
                     644474448 F2 (s)
       + n      2                    678
                            2 2 d L[u(t)]
                d (s + n ) + d

         The motivation for casting the solution into form (9-17) is a relevant general
Laplace transform pair that has not appeared previously in this book: given a function
f (t) , its Laplace transform F(s), and the exponential function e t , where  is a con-

stant, then the Laplace transform of the product e t f (t) is

                       t=                    t=
       L[e t f (t)]=  e-s te t f (t) dt =  e-(s- )t f (t) dt  F (s - )
                                                                                            (9-18)

                       t=0                   t =0

The associated inverse transform is                                                         (9-19)

                             L-1[F (s -  )] = e t f (t)

        Returning to Eq. (9-17), we identify  = -n and invert the two IC-response
terms using Eq. (9-19) in conjunction with sine and cosine transforms (2-30) and (2-31).

To invert the forced-response term, we apply both Eq. (9-19) and inverse convolution

transform (6-3). This leads to the two equivalent general equations for output x(t) of an
underdamped 2nd order system:

                                   IC response                             forced response

64444444744444448                                  644444474444448
-n t                  x&0 + n x0              n -n 2  =t
x(t) = e x0 cosd t +                 sin d t +  e sin d × u(t - ) d
                      d                       d  =0

                                                                             (9-20a)

-n t                 x&0 + n x0               n -n (t- ) 2  =t
x(t) = e x0 cosdt +                   sin dt +  e               sin d (t - ) × u( ) d
                     d                        d  =0

                                                                             (9-20b)

Note the emphasis that Eqs. (9-20) are valid for underdamped systems. This solution is
nominally not valid for overdamped systems, although we will see in Section 9-10 that it
can be converted easily. The nominal restriction to underdamped systems stems from the
use of sinusoidal transforms (2-30) and (2-31), which are valid in this case only for posi-
tive d 2 , which holds only if 0   < 1, from Eq. (9-10). For example, we used the in-

                                     9-7
       Chapter 9 Damped 2nd order systems: general time response

       -1                                                   2
verse transform L  2 2  = sin t , valid for  > 0, in order to find (9-20), but the
       s + 

                                                                                     -1   
following transform holds for a negative term in the denominator: L  2 2  =

                                                                                       s - 

sinh t , a hyperbolic sine.

9-4 Initial-condition transient response of underdamped 2nd order systems

         One form of transient, free vibration is response from non-zero initial conditions,
with input u(t) = 0 for all time. With u(t) = 0, response (9-20) becomes

       -n t                   x&0 + n x0                       
x(t) = e x0 cosdt +                                          sin dt , for 0  t and 0   < 1  (9-21a)
                              d 
                                                               

By following the procedure of Eqs. (7-11)-(7-12) for combining the two sinusoids of Eq.
(9-21a), we can also express the IC, free-vibration response as

       x(t) = xmaxe-n t cos(dt +  ) , for 0  t and 0   < 1                                  (9-21b)

                                                         2       -1   x&0 + n x0  
where  xmax =                                               and  = tan -    x0 
                        x&0 + n x0                                 d  
                 x02 +  

                        d 

Note that for  = 0, response equations (9-21) reduce to the results (7-10) and (7-12) de-
rived for an undamped system in Chapter 7. In this regard, it is useful to keep in mind

the definition of the damped natural frequency, d   n 1 -  2 .

        The equation d  n 1 -  2 also shows that damping reduces the frequency of
free vibration, and increases the period, Td  2 d . However, the words "frequency"
and "period" are used loosely in this case, because the damped response is not truly
periodic. More correctly, Td is defined as the time between successive local crests or
troughs of the response, and between successive positive-going or negative-going zeros.

         Figure 9-2 on the next page is an annotated sketch of response (9-21) for positive
values of the ICs, x 0 > 0 and x&0 > 0, and for the small damping ratio  = 0.11. The

output is a sinusoid, cos(d t +  ), modulated by a decaying exponential envelope,

± xmaxe-n t  ±xmaxe-t 2 . In this equation for the exponential envelope, we define the
time constant  2 appropriate for underdamped 2nd order systems as

                             9-8
Chapter 9 Damped 2nd order systems: general time response        (9-22)

                         2  1
                                n

Figure 9-2 IC response of a damped 2nd order system,  = 0.11

         It is often necessary to measure experimentally the dynamic response of mechani-
cal systems, which requires sensors (transducers) that sense a response quantity and con-
vert it into an electrical voltage. The sensors most abundant and relatively inexpensive
for mechanical systems are translational accelerometers (see homework Problem 10.12).
Velocity sensors and translation (displacement) sensors are also used, but less commonly.
It is appropriate, therefore, that we find from "displacement" Eqs. (9-21) the corre-
sponding equations for free-vibration "velocity" and "acceleration." One differentiation
of (9-21b) gives

                 x&(t) = xmaxe-n t [- n cos(dt +  )- d sin(dt +  )]

Next, we combine the two sinusoidal terms with use of the trigonometric identity
sin A cos B + cos A sin B = sin( A + B) and the equation d  n 1 -  2 , leading to

x&(t) = -n xmaxe-n t sin(dt +  + sin-1  ), for 0  t and 0   < 1  (9-23)

One more differentiation of (9-23) followed by a similar combination procedure gives

        &x&(t) = -n2xmaxe-n t cos(dt +  + 2 sin-1  ), for 0  t and 0   < 1 (9-24)

We see that displacement, velocity, and acceleration all have the same damped sinusoidal
form. Therefore, experimental measurements of any of the three can be used for identifi-
cation of system parameters such as  and d, a subject addressed in subsequent sections.

9-5 Calculation of viscous damping ratio  from free-vibration response

         Consider an underdamped 2nd order system in a state of free vibration, i.e., with
zero input, u(t) = 0. This free vibration can be an initial-condition response or the resid-

9-9
                         Chapter 9 Damped 2nd order systems: general time response

ual response after input excitation has ceased, e.g., for t > td if the input is a pulse. Then
the free-decay response will have the form of Fig. 9-3. On the figure, a reference local
extreme value x(t0 )  x0 is annotated (at a crest on Fig. 9-3, but it could just as well be at
a trough), and subsequent local extreme values (both crests and troughs) also are anno-
tated. We wish to calculate viscous damping ratio  from the graph of response. Note
also that the exponential envelope is indicated on Fig. 9-3 with dashed lines.

Figure 9-3 Free-vibration response of a damped 2nd order system

We use Eq. (9-21b) for free-vibration response:

          x(t) = xmaxe-n t cos(dt +  )                       (9-21b) repeated

From this equation, we form the ratio x0 xr of the reference extreme absolute value
 x(t0 ) divided by the rth crest or trough absolute value, where r as shown on Fig. 9-3 can

have either integer or half-integer values. Note that cos(d t +  ) = 1 at each of the local

extreme values, and that the time of the rth extreme value is tr = t0 + r Td , where Td =
2 d is the damped natural period. So the required ratio is

x e-n t0                     2                                      
0=        = en rTd = expn r                       = exp 2 r
x e-n (t0 +rTd )  2                                              2    (9-25)
                             n 1-                            1-     
r                                                     

Taking the natural logarithm of Eq. (9-25) gives the so-called logarithmic decrement:

    ln   x0  = 2 r            = ln(x0 xr )   s                        (9-26)
     xr   1- 2               1- 2                2 r

In the last term of Eq. (9-26), we define  s as being the accurate approximation for
"small" damping ratio  . It is very common for a system to have positive, but small
damping. We define damping to be small if 1 -  2  1, which simplifies considerably

equations such as (9-26). For  = 0.2, 1 -  2 = 0.980 , so this is a reasonable upper

                  9-10
Chapter 9 Damped 2nd order systems: general time response

limit for "smallness." We can find the exact equation for  by squaring (9-26) and then
proceeding algebraically to derive

 =  s , for 0   < 1                                        (9-27)
      1+ s2

         It might appear that the preceding derivation requires the values of x0 and xr to
be at crests and troughs of the response plot, and that these should be zero-to-peak values;
but neither of these restrictions is necessary. The values of x0 and xr can be at any con-
venient instants along the time history (zeros of the response, as well as extremes), pro-
vided that we interpret x0 and xr as being the magnitudes of the exponential envelope at
the chosen instants. Normally, only the free-vibration response plot is available (from a
storage oscilloscope, strip-chart recorder, etc.), so we should sketch in the exponential
envelope to aid in measuring x0 , xr and r. Moreover, rather than measuring zero-to-

peak values, it is more accurate and easier to measure x0 and xr as peak-to-peak values,
from the lower exponential boundary to the upper exponential boundary.

        Let's summarize the procedure for measuring/calculating  from a plot of free-
vibration response. First, sketch in the exponential envelope. Next, choose time instants
along the graph at which you can measure with reasonable accuracy the number of peri-
ods r (usually an integer, half-integer, or quarter-integer) and the magnitudes x0 and xr

between the exponential boundaries. Next, substitute the measured values of r, x0 , and
xr into Eq. (9-26) and calculate  s . If this  s is  0.2, then    s with sufficient engi-
neering accuracy. However, if 0.2 <  s < 1, then calculate  more accurately from Eq.
(9-27).

         There is a simplified version of Eq. (9-26) that is often used for quick calculation
of small  . If possible, we find the reference magnitude and the rth magnitude such that
x0 xr = 2 , and we label the number of periods as r1/ 2 . Hence, ln(x0 xr ) 2  0.110,

which leads us from Eq. (9-26) to the half-amplitude formula for small  :

 s = 0.110                                                 (9-28)
        r1/ 2

         Finally, the preceding derivation was based upon Eq. (9-21b) for "displacement"
response x(t). However, the formulas derived for  are equally valid if the measurements
are made from graphs of "velocity" x&(t) or "acceleration" &x&(t) . This is so because, from
Eqs. (9-23) and (9-24), the derivatives of x(t) have the same exponentially-bounded sinu-

soidal form as x(t) itself.

9-11
Chapter 9 Damped 2nd order systems: general time response

9-6 Step response of underdamped 2nd order systems

         For step response, we set the ICs to zero, and we define the input to be a step
function at time t = 0, with step magnitude U: u(t) = U H(t). The appropriate form of the
general solution to use is Eq. (9-20a), which becomes [with H (t - ) = 1 for  < t]

n -n 2  =t             n -n 2  =t
x(t) =  e sin d × u(t - ) d =  e sin d ×U H (t - ) d
d  =0                  d  =0

    n -n 2  =t

= U  e sin d d

     d  =0

This integral can be evaluated by hand (e.g., using integration by parts), but the process is
tedious. The following evaluation was completed with use of a table of integrals:

x(t) = U n2    2 2 1 [e-n (- n sin d - d cosd )] =0  =t
       d (-n ) + d

= U 1 [e-n t (- n sin dt - d cosdt )-1(-d )]

    d

        -n t        n  
x(t) = U 1- e  cosdt + sin dt  , for 0  t and 0   < 1           (9-29)
                    d
                       

Note that the coefficient of sin d t in Eq. (9-29) is dependent only on the damping ratio:

n = n =               =s      [see Eq. (9-26)]
d n 1- 2            1- 2

        Step response (9-29) for small damping ratio  = 0.11 is plotted over a few
cycles of response on Fig. 9-4. Relative to the pseudo-static response, x ps = U, the actual

Figure 9-4 Step response of a damped 2nd order system,  = 0.11
                                      9-12
           Chapter 9 Damped 2nd order systems: general time response

step response of a damped system initially overshoots, then undershoots, then overshoots
again, then undershoots again, etc., etc. But damping dissipates the energy of vibration,
causing the response eventually (not shown on Fig. 9-4) to settle statically at lim x(t) =

                                                                                                                                                                     t

x ps = U. Several step-response characteristics (called specifications, or specs in engi-
neering jargon) of a system can be quantified and often are of great interest in practice.
For example, the rise time is the time required for the response first to reach U, which on
Fig. 9-4 is just a bit longer than 12  n . However, before studying those characteristics
in more detail, it is appropriate that we first consider impulse response.

9-7 Ideal impulse response of underdamped 2nd order systems

         For impulse response, we set the ICs to zero, and we define the input to be an
ideal impulse at time t = 0, with impulse magnitude IU : u(t) = IU  (t) . The more

appropriate form of the general solution to use is Eq. (9-20b), which becomes

 n -n (t - ) 2  =t  n -n (t - ) 2  =t
x(t) =  e           sin d (t - ) × u( ) d =  e  sin d (t -  ) × IU  ( ) d
d  =0               d  =0

Using the integration property of  ( ) , Eq. (8-11), we find the relatively simple result:

                     n -n t 2                                         (9-30)
           x(t) = IU e sin dt , for 0 < t and 0   < 1

                     d

         Ideal impulse response (9-30) for small damping ratio  = 0.11 is plotted over a
few cycles of response on Fig. 9-5. Observe that this ideal response violates the specified

   Figure 9-5 Ideal impulse response of a damped 2nd order system,  = 0.11
initial condition x&(0) = 0 ; thus, the solution is defective in this respect, as is discussed in
Section 8-7. Figure 9-5 shows the exponential envelope; note, in particular, the values at
t = 0 of the exponential envelope, ± IU n2 d . This magnitude is easily measurable
from a graph, after we have sketched in the exponential envelope, if necessary, and it is

                                                   9-13
Chapter 9 Damped 2nd order systems: general time response

essential in the process of estimating mechanical system parameters from an experimen-
tal response to a short force pulse (Section 9-9).

         From Eq. (9-30), we find the unit-impulse-response function (IRF, as defined in
Section 8-7) for underdamped 2nd order systems:

                   n -n t 2                                               (9-31)
h(t)  x(t) I =1 = e sin d t , for 0 < t and 0   < 1

             U d

Further, from Eq. (8-25), we find the Duhamel integral giving general response to input
u(t), with zero ICs, for underdamped 2nd order systems:

 =t n -n (t - ) 2  =t
x(t) ICs=0 =  u( ) h(t -  ) d =  u( ) e                   sin d (t - ) d  (9-32)
     d  =0
 =0

Duhamel integral (9-32) is identical to convolution-integral response solution (9-20b)
with zero ICs.

         Finally, it is worthy of mention that convolution sum Eq. (8-44) for approximate
numerical forced response applies just as well to damped 2nd order systems as to 1st order
and undamped 2nd order systems. Therefore, to calculate approximate forced response of
an underdamped 2nd order system, we would apply exactly the same procedure described

in Convolution-sum Example 2 of Section 8-11, but instead of calculating in Eq. (8-44)

the IRF h(t) = n sin nt for an undamped system, we would calculate Eq. (9-31).

9-8 Step-response specifications for underdamped systems

         Engineering systems are often designed so that the time history of an output quan-
tity will mimic as closely as possible the time history of the input quantity. An example,
with reference to Section 3-5, is the aileron-induced rolling of an airplane, for which the
original input is the control wheel angle set manually ("commanded") by the pilot, and
the ultimate output is the airplane roll rate. Another example is the modern automobile;
we usually describe a car as being "responsive" if the steering (or the acceleration, or the
braking) mimics quickly and precisely the driver's commands set by hand or foot.

         Step response of a system is often used for measuring and quantifying dynamic
"responsiveness." Ideally, step response would mimic exactly the step input, but system
characteristics such as inertia and damping prevent such instantaneous response. The de-
gree to which step response fails to mimic step input is quantified in the following four
step-response specifications: rise time, tr ; peak time, t p , maximum overshoot ratio, x p ,

and settling time, ts . These step-response quantities are illustrated on Fig. 9-6 on the
next page. They are called "specifications" or "specs" because it is common in the be-
ginning of a project to specify them as design targets; later, these step-response quantities
are measured experimentally on prototype and/or production test articles.

     9-14
                 Chapter 9 Damped 2nd order systems: general time response

           Figure 9-6 Step-response specifications of an underdamped system

         For underdamped 2nd order systems, we can apply step-response solution (9-29)
and impulse-response solution (9-30) to derive specific equations for the step-response
specifications:

Rise time, tr

From Fig. 9-6, we evaluate Eq. (9-29) at t = tr , the first time when x(t) = U :

                 -n tr                   n                            n
x(tr ) = U = U 1 - e  cosd tr + sin d tr   cosd tr + sin d tr = 0
                                          d                          d

                 d 1- 2 1
 tan d tr = - = -                       =-
                  n                          s

This last equation shows that as   0 from positive values, then tan d tr  - from

negative values; therefore,  d tr    1    ×  n  from higher values, where n = 1, 5, 9, ...; and
                                     2

the first time when x(t) = U corresponds to n = 1: d tr  12  from higher values. We

can see this in Fig. 9-4, where tr is just a bit after 12  n (keep in mind that d  n ).

This leads to the conclusion that the rise time is given by

                 t 1 -1 r = tan  1 -  2                                         y

                     d              -                        (9-33)

                                                                     1- 2          d tr
                                                                             -          x
In Eq. (9-33), we take the value of the four-quadrant inverse
tangent that is between 12  and  , as shown on the drawing at
right.

                                             9-15
     Chapter 9 Damped 2nd order systems: general time response

Peak time, tp

         From Fig. 9-6, t p is the time at which x(t) is maximum and the first time after t =
0 that x&(t) = 0. So we need to differentiate Eq. (9-29), set it to zero, and solve for t p
from the resulting equation. From the appearance of Eq. (9-29), though, that differentia-
tion will be long and tedious. But that drudgery will not be necessary, because a funda-
mental relationship derived in Section 8-7 will come to our rescue. We identify the unit-
step response as Eq. (9-29) with step magnitude U = 1:

    -n t                        n             -n t     n        
xH (t) = 1× 1- e  cosdt + sin dt  = 1- e  cosdt + sin dt  (9-34)
                                d                      d        

Clearly, t p is independent of step magnitude U. Now, Eq. (8-24) gives the derivative of
Eq. (9-34) as dxH dt = h(t) , where the IRF h(t) in this case is Eq. (9-31). Therefore, the
equation leading to t p that we seek is

     dxH                        n -n t 2
             = h(t) = e sin dt = 0 at t = t p                              (9-35)
     dt                         d

The required solution of Eq. (9-35) is the lowest positive value of t that satisfies sin d t
= 0, which is

                                   tp =                                    (9-36)
                                        d

The graphical equivalent of this mathematical derivation of Eq. (9-36) is evident in an
examination of Figs. 9-4 and 9-5, where we can see that both the peak of the step re-
sponse and the first zero of the ideal impulse response occur at an instant t just a bit after
 n (recall that d  n ).

Maximum overshoot ratio, x p

From Fig. 9-6, Eq. (9-29), and Eq. (9-36), the maximum overshoot ratio is

x p = x(t p ) - U = -e  -ntp  cos d t p +  n sin  d t p  = - exp -  n    cos +  n sin  
U                                  d                    d       d                               

                               
      x p = exp -                        1, valid for 0   < 1              (9-37)
                               1- 2 
                                          

                                      9-16
                   Chapter 9 Damped 2nd order systems: general time response

So the maximum overshoot ratio is a function only of viscous damping ratio  . Con-
versely,  can be determined from a measurement of x p by taking the natural logarithm

of Eq. (9-37):

ln x p = -          - ln x p =    s , valid for 0 < x p  1                    (9-38)
            1- 2                   1- 2

Note the similarity of Eq. (9-38) to Eq. (9-26) for the logarithmic decrement. Therefore,
we arrive again at Eq. (9-27), the exact equation giving  for any overshoot in the range

0 < x p  1:  =  s 1 +  s 2 , for 0   < 1, now with  s = - ln x p  .

        If damping is small such that 1 -  2  1, i.e., 0    0.2, then Eqs. (9-37) and
(9-38) are approximated as:

x p  e-  and   - ln x p            valid for 0    0.2 and 0.534  x p  1 (9-39)
                               

Settling time, ts

         This specification is defined as the time required for response x(t) to settle to
within ±2% of the final steady-state (pseudo-static) value, U. For this underdamped 2nd
order system, the time constant of the exponential envelope is Eq. (9-22),  2  1 n .
From Chapter 3, we have 1 - e-4 = 0.982 (see Fig. 3-3), so the settling time is defined as

                                 ts = 4 2  4                                  (9-40)
                                              n

         It is appropriate here to evaluate the variation in step response of a standard 2nd
order system as damping varies. Figure 9-7 on the next page displays 2nd order step re-
sponses for a range of viscous damping ratios  . [The response curves of Fig. 9-7 are
calculated as follows: for underdamping, 0   < 1, from Eq. (9-29); for critical damping,
 = 1, from the result of homework Problem 9.11; for overdamping,  = 1.2, from the

result of homework Problem 9.16. The time reference is undamped natural period Tn =
2 / n.] As engineers designing a system, we might wish to design into the system a
quantity of damping  that makes the time history of an output quantity mimic as closely

as possible the time history of the input quantity. This means, in the context of step

response, we would want both to make rise time as fast as possible and to minimize

overshoot. However, Fig. 9-7 shows that we cannot simultaneously do both for a stan-
dard 2nd order system: rise time is fastest for small  , but overshoot is minimized or
eliminated with larger  . Therefore, we would have to compromise and select a value of
 that produces practically acceptable values of both rise time and overshoot, even

                                   9-17
                         Chapter 9 Damped 2nd order systems: general time response

though neither response parameter would be the best possible. Observe from Fig. 9-7
that overshoot exists only for underdamping.

Figure 9-7 Step responses of standard 2nd order systems as viscous damping varies

         The transient response of engineered control systems is very important in practice,
so there is more analysis and discussion of subjects such as rise time and overshoot later
in the book, beginning in Chapter 14.

9-9 Identification of a mass-damper-spring system from measured response to a
short force pulse

         Suppose we have a mechanical system that is known to be an m-c-k system (or a
close enough approximation thereto, for engineering purposes), such as that of Fig. 9-1,
and suppose we need to estimate from experimental measurements the system
parameters: mass m, effective viscous damping constant c, and stiffness constant k. This
is a form of the process known generally as system identification (ID). There are many
methods of system ID using both transient response and frequency response. In this
section, we illustrate one common method based upon pulse response.

         The theoretical basis for system ID by pulse testing of a mechanical m-c-k system
is the ideal impulse response given by Eq. (9-30), with use of Eq. (8-13), IU = I F k , and
the equation for natural frequency, n 2 = k m :

x(t) = I F k m e-n t sin d t = I F e-n t sin dt  (9-41)
k d        md

Similarly, the values at t = 0 of the upper and lower boundaries of the exponential enve-
lope (for guidance, see Fig. 9-5) are

     9-18
Chapter 9 Damped 2nd order systems: general time response

     n2 IF                                                 (9-42)
± IU = ±
  d     md

The practical implementation of these equations is based upon using them to approximate
the real response from a short force pulse, as is discussed extensively in Section 8-6.

         The experimental procedure is as follows. An engineer or technician strikes the
mass lightly but sharply with a specially designed hammer. A force sensor mounted in
the head of the hammer measures the pulse. A displacement sensor measures motion of
the mass due to the force pulse. For accuracy of the system ID, it is essential that the
pulse duration td of the hammer strike be very short relative to a quarter of the system
natural period: td << ¼ Tn ; achieving this might require some experimental iteration,
testing hammer contact tips of different degrees of hardness. The time history fx(t) of
force input to the mass is recorded; this force pulse might be somewhat irregular, such as
Fig. 8-5, or it might appear to have a more regular form, such as a half-sine. The time
history of displacement response, x(t), also is recorded; with a properly short pulse dura-
tion, response x(t) should look very much like the damped sinusoid of Fig. 9-5, ideal im-
pulse response. The steps of the subsequent calculation algorithm are:

1. Calculate from measurements on the x(t) graph the damped natural frequency fd (Hz)
and the viscous damping ratio  . In order to obtain reasonably accurate values of fd and
 , be sure to average over as many cycles as possible of the damped sinusoid. To aid in
the calculation of  , first sketch in the exponential envelope. Next, use the values of fd
and  to calculate the two circular natural frequencies in rad/sec: d = 2 fd and n =

d 1 -  2 . For small  , these two frequencies will be essentially identical.

2. From the fx(t) graph, use graphical or approximate theoretical integration to calculate
the actual force impulse I F . From the x(t) graph, find the value at t = 0 of the upper and
lower boundaries of the exponential envelope, which are approximately ± I F md from

Eq. (9-42). It is important in this step to be very careful with the units of these quantities
measured from experimental data. Now, you have the data required to calculate the mass
from the identity

     1 IF   -1

m = d × ×                                                  (9-43)
 I F md 

3. Finally, calculate the stiffness constant using k = mn2 , and calculate the effective
viscous damping constant from Eq. (9-4), c = 2 mn = 2 mk .

         It is always essential in engineering practice to check your calculations as much
as is practical. After you have calculated m, c, and k from the procedure described above,
you can check the validity of your values by using MATLAB (or some similar calcula-

  9-19
Chapter 9 Damped 2nd order systems: general time response

tion software) to graph the ideal impulse response of your calculated system, Eq. (9-41);
then compare the calculated graph with the recorded experimental response. If the two
graphs are very similar, then your system ID is probably correct, provided that you cal-
culated I F correctly. However, suppose that you use an incorrect value of I F , then
calculate wrong values of m, c, and k based upon this wrong I F ; if you then graph the
ideal impulse response, using these wrong values in Eq. (9-41), the result will look very
much like the recorded experimental response, giving you a false indication that your
system ID is correct. Therefore, be sure to calculate correctly the force impulse I F .

9-10 Deriving response equations for overdamped 2nd order systems

        For  > 1, we can consider the damped natural frequency to be an imaginary
number:

d =  n 1 -  2 = jn  2 -1  jd where d   n  2 -1 is real (9-44)

The general method of deriving transient response equations for the overdamped case is
to substitute (9-44) into the Laplace transform (9-17), and then proceed to invert the re-
sulting equation, leading to general expressions that include IC response terms and con-
volution integrals, analogous to Eqs. (9-20).

         There is an easier method for finding overdamped-system response equations if
the comparable underdamped-system equations have already been derived. The method
is to use Eq. (9-44) in order to convert trigonometric terms of the  < 1 equations into
hyperbolic terms for the  > 1 equations. From homework Problem 2.13, we have the
following conversions valid for  > 1:

cos d t = cosh d t and sin  d t = sinh d t                 (9-45)
                                d      d

         An example of applying Eqs. (9-44) and (9-45) is conversion of IC response Eq.
(9-21a) from the underdamped ( < 1) form into the overdamped ( > 1) form:

-n t                 x&0 + n x0      
x(t) = e x0 cosdt +              sin dt for 0   < 1
                     d               

-n t                    x&0 + n x0        
 x(t) = e x0 cosh dt +             sinh dt for  > 1        (9-46a)
                        d 
                                          

in which d = n  2 -1 . This IC-response equation is valid for 0  t and  > 1. The
hyperbolic functions are defined in terms of exponential functions as

                      9-20
Chapter 9 Damped 2nd order systems: general time response

             ed t + e-d t                               ed t - e-d t
cosh dt =                           and sinh dt =

                   2                                         2

Therefore, IC-response equation (9-46a) can be written a bit more clearly as

1 -n t  d t       x&0 + n x0  -d t                    x&0 + n x0 
x(t) = e e  x0 +                           + e  x0 -                          (9-46b)
2                                   d                 d 
                                             

All terms in Eq. (9-46b) are exponentially damped. Even the first term within the square

brackets decays away exponentially  because  - n + d = -n + n  2 -1 =

- ( -  2 -1)n < 0 for  > 1.

Example 9-3: RC band-pass filter, an overdamped 2nd order system

         We re-visit Section 5-4, where the input voltage to the RC band-pass filter is de-

fined as ei (t) , the mid-circuit voltage between low-pass and high-pass stages is em (t) ,
and the output voltage is eo (t) ; also, the 1st order time constants of the low-pass and

high-pass stages are  L and  H , respectively, defined in terms of resistance and
capacitance values in the circuit. The two coupled 1st order ODEs derived in Section 5-4
are

for the low-pass filter stage,  L e&m + em = ei                       (5-16) repeated

for the high-pass filter stage,  H e&o + eo =  H e&m (5-17) repeated

         We combine these coupled 1st order ODEs into a single 2nd order ODE with the
following operations: differentiate Eqs. (5-16) and (5-17); in the differentiated (5-16),
replace e&m using the original (5-17), and replace e&&m using the differentiated (5-17); re-

arrange and collect terms to find the ODE relating output eo (t) to input ei (t) :

      L H e&&o + ( L +  H )e&o + eo =  H e&i                                  (9-47)

Due to the right-hand-side dynamics (the presence of e&i rather than just ei ), we cannot

cast this entire equation into the standard form (9-13); see homework Problem 9.15 for a
modified standard form of ODE and for convolution-integral response solutions. How-
ever, the order of the circuit is determined only by the left-hand-side terms, and it is
clearly 2nd order, with natural frequency and damping ratio defined as

n =   1       and  = 1  L +  H = 1  L +  H
      L H                 2n  L H 2  L H

                                    9-21
                         Chapter 9 Damped 2nd order systems: general time response

Suppose, for example, that a particular circuit has the high-pass and low-pass break
frequencies f H = 10 Hz and f L = 500 Hz, respectively. Then the time constants are
 H = 1 H =1 (2 f H ) = 1.592e-2 sec, and  L = 1 L =1 (2 f L ) = 3.183e-4 sec, and the
undamped natural frequency is n = 4.443e2 rad/sec ( fn = n 2 = 70.71 Hz). Finally,
the damping ratio is  = 3.606, which means that this is a strongly overdamped system.

                                                   9-22
                Chapter 9 Damped 2nd order systems: general time response

9-11 Homework problems for Chapter 9

9.1 In the system drawn below, mass m is attached to a movable support by viscous

                                dashpot c1 and spring k, and the mass also

                x(t)         xi(t) slides on a lubricated surface, which causes

                          k     viscous damping with constant c2 . There are
fx(t) m                         two independent input quantities: (1) support
                                displacement xi(t) shown (displacement con-

c2                              trol, e.g., by a cam), which is often called base

                      c1        excitation,4 and (2) force fx(t) shown. The out-

                                put quantity is displacement x(t) of the mass.

Sketch and label clearly appropriate free-body diagrams, then use your FBD to derive the

differential equation of motion for x(t) in terms of constants m, c1, c2 and k, and variable

inputs xi(t) and fx(t). Your ODE of motion should include some non-standard right-hand-

side dynamics.

9.2 Given, a standard m-c-k system, Fig. 9-1, with the following parameters: weight of

                             W        0.386 lb  2 = 0.001  lb - sec2
the mass W = 0.386 lb, so that m = =                                       ; damper vis-
                             g 386 inch/ sec               inch

cous constant c = 1.1 × 10-3 lb/inch/sec; spring stiffness constant k = 3.025 lb/inch.

(a) Calculate the following quantities, all to at least 3 significant figures: n in rad/sec,
fn in Hz,  , d in rad/sec, fd in Hz, and Td  1/fd . You may calculate these quantities in
MATLAB, if you wish, using the command format short e.

(b) Given initial conditions x(0) = 0.5 inch and x& (0) = 35 inch/sec, calculate and graph
with MATLAB the free-vibration response due to the ICs over about 20 complete de-
caying cycles. Since you are multiplying sinusoidal time functions by an exponential
time function, it is necessary that you use array multiplication (.*) in MATLAB. Draw
grids on your graph and add an appropriate title and appropriate axis labels.

(c) Sketch by hand the exponential envelope on your graph, then use the grids and/or a
graduated straight edge to measure amplitudes of local peaks of the decaying sinusoid. In
particular, find (approximately) the quantity r1 2  the number of decaying cycles to de-

cay to half amplitude (not necessarily an integer). Now calculate the dimensionless ratio
0.110 r1 2 ; the value that you calculate should match closely with your previously calcu-
lated value of  .

4 Base excitation is displacement input imposed at the "ground" or "base" side of the spring instead of
directly upon the mass. It is very common to consider base excitation in analyses of earthquake-induced
response of buildings, automobile tires rolling over bumpy roads, and vibration isolation of sensitive
devices such as delicate payloads in rocket boosters.

                                                   9-23
                         Chapter 9 Damped 2nd order systems: general time response

9.3 The free-vibration response to initial conditions of a standard damped 2nd order sys-

tem is given by x(t) = 2.24 e-0.300t cos(12.00t -1.11) mm, where t is in seconds. Calcu-

late (i) the damped natural frequency fd in Hz, (ii) the damping time constant  2 in sec-
onds, and (iii) the viscous damping ratio  (use the small- approximation). Show your
calculations.

9.4 A simple type of vibration testing often used for underdamped mechanical systems,
such as the m-c-k system of Fig. 9-1, is called twang testing (named after the sharp,
ringing sound made by plucking a string of a musical instrument; Section 7-6
demonstrates twang testing of a flexible beam): the mass is displaced from its static
equilibrium position by amount x0 (with zero initial velocity, x&0 = 0 ), then it is released.
From the record of subsequent transient response, we can calculate directly the damped
natural frequency fd and the viscous damping ratio  . If we know initially either the mass
m or the stiffness constant k, then we can use the measured fd and  to calculate the other
constant and the effective viscous damping constant c. Use Eq. (9-21b) to show that
twang test response is

                  x(t) = xmaxe-n t cos(dt +  ) , for 0  t and 0   < 1

where xmax = x0 1 -  2 and  = tan -1 (-  1 -  2 )

For a very lightly damped system, the preferred simple approximation of this twang re-
sponse is

                         x(t)  x0e-n t cos(nt ), with   0

How small must  be so that phase lag  is so small (say, ||  5°) that it can't be distin-
guished from zero phase lag,   0? [NOTE: the measurement resolution on a typical
analog graphical record of transient-decay vibration response (for example, from a small
oscilloscope screen) is so limited that the resolution of calculated phase is probably only
around ± 5°.]

9.5 A laboratory mass-damper-spring system was set into motion and then allowed to
vibrate freely. The time-history acceleration on the next page was sensed by a light-
weight accelerometer attached to the mass. The graph was copied from the screen of a
digital oscilloscope. Calculate from measurements on a photocopy of the graph the
damped natural frequency fd (Hz) = d /2 and the viscous damping ratio  . In order to
obtain reasonably accurate values for fd and  , be sure to average over many cycles of the
damped sinusoid. To calculate  , first sketch in the exponential envelope. Also, note
that the zero level of the acceleration signal is offset from the center horizontal grid line;
therefore, peak-to-peak amplitude measurements are more appropriate than zero-to-peak
measurements, as well as more accurate. Annotate your measurements on the graph
(submit the annotated graph), and show your calculations clearly. From your values for fd
and  , calculate the undamped natural frequency fn (Hz). For a lightly damped system

                                                   9-24
                         Chapter 9 Damped 2nd order systems: general time response

such as this one, is the difference between fd and fn numerically significant, given the
limited precision of the measured quantities?

9.6 A standard m-c-k system is initially at rest. Then an engineer strikes the mass with a
soft-tipped hammer that produces a relatively slow half-sine force pulse of amplitude 25
lb and duration 0.1 sec [ fx(t) = 25 lb × sin(10 t) for 0  t  0.1 sec]. Both the force pulse
fx(t) and the displacement response x(t) of the mass are recorded on the graph below. To
support the calculations assigned (next page), annotate your measurements on a

                                                   9-25
                         Chapter 9 Damped 2nd order systems: general time response

photocopy of the graph (hand in the annotated graph), and show your calculations clearly.
(a) Calculate from the fx(t) equation the impulse I F produced by the force. However,
you should not use this I F in Eq. (9-43) to determine m. Explain why not.
(b) Calculate from the graph, with as much accuracy as the data permits, the damped
natural frequency fd (Hz), and the viscous damping ratio  of the system.
(c) The system's mass m is known to be 0.0652 lb-sec2/inch. Calculate stiffness constant
k and damping constant c.
9.7 A large mass-damper-spring (m-c-k) system is initially at rest. Then a machine im-
poses upon the mass a slowly varying force in the form of a sawtooth pulse of amplitude
800 N and pulse duration 1.5 sec, fx(t) = 800 N × t for 0  t  1.5 sec. Both the force

                                                   1.5 sec
pulse fx(t) and the displacement response x(t) of the mass are recorded on the graph
below. The unusual displacement scale " x(t) (mm * 100)" is employed in order to
accommodate the ranges of both fx(t) and x(t) on the same graph; this scale simply
means that the range of displacements on the graph is -6.00 mm  x(t)  +8.00 mm. To
support the calculations assigned (next page), annotate your measurements on a photo-
copy of the graph (hand in the annotated graph), and show your calculations clearly.

                                                   9-26
Chapter 9 Damped 2nd order systems: general time response

(a) Calculate the total impulse I F produced by the force. However, you should not use
this I F in Eq. (9-43) to determine m. Explain why not.

(b) Calculate from the graph, with as much accuracy as the data permits, the damped
natural frequency fd (Hz), and the viscous damping ratio  of the system.

(c) The system's stiffness constant k is known from static testing to be 120.0 kN/m. Cal-
culate mass m and damping constant c.

(d) Find the algebraic/numerical equation for the pseudo-static response xps(t) while the
pulse is active (0  t  1.5 sec), and compare your xps(t) with the actual response x(t) on
the graph.

9.8 Consider the mass-damper-spring system shown in the figure below, with:

(a) m0 = 10.0 kg, c = 40.0 N-sec/m, k = 400 N/m, and m1 = 2.00 kg;

(b) m0 g = 225 lb, c = 2.10 lb-sec/inch, k = 30.5 lb/inch, and m1g = 105 lb.

The system is initially at rest (the left-hand figure) in the static equilibrium position for

weight m0 g . At t = 0, mass m1 is gently placed upon m0 and then released. This im-

poses an m1g step force (the weight, due to

gravity) onto the system. Note also that mass                                 m1
m1 changes the system, since the total vibrat-
                                                m0                            m0
ing mass now will be m0 + m1 , not just m0 .
Use Eq. (9-29) for underdamped 2nd order        k                   y(t)      k
system step response to write the numerical
equation for response y(t) in inches of com-        c                             c

bined mass m0 + m1 (relative to the static

equilibrium position for the weight of m0

alone, as indicated on the figure). Then use MATLAB to plot the response curve of y(t)

versus t from t = 0 until the mass has settled to within at least 2% of its final steady-state
position. This means plot to at least four time constants, t = 4 2 , where  2 = (n)-1.

Since you are multiplying sinusoidal time functions by an exponential time function, it is

necessary that you use array multiplication (.*) in MATLAB. Provide appropriate grids,

titles, and labels on your graph. It is not required, but you can check from your graph

that the response has the values of frequency, steady-state (final static, pseudo-static) dis-

placement, and viscous damping ratio that you can calculate from the original data for

mass, damping, stiffness, and applied force.

9-27
               Chapter 9 Damped 2nd order systems: general time response

9.9 For the m-c-k system and step input/response of homework Problem 9.8 [part (a) or
(b), whichever is assigned], use the equations of Section 9-8 to calculate rise time tr ,
peak time t p , maximum overshoot ratio y p , and settling time ts . These calculations

should agree with the comparable results that you can measure from your MATLAB
step-response graph for homework Problem 9.8, assuming that your graph is correct.

9.10 Weight W2 = 98.1 N (mass m2 = 10.0 kg) is suspended by a string from weight W1 =
196.2 N (mass m1 = 20.0 kg), which is attached to the ceiling by spring k and viscous
dashpot c, as shown below. The system is in static equilibrium when, at time t = 0, the
string is cut cleanly, dropping W2. (This simulates the release of a bomb from a flexible
airplane wing.) Consider the subsequent motion x(t), t  0, of m1. With the y(t) datum
shown on the drawing, you can think of this as step-response, with the release of W2 be-
ing equivalent to imposing upon m1 an upward step force equal to W2.

k = 20,000              c = 140    (a) Calculate the undamped natural frequency fn
     N/m                  N-sec/m  (Hz), the damping ratio  , the damped natural
                                   frequency fd (Hz), and the damped period of os-
                                   cillation Td (sec).

                                   (b) Calculate the final (as t  ) static value of y

            m1 = 20 kg             and the settling time ts required for the motion to

                            y(t) settle within 2% of that final static value.

string cut at                      (c) Sketch a plot of the response y(t) versus t

t = 0       m2 = 10 kg W2 = 98.1 N from t = 0 until about t = ts. Don't carry out ex-

                                   tensive calculations; just use the results of parts

(a) and (b) to sketch an engineer's back-of-the-envelope type of quick graph that clearly

shows the principal features of the response, but is not precise like a computer-generated

graph.

9.11 Derive the algebraic equation for step response x(t) with zero ICs of critically
damped 2nd order systems: &x& + 2n x& + n 2 x = n 2U , for t  0, with x(0) = 0 and x&(0) =
0. One easy method of solution, the conventional approach of Section 1-5, is to use
homogeneous solution (9-9), add to it an appropriate particular solution, then enforce the
ICs to determine the unknown constants. (Answer: x(t) = U [1- (1+ nt)e-n t ] , t  0)

9.12 Having solved by inverse convolution transform for step and impulse responses of
underdamped 2nd order systems, we can now use those results to obtain rather easily two

messy Laplace transform pairs. Use Eq. (9-17) first with Eq. (9-29) and next with Eq. (9-

               -1  n 2                     -1  n 2 
31) to obtain f H (t) = L          2 2  and f (t) = L                     2 2  , both
                         s[(s + n ) + d ]             (s + n ) + d 

for 0  t ,  < 1 , and d 2 > 0 . Write the algebraic equations for f H (t) and f (t) .

                                   9-28
           Chapter 9 Damped 2nd order systems: general time response

9.13 Consider the LRC circuit drawn below. The ODE describing output voltage eo (t)

ei(t) c S  L em RL          in terms of input voltage ei (t) is derived in Ex-
                            ample 9-1 of Section 9-2. Because an inductor
                    eo(t consists primarily of coiled wire, and because

                    coiled wire accumulates resistance, a real in-

E C i ductor has resistance as well as inductance. A
                    common, simple, approximate circuit model for
           i(t)
                    such a real inductor is a series combination of an

                                                 ideal inductor and a resistor, L and RL , as shown
                                                 in the drawing. Suppose that one small circuit
component has the values L = 1.4 H and RL = 210 , and that it is in series with a ca-
pacitance of C = 0.25 F (micro-farad), as shown in the drawing. Calculate the natural
frequency fn (Hz) and damping ratio  of this circuit. Suppose further that the input volt-

age is ei (t) = 1.50 H(t) volts (a 1.5-volt battery is connected suddenly by switch S), and

that all ICs are zero (in particular, there is no initial charge on the capacitor). Use MAT-

LAB to plot output voltage eo (t) over a time interval from zero until eo (t) settles to

within at least 2% of its final steady-state value.

9.14 A particular device is known to be a mass-damper-spring system. It is required that
the mass m, the viscous damping constant c, and the stiffness constant k be identified ex-
perimentally from a transient-response test. In this test, an engineer strikes the mass
sharply with a specially designed hammer that is instrumented with a force sensor. The
force input to the mass is recorded, and examination of the actual force time history
shows that it is closely approximated by a particular half-sine force pulse that lasts only

20 milliseconds, f x (t) = 58.9sin 50 t × [H (t) - H (t - 0.02 sec)] lb. The measured dis-

placement response of the mass is shown on the graph below. Use this information to

                    9-29
                Chapter 9 Damped 2nd order systems: general time response

calculate m, c, and k in consistent units and with as much accuracy as the data permits.
To support these calculations, annotate your measurements on the graph (hand in a photo-
copy of the annotated graph), and show your calculations clearly. The input force pulse
is very short relative to the oscillatory period of the system. Therefore, for the purpose of
approximate parameter identification, you should assume that the response is very close
to ideal impulse response of the system to an ideal impulse, f x (t) = IF(t), with IF having
the value of the impulse of the actual half-sine force pulse. [NOTE: after you calculate
m, c, and k, you can easily check the validity of your values by graphing (with
MATLAB) the ideal impulse response of your system and then comparing that graph
with the actual time history of response. However, this check is valid only if you use the
correct value of impulse IF , so first be 100% certain that your IF is correct.]

9.15 For systems with the particular type of right-hand-side dynamics of Eq. (9-47), we
can define a physical constant T having dimensions of time, then write a modified form
of standard ODE (9-13) as &x& + 2n x& + n 2 x = n 2T u&(t) . [You can easily verify, for
example, that T =  H for the band-pass filter, Eq. (9-47).] The pure IC-response of this
equation is the same as Eq. (9-21), so let's focus on the forced response and set all ICs =
0. Also, let's assume initially that  < 1, so that d 2 = n 2 (1 -  2 ) > 0 .

(a) For this modified ODE, follow the steps from Eqs. (9-14) to (9-17), and assume also

that u(0) = 0. to find L[x(t)] = n 2T  2 2 sd L[u(t)]. Next, use a Laplace
                         d (s + n ) + d

transform pair developed, in effect, between Eqs. (9-17) and (9-20) to solve for x(t) if

the input is step function u(t) = U H (t) . Which of the zero ICs is or is not preserved in

this solution?

(b) Use the inverse transform for step response of part (a), and the general transform

L[f& (t)] = s F (s) - f (0) to derive the following inverse transform:

                -1   sd   -nt
                L      2 2  = e (d cosd t - n sin d t )
                (s + n ) + d 

(c) Use the result of part (b) and the inverse convolution transform to write x(t) ICs=0
equations, which involve convolution integrals, that apply for arbitrary input function
u(t) .

(d) Use the result of part (b) and Eq. (8-24) to show that the algebraic equation for the
unit-impulse-response function (IRF) valid for the modified 2nd order ODE with right-

hand side dynamics is h(t) = n 2Te-nt [cosd t - (n d ) sin d t]. Now use this IRF to

write a Duhamel integral equation, Eq. (8-25), for x(t) ICs=0 that applies for arbitrary
input function u(t) .

                                       9-30
     Chapter 9 Damped 2nd order systems: general time response

(e) The results of parts (a)-(d) apply for an underdamped 2nd order system,  < 1. But

Example 9-3 in Section 9-10 shows that an RC band-pass filter, for one, is an over-
damped 2nd order system, so we need to convert the previous results to obtain results
valid for  > 1. Use the methods of Section 9-10 to write an algebraic equation for IRF

h(t) and an integral equation for x(t) ICs=0 , both valid for the modified overdamped 2nd
order ODE with right-hand side dynamics and the latter valid for arbitrary input function
u(t) .

9.16 Figure 9-7 includes a curve that is step response of a standard overdamped 2nd order
system. Use the methods of Section 9-10 to derive the algebraic equation from which
that particular curve was calculated. Answer:

 -n t                              n                                        2
x(t) = U 1- e  cosh dt + sinh dt  , for 0  t and  > 1, d  n  -1
                                   d        

9.17 The circuit drawn

at right5 consists of          Rc

three stages, each built              C                C                Rd

around an op-amp, and          Rb                  Rb               Rd

there is feedback of

voltage e f (t) from the       Ra           em(t)         eo(t)                ef(t)

last (right-hand) stage ei(t)
to the first (left-hand)
stage, where the input

voltage ei (t) is applied. The circuit output voltage, eo (t) , is the output of the middle

stage. The first stage is a summing, inverting integrator; use the methods of Chapter 5 to
derive the first ODE, em Rc + e f Rb + ei Ra = -Ce&m . Next, for the middle stage, an

inverting integrator, derive the second ODE, em Rb = - Ce&o (homework Problem 5.6);

now use the second ODE to substitute for em in the first ODE, and differentiate the
second ODE and use the result to substitute for e&m in the first ODE. The last stage of the
circuit is a simple sign inverter, for which e f = -eo from Eq. (5-13b); substitute for e f

and show that the ODE relating output voltage eo (t) to input voltage ei (t) for the entire

                               2         2
  1                       1            1  Rb
circuit is e&&o + e&o +   eo =   ei . Convert this ODE into the standard
  RcC  RbC                             RbC  Ra

damped 2nd order form (9-13), e&&o + 2ne&o + n 2eo = n 2u(t) ; write specific equations

(in terms of this circuit's resistances, capacitances, and input voltage) for undamped natu-

ral frequency n, viscous damping ratio  , and input quantity u(t).

5 This circuit is essentially the electronic analog computer (see the footnote to homework Problem 5.6) for
solving ODE (9-13).

                                                   9-31
Chapter 9 Damped 2nd order systems: general time response

9.18 One rate gyroscope (Example 9-2 in Section 9-2) has the following rotor parame-
ters: polar rotational inertia Jr = 2.9 × 10-4 kg-m2, and spin rate r = 2,100 revolutions
per minute (rpm); also, it has the following gimbal-shaft parameters: polar rotational in-
ertia J = 2.2 × 10-4 kg-m2, and damping constant c = 0.0046 N-m/(rad/sec), and stiff-
ness constant k = 0.096 N-m/rad. Consider output gimbal-shaft rotation (t) in response
to an input turntable rotational rate that approximates step function p(t)  P × H(t). (Only
a physically impossible ideal impulse moment acting on the turntable could produce an
exact step change in rotational rate; therefore, imagine for this problem that a very short
but very large moment pulse produces the approximate step function, but use the equa-
tions that apply for an exact step function.) For the step magnitude P = 15 degrees/sec,
calculate the following response quantities: pseudo-static gimbal-shaft rotation, ps (in

degrees); and rise time, tr ; and peak time, tp ; and maximum overshoot ratio, x p . (Partial

answer: tp = 0.174 sec) The theory developed in Example 9-2 is accurate only if gimbal-
shaft rotation (t) is sufficiently small that cos(t)  1, say, cos(t) > 0.95. For the para-
meters in this problem, is this criterion for accuracy satisfied?

9.19 Another type of single-axis gyroscopic sensor is similar to the rate gyro described in
Example 9-2 of Section 9-2 except that there is no spring to restrain the rotation of the
gimbal-shaft assembly, so k = 0 in the equations derived in Example 9-2. Therefore, the
equation of motion becomes effectively a 1st order ODE in dependent variable &(t) , the
rate of gimbal-shaft rotation:

          J&& + c& = J r r p(t)

Observe from the ODE that the pseudo-static response is (&) ps = (J r r c ) p(t) . But the
electrical transducer of this device detects (t), not &(t) , which means that the sensed

quantity has the form  (t) = &( ) d = (J r r c ) p( ) d . Therefore, this type of sen-tt

sor is called a rate-integrating gyroscope; its output is proportional, not to the rotational

rate, but to the actual rotational angle of the turntable,  (t) =  p( ) d , where p  & .
                                                                                                                                       t

Consider output gimbal-shaft rotational rate &(t) and rotation (t) in response to an input

turntable rotational rate that approximates the following flat pulse of duration td :

0, t < 0

p(t) =  P, 0 < t < td  , in which magnitude P is constant

  0,  td < t


(Only physically impossible ideal impulse moments acting on the turntable could produce
exact step changes in rotational rate; therefore, imagine for this problem that very short
but very large moment pulses produce the approximate step changes, but use the equa-
tions that apply for the exact flat pulse.)

                       9-32
Chapter 9 Damped 2nd order systems: general time response

(a) The mathematical solution for response of a standard stable 1st order system to a flat-

pulse input is given in homework Problem 6.2(a). Adapt this solution to write response
equations for the rate-integrating gyro's gimbal-shaft rotational rate, &(t) , given the IC
&(0) = 0. Next, integrate appropriately (show all details!) the &(t) equations, given the

IC (0) = 0, to derive the following equations for gimbal-shaft rotation:

 bP1[t -1(1 - e-t 1 )], 0  t  td

 (t) = 

                                  2  -td 1  -(t-td ) 1
 (t ) + bP (1 - e )(1 - e                               ),  td  t
d                                 1

where b  Jr r / J and 1  J / c .

(b) One rate-integrating gyro has the following rotor parameters: polar rotational inertia
Jr = 2.9 × 10-4 kg-m2, and spin rate r = 420 revolutions per minute (rpm); also, it has the
following gimbal-shaft parameters: polar rotational inertia J = 8.5 × 10-4 kg-m2, and
damping constant c = 9.2 × 10-3 N-m/(rad/sec). For the flat-pulse rotational-rate mag-
nitude P = 5 degrees/sec and pulse duration td = 2.5 sec, calculate and plot from the equa-
tions of part (a) the gimbal-shaft rotation (t) (in degrees) over the time interval 0  t  5
sec. The theory developed in Example 9-2 is accurate only if gimbal-shaft rotation (t) is
sufficiently small that cos(t)  1, say, cos(t) > 0.95. For the parameters in this prob-
lem, is this criterion for accuracy satisfied?

(c) Since (&) ps = (J r r c ) p(t) = (J r r c )& (t) , it is clear the rate-integrating gyro's

output is designed to be proportional, as closely as its dynamics permit, to the actual ro-
tational angle of the turntable, i.e.,  (t)  (J r r c ) (t) ; therefore, the equation that
estimates  (t) from the measured gimbal-shaft rotation is  (t)  [c (J r r )] (t) . Use
your calculated (t) from part (b) to calculate and plot the quantity [c (J r r )] (t) over
the same time interval, 0  t  5 sec. Next, calculate the actual turntable rotational angle

from  (t) = t p( ) d , given the IC (0) = 0, and plot it on the same graph for compari-
                            0

son with [c (J r r )] (t) . In this case, how well does the rate-integrating gyro follow
the actual turntable rotation?

                                     9-33
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

Chapter 10 2nd order systems: frequency response; beating response to
                 suddenly applied sinusoidal (SAS) excitation

                                 © 2016 by William L. Hallauer, Jr.

10-1 Frequency response of undamped 2nd order systems; resonance

         As discussed in Section 7-1, a truly undamped 2nd order passive system is physi-
cally unrealistic. Nevertheless, it is useful to derive the frequency response for this ideal
type of system because the results reveal important characteristics of the resonating be-
havior of general underdamped 2nd order systems. Moreover, the frequency response of
an undamped 2nd order system is, for many practical purposes, a simple yet satisfactory
engineering approximation to the frequency response of the corresponding lightly
damped 2nd order system.

         Consider the standard ODE for idealized undamped 2nd order systems:

        &x& +  n 2 x =  n 2u(t)                (10-1), Eq. (7-5) repeated

To derive frequency response, we let u(t) = U cost and seek the steady-state sinusoidal
response in the form x(t) = X S () cost , in which X S () is the unknown quantity.
We find an equation for X S () by substituting into Eq. (10-1):

                 (-  2 + n 2 )X S () cost = n 2U cost

         X S () =    n2    2=    1                                                    (10-2)

                     2                      2
        U n -  1 - ( n )

Note from Eq. (10-2) that X S () is a signed quantity; it can be positive or negative de-
pending upon the value of frequency ratio  n relative to 1. But our conventional no-
tation for a frequency response function is FRF () = X () e j() , Eq. (4-41), in which

                                                                     U
magnitude X ()  0. Therefore, we infer from Eq. (10-2) the following magnitude-ratio

and phase functions in the conventional notation:

X () =  1                          0° for 0   n < 1  (10-3a, b)
                                 -180° for 1 <  n
                  2  , () = 
U 1 - ( n )                    

                     10-1
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

Equations (10-3) give the frequency response function (FRF) of an undamped 2nd order
system. The magnitude ratio X () U and phase () are plotted on Fig. 10-1 as func-

tions of excitation frequency ratio  n .

10                                            The most important feature

9                                             of FRF (10-3) is the infinite mag-

                                              nitude of steady-state response

8 when excitation frequency  ex-
                                             actly equals natural frequency n.

7                                             This is the extreme version of the

                                              phenomenon called resonance. In

           6                                  reality, any damping, no matter
X ()                                          how small, reduces the infinite
                                              resonance magnitude of Fig. 10-1
 U5                                           to some finite value, as is demon-
                                              strated in the next section; but that
           4

3                                             finite value will still generally be

                                              much greater than the static or

2                                             pseudo-static response, which is

                                              X (  0) = U . Figure 10-1 shows

            1    1 /n                             also that the response magnitude is
                                                  greatly amplified relative to static
            0                                     response even if the excitation fre-
              0                               2 quency is close (but not equal) to
                                                  the natural frequency; note, for ex-
          0°                                      ample, that the dynamic amplifica-

 ()

-180°                                         tion exceeds five (5) whenever ex-
                                              citation frequency  is within

Figure 10-1 Frequency response function       about ±10% of natural frequency
of an undamped 2nd order system               n. This high sensitivity to excita-

                                              tion near the natural frequency is a

very important characteristic of lightly damped 2nd order systems. There is additional

discussion of resonance in the next section.

        FRF (10-3) contains not only the magnitude but also the phase  : for  < n, the
phase is 0°, so the response is exactly in phase with the excitation; however, for  > n,
the phase is -180°, so the response is exactly out of phase with the excitation.

10-2 Frequency response of damped 2nd order systems

         From Section 9-2, the standard form of the 2nd order ODE is:

                 &x& + 2 n x& +  n 2 x =  n 2u(t) (10-4), Eq. (9-13) repeated

To derive frequency response, we take the Laplace transform of (10-4), with zero ICs:

                    10-2
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

   (s 2 + 2 n s +  n 2 )L[x(t)] ICs=0 =  n 2 L[u(t)]                                  (10-5)
                                                                                      (10-6)
Definition (4-23) for the transfer function gives

   TF (s) =  L[x(t)] ICs=0  2 n
                                      =2
             L[u(t)] s + 2 n s +  n                2

Then the fundamental relationship (4-41) between the transfer function and the complex
frequency response function gives

                                  n2               2 = 2 21                           (10-7)
FRF () = TF ( j) = 2
   -  + j2n + n (1 -  n )+ j 2  n

To simplify notation, we define the dimensionless excitation frequency ratio, the excita-
tion frequency relative to the system undamped natural frequency:

                                                                                      (10-8)
                            n

With notation (10-8), the relationship (4-41) between FRF() and the magnitude ratio
X ( ) U and phase angle  () of the frequency response gives

   FRF () = 2 1                                    = X () e j()                       (10-9)
             (1 -  ) + j2 U

After the standard manipulation of the complex fraction in Eq. (10-9), we find the fol-
lowing equations for magnitude ratio and phase angle [homework Problem 2.6(a)]:

X () = 1 , () = tan -1 2   - 2 ,                                    (10-10)
U  (1 -  2 )2 + (2 )2                              1-            n

         Note that results (10-10) are valid for any non-negative value of viscous damping
ratio,   0; unlike most of the time-response equations derived in Chapter 9, Eqs. (10-
10) alone apply for underdamped, critically damped, and overdamped 2nd order systems.

         Results (10-10) are plotted on Fig. 10-2 (page 10-5) for viscous damping ratios
varying from 0 to 1. The graphs of Fig. 10-2 were produced with use of MATLAB (Ver-
sion 6 or later). First, an M-file was programmed to calculate and graph FRFs using the
method described in the statement of homework Problem 4.3 [starting with complex FRF
(10-9), not the real equations (10-10)]:

                                      10-3
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

%frf2orddamped.m
%Fig. 10-2 Frequency response, damped 2nd order
%Magnitude ratio for zero damping, zeta=0
bt0a=logspace(-1,log10(0.998),100);
frf0a=(1)./(1-bt0a.^2);
loglog(bt0a,frf0a,'k'),hold on
bt0b=logspace(log10(1.002),1,100);
frf0b=(1)./(bt0b.^2-1);
loglog(bt0b,frf0b,'k')
%Magnitude ratio for several cases of zeta > 0
bt1=logspace(-1,1,400);
zt=[ 0.05 0.1 0.2 0.5 1/sqrt(2) 1];nzts=length(zt);
for i=1:nzts

       frf=(1)./(1-bt1.^2+j*2*zt(i).*bt1);
       magrat=abs(frf);
       loglog(bt1,magrat,'k')
end
hold off
%Phase angle in degrees for zero damping, zeta=0
bt0a=[0.1 1];faz0a=zeros(1,2);
figure,semilogx(bt0a,faz0a,'k'),hold on
bt0b=[1 10];faz0b=-180*ones(1,2);
semilogx(bt0b,faz0b,'k')
%Phase angle in degrees for several cases of zeta > 0
for i=1:nzts
       frf=(1)./(1-bt1.^2+j*2*zt(i).*bt1);
       faz=angle(frf)*180/pi;
       semilogx(bt1,faz,'k')
end

After the M-file was executed, the extensive figure editing features of MATLAB were
used to set axis limits and to generate titles, labels, and curve annotations.

         Even though Fig. 10-2 was produced by computer-aided graphics, it is still im-
portant that you understand how to evaluate Eqs. (10-10) with a hand calculator. These
equations appear simple, but they can be tricky, particularly for the special case  = 0.
See homework Problem 2.6(b) for help with understanding how to evaluate Eqs. (10-10)
numerically.

         There are several noteworthy characteristics of the frequency response of damped
2nd order systems, from Eqs. (10-10) and Fig. 10-2:

* Resonance: maximum (peak) magnitude ratio The frequency at which the peak
magnitude ratio occurs is called the resonance frequency, denoted r , and this frequency
is lower than natural frequency n if damping is positive,  > 0. To find the maximum,

we differentiate the magnitude ratio of Eqs. (10-10), set the result to zero, and solve for
the associated frequency (you can verify the result yourself, or see Meirovitch, 2001, pp.
115-116 for the details of calculus and algebra; also, there are instructive alternative ap-
proaches in Ogata, 1998, pp. 480-481 and in Clark, 1962, pp. 316-322):

d  X () =0    r = 1 - 2 2   r = n 1 - 2 2
                                                       (10-11)
d  U 

             10-4
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

Figure 10-2 Frequency response functions for standard 2nd order systems with
viscous damping ratios  varying from 0 to 1

                                                   10-5
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

Subscript r in Eq. (10-11) denotes a resonance quantity corresponding to the peak magni-
tude ratio Xr / U. The excitation frequency must be real and greater than or equal to zero,

so r = n 1 - 2 2 is valid only for 0    1 2 = 0.707. If  is positive but very
small, then X r U occurs almost at the natural frequency, r  n . As  increases from

very small positive values, r decreases until, for  = 1 2 , r = 0. However, dynamic
amplification is insignificant for values of  greater than about 0.5. Substituting Eq. (10-
11) back into X ( ) U of Eqs. (10-10) gives (after more algebra) the resonance value:

X (r ) = X r = 1       (10-12)
U  U 2 1 -  2

Note from Eq. (10-12) that for  = 1 2 [the maximum permissible value for validity of
Eq. (10-11)], we have X r U = 1 at r = 0. As indicated by the trend on Fig. 10-2, for
higher damping ratios,   1 2 , the magnitude X ( ) U is maximum at  = 0, and
decreases monotonically as  increases.

* Response at the natural frequency The frequency response at  = n ,  = 1 , consists
of phase angle (n ) = -90° regardless of the value of viscous damping ratio  , and
magnitude ratio X (n ) U = 1 (2 ) . Also, the peak magnitude response occurs essen-
tially at  = n if damping is small, as discussed next.

* Small viscous damping, small- approximation If damping is so small that 1 - 2 2

 1, then we can use the following accurate approximations of the values associated with
response at resonance, from Eqs. (10-11) and (10-12):

     r = n 1 - 2 2  n  (10-13)
X r = 1  X (n ) = 1    (10-14)
U 2 1 -  2 U 2

The upper limit of viscous damping ratio for which the small- approximation is practi-
cally useful is about  = 0.2, which we can see on Fig. 10-2. At this upper limit, the ap-

proximation is in error on the order of 4%, since 1 - 2(0.2)2 = 0.959 . The small-

resonance amplification factor (10-14) is sometimes called the quality factor, and it is
denoted Q = 1 (2 ) . The "quality" reference is to tuning, especially of a receiving de-

vice such as a radio (Hammond, 1961, pp. 106-114). When you turn the analog tuning
dial of an old radio, you are varying the value of capacitance in an LRC electrical tuning
circuit in order to produce resonance with the electromagnetic carrier signal, which gives

   10-6
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

the strongest possible reception. Clearly, a high Q is desirable in the tuning circuit of a
radio. On the other hand, high Q is often undesirable in mechanical systems, because it
can lead to structural failure or other negative consequences. For example, if the system
consisting of a car's tire, suspension spring, and damping strut happens to resonate with
the waves in a washboard dirt road, then the resulting vibration will produce poor ride
quality and might even break car parts.

        Note on the Fig. 10-2 graph of magnitude ratio that the  = 0 curve bounds the
curves for all  > 0 , and that it provides a good approximation for small  at all frequen-
cies except those close to n ; for small damping, therefore, the simple equation (10-3a)
for magnitude ratio will, for some calculations, be sufficiently accurate.

* Phase angles of frequency response Figure 10-2 shows that the more lightly damped a
system is, the closer its response is to being in phase with excitation below the natural
frequency, and out of phase with excitation above the natural frequency. Furthermore,
for excitation at the natural frequency,  = n , response lags excitation by exactly 90°,

regardless of the level of viscous damping; this so-called quadrature phase is an impor-
tant characteristic often used to help determine natural frequencies in vibration testing of
machines and structures.

* 2nd order low-pass filter A moderately damped ( 0.5    1) 2nd order system can

function as a low-pass filter, with natural frequency n being the break (corner) fre-
quency. Compare the magnitude ratio curve for  = 1 2 = 0.707 on Fig. 10-2 with the
magnitude ratio curve for a 1st order low-pass filter, Fig. 4-2. The most significant differ-
ence between the two curves is in their high-frequency asymptotes: the 2nd order magni-
tude ratio rolls off at the rate of two decades for each decade increase of frequency (40
dB/decade rolloff), twice as steeply as the 1st order magnitude ratio. Thus, the 2nd order
filter functions much more effectively than the 1st order filter. However, an important
practical deficiency (in some potential applications) of both types of low-pass filters is
that they impose on the low-passed output large phase lags relative to the input.

10-3 Frequency response of mass-damper-spring systems, and system identification
by sinusoidal vibration testing

         Reviewing the basic 2nd order mechanical system from Fig. 9-1 and Section 9-2,
we have the m-c-k and standard 2nd order ODEs:

m&x& + cx& + kx = f x (t)  &x& + 2 n x& +  n 2 x =  n 2u(t)  (10-15)

with the definitions

n = k ,                c = c  c,         u(t)  1 f x (t)     (10-16)
         m                 2m n 2 mk cc          k

                      10-7
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

So we can use the correspondence U = F k to adapt FRF (10-10) directly for m-c-k sys-
tems:

X () = 1 , () = tan -1 2   - 2 ,                                                 (10-17)
F k (1 -  2 )2 + (2 )2              1-  
                                            km

         In the conceptually simplest form of forced-vibration testing of a 2nd order, linear
mechanical system, a force-generating shaker (an electromagnetic or hydraulic transla-
tional motor) imposes upon the system's mass a sinusoidally varying force at cyclic fre-
quency f , f x (t) = F cos(2 f t) . The resulting steady-state sinusoidal translation of the
mass is x(t) = X cos(2 f t + ) . Calibrated sensors detect f x (t) and x(t), and then F, X,
f and  are measured from the electrical signals of the sensors. In principle, the testing
involves a stepped-sine sweep: measurements are made first at a lower-bound frequency
in a steady-state dwell, then the frequency is stepped upward by some small increment
and steady-state measurements are made again; this frequency stepping is repeated again
and again until the desired frequency band has been covered and smooth plots of X F

and  versus frequency f can be drawn.

         For system identification (ID) of 2nd order, linear mechanical systems, it is com-

mon to write the frequency-response magnitude ratio of Eq. (10-17) in the form of a di-
mensional magnitude of dynamic flexibility:1

X () = 1 1 = 1                                                                   (10-18)

 F k (1 -  2 )2 + (2 )2 (k - m 2 )2 + c2 2

Also, in terms of the basic m-c-k parameters, the phase angle of Eq. (10-17) is

                        -1 - c 
 () = tan                           2                                            (10-19)
                         k - m 

Note that if   0, dynamic flexibility (10-18) reduces just to the static flexibility (the
inverse of the stiffness constant), X (0) F = 1 k , which makes sense physically. In fact,

the first step in the system ID process is to determine the stiffness constant. Electromag-
netic shakers are not very effective as static loading machines, so a static test independent
of the vibration testing might be required. In principle, static force F imposed on the
mass by a loading machine causes the mass to translate an amount X(0), and the stiffness
constant is computed from

                        k= F                                                     (10-20)
                             X (0)

1 However, see homework Problem 10.16 for the practical reasons why it might often be better to measure
dynamic stiffness, Eq. (10-31), rather than dynamic flexibility.

                                                   10-8
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

However, suppose that it is more convenient to shake the mass at a relatively low fre-
quency (that is compatible with the shaker's capabilities) than to conduct an independent
static test. Note from Fig. 10-2 that if the excitation frequency is less than about 25% of
natural frequency n , then the magnitude of dynamic flexibility is essentially the same as
the static flexibility, so a good approximation to the stiffness constant is

k  X (  0.25n ) -1                                                             (10-21)

         F       

Even if it is possible to generate frequency response data at frequencies only as low as
60-70% of n, one can still knowledgeably extrapolate the dynamic flexibility curve
down to very low frequency and apply Eq. (10-21) to obtain an estimate of k that is
probably sufficiently accurate for most engineering purposes.

         Assuming that all necessary experimental data have been collected, and assuming
that the system can be modeled reasonably as an LTI, SISO, m-c-k system with viscous
damping, then the steps of the subsequent system ID calculation algorithm are:

1. Calculate k from Eq. (10-20) and/or Eq. (10-21), preferably both, in order to check
that both static and dynamic testing lead to the same result.

2. Determine natural frequency n from the frequency response curves. The frequency
at which the phase angle is -90° is the natural frequency, regardless of the level of
damping. Also, if viscous damping ratio  is small, less than about 0.2, then the fre-
quency at which the dynamic flexibility peaks is essentially the natural frequency. With
n and k known, calculate the mass: m = k  n 2 .

3. Measure the resonance (peak) dynamic flexibility, X r F . Then the maximum dy-
namic amplification equation (10-12) gives the following equation from which any vis-
cous damping ratio   1 2 can be calculated:

Xr  Xr        1
= k  =                                                                         (10-22)
F k  F  2 1 -  2

The calculation is simplified considerably if  is small, less than about 0.2:

1  Xr                                -1

              1   X r 
 k     k                                                                       (10-23)
2  F          2   F                                                            (10-24)

Finally, the viscous damping constant is calculated from Eq. (10-16):

c = cc ×  = 2 mk = 2 mn

        10-9
       Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10-4 Frequency-response function of an RC band-pass filter

         We re-visit once again Section 5-4 and the example of Section 9-10, where it is
demonstrated that a typical RC band-pass filter, as depicted below, is an overdamped 2nd

                                                   order system with right-hand-side

       RL - CH                                     dynamics. Our goal now is to de-
                   em(t) + em(t)
                                                   rive the FRF of this filter circuit.
                                                   Rather than analyze 2nd order ODE

ei(t)         CL                  RH eo(t) (9-47) directly, it is instructive to
                                               start with the coupled 1st order

       iL(t)      iH(t)                            ODEs of the two stages: Eq. (5-

                                                   16),  L e&m + em = ei , with  L =

Figure 5-10 RC band-pass filter (repeated)         RLCL , for the upstream, low-pass
                                                   filter; and Eq. (5-17),  H e&o + eo =

 H e&m , with  H = RH CH , for the downstream, high-pass filter. In this approach, we rep-

resent a system (the band-pass filter, in this case) as an assemblage of stages or lower-

order sub-systems (the low-pass and high-pass filters, in this case). This section is a pre-

view of the more general discussion beginning in Chapter 13.

         Taking the Laplace transform of the ODE for the low-pass stage, with the as-
sumption that all ICs are zero, gives

       ( L s + 1)L[em ] ICs=0 = L[ei ]  L[em ] ICs=0 = 1 L[ei ]    (10-25)

                                                           L s +1

Next, we take the Laplace transform of the ODE for the high-pass stage, still with the as-
sumption that all ICs are zero, and then substitute Eq. (10-25) into the result:

       ( H s + 1)L[eo ] ICs=0 =  H s L[em ] ICs=0

                                                                   (10-26)

        L[eo ] ICs=0 =  H s L[em ] ICs=0 =  H s × 1 L[ei ]
                  H s +1                           H s +1 L s +1

So the transfer function of the entire RC band-pass filter circuit, clearly displaying right-
hand-side dynamics, is

                  TF (s)  L[eo ] ICs=0 =           H s             (10-27)

                  L[ei ] ( H s + 1)( L s + 1)

Finally, the system complex frequency-response function is

                                  10-10
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

FRF () = TF ( j) =    j H                 (10-28)

                    ( j H + 1)( j L + 1)

See homework Problem 10.11 for a numerical evaluation of this frequency response that
demonstrates the practical function for which a band-pass filter is designed.

10-5 Common frequency-response functions for electrical and mechanical-struc-
tural systems

         The term frequency-response function (FRF) is general, meaning physically the
magnitude and phase in steady-state sinusoidal variation with time of some subject vari-
able, relative to the magnitude and phase of some other reference variable. Often, but not
always, the subject variable is clearly a physical response (output), and the reference
variable is clearly a physical excitation (input). During over a century of development,
engineers have found uses for many different types of FRF subject and reference vari-
ables, and names for these types are widely recognized. Many of the most common of
these FRF definitions, their names, and examples are presented in this section.

         Diagrams such as Fig. 4-1 and Figs. 10-1 and 10-2 display FRFs graphically, and
there are many different forms of these diagrams. One of the most well-known and use-
ful forms is the Bode diagram, on which relative magnitude and phase are plotted sepa-
rately against the sinusoidal frequency, which is on a logarithmic scale (as on Fig. 10-2).
Relative magnitude is usually plotted on the decibel scale [dB = 20 × log10(relative
magnitude)], and relative phase is usually expressed in degrees. Another useful graphical
format for FRFs is the Nyquist diagram or plot (after Harry Nyquist, Swedish-born
American electrical engineer and physicist, 1889-1976), which is described at length in
Section 17-2. Application of Bode diagrams and Nyquist diagrams to analysis of control
systems is discussed in Chapter 17.

         The use of FRFs apparently began during the 1880s with the definitions of admit-
tance and impedance in the context of electrical engineering. Electrical admittance is
traditionally assigned the symbol Y(). With e(t) being a specified voltage difference
and i(t) being a specified current, admittance is defined by the equation

 L[i(t)] 
Y () =                                    (10-29)
 L[e (t)]s= j

Keep in mind that the Laplace transforms in Eq. (10-29) and all other definitions of FRFs
are for zero initial conditions. Electrical impedance is traditionally assigned the symbol
Z(), and it is defined to be the inverse of admittance: Z() = 1 Y () . In general,

admittance is the degree to which an electrical system admits (or permits, if you prefer)
the flow of current, and impedance is the degree to which the system impedes the flow of
current. The simplest examples of electrical admittance and impedance are for an ideal
linear resistor of resistance R, with voltage difference e(t) across the resistor and current

10-11
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

i(t) flowing through it. Ohm's law, Eq. (5-1), is e(t) = R × i(t) , so Y() = 1 R and Z()
= R, the same for all frequencies.2

         The electrical FRFs for an ideal linear capacitor with capacitance C are more
complicated. The relationship between voltage difference e(t) across a capacitor and
current i(t) flowing through it is Eq. (5-3): i(t) = C × d [e (t)] dt . Taking the Laplace
transform of this equation gives L[i(t)] = C × sL[e (t)], so, from Eq. (10-29), a capa-
citor's admittance is Y() = jC, and its impedance is Z() =1 ( jC) = - j ×1 (C) .
The magnitude of this impedance is called capacitive reactance (Hammond, 1961, pp.
97-100), and is usually written as X C = 1 (C) = 1 (2 f C) . Physically, for a given
magnitude of voltage difference and a given capacitance C, the magnitude of current
permitted by a capacitor is directly proportional to frequency  or f, and the current leads
the voltage difference by 90°.

         The relationship between voltage difference e(t) across an ideal linear inductor
and current i(t) flowing through it is Eq. (5-6): e(t) = L × d i(t) dt (denoting inductance
 L in this paragraph only, to distinguish it from Laplace transform operator L). You can
show easily that the associated admittance and impedance are, respectively, Y() = 1 /
(jL ) = -j × 1 / (L ) and Z() = jL . The magnitude of this impedance is called
inductive reactance, and is usually written as XL = L = 2 fL . Physically, for a given
magnitude of voltage difference and a given inductance L , the magnitude of current
permitted by an inductor is inversely proportional to frequency  or f, and the current
lags the voltage difference by 90°.

         The subject and reference variables of FRFs commonly used for mechanical and
structural systems are, of course, different than those used for electrical systems. During
much of the 20th century, conflicting and ambiguous names for these FRFs appeared in
the engineering literature, but the names in English have been more uniformly standard-
ized in recent years, as described by Ewins, 1984, pp. 26-27, and by Maia and Silva,
1997, pp. 38-39. In the following, we will derive theoretical FRF equations for an m-c-k
system; however, in engineering practice, these FRF definitions are also applied both
theoretically and experimentally for much more general and more complicated mech-
anical and structural systems.

         For mechanical admittance, the subject variable is a physical displacement (trans-
lation or rotation) at some point and in some direction on the mechanical or structural
system, and the reference variable is a physical action (force or moment) imposed at
some point and in some direction onto the system (Bisplinghoff et al., 1955, pp. 663-
665). Thus, for an m-c-k system, from Laplace transformation of the ODE m&x& + cx& +
k x = f x (t) , and with use of notation defined in Eqs. (10-8) and (10-16), the equation for
complex mechanical admittance is

2 Clearly, the SI unit for impedance is the ohm (), that of resistance; apparently since admittance is the
inverse of impedance, the SI unit for admittance was given the whimsical name mho (-1).

                                                  10-12
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

 L[x(t)]             1      1         1            
    =                       =                        (10-30)
 L[ f x (t)]s= j (k -  m) + jc k (1 -  ) + j2 22

The magnitude ratio and phase angle associated with Eq. (10-30) were written earlier in
Eqs. (10-18) and (10-19). Some synonyms in English for mechanical admittance are
dynamic flexibility, dynamic compliance, and receptance.

         The inverse of mechanical admittance is known as dynamic stiffness (occasionally
also mechanical impedance, but this name usually denotes a different FRF, as described
below); thus, the dynamic stiffness of an m-c-k system is

   L[ f x (t)] = (k -  m) + jc = k[(1 -  ) + j2 ]22  (10-31)
  
   L[x (t)] s= j

The definition of Eq. (10-31), with the Laplace transform of action in the numerator and
that of displacement in the denominator, might seem unorthodox, since an action (force
or moment) is usually the physical input and a displacement is usually the physical
output. However, this type of FRF is useful in practice for experimental measurements,
as is described in homework Problem 10.16. Dynamic stiffness is also the basis of an
advanced method for analyzing theoretically the dynamics of distributed-parameter struc-
tures (Clough and Penzien, 1975, Chapter 20; Fergusson and Pilkey, 1991).

         For mechanical and structural systems, the first and second time derivatives of
displacement are also of interest, primarily because velocity sensors and, especially, ac-
celerometers are often used to measure motion. Accordingly, appropriate FRFs have
been defined. For mobility, the subject variable is a velocity, and the reference variable is
an action. Since L[x&(t)] = s × L[x(t)], the mobility of an m-c-k system, from Eq. (10-30),
is

 L[x&(t)]            j      1  j2 
          =                 =                        (10-32)
 L[ f x (t)]s= j (k -  m) + jc c (1 -  ) + j2 22

The inverse of mobility is usually given the name mechanical impedance. Accordingly,
the mechanical impedance of an m-c-k system is

   L[ f x (t)]    (k -  2m) + jc  1 -  2 
              =             = c1 - j                 (10-33)
   L[x&(t)] s= j        j        2 

For accelerance (also known as inertance), the subject variable is an acceleration, and the
reference variable is an action. Since L[&x&(t)] = s2 × L[x(t)], the accelerance of an m-c-k

system, from Eq. (10-30), is

                     10-13
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

 L[&x&(t)]       ( j)2     1  -2                 
           =               =                       (10-34)
 L[ f x (t)]s= j (k -  m) + jc m (1 -  ) + j2 22

It is worth noting that for static loading ( = 0), mechanical admittance equals a nonzero
static flexibility, but both mobility and accelerance are zero. The inverse of accelerance
is called apparent mass, as motivated by the following expression for an m-c-k system:

 L[ f x (t)]     (k -  2m) + jc  1  2 
           =               = m 1 - 2  - j          (10-35)
 L[&x&(t)] s= j  ( j)  2       

         All of the mechanical and structural FRFs described in this section have dimen-
sional units. For example, common units of accelerance used in the dynamic testing of
structures are G's or meters/sec2 (of acceleration) per pound or newton (of force).

10-6 Beating response of 2nd order systems to suddenly applied sinusoidal excitation

         Thus far in Chapter 10, we have considered only the pure frequency response of
2nd order systems, i.e., the steady-state sinusoidal response to sinusoidal excitation. In

frequency-response analysis based upon Eq. (4-41), initial conditions are ignored, as is

any non-steady-sinusoidal start-up portion of the excitation; in other words, both pure

sinusoidal excitation and response are idealized to start at some indefinite time in the

past. But any real excitation must start at some definite time, at which time any real dy-

namic system has some initial conditions. After the initiation of sinusoidal excitation,

there will be a transitional interval of response between the initial conditions and, pro-

vided the system is stable, the achievement of steady-state sinusoidal response. Section
4-2 illustrates such a transitional interval for a stable 1st order system, which does not ex-

hibit natural oscillatory behavior. In this section, we consider a form of transitional re-

sponse, beating, that is often observed in lightly damped vibrating systems, the simplest
forms of which are underdamped 2nd order systems.

         The basic character of beating response to sinusoidal excitation is best illustrated
theoretically by the idealized undamped 2nd order system. Consider again the standard
ODE for undamped 2nd order systems, Eq. (10-1). Suppose now that u(t) = 0 for t < 0,

and let's define the suddenly applied sinusoidal (SAS) excitation as u(t) = U sin t for t 

0. (We use sin t here rather than the customary cos t because it is more natural, espe-

cially for mechanical systems, that the excitation begins continuously from zero at t = 0,

rather than with a discontinuity.) Thus, the ODE Eq. (10-1) becomes

  &x& + n 2 x = n 2u(t) = n 2U sin t , for t  0    (10-36)

For simplicity, we let the initial conditions be zero: x&(0) = 0 and x(0) = 0 . The com-
plete algebraic solution of ODE (10-36) with these rest ICs is found in homework Prob-
lem 1.12 by the method of undetermined coefficients:

                    10-14
       Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

                x(t) = 2 U [sin t - ( n ) sin nt], valid for   n , t  0                                      (10-37)

                       1 - ( n )

Equation (10-37) is valid only if the excitation frequency is different than the natural fre-
quency,   n; however, this is not a serious practical restriction, because it is almost
impossible in reality to excite a system exactly at its natural frequency. [But see home-
work Problem 1.12(d) for the theoretical solution valid if  = n.]

         It is appropriate to write the response solution Eq. (10-37) in a slightly different
algebraic form:

                      x(t) = 2 U [sin t - sin nt + (1 -  n ) sin nt]                                         (10-38)

                             1 - ( n )

This form of x(t) allows us to invoke a useful trigonometric identity:

                         sin t     -  sin n   t  =  2 cos  1  (t  +  nt)   ×  sin  1  (t  -  nt)             (10-39)
                                                           2                       2

Now we can express the solution (10-38) in an equation that more clearly displays the
characteristics of beating:

           x(t) =        U            [2 cos  1  (  + n )t × sin     1  (  - n )t     +  (1 -   n ) sin nt]  (10-40)
                                              2                      2
                   1 - ( n )       2

For computation, with definitions of driving frequency ratio    / n and natural period
Tn  2 / n , we express Eq. (10-40) in the dimensionless form:

       x(t) 1                                    t                         t                     t 
           = 2 2 cos( +1)  × sin( -1)  + (1 -  ) sin 2                                                       (10-41)
       U 1-                                      Tn                        Tn                    Tn 

         Let's use numerical evaluation and graphical display to help us examine the parts
of Eqs. (10-40) and (10-41); Figure 10-3 on the next page includes plots of both suddenly
applied sinusoidal excitation and the associated response calculated from Eq. (10-41),
with the excitation frequency set at 90% of the natural frequency,  = 0.9n or  = 0.9.

       With use of Fig. 10-3, we can identify the roles of the terms within square brac-

kets of Eqs. (10-40) and (10-41) for any case in which the excitation frequency  is

somewhat close to the system natural frequency n. The dominant (in magnitude) term

that  closely   resembles       the   excitation    is  2 cos  1  (     + n )t  ,  a  sinusoid  whose  frequency  is
                                                               2

the average of the excitation and natural frequencies. But this dominant term is multi-

plied  by  sin  1  (  -  n  )t  ,  which  is  a  slowly    varying      amplitude     modulator   whose  frequency
                2

is half the difference between the excitation and natural frequencies. For the case of Fig.

                                                           10-15
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10-3 with  n  = 0.9, we have       1  (  -  n  )  = 0.05n .  Therefore, the full period of the
                                   2

amplitude-modulating term is 2 0.05n = 20Tn ; from Fig. 10-3, this period is the total

interval between time t = 0 sec and the second subsequent minimum of the amplitude-

modulating envelope. Furthermore, the beating terms are minimal in amplitude at every

half-period of the amplitude-modulating term, in this case 0, 10Tn , 20Tn , ..., and the

beating terms are maximal in amplitude at instants between the half-period instants, in

this case 5Tn , 15Tn , 25Tn , ...

Figure 10-3 Upper graph: suddenly applied (at t = 0) sinusoidal (SAS) excitation
with frequency  = 0.9n; lower graph: response from zero initial conditions of a
standard undamped 2nd order system having natural frequency n.

         The apparent period of beating is the interval between successive minima or suc-
cessive maxima of response, 10Tn in the case of Fig. 10.3, which is half the period of the
amplitude-modulating term. Therefore, the apparent frequency of beating is  - n ,
which is twice the frequency of the amplitude-modulating term. Similarly, when we hear
two musical tones of close but not identical pitches (frequencies), the frequency of beat-
ing that we perceive is the difference between the two tonal frequencies.

        Let's consider now the remaining term, (1 -  n ) sin nt , within the brackets of
Eqs. (10-40) and (10-41). Pure undamped beating, in general, is the combination of two

                                                  10-16
   Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

sinusoids that have different but closely spaced frequencies, as the two sinusoids pass
into and out of phase with each other. The beating of the undamped 2nd order system
shown on Fig. 10-3 is the combination of two sinusoids in the term sin t - sin n t of

Eq. (10-38). These two sinusoids represent (1) the driven response of the system at the
excitation frequency , and (2) most of the free-vibration response of the system at its
natural frequency n . When these two sinusoids are in phase, they combine and, to-
gether with the smaller contribution of the term (1 -  n ) sin nt , form the maximal re-

sponse; when they are out of phase, they nullify each other completely, leaving only the
small remaining part of the free-vibration response due to the term (1 -  n ) sin nt .

         Thus far, we have examined response to suddenly applied sinusoidal excitation of
a physically unrealistic undamped 2nd order system. Let's consider next the influence of

more realistic subcritical damping by solving for complete time response of an under-

damped 2nd order system the ODE &x& + 2n x& + n 2 x = n 2u(t) with u(t) = 0 for t < 0 and
u(t) = U sin t for t  0, and with rest ICs x(0) = 0 and x&(0) = 0 . An appropriate
convolution-integral solution is Eq. (9-20a):

   n -n 2  =t                      n -n 2  =t
   x(t) =  e sin d × u(t - ) d =  e sin d ×U sin (t - ) d
   d  =0                           d  =0

The damped frequency is d  n 1 -  2 , so we can express the response integral in
dimensionless form as

         x(t) =   n -n  =t         1 -  2 × sin (t - ) d                      (10-42)
         U
                        e sin n

                           2

                 1 -   =0

After evaluation of the formidable integral in Eq. (10-42), the solution is3

   -nt            (1 -  2 - 2 2 )              2
   e  2 cosd t -                   sin d t + (1 -  ) sin t - 2 cost
x(t) =            1- 2             
                                                                              (10-43)
                        22           2
U                 (1 -  ) + (2 )

         The equation for response of an undamped 2nd order system that is most similar in
algebraic form to Eq. (10-43) is Eq. (10-37), and you can easily show that for  = 0 Eq.
(10-43) reduces to Eq. (10-37). However, unlike Eq. (10-37), Eq. (10-43) apparently
cannot be reconfigured into a form comparable to Eq. (10-40) that is amenable to physi-
cal interpretation relative to beating behavior. To learn the physical character of Eq. (10-
43), it seems that the best we can do is to evaluate it computationally with relevant nu-
merical parameters and then interpret the results. For computation of Eq. (10-43), with

3 The author derived Eq. (10-43) first with MATLAB by applying the syms, int, simple, and pretty
symbolic operations, and then by implementing the human touch with pencil and paper to simplify further
the MATLAB result. See homework Problems 1.6 and 1.9.

                        10-17
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

definitions of driving frequency ratio    / n and natural period Tn  2 / n , we can
express the time-dependent function arguments of Eq. (10-43) in the following forms in
terms of dimensionless time t / Tn : - nt = -2 (t / Tn ) , d t = 2 1 -  2 (t / Tn ) , and
t = 2 (t / Tn ) . Figure 10-4 includes plots of SAS response calculated from Eq. (10-
43) for zero damping and for light viscous damping ratios  = 0.01 and 0.02, with the
excitation frequency set at 90% of the natural frequency,  = 0.9n or  = 0.9, the same
as for Fig. 10-3.

Figure 10-4 Calculations of Eq. (10-43) for a standard 2nd order system having
undamped natural frequency n , with zero damping (top) and two positive values of
viscous damping ratio,  = 0.01 and 0.02; response from rest initial conditions to a
suddenly applied (at t = 0) sinusoidal (SAS) excitation with frequency  = 0.9n.

         The response in Fig. 10-4 for  = 0 is, of course, the same as that in Fig. 10-3,
with very significant beating. However, the responses for  = 0.01 and 0.02 show that
even these relatively small quantities of damping suppress the beating, at least for this
case of  = 0.9n . Although less obvious than for zero damping, the apparent period of
beating for  = 0.01, ~10Tn , is still quite evident. However, for  = 0.02, the response in
Fig. 10-4 after 25 natural periods has almost settled into its steady-state condition, for
which you can calculate from Eq. (10-10) that the steady-state frequency-response
magnitude ratio is X / U = 5.171. To investigate the nature of beating for any other case of
damping ratio  > 0 and excitation frequency ratio    / n , we would need again to
evaluate Eq. (10-43) numerically; see, for example, homework Problem 10.17.

                                                  10-18
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10-7 Homework problems for Chapter 10

Problems 10.1-10.4 are frequency response problems (inspired by Myklestad, 1944)
about standard 2nd order mass-damper-spring systems. In each case, the mass is excited
by sinusoidal force f x (t) = F cost , and it responds with steady-state sinusoidal
displacement x(t) = X cos(t + ) , where excitation frequency in Hz is f = /2. Some
partial answers are given to help you see if you are on the right track; you still must
calculate these values as if the answers were not given. To derive maximum benefit from
these problems, use the appropriate equations for calculations, but also figure out how the
results are represented in the FRF magnitude and phase graphs, Figs. 10-1 and 10-2. Be
sure to use the appropriate value for g, either 386.1 inch/sec2 or 9.807 m/sec2.

10.1 (Myklestad, 1944, p. 61) Suppose that damping is negligibly small. The measured
weight of the mass is W = 19.0 lb, and the spring stiffness is k = 13.0 lb/inch. With F =
5.00 lb at a certain frequency of excitation, the response amplitude is X = 0.750 inch.
Calculate the dimensionless dynamic amplification X (F / k) . There are two different
excitation frequencies, f1 < f2 , that can produce this particular dynamic amplification;
calculate both frequencies (in Hz), and the response phase  (in degrees) at both fre-
quencies. (partial answers: 1 = 0°, f2 = 3.18 Hz)

10.2 Suppose that damping is negligibly small. The measured weight of the mass is W =
8.50 kgf , and the spring stiffness is k = 2.50 kN/m. With F = 5.00 N at a certain frequen-
cy of excitation, the response amplitude is X = 20.0 mm. Calculate the dimensionless
dynamic amplification X (F / k) . There are two different excitation frequencies, f1 < f2 ,
that can produce this particular dynamic amplification; calculate both frequencies (in Hz),
and the response phase  (in degrees) at both frequencies. (partial answer: f2 = 2.86 Hz)

10.3 The mass weighs W = 1.26 kN, and the viscous damping and spring constants are,
respectively, c = 2,400 N-sec/m and k = 1.12 MN/m. Calculate the undamped natural
frequency fn in Hz and the viscous damping ratio  . Suppose that the response amplitude
is X = 2.50 mm when the phase  = -90.0°; calculate the corresponding amplitude F of
the excitation force. (partial answer: F = 560 N)

10.4 (Myklestad, 1944, p. 113) The mass weighs W = 2.36 lb, and the spring and
viscous damping constants are, respectively, k = 37.8 lb/inch, and c = 0.0169 lb-sec/inch.
The force amplitude is F = 0.785 lb. Calculate the critical damping constant cc , the
damping ratio  , the maximum possible amplitude of response Xr , and the amplitude X
and phase  (in degrees) for excitation at 13.0 Hz. (Note: to calculate  correctly, you
must account carefully for the quadrant of the fraction in the arctangent argument; if you
just calculate the fraction and use the arctan function on your calculator, you will get the
wrong answer; if you need some help, see the atan2 command in MATLAB). Is the
small- approximation appropriate for this system? (partial answers: Xr = 0.591 inch, 
= -155°)

                                                  10-19
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10.5 A frequency response measurement is conducted on a standard 2nd order m-c-k sys-
tem with known stiffness constant k, so that the input pseudo-static displacement is cal-
culated from the measured input force, u(t) = fx(t)/k . A measured graph of the input and
output displacements at one particular excitation frequency is shown below. Calculate
from the graph, with as much accuracy as the data permits, the following quantities: the
frequency (in Hz); the FRF magnitude ratio X/U; the FRF phase  (in degrees). What are
the natural frequency fn (in Hz) and the damping ratio  of this system?

10.6 The mechanical system of homework Problem 9.1 [with fx(t) = 0] has base

excitation input xi(t) and output x(t). The ODE of           x(t)      xi(t)
motion is m&x& + (c1 + c2 )x& + kx = c1x&i + kxi , which
                                                                   k
includes right-hand-side (RHS) dynamics, where m

is the mass, c1 and c2 are viscous damping con-           m

stants, and k is the stiffness constant. c2

(a) Derive for this system the transfer function                   c1

TF (s) = L[x(t)] ICs=0 L[xi (t)] .

(b) Use the fundamental result TF ( j) = FRF () = [ X () X i ]e j() and the result

from part (a) to derive the relatively simple algebraic equation for real magnitude ratio
X () X i . This equation should be in terms of physical parameters m, c1 , c2 , and k, and
excitation frequency . [NOTE: You should implement complex division by the polar
method described on pages 2-3 and 2-4; do not use the rectangular method, because it
will produce an awful algebraic mess!] If you wish, you may derive the associated
relatively simple algebraic/trigonometric equation for the real phase angle  () (in

radians), but that is not required.

(c) Let the system constants be m = 128.5 kg, c1 = 1,600 N-sec/m, c2 = 800 N-sec/m, and
k = 1.12 MN/m. Calculate and plot the frequency response (magnitude ratio X/Xi, and
phase  in degrees) over the range of excitation frequencies 0-30 Hz. Use the over-under
graphical format of Fig. 10-2, except plot both graphs on linear (not log) scales. As in the

                                    10-20
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

script that produced Fig. 10-2, let MATLAB do most of the work for you by starting with
the complex frequency response function FRF() from part (b), then using MATLAB's
capability for performing complex arithmetic with the abs and angle functions. If you
need some help with the array multiplications required for this FRF, see the "frf=..."
command lines in the script that produced Fig. 10-2. Submit your MATLAB script along
with your FRF graphs.

10.7 The drawing represents a very simplified model of a land vehicle driving over a

wavy (washboard) road with constant                        y(t)
forward velocity V. The vehicle mass is                                   m
m, and it is connected to the rolling

wheel through the shock strut that has

viscous damping constant c and stiffness                      k              c        V
constant k. The deviation of the road
surface from flatness is denoted as                        x
ys (x) = Ys cos(2 x ) , in which x is

horizontal distance traveled from a Ys 
reference position, Ys is the amplitude

(wave height at the crests), and  is the wave length. We make the following
assumptions for this model: the wheel itself is rigid, it rolls without slipping, and it

maintains contact with the road at all times due to the weight of mass m; also, wave

height Ys is small relative to wheel radius, so that, in effect, the contact point is always

directly beneath the wheel axle, which means that ys plays the role of base excitation,

and essentially is a function of time: ys (x) = Ys cost .

(a) Assume for the moment that ys (t) is arbitrary base excitation. Draw a dynamic free-
body diagram of mass m, and derive from your DFBD the ODE of vertical dynamic
motion y(t) , measured relative to the static equilibrium position for a flat road surface.

First, write the ODE in terms of constants m, c, and k; second, use the standard
definitions from Eqs. (7-3) and (9-4) to write the ODE in terms of natural frequency n
and viscous damping ratio  .

(b) Use the second ODE of part (a) to derive the complex frequency response function

for arbitrary input ys (t) and output y(t) as FRF () =     1 + j2             Y () e j() , in

                                                                2
                                                           (1 -  ) + j2 Ys

which    n . Even though this system has right-hand-side dynamics that influence

response, let's consider the condition  = n . Derive equations for FRF magnitude ratio

Y (n ) Ys and phase (n ) , in terms of . (NOTE: To obtain the most manageable

algebra, implement complex division by the polar method described on pages 2-3 and 2-

4, not by the rectangular method.) If  is small, e.g.,  = 0.05, how close are your values

of Y (n ) Ys and (n ) to the values at  = n that would prevail if there were no right-

hand-side dynamics?

                                          10-21
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

(c) For the washboard road surface, we use the kinematic relation x = V t to express the
base excitation as a sinusoidal function: ys (t) = Ys cos(2 V t )  Ys cos t , in which
  2V  . Write the algebraic equation, in terms of m, k, and  , for the velocity Vn at
which base excitation frequency equals the undamped natural frequency,  = n .
10.8 A particular device is known to be an LTI mass-damper-spring system. You (the
engineer) are required to identify experimentally the mass m, the viscous damping con-
stant c, and the stiffness constant k. First, you apply a static force of 162 lb, and you ob-
serve that the mass deflects statically by 0.108 inch. Next, you run a stepped-sine fre-
quency-response test, applying sinusoidal force onto the mass, with the frequency in-
creasing in small increments from 8 to 20 Hz. You measure at each frequency the
steady-state input force magnitude F (in lbs), the output translation magnitude X (in
inches) and the phase of translation relative to force. The frequency response is plotted
below. Use this information to calculate m, c, and k in consistent units and with as much
accuracy as the data permits. Show all calculations.

                                                  10-22
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10.9 A particular device is known to be an LTI mass-damper-spring system, but the mass
m, viscous damping constant c, and stiffness constant k are unknown. It is required that

                                                                       the system parameters be iden-
                                                                       tified experimentally with a
                                                                       combination of static and vi-
                                                                       bration testing. First, a static
                                                                       force of 52.0 N is applied, and
                                                                       the mass is measured to de-
                                                                       flect statically by 1.13 mm.
                                                                       Next, sinusoidal force is ap-
                                                                       plied to the mass by an elec-
                                                                       tromagnetic shaker, with the
                                                                       frequency increased in small
                                                                       increments from 1 to 10 Hz.
                                                                       The steady-state input force
                                                                       magnitude F and output
                                                                       translation magnitude X are
                                                                       measured at each frequency,
                                                                   as is the phase  of translation
                                                                       relative to force. The fre-
                                                                       quency-response translation-
                                                                       to-force magnitude ratio and
                                                                       phase are plotted at left. Use
                                                                       this information to calculate
m, c, and k in consistent SI units and with as much accuracy as the data permits. Show all
calculations.

10.10 You, the engineer, are asked to determine experimentally the electrical constants

(inductance L and resistance RL) of a small coil, based upon the simple model of inductor

and resistor in series, to see if these constants match the design specifications. You elect

to infer these constants from a frequency response test on an LRC circuit driven by a sine-

ei(t) L em RL                  wave voltage generator, with the coil connected in series to

                               a calibrated capacitor with capacitance C = 0.500 F. The
                        eo(t) circuit is shown in the drawing (from the example in

                               Section 9-2), and its ODE in standard 2nd order form is

                        C &e&o + R e&o + 1 eo = 1 ei (t) . You run a stepped-sine
i(t)                    L LC LC

                        frequency-response test, applying sinusoidal input voltage

                        of constant magnitude Ei = 1.00 V, with the frequency in-

creasing in small increments from 100 to 1,000 Hz. You measure at each frequency the

steady-state output voltage magnitude Eo , and the phase  of output voltage relative to

input voltage. The frequency response is plotted on the next page. Use this information

to calculate L and RL in consistent units and with as much accuracy as the data permits.

Show all calculations.

                        10-23
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10.11 Consider the RC band-pass filter described in Section 10-4, for which the fre-

quency response function is FRF () = TF ( j) = j H . The purpose of

                                              ( j H + 1)( j L + 1)

this problem is to demonstrate the practical function for which that filter is designed, by

means of FRF graphs. Let  H = 1 sec and  L = 1 sec to make the high-pass
2 ×10                                                2 × 500

and low-pass break frequencies be, respectively, 10 Hz and 500 Hz. Now, use MATLAB

to calculate and plot the FRF magnitude ratio and phase (in degrees) over the frequency

range 0.1 to 10,000 Hz. Use the graphical format described in homework Problem 4.3

(log-log for magnitude ratio, semilog for phase in degrees, magnitude ratio graph directly

over phase graph). As in Problem 4.3, let MATLAB do most of the work for you by

starting with the complex FRF representation, and then using MATLAB's capability for

performing complex arithmetic. Recall, in particular, that the MATLAB function abs

calculates the absolute value (magnitude) of a complex number, and the MATLAB

function angle calculates the angle in radians of a complex number.

10.12 An idealized mechanical model for motion case

sensors of the seismic type is shown in the figure.                  k     body
Such a sensor is entirely mounted on a moving                               xi(t)
body (is said to be "structure-borne"), unlike, for  m               x(t)

example, the proximity displacement sensor shown

in Figs. 7-6 and 7-10. The mechanical part of the                    c

       10-24
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

sensor is a mass-damper-spring system sealed within a sturdy case, which is attached
firmly to the body whose motion is sensed. The stimulus to the sensor is base excitation:
translation xi(t) of the body and the case. The absolute translation of seismic mass m is
x(t). A transducer within the case detects the relative translation z(t)  x(t) - xi(t) and
generates an electrical signal4 proportional to z(t), which typically is displayed and/or
recorded by a data-acquisition-and-processing system, and may also serve as an input to a
control system.

(a) Sketch and label appropriate free-body diagrams, then use your FBDs to derive an
ODE of motion for z(t) [not x(t)] in terms of constants m, c, and k, and variable input
quantity xi(t) or its derivatives. Convert your ODE into the standard form Eq. (10-4), ex-
cept with z(t) [not x(t)] as the dependent variable: &z& + 2n z& + n 2 z = n 2u(t) . Write an
explicit equation for standard input quantity u(t) in terms of the appropriate constants and
xi(t) or its derivatives.

(b) Evaluate the use of this seismic sensor as a translational accelerometer, a sensor of
the body's acceleration in the direction defined by x(t) and xi(t). First, use the results of
part (a) to show that the pseudo-static response is z ps (t) = -(m k)&x&i (t) . This means that
if the quantity &z& + 2n z& is small (or zero) in comparison with n2 z , then the seismic
sensor acts as an accelerometer, since then z(t) and its corresponding electrical signal are
directly proportional to &x&i (t) .5 This pseudo-static response is reflected clearly in the
FRF graphs of Fig. 10-2: If the frequencies of motion within base excitation xi(t) are
substantially below the natural frequency of the sensor (  /n = 1), then both the
magnitude and phase of response follow closely those of excitation. An accelerometer is
a seismic sensor intended to measure frequencies that are considerably lower than the
sensor's own natural frequency. Suppose you are designing an accelerometer that will
measure with reasonable engineering accuracy body accelerations whose frequencies are
no higher than 25% of the sensor's natural frequency. What is the highest value of
damping ratio  (to three significant digits) that your sensor can have in order that phase
error will be less than 5°, and what is the maximum magnitude error for that  ? Use Fig.
10-2 to find an estimate, then make trial-and-error iterative calculations (preferably with
MATLAB) to determine more precisely the required  and magnitude ratio.

(c) Evaluate the use of this seismic sensor as a translational seismometer, a sensor of the
body's translation xi(t). Now, due to the right-hand-side second derivative &x&i , your first
ODE from part (a) is not in the standard form Eq. (10-4), so it is necessary to derive new
response equations. The appropriate transfer function is defined as TF(s) = L[z(t)] ICs=0 ÷
L[xi (t)] ICs=0 . Derive this TF(s), then use it to derive the corresponding FRF:

4 For most commercially available sensors, the electrical signal passes through wires connected to the
sensor, but some modern sensors send the signal wirelessly. The size of such a sensor ranges typically
from that of an aspirin tablet to that of a large soda bottle.
5 Although the theoretical constant of proportionality is -m/k, the true constant, including polarity, of any
real sensor is always measured by laboratory calibration.

                                                  10-25
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

FRF ()   Z () j ()  2          , with  =  =   , and  = c
             e=
         Xi      (1 -  ) + j22        n                               2mn
                                             km

Suppose that a seismometer has damping ratio  = 0.22, high enough to dampen resonant
response quickly. Plot over the range 0.1    10 the frequency response magnitude
ratio Z()/Xi and, separately, phase angle () in degrees. (If necessary, see for guidance
the description of producing Fig. 10-2 with MATLAB.) From these graphs, and if you
wish from low- and high-frequency asymptotes of Z()/Xi , you should recognize that: A
translational seismometer is a seismic sensor intended to measure frequencies that are
considerably higher than the sensor's own natural frequency. Suppose this seismometer
is intended to measure with reasonable engineering accuracy body translations whose
frequencies are no lower than five (5) times that of the sensor's natural frequency. Cal-
culate the greatest values of sensor error, percent of magnitude ratio and degrees of phase
angle?6 Describe physically the motion of the seismic mass in response to base-motion
frequencies that are considerably higher than the seismometer's natural frequency.

10.13 The drawing at right is the prototypical idealized model        y(t) f (t)

for the subject of vibration isolation. Suppose that mass m in

the drawing houses a reciprocating internal combustion engine         m

with a single vertically oriented piston-cylinder pair, and that      c
                                                                               k/2
the damper-spring-base assembly attaches the mass to the k/2
floor. The engine exerts an oscillatory vertical force f (t) on

mass m, and the mass-damper-spring system transmits force

through the rigid base to the stiff floor, which reacts the trans-       fR(t)

mitted force with oscillatory vertical force fR(t).7 For the

benefit of the floor and its superstructure (building, vehicle, etc.) and for the comfort of

the occupants, it is usually desirable to design the damper-spring support so that fR(t) is as

small as practical, in other words, to isolate the engine from the floor. In practice, the

damper-spring support often is an elastomeric (rubber-like) padding.

(a) Use a dynamic free-body diagram (DFBD), if necessary, to write the ODE of dyna-
mic motion y(t) relative to the static equilibrium position, in terms of excitation force f (t)
and constants m, c, and k. Take the Laplace transform of the ODE (assuming zero ICs) to
obtain an equation for transform L[y(t)]  Y(s), which equation will include as the input
quantity transform L[f (t)]  F(s). Next, write an equation for dynamic reaction force fR(t)
in terms of y(t) and its derivative and the appropriate constants, then take its Laplace
transform to find an equation for transform L[fR (t)]  FR(s). Next, combine the two trans-
form equations appropriately to find the transfer function TF(s) = FR(s)/F(s) relating the
floor-reaction dynamic force to the excitation force. Finally, use the standard definitions

6 For the phase-angle error, regard a 180° phase difference as being equivalent to 0°, because it is simply a

sign difference that is corrected in calibration and/or data processing.
7 The floor's true reaction is distributed force, i.e. stress, acting against the base over the area of contact.

Discrete force fR(t) in the drawing is the equivalent resultant of the distributed force, that is, fR(t) has the
magnitude of the total force distribution and its point of application is the center of the distribution.

                               10-26
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

of n, , and  to show that the corresponding complex frequency-response function,

known as transmissibility, is TF ( j)  FRF ()  FR () e j() = - 2 1 + j2 .8
       F  (1 -  ) + j2

(b) Plot on a single graph the transmissibility magnitude ratio FR()/F for the cases of
zero damping,  = 0, and the relatively high damping ratio  = 0.25; plot these curves on
linear (not logarithmic) scales over the frequency ratios 0    4, and display the mag-
nitude ratio only over the range 0  FR()/F  2.5. (If necessary, see for guidance the
description of producing Fig. 10-2 with MATLAB.) Explain how your graph shows

(don't bother with any theory) that there is effective vibration isolation only if  > 2 .
Suppose that you know mass m and excitation frequency ; what is the range of spring
constant k for which there is effective vibration isolation? Physically, should the springs
be stiff or soft, and how stiff or soft? Does positive damping either increase or decrease
the effectiveness of vibration isolation at all excitation frequencies, or is damping a
mixed blessing, helpful in some range of frequencies, but not so much in others?

10.14 The translational velocity v(t) of a point on an object is sometimes measured with
use of a structure-borne accelerometer (see homework Problem 10.12). An accelerome-
ter is a transducer that senses translational acceleration in one direction, e.g. a(t) = &x&(t) ,
and converts the motion into an electrical voltage signal, ea(t), which can be displayed, or
recorded, or processed, or used in a control system. The transducer's output signal is
nominally ea(t) = Cea a(t) + n(t) +  : Cea is the sensor's calibration factor, with units such
as volts per meter/sec; n(t) is small, randomly varying electrical "noise"; and  is a small,
constant offset voltage. Error voltage n(t) +  is unrelated to the sensed motion; it is an
unwanted but practically unavoidable by-product of a transducer's circuitry. Accelera-
tion is the rate of change of velocity, v&(t) = a(t), so the accelerometer's output signal must
be integrated to produce an electrical signal ev(t) that is proportional to velocity. Thus,
the basic ODE that an exact integrator (in analog circuitry or a digital algorithm) would
solve is e&v (t) = (1 T ) ea(t), where T is a physical constant having dimensions of time
(e.g., T = -RC for the op-amp-circuit integrator of homework Problem 5.6). However, in
practice exact integration of an accelerometer's signal is not desirable due to constant er-

ror , because  ea (t)dt = [Ceaa(t) + n(t) +  ]dt =  Ceaa(t) dt +  n(t) dt +  t. The

term  n(t) dt typically is negligible because random n(t) has average value of zero. On

the other hand, the error term  t is artificial drift that grows with time and distorts the ex-
act integrator's output signal, regardless of how small  is. Therefore, it is necessary to
use approximate integration that is not vulnerable to artificial drift but is still sufficiently
accurate for practical purposes. Perhaps the simplest approximate integrator, which we
name the low-pass approximate integrator, is defined by the 1st order ODE e&v +  ev =

(1 T ) ea(t); the static response to non-zero constant ea is clearly non-zero, ev = ea / (T).

This non-zero static response makes the low-pass approximate integrator unsuitable for

8 This FRF applies for a vibration isolator with viscous damping. However, the internal-friction mathemat-
ical model of structural damping is more realistic than viscous damping. In Appendix B, Section B-5, the
internal-friction model is described and applied for vibration isolation.

10-27
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

applications that require the device's output to have zero offset voltage. To avoid such an
artificial constant static response, we have the band-pass approximate integrator defined
by the 2nd order ODE e&&v +  e&v + 2ev = (1 T )e&a (t) , which has right-hand-side dynamics.

(a) Using the definition of dimensionless excitation frequency    / , derive and show
that the complex frequency-response functions of the exact integrator, the low-pass ap-
proximate integrator, and the band-pass approximate integrator can be written in the
forms, respectively, [T × FRF()]exact = 1 / (j), and [T × FRF()]low-pass = 1 / (1 + j),
and [T × FRF()]band-pass = j / (1 -  2 + j).

(b) Plot on one graph the magnitudes versus  (at least over the range 0.1    10) of
[T × FRF()]exact , and [T × FRF()]low-pass , and [T × FRF()]band-pass . Plot on an-
other graph the phases versus  (over the same range) of these three frequency-response
functions. Your graphs should clearly display features noted earlier such as the static re-
sponses of the low-pass and band-pass approximate integrators, and they should show
that for    /  > 6 both approximate integrators have negligible magnitude error, rela-
tive to the exact integrator, and phase error less than 10°.

10.15 Consider the reaction-mass actuator (RMA) drawn schematically below, which
includes an m-c-k system that is augmented with an internal force generator, fi(t). An
external dynamic voltage signal ei(t) commands the force generator to impose equal and
opposite dynamic forces fi(t) upon reaction mass m and the rigid interface, forces fi(t) that
are proportional to input ei(t). The intended function of the RMA is to "react" against m
in order to impose a dynamic force fa(t) through the connecting rod onto the rigid wall
drawn at left. However, due to the dynamics of the m-c-k system, the actuation force fa(t)
actually transmitted through the connecting rod is different than internal force fi(t).

command signal ei(t)                                                        x(t)

                                           k                  reaction mass
rigid                                                                m

fa(t) connecting rod fa(t)     fi(t)  fi(t)            fi(t)
              rigid interface
                                      force generator

                                      c

                  Reaction-Mass Actuator (RMA) in a calibration setup

Your tasks in this problem are to derive the mathematical relationship between the output
actuation force fa(t) and the input voltage signal ei(t), and then to calculate and plot fre-
quency response that illustrates the character of RMA functioning.

(a) Derive the very simple ODE relating translation x(t) of reaction mass m to the actua-
tion force fa(t) shown acting onto the rigid interface. (The masses of the internal compo-
nents--spring, damper, and force generator--are negligible relative to m.) Then derive
from that ODE the transfer function Fa(s)/ X(s), where Fa(s) and X(s) are the Laplace
transforms, respectively, of fa(t) and x(t).

                               10-28
         Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

(b) The linear relationship between generated internal force fi(t) and input voltage signal
ei(t) is fi(t) = G ei(t), where gain (calibration) constant G has units such as newtons/volt.
Derive the ODE relating the translation x(t) of reaction mass m to the internal force fi(t)
shown acting onto m, and then to input signal ei(t). Then derive from that ODE the trans-
fer function X(s)/ Ei(s), where Ei(s) is the Laplace transform of ei(t).

(c) Multiply the transfer functions of parts (a) and (b) in order to show that the required
transfer function relating the output actuation force fa(t) to the input voltage signal ei(t) is
Fa(s)/ Ei(s) = Gs2/ ( s2 + 2n s + n2), where, as usual, n2 = k/ m and  = c/ (2mn).

(d) During the 1990s, a team of aerospace companies designed a specialized RMA and
fabricated several units of the device for use as vibration-control actuators in experiments
on a test bed that simulated a space-satellite laser-beam-director structure [Dettmer, 1995,
which uses another common name, proof-mass actuator (PMA) for the device].9
Imagine that these RMAs are restored for a new project and that you, as an
instrumentation engineer, are assigned to perform system identification and calibration
tests on one of them. First, you run free-vibration tests with the force generator turned
off, fi(t) = 0. You excite vibration by displacing reaction mass m from x = 0, then
releasing it (twang testing, see homework Problem 9.4). You measure the frequency of
the resulting free vibration of m to be 5.00 Hz, with very light inherent damping that
reduces the amplitude of vibration in half in exactly 9 full cycles [in Eq. (9-28), r1/2 =
9.00]. The RMA has a flange allowing you to bolt a calibrated mass of 3.00 kg firmly to
reaction mass m; so you run a second twang test, from which you measure the frequency
of free vibration of reaction mass plus added mass, m + 3.00 kg, to be 4.23 Hz (see
homework Problem 7.9). Next, you remove the 3.00-kg added mass and turn on the force
actuator. In static testing, you measure a linear relationship between applied voltage ei
and translation x, with maximum voltage ei = +10.0 V moving m the distance x = -6.00
mm (and, conversely, -10.0 V producing +6.00 mm). Use your measured data to infer
values for the components m, c, k, and G of the RMA system (Partial answer: G = 4.47
N/V). Finally, calculate the frequency-response function corresponding to transfer
function Fa(s)/ Ei(s) of part (c), and plot it in the format of Fig. 10-2 [log(magnitude ratio)
vs. log(frequency in Hz), linear(phase in degrees) vs. log(frequency in Hz)] over the
excitation-frequency range 1-100 Hz. These graphs should indicate that the RMA
produces output actuation force fa(t) nicely representative of input voltage signal ei(t) for
frequencies above about twice the RMA's natural frequency, but that fa(t) is not at all
representative of ei(t) for frequencies near and below the RMA's natural frequency.

9 The schematic drawing for this problem shows the connecting rod attached to a rigid wall, which is a con-
figuration suitable for calibrating an RMA; however, in any end-user practical application, the connecting
rod would be attached to a flexible structure. RMAs are applied in practice to impose dynamic forces upon
structures, both to provide excitation for vibration testing, and to suppress unwanted vibration as actuators
in control systems. An RMA can be structure-borne, meaning it can be completely supported by the struc-
ture onto which it imposes dynamic force. For example, large RMAs have been installed in the top floors
of tall buildings in order to reduce bending vibration excited by wind and ground tremors; an RMA in this
civil engineering application is often called an active tuned-mass damper (ATMD). The internal force gen-
erators of ATMDs are hydraulic motors, whereas those of small RMAs (having total weight on or under the
order of 100 lb) are electromagnetic linear motors.

                                                  10-29
   Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

10.16 A distributed-parameter shear-building structural model used in an instructional

laboratory is shown in the drawing and the photograph, and is described in detail in

            x(t)

         m

b     h     fx(t)

   L

Side view Front view
homework Problem 7.10. Measurements by
students give the effective vibrating mass as mE =
0.00473 lb-sec2/inch, and the lateral stiffness due
to the two L = 12-inch aluminum beams as kE =
43.6 lb/inch. The inherent structural and aero-
acoustic damping of the vibrating beams and mass is very, very small, but a sup-
plementary dashpot (near top left in the photo) attached between the mass and ground
increases the total measured effective viscous damping constant to cE = 0.0309 lb-
sec/inch.

(a) Calculate the undamped natural frequency fn in Hz and the damping ratio  . (An-
swers: fn = 15.3 Hz,  = 0.0340)

(b) A small electromagnetic shaker10 is attached to the right-hand side of the mass, and it
produces the time-varying force fx(t) labeled on the drawing. Any real force actuator has
a maximum stroke, the range of motion of the device's moving parts, over which: (i) the
output force fx(t) is proportional to the input electrical command signal, and/or (ii) the
moving parts of the device can deflect without damaging themselves or other parts within
the device. It is important to recognize that the moving parts of the shaker are attached
directly to the structure, so they experience the same deflection as the attachment point
on the structure. Hence, the structural vibration can actually cause the maximum shaker
stroke to be exceeded, especially at or near resonance. Suppose you want to run an
experiment to measure an FRF of the shear-building model, in a stepped-sine sweep of
excitation frequency f in Hz from 0.5 fn to 1.5 fn . The shaker will drive the mass with
sinusoidal force fx(t) = F cos(2 f t), and the mass will respond with steady-state sinusoi-
dal translation x(t) = X cos(2 f t + ). Suppose the shaker in this case has the maximum

10 This device is similar to the driver of a speaker in a sound system. The primary components are a wire
voice coil and a magnetic field structure, within which is a small but strong permanent magnet. The wire
coil is wrapped around and bonded to a spool, which is attached directly to the mass. The coil is embedded
within a magnetic field that acts across an annular gap in the front of the field structure. Electrical current
driven through the coil by a power amplifier interacts with the magnetic field to produce a force onto the
coil and spool that is proportional to the current. The force is transmitted to the mass through the spool.

                                                  10-30
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

stroke of ±0.05 inch and maximum force magnitude Fmax = 2 lb (typical values for a
small commercial off-the-shelf shaker). If you were to run the stepped-sine sweep so as
to measure directly the mechanical admittance (also known as dynamic flexibility) by
holding the force magnitude constant at 80% of its capability, F = 0.8Fmax , what are the
theoretically predicted magnitudes X of structural (and shaker moving parts) translation at
the frequencies 0.5 fn , fn , and 1.5 fn ? (Partial answer: X(fn) = 0.539 inch) Why would
this dynamic-flexibility approach not work in real life?

(c) Suppose you run a stepped-sine sweep, with the same shaker properties as defined in
part (b), in such a way as to measure directly the dynamic stiffness, instead of the dyna-
mic flexibility. For example, imagine that at each discrete excitation frequency in the
sweep you adjust the shaker force magnitude so that the response magnitude equals 80%,
X = 0.04 inch, of the maximum shaker stroke. Calculate the theoretically predicted
magnitudes F of required shaker force at the excitation frequencies f = 0 (the static
condition), 0.5 fn , 1.0 fn , and 1.5 fn . (Partial answer: F(fn) = 0.119 lb) For what (if any)
range of excitation frequencies would this dynamic-stiffness approach work in real life?

(d) Calculate and plot the theoretically predicted dynamic stiffness (magnitude and
phase) of this structural system for excitation frequency over the range 0  f  1.5 fn .

10.17 Evaluate Eq. (10-

43) numerically (using            Rc

MATLAB or your choice                 C                 C             Rd

of software) to calculate         Rb                Rb            Rd

and plot the time response

from rest ICs to a sud-           Ra         em(t)         eo(t)                      ef(t)

denly applied sinusoidal
(SAS) input into the elec- ei(t)

tronic analog computer

circuit at right. The ODE

relating output voltage eo(t) to input voltage ei(t) derived in homework Problem 9.17, is,

                                      1      2          2
                                  1                  1  Rb
in standard 2nd order form, e&&o + e&o +   eo =   ei (t) . The input vol-
                                  RcC  RbC           RbC  Ra

tage is zero for time t < 0 and ei(t) = Ei sin(2 f t) for t  0, in which Ei = 3.20 V and f =

14.2 Hz. The circuit component values are: Ra = Rd = 50.0 k, Rb = 5.00 k, Rc = 500

k, and C = 2.04 F. Calculate and plot both excitation and response over the time in-

terval -0.1  t  2.4 sec, at increments of 0.001 sec (to produce suitable graphical resolu-

tion). This circuit was "patched" (programmed with plug-in wires) on a Comdyna GP-10

analog computer, and the given input voltage was produced by a sine-wave generator;

graphs of the actual measured time-varying input excitation and output response are on

the next page. Do the numerically simulated excitation and response that you calculate

look very similar to the measured excitation and response? (If not, they should!)

Although the circuit is lightly damped, there is still clear beating behavior. Show that the

period and frequency of beating evident in the time-response graph are what you would
expect, based upon Eq. (10-40) for beating of an undamped 2nd order system.

                                      10-31
Chapter 10 2nd order systems: frequency response; beating response to SAS excitation

                                           10-32
       Chapter 11 Mechanical systems with rigid-body plane translation and rotation

Chapter 11 Mechanical systems with rigid-body plane translation and
                                       rotation

                      © 2016 by William L. Hallauer, Jr.

         Up to this point, we have considered mechanical systems with motion consisting
of either translation in only one direction or rotation about one axis, but not both together.
Simple rotational systems have appeared in previous chapters (for example, in Sections
3-3, 3-5, and 7-1), but now we will treat rigid-body plane motion more generally, as
consisting of both translation and rotation, and with the two forms of motion possibly
coupled together by system components and system geometry. The focus in this chapter
is on deriving correctly the equations of motion, which generally are higher-order,
coupled sets of ODEs. Chapter 12 introduces some methods for solving such equations,
leading to fundamental characteristics of an important class of higher-order systems.

11-1 Equations of motion for a rigid body in general plane motion

       Consider a rigid body that is restricted to motion in the xy plane. Figure 11-1

shows the body in its reference static equilibrium position (solid lines) and in a position

of motion (dashed lines) relative to the reference position. The xy axis system shown is

an inertial reference with its origin at point O, which is either motionless or translating at

a constant velocity. We will use vectors and vector operations, so we need to recognize

that the inertial reference system is really the three-dimensional Cartesian xyz axis

system, with the z axis being perpendicular to the xy plane and pointed toward us, in the

sense of the right-hand rule. We denote the fixed unit vectors in the reference Cartesian

directions as 1x, 1y, and 1z. From the background of your previous dynamics and physics

courses, you should be familiar with vectors, vector algebra and calculus, and vector

                                                                kinematics and dyna-

y                                                               mics; if necessary,

                FA                                              you should review

                                                       FB       these concepts in

       MD  D               C                                    your engineering dy-

yC(t)                 rCA         rCB B                         namics textbook.

           MA                                              (t)     Of particular
                   A

       rOA rOC        rOB                                       interest is the position
                                                                and orientation of the

                                                                rigid body's center of

1y                                                              mass C. At any in-

                                                                stant of time t, C has

                                                                relative position coor-

O      1x                  xC(t)                           x dinates [xC(t), yC(t)].
                                                                Thus, the vector posi-

                                                                tion of C relative to

       Figure 11-1 Rigid body in general plane motion           some absolutely fixed

                                  11-1
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

point P is rC (t) = rO (t) + rOC (t) = rO (t) + xC (t)1x + yC (t)1y , where rO (t) is the known

instantaneous position of O relative to P. Similarly, the vector velocity of C relative to
absolutely fixed point P is vC (t) = vO (t) + vOC (t) = vO (t) + x&C (t)1x + y&C (t)1y , where

vO (t) is the constant velocity of O relative to P. Because vO (t) is constant, the absolute
vector acceleration of C is aC (t) = aOC (t) = &x&C (t)1x + &y&C (t)1y . We denote as  (t) the
positive-counterclockwise rotational orientation of mass center C (indeed, of the entire
body, since it is rigid). Position rO (t) of O is known, so if we can determine at any
instant the three motion quantities xC(t), yC(t), and  (t), then we can calculate from sim-
ple geometry the position of any point on the rigid body. These three quantities are
independent in general plane motion, and only these three [plus known rO (t) ] are
required to describe completely the position in space of the rigid body. Therefore, xC(t),
yC(t), and  (t) are called degrees of freedom, and general plane rigid-body motion is
called a three-degrees-of-freedom (3-DOF) problem.

         For generality, we identify three other points fixed to the rigid body, at which
point actions (forces or moments) are applied by sources external to the body. (In gen-
eral, there can be more or fewer points of externally applied actions; analyzing such sit-
uations will require only minor modifications to the present derivation.) Point A is a con-
nection to the external environment, possibly through springs, dampers, etc.; actions
applied at Point A are vector reaction force FA = FAx 1x + FAy 1y and vector reaction
moment MA = MA 1z. It is useful to express the vector position of point A in terms of that
of mass center C: rOA = rOC + rCA (see Fig. 11-1). An arbitrary vector force
FB = FBx 1x + FB y 1y is applied at point B, and that point's vector position is expressed as
rOB = rOC + rCB . Finally, an arbitrary vector moment MD = MD 1z acts at point D.

         We denote as m the mass of the rigid body. Newton's 2nd law for forces, written
in vector form, is

m aC = FA + FB                                                                  (11-1)

Expressing Eq. (11-1) in terms of scalar components gives the two scalar ODEs:

m &x&C = FAx + FB x                                                             (11-2a)

m &y&C = FA y + FB y                                                            (11-2b)

We denote as JC the rotational inertia of the rigid body about an axis normal to the plane
of motion and passing through mass center C. Newton's 2nd law for moments relevant to
this plane-motion case states that the inertial moment about mass center C equals the sum
of all applied moments about mass center C; it is expressed as follows in vector notation,
including vector cross products:

11-2
    Chapter 11 Mechanical systems with rigid-body plane translation and rotation

                  J C && 1z = rCA × FA + rCB × FB + (M A + M D )1z                 (11-3)

Despite the vector notation, Eq. (11-3) is actually a scalar equation, because the vector

cross products obviously produce vectors in the z direction; the use of these cross prod-
ucts just provides economy of notation.1

         We shall see an application of general-plane-motion Eqs. (11-2) and (11-3) to a
specific aeroelastic system in Section 11-3 (Example 11-3); but, first, it is appropriate to
develop in Section 11-2 and to illustrate in Section 11-3 (Examples 11-1 and 11-2) the
special case of pure plane rotational motion about a fixed point.

11-2 Equation of motion for a rigid body in pure plane rotation

    An important special case of general plane motion is pure rotation about a fixed

pivot or hinge, as depicted in Fig. 11-2. To analyze this case, let's suppose that reaction

    y point A of Fig. 11-1 is
                                                                    the hinge point, and let's

    1                FA  FH                      FB           position the xyz origin O
                  1r rOC C rCB                      (t)       at point A. To emphasize
MD  D                                                         the character of this
                                        B                     hinge point, we re-label
MA  MH                                                   x it as H; in other words,
            O  H           rOB                                both points A and O on

Figure 11-2 Rigid body in pure rotation about point O    Fig. 11-1 now become
                                                         hinge point H on Fig. 11-

                                                         2. We can use the

previous equations simply by setting position vector rOA on Fig. 11-1 equal to zero: rOA

= 0 = rOC + rCA  rCA = -rOC  -rHC . It is helpful also to express rCB on Fig. 11-1

in terms of rOC : rCB = rOB - rOC . Using these substitutions in Eq. (11-3) gives

                  J C && 1z = -rOC × FA + (rOB - rOC ) × FB + (M A + M D )1z       (11-4a)

After we replace subscripts O and A with H and re-arrange terms, Eq. (11-4a) becomes

                  J C && 1z + rHC × (FH + FB ) = rHB × FB + (M H + M D )1z         (11-4b)

Next, substituting Eq. (11-1) into Eq. (11-4b) gives                               (11-5a)
                        J C && 1z + rHC × m aC = rHB × FB + (M H + M D )1z

1 For Eqs. (11-2) and (11-3), the reference xyz axis system is inertial, either stationary in space or moving at
a constant translational velocity, and motion of the rigid body is measured relative to this inertial system.
However, for many problems in dynamics, it is preferable to derive equations of motion using a reference
axis system that is fixed in the body and moves with it. A plane-motion problem of this type is the leading-
lagging rotation of a hinged helicopter rotor blade, as analyzed by Bramwell, 1976, pp. 51-52.

                                           11-3
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

Since hinge point H is fixed, let's simplify notation by writing rHC  rC and rHB  rB .
Also, we can express the acceleration as aC  &r&C , so Eq. (11-5a) becomes

J C && 1z + rC × m&r&C = rB × FB + (M H + M D )1z                                 (11-5b)

         We can simplify the &r&C term on the left-hand side of Eq. (11-5b) by using the
kinematics of rigid-body, plane, pure rotation about point H. For this task, it is conven-
ient to work in polar rather than Cartesian coordinates, so we define on Fig. 11-2 the or-

thogonal rotating unit vectors 1r and 1; thus, we can express the position vector to mass
center C as rC = rC 1r , where rC is the constant radius from hinge point H to mass center
C. We express the rotational velocity vector as  = & 1z . (In this context, the vector
symbol  denotes rotational velocity, which is standard in dynamics textbooks, whereas
everywhere else in this book the scalar symbol  denotes frequency of vibration.) There-
fore, the first derivative of the mass-center position vector is

    r&C =  × rC = & 1z × rC 1r = rC& 1                                            (11-6)

To obtain the second derivative, we differentiate product (11-6), recognizing that rC is
constant, but that 1 is rotating:

        &r&C = rC [&& 1 + & 1&  ] = rC [&& 1 + & (& 1z × 1 )] = rC [&& 1 - &2 1r ] (11-7)

With Eq. (11-7), the vector cross product on the left-hand side of Eq. (11-5b) becomes

rC  × &r&C  =  rC  1r  × rC [&& 1  - &2  1r ]=  r 2&& 1  z                        (11-8)
                                                C

With Eq. (11-8), the left-hand side of Eq. (11-5b) becomes                        (11-9)
                        J C && 1z + rC × m&r&C = (J C + m rC 2 )&& 1z  J H && 1z

In Eq. (11-9), we use the parallel-axis theorem to define the rotational inertia of the rigid
body about center of rotation H, J H = J C + mrC 2 . Thus, Eq. (11-5b) becomes

J H && 1z = rB × FB + (M H + M D )1z  (allactiveand reactive momentsabout H )1z (11-10)

         To summarize, for a rigid-body in pure plane rotation about point H, the only de-
gree of freedom is rotation  (t), and the single, relatively simple ODE of motion is

J H && = (allactiveand reactivemomentsabout H )                                   (11-11)

                       11-4
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

in which J H is the rotational inertia of the rigid body about center of rotation H.

         Note that the reaction force at hinge H does not appear in ODE (11-11). In fact,
to find this reaction force, you would have to solve (11-11) for  (t), then find the accel-
eration of C, then substitute the results back into Eqs. (11-1) or (11-2).

11-3 Examples of equations of motion for rigid bodies in plane motion

Example 11-1: damped, spring-supported rigid bar, hinged at point H

         Let's derive the specific ODE of motion for the system of Fig. 11-3, assuming
small angles of rotation. The bar has rotational inertia J H about hinge H, which we as-
sume to have negligible friction. The bar is shown in the reference static equilibrium po-
sition, subject to static gravity but before applied dynamic force F(t) becomes active.
Dynamic degree of freedom  (t) shown with dashed lines is the small rotation relative to
the static equilibrium position. (It is this book's graphical convention for this and all sub-
sequent systems of this type that the rigid body is drawn in its static equilibrium position,
and dynamic motion relative to this reference position is indicated with dashed lines and
annotation.) Note the rotation spring with spring constant k at hinge H; this spring re-
sists rotation by generating an opposing moment of magnitude k ×  . Typical units for
k are lb-inch/radian and N-m/radian.

                      l 1                     l2 c
F(t)                                                                              (t)

                                   k H                               B y(t)
                                                               ky

           Figure 11-3 Example 11-1: damped, spring-supported, hinged rigid bar

         Before drawing a dynamic free-body diagram (DFBD, as defined in Section 7-5),
we need to express appropriately the reaction forces on the bar at point B from the trans-
lational spring (ky × y) and the translational viscous damper ( c × y& ). Observe that point B
moves in a circular arc of radius l 2 , so that y = l 2 sin . For arbitrarily large  , the term
sin and its time derivative would make equation of motion (11-11) nonlinear. How-
ever, the assumption of small rotation, | (t)| < 10°, linearizes that ODE; the geometry of
small rotation gives approximate linear equations in terms of  for stretch y of the trans-
lational spring due to motion of point B, and for damper-piston velocity y& :

              y = l 2 sin  l 2 ( in radians), and y& = l 2 cos ×&  l 2&

                                        11-5
      Chapter 11 Mechanical systems with rigid-body plane translation and rotation

The geometry of small rotation was used previously in the example of Section 7-1 to lin-
earize the pendulum equation of motion. For the system of Fig. 11-3, the assumption of
small rotation is physically plausible as well as mathematically expedient, because the
translational and rotational springs most likely would restrict rotation of the bar to small
angles relative to the static equilibrium position.

         The appropriate DFBD is drawn below. Note that we do not include bar weight
among the applied forces. We omit bar weight because we are interested only in dynamic

F(t)       l 1                             l 2

                          H                               c l 2&
                          FH k                            ky l 2

motion relative to the static equilibrium position, and because this bar is approximately
horizontal so that gravity has no pendulous effect on it; if you are not sure why we ne-
glect weight in this case, then review Section 7-5.

      From the DFBD and Eq. (11-11), the ordinary differential equation of motion is
                          J H && = l1F (t) - k - l 2 (c l 2& + k y l 2 )

            J H && + c l 22& + (k + k y l 22 ) = l1F (t)                            (11-12)

Equation (11-12) can be put into the standard form for a 2nd order damped system, and all
of the relevant results of Chapters 9 and 10 can be expressed in terms of the physical pa-
rameters of this particular mechanical system. For example, we can immediately find
equations for the system undamped natural frequency and viscous damping ratio:

      n =  k + k yl 22 ,           c l 22    =1               cl22                  (11-13)
               JH         2n =                        2  J H (k + k yl 22 )

                                     JH

NOTE: It is easy to make mistakes in algebra when we derive results such as (11-13).
One good, easy type of partial check that you can use is to evaluate the physical dimen-
sions of algebraic results. (It is only a partial check because dimensional consistency is a
necessary condition, but it does not guarantee the correctness of an algebraic equation.)
Do Eqs. (11-13) have the correct physical dimensions? You should be able to show that
the equation for n has the dimension (time)-1 and that the equation for  is dimen-
sionless. Don't forget that rotation  is dimensionless and that the radian, the natural
metric of rotation, is unitless. If you are more comfortable working with units than di-
mensions, it's satisfactory to check units instead. Table 3-1 should be helpful relative to
mechanical units.

                          11-6
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

Example 11-2: 1-DOF typical-section model for study of aeroelastic wing twist

         Since the beginning of modern aeronautical engineering in the late 1800s and
early 1900s, the interaction of aerodynamic pressure with airplane structural flexibility
has often produced unexpected and sometimes disastrous consequences. The subject of
these phenomena became known as aeroelasticity. During and after World War I, high-
aspect-ratio, cantilevered monoplane wings tended to be susceptible both to aeroelastic
flutter, undamped vibration that can escalate to destruction of wing and airplane, and to
aeroelastic divergence, the gradual twisting-off of a wing in, for example, pull-up from a
dive.2 In their attempts to analyze these aeroelastic phenomena, early aeronautical
engineers used simplified, low-degrees-of-freedom dynamic models of wing structures.
The basis of these models is called a typical section: one "typical" cross-section of a
high-aspect-ratio, straight, unswept wing is treated aerodynamically as an airfoil in two-
dimensional flow (without spanwise flow), and structurally as a spring-supported rigid
body (without spanwise beam bending and twisting).

         The simplest typical-section model is the one-degree-of-freedom (1-DOF) system
drawn in Fig. 11-4. It is helpful to visualize this as a physical model mounted for testing
in a wind tunnel. Elastic axis EA (the hinge) is assumed to be frictionless, and rotation

spring k represents wing torsional stiffness. (The term elastic axis refers to the line
along the span of a high-aspect-ratio, straight, unswept wing about which the wing chord-
wise sections rotate if a pure twisting moment is imposed upon the wing.) This model is
intended primarily for the study of aeroelastic divergence. Figure 11-4 shows the typical

            e FL                 
            MAC
                             V                                                 r
                         AC

k EA

                                            chord c

             Figure 11-4 Example 11-2: 1-DOF typical section in an airstream

section in the reference static equilibrium position before the wind tunnel fan is turned
on. Turning on the wind tunnel fan then produces an airstream of steady free-stream
velocity V flowing over the typical section at small angle of incidence r relative to the
reference chordline of the typical section. The airstream creates a resultant lifting force
FL that acts through aerodynamic center AC, and a resultant pitching moment MAC that
acts about AC. For most cases of practical interest, AC is forward of EA by some positive
distance e, as shown on Fig. 11-4; the polarity e > 0 is very important relative to diver-
gence. Aerodynamic actions FL and MAC impose moments upon rotation spring k , and
the spring flexibility permits structural rotation  relative to the reference position.

2 For the early history of aeroelastic divergence, see Bisplinghoff et al., 1955, pp. 3-7, and Gordon, 1978,
pp. 259-270.

      11-7
            Chapter 11 Mechanical systems with rigid-body plane translation and rotation

         The DFBD associated with Fig. 11-4 is drawn below. The equation of motion
comes directly from the DFBD and Eq. (11-11), with the assumption of small angles of

                                                        e FL
                                                        MAC

                                      EA                             AC

                                      FEA     k

incidence and rotation, |r | < 10° and | (t)| < 10°, and with J EA being the rotational
inertia of the typical section about EA:

                   J EA&& = FL e + M AC - k   J EA&& + k  = FL e + M AC                   (11-14)

         We can cast Eq. (11-14) into a more interesting and useful form by relating the
aerodynamic actions to the structural rotation. We assume that the airstream direction
coincides with the zero-lift attitude of the airfoil, i.e., that FL would be zero for any value
of airspeed V if the airfoil incidence were fixed at r = 0. Consequently, the total angle
of attack of the airfoil relative to the zero-lift attitude is  = r +  . Then aerodynamic
lift and moment can be expressed as

                   FL = qSCL = qSCL ( r +  ), and M AC = qS c CMAC                        (11-15)

Note especially in Eqs. (11-15) that an aerodynamic action (in this case, lift FL) is de-
pendent upon structural deformation (in this case, rotation  ); this type of interaction
between aerodynamics and structural flexibility is an important characteristic of all aero-
elastic phenomena. The symbols used in (11-15) beyond those previously defined are:

q  =  1  V  2  is  the  free-stream  dynamic  pressure  (lb/ft2  or  N/m2).
      2

 is air density (slug/ft3 or kg/m3).

S = b c is the planform area of the typical section (ft2 or m2).

b is the span of the typical section into the plane of the paper (ft or m).

CL > 0 is the slope of the curve of section lift coefficient ( FL qS ) versus angle of at-
tack (rad-1), which we assume here to be constant for small angles of attack.

CMAC is the dimensionless coefficient of pitching moment about AC, normally positive
for a positively cambered airfoil, but zero for an uncambered thin airfoil.

                                              11-8
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

         Wind tunnel experiments and aerodynamic theory show that aerodynamic action
Eqs. (11-15) are valid only for steady flow, for which angle of attack  does not vary
with time. However, we will approximate a bit here and assume that Eqs. (11-15) are at
least qualitatively valid for slowly-time-varying angle of attack, (t) = r +  (t). This
approximation is sometimes called quasi-static or quasi-steady aerodynamics. Sub-
stituting Eqs. (11-15) into Eq. (11-14) gives

J EA&& + k = qSCL ( r +  )e + qS cCMAC

 J EA&& + (k - qSCL e) = qSCL r e + qS cCMAC                                  (11-16)

         Note in Eq. (11-16) that the total stiffness constant, k - qSCL e (structural stiff-

ness plus aerodynamic "stiffness") can, for e > 0, become zero or even negative if dy-
namic pressure q is sufficiently large. This is critically important relative to the stability
of the system. Consider steady flow, for example, for which && = 0 ; in this case we can
solve Eq. (11-16) algebraically for the static structural rotation:

 = qS (CL r e + cCMAC )  q (CL r e + cCMAC )                                  (11-17)
k - qSCL e        CL e (qD - q )

In Eq. (11-17), we define the divergence dynamic pressure in terms of other fixed system
parameters as

qD  k                                                                         (11-18)
      SCL e

If it is possible for a given set of physical parameters to increase the wind-tunnel airspeed
V up to the point that q  qD = k SCL e , then, from Eq. (11-17), clearly something

very interesting will happen. From your knowledge of aerodynamics and structures, what
types of physical behavior do you think are possible? Keep in mind that Eq. (11-17) is
predicated on the assumptions of small angles and complete linearity of both aerody-
namics and structures (in this system, the rotation spring).

         A conventional airplane control surface is mounted on the trailing edge of a major
lifting surface, with the leading edge of the control surface hinged to the lifting surface
(e.g., an aileron on a wing). In this case, the aerodynamic center of the control surface is
aft of the elastic axis, making the moment arm e negative (see Fig. 11-4). From Eq. (11-
16), this produces the negative moment qSCL r e , which is called a blowdown moment,

and it also augments the structural stiffness in the total stiffness constant k - qSCL e .

Therefore, a conventional trailing-edge control surface cannot diverge aeroelastically.

            11-9
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

Example 11-3: 2-DOF typical-section model for coupled wing bending and torsion

         We now return to general-plane-motion Eqs. (11-2a), (11-2b), and (11-3), which
are three ODEs in three unknown DOFs: xC (t) , yC (t) , and  (t). In practice, these

ODEs are often coupled by system geometry and the nature of the active and reactive ac-
tions. Moreover, if motion is allowed to have arbitrarily large magnitude, then the equa-
tions are usually nonlinear. In general, these arbitrary-plane-motion equations can be
solved only in numerical form, not in the form of algebraic equations. However, the me-
chanical systems considered in this book are limited, in most cases, to those for which
center-of-mass translation is small relative to rigid-body dimensions, and for which rota-
tion is small, | (t)| < 10° (e.g., Examples 11-1 and 11-2 in this section); these limitations
allow us to linearize the ODEs into more easily solvable forms.

         One of the first forms of aeroelastic wing flutter that was observed and carefully
analyzed during the early 1900s involves coupled bending and torsional vibration (Bis-
plinghoff et al., 1955, Section 9-2). The two-degrees-of-freedom (2-DOF) typical section
depicted in Fig. 11-5 is a very simplified structural model used to study wing bending-
torsion flutter.3 The airfoil section is hinged without friction at elastic axis EA to a verti-
cal bar (assumed rigid and of negligible inertial force), which is restricted to vertical

translation by frictionless linear bearings. Rotational spring k simulates wing torsional
stiffness, and translational spring ky simulates wing bending stiffness. The theory of un-
steady aerodynamics, even for two-dimensional flow, is very complicated, so we shall
simply represent the aerodynamic resultant actions generally as lift FL(t) and pitching
moment about the aerodynamic center MAC(t), and we shall focus on the structural
dynamics.

                  MAC(t) FL(t) (t)

yEA(t)     yC(t)

        EA C AC

k       r

           e

ky

Figure 11-5 Example 11-3: 2-DOF typical section

3 Physical typical-section airfoils were designed, fabricated, and tested in recent wind-tunnel experimental
research studies of unsteady aerodynamics (as summarized by Bennett, 2000), and of feedback control to
suppress flutter (DeMarqui, et al., 2005 and 2006). Homework Problem 16.11 applies an approximate
theory of unsteady aerodynamics in a simulation of one such experimental project.

                                                  11-10
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

         In order to write the equations of motion for this typical section, we select as de-
grees of freedom the vertical translation yC(t) of mass center C, and pitching rotation  (t),
both relative to the reference static equilibrium position. The geometry of small rotation
is represented by the relationship between yC(t) and yEA(t):

yC (t) = yEA (t) + r sin (t)  yEA (t) + r (t)  yEA (t)  yC (t) - r (t) (11-19)

The DFBD associated with Fig. 11-5 is drawn below, with approximation (11-19) used to
annotate the force due to translation spring ky.

                                                                 MAC(t) FL(t)
                                             k

                              EA C AC

                              r

                 ky (yC - r)                     e

         Using this DFBD, we write the two relevant equations of motion, (11-2b) and
(11-3) in scalar form, as

                 m &y&C = FL (t) - k y ( yC - r )                             (11-20a)

  J C && = (e - r)FL (t) + M AC (t) - k + r k y ( yC - r )                    (11-20b)

It is appropriate to express Eqs. (11-20) with all terms involving degrees of freedom yC(t)
and  (t) transposed to the left-hand sides:

                 m &y&C + k y yC - r k y = FL (t)                             (11-21a)

  J C && - r k y yC + (k + r 2k y ) = (e - r)FL (t) + M AC (t)                (11-21b)

Equations (11-21) are a pair of 2nd order, coupled ODEs in unknowns yC(t) and  (t). Just

as Eqs. (1-15a) and (1-15b), Eqs. (11-21a) and (11-21b) are described as being coupled

because each equation contains both dependent variables and neither equation can be

solved independently of the other. It is possible, though we won't bother doing it, to
combine these two equations into a single 4th order ODE in a single unknown function of
time; therefore, this 2-DOF typical section is actually a 4th order system. It is appropriate

and common also to express the set of ODEs (11-21) in matrix form:

 inertia matrix     structural stiffness matrix

64748            644474448
m 0 &y&C   ky                 - rky  yC  
   &&  +                      2   =                 FL (t)                    (11-22)
                                                                
 0 JC    - rky k + r ky    (e - r)FL (t) + M AC (t)

                              11-11
              Chapter 11 Mechanical systems with rigid-body plane translation and rotation

         The labeled left-hand-side coefficient matrices of Eq. (11-22) are typical for struc-
tural dynamic systems, and they exhibit some important general properties. The inertia
matrix in this case is diagonal; more generally, it will be non-diagonal but symmetric.
The inertia matrix will always be positive definite because all matter has positive mass;
therefore, the determinant of the inertia matrix will always be positive. In (11-22), that
determinant is simply the product m JC > 0. The structural stiffness matrix in (11-22) is
symmetric, and this is a general property resulting from linearity between applied actions
and structural deformations. Moreover, if a structure is restrained by grounded supports,
such as the rotational spring k and translational spring ky of the typical section, then each
of the diagonal elements of the stiffness matrix will be positive, and the stiffness matrix
itself will be positive definite. You can check easily that the determinant of the stiffness
matrix in (11-22) is the product ky k > 0. The coupling between vertical translation yC(t)
and pitching rotation  (t) of the typical section is both produced by and displayed by the
non-zero off-diagonal terms of the stiffness matrix, each being - rk y .

                                                  11-12
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

11-4 Homework problems for Chapter 11

11.1 The trimming tab of a small airplane is attached to the elevator by a hinge at axis H

and a rotational spring (the actuator linkage) with constant k , as shown in the drawing
below. You are required to determine experimentally both rotational inertia JH of the
elevator about the hinge, and rotational stiffness k . The field experiment consists of two
separate twang tests. (See homework Problem 9.4 for a detailed description of twang
testing and relevant equations.) First, the rotational spring is disconnected from the tab,
and a vertical translational support spring of known stiffness ky = 15.6 lb/inch (and low
mass, producing negligible inertial force) is attached near the trailing edge, as shown.
Then the tab is twanged (displaced statically from the static equilibrium position, then
released). A non-contacting displacement sensor picks up the dynamic motion at a point
near the support spring: y(t) = 0.107 e-0.144t cos(59.9t) inch (t in seconds). (There is

slight damping due to friction at the hinge, internal structural damping in the spring, and
drag of the surrounding air.) From this first twang test, calculate JH (in lb-sec2-inch).
Next, translational spring ky is removed, rotational spring k is re-connected, and the tab
is again twanged. The same displacement sensor as in the first twang test now measures
dynamic motion y(t) = 0.132 e-0.112t cos(66.0t) inch. From the previous results and this

second twang test, calculate k (in lb-inch/radian).

Elevator  3.50 inches

          Trimming tab                 y(t)

          H k
                                                                      ky

11.2 The system depicted on the next page consists of a rigid bar, a mass, and springs.
The rigid bar is supported at frictionless hinge H, where it is elastically restrained by ro-

tational spring k , and the rotational inertia of the bar about point H is JH . Mass m is
connected to the bar by translational spring ky at point B, and the mass is restrained to
move only vertically by frictionless walls. An externally applied vertical force F (t) acts
on the bar at point B. Degrees of freedom y(t) and  (t) are the small motions relative to
the static equilibrium position. Sketch and label a DFBD for the bar and a DFBD for
mass m, then use these diagrams to derive the two coupled differential equations of
motion for this system. (Hints: Show that for small bar rotation, the stretch of spring ky
is a - y . Do not include mg or bar weight among the applied forces, because we are

interested only in dynamic motions relative to the static equilibrium position; if you are
not sure why we neglect weights in these equations of motion, then review Section 7-5.)

          11-13
   Chapter 11 Mechanical systems with rigid-body plane translation and rotation

                                           a                          F(t)
                  k                                                               (t)

               H                                                     B
                                                                ky y(t)

                                                                m

11.3 The two-degrees-of-freedom system drawn below consists of a pendulum supported

at frictionless hinge H, and a mass-spring connected by a viscous damper to the pendu-

                                              lum rod. The inertial moment of the

       H                                      lightweight pendulum rod is negligible,

                                              so pendulum rotational inertia about H

   a is JH = mp l2 . Degrees of freedom x(t)
                        x(t)                  and  (t) are small motions relative to

                     m                        the static equilibrium position. Show

                                              that the velocity of the damper cylinder

l         c             k                     relative to the damper piston is x& - a& .

                                              Both gravity and the externally applied

                                              horizontal force F(t) act on mass mp of

                                              the pendulum bob. Sketch and label an

          (t)                                 FBD for the pendulum and an FBD for
                                              mass m, then use these diagrams to de-
   mp          F(t)                           rive the two coupled differential equa-
                                              tions of motion for this system. In addi-

                                              tion to the motion and force variables

and the constant parameters shown on the drawing, the acceleration of gravity acting ver-

tically downward is denoted g. For this problem, unlike for Problems 11.1 and 11.2 and

the examples in Section 11-3, you should sketch your pendulum FBD with the pendulum

rotated through a small angle, so that you can indicate the restraining effect of weight mpg

on pendulum rotation; see the pendulum example in Section 7-1.

11.4 The form of the typical-section ODEs of motion represented by Eqs. (11-21) and
(11-22) is not unique. Suppose, for example, you want to define yEA(t) as the vertical
translation degree of freedom, instead of yC(t). With use of geometry, inertia, and alge-
braic manipulation, you can cast the ODEs into a cosmetically different, but mathe-
matically equivalent form. First, substitute Eq. (11-19) into Eqs. (11-21) in order to
replace yC(t) with appropriate terms that include yEA(t) and small-rotation (t); next, use
the parallel-axis theorem to replace JC with the rotational inertia about the elastic axis,
JEA, and a term including mass m; finally, perform any additional algebraic substitution
required to write the ODEs of motion in the following relatively simple matrix form:

                              11-14
Chapter 11 Mechanical systems with rigid-body plane translation and rotation

  inertia matrix             structural stiffness matrix
64748                        64748
 m mr &y&EA  k y 0   yEA   FL (t) 
                          &&  +     =                                                                             
mr J EA     0 k     eFL (t) + M AC (t)

Which terms in this matrix equation produce and display the coupling between vertical
translation yEA(t) and pitching rotation (t)? Will this coupling still exist if the applied
aerodynamic actions FL(t) and MAC(t) are either constant or vary slowly enough that the
response is pseudo-static? Prove the positive definiteness of these inertia and structural
stiffness matrices by finding the values and polarities of their determinants.

11.5 Consider the pendulum-spring system depicted below. The inertial moments of the

lightweight pendulum rods are negligible, so pendulum rotational inertias about their

hinges are Ji = mi l2 , i = 1, 2. Degrees of freedom 1 (t) and  2 (t) are small rotations
relative to the vertical hanging static equilibrium positions. A horizontal translational

spring with stiffness constant k connects the two

pendulums, and it is undeformed when the pendulums                                                            H1        H2 M2(t)
are in the vertical hanging static equilibrium positions.

Show that the stretch of the spring is given by
a(2 - 1 ) . Externally applied moment M2(t) acts on a

pendulum 2 at its hinge (applied, for example, by a                                                               k

motor). Sketch and label an FBD for each pendulum,

then use these diagrams to derive the two coupled differential equations of motion for this system. In l

addition to the motion and applied action variables and

the constant parameters shown on the drawing, the

acceleration of gravity acting vertically downward is                                                             1(t)         2(t)
denoted g. In this problem, you should sketch your

FBDs with the pendulums rotated through small angles,                                                     m1            m2

so that you can indicate the restraining effect of the

weights mig, i = 1, 2, on the rotations; see the pendulum

example in Section 7-1.

11.6 The drawing below depicts a very simplified model for the pitch-translation dy-
namics of an automotive vehicle. The body and frame are considered to be rigid, with
center of mass C located as shown, and having mass m and rotational inertia JC about C.

                             a1                               yC(t)                                                       (t)
                                                          C                                                       c2
k1                       c1
                                                                     a2

                                                                         k2

                                  11-15
              Chapter 11 Mechanical systems with rigid-body plane translation and rotation

The wheel-axle assemblies are considered to have negligible inertial forces. The flexi-
bilities of tires and suspension systems are lumped together into a single rear-axle trans-
lational spring k1 and a single front-axle translational spring k2. Damping is provided by
shock struts and rubber tires, and it is lumped into viscous dashpots c1 and c2 arranged in
parallel with the respective springs. Sketch and label a DFBD for this vehicle model,
then use it to derive the two coupled differential equations of motion for this system, in
terms of the given parameters. Use as degrees of freedom the small vertical translation
yC (t) and the small pitching rotation  (t), both relative to the static equilibrium position.

                                                  11-16
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

Chapter 12 Vibration modes of undamped mechanical systems with two
                                  degrees of freedom

© 2016 by William L. Hallauer, Jr.

12-1 Introduction: undamped mass-spring system

The subject of this chapter is free vibration of undamped mechanical systems,

beginning with the one-degree-of-freedom (1-DOF) mass-spring system of Fig. 12-1.

We evaluated the m-k system more generally in Chapter 7, but we will re-visit it here

using a different approach. Free vibration can arise from initial translation of the mass

(relative to the static equilibrium position) and/or initial velocity, and also from excitation

that has ceased, which might provide the mass with both initial translation and initial

velocity at the instant when excitation ceases. However, it is easiest

conceptually to visualize this motion as response to only non-zero initial        k

translation relative to the static equilibrium position. Doing so sacrifices a

little generality because we cannot also account for a non-zero initial

velocity, but the essential characteristics of the free vibration are revealed m

by this approach. Consider an undamped mass-spring system with non-

zero initial translation, y(0) = y0 , and zero initial velocity, y&(0) = 0 , but           y(t)
without forcing excitation, so that fy(t) = 0. From Eq. (7-2), the ODE of             fy(t)
free vibration is
                                                                                  Figure 12-1

m &y& + k y = f y (t) = 0                                                            (12-1)

        We now ask the questions: Can motion exist in the form y(t) = Y cost , and, if

so, what are the constants Y and  ? To find the answers, we substitute the presumed
form of motion into ODE (12-1), perform the differentiations and algebra, and see where
the process leads:

m (- 2Y cost) + k Y cost = (- 2m + k)Y cost = 0

This equation can be satisfied in general, for a non-trivial solution, only if
                             2 = k m  n2   = n = k m

Moreover, we can use the initial condition to find Y:

                            y(0) = y0 = Y cos( × 0) = Y

 y(t) = y0 cosnt                                                                     (12-2)

12-1
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

This simple result was already derived in Eq. (7-10); we re-derive it differently here just
to establish the approach that will be useful next for higher-order systems.

12-2 Undamped two-mass-two-spring system

Next, we analyze the two-degrees-of freedom (2-DOF) undamped mass-spring

system of Fig. 12-2. Dynamic translations y1 (t) and y2 (t) shown are relative to the sta-

tic equilibrium positions. As usual for the purpose of drawing forces on dynamic free-

body diagrams (DFBDs, as defined in Section 7-5),                         DFBDs
                                                                                k1y1
we let the translational springs be stretched at the

instant depicted, so that, in particular, the dynamic       k1

tension in the lower spring is k2 ( y2 - y1 ) . From

the DFBDs, Newton's 2nd law gives the ODEs of               m1            m1

motion:

         m1 &y&1 = f1 (t) + k2 ( y2 - y1 ) - k1 y1  (12-3)  f1(t)       y1(t) f1(t)
            m2 &y&2 = f 2 (t) - k2 ( y2 - y1 )                      k2                  k2(y2 - y1)

Transposing dependent-variable terms to the left-                 m2                  m2
hand sides, and collecting terms gives                                  y2(t)
                                                            f2(t)
                                                                                f2(t)

         m1 &y&1 + (k1 + k2 ) y1 - k2 y2 = f1 (t)   (12-4)  Figure 12-2 Two-mass-two-
            m2 &y&2 - k2 y1 + k2 y2 = f 2 (t)               spring mechanical system

Now, expressing Eqs. (12-4) in the same matrix form as Eq. (11-22) gives

           inertia matrix  structural stiffness matrix
         64748             6447448
         m1 0  &y&1  k1 + k2 - k2  y1   f1 (t)
                             +                                =               (12-5)
          0 m2 &y&2   - k2 k2  y2   f 2 (t)

You can verify easily that, just as in Eq. (11-22), the inertia and structural stiffness matri-
ces of Eq. (12-5) are positive definite, and all diagonal elements of both matrices also are
positive definite.

         Next, we want to solve matrix Eq. (12-5) for free vibrations, so we set to zero the
applied forces, f1 (t) = f2 (t) = 0 . Following the procedure in Section 12-1 for the 1-DOF
system, let's seek response to non-zero initial translations, with zero initial velocities.
Accordingly, we assume motion solutions of the unforced 2-DOF system in the form
y1 (t) = Y1 cost and y2 (t) = Y2 cost , in which , Y1 , and Y2 are the unknown quanti-
ties. It is efficient and appropriate to express the assumed solution in matrix form:

                                                    12-2
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

                   y1 (t) Y1                                          (12-6)
                    =   cost
                   y2 (t) Y2 

Substituting Eq. (12-6) into Eq. (12-5) with zero forcing gives

  m1 0 Y1  2              k1 + k2 - k2 Y1                        0
      (- ) cost +                              cost =                 (12-7)
   0 m2 Y2                 - k2 k2 Y2                            0

The common multiple cost in Eq. (12-7) cannot be zero in general, so we cancel it out

of the equation. Further, we consolidate all of the coefficients of Y1 and Y2 into a single
matrix, giving

    k1 + k2 -  2m1     - k2 Y1  0                                     (12-8)
                            2   =  
     - k2
                    k2 -  m2 Y2  0

         Before dealing with Eq. (12-8), let's review a little from your mathematics back-
ground about solving two linear algebraic equations in two unknowns. In general, the
equations are expressed in matrix notation as

a11 a12  x1  b1   a11 a12                     x1                 b1 
    =   , with              [a] , and    {x}, and    {b} (12-9)
a21 a22 x2  b2    a21 a22                    x2                  b2 

in which the aij's are known constant coefficients, the xi's are the unknowns, and the bi's
are known right-hand-side constants. It is useful to express the matrix equation symboli-
cally by using bold fonts, brackets, and parentheses: [a]{x} = {b}. Then the determinant
and the adjoint matrix of the coefficient matrix are, respectively,

                  det [a] = a11a22 - a21a12                           (12-10)

                             a22   - a12                              (12-11)
                  adj[a] =              

                            - a21   a11 

The solution of Eq. (12-9) for the unknowns involves the inverse [a]-1 of the coefficient
matrix, which is defined in terms of the determinant and the adjoint matrix:

                  {x} = [a]-1{b} = adj[a] {b}                         (12-12)
                                      det [a]

If {b} = 0, which is the case for Eq. (12-8), then there are two possible types of solutions:
(i) if {b} = 0 and det[a]  0, then the solution must be the trivial result {x} = 0; (ii) how-
ever, if {b} = 0 and det[a] = 0, then the right-hand side of Eq. (12-12) has the indetermi-

                    12-3
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

nate form 0 0 , so that there exists, and we can solve for a non-trivial {x}  0, but any
constant multiple of {x} is also a solution since {b} = 0 in Eq. (12-9). Therefore, for our
current application, Eq. (12-8), we must seek a type (ii) solution.

         To find the same type (ii) result as in the last paragraph, but without using matri-
ces or theory from linear algebra, let's write Eq. (12-8) as two separate scalar equations,
and then attempt to solve them algebraically for Y1 and Y2 :

(k1 + k2 -  2m1 )Y1 - k2Y2 = 0  Y2 = 1 (k1 + k2 -  2m1 )Y1          (12-13a)
                                                  k2

- k2Y1 + (k2 -  2m2 )Y2 = 0 = -k2Y1 + (k2 -  2m2 ) 1 (k1 + k2 -  2m1 )Y1 (12-13b)
                                                             k2

Re-arranging the last part of Eq. (12-13b) a bit differently gives

[(k1 + k2 -  2m1 )(k2 -  2m2 ) - k22 ]Y1 = 0                        (12-14)

                                           k2

We want to solve Eq. (12-14) for a non-zero Y1 , which leads us to conclude that: (1) the
bracketed term multiplying Y1 k2 must be zero [Note that the bracketed term is the deter-
minant of the coefficient matrix in Eq. (12-8).]; and (2) we cannot yet assign any specific
value to Y1 (but we will be able to do so later if we chose to regard this problem as being
time response to specific initial translations).

         The bracketed term in Eq. (12-14) must be zero; upon carrying out the multiplica-
tions, we see that it leads to a quadratic equation in the unknown  2 :

m1m2 ( 2 )2 + [- m1k2 - m2 (k1 + k2 )] 2 + k1k2 = 0                 (12-15)

This type of polynomial equation is generally called the characteristic equation of the
free-vibration problem. For any realistic values of the mass and stiffness constants, Eq.
(12-15) has two real, positive roots, which we denote as 12 and 22 .

         Let's consider a numerically simplified case for which the masses are equal, m1 =
m2  m , and the stiffness constants also are equal, k1 = k2  k . In this case, the quad-
ratic equation (12-15) becomes

m2 ( 2 )2 - 3mk 2 + k 2 = 0                                         (12-16)

Using the standard solution of quadratic equations, Eq. (2-2), we find the roots of Eq.
(12-16) to be

12-4
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

       2 = 3 ± 5 k = (0.382, 2.618) k                      (12-17)
        2m                                  m

For future reference, note that the lower of the ± signs gives the smaller (the "first") of
the two  2 roots, and that the upper sign gives the larger (the "second") of the two  2
roots. Only positive circular frequencies are physically meaningful, and they are:

 = (0.618, 1.618) k m  1 = 0.618 k m and 2 = 1.618 k m (12-18)

Of the two circular frequencies in Eqs. (12-18), the smaller value 1 is called the first or
fundamental natural frequency, and the larger value 2 is called the second natural
frequency. By convention, natural frequencies are always numbered in ascending order
for all higher-order systems that have two or more natural frequencies. It is mathe-
matically systematic to define an integer subscript n that is either 1 or 2, and to identify
the natural frequencies more generally as n , n = 1, 2. (In this case, the symbol n per-

forms double-duty, because it both implies natural frequency of vibration and takes the
values 1 or 2 to distinguish the two natural frequencies from each other.)

         Next, let's seek values of Y1 and Y2 associated with each of the natural frequen-
cies. It is appropriate and efficient to extend use of the subscript n to these motion mag-
nitude values by labeling as Y1n and Y2n the values associated with frequency n , n = 1,

2. Let's re-write Eqs. (12-13) using this notation and the numerically simplified case of
equal masses and equal stiffness constants:

   (2k - n 2m)Y1n - kY2n = 0  Y2n = 1 (2k - n 2m)Y1n       (12-19a)
                                                  k

   - kY1n + (k - n 2m)Y2n = 0  Y2n =           k           (12-19b)
                                                 2 Y1n
                                            k -n m

As is stated in the discussion of Eq. (12-14), we cannot yet assign any specific value to
Y1n . If we leave Y1n arbitrary (but not zero) for now, then Eqs. (12-19) appear to give
two different ways of solving for Y2n in terms of Y1n . Let's use natural frequency Eq.
(12-17) to evaluate both equations:

1  2                          2 m  3± 5  1m 5
Y2n = (2k - n m)Y1n =  2 - n  Y1n   =  2 -     Y1n =       Y1n (12-20a)
k                             k             2           2

                              12-5
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

Y2n = 2 k Y1n =          1 Y1n =     1 Y1n = 2                            Y1n
       k -n m              2m        3± 5                          -1m  5
                  1-     n k 1- 2

                  = 2 × 1 m 5 Y1n = 1 m 5 Y1n                                   (12-20b)
                  -1m 5 1m 5               2

Both equations (12-20) give the same answer! Mathematically, this result is related to
the zero of the determinant of the coefficient matrix in Eq. (12-8), but the detailed theory
is best left to a more advanced book (for example, Craig, 1981, Section 13.1). For our
purposes, it is enough to recognize from this example that, in this type of problem, both
equations have the same solution, so it is necessary to solve only one of them.

         Next, let's collect together from Eqs. (12-18) and (12-20) all the numerical results
for each value of the index n into modes of vibration, the physical significance of which
will become clear later. We have observed already that Y1n is some arbitrary non-zero

value, so nothing is lost if we set Y1n = 1 (with dimension of translation, i.e., length) for
both modes of vibration.

n = 1, first (fundamental) mode of vibration: [the lower sign in Eqs. (12-20)]

1 = 0.618 k ,            1+ 5                 Y11   1 
               m  Y21 =        Y11 = 1.618    =                                 (12-21a)
                            2                 Y21  1.618

n = 2, second mode of vibration: [the upper sign in Eqs. (12-20)]

2 = 1.618 k ,            1- 5                 Y12   1 
               m  Y22 =        Y12 = -0.618    =                                 (12-21b)
                         2                    Y22  - 0.618

                                              Y11                       Y12 
For reasons that will become clear later, the column matrices   and   are called
                                              Y21                       Y22 

the mode shapes of, respectively, the first and second modes of vibration. NOTE: In

Eqs. (12-21) we set Y11 = Y12 = 1 with dimension of length, but that does not necessarily

imply that the magnitudes of physical responses y1 (t) and y2 (t) are one meter or one

foot or one inch (depending upon the unit system in use). The actual physical response

magnitudes are determined by initial conditions, as is discussed in the next paragraph.

         Recall that we are seeking response to non-zero initial deformation, with zero ini-
                                                                     y1 (t) Y1 

tial velocity, and so we chose the solution in the form   =   cost , Eq. (12-6).
                                                                     y2 (t) Y2 

In view of the free-vibration results (12-21), it is quite plausible physically (and it can be

                               12-6
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

proved rigorously) that the general initial-translation response can be written as the linear
sum of two terms like Eq. (12-6), one for each of the vibration modes:

                 y1 (t) Y11         Y12 
                  = C1   cos1t + C2   cos2t                         (12-22)
                 y2 (t) Y21         Y22 

In Eq. (12-22), the dimensionless multiplying constants C1 and C2 show the contribution
to the total response due to each mode of vibration; they are found from given initial
translations y1(0) and y2 (0) by writing (12-22) for t = 0:

                 y1 (0) Y11  Y12  Y11  Y12 C1                       (12-23)
                  = C1   + C2   =          
                 y2 (0) Y21  Y22  Y21
                                       Y22 C2 

The determinant of the 2 × 2 mode-shape matrix [Y] in Eq. (12-23) is non-zero, so that
matrix can be inverted and the equation can be solved by application of Eq. (12-12), for
arbitrary known y1 (0) and y2 (0) , to give mode contribution constants C1 and C2 :

                  C1      1  Y22    - Y12  y1 (0)
                   =                                                (12-24)
                  C2  det[Y] - Y21
                                     Y11  y2 (0)

       Now, suppose that the initial translation is chosen to have the shape of the first

                                                      Y11 
mode, in other words, to be proportional to   with dimensionless constant of propor-

                                                      Y21 

tionality D1 :   y1 (0) Y11 
                  = D1   . Substituting this initial translation into Eq. (12-24)
                 y2 (0) Y21 

gives

       C1       1  Y22    - Y12  Y11  D1  Y22Y11 - Y12Y21  D1 
        =                 D1   =                   = 
       C2  det [Y] - Y21  Y11  Y21  det [Y] - Y21Y11 + Y11Y21   0 

                                                  y1 (t) Y11 
Therefore, the total response (12-22) is   = D1   cos1t for t  0. Let's express

                                                  y2 (t) Y21 
this mathematical result in words: if we impose the initial translation in the shape of the
first mode of vibration, then the subsequent free vibration of the system will be pure sinu-
soidal motion at the first natural frequency, and the relative positions of the two masses at
each instant of time will remain in the first mode shape. In other words, both masses will
vibrate with frequency 1 , and at each instant t  0 the ratio y2 (t) y1(t) will have the

same value, Y21 Y11 , which is 1.618 for the numerical example of Eqs. (12-16)-(12-18)
and (12-20)-(12-21). In this case, the two masses move in the same direction at each
instant, so they are said to move in phase with each other.

                              12-7
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

   Suppose next that the initial translation is chosen to have the shape of the second

                                    Y12 
mode, to be proportional to   with dimensionless constant of proportionality D2 .

                                    Y22 

By following the procedure of the last paragraph, we can find that the total response Eq.

    y1 (t)   Y12 
(12-22) is   = D2   cos2 t for t  0. In words, the subsequent free vibration of
    y2 (t)   Y22 

the system will be pure sinusoidal motion at the second natural frequency, and the rela-

tive positions of the two masses at each instant of time will remain in the second mode
shape: both masses will vibrate with frequency  2 , and at each instant t  0 the ratio

y2 (t) y1 (t) will have the same value, Y22 Y12 , which is -0.618 for the numerical exam-

ple of Eqs. (12-16)-(12-18) and (12-20)-(12-21). In this case, the two masses move in

opposite directions at each instant, so they are said to move out of phase.

   The modes of vibration of this 2-DOF mass-spring system, the numerical example

of Eqs. (12-16)-(12-18) and (12-20)-(12-21), are depicted graphically in Fig. 12-3. The

Static       Vibration     Vibration        system is shown in its static equilibrium
equilibrium  mode 1        mode 2           position for reference, and in deformed
                                            positions corresponding to each of the

                        k             k modes of vibration. We can't animate on
   k 1 = 0.618 m 2 = 1.618 m the printed page the dynamic motion of a
                                            vibration mode, so we imagine that we are

                                            viewing a snapshot of the masses taken at

m                                           one instant of time when the deformations

                                            are non-zero during any cycle of

   k y1(t) y1(t)                            vibration.

m                                           The object in this chapter is to de-

                                            rive and illustrate the physical character of

                         y2(t) =            modes of vibration of undamped 2-DOF
                             -0.618 y1(t)   systems. The clearest and most direct
                                            way to do this is to restrict attention to
   y2(t) = 1.618 y1(t)                      response resulting from simple initial de-

Figure 12-3 Vibration modes of the          formation, with zero initial velocity and
2-DOF mass-spring system that has           zero input action. We will not go further
equal masses and equal springs              in this book, but you should be informed
                                            that the theory started here can be ex-

tended to account for arbitrary non-zero initial conditions (both deformation and velocity)

and arbitrary non-zero input actions imposed on damped 2-DOF systems. Indeed, the

theory can be extended to damped higher-order systems having any number of degrees of

freedom, which are often called N-DOF systems, with N  2. The general method of

analysis is called modal analysis, and it is used extensively in engineering practice and

research for both mathematical and experimental studies. This book just scratches the

surface of modal analysis; the theory is extended to general response of LTI mechanical

                                      12-8
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

systems by more advanced books on linear-systems analysis and structural dynamics, two
examples being Meirovitch, 2001, Chapter 7 and Craig, 1981, Chapters 13-15.

12-3 Vibration modes of an undamped 2-DOF typical-section model of a wing

         From Example 3 of Section 11-3, the system is depicted again in Fig. 12-4:

                                  MAC(t)  FL(t)          2(t)

                        y1(t)

                        EA C AC

                 k             r

                                          e

                 ky

   Figure 12-4 2-DOF typical section

The degree-of-freedom symbols yC (t) and  (t) used in Chapter 11 are changed here,
respectively, to y1 (t) and  2 (t) , in order to denote clearly that these motion quantities
are, respectively, degrees of freedom (DOFs) #1 and #2.

        The matrix equation of motion in DOFs y1 (t) and  2 (t) , from Eq. (11-22) is

m 0  &y&1   k y      - rk y  y1              FL (t)  
0  J &&  + - rk      2   =                               (12-25)
    C  2   y     k + r k y  2  (e - r)FL (t) + M AC (t)

To analyze Eq. (12-25) for modes of free vibration following the procedure described in
the previous section, we set to zero the applied aerodynamic actions, and we seek motion
solutions of the unforced system in the form:

                     y1 (t)  Y1                          (12-26)
                      =   cost
                    2 (t) 2 

Substituting Eq. (12-26) into Eq. (12-25), canceling the common cost term, and col-
lecting all coefficients in a single square matrix leads to

   k y -  2m         - rk y        Y1  0
                             2   =                       (12-27)
    - rk y       k + r k y -  J C 2  02

                     12-9
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

Setting to zero the determinant of the coefficient matrix gives the quadratic equation for
the natural frequencies (the characteristic equation of the free-vibration problem),

mJ C ( 2 )2 + [- m (k + r 2k y ) - J C k y ]  2 + k y k = 0  (12-28)

For physically realistic values of the parameters in Eq. (12-28), there are two positive real
roots, 12 < 22 , one for each of the vibration modes, n = 1, 2. After these roots have
been found, they can be substituted back into either scalar equation of matrix Eq. (12-27)
to give equations for the mode shapes. We choose to use the first scalar equation
(because it has fewer terms than the second), and we solve for pitch mode shape
component 2 in terms of vertical translation component Y1 :

2 ky -n2m
(k y - n m)Y1n - rk y 2n = 0  2n =        Y1n , n = 1, 2     (12-29)
                                    rk y

         There is an interesting physical feature of motion in a pure vibration mode that is
sometimes exhibited by bodies such as the typical-section model of Fig. 12-4, bodies that
both translate and rotate: whereas most of the body is vibrating at a natural frequency
n , there might be a particular point on the body that is completely motionless. Such a

point is called a node or nodal point of the vibration mode. We can determine the loca-
tion of a nodal point on the typical section by referring to Fig. 12-5, which shows both
the airfoil in the static equilibrium position and the displaced chord line at some arbitrary
instant during a cycle of pure modal vibration. We define on the diagram a stationary x
axis with its origin at mass center C of the airfoil in the static equilibrium position. The

       y1(t)                                                 2(t)

                                                     Cx
              xnp

Figure 12-5 Nodal point of the 2-DOF typical section in a mode of vibration

coordinate xnp shown at the intersection of the static equilibrium chord line and the dis-
placed chord line is the nodal point. Using the geometry of small rotation and the nota-
tion on Fig. 12-5, we have y1(t)  -xnp2 (t) ; the minus sign is necessary because xnp as

shown is negative (aft of point C), but the values of y1(t) and  2 (t) shown are positive.
Therefore, the location of the nodal point for vibration mode n is given by

(xnp )n = - y1 (t) = - Y1n                                   (12-30)
             2 (t) 2n

12-10
     Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

If mode n is mostly translation, with little rotation, then the coordinate (xnp )n might have
such a large magnitude that there is no motionless point along the chord of the airfoil.
However, if there is a nodal point on a typical section in a vibration test, one can easily
observe it by sprinkling a little sand on the airfoil in the vicinity of the nodal point. As
the body vibrates, the sand will migrate away from oscillating surfaces and accumulate
on the motionless nodal point.

         Rather than deal with an excessive number of algebraic symbols in equations such
as (12-28), it is convenient now to consider a numerical example. A certain wind-tunnel
typical section has a chord of 12 inches, weighs mg = 5.00 lb, has rotational "weight"
about its mass center JC g = 90.0 lb-inch2, and has its mass center located r = 3.00 inches
forward of the axis at which it is supported by lightweight flexible beams that function as
springs. The spring constants provided by the beams are k y = 51.0 lb/inch and k = 920
lb-inch/radian. The MATLAB session printed below evaluates Eqs. (12-28) through (12-
30) for this numerical case.

» mg=5.00;Jcg=90.0;r=3.00;g=386.1; %mass and inertia constants
» ky=51.0;kt=920;format short e %stiffness constants
» p=[mg*Jcg/g^2 -(mg*(kt+ky*r^2)+Jcg*ky)/g ky*kt] %coeffs of Eq.(12-28)

p =

   3.0187e-003 -2.9746e+001 4.6920e+004

» w_sqrd=roots(p) %roots w^2 of quadratic Eq.(12-28)

w_sqrd =

   7.8822e+003
   1.9720e+003

» wn=[sqrt(w_sqrd(2)) sqrt(w_sqrd(1))] %circular natural frequencies
(in rad/sec) arranged in ascending order

wn =

   4.4407e+001 8.8782e+001

» fn=wn/2/pi %cyclic natural frequencies (in Hz)

fn =

   7.0676e+000 1.4130e+001

» Th2n=(ky-mg/g*wn.^2)/(r*ky) %Eq.(12-29) for mode shape components 2n,
with Y1n = 1 inch

Th2n =

   1.6642e-001 -3.3382e-001

» XNPn=(-1)./Th2n %Eq.(12-30) for locations of the nodal points

                                                  12-11
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

XNPn =
 -6.0087e+000 2.9956e+000

         The numerical results of the MATLAB calculations are summarized in the fol-
lowing table:

     Mode of vibration n              1                     2
Natural frequency n and       1 = 44.41 rad/sec     2 = 88.78 rad/sec
f n = n 2
                                 f1 = 7.068 Hz       f2 = 14.13 Hz
         Mode shape
                               Y11   1 inch          Y12   1 inch 
Nodal point location (xnp )n   =                     =                                 
                              21  0.1664 rad        22  - 0.3338 rad

                              -6.01 inch            +3.00 inch

         The vibration modes of this typical section are also displayed effectively in a
graphical format, Fig. 12-6, which is comparable to Fig. 12-3 for the mass-spring system.
Figure 12-6 indicates the airfoil in its reference position with a solid chord line, and in a
modal displaced position with a dashed chord line. Let's suppose that mass center C is
located 5 inches aft of leading edge LE along the 12-inch chord. In this case, the nodal
points of both modes (listed in the table above) are located on the airfoil as shown on Fig.
12-6, not forward of LE or aft of trailing edge TE. For graphical clarity, the magnitudes
of motions y1(t) and  2 (t) are shown greatly exaggerated relative to the 12-inch chord.
Actual motions of a realistic typical section would be tens or hundreds of times smaller.

       Vibration mode 1                   Vibration mode 2
         f1 = 7.068 Hz                      f2 = 14.13 Hz
                                                     2(t) = -0.334 y1(t)
2(t) = 0.166 y1(t)
                    y1(t)                       y1(t)

TE  C                         LE TE              C  LE

Figure 12-6 Vibration modes of the example typical section

                              12-12
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

12-4 Homework problems for Chapter 12

12.1 Consider again the 2-DOF system of homework Problem 11.2, depicted below.

                             a                                     F(t)
    k                                                                          2(t)

                                                                B
    H

                                                           ky y1(t)

                                                                m

The two coupled differential equations of motion for this system, as derived for home-
work Problem 11.2 and now expressed in matrix form, are

m 0  &y&1   k y                        - ak y  y1   0 
 0  J &&  + - ak                       + a 2k       =  a F (t)
     H  2   y     k                          y  2 

All the parameters in these equations are defined on the figure except J H , which is the
rotational inertia of the bar about frictionless hinge H . Consider the free-vibration prob-
lem, with F (t) = 0 . First, show that the characteristic equation in general is

m J H ( 2 )2 + [- m (k + a 2k y ) - J H k y ]  2 + k y k = 0

Now, consider the following situation. Suppose that you are a design engineer working
on a new satellite project for an aerospace company. You have designed a sensor pack-
age that includes a small mechanical device in the form of the subject 2-DOF system.
The satellite has been fabricated, and is now being subjected to functional ground testing.
The primary attitude-control actuator for the satellite is a control-moment gyroscope
(CMG), the rotor of which spins at 11,400 rpm in normal operation. The spin-up time for
this CMG is about four hours. During the first functional test, at the very end of the
CMG spin-up, test engineers observe a short period of loud buzzing coming from the vi-
cinity of your sensor package. The buzzing suddenly stops, and nobody thinks anything
more about it until functional tests begin on your sensor. Unfortunately, the readings
from your sensor are gibberish. The sensor package is removed and opened up, and ex-
amination shows that the 2-DOF device is completely destroyed: both springs are frac-
tured, the bar is badly bent, the mass is detached, and the bar and mass have banged
against near-by circuit boards within the package. It is now your responsibility to deter-
mine what went wrong. One experienced test engineer speculates that the 2-DOF device
might have resonated due to base excitation caused by the CMG. Although the rotors of
space-qualified CMGs are always carefully balanced, it is impossible to remove all im-

                  12-13
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

balance. Consequently, rotor-spin imbalance imposes small periodic forces at the spin
rate onto the CMG supports, and these forces produce vibration that is transmitted in
waves throughout the spacecraft structure. With the assistance of calibration technicians,
you determine that the numerical parameters of the 2-DOF device are: m = 19.2 g =
0.0192 kg, J H = 37.3e-6 kg-m2, ky = 16.9 N/mm = 16.9 kN/m, k = 12.8 N-m/rad, and a
= 30.0 mm = 0.0300 m. Calculate the vibration modes of this system (natural frequen-
cies, mode shapes, and sketches of the mode shapes), and discuss in a few sentences the
probable cause of the structural failure within your satellite sensor package.

12.2 Consider again the 2-DOF pendulum-spring system of homework Problem 11.5,
depicted below. The two coupled differential equations of motion for this system, as de-
rived for homework Problem 11.5 and now expressed in matrix form, are

m1l 2  0 &&1  m1gl + ka 2    - ka 2 1   0 
       2  &&  +                                               2  =                 
0      m2l  2   - ka  2      m2 gl + ka  2  M 2 (t)

Consider the free-vibration problem, with M 2 (t) = 0 .                  H1        H2    M2(t)
It will simplify the writing if, initially, you will use the
following notational abbreviations: J1 = m1l2 , J 2 =             a          k
m2l 2 , k1 = m1gl + ka 2 , k2 = m2 gl + ka 2 , and kc =       l
ka2 (the "coupling" coefficient). First, show that the
characteristic equation in general is

    J1J 2 ( 2 )2 + (-J 2k1 - J1k2 ) 2 + k1k2 - kc 2 = 0

Now consider the special case with m1 = 21 m2 and kc

= ka2 = m2 gl . Express all the coefficients of the char-                    1(t)        2(t)
acteristic equation in terms of m2 , g, and l , and then
                                                                     m1              m2

show that this quadratic equation can be put into the

form ( 2 )2 - 5(g l) 2 + 4(g l)2 = 0 . For this spe-

cial case, solve for the natural frequencies and mode shapes, and sketch the mode shapes.

12.3 Consider again from homework Problem 11.6 the simplified model for pitching-
translation dynamics of an automotive vehicle, depicted below. The rigid body frame has
mass m and rotational inertia JC about center of mass C.

                  a1             y1(t)                                                 2(t)
                             C                                                  c2
k1     c1
                                        a2

                                            k2

                      12-14
  Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

The two coupled differential equations of motion for this system, as derived for home-
work Problem 11.6 and now expressed in matrix form, are

m 0  &y&1   c1 + c2      c2a2 - c1a1  y&1   k1 + k2           k2a2 - k1a1  y1  0
   &&  +                       2 &  +                                             2  =  
 0 J C  2  c2a2 - c1a1 c1a1 + c2a2  2  k2a2 - k1a1 k1a1 + k2a2  2  022

To obtain the vibration modes of the undamped system, we set c1 = c2 = 0 , which deletes
the entire second term of the matrix equation. The following data are representative for a
compact four-door sedan: mg = 2,150 lb, JC g = 5.47e6 lb-inch2, k1 = k2 = 155 lb/inch,

a1 = 82.7 inches, and a2 = 35.4 inches. Calculate the natural frequencies, mode shapes,
and nodal point locations, and sketch the mode shapes.

12.4 Consider again Fig. 12-2, but now suppose that the       entire undamped     mass-spring
system consists of a primary sub-system, with mass m1                             F1 cos t
and spring k1, plus a smaller auxiliary sub-system, with                   k1
mass m2 and spring k2; also, that a steady sinusoidal force
f1(t) = F1 cos t acts upon m1, but no externally applied                m1
force acts upon m2, f2(t) = 0. Your assignment is to solve         y1(t) f1(t) =
for and evaluate the steady-state forced sinusoidal re-
sponses y1(t) = Y1() cos t and y2(t) = Y2() cos t. To                      k2
solve, use the theory developed in Section 12-2, not the                m2
more general procedure described in Section 4-7 for
finding frequency-response functions.

(a) Determine algebraic equations for Y1() and Y2() in y2(t)
terms of m1, k1, m2, k2, F1, and . Also, write the charac-
teristic equation of the free-vibration problem, and explain what happens if its roots are
substituted into the equations for Y1() and Y2().

Partial answer: Y2 () =        k2 F1

                         (k1 + k2 -  m1 )(k2 -  m2 ) - k2222

(b) Suppose that this is a system for which vibration isolation is required: primary mass
m1 includes an unbalanced reciprocating motor or machine that oscillates with specific
frequency  = , which tends to cause m1 to vibrate vertically at frequency ; but it is
desirable to protect from that vibration the supporting structure to which primary spring
k1 is attached. (See homework Problem 10.13 for additional discussion of vibration iso-
lation.) According to your solution in part (a), what happens to motion amplitudes Y1()
of m1 and Y2() of m2 if you tune the single-DOF frequency of the auxiliary mass and
spring, m2 and k2, to the excitation frequency, i.e., if you design the auxiliary sub-system
so that k2 / m2   2? With k2 / m2   2, what is the sinusoidal force k2[y2(t) - y1(t)] that
spring k2 imposes on primary mass m1? With the correct answers to these questions, you
will have explained the functioning of an ideal undamped dynamic vibration absorber.

                               12-15
Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

(c) An ideal undamped dynamic vibration absorber is unattainable in reality because
systems always have some damping. Moreover, even if we could magically eliminate all
damping, the ideal absorber would still have a serious deficiency: if the excitation fre-
quency were to differ from the nominal value, which usually happens in practice during
motor start-up or off-nominal operation, then the system could experience a 2-DOF reso-
nance failure. Suppose, for example, we have the following numerical parameters: m1 =
25.3 kg, k1 = 2.62 MN/m, / 2/  = 50 Hz, and the auxiliary sub-system is tuned to 50 Hz
with m2 = 5.066 kg and k2 = 0.5 MN/m. First, solve the characteristic equation to calcu-
late the two system natural frequencies in Hz, f1 = 1 / 2/  < f2 = 2 / 2/ ; if you wish, you
may use the roots MATLAB function for this task. Next, calculate and plot versus ex-
citation frequency (in Hz) the frequency-response dynamic flexibility, Y1() / F1, of the
primary sub-system. The range of excitation frequencies over which you plot this re-
sponse must include at least all three frequencies, f1, / 2/ , and f2; it probably should
even extend somewhat below the lowest of these three and somewhat above the highest.
Be sure to include appropriate axis labels on your graph. Your graph should display
clearly both the strengths and the weaknesses of the ideal undamped dynamic vibration
absorber for these particular numerical parameters.1

12.5 The drawing at right represents a rotational mechanical
system that is directly analogous to the translational mechani-
cal system of Fig. 12-2. Rotational inertias J1 and J2 are analo-
gous, respectively, to masses m1 and m2 on Fig. 12-2; rotational
springs K1 and K2 are analogous to translational springs k1 and
k2; applied moments M1(t) and M2(t) are analogous to applied
forces f1(t) and f2(t); and rotations 1(t) and 2(t) are analogous
to translations y1(t) and y2(t). Therefore, the matrix equation of
motion for this rotational system is directly analogous to Eq.
(12-5) for the translational system:

inertia matrix  structural stiffness matrix
64748           644474448
J1 0 &&1  K1 + K 2 - K 2 1  M1 (t)
   &&  +                                       =  
 0 J 2  2   - K 2 K 2  2  M 2 (t)

Consider a 2-DOF inertia-spring system with rotational inertias J1 = J2 = 0.01042 kg-m2
and rotational stiffness constants K1 = K2 = 2.77 N-m/rad. Your assignment is to calcu-
late and plot, over the time interval 0  t  5 seconds, the unforced initial-condition (IC)
responses, rotations 1(t) and 2(t), of this system if the initial rotations are 1(0) = 2(0) =
14.58 degrees, and the initial rotational velocities are zero. Use the theory (and even the
appropriate calculations, if you wish) of Section 12-2. The given inertias and stiffness
constants are those of a real structural system, which is described on the next two pages,
and the given initial conditions were imposed on that system, producing the measured re-
sponses shown on the graph following this paragraph. Your theoretical responses should

1 Homework Problem 12.4 is only an introduction to the subject of dynamic vibration absorbers. See Den
Hartog, 1956, Sections 3.2 and 3.3, for a more advanced and extensive treatment of this subject.

                                             12-16
     Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

appear somewhat similar to the measured responses, but the theoretical and measured re-
sponses should differ in one significant respect. Read the description below of the actual
structural system, then identify the property of all real mechanical dynamic systems that
is not modeled by the theory of Chapter 12, and explain how this modeling deficiency is
illustrated in the differences between the theoretical and measured responses shown on
the graphs.

         The photograph on the next page shows the relevant structural portion of the ac-
tual laboratory system2 that is represented by the drawing on the previous page, and from
which the IC-response graph above was measured. Three steel disks are attached to a
continuous steel shaft of diameter about 3.2 mm. Each disk is 20 cm in diameter and 0.5
cm thick, with four radial slots to accommodate added masses. The total length of shaft
between lower and upper disks is about 68 cm. The shaft is supported near the middle
and upper disks by bearings, which impose some damping on the structure. The lower
disk is clamped to the frame, so the shaft is fixed at the bottom but is free to twist
everywhere else along its length. Two metal cylinders, each of nominal mass 0.5 kg, are
bolted symmetrically at 9-cm radii to each of the middle and upper disks. The rotational
inertias of the two bulked-up disks are orders of magnitude greater than that of the shaft,
so this system is effectively a 2-DOF rotational structure, those DOFs being rotations
1(t) and 2(t) of the middle and upper disks, respectively. 1(t) and 2(t) are sensed by
the optical encoders shown on the photograph; each encoder shaft is connected to the

2 This is a Model 205a Torsional Plant designed and fabricated by Educational Control Products of Bell
Canyon, California, USA.

                                                  12-17
     Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

structural shaft by a lightweight belt and pulleys, which add to the system some damping
but negligible inertia.

         A clever student determined experimentally the inertias and stiffness constants of
this system, rather than relying on purely theoretical calculations, mostly by using the
added-inertia method (from homework Problem 7.9). To determine J2 and K2, the student
clamped the middle disk to the frame, and then measured free-vibration frequencies of
the upper disk [2(t) with 1(t) = 0], both bare and with symmetrically added combina-
tions of the metal cylinders. The student determined J1 and K1 + K2 by clamping the up-
per disk, and then measuring free-vibration frequencies of the middle disk [1(t) with
2(t) = 0]. The values of the parameters determined by this process are J1 = J2 = 0.01042
(± 0.00003) kg-m2 and K1 = K2 = 2.77 (± 0.04) N-m /rad.

         The initial rotations, 1(0) = 2(0) =
14.58°, were imposed on the middle and upper
disks by twang, also known as snapback, exci-
tation: a fine thread was tied around the front
cylinder of the middle disk, the thread was
pulled laterally and the opposite end was an-
chored, thus imposing onto the middle disk the
static initial rotation, then the thread was cut
with scissors, abruptly releasing the middle
and upper disks to free vibration. The struc-
tural shaft was fixed only at the bottom, so the
initial rotation of the upper disk was the same
as that of the middle disk.

                                                  12-18
   Chapter 12 Vibration modes of undamped mechanical systems with two degrees of freedom

12.6 A structure's fundamental mode of vibration is represented in the drawing below by

mass m1 and spring k1, with the translation of m1 denoted as x1(t). Suppose we wish to

exercise active control over that vibration by use of an attachment to the structure: a re-

action-mass actuator (RMA), represented in the diagram by reaction mass m2, spring k2,

and internally generated force fi(t) acting equally and oppositely on m2 and m1, with the

translation of m2 denoted as x2(t). (To simplify the equations here, we neglect the nor-

mally small natural passive damping inherent in both structures and RMAs.) Use Eq.

            x1(t)                             (12-5) to write the matrix equa-

                                              tion of motion for this combina-

                                           x2(t) tion of structure and RMA. Next,

                   k2 / 2                     revise this equation to include the

   k1                                         particular type of feedback vibra-

        m1         fi (t)              m2     tion control described in the fol-

                                              lowing. Suppose that reaction

                   k2 / 2                     mass m2 carries a transducer that

                                              senses the translational velocity of

                   RMA                        m2 relative to that of m1 and gen-

                                              erates an electrical voltage signal

                                              proportional to that relative ve-

locity, ev (t) = V (x&2 - x&1 ) , where V is a calibration constant with units such as volt per

meter/sec. Homework Problem 10.15 explains that an external voltage signal ei(t) [not

shown on this drawing] commands internal force fi(t) according to the linear relationship

fi(t) = G ei(t), G being a constant with units such as newton per volt. Suppose that we

multiply the relative velocity signal ev(t) by a variable gain factor F (using, e.g., a non-

inverting amplifier, homework Problem 5.8) and then feed the multiplied signal back to

serve as the force-command signal, ei(t) = Fev (t) = FV (x&2 - x&1) . Therefore, the gener-

ated internal force is fi(t) = G ei(t) = GFV (x&2 - x&1 )  C(x&2 - x&1 ) , where we define the

overall feedback constant C  GFV with units such as newton per meter/sec. Revise your

matrix equation of motion to reflect the feedback vibration control described here; in

particular, show that the feedback produces an artificial viscous damping matrix,

  1 -1
C       . With sufficiently large feedback gain factor F and sufficient authority of
 -1 1 

the RMA's internal force generator, this form of control can impose significant positive

damping upon a structure's vibration.

NOTE: It is not in required in this problem, but it might be of interest to you that re-
placing dependent variable x2(t) with the relative translation of reaction mass m2, z(t) =
x2(t) - x1(t) can transform the matrix equation of motion into the following form, in
which the inertia matrix becomes full and symmetric, but the artificial damping and stiff-
ness matrices become simpler and diagonal:

        m1 + m2    m2 &x&1  0          0 x&1  k1  0 x1  0
                        +                  +          =  
         m2
                   m2  &z&  0          C z&   0   k2  z  0

                                       12-19
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

Chapter 13 Laplace block diagrams, and additional background
         material for the study of feedback-control systems

                                 © 2016 by William L. Hallauer, Jr.

         We will consider in Chapter 13 a graphical format, the Laplace block diagram,
which is useful in the analysis of complicated systems that consist of more than one sub-
system. While developing closed-loop block diagrams, we will also analyze the equation
of motion and the time response of a base-excited mass-damper-spring system, which
turns out to be an instructive prototype for output feedback control. All of this is prepa-
ration for the more general study of feedback-control systems beginning in Chapter 14.

13-1 Laplace block diagrams for an RC band-pass filter

         To introduce the Laplace block diagram for a simple case, we re-visit again the
RC band-pass filter considered previously in Sections 5-4, 9-10, and 10-4. As shown in
Fig. 5-10, this circuit consists of a low-pass-filter stage to the left of the voltage follower,
and a high-pass-filter stage to the right. The Laplace transforms derived for these stages
in Section 10-4, assuming zero ICs, are: for the low-pass stage, with L = RLCL ,

L[em ] = 1 L[ei ]     (13-1)                   RL - CH
         L s +1                                            em(t) + em(t)

and for the high-pass stage, with H =  ei(t)          CL                      RH eo(t)
RH CH ,
                                               iL(t)                   iH(t)

L[eo ] =  H s L[em ]  (13-2)           Figure 5-10 (repeated) RC band-pass filter
        H s +1

         Figure 13-1 shows a convenient        L[ei]     1      L[em]    H s L[eo]
graphical format, the block diagram, for rep-         L s +1           H s +1
resenting these Laplace-transform output-to-
input relationships. From Eqs. (13-1) and             Low-pass         High-pass
(13-2), we have the individual transfer func-          TFL(s)            TFH(s)
tions of the low-pass and high-pass stages:

 TFL (s) = L[em ] = 1                  (13-3)  L[ei]            H s           L[eo]
            L[ei ]  L s + 1            (13-4)
                                                      ( L s + 1)( H s + 1)
TFH (s) = L[eo ] =  H s
           L[em ]  H s + 1                            Band-pass TFB(s)

                                               Figure 13-1 Laplace block diagrams of
                                               the RC band-pass filter

                                       13-1
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

In the upper row of Fig. 13-1, transfer functions (13-3) and (13-4) are shown as individ-
ual blocks, and the Laplace transforms are shown as input and output "signals" relative to
the blocks. The most basic rule of "block-diagram algebra" is that the input signal (trans-
form) multiplied by the block transfer function equals the output signal (transform),
which gives Eqs. (13-1) and (13-2).

         One common objective in construction of Laplace block diagrams is to simplify
the process of deriving the transfer function of the overall system from the transfer func-
tions of individual sub-systems. To help achieve this objective, we have the second basic
rule of block-diagram algebra: multiply the transfer functions of two adjacent blocks in
order to obtain the more general transfer function relating the output signal from the
downstream block to the input signal into the upstream block. The result of this opera-
tion in the present case is shown in the lower row of Fig. 13-1, where transfer function
(10-27) of the entire RC band-pass filter circuit is derived once again:

TFB (s) = L[eo ] =  H s                                                     (13-5)
           L[ei ] ( H s + 1)( L s + 1)

         Each of the block diagrams in Fig. 13-1 has a single forward (left-to-right) path or
branch. A more general type of block diagram has a forward branch and also one or
more backward paths denoting signal flow in the opposite direction; such a right-to-left
path is called a feedback branch. A forward branch combined with a feedback branch
forms a closed loop, and a block diagram that includes closed loops is called a closed-
loop block diagram. Accordingly, a block diagram with only a forward branch is called
an open-loop block diagram. The next section develops the concept of closed-loop block
diagrams in the context of a familiar mechanical system.

13-2 Laplace block diagram with feedback branches for an m-c-k system with base
excitation

Let's proceed beyond the most basic aspects of Laplace block diagrams by ana-

lyzing the m-c-k system with base excitation shown on Fig.      xi(t)        x(t)
13-2. The input is base translation xi (t) , and the output is              c
mass translation x(t) . The ODE of motion for this system       k
(from homework Problem 9.1) is                                           m

m &x& + c x& + k x = k xi (t)                         (13-6) Figure 13-2 m-c-k system
                                                                with base excitation

It is convenient to denote the input transform as L[xi (t)] = X i (s) and the output trans-
form as L[x(t)] = X (s) . Taking the Laplace transform of Eq. (13-6) with zero ICs, for

the purpose of deriving the transfer function, gives

m s2 X (s) + c s X (s) + k X (s) = k X i (s)                                (13-7)

                               13-2
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

Equation (13-7) clearly leads to the transfer function,

       TF (s)  X (s) = 2 k                               Xi(s)         k           X(s)
                 X i (s) m s + c s + k        (13-8)
                                                                     ms2 + cs + k

Equation (13-8) is represented in the simple open-loop Laplace block diagram just above.

         It will be instructive for our later study of feedback control to develop now an al-
ternative but equivalent block diagram from Eq. (13-7). First, we transpose to the right-
hand side all terms other than the X(s) term of highest order:

                       m s2 X (s) = k X i (s) - c s X (s) - k X (s)                (13-9)

Now we "solve" algebraically for X(s) on the left-hand side of Eq. (13-9) simply by di-
viding through by the coefficient of the left-hand-side X(s):

                       1 1                                           
                  X (s) =  [k X i (s) - k X (s) - c s X (s)]                       (13-10)
                       s ms
                                                                     

Observe in Eq. (13-10) that output transform X(s) appears in the right-hand-side terms as
well as on the left-hand side; these right-hand-side terms imply feedback. Using (13-10)
leads to the following block diagram with several different transfer-function blocks and
with two feedback branches:

                       kXi(s) - kX(s) - csX(s) = ms2X

Xi(s)     kXi(s)  kXi(s) - kX(s)          1 sX(s) 1 X(s) X(s)

       k          + _  +_                 ms                    s

                            csX(s)        c   sX(s)

                                  k X(s)  k   X(s)

Figure 13-3 Laplace block diagram with feedback branches for a
base-excited m-c-k system

The input and output signals for every block are labeled on Fig. 13-3 in order to help you
relate the block diagram to Eq. (13-10), and you should carefully compare the equation
and the diagram until you are certain that you understand.

Also, block diagram Fig. 13-3 introduces two kinds of junctions. The first kind is

a simple branch point (black circle), from which the same block-       In1(s) Out(s)
output "signal" travels onward on two different branches, as is                + -
indicated by the signal labels on Fig. 13-3. The second kind is a
summing junction, shown at right with input and output signals la-       In2(s)

                                        13-3
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

beled. This summing junction is configured for negative feedback, so it differences the
two input signals, Out(s) = In1(s) - In2(s).

         In this section, we started with ODE (13-6) and developed from it Laplace block
diagram Fig. 13-3. This approach is primarily for the purpose of presenting some im-
portant features of block diagrams. This approach is actually the reverse of the standard
procedure for analysis of feedback-control systems, which we will consider in later chap-
ters. There, we will start with the block diagram of a system, something like Fig. 13-3,
and derive from it the closed-loop transfer function, CLTF(s) ), which in this case is just
Eq. (13-8). The process of deriving CLTF(s) from the system block diagram will require
some new operations in block-diagram algebra; it is expedient to postpone the descrip-
tions of these operations until we need them in later chapters.

13-3 Forced response of an m-c-k system with base excitation

         It will be helpful for our introduction to feedback control in Chapter 14 if we now
examine the relationship between input motion xi (t) and output motion x(t) for the me-
chanical system of Fig. 13-2 and Eq. (13-6). Let's adopt the perspective here that we
want to use xi (t) in order to control x(t) ; in particular for this system, let's suppose that
we want to make motion x(t) of mass m be as close as possible to input motion xi (t) .
You can visualize intuitively from Fig. 13-2 that if xi (t) is imposed very slowly, then
x(t) will be essentially the same as xi (t) ; in this case, the inertial force of mass m will be
negligible, and spring k will deform only slightly, therefore acting essentially as a rigid
link. (You can, of course, prove theoretically this qualitative analysis, for example, by
finding frequency response at a very low input frequency.)

         But can output motion x(t) be made close to input xi (t) if xi (t) is not imposed
slowly? Your intuition probably fails to answer this question because, in this case, spring
k might deform significantly, and the inertial force of mass m might not be negligible.
We will have to analyze this situation theoretically. Let's do so specifying that input
motion xi (t) is a step function of magnitude X H imposed at time t = 0. An ideal step
input is not merely fast; it is in fact the fastest imaginable (though not physically realiz-
able) base excitation, because base position changes with infinite velocity at t = 0 from
xi = 0 to xi = X H . So this ideal input poses a formidable challenge to the control objec-
tive: can output translation x(t) approximate in some reasonable manner the input trans-
lation xi (t) , even though initially the input translation is infinitely fast?

         In order to analyze this case, let's first adapt ODE (13-6) to the standard ODE for
damped 2nd order systems as it is defined in Chapter 9. Dividing Eq. (13-6) through by
m, and then applying the standard definitions (7-3) for undamped natural frequency, n

= k m , and (9-4) for viscous damping ratio,  = c (2 mk ), casts the ODE into the

form &x& + 2n x& + n 2 x = n 2 xi (t) . Comparing this ODE with Eq. (9-13) shows that in-

                                                   13-4
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

put xi (t) for this particular base-excited m-c-k system is exactly equal to the standard in-
put quantity: xi (t)  u(t) . We define step input xi (t) = X H H (t) . Therefore, X H  U,
which is the general step-input magnitude of Section 9-6, and we can write the step-re-
sponse solution for  < 1 directly from Eq. (9-29):

  -nt    n  
x(t) = X H 1 - e  cosd t + sin d t  , for 0  t  (13-11)
        d
            

In Eq. (13-11), the damped natural frequency is d  n 1 -  2 . Also, for use in Fig.
13-4, the period of the undamped system is Tn = 2 n . Recall that our control objec-
tive is to make the output motion at least approximately equal to the input motion. At t =
0, input motion xi (t) jumps discontinuously from 0 to X H , then xi remains constant
thereafter, so we would like the output motion x(t) to approximate that step input as
closely as possible. In particular, we want the final, steady-state value of x(t) to be X H .

         It is instructive to calculate and graph Eq. (13-11) for a few different values of
 , assuming that the system is underdamped, 0   < 1. The step-response graphs are
shown on Fig. 13-4. If the system is undamped, c = 0, then the mass oscillates forever (in
theory) about the desired final position, x = X H ; in this ideal (with zero damping) case,
the control objective cannot be achieved.

       Figure 13-4 Base-excitation control of mass position for an m-c-k system
        However, Fig. 13-4 also demonstrates that, if there is positive damping,  > 0 ,
then the motion output x(t) does, indeed, approximate the step input, xi (t) = X H H (t) :
x(t) rises from 0, though with finite velocity, and it eventually settles at the desired final
value, x = X H .

                                                   13-5
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

         Note that the equations for step-response specifications (rise time, peak time,
maximum overshoot ratio, and settling time) derived in Section 9-8 are applicable to this
case of excitation of an m-c-k system by base motion.

         The base-excited mass-damper-spring system of Fig. 13-2 is an instructive proto-
type for output feedback control of mechanical position, which is the subject of Chapter
14. Therefore, we shall refer back to this system and to the results of Sections 13-2 and
13-3 in order to clarify and justify some of the control-system developments presented in
Chapter 14.

                                                   13-6
Chapter 13 Laplace block diagrams; background material for the study of feedback-control systems

13-4 Homework problems for Chapter 13

13.1 Consider the standard ODE (3-7) for a stable 1st order system, x& + (1 1) x = b u(t) ,
in which u(t) is the input quantity, x(t) is the output quantity, 1 is the positive time
constant, and b is a constant. Denote the Laplace transforms as L[u(t)] = U(s) and L[x(t)]
= X(s). Derive and draw for this system a Laplace block diagram with feedback, a block
diagram of the same type as Fig. 13-3. The input signal on the left side of your block
diagram is U(s), and the output signal on the right side is X(s).

13.2 With input and output voltages ei(t) and eo(t), respectively, the governing ODE for
the electrical LRC series circuit is Le&&o + R e&o + (1 C) eo = (1 C) ei (t) , as derived in
Section 9-2. Denote the Laplace transforms as L[ei(t)] = Ei(s) and L[eo(t)] = Eo(s), then
derive and draw for this system a Laplace block diagram with feedback, a block diagram
of the same type as Fig. 13-3. The input signal on the left side of your block diagram is
Ei(s), and the output signal on the right side is Eo(s).

13.3 A certain 3rd order system has excitation u(t) and response x(t), and its governing
ODE is a1&x&& + a2 &x& + a3 x& + a4 x = bu(t) , in which all ai and b are constants. Denote the
Laplace transforms as L[u(t)] = U(s) and L[x(t)] = X(s). Derive and draw for this system
a Laplace block diagram with feedback, a block diagram of the same type as Fig. 13-3,
but somewhat more complicated. The input signal on the left side of your block diagram
is U(s), and the output signal on the right side is X(s). Your block diagram should have
three feedback branches.

13.4 Consider the higher-order (4th order in this case), 2-DOF mechanical system of
homework Problems 11.2 and 12.1, for which the coupled matrix equation of motion is

m 0  &y&1   k y                        - ak y  y1   0 
 0  J &&  + - ak                       + a 2k       =  a F (t)
     H  2   y     k                          y  2 

(a) From the matrix equation, write the two separate scalar ODEs that are coupled by the
term - ak y2 in the " y1 (t) ODE" (i.e., the ODE that includes acceleration &y&1 ), and the
term - ak y y1 in the "2 (t) ODE." This system has the single input, force F (t) , but two

output quantities, translation y1 (t) of the mass, and rotation 2 (t) of the rigid bar.

(b) Denote the Laplace transforms as L[F (t)] , L[ y1(t)] = Y (s) , and L[2 (t)] = (s) .
Take the Laplace transforms of both ODEs, with zero ICs. Now, derive and draw for this
system a Laplace block diagram (in the form of Fig. 13-3, but with differences) that has
feedback and also "feed-across" between the forward-flowing branch that develops from
the y1 (t) ODE and the forward-flowing branch that develops from the 2 (t) ODE. The
input signal on the left side of your block diagram is L[F (t)] , and the two output signals

on the right side are Y (s) and (s) , one from each of the forward-flowing branches.

                  13-7
Chapter 14 Introduction to feedback control: output operations for control of rotational position

Chapter 14 Introduction to feedback control: output operations for
                         control of rotational position

                © 2016 by William L. Hallauer, Jr.

14-1 Initial definitions and terminology

         As an introduction to feedback control and related matters, this chapter considers
a common task for many engineering systems: remote (indirect) control of the rotational
position of some solid body; let's refer to this solid body generically as the rotor. The
input to a rotation-control system is typically a command issued by a human operator us-
ing a device such as a steering wheel, control column, dial, computer keyboard, etc.; the
input can also be a computer-generated signal that carries previously programmed in-
structions. The output is the rotational position of the rotor. The modifiers "remote" and
"indirect" of "control" mean that there is no direct, rigid, mechanical linkage between the
input device and the rotor; instead, for a remote control system, there might exist between
the input device and the rotor such engineering equipment as sensors, electrical circuits,
signal processors (analog and/or digital), flexible links or cables, electromagnetic or
acoustic transmitters and receivers, and actuators of many types (motors, thrusters, etc.).

         The following are a few of the many "rotors" in modern engineering practice with
which you are probably familiar: aerodynamic and hydrodynamic control surfaces, such
as rudders, elevators, and ailerons; the steering mechanisms that guide land vehicles and
taxiing airplanes; nozzles of rocket engines or vectored-thrust jet engines; any entire ve-
hicle itself, the three-dimensional rotational orientation (roll, pitch, yaw) of which is gen-
erally called the vehicle's attitude. You can probably add other rotors to this list from
your own experience.

         In general, the mass center of a solid body can have three degrees of rotational
freedom. However, in order to keep the rotational dynamics simple here and to focus on
feedback control, we will restrict our attention to rigid rotors that rotate in a plane about a
fixed point, so that there is only one degree of rotational freedom.

Consider the simple generic rotor shown in Fig. 14-1. Let's specify that it is re-

stricted to rotating about the shaft axis, that its rotation angle relative to some reference

Applied moment  Rotational  position is  (t), and that its angular velocity is
       M(t)     inertia J   p(t)  & . The rotational inertia of the rotor

                 (t), p(t)  about the axis of rotation is denoted as J, and
                            the total moment applied onto the rotor by all

                            sources is denoted as M(t). This is the physical

                            object that we wish to control; in the terminol-

                            ogy of control, the object or process to be con-

Figure 14-1 Generic rotor, the plant trolled is often called the plant.

                                          14-1
Chapter 14 Introduction to feedback control: output operations for control of rotational position

         Provided that there is no damping moment proportional to p(t) imposed upon the
rotor, the equation of motion for the plant of Fig. 14-1 is a simplified version of Eq. (3-1):

                                  J p& = J&& = M (t)                            (14-1)

Let's derive the transfer function of the plant, PTF(s), by taking the Laplace transform of
Eq. (14-1) with zero initial conditions:

          J s 2 L[ (t)] = L[M (t)]  PTF (s)  L[ (t)] = 2 1                      (14-2)
                                                         L[M (t)] J s

         In our previous work, we usually assumed that M(t) is known, and we then solved
for the resulting p(t) and/or  (t). Now, our objective is different: for control, we want to
command a desired rotor-position time history. The command usually is something like a
steering-wheel position or dial setting, or a signal carrying computer-generated instruc-
tions. In order to distinguish the input command from the output rotor angle, we intro-
duce a different symbol for the command:

          r(t)  operator setting intended to produce the desired  (t)           (14-3)

Operator setting r(t) is the reference input quantity, which is transmitted to the system by
electrical circuitry, mechanical linkages or cables, electromagnetic or acoustic waves, etc.

14-2 More definitions, and examples of open-loop control systems

        As an initial attempt to produce the desired motion history  (t), it is probably
most natural simply to seek the input setting r(t) that will do the job completely, without
the need for any further design refinement. This type of control is called open-loop con-
trol, for reasons that will be given later. Figure 14-2 depicts an open-loop control system.

Operator                          Setting                                        Disturbance
                                  voltage                                        moment Md(t)
setting  Transducer, sensitivity  signal     Actuator, sensitivity  Ma = Ka er
r (t)       Kr    volt            er = Kr r                                                  (t)
                 unit setting                       torque 
                                             Ka                                 J
                                                    volt 

Figure 14-2 Functional diagram of open-loop rotor-position control system

         Operator setting r(t) is shown in Fig. 14-2 as a general quantity, and the input
transducer is assumed to be a general linear device that produces voltage signal er(t) =
Kr r(t); if the input device were a rotary dial, for example, the operator setting might be a
rotational position in degrees, and the transducer might be a variable resistor in a voltage
divider circuit (see homework Problems 5.1 and 5.9), with accurately calibrated sensi-
tivity of Kr volts per degree. The actuator also is assumed to be a general linear device

                                             14-2
Chapter 14 Introduction to feedback control: output operations for control of rotational position

that produces control moment Ma(t) = Ka er(t) = Ka Kr r(t); if it were an electromagnetic
actuator, for example, it would probably consist of a power amplifier and a motor, both of
which are designed to function linearly. In practice, device sensitivity constants do not
have to be positive and often are negative, but let's assume here that all are positive (Ka >
0, Kr > 0, etc.) just to avoid unnecessary complications.

         Also shown on Fig. 14-2 is disturbance moment Md(t) acting upon the rotor. In
the terminology of control, a disturbance is some extraneous action upon the plant, not
the intended control action. In the system of Fig. 14-2, for example, an actuator moment
produced by unwanted electrical noise in the circuitry would be an internal disturbance,
and a moment produced by wind or impact from solid objects onto the rotor would be an
external disturbance. Disturbances are often random, or at least unpredictable, so that we
usually cannot write equations to describe their variation with time. In most cases, dis-
turbances tend to influence adversely the performance of a control system.

         Let's analyze the control system of Fig. 14-2. The total moment acting upon the
rotor is Ma(t) + Md(t), so that Eq. (14-1) becomes

J&& = M a (t) + M d (t) = K a K r r(t) + M d (t)                        (14-4)

Disturbance Md(t) in Eq. (14-4) is the nemesis of open-loop control, so let's consider ini-
tially the case with zero disturbance, Md(t) = 0. If we have an equation for the desired
motion history  (t), then we can solve (14-4) directly for the required operator setting:

                            r(t) = J &&                                 (14-5)
                                   Ka Kr

This method for finding r(t) is easy, and open-loop control appears to be a feasible en-
gineering tool. However, open-loop control has some serious deficiencies. A more de-
tailed example will help to reveal these deficiencies, so we consider next an application
of open-loop attitude control for a spacecraft.

Suppose that a capsule carrying astronauts is re-entering Earth's atmosphere, Fig.

14-3, and that pitch angle (t) must be controlled in order to position the heat shield for

optimal functioning and to prevent unstable tumbling.      fy(t)     e
Two collinear pairs of gas thrusters (usually fueled by

liquid chemicals) are separated by moment arm e so

that they actuate rotation by a couple (pure moment),             C

without causing mass center C to translate. Firing of (t)

the two thrusters shown active on Fig. 14-3 produces a                  fy(t)

positive couple, and firing of the two opposite collinear

thrusters would produce a negative couple. To simplify Figure 14-3 Pitch control of
the analysis, let's assume that the thrusters are continu- a re-entry capsule
ously throttleable, so that thrust force is related linearly

to the operator setting by

                            14-3
Chapter 14 Introduction to feedback control: output operations for control of rotational position

                           f y (t) = K r(t)                                  (14-6)

In Eq. (14-6), K is a positive sensitivity constant, with appropriate dimensions depending
upon the specific character of r(t). Then the control moment is Ma(t) = e fy(t) = e K r(t), so
that the equation of motion equivalent to Eq. (14-4) is

              J&& = M a (t) + M d (t) =e K r(t) + M d (t)                    (14-7)

in which J is the capsule's rotational inertia about mass center C. If we neglect all
possible disturbances, Md(t) = 0, then we can solve Eq. (14-7) for the required operator
setting in terms of the desired pitching maneuver:

                           r(t) = J &&                                       (14-8)
                                   eK

         For example, let's require that           rA
the spacecraft rotate smoothly from 
= 0 to final pitch angle  =  f during tf   r (t) 0
seconds, according to the lower time              -rA

history graphed on Fig. 14-4, which is             f
expressed by the equation1                  (t)

 f   1  2                                          0 0 ¼tf ½tf ¾tf tf
 (t) =  t - sin t  (14-9)                                             time t
 t f  2    t     
              f                           Figure 14-4 Example operator setting and
                                          resulting pitch maneuver for re-entry capsule
for 0  t  t f . Differentiating Eq. (14-

9) twice and then substituting the re-
sult into Eq. (14-8) leads to

                    2                     rA  2 2 J f , for 0  t  t f
         r(t) = rA sin t  ,                     eKtf                         (14-10)
                     t     
                        f  

This reference input setting r(t) is shown on the upper graph of Fig. 14-4.

         Note that Eqs. (14-9) and (14-10) and Fig. 14-4 illustrate the impulse-momentum
theorem for 1-DOF rotation, which is directly analogous to the impulse-momentum theo-
rem for 1-DOF translation (Section 8-2). The control moment is proportional to r(t),
Ma(t) = e K r(t), so the r(t) time history shows that the total moment impulse (area under
the moment curve) in this maneuver is zero; since the total impulse is zero, the final (t 

1 Maneuver time history Eq. (14-9) comes from Sarafin, 1995, pages 644-645, a book that includes addi-
tional interesting discussions of spacecraft attitude control.

                                          14-4
  Chapter 14 Introduction to feedback control: output operations for control of rotational position

tf) angular momentum also is zero, J& = 0 , so the spacecraft is rotated to the final
position  =  f with zero final rotational velocity, & = 0 .

         Let's pause for a reality check. One feature of the control equipment described
for this spacecraft maneuver is not practically realistic: space qualified gas thrusters in
common use are nonlinear on-off (approximately) force generators; they are not continu-
ously throttleable as assumed in this example, Eq. (14-6). Gas thrusters are, in fact, used
to actuate spacecraft attitude and position control, but their on-off character produces
rougher motion (abrupt changes in acceleration) than that of Eq. (14-9); see Sarafin,
1995, pp. 636-637. A smooth maneuver such as Eq. (14-9) would be actuated in practice
by a space-qualified reaction wheel or control-moment gyroscope. We have assumed the
hypothetical throttleable gas thrusters for this example just because it is easy to visualize
this situation and to describe it in equations.

         Now, with reference to the example above of spacecraft attitude control, let's
evaluate open-loop control as represented generally by Fig. 14-2, with particular interest
in identifying the following deficiencies:

1. Note from Fig. 14-4 that output  (t) is not a single-valued, monotonic function of op-
erator setting r(t). For example, to r = 0 there correspond three different output values: 
= 0 before the maneuver,  = ½f during the maneuver, and  = f after the maneuver.
This type of complicated functional relationship is not necessarily an operational defi-
ciency, but it certainly is counter-intuitive to the natural engineering expectation of a
unique, monotonic, often linear relationship between cause and effect.

2. Equations (14-5), (14-8), and (14-10) show that the validity of derived operator setting
r(t) is directly dependent upon the accuracy of the plant parameters and control system
sensitivities, and upon the fidelity of the theoretical model of the system. If, for example,
we use an inaccurate value of rotational inertia J (a distinct possibility for most vehicles,
since burning of fuel changes inertias), or if the thrusters fail to function exactly as we
model them, then the derived r(t) clearly will not lead to the exact desired rotation time
history,  (t).

3. The r (t) equations (14-5) and (14-8) are predicated on the absence of disturbances; but
if Md(t)  0, then the derived r (t) will fail to produce the exact desired  (t) . In practice,
unpredictable disturbances are common, and they should not be ignored. For example,
moments that can act upon a re-entering spacecraft might be produced by atmospheric
drag, impact from space debris, astronauts shifting position within the vehicle, etc.

Deficiencies 2 and 3 above can be described in a more general manner: the performance
of an open-loop control system is strongly dependent upon the quality of the theoretical
model of the system and its environment; in other words, the control performance is

                                                   14-5
Chapter 14 Introduction to feedback control: output operations for control of rotational position

highly sensitive to imperfections in the theoretical model, which are inevitable for most
real engineering situations.2

         It is a fundamental characteristic and weakness of open-loop control that the ac-
tual output is not measured and compared with the desired output, for the purposes of as-
sessing the output error and attempting to reduce the error. A simple and natural remedy
for this weakness is to "close the loop" with feedback, which is described in the next sec-
tion. Note that the absence of a feedback branch from Fig. 14-2 leads to the designation
"open-loop." But even this designation is at least a little misleading because there is no
"loop" at all; there is simply a single branch that carries forward-flowing signals!

14-3 Closed-loop control of rotor position using position feedback

         Let's modify the open-loop control system of Fig. 14-2 in the following manner:
measure the output with a rotational-position sensor, and send the voltage output from
this sensor back to a summing junction that forms the error signal, which is the differ-
ence between the signal representing the operator setting and the signal representing the
actual output. The feedback branch and summing junction convert the open-loop system
into the closed-loop system depicted on Fig. 14-5.

                                                                           Disturbance

Operator                             Error signal                           moment Md(t)
                                                                                        (t)
setting                              ee =
                                                                           J
r (t)     Transducer      er = Kr r  er - e Actuator           Ma = Ka ee

         Kr    volt                                 torque 
                                             Ka        
           unit setting                             volt 

                                             Position sensor
                                     e = K          volt   (t)

                                                   K  angle  

          Figure 14-5 Functional diagram of position-feedback control system

         The elements of the closed-loop system are the same as those of the open-loop
system, Fig. 14-2, but with the addition of the output sensor and the summing junction
(defined in Section 13-2). We assume that the sensor is a device such as an optical en-
coder, with accurately calibrated positive sensitivity K (volt per degree or radian). The
summing junction could be a simple circuit consisting of an inverting amplifier (Fig. 5-8)
and a summing inverting amplifier (homework Problem 5.7).

         This closed-loop system tends to be self-correcting. We can understand this ten-
dency by writing in detail the equation for the control moment, from the signals labeled
on Fig. 14-5:

2 In the language of control engineering, a control system is described as robust if its performance and sta-
bility are insensitive to potentially detrimental influences such as disturbances, deficiencies in the theoreti-
cal model of the plant, and inaccurate response measurements due to sensor dynamics.

                                     14-6
Chapter 14 Introduction to feedback control: output operations for control of rotational position

M a (t) = K a ee (t) = K a [er (t) - e (t)] = K a [K r r(t) - K (t)]             (14-11)

From Eq. (14-11), the control moment is zero when Kr r(t) - K (t) = 0 , so that

 (t) = K r r(t)                                                                  (14-12)
        K

Equation (14-12) clearly is the desired instantaneous linear relation of output  (t) to input
r(t). At instants when (14-12) is not satisfied, the control actuator imposes a corrective
moment. Suppose, for example, that at a certain instant both  (t) and r(t) are positive,
but that the output is less than the desired value,  (t) < [K r K ]r(t) ; at this instant, then,
the error signal is K r r(t) - K (t) = ee (t) > 0 , and M a (t) = K aee (t) > 0 ; thus, when the

output is less than it ought to be, the closed-loop control system imposes a positive mo-
ment to increase the output. Moreover, by reversing the inequality signs above, you can
show that the control system imposes a negative moment to decrease the output when the
output is greater than it ought to be.

         Because the corrective moment is proportional to the output error and is inde-
pendent of the theoretical model, the self-correcting tendency of this closed-loop control
system is in effect regardless of how well the theoretical model represents the system and
its environment.

         To infer more information about the closed-loop system of Fig. 14-5, let's derive
the ODE of motion by substituting Eq. (14-11) into Eq. (14-4):

J&& = M a (t) + M d (t) = K a [K r r(t) - K (t)]+ M d (t)

 J&& + K a K = K a K r r(t) + M d (t)                                            (14-13)

From Eq. (14-13), we make the following observations: (1) the feedback control in Fig.
14-5 has the effect of attaching between the operator setting and the rotor inertia an artifi-
cial restoring spring with stiffness constant Ka K ; (2) if only operator input r(t) acts, i.e.,
if Md(t) = 0, then the desired output (14-12) is actually the pseudo-static response of the
system (as defined in Section 7-1),

K a K ps = K a K r r(t)   ps (t) = K r r(t)                                      (14-14)
                                             K

(3) if only operator input r(t) acts, and if the input-transducer sensitivity equals the out-

put-sensor sensitivity, Kr = K , then the closed-loop system is directly analogous to an
undamped, base-excited mass-spring system [as described by Eq. (13-6) with c = 0]; (4)
the self-correcting tendency even counteracts the adverse influence of many types of

14-7
Chapter 14 Introduction to feedback control: output operations for control of rotational position

disturbance, which we can conclude from our previous experience with forced-response
solutions for 2nd order systems. If, for example, the disturbance is time-limited, such as a
pulse, then post-pulse response due to the pulse will oscillate about zero but will not
contain any constant steady-state component. If, for another example, the disturbance is
sinusoidal, then the resulting response will oscillate about zero but will not contain any
constant steady-state component; however, we can also see that if the frequency of the
sinusoidal disturbance is in the neighborhood of the closed-loop system natural fre-

quency, n = K a K J , then the disturbance could produce resonance, which this par-

ticular control system could not prevent.

To establish the method for analysis later of more complicated control systems,

let's draw and analyze the Laplace block diagram corresponding to functional diagram

Fig. 14-5. For this task, we define the following Laplace transforms: L[r(t)]  R(s),

L[ (t)]  (s), L[er(t)]  Er(s), L[e(t)]  E(s), L[ee(t)]  Ee(s), L[Ma(t)]  Ma(s),

L[Md(t)]  Md(s), and L[M(t)]  M(s). The Laplace block diagram, Fig. 14-6, is similar to

the functional diagram,

except that we replace                                      d(s)

the rotor in Fig. 14-5                                                (s) 1 (s)
with its transfer func- R(s) Er(s) Ee(s) a(s)
                          Kr            + _           Ka           +                    2
tion, PTF(s) of Eq. (14-                                                    Js

2), and we use a sum-                                 E(s)            (s)
ming junction to denote
                                                            K

the actions upon the ro- Figure 14-6 Laplace block diagram, including disturbance
tor of both control mo- input, of position-feedback control system
ment Ma(t) and distur-

bance moment Md(t).

This system actually has two independent inputs, r(t) and Md(t), so it is not strictly

a single-input-single-output (SISO) system. However, the most important fundamental

relationship for this control system is that between the reference input and output  (t), so

we now will focus on that relation-                   Er(s) Ee(s)     a(s) 1 (s)
                                                R(s)
Md(s) = 0, and we re-draw Fig. 14-6 ship by setting Md(t) = 0. Therefore, Kr + _ Ka J s2

as the SISO block diagram at right,                         E(s)            (s)
with the objective of deriving from
                                                                      K

it the closed-loop transfer function,  Figure 14-7 Laplace block diagram of SISO
CLTF (s)  (s) R(s) .                   position-feedback control system

         Three distinct steps of block-diagram algebra are required to reduce Fig. 14-7 to a
single block, the CLTF (s) , that separates input and output signals:

1. Combine (multiply) the two block R(s) E K r(s) Ee(s r + _                Ka (s)
transfer functions within the forward                                       J s2

branch of the loop, as shown at right.                                E(s)       (s)

                                                                            K

                                                            Figure 14-7a

                                        14-8
Chapter 14 Introduction to feedback control: output operations for control of rotational position

This multiplication operation is derived in Section 13-1.

2. Resolve the forward-branch and feedback-                                      (s)

branch transfer functions of the closed loop into R(s)     Kr                Ka

the single equivalent transfer function shown at               J s2 + Ka K

right. The block-diagram algebra used in this step

is derived in the next section; it is an important basic tool for the analysis of control

systems.

3. Finally, and obviously, just multiply the re-    2 R(s) Kr Ka  CLTF (s) (s)
maining two blocks to produce the required re-             J s + Ka K
sult shown at right.

         For this relatively simple system, the SISO version of ODE of motion (14-13) is
J&& + Ka K = Ka Kr r(t) . It is very easy to derive the same CLTF(s) directly from this

ODE, but we have derived CLTF(s) here using block-diagram algebra in order to estab-
lish the approach that is appropriate for more complicated systems.

         We shall re-visit this position-feedback control system in Section 14-5, with the
objectives of evaluating its control performance and then developing an addition to the
system that will improve the performance.

14-4 Transfer function of a single closed loop

Consider Figure 14-8, which is a more general version, in standard notation, of

the closed loop in Fig. 14-7a. General functions G(s) and H(s) are, respectively, the for-

                                   ward-branch and feedback-branch transfer func-

In(s) E(s)                Out(s) tions. E(s) is the actuating error signal, and B(s)

            G(s)                   is the feedback signal. We seek the closed-loop

          B(s)                     transfer function, the ratio Out(s) In(s) . All of
                    H(s)           the quantities labeled on Fig. 14-8 are denoted

Figure 14-8 Laplace block diagram  as functions of Laplace variable s, but it is im-
of general closed loop             portant to recognize that there are two funda-
                                   mentally different types of functions: (1) the

"signals" In(s), E(s), B(s), and Out(s), which actually are Laplace transforms of time-

dependent variables such as motion and voltage; and (2) the transfer functions G(s) and

H(s), which represent in the Laplace domain the characteristics of systems and objects

such as inertias, actuators, and circuits. To emphasize the difference in the following

derivation of Out(s) In(s) , let's omit the functional notation "(s)" from the signals, at

least in the intermediate steps. The steps follow naturally from Fig. 14-8:

          E = In - B and B = Out × H (s),

           Out = E × G(s) = [In - B]× G(s) = [In - Out × H (s)]× G(s)
                     = In × G(s) - Out × H (s) × G(s)

                                   14-9
Chapter 14 Introduction to feedback control: output operations for control of rotational position

                            Out ×[1 + G(s)H (s)] = In × G(s)

                            Out(s) = G(s)                       (14-15)
                                  In(s) 1 + G(s)H (s)

Equation (14-15) is an important, general, labor-saving tool for analysis of loops

in any control system, not just the systems discussed in this chapter. To illustrate its ap-

plication, let's use it to derive in detail the loop transfer function written in Step 2 of the

block-diagram algebra of Section 14-3. From Step 1 of that process (or from Fig. 14-7a),

we identify: G(s) = Ka J s 2 and H (s) = K . Substituting these into Eq. (14-15) gives

Out(s) =  Ka Js2           = 2 Ka           , which is the loop transfer function shown in

                        2
In(s) 1 + (K a J s )K J s + K a K

the block diagram as the result of Step 2.

         A transfer function in Eq. (14-15) often has the form of a ratio of polynomials in
s, such as G(s) in the previous paragraph, so it is useful to derive a version of (14-15) in
terms of the polynomials. First, we define numerator and denominator polynomials that
make up G(s) and H(s):

                           G(s)  NG (s) and H (s)  N H (s)      (14-16)
                           DG (s)                  DH (s)

Next, we carry out the algebra of Eq. (14-15), dropping the functional notation "(s)" from
the transfer functions and polynomials in the interest of notational conciseness:

          Out(s) = G =             NG DG           = NG DH      (14-17)

          In(s) 1 + GH 1 + (NG DG ) × (N H DH ) DG DH + NG N H

For the example of the previous paragraph, the simple polynomials are NG = Ka , DG =
J s 2 , N H = K , and DH = 1; substituting these terms into Eq. (14-17) obviously leads to
the Out(s) In(s) result derived in the previous paragraph, but with a bit less algebra be-
cause the algebra has been completed in (14-17). Equation (14-17) expresses the closed-
loop transfer function as a ratio of polynomials, and it applies in general, not just to the
problems of this chapter.

         Finally, we will use later an even more specialized form of Eqs. (14-15) and (14-
17) for the case of unity feedback, H(s) = 1 = 1/1:

                           Out(s) = G = NG                      (14-18)
                            In(s) 1 + G DG + NG

                                            14-10
Chapter 14 Introduction to feedback control: output operations for control of rotational position

         Equations (14-15), (14-17), and (14-18) are very useful for the analysis of feed-
back control. In the future, whenever you encounter a simple loop with the form of Fig.
14-8 in the Laplace block diagram of a system, you may (and usually should) apply
whichever of these equations is most appropriate to derive the loop transfer function,
without repeating the algebra that goes into the derivation of these equations.

14-5 Closed-loop control of rotor position using position feedback plus rate feed-
back

         Let's re-visit the position-feedback control system of Section 14-3 in order, first,
to evaluate its control performance and, next, to develop an addition to the system that
will improve the performance.

         It is easy to evaluate the control performance just by considering the SISO version
of ODE of motion (14-13), which is

J&& + K a K  = K a K r r(t)                                                     (14-19)

As was noted earlier, the pseudo-static response of Eq. (14-19) is  ps (t) = [Kr K ]r(t) ;

this would be good controlled response, but it is not necessarily the total response.

Therefore, let's consider in more detail the total transient response. Equation (14-19) is
an undamped 2nd order ODE of the type analyzed extensively in Chapter 7. By dividing

(14-19) through by J and then defining appropriate parameters, we can adapt this ODE to
the standard form (7-5), && + n 2 = n 2 u(t) , in which the natural frequency is n =

Ka K J , and the standard input quantity is u(t) = [K r K ]r(t) . We can also adapt

any appropriate response solutions already derived in Chapters 7 and 8 to this position-
feedback control system. For example, if the operator setting is the step function r(t) =

RH H (t) , then u(t) = [Kr K ]RH H (t)  U H (t) , so the standard solution (7-14) leads
to step response  (t) = (Kr K )RH (1 - cosnt) . This step response is plotted on the

figure at right, with the period defined as    (t) 2 Kr K      Tn          2Tn  3Tn
Tn = 2 n . Due to the absence of              R K H r K

damping, the response oscillates forever                  0 0
about the desired constant pseudo-static
response,  ps = (K r K )RH . The re-                               Time t

sponse never settles at  ps , so the control

system fails to deliver the desired performance.

         We must conclude from this example that the absence of damping renders the
position-feedback control system of Section 14-3 (Fig. 14-5) unsuitable for most, if not
all engineering applications of control. However, there is a relatively simple design fea-
ture that can be added to the control system, a feature that will provide damping to the
system and will greatly improve the control performance.

14-11
Chapter 14 Introduction to feedback control: output operations for control of rotational position

Xi(s)  k       + _        1 sX(s) 1 X(s)                  In order to describe the
                                                 motivation for this new feature
          + _             ms        s            of the control design, let's re-
                                                 visit the base-excited m-c-k
                          c                      system of Sections 13-2 and 13-
                                                 3. The principal elements of
                                        k        Fig. 13-3, that system's Laplace
                                                 block diagram, are reproduced
Figure 14-9 Laplace block diagram with feedback  on Fig. 14-9. The inner feed-
branches for a base-excited m-c-k system         back loop makes Fig. 14-9 more
                                                 complicated than any control
Xi(s)                     1            X(s)      system block diagram that we
        k +_                                     have encountered previously in
                          ms2                    this chapter. Consider, however,
                                                 the case of zero damping, c = 0,
                                      k          for which the system is an
                                                 undamped, base-excited mass-
Figure 14-10 Laplace block diagram with          spring (m-k) system, and Fig. 14-
feedback branch for a base-excited m-k system

                                                 9 loses the inner feedback loop,

R(s)      Er(s) Ee(s) Ka            (s) taking on the simpler ap-
          Kr + _ J s2                           pearance of Fig. 14-10. Now,

                    E(s)       (s)               let's compare the Laplace block
                                                 diagram of the base-excited m-k
                          K

Figure 14-7a (repeated) Laplace block diagram    system with that of the rotor
of SISO position-feedback control system         position-feedback control sys-
                                                 tem, Fig. 14-7a, which is re-

peated here. The Laplace block diagrams of the two systems have nearly identical forms,

with, for example, constants Kr and Ka J in Fig. 14-7a being directly analogous,

respectively, to constants k and 1 m in Fig. 14-10. Only the possibility on Fig. 14-7a that

input block constant Kr and feedback block constant K can be different keeps Fig. 14-7a
from being completely analogous to Fig. 14-10. This is a minor difference that has no
substantive effect in the following discussion.

         Let's exploit the similarities between the base-excited m-c-k system and the rotor-
position control system in order to guide us toward a method for improving the latter.
First, we refer back to the solution in Section 13-3 for response of the base-excited m-c-k
system to step input xi (t) = X H H (t) . The step response is presented graphically on Fig.

13-4, which is repeated on the next page for your convenience.

        Recall the following definitions for the m-c-k system: n = k m , Tn = 2 n ,

and  = c (2 mk ). Note on Fig. 13-4 that the addition of positive damping (c > 0 

 > 0) to the undamped system produces output x(t) that approximates the input; there-
fore, the positively damped m-c-k system is, indeed, a suitable control system, whereas
the undamped m-k system is not.

                               14-12
Chapter 14 Introduction to feedback control: output operations for control of rotational position

Figure 13-4 (repeated) Base-excitation control of mass position for an m-c-k system

         Can we modify the undamped rotor-position control system in such a way that it
has the same type of positive damping, and therefore suitable control performance, as the
m-c-k system? Block diagram Fig. 14-9 for the positively damped m-c-k system suggests
that we might improve the rotor-position control system by adding an inner feedback
loop to its block diagram, Fig. 14-7a, a loop that is similar to the inner loop of Fig. 14-9.
But are there practical physical operations and devices corresponding to the purely
mathematical addition of this type of loop to Laplace block diagram Fig. 14-7a? To an-
swer this question, let's observe that the Laplace feedback signal of the inner loop on Fig.
14-9 is sX(s), which is the Laplace transform of velocity x&(t) . Therefore, the inner loop
on Fig. 14-9 represents mathematically the physical operations of detecting the output
velocity and multiplying that velocity by negative constant -c to create a damping force
that opposes motion of mass m. We can perform the analogous physical operation for the
rotor-position control system by measuring output rotational velocity p(t)  &(t) with an

appropriate sensor (such as a rate gyroscope) and feeding that signal negatively back to
the input of the actuator. Figure 14-11 depicts the modified rotor-position control sys-
tem, with both this rate feedback (to provide positive damping) and the original position
feedback (to provide positive stiffness).

Operator                                                                             Disturbance
                                                                                     moment Md(t)

setting   Transducer                         er - e - ep Actuator

r (t)                     er = Kr r  er - e                               Ma         p(t)  (t)
                                                                                  J
         Kr    volt                                      torque 
                                                        Ka           
           unit setting                                  volt 

                                             ep = Kp p  Rate sensor
                                                              volt  p(t)
                                                        Kp  
                                                              rate 

                                             e = K      Position sensor
                                                           volt   (t)
                                                        K          
                                                           angle 

Figure 14-11 Functional diagram of rotor-position control system with both position feed-
back and rate feedback

                                             14-13
Chapter 14 Introduction to feedback control: output operations for control of rotational position

         Figure 14-12 is the Laplace block diagram corresponding to functional diagram
Fig. 14-11. For measuring and feeding back the rotational velocity, the appropriate form
of plant ODE of motion (14-1) is J p& = M (t) , so the appropriate plant transfer function in
the new inner loop is L[p(t)] / L[M(t)]  P(s) / M(s) = 1 / (Js). Also, the definition of
rotational velocity &(t)  p(t) leads to the forward-branch integration transfer function,

(s) / P(s) = 1 / s. Comparing Fig. 14-12 with Fig. 14-9 for the base-excited m-c-k system,
we see that the two Laplace block diagrams have nearly identical forms, except for the
presence of the disturbance moment on Fig. 14-12. Thus, and to summarize, we have
modified the rotor-position control system to add positive damping, using the base-
excited m-c-k system as a model.

                      d(s)

R(s)              Ka  a(s)          (s) 1 P(s) = s(s) 1 (s)
      Kr + _ + _
                            +           Js     s

                  Kp s(s)
                                Kp

                   K (s)
                                K

Figure 14-12 Laplace block diagram of rotor-position control system
with both position feedback and rate feedback

         The position-feedback and rate-feedback types of control illustrated by Figs. 14-
11 and 14-12 are relatively simple output operations: this control involves no more than
basic arithmetic operations on the sensed output signals, without any modification of the
error signal in the forward branch. Chapter 15 introduces control by input error oper-
ations, which involves more general mathematical operations upon a single error signal.

         Next, let's analyze in detail the SISO version of the modified rotor-position con-
trol system. Thus, we set Md(t) = 0 and Md(s) = 0, and we re-draw Fig. 14-12 as SISO
block diagram Fig. 14-13. Our objectives are: first, to derive from Fig. 14-13 the closed-
loop transfer function, CLTF (s)  (s) R(s) ; second, to infer from CLTF(s) the charac-

teristics of the SISO system.

R(s)                  Ka  a(s) 1 P(s) = s(s) 1 (s)
      Kr + _ + _
                                    Js      s

                      Kp s(s)
                                    Kp

                       K (s)
                                    K

Figure 14-13 Laplace block diagram of SISO rotor-position
control system with both position feedback and rate feedback

                          14-14
Chapter 14 Introduction to feedback control: output operations for control of rotational position

We could resolve block diagram Fig. 14-13 by the "brute-force" method of apply-

ing Eq. (14-17) first to the inner loop, then to the outer loop. However, we can achieve

the same result more simply by using some sensible block-diagram algebra. The ap-

proach in each step is to modify a block and/or branch so as to simplify the diagram

without changing the most important output signals. The obvious first step, is to combine

the two blocks in the forward branch of the inner loop on Fig. 14-13 into transfer function

Ka / (Js). Next, we move the branch point of the inner loop to the right of the integration

block, and modify accord-       R(s)            Kr R - (K + Kp s)             1 (s)
ingly the feedback transfer           Kr                                  Ka  s
function of the inner loop, as
shown at right. Next, we                  +_ +_ Js

multiply the two blocks of                       Kp s(s)
                                                               Kp s
the forward branch inside the
                                                  K (s)
loops into transfer function                                   K
Ka / (Js2). Now, both feed-

back branches essentially originate at the same branch point and terminate at the same

summing junction, so we combine     R(s)              Kr R - (K + Kp s)  Ka (s)
them into a single feedback branch        Kr     +_ J s2
with an appropriate transfer

function, as shown at right. This                (Kp s + K) (s)
block diagram has only a single                                       Kp s + K
loop, so we can apply Eq. (14-17)

with the following transfer-function polynomials: NG = Ka, DG = Js2, NH = Kps + K, and

DH = 1. The result is:

NG DH                   =2          Ka ×1        = 2 Ka
DG DH + NG N H J s ×1 + K a × (K p s + K ) J s + K a K p s + K a K

Finally, multiplying this loop transfer function by the input transducer sensitivity gives

                        CLTF (s)  (s) = 2 K r K a                               (14-20)
                                      R(s) J s + Ka K ps + Ka K

         Let's cast system transfer function (14-20) into a form that displays more clearly
the fundamental characteristics of the closed-loop system. We again use as a guide the
base-excited m-c-k system of Section 13-2. The undamped natural frequency of that sys-

tem is n = k m , and the viscous damping ratio is  = c (2 mk ). Using these defini-

tions, we can express transfer function (13-8) in terms of these fundamental system char-
acteristics rather than the physical parameters m, c, and k:

TF (s)  X (s) = 2 k                 = 2 km       = n2                         2 (14-21)

                                                         2
X i (s) m s + c s + k s + (c m) s + k m s + 2 n s + n

                                          14-15
Chapter 14 Introduction to feedback control: output operations for control of rotational position

Manipulating (14-20) in a similar manner, with an additional step to account for the pos-
sibility that Kr  K , gives:

CLTF (s)  (s) = K r × 2  Ka K J                    = Kr × n2                      2 (14-22)

                                                                      2
R(s) K s + (K a K p J )s + K a K J K s + 2n s + n

In Eq. (14-22) the undamped natural frequency and viscous damping ratio of the rotor-
position control system are

n =                      Ka K               and  = K a K p                        (14-23)
                           J                              2 J n

Equation (14-22) differs in form from Eq. (14-21) only in the presence of pseudo-static
multiplier K r K , which is defined in Eq. (14-14).

         The system with transfer function (14-21) behaves as a control system should: in
this case, as a positively damped, 2nd order system. For example, if the parameters in Eq.

(14-22) are selected such that  is in the range 0.3 to 0.5, and if the operator setting is

step function r(t) = RH H (t) , then the     (t) 2 Kr K          Tn          2Tn  3Tn
inverse Laplace transform developed in      R K H r K
homework Problem 9.12 gives the type
of step response shown on the figure at                 0 0
right. The output cannot exactly follow
this infinitely fast input, but it rises                             Time t
quickly and settles quickly to the desired

pseudo-static response. This example illustrates a general characteristic of control sys-

tems: it is generally impossible to achieve absolute accuracy instantly (in this case, the

pseudo-static response), but a good control system can achieve practically acceptable ac-

curacy, with a practically acceptable time lag between the input and the desired output.

         It was observed earlier that position feedback through the sensor with gain K has
the effect of attaching between the operator setting and the rotor inertia an artificial re-
storing spring with stiffness constant Ka K . We see now, additionally, that rate feedback
through the sensor with gain Kp has the effect of imposing upon the absolute motion of
the rotor an artificial viscous damper with damping constant Ka Kp .

         Finally, let's note that the favorable and stable performance of this rotor-position
control system is strongly dependent upon the positivity of constants Ka K and Ka Kp . In
practice, it is possible (in fact, too easy) to make these constants negative, usually by
accident or negligence, which could cause the system to be unstable. Chapters 16 and 17
examine in more detail the important issue of system stability.

                                            14-16
Chapter 14 Introduction to feedback control: output operations for control of rotational position

14-6 Comments regarding classical control theory and modern control theory

         In the words of Brogan, 1974, page 1, "Control theory can be divided into two
major categories, classical and modern." Chapters 14-17 of this book constitute an intro-
duction to the former, namely, classical control theory for linear, time-invariant (LTI)
systems. Whereas classical control theory focuses on relatively simple single-input-sin-
gle-output (SISO) systems, modern control theory, which is based upon the state-space
mathematical representation of systems, is very well suited for design and analysis of
control for both simple systems and much more complicated multiple-input-multiple-out-
put (MIMO) systems.3

         The state-space representation of systems is a generalization of the standard 1st
order ODE Eq. (1-1), x& - ax = bu(t) , which has only the single input u(t) and the single
dependent variable x(t). In the generalization to an LTI-MIMO system of, say, r inputs
and n dependent variables, scalar x(t) becomes the n × 1 state vector (column matrix) x(t)
of dependent variables, scalar u(t) becomes the r × 1 vector of inputs u(t), single constant
a becomes the n × n matrix A of system constants, single constant b becomes the n × r
matrix B of input constants, and single ODE x& - ax = bu(t) becomes the system of n cou-
pled 1st order ODEs written in matrix form, x& - Ax = Bu(t) . All of the 2nd order systems
analyzed in this book can be expressed in state-space form with x(t) being 2 × 1 state
vectors; for example, the two scalar Eqs. (1-15) can clearly be written as the following
single matrix ODE:

x&  0  1 x  0 
 -       =   f x (t)
v& - k m - c mv 1 m

Further, the 2-DOF systems of Chapters 11 and 12 can be expressed in state-space form
with x(t) being 4 × 1 state vectors.

         Chapters 14-17 of this book should provide adequate preparation for study of the
fundamental aspects of modern control theory. Three appropriate textbooks, among the
many available, are Brogan, 1974, Franklin, et al., 1991, and Ogata, 2001.

3 Franklin, et al., 1991, page 361, wrote that the adjective "modern" is misleading "... since the state-space
method of description for differential equations is over 100 years old and was introduced to control design
in the late 1950s, ... ." Those authors prefer the designations "transform methods" rather than "classical
control" and "state-space methods" rather than "modern control".

                                                  14-17
Chapter 14 Introduction to feedback control: output operations for control of rotational position

14-7 Homework problems for Chapter 14

14.1 In Section 14-3 for the rotor-position control system with position feedback, the

transfer function relating output rotor position to input operator setting, with zero

disturbance, is derived by a series of block-diagram algebraic operations to resolve

(simplify) Fig. 14-7. In practice, for assessment of control system quality, it is often

required also to determine the transfer function that relates output rotor position to the

disturbance, with zero operator setting. The appropriate block diagram for that task in

                                                 this case comes from Fig. 14-6, with R(s)

                d(s)                             = 0, as shown at left. Derive from this

             a(s)        (s) 1 (s)               block diagram the transfer function
                                Js 2
+ _      Ka        +                             (s) = 2 1          . This task is not

M(s) ×1  K (s)           (s)                     Md (s) J s + Ka K

                K                                difficult: just write Ma(s) in terms of

                                                 (s), then M(s) = Ma(s) + Md(s), and

         J s 2 = (s) , which steps should lead  you to the required result. This result can

also be derived directly from the ODE of motion (14-13), but the assignment here is to

derive it from the block diagram, to give you practice with block-diagram algebra.

14.2 In some systems, information is fed forward as well as backward. Each of the La-
place block diagrams (a) and (b) shown below includes both a feedforward branch and a
unity-feedback branch. Transfer functions F(s) and G(s) represent arbitrary plant, filter,
sensor, etc. system elements. (We could also include a transfer-function block in the
unity-feedback branch, but its value would be simply 1, so it is standard practice to omit
that obvious block.) For the part(s) assigned, derive the algebraic equation for the system
transfer function, X (s) R(s) , in terms of F(s) and G(s).

(a)                                 X(s)         (b)          F (s)
                   F(s)                                       G(s) + X(s)
                              +                  R(s)
R(s)
            +_ G(s)                                       +_

(c) The idealized series damper-spring high-pass mechanical filter shown in Fig. 3-12
has the governing ODE with right-hand-side (RHS) dynamics, x&o + (1 1 )xo = x&i (t) , Eq.
(3-24). The transfer function from this ODE is clearly Xo(s) / Xi(s) = s / (s + 1 / 1), where
L[xi(t)]  Xi(s) and L[xo(t)]  Xo(s). With the definition of a new independent variable
xd(t) and the auxiliary equation xo(t) = xd(t) + xi(t), the ODE is converted into an alternate
form without RHS dynamics, x&d + (1 1)xd = -(1 1 )xi (t) , Eq. (3-26). Construct a La-

place block diagram using the alternate ODE and the auxiliary equation; this diagram
should have input Xi(s) on the left and output Xo(s) on the right, and it should include a
feedforward branch. Use block-diagram algebra on this diagram to derive again the sys-
tem transfer function Xo(s) / Xi(s) = s / (s + 1 / 1).

                                          14-18
Chapter 14 Introduction to feedback control: output operations for control of rotational position

14.3 Consider a system represented by the     somewhat general  Laplace  block diagram at
                                                                G1(s)
the right. Constant Kr is an in-    R(s)         +_ +_          H1(s)                  X(s)
put sensor gain, and transfer             Kr                    H2(s)          G2(s)
functions G1(s), G2(s), H1(s),

and H2(s) represent arbitrary

plant, filter, sensor, etc. system

elements. Use block-diagram

algebra to show in detail that

the closed-loop transfer function is

CLTF (s)  X (s) =                                     K r G1G2

                                      R(s) 1 + G1H1 + G1G2 H 2

14.4 Consider a system represented by the block diagram below. The feedback branch is
a unity-feedback path; we could include a transfer-function block in that branch, but its
value would be simply 1, so it is standard practice to omit that obvious block.

(a) Show that the closed-loop transfer function is R(s)                  10 X(s)
                                                         +_ s +1 s2
X (s) 10(s + 1)
CLTF (s) = R(s) = s 2 + 10s + 10

(b) Evaluate the denominator quadratic equation to calculate the viscous damping ratio
 , which should indicate that the closed-loop system is overdamped.

(c) Factor the denominator quadratic into the form (s - p1 )(s - p2 ) , find the values of
poles p1 and p2 . (partial answer: p1 = -1.127 sec-1)

(d) Suppose that the ICs are zero and that the input is a step function, r(t) = 5 H (t) . De-
termine the complete algebraic equation for output x(t). First express X(s) in a partial-
fraction expansion, then find the inverse Laplace transform. Use your x(t) equation to
find the final value, lim x(t) , after all dynamic motion has damped out. (partial answer:

                                           t

one of the terms in the equation for x(t) should be -5.728 e-8.873 t.)

14.5 Consider position control of a reaction wheel (from Section 3-3) by position feed-
back plus rate feedback, for which the system Laplace block diagram is:

R(s)                                      a(s) 1 P(s) = s(s) 1 (s)
      Kr + _ + _                      Ka J s + c s

                                      Kp s(s)
                                                  Kp

                                       K (s)
                                                  K

                                      14-19
Chapter 14 Introduction to feedback control: output operations for control of rotational position

This block diagram is identical to Fig. 14-13, except that the plant transfer function from
Eq. (3-1) is 1 (J s + c ) , not just 1 J s , due to the presence of bearing friction with as-

sumed viscous damping constant c . The following data were measured for a small labo-
ratory reaction-wheel assembly:

J = 2.56 × 10-3 lb-inch-sec2, c = 0.020 ounce inch , K a = 0.950 ounce inch
                    rad sec                        V

For the case(s) assigned, the control system transducer and sensor sensitivities are as
shown in columns 2, 3, and 4 of the following table:

Case Kr (V/rad) K (V/rad) Kp (V-sec/rad) tr (sec)    x p

1  15   10   0.36            0.1280                0.3858
                                                   0.1117
2  1.5  1.5  0.27            0.4507                0.5355
                                                   0.3260
3  14   21   0.35            0.08163

4  3.5  3.5  0.24            0.2255

(a) Calculate from the values in table columns 2, 3, and 4 the following quantities for
this closed-loop system: pseudo-static multiplier K r K , undamped natural frequency
n (rad/sec), viscous damping ratio  , and damped natural frequency d (rad/sec).

(b) Suppose that the input is a step function, r(t) = RH H (t) , with magnitude RH = 30
degrees. For the subsequent step response, calculate the rise time tr , the peak time t p ,

the maximum overshoot ratio x p , and the settling time ts (see Section 9-8). Also, calcu-
late the final static value of wheel position, lim  (t) in degrees, after all dynamic motion

                                                                                            t

has damped out. Partial answers are given in columns 5 and 6 of the table above to help
you know if you are, or are not on the right track, but you still must show all derivations
and calculations leading to these answers.

(c) For the same step input as in part (b), use MATLAB to calculate and plot the step re-
sponse  (t) in degrees from t = 0 until at least the settling time t = ts .

14.6 In Section 14-5 for the rotor-position control system with position feedback and rate
feedback, the transfer function relating output rotor position (s) to input operator setting
R(s), with zero disturbance, is derived by a series of block-diagram algebraic operations
to resolve (simplify) Fig. 14-13. In practice, for assessment of control system quality, it
is often required also to determine the transfer function that relates output rotor position
to the disturbance, with zero operator setting. The appropriate Laplace block diagram for

             14-20
Chapter 14 Introduction to feedback control: output operations for control of rotational position

that task in this case comes                          d(s)

from Fig. 14-12, with R(s) =                      Ka  a(s)          (s) 1 s(s) 1 (s)
0, as shown on the figure at + _ + _
right. Derive from this block                               +       Js        s

diagram the algebraic equa-                       Kp s(s)
tion for transfer function                                      Kp

 (s) .                                            K (s)
Md (s)                                                        K

14.7 Consider a system represented by the                                     1 X(s)
                                                                              s
Laplace block diagram at right. The outer R(s)                      K1
                                                      +_ +_ ms
feedback branch is a unity feedback path; we

could include a transfer-function block in that

branch, but its value would be simply 1, so it                      K2

is standard practice to omit that obvious block.

(a) Use the result of Problem 14.3 or any other method of your choice to show that the
closed-loop transfer function is

                              X (s) = 2 K1
                              R(s) m s + K1K2 s + K1

(b) Suppose that the ICs are zero and that the input to this system is a step function, r(t)

= RH H (t) . For the case(s) assigned, the value of the mass-like parameter m (in consis-
tent units) is given in column 2 of the table below. Calculate the values of constants K1
and K2 (in consistent units) that will produce the values of maximum overshoot ratio x p

and peak time t p given in columns 3 and 4 of the table (see Section 9-8). Note that this

is a design exercise: you are calculating values of system parameters that are intended to
produce specified control objectives. Complete the problem by calculating also the rise
time tr and the settling time ts. Partial answers are given in columns 5 and 6 of the table
below to help you know if you are, or are not on the right track, but you still must show
all derivations and calculations leading to these answers.

        Case m                  x p   t p (sec)          K2         ts (sec)

        1  150                0.25     0.35           0.08230       1.010
                              0.75     0.015          8.672e-4      0.2086
        2 0.085               0.055     1.1            0.3490       1.517
                              0.125    0.75            0.2198       1.443
        3  35

        4  2.5

(c) Let the step magnitude of part (b) be RH = 0.753 (in consistent units). Calculate the
final value, lim x(t) , after all dynamic motion has damped out.

                         t

                                     14-21
       Chapter 15 Input-error operations: proportional, integral, and derivative types of control

Chapter 15 Input-error operations: proportional, integral, and deriva-
                                 tive types of control

                       © 2016 by William L. Hallauer, Jr.

15-1 Initial definitions; proportional-integral-derivative (PID) control

         Figure 15-1 is a general functional block diagram that represents many engineer-
ing control systems. The term input-error operation can be defined in the context of this
diagram: a single output quantity is fed back and differenced from the operator-setting
input quantity, and the error signal is manipulated mathematically by a controller, also
called control processor or filter, in such a way as to produce effective control. The con-
troller usually consists of analog electronic circuitry and/or a digital processor.

Operator

setting                  ee(t) Controller, w(t)

r (t)     Input er(t)    Processor,              Actuator                 Plant Output

         transducer      Filter

                                                              Output
                                                               sensor

Figure 15-1 Functional block diagram of general control system using input-error
operations

         Proportional-integral-derivative (PID) control is a class of input-error operations
used widely in industry. Let ee(t) be the error voltage signal that is input to the controller
and w(t) be the output voltage from the controller, as shown on Fig. 15-1. The mathe-
matical operations performed by an ideal PID controller are described by the equation

                        1  =t                    dee 
                     w(t) = Pee (t) + bi  ee ( ) d + bd d (t)             (15-1)
                          i  =0                  dt 
                       

The physical constants in Eq. (15-1) are proportional gain P , integral time constant  i ,
and derivative time constant  d . Each of the binary constants bi and bd has dimen-

sionless value 1 or 0, depending upon whether or not integral and/or derivative actions
are included in the control. Determining what these constants should be for a particular
application is a major part of the control design process. To find the transfer function of
the ideal PID controller, we define the Laplace transforms L[ee(t)]  Ee(s) and L[w(t)] 
W(s). Taking the Laplace transform of Eq. (15-1) gives the ideal-PID-controller transfer
function:

                         15-1
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

W (s)             1               
            = P1 + bi + bd d s                                            (15-2)
Ee (s)   i s
                                  

         We shall consider in examples three subsets of PID control that are in common
usage: for proportional (P) control, only the first term inside the brackets of Eqs. (15-1)
and (15-2) is used, so bi = bd = 0; for proportional-integral (PI) control, only the first and
second terms are used, so bi = 1 and bd = 0; and for proportional-derivative (PD) control,
only the first and third terms are used, so bi = 0 and bd = 1.

         To make the concept of PI control, for example, more concrete, Fig. 15-2 depicts
a specific analog electrical circuit that, in principle, acts as an ideal PI controller. (In
practice, a great deal of electronic refinement and conditioning is required to produce a

                                       C2 R3
               C1

                                                                R2

ee(t) R1 +  em(t)                   +  w(t)

                      Figure 15-2 Electronic analog PI controller

circuit that behaves even close to ideally.) By applying the methods of circuit analysis
described in Chapter 5 (homework Problem 5.11), we can show that the PI (bi = 1 and bd
= 0) constants in Eqs. (15-1) and (15-2), expressed in terms of the circuit parameters of
Fig. 15-2, are:

            P = R3C1 ,  i = R1C1                                          (15-3)
                 R2C2

         The detailed design of PID controllers involves a great deal of engineering art as
well as engineering science, and it has been developed extensively; see, e.g., Ogata, 2001,
Chapter 10. The present chapter is just an introduction to PID control, so we will not
delve deeply into design details; instead, we shall explore some of the more general char-
acteristics of P, PI, and PD types of control in the context of relatively simple examples.

15-2 Examples of proportional (P) and proportional-integral (PI) control

         Figure 15-3 on the next page depicts a mechanical plant that is appropriate for the
purpose of illustrating P control and PI control. A lightweight rotor is immersed in a vis-
cous liquid, so that the damping moment imposed upon the rotor is - c& . The rotor is

attached to the mechanical operator-setting device (a control wheel, for example) through

a highly flexible torsion spring that has rotational stiffness constant k . The rotor has

            15-2
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

Idealized physical model        Free-body diagram of rotor

Operator setting  k     Output  k (r -  )                c &  , &
                        (t)
r(t)

                                   c

    Figure 15-3 Lightweight rotor immersed in a viscous liquid, with connection
    to the input through a soft torsion spring

sufficiently low rotational inertia J, and viscous damping constant c is sufficiently large,
that we assume inertial moment - J&& to be negligible in comparison with the damping
and structural moments.

The equation of motion comes from the FBD on Fig. 15-3:

k (r -  ) - c& = J&&  0  c & +  = r  1& +  = r(t), where 1 = c (15-4)
                     k                                   k

Taking the Laplace transform of Eq. (15-4) gives the basic plant transfer function:

                     PTF (s) = L[ (t)]  (s) = 1                                      (15-5)
                                 L[r(t)] R(s) 1s + 1

Clearly, this idealized open-loop mechanical plant by itself is a simple 1st order system
with time constant 1 = c k ; furthermore, this system is the rotational equivalent of the

translational series damper-spring low-pass filter described by Fig. 3-12 and Eq. (3-23).

         The input to the plant is operator-setting angle r(t), and the output is rotor position
 (t). From ODE (15-4), we see that the pseudo-static output is exactly equal to the input,
 ps(t) = r(t). So let's specify that our control objective for this system is to make the ac-
tual output (t) be as close as possible to input r(t). To develop a physical feel for the
behavior of the open-loop plant in Fig. 15-3, let's suppose that the operator quickly
moves the control wheel to one side so that input r(t) is close to a step function. The tor-
sion spring will immediately be wound up more tightly, and will impose a moment upon
the rotor. However, as we can visualize intuitively, the viscous restraint upon the rotor
will prevent it from moving as quickly as the input, and the rotor angle will lag the input.
As time goes on and the torsion spring gradually unwinds, the rotor angle will eventually
settle to the input angle.

         Let's suppose that the open-loop response is too slow for our purposes, and that
we want to speed-up the response by using sensors, an actuator, feedback, and P or PI
control in the system depicted on the next page, in functional form on Fig. 15-4, and as a
corresponding Laplace block diagram on Fig. 15-5. The transfer function on Fig. 15-5
for the P or PI controller comes from Eq. (15-2), and the transfer function for the rotor-
spring-liquid plant comes from Eq. (15-5). The input transducer and the output position

                          15-3
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

Operator            ee(t) PI w(t) Position a(t)        k        Output
setting                   controller actuator                c  (t)
r(t) Input er(t)
                  e(t)
      transducer                             Position
                                              sensor

Figure 15-4 Functional diagram of a system for controlling the position of a
spring-connected rotor in a viscous liquid, based on proportional-integral control

R(s) Kr Er(s)     P Ee(s) 1 +  1  W(s) Ka a(s) 1 (s)
                                                       1s + 1
                         is 
                  E(s)

                              K

Figure 15-5 Laplace block diagram of a system for controlling the position of a
spring-connected rotor in a viscous liquid, based on proportional-integral

sensor shown on Figs. 15-4 and 15-5 are familiar from Chapter 14 (on Fig. 14-5, for ex-
ample). But the "position actuator" is something new. Whereas the output of most mo-
tors is torque, the output of this position actuator is specified to be rotational position. To
make an actuator behave in this manner requires a feedback control system within the
actuator itself; this is a characteristic of control systems that we now pause to examine.

         In fact, most actuators and sensors of all types are themselves complicated dy-
namic systems, often with internal feedback circuits. But this begs the following ques-
tion: if there are control systems within actuators and/or sensors, then why aren't the de-
tails of these systems included in the device or sub-system transfer functions shown on
block diagrams such as Fig. 15-5?

         A general response to this question is based upon the relative "speeds" of differ-
ent systems. To illustrate this concept of system speed, we imagine that two standard 2nd
order systems, A and B, have equivalent values of subcritical viscous damping ratio ,
but that System A's undamped natural frequency is 100 times that of System B, nA / nB
= 100. Consequently, System A's settling time for step inputs, tsA = 4/ (nA) [Eq. (9-
40)], is only 0.01 that of System B; in this case, we regard "the dynamics of System A"

as being "100 times faster" than "the dynamics of System B." Engineers usually select
for a control system sensors1 and, when possible, actuators that are much faster than the

dynamics of the plant under control; in such cases, we usually approximate the behavior

of a sensor or actuator with a simple linear sensitivity constant, in equations such as
er (t) = K r r(t) , e (t) = K (t) , and a (t) = Ka w(t) , all of which are represented on Fig.

1 Examples that appear in this book of such sensors are the accelerometer [homework Problem 10.12(b)],
the rate gyroscope (Example 9-2 in Section 9-2, and homework Problem 9.18), and the rate-integrating
gyroscope (homework Problem 9.19).

                        15-4
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

15-5. In these cases, we are making the approximation that the dynamics of the sensors
and actuators are essentially infinitely fast and are independent of, or "uncoupled from"
the dynamics of the plant.

         Be aware, though, that the full dynamics of devices used for control, especially
actuators, cannot always be considered uncoupled from the dynamics of the plant. For
one example, the dynamics of a reaction-mass actuator (homework Problem 10.15) in a
vibration-control system are usually inextricably coupled with those of the structural
plant, as in homework Problem 12.6. For another example, homework Problem 15.7 is
an exercise of incorporating the dynamics of a position actuator into a control-system
model; in this case, the process involves even more than just inserting the actuator's
transfer function in series within the block diagram of the overall system. In yet another
example, Dettmer, 1995, Section 1.3.4 describes a control system for which it was neces-
sary to account for the dynamic characteristics of both sensors and actuators.

         Returning now to the rotor-position control system of Figs. 15-4 and 15-5, our
objective is to make the output follow the input,  (t)  r(t) , so it is appropriate to define

a revised (relative to Fig. 15-3) open-loop configuration. If the feedback loop in Fig. 15-
5 were broken, and if the PI controller were not present (P = 1, bi = 0), then the transfer
function for this open-loop system clearly would be K r × K a ×1 (1s + 1) . We want this

to be the same as that of the bare (devoid of control devices) plant, Eq. (15-5), so let's
suppose that we have the ability to set the sensitivities of the input transducer and the po-
sition actuator so that K r × K a = 1. Also, it will greatly simplify the algebra in the

following developments if we suppose further that we can use identical sensors on the
input angle and the output angle in the feedback path, so that K r = K . To summarize,

we shall apply the following restrictions on the device sensitivities:

K r × K a = 1 and K = 1           (15-6)
                           Kr

         To compare open-loop and closed-loop system performances, let's consider re-
sponse (from zero initial conditions) to step input r(t) = RH H (t)  R(s) = RH s . Then,
for the open-loop system, using transfer function (15-5) and partial-fraction expansion
gives

(s) = RH 1 1 = RH  1 -  1         (15-7)
s 1s +1   s s +11 

Taking the inverse Laplace transform gives the step response of the open-loop system:

 (t) = RH (1 - e-t 1 ), for t  0  (15-8)

Equation (15-8) is simple 1st order step response of the type shown on Fig. 3-3. At the
end of this section, there is a comparative numerical evaluation of this open-loop re-
sponse and step responses for P and PI types of closed-loop control. For now, though,

15-5
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

let's just observe from (15-8) that the asymptotic or "final" value of response for times
much greater than time constant 1 equals the magnitude of the step input, as required:

         lim (t) = RH                                                              (15-9)

         t

         Next, let's analyze closed-loop proportional (P) control, for which bi = 0 on Fig.
15-5. Thus, for the closed loop on Fig. 15-5, we have for Eq. (14-16) the polynomials
NG = P × K a , DG = 1s + 1, N H = K , and DH = 1, which we use to find the following

CLTF(s):

(s) = K r × NG DH = K r PK a = K r K a P
R(s)  DG DH + NG N H 1s + 1 + PK a K               1s +1+ Kr Ka K P

                                                                               Kr

With simplifying assumptions (15-6), this becomes

      CLTF (s) = (s) = P = P                       1 P 1                           (15-10)
      R(s) 1s +1+ P 1+ P  1                        1 + P 1P s + 1
                               s +1
                              1+ P 

in which the new time constant for the proportionally controlled system is

            1P  1                                                                  (15-11)
                   1+ P

For step input r(t) = RH H (t)  R(s) = RH s , Eq. (15-10) gives the transform

      (s) = RH × CLTF (s) = RH P × 1 1                                             (15-12)
      s                                            1 + P s 1P s + 1

Hence, we find the step response of the proportionally controlled system just by compar-
ing Eq. (15-12) with Eq. (15-7) and then modifying Eq. (15-8) appropriately:

       (t) = RH P (1 - e-t 1P ), for t  0                                          (15-13)
                  1+ P

The asymptotic or "final" value of proportionally controlled step response for times much
greater than time constant 1P is:

         lim (t) = RH P                                                            (15-14)
         t                    1+ P

         This situation provides the opportunity to introduce the final-value theorem and to
illustrate its application; this is a useful mathematical tool that is derived in the next sec-
tion. This theorem allows us to find the finite asymptotic value of a time function f (t) ,

            15-6
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

assuming that such a value exists, based only on the Laplace transform L[ f (t)] = F (s) ,
without requiring that the equation for f (t) be available:

                       lim f (t) = lim[sF(s)]                 (15-15)
                       t  s0

          For step response of the proportionally controlled system, the final-value theo-
rem and Eq. (15-12) give

lim (t) = lim s × (s)
t   s0

    = lim  s × RH  P 1 1  = lim  RH P  1  = RH P
    s0   1 + P s 1P s + 1 s0  1 + P 1P s + 1            1+ P

This is another, easier method for finding result (15-14). The final-value theorem was
not needed to derive the correct asymptotic solution for this simple case, but it will be a
useful, labor-saving tool for more complicated cases in the future.

        Comparing Eq. (15-14) with the required asymptotic value lim (t) = RH , Eq.

                                                                                                                                                    t

(15-9), we see that, because P (1 + P)  1, the proportionally controlled system fails to

satisfy the requirement exactly. Let's examine possible values of proportional gain P.
Equation (15-11) requires that P > -1 so that the system is stable, 1P > 0 . Equation (15-
13) requires that P > 0 so that the response has the same sign as the input. Moreover, P
should be a positive number as large as possible, within practical hardware limitations,
because (1) the greater the value of P, the smaller is time constant 1P , making the sys-
tem faster than the open-loop system, and (2) the greater the value of P, the closer is the
asymptotic value of the output to the value of the input, from Eq. (15-14). The value P =
4 is a commonly used proportional gain. But even for a large, positive value of P, the
steady-state response will be at least a little smaller than the input. The steady-state out-
put error, also known as offset, is defined as

                        offset  RH - RH P = RH                (15-16)
                                             1+ P 1+ P

A large value, P > 9, is required to reduce the offset to less than 10% of the desired
steady-state output.

         There is a simple explanation for the offset produced by proportional (P) control,
which also will suggest a remedy. Block diagrams Fig. 15-4 and Fig. 15-5 show that the
final value of a must be non-zero, equal to the final value of output  . In other words,

the torsion spring must be completely relaxed (unloaded) at the end of the control proc-
ess, which is obvious physically. Furthermore, by tracing backwards on the forward
branches of the loops on Figs. 15-4 and 15-5, we find the other relevant final values: w =
a K a = K a , and, with bi = 0, ee = w P = a (K a P) = (K a P)  0 . Ideally, the final

error signal ee = er - e should be zero, corresponding to the output being exactly the

                          15-7
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

desired final value; however, the preceding argument shows that the final error for P con-
trol alone is inevitably non-zero. This argument also suggests that we seek some way to
make the final error equal zero, ee = 0 , but still to preserve non-zero input into the posi-
tion actuator, w  0 , so that a  0 , and so that the final output equals the desired value,
 = r . Integral (I) action can produce this effect: if we add a term to w that is propor-

                                                                                     =t

tional to the integral of the error signal,  ee ( ) d , then we can have a final non-zero
                                                                                    =0

control signal, w  0 , even though the final error itself is zero, ee = 0 .

Therefore, let's next find the closed-loop transfer function for closed-loop propor-

tional-integral (PI) control (bi = 1) . For the closed loop on Fig. 15-5, the forward-branch

transfer function is G = P1 +  1  × K a × 1 = PK a ( i s + 1) , so  NG = PK a ( i s + 1)
            is                          1s + 1  i s(1s + 1)

and DG =  i s(1s + 1) . For the feedback branch, N H = K and DH = 1. Therefore, Eq.

(14-16) gives the following CLTF(s) ):

    (s) = Kr × NG DH =                             Kr PKa ( is +1)

    R(s)          DG DH + NG NH  is(1s +1) + PKa ( is +1)K

          = KrKa                        P( is +1)

                   is(1s +1) + Kr Ka K P( is +1)
                                              Kr

With simplifying assumptions (15-6), this becomes

    (s) =         P( i s + 1)                 = 2 P( i s + 1)       (15-17)

    R(s)  i s(1s + 1) + P( i s + 1)  i1s + (1 + P) i s + P

         Before analyzing Eq. (15-17) in more detail, let's first determine if, as predicted
above, PI control eliminates the P-control offset of Eq. (15-16). For step input r(t) =
RH H (t)  R(s) = RH s , Eq. (15-17) gives the transform

           (s) = RH                     P( i s + 1)                 (15-18)

                              s  i s(1s + 1) + P( i s + 1)

Applying final-value theorem (15-15) to Eq. (15-18) gives

lim (t) = lim s × (s) = lim  RH P( i s + 1)                     P
                                                            = lim  RH  = RH (15-19)
t   s0            s0   i s(1s + 1) + P( i s + 1)  s0  P 

Therefore, integral action does indeed eliminate the error that is inevitable from purely
proportional control.

                                        15-8
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

         Returning to transfer function (15-17), we see that integral action has increased
the order of the system to 2nd order from the 1st order of the plant. Accordingly, we can
re-write the transfer function in terms of parameters appropriate for a 2nd order system:

                          P ( i s + 1) 2
          (s) =  i1                P  s 2 + 2 2 n ( i s + 1) n s + n
          R(s) 2 1+ P                                                       (15-20)

          s + s+
                          1         i 1

in which the undamped natural frequency and the viscous damping ratio are, respectively,

          n = P           and  = 1 1 + P = 1  i 1 + P                       (15-21)
                   i 1                2n 1 2 1 P

Note that this system is not a standard 2nd order system, as defined in Eq. (9-13). The

                 2

term n  i s in the numerator of Eq. (15-20) makes this system non-standard; that term

corresponds to right-hand-side dynamics in the ODE describing the system, which is
&& + 2n& + n 2 = n 2 ( i r& + r) . The non-standard character means, among other
things, that the step-response specifications derived in Section 9-8 do not apply exactly
for this system.

         For comparison with the previous cases of open-loop and P control, let's solve for
response of the PI-controlled system to step input r(t) = RH H (t)  R(s) = RH s . Eq.
(15-20) gives the transform

(s) =  RH n 2 ( i s + 1)  2 = RH  2 n  i    d     2+            1       n2  
                                                                            2
       2s s + 2n s + n            d (s + n ) + d s (s + n ) + d 2       2

                                                                            (15-22)

The second form of Eq. (15-22) is written subject to the condition  < 1, so that d 2 
n2 (1 -  2 ) > 0 ; since  > 0 from Eq. (15-21), this means that we assume the system to
be underdamped, at least initially. With Eq. (15-22) in the second form, we can apply the
following inverse Laplace transforms. First, Eqs. (9-17) and (9-20) give:

          -1              d                -n t
          L                      2 2  = e sin d t                           (15-23)
          (s + n ) + d 

Next, Eqs. (9-17) and (9-29) give (see homework Problem 9.12):

       -1 1 n 2  -n t                              n                  
       L                  2 2  = 1 - e  cosd t + sin d t                    (15-24)
           s (s + n ) + d                         d
                                                                      

                                   15-9
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

Substituting (15-23) and (15-24) into the inverse transform of (15-22), then combining
terms appropriately, gives the step response of the PI-controlled underdamped system:

 -n t                                         2    
 (t) = RH 1 - e  cosd t +                        sin d t  , for 0   < 1 and 0  t (15-25)
                           n - n  i

                             d                     
                                                   

In the numerical example to follow, we shall encounter cases of both underdamping and
overdamping; therefore, it is appropriate to apply conversion Eq. (9-45) to underdamped
response equation (15-25) in order to write the following equation for step response of
the PI-controlled overdamped system:

   -n t                                         2    
 (t) = RH 1 - e  cosh d t +                        sinh d t  , for 1 <  and 0  t (15-26)
                             n - n  i

                                d                    
                                                     

in which d = d  2 -1 .

         Now that we have derived the equations for step response, let's evaluate a numeri-
cal case with physically plausible parameters; in particular, let's calculate and compare
the step responses: Eq. (15-8) for the open-loop system; Eq. (15-13) for the P-controlled
system; and Eq. (15-25) or Eq. (15-26) for the PI-controlled system. We let the time con-
stant of the open-loop system have the value c k  1 = 1 sec, and we use the typical

value P = 4 for the proportional gain. For the PI-controlled system, we consider three
different integral time constants, i = 1/3, 2/3, and 1 sec. The following is a MATLAB
M-file that calculates the step responses and plots them on a single graph:

%MATLABdemo151.m
%1st order system: spring-connected rotor in a viscous fluid
%Step responses: open-loop, P-controlled, and PI-controlled
t=0:.01:4;
tau1=1;%time constant of open-loop system = 1 sec
thOL=1-exp(-t/tau1);%open-loop step response ratio
P=4;tau1P=tau1/(1+P);
thP=P/(1+P)*(1-exp(-t/tau1P));%step response ratio, P control
plot(t,thOL,t,thP),hold
taui=[1/3 2/3 1];%step response ratios, three cases of PI control
for ni=1:3,

   wn=sqrt(P/(taui(ni)*tau1));zeta=(1+P)/(2*wn*tau1);
   sig=zeta*wn;case_taui_zeta=[ni taui(ni) zeta]
   if zeta < 1

       wd=wn*sqrt(1-zeta^2);
       thPI(ni,:)=1-exp(-sig*t).*(cos(wd*t)+(sig-wn^2*taui(ni))/wd*sin(wd*t));
   else
       md=wn*sqrt(zeta^2-1);
       thPI(ni,:)=1-exp(-sig*t).*(cosh(md*t)+(sig-wn^2*taui(ni))/md*sinh(md*t));
   end
   plot(t,thPI(ni,:),'k')
end
grid,xlabel('Time t (sec)'),ylabel('Step response ratio \theta(t)/R_H')
title('Position control of a spring-connected rotor in a viscous fluid')

                                15-10
      Chapter 15 Input-error operations: proportional, integral, and derivative types of control

The MATLAB command and resulting output are printed below. The three cases shown
are for PI control with integral time constant ("taui") i = 1/3, 2/3, and 1 sec; note the
values of viscous damping ratio ("zeta")  : the system is underdamped for i = 1/3 sec,
but overdamped for i = 2/3 and 1 sec.

>> MATLABdemo151
Current plot held
case_taui_zeta =

       1.0000 0.3333 0.7217
case_taui_zeta =

       2.0000 0.6667 1.0206
case_taui_zeta =

       3.0000 1.0000 1.2500

Figure 15-6 is the graphical output from the MATLAB M-file.

Figure 15-6 Step responses for no control (open-loop), proportional (P) control, and
proportional-integral (PI) control

         Figure 15-6 illustrates clearly the results derived previously regarding the time
constants for open-loop and P control, and the final values of step response for open-loop,
P control and PI control. The new and interesting results on Fig. 15-6 relate to step re-
sponse of the system under PI control. For all three values of i , the speed of response is
much faster than that of the open-loop system, and comparable to that for P control.
Moreover, there is a design trade-off for this 2nd order system between rise time and over-
shoot. Recall from Section 9-8 that rise time is the time required for the response first to
reach the desired value, and overshoot is the maximum amount by which the response
exceeds the desired value. For most cases, the control designer would like to make rise
time as fast as possible, and to minimize overshoot. However, Fig. 15-6 shows that we

                                                  15-11
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

cannot simultaneously do both in this case: rise time is fastest for small i , but overshoot
is minimized or eliminated with larger i . Therefore, the control designer must compro-
mise and select a value of i that produces practically acceptable values of both rise time
and overshoot, even though neither response parameter would be the best possible.

         It is interesting to observe also from Fig. 15-6 that, for this non-standard 2nd order
system, there is overshoot for i = 2/3 sec   = 1.02; in other words, there is overshoot
even though the system is overdamped. This is different from the step response of a posi-
tively damped standard 2nd order system (Section 9-8), for which overshoot can occur
only if 0   < 1.

15-3 Derivation of the final-value theorem

         Consider a continuous physical function f (t) , with continuous derivative df dt ,
and with Laplace transform L[ f (t)] = F (s) . The final-value theorem expresses the final,
steady-state value of f (t) in terms of F (s) as:

lim f (t) = lim [sF (s)]                             (15-15) repeated
t                                            s0

This theorem is useful for finding the final value because it is almost always easier to de-
rive the Laplace transform and evaluate the limit on the right-hand side, than to derive the
equation for f (t) and evaluate the limit on the left-hand side. Final-value theorem (15-

15) is valid provided that lim f (t) exists (i.e., is a finite, constant value). But we must

                                                        t

apply Eq. (15-15) with care, because the theorem itself fails to distinguish between func-
tions for which the limit exists and functions which have no limit. Indeed, the theorem
can predict falsely that an unstable system has a limit when, in fact, there is none, i.e.,
that lim f (t)  ±  .

          t

         Derivation of the final-value theorem is based upon definition (2-13) of a Laplace
transform and the Laplace transform (2-15b) of a derivative:

  d  -s t t=  d 

L f (t) =  e  f (t) dt = sF (s) - f (0)

  dt  t=0  dt 

Taking the limit of all terms as s  0 gives

 d  t=  d 
lim L f (t) =  1×  f (t) dt = lim[sF (s)]- f (0)
s0  dt  t=0  dt                                  s0

Now the integral is evaluated easily:

                                       15-12
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

t=  d 
  f (t) dt  f () - f (0) = lim[sF (s)]- f (0)
t=0  dt          s0

 f ()  lim f (t) = lim[sF (s)]
          t      s0

This completes the derivation of final-value theorem (15-15), which was applied earlier
to re-derive result (15-14) and in Eq. (15-19).

15-4 Example of proportional-derivative (PD) control

         Next, we consider the effect of derivative control, the third type of operation on
the error signal indicated in Eqs. (15-1) and (15-2). The derivative term (with bd = 1) in
the actuator signal w(t) is P d × dee dt . This term is proportional to the rate of change
of the error signal, so it anticipates, in a sense, any increase in the error, and it acts to op-
pose that increase. Derivative action is used in combination with proportional action or
proportional-integral action, but not by itself. Whereas proportional action has the effect
of a restoring linear spring, derivative action has the effect of a viscous damper. There-
fore, derivative control by itself would fail to provide action that forces system output
toward the desired value.

         A reality check is appropriate at this point. The derivative output xd (t)  e&e of an
ideal PID controller in Eq. (15-1) is physically unrealistic, because it is not possible to
measure exactly, in real time, the derivative e&e of the error signal. Exact real-time meas-
urement of a derivative at an instant would require information about future values of the
signal, but future values are unknown. Another manifestation of the unrealism of the de-
rivative term is the associated transfer function, X d Ee = s 1, which is written here as a
fraction on the right-hand side so as to emphasize that the polynomial order (in s) of the
numerator is higher than that of the denominator. Thus, this transfer function is acausal,
meaning that the current output of the ideal differentiator must be dependent upon future,
as well as past and present, values of the error signal (see Bélanger, 1995, p. 440).

         Since the exact differentiator of Eq. (15-1) cannot be realized physically, an actual
PD controller often includes an approximate differentiator in the form of a 1st order high-
pass filter described by the ODE  d x&d + xd = e&e ; in this ODE,  d is the derivative time
constant, and  is a small positive number typically selected to be in the range 0.1 to 0.3
(Ogata, 2001, pages 700 and 727). The transfer function of this approximate differen-
tiator is X d (s) Ee (s) = s ( d s + 1) , which is causal, therefore physically realizable. For

error signals that are slowly varying in time relative to the high-pass-filter break
frequency 1 ( d ) rad/sec, this approximate differentiator is very accurate, but for faster

error signals the device's output fails to approximate the derivative of the error signal
(see homework Problem 15.4). In practice, therefore, the selection of parameters  d and
 is based at least partly on the speed of signals that the PD controller is expected to
process. The operation of an actual PD controller using the approximate differentiator is

          15-13
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

w(t) = P[ee (t) +  d xd (t)]; you can easily show that the transfer function of the actual PD

controller is W (s) = P1 +  d  X d (s)  = P1 +   d s  = P   (1 +  ) d s + 1 .
Ee (s)                   Ee (s)    d s + 1   d s + 1 

         It is standard in introductory discussions to describe PD control in the context of
the ideal (though physically unrealizable) differentiator xd  e&e , rather than the more
realistic approximate differentiator  d x&d + xd = e&e . The approximate differentiator
leads to a higher-order system and much more complicated algebra, from which it is dif-
ficult to infer basic physical characteristics of PD control. Therefore, in the rest of this
section, and in the continued examination of this same example in homework Problem
15.1 and in Section 16-2, we shall follow the standard introductory procedure and use the
ideal PD-controller transfer function P(1 + d s) from Eq. (15-2). Most of the theoretical
results produced by this approach are good approximations to what would be realized
from a properly designed real PD controller, at least for sufficiently slowly varying inputs
and outputs.

         To illustrate proportional-derivative (PD) control, we consider again the problem
of controlling position  (t) of a rotor with significant inertia J, as discussed in Chapter

14 [Figs. 14-1, 14-2, and 14-5, and Eqs. (14-1) R(s)                            1 (s)
and (14-2)]. Recall that the input to the system                               Js 2
                                                       Kr + _  P Ka

is operator setting r(t). Let's neglect distur-

bance moments, Md(t) = 0. Figure 15-7 is the                                 K
Laplace block diagram for the P-controlled
                                                  Figure 15-7 Proportional control of
system, from which the loop transfer functions    rotor position
are G(s) = PKa / (Js2) and H(s) = K . Hence, we

use Eq. (14-16) to find

CLTF(s) = (s) = K r × NG DH               = Kr ×         PK a   Kr             n2

                         DG DH + N G N H               2             2             2
R(s)                                              Js + PK a K K s + n

Undamped natural frequency in this CLTF(s) is defined by n2 = PKaK / J. Suppose that

the input is a step function with magnitude RH : r(t) = RHH(t). For this input, the Laplace

transform of response is (s) =  RH Kr n2
                                          2 2 . Application of inverse transform (15-
                                s K s + n

24), with  = 0 , gives the step response  (t) = (RH Kr K )(1 - cosnt) . This is un-

damped motion that oscillates forever about the desired final value,  = RH Kr K [see

Eq. (7-14) and Fig. 7-3], so it is unacceptable for a position control system. In this case,

P control alone has the effect of a restoring linear spring, but it provides no damping.

         In order to improve the control  R(s)         P(1 +  d s) Ka W(s)      1 (s)
performance, we add derivative action,         Kr + _                          Js2
upgrading from P control to ideal PD
control. From Eq. (15-2) with bi = 0                                      K
and bd = 1, the ideal PD-controller
                                          Figure 15-8 Ideal proportional-derivative
                                          (PD) control of rotor position

                                          15-14
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

transfer function is P(1 +  d s) , so the Laplace block diagram for the closed-loop system

becomes that shown in Fig. 15-8. In this case, the loop forward-branch transfer function
is G(s) = P(1 + ds)Ka / (Js2), so the closed-loop transfer function of the system is

(s) = K r × NG DH      = K r × 2 P(1 +  d s)K a  = 2 K r PK a (1 +  d s)
R(s)  DG DH + N G N H      Js + P(1 +  d s)K a K Js + PK a K d s + PK a K

As we did in Eqs. (15-20) and (15-21), which apply to PI control (but of a different

plant), we can now re-write this PD closed-loop transfer function in terms of parameters
appropriate for a damped 2nd order system:

      (s) = 2 K r (PK a K J )( d s + 1)           Kr     n 2 ( d s + 1)     (15-27)

      R(s) K s + (PK a K J ) d s + (PK a K J ) K s + 2n s + n2           2

In Eq. (15-27) the undamped natural frequency and the viscous damping ratio are, respec-
tively:

      n =          PK a K  and  = 1 PK a K  d = 1 n d                       (15-28)
                      J    2n J                          2

The obvious effect of the derivative action is to add damping to the 2nd order system, and
this damping improves the control performance (see homework Problem 15.1). Note also

                                    2

that the term n  d s in the numerator of Eq. (15-27) makes this system non-standard
relative to definition (9-13) of the standard 2nd order ODE. The non-standard character
means, among other things, that the step-response specifications derived in Section 9-8
do not apply exactly for this system.

                           15-15
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

15-5 Homework problems for Chapter 15

15.1 Consider closed-loop transfer function (15-27), with definitions (15-28), for posi-
tion control of a rotor by an ideal PD controller.

(a) Suppose that we know rotational inertia J, actuator sensitivity Ka , and equal input

and feedback transducer sensitivities, Kr = K , and that we want to specify (i.e., "design")
the undamped natural frequency n and the viscous damping ratio  for this controlled
system. Hence, we need to determine appropriate values for proportional gain P and de-
rivative time constant d , which we would set in the PD controller. For a particular sys-
tem, we have J = 2.56e-3 lb-sec2-inch (the value for a small aluminum wheel about four

inches in diameter, Fig. 3-1), and the product Kr Ka = 0.0350 lb-inch/rad; let's specify fn =
n / 2 = 1.00 Hz (so that step-response rise time will be around ¼ sec) and  = +0.1 (too
low for most practical control systems, but it suits the overall purposes of this problem).
Calculate the required values of P and  d (sec).

(b) Use the MATLAB residue operation (see homework Problem 2.15) to expand the
transfer function [with the numerical values of part (a)] into a partial-fraction expansion.
The poles are critical to the stability of any system, which is the subject of Chapter 16.
For this system, you should find a pair of poles that are complex conjugates, and their
real part should be negative--this means that the system is stable.

(c) Let the input be a step, r(t) = RH H(t). First, apply the final-value theorem to find
lim (t) . Next, use inverse transforms (15-23) and (15-24) [or just appropriately adapt

t

step response (15-25) to this case] to show that the step response is

  -n t    n                                                      2
 (t) = RH 1 - e  cosd t - sin d t  , for | | < 1 and d = n 1 - 
         d                             

Finally, let the input step magnitude be RH = 0.1 radian, with the numerical values of part
(a), and use MATLAB to plot the output (t) over the time interval 0-2.5 sec, about 2½
cycles.

(d) To simulate what would happen if you made a mistake and got the wrong sign for d
(and therefore for  ), let  = -0.1, and repeat the operations of parts (b) and (c). If you
can plot (t) for both  = +0.1 and  = -0.1 on the same graph, it will enhance compari-
son of the two cases. For  = -0.1, you should find the real part of the complex conjugate
poles to be positive; the associated time history (t) should indicate system instability.
Observe for this unstable system that the final-value theorem incorrectly predicts a finite
steady-state value for this step response.

             15-16
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

15.2 Consider ideal PID                                       Md(s)

a rotor that has significant Kr + _ P control of the position of R(s) 1 + 1 +  d s  Ka + _ 2  1   (s)
                                    is                               Js                          In the
inertia J. Let's also ac-

count for a disturbance                                    K

moment Md(t) acting up-
on the rotor. The Laplace block diagram for this 3rd order system is drawn above.

following exercises, assume that this system is stable.

(a) For zero disturbance, Md(s) = 0, derive the algebraic equation for closed-loop transfer
function (s)/R(s). For step input, r(t) = RH H(t), apply the final-value theorem to find
lim (t) .

t

(b) For zero input, R(s) = 0, derive the algebraic equation for closed-loop transfer func-
tion (s)/Md(s). For step disturbance, Md(t) = MH H(t), apply the final-value theorem to
find lim (t) . A control system should suppress permanent output due to a step distur-

           t

bance.

15.3 Consider PI control of the speed (not position) of a rotor that has significant inertia

J. The sensor on the output is a tachometer with gain constant Kp, so the electrical signal

that is fed back is Kp& . (This configuration illustrates a general rule-of-thumb in control-

system design: sense and feed back the quantity that you want to control.) This is a sim-

                            Md(s)                        plified model, for example, of
                           Ka + _
R(s)         P1 +  1                             an automobile's cruise-control
     Kr + _    is                  1 L[&] system. Let's also allow for a

                                   Js                    disturbance moment Md(t) act-

                                                         ing upon the rotor. The La-

                           Kp place block diagram for this
                                                             system is at left.

(a) For zero disturbance, Md(s) = 0, derive the algebraic equation in terms of all parame-
ters on the Laplace block diagram for the closed-loop transfer function L[&] R(s) that
relates output rotational velocity &(t) to input command r(t). For step input, r(t) = RH ×
H(t), apply the final-value theorem to find the algebraic equation for lim&(t) , assuming

                                                                                                                                                    t

that this asymptotic value exists. Explain (perhaps using an example from your own ex-
perience, such as a cruise-control system) the physical significance of the ratio Kr /Kp of
the input-transducer sensitivity to the tachometer sensitivity.

(b) Derive algebraic equations for undamped natural frequency n and viscous damping
ratio  of this controlled system, in terms of inertia J, actuator sensitivity Ka , tachometer
sensitivity Kp , proportional gain P, and integral time constant  i .

                                   15-17
Chapter 15 Input-error operations: proportional, integral, and derivative types of control

15.4 In this problem, you will produce graphically and compare the frequency-response
functions of the exact, but physically unrealizable differentiator xd  e&e (which is used in
this book for ideal PD control) and an approximate, but physically realizable differenti-
ator that has the character of a high-pass filter.

(a) Section 15-4 gives the ODE of the approximate differentiator as  d x&d + xd = e&e ,
with  d being the positive derivative time constant and  being a small positive number
in the range 0.1-0.3; show that the complex frequency-response function (FRF) of output

signal xd (t) relative to input signal ee (t) is FRF () = j (1 + j d ).

(b) For frequency response, the input signal has the steady-state sinusoidal form ee (t) =

Ee cost and the output signal has the corresponding form xd (t) = X d () cos( t + ) .

Use the FRF of part (a) to show that the equations for FRF magnitude ratio and phase of

the approximate differentiator are X d () =  and () =  - tan -1  , in which
                                   b Ee  1+ 2   2

the break frequency is b  1 ( d ) = 2 fb and the dimensionless frequency ratio is

   b = f fb . Use the magnitude-ratio equation to derive equations for the low-

frequency and high-frequency asymptotes, and sketch those asymptotes on a log-log

graph such as Fig. 4-2. The approximate differentiator should exhibit the character of a

high-pass filter, analogous to the system of homework Problem 4.4. Use the asymptotes

as an envelope to guide you in sketching the actual curve of X d () (b Ee ) , as is done

on Fig. 4-2. Finally, on a semi-log graph below the log-log graph (analogous to Fig. 4-1),
sketch the variation with frequency of phase () .

(c) Now consider the exact differentiator, with equation xd  e&e . Repeat all the steps of
parts (a) and (b) for the exact differentiator, sketching the magnitude-ratio and phase
curves on the part (b) graphs, but in some different color or line style, so that the curves
for exact and approximate differentiators are clearly distinguishable. You should be able
to infer from these final graphs the ranges of frequency over which the approximate dif-
ferentiator is reasonably accurate, or inaccurate.

15.5 Consider the transfer function of the PD-controlled rotor position of Section 15-4,

Eq. (15-27) with equal input and feedback transducer sensitivities, Kr = K , in the form

(s) =     K r PK a (1 +  d s)      . Use this transfer function and the block diagram of

       2
R(s) Js + K r PK a d s + K r PK a

Fig. 15-8 to write the algebraic equation for the transfer function of the PD controller,

W(s) / R(s). Now, examine the nature of W(s) / R(s) in the following steps:

(a) Find the order m of the numerator polynomial and the order n of denominator poly-
nomial of W(s) / R(s). Is this transfer function causal or acausal, and what does that mean
in theory regarding the physical realism of W(s) / R(s)?

                                         15-18
      Chapter 15 Input-error operations: proportional, integral, and derivative types of control

(b) Suppose that the input is the infinitely fast step function r(t) = RH H(t) of homework
Problem 15.1(c). Show that the controller-output transform W(s) must have a constant
direct term, as defined in homework Problem 2.15. What is the component of time
response w(t) that corresponds to the direct term of W(s), and is this a physically
realizable signal from a real device? Your conclusions from parts (a) and (b) should be
compatible.

(c) If you conclude in parts (a) and (b) that something is physically unrealistic about
these theoretical results, then what is there in the theoretical analysis that makes the re-
sults defective? Propose a remedy that should produce physically realizable results, and
show succinctly, with appropriate algebraic equations and written explanation (but no
calculations), why your proposed remedy should work.

15.6 Consider control of a spacecraft's pitch attitude, (t), for which the ODE of motion,
from Eq. (14-7), is J&& = M a (t) + M d (t) , where M d (t) is a disturbance moment. In this
problem, you will apply a physically realizable form of PD control, with the control
actuator moment defined as M a (t) = Ka × w(t), where Ka is the actuator sensitivity. The

output signal from the realizable PD controller is w(t) = P[ee (t) +  d xd (t)], where xd (t)

is the dependent variable in the ODE  d x&d + xd = e&e (see the relevant discussion in Sec-
tion 15-4). The input error is ee(t) = Kr r(t) - K (t), where r(t) is the input operator set-
ting, and Kr and K are the transducer sensitivities at, respectively, the input and output
feedback.

(a) Draw and label completely the Laplace block diagram of this system, from input R(s)
 L[r(t)] to output (s)  L[(t)], including disturbance moment signal Md(s) = L[Md(t)].

(b) For Md(s) = 0, derive from the block diagram of part (a) the closed-loop transfer
function CLTF(s) = (s) / R(s) = Num(s) / Den(s), where Num(s) and Den(s) are polyno-
mials in powers of s. Partial answer: Den(s) = Js2(d s + 1) + PKa K [d (1 + ) s + 1]

(c) For step input, r(t) = RH H(t), apply the final-value theorem to find lim (t) , provided

                                                                                                                                                     t

that the system is stable.

(d) How does CLTF(s) in part (b), for a physically realizable form of PD control, differ
from the corresponding closed-loop transfer function that applies for an ideal but unreal-

izable PD controller, for which w(t) = P[ee (t) +  d e&d (t)]? [Do not re-derive this CLTF(s)

from scratch; instead, just make a simple substitution in the CLTF(s) of part (b).] Discuss
in one or two sentences.

15.7 Consider the "position actuator" depicted on functional diagram Fig. 15-4, which
represents a system for control of a rotor immersed in a viscous liquid. Suppose that the
position actuator is the rotor-position control system of Fig. 14-11, and that Fig. 14-12 is
the actuator's Laplace block diagram. Your assignment in this problem is to revise the
immersed-rotor control system's Laplace block diagram, Fig. 15-5, to incorporate the po-

                                                  15-19
      Chapter 15 Input-error operations: proportional, integral, and derivative types of control

sition-actuator dynamics, replacing the simplified block of actuator gain Ka with an ap-
propriate version of Fig. 14-12, and making any other necessary modifications. There are
at least three significant changes required, the first two being notational. (1) You should
re-label the input of the modified Fig. 14-12 to W(s)  L[w(t)], replacing R(s), and also
re-label the output to a(s)  L[a(t)], replacing (s). (2) In order to avoid notational
ambiguity, you should re-label all system components on Fig. 14-12 having subscripted
symbol K, with subscripted symbol Q, e.g., on the revised Fig. 14-12, Kr Æ Qr , and Ka
Æ Qa , etc. (3) It is necessary to recognize that the rotational spring with stiffness k
shown on Fig. 15-4 imposes upon the position actuator a moment k( - a). The quanti-
ties labeled on Figs. 14-11 and 14-12 that can represent moment k( - a) are, respec-
tively, Md(t) and Md(s), for example, Md(s) = k[(s) - a(s)]. (However, the moment
k( - a) is clearly defined and not at all random or unpredictable mathematically, so it
is not truly a disturbance in the sense defined in Section 14-2, with reference to Fig. 14-
2.) Accounting for items (1)-(3) and any other necessities, draw a Laplace block diagram
of the immersed-rotor control system, a diagram that incorporates the position-actuator
dynamics from Fig. 14-12. This block diagram will be somewhat longer than others ap-
pearing in this book. It is not required that you simplify this block diagram to derive an
algebraic expression for the closed-loop transfer function; it is possible to do so using the
operations of block-diagram algebra described in Chapters 13 and 14, but the process
would be complicated algebraically, and it would produce a very long and messy equa-
tion for CLTF(s). Modern processes using specialized computer software are more ap-
propriate than algebra-by-hand for a task such as this. For example, if you had numerical
values for all the system parameters (J, k , Qr , ..., 1 , P, etc.), then you could easily
generate a single equation for CLTF(s) with MATLAB by using the functions tf, and
feedback, and series (or, rather than series, simply the operation of transfer function
multiplication).

                                                  15-20
         Chapter 16 Introduction to system stability: time-response criteria

Chapter 16 Introduction to system stability: time-response criteria

                  © 2016 by William L. Hallauer, Jr.

         Section 16-1 is a lengthy and detailed, perhaps almost tedious, development of the
theory underlying time-response stability criteria. Section 16-2, on the other hand, is a
specific example, based upon a control system from Chapter 15, which illustrates explic-
itly many of the theoretical results of Section 16-1. Rather than reading the two sections
sequentially, in series, you, the student, might find the material more interesting and in-
structive if you read Sections 16-1 and 16-2 together, in parallel.

16-1 General time-response stability criterion for linear, time-invariant systems

         For any linear, time-invariant (LTI), single-input-single-output (SISO) physical

system, we denote the input as u(t) [or r(t), the reference operator setting for controlled
systems] and the output as x(t). For an nth order system, in general, the input and output

are related by an ODE of the form

d n x d n-1x dx                            d mu d m-1u du
a1 n + a2 n-1 + K + an + an+1 x = b1 m + b2 m-1 + K + bm + bm+1 u (16-1)
dt       dt         dt                     dt         dt                 dt

Symbols a1,K, an+1 and b1,K,bm+1 are constants (with the numbering system keyed to
MATLAB notation), and m  n. With use of Eq. (2-16), especially for initial-condition
terms, the Laplace transform of Eq. (16-1) is

                                            n-1           n-2 dx              d n-1 x 
n(a1s + a2s + K + an s + an+1 )L[x(t)]- a1 s x(0) + sn-1          (0) + K + n-1 (0)

                                                          dt                  dt  

                   n-2             n-3 dx             d n-2x 
                  - a2 s x(0) + s          (0) +K + n-2 (0) -K - an x(0)          (16-2)
                                   dt                 dt
                                                          

                  = (b1sm + b2sm-1 +K+ bms + bm+1 )L[u(t)]

The initial-condition terms on the left-hand side are algebraically messy; it will suit our
purposes to combine together known ak constants and known initial conditions into con-
stant coefficients denoted as ICk , and to express the initial-condition terms in the follow-
ing simpler algebraic form, arranged in order of descending powers of s:

    IC1  64447IC24448                      644444447ICn44444448
                                                 n-1              n-2                   
678      n-1  dx         n-2               dx             dx
- a1x(0)s - a1 (0) + a2 x(0)s -K- a1 n-1 (0) + a2 n-2 (0) +K + an x(0)
          dt                                dt            dt                            

                   -IC1sn-1 - IC2sn-2 -K - ICn-1s - ICn

Therefore, we can express Eq. (16-2) in the algebraically simpler form,

                                   16-1
           Chapter 16 Introduction to system stability: time-response criteria

(a1s n + a2 s n-1 + K + an s + an+1 )L[x(t)]- IC1s n-1 - IC2 s n-2 - K - ICn-1s - ICn

                    = (b1sm + b2sm-1 +K+ bms + bm+1 )L[u(t)]                           (16-3)

The algebraic solution of Eq. (16-3) for the Laplace transform of the output is:

L[x(t)] =  IC1s n-1 + IC2 s n-2 + K + ICn-1s + ICn b1s m + b2 s m-1 + K + bm s + bm+1  L[u(t)]
                                          + n n-1
            n       n-1
            a1s + a2 s + K + an s + an+1  a1s + a2 s + K + an s + an+1

                                                                                       (16-4)

         It is appropriate now to examine the nature of transform solution (16-4). Let's re-
fer to the first term on the right-hand side as the "IC-response transform," and to the sec-
ond term as the "forced-response transform." Observe first that the coefficient of input
transform L[u(t)] in the forced-response transform is the system transfer function, from
Eq. (4-23),

                     L[x(t)] ICs=0 b1s m + b2 s m-1 + K + bm s + bm+1
            TF (s)       = n n-1                                                       (16-5)
                         L[u(t)] a1s + a2 s + K + an s + an+1

If the system is controlled with use of feedback, then Eq. (16-5) represents the closed-
loop transfer function, which we usually denote as CLTF(s). It is conventional to express
TF(s) in the following form, with both numerator and denominator polynomials factored:

b1s m + b2 s m-1 + K + bm s + bm+1 Num(s) b1 (s - z1 )(s - z2 )K(s - zm )=
TF (s) = n                                                                             (16-6)
               n-1
           a1s + a2 s + K + an s + an+1 Den(s) a1 (s - p1 )(s - p2 )K(s - pn )

The m roots zk of polynomial equation Num(z) = 0 are called the zeros of the transfer
function, since TF(s) = 0 if s equals any zk . The n roots pk of polynomial equation
Den(p) = 0 are called the poles of the transfer function, because TF(s)   if s equals
any pk . [Imagine the complex space surface TF(s) graphed as a function of coordinates
Re(s) and Im(s): for s in the vicinity of any pk , the surface will look something like that
of a circus tent near where it is held up by a structural pole; however, whereas the circus-
tent pole has finite length, the mathematical pole is infinitely long.]

         Observe next that both right-hand-side terms of Eq. (16-4) have in their denomi-
nators the term Den(s) defined in Eq. (16-6). This term is the key to system stability.
The nth degree polynomial equation Den(p) = 0 is the general1 characteristic equation of
the system, and its n roots are the poles pk , k = 1, 2, ..., n. System stability is determined
by the signs of the real parts of the poles. The general result is:

         If Re(pk) < 0 for all k = 1, 2, ..., n, then the system is stable. If, on
         the other hand, there is at least one pole for which Re(pk) > 0, then
         the system is unstable.

1 The characteristic equation of the free-vibration problem described in Chapter 12 is a specific form,
applicable only to undamped free vibration, of this general characteristic equation.

                         16-2
Chapter 16 Introduction to system stability: time-response criteria

In order to justify this general stability criterion, we shall continue the analysis of Eq.
(16-4) by deriving the inverse transform conceptually; however, it is appropriate first to
state the criterion above, without proof, so that you can see the simple yet very important
result of the analysis without being burdened by all the details of the derivation.

         First, let's review without proof some basic results from the theory of polynomial
equations with real coefficients, a subject covered in most algebra textbooks. The roots
of such equations are either real or complex. Moreover, complex roots always appear in
conjugate pairs. For example, if one of the roots of Den(p) = 0 is complex, pk =
 k + jk , where  k and k are real, then one of the other roots is the complex conju-
gate, pk+1 = pk =  k - jk .

         Returning to Eq. (16-4), let's evaluate first the IC-response transform. The nu-
merator polynomial is of degree less than n, that of the denominator polynomial, so we
can usually expand the entire term into simple partial-fraction form [see the discussion
surrounding Eq. (2-25)]:

IC1s n-1 + IC2 s n-2 + K + ICn-1s + ICn IC1s n-1 + IC2 s n-2 + K + ICn-1s + ICn n Ck
                                    =                                         =
a1s n + a2 s n-1 + K + an s + an+1           a1 (s - p1 )(s - p2 )K(s - pn )  k=1 s - pk

                                                                                 (16-7)

Right-hand-side constants Ck in Eq. (16-7) are called residues. Some relevant results
from the theory of fractions of polynomials with real coefficients are: if pole pk is real,
then the associated residue Ck also is real; if pole pk is complex, then the associated resi-
due Ck also is complex, and the residue associated with the complex conjugate pole pk+1
is the conjugate of Ck , Ck+1 = Ck . It will be useful in derivations that follow to express a
complex residue in polar form, Ck  Ck e jCk , in which Ck is the absolute value (as in

the MATLAB function abs), and Ck is the angle (as in the MATLAB function angle).

See Section 2-1 for a review of complex numbers and complex arithmetic.

         Taking the inverse transform of Eq. (16-7) to find initial-condition response, we
deal, in general, with two "Types" of terms: (1) terms that have real poles and real
residues; and (2) pairs of terms that have complex conjugate poles and complex
conjugate residues. The inverse of any Type 1 term is a simple real exponential, from
Eq. (2-14):

-1  Ck                                 pk t
L                                    = Ck e , Ck real, and pk real               (16-8)
 s - pk 

In Eq. (16-8), if pk < 0, then the term decays exponentially as time increases, which is
stable response. Such a term decays eventually to a static equilibrium state of zero; let's
call this exponential stability. However, if pk > 0, then the term is a permanently growing
exponential as time increases, which is unstable response. Finally, if pk = 0, then the term

                                       16-3
   Chapter 16 Introduction to system stability: time-response criteria

is constant in time; such response is bounded and therefore not unstable, which is good
for practical purposes; but it is also not so stable that it eventually decays to zero.

         Next, let's consider Type 2 terms, as defined above Eq. (16-8), and derive the in-
verse transform of a pair of terms that have complex conjugate poles and complex conju-
gate residues. In the following sequence of operations, we apply: first, Eq. (2-14); next,
identities derived in homework Problems 2.3(a) and 2.4; and, finally, Euler's equation,
Eq. (2-8):

      Ck 
[ ] -1 Ck         pk t        pk t  pk t    pk t                        pkt
L  +             = Cke + Cke = Cke + Cke = 2 × Re Cke
  s - pk s - pk 

                  [ ] [ ] ( ) = 2 × Re Ck e jCk e( k + jk )t = 2 Ck e kt × Re e j(k t+Ck )

                  = 2 Ck ekt cos(kt + Ck )                                   (16-9)

Equation (16-9)2 varies with time as a sinusoid modulated by an exponential envelope.
With respect to stability, the critical term is the exponential envelope, ekt , and its
character is determined by the sign of  k  Re( pk ) . If Re( pk ) < 0, then eRe( pk ) t is a de-

caying exponential, and the total response is a stable positively damped oscillation.
However, if Re( pk ) > 0, then eRe( pk ) t is a permanently growing exponential, and the total
response is an unstable ever-expanding oscillation. Finally, if Re( pk ) = 0, then eRe( pk ) t is

constant in time, and the total response is a sinusoid of constant magnitude; such re-
sponse is bounded and therefore not unstable; but it is also not so stable that it eventually
decays to a static equilibrium state, i.e., it is not exponentially stable.

         Now that we have derived the stability criterion for the IC-response terms of Eq.
(16-4), let's turn our attention to the forced-response transform,

L[x f (t)]  n n-1 b1s L m + b2 s m-1 + K + bm s + bm+1 [u(t)] = b1 (s - z1 )(s - z2 )K(s - zm ) L[u(t)]
a1s + a2 s + K + an s + an+1        a1 (s - p1 )(s - p2 )K(s - pn )

                                                                             (16-10)

We shall consider explicitly in this derivation only transfer functions for which the fol-
lowing practically common conditions apply: m < n; no pole is repeated; no zero equals
any pole. With these restrictions and with another restriction described in the next para-
graph, this particular derivation does not apply to all conceivable LTI systems. However,
the general derivation is more involved than necessary for our purposes. The stability
criterion that we shall derive applies to any LTI system, even though we will not prove it
in general. In Section 16-2, a specific, non-trivial system is analyzed in detail, in order to
illustrate all of the theory that is developed in this section.

2 When applying Eq. (16-9), you should assign the title of pk to the one root (of the complex conjugate pair
of roots) for which Im( pk)  k > 0, in order to define the oscillatory frequency as being positive. Then
you should assign the title of Ck to the residue that is associated with the root for which Im( pk) > 0.

                                                   16-4
          Chapter 16 Introduction to system stability: time-response criteria

         In order to find the conceptual inverse of Eq. (16-10), let's consider the nature of
transform L[u(t)] for physically common input functions u(t). In this derivation, we shall
consider explicitly only the type of input function whose Laplace transform is a fraction
of polynomials in the Laplace variable s, with the numerator polynomial being of lower
degree than the denominator polynomial. (However, the same stability criterion that we
derive for this special type of input function can be derived for any physically realizable
input function.) The following are simple examples of this type of input function, which
are defined to be non-zero only for t  0: ideal step H (t) , for which L[H (t)] = 1 s ; ex-
ponential-unit-impulse e-t   , for which L[e-t   ] = 1 ( s + 1) ; exponential-unit-step
1- e-t  , for which L[1 - e-t  ] = 1 [s( s + 1)] (see homework Problem 8.6 for a discussion

of the exponential-unit-step and exponential-unit-impulse functions); ramped exponential
pulse t e-t  , for which L[t e-t  ] = 1 (s + 1  )2 ; and sinusoid cost, for which L[cost] =

s (s 2 +  2 ) . Let's denote the Laplace transform of such input functions in a general

form:

L[u(t)]   Nu (s) d1s mu + d 2 s mu-1 + K + d mu s + d mu+1 d1 (s - w1 )(s - w2 )K(s - wmu )
          = nu nu-1               =
          Du (s) c1s + c2 s + K + cnu s + cnu+1 c1 (s - q1 )(s - q2 )K(s - qnu )

                                                                                 (16-11)

Constants ci and di are known coefficients of powers of s, and constants qi and wi are, re-
spectively, poles and zeros of the input transform. Keep in mind that we assume Nu(s) in
Eq. (16-11) to have lower degree than Du(s), mu < nu .

         Proceeding with the conceptual forced-response solution, we substitute Eq. (16-
11) into Eq. (16-10):

L[x f (t)] = b1 (s - z1 )(s - z2 )K(s - zm ) × d1 (s - w1 )(s - w2 )K(s - wmu )  (16-12)

            a1 (s - p1 )(s - p2 )K(s - pn ) c1 (s - q1 )(s - q2 )K(s - qnu )

Forced-response transform (16-12) is a fraction of polynomials in s, with numerator poly-
nomial degree m + mu being less than denominator polynomial degree n + nu. Therefore,
we can, in principle, usually expand (16-12) into the following form, in which terms that
are associated explicitly with the transfer-function poles have simple partial-fraction
form, including residues CU k :

          L[x f (t)] = n CU k     + F(s;qi )                                     (16-13)

                     k =1 s - pk

The symbol F (s ; qi ) denotes terms associated explicitly with poles qi of the input trans-
form. Depending upon the specific nature of L[u(t)], these terms might or might not
have simple partial-fraction form. In any case, the terms in F (s ; qi ) have the same poles
qi as the input transform, which are always stable poles, so these terms cannot produce

                       16-5
Chapter 16 Introduction to system stability: time-response criteria

instability. Therefore, instability of the forced-response can exist only in the terms

  n

 CU k (s - pk ) , i.e., the terms containing the poles of the system transfer function.

 k =1
                                                                             n

      The forced-response terms CU k (s - pk ) are identical in form to the IC-re-
                                                                           k =1
                               n

sponse terms Ck (s - pk ) of Eq. (16-7). Recall that the analysis of stability for IC-
                              k =1

response [Eqs. (16-8) and (16-9) and the associated discussion] was based upon that
form. Therefore, the analysis of stability for forced-response is identical to that for IC-
response, so we need not repeat it. However, it is worth repeating, for emphasis, the gen-
eral stability criterion for LTI systems that has been derived (albeit, not generally) here:

         For an nth order LTI system, the poles of the transfer function are
         denoted as pk, k = 1, 2, ..., n. If Re(pk) < 0 for all k = 1, 2, ..., n,
         then the system is stable. If, on the other hand, there is at least one
         pole for which Re(pk) > 0, then the system is unstable.

         Observe from the derivation that the stability or instability of an LTI system does
not depend upon ICs or forcing--it is an intrinsic property of the system. However, by
referring to general transform solution (16-4), one might make the mathematical argu-
ment that if all initial conditions were zero, and if forcing input u(t) also were zero, then
the solution would be x(t) = 0, and therefore even a system that has an unstable pole,
Re(pk) > 0, would be stable if there were no stimulus. In physical reality, though, there is
always some perturbation or excitation, no matter how small, acting upon a system; and
even the tiniest IC or forcing input, which would be negligible for a stable system, will
always be enough to provoke the instability of an unstable LTI system.

16-2 Stable and unstable PD-controlled-rotor systems

         In this section, we analyze in detail a specific example of the theory developed in
Section 16-1. The situation considered is ideal proportional-derivative (PD) control of
position (t) of a rotor with significant inertia J, as described in Section 15-4 and home-
work Problem 15.1. The sensitivity of identical input and output-feedback transducers is
denoted Kr = K , moment actuator sensitivity is Ka, and, for the ideal PD controller, pro-
portional gain is P and derivative time constant is d . The transfer function of this sys-
tem, from Eqs. (15-27) and (15-28), is

     (s) n 2 ( d s + 1)
     =2                                                              (16-14)
     R(s) s + 2n s + n                                2

with 2nd order-system standard parameters defined as

n =  KrKaP  and  = 1 n d                                 (15-28) repeated
        J               2

            16-6
Chapter 16 Introduction to system stability: time-response criteria

         The first useful thing that we can do with transfer function (16-14) is infer the
system ordinary differential equation (ODE) by inverse Laplace transformation:

   [s 2 + 2n s + n 2 ](s) =[n 2 ( d s + 1)] R(s)  && + 2n& + n 2 = n 2 ( d r& + r)
                                                                                                   (16-15)

Recall that the transfer function is based upon zero ICs for the output. But we want to
account for ICs now, so let's take the complete Laplace transform of the ODE, including
the possibly non-zero ICs, initial rotation rate &(0)  &0 and initial position  (0)  0 :

              [s 2 + 2n s + n 2 ](s) - s0 - &0 - 2n0 =[n 2 ( d s + 1)] R(s) (16-16)

The solution of Eq. (16-16) for the output transform is

       0 s + (&0 + 2n0 ) n 2 ( d s + 1)
       (s) = 2                 2 +2                      2 R(s)        (16-17)
       s + 2n s + n s + 2n s + n

Compare specific transform solution (16-17) with the general form (16-4). Next, let's
factor the denominator polynomial of the transfer function. It is convenient for this pur-
pose to assume that  < 1, and to define the positive, real, damped natural frequency as

d = n 1 -  2 . You can easily derive from the quadratic formula (or just substitute in
the right-hand side to verify) the factoring:

s 2 + 2n s + n 2 = (s - p)(s - p) , where the complex pole is p = -n + jd (16-18)

Hence, we re-write transform (16-17), and express it in terms of IC-response and forced-
response components:

(s) =  0 s + (&0 + 2n0 ) n 2 ( d s + 1)
                            +                 R(s)  ic (s) +  f (s)    (16-19)
       (s - p)(s - p) (s - p)(s - p)

The IC-response term of Eq. (16-19) is expanded into partial-fraction form:

       ic (s)  0 s + (&0 + 2n0 ) = C + C                               (16-20)
                     (s - p)(s - p) (s - p) (s - p)

Using the conventional labor-saving partial-fraction-expansion method of Sections 2-2
and 2-3, and p = -n + jd from Eq. (16-18), and a little algebra, we find the follow-

ing complex residue of Eq. (16-20):

C = [(s - p)ic (s)]s= p = 0 p + (&0 + 2n0 )   1          &0 + n0     
                                             = 0 - j                   (16-21)
                            (s - p)         s=p 2                d 
                          

                               16-7
             Chapter 16 Introduction to system stability: time-response criteria

Hence, substituting Eqs. (16-18) and (16-20) into inverse transform (16-9) gives the IC-
response [with C given by Eq. (16-21)]:

                ic           (t)  =    -1   (s)]  =  2C  e -n t  cos(d  t  +  C)                       (16-22)

                                     L [ic

         Next, let's derive the forced response of this controlled system to a specific, non-
trivial input, the ramped exponential pulse r(t) = Rp (t  ) e-t  , the maximum value of
which is rmax = r(t =  ) = Rp e-1 . The Laplace transform of this pulse is R(s) =

(Rp  ) (s + 1  )2 . The transform of the forced response, from Eq. (16-19), is

L[ f (t)] =  n 2 ( d s + 1)  R(s) =  n 2 ( d s + 1)        Rp    2 = Rp    n2     ds +1

                                                                                                              2
             (s - p)(s - p)          (s - p)(s - p) (s + 1  )                  (s - p)(s - p)(s + 1  )

                                                                                                       (16-23)

The fraction of polynomials in Eq. (16-23) can be expanded in the following form:

               n2                           ds +1          2 = CR + CR + 2 A + B

L[ f (t)] Rp  Ff (s) =               (s - p)(s - p)(s + 1  ) s - p s - p (s + 1  ) s + 1 
             

                                                                                                       (16-24)

CR, A, and B are constants that we need to find. We have not previously encountered a
case of repeated poles such as this. The last two right-hand-side terms in Eq. (16-24)
show the form that a partial-fraction expansion must have for repeated poles (Ogata,
1998, p. 33). We find complex residue CR using the conventional method:

             CR = [(s - p) Ff (s)]s= p =             2  d p + 1 =             d p +1                   (16-25)

                                                                                                    2
                                            ( p - p)( p + 1  ) j 2d ( p + 1  )

in which p = -n + jd . To find constants A and B, it is useful to multiply through Eq.
(16-24) by the denominator factor with repeated poles (Ogata, 1998, p. 33):

(s + 1  )2 Ff (s) =  d s + 1 = (s + 1  ) 2  CR +  CR  + A + (s + 1  ) B (16-26)
               (s - p)(s - p)                              s- p s- p

From Eq. (16-26), we easily find constant A using the conventional method:

       A = [(s +1  )2 Ff (s)]s=-1  = - d  +1 (-1  - p)(-1  - p) = 1- d  (1  + p)(1  + p) (16-27)

Finding constant B is expedited by first differentiating Eq. (16-26) with respect to s, so
that constant B stands alone in the last right-hand-side term:

                                                     16-8
    Chapter 16 Introduction to system stability: time-response criteria

    dds [(s +1  )2 Ff (s)]= [(s - p)(s - p)]2 (s - p)(s - p) d - ( d s +1)(2s - p - p)

                      d         2 CR CR 
                   =  (s +1  )        +             + B                                 (16-28)
                      ds         s - p s - p 

                   = 2(s +1  ) CR +  CR  + (s +1  )  2 d  CR +  CR  + B
                             s- p s- p                            ds  s - p s - p 

Hence, we find constant B by evaluating Eq. (16-28) at s = -1  :

          (s - p)(s - p) d - ( d s + 1)(2s - p - p) 
         B=                                              
                             [(s - p)(s - p)]2           s=-1 

          = [(1  + p)(1  + p)]2 (1  + p)(1  + p) d + (1 - d  )(2  + p + p)              (16-29)

Even though p is complex, p = -n + jd , the constants A in Eq. (16-27) and B in Eq.
(16-29) turn out to be real. The factors that appear to be complex are: (1  + p)(1  + p)
= (1  - n + jd ) (1  - n - jd ) = (1  - n )2 + d 2 , which is real; and 2  +
p + p = 2 (1  - n ) , which also is real. Thus, the final, more clearly real formulas for
constants A in Eq. (16-27) and B in Eq. (16-29) are

A=  1-d            2 , B=  [(1  - n )2 + d 2 ] d + 2(1 -  d  ) (1  - n )                (16-30)

    (1  - n ) + d2                                 2              22
                                  [(1  - n ) + d ]

With complex residue CR from Eq. (16-25), and real constants A and B from Eq. (16-30),
the forced-response equation is found from the inverse transform of Eq. (16-24):

             n -1 2 n -n t -t  2

 f (t) = Rp L [Ff (s)] = Rp [2 CR e cos(d t + CR) + ( At + B) e ](16-31)
                           

The terms ( At + B) e-t  in Eq. (16-31) are associated with the poles of the forcing func-
tion r(t) = Rp (t  ) e-t  . Observe that these terms vary in time similarly to r(t) , but that

they have no influence over the positive or negative stability of the system. Only the ex-
ponential function e-n t , which is in the term associated with the system (transfer-func-
tion) poles, determines the state of system stability.

         The complete output equation is the combination of IC-response (16-22) and
forced-response (16-31):

                            (t) = ic (t) +  f (t)                                       (16-32)

                                16-9
               Chapter 16 Introduction to system stability: time-response criteria

         Let's calculate and plot responses for a particular system. The basic parameters
are: rotor inertia J = 0.00256 lb-sec2-inch (the inertia of a small aluminum wheel about

four inches in diameter); and product of sensitivities Kr Ka = 0.0350 lb-inch/radian. Let's
specify for the closed-loop system: undamped natural frequency fn = n / (2) = 1.0 Hz
(so that step-response rise time would be around ¼ sec); and damping ratios  = + 0.12
for a case of positive stability, and  = - 0.03 for a case of instability. The MATLAB M-
file below uses Eq. (15-28) to calculate the proportional gain P = n2J / (Kr Ka) = 2.888
and the derivative time constants  d = 2 / n = 0.0382 sec and -0.00955 sec listed in the

alphanumeric output for the two different cases.

         In order to have non-trivial initial conditions, let's specify initial rotation rate
&(0)  &0 = -0.29 rad/sec and initial position  (0)  0 = -0.025 radian. For the ramp-
ed-exponential input function r(t) = Rp (t  ) e-t  , let's specify magnitude Rp = 0.1 × e

radian = 0.2718 radian and time constant  = 1.5 sec, so that rmax = Rp e-1 = 0.1 radian at

time t = 1.5 sec. (Most of the input values specified above were chosen by trial and error
to produce clear and instructive graphical output.)

         A MATLAB script M-file for computing and graphing the response follows:

%MATLABdemo161.m
%Stability of a PD-controlled rotor
%Excitation with initial conditions and a ramped exponential pulse
J=2.56e-3;KrKa=0.035;fn=1;wn=2*pi*fn;P=wn^2*J/KrKa;
disp('P ='),disp(P)
zeta=[0.12 -0.03];
for nc=1:2;
zt=zeta(nc);wd=wn*sqrt(1-zt^2);p=-zt*wn+j*wd;Td=2*zt/wn;
disp('Case #, zeta, Td, p ='),disp([nc zt Td p])
%Initial-condition response
th0=-0.025;dth0=-0.29;
C=(th0-j*(dth0+zt*wn*th0)/wd)/2;abC=abs(C);anC=angle(C);
t=0:.05:10;
thic=2*abC*exp(-zt*wn*t).*cos(wd*t+anC);
%Forced response
Rp=0.1*exp(1);tau=1.5;r=Rp/tau*t.*exp(-t/tau);
CR=(Td*p+1)/(j*2*wd*(p+1/tau)^2);abCR=abs(CR);anCR=angle(CR);
c1=1-Td/tau;c2=1/tau-zt*wn;c3=c2^2+wd^2;A=c1/c3;
B=(c3*Td+2*(1-Td/tau)*c2)/c3^2;
thf=Rp*wn^2/tau*(2*abCR*exp(-zt*wn*t).*cos(wd*t+anCR)+(A*t+B).*exp(-t/tau));
subplot(2,1,nc),plot(t,thic+thf,t,r),grid
end

The command to execute the M-file, and the resulting alphanumeric output and graphical
output (after use of MATLAB's editing features for annotation and graphical enhance-
ment) are:

>> MATLABdemo161

P =
       2.8876

Case #, zeta, Td, p =

1.0000                 0.1200  0.0382  -0.7540 + 6.2378i

                               16-10
        Chapter 16 Introduction to system stability: time-response criteria

Case #, zeta, Td, p =

2.0000  -0.0300        -0.0095  0.1885 + 6.2804i

         Figure 16-1 Ramped-exponential input operator setting r(t) and output
        rotor positions (t) for an ideal proportional-derivative (PD) controlled
         rotor, with two different derivative time constants

         Case 1 of Fig. 16-1 displays good performance of the PD control system: despite
rather adverse initial conditions, the output follows the input nicely, especially after the
initial transient response has decayed. In normal engineering practice, derivative time
constant  d would probably be set considerably higher than in this academic case, which
would suppress the transient oscillation even more quickly and produce even better con-
trolled response.

         Case 2, on the other hand, exhibits a serious dynamic instability, which would be
unacceptable in normal engineering practice. Note the different y-axis scales for Cases 1
and 2. In real life, the oscillations would continue to grow exponentially until some me-
chanical or electrical part would fail (possibly a protective fuse that is designed to fail
under excessive load), or some mechanical governor would limit motion, or some electri-
cal component (e.g., an op-amp) would saturate, or until the control system would some-
how be disabled intentionally. This example demonstrates that feedback control systems
can be dangerous; engineers should design and test any feedback control system with
great care in order to make certain that it is positively stable and safe.

                                                  16-11
Chapter 16 Introduction to system stability: time-response criteria

16-3 Routh's stability criteria

         We denote the transfer function of an nth order LTI system as TF (s) = Num(s) ,
                                                                                                 Den(s)

in which Den(s) is an nth degree polynomial in s. As derived in Section 16-1, the system
is stable or unstable depending upon the signs of the roots of the characteristic equation,

Den( p) = a1 p n + a2 p n-1 + L + an p + an+1 = 0                    (16-33)

For positive stability, we must have Re(pk) < 0 for all roots, k = 1, 2, ... , n. The roots are
dependent upon the polynomial coefficients a1 , a2 , ... , an , an+1 , so it would seem that
the state of stability could be determined directly from these coefficients, without the ne-

cessity of calculating the roots. This is indeed the case, and the conditions that these co-

efficients must satisfy for positive stability are known as Routh's stability criteria (after

Edward John Routh, 1831-1907, English mathematician, physicist, and educator, who

developed the systematic framework). These quantitative criteria can be written for a

system of any order n, but they become progressively more complicated as n increases.
For that reason, we examine in this section only the criteria for 1st, 2nd, and 3rd order sys-
tems; Routh's criteria for 4th order systems are presented in homework Problem 16.9(c).

         The first requirement for a system of any order, for the system to be posi-

tively stable, is that all coefficients of characteristic equation (16-33) be non-zero

and have the same sign. This is a necessary condition but, for n > 2, not a sufficient
condition for stability. Consider the simplest case, any 1st order system:

Den( p) = a1 p + a2 = 0  p = - a2                                    (16-34)
                                           a1

It is clear that p < 0 if a1 and a2 are both non-zero and of the same polarity, so no other
condition is required for stability. Consider next any 2nd order system:

Den( p) = a1 p 2 + a2 p + a3 = 0                                     (16-35)

The quadratic formula gives the following roots of Eq. (16-35):

p1,2 = - a2 ±                                 2                      (16-36)
         2a1
                                  a2  a3
                                   -
                                  2a1  a1

Careful study of Eq. (16-36) shows that these roots have negative real parts only if a1 , a2
and a3 all are non-zero and have the same sign. Therefore, for the 2nd order system, the
requirement that all three polynomial coefficients be non-zero and have the same sign is a
sufficient as well as necessary condition for stability. Note that a2 = 0 means the system
has zero damping; if, in addition, a1 and a3 have the same sign, then the free-vibration

                                 16-12
Chapter 16 Introduction to system stability: time-response criteria

response of the system is pure sinusoidal oscillation (at the natural frequency) with
constant amplitude. In this case, the system is not unstable, since the response is
bounded, but it is also not exponentially stable; the response does not decay away to a
static equilibrium state.

         Finally, let's consider the more challenging 3rd order system:

                   Den( p) = a1 p3 + a2 p 2 + a3 p + a4 = 0          (16-37)

For the system to be stable, a1 , a2 , a3 and a4 all must be non-zero and have the same sign.
The other requirement for positive stability of a 3rd order system establishes upper
and lower bounds on the product a1 × a4:

                   a2 × a3 > a1 × a4 > 0                             (16-38)

The derivation of these two Routh criteria for stability of a 3rd order system is relatively
simple, but more lengthy than necessary for our study; it is presented clearly by Cannon,
1967, pages 406-409.

         Let's evaluate Routh's stability criteria applied to the 3rd order system depicted on
Fig. 16-2. It is similar to the system of Section 14-3 for output-position-feedback control
of rotor position, but there are two additions to that system. First, there is bearing friction
that produces a passive rotational moment, - c& , with c being the viscous damping

constant. Second, there is, in the feedback branch downstream of the position sensor, an
electrical 1st order low-pass filter with time constant L. The filtering of sensor voltage
signals in this fashion is very common in practice. The usual purpose for low-pass fil-
tering is to cut out high-frequency electrical components from the sensor signal. Such
unwanted components might arise from the electronics in a "noisy" sensor, from stray
electromagnetic fields and/or improperly shielded electrical cables, and even from extra-
neous mechanical vibrations. So the amplitude-reduction function of a low-pass filter is
almost always beneficial to control-system functioning. However, a low-pass filter also
changes the phase of sensor signals, as well as reducing the amplitude of high-frequency

Operator           Moment                 Ma (t)                 Output
setting            actuator                          J           position
r (t) Transducer                                                  (t)
                     K a
              K r                                            c

                   Low-pass               Position
                      filter               sensor
                       L
                                            K 

Figure 16-2 Functional diagram of a rotor position-feedback control
system with a 1st order low-pass filter in the feedback branch

                   16-13
             Chapter 16 Introduction to system stability: time-response criteria

noise, as shown on Fig. 4-1. Phase shifts can produce adverse effects on control systems,

including reduction of control effectiveness and degradation of system stability, even to
instability. From Fig. 4-1, we see that the extreme phase shift introduced by a 1st order

low-pass filter is -90°, and we can think of this as "almost changing the sign" of the sig-

nal that goes through the filter. According to Routh's criteria, the change of a sign can

produce instability. (The effect on stability would be even more dramatic if there were a
2nd order, rather than 1st order, low-pass filter in the feedback branch, Fig. 10-2 with  >
0.5; the extreme phase shift produced by a 2nd order filter is -180°, which is a complete

sign change in the signal that goes through the filter. See homework Problem 16.5.)

         The ODE of motion for the damped rotor comes from Eq. (3-1): J p& + c p =
J&& + c& = M a (t) . With the notation L[ (t)]  (s) , the Laplace transform for zero ICs

of the ODE of motion is (J s 2 + c s)(s) = L[M a (t)] , so that the transfer function of the

basic damped-rotor plant is

                                   (s) = 2 1                                      (16-39)
                                 L[M a (t)] J s + c s

With plant transfer function Eq. (16-39) and low-pass-filter transfer function Eq. (13-3),

Fig. 16-3 is the Laplace block diagram for the system of Fig. 16-2. The branch transfer

functions for the loop in Fig.

16-3 are G(s) = 2K a and Kr + _ R(s)                          1                   (s)
                     J s + c s                         Ka J s2 + c s

H (s) = K .    Hence, with                             1
        Ls +1
                                                       Ls +1  K

use of Eq. (14-16), we find the  Figure 16-3 Laplace block diagram of position-
following closed-loop transfer   feedback control system with low-pass filtering
function:

(s) = K r × NG DH                = K r × 2 K a ( L s + 1)
R(s)           DG DH + NG N H           (J s + c s)( L s + 1) + K a K

Algebraic manipulation of this transfer function casts it into the following more useful
forms:

(s) = Kr Ka             s +1L    = KrKa                       s +1L
R(s) J         c  1  K a K            J
             s s +  s +  +               s3 +  1 +  c  s 2 + c 1 s + K a K
               J   L  J L                              L J    J L                 J L

                                                                                  (16-40)

The two final algebraic forms of Eq. (16-40) are intended to expedite both evaluation by
Routh's criteria next and by a more general analysis of stability in Section 16-4.

                                 16-14
Chapter 16 Introduction to system stability: time-response criteria

From transfer function (16-40), we find the characteristic equation:

Den( p)  a1 p3 + a2 p 2 + a3 p + a4 = p3 +  1 +  c  p 2 + c 1 p + K a K = 0 (16-41)
                  L J                 J L  J L

Routh's first set of criteria for positive stability requires that all polynomial coefficients
be non-zero and of the same sign. Since a1 = 1, the following inequalities are necessary
but not sufficient conditions for positive stability:

a2 = 1 + c > 0 ,  a3 = c 1 > 0 , and  a4 = KaK > 0                             (16-42)
     L J                J L                  J L

Rotational inertia J and filter time constant L should always be positive physical con-
stants, so Eqs. (16-42) require for positive stability that damping constant c must be
positive, and that the product of sensitivities KaK must be positive. Routh's final re-
quirement for positive stability of a 3rd order system is Eq. (16-38):

a2 × a3 > a1 × a4 > 0   1 +  c  c 1 > K a K > 0   1 +  c  c > K a K > 0
  L J  J  L J L                       L J  J J

                                                                      (16-43a)

The common factor 1  L was removed to produce the final form of Eq. (16-43a).

        Let's suppose that parameters J, c , and L are positive and fixed, but that the
positive product of sensitivities KaK is a control gain which we have the ability to vary
in order to modify the performance and/or stability of the control system. It will be con-
venient for continued analysis to define a special symbol that denotes the varying fraction
in Eq. (16-43a) and to express the stability requirement in terms of that symbol:

K a K     1 +  c  c >  > 0                                            (16-43b)
J                 L J  J

         Equation (16-43b) establishes upper and lower stability boundaries for KaK / J 

. To illustrate, let's express the stability criterion numerically for some plausible sys-

tem values. Suppose that the circular break frequency of the low-pass filter is b  1/L =
300 rad/sec, corresponding to cyclic break frequency fb = b / 2 = 47.75 Hz, a realistic

value for a low-pass filter used in the control of a mechanical system. Suppose also that
the plant parameters have values such that c / J = 100 sec-1. Substituting these constants
into Eq. (16-43b) gives the criterion: 40,000 sec-2 >  > 0 for positive stability.

         To test the correctness of Routh's criteria, let's calculate with MATLAB some re-
sponses of this system to the initial condition (0)  0 = 0.1 radian, with all other ICs
zero and with zero input, r(t) = 0. Let's find the IC response for these three cases:

                  16-15
Chapter 16 Introduction to system stability: time-response criteria

Case I  I = 0.75 ×  1 +  c  c = 30,000 sec-2; this should give stable response.
                      L J  J

Case II  II  1.00 ×  1 +  c  c = 40,000 sec-2, the upper boundary of stability;
                        L J  J

         but  is supposed to be less than 40,000 sec-2 for stability (not equal to it), so

         what will be the nature of this response?

Case III  III = 1.25 ×  1 +  c  c = 50,000 sec-2; this should give unstable response.
                         L J  J

         To solve for IC responses of this system, we adapt Eq. (16-2) to this problem. A
little algebra leads us from Eq. (16-2) to the following transform of the IC response:

        0 (a1s 2 + a2 s + a3 )
(s) = 3                                                                (16-44)
        a1s + a2 s + a3s + a42

The ak constants in Eq. (16-44) are defined in Eq. (16-42), and the numerical parameters
are given in the paragraph following Eq. (16-43b). For the numerical values of Cases I,
II, and III described above, the partial-fraction expansion of Eq. (16-44) has the form

3 Ck       C1        C2            C2
(s) =   =         +             +                                      (16-45)
k=1 s - pk s - p1 s - p2 s - p2

in which residue C1 and pole p1 are real constants, with p1 negative for all three cases,
and residue C2 and pole p2   2 + j2 are complex constants. Therefore, from Eqs.
(16-8) and (16-9), the time response has the form

 (t) = C1 e p1t + 2 C2 e2 t cos(2 t + C2 )                             (16-46)

         The MATLAB script M-file below computes the constants of transform (16-45),
using MATLAB's residue operation (see homework Problem 2.15), and it computes
and plots time response (16-46).

%MATLABdemo162.m
%Stability of a damped rotor with low-pass-filtered position feedback
%Excitation with initial position
wb=300;covrJ=100;a2=wb+covrJ;a3=wb*covrJ;Lmub=a2*covrJ;
th0=0.1;t=0:0.0004:0.16;format short e,figure,hold
Lm=[0.75 1 1.25]*Lmub;
for nc=1:3;

       a4=Lm(nc)*wb;
       Num=th0*[1 a2 a3];Den=[1 a2 a3 a4];[C,p,k]=residue(Num,Den);
       disp('Case #, Lambda ='),disp([nc Lm(nc)])
       disp('Poles p ='),disp(p.'),disp('Residues C ='),disp(C.')
       sig=real(p(2));wd=imag(p(2));abC=abs(C(2));anC=angle(C(2));
       th=C(1)*exp(p(1)*t)+2*abC*exp(sig*t).*cos(wd*t+anC);
       plot(t,th,'k')

           16-16
                Chapter 16 Introduction to system stability: time-response criteria

end
grid,xlabel('Time t (sec)'),ylabel('Position \theta (t) (radian)')
title('Response of a 3^r^d order system with different control gains')

The command to execute the M-file, and the resulting alphanumeric output and graphical
output (after use of MATLAB's editing features for annotation and graphical enhance-
ment) follow:

>> MATLABdemo162
Current plot held

Case #, Lambda =       30000
                    1

Poles p =                     -8.4887e+000 +1.5305e+002i -8.4887e+000 -1.5305e+002i
 -3.8302e+002                  4.2823e-002 -2.0336e-002i 4.2823e-002 +2.0336e-002i

Residues C =                  -4.3965e-014 +1.7321e+002i -4.3965e-014 -1.7321e+002i
   1.4354e-002                 4.2105e-002 -1.8232e-002i 4.2105e-002 +1.8232e-002i

Case #, Lambda =       40000   7.4222e+000 +1.9001e+002i 7.4222e+000 -1.9001e+002i
                    2          4.1568e-002 -1.6786e-002i 4.1568e-002 +1.6786e-002i

Poles p =
 -4.0000e+002

Residues C =
   1.5789e-002

Case #, Lambda =       50000
                    3

Poles p =
 -4.1484e+002

Residues C =
   1.6864e-002

Figure 16-4 Initial-condition response of a rotor output-position-feedback
control system with a 1st order low-pass filter in the feedback branch

                                         16-17
                     Chapter 16 Introduction to system stability: time-response criteria

         For this system with three poles, at least one pole must be real. For Cases I, II,
and III evaluated above, this real pole, p1 , turns out to be strongly negative, so it does not
contribute to any instability. The second pole, p2 , is complex, and the third pole is the
conjugate of the second. (The other possibility for a 3rd order system is that all three
poles can be real, but the gains  used in this example preclude that.) For gain I ,
Re(p2) is negative; consequently, the Case I system is positively stable, as predicted by
Routh, Eq. (16-43b). For gain III , Re(p2) is positive; consequently, the Case III system
is unstable, also as predicted by Routh. Gain II is on the upper boundary between
positive and negative stability, according to Routh, and the alphanumeric output above
shows that Re(p2) = 0. (The tiny number calculated, -4.4e-14, is non-zero due to round-
off error; comparison of this number with the values of the other poles shows that it is
effectively zero.) We see from Fig. 16-4 that the time response associated with Case II is
a pure, undamped sinusoid; the response is bounded, therefore not unstable, but it is not
exponentially stable, i.e., it does not decay to zero.

         The control system of Figs. 16-2 and 16-3 has two major dynamic sub-systems:

the damped rotor with transfer function 1 [s(J s + c )]; and the low-pass filter with trans-

fer function 1 ( L s + 1) . Each of these passive sub-systems by itself dissipates energy,
i.e., acts as an energy sink, and is positively stable. But the complete system is clearly
capable of being unstable. The complete system includes an energy source, the moment
actuator, and therefore is said to be active. Any system that includes feedback and an en-
ergy source is potentially capable of being unstable.

         Observe that Routh's criteria essentially tell us only that a system is stable or un-
stable, the nature of stability in an absolute sense. They do not tell us the type of re-
sponse (monotonic-exponential or oscillatory) or the degree of stability (essentially, the
magnitudes of the real parts of transfer-function poles), which is also known as relative
stability. The method introduced in the next section finds the relative stability.

16-4 Loci of roots for 2nd order systems

         Let's seek both the type of response and the degree of stability, by directly solv-
ing for the roots of the characteristic equation Den(p) = 0 [i.e., the poles of TF(s) or
CLTF(s), whichever is appropriate]. Further, we will observe how these roots vary as
some particular system parameter is changed. The graphical representation of this varia-
tion in the complex p-plane is known commonly as locus of roots; however, systems of
2nd and higher orders always have multiple roots, so it is more correct to use the Latin
plural: loci of roots. Stability analysis using loci of roots is more general than the basic
Routh's criteria, and more informative about the character of a system and the nature of
its stability.

         We begin by studying the roots of any 2nd order system. This will be instructive
and will also establish the basis for interpretation of loci-of-roots graphs for LTI systems
of higher order. The characteristic equation of any 2nd order system can be expressed as:

                                                  16-18
Chapter 16 Introduction to system stability: time-response criteria

                  Den( p) = p 2 + 2n p + n 2 = 0                             (16-47)

Some examples of 2nd order system transfer functions that lead to Eq. (16-47) are Eqs.
(10-6), (10-27), (13-8), (14-21), (15-20), and (15-27). We are accustomed to studying
stable systems for which  and n2 are positive values. However, these parameters are
not necessarily always positive in systems; they can be negative, especially for feedback
control systems and for self-excited systems. An example of a self-excited system is a
flexible wing in an airstream, as discussed in Examples 11-2 and 11-3 of Section 11-3.

        First, let's study the roots of Eq. (16-47) when  varies, in both magnitude and
sign, while n is fixed and positive, n > 0. Solving first for    1, using the quadratic
formula, gives the two real-valued poles:

                  p1,2 = -n ± n  2 - 1                               (16-48a)

For    1, the poles are the complex conjugate pair:

p1,2 = -n ± jn 1 -  2  -n ± jd                                       (16-48b)

Figure 16-5 shows the loci of roots Eqs. (16-48) as  varies from more negative than -1
to more positive than +1. Note that the x-axis is the real part of the roots, Re(p), and the

                  Im(p), sec-1

                      =0

+1 >  > 0         n             0 >  > -1

Break-in point    sin-1 n d                             Break-away point
        > +1          > +1 -1 >                          -1 >  Re(p), sec-1
            = +1                                      = -1
                                 increasing 

+1 >  > 0                       0 >  > -1
         Stable       =0

                           Unstable

                                              Sinusoidal
            Figure 16-5 Loci of roots of p2 + 2n p + n2 = 0 as  varies from
            less than -1 to greater than +1, with n > 0 held constant

y-axis is the imaginary part, Im(p); these two axes encompass the complex p-plane. For
selected values of , the roots are indicated by ×'s and the  values are labeled. The
directions of the loci as  increases are indicated by arrowheads.

                     16-19
                     Chapter 16 Introduction to system stability: time-response criteria

        For -1 > , the two real roots, (16-48a), are in the right ("east") half of the p-
plane, on the Re(p) axis; the type of time response associated with these roots is mono-
tonically growing exponential, an instability. At  = -1, these two real roots come to-
gether with value +n ; this is called a "break-away" point because, for the slightest in-
crease in  above -1, the roots separate into complex conjugates, (16-48b), one root
headed directly "northward" and the other directly "southward." The type of response
associated with complex conjugate roots that are in the right half-plane off the Re(p) axis
is oscillation modulated by a growing exponential envelope, an instability. For +1 >  >
-1, the loci of roots form a perfect circle of radius n and centered on the origin:
x2 + y 2 = (-n )2 + (±d )2 = n 2 . The roots for  = 0 are imaginary, p1,2 = ± jn ,
for which the time response has pure, undamped sinusoidal form. For +1 >  > 0, the
complex conjugate roots are in the left ("west") half-plane off the Re(p) axis; the type of
time response associated with these complex conjugate roots is oscillation modulated by
a decaying exponential envelope, which is stable response. As increasing  approaches
the value +1, the two complex roots come together and become real, with value -n , at
the "break-in" point. Finally, as  increases above +1, one real root heads farther west-
ward on the Re(p) axis, and the other creeps eastward toward the origin; the type of time
response associated with these real roots in the left half-plane is monotonically decaying
exponential, which is stable response.

         Keep in mind that both monotonic-exponential response and oscillatory response
are bounded by the exponential envelope eRe( p) t . If Re(p) < 0, in the left half-plane, then
we define, as in Eq. (9-22), the 2nd order time constant,  2  -1 Re( p) > 0, so that the
decaying exponential envelope is e-t 2 ;  2 is the time for the stable exponential envelope
to decrease by the factor e-1 . The degree of positive stability associated with a particular
stable root increases as Re(p) becomes progressively more negative and  2 becomes pro-
gressively smaller. In other words, the farther westward from the origin that a pole is lo-
cated, the greater is the degree of positive stability associated with that pole. On the other
hand, if Re(p) > 0, in the right half-plane, then + 1 Re( p) is the time for the unstable
exponential envelope to increase by the factor e+1 . The degree of instability associated
with a particular unstable root increases progressively as Re(p) becomes progressively
more positive; in other words, the instability worsens as the unstable pole moves farther
eastward from the origin. Although these observations are made in the context of Fig.
16-5, they are equally applicable to the loci of roots of any LTI system having any order.

         Note on Fig. 16-5 the construction of a right triangle consisting of horizontal leg
n , vertical leg d , and hypotenuse n , which extends from the origin to a complex
pole p. This right triangle is based on the definition d 2 = n 2 (1 -  2 ) = n 2 - (n )2 ,
which is valid for   < 1. Thus, the frequency of vibration (in rad/sec) associated with
this particular complex pole is the vertical leg d along the Im(p) axis. Further, the hori-
zontal leg n (if in the left half-plane) determines the time constant,  2 = 1 n (in sec).
Finally, the value of damping ratio  is the sine of the angle labeled on Fig. 16-5 between

                                                  16-20
Chapter 16 Introduction to system stability: time-response criteria

the Im(p) axis and hypotenuse n ; for a stable pole p in the left half-plane, as drawn on
Fig. 16-5,  is positive; for an unstable pole p in the right half-plane,  would be nega-
tive. Although this derivation is based on Fig. 16-5, these methods derived for
determining the frequency d , time constant  2 , and damping ratio  associated with a
particular complex pole are applicable to the loci of roots of any LTI system.

         Figure 16-5 shows the loci of roots of a 2nd order system as generalized damping,
represented by  , varies. Next, let's consider the loci of roots for a 2nd order system as
generalized stiffness varies. Rather than using the symbols  and n , it is better for this
task to revert back to the notation of Section 9-1 representing a generalized mass-damper-
spring system. Accordingly, we have Eq. (7-3), n2 = k / m, and from Eq. (9-4), n =
c (2m) . In these definitions, we specify that k represents a generalized stiffness, which

will vary, and that c and m represent, respectively, generalized damping and generalized
inertia, which are considered positive constants and will remain fixed while k varies. For
convenience, let's use the following simplified notation:

n 2 = k m  K and n = c (2m)  C                                              (16-49)

Therefore, for the case c 2m  k m , we re-write the real roots (16-48a) as

                         p1,2 = -n ± (n )2 - n 2 = -C ± C 2 - K             (16-50a)
For k m  c 2m , the complex conjugate roots (16-48b) are

p1,2 = -n ± j n 2 - (n )2 = -C ± j K - C 2                                  (16-50b)

Figure 16-6 is an incomplete graph of loci of roots Eqs. (16-50) as K varies with

C > 0 fixed. (Homework Problem 16.3 is an exercise for completing the task.) Partial

annotation shows the lo-                         Im(p), sec-1
cations of the two real

poles for K = 0. Note, in

particular, that for K < 0

one real locus is entirely in  Break-away point  increasing K
the right half-plane. The

type of time response                            K = 0                          Re(p),
associated with this locus - < K < 0 K = 0                       0 > K > - sec-1

is monotonically growing

exponential, an instability.

(Of course, Routh also

shows that the system is              Stable            Unstable
unstable for K < 0 and C >
0, since then coefficients     Figure 16-6 Loci of roots of p2 + 2C p + K = 0 as K varies
of the characteristic equa-    from - to greater than C 2, with C > 0 held constant

                               16-21
Chapter 16 Introduction to system stability: time-response criteria

tion have different signs.) The passive mechanical springs with which we are familiar
always have positive stiffness, so it might appear that this type of instability is purely
academic, without any practical significance. Such is not the case. Recall that, in the
present discussion, k (and therefore K also) represents generalized or total stiffness, not
just mechanical stiffness. An elastically restrained airfoil within an air stream is one
practical engineering system for which the total stiffness is not necessarily positive. As
shown in the discussion accompanying Eq. (11-16), the total mechanical plus
aerodynamic stiffness of this system can become zero or even negative at high airspeeds;
the resulting unbounded pitching of the airfoil, called aeroelastic divergence, is an
important example of the type of instability represented in Fig. 16-6 for K < 0.

         Developing loci-of-roots graphs Figs. 16-5 and 16-6 for 2nd order systems is rela-
tively simple, but useful as an instructive introduction to this type of stability analysis. In
the next section, we will consider the more demanding task of determining loci of roots
for systems of higher order.

16-5 Loci of roots for a 3rd order system

         In Section 16-4, we used the quadratic formula to evaluate easily the loci of roots
for 2nd order systems. It is more typical in practice, however, that engineering systems
have higher orders than 2nd order, so that determining loci of roots requires repeatedly
solving polynomial equations of 3rd and higher degrees, which can be a challenging task.

This section introduces by example the methods of solution for higher-order systems that

are commonly used in practice.

         For this example, we consider again the system described in Section 16-3 (Figs.
16-2, 16-3, and 16-4), a rotor position-feedback control system with a 1st order low-pass
filter in the feedback branch. Closed-loop transfer function (16-40) gives the 3rd degree

characteristic equation in two different algebraic forms, one of which is

Den( p) = a1 p3 + a2 p 2 + a3 p + a4 = p3 +  1 +  c  p 2 + c 1 p + K a K = 0 (16-51a)
L J    J L  J L

         In Section 16-3, we held constant rotor inertia J, viscous damping constant c of
the bearings, and time constant L of the 1st order low-pass filter, all positive values; in
particular, we chose for numerical evaluation the values c / J = 100 sec-1, and, for the

filter break frequency, b  1 / L = 300 rad/sec. We allowed the value of product KaK of

control system sensitivities to vary. Using Routh's criteria, we determined the lower and

upper stability boundaries for the parameter KaK / J  : the system is positively stable
provided that 0 <  < 40,000 sec-2.

         Now, let's conduct a more detailed evaluation of stability by calculating and plot-
ting the loci of roots as  varies, using the same numerical values of the other constants
as in Section 16-3. We solve numerically for the roots of polynomial (16-51a) using
MATLAB's root operation: for each value of , the input is the array of coefficients

16-22
        Chapter 16 Introduction to system stability: time-response criteria

[a1 a2 a3 a4], and the output is the 3 × 1 matrix of roots. We will calculate and plot the
loci of roots twice: first, for a set of  values that we choose (guess) somewhat arbitrar-
ily to encompass the entire possible range of practical interest; second, for another set of
 values that are refined, based upon the results of the first pass, to focus on the specific
roots of greatest practical significance.

         For the first pass, we vary  from -30,000 sec-2 to +70,000 sec-2 in increments of
10,000 sec-2. The following is a MATLAB script M-file that computes the roots of poly-
nomial (16-51a) repeatedly over these values of , then prints the input and output values
in a table, then plots the loci of roots:

%MATLABdemo163.m
%Stability of a damped rotor with low-pass-filtered position feedback
%Loci of roots
wb=300;covrJ=100;a2=wb+covrJ;a3=wb*covrJ;
Lm=[-3 -2 -1 0 1 2 3 4 5 6 7]*1.0e4;Np=length(Lm);
for i=1:Np;

       a4=Lm(i)*wb;
       p(i,1:3)=roots([1 a2 a3 a4]).';
end
nc=1:Np;anout=[nc' Lm' p];
disp('Roots #, Lambda, p'),disp(anout)
plot(p,'kx'),grid,xlabel('Real part of pole (sec^-^1)')
ylabel('Imag part of pole (sec^-^1)')
title('Loci of roots of a 3^r^d order system as \Lambda varies')

The command to execute the M-file, and the resulting tabular output follows:

>> MATLABdemo163

Roots #, Lambda, p
   1.0e+004 *

0.0001  -3.0000      -0.0253 + 0.0141i  -0.0253 - 0.0141i   0.0107
0.0002  -2.0000      -0.0242 + 0.0111i  -0.0242 - 0.0111i   0.0085
0.0003  -1.0000      -0.0227 + 0.0056i  -0.0227 - 0.0056i   0.0055
0.0004                                  -0.0300            -0.0100
0.0005            0            0        -0.0031 + 0.0089i  -0.0031 - 0.0089i
0.0006   1.0000      -0.0337            -0.0019 + 0.0127i  -0.0019 - 0.0127i
0.0007   2.0000      -0.0363            -0.0008 + 0.0153i  -0.0008 - 0.0153i
0.0008   3.0000      -0.0383            -0.0000 + 0.0173i  -0.0000 - 0.0173i
0.0009   4.0000      -0.0400                                0.0007 - 0.0190i
0.0010   5.0000      -0.0415             0.0007 + 0.0190i   0.0014 - 0.0205i
0.0011   6.0000      -0.0428             0.0014 + 0.0205i   0.0020 - 0.0217i
         7.0000      -0.0440             0.0020 + 0.0217i

The associated loci-of-roots plot (after use of MATLAB's editing features for annotation
and graphical enhancement) is Fig. 16-7, on the next page.

                     16-23
Chapter 16 Introduction to system stability: time-response criteria

Figure 16-7 First-pass loci of roots of Eq. (16-51a) for varying
control parameter  = KaK / J

         We infer from Fig. 16-7 the following relevant information. For  < 0, the sys-
tem has an unstable pole associated with monotonic exponentially growing time re-
sponse; we already knew from Routh that the system is unstable for  < 0, but Routh did
not reveal the type of response. For  = 0, the poles are all real and have the values 0,
-100, and -300 sec-1. This is also obvious in the alternate algebraic form of the 3rd
degree characteristic equation that comes from closed-loop transfer function (16-40):

Den( p) = p( p + c J )( p + b ) + b = 0                              (16-51b)

From (16-51b) with = 0, the poles are clearly p1 = 0, p2 = -c / J = -100 sec-1, and p3 =
-b  -1 / L = -300 sec-1. The arrows on Fig. 16-7 indicate the directions of loci as 

increases. The arrows show that there is a break-in point (as defined on Fig. 16-5) for 
somewhere in the range -10,000 sec-2 <  < 0, and a break-away point for  somewhere
in the range 0 <  < +10,000 sec-2. For future reference, let's denote the break-away

value of  as ba , which is not yet determined. We also observe from Fig. 16-7 and the

tabulated roots that the upper boundary of stability (with purely complex roots, p2,3 =
±j173 rad/sec) is  = 40,000 sec-2, and that the time response is oscillatory for values of

 in the vicinity of the upper boundary; we knew from Routh the value of the upper

boundary, but not the type of response. Moreover, since the real pole for  > ba is
associated with heavily damped exponential decay, the complex loci for  > ba of Fig.
16-7 suggest that the time response is primarily oscillatory for  > ba. See Fig. 16-4 for
examples of this primarily oscillatory response. For  > ba , this system has a heavily

16-24
Chapter 16 Introduction to system stability: time-response criteria

damped exponential mode of response and a lightly damped oscillatory mode, and the
latter, with poles closest to the imaginary axis, is the dominant mode.

         Now let's refine the loci-of-roots calculation, using a new set of  values that
would be of greatest practical interest. This set probably would consist of values for
which the system is stable, namely 0 <  < 40,000 sec-2. The value ba is significant: it
is the boundary between a system (with 0 <  < ba) for which all transient response is
decaying exponential and a system (with ba < ) for which the dominant transient re-
sponse is oscillatory. We certainly could choose the refined set of  values by numerical
trial and error, letting MATLAB do most of the work. However, this situation provides
the opportunity for introduction of a theoretical and more systematic approach, which we
shall consider next. This approach is general, but our limited objective in this introduc-
tion will be to determine theoretically only the upper boundary of stability,   ub, and
the break-away value ba.

         This approach is based upon form (16-51b) of the characteristic equation, which
we re-write as

p( p + c J )( p + b ) = -b                                           (16-52)

It is important that the sub-system poles are separated into factors on the left-hand side of
Eq. (16-52). Each factor is a complex number, in general, and it can be expressed in
complex polar form, as described in Section 2-1. It is helpful to regard each factor as a
two-dimensional complex vector with its tail at the sub-system pole, so that we write

   p = p - 0  r1 e j1 , p + c J = p - (- c J )  r2 e j2 , p + b = p - (-b )  r3 e j3

                                                                                                   (16-53)

The real right-hand side of Eq. (16-52) also is written in polar form: - b =

b exp[ j(± , ± 3 , ...)]. Therefore, the entire characteristic equation is expressed in the

following polar form, which any root must satisfy:

         r1 e j1 × r2 e j2 × r3 e j3 = r1 r2 r3 e j(1+2 +3 ) = b  exp[ j(± , ± 3 , ...)] (16-54)

The drawing at right is a graphical representation of both the polar vectors of Eq. (16-53)

and characteristic equation (16-54). The small ×'s are the sub-system poles, at which the

tails of the complex vectors are located. The large X is a pole of the complete system,

i.e., a root of Eq. (16-51b), and a value that satis-         Im(p), sec-1
fies Eq. (16-54). Complex equation (16-54) in-

cludes two real equations, both of which must be

satisfied by any system pole. The first equation is    r3 r2 r1
the equality of angles on the two sides of (16-54):    3 2 1
                                                                     Re(p),
             1 + 2 + 3 = ± , ± 3 , ... (16-55) -b      -c /J
                                                                             -1
                                                                     sec

16-25
          Chapter 16 Introduction to system stability: time-response criteria

The second equation is the equality of magnitudes:

                    r1 r2 r3 = b     = r1 r2 r3                                (16-56)
                                               b

         For our first application of this approach,                   Im(p), sec-1
let's use Eq. (16-55) to find the pole jd at the                     

upper stability boundary ub, and then Eq. (16-56)             r3 r2            r1 =  d
to find the value of ub itself. The pole is shown                                1 =  /2
on the drawing at right. We have by definition for         3          2
this stability boundary: r1 = d and 1 =  2 . -b                                    Re(p),
Therefore, Eq. (16-55) gives 2 + 3 =  2 . [We                 -c /J                  sec-1

rule out the other possibilities -, ±3, ... in Eq. (16.55) just by inspecting the figure.]

Some trigonometry is required now. Angle  between the arrowheads of r1 and r3 is

labeled on the drawing. Angles  and 3 are the complementary acute angles of a right

triangle, so we have also  + 3 =  2 . Therefore,  = 2 . Hence, we find d by equat-

ing the tangents of the two similar right triangles:

tan2 = d = tan = b   d = b c =                        300 sec-1×100 sec-1 = 173.2 rad
       c J       d                     J                                                 sec

Having d = r1 , we can use the theorem of Pythagoras to find r2 = d 2 + (c J )2 =
  b (c J ) + (c J )2 and r3 = d 2 + b 2 = b (c J ) + b 2 . Finally, we find ub

by applying Eq. (16-56), which, after a little algebra, gives

       r1 r2 r3  c  c   2

                                   -1                 -1      -1 2             -2
 ub =            = b +   = 300 sec ×100 sec + (100 sec ) = 40,000 sec
       b         J J

This result for ub is, of course, identical to the upper boundary found by Routh's criteria
in Eq. (16-43b).

         For a more subtle application of this theoretical approach, let's: first, use Eq. (16-

55) to find the value of the two identical poles at the break-away point, which is evident
on Fig. 16-7 (on the real axis, somewhere between the origin and -c /J = -100 sec-1); and
then, use Eq. (16-56) to find the associated value of ba . It is obvious that Eq. (6-55) is
satisfied identically right at the break-away point, where 1 =  and 2 = 3 = 0, so this
does not provide any useful information. But Eq. (6-55) must apply also for all other

points on the loci of roots, in particular now, for points that are close to the break-away

point; this fact will lead to a useful result. Suppose that  is just slightly greater than ba
so that one of the complex poles is a small distance  above the break-away point on the

                           16-26
Chapter 16 Introduction to system stability: time-response criteria

real axis, as shown on the drawing below. As  shrinks but remains > 0, the acute angles

                                                                  Im(p), sec-1

                r3                                  r2        r1      1

                 3                                      2 
- b -c /J -1 Re(p),
                                                                            sec

between the sub-system radii and the real axis become very small, so we can use in Eq.
(16-55) the approximation   sin . Hence, Eq. (16-55) gives

1 + 2 + 3 =  -    +  +  =     - 1 + 1 +  1  = 0
           r1  r2 r3                                 r1 r2 r3 

This equation must be valid even if  is very small but non-zero, so we conclude that

- 1 + 1 + 1 = 0 = - r2r3 + r1r3 + r1r2            - r2r3 + r1r3 + r1r2 = 0
r1 r2 r3        r1r2 r3

In the limit as the pole goes to the break-away point on the real axis,  = 0, the radii are
related as r1 + r2 = c J and r1 + r3 = b . Substituting into the equation above to elimi-
nate r2 and r3 gives - r2r3 + r1(r3 + r2 ) = - (c J - r1)(b - r1) + r1 (b - r1 + c J - r1 ) =

0, and this leads, after some algebra, to a quadratic equation in unknown r1 :

             2      c                            c
             3 r1 - 2 b +  r1 + b = 0
              J                                  J

Solving for r1 with the quadratic formula gives

     1  c                 c                      2      c   
r1 = b +  ±
                         b +  - 3b                      J
     3  J                 J
                                                            

Substituting into this equation b = 300 sec-1 and c J = 100 sec-1 gives the roots
221.53 and 45.14 sec-1, with the latter root corresponding to the break-away pole that we
seek between the origin and -100 sec-1 on the real axis, i.e., r1 = 45.14 sec-1. Then Eq.

(16-56) gives the associated value of the varying control parameter:

ba = r1 r2 r3 = r1 (c J - r1 )(b - r1 ) = 2,103.77 sec-2
          b         b

         The approach used above to determine theoretically the stability-upper-bound and
break-away values of the varying control parameter , based upon Eqs. (16-52)-(16-56),

                16-27
        Chapter 16 Introduction to system stability: time-response criteria

is a small portion of an extensive set of procedures for completely determining loci of
roots, which is known as the root-locus method. Walter R. Evans (1920-1999, American
electrical engineer) developed and published this elegant method around 1950. Using the
root-locus method, an experienced engineer can develop quickly, without the need for a
digital computer, complete loci of roots, even for systems of somewhat higher order. For
about a quarter-century after this method became widely known, the slide rule was still
an engineer's primary computational tool, and the root-locus method profoundly influ-
enced the design and analysis of control systems during that era. Now that digital com-
puters and highly specialized software are readily available, Evans' root-locus method is
no longer so essential if you need only to analyze a given system. However, if you want
to design control systems logically and efficiently, then the concepts underlying Evans'
method, represented in this example by Eqs. (16-52)-(16-56), will be extremely valuable.
Details of Evans' method are available in many references, one of the clearest and most
complete being Cannon, 1967, Sections 11.8 and 11.9 and Chapter 21.

         Let's return now to the task of choosing a refined set of  values and using MAT-

LAB to calculate and graph loci of roots for this refined set. We specify that this set con-
sists of values for which the system is stable, 0 <  < 40,000 sec-2, with particular em-

phasis on the range of values associated with the dominant oscillatory mode of response,
ba <  < 40,000 sec-2. Therefore, the value ba = 2,103.77 sec-2 calculated above is
useful, and is included in the refined set of  values. The other values are chosen by trial

and error to produce moderately uniform spacing between the complex poles in the p-
plane; the complete set, in ascending order is  = 0, 1,000, 1,800, ba , 2,300, 3,500,
6,250, 10,000, 20,000, and 40,000 sec-2. Except for this different set of  values, the

MATLAB script M-file is the same as that which produced Fig. 16-7. The command to

execute the M-file, and the resulting tabular output follows:

>> MATLABdemo164

Roots #, Lambda, p
   1.0e+004 *

0.0001                     0            0         -0.0300            -0.0100
0.0002            0.1000      -0.0305             -0.0083            -0.0012
0.0003            0.1800      -0.0308             -0.0064            -0.0027
0.0004            0.2104      -0.0310             -0.0045 + 0.0000i  -0.0045 - 0.0000i
0.0005            0.2300      -0.0311             -0.0045 + 0.0015i  -0.0045 - 0.0015i
0.0006            0.3500      -0.0315             -0.0042 + 0.0039i  -0.0042 - 0.0039i
0.0007            0.6250      -0.0326             -0.0037 + 0.0066i  -0.0037 - 0.0066i
0.0008            1.0000      -0.0337             -0.0031 + 0.0089i  -0.0031 - 0.0089i
0.0009            2.0000      -0.0363             -0.0019 + 0.0127i  -0.0019 - 0.0127i
0.0010            3.0000      -0.0383             -0.0008 + 0.0153i  -0.0008 - 0.0153i
0.0011            4.0000      -0.0400             -0.0000 + 0.0173i  -0.0000 - 0.0173i

The associated loci-of-roots plot, Fig. 16-8, is on the next page. MATLAB's editing
features for annotation and graphical enhancement were used on Fig. 16-8. In particular,
the axes were set to be "equal," which means in this case that the x axis [i.e., Re(p)] and
the y axis [i.e., Im(p)] have exactly the same linear scale.

                                           16-28
Chapter 16 Introduction to system stability: time-response criteria

         Figure 16-8 Refined loci of roots of Eq. (16-51a) for varying control
         parameter  = KaK / J

         The roots on Fig. 16-8 for one example value,  = 6,250 sec-2, are labeled in or-
der to illustrate calculation of basic 1st order and 2nd order parameters for a higher-order
system. The real root is p1 = -326 sec-1 (taken approximately from Fig. 16-8, but more
precisely from the table of roots on the previous page). The associated 1st order time con-
stant is 1 = -1 p1 = 3.07e-3 sec = 3.07 msec. The imaginary roots for  = 6,250 sec-2
are p2,3 = -37 ± j66 sec-1, and the angle labeled on Fig. 16-8 is   30° (for its relevance,
see Fig. 16-5). The associated 2nd order response parameters are: time constant  2 =
-1 Re( p2,3 ) = 27 msec (much longer than 1 ); frequency d = Im( p2 ) = 66 rad/sec;
and damping ratio  = sin  0.5 We can use MATLAB's poles to calculate more

precisely the damping ratio associated with a stable complex pole, pk =  k + jk (the
notation of Section 16-1), by recognizing that  k = Re( pk )  - (n )k and k =

Im( pk )  (d )k , and that (dropping the k subscripts temporarily) d 2 = n 2 - (n )2 :

  2 (n )2  (n )2     2                                        1
= 2 =             2 2 2=
                                                                        2
n          2(n ) + d  +  1 + (  )

Therefore (restoring the k subscripts), the damping ratio is

              16-29
Chapter 16 Introduction to system stability: time-response criteria

          k =        1                                                                                (16-57)
               1 + (k  k )2

Applying Eq. (16-57) for  = 6,250 sec-2 gives  2 = 1 1 + (66 37)2 = 0.49.

         The calculations in the previous paragraph suggest the following question: why
does this 3rd order system have one real pole that corresponds to monotonic exponential
1st order response, and a pair of complex conjugate poles that correspond to damped
oscillatory 2nd order response? In fact, this is a simple example of an important general

property of linear time-invariant systems. Every LTI system has modes of response that

are associated with its poles, the roots of the system's characteristic equation. We show

this by re-writing characteristic equation (16-33) in the general factored form:

                                                                                                  n   (16-58)

Den( p) = a1 p n + a2 p n-1 + L + an p + an+1 = a1 ( p - pk ) = 0

                                                                                                k =1

                                        n

where the symbol  denotes multiplication of n terms. Since all coefficients ak are real,

                                       k =1

this equation can always be factored into 1st order terms with real poles and 2nd order

terms with complex conjugate poles for which  j < 1 :

1 Den( p) = ( p - pk ) = ...( p - pi )...( p + 2 n 2  j j p +  j 2 )...                               (16-59)
a1
    k =1

It might be conceptually clearest to think of the modes in terms of response to initial con-
ditions, without the complication of forcing inputs. The mode of IC response associated
with any real pole [pi in Eq. (16-59)] is monotonic exponential, exactly that of a basic 1st
order system. The mode of IC response associated with any pair of complex conjugate

poles [ -  j j ± j j 1 -  j 2 in Eq. (16-59)] is oscillation modulated by an exponential

envelope, exactly that of a basic 2nd order system for which   < 1. The total time re-
sponse of an LTI system to initial conditions and forcing inputs is the superposition of the
responses of all of its individual 1st order and 2nd order modes. If the response is stable,
then the greatest contributors to this total response typically are a few, at most, dominant
modes, those whose poles are closest to the imaginary axis.

         The modes of vibration introduced in Section 7-6 and Chapter 12 represent a
special case of the more general modes of response discussed in the previous paragraph.
An undamped structural system of the type considered in Chapter 12 always has even
order (i.e., n = 2, 4, 6, ...), so that its characteristic equation has an even number of roots.
These roots appear in purely imaginary conjugate pairs, each pair for a particular mode of
vibration; the absolute value of any root is the natural frequency of that particular mode.

         Before proceeding, we should observe a general feature of loci-of-roots diagrams.
The poles are either real or, if complex, appear in conjugate pairs, as is expressed by Eq.

               16-30
Chapter 16 Introduction to system stability: time-response criteria

(16-59). Therefore, loci-of-roots diagrams are always symmetric about the Re(p) axis.
This symmetry is evident in Figs. 16-5, 16-7, and 16-8.

16-6 Open-loop transfer functions and loci of roots

         Let's review and consider again Fig. 14-8,  In(s) E(s)                                                         Out(s)
the general Laplace block diagram for an SISO
closed-loop system with feedback. In Section 14-                 G(s)
4, we used Fig. 14-8 to derive the closed-loop
transfer function, Out(s) In(s) :                          B(s)
                                                                     H(s)

CLTF (s) = G = NG DH                                 Fig. 14-8 (repeated) Laplace block
                                                     diagram of general closed loop

1 + GH DG DH + NG N H                     (16-60)

It is common practice also to refer to the ratio B(s) E(s) as the open-loop transfer func-
tion, which is expressed more completely as

                                                                                                              m         (16-61)

B(s) NG (s) N H (s) k=1 (s - Z k )

E(s)  OLTF (s) = G(s) H (s) = DG (s) DH (s)  C × n

                                           (s - Pk )

                                                                                                             k =1

In Eq. (16-61), C is some physical constant, the finite zeros Zk of OLTF(s) are the roots of
NG(s)NH(s) = 0, and the poles Pk of OLTF(s) are the roots of DG(s)DH(s) = 0. [For n > m,
there are also n - m zeros of OLTF(s) as s  .]

         The nth degree characteristic polynomial of the closed-loop system is Eq. (16-58),

       n

a1 ( p - pk ) = 0 . Note that the denominator of CLTF(s), Eq. (16-60), equals the

     k =1

denominator plus the numerator of OLTF(s), Eq. (16-61). Therefore, after we divide out
coefficient a1, the characteristic equation for closed-loop system poles p can generally be
put into one of the following forms:

                                          n
                                           ( p - Pk ) + c  = 0                                                     (a)
                                           k =1
DG ( p) DH ( p) + NG ( p) N H ( p) = 0    n          m                                                                  (16-62)

                                           ( p - Pk ) + c  ( p - Zk ) = 0 (b)
                                           k =1      k =1

In Eqs. (16-62), c is some known physical constant, and  is the varying control para-
meter. The system evaluated by root-locus methods in Section 16-5 includes open-loop
poles Pk (called there the "sub-system poles"), but not any finite open-loop zeros Zk , so
that system's characteristic equation, Eq. (16-51b), is of form (16-62a). On the other
hand, the systems of homework Problems 16.8, 16.9, and 16.10 have both open-loop
poles and open-loop zeros, so their characteristic equations have form (16-62b).

                                          16-31
Chapter 16 Introduction to system stability: time-response criteria

         Some simple but general features of loci of closed-loop roots can be inferred from
Eqs. (16-62). Both equations show clearly that when  = 0, the closed-loop poles are
exactly the same as the open-loop poles. At the other extreme, as  becomes very large,
  , m of the loci  the finite open-loop zeros Zk . This is obvious from Eq. (16-
62b), because the term including the open-loop poles becomes progressively less
significant in relative size as the magnitude of  increases.

         As    in Eq. (16-62a), in order for an equation of magnitude equality such as
Eq. (16-56), r1 r2 r3 = b, to remain satisfied, all n of the loci of that equation must go to

some  locations in the p-plane. Similarly, as    in Eq. (16-62b), although m of the
loci terminate at the finite open-loop zeros Zk , the remaining n - m loci must go to some
 locations in the p-plane. For both Eqs. (16-62) as   , the values of the finite open-
loop zeros Zk and of the open-loop poles Pk have a secondary influence, so the directions
A in the p-plane of the n - m straight-line asymptotes of the    loci are the solutions
for angles of p n-m + c = 0 , which leads to:

(re jA )n-m = c exp[ j(± , ± 3 , ...)]  (n - m) A = ± , ± 3 , ...

       A = 1 (±  , ± 3 , ...)                                        (16-63)

            n-m

However, Eq. (16-63) neglects the values of Zk and Pk , so it implies incorrectly that the
asymptotes "radiate" (or "emanate") from the origin of the p-plane; in fact, it can be
proved (Cannon, 1967, pages 658-659) that all n - m asymptotes emanate from a point on
the real axis defined by the equation:

      1 n            m          
        Re[Pk ] -  Re[Z k ]
pA =  n - m  k=1                                                     (16-64)

                     k =1       

         It is useful also to know the directions in which loci "depart" from the open-loop
poles as  increases from zero. Suppose that we seek the direction (angle) of departure
(j)dep of the locus of closed-loop roots from open-loop pole Pj . Let's use the following
notation: (P)kj is the angle from open-loop pole Pk to open-loop pole Pj ; and (Z)kj is the
angle from open-loop zero Zk to open-loop pole Pj . Provided that all of the open-loop
poles and zeros are single (not repeated or multiple) roots, then the required angle is cal-
culated from the equation (Cannon, 1967, pages 660-661):

                  n  m
( j )dep =  -  (P)kj +  (Z )kj
                                                                     (16-65)

           k =1      k =1

           k j

         We use Section 16-5's numerical example to illustrate the information about loci
of roots that is provided by open-loop poles; that example is a 3rd order system for which
n = 3 and m = 0. From Eq. (16-51b) with = 0, the open-loop poles are p1 = 0 sec-1, p2 =
-100 sec-1, and p3 = -300 sec-1. These open-loop poles are marked by ×'s on Fig. 16-9.

There are no open-loop zeros, so as   , the three loci must go to some  locations in

           16-32
Chapter 16 Introduction to system stability: time-response criteria

the p-plane; the directions of the lines asymptotic to these loci are given by Eq. (16-63) as
A = ± /3 and  =  . The point on the real axis from which all three asymptotes emanate
is given by Eq. (16-64) as pA = (0 -100 -300)/3 = -133 sec-1. The asymptotes are the
straight dashed lines on Fig. 16-9. Equation (16-65) gives the angles of departure from
open-loop poles as (1)dep =  - (0 + 0) =  , (2)dep =  - ( + 0) = 0, and (3)dep =  - (
+ ) = - . These angles of departure are represented on Fig. 16-9 by short, bold arrows.
Although the directions of departure for this particular system are either due east or due
west, this is not always the case; for systems in general, a direction of departure can be
any angle.

                       A = +60°  j200

A = 180°  -300  -200   -100             j100
 -400                            Im(p), sec-1

                                          Re(p),
                                          sec-1

                                        -j100

                       A = -60°  -j200

Figure 16-9 Example of information about loci of roots that is
provided by the open-loop poles

         We can make educated guesses as to the appearance of the completed diagram of

root loci, even from the incomplete diagram Fig. 16-9. First, it seems likely that the locus
originating (i.e., for  = 0) at open-loop pole p3 = -300 sec-1 just proceeds westerly along
the asymptote A =  , without straying away from the Re(p) axis. That being the case,
then the loci originating from the open-loop poles p1 = 0 sec-1 and p2 = -100 sec-1 must
initially approach each other, then come together somewhere between p1 and p2 , and then
break away from the Re(p) axis and become the complex conjugate pair of curves to
which the asymptotes A = ± /3 are tangent as   . Certainly, the incomplete dia-
gram Fig. 16-9 is qualitatively similar to the exact diagram Fig. 16-8, and Fig. 16-9 even

includes some of the same significant quantitative information.

         When you use software to determine loci of roots, you should also make the easy
calculations presented in this section based upon open-loop poles and zeros. If the soft-
ware calculations match yours, then this check will validate (partially, at least) that the
software is correct and that you are using it correctly.

                16-33
Chapter 16 Introduction to system stability: time-response criteria

16-7 Homework problems for Chapter 16

16.1 Examine whichever of the following characteristic equations are assigned, using
Routh's criteria to determine if all of their roots have negative real parts so that the
associated systems are positively stable.

(a) p - 3 = 0 (b) 2p + 11 = 0 (c) p2 + 2p + 8 = 0 (d) 2p2 - 9p + 29 = 0

(e) 2p3 + 4p2 + 4p + 12 = 0 (f) p3 + 6p2 + 12p + 8 = 0 (g) p4 - p3 + 7p2 + p - 8 = 0

16.2 Consider the conceptual Laplace closed-loop-system block diagram below, with

two possibly variable system parameters, K and Q.

Write the equation for the closed-loop transfer R(s)       K                X(s)

function. Next, expand the denominator (charac-        +_  s(s + 1)(s + Q)

teristic) polynomial and apply Routh's stability

criteria to write all of the algebraic inequality re-

lationships involving K and Q (in general) that must be satisfied in order for the system to

be positively stable. (Don't worry about the units of K and Q, just assume that they are

consistent.) Calculate the range of K for which the system is positively stable for which-

ever of the following cases is assigned: (a) Q = -0.5 and +0.5; (b) Q = -1.0 and +1.0; (c)

Q = -1.5 and +1.5.

16.3 Consider the characteristic equation p2 + 2Cp + K = 0. With mass m being positive-

definite, this is the characteristic equation of the standard mass-damper-spring system
described by equation of motion m&x& + cx& + k x = fx(t), but with the notation C  c / (2m)
and K  k / m. The roots of this 2nd degree polynomial equation are the poles of the
system transfer function. Suppose that damping constant C = 6 sec-1, and that you want

to evaluate the system stability characteristics for different values of stiffness constant K
sec-2. Consider first non-negative values of K. For what positive value of K  Kc is the
damping critical, and what values do the polynomial roots have for K  Kc ? (Definition:
if damping is positive but less than critical, then the roots are complex, corresponding to

initial-condition response that is oscillation modulated by a decaying exponential enve-

lope; if, on the other hand, damping is equal to or greater than critical, then the roots are

negative real, corresponding to monotonic exponentially decaying initial-condition re-

sponse.) What values are the roots for K = 0 and for K = 2Kc ? Show each of these roots
by marking large X's at the correct positions on a complex p-plane graph [x-axis is Re(p),
y-axis is Im(p), both in sec-1]; label the axes and the linear scale of the axes, the same

scale on both axes, as on the MATLAB graph Fig. 16-8. Explain concisely what quality

of the roots indicates that the system is stable for all values of K > 0. Now calculate the
values of the roots for a negative stiffness, say K = -3Kc , and mark those roots on your
p-plane graph. From the roots for a negative stiffness, what can you state conclusively

about the system stability for all negative values of K ? Indicate clearly on your p-plane
graph the loci of roots as K increases from -3Kc to 0, then from 0 to +Kc , then from Kc to
2Kc , and finally for Kc > 2Kc . Is there a break-away point on your loci of roots; if so, for
what value of K ?

                    16-34
Chapter 16 Introduction to system stability: time-response criteria

16.4 The following characteristic equations are expressed in completely or partially fac-
tored forms. For whichever equations are assigned, find the order n of the associated sys-
tem, solve for the roots and mark their locations with large X's on a sketch of the com-
plex p-plane, and state whether the system is stable or unstable; give the reason(s) for
your conclusion.

(a) ( p - 4)( p + 3)( p + 4)( p + 5) = 0    (b) p( p + 2)( p 2 - 6 p + 34) = 0

(c) ( p + 1)( p + 3 - j5)( p + 3 + j5) = 0  (d) ( p + 3)( p 2 + 2 p + 2)( p 2 + 4 p + 20) = 0

16.5 The Laplace block diagram R(s)                                  1          (s)
at right represents a system simi-
                                            Kr     +_  Ka J s2 + c s

lar to that of Figs. 16-2 and 16-3:

it is a damped rotor with position                            b 2
feedback that is low-pass-filtered.                    s2 + 2b s + b2 K
But the low-pass filter in this case

is 2nd order, whereas the filter of

Fig. 16-3 is 1st order. The filter transfer function on the block diagram is from Eq. (10-6):

low-pass break frequency b is the undamped natural frequency, and  is the filter

viscous damping ratio. We specify the value  = 1 2 ; as shown on the frequency-

response magnitude-ratio graph of Fig. 10-2, for this  , the magnitude attenuation at

 = b is 1 2 (same as for a 1st order filter), and the high frequency roll-off is two

decades for each decade increase of frequency (twice as steep as the roll-off of a 1st order
filter). (See also the discussion of 2nd order low-pass filters at the end of Section 10-2.)

(a) Derive from the block diagram the algebraic equation for the closed-loop transfer
function, CLTF (s)  (s) R(s) (in terms of the symbols shown, without numbers at this
stage). From your CLTF (s) , write the characteristic equation, Den( p) = 0 .

(b) Use the same values as for the calculations of Chapter 16: b = 300 rad/sec and
c J = 100 sec-1, as well as  = 1 2 . Also as in Chapter 16, denote the varying
control-system parameter as   K a K J . Use MATLAB's root operation to calculate,
print out, and plot the loci of roots of this system over the entire range of  values for
which the system is positively stable. Your graph and numerical output should show
with at least 2-3 significant-figure precision any break-away points and the upper and
lower boundaries of stability. Find by trial and error the approximate value of  for
which the dominant oscillatory mode of response has the system damping ratio  

1 2 , and also calculate the time constant  2 and the frequency d for this value of .

                                            16-35
Chapter 16 Introduction to system stability: time-response criteria

16.6 The Laplace block diagram here represents a system to control the angular position

of a satellite in one plane. The

unfamiliar input-error block in the R(s)         s +                    1 (s)
                                          Kr + _ Kc s + 6 Ka J s2
forward branch of the loop is the

transfer function of a compensator,

which in this case is designed to                     K

place a pair of the system's closed-

loop poles at 2 (-1 ± j1) sec-1 in the p-plane, for one value of control parameter  

Kc K a K J . For these poles, the frequency is fd = d 2 = 1 Hz, and the viscous

damping ratio is  = 1 2 .

(a) Derive from the block diagram the algebraic equation for the closed-loop transfer
function, (s) R(s) , then write the characteristic equation, Den( p) = 0 .

(b) Use MATLAB's root operation to calculate, print out, and plot the loci of roots of
this system over the parameter range 0    200 sec-2.

(c) Use Evans' root-locus method to determine the numerical value of  that produces
poles 2 (-1 ± j1) sec-1.

16.7 (Adapted from Franklin, et al., 1991, Problem 5.25 on page 347) The Laplace

block diagram of the speed-control system of a magnetic-tape drive is shown in the figure

below. The operator setting is input voltage signal ein(t), the Laplace transform of which
is Ein(s). Each major sub-system of the control system functions as a 1st order system.

The sub-system consisting of a power amplifier and a torque actuator has variable sensi-

tivity Ka (N-m/V) and time constant a = 1.0 sec. The tape drive has rotational inertia J =
4.0 N-m per rad/sec2 and lubricated-shaft viscous damping constant c = 1.0 N-m per

rad/sec; the output of the tape drive in this application is rotational speed p(t) in rad/sec

[with Laplace transform P(s)], not           Amplifier-actuator Tape drive

rotational position (t). The rota-
tional-speed sensor in the feedback Ein(s)                                  P(s)
                                             Ka                      1
                                            +_ as +1
branch has sensitivity Kp = 1.250 V                       J s + c

per rad/sec; this sensor is suffi-                    Kp

ciently slow relative to the other

sub-systems that we must account                    ps +1
for its time constant, p = 0.5 sec.              Speed sensor

(a) Derive the closed-loop transfer function P(s)/Ein(s), and then show that the character-
istic equation of this system can be expressed as

( p + c J )( p +  a -1 )( p +  p -1 ) +  = 0 , or r1e j1 × r2e j2 × r3e j3 =  exp[ j(± , ± 3 , ...)]

where the variable control parameter is defined as  = K a K p (J a p ) , with units of
sec-3.

                                      16-36
Chapter 16 Introduction to system stability: time-response criteria

(b) Determine (by hand, not MATLAB) all of the open-loop poles, all of the asymptotes
(as   ) of the closed-loop poles, and the directions of departure of the root loci from
the open-loop poles as  increases from zero. Sketch on graph paper a p-plane, and indi-
cate on it the information that you determined for this system. See Fig. 16-9 for an exam-
ple of the type of diagram that yours should be. Make educated guesses and sketch on
your diagram the forms you think the root loci should have.

(c) From part (a), any point on a locus of roots must satisfy the angle equality: 1 + 2 +
3 = ±, ±3, ... . Use this equality to write a transcendental equation that can be solved
for the closed-loop pole jd at the upper stability boundary ub of the complex oscillatory
loci; your equation will include trigonometric functions for the i angles that involve d
and the numerical values of the open-loop poles. It is not necessary for you to solve the
transcendental equation, but you may show just by substitution that d = 1.6583124 sec-1
= 11 2 sec-1 is the solution. Finally, again using the result of part (a), solve for the

value ub = r1 × r2 × r3; your equation will include terms for the ri magnitudes that in-
volve d and the numerical values of the open-loop poles. [Note: you could also solve
this part by applying Routh's criteria, Eqs. (16-37) and (16-38), to calculate ub , then
substituting ub back into the characteristic equation to solve for p = jd .]

16.8 The open-loop transfer function of a certain control system is

G(s)H(s)  OLTF(s) =   s 2 + 4s + 104

                               2
                      (s + 1)(s + 2s + 26)

where  (with units sec-1) is a variable parameter with possible range 0   < +.

(a) Determine (by hand, not MATLAB) all of the open-loop poles and open-loop zeros
of this system, any asymptotes (as   ) of the closed-loop poles, and the directions of
departure of the root loci from the open-loop poles as  increases from zero. Sketch on
graph paper a p-plane, and indicate on it the information that you determine for this sys-
tem. See Fig. 16-9 for an example of the type of diagram that yours should be. However,
whereas Fig. 16-9 does not display any open-loop zeros, your diagram should; it is tradi-
tional to mark an open-loop zero by an , just as an open-loop pole is marked by an ×.
Make educated guesses and sketch on your diagram the forms you think the root loci
should have.

(b) Show that the characteristic equation of the closed-loop system is

p3 + (3 + ) p 2 + 4(7 + ) p + 26(1 + 4) = 0

Apply Routh's criteria, Eqs. (16-37) and (16-38), to calculate bounds and ranges of  for
stability; in particular, solve a quadratic equation in unknown  to show that two of the
bounds are 1,2 = 8 ± 49.5 sec-1 = 0.964376 sec-1 and 15.0356 sec-1. In order to inter-

16-37
Chapter 16 Introduction to system stability: time-response criteria

pret the significance of these bounds relative to stability, calculate the quadratic equation

for values of  slightly above and below these two bounds. Next, substitute the values
1 and 2 back into the characteristic equation as p = jd1 and p = jd2 to solve for the
oscillatory frequencies d1 and d2 at 1 and 2 , respectively--there will be both a real
and an imaginary part of the equation that you can solve; calculate the d1,2 from the
easier part, then just substitute that value of d1,2 into the harder part to show that it also
is satisfied. What is the significance of d1,2 and 1,2 on your diagram in part (a)?

16.9 The characteristic equation of a certain LTI-SISO system can be expressed as

1+ G( p)H ( p) = 1+          2 p + 1 = 0
                      ( p -1)( p + 3)( p + 2 p + 2)

where  is a variable gain parameter with possible range 0   < +.

(a) Determine (by hand, not MATLAB) all of the open-loop poles and the open-loop
zero of this system, all of the asymptotes (as   ) of the closed-loop poles, and the
directions of departure of the root loci from the open-loop poles as  increases from zero.
Sketch on graph paper a p-plane, and indicate on it the information that you determine for
this system. See Fig. 16-9 for an example of the type of diagram that yours should be.
However, whereas Fig. 16-9 does not display any open-loop zeros, your diagram should;
it is traditional to mark an open-loop zero by an , just as an open-loop pole is marked by
an ×. Make educated guesses and sketch on your diagram the forms you think the root
loci should have.

(b) Your information in part (a) should suggest that one locus of roots is on the Re(p)
axis, starting from an open-loop pole at p = +1 (for  = 0), and terminating on an open-
loop zero at p = -1 (for   ). If that is true, then this particular locus must, for some
value of  between 0 and , cross the origin of the p-plane from p > 0 (unstable) to p < 0
(stable). Your assignment is to express the characteristic equation in polar form [in the
manner of Eqs. (16-53)- (16-56)], use that form to prove the segment -1  p  +1 of the
Re(p) axis is or is not a locus, and, if it is, find the value of  at p = 0, the boundary be-
tween instability and stability.

(c) Your solution from part (b) should indicate: there is a locus on the segment -1  p 
+1 of the Re(p) axis; and that locus has stable roots for  greater than its value at p = 0.
On the other hand, your information from part (a) should show there is a pair of complex
conjugate open-loop poles in the stable western half-plane; it also should suggest that the
loci departing from those complex open-loop poles (for  = 0) then proceed in an easterly
direction as  increases from zero, then, for some positive value of , cross over the
Im(p) axis into the unstable eastern half-plane. So, as  increases from zero, one real lo-
cus of closed-loop roots goes from being unstable to stable, but a pair of complex conju-
gate loci go from being stable to unstable. Therefore, we must ask if there is any range of
 for which all of the loci are in the western half-plane and the closed-loop system is sta-
ble? Perhaps the best way to answer this question is to use Routh's stability criteria.

                      16-38
Chapter 16 Introduction to system stability: time-response criteria

Consider a general 4th order characteristic equation: a1 p4 + a2 p3 + a3 p2 + a4 p + a5 = 0.
The associated system is stable if and only if all of the following conditions are satisfied
(Ogata, 2001, pages 275-277):

* all ai > 0, i = 1, 2, 3, 4, 5;

* R2  a2 × a3 - a1 × a4 > 0;
* R3  R2 × a4 - a22 × a5 > 0.

Use Routh's stability criteria to determine the range of  for which the closed-loop
system is stable, if there is such a range.

16.10 (adapted from Nelson, 1989, Problem 7.7 on pages 222-223) The 1903 Wright

Flyer by itself was inherently unstable in longitudinal motion (coupled pitch and vertical

translation). However, Wilbur and Orville Wright stabilized, just barely, the system of

airplane + pilot by providing sufficient control authority with a canard and by developing

flying skill through extensive experimentation and practice with piloted gliders. A math-
ematical model3 of the system was formulated, the Laplace block diagram for which is

shown below. The input to the system is commanded pitch attitude c(t), and the output

                                       is actual pitch attitude (t). Incremental ca-

c(s) E(s) Pilot + _  (s) (s) (s) nard position is (t), for which the Laplace transform is (s). The canard-position-to-
                                  (s)
                                       pitch-attitude transfer function incorporates

Visual feedback                        both rigid-body dynamics and aerodynamics;

                                       the estimated model of this transfer function is

(s) = 2 2 11.0(s + 0.5)(s + 3.0) =     11.0(s + 0.5)(s + 3.0)

                                                                    2
(s) (s + 5.9s -11.9)(s + 0.72s + 1.44) (s -1.589)(s + 7.489)(s + 0.72s + 1.44)

(a) Determine (by hand, not MATLAB) all of the open-loop poles and open-loop zeros
of this system, all of the asymptotes (as pilot gain   ) of the closed-loop poles, and
the directions of departure of the root loci from the open-loop poles as  increases from
zero. Sketch on graph paper a p-plane, and indicate on it the information that you deter-
mined for this system. See Fig. 16-9 for an example of the type of diagram that yours
should be. However, whereas Fig. 16-9 does not display any open-loop zeros, your dia-
gram should; it is traditional to mark an open-loop zero by an , just as an open-loop pole
is marked by an ×.

(b) Show in detail that the characteristic polynomial equation in the form a1 p4 + a2 p3 +
a3 p2 + a4 p + a5 = 0, with all ai coefficients either numerical or combinations of numbers
and pilot gain , is given by:

3 Culick, F.E.C.: "Building a 1903 Wright `Flyer'--by Committee," AIAA Paper 88-0094, 1988

                                                  16-39
Chapter 16 Introduction to system stability: time-response criteria

p4 + 6.62 p3 + (11 - 6.212) p2 + (38.5 - 0.072) p + (16.5 -17.136) = 0

(c) If we wish at this point to program into software the calculation of loci of roots, we
know only to consider 0 <  < ; but, without more information, it is difficult to know
what specific range or even order of magnitude of  to enter initially in the calculations.
However, Routh's stability criteria can provide that necessary additional information.
Use Routh's criteria [homework Problem 16.9(c)] and the characteristic-equation coeffi-
cients to evaluate the absolute stability of the Wright Flyer system, thereby determining
quantitatively a candidate range of  for use in calculation of loci of roots.4 (Answer:
for stability,  > 1.3096)

(d) Use MATLAB's root operation to calculate, print out, and plot the loci of roots of
this system over a range of  values for which the system is stable. From Eq. (9-28),
viscous damping ratio  = 0.11 of the oscillatory mode produces 50% amplitude decay
during each cycle; show from your calculations that  = 3.24 is the lower pilot gain for
which  = 0.11, to reasonable engineering accuracy. From your results for  = 3.24, do
you expect an oscillatory mode to be dominant in time response, or an exponential mode,
or perhaps a combination of the two?

(e) It is of interest to examine in more detail the case of pilot gain  = 3.24, beginning
with the closed-loop transfer function CLTF(s). Note that we essentially already have the
denominator of CLTF(s): in the characteristic equation of part (b), just replace p Æ s
and set  = 3.24. Show that the closed-loop transfer function, in the form of Eq. (16-5),
is:

CLTF (s) = (s) = 4  35.64(s 2 + 3.5s + 1.5)

c (s) s + 6.62s + 29.428s + 124.668s + 36.32432

Now apply MATLAB's residue operation (see homework Problem 2.15) to calculate
the residues and poles of CLTF(s), and write out the partial-fraction expansion form of
CLTF(s). Note that the poles found in this step should match those of part (d) for  =
3.24.

(f) Finally, consider a forced-response solution in time, with zero initial conditions. Sup-
pose the pilot commands a short pulse to the pitch-control lever; represent this pulse ap-
proximately with a Dirac delta function (Section 8-4): c(t) = I (t), for which the La-
place transform is c(s) = I . Let the impulse magnitude be I = 2 degree-sec. Use the
partial-fraction expansion form of CLTF(s) from part (e) to derive the equation for the

4 This exercise requires several calculations. Rather than calculating manually, you might prefer to use
symbolic software. If you use MATLAB's Symbolic Math Toolbox (see homework Problem 1.6), be
aware that this symbolic software performs calculations exactly, expressing numbers as fractions of inte-
gers if at all possible. But the integers in these fractions can become quite large and unwieldy. You can
convert these fractions into decimal numbers by using "variable precision arithmetic." For example, if a
symbolic term is expressed as v = 4115/2263*w, you can convert the fractional coefficient into a five-
digit decimal with the operations >> digits(5);v5=vpa(v), the result of which is v5 = 1.8184*w.

                    16-40
  Chapter 16 Introduction to system stability: time-response criteria

pitch response (t) to this control excitation, and then calculate and plot this transient re-
sponse over a 15-sec interval.

16.11 We know from Chapter 16 that the process of calculating and plotting loci of roots
is useful in analysis of control-system stability; the objective of this problem is to illus-
trate another important application of root-loci: analysis of the stability of a system for
which the potentially destabilizing feedback is natural and intrinsic, not human-designed.
Systems with this characteristic are often described as self-excited (see, e.g., Den Hartog,
1956, Chapter 7). The particular phenomenon we consider here, aeroelastic dynamic re-
sponse of a typical-section airfoil, including unstable flutter, originated in aeronautical
engineering but is relevant also to many other applications of force-generating objects
that are immersed within moving fluids (e.g., hydrofoils, wind-turbine blades, and pro-
pellers). The typical-section airfoil is described in Section 11-3, Examples 11-2 and 11-
3, and we consider here the form depicted below, an uncambered, symmetric thin airfoil
supported by springs in a wind tunnel, and immersed within an incompressible airstream
of density  and freestream velocity V.

                                       F(t)                               (t)
                             M(t)                                      V

          y(t)

  D                EA C      AC

     k , c         r
     d                  e e

          ky , cy

          chord c

Structural dynamic equations of motion with vertical translation of mass center C, yAC(t),
and pitch (t) as degrees of freedom (DOFs) are derived and expressed in matrix form in
Eq. (11-22). However, a more appropriate vertical translation DOF for this problem is
yEA(t)  y(t) of the elastic axis EA, as labeled on the figure above; the equations of motion
for DOFs y(t) and (t) are derived in homework Problem 11.4 and are expressed below,
with the addition of a damping matrix that represents approximately the energy dissipa-
tion within the springs (using the viscous-damping mathematical model described in Ap-
pendix B, Section B-5).

 m mr &y& cy 0  y& k y 0  y  F (t) 
   && +             & +        =                                        (P16.11-1)
mr J EA    0 c    0 k   M (t) + F (t)e

We assume that aerodynamic resultant lift force and moment (positive nose-up) are due
both to the motions of the typical section itself (self-excitation), and to sources such as
gusts that are independent of the motion, which we denote as lift FG(t) and moment

                   16-41
  Chapter 16 Introduction to system stability: time-response criteria

MG(t). There is no exact and readily applicable theory of unsteady, motion-dependent
aerodynamics; therefore, we use here one of the many approximate theories, the quasi-
steady aerodynamics of Fung, 1955, pages 191-193. In these equations of unsteady lift
and moment, we replace Fung's lift-curve slope for an airfoil of infinite span, CL = 2
per radian, with a reduced value of CL that applies for an airfoil of finite span. This is
appropriate for the specific numerical parameters considered below in part (b), which are
chosen to represent an actual experimental research investigation of typical-section aero-
elasticity. Since dynamic pressure is q = ½V 2, it is appropriate to define in Fung's

equations the constant K  ½S(2)  K  ½SCL . Thus, the motion-dependent and
motion-independent aerodynamic resultant lift and nose-up moment are written as:

   y& - d&                                  + FG (t) = K (V  - V y& + dV )+ FG (t)2&
  F (t) = qSCL  -
                                     V

                                                                                    (P16.11-2)

                                      c &         8 2 &
  M (t) = -qSc                             + M G (t) = -K c V + M G (t)
                                     8V           C L

(a) Substitute Eqs. (P16.11-2) into Eq. (P16.11-1), then transpose the motion-dependent

terms from the right-hand side to the left-hand side so that the damping and stiffness ma-

trices in (P16.11-1) become more general; for example, the structural-plus-aerodynamic

                                k y    - KV 2 
stiffness matrix becomes                        2  . Now you have a set of equations that, in

                                0    k - eKV 

principle, can be solved for DOFs y(t) and (t) by Laplace transformation. Assume null

initial conditions, y(0) = 0 and (0) = 0, and assume that FG(t) and MG(t) are Laplace

transformable functions, then express the Laplace-transformed equations of motion in the

following form, writing explicit quadratic (in s) polynomials for the four Mij(s;V) ele-

ments of the left-hand side coefficient matrix:

M11 (s;V ) M12 (s;V )Y (s)                   Y (s)           L[FG (t)]   
     [(s;V )]  =                                                          (P16.11-3)
M 21 (s;V ) M 22 (s;V )(s)                   (s) L[M G (t)] + eL[FG (t)]

The matrix solution of Eq. (P16.11-3) can be written as

  Y (s)                                           L[FG (t)]       
    = [TF(s;V )]                                                                    (P16.11-4)
  (s)                                      L[M G (t)] + eL[FG (t)]

where the 2 × 2 coefficient matrix [TF(s;V )] = [(s;V )]-1 is the multiple-input-multiple-

output (MIMO) transfer-function matrix relating two outputs, Y(s) and (s), to two in-
puts, L[FG(t)] and (L[MG(t)] + eL[FG(t)]); however, it is clear that each element of matrix

[TF(s;V )] is itself a single-input-single-output (SISO) transfer function. Use Eqs. (12-
10)-(12-12) to write an equation for [TF(s;V )] in terms of the four Mij(s;V) elements.

                                           16-42
                     Chapter 16 Introduction to system stability: time-response criteria

Note, in particular, that the denominator of each of the SISO transfer functions, TFij(s;V),

is the determinant det[(s;V )] = M11(s;V) × M22(s;V) - M21(s;V) × M12(s;V). By the
logic of Section 16-1, therefore, the quartic (in p) polynomial equation, det[( p;V )] = 0,

is the general characteristic equation of the system, and its four roots pi(V) at each free-
stream airspeed V determine both the character of unforced time response (e.g., exponen-
tial, oscillatory, etc.) and the system stability or instability at that particular airspeed.

(b) In this part, you will use the equations of part (a) to calculate and plot the loci of
roots, as wind-tunnel freestream airspeed V varies, using numerical parameters that were
selected to represent the research project of a Brazilian group, DeMarqui, et al., 2005 and
2006. The parameters of the typical-section airfoil and the wind-tunnel atmosphere are:

   Mass m = 18.0 kg
   Rotational inertia about mass center C: JC = 0.219 kg-m2; so JEA = JC + mr2
   Offset of mass center C forward of elastic axis EA: r = 5 mm = 0.005 m
   Stiffness constant of vertical-translation spring: ky = 1,110 N/m
   Stiffness constant of pitch-rotation spring: k = 49.8 N-m/radian
   Viscous-damping constant of vertical-translation spring: cy = 0.0107 sec × ky
   Viscous-damping constant of pitch-rotation spring: c = 0.00318 sec × k
   Planform: chord c = 0.45 m; span = 0.80 m; so, area S = c × span = 0.36 m2
   Offset of ¼-chord aerodynamic center AC forward of elastic axis EA: e = c/4
   Offset of ¾-chord dynamic-pitch point D aft of elastic axis EA: d = c/4
   Standard air density at 800-m average altitude of Sao Paulo, Brazil:  = 1.1337 kg/m3
   Lift-curve slope for this low-aspect-ratio airfoil: CL = 2.64 per radian

The most significant single result that you seek is the wind-tunnel freestream airspeed VF
at which the typical section experiences aeroelastic flutter. The flutter airspeed VF is that
value of V at which the dominant time response of the typical section is a pure sinusoid;
for lower airspeeds, 0  V < VF , the dominant response is stable positively damped os-
cillation; but for higher airspeeds, V > VF , the dominant response is unstable exponen-
tially expanding oscillation. Begin the numerical analysis by using Eq. (11-18) to calcu-
late the aeroelastic divergence airspeed VD in m/sec; because usually VD > VF , this value
of VD will suggest to you the range of airspeeds, 0  V < VD , over which you should cal-
culate the loci of roots in order to determine VF . Use MATLAB's conv and root opera-
tions to calculate, print out, and plot the loci of roots of characteristic equation M11(p;V) ×
M22(p;V) - M21(p;V) × M12(p;V) = 0. You might find useful the form of MATLAB script
M-file MATLABdemo164.m that produced Figs. 16-7 and 16-8 in Section 16-5. In this
problem, freestream velocity V plays the same role that control gain parameter  plays in
MATLABdemo164.m.

                                                  16-43
Chapter 17 Introduction to system stability: frequency-response criteria

Chapter 17 Introduction to system stability: frequency-response criteria

                           © 2016 by William L. Hallauer, Jr.

         Frequency-response concepts have been discussed extensively in many previous
chapters, most notably in Chapters 4 and 10 relative to methods of calculation and the
physical characteristics of frequency response in stable systems. In this chapter, we con-
sider methods using frequency response for assessing the stability of systems.

         To examine the stability of a closed-loop control system, we examine in particular
the frequency response of the associated open-loop system, for which the transfer func-
tion OLTF(s) = G(s) × H(s) was described in Section 16-6. The open-loop system itself is
usually manageable, not unstable, even though its closed-loop version might be unstable.
Therefore, the frequency-response function OLFRF()  OLTF(j) = G(j) × H(j) can
typically be measured on actual hardware, even if there is no good mathematical model
for the system. The reason for measuring and/or computing OLFRF() is that it provides
metrics of the absolute and relative stability of the closed-loop system. In other words, to
determine the stability of the closed-loop system, it might not be necessary to close the
loop with real hardware, possibly risking damage and/or injury.

         Recall that root-locus analysis is based on the characteristic equation 1 + G(s) ×
H(s) = 0, or G(s) × H(s) = -1; obviously, the right-hand-side number -1 is important to
the closed-loop poles and to closed-loop system stability. Similarly, the number -1 is
also highly significant when we evaluate stability using open-loop frequency response
G(j) × H(j).

17-1 Gain margins, phase margins, and Bode diagrams

In order to describe and illustrate the most basic form of frequency-response sta-

bility analysis, we consider again a familiar system from Chapter 16: the rotor position-
feedback control system with a 1st order low-pass filter in the feedback branch, for which

the functional diagram is Fig. 16-2 and the block diagram is Fig 16-3. We have already

studied this system to determine absolute stability by Routh's criteria in Section 16-3, and

relative stability by calculating    R(s)                               1  (s)
loci of roots and by applying the           Kr  + _ Ka J s2 + c s
root-locus method in Sections 16-
5 and 16-6. Knowing the stabil-                                1
ity characteristics in advance will
guide us in interpreting the fre-                    Ls +1        K

quency-response analysis.                       Figure 16-3 (repeated)

The branch transfer functions for the loop in Fig. 16-3 are

G(s) = 2K a                           and H (s) = K                        (17-1)
                           J s + c s                 Ls +1

                                      17-1
Chapter 17 Introduction to system stability: frequency-response criteria

The closed-loop transfer function is CLTF (s) = G(s) [1 + G(s)H (s)] ; the denominator of
CLTF(s) in this form for the system of Fig. 16-3 is

1 + G(s)H (s) = 1 + 2K a × K = 1 + K a K 1  L
J s + c s  L s + 1   J s(s + c J )(s + 1  L )
                                                                                   (17-2)
 1+  b
s(s + c J )(s + b )   1 + OLTF (s)

where   Ka K /J is the control parameter, which we now call gain. We evaluate the
stability of the closed-loop system as  ranges from 0 to +. The system constants from
Chapter 16 are b  1/L = 300 rad/sec and c / J = 100 sec-1. In Section 16-5, we solved
the characteristic equation of the closed-loop system, 1 + G(s) H(s) = 0.1 We know from
the loci of roots calculated for this system that, with gain  positive and increasing, there
is a particular value of  for which the oscillatory loci of roots intersect the Im[s] axis;
for this value of , the oscillatory time response is purely sinusoidal and periodic,
without any exponential envelope. Let's define that intersection as the point of
oscillatory neutral stability and denote the value of  there as ns (the same as ub in
Section 16-5). Accordingly, let's denote the oscillatory frequency at that point as ns (the
same as d in Section 16-5). We determined in Chapter 16 that ns = (c J ) ×

(c J + b ) = 40,000 sec-2 and ns = (c J )b = 173.2 rad/sec, and that the closed-

loop system is exponentially stable for 0 <  < ns , but unstable for  > ns .

The loci of roots are defined by the characteristic equation:

1 + G(s)H (s)  1 + OLTF (s) = 0                                                    (17-3)

Therefore, at the point of neutral stability, with  = ns and s = jns , we have
          1 + OLTF ( jns ) = 0  OLTF ( jns ) = -1 = 1× exp[ j(± , ± 3 , ...)]

      OLTF ( jns )  OLTF ( jns ) exp[ jOLTF ( jns )] = 1× exp[ j(± , ± 3 , ...)]

Equating magnitude ratios and phase angles in the last equation gives for  = ns :

OLTF ( jns ) = 1 and OLTF ( jns ) = (± , ± 3 , ...)                                (17-4)

        Equations (17-4) correspond physically, for  = ns , to the frequency-response
test depicted in Fig. 17-1 (a modification of Fig. 16-2) on the next page. For steady-state

1 We use the Laplace complex variable s in this chapter because it is traditional for treatment of frequency-
response theory to use s, instead of complex variable p (for s = p, a solution of the characteristic equation,
i.e., a pole of the closed-loop transfer function) that we used in Sections 16-3 through 16-6.

        17-2
Chapter 17 Introduction to system stability: frequency-response criteria

sinusoidal electrical-signal excitation ein(t) = Ein sin ns t of the open-loop system at the
neutral-stability frequency of the closed-loop system,  = ns , the magnitude ratio of the
open-loop frequency response is exactly 1 and the output electrical signal is exactly out
of phase with the input signal, meaning eout(t) = -Ein sin ns t.

Input signal              Moment    Ma (t)            Output
ein(t) = Ein sint         actuator             J      position
                                                       (t)
                             K a
                                                  c

Output signal             Low-pass  Position
eout(t) = Eout sin(t + )    filter   sensor
                              L
                                      K 

Figure 17-1 Functional diagram of frequency-response testing of
the open-loop portion of Figs. 16-2 and 16-3

        The observation that, for  = ns , output eout(t) = -Einsin ns t in response to input
ein(t) = Einsin ns t provides motivation for conducting steady-state-sinusoidal tests on the
open-loop system over a band of frequencies surrounding ns , not just ns , and for other
values of , not just ns , in order determine if this type of testing provides information
regarding the stability of the closed-loop system. We can simulate such a test by eval-

uating numerically the open-loop frequency-response function, from Eq. (17-2):

OLFRF ()  OLTF ( j) =  b                                                  (17-5)
                                   j( j + c J )( j + b )

To begin, in order to establish a reference set of results for the neutral-stability value of
gain,  = ns , we calculate and plot from Eq. (17-5) frequency-response components
using the following MATLAB code:

>> wb=300;coj=100;wns=sqrt(wb*coj);
>> wbar=logspace(-1,1,100);w=wbar*wns;
>> lm=4e4;olfrf4e4=lm*wb./(j*w.*(j*w+coj).*(j*w+wb));
>> subplot(2,1,1),loglog(wbar,abs(olfrf4e4)),grid
>> faz=atan(imag(olfrf4e4)./real(olfrf4e4))-pi*ones(1,length(w));
>> subplot(2,1,2),semilogx(wbar,faz*180/pi),grid

Figure 17-2 (next page) includes the graphical results from these MATLAB operations.

For now, we focus on just the plots of the polar components, magnitude ratio and phase
angle, for  = ns = 40,000 sec-2; the additional annotations on the phase plot for "PM"
at other values of  will be explained in due course. If we were testing the real hardware

of Fig. 17-1, rather than just numerically simulating a test, then the magnitude ratio
would be the measured quantity Eout / Ein as frequency  is varied, and the phase angle 
would be calculated from measurements by the method presented in Section 4-4.

                          17-3
                  Chapter 17 Introduction to system stability: frequency-response criteria

Figure 17-2 Modified Bode diagram, Eq. (17-5), frequency response for  = ns =
40,000 sec-2 of the open-loop system in Fig. 17-1

Figure 17-3 Magnitude ratios, Eq. (17-5) for  = 4,000 and 400,000 sec-2

                                                   17-4
                  Chapter 17 Introduction to system stability: frequency-response criteria

         The upper plot of Fig. 17-2 shows that, for  = ns , magnitude ratio OLFRF
varies smoothly from greater than 10 at  = 0.1ns , through the previously determined
value of 1 at  = ns , down to less than 0.01 at  = 10ns . The lower plot shows that
phase angle OLFRF is a lag ranging from more than -90° at  = 0.1ns , through the
previously determined phase of -180° at  = ns , down to a lag approaching -270° at 
= 10ns . We have from Eq. 17-4 for  = ns , OLFRF (ns ) = (± , ± 3 , ...) , which is
ambiguous regarding the multiple and sign of  that is appropriate; the phase plot of Fig.
17-2 removes the ambiguity, at least for this system: clearly, OLFRF (ns ) = - rad.2

         With Fig. 17-2 for  = ns as the reference open-loop frequency response repre-
senting the neutrally stable closed-loop system, we can now compute simulated open-
loop frequency responses for other values of , specifically, those for which the closed-
loop system is oscillatory and either exponentially stable or unstable. With the following
MATLAB code, we calculate and plot on Fig. 17-3 (on the previous page) the magnitude-
ratio (only) frequency-response graphs for the gain  = 0.1ns = 4,000 sec-2, for which
we know the closed-loop system is stable, and for the gain  = 10ns = 400,000 sec-2, for
which we know the closed-loop system is unstable:

>> wb=300;coj=100;wd=sqrt(wb*coj);
>> wbar=logspace(-1,1,100);w=wbar*wd;
>> lm=4e3;olfrf4e3=lm*wb./(j*w.*(j*w+coj).*(j*w+wb));
>> lm=4e5;olfrf4e5=lm*wb./(j*w.*(j*w+coj).*(j*w+wb));
>> subplot(2,1,1),loglog(wbar,abs(olfrf4e3)),grid
>> subplot(2,1,2),loglog(wbar,abs(olfrf4e5)),grid

If we were to calculate the phase angles for any value of , we would find them to be
identical to those on the phase-angle graph for  = ns of Fig. 17-2, which is the reason
for not repeating the phase-angle calculations. (The theory behind this feature of open-
loop phase angle, and also the variation of open-loop magnitude for different values of ,
will be presented at the end of this section.)

         By comparing the open-loop magnitude-ratio graphs of Figs. 17-2 and 17-3, we
observe the magnitudes for the closed-loop stable case  = 0.1ns to be less than those
for neutral stability,  = ns , and the magnitudes for the unstable case  = 10ns to be
greater. We conclude from this that open-loop magnitudes less than or greater than those
for neutral stability are an indication of closed-loop absolute stability. If we were to cal-
culate the open-loop magnitude ratios for other values between 0.1ns and 10ns , we

2 The line of MATLAB code that calculates phase requires the angles to be between -/2 and -3/2 rad, so
the argument here appears to be circular. However, if we were to use the more general MATLAB function
angle in place of that line of code, we would find, in the range of 0.1  /ns < 1.0, exactly the same lag-
ging phases as are on the phase plot of Fig. 17-2, which does validate the assertion that the appropriate val-
ue is - rad. We did not use angle, because it is apparently based upon MATLAB's four-quadrant inverse
tangent function atan2, which returns angle values only between - and + rad. Therefore, on the graph
of phase versus /ns , angle would produce an artificial and confusing discontinuous jump in phase from
-180° to +180° at /ns = 1.0 and, in the range of 1.0  /ns  10, phase would drop from +180° to a little
more than +90°.

                                                   17-5
Chapter 17 Introduction to system stability: frequency-response criteria

would find that the variation is monotonic and regular; this suggests that open-loop mag-
nitude can also provide a metric for closed-loop relative stability, i.e., the degree of sta-
bility or instability. Indeed, there is a commonly accepted metric called gain margin
(GM); if we denote the gain margin for a particular value of  as GM(), then it is de-
fined as the following dimensionless ratio of open-loop magnitudes:

            OLFRF (ns )  at OLFRF (ns )  = -180°                          (17-6)
GM()  ns ns

               OLFRF ()  at OLFRF ()  = -180°
          =1

            OLFRF ()  at OLFRF ()  = -180°

In the second form of Eq. (17-6), which is the working definition, we applied the unit
magnitude value derived in Eq. (17-4). The condition OLFRF ()  = -180° is called,
descriptively, a phase crossover.

         Applying Eq. (17-6) to Figs. 17-2 and 17-3, we calculate these gain margins:
GM(0.1ns) = 10 for the closed-loop stable system; and GM(10ns) = 0.1 for the unstable
system. Clearly, GM > 1 implies closed-loop stability and 0 < GM < 1 implies instabil-
ity. Expressing GM in terms of its logarithm to the base 10 (denoted "log") is also of
value, since in this form GM is positive for closed-loop stability, zero for neutral stabil-
ity, and negative for instability. It is traditional in control-system engineering to express
GM in decibels (dB), in which unit the value of a positive number N is 20 × log N dB.
Accordingly, GM(0.1ns) = +20 dB for the closed-loop stable case of Fig. 17-3, and
GM(10ns) = -20 dB for the unstable case.

Another open-loop frequency-response metric for closed-loop degree of stability

is the phase margin (PM). The phase margin for a given value  of the control parameter
is defined as the lag angle at the frequency for which the magnitude ratio is unity relative

to the comparable lag angle for the neutral-stability case,  = ns :

( ) PM() = (OLFRF ()  at OLFRF ()  = 1)- OLFRF (ns )  at OLFRF (ns )  = 1
                                                                     ns   ns

From Eq. (17-4) and the phase plot of Fig. 17-2, the reference lag angle is just -180°, so

PM() = 180° + (OLFRF ()  at OLFRF ()  = 1)                                (17-7)

The condition OLFRF ()  = 1 is called a gain crossover. Reading approximately the

appropriate phases from the phase plot of Fig. 17-2, we calculate these phase margins:
PM(0.1ns)  180° - 120° = +60° for the closed-loop stable system, and PM(10ns) 
180° - 225° = -45° for the unstable system. (See homework Problem 17.2(a) for
calculation of the more precise values of PM annotated on Fig. 17-2.) Clearly, PM > 0°
implies closed-loop stability and PM < 0° implies instability.

17-6
                  Chapter 17 Introduction to system stability: frequency-response criteria

         Brogan, 1974, page 25, described succinctly the practical interpretation of these
stability margins for an initially stable closed-loop system: "Gain margin GM is a mea-
sure of additional gain a system can tolerate with no change in phase, while remaining
stable. Phase margin PM is the additional phase shift that can be tolerated, with no gain
change, while remaining stable."

         We have defined and illustrated gain and phase margins for stable and unstable
feedback control using the physical system of Figs. 16-2, 16-3, and 17-1. The behavior
of this physical system is fairly "common" in the sense that it is stable for gain  = 0 and
for low positive values of , but it is unstable for all values of  greater than a particular
neutral-stability value, ns . For any such common physical system, the open-loop fre-
quency-response metrics of gain margin and phase margin described in this section are
valid measures of absolute and relative stability. However, for "uncommon" physical
systems, gain margins and phase margins of open-loop frequency response can be am-
biguous and difficult to interpret; for example, such an uncommon system might have
PM = +78° but GM = -10 dB, yet still be closed-loop stable. For such uncommon sys-
tems, a more general and involved, but unambiguous, approach to frequency-response
analysis is based on the Nyquist stability criterion, which is the subject of Section 17-3.

         Now that we know how to calculate open-loop frequency responses in the format
of Figs. 17-2 and 17-3 using standard MATLAB commands, it is appropriate that we not
have to do so for every problem, but, instead, that we can apply the built-in MATLAB
functions margin and bode to produce more easily the same results. Before calling one
of these functions, it is necessary first to define with the tf command a MATLAB linear-
time-invariant (LTI) transfer-function model. The following, for the gain  = 10ns of
the same system as that of Figs. 17-2 and 17-3, shows one of the many ways to do this,
along with the MATLAB responses:

>> wb=300;coj=100;
>> s=tf('s')

Transfer function:
s

>> lm=4e5;oltf4e5=lm*wb/(s*(s+coj)*(s+wb))

Transfer function:
              1.2e008

-----------------------
s^3 + 400 s^2 + 30000 s

>> margin(oltf4e5)

This margin command produced the Bode diagram or plot of Fig. 17-4 (next page),
which is annotated with the GM and PM for this case,  = 10ns , that of the unstable
closed-loop system. (The bode function itself also produces the Bode diagram, but with-
out calculating and printing the GM and PM.) Note that it was not necessary to specify
the frequency band--MATLAB chose an appropriate band. By comparing Fig. 17-4 with

                                                   17-7
                  Chapter 17 Introduction to system stability: frequency-response criteria

Figs. 17-2 and 17-3, you should observe some differences in format, which is why Fig.
17-2 is labeled a "modified" Bode diagram; but there are no differences in the essential
content. A traditional Bode diagram such as Fig. 17.4 plots the frequency-response mag-
nitude ratio (in decibels) versus frequency (in rad/sec or Hz), which is presented on a
logarithmic scale in order to accommodate a very wide band.

Figure 17-4 MATLAB's traditional Bode diagram, Eq. (17-5), frequency response
for  = 10ns = 400,000 sec-2 of the open-loop system in Fig. 17-1

         To conclude this section, we consider for systems in general how changes in gain
 influence open-loop frequency responses and their graphical representations on Bode
diagrams (and Nyquist diagrams in Section 17-4). We infer from Eqs. (16-61) and (16-
62) that an open-loop transfer function can generally be expressed in the form

OLTF (s) =  × TF1 (s)                                 (17-8)

where the baseline transfer function TF1(s) is obviously defined as OLTF (s) =1 . The
associated general frequency-response function is

OLFRF () =  × TF1 ( j) =  × TF1( j) × exp[ jTF1( j)]  (17-9)

Equation (17-9) leads to the following general forms for open-loop frequency-response
magnitude ratio (MR) and phase angle  :

17-8
Chapter 17 Introduction to system stability: frequency-response criteria

MR() = OLFRF () =  × TF1 ( j)   × MR1()                                   (17-10)

                    () = TF1 ( j)                                         (17-11)

Equation (17-11) shows that the variation of phase angle with frequency, (), is the
same for all values of gain , as was stated earlier in the context of Figs. 17-2 and 17-3.

         In the final form of Eq. (17-10), we define the baseline magnitude ratio (i.e., for
unity gain,  = 1) as MR1()  TF1 ( j) . It is also informative to express Eq. (17-10) in

a logarithmic form, either in logarithm to base 10 as on Figs. 17-2 and 17-3, or in deci-
bels as on a traditional Bode plot such as Fig. 17-4:

                    log(MR()) = log() + log(MR1 ())                       (17-12a)

20 × log(MR())  [MR()](dB) = [](dB) + [MR1()](dB)                         (17-12b)

We infer from Eqs. (17-10) and (17-12) that the graphical shape of the functional varia-
tion with frequency of magnitude ratio MR() does not change with changes in gain .
For modified Bode plots such as Fig. 17-2 and 17-3, given the baseline curve MR1(), we
can find from Eq. (17-12a) the curve for any other gain  > 1 just by adding to the base-

line curve the value log(), which moves the entire curve up by the distance log() along

the magnitude-ratio axis. The process of finding curves for different gains  from Eq.

(17-12b) is easy for a traditional Bode plot such as Fig. 17-4, on which magnitude is plot-

ted in decibels with a linear scale. For example, we can find from Fig. 17-4 the magni-
tude curve for  = 40,000 sec-2 simply by moving downward by 20 dB, i.e., by 20 ×
[log(40,000) - log(400,000)], the magnitude curve for  = 400,000 sec-2.

17-2 Nyquist plots

         We now depart temporarily from the analysis of stability in order to describe a
type of frequency-response graphical representation that has not appeared previously in
this book. Such a graph is commonly called, in the language of control-system
engineering, a Nyquist diagram or plot.

         We begin the description of Nyquist plots by re-visiting a familiar system from
several previous chapters: the standard, positively damped 2nd order system. The ODE

of this system for output x(t) in response to input u(t) is &x& + 2n x& + n 2 x = n 2u(t) [Eq.

(9-13)], and the frequency-response function is

                                         n2          (10-7, repeated)
                    FRF () = 2 2

                                n -  + j2n

                    17-9
                  Chapter 17 Introduction to system stability: frequency-response criteria

The previous graphical representation of Eq. (10-7) in this book is Fig. 10-2, a modified
Bode diagram displaying the variation with frequency  of the polar components, mag-
nitude ratio FRF () and phase angle  = FRF() . A Nyquist plot, in contrast, dis-
plays directly the mathematical rectangular components, in the format Im[FRF()] ver-
sus Re[FRF()], with frequency  being the implicit independent variable, for which
there is no graduated scale without extra annotation or a three-dimensional third axis per-
pendicular to the complex FRF()-plane. For example, the following MATLAB com-
mands produce Fig. 17-5, a Nyquist plot of Eq. (10-7) for undamped natural frequency n
= 2 rad/sec and damping ratio  = 0.2:

>> wn=2*pi;zt=0.2;
>> w=wn*logspace(-2,2,400);
>> frf=wn^2./(wn^2-w.^2+j*2*zt*wn*w);
>> plot(real(frf),imag(frf)),grid

Figure 17-5 Nyquist plot of FRF() = n2/(n2 -  2 + j2n) for n = 2 rad/sec
and  = 0.2

         Observe on Fig. 17-5 that the abscissa and ordinate axes are labeled both with the
mathematical descriptions, Re[FRF()] and Im[FRF()], and with the corresponding
physical descriptions of the response components, respectively: in-phase (0°, also known
as coincident) and quadrature (leading by 90°). If you were measuring frequency re-
sponse experimentally on a damped 2nd order system you might generate the physical in-
formation of Fig. 17-5 in the following manner: first, measure the polar components of

                                                  17-10
Chapter 17 Introduction to system stability: frequency-response criteria

response, magnitude ratio FRF() and phase angle () = FRF() , using the proce-

dure described in Section 17-1 relative to Fig. 17-2, the modified Bode diagram; then, use
Eq. (2-5) for converting complex numbers from polar form into rectangular form to cal-
culate FRFin-phase() = FRF () × cos() and FRFquadrature() = FRF () × sin().

An example of this conversion is illustrated on Fig. 17-5 for  = 0.8783n : 1.301 =
2.386 × cos(-56.95°), and -2.000 = 2.386 × sin (-56.95°).

         The concept of physical in-phase and quadrature frequency-response components
might seem strange. Moreover, their values can be either positive or negative (as Fig. 17-
5 shows for the in-phase component), and that might be confusing: if a pure "in-phase"
response is negative, then the response is actually 180° out of phase with the excitation;
and if a pure "quadrature" response is negative, then the response actually lags the
excitation by 90°. In order to provide more clarity, even at the risk of being redundant,
we present the following table, which lists multiple-of-90° values of phase angle  that
correspond to particular values or ranges of the in-phase and quadrature components.

In-phase component  Quadrature component  Phase angle 
           > 0                   = 0
           = 0                   < 0       0° and m 360°
           < 0                   = 0      -90° and +270°
           = 0                   > 0
                                               m 180°
                                          -270° and +90°

It might be instructive also to compare the Nyquist plot of Fig. 17-5 with the correspond-
ing polar components for  = 0.2 on the modified Bode plots of Fig. 10.2. On both
figures for   0, the response is essentially the static value, FRF(0) = +1 + j0. As fre-
quency  increases from 0+ to n , the magnitude ratio varies (mostly increasing) from
+1 to 1/(2) = 2.5, while the phase angle, a lag, varies from 0° to -90°. At  = n , the
response is pure negative quadrature, FRF(n) = 0 - j2.5. As  increases above n , the
magnitude ratio decreases monotonically while the phase lags further, with the magnitude
ratio approaching zero and the phase approaching -180° as   .

         Frequency response of the standard, positively damped 2nd order system is well
behaved, especially for  = 0, i.e., a non-zero input that is constant in time, for which the
system has an unquestionably stable non-zero constant static output. Let's consider now
Nyquist plotting for a contrasting system, an open-loop system that lacks a stable static
response, the system of Section 17-1 (also Sections 16-3, 16-5, and 16-6). The clearest
indication of a possible difficulty is Eq. (17-5) for OLFRF(), which indicates an infinite
response for  = 0. The mathematical source of this difficulty is the pole of OLTF(s) at
the s-plane origin, which is apparent in Eq. (17-2), Fig. 16-9, and elsewhere. The
graphical display of frequency response magnitude becoming very large as   0 is
produced by the following MATLAB commands, which calculate frequency response
and produce a Nyquist plot of the same numerical solution as that on Fig. 17-2, for the
neutral-stability case  = ns = 40,000 sec-2 :

                    17-11
Chapter 17 Introduction to system stability: frequency-response criteria

>> wb=300;coj=100;wns=sqrt(wb*coj);
>> wbar=logspace(-1,1,200);w=wbar*wns;
>> lm=4e4;olfrf4e4=lm*wb./(j*w.*(j*w+coj).*(j*w+wb));
>> plot(real(olfrf4e4),imag(olfrf4e4)),grid

Figure 17-6 is an annotated portion of the MATLAB graph that displays the noteworthy
features of the Nyquist plot. This plot shows that for frequency  becoming progres-
sively smaller, the negative quadrature component of response becomes progressively
larger.

                                                          In fact, we can calculate from Eq. 17-5
                                                 the asymptotic nature of the variation of open-
                                              loop frequency response as   0, by applying
                                                 the method of complex rectangular division
                                                 described in Section 2-1:

OLFRF () = b
                 j( j + c J )( j + b )

  = ( j)3 - (100 + 300) 2 40,000 × 300 + (100 × 300) j
     1.2 ×107 × [-400 2 - j(3×104  -  3 )]

   = 82 54 6
            9 ×10  + 1×10  + 

Therefore, as   0,

OLFRF ()   1.2 ×107 ×[-400 2 - j(3×104)]

                                                       82
                                                       9 ×10 

       = -5 13 - j 400                                                           (17-13)
                    

Figure 17-6 Nyquist plot, Eq. (17-5), frequency response for  = ns = 40,000 sec-2
of the open-loop system in Fig. 17-1, with parameters b = 300 sec-1, c / J = 100 sec-1,
and ns = (b × c / J) = 173.2 rad/sec

17-3 The practical effects of an open-loop transfer-function pole at s = 0 + j0

         The development above demonstrates an important characteristic of an open-loop
system with a transfer-function pole at the s-plane origin: frequency response of such a
system increases in magnitude progressively as excitation frequency decreases, becom-
ing, in theory, infinitely large for zero frequency. What is the significance of this type of
response relative to experimental testing? The question is appropriate since, as asserted
in the introduction to this chapter, frequency-response of the open-loop portion of a prac-
tical system (actual hardware) can indicate the stability or instability of the corresponding
closed-loop system. Figure 17-6 and Eq. (17-13) show clearly that the frequency-re-
sponse magnitude for very low frequencies of excitation could indeed be impractically

17-12
   Chapter 17 Introduction to system stability: frequency-response criteria

large. This might lead us to assume that, in order to avoid excessive output magnitudes,
we would need only to excite the open-loop system at frequencies above some practical
lower limit. The discussion in this section will show that this would be a potentially
harmful assumption.

         What is the nature of response associated with a system's transfer-function pole at
the origin of the s-plane? We know that a pole on the Re(s) axis in the right-half s-plane
means the system's time response (to an impulse, for example) is essentially monotoni-
cally growing exponential, an instability. (See the discussion of Section 16-4.) Con-
versely, a pole on the Re(s) axis in the left-half s-plane means the response is essentially
monotonically decaying exponential, a stable response. Can we infer, then, that a pole
on the Re(s) axis at the origin, between the right- and left-half planes, means time re-
sponse is neither unstable nor stable, but somehow neutral?

Let's try to answer that question, at least for the open-loop system of current

interest that motivated this discussion, by deriving the unit-impulse response, h(t). From

Eq. (8-35), a system's transfer function is also the Laplace transform of its unit-impulse

response; accordingly, Eq. (17-2) gives L[h(t)] = b [s(s + c J )(s + b )] . We could

find the complete equation for h(t), but it is easier and equally relevant for this discussion

to apply the final-value theorem [Eq. (15-15)] to find the steady-state response [which we

can show follows the decay to zero of stable terms whose time functions are e-(c J )t and

e-bt ]: lim h(t) = lim s × L[h(t)] = J c . This constant-in-time response to an impulse
t  s0

excitation is unusual, since impulse response of a stable system normally decays to zero.

         Let's probe further and find the response to a step input, which is a better gauge
of stability than impulse response. Equation (8-40) shows that the unit-impulse response
of any LTI-SISO system is the time derivative of the unit-step response, h(t) = dxH dt .
Therefore, the unit-step response as t   of the open-loop system of current interest
must be lim xH (t) = C + ( J c ) t , C being a constant. This linear-function-of-time

                   t 

response to a constant input can increase monotonically, without bound. This is not an
exponential monotonic instability or exponential oscillatory instability of the type we
have observed previously; nevertheless, for all practical purposes, it is a genuine form of
instability.

         We can be even more specific relative to frequency response. With reference to
the functional diagram that depicts testing of the open-loop system, Fig. 17-1, suppose
that the input signal, in addition to the sinusoidal excitation, has a slight constant voltage
offset, Eoff . (Even with high-pass filtering, it is often nearly impossible to eliminate all
such offsets from real circuitry used in experimental testing.) Therefore, with H(t) de-
noting the Heaviside unit-step function, the complete input signal is:

       ein (t) = Ein sin t + Eoff H (t)                                      (17-14)

       17-13
Chapter 17 Introduction to system stability: frequency-response criteria

With use of OLTF(s) of Eq. (17-2) and inverse Laplace transformation, we can find an
algebraic equation for the response in time to input Eq. (17.14), assuming zero initial
conditions. The full equation is quite lengthy. It includes transient-response terms whose
time functions are e-(c J )t and e-bt , both of which decay quickly to insignificance. If
we omit those transient-response terms, then we can express the "steady-state" response
in the form (homework Problem 17.?):

eout (t) = Ein  MR() × sin(t + ()) +                J  (c J + b ) 
                                              + Eoff t -                   (17-15)
                                      (c J )        c  (c J )b 

Open-loop frequency-response magnitude ratio MR() and phase angle () are the
quantities defined generally by Eqs. (17-10) and (17-11), respectively, and represented
for this specific system, from Eq. (17-5), by the equations:

MR() =  b                             and () =    b 
              j( j + c J )( j + b )                     j( j + c J )( j + b ) 

         Ideally in experimental sinusoidal testing, there would be only steady-state sinu-
soidal response. Much less ideally, however, there are in Eq. (17-15) three types of time
response: the sinusoidal term, two constant-in-time terms, and a term that increases
linearly with time. The constant-in-time terms would be a nuisance, but they could be
tolerable, provided they were not so large as to overcome mechanical or electrical limits.
However, the unstable linear "drift", Eoff (J c ) t , would present a serious problem in

the testing process. Consider, for example, the numerical solution of Eq. (17-15) for the
open-loop system with the ideal frequency response of Figs. (17-2) and (17-6), and for
excitation at the neutral-stability frequency,  = ns . For this case, Figs. (17-2) and (17-
6) show that MR(ns) = 1 and (ns) = -180°. Completing the calculations in Eq. (17-15)
with the remaining numerical values gives:

   Eoff 1 
  eout (t) = Ein (- sin nst + 2.309)+ (400t - 5 3)                        (17-16)
                                               Ein
                                                          

Equation (17-16) shows, for example, that if the offset voltage is even a mere 1% of the
input sinusoidal magnitude, Eoff /Ein = 0.01, then, after only one second of system re-
sponse, the linear drift increases to four times the sinusoidal-response magnitude; and the
linear drift just continues rising inexorably thereafter. Practical sinusoidal testing of this
system would be possible only if the offset voltage were almost completely eliminated, in
order to prevent, or at least minimize, this unstable drift.

         The type of response represented in Eq. (17-15) and illustrated numerically in Eq.
(17-16) would pose a formidable challenge for any type of standard experimental testing
on any system whose mathematical model has a pole at the origin of the s-plane. This
mathematical model represents a general physical deficiency of such a system: the ab-
sence of a passive mechanism that tends to restore the system toward a static equilibrium
state after the system has been perturbed dynamically. For example, the damped-rotor

                                     17-14
                  Chapter 17 Introduction to system stability: frequency-response criteria

plant of our system of current interest, Figs. (16-3) and (17-1), is the prime contributor to
the unstable drift; this plant lacks a restoring rotational spring, and so its transfer func-
tion, Eq. (16-39), PTF(s) = 1 [s(Js + c ] , has a pole at the origin.
17-4 The Nyquist stability criterion

         Section 17-1 describes how the stability margins of gain (GM) and phase (PM)
are defined and displayed on Bode plots. It is informative and it will turn out to be even
more general to extract the same stability margins from Nyquist plots of frequency re-
sponse. To begin this study, we will repeat the Nyquist plot of Fig. 17-6, the closed-loop
neutral-stability case, for which  = ns = 40,000 sec-2 and ns = 100 3 rad/sec, but
over a narrower band of excitation frequencies, 100    1,000 rad/sec, or 1 3  /ns
 10 3 ; the intent here is to restrict our attention primarily to frequency response for
which the phase lag exceeds about 150°, i.e., for which the frequency-response curve in
the OLFRF-plane is somewhat close to the negative real axis. Moreover, we will add to
the same graph the Nyquist plots of frequency response for a case of positive closed-loop
stability with  = ½ns = 20,000 sec-2, and for a case of closed-loop instability with  =
2ns = 80,000 sec-2. The MATLAB commands follow that calculate [from Eqs. (17-5)
and (17-9)] and plot these cases of open-loop frequency-response function, and the re-
sulting Nyquist diagram (after additional editing):

>> wb=300;coj=100;w=logspace(2,3,200);
>> olfrf01=wb./(j*w.*(j*w+coj).*(j*w+wb));
>> olfrf20k=20e3*olfrf01;olfrf40k=40e3*olfrf01;olfrf80k=80e3*olfrf01;
>> plot(real(olfrf80k),imag(olfrf80k),real(olfrf40k),imag(olfrf40k),...
real(olfrf20k),imag(olfrf20k)),grid

Figure 17-7 Nyquist plots of Eq. (17-5), open-loop frequency-response functions
(OLFRF) for  = (½, 1, and 2) × ns for the system in Fig. 17-1, with parameters b
= 300 sec-1, c / J = 100 sec-1, and ns = (b × c / J) = 173.2 rad/sec

                                                  17-15
Chapter 17 Introduction to system stability: frequency-response criteria

         Gain margin and phase margin are present and measurable on Nyquist plots such
as those of Fig. 17-7. Gain margin (GM) is defined by Eq. (17-6), from which we find

1 GM () = OLFRF()  at OLFRF()  = -180°                                    (17-17)

Equation (17-17) is illustrated on Fig. 17-8 for both closed-loop stable and unstable
cases. Note that a closed-loop-stable case has 0 < 1/GMS < 1 so that GMS > 1, and a
closed-loop-unstable case has 1/GMU > 1 so that 0 < GMU < 1.

                             Im[OLFRF]

OLFRFU                  PMU

        -1 + j0

                             Re[OLFRF]

        PMS 1/GMS

        OLFRFS

1/GMU

Figure 17-8 Schematic Nyquist plots of open-loop frequency-response functions
(OLFRF) for closed-loop-stable and -unstable cases

         We can measure phase margin directly by drawing on the Nyquist diagram a
circle with radius of 1 unit and centered on the origin of the complex OLFRF-plane, so
that it passes through the important point -1 + j0. Phase margin is defined by

PM() = 180° + (OLFRF()  at OLFRF ()  = 1)  (17-7, repeated)

Phase margins are indicated graphically on Fig. 17-8. The positive PMS for a closed-
loop-stable case is the counterclockwise angle from the negative Re[OLFRF] axis to the
intersection of the unit circle with the OLFRFS curve; conversely, the negative PMU for a
closed-loop-unstable case is the clockwise angle from the negative Re[OLFRF] axis to
the intersection of the unit circle with the OLFRFU curve.

        Note on Fig. 17-8 that the phase-crossover point (phase angle  = -180°) and the
gain-crossover point (magnitude ratio MR = 1) of an FRF are clearly evident on a Nyquist
plot, perhaps even more naturally than on a Bode diagram. On the other hand, a Bode
diagram displays the phase-crossover and gain-crossover frequencies, which are not
explicit on a traditional Nyquist plot.

                 17-16
Chapter 17 Introduction to system stability: frequency-response criteria

         With a little imagination, we infer from the Nyquist plots of Fig. 17-7 that the
open-loop system represented in that figure has GM > 0 and PM > 0 for 0 <  < ns , and
that GM < 0 and PM < 0 for all values of gain  greater than ns ; accordingly, the asso-
ciated closed-loop system is stable for 0 <  < ns , and unstable for all values of gain 
greater than ns . Thus, this physical system (of Figs. 16-2, 16-3, and 17-1) is considered
a "common" system, for which gain margin and phase margin provide clear and unambi-

guous metrics of stability. Let's consider next an "uncommon" system, for which the

determination of stability or instability requires a more detailed examination of the sta-
bility margins. Suppose that the open-loop transfer function of a system is3

G(s) × H (s)  OLTF (s) =   s 2 + 4s + 104  = 3  s 2 + 4s + 104            (17-18)

                                    2           2
                           (s + 1)(s + 2s + 26) s + 3s + 28s + 26

You should be able to show that the zeros of this transfer function in the complex s-plane
are at (-2 ± j10), and the poles are at (-1 + j0) and (-1 ± j5).

         In order to establish the reference for stability and instability of the closed-loop
system corresponding to Eq. (17-18), we determine the loci of roots from the character-
istic equation, 1 + GH = 0, or

    s3 + 3s 2 + 28s + 26 + (s 2 + 4s + 104) = s3 + (3 + )s 2 + 4(7 + )s + 26(1 + 4) = 0
                                                                                                   (17-19)

The following MATLAB commands, adapted from the code that produced Fig. (16-7),
calculate and plot the loci of roots:

Lm=[0 .2 .4 .7 1 1.5 2.5 3.7 4.75 6.5 9 12.5 15 18.5 25 35 50 70 125 250];

Np=length(Lm);
for i=1:Np;

       a2=3+Lm(i);a3=4*(7+Lm(i));a4=26*(1+4*Lm(i));
       p(i,1:3)=roots([1 a2 a3 a4]).';
end
plot(p,'kx'),grid,xlabel('Real part of pole (sec^-^1)')
ylabel('Imaginary part of pole (sec^-^1)')

The significant roots of Eq. (17-19) are shown on Fig. 17-9 (next page): the complete
locus of oscillatory roots with positive imaginary parts is shown; only the beginning of
the locus of real (exponentially stable) roots is shown, since those roots become progres-
sively more negative as gain  increases from the initial small values. The oscillatory
roots on Fig. 17-9 show that the closed-loop system is stable for  = 0 up to   1, it is
unstable for   1 up to   15, and it becomes stable again for  greater than  15. We
regard this closed-loop system as being "uncommon" or unusual because it is stable for
small and large values of gain , but unstable for a range of intermediate values.

3 This transfer function was concocted for the purpose of demonstration. It does not represent any specific

real physical system, but it has characteristics that are representative of some real systems. Gain  has
physical units of sec-1, but we will not bother to show units in the following discussion.

                           17-17
Chapter 17 Introduction to system stability: frequency-response criteria

         If we were to test experimentally the open-loop part of this system in order to
determine the stability of the closed-loop system, what would the open-loop frequency
responses be for different values of gain ? To simulate that testing, we have from Eq.
(17-18), the following equation for the frequency-response function:

OLFRF()  OLTF ( j) =   104 -  2 + 4 × j                                   (17-20)

                                              2
                       (1 + j)(26 -  + 2 × j)

        Let's begin this study by computing OLFRF()
and displaying it on Nyquist plots for a low value of gain,
 = 0.7 (for which the closed-loop system is stable), and
for the value corresponding to the transition from stability
to instability on Fig. 17-9, which we denote as ns1  1.
The value of ns1 is not exactly 1, as Fig. 17-9 might sug-
gest; see homework Problem 17.2(b) for calculation of
the more precise value ns1 = 0.96438. The following
MATLAB commands calculate and plot the two
frequency responses and also, for determining phase
margins as shown on Fig. 17-8, an arc of the unit circle
centered on the origin of the complex OLFRF()-plane.

                                              >> w=3.4*logspace(0,2,500);
                                              >> olfrf01=(104-w.^2+4*j*w)./((1+j*w).*(26-
                                              w.^2+2*j*w));
                                              >> olfrf007=0.7*olfrf01;
                                              >> plot(real(olfrf007),imag(olfrf007)),grid
                                              >> cirangrad=0.8*pi:0.01:1.2*pi;
                                              >> hold,plot(cos(cirangrad),sin(cirangrad))
                                              Current plot held
                                              >> olfrfns1=0.96438*olfrf01;
                                              >> plot(real(olfrfns1),imag(olfrfns1))

Figure 17-9 Loci of roots of Eq. (17-19)

         The portions of both Nyquist plots (for  = 0.7 and  = ns1) that are closest to
the negative Re[OLFRF] axis are shown on Fig. 17-10 (next page). Observe on Fig. 17-
10 the small loops beneath the negative Re[OLFRF] axis as driving frequency becomes
very high: the frequency responses approach zero from below the origin of the complex
OLFRF-plane. This is distinctly different from the Nyquist plots of a more "common"
open-loop system on Fig. 17-7, which approach the origin from above as frequency be-
comes very high. Another aspect of the difference between the plots on the two figures is
particularly significant: whereas the plots on Fig. 17-7 cross the negative Re[OLFRF]
axis only once as driving frequency  increases, those on Fig. 17-10 have two phase
crossovers, i.e., the phase angle is -180° for two different values of . Since on Fig. 17-
10 there are two different frequencies at which OLFRF ()  = -180°, the definition of
gain margin in Eqs. (17-6) and (17-17) is ambiguous: at which, if either, of the phase

17-18
                  Chapter 17 Introduction to system stability: frequency-response criteria

crossovers is it appropriate to read the quantity 1/GM, as shown on Fig. 17-8? Which, if
either, of the values calculated from that reading, GM = (1/GM)-1 is a legitimate metric
of closed-loop stability? Figure 17-10 includes the Nyquist plots for both  = 0.7 and 
= ns1 , the latter of which by definition crosses the negative Re[OLFRF] axis at the point
-1 + j0, not far to the left of where the  = 0.7 plot crosses at about -0.73 + j0; therefore,
it might be that the appropriate value of gain margin for  = 0.7 is found from 1/GM0.7 
0.73, so that GM0.7  1.37 = 2.7 dB, a small gain margin indicating that the closed-loop
system is just weakly stable. If, on the other hand, we were to calculate gain margin us-
ing the other phase crossing, at about -0.04 + j0, then that would lead to the exaggerated
GM  25 = 28 dB, which is obviously a defective metric of stability. Note that the phase
margin for  = 0.7, found as shown on Fig. 17-8, is quite clear on Fig. 17-10 and not at
all ambiguous like the gain margin: PM0.7  +20°; this value also indicates a stable, but
weakly so, closed-loop system.

Figure 17-10 Nyquist plots, Eq. (17-20), open-loop frequency-response functions
(OLFRF) for  = 0.7 and  = ns1 = 0.96438 in the system of Eq. (17-18)

        Let's continue this study by computing OLFRF() and displaying it as a Nyquist
plot for an intermediate value of gain,  = 4.75, for which Fig. 17-9 shows the closed-
loop system is unstable. The following MATLAB commands calculate [from Eqs. (17-9)
and (17-20)] and plot the frequency response and an arc of the unit circle centered at the
origin of the complex OLFRF()-plane.

w=3.4*logspace(0,2,500);
olfrf01=(104-w.^2+4*j*w)./((1+j*w).*( 26-w.^2+2*j*w));
>> olfrf0475=4.75*olfrf01;

                                                  17-19
                  Chapter 17 Introduction to system stability: frequency-response criteria

>> plot(real(olfrf0475),imag(olfrf0475)),grid
>> cirangrad=0.8*pi:0.01:1.2*pi;
>> hold,plot(cos(cirangrad),sin(cirangrad))

         The portion of the Nyquist plot for gain  = 4.75 that is closest to the negative
Re[OLFRF] axis is shown on Fig. 17-11. The  = ns1 plot of Fig. 17-10 is expanded
radially outward on Fig. 17-11 by the factor of 4.75/0.96438 = 4.9254, so the loop for
high frequencies beneath the negative Re[OLFRF] axis is more prominent than on Fig.
17-10. The frequency-response curve leading into that loop crosses the Re[OLFRF] axis
at about -0.315 + j0; if we were to use this phase crossover to calculate gain margin, then
we would find GM  1/0.315 = 3.175 = 10.0 dB. Moreover, if we apply for this system
with  = 4.75 the MATLAB margin command to generate a Bode diagram in the same
form as Fig. 17-4, then MATLAB annotates that diagram with the values GM = 10.007
dB and PM = -23.721° (the same as PM4.75 shown approximately on Fig. 17-11). We
know from Fig. 17-9 that this case of  = 4.75 is closed-loop unstable. However, the
positive gain margin 10 dB suggests positive stability. The negative phase margin indi-
cates, to the contrary, instability. Clearly, the calculation GM  1/0.315 is a defective
metric of stability. The other phase crossover, at -4.9254 + j0 (beyond the range of Fig.
17-11), might be the appropriate point for calculation of gain margin, since it at least in-
dicates instability, GM4.75 = 1/4.9254 = 0.20303 = -13.85 dB.

Figure 17-11 Nyquist plot, Eq. (17-20), open-loop frequency-response function
(OLFRF) for  = 4.75 in the system of Eq. (17-18)

        Let's complete this study by computing OLFRF() and displaying it on Nyquist
plots for the value corresponding to the transition from instability back to stability on Fig.

                                                  17-20
                  Chapter 17 Introduction to system stability: frequency-response criteria

17-9, which we denote as ns2  15, and for a slightly higher value,  =18.5, for which
the closed-loop system is stable. The value of ns2 is not exactly 15, as Fig. 17-9 might
suggest; see homework Problem 17.2(b) for calculation of the more precise value ns2 =
15.0356. The portions of both Nyquist plots (for ns2 and  = 18.5) that are closest to the
negative Re[OLFRF] axis are shown on Fig. 17-12, which was produced by the MAT-
LAB commands that produced Fig. 17-10, except with gains 18.5 and ns2 replacing,
respectively, gains 0.7 and ns1.

Figure 17-12 Nyquist plots, Eq. (17-20), open-loop frequency-response functions
(OLFRF) for  = ns2 = 15.0356 and  = 18.5 in the system of Eq. (17-18)

         For gain  = 18.5, there are two phase crossovers: one evident on Fig. 17-12 at
-18.5/15.0356 + j0 = -1.230 + j0, and the other way beyond the range of Fig. 17-12 at
-18.5/0.96438 + j0 = -19.18 + j0. We know from Fig. 17-9 that the closed-loop system
with  = 18.5 is stable, albeit weakly. However, the gain margin calculated from either
of the two phase crossovers suggests instability, showing that both are deceptively
defective metrics of stability. On the other hand, the phase margin shown on Fig. 17-12,
PM18.5  +12°, correctly indicates weak stability.

         We draw the following conclusions from the discussions above of Figs. 17-9
through 17-12, relative to an "uncommon" system with an open-loop transfer function
such as Eq. (17-18): (1) gain margin as defined on Fig. 17-8 can be an ambiguous, un-
reliable, and even deceptive metric of closed-loop stability; (2) phase margin as defined
on Fig. 17-8, on the other hand, is usually an unambiguous and reliable metric, with PM
> 0 indicating closed-loop stability, and PM < 0 indicating closed-loop instability. Con-

                                                  17-21
                  Chapter 17 Introduction to system stability: frequency-response criteria

clusion (2) regarding phase margin is a form of the Nyquist stability criterion, a form that
is pertinent to systems such as that of Eq. (17-18); it is not the most general form of the
criterion, but it suffices for the scope of this introductory textbook.

         Proofs of the general Nyquist stability criterion are based on the theory of com-
plex functions of a complex variable; many textbooks on control theory present such
proofs, one of the clearest being that of Franklin, et al., 1991, pages 261-280. This refer-
ence shows that the form of stability criterion described above [Conclusion (2)] is not
sufficiently general to handle all cases that might arise. For example, the unusual case of
an open-loop system that has unstable poles requires the general Nyquist stability crite-
rion. However, the actual hardware of such an open-loop system could not be subjected
to frequency-response experimental testing due to its unstable character, so a control-
system engineer would find it necessary to analyze a mathematical model of the system.
It is likely that the most reliable theoretical analysis of such a model for closed-loop sta-
bility would be by calculation of closed-loop loci of roots, not by calculation of open-
loop frequency response. Another unusual case that would require the general Nyquist
stability criterion is an open-loop system with more than one gain crossover, i.e., a
system whose frequency response curve intersects more than once the unit circle shown
on Fig. 17-8, thus rendering ambiguous the definition of phase margin.

         We conclude this chapter on frequency-response stability criteria by observing
that margins of gain and phase are used also as engineering design goals. For example,
Brogan, 1974, page 25, wrote "Experience has shown that acceptable transient response
will usually require stability margins on the order of PM > 30°, GM > 6 dB." Franklin, et
al., 1991, page 285, wrote "Many engineers think directly in terms of PM in judging
whether a control system is adequately stabilized. In using PM this way, a phase margin
of 30° is often judged to be the lowest acceptable PM, with values above 30° desirable."

                                                  17-22
                  Chapter 17 Introduction to system stability: frequency-response criteria

17-5 Homework problems for Chapter 17

17.1 The subject of this problem is frequency response of an RC band-pass filter circuit.
The appropriate transfer function is Eq. (13-5):

TFB (s) = L[eo ] =  H s = L s

         L[ei ] ( H s + 1)( L s + 1) ( s + H )( s + L )

in which L  1  L is the low-pass break frequency and H  1  H is the high-pass
break frequency, and for band-pass functioning it is usually specified that H << L .

(a) This transfer function has (in the s-plane) a zero at the origin and poles at - H and
 - L . Consider the case for frequency response: s = j,   0. Sketch a graph of the s-
plane that shows the zero and the poles, and sketch on the graph three complex vectors
with tails at the zero and the poles, and heads at an arbitrary point s = j on the positive
imaginary axis. Use this graphical construction to derive the frequency-response function
in the polar form FRF() = MR() e j(), in which you derive explicit formulas for mag-
nitude ratio MR() and phase angle (). [NOTE: This graphical method of deriving (or
calculating) a frequency-response function is somewhat similar to (but simpler than) Ev-
ans' general root-locus method described in Section 16-5, with the "locus" in this case
being the positive imaginary axis--see, in particular, the unnumbered figure that directly
follows Eq. (16-56).] Partial answer: () =  2 - tan -1 ( H ) - tan -1 ( L ) radians

(b) Let H = 5 rad/sec and L = 500 rad/sec. Adapt the MATLAB code that produced
Fig. 17-2 to calculate and print a modified Bode diagram for this particular band-pass
filter. Your diagram should show that signals at frequencies between about 10 and 200
rad/sec are passed through this filter with very little amplitude reduction and relatively
little phase change, but that signals at frequencies below about 0.5 rad/sec and above
about 5,000 rad/sec are effectively "filtered out", removed.

17.2 In these exercises, you will use MATLAB function M-files and the MATLAB
command fzero to calculate some results that are stated but not explicitly derived in
Chapter 17.

(a) Calculate for at least one of the gains  = 4,000 sec-2 and 400,000 sec-2 the more
precise value of PM that is annotated on Fig. 17-2. The procedure is based on the defini-
tion of PM() in Eq. (17-7), which shows that you need to find the frequency PM at
which OLFRF()  = 1, i.e., the gain-crossover frequency. Accordingly, write a func-
tion M-file that uses Eq. (17-5) to compute the quantity OLFRF()  - 1. Then calcu-
late PM by calling that function M-file with the fzero command, in which you also in-
clude an estimate for PM that you read from Fig. 17-2. Finally, use Eq. (17-5) again to

                                                  17-23
           Chapter 17 Introduction to system stability: frequency-response criteria

calculate OLFRF ()  for  = PM, and substitute that result into Eq. (17-7) to obtain
the more precise value of PM().

(b) Calculate for at least one of the neutral-stability points on Fig. 17-9 the more precise
value of gain (ns1 and/or ns2) that is stated in the text of Section 17-4. The procedure is
based on setting to zero the real part of the appropriate root of the characteristic equation,
Eq. (17-19). Accordingly, write a function M-file that first determines with the root
command the three roots of Eq. (17-19), then uses MATLAB flow control features (per-
haps a for loop containing an if loop, or some alternative of your choice) to select the
one root of the three that has a positive imaginary part, and finally computes the real part
of this root. Then calculate the required ns by calling that function M-file with the
fzero command, in which you also include an estimate for the ns , which you read from
Fig. 17-9. [See homework Problem 16.8(b) for a different method of solution.]

17.3 In this problem, re-visit the system of homework Problem 16.5: it is a damped rotor
                                                                  with position feedback that is 2nd

R(s)       + _  Ein(s)  Ka      1       (s)       order low-pass-filtered. Use the
       Kr                   J s2 + c s            same component values: b = 300
                                                  rad/sec, c J = 100 sec-1, and  =
                          b 2
           Eout(s) s2 + 2b s + b2 K               1 2 . Also as before, denote the

                                                  varying control-system gain pa-

                                                  rameter as   Ka K J .

(a) Show that the open-loop transfer function is

           OLTF (s)  Eout (s) =                   b 2

                            Ein (s) s(s + c J )(s + 2b s + b )22

(b) Homework Problem 16.5(b) showed the following by loci-of-roots analysis for the
closed-loop system: (i)   ns = 22,000 sec-2 is the neutral-stability gain, the upper
limit of stability; and (ii) for  = 3,400 sec-2, the system is stable, with the dominant

mode being oscillatory and having damping ratio  1 2 . Your task is to evaluate
stability again for  = 3,400 sec-2 and for  = ns , but now using frequency-response
criteria. Define the excitation-frequency range of interest to be the band 10    1000

rad/sec. First, use appropriate MATLAB commands to calculate the baseline open-loop
frequency-response function, i.e., OLFRF() for  = 1 sec-2. Now, use MATLAB to

calculate and plot on some type (your choice) of Bode diagram the curves of magnitude
ratio and phase angle over the defined frequency band, for both  = 3,400 sec-2 and  =

ns. Estimate from your Bode diagram the gain margin GM (in both decimal form and
dB) and the phase margin PM (in degrees) for both values of .

(c) Use MATLAB's margin function to validate the correctness of your estimated stabil-
ity margins in part (b).

                                  17-24
Chapter 17 Introduction to system stability: frequency-response criteria

17.4 Suppose that you have an LTI rotary motor

with unknown transfer function G(s) . The input Ein(s)                      P(s)

is a voltage signal ein(t), and the output is shaft                   G(s)

speed &(t)  p(t) . You want to control the shaft        Ep(s)
speed by sensing it with a tachometer, which has 

variable gain , and feeding the tachometer voltage signal ep(t) back to the input in the

standard form shown on the Laplace block diagram. In order to evaluate the stability of

the closed-loop system, you conduct a stepped-sine-sweep frequency-response test on the

stable open-loop system, which consists of the motor and the tachometer in series, with

the gain set at  = 0.4 volt per rad/sec. Specifically, you drive the open-loop system with

sinusoidal input voltage ein(t) = Vin sint with the frequency increasing in small incre-
ments through the range 0.5    50 rad/sec, you measure at each sine-dwell frequency

the steady-state sinusoidal output voltage ep(t) = Vp () sin[t + ()], and then you plot

the results for Vp () Vin and () , leading to the following diagram:

(a) Would the closed-loop system be stable with the tachometer gain for which the above
data apply,  = 0.4 volt/(rad/sec)? If so, calculate from the diagram above, with as much
accuracy as the plots permit, the phase margin PM and gain margin GM of stability. In-
dicate the graphical representations of your PM and GM on a sketch or photocopy of the
diagram.

(b) Would the closed-loop system be driven unstable by any positive values of tachome-
ter gain,  > 0? If so, estimate those values. Explain your reasoning clearly.

                                                  17-25
                  Chapter 17 Introduction to system stability: frequency-response criteria

17.5 Figure 17-5 is in the traditional two-dimensional format of a Nyquist plot, i.e.,
Im[FRF()] versus Re[FRF()], on which excitation frequency  is the implicit inde-
pendent variable. But this format might be considered unsatisfactory for many purposes
because it lacks a graduated scale for . An enhanced-format Nyquist plot, a three-di-
mensional plot, can show such a graduated scale of frequency in addition to the scales of
the rectangular components, Re[FRF()] and Im[FRF()]. In order to explore that for-
mat, run in MATLAB the following alternative version of the commands that produced
Fig. 17-5, which applies, in particular, the plot3 command to plot three-dimensionally:

>> wn=2*pi;zt=0.2;
>> w=wn*(0:0.05:2.5);
>> frf=wn^2./(wn^2-w.^2+j*2*zt*wn*w);
>> plot3(real(frf),imag(frf),w/wn),grid
>> axis equal

These commands should produce a three-dimensional plot on which the Re[FRF()] axis
(the x-axis) extends from  -1 to  +1.5, the Im[FRF()] axis (the y-axis) extends from 0
to -2.5, and the  /n axis (the z-axis) extends from 0 to 2.5. Make a print of the initial
plot, which probably will be from the "Default 3-D View" (azimuth = -37.5°, elevation =
30°; Orthographic, not Perspective). The Reference 3-D View, azimuth = 0° and eleva-
tion = 0°, is from y = - looking in exactly the + y direction, so it is a two-dimensional
projection of the x-z plane. Azimuth angle is positive rotation (in the sense of the right-
hand rule) of the viewpoint about the z axis, relative to the Reference 3-D View; thus, for
example, the view azimuth = 90° and elevation = 0° is from x = + looking in exactly the
- x direction, a two-dimensional projection of the y-z plane.

Consider two consecutive excitation frequencies in a frequency-response experiment, de-
noted as i and j , with j > i [e.g., two consecutive values in the series represented by
the MATLAB command w=wn*(0:0.05:2.5)], and denote ij = j - i ; denote the
change from i to j of the in-phase component Re[FRF()] as xij , and that of the
quadrature component Im[FRF()] as yij ; then the line segment between those two
points in the Im[FRF()]-versus-Re[FRF()] plane (e.g., Fig. 17-5, the x-y plane) is sij
= xij 2 + yij 2 . Engineers who conduct stepped-sine-sweep frequency-response vibra-
tion tests on resonant systems (such as that of this problem) consider the rate of change
sij /ij to be a physically significant quantity that leads to experimental determination
of a system's natural frequency, n . Describe how your three-dimensional Nyquist plots
(from whatever viewpoints are required) demonstrate that sij /ij is maximum at exci-
tation frequencies near n , but is below the maximum at frequencies both above and be-
low n .

17.6 In this problem, re-visit the system of homework Problem 16.7: the Laplace block
diagram of the speed-control system of a magnetic-tape drive is shown in the figure on
the next page. The operator setting is input voltage signal ein(t), the Laplace transform of
which is Ein(s). Each major sub-system of the control system functions as a 1st order
system. The sub-system consisting of a power amplifier and a torque actuator has vari-

                                                  17-26
Chapter 17 Introduction to system stability: frequency-response criteria

able sensitivity Ka (N-m/V) and time                 Amplifier-actuator Tape drive

constant a = 1.0 sec. The tape drive     Ein(s)         Ka               1          P(s)
                                                      as +1
has rotational inertia J = 4.0 N-m               +_                 J s + c
per rad/sec2 and lubricated-shaft

viscous damping constant c = 1.0                               Kp
N-m per rad/sec; the output of the                           ps +1
tape drive in this application is rota-

tional speed p(t) in rad/sec [with                         Speed sensor

Laplace transform P(s)], not rota-

tional position (t). The rotational-speed sensor in the feedback branch has sensitivity Kp

= 1.250 V per rad/sec; this sensor is sufficiently slow relative to the other sub-systems

that we must account for its time constant, p = 0.50 sec.

(a) Defining the control gain parameter as  = K a K p (J a p ) , with units of sec-3, show

that the closed-loop transfer function is P(s) = K a         s +  p -1
                                                                  -1 -1 .
                                         Ein (s) J a (s + c J )(s +  a )(s +  p ) + 

Consider response to a unit-step input, ein(t) = (1.0 V)H(t). Use the final-value theorem
(assuming system stability) to find an equation in terms of the system parameters for the

steady-state response, after all transients have decayed, lim p(t) . Select the value of sen-

                                                                                                                     t 

sitivity Ka that makes the overall steady-state sensitivity of the control system be 0.750
rad/sec per volt, then calculate gain  corresponding to that value of Ka . (partial solu-
tion:  = 7.50 sec-3)

(b) Show that the open-loop frequency-response function can be written as OLFRF() =
 × -1 -1 1 . Calculate for the given parameter values the

     ( j + c J )( j +  a )( j +  p )

phase-crossover frequency ns , i.e., the frequency at which OLFRF() = - radians =
-180°; this task will require the numerical solution of a transcendental equation, which
you might want to accomplish by applying the MATLAB function fzero in the manner
described in homework Problem 17.2. Next, calculate for the baseline case,  = 1 sec-3,
the magnitude ratio at phase crossover, MR1(ns), and the corresponding gain margin,
GM1 . (partial solution: GM1 = 8.4375)

(c) Now consider the gain determined in part (a),  = 7.50 sec-3. Calculate the magni-
tude ratio at phase crossover, MR7.50(ns), and the corresponding gain margin, GM7.50 .
Calculate the phase margin, PM7.50 , using the equation for OLFRF() of part (b)--to do
this, you will need first to find the gain-crossover frequency 1 [MR7.50(1) = 1], which
you might want to accomplish by applying again the MATLAB function fzero in the
manner described in homework Problem 17.2; then you will need to calculate phase angle
OLFRF(1) to use in the definition of phase margin.

(d) To validate your work in the previous parts, produce a diagram showing the Nyquist
plots for both values of gain,  = 1 and 7.50 sec-3; you might wish just to adapt for this

                                         17-27
Chapter 17 Introduction to system stability: frequency-response criteria

case the MATLAB code that produced Fig. 17-10. What is your assessment, based on
the gain and phase margins, of the control system with gain  = 7.50 sec-3?

17.7 Consider the feedback con- In(s)                    4                1 Out(s)
trol system depicted in the La-                    (s + 1)(s + 3)         s
                                       +_     +_
                                                        K
place block diagram at right. As-                    s(s + 2)

sume that units of all constants

are consistent, and don't bother

to label units.

(a) Combine the two feedback loops with block-diagram algebra to show that the for-

ward-branch and feedback-branch transfer functions can be written, respectively, as:

G(s) = 4         and H (s) = s + (2 + K ) . Apply Routh's criteria, as described in
s(s + 1)(s + 3)                      s+2

homework Problem 16.9(c), to determine the range of the sensitivity constant K over

which the control system is stable.

(b) Use any method of your choosing to determine the value of K for which the phase
margin PM is approximately 35°. Note that the characteristic equation of this system
does not have the form of either of Eqs. (16-62): this K does not play the role of  in
Eqs. (16-62). Therefore, many of the equations developed in Chapter 17, such as Eqs.
(17-8)-(17-12), are not applicable in this problem.

(c) To validate your work in parts (a) and (b), produce a diagram showing the Nyquist
plots for two values of K: both that for neutral stability (the upper-bound K for system
stability), and that for PM  35°; you might wish just to adapt for this case the MATLAB
code that produced Fig. 17-10. Explain the features of the Nyquist plots that confirm the
correctness of your results in parts (a) and (b), using annotations on the diagram and/or
written discussion.

17.8 Your task in this problem is to derive, with the assistance of MATLAB's symbolic
capabilities, the "steady-state" response Eq. (17-15), which includes the unstable linear
drift due to the open-loop transfer function's pole at s = 0 + j0. Because the equations
that MATLAB produces are long and complicated, it will be advantageous to separate the
voltage input function Eq. (17-14) into the following two parts:

                         ein1 (t) = Ein sin t and ein 2 (t) = Eoff H (t)

For each of these parts individually you will seek the voltage output solution, respec-
tively, eout1(t) and eout2(t), then you will add the two to obtain the total response.

(a) The Laplace transform of eout1(t), with the use of Eq. (17-2) and Eq. (2-30), is

L[eout1 (t)] = L[ein1 (t)]× OLTF (s) = Ein 2 2  ×  b
                                              s +  s(s + c J )(s + b )

                                       17-28
Chapter 17 Introduction to system stability: frequency-response criteria

You might be able to find the inverse transform of this equation in some reference, but it
is likely that a more efficient process is to define the equation symbolically in MATLAB
and then to use the ilaplace command to find the inverse transform. The less appeal-
ing aspect of this approach is that MATLAB's initial solution will probably be long and
difficult to interpret. To convert the initial solution equation into a more transparent
form, use the simple and pretty commands. You seek the "steady-state" response, so
discard (from the equation displayed after use of pretty) the transient terms involving
the time functions e-(c J )t and e-bt . At this point, you should be able to express the so-
lution in the form:

eout1 (t) =  + b 2 2 2 2 - (c J + b ) sin t + [ - (c J )b ]cost
Ein (c J )                            [ + (c J ) ]( + b )

The second right-hand-side term above is clearly a frequency-response term; but it is not
yet expressed in the form from which equations for magnitude ratio and phase angle can
be written, so you need to convert it into that form. Use the general trigonometric
identity sin × cos + cos × sin = sin( + ) , and follow the procedure described in

Eqs. (4-6)-(4-8), to show that C sin t + S cost = C 2 + S 2 sin(t + ) , where  =
tan -1(S C) . Use this result to write explicit equations, in terms of c /J and b and , for
magnitude ratio MR() and phase angle (). In the remainder of this problem, don't
write out again those somewhat lengthy equations; instead, just use the symbols MR()
and ().

(b) Use Eq. (17-2) again and MATLAB's ilaplace command in order to solve for out-
put voltage eout2(t) in response to ein 2 (t) = Eoff H (t) .

(c) Combine the response equations of parts (a) and (b) to write the complete solution
eout(t) = eout1(t) + eout2(t), the "steady-state" response Eq. (17-15):

eout (t) = Ein  MR() × sin(t + ()) +           J  (c J + b ) 
                                              + Eoff t -                  
                                      (c J )   c  (c J )b 

            17-29
                                                          References

                                       References

The following list includes only books and articles that are cited in this book. These
references are arranged alphabetically by the family name of the first author.
Robert K. Adair, The Physics of Baseball, 2nd edition, HarperCollins, 1994.
Ferdinand P. Beer and E. Russell Johnston, Jr., Mechanics of Materials, 2nd edition,
McGraw-Hill, 1992.

Pierre R. Bélanger, Control Engineering: a Modern Approach, Saunders College
Publishing, 1995.

Robert M. Bennett, "Test Cases for Flutter of the Benchmark Models Rectangular Wings
on the Pitch and Plunge Apparatus," Defense Technical Information Center Compilation
Part Notice ADP010713, http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADP010713,
October 2000.

Raymond L. Bisplinghoff, Holt Ashley, and Robert L. Halfman, Aeroelasticity, Addison-
Wesley, 1955; paperback edition published by DoverPublications.com, ISBN 10:
0486691896.

A. R. S. Bramwell, Helicopter Dynamics, Edward Arnold (Publishers) Ltd, 1976.

William L. Brogan, Modern Control Theory, Quantum Publishers, Inc., 1974.

Robert H. Cannon, Jr., Dynamics of Physical Systems, McGraw-Hill, 1967; paperback
edition published by DoverPublications.com, ISBN 10: 0486428656.

Robert N. Clark, Introduction to Automatic Control Systems, John Wiley & Sons, 1962.

Ray W. Clough and Joseph Penzien, Dynamics of Structures, McGraw-Hill, 1974.

Roy R. Craig, Jr., Structural Dynamics--an Introduction to Computer Methods, John
Wiley & Sons, 1981.

James W. Dally, William F. Riley, and Kenneth G. McConnell, Instrumentation for
Engineering Measurements, John Wiley & Sons, 1984.

Carlos DeMarqui Jr., E. M. Belo, and F. D. Marques, "A Flutter Suppression Active
Controller," Proceedings of the Institution of Mechanical Engineers,Vol. 219, Part G: J.
Aerospace Engineering, February 2005, pp. 19-33.

Carlos DeMarqui Jr., D. C. Rebolho, E. M. Belo, and F. D. Marques, "Identification of
Flutter Parameters for a Wing Model ," Journal of the Brazilian Society of Mechanical

                                               Refs-1
                                                          References

Science & Engineering, http://www.scielo.br/pdf/jbsmse/v28n3/30571.pdf, July-
September 2006, Vol. XXVIII, No. 3, pp. 339-346.
J. P. Den Hartog, Mechanical Vibrations, 4th edition, McGraw-Hill, 1956; paperback
edition published by DoverPublications.com, ISBN 10: 0486647854.

Clarence W. de Silva, (editor), Vibration Damping, Control, and Design, CRC Press,
Taylor & Francis Group, 2007.

J. William Dettmer, Space Integrated Controls Experiment (SPICE) Program, Defense
Technical Information Center (DTIC) Accession Number ADA297200, Phillips Labor-
atory PL-TR-95-1035, http://www.dtic.mil/get-tr-doc/pdf?AD=ADA297200, May 1995.

Walter R. Evans, Control-System Dynamics, McGraw-Hill, 1954.

David J. Ewins, Modal Testing: Theory and Practice, Research Studies Press Ltd., 1984.

Neil J. Fergusson and Walter D. Pilkey, "The Dynamic Stiffness Method, a Survey of the
Published Literature: Part I: DSM Elements; Part II: Frequency Extraction Methods and
Modal Analysis", Shock and Vibration Technology Review: Volume 1, Number 7, July
1991, pp. 4-13; Volume 1, Number 8, August 1991, pp. 14-20.

Stanley Fifer, Analogue Computation: Theory, Techniques and Applications, in four
volumes, McGraw-Hill, 1961.

Gene F. Franklin, J. David Powell, and Abbas Emami-Naeini, Feedback Control of Dy-
namic Systems, 2nd edition, Addison-Wesley, 1991.

Y. C. Fung, An Introduction to the Theory of Aeroelasticity, John Wiley & Sons, 1955;
and Dover Publications, 1969.

Donald T. Greenwood, Principles of Dynamics, Prentice-Hall, 1965.

James E. Gordon, Structures, or Why Things Don't Fall Down, Penguin Books, 1978;
paperback edition published by DaCapoPress.com, ISBN 0306801515.

David Halliday and Robert Resnick, Physics for Students of Science and Engineering,
John Wiley & Sons, 1960.

S. B. Hammond, Electrical Engineering, McGraw-Hill, 1961.
Russell C. Hibbeler, Mechanics of Materials, 3rd edition, Prentice Hall, 1997.

Francis B. Hildebrand, Advanced Calculus for Applications, Prentice-Hall, 1962.

                                               Refs-2
                                                          References

Paul Horowitz and Winfield Hill, The Art of Electronics, Cambridge University Press,
1980.

A. L. Kimball and D. E. Lovell, "Internal Friction in Solids," Physical Review, Series 2,
Vol. 30, 1927, pp. 948-959.

George Fox Lang, "Analog was not a Computer Trademark!", Sound and Vibration,
http://www.SandV.com, August 2000, pp. 16-25.

Benjamin J. Lazan, Damping of Materials and Members in Structural Mechanics, Perga-
mon Press, 1968.
Augustus E. H. Love, A Treatise on the Mathematical Theory of Elasticity, 4th edition,
Dover Publications, 1926.

Andy Lightbody, Joe Poyer, and Dick Cole, The Great Book of Fighter Planes, Beekman
House, 1990.

M. James Lighthill, Introduction to Fourier Analysis and Generalised Functions, Cam-
bridge University Press, 1958.

Richard H. MacNeal, Electric Circuit Analogies for Elastic Structures, John Wiley &
Sons, 1962.

Nuno M. M. Maia and Julio M. M. Silva (editors), Theoretical and Experimental Modal
Analysis, Research Studies Press Ltd., 1997.

Leonard Meirovitch, Analytical Methods in Vibrations, Macmillan, 1967.

Leonard Meirovitch, Fundamentals of Vibrations, McGraw-Hill, 2001.

N. O. Myklestad, Vibration Analysis, McGraw-Hill, 1944.

Ahid D. Nashif, David I. G. Jones, and John P. Henderson, Vibration Damping, John
Wiley & Sons, 1985.

Robert C. Nelson, Flight Stability and Automatic Control, McGraw-Hill, 1989.
Katsuhiko Ogata, Modern Control Engineering, 4th edition, Prentice-Hall, 2001 (or 2002
because there is ambiguity in different listings of the publication date; however, the ISBN
is 0-13-060907-2, without ambiguity.)
Katsuhiko Ogata, System Dynamics, 3rd edition, Prentice-Hall, 1998.

Gerald R. Peterson, Basic Analog Computation, Macmillan, 1967.

                                               Refs-3
                                                          References

Thomas P. Sarafin (editor), Spacecraft Structures and Mechanisms--from Concept to
Launch, Microcosm Press and Kluwer Academic Publishers, 1995.
Joseph E. Shigley and Larry D. Mitchell, Mechanical Engineering Design, 4th edition,
McGraw-Hill, 1983.
Arnold Sommerfeld, Mechanics: Lectures on Theoretical Physics, Volume 1, translated
into English from the 4th German edition by Martin O. Stern, Academic Press, 1964.
Stephen P. Timoshenko and Donovan H. Young, Elements of Strength of Materials, 4th
edition, Van Nostrand, 1962.
Eric E. Ungar, "Compromises: Academia and the Real World," Sound and Vibration,
http://www.SandV.com, March 1998, p. 5.

                                               Refs-4
      Appendix A Table and derivations of Laplace transform pairs

A-1 Table of Laplace transform pairs used in this book1

         General conventions: (1) time t is a real number, t  0; (2) Laplace variable s is a
complex number with dimension of time-1; (3) n and k are positive, real integers; (4) p
and  are finite constants, with dimension of time-1; (5) ts is a real, finite constant, with

dimension of time; (6)  is a positive, real, finite constant, with dimension of time-1.

Function of time t, in-      Function of Laplace variable s,               Source and notes
verse Laplace transform      forward Laplace transform
 f (t) = L-1 [F(s)]          F(s) = L[ f (t) ]                             General notation, p. 2-
                                                                           6
 f (t)                       t=                t=                          Definitions: Eq. (2-
                                                                           13), or Eq. (8-12) if f
 f& (t)                       e-st f (t) dt , or  e-st f (t) dt            (t) involves  (t)
                             t=0               t =0-                       Eqs. (2-15b) and (8-
&f&(t)                                                                     21); t = 0- for ICs
                             s F(s) - f (0- )                              precedes all inputs
 d n f (t)                                                                 Eq. (2-17), Problem
dt n                         s 2 F (s) - s f (0- ) - f& (0- )              2.4
                                                                           Eqs. (2-16) and (8-22),
 =t0                         s n F (s) - s n-1 f (0- ) - s n-2 f& (0- ) -  Ogata, 1998, pp. 25-
                                                                           26
  f ( ) d                             ( n -1)                              Eq. (2-32), derivation
                                                                           in Section A-3; note
 =-                          L - f (0- )                                   that -  < t < +
 =t0                                                                       Eq. (2-33), derivation
                             1 F (s) + 1  =0  f ( ) d                      in Section A-3
  f ( ) d                    s       s  =-
                                                                           Eq. (6-2), convolution
  =0                         1 F(s)                                        integral, derived in
                 =t          s                                             Section A-5

CI (t) =  f1( ) f2 (t - ) d  F1 (s) × F2 (s)                               Eq. (9-18);  is any
                 =0                                                        constant
                =t           F(s - )                                       Eq. (2-14); p is any
    =  f1 (t - ) f2 ( ) d                                                  constant
                =0             1
                             s- p                                          Eq. (A-15); p is any
e t f (t)                    11                                            constant
                             s s- p
e pt

1 (e pt - 1)
 p

1 Much more extensive tables of Laplace transform pairs are available in many references, for example,
Cannon, 1967, Appendix J.

                                     A-1
                  Appendix A Table and derivations of Laplace transform pairs

Function of time t, in-     Function of Laplace variable        Source and notes
verse Laplace transform     s, forward Laplace transform
 f (t) = L-1 [F(s)]         F(s) = L[ f (t) ]                   General notation, p. 2-6

 f (t)                      t=                 t=               Definitions: Eq. (2-13),
                                                                or Eq. (8-12) if f (t)
 (t)   (t - 0)               e-st f (t) dt , or  e-st f (t) dt  involves  (t)
                            t=0                t =0-            Eq. (8-13); Dirac delta
H (t - ts )                                                     function of Eq. (8-8)
                            1                                   Eq. (2-28); general unit-
H (t)                                                           step defined in Eq. (2-27)
                            e -s ts
 f (t - ts ) H (t - ts )      s                                 Eq. (2-29); Heaviside
t                                                               unit-step function defined
t e t                       1                                   in Eq. (2-26)
sin  t                      s                                   Ogata, 1998, p. 18; trans-
cos t                                                           lated function of time
                            e -sts F (s)                        Eq. (A-17)

 2 1 (1 - cost)             1                                   Eqs. (A-17) and (9-18); 
                            s 2                                 is any constant
n -n t 2
    e sin dt                    1                               Eq. (2-30);  is a positive
                            (s - )2                             real constant
d                                                               Eq. (2-31);  is a positive
                                                                real constant
1 - e -n t ×                s2 +2                               Eq. (A-16);  is a
                                                                positive real constant
 cosdt + n sin dt               s
                            s2 +2                               Problem 9.12;  < 1 ,

                                 1                              d 2 = n 2 (1 -  2 ) > 0
                            s (s2 +  2 )                        Problem 9.12;  < 1 ,

                                   n2                           d 2 = n 2 (1 -  2 ) > 0
                            (s + n )2 + d 2
                                                                Problem 9.15;  < 1 ,
                                    n2
                            s[(s + n )2 + d 2 ]                 d 2 = n 2 (1 -  2 ) > 0
                                                                Eq. (16-9); C is complex,
              d                                                 p =  + j,  and  are
                                                                real,  > 0
e-n t ×                            sd                           Eq. (A-7), Section A-2
                            (s + n )2 + d 2                     for definitions, derivation,
(d cosd t - n sin d t)                                          and restrictions
                             C +C
2 C e t cos( t + C)         s- p s- p

  n Num ( pk ) pk t         Num (s)
               e            Den (s)
k=1 Den( pk )

                                          A-2
Appendix A Table and derivations of Laplace transform pairs

Function of time t, in-  Function of Laplace variable        Source and notes
verse Laplace transform  s, forward Laplace transform
 f (t) = L-1 [F(s)]      F(s) = L[ f (t) ]                   General notation, p. 2-6

 f (t)                   t=           t=                     Definitions: Eq. (2-13),
                                                             or Eq. (8-12) if f (t)
                          e-st f (t) dt , or  e-st f (t) dt  involves  (t)
                         t=0          t =0-                  Initial-value theorem:
                                                             Eq. (8-20) and Eq. (8-24)
+lim f (t)  f (0+ ) = lim[sF (s)]                            in Section 8-6
t0 from t > 0                 s                              Final-value theorem: Eq.
                                                             (15-15) and Section 15-3,
lim f (t) = lim [sF(s)]                                      valid only if lim f (t) is a
t                        s0
                                                                                        t

                                                             finite, constant value

         It is worthy of note that MATLAB's symbolic software, which is introduced in
homework Problem 1.6, can sometimes be helpful for finding forward and inverse La-
place transforms by applying, respectively, the laplace and ilaplace commands. The
following are two relatively simple examples that do not appear explicitly in the table of
transform pairs. In these examples, MATLAB finds the forward transform L[sinh(at)] =

a (s 2 - a 2 ) , and the inverse transform L-1[(s + a) [(s + a)2 +  2 ]] = e-at cost .

>> syms s t a w                       a
>> ft=sinh(a*t)                  -------
ft =
sinh(a*t)                         2 2
>> Lft=laplace(ft,t,s)           s -a
Lft =
a/(s^2-a^2)
>> pretty(Lft)

>> Fs=(s+a)/((s+a)^2+w^2)
Fs =
(s+a)/((s+a)^2+w^2)
>> fFs=ilaplace(Fs,s,t)
fFs =
exp(-a*t)*cos(w*t)

                                 A-3
         Appendix A Table and derivations of Laplace transform pairs

For functions of time t or functions of Laplace variable s that are more complicated than
those in the examples above, MATLAB might produce solutions that are correct, but are
expressed in an unfamiliar form, or in a long and unwieldy form that must be simplified
by human touch in order to become useful.

A-2 Laplace transform of a ratio of two polynomials, with only simple poles

         Suppose that we have a Laplace transform as the ratio of two polynomials, from
Eq. (2-10):

         Num (s) b1s m + b2 s m-1 + ... + bm+1 b1 (s - z1 )(s - z2 )L(s - zm )
Fn (s)   = n n-1                          =                                     (A-1)
         Den (s) a1s + a2 s + ... + an+1 a1 (s - p1 )(s - p2 )L(s - pn )

The results derived in this section are based upon three assumptions: (1) the roots pk of
Den(s), which are the poles of Fn(s), are not repeated (such roots are called simple poles);
(2) the degree of Den(s) exceeds that of Num(s), 0  m < n; and (3) none of the zeros of
(A-1) equals any of the poles. Under these circumstances, we can expand transform (A-
1) into partial fractions, from Eq. (2-24):

                              n Ck                                              (A-2)

                    Fn (s) = 

                              k =1 s - pk

In Eq. (A-2) the residues are given by Eq. (2-25b) as

Ck = [(s - pk ) Fn (s)]s= pk = (s - pk )  Num (s) 
                                                            , k = 1, 2, ..., n  (A-3)
                                          Den (s)  s= pk
                    

Let's examine what might be considered the "total denominator" of Eq. (A-3):

                              Den (s) 
                    Dk = lim                                                    (A-4)
                    spk (s - pk ) 

Observe from Den(s) in Eq. (A-1) that Dk in Eq. (A-4) has the indeterminate form 0/0.

Since we assume that all zeros of Fn(s) are different from the poles, Num(pk) in Eq. (A-3)
is non-zero and finite. Therefore, Dk must also be non-zero and finite, and we can use
l'Hospital's rule to cast Eq. (A-4) into a different form:

                      d                                  
                            ds Den (s)   d
          Den (s)                                           Den (s)
         Dk = lim    = lim                                                      (A-5)
         s pk (s - pk )  s pk  d                           ds       s= pk
                            ds (s - pk ) 

                      A-4
      Appendix A Table and derivations of Laplace transform pairs

Thus (Hildebrand, 1962, p. 548), residue (A-3) can be expressed alternatively as

                                                       
                                            Num (s) 
                            Num (s)                            Num ( pk )
      Ck = (s - pk )                =                                             (A-6)
                            Den (s)  s= pk  d Den (s)          Den ( pk )
      
                                            ds          s= pk

Finally (Meirovitch, 1967, p. 532), by substituting Eq. (A-6) back into Eq. (A-2) and then
taking the inverse Laplace transform of each term in the summation, we find

                                   -1  Num (s)  n Num ( pk ) pk t
      f (t) = L [Fn (s)] = L -1                 =              e ,t0              (A-7)

                                    Den (s)  k=1 Den ( pk )

A-3 Derivation of the Laplace transform of a definite integral

         Suppose that a function f (t) has Laplace transform F(s) = L[ f (t) ], and that we

                                                                                       =t0

need the transform of the definite integral  f ( ) d . Note the lower limit of  = -;
                                                                                       =-

we usually consider f (t) only for t  0, but occasionally the integral of f (t) over previ-
ous time, t < 0, is also needed.

                                           6447u 448    67dv8
                             =t 0      t =  =t 0        -st
        L  f ( ) d  =    f ( ) d e dt                                             (A-8)

                             =-        t =0  =-        

Integrating by parts gives

 =t0    =t0                         -st         t =    t =  =t 0 

                                      e  1                     d
L  f ( ) d  =   f ( ) d   -    e-st   f ( ) d  dt                                 (A-9)
        =-                          t - s  =0  - s t =0 dt  =-
 =-                                                                        

The derivative of the definite integral in the second right-hand-side term of Eq. (A-9) is a
special case of Leibnitz's rule (Hildebrand, 1962, p. 360):

                                   d  =t0 
                                     f ( ) d  = f (t)                             (A-10)
                                   dt  =-
                                                

With the simple result (A-10), and with evaluation of the limits of the first right-hand-
side term, Eq. (A-9) becomes

                                           A-5
 Appendix A Table and derivations of Laplace transform pairs

    =t0          1  =0             1 -s t t =
   L  f ( ) d  =  f ( ) d +  e f (t) dt                           (A-11)
                 s  =-             s t=0
    =-

Thus, the final form of the required general transform is

    =t0               1       1  =0
   L  f ( ) d  = F (s) +  f ( ) d                                 (A-12)
                      s       s  =-
    =-

For most applications, we have f (t) = 0 for t < 0, for which the simpler transform is:

                 =t0       1
                L  f ( ) d  = F (s)                               (A-13)
                           s
                  =0

If we regard the integral of f (t) as being the first "negative" derivative (antiderivative),

then we see that transform (A-12) is logically consistent with transform (2-15b) for a
"positive" derivative, with respect to both power of s and the initial value term.

A-4 Applications of the Laplace transform of a definite integral

         A relatively painless method for deriving certain inverse transforms is based upon
the inverse transform of Eq. (A-13),

                -1 1    =t0
               L  F (s) =  f ( ) d                                (A-14)
                s       =0

It is necessary to apply carefully the limits of the definite integral, as is illustrated in the
following three examples.

-1 1 1  p  =t0        1 p  =t0 1 p t
L   =  e d =  d (e ) = (e -1) , t  0                              (A-15)
  s s - p   =0        p  =0                                p

-1  1  1  =t          1  =t 1
L  2 2  =  sin  d = - 2  d (cos ) = 2 (1 - cost) , t  0 (A-16)
 s(s +  )  =0           =0                                    

   -1 1 1   =t0               =t0

   L   =  H ( ) d =  d = t , t  0                                 (A-17)
         s s   =0
                              =0

                      A-6
Appendix A Table and derivations of Laplace transform pairs

A-5 Derivation of the Laplace transform of the convolution integral

         We consider two physically realistic functions of time, f1(t) and f2(t), that are zero
for all time t < 0 and non-zero only for t  0. The convolution integral is defined to be a
definite integral involving f1(t) and f2(t) in either of the following forms:

      =t               =t

CI (t) =  f1 ( ) f2 (t -  ) d =  f1(t -  ) f2 ( ) d                  (6-1) repeated

      =0               =0

In these definite integrals,  is the dummy variable of integration, and time t appears both
in the upper limit of the integral and in argument (t - ) of the integrand.

         The Laplace transform L[CI(t)] is called the convolution transform. Let's assume
that the Laplace transforms of functions f1(t) and f2(t) exist: F1(s) = L[f1(t)] and F2(s) =
L[f2(t)]. The derivation to follow will show that the product of these two transforms
equals the convolution transform:

                       =t 
F1(s) × F2 (s) = L[CI (t)] = L  f1( ) f2 (t - ) d                    (6-2) repeated

                       =0                                    

         Equation (6-2) is certainly not an intuitively obvious result. The short, formal
derivation (Meirovitch, 1967, p. 534 and Ogata, 1998, pp. 43-44) involves interchanging
of orders of integration. The first step is to revise the upper limit in the convolution inte-
gral since, by definition, f2 (t - ) = 0 for t - < 0 , that is, for  > t :

      =t               =

CI (t) =  f1( ) f2 (t - ) d =  f1( ) f2 (t - ) d
      =0               =0

Next, use the standard definition of a Laplace transform:

 =  t=  = 
L[CI (t)] = L  f1( ) f2 (t - ) d  =  e-st   f1( ) f2 (t - ) d  dt
 =0             t=0  =0                                              

Now interchange the orders of integration between t and  , an operation permitted by the
assumed convergence of the integrals, and re-arrange the terms within the integrands:

           = t= 
L[CI (t)] =  f1( )   e-st f2 (t - ) dt d
           =0   t =0                                       

In the inner integral, change the integration variable to  = t -  , so that t =  +  and dt =
d , since  is regarded as a constant within this integration:

               A-7
Appendix A Table and derivations of Laplace transform pairs

      =  -s( + )  = 
L[CI (t)] =  f1( ) d   e f2 () d
      =0         =-    

Now, since f2(t) = 0 for  < 0, in the second integral we set the lower limit to zero. Also,
again re-arrange terms within the integrands, to find

-s  =  -s  = 
L[CI (t)] =  e f1( ) d   e f2 () d  F1(s) × F2 (s)
 =0         =0       

This completes the derivation of the convolution transform, Eq. (6-2).

          A-8
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

Appendix B: Notes on work, energy, and power in mechanical systems
                               and electrical circuits

                                © 2016 by William L. Hallauer, Jr.

B-1 Definitions of work and power

         Work is defined for translational motion as the product of a force times a distance
through which the force moves. For translation in one dimension, denoted here as x, the
differential work of force f x (x) moving through distance dx at position x is

dW = f x (x) × dx                                                                   (B-1)

So the work by a spatially varying force moving from position x1 to position x2 is

x = x2       x = x2

W =  dW =  f x (x) dx                                                               (B-2)

x= x1        x= x1

with units of lb-ft, lb-inch, or N-m  J (for joule).

         The velocity of one-dimensional motion is vx = dx dt  dx = vx dt . There-
fore, alternative expressions for work are

                                                         t =t2                      (B-3)

dW = f x × vx dt  W =  f xvx dt
                                                         t =t1

This leads to the definition of power, the time rate of work:

P  dW = f x × vx                                                                    (B-4)
      dt

with units of lb-ft/sec, lb-inch/sec, or N-m/sec = J/sec  W (for watt).

        For rotation in one dimension, denoted here as , the differential work of moment
M moving through angle d at position  is dW = M × d , and the differential work of
moment M moving with velocity & during interval dt is dW = M ×& dt . Therefore,

the work of a possibly varying moment between states 1 and 2 can be expressed in either
of the two forms:

 =2          t =t2
W =  M d =  M & dt
                                                                                    (B-5)

 =1          t =t1

        B-1
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

with units of lb-ft, lb-inch, or J. The associated definition of power is              (B-6)
                                             P = M ×&

with units of lb-ft/sec, hp (for horsepower, 1 hp  550 lb-ft/sec), lb-inch/sec, or W.

         At least some of the work that is done on a real system might be stored in some
form of recoverable energy, or work done might be completely dissipated and lost. For
all real engineering systems, at least part of the input work that is intentionally done on a
system is lost irretrievably, not used for the intended purposes.

B-2 Mechanical work, energy, and power (complementary to Chapter 3)

         If a force accelerates in translation a body with mass m, f x = m ax = m v&x , then
the work done by f x is conserved as kinetic energy of the body, from Eq. (B-3):

       t =t2
( ) [ ] t=t2
              1 t=t2 d 2 1 2 2
W  EK =  f xvx dt =  m v&x vx dt = m  vx dt = m vx (t2 ) - vx (t1 )                    (B-7)
              2 t=t1 dt                 2
t =t1  t =t1

         If a force stretches or compresses a standard ideal linear translational spring (as-
sumed here to have negligible mass), f x (x) = k x , then the work done by f x is stored as
strain energy (a form of potential energy) within the spring, from Eq. (B-2):

              ( ) x=x2 x=x2 1 2 2                                                      (B-8)

       W  ES =  f x (x) dx =  k x dx = k x2 - x1

                    x= x1 x= x1 2

         At any instant, therefore, the total mechanical energy present in an ideal mass-
spring system, relative to an initially stationary and unstrained state, is

       EMe = EK + ES = 1 m vx 2 + 1 k x 2                                              (B-9)
                   2                 2

In an ideal conservative mass-spring system, without any agent of energy augmentation
or energy dissipation, EMe remains constant in time, oscillating between the kinetic ener-
gy of the mass and the strain energy within the spring.

         An ideal translational viscous damper dissipates mechanical energy by exerting a
force in opposition to velocity: f x = -c vx = -c x& . Thus, from Eq. (B-4), the rate of en-
ergy dissipation by the damper is

              Pc = f x vx = -c vx 2                                                    (B-10)

              B-2
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

         Suppose that a mass-damper-spring system is initially stationary and unstrained,
and that an independent, externally applied force f x (t) is imposed upon the mass. This
force is a source of power, Pf = f x (t) vx . The damper, on the other hand, is a sink of me-

chanical energy. Therefore, total mechanical energy EMe varies in time:

d   d 1 2 1 2                      m vxv&x + k x x& = -c vx 2 + f x (t) vx (B-11)
    EMe =  m vx + k x  = Pc + Pf
dt  dt  2  2

Canceling vx = x& out of Eq. (B-11) and re-arranging terms leads to the general ODE of
motion for a mass-damper-spring system1:

               m &x& + c x& + k x = f x (t)            (B-12)

         The following relations for rotational motion can be derived from the basic defini-
tions in the manner used above for translational motion. If a moment M accelerates a
body with rotational inertia J about the axis of rotation, then the work done by M is con-
served as kinetic energy of the body:

               t =t2
           W  EK =  M & dt = 1 J [&2 (t2 ) - &2 (t1)]
                                  2                    (B-13)

               t =t1

If a moment M twists an ideal linear torsion (rotational) spring (assumed here to have
negligible rotational inertia) with spring constant k , then the work done by M is stored
as strain energy within the spring:

                      ( )  =2        1       2  2
           W  ES =  M d = k 2 - 1                      (B-14)
                                     2
                       =1

A rotational viscous damper with constant c dissipates mechanical energy by exerting a
moment in opposition to velocity: M = -c & . Thus, the rate of energy dissipation by

the damper is

               Pc = M & = -c &2                        (B-15)

1 The direct power-balance method giving Eq. (B-11) and leading to ODE of motion (B-12) is also used in
this appendix to derive governing ODEs (B-19) and (B-34). Each of these applications is for a one-degree-
of-freedom (1-DOF) system, i.e., a system that has only one time-dependent variable. (See Chapters 11
and 12 for more detailed definitions of degrees of freedom and examples of multiple-DOF systems.)
Unfortunately, this direct approach fails for systems with more than one DOF, as is observed and illustrated
by Cannon, 1967, p. 166. For deriving the governing ODEs of multiple-DOF systems, a more general
energy method was developed by Joseph Louis Lagrange (French-Italian mathematician and mechanician,
1736-1813). Lagrange's equations are derived and illustrated in detail by most textbooks on classical
mechanics and structural dynamics, e.g., Bisplinghoff, et al., 1955; Cannon, 1967; Craig, 1981;
Greenwood, 1965; and Meirovitch, 1967 and 2001.

                                                  B- 3
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

         For our final example of mechanical energy, consider translation in the y direction
of a mass m that is within a field of constant gravitational field strength g (with SI units
newton/kilogram). The force required to sustain the mass without acceleration (either
stationary or at constant velocity) against gravity is

                 fy = mg                          (B-16)

Therefore, the work required to raise the mass without acceleration against gravity is
stored conservatively as gravitational potential energy:

                                     y= y2        (B-17)

              W  EG =  f y dy = mg( y2 - y1 )
                                     y= y1

For reference in the next section, we define also the gravitational potential difference,
g( y2 - y1) . The following is an application of Eq. (B-17). Suppose that we shoot a pro-

jectile of mass m straight up against Earth's gravity from surface elevation y1 , with initial

velocity v1 sufficiently low that g remains essentially constant over the entire trajectory.
Let's assume that atmospheric drag is viscous with damping constant c.2 Drag force
- cvy dissipates energy, so the total mechanical energy EMe varies in time:

d   d 1    2  2                                2
    EMe =  m (vy - v1 ) + mg( y - y1 ) = Pc  m vyv&y + m g y& = -c vy (B-18)
dt  dt  2        

Canceling out vy = y& from Eq. (B-18) and re-arranging terms leads to the 1st order ODE
describing projectile velocity:

                 m v&y + c vy = -m g              (B-19)

B-3 Work, energy, and power in electrical circuits (complementary to Chapter 5)

         Electrical fields exist in spaces around and between charged particles or charged
objects (Halliday and Resnick, 1960, Chapter 27). The electrical field strength E (with SI
units newton/coulomb) at a point in space is analogous in many respects to gravitational
field strength g, as in Eq. (B-16). Suppose that an electrical field is oriented in the y
direction and is constant. Experimental measurements show that the force required to
sustain a particle of charge q p without acceleration against the electrical field is

                 fy = qpE                         (B-20)

2 See homework Problem 1.7 for discussion of this projectile-velocity problem using both the viscous
(linear) drag mathematical model and a velocity-squared (nonlinear) drag model.

                                                  B-4
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

(This linear relationship is the basis for definition of E.) Thus, charge qp within an elec-
trical field of strength E is analogous to mass m within a gravitational field of strength g.
We see from this analogy that the work required to move the charge without acceleration
against the electrical field is stored conservatively as electrical potential energy:

y= y2  y= y2

W  EE =  f y dy =  q p E dy = q p E( y2 - y1 )                              (B-21)

y= y1  y= y1

         It is customary and appropriate in electrical theory and applications to define (in
analogy with the gravitational potential difference) the electrical potential difference in
volts between two points in space as (Halliday and Resnick, 1960, Chapter 29)

e2 - e1  E( y2 - y1 ) , or differentially, de  E dy                         (B-22)

With de  E dy in Eq. (B-21), the work required to move charge qp , work equal to the
electrical potential energy, is expressed in terms of electrical potential difference as

                      e=e2                                                  (B-23)

W  EE =  q p de = q p (e2 - e1 )
                      e=e1

We infer from Eq. (B-23) the SI unit equivalence: 1 volt = 1 joule/coulomb. Note the
sign conventions in Eq. (B-23): work and potential energy are positive if a positive
charge, qp > 0, is moved to a higher electric potential, e2 > e1 .

         One useful application of Eq. (B-23) for electrical potential energy is to a capaci-
tor within a circuit. Halliday and Resnick, 1960, p. 651, explain the physical process:

... work must be done to separate two equal and opposite charges. This
energy is stored in the system and can be recovered if the charges are al-
lowed to come together again. Similarly, a charged capacitor has stored in
it an electrical potential energy U equal to the work W required to charge
it. This energy can be recovered if the capacitor is allowed to discharge.
We can visualize the work of charging by imagining that an external agent
pulls electrons from the positive plate and pushes them onto the negative
plate, thus bringing about the charge separation; normally the work of
charging is done by a battery, at the expense of its store of chemical en-
ergy.

To derive an equation for capacitive potential energy, let's suppose that some quantity of

positive charge q+ has already been transferred from the negative

plate of an ideal capacitor to the positive plate; the voltage     e1 e2

difference between the two plates due to q+ is expressed in terms

of the capacitance C, from Eq. (5-2), as e1+ - e2+ = (1 C)q+ , in  C

       B-5
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

which e1+ is a higher potential than e2+ . From Eq. (B-23), the differential work required
to transfer an additional differential quantity of positive charge dq+ from the negative
plate to the positive plate is given by

dW = dq+ (e1+ - e2+ ) = 1 q+ dq+                                                (B-24)
                           C

We integrate Eq. (B-24) to find the total work required to fully charge the ideal capacitor
from zero to a quantity q, which also is the total electrical potential energy stored in the
capacitor:

q+ =q                                    1 q+ =q     11 2

W = EE =  dW =  q+ dq+ = q                                                      (B-25)
                                         C q+ =0     2C
q+ =0

Whereas the energy of a capacitor, Eq. (B-25), is stored in an electrical field, that

of an inductor is stored in the magnetic field within the inductor's coils; this magnetic

field exists as a consequence of the electrical current flowing in the  e1  L   e2
wire (Halliday and Resnick, 1960, Chapter 34). Even though it is
magnetic field energy, we can still apply Eq. (B-23) for electrical

work to determine an equation for the energy within an inductor

(Halliday and Resnick, 1960, Section 36-4). From Eq. (B-23), the i, di
differential work required to move a differential quantity of positive      dt

charge dq+ through an ideal inductor is

dW = dq+ (e1+ - e2+ )                                                           (B-26)

in which e1+ is a higher potential than e2+ . This is a conservative process, so the elec-
trical work, which might be done by a battery or some other power source, must be stored
as magnetic field energy, EM . The self-induced electrical potential difference across the
inductor is given by Eq. (5-6), e1+ - e2+ = L(di+ dt) . Also, current and charge are related
by i+ = dq+ dt , so that dq+ = i+ dt . Therefore, we re-write Eq. (B-26) as

dW = dEM = i+ dt × L di+ = L i+ di+                                             (B-27)
                           dt

Finally, we integrate Eq. (B-27) to find the total magnetic potential energy stored in the
ideal inductor for a quantity of current i:

                i+ =i 1 2                         2                             (B-28)

W = EM = L  i+ di+ = L i
                                         i+ =0

                                         B-6
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

Next, we apply Eq. (B-23) for electrical work once again in order to evaluate

power sources and power sinks in electrical circuits (Halliday and Resnick, 1960, Section

31-5). Consider a general component within a circuit, a "black box."

This might be a passive component such as a resistor, a source of       Black box
power such as a battery or signal generator, or a device such as a      e1
motor that converts electrical energy into another form of energy.                  e2

For this derivation, let's consider the upstream terminal of the black      i = dq
box to be at a higher potential than the downstream terminal: e1 >              dt
e2 . Suppose that a positive differential charge dq moves through

the black box from higher potential to lower potential; Eq. (B-23) shows that there is a

reduction of electrical energy: dW = dEE = - dq (e1 - e2 ) = - i dt (e1 - e2 ) . Electrical

power also is reduced:

                        PE = dW = -i (e1 - e2 )                                   (B-29)
                               dt

         Equation (B-29) is an important formula that can be applied usefully for many
different black boxes. We shall consider here just two of them. First, suppose that the
black box is a resistor with resistance R, for which Eq. (5-1) gives e1 - e2 = iR ; in this
case, the downstream terminal is at lower voltage than the upstream terminal, so Eq. (B-
29) becomes the following famous formula for the electrical power that is dissipated in
heating the resistor:

                        PR = -i 2 R                                               (B-30)

Next, suppose that the black box is a source of input voltage ei (t) (battery or signal gen-
erator) for a circuit; in this case, the downstream voltage e2 = ei (t) exceeds the upstream
voltage (for positive current i), so Eq. (B-29) gives the formula for electrical power intro-
duced into the circuit by the voltage source:

                        Pe = i [ei (t) - e1 ]                                     (B-31)

For most, if not all of the relatively simple circuits considered in this book, the upstream
terminal of the voltage source is connected to the ground (zero) potential, so that e1  0
and the input power is Pe = i ei (t) .

         An interesting application of the equations derived in         L em R
this section is to the powered LRC circuit drawn at right, from                           eo(t)

the example in Section 9-2. The total stored electromagnetic ei(t)

energy resides in the electrical field of the ideal capacitor and                          C

the magnetic field of the ideal inductor:                                   i(t)

                                           B-7
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

    EEM = EE + EM = 1 1 q 2 + 1 L i 2                 (B-32)
                          2C 2

The signal generator is a source of electrical power, and the resistor is a sink of electrical
power, so the total electromagnetic energy varies in time:

d   d 1 1 2 1 2                            di 1 dq 2
    EEM =  q + L i  = PR + Pe  L i + q = - i R + i ei (t) (B-33)
dt  dt  2 C 2                              dt C dt

Canceling i = q& out of Eq. (B-33) and re-arranging terms leads to the general ODE for
charge q(t) on the capacitor plates in the LRC circuit:

    L q&& + R q& + 1 q = ei (t)                       (B-34)
                 C

Since q = Ceo , Eq. (B-34) is essentially the same as that derived from Kirchhoff's volt-
age law in Section 9-2 for output voltage eo (t) : &e&o + (R L) e&o + (1 LC) eo = (1 LC) ei (t) .

B-4 Analogies between an m-c-k mechanical system and an LRC electrical circuit

         By comparing ODEs (B-12) and (B-34) and the many other mechanical and elec-
tromagnetic equations developed in this appendix, we can identify some clearly analo-
gous variable quantities and constants between a forced m-c-k mechanical system and a
powered LRC electrical circuit (Halliday and Resnick, 1960, Section 38-2). The most ob-
vious analogies are listed in the following table.

Forced m-c-k mechanical system               Powered LRC electrical circuit
                mass m                                   inductance L
                                                          resistance R
    viscous damping constant c
         stiffness constant k                     inverse capacitance 1 C
                                                charge on the capacitor q(t)
     position of the mass x(t)             current through the circuit i(t) = q&(t)
 velocity of the mass vx (t) = x&(t)
                                                      input voltage ei (t)
       excitation force f x (t)                magnetic energy EM = 21 L i 2
   kinetic energy EK = 21 m vx 2             electrical energy EE = 12 (1 C) q 2
                                               power dissipation PR = -R i 2
     strain energy ES = 21 k x 2
   power dissipation Pc = -c vx 2                  power input Pe = ei (t) i

     power input Pf = f x (t) vx

         The mathematical similarity of an m-c-k system to an LRC circuit is one of the
simpler analogies between physical systems and circuits, and there are many other analo-
gous electrical circuits of greater complexity (Fifer, 1961, Vol. III, Chapter 19; MacNeal,
1962). In fact, during the 1940s and 1950s, methods of direct analog computation were

                                      B-8
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

developed extensively for analysis of many physical "prototype" systems with use of
electrical circuits. In the introductory chapter of a 1962 book entitled Electric Circuit
Analogies for Elastic Structures, Richard H. MacNeal wrote (pages 6-7): "The ... direct
analog computer is ... a device in which each electrical component (or group of
components) is equivalent to a physical component of the prototype system." MacNeal
stated further: "This technique has been frequently used for the solution of problems
concerning mechanics and elasticity, the conduction of heat, fluid flow, and electromag-
netic waves." However, during and after the mid-1960s, direct analog computation was
completely eclipsed by the rapidly advancing capabilities of digital computers and soft-
ware written for digital processing. It is an ironic twist of history that MacNeal himself
became an innovative pioneer in the development and implementation of the finite-
element method for high-precision digital computation of structural behavior.

B-5 Hysteresis and dissipation of mechanical energy by damping

Consider the ideal parallel damper-spring system of Example 3-3, shown again in

the figure below, with the damper assumed to be an ideal viscous dashpot. The spring

k x(t)                           FBD of link            and dashpot forces acting
               fx(t)        fs = -kx                    onto the link are depicted
                                                        with arrows as positive
                                                 fx(t)  toward the right so that they

                                                        have the same polarity as

c that x(t) is imposed by some fd = - cx& translation x(t). Suppose

                                                        external agent in a steady-

state sinusoidal form with frequency  and constant amplitude X: x(t) = X cos t.

Accordingly, the spring force and viscous-dashpot force are, respectively,

fs(t) = - kx(t) = -kX cost  and  fd(t) = - cx&(t) = cX sin t

         Let's examine the relationships between x(t)
and the two component forces as the system moves
through one complete cycle. These relationships are
depicted graphically on Fig. B-1, on which the points
labeled 1 represent times t = 0 and 2 /  at the begin-
ning and end of the cycle, and the points labeled 2
represent time t =  /  at the middle of the cycle. On
Fig. B-1(a), the loci of spring force fs and dashpot
force fd are plotted separately versus x. Spring force
fs is exactly out of phase with x, so its locus is simply
a straight line. On the other hand, dashpot force fd
lags behind x by ¼ of the cyclic period, since sin t =
cos(t -  2) , so that its locus forms a closed loop.

A time lag such as this in cyclic motion, of an output
quantity (fd in this case) relative to an input quantity
(x in this case), is generally referred to as hysteresis, and the locus of the output versus

                            B-9
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

the input over a complete cycle is called a hysteresis loop. As shown by the following
equation, this particular hysteresis loop has the simple and familiar form of an ellipse,
one with semi-major axis X and semi-minor axis cX:

x2 +  f d 2 ( X cost)2 (cX sin t) 2 2 2
           2=                       +             2 = cos t + sin t = 1
X 2 (cX )                 X  2          (cX )

The total area A enclosed within the hysteresis loop is a significant physical quantity, and
it is given for the ellipse of Fig. B-1(a) by the following simple formula from plane geo-
metry:

      A =  × semi-major axis × semi-minor axis =  c X 2

         Let's now derive the work per cycle done by each of the component forces within
the damper-spring system. From Eq. (B-2) the work per cycle of viscous-damper force

fd(t) is  fd dx , in which the symbol  denotes that the integration path covers one com-

plete circuit around the loop, from point 1 to point 2 on the curve of fd  0 of Fig. B-1(a),
and then from point 2 back to point 1 on the curve of fd  0:

                           fd 0             fd 0         fd 0       fd 0

                      64748            64748      64748        64748

                      x=- X            x=+ X         x=+ X     x=+ X

Wd =  fd dx =  fd dx +  fd dx = -  fd dx +  fd dx
                      x=+ X            x=- X      x=- X        x=- X

                                                                          (B-35)

      =  -(12  A)  +  (-  1  A)  =  -A
                          2

In the second form above for the integral over the path of fd  0, the limits of integration
have been reversed, which accounts for the sign change of that entire integral. Therefore,
the work per cycle done by the viscous damper is simply the entire area enclosed within
the hysteresis loop, Wd = - c X 2 . Now, having completed carefully the derivation of

work per cycle for fd(t), we can recognize without the necessity of any further mathemati-
cal derivation that the work per cycle done by any cyclic force that moves through a cy-
clic path of translation is simply the area enclosed within the hysteresis loop, even though
the loop might not be a simple ellipse such as that for viscous-damper force fd(t). One
immediate application of this general result is that the work per cycle done by spring
force fs(t) is zero, Ws = 0; for, as shown on Fig. B-1(a), the path of fs(t) for x decreasing
from point 1 to point 2 is exactly the same as the path for x returning from point 2 back to
point 1, so this hysteresis "loop" collapses to a line that encloses zero area. Therefore,
the total work per cycle done by the viscous-damper-spring system is the sum

         Wd -s = Wd + Ws = - c X 2 + 0 = - c X 2                          (B-36)

The polarity of Wd-s is negative because the damper-spring system actually dissipates
mechanical energy. In a real solid structural component (which is discussed next), the

                                       B-10
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

dissipated mechanical energy does not disappear, but rather is converted into thermal
energy that raises the temperature of the component.

         Imagine now that the damper-spring system is a solid, distributed-parameter
structural component of some sort, e.g., a metal tensile-test specimen, or a hard rubber
pad of the type used to support heavy machines. If we were conducting a cyclic tensile
test on this component, we would be able to measure its deformation, comparable to x(t)
on Fig. B-1. But the structural component could not be separated into a discrete damper
and a discrete spring, so we would be able to measure directly only the total resisting
force of the component, comparable to fd(t) + fs(t), but not individual damper and spring
forces. Therefore, Fig. B-1(b) is more representative than Fig. B-1(a) of actual physical
measurements. A thoughtful study of Eq. (B-35) should convince you that, even though
the hysteresis loop of Fig. B-1(b) is not a true ellipse, the area that it encloses, and the
work per cycle done by the viscous-damper-spring system, is still

Wd -s  W =  ( f d + f s ) dx = - c X 2  (B-37)

The symbol W is introduced in Eq. (B-37), with subscript  indicating that this particular
equation applies for the linear viscous-damping mathematical model, fd = -cx& , since 

is the standard symbol for viscous-damping ratio in vibrating systems.

         For over a century now, experimental measurements on distributed-parameter
structural components have demonstrated that the linear frequency dependence of me-
chanical-energy dissipation in Eq. (B-37) is unrealistic (Love, 1926, pp. 117-121, Kim-
ball and Lovell, 1927; Ungar, 1998). The subject of damping in solids under loading is
very complicated (see books by Lazan, 1967; Nashif, et al., 1985; and de Silva, 2007):
different solid materials behave differently, of course, and even the same material usually
behaves differently after different time-histories of loading, temperature, exposure to cor-
rosion or chemicals, etc. Nevertheless, laboratory measurements with structural metals
and elastomers (rubber-like materials), at stresses below yield and fatigue endurance lim-
its, generally show that mechanical-energy dissipation (conversion of mechanical energy
into heat energy) is not proportional to excitation frequency, as predicted by the viscous-
damping model, but, instead, is much more weakly dependent on frequency. For this rea-
son, engineers have developed an alternative, simple, linear, approximate mathematical
model of damping, for which mechanical-energy dissipation is specified to be independ-
ent of frequency. Further for this model, the energy dissipation is specified to be propor-
tional to the stiffness of a solid structural component, which is at least plausible physi-
cally. Thus, for this alternative model, we replace the term c ×  in Eq. (B-37) with the
term k × , in which constant of proportionality  is generally called the damping loss
factor. Accordingly, the work per cycle for this model, denoted as W , is written as

W = - k X 2                             (B-38)

Engineers have used this mathematical model of damping at least since the 1940s (Bis-
plinghoff, et al., 1955, pp. 558-568), but, unfortunately, there is no standard, recognized

B-11
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

name for it in engineering literature.3 We shall call it the internal-friction model, in re-
cognition of the 1927 article entitled "Internal Friction in Solids" by Kimball and Lovell,
who reported the first experimental measurements of energy dissipation that is indepen-
dent (or nearly so) of cyclic frequency.

        We derived Eq. (B-38) for damping energy dissipation by replacing c ×  in Eq.
(B-37) with k × . Next, we need for the internal-friction model a corresponding linear
equation for damping force that can be used directly in ODEs of motion, an equation
comparable to fd = -cx& for the viscous-damping model. Based only upon algebra, if k ×
 replaces c × , then k  replaces c, and the desired equation is

fd = - (k )x&                 (B-39)                                    k x(t)
                                                                                       fx(t)
Accordingly, the figure at right depicts a damper-spring
system for the internal-friction model, and the ODE for               k 
this simple system is

(k )x& + k x = f x (t)        (B-40)

Question: If we want to apply damping force fd = - (k )x& for general motion x(t),
we can probably find values for material constants k and , but what value should we use
for , since general motion is not necessarily steady-state sinusoidal?

Answer: Damping force fd = - (k )x& is mathematically consistent only for steady-
state sinusoidal motion at known frequency , so, in general, this equation for internal-
friction-model force should be used only in frequency-response derivations and calcula-
tions. (However, engineers and physicists occasionally bend the rule a bit and use this
model for more general structural motion that consists primarily of lightly damped vibra-
tion, by setting  equal to the dominant natural frequency of the system.)

         An interesting and practically relevant application of       y(t) f (t)
the internal-friction model of structural damping is to passive

vibration isolation, which is described in homework Problem

10.13 for the viscous-damping model. The drawing from                 m

Problem 10.13 is reproduced at right. A mass m (often a ma-           c
                                                                               k/2
chine that includes unbalanced rotating or translating parts) is k/2
supported on elastomeric padding. The padding is modeled as

an ideal shock strut (from Example 3-3), with a spring of stiff-

ness constant k and, on the drawing, a viscous damper of con-            fR(t)

stant c; here we shall consider as well elastomeric padding with

the internal-friction damping model, which is more realistic than the viscous-damping

model. Dynamic force f(t) is applied to m, by either external or internal agents, and

3 Perhaps the most common name used is "hysteretic damping", but that name is misleading because every
form of solid damping involves hysteresis.

                        B-12
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

dynamic reaction force fR(t) is transmitted through the padding to the supporting struc-
ture. The purpose of passive vibration isolation in this form is to protect the supporting
structure, with the flexible padding designed so as to minimize the transmitted dynamic
force fR(t).

         Part of the assignment in Problem 10.13 is to derive the transfer function TF(s) =
FR(s)/F(s) relating the floor-reaction dynamic force to the excitation force and then to
show that the corresponding complex frequency-response function, known as transmissi-
bility, is

               TF ( j)  FRF ()  FR () e j() = -     1 + j2

                                                         2
                                        F           (1 -  ) + j2

where   c (2 mk ) and    n =  k m . Therefore, the magnitude of transmis-
sibility, which we denote as T () for the viscous-damping model, is

               T ()  FRF() =                  1 + (2 )2                      (B-41)

                                                22            2
                                              (1 -  ) + (2 )

         For the internal-friction model, the viscous-damping constant c is replaced by the
term k  , Eq. (B-39). Frequency-response functions that are derived for a mathemati-

cal model based upon viscous damping can be converted easily to apply for internal-fric-
tion damping, without the necessity of a complete re-derivation. To show this, we write
below the mass-damper-spring ODEs for the viscous-damping and internal-friction mod-
els and then express these ODEs in terms of  , n , and :

Viscous: m&y& + cy& + ky = f (t)           Internal friction: m&y& + (k ) y& + ky = f (t)

&y& + c y& + k y = f (t) = k f (t)      &y& + k  y& + k y = f (t) = k f (t)
    m m m mk                                m m m m k

&y& + 2 c   k y& + n 2 y = n 2 f (t)    &y& + n 2  y& + n 2 y = n 2 f (t)
      2 mk  m                        k                           k

&y& + (2 )n y& + n 2 y = n 2 f (t)      &y& +     n y& + n 2 y = n 2 f (t)
                                                                 k
                                  k

From the terms in parentheses in the final forms of the two ODEs, we see that replacing
2 with   , everywhere 2 appears in any response equation derived from the viscous-

damping ODE, will convert the response equation to apply for internal-friction damping.
We note that engineers sometimes carelessly assert that the two types of damping are
equivalent if we simply equate 2 with . That assertion is clearly incorrect; for, even if

                                        B-13
Appendix B Notes on work, energy, and power in mechanical systems and electrical circuits

2 = , the only frequency at which frequency-responses of the two different models are
certain to be equal is  = n ,  = 1.

        Using the replacement 2 Æ   in Eq. (B-41) for the viscous-damping-model
transmissibility T () gives the equation for transmissibility T () that is applicable for
internal-friction damping:

T () = T () 2   =      1 + (2 )2 =                                1+ 2         (B-42)
                   (1 -  2 )2 + (2 )2                         (1 -  2 )2 +  2

                                                         2  

        Equation (B-41) is plotted below for  = 0.25 and 0.5, and Eq. (B-42) is plotted
for the two values of  that produce the same transmissibility magnitude at  = 1 as the
corresponding  values, namely,  = 0.5 and 1.0, respectively. The plotted values, espe-
cially those for  > 2, demonstrate why it is good that the frequency responses of real
elastomeric vibration isolators are much closer to the predictions of the internal-friction
model than to those of the viscous-damping model (Ungar, 1998).

                   B-14
Index of all Chapters and Appendices

                      Index of all Chapters               and Appendices

 A                                                        apparent mass, 10-14
                                                          approximate numerical solutions, 6-8, 8-15, 9-14
abs MATLAB function, 2-3, 4-16
absolute stability, 16-18, 17-1                               ..., convolution sum, 8-15, 9-14
absolute unit system, 3-1                                     ..., recurrence formulas, 6-8, 6-10, 6-12
AC = aerodynamic center, 11-7                             arctangent, four-quadrant, 2-2
accelerance, 10-13                                        argument of a complex number, 2-2
acceleration in G's, 1-19                                 array multiplication, MATLAB, 1-16, 9-23, 9-27
accelerometer, 7-17, 9-9, 9-24, 10-13, 10-25, 10-27,      arrow, double-headed, 3-4
                                                          artificial spring, 14-7, 15-14
    15-4                                                  artificial viscous damper, 12-19, 14-16, 15-15
actions = forces or moments, 11-2                         asymptotes, loci of roots, 16-32
active system, 7-1, 16-18                                     ..., low- and high-frequency, 4-7
actuator, dynamics, 15-4                                  atan2 MATLAB function, 2-2
                                                          attitude (vehicle rotational orientation), 14-1, 14-4, 15-
    ..., position, 15-4, 15-19                                19
adapting standard solutions, 3-7, 7-3, 7-17, 7-19, 7-20,  automotive vehicle, 11-15, 12-14
                                                          axis equal MATLAB function, 16-28
    9-4, 9-5, 9-21, 9-31, 10-21, 11-6, 13-4, 14-11
added-mass (-inertia) method, 7-22, 12-18                  B
adjoint matrix, 12-3
admittance, electrical, 10-11                             balloon carrying a basket, 7-3, 7-9, 7-18
                                                          band-pass filter, 5-12, 9-21, 9-31, 13-1
    ..., mechanical, 10-12                                base excitation, 9-23, 10-20, 10-21, 10-25, 12-13, 13-
aerodynamic center (AC) of a wing section, 11-7
aerodynamics, coefficients, 1-21, 3-8, 11-8, 16-43            2, 13-4, 14-7
                                                          baseball, 1-20
    ..., drag, 1-20                                       baseline, transfer and frequency-response function,
    ..., rolling moment, 3-8
    ..., quasi-static, 11-9, 16-42                            17-8
aeroelasticity, divergence and flutter, 11-7, 16-41       battery, electrical, 5-1
aeronautical unit system, 3-1                             beam, structural, 7-9, 7-22
aileron, 3-8, 11-9                                        beating of vibrating systems, 1-24, 10-14, 10-31
air density, 1-21, 3-9, 3-18, 11-8, 16-43                 beating period and frequency, 10-16
air-jet thruster, 8-28                                    black box, general circuit component, B-7
airplane, aileron, 3-8, 11-9                              block diagram, algebra, 13-2, 14-8, 14-15, 14-18
    ..., blowdown moment, 11-9
    ..., Boeing 747, 3-18                                     ..., closed-loop, 13-2
    ..., bomb release, 9-28                                   ..., junctions, 13-3
    ..., brake release, 7-6                                   ..., Laplace, 13-1
    ..., Douglas A-4 Skyhawk, 3-18                            ..., open-loop, 13-2
    ..., landing contact, 7-9, 7-19                       blowdown moment, 11-9
    ..., rolling, 3-8, 9-14                               Bode diagram, 4-6, 10-11, 17-4, 17-7
    ..., trimming tab, 11-13                              Boeing 747 airplane, 3-18
    ..., wing, 3-8, 11-7, 11-9                            branch point junction, 13-3
airspeed, free-stream, 3-9                                branch, feedforward, 14-18
algorithms, numerical, for 1st order ODE, 6-7, 6-12, 8-       ..., forward or feedback, 13-2
    15, 8-20                                              break frequency, 4-6
    ..., ..., for 2nd order ODE, 8-15, 8-22               break-away point, 16-20, 16-24
aluminum flat, 7-21                                       break-in point, 16-20, 16-24
amp, ampere (A), unit of electrical current, 5-1          buoyancy force, 7-18
amplification, dynamic, 10-2
amplifier, inverting, 5-10                                 C
    ..., non-inverting, 5-16
    ..., summing inverting, 5-16                          cantilever (ideally clamped-free) beam, 7-12, 7-22
amplitude modulator, 10-15                                capacitors, circuit components, 5-3
analog computation, direct, B-8
analog computer, electronic, 5-15, 5-17, 7-20, 9-31,          ..., in parallel, 5-14
    10-31                                                     ..., in series, 5-14
analogous systems, 5-6, B-8                                   ..., potential energy, B-5
angle MATLAB function, 2-3, 4-16                          capsule (re-entry vehicle), 14-3
angle of a complex number, 2-2                            Cartesian coordinates x and y, 2-2
angle of attack of a wing section, 11-8                   Cartesian xyz axis system, 11-1
antenna, 7-20                                             causality of transfer function, 4-12, 15-13, 15-18
apparent frequency of beating, 10-16                      cavity resonator, 7-20

Index-1
Index of all Chapters and Appendices

center of mass, 11-1                                           ..., polar, 11-4
characteristic equation, 1st order ODE, 1-7                corner frequency, 4-7
                                                           coulomb, unit of electrical charge, 5-3
    ..., 2nd order ODE, 1-22                               coupled ODEs, 1-12, 3-14, 11-1, 11-11, 13-7
    ..., damped 2nd order system, 9-1                      critical viscous damping constant, 9-1, 10-19, 16-34
    ..., free-vibration problem, 12-4, 12-10               critically damped 2nd order system, 9-2, 9-28
    ..., nth order, 16-2, 16-43                            crossovers, phase and gain, 17-6
    ..., polar form, 16-25                                 cruise-control system, 15-17
characteristic time, 8-11                                  cyclic frequency (cycles/second), 1-17, 4-8
characteristic values, 1st order ODE, 1-7
    ..., 2nd order ODE, 1-22                                D
charge, electrical, 5-3, B-4
circular frequency (radians/second), 1-6, 1-17, 4-8        damped natural frequency, 9-3, 14-20
clamped beam, non-ideal support, 7-16                      damper-spring (c-k), parallel system, 3-13, 4-2
classical control theory, 14-17
closed loop, 13-2                                              ..., series system, 3-14, 4-16, 4-17, 5-6, 5-14, 15-3
    ..., control, 14-6                                     damping laws, nonlinear, 3-12
    ..., transfer function (CLTF), 13-4, 14-8, 17-2
    ..., circuit for op-amp, 5-10, 15-2                        structural internal-friction, B-12
CLTF = closed-loop transfer function, 13-4                     structural viscous, B-9
    ..., general formulas, 14-9                            dashpot (mechanical viscous damper), 3-12
    ..., P control, 15-6, 15-14                            decibel (dB) scale, 4-7, 10-11, 17-6
    ..., PD control, 15-15                                 definite integral, Laplace transform of, 2-14, A-5
    ..., PI control, 15-8                                  degrees of freedom (DOFs), 11-2, 11-10, 12-1, 16-41
    ..., position + rate feedback, 14-15                   density of air, 1-21, 3-9, 3-18, 11-8, 16-43
    ..., position feedback, 14-9                           departure angles, loci of roots, 16-32
coil of conducting wire, 5-6                               derivative time constant, 15-1, 15-13, 15-16
coincident frequency-response component, 17-10             derivative, Laplace transform of, 2-8
command, 1-2                                               design, control system, 14-21, 15-2, 15-11, 15-16, 15-
    ..., control, 9-14, 13-4, 14-1, 14-2                       17, 16-28, 16-36, 17-22
common open-loop system, 17-7, 17-17                       determinant of a matrix, 12-3
compensator, 16-36                                         DFBD = dynamic free-body diagram, 7-7, 11-5, 12-2
complementary solution of an ODE, 1-6                      dielectric (insulating) material, 5-3
complex, arithmetic, 2-3                                   differentiator, approximate, 15-13, 15-18
    ..., conjugate, 2-4                                        ..., exact, 15-18
    ..., function F(s), 2-6                                digital camera, 7-11
    ..., number z = x + jy, 2-1                            Dirac delta function, 8-3, 16-40
   ..., variable s =  + j, 2-6                             direct term of partial-fraction expansion, 2-19, 15-19
compliance, dynamic, 10-13                                 distributed-parameter system, 7-9
component of a system, 1-1                                 disturbance, 1-2
concentrated mass, 7-15                                        ..., internal or external, 14-3, 14-5
conjugate of a complex number, 2-4                             ..., response of controlled system, 14-8, 14-18, 14-
conservative system, B-2
consistent mass, 7-23                                              20, 15-17
continuity condition, 5-2                                  divergence, aeroelastic, 11-7, 16-22, 16-43
control, actuators and sensors, 15-4                       DOF = degree of freedom, 11-2
    ..., m-c-k system by base excitation, 13-4             dominant modes of response, 16-30, 16-43
    ..., open-loop, 14-2, 14-6                             dot notation, 1-2
    ..., output feedback, 14-14                            Douglas A-4 Skyhawk airplane, 3-18
    ..., P, 15-2, 15-6, 15-14                              dsolve MATLAB operation, 1-20, 1-23
    ..., PD, 15-2, 15-13, 15-14                            Duhamel integral, 8-15
    ..., PI, 15-2, 15-8
    ..., PID, 15-1                                             ..., 2nd order ODE with RHS dynamics, 9-30
    ..., remote (indirect), 14-1                               ..., underdamped 2nd order system, 9-14
controller (control processor, filter), 15-1               dummy variable of integration, 1-4, 6-1
control theory, classical and modern, 14-17                duration of pulse, 1-6
control-moment gyroscope (CMG), 12-13, 14-5                dwell, vibration testing, 10-8, 17-25
                                                           Dynaman and Dynamobile, 1-18
conv MATLAB function, 6-2, 8-19, 8-26, 16-43               dynamic, behavior, general definition, 1-1
convolution integral, 6-1, 6-3, 6-8, 7-1, 7-3, 9-7, 9-14,      ..., flexibility, 10-8, 10-13, 10-31
                                                               ..., free-body diagram (DFBD), 7-7, 11-5, 12-2
    9-21, 9-30                                                 ..., pressure, 1-21, 3-8, 11-8, 11-9, 16-43
    ..., Laplace transform of, 6-1, A-7                        ..., stiffness, 10-8, 10-13, 10-31
convolution sum, 6-2, 8-15, 8-17, 9-14
coordinates, Cartesian, 11-1

                                                           Index-2
Index of all Chapters and Appendices

 E                                                             ..., system, 1-4
                                                           flat impulse, 8-3
e, the base of natural logarithms, 1-6                     flat pulse, 6-11, 8-1, 9-32
EA = elastic axis of a flexible wing, 11-7                 flexibility, dynamic, 10-8, 10-13
elastomers, 10-26, B-11, B-12
electrical, current, 5-1                                       ..., static, 10-8
                                                           flutter, aeroelastic, 11-7, 11-10, 16-41
    ..., field strength, B-4                               folding, 8-17
    ..., potential (voltage), 5-1, B-5                     forced response, 6-3
    ..., potential energy, B-5
electromagnetic force shaker, 10-30                            ..., approximate numerical, 6-8, 8-15, 9-14
element of a system, 1-1                                   forcing function, general definition, 1-2
emf (electromotive force), self-induced, 5-6               forward Laplace transform, 2-6
energy, dissipation, B-2                                   forward path or branch, 13-2
    ..., kinetic, B-2                                      Fourier series, 7-14
    ..., potential. See potential energy                   four-quadrant arctangent, 4-10
    ..., sinks and sources, 16-18, B-3, B-7                four-quadrant tangent, 4-4
engineering models, 1-5                                    fourth (4th) order system, 3-14, 11-11, 13-7
equations of plane motion, 11-1                            free vibration, undamped 2nd order system, 7-4, 12-1
error, signal, 14-6
    ..., propagation of, 7-21                                  ..., distributed-parameter system, 7-10
    ..., steady-state output, 15-7                             ..., undamped 2-DOF system, 12-2
Euler's equation, 2-3                                      free-body diagram (FBD), 1-3, 3-4, 7-9, 11-14, 11-15
Evans, Walter R., 16-28                                    frequency of sinusoidal signal, circular (radians
excitation, general definition, 1-2                            /second), 1-17
existence of Laplace transforms, 2-10                          ..., cyclic (cycles/second = Hz), 1-17
exponential, decay, 1st order, 3-6                         frequency response, 4-1, 10-1, 17-1
    ..., envelope, 16-4                                    frequency, circular and cyclic, 1-17, 4-8
    ..., ..., underdamped 2nd order system, 9-8            frequency, excitation, 10-3
    ..., rise, 1st order, 3-7                              FRF = frequency-response function, 4-6
    ..., stability, 16-3                                       ..., damped 2nd order, 10-2
    ..., unit-impulse function, 8-30, 16-5                     ..., general definition, 4-12, 10-11
    ..., unit-step function, 1-23, 8-30, 16-5                  ..., general derivation, 4-12
external disturbance, 14-3                                     ..., m-c-k system, 4-18, 10-8
                                                               ..., open-loop (OLFRF), 17-1
 F                                                             ..., RC band-pass filter, 10-10, 10-24
                                                               ..., stable 1st order system, 4-6, 4-10
Faltung, 8-19                                                  ..., stability criteria, 17-1
farad (F), unit of electrical capacitance, 5-3                 ..., undamped 2nd order system, 10-1
FBD = free-body diagram, 1-3
feed across, block diagram, 13-7                            G
feedback control, 7-1, 13-1, 14-1
feedback MATLAB function, 15-20                            g, gravitational acceleration, 3-2
feedback, block diagram, 13-2, 13-3                        gain, crossover, 17-6, 17-16, 17-22, 17-23

    ..., for an op-amp, 5-10                                   ..., margin (GM), 17-6, 17-16
    ..., output, 14-6, 14-11                                   ..., control parameter, 17-2
    ..., unity, 14-10, 14-18, 14-19                            ..., proportional, 15-1, 15-16
feedforward branch, 14-18                                  general response solution, 1st order system, 6-7
field strength, electrical, B-4                                ..., stable 1st order system, 6-2
    ..., gravitational, B-4                                    ..., undamped 2nd order system, 7-3
filter, 2nd order low-pass, 10-7, 16-35                        ..., underdamped 2nd order system, 9-6
    ..., band-pass, 5-12, 9-21, 9-31, 10-10, 13-1          generalized functions, theory, 8-4
    ..., controller, 15-1                                  gimbal, 9-5
    ..., damper-spring, 3-14, 3-19, 4-8, 4-16, 4-17, 5-6,  graphics, electrical circuits, 5-4
                                                               ..., engineering, 1-10
        5-14, 14-18                                        gravitational, field strength, B-4
    ..., high-pass, 4-17, 5-12, 5-14                           ..., potential difference, energy, B-4
    ..., low-pass, 4-8, 4-16, 5-4, 5-12, 16-13                 ..., unit system, 3-1
    ..., RC band-pass, 5-12, 10-10, 13-1                   ground voltage, 5-4
    ..., RC high-pass, 5-12, 5-14                          gyroscope, control-moment (CMG), 12-13, 14-5
    ..., RC low-pass, 5-4, 5-12                                ..., rate, 9-4, 9-32, 15-4
final-value theorem, application, 15-6, 15-8, 15-16            ..., rate-integrating, 9-32, 15-4
    ..., derivation, 15-12
first (1st ) order, LTI ODE, 1-2, 1-19

Index-3
Index of all Chapters and Appendices

 H                                                 initial-value theorem, application, derivation, 8-7
                                                   in-phase, sinusoidal response, 4-6
half-amplitude formula, small damping, 9-11
half-sine pulse, 1-6, 6-4                              ..., motion, 2-DOF IC response, 12-7
hammer strike, 9-19, 9-25, 9-29                        ..., frequency-response component, 17-10
Heaviside unit-step function, 2-12, 3-5            input resistance, 5-9
helicopter rotor blade, 11-3                       input, general definition, 1-2
henry (H), unit of inductance, 5-6                     ..., reference for control, 14-2, 14-4
higher-order, ODEs, 3-14, 11-1, 12-2               input-error operations, 14-14, 15-1
                                                   instability, 16-3, 16-6, 16-11, 16-18, 16-20
    ..., systems, 12-8, 13-7                           ..., by linear drift, 17-14, 17-28
high-frequency asymptote, 4-7                          ..., degree of, 16-20
high-pass filter, 4-17, 5-12, 5-14                 integral time constant, 15-1, 15-11
                                                   integrating factor, 6-7
    ..., approximate differentiator, 15-13, 15-18  integration, by parts, 2-7
    ..., damper-spring, 3-15, 3-19, 14-18              ..., approximate, 10-27
homogeneous solution, 1st order ODE, 1-6           integrator, electronic circuit, 7-20, 9-31
    ..., damped 2nd order ODE, 9-1                     ..., op-amp circuit, 5-15
    ..., undamped 2nd order ODE, 7-4, 12-1         internal disturbance, 14-3
    ..., undamped 2-DOF system, 12-3               internal-friction model of structural damping, 10-27,
horsepower (hp), traditional unit of power, B-2        B-12
hydroplaning, 1-18                                 inverse Laplace transform, 2-7
hyperbolic, cosine and sine, 2-18, 15-10           inverse matrix, 12-3
    ..., functions, 9-8, 9-20                      inverse tangent, four-quadrant, 2-2
hysteresis, B-9                                    IRF = unit-impulse-response function, 8-13
Hz (hertz) = cycles/second, 1-17, 4-1                  ..., 2nd order ODE with RHS dynamics, 9-30
                                                       ..., underdamped 2nd order system, 9-14
 I
                                                    J
IC = initial condition, 1-4
ideal, impulse, 8-3                                j = unit imaginary number, 2-1
                                                   joule (J), SI unit of work, B-1
    ..., shock strut, 3-13                         junction, block diagram, 13-3
idealized physical model, 1-5
ilaplace MATLAB function, 17-29, A-3                   ..., branch point, 13-3
imaginary number, 2-1                                  ..., summing, 13-3
impedance, electrical, 10-11
                                                    K
    ..., low output, 5-13
    ..., mechanical, 10-13                         KCL = Kirchhoff's current law, 5-2, 5-3
impulse of force, 8-3, 9-19                        kilogram force (kgf), 3-2
impulse response, 8-5, 8-7, 8-9                    kinetic energy, B-2
    ..., ideal vs. real, 8-10                      KVL = Kirchhoff's voltage law, 5-7, 5-15
    ..., underdamped 2nd order system, 9-13
impulse-momentum theorem, 8-3, 14-4                 L
indeterminate form 0/0, 12-4
inductor, circuit component, 5-6                   l'Hospital's rule, 1-25, A-4
    ..., potential energy, B-6                     labor-saving method, partial-fraction expansion, 2-9,
inertance, 10-13
inertia matrix, 11-11, 12-2                            4-14
inertial, force, 3-12, 3-14                        Lagrange's equations, B-3
    ..., moment, 11-2                              Laplace block diagram, 13-1
    ..., reference, 11-1
initial conditions (IC), 1-4                           ..., 2-DOF system, 13-7
    ..., 2nd order, 1-13                               ..., m-c-k system with base excitation, 13-3
    ..., 2-DOF system, 12-1                            ..., output feedback, 14-8
    ..., distributed-parameter system, 7-10            ..., stable 1st order system, 13-7
    ..., nth order, 16-1                           laplace MATLAB function, A-3
initial-condition (IC) response, 6-3               Laplace transform, 2-5
    ..., 1st order, 3-5                                ..., pairs, table of, A-1
    ..., 2-DOF system, 12-7                        LC electrical circuit, 7-20
    ..., 3rd order system, 16-15                   leading-lagging rotation, 11-3
    ..., distributed-parameter system, 7-10        Leibnitz's rule, A-5
    ..., nth order, 16-3                           linear algebraic equations, 12-3
    ..., undamped 2nd order system, 7-4            linear, constant-coefficient ODEs, 1-1
    ..., underdamped 2nd order system, 9-8

                                                   Index-4
Index of all Chapters and Appendices

linear, time-invariant (LTI) system, 1-1                  MATLAB script M-file, 1-9, 1-15, 4-3, 4-16, 10-3, 12-
linearity of an ODE, 1-2                                      11, 15-10, 16-10, 16-16, 16-23
linearized ODE, 7-3, 7-18
linearly independent functions, 1-7                       matrix, notation, 12-3
linear-system theory, 8-13, 8-14                              ..., equations of motion, 11-11, 12-2, 12-9, 12-13,
liquid-layer damping, 1-12                                        12-14, 12-15, 16-41
loci (or locus) of roots, 16-18, 16-22, 16-31, 17-17          ..., 2-DOF mode shapes, 12-6, 12-7
logarithmic decrement, 9-10                                   ..., adjoint of, 12-3
loss factor, structural damping, B-11                         ..., determinant of, 12-3
low-frequency asymptote, 4-7                                  ..., inverse of, 12-3
low-pass filter, 4-8, 4-16, 5-4, 5-12, 16-13                  ..., positive definite, 11-11, 11-15, 12-2
                                                              ..., zero determinant (singular), 12-3, 16-43
    ..., damper-spring, 3-15, 15-3
    ..., 2nd order, 10-7, 16-35                           Maxwell's equations of electromagnetism, 5-6
LRC electrical circuit, 5-15, 9-4, 9-29, 10-6, 10-23, B-  mechanical admittance, 10-31
    7                                                     mechanics of materials, 7-12, 7-23
LTI = linear, time-invariant, 1-1, 8-13                   mho, electrical impedance unit, 10-12
lumped-parameter system, 7-9                              MIMO = multiple-input-multiple-output, 14-17, 16-42
                                                          missile, rolling, 3-8
 M                                                        mobility, 10-13
                                                          modal analysis, 12-8
Mach number, 3-9                                          mode shapes, 2-DOF system, 12-6
MacNeal, Richard H., B-9                                  models (engineering, idealized physical,
magnetic field energy, B-6
magnitude of a complex number, 2-2                            mathematical), 1-5
magnitude ratio, sinusoidal response, 4-5, 17-3           modern control theory, 14-17
margin MATLAB function, 17-7, 17-24                       modes of response, 16-25, 16-30
margins, gain and phase, 17-6
mass center, 11-1                                             ..., dominant, 16-25, 16-30, 16-40
mass, apparent, 10-14                                     modes of vibration, 2-DOF system, 12-6
mass, translational inertia, 1-3
mass-damper (m-c) system, 1-3                                 ..., distributed-parameter system, 7-14
mass-damper-spring (m-c-k) system, 1-12, 1-22, 3-13,          ..., nth order system, 16-30
                                                          mode-shape matrix, 12-7
    7-1, 9-1, 9-18, 10-7, 10-19, 13-2, 13-4, 14-12, 16-   modulus of a complex number, 2-2
    21, 16-34, B-3                                        modulus of elasticity (Young's modulus), 7-12
mass-spring (m-k) system, 1-13, 2-18, 7-1, 12-1, 14-7     moment of inertia, rotational inertia, 3-3
Mathematica, 1-20                                             ..., area, 7-12
mathematical model, 1-5                                   musical instrument, 7-14
MATLAB, 1-1
    ..., Symbolic Math Toolbox, 1-20, 16-40, A-3           N
MATLAB functions, operations, abs, 2-3, 4-16
    angle, 2-3, 4-16                                      natural frequencies of vibration, 2-18
    array multiplication, 1-16, 9-23, 9-27                    ..., 2-DOF system, 12-5
    atan2, 2-2                                                ..., distributed-parameter system, 7-14
    axis equal, 16-28                                         ..., damped, 9-3, 14-20
    bode, 17-7, 17-24                                         ..., undamped 2nd order, 1-14, 7-1, 7-5, 14-16, 15-
    conv, 6-2, 8-19, 8-26, 16-43                                  15
    dsolve, 1-20, 1-23
    feedback, 15-20                                       natural logarithm, 9-10
    ilaplace, 17-29, A-3                                  negative stiffness, 11-9, 16-22
    laplace, A-3                                          neutral stability, 17-2
    margin, 17-7, 17-24                                   Newton, Isaac, 1-3
    plot3, 17-26                                          Newton's 2nd law, for forces, 1-3, 11-2, 12-2
    pretty, 1-20
    residue, 2-19, 16-16, 16-40                               ..., for moments, 3-4, 11-2
    roots, 12-16, 16-23, 16-43                            Newton's 3rd law, 3-14
    series, 15-20                                         node (nodal point) of a vibration mode, 12-10
    simple, 1-20                                          non-homogeneous solution of an ODE, 1-7
    syms, 1-20, 1-23, A-3                                 nonlinear ODE, 1-2, 1-21
    tf, 15-20, 17-7                                       notation, dot, 1-2
    vpa, 16-40
                                                              ..., matrix, 12-3
                                                          nth order ODE, 4-11, 16-1
                                                          numerical approximate solutions, 6-8, 8-15, 9-14

                                                              ..., convolution sum, 8-15, 9-14
                                                              ..., recurrence formulas, 6-8, 6-10, 6-12
                                                          Nyquist, diagram or plot, 10-11, 17-9
                                                              ..., stability criterion, 17-15, 17-22
                                                              ..., three-dimensional plot, 17-26

                                                          Index-5
Index of all Chapters and Appendices

 O                                                        PID = proportional-integral-derivative, 15-1
                                                          piecewise continuous input function, 6-3
O(105), e.g., order-of-magnitude symbol, 5-9              plane motion, general, 11-3
ocean surface ship, 3-17
ODE = ordinary differential equation, 1-1                     ..., rotation about a fixed point, 11-3
                                                          plant (controlled object or process), 14-1
    ..., 1st order, 1-2                                   plant transfer function (PTF), 14-2, 15-3
    ..., 2nd order, 1-13                                  plausibility check, 1-11, 7-12
    ..., derived from power balance, B-3                  plot3 MATLAB function, 17-26
    ..., derived from transfer function, 16-7             pluck testing, 7-10
    ..., nonlinear, 1-2, 1-21                             pogo stick, 7-19
    ..., nth order, 4-11, 16-1                            polar coordinates r and , 2-3, 11-4
offset, voltage, 10-27                                    polar form, complex number, 2-3
    ..., P control, 15-7
ohm (), unit of electrical resistance, 5-1                    ..., characteristic equation, 16-25
Ohm's law, 5-2                                            poles, of a complex function, 2-6
open loop, 13-2
    ..., control, 14-2, 14-6                                  ..., at the s-plane origin, 17-12, 17-28
    ..., frequency-response function (OLFRF), 17-1            ..., of a transfer function, 4-13, 16-2
    ..., poles and zeros, 16-31                               ..., repeated, 16-8
    ..., transfer function (OLTF), 16-31, 17-1                ..., sub-system, 16-25
operational amplifier (op-amp), 5-9                       polynomial equation, roots, 12-16, 16-3, 16-22
    ..., PI controller, 15-2                              polynomials, multiplication of, 8-26
operations, control, input error, 14-14, 15-1             port, of operational amplifier, 5-9
    ..., output, 14-14                                    position feedback, 14-6
operator setting (reference input), 14-2, 14-4            positive definite matrix, 11-11, 11-15, 12-2
optical encoder, 12-17                                    potential energy, electrical, B-5
ordinary differential equation (ODE), 1-1                     ..., gravitational, B-4
out-of-phase motion, 2-DOF IC response, 12-8                  ..., magnetic field, B-6
out-of-phase, sinusoidal response, 4-6                        ..., of a capacitor, B-5
output, general definition, 1-2                               ..., of an inductor, B-6
    ..., feedback, 14-6, 14-11                                ..., strain, B-2
    ..., impedance, 5-13                                  potentiometer = variable resistor, 5-17
    ..., operations, 14-14                                power, B-1
overdamped 2nd order system, 9-2, 9-20, 9-31, 14-19,      power-balance method, B-3
    15-10                                                 prefixes indicating powers of ten, 3-2
overshoot ratio, underdamped 2nd order, 9-14, 14-20       pretty MATLAB function, 1-20
overshoot, PI control, 15-11                              proof-mass actuator (PMA), 10-28, 10-29, 12-19, 15-5
                                                          propagation of error, 7-21
 P                                                        proportional (P) control, 15-2, 15-6, 15-14
                                                          proportional gain, 15-1, 15-16
pair, Laplace transform, 2-7                              proportional-derivative (PD) control, 15-2, 15-13, 15-
parallel damper-spring low-pass filter, 4-8                   14, 16-6
parallel, electrical components in, 5-3, 5-14             proportional-integral (PI) control, 5-17, 15-2, 15-8
                                                          proportional-integral-derivative (PID) control, 15-1
    ..., mechanical components in, 3-13                   proximity (displacement) sensor, 7-10
parallel-axis theorem, 11-4                               pseudo-static response, 1-17, 7-2, 9-4, 9-27, 11-15,
parameter identification, 3-18                                14-7
partial-fraction expansion, 2-9, 4-12, 15-5, 16-3, 16-5,  PTF  plant transfer function, 14-2
                                                          pulse duration, 1-6
    16-40, A-4                                            pulse, flat, 6-11, 9-32
    ..., direct term, 15-19                                   ..., half-sine, 1-6, 6-4
    ..., repeated poles, 16-8                                 ..., ramped exponential, 1-14, 16-5, 16-8
particular solution of an ODE, 1-7                            ..., sawtooth, 6-12
passive system, 7-1, 16-18                                Pythagoras, theorem of, 16-26
peak time, underdamped 2nd order, 9-14, 14-20
pendulum, simple, 7-2                                      Q
pendulum-spring systems, 11-14, 11-15, 12-14
period, 4-3, 4-8                                          quadratic equation, 2-1, 12-4, 16-12, 16-27
    ..., of damped vibration, 7-11                        quadrature frequency-response component, 17-10
    ..., of sinusoidal signal, 1-17                       quadrature phase, 10-7
phase angle, sinusoidal response, 4-5, 17-3               quality factor Q, 10-6
phase crossover, 17-6, 17-16, 17-18                       quasi-static (quasi-steady) aerodynamics, 11-9, 16-42
phase lead or lag, sinusoidal response, 4-5
phase margin (PM), 17-6, 17-16

                                                          Index-6
Index of all Chapters and Appendices

 R                                                        second (2nd) order system and ODE, 1-13
                                                          seismic motion sensors, 10-24
radian, units in calculations, 3-10                       seismometer, 10-25
radio, tuning circuit, 10-7                               self-correcting control system, 14-6
ramp input, 6-5                                           self-excited systems, 16-19, 16-41
ramped exponential pulse, 1-14, 8-31                      sensitivity of control, to disturbances, 14-5
rate feedback, 14-11
ratio of two polynomials, 2-6, 2-11, 14-10                    ..., to modeling errors, 14-6
RC, band-pass filter, 5-12, 9-21, 9-31, 10-10, 13-1       sequence of length N, 8-16
                                                          series damper-spring, high-pass filter, 4-17
    ..., high-pass filter, 5-12, 5-14
    ..., low-pass filter, 5-4, 5-12                           ..., low-pass filter, 4-16, 5-6
reactance, capacitive and inductive, 10-12
reaction wheel, 3-3, 3-17, 6-5, 7-17, 14-5                series MATLAB function, 15-20
reaction-mass actuator (RMA), 10-28, 12-19, 15-5
reality check, 1-11, 14-5, 15-13, 15-19                   series, electrical components in, 5-2, 5-14
receptance, 10-13                                             ..., mechanical components in, 3-14
rectangular form of complex number, 2-2
recurrence formulas, 6-8, 6-10, 6-12                      settling time, 3-4, 14-20
re-entry vehicle (capsule), 14-3                              ..., 1st order, 3-6, 3-7
reference input (operator setting), 14-2, 14-4                ..., underdamped 2nd order, 9-14
relative stability, 16-18, 17-1
remote (indirect) control, 14-1                           shaker, mechanical vibration exciter, 10-8, 10-30
residue MATLAB function, 2-19, 16-16, 16-40               shear building, 7-22
residues of partial-fraction expansion, 2-9, 16-3, 16-7
resistance, high input, 5-9                                   ..., structural model, 10-30
resistors, electrical circuit components, 5-1             shock strut, 3-13, 4-2
    ..., in parallel, 5-3                                 SI unit system, 3-1
    ..., in series, 5-2
resonance, 10-2, 10-4, 12-13                              simple MATLAB function, 1-20
response, general definition, 1-1
resultant of distributed force, 10-26, 11-7               simple pendulum, 7-9
RHS = right-hand-side, 3-16                               sink, of energy, 16-18, B-3, B-7
right-hand rule, 3-4                                      SISO = single-input-single-output, 4-11, 8-13, 14-8,
right-hand-side (RHS) dynamics, 3-16, 3-19, 5-12, 5-
    14, 6-3, 9-23, 9-30, 10-10, 10-20, 10-21, 10-28, 14-      16-1, 16-42
    18, 15-9, 15-15                                       small damping, approximation, 9-10, 9-24, 10-6, 10-7,
rigid-body plane motion, 11-1
rise time, underdamped 2nd order, 9-13, 9-14, 14-20           10-9
    ..., PI control, 15-11                                small damping, half-amplitude formula, 9-11
robustness of a control system, 14-6                      small rotation, 7-3, 11-5, 11-10
roll (bank) angle of a flight vehicle, 3-8                snapback testing, 7-10, 12-18
rolling, airplane or missile, 3-8                         source, of energy, 16-18, B-3, B-7
root-locus (Evans') method, 16-28                         spacecraft, attitude control, 14-3, 16-36
roots MATLAB function, 12-16, 16-23, 16-43                specifications, step-response, 9-13, 9-14
roots of a polynomial equation, 16-3, 16-22, 16-43        speed (rotor velocity), PI control, 15-17
roots, loci (or locus) of, 16-18                          speed, of control system components, 15-4
rotation, small, 7-3, 11-5, 11-10
rotational (moment of) inertia, 3-3, 7-2, 11-2, 11-4          ..., of system response, 15-3, 15-11
rotational, damper-spring system, 15-2                    spring, artificial, 14-7, 15-14
    ..., inertia-damper-spring system, 11-5
    ..., inertia-spring system, 7-17, 11-7, 11-13, 12-16      ..., close-wound, 7-7
rotational velocity vector, 11-4                              ..., linear, 1-12, 3-11
rotor, 14-1, 15-2                                         stability, 4-13, 14-16, 15-16, 16-1, 17-1
Routh's stability criteria, 16-12, 16-34, 16-38, 16-40    stability, degree of, 16-20
rule, for analysis of op-amp circuits, 5-11                   ..., exponential, 16-3
    ..., of thumb in control design, 15-17                    ..., general criterion, 16-1, 16-2, 16-6
                                                              ..., Routh's criteria, 16-12
 S                                                        stable 1st order system, 3-6
                                                          stairstep approximation, 6-9, 8-19
sanity test, 1-11                                         standard form of ODE, stable 1st order system, 3-6
sawtooth pulse, 6-12                                          ..., damped 2nd order system, 9-3
second (2nd) area moment, 7-12                                ..., any 1st order system, 1-2, 1-19
                                                              ..., undamped 2nd order system, 7-2
                                                          state-space representation of systems, 14-17
                                                          static equilibrium position, 7-7, 11-5
                                                          steady-state output error, offset, 15-7
                                                          steady-state sinusoidal response, 4-1, 4-4, 17-1
                                                          step response, 1st order, 3-5, 3-6
                                                              ..., physical applicability of solutions, 7-6
                                                              ..., overdamped 2nd order, 15-10
                                                              ..., P control, 15-10, 15-14
                                                              ..., PI control, 15-10
                                                              ..., position + rate feedback control, 14-16
                                                              ..., undamped 2nd order system, 7-5, 14-11

Index-7
Index of all Chapters and Appendices

    ..., underdamped 2nd order, 9-12, 13-5, 14-12, 15-    transient response, 3-4
        10                                                translated (in time) function, 8-29
                                                          transmissibility, 10-27, B-13
    ..., specifications, underdamped 2nd order, 9-13, 9-  trapezoid rule of approximate integration, 8-6
        14                                                trigonometric identity, cosine of sum, 4-4
                                                          trimming tab, airplane, 11-13
step-relaxation (twang) testing, 7-10                     tugboat, 3-17
stiffness matrix, 11-12, 12-2                             tuned-mass damper, 10-29
stiffness, dynamic, 10-13                                 twang testing, 7-10, 9-24, 10-29, 11-13, 12-18
                                                          two-degrees-of freedom (2-DOF) systems, 11-10, 11-
    ..., negative, 11-9, 16-22
stimulus, 1-2                                                 13, 11-14, 11-15, 12-2, 12-9, 12-13, 13-7
strain energy, B-2                                        typical-section, aeroelastic model, 11-7, 11-10, 11-14,
strength of materials, 7-12
stroke of a force shaker, 10-30                               12-9, 16-41
structural damping model, internal-friction, B-12
                                                           U
    ..., viscous, B-9
structural unit system, 3-1                               u(t) = input quantity, 1-2
subcritically damped 2nd order system, 9-3                uncommon open-loop system, 17-7, 17-17
sub-system poles, 16-25                                   underdamped 2nd order system, 9-3
summing junction, 13-3                                    undetermined coefficients, method of, 1-7, 1-15, 1-19,
supercritically damped 2nd order system, 9-2, 9-20
superposition, 1-2                                            1-22, 1-23, 1-24
                                                          unit imaginary number, 2-1
    ..., integral, 6-3                                    unit system, absolute, 3-1
    ..., impulse responses, 8-14
sweep, stepped-sine, 10-8, 17-25, 17-26                       ..., gravitational, 3-1
Symbolic Math Toolbox, MATLAB, 1-20, 16-40, A-3               ..., SI, 3-1
syms MATLAB operation, 1-20, 1-23, 16-40, A-3                 ..., traditional aeronautical, 3-1
system ID = system identification, 8-11, 9-18                 ..., traditional structural, 3-1
    ..., aerodynamic coefficients, 3-18                   unit vectors, Cartesian coordinates, 11-1
    ..., LRC circuit by FRF, 10-23                            ..., polar coordinates, 11-4
    ..., m-c-k system by FRF, 10-9, 10-22, 10-23          unit-impulse function, 8-3, 8-13, 8-30
    ..., m-c-k system by pulse, 9-18, 9-29                unit-impulse-response function, 8-13
    ..., m-k system by added mass, 7-22                   unit-step function, 2-13, 8-13, 8-30
system, basic definition, 1-1                                 ..., exponential, 1-23, 8-30, 16-5
                                                              ..., Laplace transform of, 2-13
 T                                                        unit-step-response function, 8-13
                                                          unity feedback, 14-10, 14-18, 14-19
t = time, independent variable, 1-1                       unstable, 1st order system, 3-6
tachometer, 3-17                                              ..., linear drift, 17-14, 17-28
                                                              ..., PD-controlled rotor
    ..., control sensor, 15-17
Taylor power series expansions, 2-3                        V
terminal velocity, 1-21
tf MATLAB function, 15-20, 17-7                           vpa MATLAB operation, 16-40
TF = transfer function, 4-10, 4-12, 4-19                  variable resistor (AKA potentiometer, pot), 5-16
third (3rd) order system, 13-7, 16-13, 16-22, 16-31       vector operations, 11-1
three-dimensional Nyquist plot, 17-26                     velocity (rate) feedback, 14-13
three-DOFs problem, 11-2                                  velocity, terminal, 1-21
thruster, on re-entry vehicle, 14-3, 14-5                 vibration absorber, 12-15
time constant, 1st order, 1-23, 3-5                       vibration isolation, 7-18, 10-26, 12-15, B-12
                                                          vibration testing, sinusoidal, 10-8, 17-3, 17-26
    ..., derivative, 15-1, 15-13, 15-16                   viscous damper, artificial, 14-16, 15-15
    ..., integral, 15-1, 15-11                            viscous damping constant, 1-3, 1-12, 10-9, 14-20
    ..., underdamped 2nd order system, 9-8, 16-20
time invariance, 1-2                                          ..., critical, 9-1, 10-19, 16-34
time lag, 4-4                                             viscous damping law, general linear, 3-12
    ..., artificial numerical, 6-9, 8-25                  viscous damping ratio, 9-1, 9-9, 9-17, 10-3, 10-6, 10-
torque motor, 7-17
transfer function (TF), 4-10, 4-12, 4-19                      9, 13-4, 14-16, 14-19, 15-15
    ..., base-excited m-c-k system, 13-3                  voice coil, 5-8
    ..., closed-loop (CLTF), 13-4, 17-2                   voltage, 5-1, B-5
    ..., damped 2nd order, 10-3
    ..., nth order, 16-2                                      ..., divider, 5-14
    ..., open-loop (OLTF), 16-31, 17-1                        ..., follower, 5-11
    ..., plant (PTF), 14-2                                    ..., generator, 5-3, B-7
    ..., RC band-pass filter, 10-10

                                                          Index-8
                                         Index of all Chapters and Appendices

 W

washboard road, 10-7, 10-21
watt (W), SI unit of power, B-1
wing chord, planform, span, 3-9, 11-8, 16-43
work, B-1, B-5
Wright Flyer, 16-39

 X

x Cartesian coordinate, 1-4, 11-1, 12-10
x(t) = dependent variable, output quantity, 1-1

 Y

y Cartesian coordinate, 7-7, 10-21, 11-1, 12-1

 Z

z = x + jy complex number, 2-1
z Cartesian coordinate, 11-1
zeros, of a complex function, 2-6

    ..., of a determinant, 12-3, 16-43
    ..., of a transfer function, 16-2

                                                 Index-9
