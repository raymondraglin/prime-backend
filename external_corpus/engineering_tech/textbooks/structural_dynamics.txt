Structural Dynamics

   Hilmi Lu, Sinan Keten
          2024-08-30
ii
Table of contents

Preface                                                1

1 Fundamentals of Dynamics                             3

1.1 Basic Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

1.2 Degree of Freedom . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.3 Fundamental Laws . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8

         1.3.1 Newton-Euler Formulation . . . . . . . . . . . . . . . . . . 9

         1.3.2 d'Alembert's Principle and Virtual Work . . . . . . . . . . . 17

         1.3.3 Lagrange's Equations . . . . . . . . . . . . . . . . . . . . . . 22

         1.3.4 Constraint Forces . . . . . . . . . . . . . . . . . . . . . . . . 25

         1.3.5 Wrapping Up . . . . . . . . . . . . . . . . . . . . . . . . . . 37

2 Free Vibrations of Single Degree of Freedom Systems  39

2.1 Motivation and Preliminary Discussions . . . . . . . . . . . . . . . . 39

2.2 The Prototype . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

2.3 Undamped Free Vibrations . . . . . . . . . . . . . . . . . . . . . . . 49

2.4 Damping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

         2.4.1 Viscous Damping Model . . . . . . . . . . . . . . . . . . . . 54

         2.4.2 Estimating Viscous Damping from Free Vibration Data . . . 60

         2.4.3 Energy Dissipated by Viscous Damping . . . . . . . . . . . . 63

         2.4.4 Non-viscous Damping Models . . . . . . . . . . . . . . . . . 65

2.5 Generalized SDOF Systems . . . . . . . . . . . . . . . . . . . . . . . 67

         2.5.1 Continuous Systems . . . . . . . . . . . . . . . . . . . . . . 67

         2.5.2 Discrete Systems . . . . . . . . . . . . . . . . . . . . . . . . 74

         2.5.3 Damping and External Forces . . . . . . . . . . . . . . . . . 79

         2.5.4 Epilogue . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

                            iii
iv  TABLE OF CONTENTS

3 Forced Vibrations of Single Degree of Freedom Systems  87

    3.1 General Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . 89

    3.1.1 Constant Force: Step Input . . . . . . . . . . . . . . . . . . . 92

    3.2 Linearly Increasing Force: Ramp Input . . . . . . . . . . . . . . . . . 95

    3.2.1 Input Shifted in Time . . . . . . . . . . . . . . . . . . . . . . 98

    3.2.2 Constant Load Applied in Finite Time . . . . . . . . . . . . 100

    3.3 Harmonic Force Excitations . . . . . . . . . . . . . . . . . . . . . . . 103

    3.3.1 Dynamic Amplification . . . . . . . . . . . . . . . . . . . . . 104

    3.3.2 Response of Undamped Systems . . . . . . . . . . . . . . . . 110

    3.3.3 Response of Damped Systems . . . . . . . . . . . . . . . . . 113

    3.3.4 Beat Phenomenon . . . . . . . . . . . . . . . . . . . . . . . 114

    3.4 Pulse Response and Impulse Response Function . . . . . . . . . . . . 117

    3.4.1 Rectangular Pulse . . . . . . . . . . . . . . . . . . . . . . . . 118

    3.4.2 Half-Sine Pulse . . . . . . . . . . . . . . . . . . . . . . . . . 125

    3.4.3 Response and Shock Spectra . . . . . . . . . . . . . . . . . . 129

    3.4.4 Impulse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137

    3.5 Force Transmission and Vibration Isolation . . . . . . . . . . . . . . 142

    3.6 Vibrations Induced by an Eccentric Rotating Mass . . . . . . . . . . 145

    3.7 Base Excitation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148

    3.7.1 Response to a Pulse-Like Base Motion . . . . . . . . . . . . 151

    3.7.2 Response to Harmonic Base Excitations . . . . . . . . . . . . 158

    3.7.3 Brief Notes on the Basic Model . . . . . . . . . . . . . . . . 161

4 Numerical Solutions of the SDOF Equation of Motion     163

    4.1 Preliminary Ideas . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163

    4.2 Linear Interpolation of the Excitation . . . . . . . . . . . . . . . . . 164

    4.3 Central Difference Method . . . . . . . . . . . . . . . . . . . . . . . 175

    4.4 Interlude . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184

    4.5 Houbolt's Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189

    4.6 Newmark's Method . . . . . . . . . . . . . . . . . . . . . . . . . . . 195

    4.6.1 General Formulation . . . . . . . . . . . . . . . . . . . . . . 196

    4.6.2 Various Interpretations of Newmark's Method . . . . . . . . 199

    4.7 Numerical Integration for Nonlinear SDOF Systems . . . . . . . . . 202

    4.7.1 Central Difference Method for Nonlinear SDOF Systems . . 204

    4.7.2 Newmark's Method for Non-linear Systems . . . . . . . . . 209

5 Seismic Analysis of Single Degree of Freedom Systems   219

    5.1 Preliminary Concepts . . . . . . . . . . . . . . . . . . . . . . . . . . 219
TABLE OF CONTENTS                                              v

5.2 What Is An Earthquake? . . . . . . . . . . . . . . . . . . . . . . . . . 220
5.3 Measuring the Magnitude Of An Earthquake . . . . . . . . . . . . . 222
5.4 Architectural Considerations in Earthquake Resistant Design . . . . 226
5.5 Earthquake Response Spectra for Linear Systems . . . . . . . . . . . 228
5.6 Characteristics of Response Spectra . . . . . . . . . . . . . . . . . . 234
5.7 Elastic Design Spectra . . . . . . . . . . . . . . . . . . . . . . . . . . 236
5.8 Earthquake Response Spectra for Non-linear Systems . . . . . . . . 239

      5.8.1 Strength Reduction and Ductility . . . . . . . . . . . . . . . 240
      5.8.2 Inelastic Response Spectra . . . . . . . . . . . . . . . . . . . 243
5.9 Wrapping Up . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 250

6 Models for Linear Multi Degree of Freedom Systems            251

6.1 Equations of Motion in Matrix Form . . . . . . . . . . . . . . . . . . 252

6.2 Symmetry of System Matrices . . . . . . . . . . . . . . . . . . . . . 255

6.3 Stiffness and Inertia Influence Coefficients . . . . . . . . . . . . . . 263

6.3.1 Force Equilibrium . . . . . . . . . . . . . . . . . . . . . . . 263

6.3.2 Equivalent Forces and Virtual Work . . . . . . . . . . . . . . 268

6.4 Coordinate Transformations . . . . . . . . . . . . . . . . . . . . . . 270

6.5 Rigid Floor Plate Model . . . . . . . . . . . . . . . . . . . . . . . . . 274

6.6 Shear Building . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 289

6.7 Models for Base Excited Systems . . . . . . . . . . . . . . . . . . . . 292

7 Free Vibrations of Multi Degree of Freedom Systems           303

7.1 Harmonic Motion and the Eigenvalue Problem . . . . . . . . . . . . 303

7.2 Orthogonality of Modes . . . . . . . . . . . . . . . . . . . . . . . . . 310

7.3 Coordinate Transformations and the Eigenvalue Problem . . . . . . 314

7.4 Modal Analysis of Free Vibrations . . . . . . . . . . . . . . . . . . . 315

7.5 Approximations for Frequencies . . . . . . . . . . . . . . . . . . . . 325

7.5.1 Rayleigh's Quotient . . . . . . . . . . . . . . . . . . . . . . . 325

7.5.2 Rayleigh-Ritz Method . . . . . . . . . . . . . . . . . . . . . 329

7.6 Free Vibration Response of Damped Systems . . . . . . . . . . . . . 338

7.6.1 Damping in MDOF Systems . . . . . . . . . . . . . . . . . . 338

7.6.2 Modal Analysis of Classically Damped Systems . . . . . . . . 339

7.6.3 Constructing Damping Matrices in Classically Damped Systems341

8 Forced Vibrations of Linear Multi Degree of Freedom Systems  351

8.1 Modal Analysis for Forced Vibration Response . . . . . . . . . . . . 351

8.1.1 General Flow . . . . . . . . . . . . . . . . . . . . . . . . . . 351

8.1.2 Derived Response Quantities . . . . . . . . . . . . . . . . . 353
vi  TABLE OF CONTENTS

          8.1.3 Harmonic Excitations . . . . . . . . . . . . . . . . . . . . . 357
    8.2 Modal Combination Rules . . . . . . . . . . . . . . . . . . . . . . . 363

          8.2.1 Absolute Sum (ABSSUM) . . . . . . . . . . . . . . . . . . . 365
          8.2.2 Square Root of the Sum of Squares (SRSS) . . . . . . . . . . 366
          8.2.3 Complete Quadratic Combination (CQC) . . . . . . . . . . . 366
    8.3 Response to Ground Motion . . . . . . . . . . . . . . . . . . . . . . 368
          8.3.1 Modal Response to Ground Motion . . . . . . . . . . . . . . 369
          8.3.2 Base Shear and Overturning Moment . . . . . . . . . . . . . 372
          8.3.3 Spectral Analysis and Modal Combination . . . . . . . . . . 376
Preface

This textbook represents our effort to make freely available to students and practition-
ers the theory and common applications of structural dynamics. The presentation is
hoped to inspire interest and active learning. The book's content is expected to evolve
and expand in time so we truly welcome suggestions from readers and colleagues.
To make available in a timely manner, the first upload/edition has been limited topics
that could be covered in a senior level undergraduate or an introductory level gradu-
ate course in a single semester. Given the vastness of the theory and practical details,
such a compromise was inevitable. On the other hand we hope that by continuing to
expand the contents at certain intervals the material will eventually cover a very signif-
icant portion of the relevant literature and current practices. This living nature of the
electronic medium was what motivated us to undertake this project to begin with.
We thank Northwestern University Libraries for their interest in this textbook, and
we express our gratitude to Xinyan Yang for her help in solving many problems we
encountered along the way.
This textbook is published by Northwestern University Libraries, with funding from
Northwestern University's Affordable Instructional Resources initiative.
Copyright © 2024 Hilmi Lu and Sinan Keten. Licensed Creative Commons
Attribution-NonCommercial-ShareAlike 4.0 International (CC-BY-NC-SA 4.0).
Preferred attribution: Lu, H., and Keten, S. 2024. Structural Dynamics. Northwestern
University Libraries.

                                                 1
2  Preface
Chapter 1

Fundamentals of Dynamics

Dynamics focuses on understanding how systems evolve in time. The modern defi-
nition of the term dynamical systems encompasses a broad range of social to physical
systems with time-varying properties, but initially dynamics emerged as the study of
motion of celestial and terrestrial bodies. In the study of such motion, the main ob-
jectives are the modeling of the dynamical system, i.e. formulating the equations that
govern the motion of the system, and the prediction of response parameters that are to
be observed during the motion, i.e. the solution of the equations of motion. The basic
principles that govern the investigations to be presented in this text are the fundamen-
tal pillars of classical mechanics.
Classical mechanics differs from relativistic and quantum mechanics on a few funda-
mental assumptions pertaining to motion. A system is described as classical if all mo-
tion investigated occurs at speeds much less than the speed of light so that relativistic
effects may be neglected. At the length and time scales relevant to classical mechanics,
quantum effects such as those that require explicit description of the dynamics of elec-
trons are deemed negligible as well. We will assume both restrictions to hold for all
the systems to be investigated throughout this text. In this introductory chapter, we
will review some of the basic principles of classical mechanics upon which the theory
of structural dynamics rests.

1.1 Basic Definitions

The fundamental framework that will be used throughout will be Newtonian and there
are certain a priori concepts in this framework that we generally take for granted.

                                                 3
4  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

In classical mechanics, motion of a body is geometrically described by the positions
(locations) of its constituents in space, and the variation of these positions in time. The
existence of space and time as two independent, `absolute' entities are accepted without
proof; these are intuitive concepts that lay the foundations for all that is to follow, as
the geometric description of motion depends solely on these two concepts.

To define the position of an object, we need a reliable reference, for instance a station-
ary set of rigid "rulers" against which to measure distances, and a clock with which
to measure time. Such a combination is called a frame of reference. The acceptance of
space and time as absolute quantities is equivalent to assuming the existence of at least
one inertial frame of reference in which the laws of motion as stated by Newton are valid.
In fact, any reference frame that is in a state of pure translation with constant velocity
relative to this initial, absolute(ly standing still) frame would serve equally well as an in-
ertial frame of reference. The key here is to use a non-accelerating (with respect to the
`absolute' space) frame of reference. Motion on a curved line, even with constant speed,
and rotations lead to centripetal accelerations and hence reference frames undergoing
such motions will generally not serve as inertial frames.

But then again, the earth, of course, is one such rotating and translating frame. So how
come we use it, as we do in most earthbound dynamical analysis in engineering, as our
frame of reference? The answer to this may not be given a priori but the validity of
the choice must be evaluated a posteriori. It may be said that for many earthbound
problems that involve distances and time spans comparable to those we commonly
encounter in our everyday experiences, treating the earth as an inertial frame does not
lead to significant errors, at least not significant enough to have any impact on the
predictions deduced. We accept to err but we hope it is inconsequential. Hoping to
err less, we can take into account the earth's rotation about its polar axis, then expand
further to take into account the earth's rotation around the sun, then expand further to
include the motion of the whole solar system in the milky way, then expand ... How far
one should go will depend on the specific problem studied. Unless otherwise explicitly
stated, we will assume that the reference frames we use in our discussions are inertial
(or may be treated as such for the particular problem at hand).

Mass is another prior that we take for granted based on our experiences with weight.
One definition of mass is to say that it is a measure of a body's resistance to motion.
This definition does implicitly refer to Newton's equation of motion - force is equal to
mass times acceleration - but it serves to hint at a difference between what are called
gravitational mass and inertial mass. No difference between these two have been de-
tected experimentally and so mass as far as we are concerned will be the quantity of
matter that we can measure through its weight.
1.2. DEGREE OF FREEDOM  5

A fundamental idealization of dynamics is that of a particle, a geometric point, devoid of
size but endowed with mass. The fundamental Newtonian law governing the motion
of a particle is the well known (more on this later)

                                             f = a

with  denoting the mass of the particle, a denoting its acceleration, and f denoting
the resultant force acting on the particle. Please note that this is a vector equation,
with underlined miniscule roman letters denoting vectors and italic miniscule roman
letters denoting scalar variables. This is a convention we will adhere to throughout the
text.

A body may be defined as a collection of particles. Legitimate objections are raised
against this definition challenging the coherency of extending a geometrically non-
dimensional entity to a geometrically finite dimensional system, and it may be pre-
ferred to define a body through a continuous medium to address this issue. If the dis-
tances between the particles are constant throughout the motion, or in other words if
there is no deformation in the body, then the model is called a rigid body. The rigid body
is another fundamental idealization of dynamics, used in the analysis of many problems.
The main advantage brought about by this idealization is the significant reduction in
the number of variables required to describe motion. Whenever deformations may be
estimated to be negligible compared with the size of the body and such deformations
have very limited impact on the motion of the whole, the body may be idealized as rigid
to analyze its overall motion.

1.2 Degree of Freedom

We define the degree of freedom of a system to be the number of independent ways a sys-
tem may move; equivalently, it is the dimension of the system's configuration space.
Mechanical systems may translate and rotate. A particle unconstrained in any way has
three degrees of freedom as it can, for example, translate independently along the three
coordinate axes of a rectangular coordinate system. Consider now two particles, con-
nected by an inextensible rod: even though one needs 6 coordinates to locate both par-
ticles, these coordinates are not all independent since the inextensible rod will always
make sure that the distance between the particles will not change, and so the particles
may not move independently. In this case, then, the system of two particles will have a
smaller number of degrees of freedom. A constraint is any kinematic relationship that
prescribes limitations on the motion of the system or any of its parts; the inextensi-
bility of the rod in the two particle system, enforcing that the distance between the
6  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

particles remains constant, is a constraint. Such constraints may be in the form of alge-
braic equations, in which case they are called holonomic, or they may be in differential,
non-integrable forms, in which case they are called non-holonomic. We limit all our
discussions to holonomic systems.

Generalized coordinates are the specific variables that are used to describe the motion;
accordingly, any kinematic quantity pertaining to a system (such as the position, veloc-
ity and/or acceleration of any point in the system) may be expressed as functions of
the generalized coordinates (and their derivatives) chosen to model that system. The
choice of generalized coordinates for a specific system is not unique and different sets
of variables may serve equally well to formulate the system's dynamics. The term gen-
eralized is historically used to note that these variables do not necessarily have to be
directly associated with a coordinate basis. For any system with holonomic constraints
one can always find a set of independent generalized coordinates, as many as the degree
of freedom of the system, to describe all of kinematics.

       Figure 1.1: Particle constrained to move on a circle lying on the -plane.

To elucidate these definitions, consider, for example, a particle constrained to move on
a circular path as shown in Figure 1.1. Assume that the circular path's center is located
at ( = 0,  = 0,  = 0) so that the path lies on the -plane. Then at any time  the
particle is constrained to move on the -plane so that:

                                        () = 0 

This is a constraint equation. The second constraint equation for this particle would
have to specify that it is moving on a circular path of radius :

                                 2() + 2() = 2 
1.2. DEGREE OF FREEDOM  7

What remains is essentially just one degree of freedom (the particle may only rotate
about the -axis while it remains in the -plane), and the particle's position can be
located with only one generalized coordinate. For example, if one knows the value
of () at some time  then the other two rectangular coordinates may be calculated
via the constraint equations as () = 0 and () = ±2 - 2() (the sign is
surprisingly not trivial but we'll not dwell on it). One could easily well choose ()
as the independent variable and treat the others as dependent. Better yet, one could
define the angle 0  () < 2 between the line  and the -axis as the generalized
coordinate, so that knowing () one can locate wherever the particle is on the circle.
In any case, for the single particle system of this example, its degree of freedom is

                   3 - (number of constraint equations) = 3 - 2 = 1

If the system comprises  particles and there are  many constraint equations, then
the degree of freedom  of the system is given by

                                           = 3 - 

             Figure 1.2: A rigid body constrained to move on the -plane.

It may be shown that an unconstrained rigid body has 6 degrees of freedom. Generally
the motion is described through translations of a single point, most often the center of
mass which we will denote by cm, and three rotations of the rigid body about that point.
If the rigid body is constrained so that its motion is planar1, as seen in Figure 1.2, then

    1Planar motion is the name given to motion of rigid bodies in which the velocity (vector) of any point
on the rigid body always remains parallel to a fixed plane.
8  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

at most 3 degrees of freedom are possible. The location of all points on such a rigid
body may be determined by tracking the translation of one point on it and the body's
rotation about the axis perpendicular to the plane in which that translation takes place.

In holonomic systems use of the phrases `generalized coordinate' and `degree of free-
dom' tend to intertwine such that `degree of freedom' is sometimes used to refer to a
specific generalized coordinate and the phrase `number of degrees of freedom' is used
to signify our original definition of degree of freedom. We'll try to maintain the distinc-
tion but say that a system has  degrees of freedom (that it is an  -DOF system), if 
independent variables suffice to completely describe the configuration of the system,
and we will need  generalized coordinates to model the dynamics. To emphasize
the independence of the generalized coordinates from specific coordinate systems, it
is customary to denote a generalized coordinate by the letter . Employing this sym-
bolism and based on the terminology elaborated above, if, in this text, a system is said
to have  -DOFs, then its dynamics will be governed by the  generalized coordinates

   1(), 2(), ... ,  ()

1.3 Fundamental Laws

Formulating the governing equations of motion for any system in classical mechanics
is possible through a few different formulations and principles that may be shown to
be equivalent. Throughout this text we will employ the Newton-Euler formulation,
the virtual work formulation with d'Alembert's principle, and/or the Lagrangian for-
mulation. In this section we will present the fundamental issues without going into the
details of the derivations for which the reader may consult various books on classical
mechanics.2 It is important to note that the differences that will strike the reader are
more procedural than essential in that all formulations will lead to identical (possibly
up to a linear transformation) equations of motion for a given system. The choice of
which method to use in the context of a specific problem is generally a matter of ease
of application, personal experience and preference.

    2see, for example, H. Goldstein's Classical Mechanics, first published in 1950 by Addison-Wesley Pub-
lishing Company, or D.T. Greenwoods's Classical Dynamics, first published by Prentice-Hall in 1997.
1.3. FUNDAMENTAL LAWS        9

1.3.1 Newton-Euler Formulation

It is only natural to start with this formulation since historically Newton3 is the first
scientist to have formulated some laws of motion, still used today, in a rigorous, math-
ematical manner and apply them for the solution of various problems. These laws as
stated by Newton read as follows:

    I) Every body perseveres in its state of rest, or of uniform motion in a right line,
       unless it is compelled to change that state by forces impressed thereon.

   II) The alteration of motion is ever proportional to the motive force impressed; and
       is made in the direction of the right line in which that force is impressed.

  III) To every action there is always opposed an equal reaction: or the mutual actions
       of two bodies upon each other are always equal, and directed to contrary parts.

It is generally accepted that by body, Newton implies a particle or a finite sized body
that could be treated as a particle; by motion, what we currently call (linear) momentum,
i.e. the product of mass with velocity.

The first law is essentially a statement about the existence of an inertial frame in which
the second law is applicable, and defines uniform motion (motion with a constant ve-
locity along a straight line) as a state equivalent to that of rest.

The second law, in modern vectorial notation, postulates

                       f = d L = d(v) = a (1.1)
                       d  d

where the last equality follows for closed systems in which there is no mass transfer in
and out of the system boundaries so that  is constant in time. We have introduced the
notation L = v to denote the linear momentum of a particle and we will use the same
notation when we are talking about the linear momentum of a system comprising more
than one particle. It is important to emphasize again that the velocity v of the particle
is measured in an inertial frame, as is its acceleration a; otherwise, this law does not
hold in its current form.

The third law states that when two particles interact, they do so through a pair of forces,
equal in magnitude but opposite in direction, acting along the central line hypotheti-
cally connecting the two particles; its validity is generally accepted unless the velocities

    3I. Newton, Philosophiae Naturalis Principia Mathematica, or simply the Principia as it has come to be
known. The original, published in 1687, is in Latin and here we will be quoting from its translation by
A. Motte, specifically the version published in 1846 in New York by D. Adee.
10  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

considered are so large that the velocity of propagation of interaction may have to be
taken into account. In structural dynamics we assume this law is always valid.

The generalization of the laws of particles to bodies of finite sizes is generally attributed

to Euler, who discussed governing equations of motion of rigid bodies in various works
starting in the 1750s4 until the middle of the 1770s5. To somewhat economize on the
notation, let us denote time derivatives by dots placed over the variables so that  de-
notes the first derivative in an inertial frame, with respect to time, of some variable ,
and  denotes its second derivative. In modern language, the laws governing the dy-

namics of a closed system of particles, including rigid bodies, may be expressed as follows:

    I) Principle of Linear Momentum: The time derivative of the linear momentum of
       a system of particles is equal to the net resultant force of all the external forces
       acting on the particles composing the system. In a closed system with total mass
       , this law may be stated as:

    L = f = acm         (1.2)

    where acm is the acceleration of the center of mass of the system and the last
    equality will be demonstrated below.

    II) Principle of Angular Momentum: The time derivative of the angular momentum of
        a system of particles, with respect to a stationary point  or the center of mass of
        the system cm, is equal to the resultant moment at the same point all the external
        forces acting on the system:

    H = M or Hcm = Mcm  (1.3)

    where H and Hcm are the angular momenta of the system about points  and cm,
    respectively, and M and Mcm are the resultant moments of the external forces
    and couples at the same points.

There are many details involved in applying these principles to a specific system but it
may be best to define some of the quantities specified in these laws through illustration.

Consider the rigid body  shown in Figure 1.3.6 An arbitrary point on the rigid body,
having an infinitesimal mass d, is located at position r at some time , relative to a

    4L. Euler, "Découverte d'un nouveau principe de mécanique." Mémoires de l'académie des sciences de

Berlin, Vol. 6, pp. 185-217, 1752.
    5L. Euler, L, "Nova Methodus Motum Corporum Rigidorum Determinandi." Novi Commentarii

Academiae Scientiarum Petropolitanae, Vol. 20, pp. 208-238, 1776.
    6To minimize the details, we just discuss the expressions that pertain to rigid bodies. Most of the

results discussed, in particular the fundamental laws, are valid for systems comprising discrete particle

masses, with summations over all the particles replacing the integrals pertaining to rigid bodies.
1.3. FUNDAMENTAL LAWS                      11

stationary observer in an inertial frame of reference. The linear momentum of this
infinitesimal piece is defined as v d, where v = r is the (absolute) velocity of d in
the inertial frame. The linear momentum of the whole body is then defined as the sum
(integral) of the linear momenta of all the infinitesimal masses:

                           L   v d         (1.4)

                              

The center of mass of a system of particles turns out to be a significant point of refer-
ence. The location of the center of mass of the rigid body  relative to a point, say in
this case the stationary point , is defined through

                           rcm   r d =  r d (1.5)
                              d         

                            

where  is the mass of the whole body. For a closed system with no mass transfer and
constant mass, the direct time derivative of this expression may be used to define the
velocity and acceleration of the center of mass in the inertial frame of reference as

                           vcm =  v d  , acm =  a d  (1.6)

where a is the acceleration of the infinitesimal mass d in the inertial frame. With
these definitions, the linear momentum of the whole body may be shown to be equal
to

                           L =  v d = vcm  (1.7)

                           

and that its time derivative in the inertial frame may be shown, using Newton's second

and third laws, to yield,

                           L = acm = f     (1.8)

where f is the force resultant of all the external forces. The principle of linear mo-
mentum for a rigid body therefore boils down to the analysis of a single hypothetical
particle, of mass equal to the total mass of the rigid body, which is located at the center
of mass of the body and onto which acts the force resultant of all the external forces
that act on whole rigid body.

Angular momentum is defined as the "moment of momentum". The angular momen-
tum of the infinitesimal mass d, relative to a stationary point , is therefore defined
12    CHAPTER 1. FUNDAMENTALS OF DYNAMICS

    Figure 1.3: An arbitrary rigid body.

as r × v d, and the angular momentum of the whole body is given by

    H   r × v d                                                     (1.9)

      

It may be shown, using Newton's second and third laws, that the time derivative of the
angular momentum in the inertial frame yields

      H = M                                                         (1.10)

where M is the resultant moment, at point , of all the external forces and couples.7
It turns out that even though cm is in general non-stationary, the principle of angular

momentum leads to analogous results when cm is taken as the reference point. If the
position of the infinitesimal mass d relative to cm is denoted by R, then the angular

momentum of the rigid body with respect to its center of mass may be defined in two

equivalent ways as

    Hcm =  R × v d =  R × R d                                       (1.11)

             

where the last equality is not immediate but may quickly be arrived at through the def-

    7Note that moment of a momentum (angular momentum) or a force will depend on the point with
respect to which it is calculated. The angular momentum of a particle with respect to some point is in
general not equal to its angular momentum with respect to some other point. This is not the case for
linear momentum in that a particle will have a unique linear momentum in a given inertial frame.
1.3. FUNDAMENTAL LAWS                                                                                             13

inition of the center or mass.8 It may be shown that the time derivative, in the inertial

frame, of the angular momentum with respect to the center of mass leads to a result

analogous to Equation 1.10:                     Hcm = Mcm

                                                                                                               (1.12)

For general three dimensional motion of a rigid body, the principle of angular momen-
tum will in general lead to nonlinear first order differential equations in angular veloc-
ities. For the simpler case of two dimensional motion, however, the equations simplify
significantly: it may be shown that for a two dimensional rigid body motion that takes
place in some plane with normal n, the principle of angular momentum leads, through
Equation 1.10 or Equation 1.12, to a relationship of the form

                    n = n or cmn = cmn                                                                         (1.13)

where  and cm are moments of inertia9 of the body, with respect to the axes perpen-
dicular to the plane at points  and cm, respectively,  is the angular velocity (rate of
rotation) of the body, and its time derivative  is the body's angular acceleration.

To present an application of this formulation, let us work on deriving the equation

of motion of a pendulum made of a rigid, homogeneous bar, as shown in Figure 1.4(a).
The bar has mass per unit length  and total mass  = . It is pinned to a stationary
point  (in an inertial frame) and is acted upon by gravity g along the vertical direction,

directed downward. This is a single degree of freedom since essentially the only thing
that the whole body may do is rotate about point ; therefore, knowing, for example,
the angle  the bar makes with the vertical, it is possible to locate all the points in the
body and hence define its configuration. Let us choose this angle  as our generalized

coordinate and formulate the equation of motion of the bar in terms of this variable.

One of the fundamental steps in the analysis of dynamical problems is the sketch of
appropriate free body diagrams, which is an isolated sketch of the body, from which all
geometric constraints are removed but the constraint forces are shown, along with all
other external forces and geometrical dimensions. There is, however, a difference in
the analysis of most systems in static equilibrium and the analysis of systems moving.
When analyzing static equilibrium problems in structural mechanics, especially those

8As R is essentially the relative velocity of d with respect to cm in the inertial frame, the last in-

tegral is sometimes referred to as the relative angular momentum. The difference may be important for

an arbitrary reference point but for the center of mass the two integrals in Equation 1.11 yield the same

result.                                                                                                        2

9Recall  that  the  moment  of  inertia  of  a  body    with  respect  to  some  axis  is  defined  as            d

where  is the distance between the axis and d.                                                               
14  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

    Figure 1.4: A homogeneous bar pinned to an inertial frame.
1.3. FUNDAMENTAL LAWS                                                     15

focusing on linear elastic systems, the free body diagrams are often sketched assuming
that the systems retain their initial configuration.10 The premise is that when displace-
ments remain comparatively very small, it may be assumed that the difference between
the deformed and the undeformed configurations will be negligible, and that equilib-
rium analysis may be conducted using the undeformed configuration. When motion is
analyzed, however, the free body diagram must necessarily be sketched for a displaced and
deformed configuration such that all forces that act on the system, some of which may
be caused or modified by the motion itself, may be observed. We generally consider
an instant such that the the generalized coordinates and their time derivatives have
non-zero, positive values to ensure consistency in algebraic signs of variables.

The free body diagram of our bar is shown in Figure 1.4(b). Included in this figure are

the unit vectors we will employ in our formulations, n and t, which are attached to
the bar and hence are moving with it.11 With the third unit vector k defined through
k = n × t, we have a right handed orthogonal vector basis, with the angular velocity
expressed as  =  k.

Since this is a single degree of freedom system, all kinematic quantities should be ex-
pressible in terms of . The center of mass of the bar will be located at the middle of
the bar since the bar is homogeneous, and its acceleration may be derived as

        
rcm = n

        2

                         
vcm = n = ( × n) =  t
   22                    2

                              2 
acm =  t +  t =  t + ( × t) = -  n +  t
   22 22                      2  2

The principle of linear momentum for this system may now be expressed as

2          
acm = -  n +   t = f = (g cos  - ) n + ( - g sin ) t (1.14)
2          2

These two equations, one for each direction, include three unknowns: ,  and . A
third equation may be obtained via the principle of angular momentum. To apply this

   10Some systems do in fact require that deformed configuration be considered in static analysis as

well but structural analysis of many systems do indeed consider small deformations and deformation

gradients so that force equilibrium is established in the undeformed configuration.
   11When unit vectors are rotating in an inertial frame, their time derivatives are non-zero since their

direction changes. If u is such a unit vector which is rotating with angular velocity $ $ in an inertial
frame, then its time derivative in that frame is given by u =  × u.
16        CHAPTER 1. FUNDAMENTALS OF DYNAMICS

principle to the system at hand, we may either try to evaluate the time derivative of the
angular momentum from basic principles, or use previously derived results regarding
moments of inertia. To go over the steps involved, let us choose the first option and try
to find out the angular momentum of the system relative to the stationary point . The
infinitesimal segment d =  d shown in Figure 1.4(c), located at r =  n relative
to , has velocity v =  t so that its angular momentum is given by

                         r × v d = 2(n × t) d = 2 d k

When integrated over the whole bar, the angular momentum of the system about point
 will be obtained as

                                  2  3 2     3  3                               (1.15)
    H =  r × v d =    d k =  k =  k
          0

Noting that the unit vector k maintains its magnitude (unit vector by definition) and
direction at all times, the time derivative of the angular momentum yields

          H = 3  k 2                                                            (1.16)

and the principle of angular momentum gives

    H = M  3  k = - 2 g sin  k 2                                                (1.17)

so that the equation of motion governing the time evolution of  is found to be

    2  = -  g sin    + 3g sin  = 0                                              (1.18)
    3  2                                     2

Point  was a somewhat obvious choice to refer to since the unknown reaction forces

 and  do not contribute to the resultant moment at  and hence an equation ad-
dressing only  is constructed directly.

The Newton-Euler approach and the other methods that we will discuss differ mainly
in this initial step, i.e. constructing the governing equation of motion. The solution
procedure is likely to proceed as follows: the governing equation of motion,

           + 3g sin  = 0                                                        (1.19)
               2

will have to be solved to find (). As this is a second order nonlinear differential equa-
tion, its solution is not trivial. On the other hand, if the motion takes place in the
1.3. FUNDAMENTAL LAWS                                    17

vicinity of the equilibrium configuration so that  and  remain relatively small, then

sin  may be approximated by sin   , and the linearized equation of motion will be

obtained as             + 3g  = 0
                            2
                                                         (1.20)

Once () is obtained, the unknown reaction forces may be calculated via the principle

of linear momentum.

1.3.2 d'Alembert's Principle and Virtual Work

Even though it is within the realm of the Newton-Euler formulations, d'Alembert's
principle has proven to be quite a useful rephrasing, especially for those well trained
in static analysis. There are slightly different variations of the statement and here we
phrase it in the form most conducive to static analysis tools: If one considers a hypotheti-
cal force to act on a particle, acting in opposite direction to the particle's acceleration and with
magnitude equal to the product of the particle's mass with its acceleration, then the particle
would be in static equilibrium instantaneously under the joint action of this hypothetical force
and all the external forces acting on it.

For a single particle, this statement amounts to saying

                       f - a = 0                         (1.21)

where it seems the only thing we have done is to move the right hand side of Equa-
tion 1.1 to the left of the equality sign. While it may be so, the emphasis is not on the
algebra but rather on the treatment of the problem.

The real benefit of this rephrasing will generally be more pronounced for systems of
rigid bodies. For ease of reference, let us call the aforementioned hypothetical force
the d'Alembert force. When the corresponding d'Alembert forces are acted on at each
point in a system of particles or even a rigid body, each particle, and consequently the
whole system, will instantaneously be in a state of static equilibrium. It may be shown
that when these forces are taken into account, one can write the following equations
for the instantaneous static equilibrium of a two dimensional rigid body:

                     f - acm = 0,    -  = 0              (1.22)
                                            or

                                   cm - cm = 0

The term -acm is the force resultant and - is the moment resultant, at point , of
all the d'Alembert forces that should be acting on the system; similarly, -cm is their
moment resultant at point cm.
18  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

    Figure 1.5: Accelerations and d'Alembert forces on the rigid bar pendulum.
1.3. FUNDAMENTAL LAWS                                                           19

Let us go back to the pendulum example, sketched again in Figure 1.5. The acceleration

of the infinitesimal piece of mass d, located at a distance of  to the stationary point
 is given by12

                       a = -2n + t

and the components are shown in Figure 1.5 (a). For each of these infinitesimal seg-
ments, we could add the corresponding d'Alembert forces so that each segment may be
considered to be instantaneously in static equilibrium. When all the d'Alembert forces
are included in the free body diagram, as shown in Figure 1.5 (b), the whole system may
now be considered to be in static equilibrium at the instant considered. The d'Alembert
forces shown with dotted lines and arrows are distributed loads per unit length, acting
in the directions indicated by the arrows. Therefore we now have, from static equilib-
rium equations,

  = 0   - 12 ()() - g sin  = 0                                                  (1.23)

                       1  2
  = 0   - ( )() - g cos  = 0                                                    (1.24)
                       2                                                        (1.25)

  = 0  - 2 g sin  - 2 1 3 2 ()() = 0

which leads, after some rearranging, to the following equation of motion for :

                        - 3 g sin  = 0                                          (1.26)
                            2

It must be noted that this equation is identical to Equation 1.19.

d'Alembert's principle finds its full potential when virtual work is used in complex sys-
tems usually involving multiple degrees of freedom. In order to focus on the general
principle we will define and briefly present the application of the virtual work approach
to the simple pendulum problem we have been studying, but there will be ample oppor-
tunities to revisit the principle in latter chapters.

In modern language, the principle of virtual work states that if a system is in static equilib-
rium, then the internal virtual work that would be done by the system, if it were to go through

   12One can start with the position vector r = n, take its time derivative to get to the velocity as
v = r = n = ( × n) = t, and then take the time derivative of the velocity to get a = v =
t +  = -2n + t. Note that the time derivative of  is zero on virtue of the body being rigid

so that the distance between any two points on the body does not change with time.
20        CHAPTER 1. FUNDAMENTALS OF DYNAMICS

some virtual displacements and deformations consistent with the imposed constraints, would
have to be equal to the work done by the external forces as the system moves through such dis-
placements and deformations. This statement is more appropriately called the principle
of virtual displacements; there is also an alternative statement of virtual work in which
the forces rather than the displacements are fictitious. Since we want to emphasize the
concept of work, we will refer to the more general principle of virtual work.13

To apply the principle of virtual work to our rigid bar pendulum, we must consider a
virtual variation in the generalized coordinate . Let us denote this virtual variation as
, as shown in Figure 1.6. Since the inclusion of d'Alembert forces allows us to treat

the dynamic problem as an equivalent static problem, the principal of virtual work

leads to

           =                          (1.27)

where  is the virtual work done by the internal forces during the virtual displace-
ment , and  is the external forces during the same virtual displacement.

Since the bar is rigid and there is no deformation in any of the components during the
virtual displacement, the internal virtual work is zero for the system., i.e.  = 0.
As for the external virtual work, the only external forces that will do work during the

virtual displacement are the tangential d'Alembert forces and the tangential component
of the weight. The reaction forces  and  do no work since no displacement results
at the point of application of these forces during the virtual displacement: this is a

direct consequence of our choice of imposing virtual displacements consistent with the

kinematic constraints. The d'Alembert forces along the radial direction will do no work
either since the displacements that will occur, due to the virtual displacement , at the

points of application of these forces will be perpendicular to the forces; the same is true

for the radial component of the weight of the bar. Since the single force resultant of the
triangular distribution of tangential d'Alembert forces is given by 2/2 = /2
and this resultant acts at a distance 2/3 to the center of rotation, as shown in Figure 1.6
(b), the virtual work done by the external forces as the bar goes through  is given by

                2
           = -(g sin ) ( ) - ( ) ( )
          2    2  3

where we have assumed  is small enough so the paths travelled by the points of appli-
cation of the forces involved, which would be circular arcs for large values of , may

   13"Virtual," because this is essentially a thought experiment; these displacements and deformations do
not actually take place in some finite time as real displacements do, they are assumed to hypothetically
take place with time frozen at some instant. Although not absolutely necessary, the virtual displacements
and deformations are generally taken to be (very) "small" so that the geometry is not highly deformed
during these deformations, and the variations in the force field do not alter conditions of equilibrium.
1.3. FUNDAMENTAL LAWS                                     21

Figure 1.6: The bar going through virtual displacement .
22        CHAPTER 1. FUNDAMENTALS OF DYNAMICS

be approximated by straight lines of the tangents, given by /2 and 2/3. The
principal of virtual work for this system therefore leads to

             2
     = - (g sin  +  )  = 0
          2  3

and since this result must be valid for arbitrary values of , the term in the parentheses
must be zero, leading to

     2  + g  sin  = 0   + 3g sin  = 0
    3  2        2

The final equation is, of course, identical to the ones previously derived through alter-
native methods.

1.3.3 Lagrange's Equations

Lagrange14 is credited for transforming mechanics from the realm of geometry to the
realm of analysis in his seminal work `Analytical Mechanics' published almost exactly
after one hundred years from the Principia. His equations of motion, referred to as
Lagrange's equations, may be derived via virtual work and d'Alembert's principle, as
well as the principle of least action. In this section we will not provide the derivation
of these famous equations but will just aim to highlight the fundamental issues and
equations.

At the heart of Lagrangian formulation is the concept of energy. Let us assume that a
(holonomic) system has  -DOFs, with its kinematics defined by generalized coordi-
nates 1, 2, ... ,  . The kinetic energy  of the system will in general be an explicit
function of these generalized coordinates as well as their time derivatives, called the
generalized velocities, and possibly also of time:

                           = (1, 2, ... ,  , 1, 2, ... ,  , )

The forces that act on the system are generally classified as those that may be derived
from a potential, i.e. conservative forces, and those that may not, i.e. non-conservative
forces. The potential  of the conservative forces will in general will be an explicit
function of the generalize coordinates and possibly also of time:

                                    = (1, 2, ... ,  , )

   14J.L. Lagrange, Mécanique Analytique, 1788. A famous quote from his preface to the first edition
is: "No figures will be found in this work. The methods I present require neither constructions nor
geometrical or mechanical arguments, but solely algebraic operations subject to a regular and uniform
procedure." We quote from the English translation by A. Boissonnade and V.N. Vagliente, 1997.
1.3. FUNDAMENTAL LAWS                                        23

If there are no non-conservative forces acting on the system, then Lagrange's equations
may be expressed in the following form:

d () -  +  = 0             for  = 1, 2, ... ,                (1.28)
d   

Note that these represent  equations, one for each generalized coordinate
 = 1, 2, ... ,  , but each equation may contain all the other generalized coordinates
as well so that the resulting equations are in general coupled.

If there are non-conservative forces as well, then the equations in Equation 1.28 will
have to be modified. Let  denote the work done by the non-conservative forces

during virtual displacements 1, 2, ... ,  . In a holonomic system this work will

be a simple linear function of the virtual displacements that may be expressed as

 = 11 + 22 + ... +  

where the coefficients of the virtual displacements, , are called generalized forces. It
may be shown that in this case, Lagrange's equations will be of the form:15

dd (   ) -  +  =      for  = 1, 2, ... ,                     (1.29)

Finally, using the Lagrangian , defined conventionally as  =  - , the equations
may also be expressed as

dd (   ) -  =     for  = 1, 2, ... ,                         (1.30)

since  is not a function of the generalized velocities .

Before discussing further details, let us apply this approach to the rigid bar pendulum

we have been studying. Consider the sketch shown in Figure 1.7. The velocity of an
infinitesimal segment of the bar, located at a distance  to the center of rotation , is
given by v =  t. The kinetic energy of this segment will then be equal to 12 (v 
v) d = 12 (v  v) d. The kinetic energy of the whole bar is calculated by summing
the contributions of all the segments that make up the bar so that

  =  1  (v  v) d =   22 d = 2 2
02                     02                                 6

   15Generalized force are not necessarily actual forces; if the generalized coordinate is a rotation, for
example, the generalized force will have units of moment.
24                                         CHAPTER 1. FUNDAMENTALS OF DYNAMICS

As for the potential energy, we first note that the conservative force acting on the sys-

tem is the weight. Let us assume that the potential energy of the system when  = 0 is

some unknown value ; there is always the possibility that the system possesses some

potential even if it is not moving but this initial value would have to be independent of

the generalized coordinates. As the bar moves, the center of mass, which we assume to

coincide with the center of gravity when the variations in the gravitational field may
                                           ( 2     
be  neglected,  rises  by  an  amount  of       -  2  cos ),  and  so  the  potential  energy  of  the

system at some arbitrary instant is given by:

                                =  + g ( 2 - 2 cos )

                           Figure 1.7: Rigid bar pendulum revisited.

Note that there are no non-conservative forces acting except perhaps the constraint
forces, i.e. the support reactions  and . One of the characteristics of the La-
grangian approach is that such constraint forces never do work through any virtual dis-
placements so that constraint forces never contribute to the generalized forces. There-
fore we may simply use the form of the Lagrange's equations given by Equation 1.28
for this system. Evaluating the individual terms yields

     = 2 ,                     d (  ) = 2 ,            = 0,             = g sin 
     3                         d                3                       2
1.3. FUNDAMENTAL LAWS                                    25

so that Equation 1.28 leads to:

               2  + g sin  = 0   + 3g sin  = 0
               3           2                          2

When working with rigid bodies, it may not be necessary to calculate the kinetic energy

from basic principles. In fact, it may be shown that the kinetic energy of a rigid body

may be expressed as              1                 1

                            = (vcm  vcm) + Hcm  2  2     (1.31)

where  is the total mass of the body, vcm is the velocity of the body's center of mass,
Hcm is the body's angular momentum about its center of mass, and  is its angular
velocity. When the body is planar, as for example we may assume a floor plate to be,

with planar dimensions much bigger than the depth and the plate moving in that plane,

the kinetic energy expression will simplify to

                                       12 1 22  2        (1.32)
                                  = cm + cm

where cm is the speed with which the center of mass moves, cm is the moment of

inertia of the body about the axis perpendicular to the plane of motion and passing

through point cm, and  is the angular speed. Finally, if the planar body is simply

rotating in a plane about a fixed point , then the kinetic energy expression further

simplifies to                        = 12 2

                                                         (1.33)

where  is the moment of inertia of the body about the axis perpendicular to the plane

of motion and passing through point . Since the moments of inertia of most regularly

shaped homogeneous bodies are tabulated in many references, the use of these expres-

sions may be most beneficial. For example, if we look up the moment of inertia of a

homogeneous rod, of length  and total mass , about a perpendicular axis passing
through one of its ends, we'll see that it is given by  = 2/3. Since the angular

speed of our rigid bar pendulum is  = , use of Equation 1.33 for our rigid bar pen-

dulum will simply lead to              1 2 2 2
                                  =  = 
                                    2              6

1.3.4 Constraint Forces

The preceding presentation is too concise to include much of the finer details. In any
case it should be clear that all the approaches discussed above will ultimately yield the
26  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

same equations of motion (possibly up to a linear transformation) for a given system
when one employs the same generalized coordinates to describe the kinematics. Which
approach to use in the analysis of a particular problem will generally depend on the ex-
perience and personal preference of the analyst as well as the complexity of the system.
There is, however, an important issue that must be brought to attention since it may
have a significant affect on the choice, and that is whether or not the analyst is inter-
ested in calculation of constraint forces, which may actually be quite important for
design purposes.

While using the Newton-Euler approach, or static equilibrium equations via
d'Alembert's principle, the constraint forces appear explicitly in at least some of the
equations of motion. Once the motion is solved for, the reaction forces may then be
solved directly from these equations. Recall, for example, the equations we derived
for the equilibrium of the rigid bar pendulum employing d'Alembert's principle, i.e.
Equation 1.23-Equation 1.26. The motion of the pendulum is to be evaluated from the
equation of motion, i.e. Equation 1.26, by solving for (). Once the time history of
 is obtained, Equation 1.23 and Equation 1.24 may be used to solve for the reaction
forces.

These reaction forces, or any other constraint force for that matter, will not show up
explicitly in the equations of motion when we use virtual work or Lagrange's equations,
since in both of these approaches, the virtual displacements will be chosen to be com-
patible with geometric constraints. If we want to evaluate constraint forces, then we
will have to derive additional equations through other means after we solve the equa-
tion of motion that is obtained via these methods. This is not necessarily a drawback
since we will see that derivation and solution of the equations of motion will be the
main effort in structural dynamics, and most often not having the constraint forces
appear explicitly in the equations will provide immense simplification.

EXAMPLE 1 .1

As an exercise in a simple multi-DOF (MDOF) system, let us try to derive the equations
of motion for the two horizontally moving blocks shown in Figure 1.8.

This system comprises two masses, 1 and 2, which are connected by two linear
springs, with spring coefficients 1 and 2. The second mass is acted upon by an exter-
nal force  (). The system has two degrees of freedom since both masses may translate
only along the horizontal direction. We'll use the translations 1() and 2() as our
generalized coordinates. Both are defined positive towards the right, as indicated in
the figure, of their respective references; these reference points correspond to the state
1.3. FUNDAMENTAL LAWS  27

                 Figure 1.8: A system of two horizontally moving blocks.

when masses are standing still and there are no deformations in the springs. We assume
friction to be negligible and gravity is acting downward so that it has no bearing on the
horizontal internal or external forces. We will try to derive the equations that govern
the motion of this system using all the methods we have been discussing above. In the
following discussions we will omit explicit reference to time in most places to keep the
symbolism as simple as possible.

           Figure 1.9: Free body diagrams of the horizontally moving blocks.

Once the generalized coordinates are chosen, the free body diagrams of the compo-
nents may be sketched. Since this system has two distinct bodies, each of which may be
treated as a rectilinearly translating particle, we have to sketch two free body diagrams,
one corresponding to each body. Such free body diagrams are shown in Figure 1.9.
While sketching these free body diagrams, we have implicitly assumed a few key is-
sues which we now verbalize. First and foremost, we have sketched the diagrams for
an instant at which 1 > 0 and 2 > 0; this is to ensure that the sign convention is
properly established in the scalar variables (since we are not using vectors in this one di-
mensional problem); the implied directions of the forces are consistent with this initial
assumption, and the forces that depend on the generalized coordinates will automati-
cally reverse when the signs of the generalized coordinates reverse. Note that once the
sign convention for the generalized coordinates is set, i.e. in this case  > 0 if it is to
28                    CHAPTER 1. FUNDAMENTALS OF DYNAMICS

the right of the reference point, this choice also has consequences for the derivatives of
the coordinates as well, so that velocities  and accelerations  are now also positive
if they are directed rightward. Secondly, we have not shown frictional forces since we
had assumed friction was negligible, and we have simply not shown any forces in the
vertical direction because the system is in static equilibrium in that direction, i.e. the
masses do not move in the vertical direction and the vertical forces will not contribute
to the horizontal equations of motion. The latter part of this clause is not necessary
but is helpful in that it limits overcrowding of the sketches. Third, we have assumed, as
indicated by the directions of the spring forces acting between the masses, that at this
instant 2 > 1; this assumption has no bearing on the results, and the only important
issue is the compliance of the assumed directions of the forces with this assumption.

Newton-Euler laws of motion demand that for each mass, we'll have f = a. Express-
ing this condition in the horizontal direction alone will lead to

                      -11 + 2(2 - 1) = 11
                         -2(2 - 1) +  = 22

and when the equations are re-arranged, we'll have

    11() + (1 + 2)1() - 22() = 0
            22() - 21() + 22() =  ()

which could be written in matrix form as

    [1 0 ] {1()} + [1 + 2                 -2] {1()} = { 0 }
    0 2 2()           -2                  2 2()      ()

or more generally as

                      [M]() + [K]() = ()

which, as we will so often see in the latter chapters, is one of the classical forms of the
equations of motion for systems with multi degrees of freedom.

To use virtual work with d'Alembert's principle, we first have to sketch the free body di-
agrams with the d'Alembert's forces that will bring each mass into instantaneous static
equilibrium. Such free body diagrams are shown in Figure 1.10. Since we have dis-
carded all the springs and shown the spring forces as acting on the mass externally, all
the forces shown in this free body diagram are external to the individual components.
The virtual work done by the external forces through arbitrary virtual displacements
1 and 2 should therefore be equal to zero:

    [-11 + 2(2 - 1) - 11]1 + [-2(2 - 1) +  - 22]2 = 0
1.3. FUNDAMENTAL LAWS                    29

Since this condition must be satisfied for arbitrary virtual displacements, including
when 1 = 0 and 2 > 0 or vice versa, it must be true that the coefficients of the
virtual displacements must be zero. Therefore we have

                             -11 + 2(2 - 1) - 11 = 0
                                -2(2 - 1) +  - 22 = 0

and rearranging the equations leads again to

                       11() + (1 + 2)1() - 22() = 0
                                22() - 21() + 22() =  ()

Figure 1.10: Free body diagrams of the horizontally moving blocks, including
d'Alembert forces.

As for Lagrange's equations, the spring forces, being conservative, may be derived from
the following potential energy function

                       1 21        2
    = 11 + 2(2 - 1)
                       2     2

since 1 and (2 -1) are the elongations in the two springs. We have assumed  = 0
since it is independent of the generalized coordinates; it is just a constant value to be
added so that it has no bearing on the final equations. The kinetic energy of the system
is given by

1                         1     1 21 2
 = 1(v1  v1) + 2(v2  v2) = 11 + 22
2                         2     2     2

The only non-conservative force, apart from any support reactions and constraint
forces that do not contribute to the virtual work expression, is the external force  .

The work done by the external non-conservative forces through virtual displacements
1 and 2 therefore becomes

 = (0)1 + ( )2 = 11 + 22
30  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

Lagrange's equations now lead to,

     dd (   ) -  +  =  1 1 1 11 - 0 + (11 - 2(2 - 1)) = 1 = 0
          dd (   ) -  +  =  2 2 2 22 - 0 + 2(2 - 1) = 2 = 

and rearranging the terms once again leads to the following equations of motion:

                      11() + (1 + 2)1() - 22() = 0
                               22() - 21() + 22() =  ()

EXAMPLE 1 .2

Let us try to derive the equation of motion that would govern the small amplitude
vertical motion of the assembly shown in Figure 1.11.

                        Figure 1.11: Assembly of massless rigid bars.

The bars are rigid but massless, and the springs are linear with the coefficients indicated.
Gravity is to be ignored in the analysis.

For all its complex looking construct with multiple bars, this is a relatively simple sin-
gle DOF system when one considers small amplitude motion around the initial equilib-
rium configuration shown. As the assembly moves, the two horizontal bars will rotate
about their respective supports, and the vertical bar that connects the two will remain
1.3. FUNDAMENTAL LAWS                                            31

vertical and move along the vertical direction. One possible choice for the generalized
coordinate is the vertical displacement of the end of the top bar. To refer to the com-
ponents directly, let us consider the free body diagram of the whole system as shown
in Figure 1.12. With the specific points denoted by letters  through  , the free end of
the top bar is point . Let us denote the vertical displacement of point  by  and try
to formulate the equations governing its time evolution. We define a stationary rect-
angular set of axes  originating at stationary point  as shown; i is the unit vector
along , j is the unit vector along , and k = i × j is the unit vector along .

If we were to analyze the problem using the Newton-Euler approach, we might first
locate the center of mass of the whole system, and then use the principle of linear mo-
mentum and the principle of angular momentum, most probably with reference to ei-
ther the center of mass or a fixed point, and try to eliminate all unknowns but . Since
there are only two concentrated masses, located at  and , the center of mass of the
system will lie along the vertical line connecting  and . In fact, with regards to the
origin of the coordinates, these two points are located at

                       r = 3 i + ( - 34 ) j, r = 2 i - 12  j

so that the center of mass cm is located at16

                      rcm = r + 2r  + 2 = 73 i + ( 53 - 712 ) j
and its velocity and acceleration are given by

                   7                   7
vcm = rcm = -  j,      a = vcm = -  j

                  12                   12

The principle of linear momentum for this assembly leads to

7                                                            5
3acm = -  j = ( + ) i + ( +  + ) j = f
4                                                            2

   16At the risk of repeating ourselves, we must emphasize that these derivations implicitly assume that
all horizontal motion is so small as to be completely negligible, which would be possible only for small
vertical motions. If it were not so, the position vectors and their time derivatives would have to be
modified, and the resulting equations would be nonlinear. So please note that the discussion here is
strictly limited to small amplitude vertical motion.
32                                           CHAPTER 1. FUNDAMENTALS OF DYNAMICS

            Figure 1.12: Free body diagram of the rigid bar assembly.

To use the principle of angular momentum with respect to the fixed point , let us first
calculate the angular momentum of the system with respect to that same point. Since
there are only two point masses in the system, its angular momentum H is given by

                          H = r × (v) + r × (2v)

where v  =  r  =  -  3      j  is  the  vel  ocity  of  mass    located  at    ,  and  v    =  r  =  -  1      j
                     4                                                                                  2
is the velocity of mass 2 located at . Evaluating the cross products in the angular

momentum expression therefore leads to

                                        H = - 174  k

and the principle of angular momentum yields

                                   17
                  H = -  k = (- + 9) k = M
                                   4

When the equations are written out separately for each vector component, it is easy to
see that we have three equations in five unknowns:

                                          0 =  +                                                  (Ex.1.2.a)
                                                                                                  (Ex.1.2.b)
                                   - 74  =  +  + 52                                               (Ex.1.2.c)
                                   - 174  = - + 9
1.3. FUNDAMENTAL LAWS                      33

from which we may deduce

                           = 174  + 9 = -  (Ex.1.2.d)

but this is as much as we can conclude with the information that we currently have.
Note that another angular momentum equation, such as H = M, will yield no new
(independent) information and that whatever we may obtain through such an endeavour

will be limited to some linear combination of the equations above.

        Figure 1.13: Free body diagrams of the individual bars in the assembly.

Clearly more equations are needed to proceed further, and for such equations we may
analyze each rigid bar in the assembly separately.17 The free body diagrams of the in-
dividual bars are presented in Figure 1.13. We can now apply Newton-Euler equations
to each of the individual bars separately and try to eliminate some of the unknowns.
Since the vertical bar  is massless, we know that static equilibrium equations hold
for this bar at any instant (i.e. its linear and angular momenta are always zero by virtue
of it having no mass), such that

                                       0 =  - 
                                       0 =  - 
                                       0 = 2  + 2 

   17We could argue that since no external forces are present in the horizontal direction and since we are
neglecting all horizontal accelerations by restricting vertical motion to small amplitudes, the horizontal
reaction forces will be zero. It may be so in this case, but it would be somewhat easy to err in such
arguments, and a more rigorous demonstration should be preferred unless we are absolutely sure.
34  CHAPTER 1. FUNDAMENTALS OF DYNAMICS

where the first two equations are force equilibrium equations and the third one is mo-
ment equilibrium. We may deduce from these equations that

     =  = 0,  =                                                 (Ex.1.2.e)

Considering bar , application of the principle of linear momentum will yield
                     - 34  j = ( + ) i + ( -  + 2 ) j

whence we deduce, via Equation Ex.1.2.e, that

     = - = 0                                                    (Ex.1.2.f)

and combining this information with Equation Ex.1.2.d leads to

    17 () + 9() = 0                                             (Ex.1.2.g)
    4

This is an equation that governs the time evolution of the generalized coordinate ()

with no other unknowns appearing in it; this is the equation of motion we were looking
for. Note that we would get the same equation if we were to analyze bar  instead.

Once we solve this equation we can use the results to evaluate the unknown reaction

forces. It may be shown, through applying the principles of linear momentum and
angular momentum to bars  and  , that18

     = - 3 16 () - 4 (),  = - 2 ()                              (Ex.1.2.h)

and so once () is determined, the vertical reaction forces may be calculated using the
results in Equation Ex.1.2.h.

To analyze this system with virtual work, we need to include the d'Alembert forces as
shown in Figure 1.14 at an instant . The d'Alembert forces for this system will be two
concentrated forces, acting at points  and , i.e. the locations of the concentrated
masses, with magnitudes determined by the product of the masses with their accelera-
tions. With the addition of the d'Alembert forces, the system is in static equilibrium at
the instant shown. The question now is, what would be the virtual work done by the
internal and external forces if a small virtual displacement  were to be imposed?

   18Note that these results are not unique in the sense that adding or subtracting any multiple of Equa-
tion Ex.1.2.g to the right side of the equations would not change the values of the reaction forces.
1.3. FUNDAMENTAL LAWS                                          35

Figure 1.14: The rigid bar assembly with d'Alembert forces. Although not good prac-
tice, we keep the supports in the free body diagram to emphasize that the support re-
actions, being constraint forces, will play no role in the virtual work calculations.

Since the spring forces are treated as external to the bar assembly and the bars bear no
deformations, there will be no internal work done during . The displacements that
occur at the force locations due to  will be /2 at , 3/4 at ,  at  , and /2
at . Clearly there will be no displacements at the supports  and . The principle of

virtual work therefore will lead to:

                            3 3                             
 = - ( ) - ( ) - (2) - ()
                          22    44                          2

                           9    
= -( +                          + 2 + )  = 0
                          4 16  2

This equation has to be valid for an arbitrary value of , the only possibility for this
condition to hold is to have the term in the parenthesis equal to zero, i.e. we must have

                           + 9 + 2 +  = 0
                          4 16      2

or, in a rewritten form,  17 () + 9() = 0
                          4
                                                               (Ex.1.2.i)

which of course is the same equation as Equation Ex.1.2.g.

Once the equation of motion is solved and () is determined, d'Alembert's principle
may be used to determine unknown reaction forces in a relatively easy manner. Con-
sider the free body diagrams, including d'Alembert forces, of the individual bars shown
36      CHAPTER 1. FUNDAMENTALS OF DYNAMICS

    Figure 1.15: Free body diagrams of the rigid bars including d'Alembert forces.

in Figure 1.15. With the inclusion of d'Alembert forces, each bar is now in static equi-
librium. Therefore, equilibrium of bar  demands

                                 =  = 0,  = 
so that from the horizontal force equilibrium of bar  we have

                                          =  = 0
and since the sum of moments about point  in  must be zero,

            4 + 2 2  +  34  = 0   = - 3 16 () - 4 ()
Similarly, for bar  , horizontal force equilibrium leads to

                                          =  = 0
and equating the sum of moments about point  to zero leads to

                        4 + 2 = 0   = - 2 ()

Finally, to derive the governing equation of motion using Lagrange's equations, we
note the the kinetic energy of the assembly is given by

    1 32 1  1 2 17 2
     =  ( ) + (2) ( ) = 
    24  2   2  32
1.3. FUNDAMENTAL LAWS                             37

and its potential energy given by

 = 1  ( 1 2 ) + 1 (2)2 = 9 2
                           22      2        8

Since there are no non-conservative forces acting (except the constraint forces), Equa-
tion 1.28 may be used to derive the equation of motion:

d (  ) -  +  = 0 = 17  + 9 
d                                     16       4

which may be rewritten as

                           17 () + 9() = 0        (Ex.1.2.j)
                           4

1.3.5 Wrapping Up

Neither the theory, the surface of which we have barely scratched in this chapter, nor
the details of application have by no means been exhaustively discussed. Our aim was
simply to provide a refresher about some of the fundamental frameworks which we
will make use of throughout the rest of the book. Newton-Euler framework is funda-
mental since it provides the stage for latter developments, and for systems in which
constraint forces need to be evaluated, the Newton-Euler laws may provide all the nec-
essary equations. It is likely that d'Alembert's principle will be most often referred to
since most engineers are familiar with the concept of static equilibrium, and also be-
cause the inclusion of d'Alembert forces generally lead to simpler analysis of constraint
forces even if other methods are used to derive the governing equations of motion.
For generalized single degree of freedom systems, the fundamental framework will be
d'Alembert's principle and virtual work; virtual work will also be directly employed
in the context of Lagrange's equations whenever non-conservative forces are present.
The choice of method that will be used in the analysis of a specific problem may stem
from a variety of reasons, not least from familiarity and personal choice. On the other
hand it is also true, as hopefully demonstrated by the examples discussed, that some
methods may provide a more direct reach to a specific goal for a particular system.
38  CHAPTER 1. FUNDAMENTALS OF DYNAMICS
Chapter 2

Free Vibrations of Single Degree of
Freedom Systems

2.1 Motivation and Preliminary Discussions

The fundamental step in the analysis of any system is idealization and conceptual mod-
eling. In engineering analysis, the idealized model should be simple enough so as to
allow extraction of predictive results, but it should still have sufficient complexity to
reflect all the salient features of the particular problem studied. The claim to validity
may only be tested against experiments which are neither feasible nor even possible
for many structural systems. Some simple models have however provided acceptable
predictive accuracy in numerous previous trials so that structural engineers take many
such models for granted while thinking about real, complex structures.

The static analysis of structures makes ample use of simple behavioural models; trusses,
beams, plates or shells, elastic or inelastic, with or without time dependent properties
have been used in the design and analysis of many structures still standing. The degree
of freedom of a structural element in static analysis is associated with deformation pat-
terns that are included in the model. A truss element is assumed, based on connection
details and loading patterns, to deform only axially so that the final form of the bar is
completely determined by translations of its two end points. A beam element, on the
other hand, has rotational deformations so that its deformed shape is determined by
end translations, end rotations, and the deformational patterns imposed by the loads
applied inbetween its two ends.

                                                39
40 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS
Since the concept of degree of freedom in dynamics is intimately connected to mass
distribution and forces associated with accelerations, it may be the case that static and
dynamic degrees of freedom of a system do not map one-to-one. In dynamics, inertia-
related degrees of freedom govern and the static degrees of freedom will often need
to be condensed since, in developing simple models of deformable structures, we will
often assume that the mass is concentrated at certain locations.1 To discuss how such
a simplification may proceed, let us consider the portal frame shown in Figure 2.1.

Figure 2.1: (a) Degrees of freedom in static analysis, (b) masses lumped at the nodes, (c)
dynamic degree of freedom, (d) free body diagram of the mass.
Under the action of a general static loading, one needs to keep track of the three de-
grees of freedom shown in Figure 2.1(a) to be able to specify the deformations that
take place: The lateral translation 1 of the joints, and the joint rotations 2 and 3.2

    1There are of course models in which mass is distributed as well as flexibility. Such models will be
discussed in latter sections and chapters.

    2Even this model has an abundance of implicit assumptions. As an example, the axial deformations
2.1. MOTIVATION AND PRELIMINARY DISCUSSIONS  41

The dominant issue in modeling a system for dynamic analysis, however, is the distri-
bution of the mass or, relatedly, the inertial effects produced by the distribution of the
mass and their accelerations in the system (think of d'Alembert forces). It is common
to consider that in such structural frames most of the mass will be concentrated in the
level of the floor plate and the beams attached to it; furthermore, the accelerations at
this level will also be relatively more significant than say the accelerations near the sup-
ports. Should one wish to incorporate the contribution of the columns to the mass, it
may be argued that some , but not all, of the column mass will have an significant effect
on the dynamics. With this line of thought, a model in which masses are lumped to the
two joints may be developed. An important question that must be raised is whether or
not rotational accelerations will have a significant affect. This is a question without an
obvious a priori answer but past experiences indicate that under the action of common
load effects, rotational accelerations at the joints and the inertial effects thereby gener-
ated remain inconsequential compared to those related to lateral translation; in a sense
these rotations are predominantly secondary effects caused by lateral translation and
compatibility. If rotational accelerations are thus neglected, angular momentum equa-
tions for the joints will be in essence static equilibrium equations, and no mass need to
be assigned to the rotational degrees of freedom. This model, commonly employed in
finite element analysis of frame structures, is referred to as the lumped mass model.

Since the lateral translation is assumed to be common to both joints, we could consider
a single mass  = 1 + 2 which would be dynamically equivalent, and the motion
of this mass may be completely defined by the single generalized coordinate   1
as in Figure 2.1(c). What is left to determine for the formulation of the equation gov-
erning the motion of this mass is the lateral stiffness of the frame, i.e. the resistance
with which it tries to pull the mass back to the initial equilibrium position.3 This cu-
mulative resistance will stem from the deformations of columns and beams, and from
static analysis we know that under the action of the lateral load , static equilibrium
equations for the joints may be expressed as

                             21 22 23 11 12 13 2 = 0 (2.1) {1} {}
                             31 32 33 {3} {0}

are considered to be at least an order of magnitude smaller than flexural deformations, so that: i. the
translations of the two joints along the longitudinal axes of the columns are neglected, and ii. the joints
are assumed to translate laterally by the same amount since the beam's axial deformations are neglected.

    3There is another important component called damping which is used to model energy dissipation
during motion; we leave aside for the moment the introduction of this component.
42 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

where  are stiffness coefficients. Since rotational accelerations and the associated
d'Alembert moments are to be neglected, the right hand sides of the second and third

equations that represent moment equilibrium of the joints will remain zero in dynamic
equilibrium analysis. Consequently, {2, 3} are not independent: noting that   1,
the relation between  and {2, 3} at any instant will be given by

    22 23  -1  21  2

-[         ] [ ] = { }  (2.2)
    32 33      31  3

so that eliminating the rotational degrees of freedom from Equation 2.1 with the help
of Equation 2.2 leads to a single expression relating the lateral displacement directly to
the lateral force,

                                                     -1

(11 - [12 13] [22 23  ] [21])  =    =  (2.3) 32 33 31

where the coefficient  is called the lateral stiffness of the frame. This procedure of elim-
inating the dynamically indirect degrees of freedom from the model is referred to as
static condensation and it is widely used to simplify the structural models through elim-
ination of those degrees of freedom onto which no mass or moment of inertia is as-
signed. It is important to note that even though inertial properties are alluded to, es-
pecially with respect to their existence or nonexistence, determination of the stiffness
properties of a system is essentially a matter of static analysis.

Now that the conceptual model is finalized, we may use any of the frameworks previ-
ously reviewed to derive the equation that will govern the motion of the mass, i.e. the
time variation of (). For example, making use of d'Alembert's principle and the free
body diagram shown in Figure 2.1(d), the sum of forces in the horizontal direction
would lead to

                                    () + () = ()

which, as we will so often see, is the canonical equation governing the dynamics of
undamped linear single degree of freedom systems under the action of external load
effects.

2.2 The Prototype

As the equation of motion has the same form for all single degree of freedom (SDOF)
systems, a single simple model suffices to conceptually represent all undamped SDOF
2.2. THE PROTOTYPE                                                    43

systems. This model, sketched in Figure 2.2, comprises a mass, representing the inertial
features that contribute to the equation of motion through accelerations, and a spring,
representing flexiblility features that contribute to the equation of motion through de-
formations. The mass is assumed to be travelling on a frictionless surface (the wheels
are there to hint, admittedly erroneously, at motion unhindered by interaction with
the ground) and there are no other dissipative sources either. Physical properties of
the system are assumed to be invariant in time. Each component of the model may
indeed correspond to a single entity of some system but most likely each will represent
the contribution of multiple sources. It may therefore be more appropriate to think of
the mass and stiffness coefficients as equivalent mass and equivalent stiffness of the sys-
tem, but we refrain from emphasizing this distinction through symbols or scripts to in
an effort to keep notational complexity at a minimum.

Figure 2.2: Prototype for undamped single degree of freedom systems.

To provide a few examples on how such a model could be so vastly representative, let us
first derive the equation of motion for the system of Figure 2.2. The free body diagram
of the system including the d'Alembert force is provided in Figure 2.3. Sum of forces in
the horizontal direction leads to the following equation of motion governing the time
variation of the single coordinate :

() - () - () = 0  () + () = ()                                        (2.4)

Alternatively we could use the Lagrangian approach which would proceed as follows:
The kinetic and potential energies of the system are given by

                    12  12
                     =  ,  = 
                    2   2

while the virtual work done by the external forces through a virtual displacement is
given by

                                       =  = 
44 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 2.3: Free body diagram of the prototype single degree of freedom system includ-
ing the d'Alembert force.

so that the generalized force is simply  = . Therefore Lagrange's equations lead to
              d (  ) -  +  =   () + () = ()
             d   

which, of course, is identical to the equation of motion in Equation 2.4.
Let us now consider the systems shown in Figure 2.4. The simply supported beam in
Figure 2.4(a), assumed to behave linear elastically, is supposed to be very light compared
to the heavy mass  so that it is to be modeled as massless. The system has a single de-
gree of freedom since the mass may only translate vertically (assuming the deflections
are small so that lateral motion due to beam deformations is negligible). The critical
issue in modeling this system is the determination of its stiffness, which is due to the
deformation resistance of the beam. By definition, a stiffness coefficient is numerically
equal to the external force that should be imposed along the degree of freedom to in-
duce a unit displacement.4 If the beam is undergoing uniaxial bending with bending
rigidity  (i.e. the product of modulus of elasticity  and the second moment of the
cross sectional area about the bending axis ) and length , from structural analysis we
know that the relationship between a force  applied at the midspan of the beam and
the deflection  under the force is given by

                                                48
                                          = 3 

                                                  

    4When more than one degree of freedom are present, one should consider forces at all degrees of
freedom so that while a unit displacement occurs in one, there are no displacements at any other degrees
of freedom. More on this in latter chapters.
2.2. THE PROTOTYPE                                                              45

so that if  = 1, then the force that has to be applied is numerically equal to 48/3.

While this interpretation is more direct for experimental determination of stiffness, in

the analytical derivation the stiffness is simply identified as the coefficient that mul-
tiplies the displacement in the linear force-displacement relationship, i.e. 48/3.

Whichever way it is interpreted the bottom line is that, as far the vertical motion of

the mass is concerned, the massless beam is equivalent to a linear spring with equiva-

lent spring coefficient       48
                         = 3

                                 

and the equation of motion governing the time variation of  may be shown to be

                                    48
                         () + 3 () = 0

                                      

since there are no external forces acting on the mass. This statement may immediately
trigger the question `what happened to gravity?' In structural dynamics, it is generally
assumed that the deformations due to gravity loads and the deformations due to dy-
namic loads may be analyzed separately and the results so obtained may be superposed
afterwards. This of course is strictly possible only if the deformations resulting from
either is relatively small so that the geometry is not significantly altered and the re-
sponse remains linear. There are important exceptions to this approach, most notably
for systems in which second order effects and/or nonlinearity is pronounced.

The shaft in Figure 2.4(b) is again assumed to be massless. It is supporting a disc with

moment of inertia  about the longitudinal axis of the shaft. When torsional vibra-

tions are to be studied, the system has a single degree of freedom since the disc will

only be rotating about the longitudinal axis. Consider now an instant at which the

disc has rotated by an amount . If the shaft of length  is assumed to behave linear

elastically with torsional rigidity  (i.e. the product of the shear modulus  and the

polar moment of the cross sectional area  ), then the resisting moment acted upon the

disc by the shaft at that instant may be shown to be in opposite direction to  and of

magnitude                 =  
                                  

Sketching the free body diagram of the disc and applying the principle of angular mo-

mentum will then yield the equation of motion

                         () +  () = 0

which once again has a form identical to that of Equation 2.4: If one could build a
physical model that looks like the system shown in Figure 2.2, adjust its mass  to be
46 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 2.4: (a) A beam carrying a heavy mass, (b) a heavy disc attached to a shaft, (c)
truss and springs supporting a heavy mass.
2.2. THE PROTOTYPE  47

numerically equal to , and adjust its stiffness  to be numerically equal to  /, then
the response of that built model would perfectly match the response of the disc-shaft
system under numerically similar load effects. Such similarities are generally referred
to as mechanical analogies and with this terminology, the system of Figure 2.2 may be
referred to as the mechanical analogue for all undamped linear single degree of freedom
systems.

          Figure 2.5: Equivalent springs with parallel and series connections.

Slightly more complicated is the system shown Figure 2.4(c), where a three member
truss, supported by two identical springs, is carrying a heavy mass attached to its top
node. To simplify the problem, it is assumed that the truss members have negligi-
ble mass, and that the supports are restrained to move vertically. Due to symmetry,
the mass will translate in the vertical direction alone, assuming no external forces are
present to explicitly force any other motion. The system therefore again has only one
degree of freedom. If we were to consider an instant at which the mass has moved
down an amount of , it is clear that some of that displacement will be due to the defor-
mation of the truss bars and the rest will be due to the deformation of the springs. A
detailed analysis may be undertaken to analyze the bar forces and associated displace-
ments to find the equivalent stiffness of the system but the following analogy may help
while thinking about this and similar problems. The combined system of Figure 2.5(a),
with the massless truss and springs, is mechanically analogous to the springs shown
in Figure 2.5(b) where the truss has been replaced by a spring with stiffness . This
spring is representative of the force-displacement relationship of the truss alone, with
displacement here referring to the relative vertical translation of node  with respect
to nodes  and  which, due to symmetry, will behave identically. It may be shown
through structural analysis that the relative vertical displacement  of node  under
48 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

the action of a vertical force  applied at  is given by

                                           = 2 
                                                 3

so that the equivalent spring coefficient  may be defined as

                                            = 3 2

As for the two springs supporting the truss, they may be said to be connected in par-
allel; their displacement is the same but each will carry a portion of the total force in
proportion to its stiffness. Consider any two linear springs, with coefficients 1 and
2, connected in parallel. Let the total force they transmit be , and assume they both
displace by the same amount . The relation between force and displacement for such
a system would be

                             =  1 +  2 = (1 + 2)

                                                force in 1 force in 2

so that the response of such a system would be equivalent to a system with a single
spring of stiffness 1 + 2.5 Therefore the system of Figure 2.5(b) may be replaced by
the system of Figure 2.5(c).

Now we have two springs in series, with stiffness coefficients  and 2. For any two
linear springs, say with stiffness coefficients 1 and 2, that are connected in series,
the force transmitted through each will be the same, but each will contribute to the

displacement in proportion to their stiffness. The relationship between the force 

through such a system and the total displacement  is given by

 =  +  = ( 1 + 1 )
1  2                               1 2

deformation in 1 deformation in 2

so that such a series system would be equivalent to a single spring with spring coeffi-
cient6 1

                                             11 + 12

Applying this result to our system leads finally to the single equivalent spring shown in
Figure 2.5(d), with equivalent spring coefficient  given by

 = 1 1 1 = 6
       + 2 4 + 3

5Which may easily be generalized to any number of springs connected in parallel.
6Which again generalizes easily to multiple springs connected in series.
2.3. UNDAMPED FREE VIBRATIONS  49

and the equation of motion for the system of Figure 2.4(c) would finally be derived as
                    () + () = () + 6 () = 0
                                                     4 + 3

We should recall that, although various details on a number of issues have been men-
tioned, the main point of this exercise was to motivate the use of the prototype single
degree of freedom model. Whether or not a system may be effectively represented by
a single degree of freedom model, however, is a question that does not have a straight-
forward answer, as hopefully illustrated by even the relatively simple systems discussed
above. There is no shortcut or a single foolproof recipe that we know of which would
be applicable in all situations; as such, this book will mainly focus on the methods of
analysis that will be applicable to different models, assuming that those models are rep-
resentative of whatever real life system they are aspiring to replicate the behavior of.
The success or failure of the modeling approach will eventually boil down to how ac-
curately the model will be able to predict the real response. The only way we know of
to increase one's model developing abilities is simply by doing: working on many text-
book exercises and more realistic problems to get acquainted with a diverse set of cases,
identifying the strengths and caveats of modeling assumptions and approximations, so
as to be able to make rational choices based on reliable experience and information.
We therefore highly recommend the reader to attempt all the solved and unsolved ex-
ercises that will be provided in the text in an effort to start on this arduous journey
which will in all likelihood continue, as ours still do, indefinitely.

2.3 Undamped Free Vibrations

If a system in natural (static) equilibrium is set to motion by imposing some initial
displacement and/or velocity but then left to move around the initial equilibrium con-
figuration on its own, without imposing any external load effects, then the system is
said to be executing free vibrations.

In order to introduce some basic concepts and definitions, let us first analyze a system
in which there is no energy dissipation. Such a system would be governed by Equa-
tion 2.4 but with no external force so that

                                      () + () = 0

but this equation alone is not sufficient to describe the problem completely. To be able
to determine the time variation of (), one needs to know the state of the system at
50 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

some time so as to be able to track the system thereafter. The state of a single degree

of freedom system at some instant  =  refers collectively to its displacement and

velocity, i.e. {(), ()}, since these two variables are sufficient to determine all that

happens to the system along with the governing equation of motion. This `instant' 

is generally taken to be the start of the time interval considered corresponding to  =

0, and the values of displacement and velocity at this initial instant are called initial

conditions for the system. These initial conditions are so often utilized that we shall

denote them by special symbols: the initial displacement will be denoted by  and the

initial velocity by . A more proper statement of the problem may now be expressed

as:

     () + () = 0 ; {(0) = , (0) = }       (2.5)

Equation 2.5 is a second order linear differential equation with constant coefficients.
Its solution may be expressed in the form

                                  () = e  (2.6)

where  and  are in general complex valued and as yet undetermined. Substituting
this proposed solution to the equation of motion in Equation 2.5 yields

                                      (2 + )e = 0

If this equality is to be satisfied for all time , then there are two possibilities that should
be considered. It could be that  = 0, in which case equilibrium is automatically
satisfied since the system is not moving; this is called the trivial solution. The second
possibility, which is the non-trivial solution, requires  to be such that

                                          2 +  = 0

which yields two solutions for :

     1 = +-  = +j, 2 = --  = -j

where j, defined through j2  -1, is the unit imaginary number, and we have intro-
duced   +/. This variable  is of fundamental importance; it is called the

(undamped) natural frequency of the system for reasons that will soon be clear. Since
both of the solutions for  will satisfy the equation of motion, the general solution will

be the superposition of the two, so that

     () = 1e1 + 2e2 = 1ej + 2e-j          (2.7)
2.3. UNDAMPED FREE VIBRATIONS                                    51

and finally, since () is real valued, it must be that 1 and 2 are complex conjugates,
                                                    j),
so that with   =  1  =    +  j  =        =  (    -       we have the following general
                                      2

solution:

                             () = ej + e-j                       (2.8)

Equation 2.8 is referred to as the general solution since the response of all SDOF sys-
tems to initial conditions will be of this form. The two coefficients  and  in  = +j
will have to be determined based on the specific initial conditions of the particular prob-
lem being studied. This form of the solution, however, is not very conducive to direct
physical interpretation, and most often expressing the solution in terms of well known
trigonometric functions is preferred. Euler's formula says that

                             e±j = cos  ± j sin                  (2.9)

and when this expansion is used in Equation 2.8 with  = , we arrive after some
algebra to the following form for the general solution:

                          () = 1 cos  + 2 sin                    (2.10)

When expressed in this form, the nature of the time variation of  is much more obvious.

The displacements that will occur in a SDOF system after it is set to motion will be of
sinusoidal nature, with frequency  and an amplitude that depends on the particular
initial conditions. In fact, for (0) =  and (0) = , the coefficients 1 and 2
will be evaluated as

           (0) =  = 1 cos 0 + 2 sin 0                    1 = 
           (0) =  = -1 sin 0 + 2 cos 0                    1 =  

so that the general solution now takes the form

                          () =  cos  +   sin                     (2.11)

That this solution corresponds in fact to a single sinusoidal wave may be shown math-
ematically through the use of the following expansion formula:

                     cos( ± ) = cos  cos   sin  sin              (2.12)

A function of the form  cos( - ) is therefore equivalent to

 cos( - ) = ( cos ) cos  + ( sin ) sin  = 1 cos  + 2 sin 
52 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

so that with

                 1 =  cos ,               2 =  sin                             (2.13)
                                                                               (2.14)
the general solution may be expressed as

                 () =  cos( - )

This form is arguably the one that is most easily visualized. The response to initial
conditions is in the form of a single cosine wave with amplitude  and phase angle7 .

The amplitude and phase are given, through Equation 2.13 and Equation 2.11, by

                                                                         2     (2.15)

               = 12 + 22 = 2 + (   )

               = arctan sin  = arctan 2/ = arctan /()                          (2.16)
                 cos                      1/                                /

The response of an undamped linear single degree of freedom system to some initial
conditions  > 0 and  > 0 is shown in Figure 2.6. This sinusoidal response starts
from the initial displacement  with slope . The first peak is reached at time  =
 = /. The peak amplitude  is the same at all peaks, in other words the vibrations

do not decay since there is no energy dissipation in the system and once it gets going

with a certain total mechanical energy, given by

                                       1 2 1222
                  =  +  =  + 

its mechanical energy remains at this constant level. The maximum displacement
and velocity (in an absolute sense) that occur during the motion, inferred from
Equation 2.14 and its time derivative, are given by

                 max = , max = 

The maximum kinetic energy occurs whenever the displacement is zero and at a value

of 1 2 1 2 1 2 2 22    2                      2
                 max = (max) = () =  (  + )

    7A phase angle is also referred to as a lead or a lag. When written in this form,  may be referred to
as a lag in the sense that the time to first peak is determined by the value of  and for any  > 0, the first
peak occurs sometime after  = 0, as opposed to an unshifted cosine wave ( = 0) for which the first
peak occurs exactly at  = 0.
2.3. UNDAMPED FREE VIBRATIONS                                                                                 53

Figure 2.6: Initial condition response of an undamped single degree of freedom system.

whereas the maximum potential energy occurs whenever the velocity is zero and at a

value of  1  2 1 2 1 2 2

          2max = (max) =  =  ( + 2 )22

The maximum force that occurs in the spring, possibly important for design consider-
ations, is given by

                                                                                                           2

          maximum spring force = max =  = 2 + (   )

The response is said to be periodic with period  so that the motion of the mass repeats
itself in patterns of duration  ; periodicity is expressed mathematically by the condi-
tion

                                     () = ( +  ) 

where  is said to be the period of the system, given by

                                              = 2
                                                    

as may be easily inferred from Equation 2.14. The period, which may be defined as
the time it takes for motion to complete one full cycle, is a fundamental quantity in
structural dynamics and it is more often referred to than the frequency due to its more
direct physical implication. It is often stated in units of seconds [sec or s] since the
54 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

periods of most systems encountered in structural dynamics are of the order of seconds.

What is called the cyclic frequency is defined as the number of cycles completed in a unit

of time, i.e.

               cyclic frequency = 1 = 
                                       2

If time is measured in seconds, than the unit of cyclic frequency is named Hertz, de-
noted by Hz, so that 1 Hz = no.ofcycles/1 sec. To distinguish between the two fre-
quencies,  (with units of rad/sec) is often referred to as angular frequency since it cor-

responds to the angle the cosine function in the response goes through in a unit of time.
Here we will simply refer to  as frequency to economize on adjectives, and use the term

cyclic frequency whenever we need to explicitly refer to it.

2.4 Damping

Although indispensable for introducing basic concepts, one of the major drawbacks
of the undamped model is that it does not reflect energy dissipation, which is a phe-
nomenon observed in all real life systems. Energy dissipation may occur do to various
mechanisms. Friction between the system and its surroundings, radiation, internal
friction and heat generation, cracking and plastic deformations, to list some promi-
nent causes, may all contribute at varying degrees to dissipation. The simple fact is
that explicit identification and modeling of all such causes is not feasible if at all pos-
sible, unless some of them are dominating and the aim is to specifically address and
study them.

2.4.1 Viscous Damping Model

A simple model for dissipation has proved both mathematically convenient and practi-
cally applicable, so as to provide acceptable representations of experimentally observed
responses. The model is based phenomenologically on the response of a linear viscous
dashpot in which the applied force is proportional to the velocity of deformation. Amal-
gamation of energy dissipation mechanisms to a single equivalent linear viscous dashpot
provides a model that is capable of producing a certain type of amplitude decay often
observed in free vibrations of real structures. This model is therefore generally ac-
cepted as a reasonable prototype to model energy dissipation in small amplitude vibra-
tions, so much so that it is explicitly referred to in many structural codes and guidelines.
With due caution we will simply refer to this model as viscous damping and represent it
graphically with a dashpot as shown in Figure 2.7(a).
2.4. DAMPING                                       55

Figure 2.7: (a) Viscously damped single degree of freedom system and (b) its free body
diagram including the d'Alembert force.

The force across the damper is given by  where  is the rate of deformation and  is

called the (linear) viscous dashpot coefficient: it is this coefficient, or some other one

derived form it, that must be adjusted properly if the model is to represent accurately

the amplitude decrement of the real system. The force acted upon the mass by the

damper is therefore equal in magnitude to  and opposite in direction to the direction

of the velocity. The free body diagram of the mass, including the damping force and

the d'Alembert force, is shown in Figure 2.7(b). The sum of the horizontal forces leads

to

              () + () + () = ()                    (2.17)

which is the equation of motion that represents the dynamics of all viscously damped
single degree of freedom systems. The unforced vibrations will hence be governed by

    () + () + () = 0 ; {(0) = , (0) = }            (2.18)

which is once again a second order linear differential equation with constant coeffi-
cients.

Since Equation 2.18 is of the same form as Equation 2.5, we may expect Equation 2.6
to work in this case as well. Using the candidate solution in Equation 2.18 leads to

                                  (2 +  + )e = 0

and the non-trivial solution requires
                                      2 +  +  = 0
56 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

There are two solutions for  that satisfy this quadratic equation, given by

1 = -  + 1 2 - 4,  2 = -  - 1 2 - 4
         2 2                2 2

It is possible to rewrite these expressions in somewhat simpler, familiar terms. Remem-
bering that 2 = /, and defining

         2                                                                   (2.19)
                  

where  is a new but dependent variable derived from the damping properties, the roots
may also be expressed as

         1 = - + 2 - 1, 2 = - - 2 - 1                                        (2.20)

It is somewhat easier to observe that the nature of the solution depends very much on
the value of the coefficient . Although only one of the cases is mostly relevant, for
completeness we note the following three possibilities:

    i) Overdamped systems: Consider that  > 1. In this case both roots are real valued
       and the exponentials lead to hyperbolic sines and cosines such that no oscillation
       is possible. In fact, one has

       () = 1e(-+2-1) + 2e(--2-1)
             = e- [1e2-1 + 2e-2-1]
             = e- [(1 + 2) cosh (2 - 1) + (1 - 2) sinh (2 - 1)]

       () = e- [1 cosh (2 - 1) + 2 sinh (2 - 1)]

To simplify the presentation, let us define

           2 - 1

so that

         () = e- (1 cosh  + 2 sinh )                                         (2.21)

To satisfy initial conditions one must have

         (0) =  = 1  1 =                     2 =  +  
         (0) =  = -1 + 2 
2.4. DAMPING  57

Figure 2.8: Response of overdamped systems subjected to initial conditions { 
0,  = 0}.

       and hence the general solution for initial condition response of overdamped
       SDOF systems may be expressed as

                         () = e- [ cosh  +  +   sinh ]

How the response varies for some values of  may be seen in Figure 2.8. Each curve in
this figure shows the response of an overdamped SDOF system with a specific value of
 due to nonzero initial displacement   0 and zero initial velocity  = 0. The plots
are non-dimensionalized, with the horizontal axis corresponding to time scaled with
 (i.e. the period the system would have if it were undamped). Evidently all responses
simply decay towards the static equilibrium position. What is slightly counter intuitive
is that the higher the damping coefficient in an overdamped system, the longer it takes
for the system to go back to the original configuration. Higher damping limits the
velocities to smaller values so that recovery takes longer.

   ii) Critically damped systems: The nature of the solution will eventually change as
       damping gets smaller and the transition occurs when 2 - 4 = 0 or, equiva-
       lently, when  = 1. In this case the roots in Equation 2.20 yield

                                             1 = 2 = -

       and with repeated roots the solution takes the form

                                      () = 1e- + 2e-
58 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

For initial displacement  and initial velocity , the coefficients are evaluated
as

        (0) =  = 1  1 = 
        (0) =  = -1 + 2  2 =  + 

so that the general solution for critically damped single degree of freedom sys-
tems may be expressed as

                      () = e- + ( + )e-

The response is once again a simple decay with no oscillation around the static

equilibrium configuration but the recovery will be faster than the curves shown

in Figure 2.6. This particular case allows us to define a critical damping for SDOF

systems, given by                    
                             = 2 

since for  >  the system will be overdamped, and the for  <  it will be
underdamped. This critical value depends on the mass and stiffness properties
of the system and thus it may be estimated for design purposes. Employing the
critical damping concept, the coefficient  initially defined via Equation 2.19
may also be defined as the ratio of the available damping to the critical damping,
i.e. 

                                          = 

and so  is referred to as the critical damping ratio or simply as the damping ratio,
which is the name we will use to address it.

iii) Underdamped systems: When  < 1, the square roots in Equation 2.20 lead to
    complex numbers, and harmonic motion becomes possible. Let us express the
    two roots as

        1 = - + -(1 - 2) = - + j,

        2          =  -  -  -(1  -  2)  =  -  -  j  =  

                                                         1

where

                              1 - 2                         (2.22)

is called the damped frequency of the system. Remembering the discussion about

complex coefficients in undamped vibrations, the general solution may be writ-

ten as

                      () = e- (ej + e-j)
2.4. DAMPING                                                                59

which, with the help of Equation 2.9, may be recast in the following form:
                        () = e- (1 cos  + 2 sin )

Applying the initial conditions leads to

              (0) =  = 1  1 =                  2 =  +  
              (0) =  = -1 + 2 

so that       () = e- ( cos  +  +   sin )

                                                                            (2.23)

Alternatively, via Equation 2.12 and defining

                     cos  = 1,  sin  = 2

the solution may be expressed as                                            (2.24)
                             () = e- cos( - )

where

                               2                 2
                                + 2 ( ) + ( )
                                                      
               = 2 + 2 =                                                    (2.25)
                    1  2                       1 - 2

 = arctan sin  = arctan 2/ = arctan ( + )/()                                (2.26)
              cos              1/                     /

Evidently the oscillations in underdamped systems will take place with an ex-
ponentially decaying amplitude defined by e-. The response is not strictly

harmonic but we still talk of a period and frequency of the system: the oscilla-
tory part, cos( - ), is a harmonic wave with frequency equal to the damped

frequency of the system, and the damped period of the system is defined as

                                = 2
                                      

Since the damping ratio  < 1,

                     = 2 =  > 
                          1 - 2 1 - 2
60 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

       so that the damped period is slightly longer than the undamped period. The dif-
       ference, however, is generally small for common structures, in which damping
       ratios are generally on the order of 1% to 15%. Even for a relatively high damp-
       ing ratio of 10%, the difference between the two periods is about 0.5%; in most
       applications, this difference may be neglected and the undamped period may be
       referred to.

The responses of underdamped systems are visualized in Figure 2.9. The typical re-
sponse of an underdamped system, subject to initial conditions  > 0 and  > 0
is shown in Figure 2.9(a). The response at any instance is the product of the harmonic
wave cos(-) with the envelope e-, resulting in an oscillation about the natural
equilibrium configuration with an exponentially decaying amplitude. The damped pe-
riod is easily identified as the duration between any two consecutive down-crossings
(or up-crossings), or any two consecutive peaks (or troughs). How fast the response
decays in a single cycle depends on the value of ; this dependence is clearly seen in
Figure 2.9(b), which shows the responses of underdamped systems with three different
values of , all plotted in non-dimensionalized form to allow a direct comparison.

2.4.2 Estimating Viscous Damping from Free Vibration Data

Increasing damping ratio in underdamped systems leads obviously to faster decay in
the response, which may be quantified by the decrease in amplitudes of peaks. This
relation is used directly in a well known method used to estimate the damping ratio of
SDOF systems. Consider a local peak, say the ith local peak, that occurs at some time
 = . The amplitude  of this peak will be given by

                             = () = e- cos( - )

as shown in Figure 2.10.

This local peak does not occur exactly when the cosine term is equal to one. In fact, by
taking the first time derivative of the displacement given by Equation 2.24 and after
combining the harmonic terms, the velocity may be expressed as

() = -e- sin( -  + )  (2.27)

where  is a phase shift that depends on the damping ratio as tan  = /1 - 2,
which yields    for   1. If there is no damping then  = 0, and for small values

of damping it is very close to zero. In any case, an extremum in the displacement occurs
whenever sin( -  + ) = 0. If a local peak occurs at time  = , then the next local
2.4. DAMPING  61

Figure 2.9: Response of underdamped systems subjected to initial conditions: (a) Typ-

ical response of an underdamped system to initial conditions { > 0,  > 0}, (b)
effects of damping ratio on the response to initial conditions {  0,  = 0}.
62 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 2.10: Peaks in free vibrations of a viscously underdamped system.

peak occurs at  =  +  since sin(( +  ) -  + ) = sin(2 +  -  + ) =
sin( -  + ); it is obvious from this discussion that all consecutive local peaks are
separated by duration  . The amplitude +1 = ( +  ) of the ( + 1)th local peak

therefore is given by

+1 = e-(+ ) cos(( +  ) - ) = e-e-2/1-2 cos( - )

since the angles in cos(( +  ) - ) and cos( - ) differ by 2. The ratio of the
amplitudes of two consecutive local peaks is therefore given by

                      = e2/1-2                                            (2.28)
                    +1

Logarithmic decrement is the name given to the natural logarithm of the ratios of two

successive local peaks. It may be measured and calculated directly from recorded free

vibration data and it is a widely used indicator of energy dissipation; as the velocity is

zero at the peaks, the energy of the system when the mass is at a peak displacement

comprises only the potential energy, which is a direct function of the displacement.

Based on Equation 2.28, the logarithmic decrement in a viscously damped system is

therefore given by  ln  = 2 

                    +1  1 - 2                                             (2.29)
2.4. DAMPING                                                                               63

so that, having measured the amplitudes, the damping ratio of the system may be cal-

culated from                        = 1 ln 
                               1 - 2 2 +1
                                                                                           (2.30)

When the damping ratio is small, this expression may be approximated by

                                       1 ln                                                (2.31)
                                          2 +1

which is the form more commonly encountered. Applications have shown that the

damping estimates improve if one uses the ratio of more widely separated peaks instead
of two consecutive ones. If one uses two local peaks,  and +, separated by a
duration of  , the damping may be estimated as

                                    = 1 ln                                                 (2.32)
                               1 - 2 2 +

where the last approximation is acceptable only for small values of damping ratio; it
might be mentioned that the error due to this approximation alone would be less than
1% for damping ratios less than 10%.

2.4.3 Energy Dissipated by Viscous Damping

The amount of energy dissipated due to viscous damping may be calculated based on

the principle of work and energy which states that the total mechanical energy of a

system varies as it moves from state 1 at time  = 1 to state 2 at time  = 2 according

to

                                     1   +          =  2

                                                12

where  =  +  is the total energy of the system at state , and  and  are the
system's kinetic and potential energies, respectively, at state . When a single degree of

freedom system is governed by Equation 2.17, its kinetic and potential energies at state
 at time  = , may be expressed as

                          = 12 [()]2,  = 12 [()]2

with the set {(), ()} denoting the state of the system at time . The displacement

(deformation) and the velocity are sufficient to define the state since the acceleration

at time  =  is dependent on these through the equation of motion. The third com-
        
ponent          is  the  work  done  by  non-conservative  forces  as  the  system  moves  from
            12
64 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

state 1 to state 2. The only non-conservative force in the system of Figure 2.7 is the
damping force . Consider the free body diagram of the SDOF system at some time
 shown in Figure 2.11. When the system moves by an amount d, the change in the

system's energy will equal to the work done by this force so that

             d = - d                            (2.33)

where the minus sign is due to the algebraicaly consistent directions employed. Note
that the work done by the spring force is the change in potential energy and the work
done by the d'Alembert force is the change in kinetic energy, and so they are accounted
for as d. The time rate of change of energy will be given by

          d  d        2
             = - = -                            (2.34)
          d  d

Figure 2.11: Free body diagram of the freely vibrating damped SDOF system.

In principle, this expression may be integrated, either over a path via Equation 2.33
or over a duration via Equation 2.34, to calculate the energy dissipated over the path
or time interval investigated, which is simply the negative of the work done by the
non-conservative forces. A simple result, however, does not emerge in the case of free
vibrations because the dissipated energy depends on the state or, equivalently, where
in its cycles the system is. To give an idea as to possible results, the energy dissipated
in  = [0,  ) may be shown to be equal to

        
 2 d =   [-e- ( cos( - ) +  sin( - ))]2 d

0    0

     = 2 [1 - e-4/1-2] [ 2 + 2 cos2  -  sin 2]
     4          
2.4. DAMPING  65

One graphical tool frequently used to visualize the effects of energy dissipation is to
plot the force-displacement relationship. The force in the context of free vibrations
refers to the total resisting force that acts on the mass of the prototype model. When
the system is undamped, this force is simply  = , and when the system is linearly
viscously damped, it is  =  + . The force-displacement graphs of these two
cases are presented in Figure 2.12. These plots have been developed for durations of
one period starting with time  = 0 for systems subjected to the same initial velocity
but no initial displacement, the only difference between the systems of the two plots
being the addition of damping in the second one.

The main difference between the behavior observed in Figure 2.12 is the area enclosed
by each curve. When undamped, the system loads and unloads (with directions indi-
cated by the arrowheads on the curves) along the same line as shown in Figure 2.12 (a).
Force and displacement are in phase, and as a result the total work done by the force as
the system moves through one full period is zero. In the viscously damped system, the
path is curvilinear as shown in Figure 2.12 (b) because of the phase difference between
the force and displacement; moreover, the total work done is not zero in this case but
the system dissipates energy of amount equal to the shaded area "enclosed" within the
curve. When the force-displacement curve encloses an area the system is said to exhibit
hysteretic behavior, after such behavior observed in magnetic hysteresis.

Figure 2.12: Force-displacement plots for (a) undamped and (b) linearly viscously
damped SDOF systems.

2.4.4 Non-viscous Damping Models

The widespread acceptance of the viscous damping model has reinforced itself with its
appearance in structural codes and more recent identification and health monitoring
66 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

studies which have focused almost exclusively on fitting viscous damping models to
vibration data obtained from large scale systems. The complexity of energy dissipa-
tion mechanisms in large scale systems somewhat justifies the use of this model due to
its relative simplicity and success. When studying individual components, composite
materials and high amplitude vibrations, however, other damping mechanisms have
proved useful and sometimes provided better results. Although we will revisit some of
these models when studying forced vibrations, here we will briefly mention them and
comment on their major differences compared with the viscous damping model.

The two governing characteristics of the viscous damping model are that: i. it predicts
an exponentially decaying response; ii. the amount of energy dissipated in one cycle of
steady state vibrations under a harmonic external excitation depends on the frequency.
A physical shortcoming of the model is that the oscillations theoretically continue in-
definitely albeit at completely negligible amplitudes; observationally the vibrations in
real structures eventually cease so that the real dissipative mechanism should be at the
very least a combination of viscous and friction mechanisms. Since this phenomenon
becomes significant in very low amplitudes that possibly have no bearing at all on de-
sign constraints it is not generally dwelt upon, and the focus of investigations lie with
the general characteristics that are pronounced in design sensitive amplitudes.

One often cited alternative damping model is called Coulomb damping, with energy dis-
sipated through sliding friction (in other words, external friction). In this case the dissi-
pative force is not velocity dependent as in the case of viscous damping but rather it has
a constant value, whereas the direction of this force varies as the direction of motion,
i.e. direction of velocity, changes. The solution of this problem is not particularly diffi-
cult but now the problem is that of forced vibrations. Analysis of this problem shows
that the decay predicted by Coulomb damping is linear, as opposed to the exponential
decay of viscous damping; the mass does come to a stop in finite time, however, since
the energy of the system eventually fails to overtake friction. The fact that exponential
decay seems to match better with experimental evidence is one reason that Coulomb
damping has not gained much precedence in structural dynamics.

Another damping model which goes by different names including structural damping
or hysteretic damping aims to model dissipation through internal friction. The motiva-
tion for this type of damping comes from observations regarding energy dissipation of
systems oscillating harmonically, as a single degree of freedom system would when it
reaches steady state under a harmonic forcing. A thorough understanding of this state-
ment requires forced vibration analysis, but to provide a qualitative perspective we
note that viscous damping leads to a closed, elliptic hysteresis loop whose size depends
on the frequency of loading (which in steady state becomes the frequency with which
2.5. GENERALIZED SDOF SYSTEMS  67

the system moves). Hence, viscous damping or the energy it dissipates is sometimes re-
ferred to as frequency dependent. Experimental observations have shown however that
hysteresis loops tend to be independent of frequency in a wide range of systems and
frequencies. The structural damping model has been proposed to reflect this frequency
independent property, which may be mathematically achieved by treating the stiffness
as having a complex valued part. The analysis of this model is however more involved
and particularly not so simple for free vibrations.

2.5 Generalized SDOF Systems

2.5.1 Continuous Systems

When the mass and flexibility of a system are distributed, it becomes necessary for a pre-
cise formulation to treat the system as continuous, and the state of the system is defined
as functions of both space (comprising all the points included in the system's domain)
and time. Due to this continuity, such systems have infinite number of degrees of free-
doms governed by partial differential equations, and their response shows considerable
complexity compared with the simple SDOF model. In certain cases, however, single
degree of freedom models may yield reasonable estimates of prominent dynamic char-
acteristics of complex systems provided that the deformation patterns are estimated
relatively accurately.

Consider for example a cantilever beam as shown in Figure 2.13; this could be a chim-
ney with possibly variable cross section of bending rigidity8  = (), length ,
mass per unit length  = () = (). Analysis of the vibration problem for this
system requires that the equations of motion be formulated in terms of the displace-
ment field  = (, ) and one will obtain a partial differential equation, which in
the case of variable section will be nonlinear, that must be solved. We will eventually
deal with vibrations of simple continuous systems but at this stage such an approach
is simply not feasible. The experience gained through analyses of such systems have
however shown us that they have many frequencies with which they may oscillate, and
that they maintain some particular shapes when they oscillate harmonically with any
of those frequencies. This behavior could be exploited and a great simplification would
be achieved if the shape of vibration could somehow be foreseen. This of course is not
practically possible, but it turns out that a reasonable estimate of how the structure

    8Recall from basic strength of materials that the bending rigidity of a homogeneous linear elastic bar
is the product of the material's modulus of elasticity  and the cross sectional area's second moment 
about the bending axis.
68 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS
would behave may lead to acceptable results.

Figure 2.13: A tall chimney.

We feel it is best to proceed by demonstration, so let us continue the simplified analy-
sis of the chimney. We will assume that during free vibrations the chimney oscillates
harmonically with a certain frequency and that during these oscillations it maintains
a constant shape albeit with varying amplitude so that the at any instant , the lateral
displacement of the section at location  is given by

(, ) = ()()                   (2.35)

where  = () is called the shape function and  = () is a time dependent ampli-
tude, generally corresponding to the actual displacement of a particular point. Equa-
tion 2.35 is a variation of the method of separation of variables since instead of solving
for possible candidates via the governing equation of motion, the shape function in this
case is specified by the analyst. There are some guidelines as to how this choice may be
improved. First the restraints: the shape function should satisfy the geometric bound-
ary conditions because only by doing so it can be ensured that the solution will satisfy
those conditions. Since in our example the chimney is fixed at  = 0, at any instant
2.5. GENERALIZED SDOF SYSTEMS                                               69

during motion we should have no translation or rotation at  = 0:

                   (, )|=0 = 0,           (, )  = 0
                                              =0

If we are to use the approximation of Equation 2.35, these conditions are satisfied at

all times only if

                   (0) = 0,               d  = 0
                                          d =0

To simplify the presentation, let us introduce the following notation to denote deriva-
tives with respect to a spatial variable, such as  in this example:

                    = () = d() ,                  d2()
                                       d   =  () = 2
                                                  d

With this notation, the geometric conditions may be written more simply as

                   (0) = 0, (0) = 0                                         (2.36)

and we note that, whatever shape function  we choose for the chimney, we should at
a minimum ensure that the conditions in Equation 2.36 are satisfied. Satisfaction of
these condition, however, is not sufficient to ensure acceptably accurate results since
the approximation will improve only if the shape function truly resembles the actual
shape taken on by the system. Various proposals have been discussed to ensure ac-
ceptable results, including choosing the shape function as the deflected shape of the
structure under some static loading. As the possibilities are numerous, here we will fo-
cus on the procedure and we will try to provide some worked examples to investigate
the performances of differing shape functions.

For our chimney, we will choose the unknown amplitude  to be the displacement at
the tip, i.e. we choose ()  (, ). The shape function now will have to be a func-
tion which will satisfy the geometric boundary conditions at the fixed end, i.e. (0) =
0, (0) = 0, but it will also have to satisfy () = 1 at the tip since by choice
(, ) = ()() = (). Two simple candidates could for example be:

                   () = 2 or () = 1 (1 - cos  )
                   2                        2     

Having specified a shape function, we are now ready to proceed with the analysis. The
method of choice is virtual work, which requires that d'Alembert forces be included.
70 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

At any point along the chimney the acceleration is given by the second time derivative
of (, ), and our approximation leads to

                                         2 
                           () =  ()  2 =  ()

                                                       

since the shape function is constant in time. For the segment of width d and located
at position , the d'Alembert force to be acted on it at time  is given by

[ d]()

acting in the direction opposite to that of the acceleration9 so that per unit length, the
d'Alembert force is given by (). These forces are included in the free body di-
agram shown in Figure 2.13 (c), which also includes the reaction forces at the base
(i.e. the fixed end). Since with the inclusion of the d'Alembert forces the system is in-
stantaneously in a state of static equilibrium, the principle of virtual work dictates that
in a virtual variation of displacements, the virtual internal work has to be equal to the
virtual external work:

                                         = 

The virtual displacements are generated by a variation in the single free parameter 
because  is prescribed, and so the virtual displacement pattern is given by

() = ()  (2.37)

where it should be noted that while  = (, ) and  = (),  is a function only
of the spatial coordinate and neither  nor  are functions of time.10

Since the shape function satisfies the geometric boundary conditions, there will be no
translation of rotation induced at the fixed end during the virtual displacement, and
the work done by the reaction forces at the base will be zero. The only external work

    9To clarify this statement: when free body diagrams are sketched, we consider an instant at which
 and its time derivatives are (considered to be) positive valued, and sketch all the forces in accordance
with this setup. This ensures compatibility with assumed sign convention: when the sign of  or its
derivatives change, so do automatically the directions of the associated forces, and there is no need for
explicit corrections.

   10Reminder: virtual displacements are some non-zero patterns that are imposed on the structure in
a fashion that is independent of time, as if time was frozen at that particular instant at which the system
attained a state of static equilibrium. A virtual displacement hypothetical, a thought experiment if you
wish, and not an actually imposed displacement.
2.5. GENERALIZED SDOF SYSTEMS                                           71

done is that due to the d'Alembert forces, which may be calculated via

                                                    

                      =  -[ d][]

                                                 0
                                                           

                              = - [ 2 d]  = -

                                                        0

where                                           
is called the generalized mass.
                                  =  2 d

                                              0

The internal work is slightly more involved with various components that may be taken
into consideration. To keep the derivation relatively simple, let us assume that bending
deformations dominate and that bending is uniaxial during motion. Under the assump-
tion of cross sections remaining plane and perpendicular to the neutral axis, which is
the pillar of the well known Euler-Bernoulli beam theory, the geometry of deformation
is completely described by the displacement  = (, ) and its spatial derivatives. Let
the rotation of the cross section at  be denoted by  = (, ). This rotation is related
in general to the displacements through

                                              = 
                                                   

so that for the approximation considered, we have

                                  =    = 

and the virtual rotation imposed due to the variation  is given by

                                  = 

Another key geometric quantity is the curvature, expressing the variation of the slope
along the elastic curve11. For small displacement gradients, it is shown in all introductory
strength of materials texts that the relationship between rotation and curvature  =
(, ) is given by

                                            d =  d

   11Elastic curve is a name given to the deformed shape of a beam's longitudinal axis.
72 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

so that curvature is related to the displacements through
                                               2

                                        = = 2
                                               

For the generalized SDOF approximation we therefore have
                                  =    = 

and the relative virtual rotation d() of two infinitesimally close cross sections may
be expressed in terms of the virtual curvature as

                               d() = () d = () d

Figure 2.14: Bending moments and rotations in a beam. (a) Undeformed configuration,
(b) real rotations of two infinitesimally close cross sections and the bending moments
acting on them, (c) virtual rotations imposed.

The work done by the internal bending moment  (, ) acting on the cross sections

at  and  + d depends on the relative rotation of these two cross sections. As the rota-

tions vary due to the virtual displacements as schematically shown in Figure 2.14, the
net virtual work done by the bending moments is given by  d() =   d if

we neglect the work done by d since the product of d with any other infinitesimal

quantity is expected to be of second order. In uniaxial bending of a linear elastic bar,

the bending moment  =  (, ) is related to the curvature through the well known

expression                       2  
             =  =  2 =  

                                 

so that the virtual work done by  as it goes through the incremental difference of

virtual rotation may be expressed as

             d() = () ( d) = ()2 d
2.5. GENERALIZED SDOF SYSTEMS                       73

and the total internal work done may be calculated by integrating over the whole length
so that

                                           

 =  ()2 d = [ ()2 d]  = 

       0                                0

where                     

             =  ()2 d

                       0

is called the generalized stiffness.12

The principle of virtual work demands that the external virtual work must be equal to
the internal virtual work so that we have

 = - =  =   [ + ]  = 0

and since this condition must be satisfied for all admissible virtual displacements,
i.e. for any admissible , it must be that

            () + () = 0                             (2.38)

The similarity of this final equation with the standard equation of motion for the pro-
totypical SDOF model is obvious, but we feel that the notational difference involv-
ing the superscript asterisk is worthwhile to emphasize that the generalized SDOF
approach involves significant further approximations compared with the more con-
ventional SDOF models.

An estimate for the natural frequency of the system is now given by

                                         =          (2.39)
                                                  

which may be shown to provide an upperbound for the lowest frequency of the real sys-
tem.13 The approximation would get better as the assumed shape  resembles more

   12Here we have considered only bending deformations to keep the discussion relatively simple. It
is possible to include the contributions of other deformations, including for example shear and axial
deformations, in the calculation of virtual work as well.

   13Although the details are to be provided in latter chapters, it should be mentioned here that while
a single DOF system has only a single frequency with which it freely vibrates, multi DOF systems have
multiple frequencies with which they may freely vibrate. The lowest of those frequencies is often the
one that is most significant in the vibrations of such structures and so a good estimate of that lowest
frequency is quite helpful.
74 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

and more the actual shape the structure oscillates with. While it may not be possible to
perfectly estimate the true shape, it is possible to improve the estimates; one could, for
example, try a few alternative proposals for  and take the minimum of the estimated
frequencies obtained via each shape.

For historical reasons it should be mentioned that this approach is sometimes referred
to as Rayleigh's method, wherein an approximating function defined over the whole do-
main is used to estimate the frequency of a complex system. One could use a set of
approximating functions, defined again over the whole domain, which may be used to
estimate multiple frequencies, and this approach is generally called the Rayleigh-Ritz
method. One could also divide the domain and use approximating functions in each of
the sub-domains, leading to what is commonly referred to as the finite element method
of analysis, which is very suitable for computer based analysis of structures.

2.5.2 Discrete Systems

Discrete systems refers in dynamics to those systems which may have distributed flexi-
bility but their mass is assumed to be concentrated at a finite number of points on the
system. This concentration leads to a finite number of degrees of freedom, as opposed
to the uncountable number in continuous systems, so that these systems are generally
referred to as multi degree of freedom (MDOF) systems. An MDOF system is governed
by a set of coupled ordinary differential equations, as many as the number of degrees
of freedom, and many frequencies with which it may oscillate. The analysis of motion
is therefore much more involved compared to the analysis of an SDOF system. On the
other hand, it may be possible also for MDOF systems to obtain acceptable estimates
for the fundamental (lowest) frequency of the system using the generalized SDOF ap-
proach.

To again proceed with an example, let us consider a simple three story structure with
rigid floors, represented as three single bay frames vertically stacked as shown in Fig-
ure 2.15(a), with masses concentrated at the floor levels. It is assumed that the struc-
ture is symmetric so that translation along one horizontal direction is uncoupled from
rotation of the floor plates in their own plane and translation along the orthogonal
horizontal direction; axial deformations are altogether ignored. This is called the shear
building model, and it is frequently used for buildings of different heights.14 The defor-
mation pattern is prescribed by the lateral translations of the floors, denoted here by
1 = 1(), 2 = 2() and 3 = 3(). Generalization of the approach is much easier

   14This is essentially a model comprising masses in series, each executing one dimensional motion,
connected to each other by springs that deform under relative motion of the neighboring masses.
2.5. GENERALIZED SDOF SYSTEMS  75

                          Figure 2.15: A three story shear building.

is matrix notation is used, so let us define a displacement matrix  = () as

                                               { 1 }
                                             2 

                                               { 3 }

where it should be obvious that if there were  -many floors, the dimension of  would
be  ×1. Lateral translation of the floors are resisted by deformations in the structural
load bearing members, most importantly the columns, in such a way that the cumula-
tive lateral story stiffness (including all contributions) is assumed to be equal to  for the
th story, and the force-displacement relationship is assumed to be linear. The internal
forces that develop as a result of the motion of the floor masses is in general much more
complicated, including axial forces and bending moments at the ends of the columns
in addition to lateral shear forces, and the structural behavior will most probably non-
linear under significant displacements. When axial deformations are neglected and the
floors are assumed to be rigid, however, the axial forces and moments in the columns
are not associated with any inertial action and hence they are not explicitly treated in
the dynamic analysis. When they need to be determined, they may be calculated using
standard structural analyses methods once the dynamic response is evaluated.

The generalized SDOF approximation for discrete systems is based on assuming a time
independent displacement pattern with an unknown amplitude, as was done for con-
tinuous systems, with the displacement pattern defined not by a shape function ()
76 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

defined over the whole domain but rather by a shape matrix  such that

    () = ()                                                                 (2.40)

which, when written out explicitly for an  -DOF model, may be expressed as

 1()   1 
{{ 2() }} { = { 2 }} ()
                                                                            (2.41)
{{  }} {{ }}
  ()    

The time dependent variable  is generally defined to be the amplitude of response

that would be observed at one of the degrees of freedom. For our three story frame, for
example, we could choose   3; in this case, the shape matrix may be chosen as

          { 1/3 }
     = { 12/3 }

          

if we foresee a linear increase with height, or perhaps as

    { 5/10 }
     = { 1 8/10 }
         

if relatively larger deformations are expected in the lower stories. Obviously the

choices are endless, and the only guide is an estimate of how such a structure would

possibly behave. In any case, once the shape matrix is fixed, the virtual displacements
are obtained only through a variation in  so that

     = 

By virtue of the shear building model's inherent assumptions, the internal virtual work
done through the virtual displacements will comprise the work done by the end shear
of the columns alone. Consider two consecutive floors, floor  and  - 1, with the
th story columns between them, as shown in Figure 2.16. The cumulative shear force
obtained by summing the shear forces at one end of the columns is called the story shear
, which is the total force transmitted by the story. If the stiffness of the story is ,
then this shear force is given by  = ( - -1) since the difference  - -1 is
the deformation which the columns of that story suffer;15 this relative displacement

   15For ease of discussion we define 0  0 which corresponds to the base of the first story columns.
2.5. GENERALIZED SDOF SYSTEMS                                  77

is also called the interstory drift. The work done by  as the floors go through virtual
displacements  and -1 is given by

                - -1 = ( - -1) = ( - -1)

which, after substituting in the force-displacement relationship and the generalized
SDOF approximation, leads to

            ( - -1)2

and the total virtual internal work done will be a summation of all the contributions

so that,16

            

             = [ ( - -1)2]                                     (2.42)

            =1

            Figure 2.16: Lateral shear forces at column ends.

The term in the brackets in Equation 2.42 may be expanded and then rewritten as a
matrix equation so that, for example, for our 3-story shear frame,

 (--1)2 = {1 1 3} 3  -2 2 + 3 -3 1 + 2 -2 0  2 =  {1}  [K]
                               0                   { }
=1                                -3 3  3

where the superscript [] denotes the transpose of the matrix [] and [K] is the stiffness
matrix of the system, a concept well known from static analysis but written here for

   16Again we are defining 0  0 for ease of presentation, which is of course consistent with the pre-
vious definition 0 = 0 = 0 since the shape approximation should satisfy the geometric boundary
conditions as in the case of continuous systems.
78 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

dynamic degrees of freedom. The total virtual internal work may finally be expressed
as

                            = ( [K])  = 

where               =  [K]

is the generalized stiffness of the system.17

The external virtual work for the shear frame is relatively easier to calculate. The ac-
celeration of the -th floor mass is given by  =  and the associated d'Alembert

forces are shown in Figure 2.15(c). The work done by the d'Alembert force on the -th
floor as that floor goes through the virtual displacement  =  is

                   - ()  = - ()2 

and, going through steps similar to those undertaken in derivation of the internal work,
the total external virtual work for our 3-story frame may now be evaluated via

       3                                                   1 0     00  2  {1}
 = - [  ()2]  = {1                                         
                                               1  3     }    0  2
                                                                                { }
       =1                                                   0 0 3 3

       = - ( [M])  = -

where [M] is called the mass matrix of the system, and
                                          =  [M]

is its generalized mass.
The by-now-familiar steps follow: principle of virtual work demands we must have

      = - =  =   [ + ]  = 0

and since this condition must be satisfied for all admissible virtual displacements it

must be true that

                   () + () = 0

   17Before concluding, we should note that one could consider the free body diagram of each floor mass
separately wherein the shear forces would have to be considered as external forces acting on the mass
and the whole virtual work would be written as that due to external forces alone. This has no bearing
on the final outcome since then the forces would change direction and the end result would not alter by
one bit.
2.5. GENERALIZED SDOF SYSTEMS  79

which is identical to Equation 2.38. Once again, an estimate for the fundamental fre-
quency of the system is provided by:

                                           =  
                                                     

2.5.3 Damping and External Forces

Having established the basic approach, we may begin to include additional complexities
in our model. To this end let us consider again the chimney and the shear frame, but
with some dampers and external forces acting on them as shown in Figure 2.17.

Let us start with the chimney shown in Figure 2.17(a). The displacement field is once
again  = (, ), and the generalized SDOF approximation is given by (, ) =
()(). In addition to our previous investigation, this chimney is acted upon by a
distributed external force  = (, ) defined per unit length, and two external damping
devices connected to a rigid frame, with damping coefficients 1 and 2. These exter-
nally connected dampers are possibly not common applications but here they simply
serve the discussion; more on this will be said later on. We have already shown that the
internal work done by the bending moments during a virtual displacement is given by

                                                                  

                             = [ ()2 d] 

                                                                0

and the external work done by the d'Alembert forces is given by

                                                                         

                             - = [ 2 d] 

                                                                      0

so that we need only derive the contributions of the new components.

The external force acting on the section at  is  d. When the chimney goes through
virtual displacement  = , this force does work of amount

                                          [ d] []

so that the total work done by the distributed force may be evaluated by integrating the
contributions along the height as

                                                        

                                  [  d]  = 

                                                     0
80 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 2.17: (a) Chimney with external loads and dampers, (b) free body diagram of the
chimney, (c) shear frame with dampers, (d) story shears due to dampers.
2.5. GENERALIZED SDOF SYSTEMS                                             81

where  = () is called the generalized force.18

The forces acted on the chimney by the dampers are proportional to their velocities of
deformation. The velocity of deformation for the damper located at position  =  is

   = ()                        

  =

and therefore the force acted upon the chimney by the damper is given by

  ()

with the direction shown in the free body diagram of Figure 2.17(b). The force acts at
 =  so that during virtual displacements, the point of application of the force moves
by an amount () so that the virtual work done by this force is equal to

                        -[()][()] = -2()

The cumulative contribution of such dampers to the external virtual work is then cal-
culated by a summation over all the dampers to obtain

- [ 2()]  = -

         

where  is referred to as the generalized damping.19

The principle of virtual work is the same as always but now with additional terms con-
tributing to the work expressions so that we have,

 =  = - -  +   = 

which may be expressed as [ +  +  - ]  = 0. Since this condition
must be valid for arbitrary , it must be true that:

 +  +  =                                                                  (2.43)

   18There may be many components of the external force and the generalized force will then be the
superposition of all the contributions; it is essentially the coefficient that multiplies  in the calculation

of the work done by all external forces.
   19Again, there may be other contributions to the damping, and at the end of the day generalized (vis-

cous) damping is the name given to the coefficient of the velocity in the virtual work expression.
82 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

This is the general equation of motion that governs the dynamics of generalized SDOF
systems, and its similarity with the previously discussed equation for the prototype
SDOF model is obvious. We may at this point say a few words about the damping term
. It has already been mentioned that viscous damping is a phenomenological model
that has been found to represent observed behavior acceptably well in most cases; as
such, it is almost impossible to define a viscous damping coefficient if there are no ac-
tual physical viscous dampers as in this example. What will most probably happen is
that there will not be such dampers but the damping coefficient will have to be some-
how estimated. As before, it is relatively easier to approach the problem via the damp-
ing ratio coefficient so that, by defining

                                   2 = 
                                              

Equation 2.43 may be expressed as

   + 2 + ()2 = 1                                (2.44)
                                   

As previously discussed for the prototype SDOF model, estimating  based on previ-

ous experience with similar systems will almost always be much easier than trying to
estimate  and the equation of motion for the generalized SDOF is most often formu-

lated in the form of Equation 2.44.

Analogous expressions will be observed while working with discrete systems. Consider

for example the three story shear frame of Figure 2.17(c), acted upon by three forces

and stories supplemented with dampers. The floor displacements are once again given
by  = {1 2 3} and the generalized SDOF approximation is defined through
 = {1 2 3} . We have already shown that the virtual external work done by
the d'Alembert forces is given by

  - = - [M]

and now we have to additionally consider the virtual work done by the externally ap-
plied forces  = {1 2 3} . As the -th floor moves through the virtual displace-
ment  = , the virtual work done by the force  acting on that floor is simple
 = . The total virtual work done by the applied forces is then given by

  = [ ]  = [ ]  = 

  
2.5. GENERALIZED SDOF SYSTEMS                                                83

where  is called the generalized (external) force. This work will have to be added to
that done by the d'Alembert forces.

As for internal virtual work, it was previously shown that the virtual work done by the
lateral load bearing system was equal to:

                                  = ( [K]) 

The addition of dampers between floors will lead to additional shear forces transmit-
ted via stories. The forces at the two ends of a damper are given by the product of the
damping coefficient with the relative velocity across the two ends causing the defor-
mation of the damper, so that the additional interstory shear across the -th story is
given by ( - -1) = ( - -1). The internal virtual work done by these
end shears is to be calculated as

            ( - -1) - ( - -1)-1 = ( - -1)2

and the contribution of the dampers to the internal virtual work is obtained by sum-
ming the contributions of all stories:

            [ ( - -1)2] 

                 

Similar to the case regarding stiffness terms, the summation in the brackets may be
written as a matrix product; e.g. for our three story shear frame,

 ( - -1)2 = {1 1 3} 3  -2 2 + 3 -3 1 + 2 -2 0  2 =  {1}  [C]
                               0                                        { }
=1                                                     -3 3  3

so that

            [ ( - -1)2]  = ( [C])  = 

                 

where  =  [C] is called the generalized damping, and [C], given in this specific

example by

                    1 + 2       -2                      0
                               2 + 3                   -3
            [C]  =    -2                                3 
                                -3
                    0

is called the (viscous) damping matrix of the system.
84 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

With these additions, principle of virtual work yields

 =  +  = - +   = 

which may be expressed as [ +  +  - ]  = 0. Since this condition
must be valid for arbitrary , it must be true that

                         +  +  =                        (2.45)

which, as expected, is identical in form to Equation 2.43. Damping again deserves a
special mention: It is rare to find buildings equipped with such dampers as investigated
in the discussion above, and the concept of generalized damping will most often refer
to a conceptual mechanism, as referred to previously in the analysis of the chimney.

2.5.4 Epilogue

The introduction of the generalized SDOF approximation has been via examples, and
we agree that there are advantages and disadvantages associated with this choice of pre-
sentation. The discussion may be considered to lack a generality that could be reached
through a more rigorous theoretical introduction, a shortcoming we have tried to alle-
viate by referring along the way to what the formulations would look like if we were to
consider more general cases. We believe, however, that the generalized SDOF approx-
imation is essentially very much dependent on intuition regarding structural behavior,
and that its introduction through examples helps to establish a better understanding
of the step-by-step procedure while presenting the fundamental issues. For quick ref-
erence, we present in Table 2.1 the fundamental equations that will most probably be
encountered while developing and analyzing generalized SDOF models for relatively
simpler systems.

Table 2.1: A summary of expressions commonly used in generalized SDOF approxima-
tions.

Approximation           Beam (1-D, bending)             Discrete (N-DOF)
Generalized mass 
Generalized stiffness   (, ) = ()()                       () = ()
Generalized force              2 d                            [M]
Frequency                                                     [K]
                            ()2 d                               
                                 d
                                                               same
                           = /
2.5. GENERALIZED SDOF SYSTEMS                                    85

Generalized damping   Beam (1-D, bending)   Discrete (N-DOF)
Equation of motion                         2 or  [C]
                             2   
                      () + () +                     same

                         () = ()

There are of course still many cases that one could concoct which we have not explicitly
addressed here. That being said, we hope the discussions have been detailed enough
so that should such new challenges arise, the fundamental tools and techniques dis-
cussed above will suffice to help the reader deal with those challenges. An immediate
question is whether or not this method could be extended to two or three dimensions
in continuous systems, as for example the case would be for analysis of plate vibra-
tions. It should be somewhat straightforward to assume that the extension would be
possible by defining shape functions in two or three dimensions, but the expressions
we derived for the relatively simple beam (chimney) would have to be modified since
force-deformation mechanisms will in general have additional complexities . It is not
feasible within the confines of this books to analyze deformation patterns of all possible
structural elements, but relevant information may be accessed in texts dealing with ad-
vanced strength of materials and structural analysis. The main flow of the generalized
SDOF approximation, however, would still be that presented herein.

The generalized SDOF approximation is a powerful tool although its usefulness these
days may be questioned since, with the increase in computational power and the strict
performance criteria established in more recent decades, analyses of structural dynam-
ics problems are almost exclusively executed with specialized software tailored to han-
dle large numbers of degrees of freedom. Still, we feel that the generalized SDOF model
is a very good teaching tool, forcing the applier to think about dynamic behavior and
various concepts at a relatively early stage. Many of the more advanced analytical and
numerical methods used for analyses of complex structures may be better appreciated
with an understanding of the generalized SDOF approximation. It is also important for
experienced engineers in that it provides an easy to apply tool for sanity checks when
evaluating numerical results obtained via other tools.
86 CHAPTER 2. FREE VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS
Chapter 3

Forced Vibrations of Single Degree of
Freedom Systems

While investigation of free vibrations is a necessary starting point in discussions, criti-
cal performance issues are encountered almost always during forced vibrations while
the system is acted upon by external load effects, either in the form of external forces
or support motions such as those occurring during earthquakes. We'll see that, while
only the excitation amplitudes matter in static analyses, how the excitation varies with
time and in relation to the time constants of the system matters as much, if not even
more, in dynamic analyses. So let us begin by introducing some typical excitation pat-
terns that are frequently encountered, hoping to lay the groundwork for the tools we
will have to introduce for solution of various problems.

A static force is essentially a force of constant magnitude and direction. In principle,
it is impossible to apply any load instantaneously, but when the duration it takes for
the load to reach its peak value is much smaller in comparison with the period of the
system, it may be feasible to model the load as what is called a step function, an ex-
ample of which is sketched in Figure 3.1 (a). In this model the load is assumed to be
applied instantaneously and it is relatively simple to handle analytically. The response
of a damped SDOF system will eventually settle to the response one would obtain by
static analysis, given by the ratio of the amplitude of applied force to the stiffness of the
system. A larger peak response may however occur before this steady value is attained,
which may be an important issue in certain applications.

On the other end of the spectrum is a force of very small duration relative to the period
of the system, an example of which is sketched in Figure 3.1 (b). If the force duration is

                                                87
88CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.1: Various types of forces frequently encountered in dynamic analysis. (a) con-
stant (step), (b) impulsive, (c) harmonic, (d) periodic, (e) numerically defined, (f) random.

very small compared to the reaction time of the system, the effect is similar to imposing
some initial velocity to the system. Such forces are called impulsive; as the force dura-
tion decreases to what one would call to be instantaneous, the force is mathematically
modeled as an impulse. It is possible to obtain an analytical solution to the response of
an SDOF system to an impulse and, moreover, this solution may be used to construct
the response of a system to some arbitrary excitation.
Dynamic effects start to be more pronounced when one considers a harmonic excita-
tion like the one shown in Figure 3.1 (c). When the duration of the force is long rel-
ative to the period of the system, the system will eventually start to oscillate with the
frequency of the force during what is called the steady-state response. We will investi-
gate this type of input in great detail since it will be shown that a very critical condition
called resonance occurs when the frequency of excitation approaches that of the system.
Resonance is critical because the maximum response of the system under resonance
may reach multiple times of the static response it would show under the same ampli-
tude of force, with the amplification factor being some function of damping. As this
phenomenon is the cause of many failures in real life, understanding it is of paramount
importance.
It may be that the force is not just a single harmonic wave but it comprises repetitions
of some particular pattern as is the case shown in Figure 3.1 (d). When the duration
of the force is long compared with the period of the system, such a repetitive force is
called periodic. Under a periodic force the response will also eventually reach a repeti-
tive cycle called the steady-state response; in that case the analysis may be conducted
3.1. GENERAL METHODOLOGY              89

by modeling the periodic force as the superposition of a number of harmonics, and cal-
culating the response as the superposition of the response to each harmonic, using the
tools developed for the analysis under a single harmonic force. Periodic forces are im-
portant because the presence of multiple harmonics may lead to various risks regarding
resonance.

Most often, however, we will have to deal with forces that are somewhat arbitrary in
that their time variation can not be characterized analytically, as sketched in Figure 3.1
(e). In such cases, if the values of the excitation are known at points in time, the re-
sponse may be evaluated via numerical techniques. We will introduce some numerical
techniques that may be used in a wide variety of systems. Earthquake response calcula-
tions are generally based on such numerical methods since ground motions, which act
as inputs to structures, are of such arbitrary nature, as numerous recordings of earth-
quake induced ground vibrations have shown.

In some cases it may not be possible to even measure the input. Some of such forces,
an example of which is sketched in Figure 3.1 (f), may be modeled using tools and tech-
niques from analysis of random processes, and the response of a system subject to such
inputs is generally referred to as random vibrations. Random vibrations are generally
analyzed in the frequency domain since random inputs are more easily characterized in
that domain though their spectra. Although random vibrations are important in some
applications, our focus in this chapter will be introducing basic analysis tools and un-
derstanding of forced vibrations.

3.1 General Methodology

To develop the general method for developing analytical solutions to forced vibrations,
let us once again consider the prototypical SDOF model, shown for ease of reference
again in Figure 3.2. The equation of motion for the system, obtained by summing the
forces shown in the free body diagram and considering initial conditions, is given by

() + () + () = () ; {(0) = , (0) = }  (3.1)

Studies in differential equations tell us that the solution to Equation 3.1 may be con-
structed via two components as

                                     () = () + ()

where () is referred to as the complementary solution, given by the solution to the
90CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.2: (a) Viscously damped single degree of freedom system and (b) its free body
diagram including the d'Alembert force.

homogeneous equation so that

() + () + () = 0

and () is referred to as the particular solution satisfying

() + () + () = ()

The particular solution will depend on the forcing function and so it must be deter-
mined anew for each different type of force, whereas the complementary solution for
an underdamped system will always be given by some form of

() = e- (1 cos  + 2 sin )                                    (3.2)

where 1 and 2 are two coefficients to be determined. The existence of these two
coefficients is what allows us to solve the problem since that freedom is needed to in-
corporate the contribution of initial conditions, something that the particular solution
alone cannot do. That the superposition of the complementary and the particular so-
lutions still satisfy the force equilibrium equation is trivial due to the linearity of the
differential equation since

 [ + ] +  [ + ] +  [ + ]
               = [ +  + ] + [ +  + ]
               = [0] + [ +  + ] = ()

The linearity of the governing equation has even more significant consequences which
has proven extremely useful in analysis: since superposition holds, the simultaneous ac-
tion of a number of disturbances may be analyzed by evaluating the response of the
3.1. GENERAL METHODOLOGY  91

system to each individual disturbance separately, and then superpose all the solutions
thus obtained to evaluate the cumulative response; the principle is schematically ex-
plained in Figure 3.3. To express this statement symbolically, if (1) is the response of
the system to some input inp(1) and if (2) is its response to some input inp(2), then the
response of the system will be given by (1) + (1) when the system is acted upon by
both inputs simultaneously, i.e. by inp(1) +inp(2). If the inputs are amplified so that the
system is acted upon by 1inp(1) + 2inp(2), then the responses to individual inputs
will likewise be amplified so that the system response will be given by 1(1) + 2(1).
Note that we have used the more generic term input to denote the effect that sets the
system in motion for it can refer to a set of initial conditions and/or external forces
and/or base motion; all of these may be investigated separately and the results thus
obtained may then be combined to calculate the response that would occur under the
combined action of all. We may therefore finally state the following: Let (1) be the
solution to the initial condition problem

      (1)() + (1)() + (1)() = 0 ; {(1)(0) = , (1)(0) = } (3.3)

so that it is given for a viscously underdamped system by

                     (1)() = e- ( cos  +  +   sin )

                        Figure 3.3: Superposition in linear systems.

as we had shown while discussing free vibrations. If the same system were subjected
only to some external force with zero initial conditions, the response (2)() would
have to satisfy1

      (2)() + (2)() + (2)() = () ; {(2)(0) = 0, (2)(0) = 0} (3.4)

    1That the initial conditions are zero DOES NOT mean the complementary solution has to be zero;
(2) will still need a particular and a complementary component.
92CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

When the system is subjected to both the external excitation () and the nonzero ini-
tial conditions (0) = , (0) = , the response () would have to satisfy

() + () + () = () ; {(0) = , (0) = }            (3.5)

and the linearity of the system allows superposition so that () is simply given by

() = (2)() + (2)() = e- ( cos  +  +   sin ) + (2)() (3.6)

This result will allow us to investigate all forced vibration problems with zero initial
conditions as the additional contribution of any nonzero initial condition may simply
be superposed afterwards.

3.1.1 Constant Force: Step Input

Let us start with the case of a constant force shown in Figure 3.4, defined mathemati-
cally as

                                      () = {   0
                                                  0 <0

Figure 3.4: Constant force (step function)

For   0, the underdamped system is governed by

() + () + () =  ; {(0) = 0, (0) = 0}            (3.7)

and the complementary solution is given by

() = e- (1 cos  + 2 sin )                       (3.8)
3.1. GENERAL METHODOLOGY                                                  93

We have to find the particular solution before evaluating the unknown coefficients

since the initial conditions are to be imposed on the actual response, not just the com-

plementary part. As the forcing function is a constant, we may initially try a constant

particular solution of the form

                                 () =                                     (3.9)

Substituting the trial solution of Equation 3.9 into the equation of motion in Equa-
tion 3.7 leads to2

                                       0 + 0 +  = 

so that we conclude the particular solution to be of the trial form with

                                 =
                                        

which, it should be noted, is equal the static displacement

                                  = 

if this were a static problem. Now the solution becomes

  () = e- (1 cos  + 2 sin ) +                                             (3.10)

and applying the initial conditions lead to

        (0) = 1 +  =0  1 = - 
(0) = -1 + 2 =0  2 = -    1 - 2

so that the solution is finally obtained as

() =  [1 - e- (cos  +  sin )]                                for   0      (3.11)
                                             1 - 2

How the system responds to the force and the effects of damping on the response may
be most easily visualized via the plots sketched in Figure 3.5. There are a few impor-
tant things to be noted. First of all, in the presence of damping, the response eventually
converges to the static displacement; how fast this convergence occurs depends on the

    2This approach is commonly referred to as the method of undetermined coefficients.
94CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

amount of damping with faster rates occurring for larger damping values. Results ob-

tained via static analyses are therefore the asymptotic values the dynamic responses

eventually settle to whenever the duration of the load application is long enough. An-

other point worth making is that the maximum response that occurs may exceed the

static response and the peak value depends again on the amount of damping. In fact,

the velocity as a function of the normalized time  = / may be shown to be given

by

                      () =  e-  sin             (3.12)
                        1 - 2

Figure 3.5: Response to a constant force (step function) for various values of damping
ratio (noted in percentage) as a function of normalized time  = / .

which will take on a value of zero for  > 0 whenever  is a positive integer multiple
of , or in other words, whenever

                       =  =   for  = 1, 2, ...
                           2

which corresponds to

                       =  = 1 for  = 1, 2, ...
                           2

i.e. whenever  is a positive integer multiple of 1/2. Therefore, the first peak is reached,
if at all, when  = 1/2, i.e. halfway through the first cycle when  =  /2, and the value
of the peak displacement is given by

                       =  [1 + e-/1-2 ]
3.2. LINEARLY INCREASING FORCE: RAMP INPUT                                      95

so that for an undamped system we have
                                             = 2
                                             

and for damping values of  = 5%,  = 20% and  = 50% the amplification above
will be calculated as 1.85, 1.53 and 1.16, respectively.

3.2 Linearly Increasing Force: Ramp Input

Consider a linearly increasing external force as shown in Figure 3.4. This force, having
a rate of increase of 1 (unit of force/unit of time), is defined mathematically as

() = {   0
           0 <0

so that for   0, the underdamped system is governed by

() + () + () =  ; {(0) = 0, (0) = 0}                                            (3.13)

Figure 3.6: Linearly increasing force (ramp function).

The complementary solution is still given by Equation 3.8. Since the right hand side of
the equation is a linear function of , for the particular solution, we may try

() =  +                                                                         (3.14)

which leads, when substituted into the equation of motion of Equation 3.13, to

0 +  +  +  = 
96CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

In this case, the coefficients of the left and right hand sides of the equation may be
matched to conclude

  1                                            2 1 2
  = , =- 2 =- 2 =-
                                                   

so that the solution  =  +  is of the form

() = e- (1 cos  + 2 sin ) + 1 [ - 2 ]                      (3.15)

Applying the initial conditions leads to

  (0) = 1 - 2  =0  1 = 2 

                                            1      22 - 1
(0) = -1 + 2 + =0  2 =
                                                      

with the final solution now given for   0 by

() = 1 [e- (2 cos  + 22 - 1 sin ) +  - 2]                  (3.16)
                                            1 - 2

Having determined the solution for a unit rate, we may easily extend this solution to
the case when the rate of increase of the force is not unity but some  so that the force
is defined as

                                     () = {   0
                                                 0 <0

and the system is governed by

() + () + () =  ; {(0) = 0, (0) = 0}                       (3.17)

Due to the linearity of the system, the principle of superposition summarized in Fig-
ure 3.3 allows us to conclude that when the input is scaled by some value , the output

will also have to be scaled by the same value so that the response will simply be given
for   0 by

() =  [e- (2 cos  + 22 - 1 sin ) +  - 2]                   (3.18)
                                            1 - 2
3.2. LINEARLY INCREASING FORCE: RAMP INPUT  97

Figure 3.7: Response to a linearly increasing force (step function) for various values of
damping ratio (noted in percentage) as a function of normalized time  = / .
98CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

which of course includes the initial problem as a special case with  = 1. If the system
is undamped, then using  = 0 in Equation 3.18 leads to

   () =  [ - sin ] for   0               (3.19)
            

A graphical comparison of the variation of response with damping in this case is not
as straightforward as it was in the response to a step function. To help discuss general
trends, Figure 3.7 presents the responses that would be observed for a particular system
for various values of the damping ratio. The normalized time used in these plots is  =
/ which differs from that used for previous investigations in that here we use the
undamped period as opposed to the damped one. To help facilitate a visual reference,
the plots also include what may be referred to as instantaneous static response ( )/.
The tendency of the response is to converge to some percentage of the instantaneous
static response. Since  = 2 , for an undamped system we have

( ) - ( ) =  2 -  [2 - sin 2 ] =  sin 2
                            

so that the response oscillates around the instantaneous static response. On the other
hand, whenever there is damping in the system we have, from Equation 3.18,

lim [ ( ) - ( )] =  2 -  [2 - 2] = 2 
                              

so that eventually the transient vibrations die out and the steady state response tracks
the force with a certain lag that depends on the damping ratio for a given system and
force.

3.2.1 Input Shifted in Time

Consider what the response would be if the step and the ramp forces of the discussions
above were applied not at time  = 0 but they started to act at some time  =  as
shown in Figure 3.8.

Since the coefficients in the differential equation are time invariant, or in other words
since the mass, damping and stiffness properties of the system remain unaltered as time
progresses, the solution to these problems is relatively straightforward. Let us take the
step input to begin with. The problem statement for zero initial conditions is given by

         () + () + () =  ; {() = 0, () = 0} for   
3.2. LINEARLY INCREASING FORCE: RAMP INPUT                               99

If we define a new time variable  =  - , then

  d = d d = d ,                   d2 d2
  d d d d                         d 2 = d2

so that the problem may be stated in terms of this new time variable as

( ) + ( ) + ( ) =  ; {(0) = 0, (0) = 0} for   0

Note that this is exactly the same problem as that in Equation 3.7, with  replacing .
The solution may therefore immediately be written following Equation 3.11

( ) =  [1 - e- (cos  +  sin  )]                for   0
                                  1 - 2

and substituting  =  -  leads to

() =  [1 - e-(-) (cos ( - ) +  1 - 2 sin ( - ))] for   

                     Figure 3.8: Step and ramp inputs shifted in time.

As the methodology described above is general, the conclusion is obvious: since the
coefficients of the linear equation of motion are time invariant, a time shift in input
results simply results in a shift in the output. If, for example, the initial conditions for
the system were nonzero at time  =  so that the system were to be governed by

        () + () + () =  ; {() = , () = } for   
100CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

then, based on equations Equation 3.6 and Equation 3.11 wherein we replace  by -,
and  and  by  and , respectively, the response would be given by:

 () = e-(-) [ cos ( - ) +  +   sin ( - )] +

        [1 - e-(-) (cos ( - ) +  1 - 2 sin ( - ))] for   

Similarly, if an underdamped SDOF system, initially at rest, is subjected to the ramp
function shown in Figure 3.8 so that it is governed by

() + () + () = ( - ) ; {() = 0, () = 0} for   

then its response is obtained simply by shifting the solution in Equation 3.18 as:

() =  [e-(-) (2 cos ( -  22 - 1 ) + sin ( - )) + ( - ) - 2]
                                    1 - 2

3.2.2 Constant Load Applied in Finite Time

To model the fact that it is not physically possible to instantaneously apply a load, let

us consider a forcing function which starts from 0 and increases linearly to some value
 in duration , called rising time, after which it remains at the constant value of  .
Such a loading, shown in Figure 3.9, is described mathematically by

                                    0   < 
           {                          
  () = { 
           

There is more than one way to approach this problem, as will probably be the case in
many of the problems that will be considered throughout this work. One approach is to
make use of the results previously derived and construct a solution via superposition.
Assume the system is underdamped and initially (at time  = 0) at rest. The system
is governed by two different equations, one corresponding to each force segment, as
follows:

() + () + () =   ;                  {(0) = 0, (0) = 0}  for 0   < 
                                                        for   

() + () + () =  ; {() = , () = }
3.2. LINEARLY INCREASING FORCE: RAMP INPUT                           101

         Figure 3.9: Force linearly increasing to a constant value.

The solution to the first part for 0   <  is simple in that it is given by Equation 3.18
with  =  /:

() =  [e- (2 cos  + 22 - 1 sin ) +  - 2]                             (3.20)
             1 - 2

The second part is essentially a problem we have investigated in Section 3.2.1, with
a shifted step input and non-zero initial conditions with  = . The solution was
shown to be given for    by

        () = e-(-) [ cos ( - ) +  +   sin ( - )] +

               [1 - e-(-) (cos ( - ) +  1 - 2 sin ( - ))]

wherein the initial conditions  and  will have to be determined as the values from
the last instant governed by the solution to the first part. Substituting  =  in Equa-

tion 3.20 yields

    () = [e- (2 cos  22 - 1  + sin ) +  - 2]
             1 - 2

The time derivative of  may be obtained from Equation 3.20 as

         () =  [1 - e- (cos  +  sin )]                               (3.21)
             1 - 2

so that

           () =  [1 - e- (cos    +  1 - 2 sin )]
102CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Although we have obtained the full solution, the presence of damping somewhat makes
the algebra complicated and the presentation symbolically overloaded; let us therefore
first simplify the results by considering the undamped case with  = 0. When there is
no damping, the solution reduces to

 1   [ - sin ] for 0   < 
{
() =     
{ cos ( - ) +  sin ( - ) +  [1 - cos ( - )] for   

The initial conditions for the second part will be given by

     =   [   - sin ] ,  =  [1 - cos   ]                                  (3.22)

and substituting these into the solution leads, after some algebra and trigonometric
combinations, to

            /                                                for 0   <   (3.23)
           { [ - sin ]                                       for   
   () = 
            /
           { [ - sin  + sin ( - )]
            

The response is very sensitive to the value of the rise time  in relation to the system's
period  as signified by the ratio / . Some trends may be observed better by writing
the solution in terms of a normalized time  = / and replacing  with 2/ so that

         sin 2                   for 0   < (/ )
( ) { (/ ) - 2(/ )               for   (/ )
      =  sin 2 - sin 2( - (/ ))                                          (3.24)
 / {1 -
         2(/ )

A somewhat interesting result is observed when it is noted that whenever (/ ) is
some integer, sin 2 - sin 2( - (/ )) = 0 since the sine of an angle is the same
as the sine of the same angle plus any integer multiple of 2. In such cases, the response

after the rise time becomes equal to  / and no oscillations occur. Incidentally this

corresponds to those cases in which the velocity of the system at the end of the ramp

loading is zero. For non-integer values of (/ ), the behavior is determined by the
magnitude of the ratio: if (/ )  1 (load is applied very slowly relative to the period
of the system), the maximum response is close to  /, which again could be considered

as the static response of the system. At the other end, if (/ )  1 (load is applied
3.3. HARMONIC FORCE EXCITATIONS  103

very quickly compared to the period of the system), the maximum response is close
to 2( /); recall that in the limiting case of an instantaneously applied step load we
had previously shown the maximum response to be 2( /)3. The variation of the
ratio ( )/( /) with the relative rise time (/ ) is examplified for various cases in
Figure 3.10.

Figure 3.10: Normalized response of an undamped system to step input with a fi-
nite rise time for various values of (/ ). The dashed lines corresponding to
(( )/)/( /) are presented to indicate the behavior of the force.

3.3 Harmonic Force Excitations

We have already seen that the nature of vibrations occurring in an SDOF system depend
significantly on the time variation of the input relative to the period of the system. This
dependence may lead to catastrophic outcomes in the case of repeated loads under
which the amplifications in the response may become excessively large so as to induce
failure. The most significant parameter in the response to repeated loads turns out to

    3As (/ )  0, Equation 3.24 may be shown to converge to 1 - cos 2, which is the same result
as that obtained for the step input applied instantaneously.
104CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

be the ratio of the frequency of excitation to the frequency of the system. Therefore
we start the discussions of this phenomenon with the analysis of response to a single
frequency input in order identify critical issues. The results developed for this case
may then be used to investigate the responses to a broader set of repeated loads with
the help of a well-known expansion that has been used in many branches of engineering
sciences.

A harmonic excitation is essentially a single frequency sinusoidal wave. A harmonic force

may be expressed as

                     () =  sin ( - )            (3.25)

where  is the amplitude,  is the excitation frequency, and  is the phase angle of
the force. When analyzing long term behavior the phase generally does not have a
significant bearing on design critical issues so that most often it is neglected (i.e. 
is assumed to be 0); we will however consider the possibility of a nonzero phase to
promote a general discussion.

We will assume that such a force acts on our system for a long duration4, long enough so
that the transient vibrations have died out completely and the system is in what is called
to be steady state. Recall that the forced vibration response of a viscously underdamped
system is given by

             () = () + () = e- (1 cos  + 2 sin ) + ()

so that as  progresses, the exponential term tends to die out; hence the name transient
vibrations. As the transient vibrations die out, the response is defined more and more
solely by the particular solution, and this state of things is referred to as steady state
vibrations. Since a harmonic excitation by assumption acts for a long duration, we shall
initially neglect the transients and focus solely on the steady state. This does not mean
that the critical response is observed always during steady state vibrations; it may be
that for some cases the maximum deformation in the system occurs before the tran-
sients die out. It turns out, however, that the worst of the worst occurs for particular
ranges of the excitation frequency and in those cases the transients play an insignificant
role.

3.3.1 Dynamic Amplification

The steady state vibrations under the action of a harmonic force are governed by

                     () + () + () =  sin ( - )  (3.26)

    4As will be observed in numerous investigations, all time related adjectives such as `long' and `short'
are relative to the period of the system.
3.3. HARMONIC FORCE EXCITATIONS                                                       105

or equivalently, after dividing through by ,

      () + 2() + 2() =  sin ( - )                                          (3.27)
                                        

where it should be mentioned that no initial condition information is provided simply
because the effects of initial conditions are irrelevant for steady state vibrations. When
the forcing function is harmonic the response may be expected to be harmonic as well
since, at the end of the day, the left hand side of equation ought to match the right
hand side at all times, and therefore appearance of sines and cosines on the left hand
side should not come as a surprise. A trial solution for steady state vibrations may
therefore be formulated as

      () = 1 cos ( - ) + 2 sin ( - )                                       (3.28)

which, when substituted into Equation 3.27, leads to

   [-21 + 22 + 21] cos ( - ) +
                      [-22 - 21 + 22] sin ( - ) =  sin ( - )

and equating the coefficients of the sines and cosines on both sides leads to

      (2 - 2) 1 + 22 = 0                                                   (3.29)

                             -21 + (2 - 2) 2 =                             (3.30)
Solving for the coefficients , one obtains,

1 =   (-2)            2,                      2 =     (2 - 2)

 (2 - 2) + (2)2                               2 2         2             2
                                                      ( -  ) + (2)

and after dividing the nominators and denominators by 4 we get

1 =   -2              2,                      2 =     1 - 2

       (1 - 2) + (2)2                                 22             2
                                                      (1 -  ) + (2)

where  is the ratio of the excitation frequency to the frequency of the system, i.e.

            = 
                  
106CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Since the response is given by

     () = 1 cos ( - ) + 2 sin ( - )

these two harmonics may, via the expansion sin ( - ) = sin  cos  - cos  sin , be
combined into a single wave, as was done on numerous previous instances, to obtain

() =  sin ( -  - ) =  [sin ( - ) cos  - cos ( - ) sin ] = (- sin ) cos ( - ) + ( cos ) sin ( - ) (3.31)

so that we have 1 = - sin  and 2 =  cos , leading to:

                  =  2             +  22,  tan  = -1/
                                                      2/
                            1

The amplitude  of the response is therefore given by

  =  2         +  2             =            1        =  (, )                      (3.32)

            1        2              (1 - 2)2 + (2)2 

where  / would be the response that would be observed if the force of amplitude 
were to be applied statically, and

      = (, ) = 1 =                                                                 (3.33)
                        (1 - 2)2 + (2)2  /

is called the dynamic amplification factor.5 With this definition, the phase angle  may
now be shown to be defined through

                                tan  =     (2)/                                    (3.34)

                                        (1 -  )/2

and it is implied by definition that 0    .

The dynamic amplification factor is a measure of increase in maximum response due
to the harmonic application of the force, depending on ratio of the frequencies and
available damping. How this amplification factor varies as a function of the ratio of
frequencies is naturally of greatest importance, and this variation is shown graphically
in Figure 3.11, along with variations of the phase angle, for various levels of viscous
damping. A few characteristics of these curves deserve special mention:

5Note that by definition the dynamic amplification factor is a positive quantity.
3.3. HARMONIC FORCE EXCITATIONS  107

Figure 3.11: Variation of the dynamic amplification factor  and the phase angle  with
ratio of frequencies, plotted for various levels of viscous damping.
108CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

    i) For all levels of damping,   1 as   0. This is mathematically obvious as
       the limit of the expression in Equation 3.33, and it may physically be interpreted
       in a few different ways:

          a) For a given excitation with some finite, non-zero excitation frequency ,
                0 implies   , which in turn requires   0 for a system with
              finite stiffness. If so, then the inertial forces would be very small compared
              to the deformational forces so that () could be neglected in compari-
              son with () and the governing differential equation would effectively
              simplify to () =  sin ( - ) with the response given by

                                           () =  sin ( - )
                                                     

              and the system would deform in phase with the force (  0). A massless
              spring represents a limiting case as the spring simply deforms in phase with
              the force ( = 0), with the maximum deformation be given by  =  /.
          b) For a given excitation with some finite, non-zero excitation frequency ,
                0 implies   , which in turn requires    for a system
              with finite mass. Also in this case inertial forces could be neglected beside
              deformational forces so that () could be neglected compared to ()
              and the governing differential equation would again effectively simplify to
              () =  sin ( - ). The ratio of maximum deformation to  / is
              again given by /( /) = 1, no matter how small  and  / are due to
              the very high value of .
          c) For a given system with some finite, non-zero frequency ,   0 implies
                0, which would mean that the force is applied ever so slowly and no
              significant accelerations develop, again allowing us to neglect () com-
              pared to (), with the governing differential equation simplifying once
              again to () =  sin ( - ), and the previous conclusion follow.

   ii) For all levels of damping,   0 as   . This result is also obvious mathe-
       matically as the limit of the expression in Equation 3.33, and the physical system
       may correspond to one of the following:

          a) For a given excitation with some finite, non-zero excitation frequency ,
                 implies   0, which in turn requires    for a system with
              finite stiffness. If so, then the inertial forces would be very large compared
              to the deformational forces so that () could be neglected in compari-
              son with () and the governing differential equation would effectively
3.3. HARMONIC FORCE EXCITATIONS                           109

    simplify to () =  sin ( - ), the integration of which leads to:

                 
    () = - 2 sin ( - )

               

       The minus sign implies that the response is out of phase with the force
       (  ) so that whenever the force reaches a maximum, the displacement

       reaches a minimum and vice versa. Clearly the maximum deformation
       tends to zero as  gets larger; in the limit, the inertia of the system is so

       great that no force can get it to start moving.
    b) For a given excitation with some finite, non-zero excitation frequency ,

          implies   0, which in turn requires   0 for a system

       with finite mass. Also in this case deformational forces could be neglected
       beside inertial forces so that () could be neglected compared to ()

       and the governing differential equation would again effectively simplify to
       () =  sin ( - ), leading to the same conclusions as in (ii.a).
    c) For a given system with some finite, non-zero frequency ,    im-
       plies   , which would mean that the time variation of the force is

       extremely fast and significant accelerations develop as the mass tries to
       respond, again allowing us neglect () compared to (). The gov-
       erning differential equation would again effectively simplify to () =
        sin ( - ) and the response would be given by

                 
    () = - 2 sin ( - )

               

    which would tend to zero as  gets larger and larger.

iii) The dynamic amplification factor reaches a peak value somewhere in the vicinity

of  = 1 when damping levels are low. We can investigate the derivative of the

dynamic amplification factor with respect to  to locate the extremum points:
d/ d becomes zero at  = 0 and  = 1 - 22 for   1/ 2, while for
 > 1/ 2 the derivative is zero only for  = 0. Therefore whenever  
1/ 2  71%, the maximum value of the dynamic amplification factor is given

by                               1  1 1
    max = =1-22 =
                                           2              (3.35)
                                 2 1 -  2

where the last approximation is valid for small values of the damping ratio. To
provide some numerical justification, for a damping ratio of  = 10%, which
is not so small in terms of damping ratios frequently encountered in structural
110CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

       dynamics, the exact value for the amplification factor is 5.05 whereas the ap-
       proximate value is 5.00, with the error of approximation about 1% or, in other
       words, practically completely negligible.

If the damping is zero, the amplitude of the dynamic response tends to infinity as
 = (/)  1, and this phenomenon is called resonance. This infinite response
is of course purely theoretical as the system would either yield or break if the defor-
mations were to exceed critical levels but nevertheless the possibility of such large in-
creases, no matter how small the amplitude of the forces is and purely due to the time
variation of the force, is most significant. The large peaks observed in the vicinity of
 = (/) = 1 when viscous damping is present are also very significant as they
may lead to excessive deformations not accounted for in design, and these will also be
referred to as resonance to allude to the nature of phenomenon. Resonance leads to
such significant increases in demands that it should definitely be avoided if possible,
most probably by changing the design to modify the frequency of the system and mak-
ing sure that it does not coincide with the possibly dominant frequencies of expected
excitations.

3.3.2 Response of Undamped Systems

The curves in Figure 3.11 are very significant for design purposes as they indicate
the most critical deformations that SDOF systems are likely to suffer under harmonic
forces, but they do not represent the whole picture regarding the time variation of the
response. Let us first investigate an undamped system's response over time for various
values of  = /, sketched in Figure 3.12. The system is initially at rest and the
force is given by () =  sin ( - ). Since the system is undamped, for all   1,
Equation 3.32 and Equation 3.34 lead to6

= =   1,     ={  arctan  0  =  0  <1
                         1        >1

   (1 - 2)2      arctan -1 = 0

Since the phase angle is either zero (for  < 1) or  (for  > 1), the particular solution
may be written with the help of the expansion sin ( - ) = sin  cos  - cos  sin 
as

                                () =  cos  sin ( - )

    6When  = 1, the particular solution used for   1 is also the complementary solution and so the
particular solution needs to be modified as we will soon see.
3.3. HARMONIC FORCE EXCITATIONS  111

Figure 3.12: Response of an undamped SDOF system, initially at rest, to the harmonic
force () =  sin ( + (/2)) =  cos , for various values of  = /. The
plots are for time normalized by the period of the force, i.e.  = /(2/). Thin (blue)
lines correspond to normalized force ( )/ and are presented for visual comparison

of time shifts between the input and the response.
112CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

so that () = () + () is given by

    () = 1 cos () + 2 sin () +  cos  sin ( - )

When the system is initially at rest, evaluating  leads to                 (3.36)
    () = [sin  cos  cos  -  cos  cos  sin  + cos  sin ( - )]
     /

so that if, for example, () =  sin () with  = 0, the response is given by

                      () = [- cos  sin  + cos  sin ]
                       /

whereas if () =  cos () with  = -/2, the response is given by

                      () = [- cos  cos  + cos  cos ]
                       /

where, in all cases concerning undamped systems, cos  = 1 if  < 1, and cos  = -1
if  > 1. Expressing the result in Equation 3.36 in terms of normalized time  =
/(2/), i.e. normalizing time with the period of the excitation frequency, we obtain

( ) = [sin  cos  cos ( 2  ) -  cos  cos  sin ( 2  ) + cos  sin (2 - )]
 /                                

                                                                           (3.37)

and we use Equation 3.37 to develop the response time histories shown in Figure 3.12

for  = 0.1 and  = 3.0, with  = -/2. Note that since the system is undamped,

the so-called transient solution never dies out, and in fact the maximum response may

easily exceed what the particular solution, i.e. the dynamic amplification factor, alone

predicts. The phase difference  between the input and the output is not easily identi-

fied from these plots since the response comprises not only the particular solution but

also the transients.

When  = 1, i.e. when  = , the particular solution  =  sin ( - ) may no
longer be employed since when  = ,  =  sin ( - ) satisfies the homoge-

neous equation. The particular solution for this specific case is given by

 = [1 cos ( - ) + 2 sin ( - )] = [1 cos ( - ) + 2 sin ( - )]

where  are constants yet to be determined. Substituting this proposal in the equation
of motion given by

    () + () =  sin ( - ) =  sin ( - )
3.3. HARMONIC FORCE EXCITATIONS                            113

and solving for  yields:                           2 = 0
                                  1 = -    2 ,

The total solution is given by

                 () = 1 cos () + 2 sin () -    2  cos ( - )

so that with the system initially at rest, one gets 1 = 0 and 2 =  cos /(2), and
the response is given by

                      () = cos  sin  -   cos ( - )         (3.38)
                       / 2                      2

For the specific case of  = -/2 and using normalized time  = /(2/), the

response is given by  ( ) =  sin (2 )
                       /

and this final form is the one plotted in Figure 3.12. Two characteristics of the response
are immediately obvious from this plot: i. The sinusoidal component is multiplied by
a linearly increasing envelope so that the response amplitude continuously increases,
leading to an infinitely large response as   , ii. the response reaches its local
peaks and troughs when the force is zero, so that the phase difference between the
input and output is given by  = /2, a result that is not obvious at a first glance from
Equation 3.34.

3.3.3 Response of Damped Systems

The behavior is qualitatively different in the presence of damping as it should be ex-
pected. The particular solution is still given by Equation 3.31 but the complementary
solution is given, for a viscously underdamped system, by Equation 3.2, i.e.

                            () = e- (1 cos  + 2 sin )

Evaluating the coefficients for a system initially at rest leads to

 / () = e-[sin ( + ) cos  + ( 1-2  sin(+)- cos(+) ) sin ]  (3.39)
           + sin ( -  - )
114CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

which may be expressed, using normalized time  = /(2/), as:

 / () = e-2/[sin ( + ) cos  21-2  + ( 1-2  sin(+)- cos(+) ) sin  21-2  ]

+ sin (2 -  - )

                                                             (3.40)

Let us see how the response develops in the presence of relatively small amount of
linear viscous damping, plotted in Figure 3.13. These plots show the response of an
SDOF system, with  = 1%, during the first ten cycles of the input. When  = 0.1,
the transients die out by the time about 6-7 cycles of input are completed, and the
steady state response starts to completely govern, with response amplitude   /
and phase   0. Since  = 0.1, the system's (undamped) frequency is ten times
bigger than the forcing frequency, and so the system's period is about ten times smaller
than the period of the input; therefore, by the time the input completes one full cycle,
the transient response completes about 10 cycles, and hence we can see the transient
response decaying almost completely by the end of 6-7 cycles of input. The situation is
reversed when  = 3.0, since now the system's period is 3 times longer that the period
of the input; therefore, by the time the input completes ten full cycles, the transient
response completes only a bit more than 3 cycles, and hence it is still very much alive.
The dominance of the steady response is therefore not obvious and the presence of two
distinct frequencies is still felt at  = 10; nevertheless, the amplitude of the response
clearly indicates the decrease in the dynamic amplification factor as  exceeds 1.

Obviously the most interesting case is again that of near resonance, and we see that
contrary to the unbounded increase observed in the undamped case, damping leads
to a response converging to some finite value when  = 1. As the transients com-
plete about 10 cycles, the convergence is not finalized in the segment shown; in fact,
for this amount of damping, the undisputed dominance of the steady state response
requires about 50-60 cycles to be completed. This relatively delayed convergence is
observed clearly in Figure 3.14 where the exponential decay of the response amplitude
is tractable, and the response eventually converges to a steady state amplitude given
by 50  1/(2) = 1/0.02 as previously discussed while the dynamic amplification
factor was investigated.

3.3.4 Beat Phenomenon

A curious phenomenon becomes predominantly evident in the response when the ex-
citation frequency and the frequency of the system are close in an undamped system.
The response of an undamped system, initially at rest, to the external force () =
3.3. HARMONIC FORCE EXCITATIONS  115

Figure 3.13: Response of a lightly damped ( = 1%) SDOF system, initially at rest, to
the harmonic force () =  sin ( + (/2)) =  cos (), for various values of
 = /. Time is normalized by the period of the force, i.e.  = /(2/). Thin
(blue) lines correspond to normalized force ( )/ and are presented for visual com-

parison of time shifts between the input and the response.
116CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.14: Response of a lightly damped ( = 1%) SDOF system, initially at rest, to
the harmonic force () =  sin ( + (/2)) =  cos (), for  = / = 1.
Time is normalized by the period of the force, i.e.  = /(2/).

 sin ( + (/2)) =  cos () was shown to be given by

    () = [- cos  cos  + cos  cos ]
     /

When the response comprises two harmonics, it may be written, using trigonometric
identities7, as the product of two harmonic waves: one of frequency equal to the aver-

age, and the second equal to half the difference of the original two frequencies. For this

particular case, it may be shown that:

() =  cos [- cos  + cos ] = -2 cos  sin (  -  ) sin (  +  )
 /                                                 2  2

This product of two sine waves is generally interpreted as one modulating wave with
frequency of modulation, called the beat frequency, equal to ( - ),8 and a second
wave, of frequency equal to the average given by ( + )/2, whose amplitude is mod-
ified in a time dependent manner by the modulating wave. The resulting pattern is
shown in Figure 3.15 which shows the response for the case  = / = 0.94. If this
were a sound wave, one would hear a note with a perpetually changing strength so that
it would get loud and then quiet and then loud again and so on. Such a phenomenon is
not very common but certainly possible in structural dynamics, with the more impor-
tant considerations appearing in multi degree of freedom systems in which this beat

    7sin( ± ) = sin  cos  ± cos  sin ,
cos 2 = 1 - 2 sin2  = 2 cos2  - 1

    8The beat frequency is defined as the difference and not the half of the difference of the two fre-
quencies, a choice based on the fact that the time between the peaks (or zeros) of modulation is given by
2/( - )
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  117

phenomenon generally corresponds to a back-and-forth transfer of energy between
different types of motion.

Figure 3.15: Beat phenomenon in an undamped SDOF system subjected to a harmonic
force () =  cos () with  = / = 0.94. Time is normalized by the period of
the force, i.e.  = /(2/).

3.4 Pulse Response and Impulse Response Function

A subclass of inputs called pulse type inputs (or simply pulses) are useful to model exci-
tations that are relatively of short duration. The response of an SDOF system to such
inputs will be qualitatively different than those we have so far considered in that due
to the short excitation duration the system will not reach steady state conditions, and
most of the oscillations will be free vibrations instigated by the energy the input im-
parts to the system.

Figure 3.16: Pulse type forces: (a) arbitrary shaped, (b) rectangular pulse, (c) half-sine
pulse, (d) triangular pulse.

A pulse type loading often does not have a well-defined shape, such as the one shown
in Figure 3.16(a). For analytical treatment pulses are often modeled in simpler shapes,
such as the rectangular pulse of Figure 3.16(b), the half sine wave of Figure 3.16(c), and
the symmetrical triangular shape of Figure 3.16(d). Analyses of these simpler shapes
118CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

could be expected to give some indication of how SDOF systems respond to pulses
and the effects of the pulse shape on the observed behavior.

3.4.1 Rectangular Pulse

Let us start with the rectangular pulse of Figure 3.16(b) since we have previously devel-

oped solutions to step inputs. We'll analyze this problem twice, once by direct solution

and once via superposition, to provide some exercise in possible approaches. The force

is defined by

               () = {        0   <               (3.41)
                          0    

where  is generally referred to as the pulse duration. Assuming the system is viscously
underdamped and initially at rest, the system will be governed by

     () + () + () =  ; {(0) = 0, (0) = 0} for 0   <  (3.42)

      () + () + () = 0 ; {() = , () = } for    (3.43)

We have already solved both cases: The solution to the step input of Equation 3.42
is given by Equation 3.11 and restated here for convenience, including the region of
validity:

() =  [1 - e- (cos  +  sin )]        for 0   <   (3.44)
                         1 - 2

The displacement and velocity of the of the system at  =  may be evaluated via
Equation 3.11 and Equation 3.12 and they are given by

  () =  [1 - e- (cos  +  1 - 2 sin )]            (3.45)

                 () =    1 - 2 e- sin            (3.46)

so that, based on the discussions of Section 3.2.1, the free vibration of the system for
   in response to Equation 3.43 is given by

() = e-(-) [ cos ( - ) +  +   sin ( - )]         (3.47)
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION    119

To gain some physical insight into how response characteristics change depending on
the relative duration of the pulse, we may start by evaluating the response of an un-
damped SDOF system subjected to different pulses of same amplitude but varying rel-
ative duration. When the system is undamped, the expressions above may be used with
 = 0 to obtain the response, and doing so we get

                                     for 0   < 
       { [1 - cos ]                  for   
       () =                                          (3.48)
                       
       { cos (( - )) +  sin (( - ))
                       

with  
                =  [1 - cos ()] ,  =   sin ()        (3.49)

To generalize the discussion, normalized time  = / may be used and the relative

pulse duration explicitly identified as / so that the response normalized by  / is
given by9

() {[1 - cos (2 )]                                   for 0   < 
 / =                                                 for    
       { cos (2 ( - )) +        sin (2 ( - ))
        /                 ( /)                                 
                                                            (3.50)
where    =  [1 - cos (2   )] ,  =   sin (2   )
                                                            (3.51)

One immediate observation is that whenever / is a positive integer,  = 0 and
 = 0 so that no oscillations occur after the pulse ends.

How the response varies as a function of the relative pulse duration may be observed
from the cases shown in Figure 3.17. In all cases, the maximum relative amplitude is
capped by 2, which is the same as that observed when the system is excited by a constant
force. The response may not reach this maximum though, as clearly seen in the plots
corresponding to / = 0.05 and / = 0.20. The response in these cases looks
very much like free vibrations with some positive initial velocity. This observation may
be justified by the following argument: the well-known impulse - momentum equation,
derived from Newton's equation of motion for a particle, is given by

                   2

                [() - ()] d = (2) - (1)

                1

    9It is really not appropriate to talk of a static response in the case of a pulse loading but normalizing
the response by  / allows generalization of results to arbitrary  and .
120CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.17: Response of an undamped SDOF system to a rectangular pulse for various
ratios of pulse duration to system's period. The plots are for normalized time  = / .
Dashed lines correspond to normalized force ( )/ and are included to indicate the
duration of the excitation.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  121

where () - () is the resultant force acting on the mass of the undamped SDOF
system at time . The integral on the left hand side is called the (linear or angular) im-
pulse10 acting on the system, and the product  appearing on the right hand side is
the (linear or angular) momentum of the mass.11 Integrating from 1 = 0 to 2 =  and
remembering that the system we are investigating is initially at rest, we have:

                                                   

                                 [ - ()] d = ()

                                                0

If the pulse duration is very small so that /  1, then (), which is initially 0,
may be expected to remain in the near vicinity of 0 since it physically takes time for
the displacement response to build up during oscillations. In such cases, therefore, the
integral of  may be neglected, and the problem may be approximated by

                                                     

                                    d =    ()

                                                   0

which implies that when /  1 the response is that of free vibrations with zero
initial displacement and initial velocity equal to  /. Obviously for a finite ampli-
tude pulse, the impulse imparted on the system will get smaller as / gets closer to
zero so that when /  1 it may be argued that the maximum response generated
will remain much lower than the maximum response generated by pulses with same
magnitudes but longer durations.

An important discussion directly relevant for design is the investigation of the maxi-
mum deformation that occurs during the motion of the mass. The parameter we will
be concerned with is the absolute maximum deformation max defined as

                                       max = max |()|

                                                                         

where the notation || denotes the absolute value of . From the plots in Figure 3.17 it
may be observed that whenever / < 1/2, max occurs for the first time12 during
the free vibration phase (at some    or, equivalently, some   / ) while when-
ever /  1/2, max occurs for the first time during the forced vibration phase (at
some  <  or, equivalently, some  < / ). To discuss this phenomenon analyti-
cally, consider the following observations:

   10If the generalized coordinate is a unidirectional translation then we are talking about linear impulse
- momentum, whereas if it is a rotation about some axis then we are talking about angular impulse -
momentum, in which case  would be some moment of inertia and  would in fact be some moment.

   11In general this is a vector equation but here the scalar form suffices since the motion is one dimen-
sional.

   12Due to the periodicity of the response, max is observed at many instances in these cases.
122CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

 i) If /  1/2, then from Equation 3.48 for 0   < , we see that the response
    reaches the maximum possible value of 2 / at least once during the pulse. This
    value is reached only once if / = 1/2 and at time  =  =  /2; it thereafter
    may be reached at every integer multiple of  /2 if the pulse duration permits.

ii) If / < 1/2, then from Equation 3.48 for 0   <  we see that the maxi-
    mum response reached during the forced vibration stage is

                                        [1 - cos ] < 2

    since when / < 1/2,  < .
iii) The maximum vibration amplitude during the free vibrations, described by

    Equation 3.48 for   , is given by13

                                             ()2 + (  2 )
                                                            

which, after substituting the initial conditions from Equation 3.49, yields
                                  21 - cos ()
                                 

This expression may be recast, by using the identity
                                 cos 2 = 1 - 2 sin2 

to the following form:                       2  sin (  )

                                                 

where the absolute value is included as per definition of the absolute maximum
response.

Based on these observations, the following may be deduced:

i) If /  1/2, then

       max = max {2  , 2  sin (   )} = 2 

since                   sin (  )  1    1/2

                                                   

13Recall the discussions on free vibrations for how a sine and a cosine wave of the same frequency is

combined into a single sine or cosine wave.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION           123

ii) If / < 1/2, then

max = max {  [1 - cos ] , 2  sin (   )} = 2  sin (   )

since

       [1 - cos ] = 2 sin2 (   ) < 2 sin (   )       < 1/2
                                                      

These results therefore confirm the validity of the conclusions, deduced from a limited
number of cases, for all possible values of the ratio / .

Figure 3.18: Response of a damped SDOF system to a rectangular pulse for various
ratios of pulse duration to system's damped period and damping ratio. The plots are
for normalized time  = / . Dashed lines correspond to ( )/ and are included
to indicate the duration of the excitation.

The effects of damping may be observed in the response plots of Figure 3.18, where
two ratios of / (duration normalized by the damped period) are investigated for
various values of . The values of damping range from lightly damped systems ( =
5%) to heavily damped systems ( = 80%), and the maximum response decreases with
increasing damping for all ratios of / as expected. This observation helps to justify
the choice of investigating undamped systems as some upper bound on the response;
124CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS
for some instances though this upper bound may be too conservative and it may be
necessary to acknowledge the presence of damping.
The absolute maximum deformation that would occur in the damped system is smaller
than that which would be observed in the corresponding undamped system (identical
system and loading but with  = 0). The patterns discussed for the undamped system
persist for the damped systems: If /  1/2, max occurs at time  =  /2 with
magnitude14 given by

                                max =  [1 + e-/1-2 ]
whereas if /  1/2, max occurs at the first local maximum or minimum (peak or
trough) that occurs after the pulse ends.

          Figure 3.19: Rectangular pulse as combination of two step functions.

Before concluding the discussion on the rectangular pulse, we may also investigate how
the principle of superposition may be employed to solve for the response. The rectan-
gular pulse may be thought of as the combination of two step functions, one with a
positive and the other with a negative amplitude with the second one also shifted in
time, as schematically shown in Figure 3.19. The response for the first part, during
which only the first step function acts, is again given by Equation 3.44. In the second
part for which   , both step functions act and so the response will be the superpo-

   14We had previously derived this result while discussing response to a step function. Note that the
pulse duration is normalized with the damped period  in the damped cases.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  125

sition of the responses to each input:

() =  [1 - e- (cos  +  sin )] -
                         1 - 2

   [1 - e-(-) (cos ( - ) +  1 - 2 sin ( - ))] for   

That this expression is equivalent to the expression that would be obtained via Equa-
tion 3.45, Equation 3.46, and Equation 3.47 is not obvious but it may be shown after
some tedious algebra. Life is simpler if we consider the undamped case with  = 0 so
that the solution obtained via superposition simplifies to

   () =  [1 - cos ] -  [1 - cos ( - )] =  [cos ( - ) - cos ]
The previous solution we obtained in Equation 3.48.b and Equation 3.49 lead to

            () =  [(1 - cos ) cos ( - ) + sin  sin ( - )]
which, after using the often-employed trigonometric relations for cosines and sines of
angle sums, simplifies to

                             () =  [cos ( - ) - cos ]
as claimed.

3.4.2 Half-Sine Pulse

Let us now consider the response of an SDOF system to a pulse with a different shape,
in particular a pulse in the form of half a sine wave as shown in Figure 3.16(c). Such a
force would be defined mathematically as

                                        
                       { sin ( )          0   < 
  () =                                             (3.52)
                       {0

We have already seen that the undamped cases provide an upper bound to the response
quantities so let us concentrate on the analysis of undamped systems to identify possi-
ble effects of the pulse shape. An undamped SDOF system, initially at rest, would be
governed by

() + () =  sin (  ) ; {(0) = 0, (0) = 0} for 0   <    (3.53)
126CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

() + () = 0 ; {() = , () = } for                                              (3.54)

The first stage of the response, i.e. the stage defined by Equation 3.53, is the response
to a sinusoidal force excitation with frequency and phase given by

                = ,                        =0
                      

We already solved this problem in Section 3.3.2. For 0   <  the solutions given by
Equation 3.36 and Equation 3.38 lead to

() {[- cos  sin  + cos  sin ()]                                   =        1
    =                                                                
       1                          cos ()                                      (3.55)
 /     {  sin   -                                                 =     =  1
       2                        2                                    

For an undamped system we have

       = 1 ,                                = {0     <1                       (3.56)
             (1 - 2)2                                >1

so that both cases may be collected in a single expression as

                 cos  =                    1                                  (3.57)

                                           (1 -  )2

and Equation 3.55 may be rewritten as

       1        2 [sin () -  sin ]                             =        1
() {                                                              
       = (1 -  )                                                              (3.58)
 / {1   sin  -  cos ()
          2                        2                           =     =  1
                                                                  

Based on our experience with the rectangular pulse, we may foresee that the ratio of
pulse duration to the period of the system will be an important parameter. To track the
dependence on this parameter directly, we define

              =  = / = 1
                    2/ 2

so that Equation 3.58 may be expressed as

        42                                    1                     12
() { 2 [sin () - sin ()]                                           = 12
    = (4 - 1)                                 2                               (3.59)
 / 1                                   
       {2 sin () - 2  cos ()
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION                       127

and the velocity is given by

             2                                      12                  (3.60)
   () { 2 [cos () - cos ]                          = 12

         = (4 - 1)
    /  2

            {  sin ()
            2

The response in the stage    during which no force acts, governed by Equation 3.54,
are free vibrations defined by

   () =  cos (( - )) +  sin (( - ))                                     (3.61)

where  = () and  = () are to be calculated using the results at the end of
the forced vibration phase, i.e. from Equation 3.59 and Equation 3.60. Note that when

 = / = 1/2, we have  = , so that () = /2 and () = 0. Eval-
uating {, } and substituting them into Equation 3.61 leads, after some algebraic
manipulations using certain trigonometric relations,15 to

      -4                                               12
() { 2 cos  sin ( ( - ))                              = 12
   = (4 - 1)                                 2                          (3.62)
 / {   2 cos (( - ))

Using normalized time                 = 
                                           

the response to the half-sine pulse may now be expressed in condensed fashion as fol-
lows:

 42                                   1      0      <  , ,           1
{ 2 [sin ( ) - sin (2 )]                                             2
{(4 - 1)                       2
         {1
() { sin (2 ) -  cos (2 )                    0      <  ,       =  1
 / = 2 4                                                          2     (3.63)

{- 2 cos () sin ((2 - ))                          ,         1
{ (4 - 1)                                                   2
{
{- cos (2 )                                       ,    =  1
2                                                         2

   15cos( ± ) = cos  cos   sin  sin 
sin( ± ) = sin  cos  ± cos  sin 
cos 2 = 2 cos2  - 1 = 1 - 2 sin2 
128CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.20: Response of an undamped SDOF system to a half-sine pulse for various
ratios of  = / . The plots are for normalized time  = / . Thin dashed (blue)
lines correspond to ( )/ and are included to indicate the duration of the excitation.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  129

These equations are used to plot the various cases shown in Figure 3.20. When  =
/ is relatively small, the behavior observed for the case of a half-sine pulse is very
similar to that observed for a rectangular pulse, since then the response resembles very

much that of a system subjected to some initial velocity. The initial velocity depends
on the impulse 0 d imparted, and it is the amount of impulse rather than the shape
of the pulse that governs the response. At the other extreme, for  relatively large, the
effects of the pulse shape become much pronounced. Even for the case of  = 3 in Fig-

ure 3.20, we can see that the mean response follows the half sine wave with amplitude
fluctuations smaller than those observed for smaller  values. This trend continues
with increasing values of  so that eventually for truly large values of  the response
simply tracks ()/ as if the system responds pseudo-statically with negligible dy-

namical variations. The main difference between the long duration rectangular and

half-sine pulses is the sudden jump in the rectangular pulse in contrast to the compar-

atively slowly rising excitation in the half-sine wave, leading to dominant transients in

the case of the rectangular pulse that do not die out in undamped systems.

3.4.3 Response and Shock Spectra

Recall the prolonged analysis we presented while investigating how the maximum de-
formation varies depending on the duration of the rectangular pulse? The same ques-
tion is also pressing in the case of the half-sine pulse. More generally, it could be the
variation of maximum velocity, acceleration, or any other response related quantity
that we may want to track as some function of a defining parameter. A record of the
variation of some response quantity with a specific parameter when the system is sub-
jected to a particular excitation is referred to as a response spectrum. The idea of a re-
sponse spectrum is prominent in design because it is tailored to reflect the most criti-
cal case to be considered under a specific action. In the context of pulse-like inputs the
maximum deformation is often the most relevant design parameter,16 and the variation
of the maximum deformation with the duration and amplitude of the pulse excitation
is referred to as a shock spectrum. We will see later that the concept of response spectra
plays a pivotal role in aseismic design.

There are quite a few pulse forms that have been investigated besides the rectangu-
lar and the half-sine pulses we have analyzed in detail, with results published in many
specialized publications and handbooks.17 Here we just intend to introduce some sam-

   16An impact, for example, may be modelled as a short duration pulse-type loading and protection
against impacts is often a matter of limiting deformations with proper design. Blast type loadings are
also an important subclass.

   17See, e.g., Harris's Shock and Vibration Handbook, edited by C.M. Harris and A.G. Piersol, Fifth Edition,
130CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

ples for the concept and therefore limit our discussions to the shock spectra for the

two pulse types we have analyzed in the previous sections. Consider first the case of a

rectangular pulse type force which was investigated in some detail in Section 3.4.1. In

particular, it was shown that when an undamped SDOF system is acted upon by a rect-
angular pulse of amplitude  and duration , the maximum deformation max that
occurs in the system depends on the ratio of the pulse duration to the system's period,
i.e. / , so that

i) when /  1/2, max = 2  ,
ii) when / < 1/2, max = 2  sin (  ).
                            

Normalizing max with  / would provide a measure of the amplification observed in
the dynamic response compared with the static response one would observe if the same
amplitude of excitation were to be applied statically. Sometimes referred to as response
factors, such normalized response quantities may therefore be employed as indicators
for certain practices in which the maximum response amplitude is the sole critical pa-
rameter. A summary of results may be most readily shown on a simple graph depicting
the variation of max/( /) with / , such as the one shown in Figure 3.21.

Figure 3.21: Shock spectrum for a rectangular pulse, showing the variation of the maxi-
mum deformation that occurs in an undamped SDOF system subjected to a rectangular
pulse.

A similar discussion could be held for the case of the half-sine pulse although now the
algebra becomes more involved. The response of an undamped SDOF system to a half
sine pulse of amplitude  and duration  was shown in Section 3.4.2 (Equation 3.63)

McGraw-Hill, 2002; in particular Chapter 8: Transient Response to Step and Pulse Functions by R.S. Ayre.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION                                      131

to be given by

                1                                           <  , ,                        
         {                   2 [sin ( ) - sin ()]    0                                    2
         { 1 - ( /(2))         2
         {1
() { [sin () -  cos ()]                              0      <  ,                    =  
 / =  2  /                                                                             2

         {-                  2 cos ( ) sin (( - ))        ,                      
         { 1 - ( /(2))               2                                           2
         {
         {- cos ()                                        ,    =                 
         2                                                                       2

                                                                                       (3.64)

Let us start with the case of  =  /2 as it is easier to deal with. The forced vibration

phase, i.e. the time interval during which the force is acting, is described by

         () = 1[sin () -  cos ()] = 1[sin (  ) -   cos (  )]
 / 2                           2                               

where we have incorporated the information that for the case at hand,  =  /2. Ex-
treme values occur at instances  at which the time derivative of this expression is zero

so that         d(()/( /))     1 2      

                              =  2 sin ( ) = 0
                    d        = 2        

which yields either  = 0 or  = . It may be shown by substitution that the latter is

the value that leads to the maximum response whereas the first corresponds to the in-

stant of the minimum response. The maximum response that occurs during the forced

phase is therefore given by

                1 [sin (  ) -   cos (  )] = 
                2    = 2

We can not yet conclude that this is the maximum of all response (still for the particular
case of  =  /2) since the maximum that would be observed during the free vibration
phase, i.e. the time interval after the force stops acting, may exceed this value. The

response in the free vibration phase is described by

                   () = -  cos () = -  cos (  )
                    / 2           2                

which is a simple sinusoidal wave with amplitude /2. We therefore may conclude that
the maximum response that occurs in the system when / = 1/2 is given by /2.
132CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

The investigation of what happens when /  1/2 is more involved. The response
in the forced vibration phase is described by

          () =    1                  
                        2 [sin ( ) - sin ()]
           / 1 - ( /(2))             2

          = 1 - ( /(2))2 1 [sin (  ) -  sin (2   )]  2  

To find the time instances  at which the extreme values of this response occur, we
take the derivative of the expression above and set it equal to zero at  =  to obtain:

                  cos (  ) = cos (2  )
                                     

Since cosine is an even, periodic function with a period of 2, this condition is satisfied

whenever    = ±2  ± 2   = ± 2

                             1  (2/ )

where  is a non-zero integer. To account for all possibilities is important since at

this point it is almost impossible to conclude anything specific about what these values

lead to in the response. It may be shown by substitution that the response attains local

maximum values for the positive signs so that the values we are interested in are given

by               = 2

                 1 + (2/ )  for  = 1, 2, 3, ...

It should also be noted that not all values of  may be used for an arbitrary value of /
since the viable possibilities are those for which  <  because we are investigating
the forced vibration phase. For example, when / = 1, we have

                           = 2  < 1
                           3

which leads to a viable solution only for  = 1. For any   2, the values obtained
would not be valid since those values would lead to  > , and the response expres-

sion we are investigating is not valid in that range (that would be the free vibration

phase). The fact that only  = 1 is admissible means that there is only one local max-

imum (peak) in the response, a conclusion that may be verified by the corresponding

plot in Figure 3.20. This single peak occurrence persists until / = 1.5 since for
any / < 1.5,

                 > 2   > 1           for  = 2, 3, ...
           4              
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION                  133

With / = 1.5, the second peak starts to develop albeit with zero amplitude to begin
with. When / = 2, for example,

                                           = 2 < 1
                                           5

yields  = 1 and  = 2 as viable solutions, and hence indicates the existence of two
local maxima during the forced vibration phase. Similarly, the third local peak starts
to kick in after / = 2.5, and for / = 3, we have

                                           = 2 < 1
                                           7

leading to  = 1, 2 and 3, thereby indicating three local maxima. All of the cases above
may be observed in the plots in Figure 3.20.

The next issue to consider is to figure out which of these local maxima is the biggest of

all. This question may be dealt with analytically but a graphical approach is somewhat

easier and more informative. The local maxima in the forced vibration phase are given
by the response values at times  = , i.e.

() =         2 1 [sin (  ) -  sin (2   )]
 /  1 - ( /(2))                                    2       =

The first local peak is defined by
                                        = 2
                                        1 + (2/ )

so that if we want to plot how the amplitude of this local peak varies with the ratio
/ , we have to plot the variation of

1 - ( /(2))2 1 [sin ( 2 1 + (2 ) -  sin (2  2 )] / ) 2  1 + (2/ )

for /  0. Similarly, for the second local peak, we have
                                        = 4
                                       1 + (2/ )

and we plot

1 - ( /(2))2 1 [sin ( 4 1 + (2 ) -  sin (2  4 )] / ) 2  1 + (2/ )
134CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.22: Amplitudes of local response (()/( /)) peaks (top) and the maximum
of those amplitudes (bottom) as they vary with the ratio of pulse duration to the period
of the system when an undamped SDOF system is subjected to a half-sine pulse. The
results pertain to the forced vibration phase alone.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  135

for /  1.5 (since the second peak does not exist for / < 1.5). Such plots are
provided in Figure 3.22 for the first three local peaks (i.e.  = 1, 2, 3).

The three curves in the top plot of Figure 3.22 show how the amplitude of each individ-
ual peak, i.e. the first, the second and the third peak, that occur in the forced vibration
phase varies with / . Clearly the first peak's amplitude is the largest initially but af-
ter a while the amplitude of the second peak exceeds that of the first, and after a while
the peak of the third exceeds both and so on. The value corresponding to the case of
/ = 1/2 is also embedded to the first local peak plot. As we are interested in
the global maximum response that will be observed during the forced vibration phase,
what we need is the envelope of these curves, which is the curve shown in the bottom
plot.

What remains to be seen is whether the maximum response that will be observed in
the free vibration phase exceeds the one that is observed in the forced vibration phase.
The response in the free vibration phase is given by

                 ()  / = - 1 - ( /(2))2  / cos (   ) sin (( - 2 ))

and so this is a simple sinusoidal wave with amplitude

                                 1 - ( /(2))2  / cos (   )

How this free vibration amplitude varies with / is shown in the top part of Fig-
ure 3.23. The lighter line accompanying the free vibration amplitudes corresponds to
the previously calculated maxima for the forced vibration phase.

Finally, the shock spectrum is constructed by the envelope of the two curves, i.e. the
value of the shock spectrum at any value of / is the greater of the free vibration
amplitude and the maximum forced vibration response at that particular / . The
free vibration amplitude exceeds the maximum force vibration response for / <
1/2 whereas the reverse is true for / > 1/2. The resulting shock spectrum in
terms of max/( /) is shown in the lower part of Figure 3.23.

The effort that goes into developing such spectra is obviously not insignificant, even
for the relatively simpler case of undamped systems. What damping will do will be
to decrease the amplitudes in all cases so that the undamped system may be used as
a conservative estimate of what to expect. Further complexities will be introduced as
the pulse shape varies. Still we find the exercise above worthwhile to introduce the
136CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.23: Variation of the free vibration amplitude (()/( /), top) and the shock
spectrum (bottom) for the undamped SDOF system subjected to a half-sine pulse.
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION  137

concept of spectrum and illustrate the procedures engineers employ to produce such
information. On the other hand, it is probably more efficient to develop such spectra
using numerical methods to calculate the response to any input. Moreover, the numer-
ical approach is the only option when analytical solutions are elusive as, for example, in
the case of earthquake induced ground motions. More will be said on this issue while
discussing earthquake response spectra in latter sections.

3.4.4 Impulse

We have already seen that as the pulse duration tends to be very short compared to the
period of the structure, the response tends to free vibrations with some initial velocity.
The mathematical limit of such a pulse would be an instantaneous effect. The impulse
imparted by finite amplitude pulses, however, tend to zero with decreasing duration,
so in the limiting case such a pulse would have no effect whatsoever on the system. To
be able to impart a finite impulse instantaneously, a generalized function called Dirac-
delta is employed to model this limiting case.

The Dirac-delta function may be defined as the limit of a number of different func-

tional forms but, for the purposes of this discussion, assume we have a rectangular

pulse starting at  = 0, of duration  and amplitude 1/ as shown in Figure 3.24(a).

The impulse imparted by this pulse is of unit magnitude, hence the limit is also referred

to as the unit impulse. As   0, the amplitude increases without bound, but the inte-

gral of the function is assumed to remain at the constant value of unity, i.e. we assume

that  0 for  < 0
                ( ) d = {                          (3.65)
                           1 for   0
               -

where the instantaneous transfer of momentum is assumed to be completed by the
time  = 0.18 This limiting case is graphically represented by a line with an arrowhead,

placed on the instant at which the unit impulse acts, as shown in Figure 3.24(b) and (c).
If the unit impulse acts at  = 0, then it is simply written as (), whereas if it is acting
at some other instant  = , then the instance of application is explicitly indicated and
the function is expressed as ( - ).19

How would a damped SDOF system respond to such an input? Let us assume that
the system is initially at rest and it is subjected to the unit impulse (). The impulse-

   18The simple fact is that this function can not actually be determined at  = 0; the bounds of the two
cases should more properly be < 0 and > 0, but here we include the equality sign as a mere convention.

   19It shouldn't be a stretch to imagine that the Dirac-delta function may also be defined on a spatial

domain, an approach sometimes used to model discrete forces acting at a point.
138CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.24: (a) A unit pulse, (b) its limit as   0 known as the unit impulse (the
Dirac-delta function), (c) a shifted unit impulse.

momentum equation, with the limits of the integral corresponding to 0- and 0 where
0- is some instant very close to 0, is given by

0                                                                    0

 [()- ()-()] d = d( ()) =  () d
0-resultant force acting on the mass   momentum 0-

Let us investigate these integrals one by one. By definition,

                                                                  0

                                            () = 1

                                                               0-

and since the system is at rest,

   d(()) = (0) - (0-) = (0)

The remaining two integrals need more deliberation. We have already seen while dis-

cussing response to pulse inputs that it takes some time for displacements to build up.

The duration we are considering is extremely small so that the positions of the mass at
 = 0- and  = 0 are practically the same, in which case the integral of () within

those limits is zero. These considerations lead to

    0                                      0

 () d = (0) - (0-) = 0,                 () d = 0

 0-                                     0-

so that by the time the impulse has ended, the mass, while still at the same position, has

gained a velocity equal to  (0) = 1
                                     
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION                     139

A viscously damped linear SDOF system subject to a unit pulse at  = 0 is therefore
governed for   0 by

() + () + () = 0 ; {(0) = 0, (0) = 1 }                                (3.66)
                                                              

The response to a unit impulse, i.e. the solution to Equation 3.66, is very important
in structural dynamics. It is often referred to as the impulse response function and it is
designated by a special symbol for distinction. Here we will use h() to denote the
impulse response function which, for an underdamped system is given by

h() = 1 e- sin                                                        (3.67)
         

and if the system were undamped, the impulse response function could be derived from
Equation 3.67 by substituting  = 0 to obtain

h() = 1 sin                                                           (3.68)
         

The impulse response function is schematically shown in Figure 3.25.

Figure 3.25: Impulse response functions h() [on the left] and h( - ) [on the right]
for a viscously underdamped SDOF system.

The same conclusion would be reached if we were to consider the limiting case of a
finite duration rectangular pulse. The solution for a rectangular pulse, of amplitude
140CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

 and duration , is given by Equation 3.44, Equation 3.45, Equation 3.46, and Equa-
tion 3.47. Let us employ these solutions with

    = ,  = 1

and consider the limit   0. Using the series expansions20 for the exponential as
well as the sine and cosine terms in the solutions, the limits for the initial conditions of
Equation 3.45 and Equation 3.46 are obtained as

 lim () = 0,                               lim () = 1
                                           0  
0

so that the limit of Equation 3.47 yields

lim () = 1 e- sin  = h()                               (3.69)
0  

The linearity of the system allows for applying the principle of superposition so that
if the system was subject to an impulse of amplitude , then the response would be
simply

                                          () = h()

and if this impulse were applied at time  = , then the response would be given for
   by

                                       () = h( - )

where it is implied by definition that h( - ) = 0 for  < .

If the system is subject to multiple impulses, say  impulses, each of which is applied at
 =  with amplitude , then the response of the system at time  may be evaluated
via superposition as

                                                                  

                                    () =  h( - )

                                                                 =1

This reasoning may be extended to finding the response of an SDOF system to a general
input by modeling the input as a sequence of infinitesimal impulses. Consider the input
sketched in Figure 3.26. This input may be approximated by a sequence of impulsive

   20e = 1 +  + 2! 2 + 3! 3 +
,
sin  =  - 3! 3 + 5! 5 + ,
cos  = 1 - 2! 2 + 4! 4 + 
3.4. PULSE RESPONSE AND IMPULSE RESPONSE FUNCTION        141

Figure 3.26: A general input as a sequence of impulses.

actions, each of which is applied at  =  with impulse () . The response of the
system at some time  would be given, according to the principle of superposition, by

the sum of the responses to each individual impulsive action so that

()   [() ] h( - )

               

where the approximate sign is used since (i) the input is idealized by a sequence of

pulses as opposed to the continuous curve it actually is, and (ii) the response to a finite
duration pulse is not exactly equal to the impulse response h( - ) but we assume 
is small enough so that this approximation is acceptable and that the impulse response
may be used in the construction.21 It is implied that the summation is over only those
impulses for which   . As we consider smaller and smaller increments  , 
becomes a continuous variable (as opposed to the countable ), ()  ( ) d ,
and the summation is replaced by an integral to account for all the impulses from the
time the force begins to act up to the final time  so that

                                                         (3.70)

() = ( )h( -  ) d

              0

This integral, commonly known as the convolution integral or the superposition integral,
is referred to as Duhamel's integral in the context of vibrations. It may be considered as

   21Eventually we will take the limit as   0 in which case the impulse response function will
indeed appear in the solution as we observed in Equation 3.69. At this stage we simply note this rather
than introducing a new function.
142CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

the general solution to all forced vibration problems regarding SDOF systems since the
integral may, in theory, be evaluated given a force and the system's impulse response
function, whether analytically or by numerical means. There are, however, more accu-
rate and efficient numerical methods used in integrating the equations of motion and
the direct numerical evaluation of Equation 3.70 is seldom used anymore.

Two further points should be made in passing. First, it should be apparent if we follow

the development of the formulations that the solution in Equation 3.70 is constructed
for a system initially at rest. If the system has non-zero initial conditions so that (0) =
 and (0) = , their contribution may be included via superposition as

() = e- [   cos  +  +   sin ] + ( )h( -  ) d    (3.71)
                 
                                  0

The second point is related to how the convolution may be executed in terms of what
is referred to as its commutativity. By defining a new (dummy) variable   =  -  so
that22 d  = - d , Equation 3.70 may be expressed as

()  =         -   ) d  =    0  -   )h( )(- d )

       ( )h(               (
       0                                        (3.72)
                            
    = ( -  )h( ) d  = ( -  )h( ) d
       0                    0

where the last equality follows form the fact that both  and   are (dummy) variables
that scan the interval between 0 and  so that either symbol may be used to express
the integral. Whether the form in Equation 3.70 or the one in Equation 3.72 should be
preferred is solely a matter of pragmatism in that one form may lead to integrals that
are simpler to evaluate; otherwise, these two forms are equivalent and either may be
employed in any problem.

3.5 Force Transmission and Vibration Isolation

Next, we consider two interrelated problems dealing with systems subjected to har-
monic excitations. The first question we will ask is, how does the magnitude of the
force transmitted to the base of a SDOF system depend on the excitation frequency?
In other words, are there particular strategies that can isolate the force transmitted to
the base? This problem is of course relevant for designing a foundation or support
structure may have to sustain the dynamic loads induced by a machine housed in the
building. More commonly, there may be stringent limits to the magnitude of forces

   22Since  in this context denotes only the final time and time as variable is denoted by either  or .
3.5. FORCE TRANSMISSION AND VIBRATION ISOLATION  143

transmitted to the base in applications where they may be other sensitive equipment
housed nearby. The second related problem pertains to base excitation described in
the previous section. The central question here is are there strategies that can be im-
plemented to limit, as much as possible, forces transmitted from the ground motion to
the structure, given a certain ground excitation (either accelerations or displacements)
with a sinusoidal time history and constant amplitude. An obvious application here is
base isolation of structure to protect it from earthquake induced ground excitations,
but there are other applications for this as well. For instance, in laboratories hous-
ing sensitive equipment such as microscopes, base isolation is necessary to ensure that
pedestrian motion nearby does not impact instrument performance.

We start our inquiry by examining first the problem of force transmission to the base
by a mass subject to simple harmonic motion. First, it will be necessary to rewrite
our equation of motion and isolate the elements that transmit forces to the base. The
total force () transmitted to the base comprises forces coming from springs and
dampers, and it may be expressed as:

() = () + ()

For an excitation () =  cos (), the solution to the equation of motion gives us

                                   () =   cos ( - )
                                               

and 
                                  () = -  sin ( - )

so that plugging () and () into the expression for () yields:
        () =   [ cos ( - ) +  sin ( - )] =  cos ( - )

where  is the phase difference between the applied external force and the force trans-
mitted to the base, and  is the amplitude of the transmitted force given by

                                    =   2 + 22

If the problem were static, the force transmitted would be equal to  . Amplification
factor for transmissibility in the dynamic case can be given as:

 = 1 + 22 2
144CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Noting that 2 = (2)2 and 2 = (2)2, the expression above may be written

as

                                 = 1 + (2  2 )
                                                         

and  substituting  in    =    and  the  expression  for  ()  given  by  Equation  3.33,  we  get:
                            

                               =        1 + (2)2                                         (3.73)

                                        22                   2
                                        (1 -  ) + (2)

Figure 3.27: Force transmitted to the base for SDOF systems subject to harmonic exci-
tation, shown here for varying damping ratios.

This ratio describing the amplification in force transmission due to dynamic effects
is called transmissibility in the context of structural dynamics and it is an important
consideration for numerous applications including vehicle, structure, and instrument
design. Figure 3.27 shows how the transmissibility changes as a function of  and .
It is noteworthy that for very stiff systems, i.e. as   , /  1. Additionally,
if / < 1 is desired, then in lightly damped systems we would like to have  >
3.6. VIBRATIONS INDUCED BY AN ECCENTRIC ROTATING MASS  145


  2, which corresponds to systems with low stiffness values. Finally, near the resonant

frequency for   1, damping plays an important positive role and can substantially
reduce transmissibility.

3.6 Vibrations Induced by an Eccentric Rotating Mass

There are many instances in which it may be desirable to induce vibrations to a struc-
ture or device with a prescribed frequency and amplitude. This is used in structural
models for instance for health monitoring and dynamical testing. Other applications
include eccentric mass vibration motors that are commonly used as haptic feedback
devices (e.g. vibrations of a cell phone or game controller). Figure 3.28 illustrates an
example structure on which such a device is mounted. In this scenario, we assume that
the columns and beam are axially rigid, and only lateral forces induced by the rotation
of the mass generate forces that translate into motion, with the lateral displacement
() of the portal frame being the only degree of freedom.

Figure 3.28: Eccentric rotating mass driven by a motor supported by a simple frame.

In this case, the eccentrically rotating mass  rotates around the anchor point with
constant angular velocity , and its eccentricity, i.e. its offset from the anchor point,
is . This eccentrically rotating mass is referred to as the unbalanced mass in some
applications. The total non-rotating mass, comprising the structural mass and, if rela-
tively significant, the mass of the motor, is . The system has a total lateral stiffness
 and it is viscously damped with damping coefficient . The rotation of the eccentric
146CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

mass generates a tensile force on the bar as the bar tries to keep the rotating mass on
its circular path. This force gets transmitted to the beam, and consequently a dynamic
lateral force is exerted by the motor on the structure which can be expressed as:

                                  () = 2 cos ()

It is worth noting here that the amplitude of the force depends on the angular velocity
of the rotating mass, which is also the frequency of the excitation. The equation of
motion for the system is then given as:

                       () + () + () = 2 cos ()

or equivalently,

                   () + 2() + 2() = 2 cos ( - )
                                                          

Considering only the steady state response, the displacement response of the system is
given by

                                    () =  cos ( - )

where the dynamic amplitude  and the phase angle  are given by

 =  2             =  2  (3.74)
 (1 - 2)2 + (2)2  

tan  =  2               (3.75)

        1-  2

Figure 3.29 shows the variation of the response amplitude (normalized by /)
with the ratio of the excitation frequency to the frequency of the system. As should

be expected, this graph is quite similar to the response graphs we have previously en-

countered for harmonic inputs. In the limit of vanishing angular velocity of the motor
as   0 or very high values of system frequency as   , the displacement re-

sponse diminishes to zero since the either the magnitude of the applied force becomes

negligible or the structure is very rigid. As the angular speed of the motor increases
so that   , the dynamic response converges to  = /. Damping is in-
consequential near these limits, but again plays a critical role in reducing the response
amplitude near the resonant frequency   1, with the resonant condition occurring
at  > 1 (but still close to 1) for damped systems.
3.6. VIBRATIONS INDUCED BY AN ECCENTRIC ROTATING MASS  147

Figure 3.29: Variation of normalized displacement amplitude /() with nor-
malized frequency  = / in a SDOF system supporting a rotating eccentric mass.
148CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

3.7 Base Excitation

Consider what would happen if you were to stand on a cart, and someone started to
shake the cart back and forth. You whole body would, if there was sufficient friction
between your shoes and the surface of cart, eventually move with the cart, sometimes
in and sometimes opposite to the direction in which the cart moves, and you would
possibly topple over should the cart move too quickly. This is one way to feel what
happens in earthquakes, of which more will be said further down the road. During an
earthquake, the ground on which the structure stands moves due to waves travelling in
and on the surface of the earth, forcing the supports, i.e. the points at which the struc-
ture is connected to the ground, to move with it.23 This motion is in turn transmitted to
the whole structure, whereby so many unfortunate losses have occurred in past earth-
quakes. The full understanding of structural behavior and safety in large earthquakes
is quite involved and requires collective knowledge across various areas of study. Here
we will focus on modeling dynamical behavior of relatively simple systems; analyses of
such systems go a long way in understanding earthquake responses of structures.

To better visualize some concepts and direct the focus of our investigations to how
building-like structures behave during earthquakes, we will work with a modified (but
completely analogous) SDOF prototype: the 2D, single bay single story frame shown in
Figure 3.30(a), with mass concentrated at the floor level. The whole story has a certain
lateral stiffness, denoted by , the value of which will depend on the material, dimen-
sions and end conditions of load bearing elements such as columns and beams. The
vertical elements in the load bearing system are graphically represented by the two
columns. All elements are assumed to have sufficient axial rigidity so that their axial
deformations may be neglected compared to bending deformations; therefore two ends
of a line element are assumed to translate by the same amount along the longitudinal
axis of that element. With this assumption, the only translation possible is the common
lateral translation of the top joints. Rotations of the joints are assumed to have either
negligibly small accelerations and/or negligibly small masses associated with these ac-
celerations so that no significant inertia is developed in rotational degrees of freedom,
and therefore these are not considered explicitly as dynamic degrees of freedom.24 Fur-
thermore, although mass is present in vertical as well as horizontal members, it is gen-
erally the case that the concentration of inertial effects in the vicinity of the floor level
is significantly larger than those contributed by the vertical members, so that the mass

   23Earthquakes are not the sole cause of support motion but they are the most catastrophic. All ground
borne vibrations, including those due to traffic, nearby machinery, pile driving or drilling will lead to
support motions albeit negligible ones in most cases.

   24Recall the discussions on modeling assumptions at the beginning of Chapter 2.
3.7. BASE EXCITATION                                  149

Figure 3.30: SDOF system subjected to ground motion.
150CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

of the system may be assumed to be concentrated at the floor level. This mass, generally
referred to as the floor mass, is graphically indicated by the block of mass  located
at the top of the frame. With these assumptions, the model is an SDOF system, with
lateral translation of the floor mass as its sole degree of freedom.

When the ground moves horizontally as (), the mass would move by the same amount

if there were no deformations of the columns, but this is not possible because of the
inertia effects. In general the mass moves relative to the ground by an amount of ()
so that at some instant , the mass has moved from its original (stationary) equilibrium

position by
                                      () = () + ()

To address the two movements distinctly, () is referred to as the absolute displacement

or total displacement, and () is referred to as the relative displacement of the mass; the

relative displacement is referred to more simply as the deformation since its value at

any instant corresponds to the amount of deformation in the spring (the columns in

this case) at that instant. The forces, including the d'Alembert force, that act on the

mass at instant  are shown in Figure 3.30(b). The important thing to note is that the

d'Alembert force depends on the absolute motion of the mass, i.e. (), since Newton's

law demands that acceleration be measured relative to a stationary reference (and the

base the structure is attached to is not stationary in this case), but the forces that develop

due to the deformation of the columns, i.e. , and those that develop in proportion to

the rate of deformation across the damper, i.e. , depend on the relative motion of the

mass with respect to the ground (the base the structure is attached to). Summation of

forces leads to

                 () + () + () = 0        (3.76)

which is a correct equation of motion but not directly applicable since generally we aim
to investigate the resulting motion of the mass under a specific ground motion. The
ground motion may be treated as a known external excitation in two different ways. We
may choose to track the absolute motion of the mass, in which case we may substitute
() = () - () and () = () - () into Equation 3.76 ,and move the terms
related to the ground motion to the right hand side of the equation to obtain:

                 () + () + () = () + ()  (3.77)

If, on the other hand, we choose to track the relative motion of the mass, we substitute
() = () + () into Equation 3.76, and move the ground acceleration term to the
right hand side of the equation to obtain:

                 () + () + () = -()      (3.78)
3.7. BASE EXCITATION                        151

Which of these equations is to be preferred generally depends on the particular de-
tails of a specific problem, but admittedly Equation 3.78 is by far the more commonly
encountered one, especially for SDOF systems. The relative displacement is most read-
ily related to the shear forces that must be transmitted by the columns and the maxi-
mum relative displacement therefore is an important design parameter which can be
addressed more directly via Equation 3.78. Furthermore, this equation is quite similar
in form to that of an SDOF system subject to an external force, and in earthquake re-
sponse analysis the term on the right hand side, i.e. -(), is often referred to as the
effective earthquake force. The form of the governing equation may be abridged if we
divide both sides by the mass, after which we obtain

                      () + 2() + 2() = -()  (3.79)

This form of the equation of motion more emphatically demonstrates that the response
of a system to a specific base motion depends solely on two parameters: the frequency
and the damping ratio of the system.25 To highlight the significance of this observa-
tion, let us investigate the following scenario: consider two single degree of freedom
systems, one extremely heavy and stiff, the other extremely light and flexible, such that
they have the same frequency and damping ratio. Identical displacements (and hence
velocities and accelerations) will develop in these two systems when they are both sub-
jected to the same ground motion, no matter what the ground motion looks like, albeit
the two systems seemingly being very different.

Often the critical issue with base excitations in the context of structural dynamics is
calculation of demands induced on structures by earthquake induced ground motions.
Such motions are quite erratic with time histories defying analytical expressions, and
we therefore feel that the details of earthquake response analysis are best left after a
discussion of numerical methods to be used in solving the equation of motion. There
is, however, significant insight to be gained from analyses of simpler loading patterns,
and this is what we undertake for the rest of this section.

3.7.1 Response to a Pulse-Like Base Motion

Let us first investigate what the response of an SDOF system to a base excitation in
the form of some pulse would be. To make this investigation more plausible, we have
to consider the evolution of ground motion in real life which would require that the

   25To contrast: under an external force, the frequency and the damping ratio are still fundamental
determinants, but the stiffness (or, equivalently, the mass) of the system also plays a role in the amplitude
of the response.
152CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

ground be at rest before and after the pulse, with possibly a permanent drift, and that

the velocity starts from zero and again reaches zero at the end of the pulse. There could

be numerous functions that fit this description but we use one previously proposed in
the literature26, defined as

() = V  - V sin ( 2 )                    (3.80)
2 4           

() = V - V cos ( 2 )                     (3.81)
22            

() = V sin ( 2 )                         (3.82)
     

where  is the duration of the pulse, V is the absolute maximum velocity defined as

V = max |()|                             (3.83)

            

and all the expressions are valid only for 0    , with the ground motion for

 >  defined by () = V2 , () = 0, () = 0  (3.84)

The ground displacement, velocity and acceleration time histories defined by such a
ground motion are shown in Figure 3.31.

Figure 3.31: Pulse type ground motion defined by Equation 3.80, Equation 3.81, and
Equation 3.82

   26see, e.g., N. Makris and Y. Roussos, "Rocking response of rigid blocks under near-source ground
motions," Géotechnique, Vol.50, No.3, pp. 243-262, 2000.
3.7. BASE EXCITATION                                                              153

What would be the response of a viscously underdamped, linear, SDOF system, initially
at rest, to such a base motion? Such a system's relative motion would be governed for
0     by

         () + 2() + 2() = -() = - V sin ( 2 )                    (3.85)
                                                

and we have actually solved an analogous problem before, that of a system subjected to
a harmonic force, for which the equation of motion was given by Equation 3.26 which
is noted below for convenience:

                 () + () + () =  sin ( - )                       (3.86)

Clearly Equation 3.85 is the same as Equation 3.86, with the coefficients and variables
given by

 = 1,     = 2,         = 2,   = 2 ,   = - V = - V ,              =0
                                                  2                  (3.87)

Therefore the solution will be given by Equation 3.39, repeated below for ease of ref-

erence:

() = e-[sin ( + ) cos  + (  sin ( + ) -  cos ( + ) ) sin ]
 /                                      1 - 2

         +  sin ( -  - )

When this solution is adopted to our current problem via Equation 3.87, one gets

       () = - 22 V e-[sin  cos  + (  sin  -  cos  1 - 2 ) sin ]  (3.88)
                     V

                  - 2  sin ( - )
                     2

where

          = ,    = 1 ,                  tan  =  (2)/
                       (1 - 2)2 + (2)2
                                                (1 -  )/2

as defined previously by Equation 3.33 and Equation 3.34. Contrary to the case of
a harmonic force, the case we are currently investigating is that of a finite duration
pule-type input, and the parameter we would like to focus on is not the ratio of the
154CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

frequencies but rather the duration of the pulse relative to the period of the system. To
reformulate the solution in terms of this parameter, we define

                      =  =  = 1 - 2 
                                   

and note that        D = V 2 = V 

is the maximum ground displacement due to the motion given by Equation 3.80, Equa-
tion 3.81, and Equation 3.82. Substituting these variables into the solution leads, after
some algebraic manipulation, to

() = -De-[sin  cos  +  sin  - cos 1 - 2 sin ]               (3.89)
                                                     1 - 2

           -D sin ( - )

for 0    , where

                = 1    1 - 2

                  2 (2 - 1 + 2)2 + (1 - 2)(2)2

The response of the system after the pulse stops to act, i.e. for  > , will be one of free
vibrations, with initial conditions given by the displacement and velocity  = ()
and  = () to be calculated from Equation 3.89 and its time derivative so that

() = e-(-) [ cos ( - ) +  +   sin ( - )]                    (3.90)

To visualize possible different outcomes, we shall simplify the problem by considering

an undamped case, the response of which may be derived using the foregoing equations
by substituting  = 0. The displacement and velocity of such a system for 0    
and   1 may be shown to be

               () = -D 2 2 1 1- 1 [sin  - 1 sin ]           (3.91)

                  () = - 2 2 V 1- 1 [cos  - cos ]           (3.92)
3.7. BASE EXCITATION                                                    155

whereas when  = 1, the particular solution could be obtained by appropriate sub-
stitutions into the solution given previously for the case of a harmonic force in Equa-
tion 3.38 so that after going through the algebraic manipulations as was done above for
the damped system, one obtains, for 0    ,

                      () = -D 14 [sin  -  cos ]                     (3.93)

                                     () = - V  sin                  (3.94)
                                                 4

For  > , the undamped system's motion is given by

           () =  cos ( - ) +  sin ( - )                             (3.95)

for all values of , where  = () and  = () are to be evaluated from Equa-
tion 3.91 and Equation 3.92 (for   1), or Equation 3.93 and Equation 3.94 (for

 = 1).

The results that would be obtained for various cases of  = / are shown in Fig-
ure 3.32. These responses are sketched for normalized time  = / so that the plots

reflect about five cycles of the system, and the expressions used in these plots are

     ( )            1     [sin  (2  )  -  1  sin     (2 )]  1
                                                            =1
           - 2(2-1)
           ={ 1
     D     - 4 [sin (2 ) - 2 cos (2 )]

for 0     (equivalently, for 0    ), and for  >  (equivalently, for  > )
we have

( )  = {12(2-1) sin(2) cos (2( - )) + 2(2-1) cos(2)-1 sin (2( - ))  1
                                                                    =1
D        2 cos (2( - 1))

These response graphs help us discern some differences between a pulse-type force and
a pulse-type base excitation. We had previously seen in Section 3.4 that the effects of
a pulse-type force tend to be more pronounced when the pulse duration exceeds half
the period of the system. In the case of a base excitation, this phenomenon seems to be
somewhat reversed: It seems that the amplitude of the maximum relative displacement
approaches the amplitude of the ground displacement when the pulse duration tends
be much shorter compared to the period of the system, and that when the duration
exceeds the period by a significant amount, the amplitude of the relative displacement
156CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 3.32: Response of an underdamped SDOF system, initially at rest, to a pulse-
type base motion defined by Equation 3.80, for various values of  = / . The plots
are for time normalized by the period of the system, i.e.  = / . Dashed (blue) lines
correspond to normalized ground displacement ( )/D and are presented for visual
comparison of the response amplitude.
3.7. BASE EXCITATION  157

tends to zero. It may be argued that such an observation is consistent with how the ex-
citation is transmitted to the mass via the stiffness elements. For a finite duration pulse,
  0 implies    and so, for a finite mass,   0: in this case the ground moves
but exceedingly small forces develop in the stiffness elements, therefore negligibly lit-
tle force is transferred to the mass and so the mass remains almost still (with respect
to the stationary frame of reference), thereby the maximum relative displacement of
the mass with respect to the (moving) ground approaches the amplitude of the ground
motion. At the other extreme,    implies   0 and   , in which case
the deformations in the stiffness elements remain negligibly small (even though now
the forces may be very large), and so the mass moves in almost full accordance with
the ground and the relative displacement approaches zero (although the mass moves
with respect to the stationary frame of reference). These two extremes are common
characteristics in all systems subjected to base motion.

Figure 3.33: Response of a damped SDOF system to a pulse-type base motion defined
by Equation 3.81, for various values of damping ratio . The system is initially at rest.
In all cases,  = / = 0.5. The plots are for time normalized by the damped
period of the system, i.e.  = / . Dashed (blue) lines correspond to normalized
ground displacement ( )/D and are presented for visual comparison of the response
amplitude.

What would happen if there was damping in the system? The various cases hitherto
discussed have demonstrated that the undamped case provides an upper bound on the
response amplitudes, and that when damping is present the response amplitudes de-
crease. The same is true in this case, with the maximum response decreasing as the
damping ratio increases, and the response exponentially decaying in free vibrations.
To provide some quantitative results, the responses of three SDOF systems with dif-
ferent values of viscous damping ratios are shown in Figure 3.33, where the rate of
decay in time and decrease in maximum response are seen to be highly dependent on
the available damping.
158CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

3.7.2 Response to Harmonic Base Excitations

Resonance is possible also in the case of base excitations and its effects are highly dev-
astating on structures. Although similar to the case of harmonic forces, there are some
differences that should be highlighted when the input is that of ground motion. To
analyze the issue, we suppose that the ground motion is harmonic, defined by

                         () = D sin                          (3.96)

so that the system is governed by                            (3.97)
                         () + 2() + 2() = 2D sin 

As in the case of harmonic forces, also in this case we investigate the steady-state vi-
brations to quantify the effects of a harmonic base motion. The steady-state vibrations
may be developed by analogy from the solution developed for the harmonic force case
governed by Equation 3.26, given below for ease of reference:

                   () + () + () =  sin ( - )                 (3.98)

Clearly Equation 3.97 is the same as Equation 3.98, with the coefficients defined as

 = 1,  = 2,  = 2,  = 2D,  = 0                                (3.99)

Therefore the solution will be given by Equation 3.31, i.e.

                         () =  sin ( - )                     (3.100)

where, from Equation 3.32 and with  = /,                     (3.101)
                                            = D2

and from Equation 3.34,          (2)/

                         tan  =  (1 -  )/2                   (3.102)

and it is implied by definition that 0    .  = (, ) is the dynamic amplifica-
tion factor defined by Equation 3.33.

A reasonable normalized response to investigate is the variation, with respect to , of

the amplitude of steady state response to that of the maximum ground displacement,

i.e. /D, given by         = 2
                         D
3.7. BASE EXCITATION  159

Figure 3.34: Variation of /D = 2 and the phase angle  with ratio of frequencies,
plotted for various levels of viscous damping.
160CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

The tendency of amplified response near  = 1 is somewhat similar to that observed
in the case of harmonic force excitations, with the peaks for different damping values
all occurring now slightly to the right of  = 1 and the shift increasing with increasing
values of damping. The limiting values show important differences compared to the
case of harmonic force excitations, and it is important to note the following issues:

    i) For all levels of damping,   0 as   0. This is mathematically obvious as
       the limit of the relationship in Equation 3.101 and may physically be interpreted
       as the case of a system with a finite mass and an extremely large lateral stiffness
       so that   . In this case the lateral displacements that are caused by the
       deformations will be negligibly small so that the steady state response is given
       by ()  0.

   ii) For all levels of damping,   0 as   . This result is also obvious math-
       ematically as the limit of the relationship in Equation 3.101, and may physically
       be interpreted as the case of a system with a finite mass and almost no lateral
       stiffness so that   0. As the ground moves, the lateral force that develops in
       the lateral stiffness system remains negligibly small so that the accelerations that
       the mass develops remain negligible. The mass therefore practically stands still
       with respect to a stationary frame of reference while the ground moves, with the
       steady state relative displacement of the mass with respect to the ground there-
       fore given by ()  -().

  iii) The ratio /D = 2 reaches a peak value somewhere in the vicinity of  = 1
       when damping levels are low. Taking the derivative of 2 with respect to 
       to locate the extremum points yields the following possibilities: if   1/2,
       d(2)/ d becomes zero at  = 0 and  = 1/1 - 22, while for > 1/ 2
       the derivative is zero only for  = 0. Therefore whenever   1/ 2  71%,
       the maximum amplification is given by

(  ) = (2)        =1 1 1     (3.103)
D max             2 1 - 2 2
       = 1
            1-22

where the last approximation is valid for small values of the damping ratio. It was
already shown in Section 3.3 that even for a relatively sizeable damping ratio of
 = 10%, the error of approximation remained about 1%. As in the case of har-
monic force excitations, the amplitude of the dynamic response tends to infinity
as   1 for undamped systems, representing the theoretical upper bound al-
though in practice it is impossible for deformations to reach even finitely large
levels. Structures inevitably have energy dissipation through many mechanisms
3.7. BASE EXCITATION  161

and inelastic deformations would alter system characteristics in any case after
certain thresholds of deformation are exceeded.

3.7.3 Brief Notes on the Basic Model

The model we have so far discussed while investigating vibrations due to ground mo-
tion is the most basic model and while it is extremely useful in understanding the fun-
damental concepts and patterns, it contains some simplifying assumptions that should
be highlighted.

One point to make is that this model presumes a rigid ground such that the behavior
of the soil and the structure may be assumed to be completely uncoupled. Soil is a
deformable medium that has its own dynamic characteristics which are amplitude and
frequency dependent. Any excitation transmitted via the soil is transmitted by waves
that travel in the soil, and one part of the problem is the apparent wavelength of these
soil waves in comparison with the dimensions of the structure. For relatively short
spans all the supports of the structure may be assumed to move identically, whereas for
long span structures it is possible to have significant differences in support motions.
The second issue is the disturbance or modification that will take place in such wave
motion due to the presence of the structure. If the structure is very flexible compared to
the soil, the disturbance generated by its presence is generally expected to be relatively
small so that the ground motion measured away from the structure, called the free-field
motion, is roughly the same as that which would be measured at the base of the structure.
On the other hand, the presence of a relatively rigid structure on flexible soil is expected
to locally modify the ground motion significantly, leading to significant differences is
free-field measurements and the actual motion at the structure's base. This issue may
be very significant when one wishes to analyze the effects of a specific earthquake on
a structure based on measured free-field ground motions as actual base motions may
not be available.

A related point is that rotational motion (in this case, rotation in the plane of the 2D
model) is neglected. Free field ground motions rarely contain significant surface rota-
tions but in some cases, for example in the existence of a large rigid foundation plate,
pronounced soil structure interaction may lead to rotational motion. Such rotations
lead to additional lateral motion and inertia, leading to increased demands in the load
bearing members, while also increasing contributions from gravity loads which may
in turn reduce effective lateral stiffness. There are simple models that help in under-
standing and quantifying such effects and some will be introduced further on.

Possibly the most important issue is the omission of inelastic response. Earthquakes, at
162CHAPTER 3. FORCED VIBRATIONS OF SINGLE DEGREE OF FREEDOM SYSTEMS

least those that are deemed significant, exert large demands on structures such that elas-
tic behavior limits are almost always exceeded. In such cases, the linear elastic model
of Equation 3.79 is generally modified to

() + 2() + () = -()  (3.104)

where () is the lateral force provided by the stiffness members on the mass and it
is now a non-linear function of the deformation (). This issue will be revisited in

greater detail while discussing earthquake induced vibrations in latter sections.
Chapter 4

Numerical Solutions of the SDOF
Equation of Motion

4.1 Preliminary Ideas

The equation of motion for a viscously damped linear SDOF system under the action
of an external force was shown in previous sections to be

    () + () + () = ()            (4.1)

with the specialized equation for the case of a system excited by a ground motion given

by

    () + () + () = -()           (4.2)

Although we have discussed the analytical solutions of these equations for an important
subset of excitations, it has to be said that most often analytical solutions are beyond
our reach and numerical techniques must be employed to obtain values for the response
at various instances. While discussing numerical techniques, we will employ the force
excitation form of the equation only to minimize repetitive expositions; clearly the
formulations may be specialized for ground motion excitation by substituting -()
for ().

The need for use of numerical techniques may arise from various reasons: it may be that
the form of excitation is so complex that no known analytical solutions exist, it may be
that the excitation is known only at discrete instances of time to begin with, or it may
be that the nonlinearity of the system is prohibitive for any closed form solutions. In all

                       163
164CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

cases, the method of attack for all numerical techniques is similar: a. time is discretized
into a finite number of instances (using, if possible, small intervals in-between them);
b. the behavior, in-between the time instances, of the force or the system or both is
approximated via straight lines or simple curves; and c. the solution progresses from
one step to the next through solution of algebraic equations.

In what follows, we will try to adhere to the following notation so as to provide some
common language for all the methods to be discussed. We will assume that continu-
ous time  is discretized into a total of  + 1 instances, each denoted by  for  =
0, 1, 2, ... , . The difference between any two consecutive instances is called a time step,
to be denoted by  = [+1] - []. The time step does not in general have to be
constant, but when working on linear systems with relatively smooth inputs, it often
is. To emphasize the discrete nature of the calculations, we'll use brackets: for some
time dependent variable (), [] will denote the value of that variable at time  = []
where, for constant time step, [] = . The construction of the numerical solution
up to and including the final time, corresponding to step  + 1 (counting time  = 0 as
the first time step) will require knowledge of the input [] for  = 0, 1, 2, ...,  and the
initial conditions [0], [0].

4.2 Linear Interpolation of the Excitation

For linear SDOF systems, it is relatively straightforward to develop a numerical pro-
gression based on analytical solutions developed for simply varying forces. The funda-
mental idea is linear interpolation of the excitation in-between two consecutive time
steps. Consider the sketch given in Figure 4.1. According to the this approach which
we shall refer to as the piecewise linear excitation1 (PLE), the excitation () is assumed
to vary linearly between its values at [] and [+1] so that for []    [+1] the
excitation is approximated by

    ()   ([]) +  ([+1]) -  ([])  ( -  [+1] - [] []) = [] + [+1] - []  ( -   [])

It is easier to express this equation using a shifted time variable  =  - [] such that
(replacing the approximation with an equality)

                  ( + []) = [] + [+1] - []   for 0      

    1This approach is referred in many references as the piecewise exact method which we think is some-
what misleading in that the `exactness' alluded to with this name pertains only the analytical expressions
used and not to the accurateness of the method itself.
4.2. LINEAR INTERPOLATION OF THE EXCITATION                          165

For a linear system, it is possible to employ superposition to develop the `exact' re-
sponse of the system under such an excitation: The response () for []    [+1]
may be considered to be the superposition of the following three responses, all of which
were previously developed:

     · The response due to nonzero initial conditions [] and [] at time  = []. This
       response is given (see Chapter 2) by

                    ( + []) = e- ([] cos  + [] + []  sin  )

· The response due to the constant force [] acting on a system initially at rest.
  This response is given (see Chapter 3) by

( + []) = []  [1 - e- (cos  +  1 - 2 sin  )]

· The response due to the linearly varying (ramp) force ([+1] - []) / acting
  on a system initially at rest. This response is given (see Chapter 3) by

( + 1 [+1] - [] []) = e- ( 2 cos  + [ 22 - 1 ] sin  )+ 1 [+1] - [] [ - 2 ]
                                                                                          

By taking the derivatives of these expressions we may obtain expressions for
velocity, which will also be the superposition of the contributions from the three
cases considered above.

Figure 4.1: Approximating the force as a series of linear segments.
166CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

The displacement at  =  (corresponding to  = [+1]) is therefore given by

([+1]) = [+1] = e- ([] cos  + [] + []  sin )

              + []  [1 - e- (cos  +  1 - 2 sin )]

              + [+1] - [] e- ( 2 cos  22 1  + [ - ] sin )
                                                   

                + [+1] - []  [   - 2 ]

Despite the somewhat complicated structure of this result, it is actually composed of

a number of coefficients such as cos , sin , etc, multiplying the time-varying
variables ,  and . Rearranging the terms, it is possible to express the result above as

            [+1] = 1[+1] + 2[] + 3[] + 4[+1]                              (4.3)

where

1 = e- (cos  +  1-2 sin )
2 = e- ( 1 sin )
                                             1-22
       1 2    -       2                            
3 =  [  + e      (- [1 +  ] cos  + [  - 1-2 ] sin )]
4 = 1 [1 - 2 + e- ( 2 cos  +  22-1 sin )]
                                           
                                                                          (4.4)

It is noteworthy that these coefficients are time invariant if a constant time step is used,

in which case they would have to be calculated only once. Similarly, if we obtain the

velocity by differentiating ( + ) and evaluate its value at  = , we find that this

value may also be expressed in the form

              [+1] = 1[] + 2[] + 3[] + 4[]                                (4.5)

where

       1 = -e- (  1-2 sin )

       2 = e- (cos  -  1-2 sin )
       3 = 1 [-1 + e- (cos  + 2 + sin )] (4.6)
                                             1-

       4 = 1 [1 - e- (cos  +  1-2 sin )]
4.2. LINEAR INTERPOLATION OF THE EXCITATION  167

and once again all coefficients are independent of time if a constant time step is used.
Once the displacement and the velocity at an instant are evaluated, the acceleration at
that instant may be calculated via the the equation of motion as:

                 [] = 1 ([] - [] - []) = []  - 2[] - 2[] (4.7)

Having developed the analytical results based on the initial assumptions, the flow of
the PLE implemented with a constant time step may be summarized as in Figure 4.2.

  Pseudocode for the Piecewise Linear Excitation method.

  viscously damped SDOF system, for constant time step
  Input: ,  (or ), , , [0], [0], {[0], ... , []}
  Initialize: calculate 1, 2, 3, 4, 1, 2, 3, 4 using Equation 4.4 and
  Equation 4.6
  for  = 0, ... ,  - 1:

                    [+1] = 1[] + 2[] + 3[] + 4[+1]
                    [+1] = 1[] + 2[] + 3[] + 4[+1]
  for  = 0, ... , :
                    [] = 1 ([] - [] - [])

                               Figure 4.2: Pseudocode for PLE.

EXAMPLE 4 .1

A single story structure, initially at rest, is idealized as an SDOF system for studying
its lateral vibrations when subjected to unidirectional, pulse type lateral forces. The
mass2 of the structure is assumed to be condensed at a certain level and estimated as
125 tons, its lateral stiffness is estimated as 2 × 105 kN/m, and it is assumed to be
viscously damped with a damping ratio of 2%. The equivalent model of the system
and the forces it is subjected to are shown in Figure 4.3. Consider a constant time step
of  = 0.01 seconds, which corresponds to less than one-tenth of the system's period,
and let us say we want to evaluate the response of the system for a duration of 1 second,
so that a total of 101 time instances are to be taken into consideration including the
initial time  = 0.

    2Many structures involve relatively large masses such that in practice metric ton (ton or t) is often
used, with 1 ton = 1000 kg.
168CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.3: (a) SDOF model of a single story structure, (b) triangular pulse with duration
0.2 seconds, (c) half-sine pulse with duration 0.4 seconds.
4.2. LINEAR INTERPOLATION OF THE EXCITATION                169

Let us start with the analysis of the triangular pulse with an amplitude of 100 kN and

duration  = 0.2 seconds. The force increases linearly until it reaches its peak value
of 100 kN at  = /2 = 0.1 seconds corresponding to  = 10, after which it declines
linearly until it disappears at  = /2 = 0.1 seconds corresponding to  = 20. The
value of the force may therefore be defined at instances  as

100 [] = 10 kN                   for  = 0, 1, ... , 10
       { /2                      for  = 11, 12, ... , 20
[] = 200 - 200 [] = 200 - 10 kN  for  = 21, 22, ... , 100
   
{
0

The first order of business is to calculate the coefficients 's and 's that appear in the
recursive formulas of Equation 4.3 and Equation 4.5. These coefficients are evaluated
using the expressions given in Equation 4.4 and Equation 4.6 to obtain:

   1 = 9.2148 × 10-1,  2 = 9.6580 × 10-3
   3 = 2.6086 × 10-7,  4 = 1.3174 × 10-7
   1 = -1.5453 × 101,  2 = 9.0603 × 10-1
   3 = 3.8004 × 10-5,  4 = 3.9260 × 10-5

Note that these coefficients are independent of the force insofar as the time step does

not change. The next step is to calculate the displacement and the velocity through

Equation 4.3 and Equation 4.5, and the acceleration at each time step through Equa-
tion 4.7. At the initial instance corresponding to  = 0 the system is at rest, and so
[0] = 0, [0] = 0. Since [0] = 0, we find [0] = 0 as well. [1] and [1] are to be
evaluated from

[1] = 9.2148 × 10-1[0] + 9.6580 × 10-3[0] + 2.6086 × 10-7[0]
            + 1.3174 × 10-7[1] = (1.3174 × 10-7)(10) = 1.3174 × 10-6 m

[1] = -1.5453 × 101[0] + 9.0603 × 10-1[0] + 3.8004 × 10-5[0]
          + 3.9260 × 10-5[1] = (3.9260 × 10-5)(10) = 3.9260 × 10-4 m/s

and the acceleration at  = 1 is consequently given by
                  [1] = 1 ([1] - [1] - [1]) = 7.7264 × 10-2 m/s

The calculations proceed in this manner, and the instances until  = 0.1 seconds are
170CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

obtained as:                    [0] = 0.0000 × 10-3 m/s,     [0] = 0.0000 m/s2
                                [1] = 0.3926 × 10-3 m/s,     [1] = 0.0773 m/s2
       [0] = 0.0000 × 10-3 m,   [2] = 1.5006 × 10-3 m/s,     [2] = 0.1412 m/s2
       [1] = 0.0013 × 10-3 m,   [3] = 3.1391 × 10-3 m/s,     [3] = 0.1820 m/s2
       [2] = 0.0102 × 10-3 m,   [4] = 5.0430 × 10-3 m/s,     [4] = 0.1937 m/s2
       [3] = 0.0331 × 10-3 m,   [5] = 6.9100 × 10-3 m/s,     [5] = 0.1748 m/s2
       [4] = 0.0739 × 10-3 m,   [6] = 8.4482 × 10-3 m/s,     [6] = 0.1289 m/s2
       [5] = 0.1338 × 10-3 m,   [7] = 9.4219 × 10-3 m/s,     [7] = 0.0635 m/s2
       [6] = 0.2110 × 10-3 m,   [8] = 9.6876 × 10-3 m/s,   [8] = -0.0108 m/s2
       [7] = 0.3009 × 10-3 m,   [9] = 9.2149 × 10-3 m/s,   [9] = -0.0823 m/s2
       [8] = 0.3971 × 10-3 m,  [10] = 8.0896 × 10-3 m/s,  [10] = -0.1397 m/s2
       [9] = 0.4922 × 10-3 m,
      [10] = 0.5792 × 10-3 m,

These values are provided as reference for readers wishing to check the answers they
obtain through their calculations and thereby verify their codes. The response obtained
for the whole 1 second duration is plotted in Figure 4.4.

Let us repeat the analysis for the case of the half-sine pulse, of amplitude 100 kN and
duration 0.4 seconds, shown in Figure 4.3.c. This time the force is defined by

 100 sin ( [] = { 0.4 []) = 100 sin ( 40 ) ;   = 0, 1, ... , 40
          0;                                   = 41, 42, ... , 100

Since the coefficients 's and 's of the PLE do not depend on the input but only on
the system parameters and the time step, the values calculated previously for the trian-
gular pulse case are still valid. Proceeding with the recursive calculations, the response
quantities until  = 0.1 seconds are obtained as follows, presented for reference:

 [0] = 0.0000 × 10-4 m,         [0] = 0.0000 × 10-3 m/s,     [0] = 0.0000 m/s2
 [1] = 0.0103 × 10-4 m,         [1] = 0.3080 × 10-3 m/s,     [1] = 0.0606 m/s2
 [2] = 0.0804 × 10-4 m,         [2] = 1.1755 × 10-3 m/s,     [2] = 0.1104 m/s2
 [3] = 0.2591 × 10-4 m,         [3] = 2.4518 × 10-3 m/s,     [3] = 0.1414 m/s2
 [4] = 0.5772 × 10-4 m,         [4] = 3.9214 × 10-3 m/s,     [4] = 0.1486 m/s2
 [5] = 1.0416 × 10-4 m,         [5] = 5.3378 × 10-3 m/s,     [5] = 0.1310 m/s2
 [6] = 1.6350 × 10-4 m,         [6] = 6.4633 × 10-3 m/s,     [6] = 0.0913 m/s2
 [7] = 2.3181 × 10-4 m,         [7] = 7.1061 × 10-3 m/s,     [7] = 0.0357 m/s2
 [8] = 3.0361 × 10-4 m,         [8] = 7.1495 × 10-3 m/s,   [8] = -0.0270 m/s2
 [9] = 3.7271 × 10-4 m,         [9] = 6.5696 × 10-3 m/s,   [9] = -0.0873 m/s2
[10] = 4.3315 × 10-4 m,        [10] = 5.4370 × 10-3 m/s,  [10] = -0.1361 m/s2
4.2. LINEAR INTERPOLATION OF THE EXCITATION  171

Figure 4.4: Displacement, velocity and acceleration response calculated for the system
of Figure 4.3 subjected to the triangular pulse. The response quantities calculated by
the PLE are marked with solid circles while the dashed lines are interpolations included
for visualisation.
172CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.5: Displacement, velocity and acceleration response calculated for the system
of Figure 4.3 subjected to the half-sine pulse. The response quantities calculated by the
PLE are marked with solid circles while the dashed lines are interpolations included
for visualisation.
4.2. LINEAR INTERPOLATION OF THE EXCITATION                             173

The displacement, velocity and acceleration responses calculated for the first 1 second
are plotted in Figure 4.5.

EXAMPLE 4 .2

To illustrate how the calculations would proceed for an SDOF system subjected to

ground motion, let us consider the system of Ex. 4 .1, subjected to a ground motion

defined by     V V

                          2
              {  - sin ( ) ; 0    
              () = 2 2    
               V
              { 2 ;  > 

with V = 1 m/s and  = 0.4 s. The ground acceleration is therefore given for 0 

   by         () = V sin ( 2 ) = 2.5 sin (5)

                        

and it is zero at all other times. Recall that for this system,  = 2%.

Figure 4.6: (a) SDOF model of a single story structure subjected to ground motion, (b)
A velocity-pulse type ground motion with duration 0.5 s.

The model and the ground acceleration are shown in Figure 4.6, and the governing
equation of motion for 0    0.4 s is given by
()+()+() = -()  125()+()+2×105() = -312.5 sin (5)

subjected to initial conditions (0) = 0, (0) = 0; or equivalently by
() + 2() + 2() = -()  () + 1.6() + 1600() = -2.5 sin (5)
174CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

where we have taken into consideration that  = 0.02 and  = / = 40 rad/s as
per the properties stated for the system. Free vibrations ensue after  = 0.4 s. Either
form of the equation of motion may be used while calculating the response, but note
that for the second equation the numerical values for the mass, damping and stiffness
coefficients would have to be defined as  = 1,  = 1.6 and  = 1600, respectively.
Let us use this second form in our calculations with a constant time step of  = 0.01 s.
The input is defined at each step by

[] = -[] = {-7.854 sin (0.1571) for  = 0, 1, ... , 40
0  for  = 41, ... , 100

Figure 4.7: Relative displacement, relative velocity and relative acceleration response
calculated for the system of Figure 4.6 subjected to the pulse-type ground motion.
The response quantities calculated by the PLE are marked with solid circles while the
dashed lines are interpolations included for visualisation.

For  = 1,  = 0.02 and  = 1600, the coefficients for the PLE are calculated via
4.3. CENTRAL DIFFERENCE METHOD                              175

Equation 4.4 and Equation 4.6 to obtain

1 = 9.2148 × 10-1,                       2 = 9.6580 × 10-3
3 = 3.2607 × 10-5,                       4 = 1.6468 × 10-5
1 = -1.5453 × 101,                       2 = 9.0603 × 10-1
3 = 4.7504 × 10-3,                       4 = 4.9076 × 10-3

The recursive calculations via Equation 4.3, Equation 4.5 and Equation 4.7 yield, for
the first few steps, the following results:

   [0] = 0.0000 × 10-3 m,     [0] = 0.0000 × 10-1 m/s,  [0] = -0.0000 m/s2
 [1] = -0.0202 × 10-3 m,    [1] = -0.0603 × 10-1 m/s,   [1] = -1.1866 m/s2
 [2] = -0.1569 × 10-3 m,    [2] = -0.2290 × 10-1 m/s,   [2] = -2.1393 m/s2
 [3] = -0.5036 × 10-3 m,    [3] = -0.4735 × 10-1 m/s,   [3] = -2.6841 m/s2
 [4] = -1.1136 × 10-3 m,    [4] = -0.7471 × 10-1 m/s,   [4] = -2.7151 m/s2
 [5] = -1.9897 × 10-3 m,    [5] = -0.9967 × 10-1 m/s,   [5] = -2.2106 m/s2
 [6] = -3.0818 × 10-3 m,    [6] = -1.1712 × 10-1 m/s,   [6] = -1.2357 m/s2
 [7] = -4.2934 × 10-3 m,    [7] = -1.2302 × 10-1 m/s,
 [8] = -5.4955 × 10-3 m,    [8] = -1.1501 × 10-1 m/s,     [7] = 0.0683 m/s2
 [9] = -6.5461 × 10-3 m,    [9] = -0.9284 × 10-1 m/s,     [8] = 1.5073 m/s2
[10] = -7.3110 × 10-3 m,   [10] = -0.5835 × 10-1 m/s,     [9] = 2.8651 m/s2
                                                         [10] = 3.9370 m/s2

The relative displacement, relative velocity and relative acceleration responses calcu-
lated for the first 1 second are plotted in Figure 4.7.

4.3 Central Difference Method

A family of numerical methods commonly referred to as finite difference methods makes
use of the Taylor series expansion of response and assumes that the series may be trun-
cated after some terms with negligible error if the time step is relatively small. What
is known as the Central Difference Method makes use of a one step forward and a one
step backward expansion to reduce the order of error. Recall that for some sufficiently
smooth continuous function  = (), Taylor series expansion expresses the value of
the function at  = 2 as a function of the value of itself and its derivatives at  = 1
176CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

through

                   d     (2 - 1)2 d22 +  (2 - 1)3 d33 +
(2) = (1) + (2 - 1)  +
                   d =1    2 d =1        6 d =1

          (2 - 1) d      
         = (1) + 
         =1 ! d =1

Consider now the Taylor series expansions for displacement () at  +  and  - ,
given by

                     ( + ) = () + () + 12 ()2 + (3)
                     ( - ) = () - () + 12 ()2 - (3)

where ( ) is the remainder of the expansion with leading term of order  . The sum
of the two equations above leads to

         ( + ) + ( - ) = 2() + ()2 + (4)

and if the fourth-order remainder were to be neglected, the acceleration at time  could
be approximated by

                          ()  2 ( + ) - 2() + ( - ) (4.8)
                                                     

The error so incurred is expected to decrease in an absolute sense as  decreases. On
the other hand, the difference of the two expansions leads to

         ( + ) - ( - ) = 2() + +(3)

so that neglecting the third order remainder yields the following approximation for the
velocity:

                               ()  ( + ) - ( - ) (4.9)
                                                    2

Equation 4.8 and Equation 4.9 are called the central difference approximations to the
acceleration and the velocity, respectively. These approximations may be used in the
equation of motion to express the equation solely in terms of the generalized displace-
ment. Substituting the central difference approximations into the equation of motion
4.3. CENTRAL DIFFERENCE METHOD                                           177

and considering that time is discretized with constant time step  so that  = 
and  ±  = ( ± 1), we get

() + () + () = [] + [] + []

       =  2 [+1] - 2[] + [-1] +  [+1] - [-1] + [] =  () = []
                                    2

It is straightforward to recast this expression into a regression type formula so that

given the response up to and including time  (time step ), the response at  +  (time
step  + 1) may then be estimated using

       1[+1] = ([] - 2[] - 3[-1])                                        (4.10)

where                           1 

       1 = 2 + =  [ 2 + ]
        2                        
       2 =  - 2 2 =  [2 - 22 ]
                                
                                1 
       3 = 2 - =  [ 2 - ]                                                (4.11)
        2                        
       4 = 1 2
       1
       5 = 2
       

Once again, for a constant time step , the coefficients  are to be calculated only

once. At each time step, the velocity is to be calculated from the central difference

approximation in Equation 4.9, which may be written in discrete form as

       [] = 1 2 (  [+1] - [-1]) = 4([+1] - [-1])                         (4.12)

and in the case of SDOF systems the acceleration may be calculated using the equilib-
rium equation for that time step via the discretized form:

       [] = ([] - [] - [])                                               (4.13)

In the case of systems with numerous degrees of freedom the matrix computations
involved above may be prohibitive and the accelerations may instead be calculated via
the central difference approximations:

       [] = 2 [+1] - 2[] + [-1] = 5([+1] - 2[] + [-1])                   (4.14)
                          
178CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

For initial conditions [0] and [0], the first iteration would be given by

                       1[1] = ([0] - 2[0] - 3[-1])

where [-1] is needed. One practice for a system at rest may be to assume [-1] = 0. An
alternative is to use a value consistent with the central difference approximation which

may be derived as follows: The central difference approximations for the acceleration
and the velocity at time  = 0 are

                   [0] = 2 [1] - 2[0] + [-1] ,     [0] = [1] - [-1] 2
                                    

so that using these two equations to eliminate the [1] term, [-1] is given by

                                                      2
                          [-1] = [0] - [0] -  2 [0]

where the initial acceleration term [0] is to be calculated from the equilibrium equation

at time  = 0:             [0] = 1 ([0] - [0] - [0])

The calculations involved are summarized in Figure 4.8.

Pseudocode for the Central Difference Method

viscously damped SDOF system, for constant time step

Input: ,  (or ), , , [0], [0], {[0], ... , []}

Initialize: calculate

               1,  2,     3,  4  and  5  using  Equation  4.11,  -1
               [0] = 1 ([0] - [0] - [0])
                                                                    1

                2 [-1] = [0] - [0] - 2 [0]
for  = 0, ... ,  - 1:

               [+1]    =  -1    ([]  -  2[]     -  3[-1])

                             1

for  = 1, ... , :

               [] = 4([+1] - [-1])

               [] = 5([+1] - 2[] + [-1])

               Figure 4.8: Pseudocode for the central difference method.
4.3. CENTRAL DIFFERENCE METHOD                                              179

It is extremely important to note that for the response to stay stable, meaning not to
eventually get excessively and unphysically large so as to render all results useless, the
time step used must be such that

                                               
                 
where  = 2 /  is the natural period of the system. Because of this constraint,
the CDM is said to be a conditionally stable method, as opposed to those that are stable
for any time step (which are called unconditionally stable). Note that this condition does
not necessarily guarantee accuracy, but only stability. In general, the smaller the time
step, the more accurate the results would be expected to be; a commonly suggested
value is  <  /10.

Geometrically, the central difference method is equivalent to fitting a second order
curve passing through three data points [-1], [] and [+1], and evaluating the deriva-
tives (velocity and acceleration in this case) at the midpoint. Assume a discretization
with constant time step  and consider a time variable  =  - ( - 1), such that

( =  + ( - 1)) = d( ) d ,                                            d2( )
                                       ( =  + ( - 1)) = 2

                                                                       d

for     ( + 1) and 0    2. Given three data points [-1], [] and
[+1], there is a unique second order curve ( ) that passes through all the three points

as shown in Figure 4.9. Such a curve is defined by the equation

( ) = 1 2 + 2 + 3

where  are constants that may be determined through the available information. In
fact, we have,

   ( = 0) = 3 = [-1]
 ( = ) = 21 + 2 + 3 = []
( = 2) = 421 + 22 + 3 = [+1]

Solving for the coefficients leads to

         1                             2 = 1 2 (-  [+1]+4[]-3[-1]),  3 = [-1]
1 = 2 ([+1]-2[]+[-1]),

       2

so that the velocity and acceleration at the midpoint, i.e. at  =  or  = , are
given by

[] = ( = ) = d( ) d  = (21 + 2)= = [+1] - [-1]  2

                                                 =
180CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

         Figure 4.9: Second order curve passing through data three points.

                       d2( )                     [+1] - 2[] + [-1]
      [] = ( = ) = 2  = (21)= =
                          d =                                   2

which are in fact the finite difference approximations used for these two quantities in
the central difference method.

EXAMPLE 4 .3

To illustrate how the central difference calculations proceed, let us consider the sys-
tem discussed previously in Ex. 4 .1, subjected to the half-sine pulse shown in Fig-
ure 4.3.c. The system is defined by parameters  = 125 tons,  = 200 000 kN/m
and  = 0.02 (or, equivalently,  = 2 = 200 kN  s/m). With a time step of
 = 0.01 seconds  0.06 , the force is again given by

          100 sin ( [] = { 40 ) for  = 0, 1, ... , 40
                          0           for  = 41, 42, ... , 100

and the coefficients to be used in the central difference method are calculated via Equa-
tion 4.11 as:

-1    =  7.9365×10-7,  2  =  -2300×103,  3  =  1240×103,  4     =  50,      5  =  104

   1

With zero initial conditions so that [0] = 0 and [0] = 0, [0] and [-1] are calculated
to obtain

      [0] = 1 ([0] - [0] - [0]) = 0,                                 2
                                         [-1] = [0] - [0] -  2 [0] = 0
4.3. CENTRAL DIFFERENCE METHOD                                            181

after which, through the recursive formulas given by Equation 4.29, Equation 4.12 and
Equation 4.14, the following values are calculated for the first few time steps:

 [0] = 0.0000 × 10-4 m,   [0] = 0.0000 × 10-3 m/s,     [0] = 0.0000 m/s2
 [1] = 0.0000 × 10-4 m,   [1] = 0.3114 × 10-3 m/s,     [1] = 0.0623 m/s2
 [2] = 0.0623 × 10-4 m,   [2] = 1.1891 × 10-3 m/s,     [2] = 0.1133 m/s2
 [3] = 0.2378 × 10-4 m,   [3] = 2.4792 × 10-3 m/s,     [3] = 0.1447 m/s2
 [4] = 0.5581 × 10-4 m,   [4] = 3.9608 × 10-3 m/s,     [4] = 0.1516 m/s2
 [5] = 1.0300 × 10-4 m,   [5] = 5.3824 × 10-3 m/s,     [5] = 0.1327 m/s2
 [6] = 1.6346 × 10-4 m,   [6] = 6.5023 × 10-3 m/s,     [6] = 0.0913 m/s2
 [7] = 2.3304 × 10-4 m,   [7] = 7.1272 × 10-3 m/s,     [7] = 0.0337 m/s2
 [8] = 3.0600 × 10-4 m,   [8] = 7.1418 × 10-3 m/s,   [8] = -0.0308 m/s2
 [9] = 3.7588 × 10-4 m,   [9] = 6.5263 × 10-3 m/s,   [9] = -0.0923 m/s2
[10] = 4.3653 × 10-4 m,  [10] = 5.3582 × 10-3 m/s,  [10] = -0.1413 m/s2

Figure 4.10: Displacement, velocity and acceleration response calculated for the system
of Figure 4.3 subjected to the half-sine pulse. The response quantities calculated with
the central difference method are marked with solid circles while the dashed lines are
interpolations included for visualisation.

The displacement, velocity and acceleration response calculated for the first 1 second
182CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

are plotted in Figure 4.10.

EXAMPLE 4 .4

For a second application of the central difference method, let us consider the system
and base motion of Figure 4.6. The equation of motion for 0    0.4 seconds was
shown (see Ex. 4 .2) to be given by

       () + 1.6() + 1600() = -2.5 sin (5) , {(0) = 0, (0) = 0}

while for  > 0.4 s, free vibrations ensue. With a time step of  = 0.01 s, the input is
defined by

              [] = {-7.854 sin (0.1571) for  = 0, 1, ... , 40
              0                               for  = 41, 42, ... , 100

For  = 1,  = 0.02 and  = 1600, the coefficients for the central difference method
are calculated via Equation 4.11 to obtain

-1         =  9.9206 × 10-5,  2  =  18  400,  3  =  9920,  4  =  50,  5  =  104

   1

With zero initial conditions so that [0] = 0 and [0] = 0, [0] and [-1] are calculated

to obtain

[0] = 1 ([0] - [0] - [0]) = 0,                                            2
                                              [-1] = [0] - [0] -  2 [0] = 0

after which, the recursive calculations via Equation 4.29, Equation 4.12 and Equa-
tion 4.14 yield, for the first few steps, the following results:

   [0] = 0.0000 × 10-3 m,        [0] = 0.0000 × 10-1 m/s,    [0] = 0.0000 m/s2
   [1] = 0.0000 × 10-3 m,      [1] = -0.0609 × 10-1 m/s,   [1] = -1.2189 m/s2
 [2] = -0.1219 × 10-3 m,       [2] = -0.2316 × 10-1 m/s,   [2] = -2.1949 m/s2
 [3] = -0.4633 × 10-3 m,       [3] = -0.4788 × 10-1 m/s,   [3] = -2.7478 m/s2
 [4] = -1.0794 × 10-3 m,       [4] = -0.7546 × 10-1 m/s,   [4] = -2.7686 m/s2
 [5] = -1.9725 × 10-3 m,       [5] = -1.0049 × 10-1 m/s,   [5] = -2.2369 m/s2
 [6] = -3.0892 × 10-3 m,       [6] = -1.1779 × 10-1 m/s,   [6] = -1.2229 m/s2
 [7] = -4.3282 × 10-3 m,       [7] = -1.2328 × 10-1 m/s,
 [8] = -5.5547 × 10-3 m,       [8] = -1.1465 × 10-1 m/s,     [7] = 0.1244 m/s2
 [9] = -6.6212 × 10-3 m,       [9] = -0.9173 × 10-1 m/s,     [8] = 1.6014 m/s2
[10] = -7.3892 × 10-3 m,      [10] = -0.5651 × 10-1 m/s,     [9] = 2.9833 m/s2
                                                            [10] = 4.0592 m/s2

The relative displacement, relative velocity and relative acceleration responses calcu-
lated for the first 1 second are plotted in Figure 4.11.
4.3. CENTRAL DIFFERENCE METHOD  183

Figure 4.11: Relative displacement, relative velocity and relative acceleration response
calculated for the system of Figure 4.6 subjected to the pulse-type ground motion. The
response quantities calculated by the central difference method are marked with solid
circles while the dashed lines are interpolations included for visualisation.
184CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

4.4 Interlude

Having discussed two numerical integration methods and gained a sense of how numer-
ical integration schemes operate, it may be worthwhile to look into how the "success"
of a numerical method should be judged. It is not our intention to provide a complete
coverage of the analysis of numerical integration schemes. For interested readers, there
are various studies and books in which thorough investigations may be found.3 Rather
we aim to simply introduce some of the concepts and keywords that are encountered
in such analyses so as to allude to certain pros and cons of the numerical methods that
have been and will be introduced in this chapter.

To begin with, we may try to get a sense of how well a particular approach does by com-
paring its predictions in those problems for which analytical solutions are available.
This is obviously not the best approach since there is no guarantee that if a method
works well in a particular problem it should also work well in some other: certain
qualities of the system and/or the excitation may lead to variations in how well a nu-
merical integration scheme works for that particular problem. Having expressed this
disclaimer, it is still worthwhile to get a sense of what happens through visuals. Let
us consider the sinusoidal pulse type ground motion that was investigated in Ex. 4 .2
and Ex. 4 .4. The analytical solution to such an input was developed as given in Equa-
tion 3.88 and Equation 3.90, and so the true value of the response may be calculated at
all times provided the following values are used in the analytical solution:

V = 1 m/s,  = 0.4 s,  = 2 = 5,  = 40 rad/s,  = 0.02,  =  = 
                 8

Consider, for example, the estimates that would be obtained by the central difference
method for this problem. Figure 4.12 shows the estimates obtained with the central
difference method employed with three different step sizes, i.e. 0.002, 0.01 and
0.02 seconds, along with the true values that are given by the analytical solution. Note
that all the solutions are stable since they all remain bounded: this is to be expected
since all time steps are smaller than the critical time step given by  / = 0.05 seconds.
That a solution is stable does not mean it is necessarily sufficiently accurate. The good
news seems to be that as the time step gets smaller, the central difference estimates

    3see, e.g.: N. M. Newmark and S.P. Chan, A Comparison of Numerical Methods for Analyzing the
Dynamic Response of Structures, Civil Engineering Studies SRS-036, University of Illinois at Urbana-
Champaign, 1952. S. Levy and W.D. Kroll, Errors Introduced by Finite Space and Time Increments in Dy-
namic Response Computation, J. of Research of the National Bureau of Standarts, Vol. 51, No. 1, pp. 57-68,
1953. R. E. Nickell, On the Stability of Approximation Operators in Problems of Structural Dynamics, Int. J.
Solids Structures, Vol. 7, pp. 301-319, 1971. K.-J. Bathe, Finite Element Procedures, Prentice Hall, 1996.
4.4. INTERLUDE  185

tend to match very well with the true values and in fact it is visually very difficult to
distinguish in Figure 4.12 between the true values and the estimates obtained with
 = 0.002 seconds.

Figure 4.12: Plots of results obtained for the sinusoidal pulse type ground motion (see
Ex. 4 .2 and Ex. 4 .2) with the central different method for various values of time step.
True response is the continuous red line, with solid (red) circles marking the results
for  = 0.002 s, hollow (blue) circles for  = 0.01 s, and plus signs (green) for
 = 0.02 s.

As the time step gets larger, some systematic issues begin to appear. One obvious con-
cern is whether or not the response amplitude at a given instance is estimated well.
Some part of the response relates to the input: whether or not the time step used is
small enough to capture the variations in the excitation will naturally directly affect
the results. Assuming that the excitation is captured appropriately, there could still be
an issue with what is generally called artificial damping or numerical damping. Some
numerical techniques introduce, by virtue of their approximations, an artificial dissi-
pation which causes errors in amplitude estimates. The central difference method is
not known to suffer from this error. The second and perhaps more surprising problem
186CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

is that some numerical methods introduce a change in the period of the system (some-
times referred to as period elongation) , and this seems to be a particular issue with the
central difference method, as may be observed from the response curves. As the time
step increases, the central difference method seems to lead to a decrease in the period,
very evident especially in the free vibration phase. That this effect is inherent to the
method and not specific to a particular example may be shown by direct analysis of the
finite difference equations.

Whether or not a numerical integration scheme is conditionally or unconditionally
stable is a fundamental question that in most cases precede accuracy. The analysis of
stability generally proceeds with either the analytical solution of the finite difference
equations or a state space analysis. For illustration purposes let us focus on the state
space analysis by again taking the central difference method as a case study, and further
simplify the problem by assuming that the system is undamped. The central difference
estimate of the response for such a system is given (Equation 4.29 and Equation 4.11
with  = 0) by

                                                                   2
                         [+1] = (2 - 22)[] - [-1] +   []

This equation may be complemented by the identity [] = [] so that, by defining a

state vector  [] = { []  } [-1]

the central difference estimation may be cast into state space format as

              [+1] = [A][] + [B] []

where the state transition matrix is given by

              [A] = [(2 - 22) -1]
              1                                0

Through repeated substitutions, the state after  time steps may be shown to be given
by

                                                                       -1

                          [+] = [A][] + [A]-1-[B] [+]

                                                                       =0

whence it should be apparent that whether or not the response estimates indefinitely
grow with increasing  depends on how [A] behaves. From linear algebra we know
4.4. INTERLUDE                                                            187

that a real valued matrix [A] may be expressed using its eigenvalue matrix4  and eigen-
vector matrix [V] as

                                        [A] = [V]-1[V]

where, for our 2 × 2 state transition matrix [A], the eigenvalues are the roots of the
characteristic equation given by:

      (2        -  2  2  )  -      -1    2  22
det ([                                 ]) =  + ( - 2) + 1 = 0
                                   0-
                   1

Solving this quadratic equation and using the relationship  = 2/ yields

  1,2 = 1 - 2 (  2 )  2 (  ) (  2 ) - 1
                                            

Using the eigendecomposition, the th power of [A] may be expressed as

[A] = [V]-1[V][V]- 1[V] [V]-1[V] = [V]-1[V]

                                     times

so that the stability (or boundedness) depends directly on whether or not any of the
eigenvalues have a magnitude bigger than unity, inwhich case  would increase with-

out bound as  continues to increase. For our state space model of the central difference

method, it is straightforward to see that when / > 1, the magnitude of at least
one of the roots exceeds 1 and so the system becomes unstable. When / < 1, we

have complex valued roots given by

  1,2 = 1 - 2 (  2 )  j2 (  ) 1 - (  2 )
                                                

so that the magnitude of the eigenvalues, which are a pair of complex conjugate num-
bers in this case, is given by

                                   2                                   2

                             2                     2
|1| = |2| = [1 - 2 ( ) ] + 2 ( ) 1 - ( )  = 1
                                                  

and therefore the th power of the eigenvalues remain bounded, making the system
stable. The magnitude of the maximum eigenvalue of a matrix is called the spectral

4Jordan canonical form, which is not necessarily diagonal in the presence of repeated eigenvalues.
188CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

radius of that matrix, and the stability criterion is sometimes expressed as the spectral
radius being less than or equal to 1.5

The foregoing analysis is presented to introduce some key concepts in the evaluation of
numerical techniques for solving the equation of motion. By now it should be obvious
why the step size

                                               
                                              =

                                                     

is critical, and that the algorithm should be run with a time step less than this value.
While discussing other numerical methods we will not dwell on detailed analyses, but
we will use some terminology like artificial (or numerical) damping, period elongation and
conditionally stable, all of which have been discussed or illustrated in the context of the
central difference method.

Since most of the problems go away if one were to choose a small enough time-step,
why do we care, why not choose a very very small time step and be done with it? The
computational cost for single degree of freedom systems is negligible and by all means
the problems may be alleviated by using as small a time step as desired. The signifi-
cant problem lies with systems having multiple degrees of freedom. We will eventually
see that the response of such systems may be thought of as some linear combination
of the responses of many contributing single degree of freedom systems with varying
frequencies. Consider a system with thousands of degrees of freedom: the choice of a
very small time step may drastically increase computational burden while using a larger
time step may lead to stability problems in some of those contributing single degree of
freedom systems. It is therefore crucial to understand possible problems that may be
encountered while employing numerical integration schemes so that the analyst may
correctly interpret the results obtained and perhaps optimize the choice of time step.

Another consideration that factors in predominantly when working on multi degree
of freedom nonlinear systems is whether or not an integration scheme is explicit or im-
plicit. If an integration scheme is such that all the information necessary to calculate
the displacement response at time step  + 1 is limited to those already known at the
end of time step , the method is said to be explicit. Mathematically this is analogous
to a relationship of the sort [+1] = ([], [], []) where () is some function, and
it stems from the practice of evaluating the equilibrium equation at time step  into
which the response at step  + 1 enters as some component. The central difference
method is an explicit method because to calculate [+1], we just need to know [] and

    5When / = 1, two roots are identical as 1 = 2 =  but their magnitude remains || = 1
and stability is maintained.
4.5. HOUBOLT'S METHOD                                    189

[-1], both of which are known at the end of the -th step.6 Explicit methods may
be more cost effective, especially in the analysis of multi degree of freedom systems,

but generally suffer from a need to work with relatively small time steps to minimize

errors. Implicit methods, on the other hand, make use of some information pertain-
ing to time step ( + 1) while solving for the response at that time step, and thereby

may require iterative techniques. The equilibrium equation considered is that at time
step  + 1. Mathematical expressions of implicit methods are analogous to the form
([], [], [], [+1], [+1], [+1]) = 0 where () is some function such that a sim-
ple forward time marching is not possible. Their solution is generally more costly due

to the need to iterate in between and may also involve costly matrix factorizations.

4.5 Houbolt's Method

There are many variations to the theme of finite differences, and the one that we will
now discuss as an alternative is generally referred to as Houbolt's method. Originally in
an effort to improve dynamic analyses of aircraft subjected to gusts,7 Houbolt's method
employs a four-point expansion whereby in the more commonly employed variation
the response at steps ,  -1 and  -2 are expressed in terms of the response quantities
at time step  + 1:

                       2        3
[] = [+1] - [+1] +  2 [+1] -  6 [+1] + (4)

[-1] = [+1] - (2)[+1] +   (2)2  [+1] -  (2)3  [+1] + ()4

                          2             6

[-2] = [+1] - (3)[+1] +   (3)2  [+1] -  (3)3  [+1] + ()4

                          2             6

Taking into account the third order derivatives makes this a higher order approach
than the central difference method and the error introduced by truncating the Taylor
series in this case is (4). Solving for [+1], [+1], [+1] in terms of [+1], [], [-1]

    6There is also information coming from the excitation but the excitation is assumed to be known
and hence does not affect the discussion.

    7J.C. Houbolt, A Recurrence Matrix Solution for the Dynamic Response of Aircraft in Gusts, NACA Tech-
nical Report 1010, 1951.
190CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

and [-1] while ignoring higher order terms leads to

                   [+1] = 1 6 (11  [+1] - 18[] + 9[-1] - 2[-2])
                               1

                   [+1] = 2 (2[+1] - 5[] + 4[-1] - [-2])
                              

Substituting these approximations into the equation of motion at time  = ( + 1),
given by

                            [+1] + [+1] + [+1] = [+1]

and after rearranging the terms, we get

       1[+1] = [+1] + 2[] + 3[-1] + 4[-2]                                     (4.15)

where                     2         11                 2           11

       1 =  + 2  +  =  [1 +                                2+           ]
                                  6                   () 3()
           5                  3              5         6
       2 = 2  +  =  [                              2+        ]
                                           () ()
                       4         3                 4         3
       3 = - 2  -  = - [                               2+          ]
                              2                 () ()
           1                  1                 1         2                   (4.16)

       4 = 2  +  =  [                              2+           ]
                             3               () 3()
       5 = 1 6
           1
       6 = 2
       

Pseudocode for Houbolt's Method

viscously damped SDOF system, for constant time step

Input: ,  (or ), , , [0], [0], {[0], ... , []}

Initialize: calculate

       1,  2,             3,  4,    5   and  6  using  Equation  4.16,  -1
       [0] = 1 ([0] - [0] - [0])
                                                                           1

       [1], [2], [1], [2], [1], [2] by some method

for  = 2, ... ,  - 1:

       [+1]            =  -1(           +  2[]     +  3[-1]  +   4[-2])

                             1 [+1]

       [+1] = 5(11[+1] - 18[] + 9[-1] - 2[-2])
4.5. HOUBOLT'S METHOD                 191

[+1] = 6(2[+1] - 5[] + 4[-1] - [-2])

                      Figure 4.13: Pseudocode for Houbolt's method.

Houbolt's method is unconditionally stable so that relatively larger time steps may be
used without stability concerns compared to the central difference method. On the
other hand, it introduces artificial damping and period elongation which become pro-
nounced with increasing step size. It is an implicit method since the equilibrium equa-
tion is evaluated at time step  + 1, and consequently the stiffness term that appears in
coefficient 1 has to be inverted to obtain a solution. Although this is a trivial matter
in the case of SDOF models, in the context of MDOF models it may mean the inversion
(usually by some type of matrix factorization) of a large dimensional non-diagonal ma-
trix, possibly at each time step if considering nonlinear systems with varying stiffness,
which may be computationally very costly. Another issue is the initiation, in that to
calculate [1] and [2] one needs to know [-1] and [-2] which, unfortunately, are not
directly available. It turns out that the method may be quite sensitive to these initial
conditions and that, for example, prescribing zero values for [-1] and [-2] may lead
to unacceptable results. The common procedure is to estimate [1] and [2] via some
other method and start the Houbolt progression with the third step.

Geometrically, Houbolt's method amounts to fitting a cubic curve to four data points
and evaluating the derivatives at the end point. Consider the data points shown in
Figure 4.14. A cubic curve may be fit to these four points, to be defined by the equation

                             ( ) = 1 3 + 2 2 + 3 + 4

where  are constants that may be determined through the available information. In
fact, we have,

                  ( = 0) = 4 = [-2]
                ( = ) = 31 + 22 + 3 + 4 = [-1]
               ( = 2) = 831 + 422 + 23 + 4 = []
               ( = 2) = 2731 + 922 + 33 + 4 = [+1]
192CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.14: Second order curve passing through data three points.

Solving for the coefficients one gets

      1
   1 = 3 ([+1] - 3[] + 3[-1] - [-2])
          6
   1
2 = 2 (-[+1] + 4[] - 5[-1] + 2[-2])
       2
3 = 1 (2[+1] - 9[] + 18[-1] - 11[-2]),
6                                           4 = [-2]

so that the velocity and acceleration at the end point, i.e. at  = ( + 1) or equiva-
lently at  = 3, are given by

[+1] = ( = ( + 1)) = d( ) d             =3  = (3 21 + 2 2 + 3)=3

= 11[+1] - 18[] + 9[-1] - 2[-2]
                      6

                                   d2( )    = (18 1 + 22)=3
[+1] = ( = ( + 1)) = 2 
                                       d =3 

= 2 2[+1] - 5[] + 4[-1] - [-2]
                     

which are in fact the finite difference approximations used for these two quantities in
Houbolt's method.
4.5. HOUBOLT'S METHOD                                                193

EXAMPLE 4 .5

To illustrate how Houbolt's method proceeds and to provide some comparison with
the central difference method, let us consider the relatively simple problem of free vi-
brations.

Consider an undamped system with frequency , subjected to initial conditions (0) =
 and (0) = 0, so that it is governed by

                       () + 2() = 0, {(0) = , (0) = 0}

and its response is given by

                                  () =  cos 

This response with a single known period and amplitude will allow a direct observa-
tion of any period elongation or artificial damping introduced by a numerical method.
Since the right hand side of the equation is zero, the problem represents all undamped
and unforced linear SDOF systems, and the results may be discussed in terms of the
ratio of the time step to the period of the system. Here we will discuss the estimates for
three different time steps. To provide a numerical check for the reader for Houbolt's
method, for a time step of  = 0.1 seconds and / = 0.01, the system's fre-
quency is calculated as  = 2/10, and the coefficients in Houbolt's method for this
undamped system are given by:

1 = 200.394784,                   2 = 500,       3 = -400,  4 = 100
                                                            

Given the initial condition [0] = , the estimates for [-1] and [1] are calculated using

the central difference approximations to obtain

              [-1] = 1.001974,              [1] = 0.994078
                                            

Once these two values are calculated, the recursive equation of Houbolt's method may

be employed to obtain estimates for [2], [3], .... Displacement estimates for the first

few time steps are calculated as

              [2] = 0.984240,     [3] = 0.970527
                                  
              [4] = 0.952996,     [5] = 0.931717
                                  
              [6] = 0.906774,     [7] = 0.878266
                                  
              [8] = 0.846304,     [9] = 0.811014
                                  
194CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

How the two phenomena previously discussed become more or less pronounced with
increasing time step size is quite easily observed in the plots of Figure 4.15. These
three plots show the variation of the displacement response, normalized by the maxi-
mum displacement (which is equal to the initial displacement), for the first four cycles
of oscillation. The solid line in these plots show the response calculated via the ana-
lytical solution. The hollow circles are the response values calculated with the central
difference method, and the plus signs mark those calculated with Houbolt's method.

For a relatively small time step such as / = 0.01, both methods provide good
estimates for the analytical solution, although some errors are present as would be ob-
served if one were to zoom in. Period elongations or artificial damping are not percep-
tible in the four cycles although they are present albeit in negligible amounts. These
effects become more pronounced with increasing time step size. For the time step of
/ = 0.05, the two methods lead to perceptibly different results in that the central
difference method leads to period shortening (its estimates slightly lagging the ana-
lytical solution) and Houbolt's method leads to period elongation (its estimates slightly
leading the analytical solution). With the time step of / = 0.10, the trend becomes
painfully obvious. The errors in the central difference estimates increase relative to
those of smaller time steps, yet the algorithm does not have any artificial damping since
the response amplitudes remain quite consistent. In comparison, the artificial damp-
ing in Houbolt's approach looks quite detrimental and the amplitude estimate by the
end of the fourth cycle is about half of the analytical response. Both algorithms reflect
increasing errors in period estimates with the period shortening (central difference
method) and elongation (Houbolt's method) effects becoming even more pronounced
with increasing time step size.

This of course is just one simple illustration of the critical issues in numerical integra-
tion and it is by no means conclusive. A thorough analysis requires analytical inves-
tigations of the numerical techniques but we refrain from further analysis as such an
in depth critique is not the main focus here. The brief discussion in Section 4.4 and
the references cited therein should give a flavour of what such an in depth analysis
requires. It may however be pertinent to note that the complexity of a numerical in-
tegration scheme does not necessarily guarantee accuracy. Being a higher order finite
difference technique, one may initially suppose that Houbolt's method would outper-
form the central difference method in all cases but this presupposition is clearly not
well founded as exemplified by the observations above.
4.5. HOUBOLT'S METHOD  195

Figure 4.15: The free vibration of undamped SDOF systems subjected to initial dis-

placement [] calculated using the analytical solution (solid line), the central difference
method (circles) and Houbolt's method (stars). (a) / = 0.01, (a) / = 0.05, (c)
/ = 0.1. Plots presented for normalized displacements and normalized time.
196CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

4.6 Newmark's Method

A family of algorithms proposed by Newmark8 have proven to be quite popular with
their intrinsic properties and their relation to various existing approaches. The ap-
proach is designed to employ information pertaining to acceleration at time step (+1)
step while solving for the velocity and displacement at time step ( + 1). Since the in-
formation at step ( + 1) is not available at the end of the -th step, such an approach
in principle requires an initial prediction and then subsequent corrections of the fu-
ture value. In this sense, Newmark's method essentially belongs to a family known as
predictor-corrector methods.

4.6.1 General Formulation

Newmark's formulation is based on the following estimation equations:

[+1] = [] + (1 - )[] + [+1]  (a)                                       (4.17)

[+1] = [] + [] + ( 12 - ) 2[] + 2[+1] (b)

In principle,  and  are two free parameters that may be chosen by the analyst. Soon af-
ter the method was introduced, however, it became clear that unless  = 1/2, artificial
damping is introduced and that this damping is proportional to ( - 1/2). Therefore
it has become the mode of operation to take  = 1/2 and cast Newmark's method as

[+1] = [] +  2 [] +  2 [+1] (a)                                        (4.18)
[+1] = [] + [] + ( 12 - ) 2[] + 2[+1] (b)

With dependence on only the single parameter , this formulation is often referred as
the Newmark- Method.

Using the estimations from Equation 4.18, the equilibrium equation is written at time
step  + 1 so that

                             [+1] + [+1] + [] = [+1]

and the acceleration term is solved for using

    [+1] = 1 [+1] -  [+1] -  [] = 1 [+1] - 2[+1] - 2[] (4.19)

    8N. M. Newmark and S.P. Chan, A Comparison of Numerical Methods for Analyzing the Dynamic Re-
sponse of Structures, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign,
1952. N.M. Newmark, A Method of Computation for Structural Dynamics, ASCE Journal of the Engineer-
ing Mechanics Division, Vol. 85, No. EM 3, pp. 67-94, 1959.
4.6. NEWMARK'S METHOD                                                                  197

Herein lies the fundamental issue: to calculate [+1] and [+1] via Equation 4.18 we
need to know [+1], which in turn is to be calculated via Equation 4.19 using [+1] and
[+1]! Essentially Equation 4.18 is the predictor and Equation 4.19 is the corrector,

and in one formulation of the method the acceleration is iteratively improved until

convergence (within a desired tolerance) is achieved. To discuss how such iterations

proceed, say that all response variables have been calculated for time step  so that [],
[] and [] are known. An initial estimate of [+1] is used to calculate initial estimates
for [+1] and [+1]. Let these initial estimates be denoted by

                             (0)    (0)                          [+1] (0)

                           [+1],  [+1],

so that

               (0)                                          (0)
               [+1] = [] + [] + [+1]
                           2                               2
                                                           1
               (0)                                               2         2 (0)
               [+1] = [] + [] + ( - )[] + [+1]
                                                           2

                                                                                                          (1)

These initial estimates are used to calculate the next estimate [+1] using the equilib-
rium equation at time step (+1); for example, for a linear system, this equation would

(1) be 1  (0)  (0)
                          [+1] =  [+1] -  [+1] -  [+1]

and we check whether

                      (1)  (0)
                    [+1] - [+1]  predetermined tolerance

If this condition is satisfied, then desired accuracy is reached and we set

                                                 (1)

                                [+1] = [+1]

and calculate

               [+1] = [] +  2 [] +  2 [+1]
                                                           1
               [+1] = [] + [] + ( - )[] + [+1]                   2         2

                                                           2

                                                                                  (1)  (1)
but if the condition is not satisfied, then we calculate the next estimates [+1] and [+1]

                                                      (1)

using the most recent estimate [+1] via

               (1)                                          (1)
               [+1] = [] + [] + [+1]
                           2                               2
                                                           1
               (1)                                               2         2 (1)
               [+1] = [] + [] + ( - )[] + [+1]
                                                           2
198CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

and repeat the iterations until convergence is achieved.

It is possible to formulate the Newmark- method without the need for iterations. For

this we need to formulate the equilibrium equation in terms of the displacement, which

requires the velocity and acceleration quantities to be expressed in terms of the un-
known displacement and other known quantities. Note that using Equation 4.18, [+1]
and [+1] may be expressed in terms of [+1] and response quantities of time step  as

         1                 1           1                  1
[+1] = 2 [+1] - 2 [] -                    [] + (1 - ) []           (a)
                                                          2
[+1] = 1 2   [+1] - 1 2   [] + (1 - 12 ) [] + (1 - 14 ) []         (b)
                                                                    (4.20)

With these estimates, the equilibrium equation at time step ( + 1) for a viscously

damped SDOF system yields

[+1] + [+1] + [+1] =

         1                 1           1                  1
        [ 2 [+1] - 2 [] - [] + (1 - ) []]
                                                          2

         +  [ 1 2   [+1] - 1 2   [] + (1 - 12 ) [] + (1 - 14 ) []]

            + [+1] = [+1]

and rearranging the equation leads to

            1[+1] = [+1] + 2[] + 3[] + 4[]                         (4.21)

where

                                           1              
1 =  + 2 +                 =  [1 +            2+             ]
          2                            () ()
                              1               
2 = 2 +       = [                      2+         ]
        2                     () ()
3 =   +  ( 1 - 1) =  [ 1 + (  - 2)]  2  () 
4 =  ( 21 - 1) +  ( 41 - 1) = 2  [ 1 - 1 + 2() ( 1 - 1)]
                                            2                   4

                                                                   (4.22)

The flow of the algorithm for Newmark's method as it would be applied to viscously

damped linear SDOF systems is shown below.
4.6. NEWMARK'S METHOD                                              199

Pseudocode for Newmark's Method (Newmark-)

viscously damped SDOF system, for constant time step

Input: ,  (or ), , , , [0], [0], {[0], ... , []}

Initialize: calculate

1,  2,                    3  and  4  using  Equation  4.22,  -1

                                                                1
5 = 21 , 6 = 1 - 21 , 7 =  (1 - 41 )
                       1             1
8 = 2 , 9 = - 
                          
[0] = 1 ([0] - [0] - [0])
for  = 0, ... ,  - 1:

[+1]                   =  -1(        +  2[]  +  3[]   +      4[])

                             1 [+1]

[+1] = 5([+1] - []) + 6[] + 7[]

[+1] = 8([+1] - []) + 9[] + 6[]

                     Figure 4.16: Pseudocode for Newmark's method.

Newmark's method is self starting in that initial conditions suffice to begin the itera-
tions (along with [0], which itself is calculated based on [0] and [0] alone). Its stability,
however, depends on the value of . This issue is what we discuss next, along with the
relations between this framework and some previously developed methods which may
be considered to be special cases of Newmark's approach.

4.6.2 Various Interpretations of Newmark's Method

Newmark's formulation provides a general framework from which various methods
developed previously may be derived as special cases. The free parameters  and  are
what makes this possible, and its value determines the nature of the assumed variation
of acceleration within a time step. If, for example,  = 0 and  = 0, Newmark's
velocity and displacement approximations in Equation 4.17 yield

                               [+1] = [] + []
                                                            12

                               [+1] = [] + [] + []
                                                            2

so that this choice is essentially equivalent to keeping the acceleration constant  
 < ( + 1) at its value at time step . This approach, which is not so popular due
to want of accuracy and stability, is called the constant acceleration method.
200CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Next, consider the case with  = 1/2 and  = 1/4. The approximations now yield

[+1] = [] +  2 []+[+1] = [] +  (a)                               (4.23)
                           1 2 []+[+1]
                                                    12
[+1] = [] + [] + 2  2 = [] + [] + 2  (b)

which amounts to assuming that the acceleration is constant for    < ( + 1)

at an average value of          = [] + [+1] 2

This approach is called the constant average acceleration method or, according to New-
mark and Chan,9 Timoshenko's modified acceleration method.

Finally, when  = 1/2 and  = 1/6, the approximations yield

[+1] = [] + 12 [] + 21 [+1]                                 (a)  (4.24)

[+1]                    =  []  +  []  +  1 2    +  1 2      (b)

                                         3  []     6  [+1]

These approximations are identical to those one would obtain if one were to assume

that the acceleration varied linearly for    < ( + 1) from a value of [] to a
value of [+1] since if, for  =  - ,

                           ( ) = [] + [+1] - []   

then integration leads to

( ) = [] + [] + [+1] - [] 2  2 
( ) = [] + [] + 12 [] 2 + [+1] - [] 6  3 

which yield exactly the same expressions as those in Equation 4.24 for  = ; hence,
this approach is called the linear acceleration method.

It is not surprising that the stability of Newmark's method depends on the values of 
and . Consider the commonly used case with  = 1/2 and recall the discussion of

    9N.M. Newmark and S.P. Chan, A Comparison of Numerical Methods for Analyzing the Dynamic Re-
sponse of Structures, Civil Engineering Studies SRS-036, University of Illinois at Urbana-Champaign,
1952.
4.6. NEWMARK'S METHOD                                                      201

Section 4.4. For an undamped system,10 it is possible to construct a state space model

in the form                         { [] }
                            [] =  [] 

                                    { [] }

so that Newmark's estimates may be cast into state space format as

                          [+1] = [A][] + [B] [+1]

where, for  = , the state transition matrix is given by

               1 - 1+2 2   (1 - 1+2 2 )     2            1   2
                            1 - 2(1+2) 2  ( - 2 ) ( 1+2 - 1)
                                                   2(-1/2) 1 
[A] = - 1      2             -  1+ 1 2 2        ( 2(1+2) + 2 ) 
                                                                         
                      2
               2(1+ )
               1 2                                       2(-1/2)
               - 2 1+2                                              
                                                         1+2
                      

This matrix has three eigenvalues, one of which is 3 = 0. The other two are given by

             1,2 = 1 - 2(1 + 2  ) ± 2(1 + 2 2  ) 2 - 42 - 4

Stability of the system is governed by the magnitude of the largest eigenvalue, called
the spectral radius, as discussed in Section 4.4. For  = 1/4, we have

                            |1| = |2| = 1

so that the constant average acceleration method (Newmark's method with  = 1/2,  =
1/4) is unconditionally stable. For  = 1/6, the eigenvalues are given by

               1,2 = 1 - (6 + 2 3 ) ± (6 + 2 2 2 )  3 - 4 2

When 2 = 12, we have 1 = 2 = -1, and this in fact is the transition point from a
stable to an unstable scheme since for 2 > 12 the spectral radius, i.e. the largest value

of the magnitude of the eigenvalues, will exceed 1. The stability condition is therefore
             2 = ()2 = ( 2 2   )  12     3  0.551
                                               

and the linear acceleration method (Newmark's method with  = 1/2,  = 1/6) is con-
ditionally stable. The variation of the spectral radii for the two methods is shown in
Figure 4.17.

   10For a more detailed discussion with linear viscous damping included see, e.g., Chapter 9 in K.-J.
Bathe, Finite Element Procedures, Prentice Hall, 1996.
202CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.17: Spectral radii for two commonly employed Newmark- methods as a
function of the ratio of the time step  to the period  of the undamped SDOF sys-
tem.

4.7 Numerical Integration for Nonlinear SDOF Sys-
      tems

A predominant assumption in most structural engineering practice is that for small
deformations and displacements, the structural members behave as linear elastic mate-
rials and geometric changes are small so as to not give rise to any sources of geometric
nonlinearity. That said, in applications such as seismic design where extreme events
like strong ground motions from rare earthquakes must be considered, linear elastic
behavior is most probably not a valid assumption. The current design principles stip-
ulate that overconservative approaches leading to structures that remain linear elastic
even under extreme loadings may yield suboptimum/uneconomical designs.11
Most notably in the context of seismic design, it is reasonable to assume that struc-
tural members may undergo yielding and permanent deformations, and in doing so
dissipate great amounts of energy through mechanisms such as cracking and spalling,
yielding of joints and reinforcement bars, shearing of gusseted connections etc. The

   11There is much to say about this with many recent earthquakes demonstrating that the social and
economic losses that accumulate after significant earthquakes may reach devastating levels. "Resilience' '
is likely to be a central concept in the coming years.
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS  203

Figure 4.18: a) Linear vs. nonlinear behavior of structural elements. b) Elastic-perfectly
plastic assumption, where material stiffness vanishes past the yield point but elastic
response is recovered as the displacement direction reverses.

concept of nonlinear response and energy dissipation are schematically illustrated in
Figure 4.18. The energy dissipated in a hysteretic cycle is the area enclosed by the
hysteresis loop and dissipation through plastic deformations may reach levels much
more prominent than the dissipation provided solely by the viscous damping model.
It is therefore important to understand how yielding behavior and other nonlineari-
ties in the load-bearing members would influence the response of the structure. In the
context of SDOF systems, maximum relative or absolute displacement observed un-
der an excitation may be important design considerations. Intuitively, we can imagine
that yielding beyond a critical point may promote additional energy dissipation and
thereby reduce maximum displacement, at the expense of resulting in some perma-
nent deformation. A member that yields at a relatively low critical level of force how-
ever may result in excessive deformations, either transient and permanent, and these
may reach unallowable levels for design purposes. Even for a simple SDOF system
in which the nonlinear behavior of the material is idealized as elastic-perfectly plas-
tic, often shortly referred to as elastoplastic, the response depends on the loading and
deformation time-history, yield strength and other parameters, and thus generalized
analytical solutions are elusive. Numerical methods presented in the previous sections,
however, are broadly applicable to situations where structural members behave non-
204CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

linearly.

There has been much progress in our understanding of the behavior of nonlinear sys-
tems in recent decades, which has allowed identification of simple design rules that
allow us to predict the expected total response of structures without any nonlinear anal-
ysis. These rules of thumb commonly employed in building codes have been based on
documented behavior of nonlinear response of buildings from simulations and thereby
projecting outcomes based on their elastic properties and approximated yield response.
In doing so, engineers have simplified seismic design in building codes to the extent
that nonlinear analysis is often not mandatory and dynamical response variables may
be estimated from linear analysis on the basis of typical expectations of ground mo-
tions in a region, soil properties, and the degree to which the system may safely exhibit
ductility without loss of all load bearing capacity. Nevertheless, simulation of nonlin-
ear systems remains an important topic, at a minimum to reinforce the underpinnings
of these design methods and in many instances to attain more accurate and economical
structural solutions.

In this section, we will revisit a couple of the methods presented previously, the cen-
tral difference method and the Newmark- approach to illustrate their application to
nonlinear systems.

4.7.1 Central Difference Method for Nonlinear SDOF Systems

The approximations presented in Equation 4.8 and Equation 4.9 for the central dif-
ference method are readily adopted to study nonlinear systems as well, since these are
simply mathematical approximations of the basic variables describing the motion of the
system in time. That said, it will be shown later that system characteristics such as the
yield point will influence the accuracy of the method relative to other numerical meth-
ods. CDM is arguably the easiest method to apply to nonlinear systems given the sim-
plicity of the algorithm and transferability to a generalized scenario where the spring
term behaves nonlinearly. On the other hand, given its explicit nature, it is prone to
error as it will generally have difficulty accurately reproducing member forces around
the yielding point.

The generalized nonlinear equation of motion for SDOF systems subject to an external
forced excitation may be expressed as

() + ((), ()) = ()  (4.25)

but often (unless structural elements such as suppplemental dampers make it necessary)
it is assumed that the velocity dependent damping term may be modeled by the linear
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS                  205

viscous damping model so that the governing equation is expressed as:

                           () + () + (()) = ()                         (4.26)

If, for example, the excitation is ground motion, then the equation of motion will be

given by

               () + () + (()) = -()                                    (4.27)

and in discretized form, equilibrium at time step  will require

                           [] + [] + {()}[] = []                       (4.28)

In these equations,  represents the nonlinear spring force and in general it is a func-

tion of the displacement time history () up until the current time. If the central dif-

ference approximations of Equation 4.8 and Equation 4.9 are employed and the dis-

placement at time step  + 1 is isolated as the unknown as was done in linear analysis,

one gets

               1[+1] = [] - 2[] - 3[-1] - {()}[]                       (4.29)

where          

               1 = 2 +
                2
               2
               2 = - 2
                                                                       (4.30)
               
               3 = 2 -
                       2   1                                     1

               (and for use further down the line: 4 = , 5 = 2 )
                           2                                     

Note that the definition of 2 is different than its previous version used in linear sys-
tems since the spring force now appears separately in () Once again, for a constant
time step , all of the coefficients  are to be calculated only once. At each time
step, the velocity is to be calculated from the central difference approximation in Equa-

tion 4.9, which may be written in discrete form as

               [] = 1 2 (  [+1] - [-1]) = 4([+1] - [-1])               (4.31)

and the acceleration may be calculated using the equilibrium equation for that time

step given by

                           [] = [] - [] - {()}[]                       (4.32)
206CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

or from the central difference approximation given by                       (4.33)
               [] = 2 [+1] - 2[] + [-1] = 5([+1] - 2[] + [-1])
                                  

The nonlinear spring force  will generally depend on the model used for describing
the nonlinearity of the element. For the idealized case of an elastic-perfectly-plastic

spring subject to loading cycle as shown in Figure 4.18, member deforms elastically
up to the yield point, in which case the force generated is  = . In the post-yield
regime, force generated by the member remains constant  = . When the un-
loading begins, which may be determined based on the direction (sign) of velocity, the

spring force follows a straight path parallel to the initial loading line. Once the unload-

ing reaches a level such that yielding is initiated in the opposite direction, the spring
force once again takes on a constant value, given now by  = -. This loading -
unloading sequence goes on as the direction of velocity is reversed. An example pseudo-

code is provided below for the special case of perfect elastoplastic SDOF systems with

viscous damping.

Pseudocode for the Central Difference Method for Nonlinear Systems

viscously damped SDOF system with nonlinear spring, for constant time step

Input: ,  (or ), () (or for elastoplastic, , and  or ), , [0], [0],

{[0], ... , []}

Initialize: calculate

                 1,  2,   3,  4  and  5  using  Equation  4.30,  -1
                 [0] = 1 ([0] - [0] - {()}[0])
                                                                    1

                  2 [-1] = [0] - [0] - 2 [0]
for  = 0, ... ,  - 1:

                 [+1]  =  -1    ([]  -  2[]  -  3[-1]     -  { ()}[] )

                             1

for  = 1, ... ,  - 1:

                 [] = 4([+1] - [-1])
                 [] = 5([+1] - 2[] + [-1])

Figure 4.19: Pseudocode for the Central Difference Method for Nonlinear Systems.
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS  207

EXAMPLE 4 .6

To identify some fundamental behavioral concepts, consider the analysis of an elasto-
plastic toy model with mass  = 1 kg, viscous damping ratio  = 0.05, and ini-
tial undamped period  = 1 second, subject to a cyclic base acceleration given as
() = sin  m/s2. If the yield limit is  = 3 N and similar behavior is observed in
tension and compression, what will be the maximum displacement?

The response of this model is calculated via CDM with an example code and the max-
imum displacement is found to be 0.098 m. The code illustrates the simplicity of the
central difference algorithm, owing to the explicit nature of the approach, which makes
calculations of the spring force easy as they only depend on the previous time step.
The implementation, however, has relatively low accuracy, especially in systems where
there is an abrupt change in stiffness due to yielding. The elastoplastic case is an ex-
treme example in this regard, since the post-yield stiffness is zero.

Some important physical insights can be gained from this simple example. First, the
yielding behavior of the elastoplastic system provides energy dissipation through hys-
teresis, with the size of the hysteresis loop giving us a sense of energy dissipated in each
cycle. In this particular case, the dissipation energy in viscous and spring forces are
comparable, and this helps further reduce the peak displacement of the system relative
to the purely elastic case (0.098 m vs. 0.253 m for elastic). Figure 4.1 illustrates these
findings. These observations support the notion that yielding of elements may provide
an economical way of reducing peak displacements under strong dynamic excitations,
i.e. ground motion. The caveat, however, is that there is permanent deformation, which
can be calculated from the mean of the steady state response, which in the case of har-
monic deformation is small. As  is reduced, more energy can be dissipated, up to a
practical limit beyond which either the hysteresis loop becomes too small and peak dis-
placements increase, or plastic deformations become excessively large. The degree of
plastic deformation will be proportional to the ratio of the peak displacement recorded
in the linear elastic case vs. /, that is the displacement limit for yield. We will con-
sider this ratio further in seismic design, to be visited in later chapters. These concepts
can be further explored in the case of harmonic excitation by modifying the example
code provided, for instance to explore how yield limit, excitation characteristics, and
viscous damping parameters influence the relative role of yielding on reducing peak
displacements.
208CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.20: a) Example displacement time history for an elastoplastic system subject
to harmonic ground excitation; b) spring force vs. displacement showing the hystere-
sis loop; c) damping force vs. displacement, showing viscous dissipation. The Python
scripts used to calculate the response can be found here.
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS  209

4.7.2 Newmark's Method for Non-linear Systems

While explicit methods such as central difference are easy to implement for nonlin-
ear systems, implicit approaches are often preferred due to their higher accuracy and
stability. In this context, the Newmark family of algorithms are quite popular, and
they will be briefly discussed in this section to exemplify how their implementation in
nonlinear cases differs from linear cases and explicit methods. As in the case of linear
systems, the implicit nature of the method requires that force at each time step be cal-
culated taking into account information from that same time step. In a system where
the spring or damping forces are non-linear, this requires iterative calculations within
each time step to precisely capture possible variations in system properties. The fun-
damental approximation involved is the assumption that properties of the system are
considered to be constant at very short time intervals (within a time step) but vary over
time. Within each step, iterative solutions determine how the system variables change,
and displacements, velocities and accelerations are calculated consistently to satisfy the
equations of motion. A commonly used iteration method is illustrated herein first for a
static problem, and then integrated into Newmark's method to solve SDOF structural
dynamics problems.

4.7.2.1 Newton-Raphson Iteration

Consider a scenario in which the spring force - deformation relationship is nonlinear as
shown in Figure 4.18. Assume the system is subject (or rather will eventually be subject
after deformation) to a static external force  . The system resists the external force by
some  and if the nonlinear spring is the only element then the resisting force is simply
the force in the spring. There may be other components, say for example dampers
or other terms coming from numerical approximations, which may contribute to this
resistance and so we use the term resisting force to denote their cumulative act. Assume
for simplicity that the resisting force is a function of only the generalized displacements,
i.e.  = (). If the initial displacement is (0), which may or may not be equal
to zero, the resisting force is given by (0) = ((0)). Unless by a very fortuitous
surprise, the system is most likely not balanced in that (0)   , and we have not yet
reached equilibrium. The system will have to deform further to reach equilibrium, and
the question is, by how much?

The Newton-Raphson approach tries to answer this question by iteratively updating
the displacement and the unbalanced force until a specific condition is set and the con-
vergence is deemed acceptable. Mathematically it is a root finding method, adopted
here to minimize the residual  =  - (). The objective of the iteration is
210CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

to reduce  below an acceptable threshold, which represents the acceptable error
in force calculations. The underlying approximation may be discussed via Taylor ex-

pansion of : consider that an estimate of the state and the resisting force, which is
essentially a known function of the estimate of state, is available for the -th iteration,
i.e. () and () are known. The linearized Taylor series expansion approximation for
the resisting force in the next iteration (i.e. essentially the resisting force at some other

state) can be expressed as

            (+1)  () +   ((+1) - ()) =  ()  + ()  ()
                                  ()

where () = (/)|() is the equivalent tangent stiffness at (), and
() = (+1) - () is the state step (as opposed to the time step we have re-

ferred to previously). Recall that we have assumed the resisting force to be a function

of the generalized displacement alone; for more complicated cases, for example

involving generalized velocities, the tangent stiffness may have to be a matrix. The

setback is that we do not know the next point in the expansion, i.e. we do not yet know
(+1) or, equivalently, (). We may try to estimate the state step using the current

imbalance in the system, i.e.

            () = ( - ()) = ()
            ()              ()

where () is called the residual or the imbalance at iteration . But now that we have
a new estimate for the state, given by

            (+1) = () + ()

we may calculate a new estimate for the resisting force, i.e. (+1), and check whether
the system is in equilibirum or not. An exact equality may be too much to ask but

we may be satisfied with an approximate answer such that the error is less than some

tolerance, so that we may check whether

            (+1) =  - (+1)  force tolerance

or whether

            (+1) - ()  state tolerance

If the convergence condition is satisfied we may stop the iterations and use the final
values as our best estimates, otherwise we may proceed further with the iterations by
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS    211

simply repeating the steps involved for the next iteration. All this may be graphically
easier to grasp via the schematic description in Figure 4.21 (a). A simplified version
that is often referred to may be conducted by keeping the same tangent stiffness in
all iterations, which is also graphically depicted in Figure 4.21 (b); the benefit being the
savings obtained by minimizing the number of tangent stiffness calculations at the cost
of possibly more iterations. The good news is that the Newton-Raphson approach is
quite general and it may be used for other type of nonlinear interactions, such as for
example a nonlinear damper.

A very simple example may suffice to demonstrate the steps involved. Consider a spring
for which the force-displacement relationship is given by

                                =  for  in mm  0
                     
with  = 10 N/ mm, and assume that the spring is subjected to an external force
of 50 N, as sketched in Figure 4.22.

The exact solution is obvious: the spring has to deform 25 mm for the system to equi-

libriate. Let us try to see if we can apply the Newton-Rhapson iterations to obtain this
result. Assume our initial guess for the displacement is (0) = 1 mm (note that an ini-
tial guess of 0 would yield an infinite tangent stiffness so that it would not be useful
to start from). Since the only resisting element is a spring, we have  = . The
unbalanced force and the tangent stiffness at this step are

(0) =  - (0) = 50 - (10)(0) = 40 N,

(0)     5
 =   (0) =    = 5 N/mm
         (0)

The state step is therefore given by
                                       (0) (0)

                                    = (0) = 8 mm
                                                

and the next estimate is calculated as
                                 (1) = (0) + (0) = 9 mm

with the new resisting (spring) force
                                 (1) = (10)|(1) = 30 N
212CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.21: Newton-Raphson iteration method for calculating nonlinear spring
forces.
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS                 213

Figure 4.22: Simple nonlinear spring subjected to an external force.

Repeating the steps above will lead to the following results:

(1) = 9 mm, (1) = 30 N, (1) = 20 N, (1) = 53 N/mm, (1) = 12 mm
(2) = 21 mm, (2) = 45.83 N, (2) = 4.17 N, (2) = 2.45 N/mm, (2) = 1.70 mm
(3) = 22.70 mm, (3) = 47.64 N, (3) = 2.36 N, (3) = 1.05 N/mm, (3) = 2.25 mm
(4) = 24.95 mm, (4) = 49.95 N, (4) = 0.05 N, (4) = 1.00 N/mm, (4) = 0.05 mm
(5) = 25 mm, (5) = 50 N, (5) = 0 N

With the residual falling to zero, we may safely stop the iterations and identify the so-
lution as 25 mm, which happens to coincide with the exact solution. In more realistic
problems we would have to accept some small error to avoid excessive number of iter-
ations in order to save on computations.

4.7.2.2 Newmark with Newton-Rhapson

Now that we have established the procedure for solving nonlinear equilibrium equa-
tions, we can proceed with formulating Newmark's algorithm for nonlinear systems.
For simplicity, we consider here an SDOF system with a nonlinear spring force, with
equation of motion given by Equation 4.26. The discretized form of this equation for
time step ( + 1) will be given by

[+1] + [+1] + {()}[+1] = [+1]                                         (4.34)
214CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

No matter what the spring force looks like, Newmark's approximations for the
velocity and acceleration, given by Equation 4.20, remain the same. Therefore the
velocity and acceleration estimates [+1] and [+1] will be given by

[+1] = 1 2   [+1] - 1 2   [] + (1 - 12 ) [] + (1 - 14 ) []         (4.35)
       1    1                         1             1
[+1] = 2 [+1] - 2 [] -                   [] + (1 - ) []
                                                    2

With these estimates, the equilibrium equation in Equation 4.34 may be written as

[+1] + [+1] + {()}[+1] =

       1    1                         1             1
        [ 2 [+1] - 2 [] - [] + (1 - ) []]
                                                    2

       +  [ 1 2   [+1] - 1 2   [] + (1 - 12 ) [] + (1 - 14 ) []]

          + {()}[+1] = [+1]

The coefficients may be grouped together to obtain

       1[+1] = [+1] + 1[] + 2[] + 3[] - {()}[+1]                   (4.36)

where                                                  1

       1 = 2 +                     , 2 = +  ( - 1) ,
           2                                           2
          3 =  ( 1 - 1) +  ( 1 - 1)                                (4.37)

                                   2                4

This equation is very similar to the equation we tried to solve while discussing the static
load application in that we have

       1[+1] + {()}[+1] = [+1] +1[ ] + 2[]+3[]

       like  of the static case          like  of the static case

and the question is whether or not the equality holds. Most probably it will not, and
we will have to iteratively solve for the value of [+1] which will balance the equation,
and in a dynamic progession we will have to do this for each time step separately.

For implementation details, consider that we have solved the state for all time steps
until , so that [], [] and [] are all known, along with all values of the excitation.
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS                 215

Within time step  + 1, we may be in iteration , for which we check whether the
equation

1[+1] () + {()}[+1] () = [+1] + 1[] + 2[] + 3[]

is satisfied (within some eror tolerance). If it is, then we set
                                         [+1] = [+1] ()

and calculate the velocity and the acceleration for time step  + 1 via Equation 4.35. If
it is not satisfied, however, we need to update our estimate, for which we first calculate

            () = 1[+1] () + {()}[+1] ()
() = ([+1] + 1[] + 2[] + 3[]) - ()

                   ()                                             ()
 =   () = 1 +   () = 1 + 
                        [+1]    [+1]

where () = (/)|() is the tangent stiffness, which is the contribution of the

                                                              [+1]

actual physical stiffness terms to the equivalent tangent stiffness. The state step is to

be determined via          () ()
                        [+1] = ()

                                      

and the new estimate for the generalized displacement is given by

                        [+1] (+1) = [+1] () + [+1] ()

and use this new estimate to calculate {()}[+1] () and the other quantities involved.
We check if another update is necessary, by either checking

                   (+1)  force tolerance

or
                              [+1] (+1) - [](+1)  state tolerance

and decide whether to proceed with further updates. Say that iteration  is the itera-
tion at which we have satisfied the error condition, with the final value calculated given
by [+1] () . Then we set

                                         [+1] = [+1] ()

using which we calculate the velocity and acceleration for time step  + 1 via Equa-
tion 4.35, and move on to the next time step. The algorithm is summarized in Fig-
ure 4.23.
216CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Pseudocode for Newmark's Method - Non-linear Spring (Newmark-)

viscously damped SDOF system with non-linear spring, for constant time step

Input: ,  (or ), (), , , [0], [0], {[0], ... , []}, tolerance(s)

Initialize: calculate
1 = 2      + 2                         +  ( 21 - 1),
                          ,  2  =    

      

3 =  ( 21 - 1) +  ( 41 - 1),

4 = 21 , 5 = 1 - 21 , 6 =  (1 - 41 ),
        1                 - 1
7  =  2    , 8         =         ,

      
[0] = 1 ([0] - [0] - ([0]))
for time steps  = 0, ... ,  - 1:
Initialize: set [+1] (0) = []

+1 = [+1] + 1[] + 2[] + 3[]

           for state step  = 0, ... convergence:

                       () = ()

                                              [+1] ()

                       () = () + 1[+1] ()

                       () = +1 - ()

                           ()          
                        = 1 +   ()
                                                       [+1]

                            () ()

                        = ()

                                        

                       [+1] (+1) = [+1] () + ()

                       if tolerance(s) satisfied, set [+1] = [+1] (+1)

Compute velocity and accelerations:

[+1] = 4([+1] - []) + 5[] + 6[]

[+1] = 7([+1] - []) + 8[] + 5[]

    Figure 4.23: Pseudocode for Newmark's method with nonlinear spring force.

EXAMPLE 4 .7
Consider a SDF system with  = 10000 kg and  = 0.02. The restoring force-
deformation relation is elastoplastic with stiffness  = 200 kN/m before yield and
yield force  = 18 kN. The system is subjected to a sinosoidal force excitation given
4.7. NUMERICAL INTEGRATION FOR NONLINEAR SDOF SYSTEMS  217

as  = 10sin() kN. Determine the response of this system (starting from rest) within
0    5.0 sec using the Central Difference Method and Newmark- constant and
linear acceleration methods, with  = 0.1 sec. Compare the results.

The comparison of the response computed using Newmark- method (with  = 1/4
and  = 1/6 ) are shown in Figure 4.24. It can be seen that the various methods
give rise to small but noticable differences in the response calculation, which can have
an effect on the peak response quantities obtained from the time histories obtained
using different integration methods. In general, these differences may become more
prominent with greater nonlinearities and coarser time step choices.
218CHAPTER 4. NUMERICAL SOLUTIONS OF THE SDOF EQUATION OF MOTION

Figure 4.24: Comparison of central Difference Method (CDM) and Newmark -  al-
gorithms for Ex. 4 .7 displacement, velocity, and nonlinear spring force time histories.
The Python scripts used to calculate the response can be found here.
Chapter 5

Seismic Analysis of Single Degree of
Freedom Systems

5.1 Preliminary Concepts

In previous chapters we covered most of the required analysis approaches for calcu-
lating the response of SDOF systems to various types of excitations including ground
motions. Determining a system's response to base excitation is important for a variety
of applications. We mentioned that base excitations in the form of ambient vibrations,
human activity such as pedestrian or vehicle traffic, or nearby industrial activity such as
construction and mining may induce small-amplitude vibrations that may nevertheless
be noticeable and may even be important in housing of sensitive equipment. Yet, many
of these activities typically cause insignificant displacements in well-designed struc-
tures even if they cause uncomfort to occupants. Conversely, so-called strong ground
motion, arising from seismic activity and most significantly in large earthquakes, is so
centrally important in structural analysis and design that it merits a dedicated discus-
sion. For this purpose, here we will briefly discuss some fundamental concepts from
seismology such as causes of earthquakes and measures of earthquake intensity, fol-
lowed by a qualitative discussion of factors that may influence structural behavior and
possible damage in response to an earthquake. In latter sections response and design
spectra for linear systems will be introduced, followed by a discussion of inelastic be-
havior of structures and its implications for structural design .

                                               219
220CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

5.2 What Is An Earthquake?

The outermost layer of Earth is called the lithosphere. Earth's thin crust is part of the
litosphere and this crust is subject to extreme stresses that arise from the tremendous
mass and relative motion of its fragmented sections because the lithosphere is essen-
tially floating on another layer, called the asthenosphere, which is viscous. Each section
of the lithosphere that seemingly moves as a single slab is called a tectonic plate or sim-
ply a plate, and the scientific theories and studies regarding the motions of these plates
constitute the field of plate tectonics. There are 15 tectonic plates identified currently,
some of which are called continental plates as they contain the continents, and some
called the oceanic plates which spread between continental plates due to driving forces
such as the heat from the mantle and magma cooling in the ocean bed. In a simple anal-
ogy, the movement of these plates resembles those of frozen sheets of ice on a partially
frozen water body, i.e. with the water body representing the asthenosphere, the liquid-
like viscous layer of the mantle. The interfaces of plates are called faults; as plates are
driven to move, stresses build up along these faults due to constraints that hinder free
relative motion, such that deformations occur in the plates. More generally, faults are
fracture planes in Earth's crust; they may be large so as to form interfaces inbetween
tectonic plates, or they may be small (its all relative as even small may mean many kilo-
meters long) so as to result from more local rock mass movements. Eventually the
stress may exceed the interface resistance causing the plates or rock masses to slide rel-
ative to each other, either vertically (dip-slip fault), laterally (strike-slip fault), or some
combination of vertical and lateral (oblique-slip fault). With the slip, the deformation
energy previously stored in the plate is released by the elastic rebound1 of the plate.
Figure 5.1 schematically illustrates the cycle.

Post-slip elastic rebound causes seismic waves that travel across the lithosphere. These
waves include body waves that travel within Earth, comprising longitudinal tension-
compression motion (P waves) and shearing motion (S waves), and surface waves that
are generated as the body waves emerge on the surface of the crust (Rayleigh and Love
waves). These waves cause local lateral and vertical displacements as they pass through
a point on the ground. Some of the commonly encountered terms are schematically
noted in Figure 5.2.

    1The concept of elastic rebound was established by Harry F. Reid's seminal report entitled "The Me-
chanics of the Earthquake, The California Earthquake of April 18, 1906" on the 1906 San Francisco
earthquake. The report established substantial elastic bending of the ground through geological surveys
that seemed to have occurred in years leading to the earthquake.
5.2. WHAT IS AN EARTHQUAKE?                221

Figure 5.1: Slip along a fault line, showing the (a) original state (b) development of strain
due to impeding slip (c) elastic rebound post-slip.

Figure 5.2: Basic earthquake terminology.
222CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

5.3 Measuring the Magnitude Of An Earthquake

Anecdotal records of earthquakes date back centuries. Systematic quantification of the
magnitude and time-history characteristics of earthquakes, however, has become pos-
sible only with the advent of seismographic tools. Specifically, accelerometers housed
in special stations that are distributed across the world offer us recordings of ground
accelerations. Such recordings allow scientists to identify the epicenter as well as the
amount of energy released. Figure 5.3 shows actual ground acceleration time histories
that were measured during three earthquakes that occurred in a relatively small time
span at distinct geographic locations.

Coming up with a single, all-telling indicator to characterize the measure of an earth-
quake has been an elusive task. Characterizing the behavior of a structure that will
be subjected to a future earthquake is all the more so since uncertainties regarding
structural behavior compound with uncertainties surrounding what a future ground
motion may look like. A general framework proposes that the risk posed to a system is
determined jointly by the hazard to which the system will be exposed and the system's
fragility or vulnerability so that:

                                  Risk = Hazard × Fragility

Ground motion studies try to model and estimate the hazard component while
structural engineering studies focus on modeling structural behavior and estimation
of fragility. The measure of an earthquake may mean either a quantification of the
hazard or a quantification of the risk. For hazard, the measure used may be some
magnitude that will try to define how big the energy released during the earthquake
is, or some characteristic parameter, like for example the peak ground acceleration, that
will try to quantify the amplitude of motion at a specific location. Examining the
earthquake records shown in Figure 5.3, we can see that earthquake excitations are
generally of random nature without a clear observable pattern. As is characteristic of
earthquake ground acceleration time histories, the peak ground acceleration, taken as
the maximum value of ground acceleration measured, is different in each case since
it depends on distance from the epicenter, magnitude of the earthquake, geological
conditions at the site, the response of the structure housing the equipment, instrument
characteristics, and other factors. This obviates the well accepted notion that correct
interpretation of a seismogram requires us to put the data acquired from a number of
seismograms into context through some form of normalization, such that the mag-
nitude of the earthquake can be objectively determined. Additionally, scaling (e.g. to
attain a target peak ground acceleration), orientation and other post-processing steps
may be necessary prior to utilizing seismogram data for structural analysis purposes.
5.3. MEASURING THE MAGNITUDE OF AN EARTHQUAKE  223

Figure 5.3: Earthquake ground acceleration time histories from 3 different earth-
quakes, Kocaeli (Türkiye) 1999 Iznik Station (90 degrees), Northridge (USA) 1994 Ca-
marillo Station (180 degrees), and Kobe (Japan) 1995 Takarazuka Station (90 degrees).
Note that horiontal (time) and vertical (acceleration in g) axes are scaled differently
across figures.
224CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

The wide-spread availability of seismographic data allows us to have not just qualitative
but also quantitative description of `big' an earthquake is. In general use are two differ-
ent phrases to describe how big is `big': intensity, and magnitude. Intensity commonly
refers to a qualitative measure of the devastation caused in the built environment, and
sometimes also in the natural environment, by the earthquake. Such a measure may
be helpful for organizing disaster response and for emergency policy-making, among
other purposes. The Modified Mercalli Intensity (MMI) Scale2, for example, is an in-
tensity measure widely used around the world. MMI scale, summarized in Table 5.1,
ranges from I to XI (roman numerals), with the severity of damage increasing with
intensity. MMI estimates may be developed via observation reports and also seismo-
graphic measurements such as maximum (peak) ground velocity which have previously
been correlated with the MMI scale.

                        Table 5.1: Modified Mercalli Intensity Scale.

Intensity  Shaking   Description / Damage
I          Not felt
                     Not felt except by a very few under especially favorable
II         Weak      conditions.
                     Felt only by a few persons at rest, especially on upper
III        Weak      floors of buildings.
                     Felt quite noticeably by persons indoors, especially on
IV         Light     upper floors of buildings. Many people do not recognize it
                     as an earthquake. Standing motor cars may rock slightly.
V          Moderate  Vibrations similar to the passing of a truck. Duration
                     estimated.
VI         Strong    Felt indoors by many, outdoors by few during the day. At
                     night, some awakened. Dishes, windows, doors disturbed;
                     walls make cracking sound. Sensation like heavy truck
                     striking building. Standing motor cars rocked noticeably.
                     Felt by nearly everyone; many awakened. Some dishes,
                     windows broken. Unstable objects overturned. Pendulum
                     clocks may stop.
                     Felt by all, many frightened. Some heavy furniture moved;
                     a few instances of fallen plaster. Damage slight.

    2The Modified Mercalli Intensity Scale dates back to the work of Harry Wood and Frank Neumann
in 1931 at a time preceding a more clear understanding of the factors that govern the level of destruction
dealt by an earthquake and how instrumental measurements could be used to assess this objectively.
5.3. MEASURING THE MAGNITUDE OF AN EARTHQUAKE  225

Intensity  Shaking  Description / Damage
VII
           Very     Damage negligible in buildings of good design and
           Strong   construction; slight to moderate in well-built ordinary
                    structures; considerable damage in poorly built or badly
VIlI       Severe   designed structures; some chimneys broken.
                    Damage slight in specially designed structures;
IX         Violent  considerable damage in ordinary substantial buildings
                    with partial collapse. Damage great in poorly built
X          Extreme  structures. Fall of chimneys, factory stacks, columns,
                    monuments, walls. Heavy furniture overturned.
                    Damage considerable in specially designed structures;
                    well-designed frame structures thrown out of plumb.
                    Damage great in substantial buildings, with partial collapse.
                    Buildings shifted off foundations.
                    Some well-built wooden structures destroyed; most
                    masonry and frame structures destroyed with foundations.
                    Rails bent.

Magnitude, on the other hand, is a measure of the amplitude of ground motion and
energy released in an earthquake, independent of its effects on the environment. In
that sense, a magnitude measure may seem more objective than an intensity measure,
but in essence they serve different albeit similar purposes. Early efforts to build an ob-
jective and quantitative measure for earthquake intensity made use of seismographic
data that was becoming widely available. In 1935, Charles F. Richter developed a scale
that aimed to account for the size of an earthquake using the peak amplitude measured
by a torsional seismometer called the Wood-Anderson seismograph, normalizing this
amplitude empirically for the distance from the epicenter to arrive at a local measure of
the magnitude. An important notion of the Richter magnitude was that it employed a
logarithmic scale to describe the magnitude. The Richter scale, often referred to as the
local magnitude (scale) and denoted by , is no longer commonly used today, and it
has been replaced by other magnitude measures such as the Moment Magnitude Scale
(MMS)  which improves upon the shortcomings of the Richter scale.  is an es-
timate of energy released during an earthquake based on the estimate of a seismic mo-
ment, defined conceptually as the product [slip length] × [fault area] × [rigidity], where
rigidity depends on the cohesive strength of the rocks along the faults on which the
slip occurs. Just to provide a comparison, the amount of energy released by a  = 6
earthquake is comparable to that of an atomic bomb. This measure is also logarith-
226CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

mic, so that an increase from  = 6 to  = 7 corresponds to a ten fold increase
in energy released. Each year, multiple earthquakes of  > 7 occur in various lo-
cations around the world. Extremely large earthquakes can register  > 9, such
as the 2011 Tohoku (Japan) earthquake, which triggered a tsunami that compounded
the devastation caused by the earthquake. While many of the large earthquakes cause
no fatalities as they occur in remote locations, there have been significant earthquakes
from the past decade that have caused loss of life measured in tens of thousands and
total damage or collapse of thousands of buildings. As such, the issue of seismic design
remains as relevant as ever for structural engineering and urban planning, especially
for settlements near active faults.

5.4 Architectural Considerations in Earthquake Re-
      sistant Design

Many socio-economic considerations, including availability of fresh water and access
to fertile lands, have influenced development of civilizations and birth of mega cities
that harbor most of the human population in the modern age. Indeed, some of the
world's most populated urban centers are near active faults, and as such, it is not eco-
nomically viable to avoid seismic hazards altogether by choosing low-hazard regions
for further development. A number of considerations in structural design can, how-
ever, reduce the risk of structural damage. Many of these design considerations can be
explained by intuition without resorting to any structural design calculations. Among
the factors governing the demands generated on a structure by an earthquake, site con-
ditions are of paramount importance. Waves travel quicker through dense geomateri-
als such as hard, unfragmented rock surfaces, which reduces the amplitude of ground
motions transferred onto structures. Conversely, softer ground conditions such as soft
clay and filled lake or river beds can amplify the amplitude of ground motion by multi-
ple times. Construction in such regions may require implementation of soil improve-
ment techniques, such as drawing piles that extend the foundation to the bedrock. An
additional consideration is soil liquefaction, in which the increase in pore water pres-
sure of soils due to excitation may reduce the load bearing capacity, thereby causing
buildings to topple over or sink, sometimes even with their foundations intact, into
the ground. This may cause damage and collapse even without visible damage to struc-
tural elements above surface.

As one may expect from all that we have learned in previous chapters, the natural fre-
quency of the structure as well as available damping will also influence the demands.
The fundamental period of a building can roughly be estimated as the number of sto-
5.4. ARCHITECTURAL CONSIDERATIONS IN EARTHQUAKE RESISTANT DESIGN227

ries divided by 10. Random vibrations such as earthquakes can be thought as a super-
position of many harmonic excitations, where in the particular case of earthquakes the
notable contributions to the signals come from excitations in the fraction of one Hz to
several Hz range. Stiffness of structural elements is of course critical in determining
where the frequency lies relative to this range. Typically, low to mid-rise multi-story
buildings are more susceptible to earthquakes, whereas for high-rises the flexible na-
ture of the tall cantilever structure makes the response amplification much smaller, and
in such cases lateral wind loads are often the dominant design consideration for deter-
mining member sections.

Construction and materials quality are additional factors that determine structural re-
sponse outcomes, and we cannot overemphasize the importance of quality control and
site inspections for ensuring good seismic performance of well-designed structures. In
most structures, the cost of the structural elements is a much smaller fraction of the to-
tal cost of the building, and from an engineering standpoint it is sensible to invest in
high structural performance over superfluities that are largely cosmetic.

A number of design factors also contribute to the structural response. Symmetrical
plans and continuous load transfer mechanisms, especially along vertical axes, are
known to be beneficial or at least nondetrimental is seismic behavior. Typically,
basic structural designs utilize moment resisting frames, diagonal braces, or shear
walls to limit lateral drift due to earthquake loads. Codes typically limit drift to 1%
of building height to avoid excess damage. Seismic resisting elements placed at the
perimeter help limit drift and also maximize torsional resistance of these structures.
Uniformity of load bearing elements is important: designs should avoid short column
effects that will concentrate stresses on particular load-bearing elements, or soft
stories that often arise when fewer columns are used in entrance floors to generate
commercial or parking spaces but are susceptible to formation of collapse mechanisms.
Additionally, simple design considerations, such as low height to base ratios (to avoid
overturn), equal floor heights or stiffness distributions, short spans, diaphragms
without large openings, and avoiding cantilevers are preferable. Aseismic design
guidelines are well-described in building codes and documents such as FEMA 4543
which offer guidance for seismic considerations in architectural design. Structures
conforming with these design guidelines are considered to be regular structures, for
which analysis procedures may be considerably simpler. That said, irregularities may
need to be present for architectural or other purposes and are permissible within the
guidelines of building codes (e.g. ASCE 74 in the US) that delineate conditions that

    3FEMA 454, Risk Management Series: Designing for Earthquakes - A Manual for Architects, 2006.
    4Minimum Design Loads and Associated Criteria for Buildings and Other Structures (ASCE/SEI
228CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

must be satisfied for these structures to be code-compliant. While these aspects are
worthy of mentioning to promote awareness, in depth discussion of such practical
considerations is beyond our scope and can be found in building codes and references
focusing on structural design.

5.5 Earthquake Response Spectra for Linear Systems

Let's recall that the equation of motion for a viscously damped linear SDOF system
subject to ground accelerations () is given by

                             () + () + () = -()

which may also be expressed as
                             () + 2() + 2() = -()

whereby it is quite obvious that the mass of the SDOF system does not explicitly factor
into the equation in the case of ground motion, although it influences system parame-
ters such as its natural period. In the context of seismic design, our primary goal is to
determine the peak value of a key response variable, for example the relative displace-
ment of the mass with respect to the ground, given a particular ground acceleration
time history (). These calculations will almost always have to be done via numerical
methods.

The equation of motion implies that the response to a specific ground motion depends
only on the natural frequency (or period) and the damping ratio of the system. How
a response quantity varies with the period of the system is a very important design
consideration, and the concept of a response spectrum was previously introduced
in our discussion of forced vibrations of SDOF systems precisely for this reason. In
the particular case of earthquake response spectra, we compute the peak response
quantity (for example the absolute maximum value of ()) attained due to a par-
ticular ground acceleration time history (), and plot it against the period of the
structure. Given an earthquake ground acceleration record, the response spectrum
tells us what peak values may be expected depending on the period  of the system.
Often the same plot may include multiple graphs, each corresponding to a different
value of the damping ratio. Of particular interest is the displacement (deformation)
response spectrum, where we can define the absolute maximum of the displacement as:

                              D = D( , )  max ((,  , ))

                                                                           

7-22).
5.5. EARTHQUAKE RESPONSE SPECTRA FOR LINEAR SYSTEMS  229

Figure 5.4 illustrates how the displacement response spectrum of SDOF systems vary
with their undamped period  in response to the Kobe and Northridge records shown
in Figure 5.3. The spectra are developed for a damping ratio of  = 5% using the

central difference algorithm.

Figure 5.4: Displacement response spectra for systems with  = 5% for Kobe and
Northridge ground motion records shown in Figure 5.3.

The two ground motion records are quite different (see Figure 5.3) and so are their re-
sponse spectra; there are, however, some common behavioral observations. When the
period is very small (as   0), the deformation is negligible, as this limit represents
an extremely rigid structure that moves as a rigid body with the ground. At the other
extreme (as   ) , each spectra seems to converge to some constant value, as this
limit represents an extremely flexible structure in which the mass basically stands still
as the ground moves, with the maximum deformation given by the peak ground dis-
placement (of that particular ground motion). The mid-period range is where obvious
differentiation between the ground motions appear and this region is where most civil
engineering structures are located.

One could similarly compute the absolute maximum values of the relative velocity and
absolut (total) acceleration responses. Plotting these computed values against the nat-
ural period of the SDOF system can be used to construct the relative velocity response
230CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS
spectrum and the acceleration response spectrum. These two spectra are seldom computed.
Instead, it is more practical to compute the so-called pseudo-velocity, defined as

                                        V = D = 2 D (5.1)
                                                       

and the pseudo-acceleration, defined as
                                    A = 2D = ( 2 2 ) D (5.2)
                                                      

whic are very close, but not exactly equal in the presence of damping, to the peak rela-
tive velocity and the peak absolute acceleration, respectively.

Figure 5.5: Acceleration response spectra for systems with  = 5% for the Kobe and
Northridge ground motions shown in Figure 5.3.
Figure 5.5 shows the pseudo-acceleration response spectra derived from the displace-
ment response spectra shown in Figure 5.4. Again, the two spectra are significantly
different, each reflecting the nature of its corresponding ground motion, albeit with
some common behavioral patterns. Each spectra starts (as   0) from the peak
ground acceleration of its ground motion, as this limit represents a completely rigid
structure with the mass moving identically with the ground. At the other extreme (as
5.5. EARTHQUAKE RESPONSE SPECTRA FOR LINEAR SYSTEMS  231

  ), both spectra asymptotically converge to zero, as this limit represents an ex-
tremely flexible structure with the mass standing still as the ground moves. Once again
the mid-period range reflects the particular energy contents of the individual ground
motions, with high amplifications for some values of the period and not so significant
amplifications in others. The response spectra essentially represent the demand on
a structure: the bigger the response spectra, the more deformation the structure will
have to resist.

We may naturally inquire how the pseudo-acceleration relates to the absolute (total)
acceleration. In the case of undamped SDOF systems, the two quantities are identical.
We can see this by writing the equation of motion as

                       () + () = 0

and thus

                       () = -2()                     (5.3)

where we note that () is teh absolute (total) acceleration given by () = ()+().

From Equation 5.3 it is clear that the total acceleration scales proportionally with rel-
ative displacement (), with the proportionality constant being 2. This approxima-

tion is not strictly true for damped systems since with the inclusion of the damping

term, acceleration is

                       () = -(2() + 2())

However, the maximum of the relative displacement (deformation) occurs when the

relative velocity is zero, and the acceleration at that instance, while not exactly equal
to its peak value, is given by -2. This value is a close approximation for lightly

damped systems. The error of this approximation will grow with the damping ratio
but for common structures with  < 0.1 it is inconsequential, justifying the use of

Equation 5.2.

The utility of calculating the pseudo-acceleration becomes apparent when we think
about what will be the peak demand from our SDOF system due to the ground excita-
tion. For SDOF systems, two of the significant measures of demand are the base shear
and overturning moment: these quantities have direct implications on demands re-
garding shear forces, bending moments and axial forces that must be transmitted by the
vertical members right above the ground. A popular conceptualization that bears some
familiarity to the models the structural engineers are accustomed to is to think about
a set of external forces that would, if they were to be applied to a stationary stucture,
generate the same deformations as those that would be induced by the ground motion.
These hypothetical forces are called equivalent static forces, to be denoted by () in
232CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS
    Figure 5.6: Base shear and overturning moment due to earthquake excitation.
5.5. EARTHQUAKE RESPONSE SPECTRA FOR LINEAR SYSTEMS  233

SDOF systems. Obviously if the deformation (relative displacement) in an SDOF sys-
tem at any instant is , the external force that would have to be applied to that system
to generate the same deformation without motion would have to be  = . Since
the internal forces developed in members depend on the deformations, the equivalent
static forces may be used to calculate the internal forces that must be transmitted by the
load bearing members using static equilibrium concepts. The equivalent static forces,
although hypothetical, are of course related to the inertial effects through the equation
of motion. Consider the SDOF force diagram shown in Figure 5.6. Using d'Alembert
forces, we may consider static force and moment equilibrium of the whole system and
calculate the base shear and overturning moment as:

     () = -(), () = -()                              (5.4)

The equivalent static force concept says that we may use the lateral static force (applied
in concordance with the sense of the generalized coordinate) () = (), in which
case we would have

     () = (), () = ()                                (5.5)

That these are both viable approaches (the d'Alembert forces are in fact exact) for cal-
culations may be deduced from the equation of motion of an undamped system since
then we would have

     () + () = 0  -() = () = ()

so that if damping were neglected, Equation 5.5 and Equation 5.5 would yield identical
results. With damping there will be differences but such differences could very well be
neglected for lightly damped systems. The peak values for base shear and overturning
moment may therefore be calculated via

      = D = A                                        (5.6)

and

      = D = A                                        (5.7)

When expressed in units of gravitational constant g, the pseudo-acceleration A directly

specifies the magnitude of peak base shear as a ratio to the weight ( = g) of the

SDOF system; e.g. when A = 0.7g, then the peak shear is  = 0.7g = 0.7 or, in
other words, 70% of the structural weight.
234CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

5.6 Characteristics of Response Spectra

From Equation 5.1 and Equation 5.2 we note that the response quantities D, V, A are
all interrelated through the equation

A = V = D


which, when expressed in terms of the period instead of the frequency, become

 A =  = 2 
2  

Logarithms (say to base 10) of these relations lead to

                              log V = - log  + log D + log 2

                              log V = + log  + log A - log 2

so that if log V were to be plotted against log  , log D = constant would be a line
parallel to the -45 line (in other words, parallel to the line log V = - log  ), and
log A = constant would be a line parallel to the +45 line (i.e. parallel to the line
log V = + log  ). Therefore, if plotted on the same logarithmic figure with the ver-
tical axis corresponding to V, D axis would have a slope of +1 and A axis would have
a slope of -1. Thus, the three spectral response parameters D, V, and A may be shown
on a single tripartate logarithmic graph as plotted in Figure 5.7. Such tripartate plots
have historically helped identify certain trends in earthquake response spectra which
in turn have been employed in development of design spectra.

There are two extremes in such spectra which happen to yield identical behaviors
across all earthquake ground motions: lines for different  converge to the same limits
asymptotically at the low and high ends of the spectra. These two extremes may be
explained by mechanical considerations. When the period is very low (  0), the
stiffness of the system should be extremely large (assuming a proportinately finite
mass). In the limit, if the structure were to be infinitely stiff (  ), then we would
have 

                                    () + () = 0  ()
so that with no relative displacements, the mass would move identically as the ground.
Hence the maximum absolute acceleration of the mass would be identical to the peak
ground acceleration so that

                 as   0, D  0 and A  peak ground acceleration
5.6. CHARACTERISTICS OF RESPONSE SPECTRA  235

Figure 5.7: Tripartite D-V-A spectra for various damping ratios for the Kobe 1995
ground motion record of Figure 5.3 scaled to a PGA of 1g.
236CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

At the other extreme when   , the system has negligibly small stiffness (  0)
so that almost no force is transmitted to the mass. The mass therefore stands still as
the ground moves, with

             () + () = 0    ()  -(), ()  -()

and we have

               as   , D  peak ground displacement and A  0

Note that these trends are clearly independent of the ground motion as they are rather
solely dominated by the physical properties of the system. The mid-range of the peri-
ods meanwhile illustrate the regime in which damping plays a pivotal role in the dy-
namic amplification observed. The behavior in this region is generally idealized as
variations around a constant velocity value.

5.7 Elastic Design Spectra

It will be of interest to plot variations in the pseudo-acceleration response spectrum
for different values of  for a given ground motion time-history. This is shown in
Figure 5.8 for the Kobe ground motion record of Figure 5.3. It is clear yet again that
damping plays an important role for SDOF systems in the mid-period range. While the
excitation time history would cause notable differences in the spectra, some generic
observations can be made.

For  values that are very small, A converges to the peak ground acceleration. As the
period gets longer, A exhibits a sharp increase with increasing  . This increase can
be assumed to be more or less linear. At intermediate values of  , A shows large fluc-
tuations in lightly damped systems. A plateau-like behavior can be seen as damping
increases. Highest sensitivity to the damping ratio is observed in this intermediate
regime. For design purposes, we may consider A to be roughly constant over a nar-
row range of  values beyond the initial linear increase regime, before transitioning
to a decay regime. The value of A strongly depends on  in this intermediate range.
Beyond this point, A exhibits a roughly inverse 1/ relation with the  and possibly
transitions to a 1/ 2 scaling at very long periods.

In summary, three distinct regions possibly arise in an idealized spectrum. The spec-
trum starts from the PGA value and linearly rises in the acceleration governed, small
period regime. In the narrow velocity governed regime, A fluctuates around an aver-
age value, possibly with sharp peak and troughs. At longer periods, A decays inversely
5.7. ELASTIC DESIGN SPECTRA  237

Figure 5.8: Acceleration response spectra for the Kobe '95 earthquake with various
damping ratios and PGA = 1 g.

with the period and the response is governed by a large relative displacement. These
basic features form the basis of linear elastic design spectra used in structural design
codes such as ASCE/SEI 7: "Minimum Design Loads and Associated Criteria for Build-
ings and Other Structures". The parameters describing the curve, most notably the two
periods that mark the transition points in the so-called traditional 2-period response
spectra (2PRS), are determined based on the local regulations that take into account
the expected magnitude of the earthquake and ground conditions, considering an ideal
maximum credible earthquake (MCE, e.g. an earthquake with ~2,500 yr return period).
Various tools (such as the "ASCE Hazard Tool") can be used to obtain design spectra for
specific site conditions. It should be noted that with ASCE 7-22 and subsequent ver-
sions, the design guidelines have shifted from the traditional two-period response spec-
tra (2PRS) to multi-period response spectra (MPRS) that better captures the frequency
characteristics of earthquakes5. Notable differences between 2PRS and MPRS spectra
are the sharper peak and transition in the velocity governed regime and a more gradual
decay in the long-period regime. Figure 5.9 demonstrates the ASCE 7-22 prescribed
response and design spectra (defined as the 2/3 of the intensity of the response spec-

    5MPRS methodology was proposed partly to better estimate the response of long-period structures
on soft soils where 2PRS estimates may not be conservative.
238CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS
trum to MCE) for a site on stiff soil and ordinary building (Risk Level II) in Evanston,
IL, USA.
The discussion of practical considerations in constructing and using response and de-
sign spectra are purposefully kept brief here not to detract from the fundamental con-
cepts pertaining to structural dynamics. Developing understanding of seismic hazards
results in continuous changes in design codes and regulations, as such, these discus-
sions are meant to familiarize the reader with general considerations rather than in-
tending to convey the most up to date and accurate practices. For a more in depth
discussion of response and design spectra, as well as their historical development, we
refern the reader to comprehensive references on structural dynamics and seismic de-
sign6.

Figure 5.9: Example response and design spectra (spectral acceleration vs period): Risk
Level II, Class D buildings in Evanston, IL, USA based on ASCE 7 specifications.

    6Anil K. Chopra, Dynamics of Structures, 6th edition, 2024.
Ray W. Clough and Joseph Penzien, Dynamics of Structures, 2nd edition, 2015
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  239

EXAMPLE 5 .1

Based on the response spectra shown in Figure 5.8 scaled down to a PGA of 0.5g, cal-
culate the peak base shear and overturning moment for an SDOF idealization of a one-
story building with floor mass  = 250 000 kg, floor height  = 3 m, total lateral
stiffness  = 10 000 kN, and  = 0.05. Express the base shear and overturning mo-
ment in terms of the weight of the structure.

We first compute natural frequency and period of system as  =   = 6.32 rad/s.
This gives

                                       = 2 = 0.993 s.
                                             

We can estimate A from the graph as

                                    A  1.2 × 0.5 = 0.6g

noting that the acceleration must be scaled down by 50%. Then, the base shear is cal-
culated as a function of the weight  = g:

             =  = 0.6g = 0.6

Similarly,

             =  = 1.8

5.8 Earthquake Response Spectra for Non-linear Sys-
      tems

The elastic response and design spectra are helpful in understanding the response of
a building to strong ground motion, particularly the effects of viscous damping and
the natural period on response characteristics. The current paradigm in earthquake
engineering, however, is based on the premise that it is not feasible economically to
design buildings in a way to ensure that they respond elastically in rare large earth-
quakes. It is expected and deemed acceptable to some degree that a building shall re-
spond inelastically to a significant ground motion; that cracking of concrete, yielding
240CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

and plastic deformation of reinforcing bars or moment resisting steel frames shall oc-
cur. These material nonlinearities conribute to energy dissipation capacity of the struc-
ture. Additionally, when displacements become large, geometric nonlinearities may also
become significant; for instance, brace members or suspension cables may exhibit large
deviations from their undeformed orientations, which in turn may necessitate use of
nonlinear trigonometric relations to model the stiffness term in the SDOF equation of
motion.

Figure 5.10: Excessive damage due to high inelastic demands in a large earthquakes.
Spalling of concrete and buckling of longitudinal reinforcement indicate that the de-
sign capacity has been exceeded.

Inelastic behavior is difficult to quantify and predict exactly, but safety may be approx-
imately accounted for by estimating how much ductility structural members can ex-
hibit without losing load-bearing capacity, and how that capacity would fare against
the total elastic and plastic deformations that a structure would have to sustain during
an earthquake, i.e. demand. High inelastic demands may lead to excessive damage on
load bearing members, a few examples of which are shown in Figure 5.10; significant
demands may lead to collapse of structures during earthquakes or the structure may
need to be demolished after the earthquake due to irreperable damage. In this section
we will try to examine the effects of plastic deformations on the response time histories
and consequently the peak response spectrum variables D,V and A.

5.8.1 Strength Reduction and Ductility

The elastoplastic (elastic-perfectly plastic) spring model was previously introduced in
the context of non-linear numerical integration methods, where it was also illustrated
how energy is dissipated via plastic deformation in the form of hysteresis during cyclic
excitation. We once again adopt the simple elastoplastic spring model to account for
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  241

post-elastic deformations, this time in the context of earthquake induced ground mo-
tions. With no claims to exactness, the elastoplastic (elastic-perfectly plastic) model
leads to some observations which help understanding of response behavior in more
complicated nonlinear force-deformation relationships in which stiffness is continu-
ously modified throughout the analysis to simulate plastic deformations that could oc-
cur due to large displacements.

Figure 5.11: Force-displacement relationships: (a) ideal elastoplastic spring model, (b)
the corresponding linear elastic model.

Recall that in the first loading (d  0 throughout) of an initially unloaded and unde-
formed elastoplastic spring, the force-displacement (-) relationship is defined as:

                                    = { if  < . (5.8)
                                              if   .

Yielding begins when  = , i.e. the yield displacement, and the corresponding spring
force  is called the yield force. When defining such a spring one also needs to pre-
scribe unloading and reloading roles, for which it is assumed yielding in tension and
compression occur at the same deformation level ( ±  where  is some value of
 for which  = 0), and all unloading and reloading lines are parallel to the initial
loading line. These rules are graphically summarized in Figure 5.11 (a).

It has become customary in earthquake engineering to define a hypothetical conjugate
linear SDOF system (also referred to as the corresponding linear system) for comparison
242CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

purposes. The conjugate linear SDOF system is a system with the same mass and the

same initial tangent stiffness as the inelastic system, and it is assumed that the conjugate

system remains linear elastic with this stiffness value. If the conjugate linear SDOF
system has a stiffness of  and its maximum deformation under an excitation is D = ,
then the peak force transmitted by the spring of the conjugate system is  = . The
comparative behavior of an elastoplastic system and its conjugate linear SDOF system

are sketched in Figure 5.11 (b). By definition, the force in the elastoplastic spring can
not exceed the yield force so that if  > , then  > . One measure of inelastic
action is the strength reduction factor  (also reffered to as the yield strength reduction

factor), defined as
                                       =  =   1
                                             

The strength reduction factor is significant because in some sense it provides a bound

for force-based design: if the system is allowed to deform inelastically, then the force

it will have to be designed for is less than the force it would have to resist if it were

to remain elastic. This sounds too good to be true and it is: plastic deformations may

not be allowed to reach excessive levels and, even more importantly, the system must

be designed sufficiently well so as to be able to undergo expected plastic deformations

without any failure (however one may define failure). So the strength reduction factor

by itself does not suffice to ensure successful aseismic design. Another commonly used

measure in earthquake engineering is the ductility demand  (also referred to as the

ductility factor) defined as   = 
                                     

where  is the maximum (in an absolute value sense) deformation that occurs in
the system under a particular excitation. The ductility demand helps to quantify the

amount of plastic deformation that will be asked of a system designed with some value
of  in mind. For a certain value of , the response of the inelastic SDOF model may
be computed numerically to estimate the maximum deformation  with which the
ductility demand may be forecast.

In the context of damped SDOF systems with damping ratio , several important ques-
tions arise. First, what is the relationship between , , and  , and to a lesser extent
? Qualitatively, one can expect that higher values of  will result in greater ductility
demands, but how does this depend on system variables? Another important question
is: how should an inelastic response spectra be constructed to understand the impact
of ductility demand on key response variables, and what are the appropriate variables
to ensure a rational comparison with elastic systems? This will allow us to contrast
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  243

strength-based designs (elastic design) and ductility-based designs (inelastic design) to
see how they fare against each other from an economical or structural performance
standpoint.

5.8.2 Inelastic Response Spectra

Analyses by Veletsos and Newmark7 using the El Centro and Vernon earthquake
records in the early 1960s helped clarify how elastic and inelastic behavior can be
contrasted. To examine various issues, we'll calculate the response of inelastic systems
subjected to an actual ground motion (in our case the Kobe '95 record) using the central
difference algorithm. The first question that arises is, can inelastic deformations
dissipate sufficient energy to reduce the maximum displacement attained to be below
that of the conjugate linear system. Figure 5.12 illustrates that for lightly damped
systems, this appears to be the case over a wide range of intermediate periods.

For fairly rigid systems with small periods, on the other hand, plastic deformations be-
come quite excessive, often exhibiting a multi-fold increase relative to linear responses.
In this regime, the large ductility demands shown in Figure 5.13 impose some practi-
cal limitations on the utility of inelastic behavior. Thus, for structural systems that are
fairly rigid and with periods lower than 1 second, the design tends to rely predomi-
nantly on strength to ensure that the response remains largely elastic. Inelastic defor-
mations seem to contribute to keeping the peak displacements relatively small in the
intermediate period range even for increasing values of viscous damping. Whereas
for long-period structures, benefits of hysteretic damping seem marginal, in a sense
similar to the case of viscous damping. In this long-period regime, as previously dis-
cussed in the context of elastic spectra, a system with a finite mass is relatively so very
flexible that the mass basicaly stands still as the ground moves; hence one essentially
has     peak ground displacement. This convergence also implies that for
long-period systems one has    since for  = ,

                                =  =  =  = 
                                        

and not surprisingly we see that the ductility curves in Figure 5.13 tend to their respec-
tive strength reduction factors toward the higher values of the period. The observation
that for longer periods    (and, equivalently,   ) is called the equal dis-
placement rule and it has been used as a basis for many code provisions.

    7A.S. Veletsos and N.M. Newmark, Effect of Inelastic Behavior on the Response of Simple Systems to
Earthquake Motions, Proc. of 2nd WCEE, pp. 895-912, 1960.
244CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 5.12: Ratio of maximum displacement (elastic or inelastic) to maximum elastic
displacement (observed in the conjugte SDOF system) for the Kobe ground motion
record of Figure 5.3 considering four different values of  (with  = 1 corresponding
to the elastic case) and two different values of damping ratio: (a)  = 2%, (b)  = 20%.
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  245

Figure 5.13: Variation of ductility demand as a function of period for four different
values of  (with  = 1 corresponding to the elastic case) for the Kobe ground motion
record of Figure 5.3.
246CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

To delve deeper in to these comparisons, it will be fruitful to think about how response
spectra may be constructed to allow for direct comparison between inelastic and elastic
systems. For this purpose, we consider that the maximum elastic strain energy that can
be stored in the inelastic system is given by

12 1  21 2
    = () = V
2  2        2

where the pseudo-velocity spectral response variable is defined as V  . This
notation is consistent with elastic pseudo-velocity and pseudo-acceleration definitions
presented earlier, since for  = 1 corresponding to the elastic case we have

   D =  = 

Similarly, the pseudo-acceleration spectral response and yield-deformation spectral re-
sponse variables can be defined in accordance with linear systems, which results in the
following relationships:

                                      A  = V = D (5.9)

As in the case of linear systems, A is significant from a design standpoint because it
is related to the maximum base shear and overturning moment that can be attained,
i.e.  = A since the maximum member force is capped at the yield strength. It is
of practical utility to construct a constant ductility response spectrum for the variables
shown in Equation 5.9 to understand how ductility demand will impact these response
measures. Such a development, however, requires iterative determination of the rela-
tionship between  and . This can be done by numerically computing the ductil-
ity demand and then determining the largest value of the  that results in a target
, within an acceptable threshold. Interpolation of  and  relationships computed
with a small number of points may also be used to more efficiently converge to the
ductility solutions. Figure 5.14 demonstrates the relationship between  and . From
Figure 5.14, it is apparent that as   0,   1. In the limit as    period limit,
  . It has also been empirically suggested that   2 - 1 in the intermediate
range, although various analytical formulas could be fitted to this regime. These basic
rules of thumb, along with linear interpolation of  between these constant  regimes
can be used to determine design values for yield-strength reduction factors empirically
based on ensembles of ground motion data to construct inelastic design spectra.

Figure 5.15 illustrates the variation of A with  . Comparing Figure 5.8 with this spec-
tra while being mindful of the scaling difference due to different PGAs, it is evident
that the role of inelastic deformation is similar to damping, with a moderate amount
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  247

Figure 5.14: Relationship between  and  for different  for a system with  = 0.05
subjected to the Kobe ground motion record of Figure 5.3.
248CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

Figure 5.15: A vs  for varying  values for a system with  = 0.05 subjected to the
Kobe ground motion record of Figure 5.3.
5.8. EARTHQUAKE RESPONSE SPECTRA FOR NON-LINEAR SYSTEMS  249

of ductility strongly reducing the amount of strain energy that must be accommodated
elastically in the system during deformations. As in the case of viscous damping, in-
elastic dissipation is most effective in the intermediate range of periods, which is the
velocity sensitive regime. For the pseudo-acceleration spectra, it is clear that allowing
a ductility factor of  = 2 is equivalent to having a linear system with fairly high levels
of damping (~10%) in the velocity-sensitive regime. Considering that most structural
engineering materials and member designs can accommodate reasonable amounts of
ductility in the range of   3, and that externally supplementing viscous damping is
relatively costly, ductile designs offer economical alternatives to purely strength-based
designs that enforce strictly linear behavior.

Based on these considerations, we can summarize the seismic design process as fol-

lows. The designer may choose to pursue a strength-based design approach, ensuring

that the response remains elastic at all times. This may be an economical solution in

fairly rigid, short period structures in which high ductility demands may result in dis-
placements that exceed safety limits even with a relatively small . For intermediate

to longer period structures, accounting for some degree of inelastic deformation will
often yield more economical solutions.8 This can be pursued by choosing a reason-
able  and determining what is an acceptable ductility demand, for instance using the
approximate  -  relationships listed above for different period ranges. In building

codes, the reduction factor is generalized to account for not only the yield behavior but

also the overstrength that a structure should have, which is the difference between the

design strength and the true yield strength that exceeds that value. All the relevant pa-

rameters such as the maximum deformation of an inelastic system can be determined

directly from an elastic response spectrum. For instance, in the case of an allowable
stress design approach, assume that the designer needs to determine . Based on the
type of the structure and materials used, building codes typically prescribe an allow-
able ductility factor . Based on a linear elastic design spectrum, A can be determined
for a given  and  . Then, approximations for  based on  can be determined for
the given  using the established empirical relationships (recall trends in Figure 5.14).
From there it follows that  = A/ = . Additionally, one may need to consider
the maximum displacement attained to ensure that it is within allowable limits. Recall

    8We have to be careful about what we mean by "economical" as the validity of the adjective depends
very much on the boundaries or horizon of analyses. Recent earthquakes have unfortunately shown
that indirect losses, such as significant population migration away from heavily damaged quarters and
the consequent socio-economic losses may better be avoided even at higher costs of initial construction.
"Resilient Urban Environment" may become the dominant paradigm in recent future.
250CHAPTER 5. SEISMIC ANALYSIS OF SINGLE DEGREE OF FREEDOM SYSTEMS

that  =  =  (5.10)
  D

where D is the maximum displacement attained in the conjugate linear system, and
thus  = D/. Noting that for the conjugate linear system,

A = ( 2 2 ) D                                         (5.11)
        

we can use Equation 5.11 in Equation 5.10 to obtain:

            1 2                                       (5.12)
 =  ( ) A

             2

5.9 Wrapping Up

In this chapter, we tried to introduce the basic concepts and analyses techniques de-
veloped for understanding how SDOF systems respond to base excitations, most no-
tably in earthquakes. For linear systems designed for substantial strength, construc-
tion of elastic response spectra is relatively straightforward and can be done using ex-
isting ground acceleration time-histories. Appropriate care must be taken to ensure
that time-histories, notably frequency range of the excitations, and peak amplitude
of ground accelerations taken are representative of the site conditions and historical
characteristics of earthquakes in the region. Principles underlying simplified design
spectra commonly employed in building codes were briefly mentioned. We also in-
troduced concepts of inelastic response spectra and design considerations, namely the
importance of ductility in dissipating energy and economical designs that arise when
ductility is favored over strength.
Chapter 6

Models for Linear Multi Degree of
Freedom Systems

When more than one but still a finite number of generalized coordinates are required
to model the dynamics (inertial effects) of a system, the system is classified as multi
degree of freedom (MDOF). Even locating a single particle may, in the most general
case, require three coordinates when its motion is unconstrained. Unconstrained rigid
bodies require six generalized coordinates, comprising generally the three coordinates
of its center of mass and the body's three rotations about the same point. The horizon-
tal floor plate of a single-story structure, for example, may require three generalized
coordinates as it translates and rotates in its own plane, when it is modeled as a rigid
body and the vertical members are assumed axially rigid so that the motion of the floor
plate is assumed to be restricted in the vertical direction. A simple but frequently em-
ployed model is that of a multi-story structure in which all floor plates are assumed
to translate in only one horizontal direction, but the existence of multiple such stories
requires as many coordinates as the number of floors to track each one.

The fundamental principles/laws that we use to derive the governing equations for
multi degree of freedom systems are of course the same ones we have used heretofore.
The difference is that now we will end up with multiple equations, as many as the num-
ber of degrees of freedom, which will be coupled through stiffness and/or inertia terms
(or sometimes even through requirements regarding the distribution of damping). The
solution of these equations will either require a direct numerical integration scheme,
or an analytical approach (often coupled with a numerical scheme) in which an inter-
mediary step will lead to uncoupling the governing equations and reduce the problem

                                                251
252 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

to solving for the response of a number of single degree of freedom systems.

In this chapter we limit our investigations solely to linear systems. The analysis of
nonlinear MDOF systems is almost always conducted via numerical integration algo-
rithms and contain additional complexities the introduction of which may wait until a
thorough understanding of linear response is accomplished.

6.1 Equations of Motion in Matrix Form

To begin thinking about the equations that govern the dynamics of linear MDOF sys-
tems let's first consider the simple case of a three degree of freedom system. A tinker
toy model of a 3-DOF system is shown in Figure 6.1 a in which three point masses
connected by springs and dashpots are allowed to move in one direction. Since the in-
dividual masses may move in differing amounts, we need to track the position of each
separately. The positions of the masses 1, 2 and 3 are denoted by 1, 2 and 3,
respectively, and these are the generalized coordinates of our model. External forces
1(), 2() and 3() may in general be imposed on the masses.

Since we have three distinct point masses, Newton's second law may be applied to each
individual mass separately, which will in turn yield the governing equation for that
mass in terms of the generalized coordinates and system parameters. Since the motion
of each mass is one dimensional, we may develop the equations using scalar analysis.
To this end we first have to sketch the free body diagram of each mass at an instant at
which all kinematic variables (displacements, velocities and accelerations) are positive
valued to obtain algebraically consistent signs and implied directions. Such free body
diagrams are shown in Figure 6.1 b in which all the masses are assumed to be in those
states for which  > 0,  > 0 and  > 0. The directions of the forces, indicated by
the arrowheads, are consistent with the assumed states and relative motions.

Considering the sum of forces for each particle, we deduce the following equations
from the individual free body diagrams:

                1 + 2(2 - 1) + 2(2 - 1) - 11 - 11 = 11

     2 + 3(3 - 2) + 3(3 - 2) - 2(2 - 1) - 2(2 - 1) = 22 (6.1)
                         3 - 3(3 - 2) - 3(3 - 2) = 33

Now it is important to note that these equations are coupled, meaning that the variables
 and their time derivatives appear in multiple equations. If, for example, the first
equation had only 1 and its time derivatives, the second 2 and its time derivatives, and
6.1. EQUATIONS OF MOTION IN MATRIX FORM  253

Figure 6.1: Three degree of freedom system: (a) the model, (b) free-body diagrams of
the individual masses.
254 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

the third 3 and its time derivatives, then we would have three uncoupled equations
that govern the dynamics of three separate single degree of freedom systems. These
systems would be able to move independently of what the others are doing. For our
system, however, the equations are coupled in that, for example, to solve for 1 using
the first equation we need to know 2 which also appears in that equation. The motions
of the masses affect each other and their responses must be determined simultaneously.
This is the major difficulty with analyses of MDOF systems.

A more general representation is possible if we choose to write these equations in ma-
trix form. A simple rearrangement of terms leads to

1 0       00   2  + { 1 }  -2 2 + 3 -3 1 + 2 -2 0   2  + { 1 }

  0  2
0 0 3  { 3 } 0 -3 3   { 3 }

     [M]    [C]                         

             -2 2 + 3 -3 1 + 2 -2 0   2  =  2  { 1 } { 1 }
             0  -3 3   { 3 }  { 3 }

            [K]                                                 

In this representation, the accelerations are collected in the column matrix , the veloc-
ities in the column matrix , and the displacements in the column matrix , all having
dimensions of  × 1 with  being the number of degrees of freedom ( = 3 for our
current example). The matrix [M] that multiplies the accelerations  is called the mass
matrix, the matrix [C] that multiplies the velocities  is called the damping matrix, and
the matrix [K] that multiplies the displacements/deformations  is called the stiffness

matrix of the system. These are square matrices with dimensions equal to the number
of degrees of freedom of the system (i.e.,  × , with  = 3 for our example). The
column matrix  appearing on the right hand side of the equation comprises the exter-
nal forces.  also has dimensions  × 1 and, for ease of reference, it is often called the

external force vector or the load vector. With these definitions, the equations of motion

for our example may now be stated as

          [M]() + [C]() + [K]() = ()                              (6.2)

and, more importantly, the equations of motion for any linear MDOF system will be
given by this matrix expression. For different systems the sizes of matrices will differ,
the coefficients in the matrices will differ, but once the equations are written in matrix
form, they will be identical to the expression that we see in Equation 6.2. If the system
6.2. SYMMETRY OF SYSTEM MATRICES                            255

is undamped, then its equations of motion will be given by

[M]() + [K]() = ()

and if this undamped system is undergoing free vibrations, then the equations of mo-
tion will be given by

                                    [M]() + [K]() = 0

where 0 denotes a column matrix, of dimensions  × 1, whose elements are all equal to
zero. Clearly both of these equations may be derived from Equation 6.2 by enforcing
[C] = [0] and/or  = 0; [0] is the zero matrix, of dimensions  × , with all of its
elements equal to zero.

It is therefore of utmost importance to develop solution strategies that will directly deal
with the matrix form of equations so that such strategies will be applicable to all linear
MDOF systems. To solve the matrix equation of motion means to find

{ 1() }
() =  2()                                                   (6.3)
{ 3() }

for all relevant time instances . This solution must satisfy the equilibrium condition
specified by Equation 6.2 at all times and furthermore it must also satisfy the initial
conditions (0) and (0).

6.2 Symmetry of System Matrices

To introduce some additional concepts and details, let us consider as a second example
the simple rigid bar shown in Figure 6.2. In order to simplify the problem, we will as-
sume that horizontal motion of the bar is negligible. Any horizontal forces, including
those that are associated with the rotation of the bar, will remain so small that they
may be neglected. This assumption also implies that vertical motion, although not neg-
ligible, also remains relatively small such that circular arcs may be approximated by
tangent lines and angles by their tangents. With these approximations the problem is
drastically simplified but consequently, at least in principle, the analyses are limited to
immediate vicinity of the initial equilibrium configuration. Gravity is assumed to play
no role in this particular problem.

The first order of business is to determine the generalized coordinates to be employed
in the analysis. One way to think about the problem is to visualize the possible motion
256 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

                  Figure 6.2: A rigid bar constrained to move vertically.

of the bar and identify possible candidates with which this motion may be described.
As the bar is said to be rigid, this particular problem essentially boils down to choosing
variables to describe a straight line. Furthermore, since the parts of the bar is assumed
to move vertically, knowing the vertical positions of any two points on this straight
line suffices to sketch the line. The system therefore has only two degrees of freedom
in that once any two points on the bar are located at any instant, the positions of all its
other parts may be determined in relation to those two points. One could also choose
to identify the orientation of the bar through the angle it makes with the horizontal,
so that knowing the vertical translation of any point on the bar and the rotation of
the bar about that point also suffices to sketch the current spatial configuration of the
whole bar. There is therefore an infinite number of choices that we may use as our
generalized coordinates, three sets of which are shown in Figure 6.3. The sketches
shown in the figure greatly exaggerate the displacements for visual purposes and they
clearly do not conform to our stated assumptions of small amplitude motions, hence
they should be regarded with care. So which choice shall we proceed with? Some
choices may lead to simpler structures in the system matrices but it is somewhat early
to introduce these investigations and therefore we postpone relevant discussions to
after our initial analyses.

Figure 6.3: Possible choices of generalized coordinates for modeling the dynamics of
the rigid bar.
6.2. SYMMETRY OF SYSTEM MATRICES                                         257

For no particular reason, let us choose as our generalized coordinates the vertical trans-
lations of the two ends of the bar as shown in Figure 6.4 wherein the top sketch shows
the kinematic variables and the bottom figure shown the free body diagram of the bar.
Here we have to note some issues which follow from our initial assumption of small
displacements. The location of any point on the bar should in general be specified via
the coordinate , which denotes a positional variable in the deformed configuration.
Since, however, the vertical displacements are assumed to be small and the horizon-
tal displacements (and velocities and accelerations) are assumed to be comparatively
negligible, we may instead use the horizontal position variable  since by assumption
  . The vertical position (, ) of the piece of the bar located at  at time  is given
by 

                             (, ) = 1() +  (2() - 1())
and the vertical velocity of that same piece is

                             (, ) = 1() +  (2() - 1()) (6.4)

Let us first use the Newton-Euler approach to derive the governing equations of mo-
tion. To this end we have to calculate the linear and angular momenta (about the center
of mass), take their time derivatives, and equate these time derivatives to the sums of
external forces and moments, i.e.

                                     L = f, Hcm = Mcm

If the bar is homogeneous, its center of mass is located at  = /2, and the mass of an
infinitesimal segment of width d is given by (/) d. The vertical linear momentum
of this infinitesimal piece given by the product of its mass and its vertical velocity so
that when the piece is located at , its vertical linear momentum is

                          [(  ) d] [1() +  (2() - 1())]

and the vertical linear momentum of the whole bar is therefore given by

  (  ) [   1() + (2() - 1())] d =  ( 1 + 2 )2
0  

which of course is equal to the total mass of the bar times the vertical velocity of its
center of mass.1 Since the time derivative of the vertical linear momentum is equal to

    1When discussing linear and angular momenta, we could of course have directly used the particular
results pertaining to rigid bodies but instead we choose to start from fundamental principles in this
introductory example in an effort to emphasize their importance. Experienced readers may skip the
details and choose to focus on the familiar conclusions.
258 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 6.4: Vertical motion of the rigid bar and the employed generalized coordinates.

the resultant of the external forces we have, from the free body diagram in Figure 6.4,

           ( 1 + 2 2 ) = -1 - 22 - 1 + 2

which, after rearranging, may be written as
                          2 1 + 2 2 + 1 + 22 = 2 - 1 (6.5)

To derive the expression for angular momentum about the center of mass, we note that

the position of the infinitesimal segment with respect to the center of mass is given by

 - /2. Note that angular momentum is a vectorial quantity given by an expression of

the sort r × L (i.e. position times linear momentum): for the infinitesimal segment to

the right of the center of mass the position variable is positive, its velocity (and hence

its linear momentum) is positive if it is upward, and their vectorial product yields a

vector perpendicular to the plane of the bar with the sense given by the right hand rule

(i.e. positive when out of the screen or page on which you are reading this text). The

scalar component of the angular momentum for the infinitesimal piece is therefore

given by  [ - 2 ] [(  ) d] [1() +  (2() - 1())]
6.2. SYMMETRY OF SYSTEM MATRICES                                       259

and the angular momentum of the whole bar about its center of mass is

                                
 ( ) [ - ] [1() + (2() - 1())] d = (2 - 1)
0                   2                        12

which, of course, is equal to the product of the bar's moment of inertia about its center
of mass (i.e. 2/12) and its angular velocity (i.e. (2 - 1)/). As the time derivative

of this angular momentum should be equal to the resultant moment of the external

forces and moments about the center of mass, we have, based on the free body diagram

in Figure 6.4,       12 (2 - 1) = 2 1 - 22 2 - 4 1 - 

which could be rewritten as

                -  12 1 +  12 2 - 2 1 + 2 = -( 4 1 +  ) (6.6)

When the two equations derived from linear and angular momenta are written in ma-

trix form one gets

                                 2 1         2 - 1

 2 2  1
    { } + [  ] { } = { 1                                               } (6.7)
- 12 12  2                      - 2  2    - 4 -

These equations are perfectly fine in terms of representing the dynamics, but the co-
efficient matrices are not symmetric as were those of the 3-DOF model discussed pre-
viously. Symmetry is a desirable property for computational purposes and it follows
naturally if certain physical expectations (such as Betti's law of reciprocity for exam-
ple) are accounted for. One drawback about the Newton-Euler approach for MDOF
systems is that the symmetry of the coefficient matrices is not guaranteed when an ar-
bitrary set of generalized coordinates are employed. It should be mentioned that if,
for example, we were to use the vertical translation of the center of mass of the bar
and its rotation about that point as our generalized coordinates, we would end up with
symmetric coefficient matrices with the Newton-Euler approach.

The Lagrangian approach, on the other hand, ensures symmetry naturally for all

choices of generalized coordinates. To exemplify this statement, let us use the same
two coordinates 1 and 2 shown in Figure 6.4, and this time use Lagrange's equations.
The velocity of an infinitesimal segment of the bar is given by the expression in

Equation 6.4 so that the kinetic energy of the bar is:

12                           1    2  2 2
 =   d =  [1 + (2 - 1)] d = [1 + 2 + 12]
2                   02                    6
260 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

This form of the kinetic energy is representative of most systems and in the most gen-
eral case one may expect to have a kinetic energy function of the form2

 = ({}, {}, ) = 1   ({}, ) +  ({}, ) + ({}, )
                            2  

where {} denotes the set of generalized coordinates used for the system and {} de-
notes the set of generalized velocities, with the summations over all generalized coor-
dinates. The coefficients themselves may be functions of generalized coordinates and
time so that  = ({}, ),  = ({}, ), and  = ({}, ). Whenever
time does not explicitly appear in the relations the last two terms disappear and the
kinetic energy becomes a homogeneous quadratic form of the generalized velocities as

                        = ({}, {}) = 1   ({})
                                                2 

and it may be shown that the coefficients are such that  =  for all , . Fur-
thermore, when we consider small oscillations around the equilibrium configuration,
these coefficients cease to depend explicitly on generalized coordinates so that

                                ({}) = 1   
                                              2 

with  = , given by:              2

                              =                     (6.8)

In this case the kinetic energy of the system may be expressed using matrix notation as

                             1
                              =  [M]                (6.9)
                             2

where, for an n-DOF system,

11 12  1                                   1 
21 22  2                                  {{  }}
[M] =                             and  =
                                                 2
                                          
                                          {{ }}

1 2                                         

    2Subtle details regarding Lagrange's equations are too many to discuss in detail in this text. For a
thorough introduction and much more, see e.g. D.T. Greenwood, Classical Dynamics, Dover Publications,
1997.
6.2. SYMMETRY OF SYSTEM MATRICES                           261

The potential energy of the system of Figure 6.2 comprises the energy stored in the two

springs so that we have            12 1 2
                              = 1 + 22
                             2     2

The potential function may in general depend on generalized coordinates and time,

i.e. we may have to deal with a function  = ({}, ). Most often this function does

not explicitly depend on time. Moreover, when we consider small oscillations around

the equilibrium configuration, it may be shown that the potential energy has the form

                          = ({}) = 1   
                                            2 

where the coefficients do not explicitly deped on generalized coordinates, and that they

are given by                          2
                              =
                                                           (6.10)
                                       

such that  =  for all , . In this case the potential energy of the system may be
expressed using matrix notation

                              = 1  [K]                     (6.11)
                                   2

where, for an n-DOF system,

                         11 12  1                1 
              21 22  2                          {{  } 2 }
              [K] =                 and  =      
                                                {{ }}

              1 2                                 

The last step before we write Lagrange's equations is identifying the generalized forces.
Recall that the generalized forces are the coefficients in the virtual work expression
when arbitrary virtual variations of the generalized coordinates are considered. Con-
sidering the external forces 1, 2 and  shown in the free body diagram in Figure 6.4
and imposing virtual displacements 1 and 2 shown in Figure 6.5, the virtual work
done by the external forces3 as the system goes through these virtual displacements is
given by

      1 2 2 - 1 4 1 + 1 - 2   - 32 4 1 + 2 2 2 = 11 + 22

    3The spring forces have already been accounted for in the potential energy and so they are not in-
cluded in the work calculation regarding external forces.
262 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

     Figure 6.5: Virtual displacements and resulting patterns.

so that the generalized forces are identified as the coefficients of the virtual displace-
ments as

              1 = 12 2 - 14 1 + 1  , 2 = 12 2 - 34 1 - 1 

Now we are ready to derive the governing equations for our model. Lagrange's equa-
tions specify that for our 2-DOF system,

     dd (   ) -  +  =      for  = 1, 2                                      (6.12)

Substituting the energy expressions and evaluating the derivatives lead to

     3 1 + 6 2 + 1 = 12 2 - 14 1 + 1                                        (6.13)

and  6 1 + 3 2 + 22 = 12 2 - 34 1 - 1 

                                                                            (6.14)
6.3. STIFFNESS AND INERTIA INFLUENCE COEFFICIENTS                   263

which may be combined into a single matrix equation as follows:

                                 1                   1           1
                                 { 2 2 - 4 1 +   }
 3 6  1                   0 1
  {  } + [0 2] {  } =  1                             3           1  (6.15)
                                 { 2 - 1 -  }
6 3 2                    2       2                   4           

So how is it that we come up with two different equations that govern the same set of
generalized coordinates; in other words, can Equation 6.7 and Equation 6.15 both be
valid? These two sets of equations are indeed interrelated as one set is a linear com-
bination of the other (e.g. simple addition of Equation 6.12 and Equation 6.13 leads
to Equation 6.5). As we have the possibility of obtaining symmetric coefficient matri-
ces by a choice of method or coordinates in all cases, we will always assume that the
mass and the stiffness (and eventually also the damping) matrices are symmetric, and
develop solution strategies accordingly.

6.3 Stiffness and Inertia Influence Coefficients

6.3.1 Force Equilibrium

A more direct way to derive the coefficient matrices is often employed in structural
dynamics due to its algorithmic nature. This approach addresses the matrix form of
equations, given by

                                        [M] + [K] = 

as the force summation equation that it is, in the form

                          +  = 

where the components of

                          = [M]

are called the inertia forces and the components of

                          = [K]

are called the elastic forces. Note that both the inertia and the elastic forces are gen-
erated by motion. Since for small amplitude motion the coefficients in the mass and
stiffness matrices do not explicitly depend on generalized coordinates, these terms may
be thought of as independent quantities in that it may be possible to discuss them sep-
arately.
264 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Let us start with the elastic forces term. As the force equilibrium equation has to be
valid whenever the accelerations are zero too, the stiffness related term may be deter-
mined by the well-known methods of structural analysis, e.g. the direct displacement
method. In this case the force equilibrium equation would read

11 12  1  1                                  1 
     {{  }}                                 {{  }}
 = [K] =  21          22  2   2 ==          2
                                            
                              {{ }}         {{ }}

1 2                                           

where  are called the stiffness influence coefficients. Now consider a particular case
with a small displacement 1 > 0 while all other displacements are kept at zero (re-
member that accelerations were already assumed zero). In this particular case, the

external forces and moments (depending on whether the DOF is translational of ro-

tational) that have to be applied along the generalized coordinates for equilibrium of the

system have to be equal to

                   111   1 
                  {{ 21 } 1 } { = {  } 2 }
                     
                  {{      }} {{ }}
                   11    

which means we must apply a force equal to 111 along generalized coordinate 1,
211 along generalized coordinate 2, etc. If the displacement imposed on generalized
coordinate 1 is assumed to be equal to unity, then the forces are numerically given sim-

ply by the stiffness influence coefficients. This whole discussion may be extended to
any coordinate in that we could assume  = 1 while all other generalized coordinates
take on a value of zero; the forces that must be applied are then given by 1 = 1,
2 = 2 etc. Based on this pattern, the following phrasing is often used in defining
the stiffness influence coefficients: "The stiffness coefficient  is numerically equal
to the force/moment that must be applied along generalized coordinate  while the sys-
tem is in static equilibrium when the imposed displacements are such that  = 1 and
all other displacements (and accelerations and velocities) are zero.' ' Note that this is

somewhat reverse thinking: we are not trying to find the displacements that would be

observed under a specific set of external effects and so the actual set of external forces

acting on the system are irrelevant for this particular analysis; on the contrary, we are

trying to figure out what external forces/moments should be applied to impose a cer-

tain displacement pattern. Even though this may seem somewhat peculiar, it actually

provides a systematic way to evaluate the stiffness influence coefficients, one column at

a time. Consider the rigid bar example of Figure 6.2, with the generalized coordinates
6.3. STIFFNESS AND INERTIA INFLUENCE COEFFICIENTS  265

shown in Figure 6.4 selected to model our problem. By imposing the displacement
patterns

                       {1 > 0, 2 = 0} and {1 = 0, 2 > 0}

one at a time in a successive fashion, we obtain the free body diagrams shown in Fig-
ure 6.6.

Figure 6.6: Free body diagrams of the rigid bar for displacement patterns
{1 > 0, 2 = 0} and {1 = 0, 2 > 0}.

Static equilibrium demands that the forces shown in these free body diagrams be given
by

               111 = 1, 211 = 0, 222 = 22, 122 = 0
from which it could be deduced that:

                          11 = , 22 = 2, 12 = 21 = 0

A similar analysis could be employed in discussing the coefficients in the mass matrix.
To this end we need to include d'Alembert forces in our free body diagrams to discuss
`static' equilibrium, and consider what happens when some acceleration is present at
266 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

a generalized coordinate while all other generalized coordinates have zero accelera-
tions. At the same time we assume that the displacements at the generalized coordi-
nates are zero (as well as velocities, which will be important when discussing damping).
When the generalized coordinates take on values of zero, the force equilibrium equa-
tion yields

         11 12  1  1                                       1 
         21                                {{  }}         {{  } 2 }
 = [M] =          22                     2       2   = =
                
                                                          
                                              {{ }}       {{ }}
         1 2                                                

and furthermore, if  > 0 while all other  = 0 for   , the force equilibrium

demands

                   1   1 
                  {{   }} {{  }}
                      2  =                    2                                  (6.16)
                     
                  {{    }} {{ }}
                       

which means that if static equilibrium is to be satisfied under these conditions, then
forces equal to  must be applied externally along generalized coordinates . Simi-
lar to the stiffness case, we can apply such distributions successively and one at a time to
all the generalized coordinates, sketch free body diagrams including d'Alembert forces
and those forces that must be applied externally as per Equation 6.16, and use `static'
equilibrium requirements to determine the unknown coefficients.

Going back to our rigid bar, the free body diagrams including d'Alembert forces for
cases

                       {1 > 0, 2 = 0} and {1 = 0, 2 > 0}

when all other displacements (and velocities) are zero are shown in Figure 6.7.

Equilibrium demands balance of forces and balance of moments so that

         111 + 211 - 1  2  1 = 0,           111 - 2 1  3 2  1 = 0
         122 + 222 - 1  2 = 0,              222 - 2 1  2 = 0

                                2                        32

from which we deduce                     12 = 21 = 6
                          11 = 22 = 3 ,
6.3. STIFFNESS AND INERTIA INFLUENCE COEFFICIENTS  267

Figure 6.7: Free body diagrams of the rigid bar for acceleration patterns
{1 > 0, 2 = 0} and {1 = 0, 2 > 0}.
268 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

6.3.2 Equivalent Forces and Virtual Work

The approach discussed above could very well be cast into a question of equivalence
as opposed to equilibrium, and its implicit connection to the principle of virtual work
would be more directly evident. The underlying point is replacing d'Alembert forces,
elastic forces and external forces, which may in general be distributed over the whole
system, with equivalent sets of force systems applied along the generalized coordinates.
This is an approach which structural engineers are familiar with as it is the frame-
work within which displacement methods operate in structural analysis. While dis-
cussing equivalence, d'Alembert forces and elastic forces (and eventually damping re-
lated forces) should be explicitly accounted for as resisting forces in that they occur in op-
posing directions to the directions of accelerations and displacements (and velocities),
respectively. This sense of direction must be taken into consideration while setting up
the equivalent systems of forces. Consider again the rigid bar, and assume that we are
trying to calculate the coefficients in the mass matrix. The d'Alembert forces acting
on the bar and an equivalent set of forces acting along the generalized coordinates are
shown in Figure 6.8. Note that we have already determined the directions of the equiv-
alent set of forces as opposing the motion, i.e. as their direction being opposite to those
of the accelerations when 1 > 0 and 2 > 0.

Figure 6.8: Free body diagrams of the rigid bar for displacement patterns
{1 > 0, 2 = 0} and {1 = 0, 2 > 0}.

If two sets of forces are equivalent, then the work done by those two sets as the system
goes through any arbitrary virtual or real displacements should be equal.4 Considering
two arbitrary virtual displacements 1 and 2, equating the virtual work done by the

    4Two sets of forces are statically equivalent if they have the same resultants at any given point. As
such the virtual work approach is not a necessity and equilibrium conditions could also be employed.
We choose to proceed with the virtual work method in our discussions simply to present one of the
ways it could be employed in analyses of multi degree of freedom systems.
6.3. STIFFNESS AND INERTIA INFLUENCE COEFFICIENTS                   269

two sets of forces leads to

     - 1  2  1 ( 23 1) - 1  2  2 ( 13 1)
                            - 1  2  1 ( 13 2) - 1  2  2 ( 23 2)
                                 = - [111 + 122] 1 - [211 + 222] 2

Since this work expression has to be valid for all virtual displacements (for example

{1 > 0, 2 = 0} or {1 = 0, 2 > 0}) and at any instant (for example when

{1 > 0, 2 = 0} or {1 = 0, 2 > 0}), this equation will be satisfied for any arbitrary

setup if               1  2  1 23 = 11,  1  2  2 13 = 12
                       1  2 1 = 21,      1  1 2 = 22
                       2 3               2 3

from which we deduce:

                11 = 22 = 3 , 12 = 21 = 6

As equilibrium conditions and the principle of virtual work are completely equivalent
procedures, it is no surprise that the coefficients obtained via both methods are iden-
tical. The virtual work approach, if executed for elastic forces and their equivalent
system of nodal forces, may be shown easily to yield

                11 = , 22 = 2, 12 = 21 = 0

There is yet the issue of the load vector. Whether one uses the equilibrium or the vir-

tual work methods, the most commonly employed approach in determining the load

vector is that of virtual work with which the external forces are to be accounted for

with an equivalent set of loads applied along the generalized coordinates. This is also

the approach that we used in Lagrange's equations. Consider, for example, our rigid

bar for which the external forces and the equivalent loads are shown in Figure 6.9. Un-

der any arbitrary set of virtual displacements {1, 2}, the virtual work done by the

load vector is         {1 2} { 1  } =   2

where () denotes transpose of the matrix (), with

                         { 1 }
                                 2
270 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 6.9: External forces and equivalent loads.

This work has to be equal to the virtual work done by all the external loads as the system
goes through the same virtual displacements so that for our bar,

       1 2 2 - 1 4 1 + 1 - 2   - 32 4 1 + 2 2 2 = 11 + 22

and for this equality to hold for arbitrary virtual displacements the equivalent forces
should be

                1 = 12 2 - 14 1 + 1  , 2 = 12 2 - 34 1 - 1 

which are of course identical to the generalized forces that were derived before.

6.4 Coordinate Transformations

Choosing a set of generalized coordinates to work with is not a problem that has a
unique answer; there may be many viable choices that one may work with in any par-
ticular problem. We have already glimpsed into this issue while discussing possible
choices of generalized coordinates for a 2-D rigid bar with some candidates shown in
Figure 6.3. An important question therefore arises: if the equations of motion for a sys-
tem is derived using a particular choice of generalized coordinates, does one have to
start from scratch to derive the equations for some other set of coordinates or is there
a way to directly transform the equations from one coordinate set to the other.

We must first note that if there are multiple sets of generalized coordinates that may
completely describe the motion of a particular system, then there necessarily must be
some transformation equations that relate these coordinates to each other. Consider
as an example the 2-D rigid bar and two sets of generalized coordinates shown in Fig-
ure 6.10 that we may use to model its dynamics. For distinction we have denoted the
two sets of coordinates as

1                               1
 = { } and  = {  }
2                               2
6.4. COORDINATE TRANSFORMATIONS                                    271

Figure 6.10: Two different sets of generalized coordinates that may be used to model
the same 2-D rigid bar.

These two sets of coordinates are obviously geometrically related. With small rotations,

we have

                          1  =      -  2 ,  2   =      +  2

                                 1                  1

or in matrix notation

                       1     1 -                             
                { }=[
                                             1
                                       ] {  }   = [T]
                       2     1  2

where [T] is called the transformation matrix. Such a transformation matrix will exist
between any two sets of admissible generalized coordinates that may be used to model
a particular linear system.

Now assume that if we write the equations of motion in the  coordinates they are
given by

                                  [M]() + [K]() = ()

whereas if we were to write the governing equations in the  coordinates they would

by given by               [M]() + [K]() = ()

Given [M], [K] and , can we determine what [M], [K] and  should be? If both sets
of coordinates may be used to represent the complete dynamics of the system, then any
invariant quantity should have the same value in both coordinate systems. Kinetic and
potential energies are such invariant quantities since they are scalars and their values
are independent of the particular choice of coordinates used to mathematically express
the relevant physical displacements and velocities. The kinetic and potential energies
are given by Equation 6.9 and Equation 6.11, i.e. by

             1            1                            1     1   
          =  [M] =  [M ] and  =  [K] =  [K ]
             2            2                            2     2
272 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

but since  = [T], we also have

     1                 1                                1        1          
 =  [M] =  [T] [M][T] and  =  [K] =  [T] [K][T]
     2                 2                                2        2

and so it must be true that

                          [M] = [T] [M][T], [K] = [T] [K][T]

As for external excitations, we may proceed by the fact that as the system goes through
any arbitrary displacement pattern, the work done by both sets of load vectors should
be the same. This should be so because both sets are by definition equivalent to the
general distribution of external excitations applied on the system, and therefore they
are equivalent to each other as well. Consider a virtual displacement pattern given by
 = [T]. The work done by the two sets of load vectors are

                              =   =  

and since  = [T], it must be true that

                            =  [T]   [T]  = 

So this is how we should proceed when transforming the governing equations of mo-

tion from one set of coordinates to the other: Given the equations of motion in say 

coordinates as

                             [M]() + [K]() = ()                             (6.17)

and the relation between  and  given by

                                            = [T]                           (6.18)

the first step is to substitute Equation 6.18 into Equation 6.17 to obtain

                                           +  [K][T]()  =    ()             (6.19)

                            [M][T] ()

after which we complete the transformation by premultiplying Equation 6.19 with [T]
to obtain

[T]                 +  [T]  [K][T]()  =    [T]    ()         [M]() + [K]() = ()

     [M][T] ()

                                                                            (6.20)

This final step that takes us from Equation 6.19 to Equation 6.20 is crucial and it can

not be left out.
6.4. COORDINATE TRANSFORMATIONS                                                                 273

EXAMPLE 6 .1

Consider the 2-DOF rigid bar we previously worked on. The sketches of the bar with

two sets of possible generalized coordinates are shown in Figure 6.11. Coordinates 1
and 2 denote the vertical displacements of the two ends of the bar and the mass and

stiffness matrices and the load vector in these coordinates were shown to be:

                                                            2 1  
                       6  , [K] = [0                       { -+ }
          [M]  =    3  3                            0  ],  = 2 4 
                  
                                                 2          2 31  
                  6                                        {- -}
                                                           2 4 

     Figure 6.11: Rigid bar with two possible sets of generalized coordinates.

Assume we want to figure out the equations of motion for the same system written us-

ing  the  generalized  coordinates      and      ,  which  respectively  denote  the  vertical  trans-

                                     1        2

lation of the bar's center of mass and the bar's rotation about the same point. Since the

bar is homogeneous and uniform its center of mass is located at its midpoint; therefore
 and  are related through

                                                                         
                                                           1 - 2  
          1 = 1 - 2, 2 = 1 + 2   =     = [T]                                            

                       2 2 1 2 

Using the transformation given by Equation 6.20, the matrices we are seeking are cal-
culated as:

          [M]     [T] [M][T]            1    1              1 -                  2 0 ]
               =              =     [          ]    [  3   6 ] [ 2] = [
                                                           3 1 2 0                12
                                       -2
                                             26
274 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

[K]     [T] [M][T]         1     1] [  02] [11  -    3     
     =               =  [        20             2 ] = [ 
                                                           22]
                           -2
                                                2    2    3
                                                            4

     [T]         1      1      2 - 1 +               2 - 1
  =        =  [         ]{      2   4           }={         }
                               2   31                1
                 -2              2- 4 -              - 4 -
                        2

That these indeed are the matrices we desired to find may be easily verified via any of
the direct methods discussed in previous sections.

6.5 Rigid Floor Plate Model

A model that is frequently used in structural dynamics and that has a higher level of
complexity compared with the 2-DOF bar is that of a rigid flat plate (the floor) sup-
ported by massless columns. Such a system is shown in Figure 6.12. The axial rigidity
of columns is significantly greater than their flexural rigidity so that neglecting the out-
of-plane displacements of the floor plate is often quite acceptable. The movements of
the floor plate then comprise two translations in its plane and a rotation about the axis
perpendicular to the plane. The mass of the columns is generally quite small compared
to that of the plate and here we choose to neglect that mass in our model. In this sim-
ple model we also neglect the torsional resistance of the columns so that the columns
become analogous to massless translational springs.

This problem has one more dimension than the rigid bar discussed in the previous sec-
tions and this dimensional increase imposes additional complexities. We first need to
understand the geometry of deformation and how it relates to the degrees of freedom.
To set up our problem we will choose the two displacements of the centroid of the floor
plate, the directions of which are parallel to the two sides of the plate, and the rotation
of the plate in its own plane about its centroid, as our generalized coordinates. Con-
sider small amplitude motion so that arcs may still be approximated by tangent lines
and angles by their tangents so that the two translations 1 and 2 are always assumed
in the directions  and  shown in Figure 6.12, independent of rotation 3. The cen-
troid of the plate is designated by cm because for this particular case of homogeneous
plate with constant thickness, this point actually coincides with the center of mass.

Given this set of generalized coordinates, the next order of business is to determine
how the deformations in the columns are related to the generalized coordinates. We
will assume that the floor plate is rigid enough, so that both ends of the columns may be
6.5. RIGID FLOOR PLATE MODEL  275

Figure 6.12: Rigid plate (floor) supported by columns, plan view with generalized co-
ordinates and equivalent springs.
276 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

considered fixed and that end rotations of the columns are constrained. The deforma-

tion of each column is then determined by the relative translation of its two ends. We

know from structural analysis that when two ends of a linear elastic and homogeneous

bar are fixed, and the bar is subjected to bending about a principal centroidal axis of its
cross section as a result of which one end of the bar translates by an amount of  relative
to its other end, then the shear forces that develop at both ends of the bar are given by5

      12
 = 3  = 

        

where  is modulus of elasticity,  is the second moment of the cross sectional area
about the axis of bending, and  is the span of the bar (in our case, height of the col-

umn). Essentially the interaction of the column with the plate is equivalent (since we

ignore the bending moments at the bar ends because they do not contribute to force

or moment summations along our generalized coordinates) to a translational spring
with stiffness  = 12/3. Remember from structural analysis that a cross section

will have two principal centroidal axes that are orthogonal to each other. Let's say that
the ith column's centroid  is located at some coordinates (, ) measured from
the centroid of the plate (see Figure 6.12). We will denote the cross section's princi-
pal centroidal axes as  and . These local axes, defined separately for each column,
may in general not coincide with the global axes  and  , defined once for the whole
system. We will assume that the angle between local axis  and global axis  is given
by ; since the axes come in orthogonal pairs, knowing  is sufficient to define the
complete relative orientation of the axes. Given this setup, we need two springs, one for

each principal direction, to represent the cumulative resistance of a column to bending

deformations, with stiffnesses given by

 = 3 12 ,    = 3 12
                      

where it should be noted that a translation along  requires bending of the bar about
axis  and vice versa (hence the subscripts for the second moments of area). All quan-
tities tagged with the index  are supposed to signify their values specific to the ith

column.

So how does a variation in a generalized coordinate affect the deformation in a column?
To inspect the geometry, consider the sketch given in Figure 6.13. The sketch considers
an arbitrary column with centroid  located at (, ) measured relative to the center

    5Different boundary conditions will of course yield different stiffnesses; we use the case of a fixed-
fixed bar simply to exemplify the process.
6.5. RIGID FLOOR PLATE MODEL  277

Figure 6.13: Relations between the generalized coordinates for the floor plate and the
displacements they impose at the center of a column.
278 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

of mass of the plate on which the generalized coordinates are defined. It is possible
to analyze the system sequentially by imposing a nonzero value for one generalized
coordinate at a time while keeping the others locked at zero. For example, when there
is only 1 > 0 with 2 = 0 and 3 = 0, the two translations of  along the columns
principal centroidal axes  and  are given by

                                 1 cos  and - 1 sin 

respectively, while for 2 > 0 with 1 = 0, 3 = 0 one has

                                   2 sin  and 2 cos 

The translations  goes through along  and  due to a rotation 3 > 0 of the plate
about cm with 1 = 0, 2 = 0 are given by

                                      -3 and 3

so that when these are projected along  and  as in the previous two cases, the trans-
lations of  along  and  are found to be

             -3 cos  + 3 sin  and 3 sin  + 3 cos 

When all three generalized coordinates are active, the two displacements of  along
local axes  and  will be given by a superposition of the contributions detailed above
so that  will move along  by an amount  given by

                 = 1 cos  + 2 sin  + 3(- cos  +  sin )
while the movement along  will be of the amount  given by

                 = -1 sin  + 2 cos  + 3( sin  +  cos )

Having figured out the displacements and knowing the column stiffness, we are ready
to calculate the resisting forces. Again consider a single column. If the equivalent
spring stiffnesses along the column's local (principal centroidal) axes are given by 
and , the resisting forces along the local axes are

       =  = 1 cos  + 2 sin  + 3(- cos  +  sin )

and
       =  = -1 sin  + 2 cos  + 3( sin  +  cos )
6.5. RIGID FLOOR PLATE MODEL                                                               279

as shown for a single column in Figure Figure 6.14. The forces along local coordinates

are  equivalent  to  the  forces      and      along  global  coordinates  and  given  by

                                             

                                                      
                                   =  cos  -  sin 

and                                                   

                                   =  sin  +  cos 

     Figure 6.14: Elastic restoring forces along local axes and global axes.

The recurrent terms in transformations between forces and coordinates are indeed in-

terconnected as you might have suspected. It might be more revealing to write these re-
lations in matrix form. The differentials d and d are related to d and d through
a simple rotation and their relation may be written in matrix form as

                          { d } = [ cos  sin  ] { d }
                          d                - sin  cos  d

as one may show starting with the infinitesimal displacement vector written in both
coordinate systems. A concise and more general way to write this expression would be
the form

                                          d = [Ti]d

where d is the column matrix comprising the differential increments along the global
axes, d is the column matrix comprising the differential increments along the local
axes of the ith column, and [Ti] is the transformation matrix that relates the two. This
280 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

is the well-known transformation for vector components under orthogonal rotations.
The inverse transformation is given by

         d = [Ti]-1d  { d d } = [cos  - sin  sin  ] { d }  cos  d

where ()-1 denotes inverse of the matrix (). It is important to note that [Ti] is an

orthogonal matrix, i.e.
                                         [Ti]-1 = [Ti]

so that

                             [Ti]d = d, d = [Ti] d

These transformations hold for all vector components. The displacement of the ith
column's centroid may be expressed in local coordinates with components  and ,
                                                            
or  in  global  coordinates  with  components          and       .  The  two  sets  of  components
                                                               

related through

                             cos  sin                                                   

                                                     
          {  }=[                               ] {  }   = [Ti]
                  - sin  cos  

where  and  denote displacement components along the local (L) and global (G)
coordinates. Similarly, elastic forces in local and global coordinates are related through

                             cos  sin                                                   

                                                    
          {  }=[                               ] {  }    = [Ti] 
                             - sin  cos  

with local and global components implied again by the subscripts. Note that our choice
of generalized coordinates are such that

                             =     1  -  3,            = 2 + , 3

                                                     

for all columns, i.e. for all i, which yields

                                               1            -       } 3

                                
                  {  }={ }+{
                                               2            

so that the displacements at the centroid of the ith column in local coordinates are given
by

                  cos  sin                                          1               -

                                            
    {  }=[                            ] {  } = [Ti] { } + [Ti] {                          } 3
                  - sin  cos                                        2                   
6.5. RIGID FLOOR PLATE MODEL                                                          281

Recall that the resisting elastic forces in local coordinates were given by
                                  = ,  = 

which in matrix form may be written as

                   0                                     L
              {  }=[             ] {  }    = [Ki ]
                           0  

where [KLi ] is called the member stiffness matrix in local coordinates. If we think in terms
of the global coordinates or, as in our case, the generalized coordinates for the whole

system, we have

                           L     L         1    L          -                 } 3
            = [Ti]  = [Ki ] = [Ki ][Ti] { } + [Ki ][Ti] {
                                           2               

so that,

                       L         1         L           -
              = [Ti] [Ki ][Ti] { } + [Ti] [Ki ][Ti] {      } 3
                                 2                     

which, after the components of [T] and [KLi ] are explicitly accounted for, leads to

              2            2                           
 = ( cos  +  sin )1 + cos  sin ( -  )2

              + [-( cos2  +  sin2 ) +  cos  sin ( - )] 3

                                        2     2
 = cos  sin ( -  )1 + ( sin  +  cos )2

              + [- cos  sin ( - ) + ( sin2  +  cos2 )] 3

To derive the system stiffness matrix, let us try to use the equilibrium approach that we
discussed in Section 6.3.1. Considering first the case with {1 = 1, 2 = 0, 3 = 0},
the forces shown in Figure 6.15 will be in equilibrium when

          11 × 1 =                      =   cos2  +  sin2 
                        1=1,2=0,3=0 

          21  ×  1  =                   =  cos  sin ( - )

                           
                        1=1,2=0,3=0 
282 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 6.15: Elastic restoring forces and balancing external forces for the case {1 =
1, 2 = 0, 3 = 0}.

and

      31 × 1 = ( - )1=1,2=0,3=0

                               

                =  [ cos  sin ( - ) - ( cos2  +  sin2 )]

                               

We can proceed similarly to investigate the cases of {1 = 0, 2 = 1, 3 = 0} and
{1 = 0, 2 = 0, 3 = 1}, depicted in Figure 6.16. To simplify the visuals in these
figures, only the generic ith column is identified. For the first case of {1 = 0, 2 =
1, 3 = 0}, equilibrium considerations lead to

12 × 1 =             =  cos  sin ( - )
              1=0,2=1,3=0 

22  ×  1  =          =   sin2  +  cos2 

                 
              1=0,2=1,3=0 
6.5. RIGID FLOOR PLATE MODEL                                                  283

and

      32 × 1 = ( - )1=0,2=1,3=0

                               

                =  [( sin2  +  cos2 ) -  cos  sin ( - )]

                               

Finally, for the case of {1 = 0, 2 = 0, 3 = 1} we have:

     13 × 1 =  1=0,2=0,3=1

                             

               =  [-( cos2  +  sin2 ) +  cos  sin ( - )]

                             

     23 × 1 =   1=0,2=0,3=1

                          

               =  [- cos  sin ( - ) + ( sin2  +  cos2 )]

                          

and

33 × 1 = ( - )1=0,2=0,3=1

                     

<!  -  -  =    [(2  sin2    +  2   cos2  )  +  (2  cos2    +  2   sin2  )  -  2           cos    sin  (  -  )]

                                                                

             

-- > =  [( sin  -  cos )2 + ( cos  +  sin )2]

             

We now have the complete stiffness matrix of the system with

                                     11 12 13
                            [K] = 21 22 23

                                   31 32 33

where the coefficients  are to be calculated using the equations derived above. The
stiffness matrix is symmetric so that  = .

There are two types of coupling that occur through the stiffness matrix. One is the cou-
pling between the translational degrees of freedom, and the other between the transla-
tional and rotational degrees of freedom. It is worthwhile to see under which circum-
stances these coupling terms would disappear. Let us first consider the case when the
284 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 6.16: Elastic restoring forces and balancing external forces for the cases {1 =
0, 2 = 1, 3 = 0} and {1 = 0, 2 = 0, 3 = 1}.
6.5. RIGID FLOOR PLATE MODEL               285

principal directions of column sections are aligned with the translational degrees of
freedom. In the formulations above, this overlap could be taken to mean  = 0 with-
out loss of generality for all columns. When such is the case, the cross terms between
the translational terms 1 and 2 are zero:

       12 = 21 =  cos 0 sin 0( - ) = 0

                                

Let us continue with this setup to make the point. Note that even though the transla-

tional degrees are uncoupled, it is not necessarily true that the coupling between the
translational and rotational degrees of freedom is also removed, i.e. 13 = 31 and
23 = 32 are not necessarily zero. When  = 0, however, these terms are given by

13 = 31 =  [-( cos2 0 +  sin2 0) +  cos 0 sin 0( - )] = -  

                                           

and

23 = 32 =  [- cos 0 sin 0( - ) + ( sin2 0 +  cos2 0)] =  

                                         

Recall that  and  are the coordinates for the center of the ith column. It is therefore
not guaranteed by any means that we should be so lucky and the point of origin we have

defined is such that the summations on the right hand side turn out to be zero. On the
other hand, there will always be some point such that when  and  are measured
from that point, we will have

     13 = 31 = -   = 0, 23 = 32 =   = 0

                              

The special point for which this condition holds is called the center of stiffness: more
particularly, the center of stiffness  is that point for which the translational and ro-
tational degrees of freedom are uncoupled when the translational and rotational coor-
dinates are defined with respect to that point. The identification of this point becomes
more tedious when the principal directions of the column stiffnesses are not aligned
with the directions of the translational coordinates, i.e. when not all  are equal to zero,
but it is still possible and the definition is in fact applicable to all cases. We'll include
this case in an example to provide the details.

We had previously defined the center of mass in the introductory sections. The im-
portant point to add in the current context is the distribution of the d'Alembert forces.
When the rigid body is planar, as is our floor plate, the d'Alembert forces may be shown
286 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

to be equivalent to a single force, coplanar with the plane of the body, and a moment
perpendicular to that plane such that each force and moment component is a function
of only one acceleration component. With the generalized coordinates we have cho-
sen to work with, the resultants of the d'Alembert forces at the center of mass would
be those shown in Figure 6.17, where  is the total mass of the plate and  is its mass
moment of inertia about the axis perpendicular to its plane at the center of mass.

Figure 6.17: Resultants of d'Alembert forces at the center of mass of the plate.

To derive the mass matrix, we may proceed with the equilibrium approach as we did
in the case of the stiffness matrix. To find the coefficients in the three columns of
the mass matrix, we sequentially investigate the following cases shown in Figure 6.18:
{1 = 1, 2 = 0, 3 = 0}, {1 = 0, 2 = 1, 3 = 0} and {1 = 0, 2 = 0, 3 = 1}.

For each individual case, force equilibrium requires:

11 = ,                                  21 = 0,  31 = 0
12 = 0,                                22 = ,    32 = 0
13 = 0,                                23 = 0,   33 = 

The mass matrix is therefore given by

                                       00
                                                 0
[M]      =                               0  

                                        0 0 
6.5. RIGID FLOOR PLATE MODEL  287

Figure 6.18: d'Alembert forces and balancing external forces for the cases {1 =
1, 2 = 0, 3 = 0}, {1 = 0, 2 = 1, 3 = 0} and {1 = 0, 2 = 0, 3 = 1}.
288 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

which is diagonal, with translational and rotational motions uncoupled. This will be
true whenever the center of mass is employed, as was the case for the stiffness matrix
if the center of stiffness were to be used.

Now a trivial but necessary note: consider the simple system shown in Figure 6.19.
The floor plate is supported by two identical columns located symmetrically about the
 axis, with stiffnesses 1 = 2 = , 1 = 2 = . The principal directions of the
column sections are along the generalized coordinates. With  = 0 for both columns
and the two columns located symmetrically so that 2 =  = -1, the general
formulas we derived for  yield

     11 = 2, 22 = 2, 33 = 22

and                                                 23 = 32 = 0
                   12 = 21 = 0, 13 = 31 = 0,

so that the mass and the stiffness matrices become

        00                 2                        00    
               0 , [K]                                    
[M]  =    0             =    0                      2  0

         0 0               0                        0 22

           Figure 6.19: Three independent single degree of freedom systems.

What we have here is a system that has three degrees of freedom but the motion along
those degrees of freedom are uncoupled so that if the system were to be set in motion
6.6. SHEAR BUILDING  289

along one, it would continue along that direction alone, with no motion incurred along
other degrees of freedom. This is actually not a three degree of freedom system in the
context of structural dynamics but rather three independent single degree of freedom
systems. This complete uncoupling is the basis for the model we will consider in the
next section.

6.6 Shear Building

When inertial and deformational coupling are negligible, as was the case for the per-
fectly symmetrical plan of the previous section or for cases when such coupling is small
so as to be of no significant consequence if ignored, a simple chain-like model could be
used for dynamic analyses of multi-story structures. Such a model, represented in the
sketch of Figure 6.20, comprises rigid floors at which all the relevant masses are col-
lected, and columns that represent the lateral story stiffnesses, stacked on top of each
other.

To set the terminology straight: the ith floor has mass , it covers the ith story which
has a cumulative lateral story stiffness , the ith floor's displacement relative to the
ground is (), and that floor is acted upon by an external lateral force (). There
are a total of  floors. Vertical deformations are assumed negligible so that only lateral
motion is pertinent. As there is no inertial or deformational coupling present, the lat-
eral motion of the floors along one direction does not lead to motion in the orthogonal
direction or in-plane rotations. This of course is a highly idealized simple model and
various objections quickly make themselves available: The mass distribution is most
probably not concentrated at the floor levels as there are columns and walls along the
vertical height of each story, external forces that are assumed to act at floor levels are
most likely distributed over certain areas such as wind induced loads, complete uncou-
pling is highly improbable and there are certain actions induced in other directions, so
on and so forth. Even as such, this simple chain model has proven itself time and again
capable of providing great insight into how multi story structures behave dynamically
and their use is allowed even in structural codes, subject to certain limitations.

The equations of motion for the shear building model may easily be derived by investi-
gating the lateral forces that act on each floor at any given instant. A free body diagram,
including d'Alembert forces, of some typical ith floor is shown in Figure 6.21. Static
equilibrium requires

         () + +1(+1() - ()) - (() - -1()) - () = 0
290 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
                             Figure 6.20: Shear building model.
6.6. SHEAR BUILDING                                                             291

which may be rearranged to obtain

() - -1() + ( + +1)() - +1+1() = ()

This equation is valid for all floors, i.e. for  = 1, 2, ... , , with -1 = 0 when  = 1
and +1 = 0 for  = .6

  Figure 6.21: Free body diagram of the ith floor in the shear building model.

6Brief reminder: the symbol = is to be understood as defined to be equal to.
292 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

The whole set of equations for all  floors may be written in matrix form as

1 0 0  0 0  1                  
 0 2 0  0            {         }
                  0    {    2  }
                     {         }
 0 0 3  0 0  3                 +
                               }
                         {     }
 0 0 0  -1 0  { -1             }
                         {     
 0 0 0  0   
                                    
    1 + 2    -2       0     0         0  1   1 
   -2      2 + 3                      0 {  } {  }
                    -3      0            { 2 }                                  { 2}
  0          -3   3 + 4        -1 +   0 { 3 }                                =  { }
                          -4       -
  0                                                                                       3
  0            0                            
                         --1            {                                    }{         }
               0            0         - { -1 } { -1 }
                                        {                                    }{         }
                                             

which, you may realize, has the same form as the chain model of Section 6.1. The mass
matrix in a shear building model will always be diagonal and the stiffness matrix will
always be tridiagonal. These constructive properties of the system matrices provide
significant computational efficiency, which may be of great significance as the number
of degrees of freedom increases to large values.

6.7 Models for Base Excited Systems

Accounting for base excitation in MDOF systems is similar to its treatment in SDOF
systems. In essence, when some or all of the supports/foundations of an MDOF sys-
tem move, the references for rigid body motion and deformational motion have to be
properly accounted for, and relevant forces must be consistently developed. To demon-
strate some possible models, let us start with the simple shear building model that we
discussed just above, subjected to unidirectional ground translation as shown in Fig-
ure 6.22.

There are two components that contribute to the total displacement () of the ith
floor: the part due to rigid body translation of the structure with the induced ground
motion, indicated here by (), and the part due the movement of the floor relative to
the rigid body configuration, symbolized by (). As in the single degree of freedom
model, the deformations in the stories are governed by the relative displacements ()
whereas d'Alembert forces are governed by the absolute (total) accelerations (). The
free body diagram of the ith floor, including d'Alembert forces, would be like the one
6.7. MODELS FOR BASE EXCITED SYSTEMS  293

Figure 6.22: Shear building model subjected to unidirectional ground translation.
294 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

shown in Figure 6.23. Equilibrium requires

+1(+1() - ()) - (() - -1()) - () = 0

and, noting that

                         () = () + ()

the whole set of equations for all  floors may be written in matrix form as

1 0 0  0 0  1 +  
 0 2 0  0                   {               }
                         0    {    2 +      }
 0 0 3  0                0  { 3 +  } +
                            
                                {           }
 0 0 0  -1 0  { -1 +  }
                                {           }
 0 0 0  0    +  

  1 + 2             -2       0     0               0  1   0 
 -2               2 + 3                            0 {  } { 0 }
                           -3      0                  { 2 }                     {}
0                   -3   3 + 4                     0 { 3 }                   =  {0}
                                 -4         -1 + 
0                                              -         
0                     0                              {                       }{}
                                --1                - { -1 } { 0 }
                      0            0                 {                       }{}
                                                         0 

The task almost always is to evaluate the response of a structure subjected to a particu-
lar base motion so that the equations are often expressed with the ground motion term
on the right hand side as

                          ()                1
{ [M]() + [K]() = -[M] { () }} { = -[M] { 1 }} () = -[M]1()
                                                                             (6.21)
                         {{ }}              {{ }}
                          ()                1

where 1 is a column matrix of dimension  with all its elements equal to one. The
similarity of this equation with that of the single degree of freedom model is quite
evident, with scalar system parameters in the SDOF model becoming matrices in the
MDOF model.

There is a trivial alternative to how the equation of motion may be stated if we were to
choose to work with the absolute motion variables. Starting with

                         [M]() + [K]() = 0
6.7. MODELS FOR BASE EXCITED SYSTEMS  295

Figure 6.23: Free body diagram of the ith floor in the shear building model subjected
to unidirectional ground translation.
296 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

and substituting () = () - 1(), one gets, after reordering,

[M]() + [K]() = [K]1()

and due to the structure of the stiffness matrix in the shear building model, the right
hand side of the equation may be shown to yield:

                           1                                 (6.22)
                          {0}
                          {}
[M]() + [K]() =  0  ()
                          {}
                          {}
                          0

As with the SDOF model, the choice of equations to use depends on the particular appli-
cation, but often the form of Equation 6.21 is preferred since calculating deformations
directly is generally the most pressing concern for analysts. On the other hand, espe-
cially when dealing with multi-support excitations under which it mat not be trivial
to define the moving reference frame, it may be preferable to cast the formulations in
terms of absolute motion parameters.

Next let us consider a different scenario, albeit one that is not very common, to present
a slightly different formulation. Assume that the ground motion is not translational but
rotational, with rotations relatively small so that arcs may be approximated by tangents.
The rigid body displacements that would occur in the system due to the ground motion
would then be as shown in Figure 6.24: if the ith floor is located at a height of  from
the ground, then it would translate laterally by an amount of () due to rigid body
motion that would occur under a ground rotation of amount (). Such a motion that
would occur at each floor would cause no deformation in the system. On top of this we
include the possibility of relative motion, relative to this rigid body state, at each floor
given by (), so that the total displacement of the ith floor is given by

() = () + ()

Note that the stiffness matrix is all about deformations so that there is no change in
it with regards to the previous model. The mass matrix similarly remains unaltered.
What changes is how the input affects the system. The equations of motion again are

                                    [M]() + [K]() = 0
6.7. MODELS FOR BASE EXCITED SYSTEMS                                      297

Figure 6.24: Shear building model subjected to uniaxial ground rotation.
298 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

but now we have

                                          1 
                       { () = () + {  } 2 } () = () + ()

                                         
                                         {{ }}
                                           

where height vector  = {1 2  } is a column matrix that has floor levels
(measured from the ground) as its elements (compare with the column matrix of ones
in the translation case). The equation of motion of a shear building model subjected to
uniaxial ground rotation may therefore be written as:

                              [M]() + [K]() = -[M]()

It is of course relatively straightforward to extend this model to include both a unidi-
rectional ground translation and a uniaxial ground rotation. Assume that the ground
translation is given by 1() and rotation by 2(), as shown in Figure 6.25.

When both ground motions are present, the absolute and relative displacements are
related through

    () = () + 11() + 2() = () + [1 ] { 1()  } = () + [b]() 2()

where [b] is a matrix that maps the relationship between inputs and generalized coor-
dinates. We will call it the input influence matrix when it maps more than one input, and
input influence vector (to be denoted ) if it is a single column mapping only one input.
The determination of the input influence matrix for the support excitation/ground mo-
tion problem is, as we have seen, a geometric problem in which one tries to determine
the rigid body displacements that would occur at the locations and along the directions
of the generalized coordinates. With this inauguration, the equation of motion for base
excited structures may be more generally expressed as7

                              [M]() + [K]() = -[M][b]()

Would this formulation hold for, say, the three dimensional rigid plate model? Con-
sider the motion of the previously investigated rigid floor plate moving in its plane
under translational and rotational base motion as shown in Figure 6.26.

    7Implicit assumption here being that the input influence matrix is time invariant, i.e. it remains un-
altered as the system moves, so that taking time derivatives to obtain accelerations is trivial.
6.7. MODELS FOR BASE EXCITED SYSTEMS  299

Figure 6.25: Shear building model subjected simultaneously to unidirectional ground
translation and uniaxial ground rotation.
300 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
  Figure 6.26: In-plane rigid body motion of the floor plate due to ground motion.
6.7. MODELS FOR BASE EXCITED SYSTEMS                      301

We assume that the ground moves like a rigid block so that there are three components
to ground motion: translational motion given by 1() and 2(), and rotational mo-
tion 3(). (Although we should note that such rotational motion is generally negligible,
and its inclusion here is more for demonstration purposes.) The floor plate may itself
move relative to the ground, with this relative motion defined by 1(), 2() and 3()
as before (once again we use the center of mass as our reference point, and remind that

the mass matrix is diagonal in that case). This relative motion is what may cause defor-
mation in the system so that the restoring forces are given by [K]. The accelerations

and the related d'Alembert forces, on the other hand, are proportional to the absolute

accelerations so that the equations of motion will be given by

                             { 1 + 1 }
                         [M]  2 + 2  + [K] = 0

                             { 3 + 3 }

which may be written as

[M]() + [K]() = -[M] 0 1 0 1 0 0 2() = -[M][b]() { 1() }
                         0  0  1 {    3()       }
                                                

with [b] = [I].

Before closing this section, a disclaimer may be in order. When deriving the equations
of motion one does feel a sense of unease when rotations are present. If the motion
amplitudes are large, rotational motion does indeed bring about increasing levels of
complexities. The sketches that we use to demonstrate how systems move are, for ease
of visual identifiability, almost always extreme in that the marked displacements and
deformations are inadmissibly large. So these sketches should be taken with a grain
of salt. The motion amplitudes which we aim to investigate herein are limited to the
immediate vicinity of initial equilibrium such that in all cases arcs may be approximated
by tangent lines unless otherwise explicitly stated. Direct superposition of the rigid
body motion and the deformational motion in the case of the floor plate is justified
only with this constraint in mind.
302 CHAPTER 6. MODELS FOR LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
Chapter 7

Free Vibrations of Multi Degree of
Freedom Systems

7.1 Harmonic Motion and the Eigenvalue Problem

Solving the coupled equations of motion of an MDOF system is not a trivial issue. If
one wants to find how each generalized coordinate evolves in time, one has to find
 many time functions in an -DOF system that will somehow satisfy the coupled
equations at all times. Most often this task will have to be dealt with numerically, if
it can be dealt with at all. Numerical results, however, tend to be not so conducive in
helping us develop physical insights, which we do need in order to be able to judge the
validity of any analysis.

So we may ask: is there any insight or experience that we have gained from analyses
of SDOF systems that may help us get started with MDOF systems. One predominant
characteristic of an SDOF system was its unique period (or frequency) with which it
oscillated if it were perturbed form its original equilibrium configuration. Would an
MDOF system do the same, and, what does this exactly mean? By the period of the
MDOF system we shall understand the period, if it exists, with which the whole system
repeats its motion in that during free vibrations all generalized coordinates execute har-
monic motions with the same period. Since there are multiple degrees of freedom, the
motions along each may have different amplitudes, but all motion should bear the same
period. Consider the three masses hung along the same rope as shown in Figure 7.1.
We may intuitively feel that if we were to pull this pendulum to some initial angle and
let go, the masses would move in harmony, swinging back and forth while keeping

                                                303
304 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

their initial relative appearance so that if we were to take consecutive snapshots, the
pendulum would look pretty much as it did at the first instant albeit at smaller angles,
somewhat like the sketch in Figure 7.1 (a). We may also feel that after such an initial per-
turbance the snapshots depicted in Figure 7.1 (b) are probably unlikely, that the masses
are unlikely to do as they please and swing any way they want at any speed they want.

    Figure 7.1: Pendulum with three masses.

We can't quit at intuition of course and so the question is whether or not such harmonic
motion is mathematically possible. For the whole system to move with the same fre-
quency but different amplitudes along the generalized coordinates, the equations of
motion should admit a solution that may be expressed as

 1()   1 
{ () = { 2() }} { = { 2 }} cos ( - ) =  cos ( - ) (7.1)
   
{{  }} {{ }}
 ()    

where  is the time independent amplitude at the jth generalized coordinate,  is the
frequency with which the whole system moves, and  is some possible lag. Note that

the way the system looks as it moves is governed by  or, more precisely, the ratios of
7.1. HARMONIC MOTION AND THE EIGENVALUE PROBLEM  305

 to each other. As we assume these amplitudes to be time invariant, the relative shape
of deformation is constant by assumption, with instantaneous positions communally reg-

ulated by the time dependent cosine component.

Admissibility of such a motion depends on whether the equation of motion for free

vibrations, given by

                      [M]() + [K]() = 0          (7.2)

may be satisfied by this solution. The damping matrix is conspicuously missing of
course, but we will come back to that in a little while. To see whether or not the so-
lution works we plug the proposed expression Equation 7.1 into Equation 7.2 to get

 -2[M] cos ( - ) + [K] cos ( - ) = ([K] - 2[M])  cos ( - ) = 0
                                                                                               (7.3)

If such a solution is to exist, Equation 7.3 should be satisfied at all times. Obviously
the cosine term can take on nonzero values, and so there are only two possibilities. It
could be that   0, which means that the system is not moving at all! Equilibrium is
naturally satisfied in that case (remember that initially the system is at an equilibrium
state) but this is not the option we are seeking; this is called the trivial solution. The
nontrivial solution is the possibility of

                      ([K] - 2[M])  = 0

which means that, for a nonzero , the matrix ([K] - 2[M]) is (to borrow from linear
algebra) rank deficient, i.e. its determinant is zero and its inverse does not exist; for if
it did, then the only possibility would be  = ([K] - 2[M])-1 0 = 0.

What does this mean? Well, we were seeking for the possibility of harmonic motion
and it turns out that: yes, it is possible, but only for those values of  which make

                      [K] - 2[M] = 0             (7.4)

where |[A]| denotes the determinant of matrix [A]. For an -DOF system, [M] and [K]
are  ×  matrices, and the characteristic equation of Equation 7.4 is of order  in 2.
The characteristic equation, therefore, has  roots, meaning there are  values of 

which may make the determinant zero. From a more physical perspective: an MDOF

system has multiple frequencies, as many as the number of degrees of freedom, with

which it may execute harmonic motion.

In linear algebra, this problem is usually cast as the generalized eigenvalue problem: find

all 2 and  for which

                      2[M] = [K]                 (7.5)
306 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

is satisfied. When matrix dimensions are very small, it may be possible to solve this
problem by hand. After a while it becomes tedious and outright impossible to pro-
ceed by hand and so the eigenvalue problems are almost always solved numerically.1
In the structural dynamics jargon, the eigenvalues of Equation 7.5, or rather their pos-
itive square roots the 's, are called the natural frequencies or modal frequencies, and its
eigenvectors the 's are called the mode shapes of the system. This terminology is well
established and we will adhere to it.

To give a flavor of what this all means, let us work on the two-story shear building
shown in Figure 7.2. It is relatively easy to show that the mass and stiffness matrices
for this simple model are given by

[M] = [1 0 ] ,  [K] = [1 + 2 -2]
           0 2             -2 2

                            Figure 7.2: Two story shear building.

Let us simplify the algebra by considering a particular case with 1 = 2 = ,
1 = 2 and 2 = . The eigenvalue problem becomes

                           ([ 3 - -  ] - 2 [ 0 0 ])  = 0 (7.6)

    1The more commonly encountered version is the eigenvalue problem expressed as  = [A]. Eigen-
value problems are so common and important in mathematical physics that there are extremely efficient
and well-established algorithms available in computing platforms. We therefore will not delve into how
this problem is solved numerically.
7.1. HARMONIC MOTION AND THE EIGENVALUE PROBLEM                               307

with the characteristic equation given by

     [K] - 2[M] = [3 - 2                          -       ] = 2(2)2 - 42 + 22 = 0

                                                       2
                            -  -  

                                                                              (7.7)

which yields the following two roots via the well-known quadratic formula:

                         2                                2    
                         1 = (2 - 2) ,                    2 = (2 + 2)
                                                                       

By convention, when numbering the multiple frequencies of a system, they are num-
bered in increasing order so that

                                   1  2  ...  -1  

This convention is almost always adhered to, with the lowest frequency 1 generally
referred to as the fundamental frequency of the system; the corresponding period 1 =
2/1, which happens to be the longest period of the system, is analogously called the
fundamental period. Experience has shown that in most cases the largest amplitudes of
motion occur in relation to this fundamental period, and therefore its proper estima-
tion is of prime importance.

So what kind of a deformed shape does the system take on while moving with any of
these frequencies; in other words, what are the corresponding 's? We have to go back
to Equation 7.7 and try to figure out the  that accompanies the particular frequency
. For our system we have two frequencies and two such mode shapes. We will denote
the related mode shapes by 1 and 2, and their components as

                            1 = { 11  } , 21 2 = { 12  } 22

where we take  to mean the jth component of the ith mode shape. In short,  is the

relative amplitude at generalized coordinate j while the system moves in mode i. For

2    ,  the  eigenvalue  equation  is  given  by

  1

                                                                         -  ] { 11 } = 0
        3 -              2 0                      3 - (2 - 2)
([           ] - 1 [               ]) 1 = [
     -                   0                                -     - (2 - 2) 21

which seemingly yields two equations as                                 
                                                          11 - (1 - 2)21 = 0

                  (1 + 2)11 - 21 = 0,
308 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

but these two equations are in fact one and the same:

                     21 = 2.41411

How do we determine two unknowns with one equation? We can't. Mathematically
this result is to be expected since, for the eigenvalue problem to work out,  must lie in
the null space of the rank deficient coefficient matrix ([K] - 2[M]); consequently, if
some  satisfies ([K]-2[M]) = 0, then so does  where  is an arbitrary multiplier.
Does this make sense physically? Think about it this way: What we have determined
is the relative shape the system maintains as it moves with a certain frequency, but the
absolute amplitude of motion should depend on the initial conditions (e.g. how large
is the initial perturbation?). We have not considered such information yet and it will
have to wait until we discuss the initiation of motion. Until then, we have to be satisfied
with only the relative ratios of what will occur along the generalized coordinates. We
may therefore choose to represent the relative amplitudes according to any particular
scaling at this point. We may, for example, assign a magnitude of one to a particular
generalized coordinate; say we assign 11 = 1, in which case we have

                                       1 = { 1 2.414 }

Alternatively we may adjust the values of the coefficients so that the mode shape has
unit magnitude, i.e. 1 1 = 1, in which case we would have

                     1 = { 0.383 0.924 }

Both of these choices are fine in that the actual response that we will observe as the
system oscillates with the fundamental frequency will be given by

                     () = 11 cos (1 - 1)

where, depending on the particular scaling we choose, the coefficient 1 may take on
different values, but at the end all choices will yield the same ().

There is also a second frequency with which harmonic motion is possible. The mode

shape corresponding to 2 is prescribed by

    3 -  2 0                                           -  ] { 12 } = 0
                               3 - (2 + 2)
([       ] - 2 [     ]) 2 = [
  -               0                        -            - (2 + 2) 22
7.1. HARMONIC MOTION AND THE EIGENVALUE PROBLEM                                   309

Figure 7.3: Mode shapes of the two story shear building.

which yields the following relationship:

22 = -0.41412

If we again assign a unit amplitude to the first generalized coordinate, we have

2 = { 1 -0.414 }

Finally as there are two possibilities of harmonic motion, the general solution is the
superposition the two, giving as the final answer the following expression for our ex-
ample of the two story shear building:

() = 11 cos (1 - 1) + 22 cos (2 - 2)                                              (7.8)

Before we move on, it is worthwhile to visualize the mode shapes for such a structure,
schematically sketched in Figure 7.3. In the fundamental mode, the relative movements
of the masses are such that the building sways to one side as a whole. The second mode,
on the other hand, comprises movement of masses in opposite directions, with one sign
change or one cross-over. We'll see in numerous cases that such modal motions are
typical of many similar systems, with number of crossovers increasing with increasing
mode numbers and the fundamental mode comprising a unidirectional movement.
310 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

7.2 Orthogonality of Modes

A property known as orthogonality of the mode shapes leads to a very well-known and
extremely useful analyses tool for MDOF systems. To demonstrate this property, let
us assume we have an n-DOF system with symmetric [M] and [K], with frequencies 
and mode shapes  for  = 1, 2, ... , . For ease of proof let us further consider the
case with no repeated roots so that    for   ; in structural dynamics this
is almost always the case except when there is perfect symmetry so that the structure
has identical periods in two directions but even in such cases the following conclusions
will hold.

For such a system, the eigenvalue problem for two different modes, modes  and , will
be given by the following equations:

                                           [K] = 2[M]                                         (7.9)

                                       [K] = 2[M]                                             (7.10)
If we pre-multiply Equation 7.9 by  and Equation 7.10 by  , we obtain:

                                                      2
                                    [K] =   [M]                                               (7.11)

                                                      2
                                    [K] =   [M]                                               (7.12)

Since the mass and stiffness matrices are symmetric, the transpose of Equation 7.12

yields                                                                  2

                ( [K]) =  [K]  =  [K] =   [M]                                                 (7.13)

so that the difference of Equation 7.11 and Equation 7.13 leads to:

                                   0  =    (2  -    2        [M]                              (7.14)

                                                   )

The equality in Equation 7.14 demands that either (2 - 2) = 0 or  [M] = 0;

but  if  there  are  no  repeated  roots,  2   -  2     0  and  so  it  must  be  true  that

                                                    

                                            [M] = 0                                           (7.15)

whenever   . This condition also implies by the eigenvalue equation that                      (7.16)
                                   [K] = 0 for   .
7.2. ORTHOGONALITY OF MODES                                       311

When  = , on the other hand, these products may yield nonzero values. Let us denote

those values by     [M] = ,  [K] = 

                                                                  (7.17)

where  is called the modal mass and  the modal stiffness for the i-th mode. The
orthogonality conditions are generally expressed more concisely via the Kronecker-
 defined as

                                        = {1  = 
                                                 0 

so that modal orthogonality may be simply written as follows:

                    [M] = ,  [K] =                                (7.18)

It is important to note that these relations imply a formulation to calculate the frequen-
cies. Considering the eigenvalue equation for the i-th mode and premultiplying it with
 we have

                   2         2  [K] 
                  [K] =   [M]   =                              =  (7.19)
                              [M] 

The particular values of the modal masses and stiffnesses will naturally depend on the
particular scaling chosen for the mode shapes. Consider for example the two story
shear building of Figure 7.2 discussed previously, with the mass and stiffness matrices
given by

                           [M] = [ 0 0 ] , [K] = [ 3 - -  ]

One option that was considered was to scale the mode shapes so that the amplitude
corresponding to the first generalized coordinate was of unit magnitude, leading to

                   1 = { 1 2.414 } , 2 = { 1 -0.414 }

With these mode shapes, Equation 7.18 yields                      1 [M]2 = 0
   1 = 1 [M]1 = 6.83, 2 = 2 [M]2 = 1.17,

and
          1 = 1 [K]1 = 4, 2 = 2 [K]2 = 4, 1 [K]2 = 0
312 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

One way to check the algebra is to make sure that the modal masses and stiffness lead
to the calculated frequencies:

           1               2          2            2
                        = 0.586 = 1,     = 3.41 = 2
           1                          2  

An alternative scaling for the first mode shape was also considered subject to 1 1 =
1 in which case the mode shapes were given by

           1 = { 0.383 0.924 } , 2 = { 1 -0.414 }

so that with these mode shapes, the orthogonality conditions would in this case yield
      1 = 1 [M]1 = , 2 = 2 [M]2 = 1.17, 1 [M]2 = 0

and
       1 = 1 [K]1 = 0.586, 2 = 2 [K]2 = 4, 1 [K]2 = 0

and once again we have

           1               2          2            2
                        = 0.586 = 1,     = 3.41 = 2
           1                          2  

as we should. If the mode shapes are scaled so that the modal masses are equal to 1, then

the mode shapes are said to be mass normalized. Recall that scaling of a mode shape is

essentially multiplying it with a non-zero scalar. If  is the arbitrarily scaled mode

shape for the -th mode, the mass normalized mode shape  for that mode is related

to  through  =  where  is some scalar. To find out what it should be, we can

use the condition that mass normalized mode shapes should lead to unit modal masses,

so that                                               1

                        2             2
          [M] = 1 =   [M] =     =                        (7.20)
                                                      

Our aim is to introduce the terminology of mass normalized mode shapes and to show
how they can be constructed. From now on we will refrain from introducing a special
symbol for mass normalized mode shapes in an effort to curb symbolic overcrowding
and simply state, if necessary, whether a particular mode shape is mass normalized.
Finally, we should note that the eigenvalue problem may be collectively stated for all
7.2. ORTHOGONALITY OF MODES                                                  313

the modes with a relatively simple matrix notation. Collecting the eigenvalue equation
for each mode in consecutive columns we get

             [[K]1 [K]2  [K]] = [[M]112 [K]222  [K]2 ]

which may also be written as

                                               2            0  0        0

                                                 1
                                             0           2              0
                                                               0           
                                                           2

[K] [1 2  ] = [M] [1 2  ]       
                                             0              0     2     0

                                                                    -1
                                              0 0 0  2 

Defining the mode shape matrix (or the modal matrix as it is referred to in linear algebra)
 as

                                      = [1 2  ]

and the diagonal spectral matrix 2 as

                                2    0    0              0

                                  1
                              0      2                   0
  2                                       0                 
                                       2

   =      
                              0      0       2           0

                                               -1
                               0 0  0 2 

the eigenvalue problem may be collectively expressed as                      (7.21)
                                        [K] = [M]2

Furthermore, the orthogonality conditions may now be expressed as

  1 0 0  0                                                          1 0 0  0 
 0 2 0  0                                                          0 2 0  0 
 [M] =        = [M] ,                                     [K] =        = [K]
                                                                                             
                                                                             
 0 0  -1 0                                                         0 0  -1 0 
 0 0 0                                                             0 0 0  

where the diagonal matrices [M] and [K] are called the modal mass matrix and the
modal stiffness matrix, respectively.
314 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

7.3 Coordinate Transformations and the Eigenvalue
      Problem

Do coordinate transformations affect frequencies and mode shapes? The answer is
probably relatively easy to reason: frequencies characterize how fast the harmonic mo-
tions of the whole system take place and therefore they should not depend on which
coordinates are used to describe the motion; mode shapes, on the other hand, depict
what the system looks like so that different coordinates may require different coeffi-
cients to specify the shape of the system. How shall we approach this issue mathemat-
ically? Consider two sets of generalized coordinates,  and , both of which may be
used to define the dynamics of a system. Assume these two coordinate sets are related
through

                                             = [T]

with the eigenvalue problem in  coordinates given by:

                                     ([K] - 2[M]) = 0

Remembering that [A][B][C] = [A][B][C], we note that the characteristic equa-
tion

                                       [K] - 2[M] = 0

will have the same roots as

                          [T]- [T] ([K] - 2[M])[T][T]-1 = 0

since [T][T]-1 = [T]- [T] = [I] where [I] is the identity matrix (the determinant
of which is equal to 1) and [T]- is the inverse of [T] . Proceeding with this line of
inquiry, we have

  [T]- ([T] [K][T] - 2[T] [M][T])[T]-1 = [T]- ([K] - 2[M])[T]-1 = 0

which implies                                          (7.22)
    [T]- ([K] - 2[M])[T]-1 = 0  ([K] - 2[M])[T]-1 = 0

since [T]-  [0]. Noting that the eigenvalue problem in the transformed coordinates

would be given by,  ([K] - ()2[M]) = 0

                                                       (7.23)
7.4. MODAL ANALYSIS OF FREE VIBRATIONS      315

we conclude, by comparing Equation 7.22 and Equation 7.23, that

                                           ()2 = 2

and hence the eigenvalues are unique; i.e., the values of the frequencies of a system
are independent of the generalized coordinates employed in writing the equations of
motion. It also follows by comparison that

                                           = [T]-1

so that in general the mode shapes in the transformed coordinates will be different than
those in the original coordinate as we had foreseen.

7.4 Modal Analysis of Free Vibrations

As in the SDOF case, free vibrations in the context of MDOF systems refers to motion
that takes place due to some initial perturbation from the system's original equilibrium
configuration, with no other external disturbance present. Let's first consider an un-
damped system subjected to a set of initial displacements and velocities at time  = 0:

       [M]() + [K]() = 0, {(0) = , (0) = }

where         1             1 
             {{  }}        {{  }}
        = 2 ,         = 2
                           
             {{ }}         {{ }}
                             

are the generalized coordinate and generalized velocity vectors (column matrices), re-
spectively, at time  = 0; we will refer to these two collectively as the initial conditions
for the MDOF system. Since this matrix equation is a coupled set of equations, com-
ing up with solutions simultaneously for all generalized coordinates directly is not an
easy feat and in most cases simply not feasible. One way to approach this problem is to
inquire if there is any way we can decouple the  equations of motion describing our
system. Let's imagine an alternative set of coordinates,

                  1()
                2() 
       () =  
               
                ()
316 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

such that if the equations were to be written in these coordinates, the mass and stiffness
matrices would all become perfectly diagonal. In that case, the first equation would
only involve terms with 1 and 1, the second equation with 2 and 2, and so forth.
If this were possible, one would essentially have -many uncoupled single degree of
freedom systems, each of which would execute simple harmonic motions due to their
initial conditions. We have implicitly solved this problem when we derived the eigen-
value problem. Recall that we had asked if it were possible for an MDOF system to
execute simple harmonic motion, and the answer we got was that the system had cer-
tain frequencies and mode shapes with which it indeed could execute such motion.
Furthermore we also showed that these mode shapes were orthogonal in that

                             [M] = [M] ,  [K] = [K]

where [M] and [K] were diagonal matrices! If we recall the coordinate transformation
rules given by Equation 6.20, we may guess where this discussion is going. Let us define
a set of coordinates () such that

       () = ()

The equations of motion when transformed to these coordinates would yield
 [M]() +  [K]() = [M] () + [K] () = 0, {(0) = , (0) = }

where         1             1 
             {{  }}        {{  }}
        = 2 ,         = 2 ,
                           
             {{ }}         {{ }}
                             

are the initial conditions in the  coordinates. These will have to be calculated via the
initial conditions in the  coordinates: since the two sets of coordinates are related
through the same transformation at all times, we have

        =    = -1

and
                                  =    = -1

Calculating the initial conditions via matrix inversion is costly, especially if the dimen-
sions are large; furthermore, it may be that we are interested in only a handful of co-
ordinates  (for reasons that will be soon discussed), for which evaluating the whole
7.4. MODAL ANALYSIS OF FREE VIBRATIONS                        317

set by inverting the mode shape matrix is too inefficient. Instead we may proceed as
follows: the orthogonality of the mode shapes lead to

    [M] =  [M]
                = {  [M]1  [M]2   [M]   [M] } 
                = { 0 0    0 } 

    [M] = 

so that                 [M]
                 = 
                                                              (7.24)

and similarly,          [M]
                 = 
                                                              (7.25)

Both these equations may be collectively written for all modal coordinates via matrix

notation as      = [M]-1  [M],  = [M]-1  [M]

                                                              (7.26)

This looks like a lot of work compared to a one-step matrix inversion but we must
remember that with increasing dimensions, matrix multiplication becomes much less
costly compared to matrix inversions (since the modal mass matrix is diagonal, its in-
version is trivial). Keeping in mind that the mass matrix is frequently diagonal, the
approach summarized above, which also allows for picking specific subsets, turns out
to be quite an efficient way to calculate the initial conditions in the transformed coor-
dinates.

In any case, this is the brief summary of what happened so far: we aim to solve for the
free vibration response of an MDOF system, governed by

                [M]() + [K]() = 0 ; {(0) = , (0) = }          (7.27)

and we attempt the solution via the transformation

                () = ()                                       (7.28)

with the governing equations in the new coordinates given by  (7.29)
                  [M] () + [K] () = 0 ; {(0) = , (0) = }
318 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

It may be better to introduce some terminology to reduce the burden of keeping track
of which coordinates are which. When we initially write the equations of motion, the
generalized coordinates that we employ almost always have a physical correspondence;
for example, a generalized coordinate may be the displacement of a particular point or
a rotation of a rigid body about a particular axis. Therefore we will call the initial set of
generalized coordinates  that we use to derive the governing equations of motion the
physical coordinates. In contrast, the transformation of Equation 7.28 relates these phys-
ical coordinates to a set of coordinates that have no direct physical correspondence; the
 coordinates are essentially a set of abstract variables which help us uncouple the ini-
tial set of equations. We will refer to this set of coordinates which are related to the
physical coordinates via the mode shape matrix the modal coordinates.

We already discussed that the mass and stiffness matrices in the modal coordinates are
diagonal by virtue of mode shape orthogonality conditions. The set of equations of
Equation 7.29 are therefore  uncoupled equations, each of the form:

                 () + () = 0 ; {(0) = , (0) = }

So by transforming to modal coordinates, we have converted our -DOF system to 

uncoupled SDOF systems! The good news is that we have solved the SDOF problem

before: the free vibration response of an undamped SDOF system is given by Equa-
tion 2.11 or equivalently by Equation 2.14, which may be written for the -th modal

coordinate as

               () =  cos () +   sin (  ) =  cos ( - )  (7.30)

where

        =   ,           2       tan  = (/) / /
                 
                   2
                    =  + ( ) ,                         (7.31)
                      

We are not done yet. What we want is the response of the system in physical coordi-
nates, i.e. the solution to the original set of equations of Equation 7.27. Hence we must
transform back to the physical coordinates via

 () = () = 11() + 22() +  + ()
       = 11 cos (1 - 1) + 22 cos (2 - 2) +  +  cos ( - )
                                                                                             (7.32)

and we should note that the solution in Equation 7.32 is essentially the same (except for
the number of modes involved) as the one we obtained at first when we were seeking
the possibility of harmonic motion, i.e. Equation 7.8.
7.4. MODAL ANALYSIS OF FREE VIBRATIONS                                    319

The expansion                                

               () = () =  ()

                                            =1

is generally referred to as the modal expansion. This equation provides a particular in-
terpretation of the response as being the superposition of some variables which are
in some sense independent, this said independence being related to the orthogonality
of the mode shapes. Consider, for example, what would happen if the system were to
be set in motion via an initial displacement pattern that looked like one of the mode
shapes, say the th mode shape; i.e. consider the following initial conditions:

                = ,  = 0

where  is a non-zero real number. The initial conditions in modal coordinates are

then given by

                       [M]  [M]
                =  =  = 

since  [M] =  due to the orthogonality conditions. The initial velocities in
modal coordinates, i.e. , are zero since all initial velocities in physical coordinates are
zero. Therefore, when the initial displacements are a scaled version of the th mode
shape, the only non-zero response comes from the th modal coordinate, and it is given

by

                                      () =  cos ()

with all other ()  0 for   . The response of the system is then given by

                             

               () =  () =  cos ()

                            =1

This result is important and it is worthwhile to state it again in plain language: if an
MDOF system is set in motion by an initial perturbation that coincides with one of
the mode shapes of the system, then the system will oscillate with only the frequency
of that particular mode to which that mode shape belongs. No other mode will con-
tribute to the response. It is yet speculative but somewhat foreseeable that if an initial
displacement pattern does not fully comply with a particular mode shape but mostly
resembles it, than the biggest contribution to the response may be expected to come
from that particular mode, with smaller but possibly non-zero contributions from the
others. This pattern we shall demonstrate through some examples.
320 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

           Figure 7.4: Two DOF system subject to free-vibration.

EXAMPLE 7 .1

Consider a 2-DOF system with masses and spring constants defined as shown in Fig-
ure 7.4. We would like to calculate its free vibration response to initial conditions

              (0) = { /2  } =  { 1/21 } , (0) = { 00 }

We first have to derive the governing equations of motion. Say we use the Lagrangian
approach to construct the mass and stiffness matrices. The kinetic and potential ener-
gies are given by

                 1 21 2                      1 21                  2
            = 21 + 2,         = 21 + (2 - 1)
               2  2                          2         2

so that, by Equation 6.8 and Equation 6.10,

     11 =  2   = 2, 22 =     2               = , 12 =     2        = 0 = 21

           11                22                           12

and

     11 =  2      = 3, 22 =  2               = , 12 =     2        = - = 21

           11                22                        12

The equations governing the free vibration are therefore given by

           [2 0 ] { 1 } + [ 3 -] { 1 } = { 0 }
              0  2           -  2                            0

Next, we find the eigenvalues by solving the characteristic equation that is obtained
from [K] - 2[M] = 0. The characteristic equation is given by

[ 3 - -  ] - 2 [2 0 0 ] = (3-22)(-2)-2 = 2(2)2-52+22 = 0
7.4. MODAL ANALYSIS OF FREE VIBRATIONS                                     321

or equivalently by      (2)2 - 5 2 + (  2 ) = 0

                                     2          

and therefore the squares of the frequencies are calculated as

                         2 1                2 = 22  
                        1 = ,
                                                    
                               2

The mode shapes are computed by plugging back each eigenvalue into the equation
one at a time and solving for the corresponding eigenvector. For the first one we have

                 [[ 3 -] - 1  [2 0 ]] { 11 } = { 0 }
                    -        2 0                  21            0

leading to:

                                     21 = 211

If per choice we set 11 = 1, we get

                                     1 = { 12 }

Similarly for the second mode shape we have

                 [[ 3 -] - 2  [2 0 ]] { 12 } = { 0 }
                    -        0                    22            0

so that

                                     22 = -12

and with 12 = 1 we get       2 = { 1-1 }

The modal masses with these mode shapes are given by

         [M] =  [M] = [      1 2 2 0 1 1                        6 0
                                        ][      ][    ]=[               ]
                             1 -1 0  2 -1                       0 3

and the modal stiffnesses are given by

                             1 2 3 - 1 1                        3 0
             [K] =  [K] = [             ][       ][   ]=[               ]
                             1 -1 -  2 -1                          0 6
322 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

whence we can check                     2 2               
                            2 1 1       2 = = 2
                                        2 
                          1 = = ,
                                  1 2 

If instead we would like to work with mass normalized mode shapes, those we can
obtain by scaling the mode shapes above according to Equation 7.20 so that

              1 = 16 { 12 } , 2 = 13 { 1-1 }

and the modal mass and stiffness matrices in this case would be given by

                 [M] = [1 0 0 1] ,                     1    0 ]
                                                          2
                                        [K] = [ 2 
                                                   0

Since there is no particular advantage to use mass normalized mode shapes for this
system, we will proceed with our original set of mode shapes.

To solve for the response in modal coordinates, we must find the initial conditions in
those coordinates. By Equation 7.24 and Equation 7.25 we have,

         1 = 1 1 [M] = 1 {1 2} [2 0 ] { /2 } = 
              1  6                      0                                 2

and
                                  2 = 0, 1 = 2 = 0

which the reader may easily verify. This result should, of course, be expected as per our
discussion preceding this example: the initial condition shape coincides with the first
mode in that  = (/2)1, and therefore it sets in motion only the corresponding
first mode and does not induce any motion in the other mode. The amplitudes and the
phase angles in modal coordinates are calculated via Equation 7.31 to obtain

                 1 = 2 , 1 = arctan 01 = 0, 2 = 0

so that          1() = 2 cos (1) , 2()  0

The response in physical coordinates is then given by

() = { 1() } =  1/2  11()+22() =  { } cos (1) = { 2 cos (1) }1
         2()                                                               cos (1)
7.4. MODAL ANALYSIS OF FREE VIBRATIONS                           323

Figure 7.5: Free vibration response for the system shown in Figure 7.4, subject to initial
conditions  = {/2 } ,  = 0. The plots show time histories with respect
to normalized time  = /1.

The response of the two masses are shown Figure 7.5, plotted against dimensionless
time  = /1 = (1)/(2). Due to the given initial conditions both masses move
in phase, but the displacement of the first mass is half of that of the second mass.

What if the system was subjected to some other initial conditions? Consider first what

would happen if the initial displacement pattern didn't exactly match one of the modes

but was given by
                                  = { 2/3  } ,  = 0

Note that the initial displacement pattern still resembles the first mode more than the
second one. In this case the initial conditions in modal coordinates will be given by

1 = 16 {1  2} [2 0 ] { 2/3 } = 5
2 = 13 {1  0                                9

           - 1} [2 0 ] { 2/3 } = 1
           0                                   9

and 1 = 2 = 0. The modal amplitudes and phase angles will be
         1 = 59 , 1 = arctan 01 = 0, 2 = 19 , 2 = arctan 01 = 0
324 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

with the modal responses given by

             1() = 59  cos (1) , 2() = 19  cos (2)

leading to the following displacement time histories for the two masses:

() = {  1()  } = 11() + 22() = { 1059  cos (1) + 19  cos (2)              }
                                                                1
        2()                        9  cos (1) - 9  cos (2)

In terms of normalized time  = /1 = (1)/(2), the responses are given by

        {    1( )  } = { 10        59  cos (2 ) + 19  cos (4 )  }
                                     1
             2( )                  9  cos (2 ) - 9  cos (4 )

wherein we have incorporated the information that for our system, 2 = 21. These
displacement time histories plotted against normalized time  are shown in Figure 7.6.

It is noteworthy that even though there is no exact match between the initial displace-

ment pattern and the first mode, they are relatively similar and therefore most of the

physical response is contributed by the first mode.

Figure 7.6: Free vibration response for the system shown in Figure 7.4, subject to initial
conditions  = {2/3 } ,  = 0. The plots show time histories with respect
to normalized time  = /1.
7.5. APPROXIMATIONS FOR FREQUENCIES                                       325

Finally, consider what would happen if the system were now given a set of initial veloc-
ities, so that the initial conditions are given by

                     = 0,  = { - } =  { 1-1 }

In this case the initial conditions in modal coordinates are calculated to be 1 = 2 =
0,

               1 = 16 {1                  2} [2 0 0 ] { 1-1 }  = 0
               2 = 13 {1                  - 1} [2 0 0 ] { 1-1 }  = 

so that modal amplitudes and phase angles obtained via Equation 7.31 are

               1 = 0, 2 =  ,2 2 = arctan 10 = 2

leading to

            1()  0, 2() =  cos ( 2 2 - 2 ) =  sin ( 2 2)

As the initial velocity distribution coincides with the second mode shape (i.e. since  =
0 and  = 2), only the second mode gets excited and the first mode does not get

excited at all. Accordingly, the displacements of the two masses will be given by

               1()                        2 sin (2)
            {       } =  11() +22() = {                              }
               2()                        - 2 sin (2)

                                       0

the plots of which are shown in Figure 7.7. In this case the two masses start to move
in opposite directions with the initial velocities imposed on them and oscillate with
frequency 2, with no contribution form the first mode.

7.5 Approximations for Frequencies

7.5.1 Rayleigh's Quotient

Consider a particular mode of an MDOF system, with mode shape  and frequency
. We have already seen that the following equation holds exactly true for undamped
326 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

Figure 7.7: Free vibration response for the system shown in Figure 7.4, subject to initial
conditions  = 0,  = { - } . The plots show time histories with respect to
normalized time  = /1, with 2 = 1/2.

systems:

              2   [K]                                                             (7.33)
              = = 

                      [M]

Note that this ratio is also a statement about the equality of maximum kinetic and po-
tential energies that the system attains as it oscillates harmonically in the -th mode.
When the system oscillates as such, the generalized displacements and velocities are
given by

          () =  cos ( - ) , () = - sin ( - )

so that the kinetic energy and potential energy at any instant are calculated as

          1  1 22          2
           =  [M] =    [M] sin ( - )
          2  2
          1  12 
           =  [M] =   [K] cos ( - )2

          2  2

The energies will reach their respective maximum values when the sine and cosine
terms are equal to unity; note also that whenever the kinetic energy is at a maximum
7.5. APPROXIMATIONS FOR FREQUENCIES                                      327

the potential energy is zero and vice versa. The maximum values are therefore given by

                   1 22                        12 
         max =    [M],               max =   [K]

                   2                           2

and if there is no energy feed or loss, conservation of energy requires

         1 22                        12 
         max = max     [M] =   [K]
         2                           2

so that

          2  [K]
          = 

                 [M]

Now assume we do not exactly know the mode shape but maybe we have an estimate
of what it may look like. This is not so unexpected, especially as an analyst gains experi-
ence over different models. Even at an introductory stage we may feel, for example, that
if there was a beam with a few heavy masses attached to it, or a tall building that could
be approximated by a shear building model, their fundamental mode shapes would look
reasonably like those shown in Figure 7.8. Yes, we probably will not know the exact
mode shape, but a decent estimate may be possible; and yes, all this is somewhat vague.

Figure 7.8: Some deformation shapes estimates: a beam carrying heavy masses and a
tall shear building.

Assume that our estimate for the mode shape is denoted by  and it is called the shape
vector. We may at least require for consistency that were the system to oscillate harmon-
ically with such a shape, the conservation of energy should still hold. If the frequency
328 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

of oscillation is denoted by , going through a similar set of steps, we find that con-
servation of energy requires:

                       2  [K]                      (7.34)
                   ( ()) = 

                                   [M]

This ratio is called Rayleigh's Quotient. At this point we hope that the similarity of Equa-
tion 7.34 to Equation 7.33 is sufficient to claim that if  is similar to , then  will
provide an acceptable estimate for . The resemblance of the expressions to those dis-
cussed in Section 2.5 in the context of generalized single degree of freedom systems is

not coincidental: the generalized SDOF approach is essentially the broader version of

Rayleigh's approach. Rayleigh's Quotient generally works well and it is used in numer-

ical methods to iteratively refine eigenvector estimates to solve an eigenvalue problem.

Let us try to further investigate what it is that we are investigating. The mode shapes

of an n-DOF system provide a set of bases in the n-dimensional space due to the
orthogonality relations. For some set of coefficients  (for  = 1, 2, ... , ), we may
express the shape column  as

                                               

 = 1[K]1 + 2[K]2 +  + [K] =  [K] =  2[M]

                              =1               =1

where the last equality follows from the eigenvalue problem, i.e. [K] = 2[M].
The coefficients  are unique and may be evaluated as

                      
  =  ( [K]) =   =  = 2

               =1     =1

where  [K] =  and  [M] =  are the orthogonality relations we
had previously shown. With these expansions, we have

                          

 [K] = ( [K]) [K] ( [K])

               =1         =1

                                           
               =    =  2  =  2 2

               =1 =1      =1               =1

and similarly                            

                    [M] =  2 

                                       =1
7.5. APPROXIMATIONS FOR FREQUENCIES                             329

so that Rayleigh's Quotient may be expressed as

                   ()2 =  [K] = =1 2 2
                    [M]               2

                                         =1  

As   1 for all , if we express Rayleigh's Quotient as

                          2                       2
                                                 2 
                          1 =1  2 
                   ()2 =            1

                             
                          =1 2 

we can argue that            2

                          2        
                   =1        2     

                                1
                       2 1
                     
                     =1

since (/1)  1 for all . Therefore we may conclude that for any arbitrary (non-
zero of course) shape vector ,

                   (())2                         2

                                                   1

so that Rayleigh's Quotient always provides an upper bound to the lowest frequency.
Going through a similar argument we may also show that it will provide a lower bound
to the highest frequency.

7.5.2 Rayleigh-Ritz Method

An extension of Rayleigh's Quotient is achieved by considering more than one shape
factor and thereby introducing more flexibility in achieving optimality. Consider using
in Rayleigh's Quotient a shape vector that is composed of  different candidates, i.e.,

                    = 11 + 22 +  +  = [U]

where                                                  1 
                                                 {  = {  } 2 }
                   [U] = [1 2  ] ,
                                                      
                                                      {{ }}
                                                        

We may think of this approach as an attempt to approximate multiple modes simul-
taneously where we pick candidate shapes  and try to adjust the coefficients  to
330 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

somehow get the best possible result. For a given set of , the value of Rayleigh's Quo-
tient will depend on 's since

                      2  [K]  [U] [K][U]  [K]
                  ( ) =              =                  = 
                          [M]  [U] [M][U]  [M ]

where

                  [K] = [U] [K][U] and [M] = [U] [M][U]

are both symmetric and of dimensions  × . As Rayleigh's Quotient provides an upper

bound for the lowest frequency, it should make sense that we ought to seek values of 

which will make Rayleigh's Quotient a minimum for the given set of candidate shapes

so that we have the best possible estimate. In other words, we shall seek those values

of    =      for  which

           

                         ()2  = 0    for  = 1, 2, ... 
                            =

This condition may be expressed in matrix form as

                                     ()2  = 0
                                        =

and when we use matrix differentiation rules we obtain

                      [M] = 2[M],     [K] = 2[K]
                                         

so that

         ()2                      2       [M]
                         =           [[K] -             [M]] = 0
              =  [M]                      [M]

Since by definition                      2  [K]
                                     ( ) =  

                                                 [M ]

the condition that must be satisfied by  to yield the minimum value of Rayleigh's
Quotient may be expressed as:

                         ([K] - ()2[M])  = 0                      (7.35)
7.5. APPROXIMATIONS FOR FREQUENCIES                             331

Well, this is an eigenvalue problem, reminiscent of our original eigenvalue problem;

but we must note that this new problem is of dimension , with possibly  << , so

that computationally it is much more feasible. As with any such problem, there will be

 eigenvalues and eigenvectors that satisfy Equation 7.35. The eigenvalues will yield 

natural frequency estimates,

                                         ,       ,  ...  ,  
                                              2
                                      1                       

such that

                                    ,       for  = 1, 2, ... 

                                

with estimates improving with better selection of candidate shapes. The eigenvectors

obtained from Equation 7.35 are to be used in calculating estimates of the mode shapes

of the system so that

                                     = [U]  

EXAMPLE 7 .2

What we have is a taut string, subject to a high tension  , and five equal masses attached
to it, as shown in Figure 7.9. Due to the high level of tensile force, the masses will
move mainly along the vertical, with a total of five degrees of freedom for the system.
We would like to estimate the fundamental frequency of the system with Rayleigh's
Quotient.

                    Figure 7.9: A taut string bearing five equal masses.

The first order of business is to derive the mass and stiffness matrices. With the general-
ized coordinates  denoting the translation of each mass and with masses concentrated
at a point, it should be obvious that the mass matrix will be diagonal, with the values of
the masses appearing on the diagonal. We may see that this should be so by considering
a nonzero acceleration  while all other accelerations are zero and see what external
forces would be required for equilibrium; the only external force required in that case
would be  acting along the th generalized coordinate.

To construct the stiffness matrix, let us try to identify the stiffness influence coeffi-
cients via the force equilibrium approach discussed in Section 6.3.1. What would be
332 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

the forces required to keep the system in equilibrium when  > 0 with all other gener-
alized coordinates locked at zero? The free body diagrams of three consecutive masses,
with the th mass at the center, are shown in Figure 7.10. Due to the imposed displace-
ment, there will be some deformation in the string resulting in a change  in the
tensile force. It makes a big difference how high the initial tensile force and how big
the imposed displacement are. If the considered displacement were to be large, then
horizontal effects would have to be included, for otherwise equilibrium would not be
possible. For small displacements we can consider only vertical forces so that

 = 2( +  ) sin , (-1) = (+1) = -( +  ) sin 

anf furthermore, since for   1 we would have
                                      sin   tan  = 
                                                         /5

we get                   (-1) = (+1) = -( +  )  /5
        = 2( +  )  /5 ,

Note that with (-1) and (+1) locked, no force needs to be applied along any other
generalized coordinate since there will be no deformations in their neighborhoods.

Figure 7.10: Stiffness influence coefficients: Free body diagrams of the ith mass and its
neighbors for  > 0 and all other  = 0 for   .

When the initial tension in the string is large and the imposed displacement is small, the
change  due to deformations will remain very small compared to the initial tension
and we may neglect  compared to  for an acceptable approximation. Therefore
the stiffness coefficients will be given by

                          = 10  , (-1) = (+1) = - 5
7.5. APPROXIMATIONS FOR FREQUENCIES                                333

and repeating this analysis for all the generalized coordinates, the stiffness matrix may
be shown to be given by:

                                 2 -1 0 0 0
                                -1 2 -1 0 0 
                             5                     
[K] =  0 -1 2 -1 0 
                               0 0 -1 2 -1

                                 0 0 0 -1 2 

Now we are ready to start our investigation of the frequencies. To use Rayleigh's Quo-
tient we need to estimate what the first mode of vibration might look like. Considering
what we would expect if such masses were hung on a string, a sagged cable shape seems
a reasonable guess. We will therefore use the two shapes shown in Figure 7.11 as two
different shape vectors to employ in Rayleigh's Quotient:

                              1/3           1/2 
                             {       }     {       }
                             {  2/3  }     {  3/4  }

1 =  1  ,                               2 =  1 
                             { 2/3 }       { 3/4 }
                             {}            {}
                              1/3           1/2 

Figure 7.11: Two different shape columns for Rayleigh's Quotient.

These shape vectors lead to

 2 1 [K]1 (10 )/(3) 30
( (1)) =                                =          =
                             1 [M]1        19/9       19

 2 2 [K]2 (15 )/(4) 30
( (2)) =                                =          =
                             2 [M]2        21/8       21
334 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

so that the two upper bound estimates for the first mode frequency obtained from these
respectively are

                   (1) = 1.27   and (2) = 1.20  
and the smaller of the two is our best estimate yet for the first frequency of the system:

                                        1  1.20  

We could try many different shapes and see if this upper bound may be further refined
but it turns out that the estimate above is pretty good: the exact first two frequencies
and mode shapes of the system are

1 = 1.16   ,  1 = {0.50 0.87 1 0.87 0.50}
2 = 2.24   ,  2 = {-1 - 1 0 1 1}

so that the estimate we get for the fundamental frequency from Rayleigh's Quotient is
quite good for many practical purposes.

EXAMPLE 7 .3

To illustrate an application of the Rayleigh-Ritz approach, let us consider the 8 story
shear building shown in Figure 7.12. Based on our previous discussions regarding
shear buildings, we may expect the first mode to have no crossovers and the second
mode to have only one crossover. Candidate shapes 1 and 2 shown in Figure 7.12
seem reasonable enough to be used in our analysis:

[U] = [1                1/8   1/3
                      2/8     2/3 
                      
                      3/8          
                      4/8      1
              2] =            2/3 
                      5/8     1/3 
                      6/8
                      7/8          
                      1        0
                             -1/3
                             -2/3
7.5. APPROXIMATIONS FOR FREQUENCIES  335

Figure 7.12: Eight story shear building model and two candidate vectors to be used in
the Rayleigh-Ritz approach.
336 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

The mass and stiffness matrices are relatively easy to derive. The mass matrix is diag-
onal as in all shear building models, with all diagonal elements equal to  in this case.
The stiffness matrix will follow the classic progression of shear building models as well
and it will be given in this case by

                           4 -2 0 0 0 0 0 0
                 -2 4 -2 0 0 0 0 0 
                                                                                 
                  0 -2 3 - 0 0 0 0 
                       0          0 - 2 - 0 0 0 
                [K] =                                                         
                  0 0 0 - 2 - 0 0 
                  0 0 0 0 - 2 - 0 
                  0 0 0 0 0 - 2 -

                  0 0 0 0 0 0 -  

We now have to set up the eigenvalue problem whose solution will help us determine

the  frequency  estimates  and  the  coefficients      which  we  will  use  in  constructing  our

                                                     

mode shape estimates. To this end we first calculate

                             11                                                  51    
                                     24  ,                                              6
[K]  =     [U] [K][U]  =     64      11     [M]        =   [U]   [M][U]  =         16  8 
                                                                                   
                                      9                                                 3
                            24                                               6

and then use these matrices in the eigenvalue problem

                                ([K]  -  ()2[M])           =  0

                                                         

to obtain

(1)2 = 0.054  ,  (2)2 = 0.459  ,            1 = {          -0.561  },        2 = {     -0.016  }

                                                           0.017                       0.613

Therefore our estimates for the frequencies of the first two modes become

                        1 = 0.232  and 2 = 0.677 
and for the mode shape estimates we get, after scaling them so that their component at
7.5. APPROXIMATIONS FOR FREQUENCIES                                              337

the top floor is equal to one,

               0.11                                              -0.48 
              {                       }                         {         }
              {                 0.23  }                         {  -0.95  }
              {                       }                         {         }
              {                 0.34  }                         {  -1.43  }
               { 0.47 }                                       { -0.94 }
1 = [U]1 ==                            , and 2 = [U]2 =                   
              {                 0.60  }                         {  -0.46  }

              { 0.74 }                                          { 0.03 }
              {                       }                         {         }
              { 0.87 }                                          { 0.51 }
              {                       }                         {         }
               1.00                                              1.00 

It turns out that these estimates are quite acceptable since the exact frequencies and
mode shapes are given by

                                          0.12                      -0.44 
                                         {                   }     {             }
                                         {             0.23  }     {      -0.79  }
                                         {                   }     {             }
                                         {             0.34  }     {      -0.99  }
                                         { 0.54 }                  { -1.01 }
1 = 0.222  ,  2 = 0.623  ,               1 =  0.72  ,           2 =  -0.63 
                                         {                   }     {             }
                                         { 0.85 }                  { -0.01 }
                                         {                   }     {             }
                                         { 0.95 }                  { 0.61 }
                                         {                   }     {             }
                                          1.00                      1.00 

The errors in the frequency estimates and the first mode estimate are quite small, but

the errors in the second mode estimate somewhat more pronounced. The success of

this approach in general depends on how well the candidate shapes resemble the actual

modes and how many such shapes are taken into consideration. If, say, we were to

include three candidate vectors, with the addition of

                                1 2 2 1 1 2
              3 = {                   1  -0                  }
                                33 3 3 33

so that with [U] = [1 2 3], the estimates for the first two modes will be (note that
there will also be an estimate for the third mode which we do note report)

                                          0.11                      -0.38 
                                         {                   }     {             }
                                         {             0.23  }     {      -0.77  }
                                         {                   }     {             }
                                         {             0.34  }     {      -1.15  }
                                         { 0.49 }                  { -0.79 }
1 = 0.227  ,  2 = 0.668  ,               1 =  0.69  ,           2 =  -0.57 
                                         {                   }     {             }
                                         { 0.79 }                  { -0.05 }
                                         {                   }     {             }
                                         { 0.90 }                  { 0.48 }
                                         {                   }     {             }
                                          1.00                      1.00 
338 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

A quick overview of results will immediately reveal that increasing the number of can-
didate shapes have improved both the frequency and the mode shape estimates for the
first two modes.

7.6 Free Vibration Response of Damped Systems

7.6.1 Damping in MDOF Systems

Damping. Well, at this point we can't avoid the issue any further so let's get into it. We
already had a few words to say in Section 2.4 and we will again promote the linear vis-
cous damping model as the model of choice for energy dissipation in small amplitude
vibrations, with energy dissipated due to post-yield deformations to be accounted for
separately. There is, however, an added level of complexity that damping brings into
analysis of MDOF systems: would one be able to uncouple the equations of motion by
transforming to modal coordinates in the presence of damping?

The answer is: not necessarily, but for many applications we will assume that is the case.
To remind ourselves the mathematical structure on which we base our discussion, the
equation of motion of free vibrations for a viscously damped linear MDOF system will
be given by:

[M]() + [C]() + [K]() = 0 ; {(0) = , (0) = } (7.36)

If  is the matrix of eigenvectors (i.e. mode shapes) obtained from the undamped eigen-

value problem

               [K] = [M]2                                  (7.37)

then we know from previous discussions that a coordinate transformation of the form

               () = ()

will lead to                             {(0) = , (0) = }
         [M] () +  [C]() + [K] () = 0 ;

where [M] and [K] are diagonal matrices. So the question is: is  [C] a diagonal
matrix? If so, then transformation to modal coordinates would successfully uncouple
all equations; but if not, then equations would be coupled and the modal analysis ap-
proach discussed previously would have to be modified if not altogether abandoned.
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS   339

If transformation to modal coordinates uncouples also the damping terms so that the
damping matrix in modal coordinates, given by

                                        [C] =  [C]

is a diagonal matrix, the system is said to be classically damped, and the damping mech-
anism is classified as classical. There is no necessity that this should be the norma-
tive case. On the other hand it is by far the dominant model employed in analyses
because it is simple to work with and its critical parameters may be estimated from
(in other words, fit to) experimental observations. The eigenvalue problem that must
be dealt with in classically damped systems is the undamped eigenvalue problem of
Equation 7.37. If, on the other hand, one would like to obtain eigenvectors that would
simultaneously uncouple [M], [K] and [C], one would have to solve the damped eigen-
value problem defined by

(2[M] + [C] + [K]) = 0                           (7.38)

where  is called the damped eigenvalue and  is called the damped eigenvector or the
damped modeshape. We shall not pursue the non-classical model further in this section
and limit the current discussion to classically damped systems. We note in passing
that if the system is classically damped, then the eigenvalues and eigenvectors obtained
from Equation 7.38 will be equivalent to those that will be obtained from the undamped
eigenvalue problem of Equation 7.37.2

7.6.2 Modal Analysis of Classically Damped Systems

If an -DOF system is classically damped, the equations of motion given by Equa-
tion 7.36, when transformed to model coordinates, will yield

[M] () + [C] () + [K] () = 0 ; {(0) = , (0) = }  (7.39)

    2The wording ("equivalent") is suspiciously vague but on purpose so: without going into details now,
we just note that for symmetric, positive definite matrices of dimensions  ×  the damped eigenvalue
problem will lead to 2 eigenvalues and eigenvectors that will appear in complex-conjugate pairs and
the undamped eigenvalue problem will lead to  real valued eigenvalues and eigenvectors. If the sys-

tem is classically damped, the complex conjugate pairs of the damped eigenvalue problem may be easily

transformed to the real valued eigenparameters of the undamped eigenvalue problem.
340 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

where

       1 0              0           1 0    0
                  2     0 ,            2   0 ,
       [M] =  0              [C] =  0      
                                      

        0  0                         0  0 
                          1 0  0 
                  [K] =    0 2  0   

                           

                       0  0 

arr all diagonal so that Equation 7.39 comprises -many uncoupled equations of the
form

       () + () + () = 0 ; {(0) = , (0) = }      (7.40)

This is obviously the equation of motion for a viscously damped linear oscillator, same
as the one we discussed in much detail starting with its introduction in Section 2.4. As
we did in the analysis of SDOF systems, it is beneficial to rewrite this equation dividing
through by the modal mass so that

       () + 2() + 2() = 0 ; {(0) = , (0) = }    (7.41)

where                    = 1 
                              2 

is called the modal damping ratio. Preference of  over  (perhaps we could call this
the modal damping coefficient) is based on the same reasons that we preferred  over 

in SDOF systems:  is a parameter that may be estimated from vibration data and its
physical interpretation is more direct.

The solution of Equation 7.41 was derived previously for SDOF systems and it may be
expressed (based on Equation 2.23, Equation 2.24, Equation 2.25 and Equation 2.26)
as

() = e- [ cos () +  +   sin (  )] = e- cos ( - )
                                                                                             (7.42)
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS              341

where

           ()2 + 2   (  ) + (  2 )
                         
        =
           1 - 2

        = arctan sin  cos  = arctan ( + )/()  /

and the damped modal frequency of the ith mode, , given by

             =  1  -  2

                       

Once the solutions for modal coordinates are obtained, the response in physical coor-
dinates is given by modal superposition as for the undamped case:

                                                                              

                                 () = () =  ()

                                                                            =1

7.6.3 Constructing Damping Matrices in Classically Damped
        Systems

What should the structure of the damping matrix [C] be so that the system will be clas-
sically damped? Or better yet: do we need a damping matrix at all? If we are to perform
linear analysis and the system has a relatively uniform distribution of energy dissipa-
tion so that the classical damping model is acceptable, we need only estimate modal
damping ratios. In classical modal analysis we may write the equations of motion for
the system assuming it is undamped, transform to modal coordinates, and then sim-
ply add the damping term to the modal equations. As a relatively few modes generally
will suffice to give a decent estimate of the response, we will not even need to estimate
damping for all the modes and definitely will not need a full order damping matrix.
There are instances however when such a damping matrix in physical coordinates is
necessary. Clearly any attempt to numerically integrate the equations of motion in
physical coordinates needs such a matrix. Such an approach will be especially impor-
tant if one were to analyze nonlinear systems, say in structures which undergo yielding
and hysteretic behavior under large demands.

There are a few ways to go about this problem, some of which are discussed next.
342 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

7.6.3.1 Rayleigh Damping

As the mode shapes obtained from the undamped eigenvalue problem diagonalize both
the mass and the stiffness matrices, they will also diagonalize any third matrix that may
be written as a superposition of the two. There are two extreme points in this approach:
the damping is said to be mass proportional if the damping matrix is given by

[C] =  [M]  (7.43)

Here,  is a proportionality constant (scalar) with units 1/[unit of time]. With mass
proportional damping we have

                         [C] = [C] =   [M] =  [M]

so that for the ith mode

                         = 2 =     =  2

This construct therefore imposes a decreasing damping ratio with increasing mode
number so that higher modes are damped much less than lower modes. The other
extreme is when the damping is assumed to be stiffness proportional so that

[C] = [K]   (7.44)

where  is a proportionality constant with units of [unit of time]. In this case we
have

                          [C] = [C] =  [K] =  [K]

so that for the ith mode

                = 2 =  = 2   =  2

and therefore we end up with much higher modal damping percentages assigned to
higher modes compared to those for lower modes. A superposition of the two cases
imposes a more uniform range for damping ratios, at least for some portion of the
modes, given by

                 [C] =  [M] + [K]   =  12 +    2
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS  343

Figure 7.13: Qualitative variation of modal damping ratios with frequency in mass
proportional, stiffness proportional and (combined) Rayleigh damping models.

This model is often called Rayleigh Damping after Lord Rayleigh who promoted it.3 The

implication of this equation, which is a combination of inversely proportional (1/)
and proportional () terms is that the lower and higher frequency modes will possibly

have larger damping ratios compared to intermediate modes, as sketched in Figure 7.13.

The two free parameters of the Rayleigh Damping model,  and , could be deter-
mined by prescribing damping ratios for two modes: given  and , we have

         {  } = [1/(2) /2] {  }
           1/(2) /2 

so that    2             1 - {  }
                               
         
         {  } = 2 2 - 1                         (7.45)
           -   

A common practice is to assume that the damping ratios of two modes, say modes 
and , are equal so that  =  = , in which case

          = 2  ,  +   = 2    +                  (7.46)

    3A true classic in the field of classical mechanics, "The Theory of Sound" by Lord Rayleigh (for-
merly/also known as John William Strutt) was originally published in two volumes in 1877 and 1878,
respectively.
344 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

In practice, the two modes at which the damping ratio is set equal to  are the funda-
mental (lowest frequency) mode and one of the modes in the high frequency range that
still contributes significantly to the response. This choice effectively damps out contri-
butions from higher frequencies, whereas intermediate frequencies will have slightly
lower damping ratios than the fundamental frequency.

The obvious issue with Rayleigh Damping is the possibly unwanted variation of damp-
ing percentages in the modes other than those for which the damping ratios are pre-
scribed. If one wants to prescribe damping ratios to more than two modes, other ap-
proaches should be considered.

7.6.3.2 Caughey Damping

The Rayleigh Damping approach could be extended to prescribe the damping ratios

of more than two modes. In what is generally called Caughey Damping or Extended

Rayleigh Damping, the damping matrix is written as a linear combination of some pow-

ers of mass and stiffness matrices. Consider the undamped eigenvalue problem given

by

                                    [K] = 2[M]                                    (7.47)

with orthogonality conditions

     [K] = ,  [M] =                                                               (7.48)

If we premultiply Equation 7.47 by  [K][M]-1, we get

     [K][M]-1[K]  =            2        [  K][  M]-1  [  M]    =    2    =  2
                               
                                                                    [K]

which means that the eigenvalues of the undamped eigenvalue problem diagonalize
also the matrix [K][M]-1[K]. But if that is the case, then premultiplying Equation 7.48
with  [K][M]-1[K][M]-1 leads to

    [K][M]-1[K][M]-1[K]  =          2      [K][M]-1[K][M]-1[M]    =         [K][M]-1[K]

                                   

                         = 4

and therefore, by induction, it can be shown that                        for   0  (7.49)
    [K] ([M]-1[K])  =  ([K][M]-1) [K] = 2
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS                                345

Similarly, if we start by premultiplying Equation 7.48 by  [M][K]-1, we have

              [M][K]-1[K]  =               =    2  [M][K]-1[M]

                                               

which means that the eigenvalues of the undamped eigenvalue problem diagonalize
also the matrix [M][K]-1[M]. Consequently, premultiplying Equation 7.48 with
 [M][K]-1[M][K]-1 leads to

 [M][K]-1[M][K]-1[K] =  [M][K]-1[M] =              1     =             2  [M][K]-1[M][K]-1[M]

                                                    2                 
                                                   

so that        [M][K]-1[M][K]-1[M] = 4 1 
                                                    

and by induction it may be shown that

         -1                            -1            1
 ([M][K] ) [M] =  [M] ([K] [M])  = 2                                 for   0 (7.50)
                                                   

Equation 7.49 and Equation 7.50 may be combined in a single expression by allowing
the powers to take on both positive and negative values as

          [M] ([M]-1[K])  = 2 for -  <  <                                     (7.51)

Note that the classical orthogonality relationships may recovered from Equation 7.51
using  = 0 and  = 1.

The point of this exercise is: any damping matrix that has the form
                                        [M] ([M]-1[K])

will be diagonalized by the undamped mode shapes! A superposition of such matrices
corresponding to various powers, which may be expressed as

                                [C] = [M]   ([M]-1[K])

                                                                  

will therefore yield a damping matrix [C] that will lead to a classically damped system.
The coefficients  are the free variables we may adjust to prescribe damping ratios
for different modes. Consider, for example, the -th mode of the system for which
(knowing that [C] is diagonalized by the mode shapes and via Equation 7.51) we have

                        [C] = 2 =  2

                                                                                    
346 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

so that                  1

                        =    2                               (7.52)

                         2 

When trying to prescribe the damping ratios for -many modes (with   ) we
should use -many terms in the summation and therefore -many coefficients .
Therefore we will have -many equations given by Equation 7.52, containing -many
unknowns  which we solve for using these equations. The question is: which powers
of  should be included? This is important since a particularly egregious error would

be to end up with unphysical negative damping ratios, which turns out to be a common

issue if an odd number of damping constants are prescribed. In practice it is generally

recommended to include an even number of terms, with powers as close to zero as
possible. It is straightforward to show that summing over just the two powers  = 0
and  = 1 will yield the Rayleigh Damping model.

EXAMPLE 7 .4

As an exercise, let us consider the 5-DOF system of masses on a taut string, shown in
Figure 7.14. Recall that we had worked on this system before and shown that the mass
and stiffness matrices were given by

           0 0 0 0                      10 -5 0 0 0
           0  0 0 0          -5 10 -5 0 0 
                                                      
[M] =  0 0  0 0  ,          [K] =  0 -5 10 -5 0 
           0 0 0  0            0 0 -5 10 -5

            0 0 0 0           0 0 0 -5 10 

To turn this into a completely numerical problem, assume  = 10 kg,  = 1000 N
and  = 1 m so that

         10 0 0 0 0              10000  -5000     0      0      0
          0 10 0 0 0          -5000     10000  -5000     0      0
                                        -5000  10000  -5000
[M] =  0 0 10 0 0  ,   [K] =  0                -5000  10000          
          0 0 0 10 0          0            0          -5000     0
                              0            0      0          -5000
          0 0 0 0 10                                         10000 

Eigenvalue analysis yields the following values for the five frequencies of the system:

             1 = 11.575 rad/s, 2 = 22.361 rad/s, 3 = 31.623 rad/s,
                          4 = 38.730 rad/s, 5 = 43.198 rad/s
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS                        347

         Figure 7.14: A taut string bearing five equal masses.

First say we want to prescribe a damping ratio of 5% to the first and the fifth modes
(i.e. we want 1 = 5 =  = 0.05). Since we want to prescribe only two values we
may use the Rayleigh Damping model. According to Equation 7.46, the coefficients

that should multiply the mass and stiffness matrices are given by

          = 215   = 0.91287, 1 + 5  = 2   = 0.00183 1 + 5

so that

                                   27.386  -9.1287      0        0        0
                               -9.1287      27.386  -9.1287      0        0
                                           -9.1287   27.386  -9.1287
[C] =  [M] + [K] =  0                               -9.1287   27.386            
                               0               0             -9.1287      0
                               0               0        0             -9.1287
                                                                       27.386 

Now this damping matrix will lead to the following damping ratios:

         1 = 5.0%, 2 = 4.1%, 3 = 4.3%, 4 = 4.7%, 5 = 5.0%

While we have prescribed only the first and the fifth mode damping ratios, the other
three have come out relatively close to those two. If we had instead prescribed the
damping ratios for the first and the second modes as 1 = 2 = 5%, the same proce-
dure would yield

              = 212   = 0.76268, 1 + 2  = 2   = 0.00295 1 + 2

and the damping ratios would be obtained as

         1 = 5.0%, 2 = 5.0%, 3 = 5.9%, 4 = 6.7%, 5 = 7.2%

If there were more modes, the higher ones would get increasing damping values so
that one has to be careful. High value of damping in a mode will effectively render the
348 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS

contribution of that mode to the response insignificant: this may be something that is
preferred by the analyst but it may also be the source of significant error.

To prescribe the damping ratios for more than two modes we will use the Caughey
Damping model. Assume we would like to prescribe the damping ratios for modes
1, 2 and 3 5%. The first issue that must be addressed is which powers to include in
the summation of Equation 7.52. Since we want to prescribe three damping values,
the summation should include four terms (for three coefficients ). Assume, for no
particular reason, that we would like to use the powers  = -4,  = 1 and  = 6.
In this case, the coefficients  will have to be determined from the following three
equations:

                      1 = 0.05 = 1 2 ( 1 -41-8 + 112 + 6112)
                      2 = 0.05 = 1 2 ( 2 -42-8 + 122 + 6212)
                      3 = 0.05 = 1 2 ( 3 -43-8 + 132 + 6312)

Solving for  we get

                 -4 = 1.783 × 108, 1 = 4.509 × 10-3, 6 = 0

The damping matrix will then be given by

         [C] = [M] (-4 ([M]-1[K])-4 + 1 ([M]-1[K])1 + 6 ([M]-1[K])6)

which will lead to the following damping ratios for all modes:

         1 = 5.0%, 2 = 5.0%, 3 = 5.0%, 4 = -11.1%, 5 = -56.1%

Obviously the damping values thus obtained are unacceptable for the last two modes. If
instead we use the powers  = -1,  = 0 and  = 1, we would solve for the unknown
 values using the equations

                       1 = 0.05 = 1 2 ( 1 -11-2 + 010 + 112)
                       2 = 0.05 = 1 2 ( 2 -12-2 + 020 + 122)
                       3 = 0.05 = 1 2 ( 3 -13-2 + 030 + 132)
7.6. FREE VIBRATION RESPONSE OF DAMPED SYSTEMS  349

from which we find

                     -1 = -84.65, 0 = 1.5638, 1 = 0.0017
and the damping matrix given by

         [C] = [M] (-1 ([M]-1[K])-1 + 0 ([M]-1[K])0 + 1 ([M]-1[K])1)

leads to

             1 = 5.0%, 2 = 5.0%, 3 = 5.0%, 4 = 5.2%, 5 = 5.4%
which are quite acceptable. As a final case, let us try to set the damping ratios for modes
2, 3 and 5 at 5% using powers  = -1,  = 0 and  = 1. Now the equations become

                       2 = 0.05 = 1 2 ( 2 -12-2 + 020 + 122)
                       3 = 0.05 = 1 2 ( 3 -13-2 + 030 + 132)
                       5 = 0.05 = 1 2 ( 5 -15-2 + 050 + 152)
from which we obtain

                   -1 = -352.36, 0 = 2.3669, 1 = 0.00115
and the damping matrix obtained via these values leads to

           1 = -0.5%, 2 = 5.0%, 3 = 5.0%, 4 = 4.97%, 5 = 5.0%
where the first mode is seen to have an unacceptable damping value.
350 CHAPTER 7. FREE VIBRATIONS OF MULTI DEGREE OF FREEDOM SYSTEMS
Chapter 8

Forced Vibrations of Linear Multi
Degree of Freedom Systems

8.1 Modal Analysis for Forced Vibration Response

8.1.1 General Flow

Now that we have established the basic principles of modal analysis while discussing
free vibrations, we will outline the procedure for its application to forced vibrations.
Consider an MDOF system, with  degrees of freedom, subject to time dependent exci-
tations acting along various generalized coordinates and collected in a column matrix
(), so that the equations of motion for the system are given by:

                         [M]() + [C]() + [K]() = ()  (8.1)

Assume that the eigenvalue problem is solved so that mode shapes  and frequencies
 are known. For a classically damped system, transformation from physical coordi-
nates  to modal coordinates  via

                         () = () =  ()               (8.2)

                              

leads to

           [M] +  [C] +  [K] =  ()                   (8.3)

which may be written as

          [M] () + [C] () + [K] () = ()              (8.4)

                         351
352CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

where we have defined the modal load vector  as ()   (). Equation 8.4 is a
collection of -many uncoupled equations, each of the form

       () + () + () = () for  = 1, 2, ...                                (8.5)

where
         =  [M],  =  [C],  =  [K], () =  ()

Dividing by modal mass  leads to

       () + 2() +  () =           2  ()  for  = 1, 2, ...                (8.6)

                                     

Equation 8.6 is the equation for a viscously damped SDOF system. The solution of such
equations have been discussed in detail in Chapter 3 and Chapter 4. Once these equa-
tions are solved, we can combine the contributions from different modes to compute
the response in physical coordinates via

                                     

                () =  ()() =  ()                                         (8.7)

                =1                   =1

where

                ()() = ()                                                (8.8)

is the contribution of the -th mode to the generalized displacements. Such a dissolu-
tion is employed in analyzing the particular contributions of modes to many response
quantities. We will use the terminology modal [response quantity] to refer to such contri-
butions; for example, we will call the vector () in Equation 8.8 the modal displacements.
We shall eventually refer other quantities such as modal base shear, modal interstory drift,
modal equivalent static loads, etc.

In summary, the procedure to solve MDOF forced vibration problems with modal anal-
ysis can be summarized as follows:

Modal Analysis

       · Construct [M], [K] (for example via the methods of Chapter 6).
       · Obtain , .
       · Transform the equations to modal coordinates.
8.1. MODAL ANALYSIS FOR FORCED VIBRATION RESPONSE  353

       · Solve for  from Equation 8.6.
       · Calculate the modal responses (e.g.modal displacements via Equation 8.8).
       · Calculate physical response quantities (e.g. generalized displacements via

          Equation 8.7).

In principle, for an -DOF system, it may not be necessary to include all  modal re-
sponses while calculating a response quantity since some (or even many) of the modal
contributions may be negligible and therefore not worthwhile to spend resources on,
especially in solving the eigenvalue problem and the response calculations in modal
coordinates. The answer to the question of how many and which modes to include,
however, is not trivial since the acceptable subset to use will depend on both the spa-
tial and temporal distributions of the inputs. We will revisit this issue in more detail
while discussing earthquake response analysis.

8.1.2 Derived Response Quantities

When modal analysis is used to analyze the response of a system, any response quan-
tity we may seek to find will depend on the modal coordinate responses. We have seen
an example of this in Equation 8.7 where the displacement responses in physical coor-
dinates were expressed as a superposition of the modal displacements which in turn
were functions of modal coordinates . In this section we will introduce a few derived
quantities which are deemed important for design and control purposes, and try to
evaluate the modal conributions to each.

Consider, as an example, a multi-story shear building. We choose to analyze this model
because certain response quantities are relatively easily visualized on this model. The
structure is shown in Figure 8.1 (a), and we assume that it is subjected to a unidirec-
tional ground motion given by (). The response quantities we are about to introduce
are frequently employed in earthquake related analyses but the formulations could be
generalized to any external excitation with proper modifications.

One of the design parameters often referred to in structural codes is the base shear, de-
noted here by . This is the total shear force that must be transmitted to the fixed
base by the columns attached to the foundation. It may be calculated via the cumula-
tive d'Alembert forces or the equivalent static loads as follows: At any time during its
motion, the free body diagram of the whole shear building, including the d'Alembert
forces, will be like the one shown in Figure 8.1 (b) (the free body diagram also includes
the overturning moment  which will be subsequently introduced). Equilibrium de-
354CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 8.1: Shear building: (a) unidirectional ground motion model, (b) d'Alembert
forces, (c) equivalent static loads. Note that vertical forces (weights and ground reac-
tion) are not shown here since only lateral effects are analyzed but they do exist and
they may have to be accounted for in certain analyses.
8.1. MODAL ANALYSIS FOR FORCED VIBRATION RESPONSE     355

mands that the net horizontal force shall be zero so that

                                                          

                          () = -  () = -1 [M]() (8.9)

                                                         =1

Alternatively, we define equivalent static loads

                         ,1() 
                        {  {  () = ,2() }} = [K]()
                                                      (8.10)
                        {{                        }}
                         ,() 

as the set of external loads that should be appplied to a fixed base structure to induce

the displecement pattern () at time . The structure with these forces is shown in

Figure 8.1 (c). The reasoning is that since () is imposed, the internal force distribution

related to deformation (stiffness) elements must be compatible with that which would

occur under external loads  = [K]; this in turn implies that a static analysis under

applied loads  could be used to solve for internal forces. Under the action of 

shown in Figure 8.1 (c), the base shear will be simply equal to the sum of these forces

so that it is given by  () = 1 [K]() = 1 ()

                                                      (8.11)

which may be shown to be equal to  = 11. It is important to note that there
are no such external forces that actually act on the system; the equivalent static force
 is a conceptual device that simply helps us in calculations and allows us to think
about a problem as we are accustomed to do in our experience with static analyses.

The expression in Equation 8.10 is the same as that with which we have previously
defined  but these two sets of forces have a subtle conceptual difference and we feel
that difference should be reflected in the symbolism. In any case we should note that

if the system is undamped, then equations Equation 8.9 and Equation 8.11 actually

yield the same results since by the equation of motion for a shear building subject to

unidirectional ground motion we have

[M]() + [K]() = 0  [K]() = -[M]()

In the presence of damping, a portion of d'Alembert forces would be balanced with
damping forces so that the values obtained from the two expressions would differ; for
small values of damping, however, the difference may not have a significant impact on
design. Due to its direct link with methods of static analysis, the equivalent static force
formulation is often preferred.
356CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

How do we calculate the base shear with modal analysis? If we replace the generalized

displacement vector in Equation 8.10 with its modal expansion given in Equation 8.2

we get

        () = [K]() = [K] ( ())                  (8.12)
                = [K]11() + [K]22() +  + [K]()

          (1)  (2)                 ()
          =  () +  () +  +  ()

where            ()

                () = [K]()                      (8.13)

is the modal equivalent static force for the -th mode, i.e. the contribution of the -th
mode to the equivalent static force at time . Consequently, the base shear may be
written in the form

                (1)   (2)               ()
        () = 1 () = 1  () + 1  () +  + 1  ()
                                                (8.14)
        = (1)() + (2)() +  + ()()

where     ()    ()   

           () = 1  () = 1 [K]()                 (8.15)

is the modal base shear for the -th mode, i.e. the contribution of the -th mode to the
base shear.

Another design variable commonly referred to is the overturning moment , which
is the total moment generated during at the base of the structure. We may calculate
this quantity as follows: assume that the -th floor is located at a height of  measured
from the base. Condsidering the equivalent static loads, the overturning moment may

be derived from moment equilibrium as

        () = 1,1 + 2,2 +  + , =  ()

where  = {1 2  } is a column matrix that contains the heights, and it
is generally referred to as the height vector. Considering modal expansion of the equiv-

alent static loads given in Equation 8.12 we get

                (1)   (2)               ()
        () =  () =   () +   () +  +   ()
                                                (8.16)
        = (1)() + (2)() +  + ()()

with      ()    ()   

           () =   () =  [K]()                   (8.17)
8.1. MODAL ANALYSIS FOR FORCED VIBRATION RESPONSE  357

denoting the modal overturning moment for the -th mode, i.e. the contribution of the
-th mode to the overturning moment at time .

One could contrive many other response quantities that may depend on displacements,
deformations, and their time derivatives. The simple fact is that if a system has 
degrees of freedom, then it should be possible to express any of these quantities as
some function of at most -many generalized coordinates and/or their time deriva-
tives. Whenever modal analyses is possible, it will be convenient to express such re-
sponse quantities via summation of modal contributions, and it will be possible to iso-
late and discuss the contribution of a specific mode to a particular response quantity.
Such modal expansions of response quantities play important roles in determining how
many modes to include in an analysis, or whenever it is not possible to obtain full time
histories but estimates of maximum responses are available. We will visit these issues
further down the text.

8.1.3 Harmonic Excitations

With the modal analysis procedure described above, we can examine how systems will
respond to time varying external forces (). As in the case of SDOF systems, the excita-
tion may be impulsive, periodic, harmonic or random in nature. The preferred analysis
method for each scenario may differ. Most generally, time-stepping based numerical
approaches can be used to compute the response for a broad range of excitations. For
simple loading scenarios such as a harmonic excitation distributed to nodes, the modal
analysis technique allows us to obtain analytical solutions with relative ease. In addi-
tion, response of MDOF systems to harmonic excitations gives us a window through
which we can observe how concepts such as resonance translate to MDOF systems.

A particularly relevant class of problems involves situations where the whole system
is excited with a single frequency harmonic excitation but with excitation amplitudes
varying at each node. The equation of motion for this system is given by

[M]() + [C]() + [K]() =  sin ( - )                 (8.18)

wherein the load vector is expressed as () =  sin () to separate the time varying
harmonic component and time invariant amplitude distribution of the loading. Let's
recall the modal equations for forced excitations, Equation 8.4, where the modal load
vector is obtained as () =  (). For each mode then we have,

() + () + () = () for  = 1, 2, ... , 
358CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

where, for our harmonic force,

                  () =   sin ( - )                              (8.19)

so that the equation of motion for the -th mode, after dividing through by its modal
mass, may be written as

                                   2  
          () + 2() +  () =                     sin ( - )        (8.20)
                                            

Equation 8.20 is the equation of motion for an SDOF system subjected to harmonic ex-
citation and we have solved this problem before: the solution is given by Equation 3.39,
which may be adapted to the modal SDOF equation as

          -                                     sin(+)- cos(+)  ) sin ]
() = 2  e      [sin ( + ) cos  + (
                                                    1-2

                                                                (8.21)

       + 2   sin ( -  - )

           

where                                        = 

                  =             1  -  2  ;

                                       

        = 1 ;                               tan  =  (2)/

           (1  -    22          +  (2)2             (1 -  )/2

                   )

Once the response in modal coordinates are evaluated, the response time histories in
physical coordinates are obtained via modal superposition, i.e. Equation 8.7.

It is difficult to make sense of what the solution looks like by investigating the equations
alone, so let us try to investigate a relatively simple case to gain some physical insight.
Consider what the response would be when the system is subjected to a sinusoidal
excitation with unit amplitudes, i.e. for the case with

                                () = 1 sin ()

As the response will eventually comprise only the steady state solution let us focus
solely on that part, so that the response of the -th mode will be given by

                          1                                     (8.22)
               () = 2  sin ( - )
8.1. MODAL ANALYSIS FOR FORCED VIBRATION RESPONSE           359

and the responses in physical coordinates will be given by

            1
          () =     sin ( - )
          =1 2

There are two distinct contributions to the amplitude of the modal response. One is

the term           1

                  2

which is in part associated with the spatial distribution of the excitation and in part
by the modal stiffness (i.e.  = 2). As we get to higher modes the number of
sign changes in a mode shape increases, and so it is forseeable that  1 will most
likely decrease with increasing mode number. This decrease is also exacerbated with

the increase in the value of the frequency as the mode number increases (recall that by

convention we order modes in increasing frequency values). The second contribution,
however, comes from the dynamic amplification factor , which is a function of  and
. Whenever the excitation frequency approaches the frequency of a particular mode,
the dynamic amplification factor for that mode will increase significantly (theoretically

it will asymptotically reach an infinitely large value for an undamped system), and in

that case the response will be dominated by that mode. It is the interplay of the spatial

and temporal components that eventually determines the dominance of a mode in the

response.

EXAMPLE 8 .2

Let's consider a special case of an undamped 2-DOF system subject to a harmonic ex-
citation on the first mass only. A question we can immediately ask is: how does the
presence of the second mass and spring affect the response of the first mass? In other
words, imagine an SDOF system with mass  and stiffness ; could we attach a second
mass-spring unit to reduce or altogether suppress the motion of this system, assuming
we can adjust  and  as we like? The answer is yes, and in fact this is commonly uti-
lized in engineering practice to dampen out structural vibrations. These systems are
broadly called tuned mass damper (TMD) systems, where unlike viscous damping,
the vibration amplitudes are reduced by the addition of a well-calibrated mass-spring
system.

The SDOF system with the mass-spring attachement is shown in Figure 8.2. For the
combined system the matrix equation of motion is
360CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 8.2: A tuned-mass damper system consisting of two masses and no dashpots.

[ 0 ] { 1() }+[ +  -] { 1() } = {  } sin () =  sin ()
0  2()       -                 2()               0

The two equations are coupled through [K]. This system is simple enough that we can
either solve it by assuming a sinusoidal solution in physical coordinates. The equation
of motion for each mode will be

                    2  
             () +  () =               sin ()
                               

Noting that

               = {1 2} { 0 } = 1

and that

             = 1 ;              = {0          if  < 1
             (1  -  2)2                       if  > 1

                      

the steady state solution for the -th mode may be derived via Equation 8.21 to obtain

             () = 1            1
                                  2 sin ()
                       2 1 - 

Summing up the contributions of the two modes, the response of the primary mass (the
original SDOF system) is obtained as

             1() = [ 1111 + 1212 ]  sin ()
             1  (1  -  2    )  2  (1  -  2    )

                         1                 2
8.1. MODAL ANALYSIS FOR FORCED VIBRATION RESPONSE                          361

where  = 2.

Let's consider a simple numerical case to illustrate the response. Intuitively, we can
imagine that if the second mass-spring complex is tuned to move out of phase with the
first during steady-state response, this will result in reduced motion of the first mass.
Defining the natural frequency of the isolated SDOF primary system as  = /,
we will investigate how the response amplitude varies for different values of /. Let's
consider a special case where we define a mass ratio of / = 0.1, and use the same
ratio to scale the stiffnesses as / = / = 0.1) such that both the primary and
the damper system would, if they were considered as two separate SDOF systems, have
the same natural frequency. In this case,

                      [M] =  [1 0 0 0.1] , [K] =  [ 1.1 -0.1 -0.1 0.1 ]

so that solving the eigenvalue problem, we get the natural frequencies as

2    =  0.72982                    ,  2    =  1.37022

  1                                     2

and a set of mode shapes given by

1 = { -0.6495 -2.4043 } , 2 = { -0.7603 2.0541 }

With these mode shapes, the modal mass and stifness values are calculated as

                  1 = 2 =  ; 1 = 0.7298, 2 = 1.3702

The absolute value of the displacement response amplitude 1 of the primary mass,
normalized with  / (as in static deflection under  ) is then given by

                                 1  =  2 0.578 + 2 0.422 
                                   / 1 - 1 1 - 2

The normalized response amplitude plotted in Figure 8.3 shows that the response was
completely suppressed at the original natural frequency of the primary system. Even in
damped systems, for the critical scenario where the primary system would exhibit res-
onance, we will have a significantly diminished response, with the displacements being
much smaller than static response. In the damped scenarioes, the lowest amplification
happens near but not exactly at /. It can be shown that by increasing the mass ratio
362CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

Figure 8.3: The steady state displacement response amplitude (normalized by  /) of
the primary mass in a tuned mass damper system with mass ratio / = 0.1, plot-
ted here against excitation frequencies  normalized by the primary system's resonant
frequency  = /.
8.2. MODAL COMBINATION RULES  363

/, it would be possible to broaden the operational frequency range (e.g. the range
where response is less than static equivalent) and further reduce the resonant amplitude
(considering primary only), but such an increase becomes practically challenging given
the need to add a substantial amount of weight to the system. An additional constraint
is the displacement bounds on the second mass which may reach excessive amplitudes.
Designs typically consider these criteria and try to determine optimal solutions under
viable constraints imposed on both variables.

8.2 Modal Combination Rules

Obtaining response time histories with modal analysis requires a complete character-
isation of how the excitation varies in time. This may simply not be possible under
certain types of loads or analyses, a prime example of which is the analysis frequently
encountered in design of structures for earthquakes. Recall that the concept of earth-
quake spectra was developed specifically for such an issue since the actual time history
of a future earthquake is impossible to estimate but some bounds on the response of
SDOF systems may be estimated. So the question is, how may we proceed when we
do not know the full excitation but may estimate peak values of some modal response
quantities?

This question is not so trivial since there is no precise approach suitable for all cases
although one is more likely to err by over-estimating. Let us first clarify what the prob-
lem is: consider an analytically tractable problem such as a 3-DOF shear building sub-
ject to a harmonic ground motion given by () = sin (). Assume we would like
to calculate the peak response for the first floor displacement 1 that will be observed
during steady state vibrations. By peak response we shall refer to that value of the re-
sponse quantity whose absolute value would be the maximum of all the absolute values
of that response quantity for a particular excitation and/or duration; in other words,
the peak value  of a response quantity () is its value at time  = , i.e.  = ()
such that |()| is the maximum of all |()|. The sign of a peak response quantity
may be positive or negative, and this sign will be prescribed by the definition of the
response quantity as will be evident later on. There is a slight but consequential dif-
ference between the peak response that we have defined and the peak response that
is often refferred to which represents a maximum absolute quantity. For example, a
spectral quantity like the pseudo-acceleration or the deformation that will be obtained
from a given spectrum, which denotes a maximum response or sometimes a maximum
excitation value, will always have a positive value by definition, since by definition we
would have  = |()|. If differentiation is necessary, we will refer to such maxima
364CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
as peak absolute response or peak spectral response. Recall that ground motion parameters
such as peak ground acceleration introduced previously in Chapter 5 are in fact also
quantities of this sort.

Figure 8.4: Steady state response (extracts) of modal coordinates for the 3-DOF shear
building subjected to harmonic ground motion.
For the problem at hand, the steady state vibrations of the modal coordinates  will
have the time histories shown in part in Figure 8.4. If the time histories are known,
then straightforward superposition leads to

                         1() = 111() + 122() + 133()
and the peak first floor displacement 1 that is observed during steady state vibrations
may be directly identified from the time history of 1(). What if we do not have the
time histories but only estimates of the amplitudes of steady state vibrations of modal
coordinates, i.e. estimates for 1, 2 and 3 shown in Figure 8.4? Such esimates could
be available from a given spectrum, for example in the form of a graph of dynamic
amplification, which shows how vibration amplitude varies with the ratio /.
8.2. MODAL COMBINATION RULES  365

Estimating 1 from 1, 2 and 3 alone is not a trivial issue. The obvious problem
is the phase difference. If we look at the time histories we will see that when 1()
reaches a maximum, 2() is near zero and 3() is almost at its minimum. Therefore
if we were to superpose the time histories, the sign differences would most likely lead
to a peak value less than what we would obtain by superposing the modal peak values,
i.e.

                            1  111 + 122 + 133

If phase information is not available this may be an option but most likely it is a very
conservative estimate. The absolute values are in fact there to ensure that our estima-
tion error does not lead to increased risk of safety; if errors can not be avoided, we
should at least make sure that we remain conservative and not give way to any unwar-
ranted concerns.

The estimation issue we have tried to exemplify is generally investigated under the
heading modal combination rules. The concise form of the problem is as follows: As-
sume there is a response quantity () generated in a system under a certain load, and
that its peak value is . The contribution of mode  to this response quantity is given
by ()() and its peak value is (), with  = 1, 2, ... ,    where  is the num-
ber of modes that will be included in the analysis; this number may be less that the
total number of modes  if it is known that the contribution of some modes may be
neglected. The question is: knowing (), how could we produce an estimate of ?
There could obviously be many ways of doing this but we will discuss only three of the
most commonly used combination rules.

8.2.1 Absolute Sum (ABSSUM)

The most obvious and most conservative way to combine the modal response is to
consider the worst case scenario where all modal peaks occur at the same time with
the same sign so that

                                                                                               

                      (1) + (2) +  + () =  ()

                                                                                                   

It is rarely if ever possible that such a complete concurrence occurs and therefore this
modal combination is generally considered to be over-conservative.
366CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

8.2.2 Square Root of the Sum of Squares (SRSS)

Initially considered as a less conservative combination that favors the larger contribu-
tions more, the square root of the sum of squares (SRSS) rule estimates the peak response
via

2  2  2            2 1/2

  ((1)) + ((2)) +  + (()) = (  (()) )

                 

Theoretical justification of the SRSS may be given via random vibration analysis and
it has been shown that SRSS works best when modes are well separated; in any case
it is not so overly conservative as the ABSSUM. When, however, the majority of the
estimate is contributed by close modes, the results are more questionable and the com-
plete quadratic combination rule may be considered as an alternative with a stronger
theoretical justification.

8.2.3 Complete Quadratic Combination (CQC)

It may not be possible to specify a single combination rule that would be optimum
for all arbitrary inputs but certain types of excitations are conducive for classification.
Stationary random excitations are one such set which, although quite idealized, may
be used to model certain inputs such as wind and earthquake excitations. Neither
of the two are in fact stationary and their probabilistic characteristics are always
time dependent; in any case, analysis of response to stationary excitations have
provided very useful theoretical frameworks and some practical results that have
been employed with satisfactory accuracy. In the analysis of earthquake excitations,
for example, considering the ground motion to be a stationary random process have
helped tracking how modal response may vary with respect to each other and how this
variation affects the response. This investigation have led to the modal combination
rule known as the complete quadratic combination which proposes

         1/2

     (   () ())                        (8.23)

   

Parameter , called the correlation coefficient, provides in general a measure of the
reciprocal relationship between two random variables, and in this particular case it
provides a measure of temporal reciprocity between mode i and mode j. There are dif-
ferent estimates for this coeefficient all of which depend on some measure of separation
8.2. MODAL COMBINATION RULES               367

between the frequencies of the two modes. For example, a frequently cited proposal

is1          8( + )3/2

      =  22                      2  2  22  (8.24)
         (1 - ) + 4(1 + ) + 4( +  )

where  = /. It may be easily shown that 0 <   1,  = , and  = 1.
In a simpler version, if two modes have the same damping ratios with  =  = ,

then Equation 8.24 reduces to

          =  82(1 + )3/2                   (8.25)

             22               2     2
             (1 - ) + 4 (1 + )

Figure 8.5: Variation of the correlation coefficient of Equation 8.25 with the ratio of
frequencies for three different modal dmaping values.

The correlation coefficient depends very much on the separation of the two frequen-
cies and this trend is most readily observed in a simple plot like the one in Figure 8.5
which shows the variation of the correlation coefficient between two modes  and 
with the ratio of the modal frequencies /. For simplicity we have assumed both
modes to have the same damping ratio  and have provided curves for three different
values of modal dmaping ratio. Two things are immediately identified: i. the correla-
tion coefficient steeply decreases from its maximum value of 1 as the separation of the

    1E.L. Wilson, A. Der Kiureghian and E.P. Bayo, "A Replacement for the SRSS Method in Seismic
Analysis' ', Earthquake Engineering and Structural Dynamics, Vol. 9, pp. 187-194, 1981.
368CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

frequencies increases, ii. the correlation coefficient is quite sensitive to damping and
the more lightly damped the modes are, the steeper is the decent from the peak value.
These observation support the use of SRSS in many application as well. If we note that
 = 1 and write the CQC rule given by Equation 8.23 in the form

  2                                1/2

  (  (()) +   () ())                    (8.26)

   

then it is obvious that the first part comprising the single summation is the SRSS rule
and the second part comprising the double summation is the additional contribution
brought about by the CQC. If the modal frequencies are sufficiently separated then
  0 and the difference between SRSS and CQC becomes negligible.

8.3 Response to Ground Motion

Extension of the discussions and formulation hereto presented to structures subjected
to ground motoions is both trivial and not-so-simple. It is trivial because mathemati-
cally the equations of motion for a system subjected to ground motion, as discussed in
detail in Section 6.7, are analogous to the equations discussed in the current chapter.
For a linear, classically damped system these equations are of the form

[M]() + [C]() + [K]() = -[M][b]()       (8.27)

as was developed in Section 6.7, with the current addition of the damping term. This
equation is identical to Equation 8.1 where ()  -[M][b](); in fact, due to this
analogy, the term -[M][b]() is sometimes referred to as the effective earthquake force.
When the system is classically damped, all that we have said about modal analysis is
valid and the time history of any response quantity may be determined provided that
the input signal () is known. But therein lies the difficulty. The primary example of
ground motion is earthquakes, generally governing the design of a structure in earth-
quake prone areas. As was discussed in the context of SDOF systems, it is impossible to
preciely predict what a future earthquake will look like, and therefore the design pro-
cedure is often based on a design spectrum that is established from historical analysis of
past earthquakes and that hopefully represents the typical earthquake loads that may be
expected in the lifetime of a structure considering its location and ground conditions.
Use of a spectrum necessitates the use of modal combination rules that were discussed
in Section 8.2. Uncertainty in the input is ever present in earthquake resistant design
and still the subject of many reasearch effrots.
8.3. RESPONSE TO GROUND MOTION                                                369

8.3.1 Modal Response to Ground Motion

To walk through the basic steps involved in analyses and introduce some terminology,
let us consider the simple shear building shown in Figure 8.6, subject to a 1-D transla-
tional ground motion (). The position of the masses can be defined in response to
an inertial frame of reference in absolute terms by (), or relative to the ground by
(), while the ground itself is displaced by an amount (). As shown in Section 6.7,
the absolute and relative displacements of the masses are related through

    () = () + 1()

where 1 is the 1 ×  column matrix of ones. Differentiating with respect to time yields

    () = () + 1()

and the equation of motion governing the relative displacements are given by

    [M]() + [C]() + [K]() = -[M]1()                                           (8.28)

We might recall that this version was generally preferred over the equations regarding
the absolute displacements since the relative displacements are more directly associ-
ated with deformations; also note that ground motions from earthquakes are often
recorded as time-histories of accelerations, typically captured by means of seismome-
ters. It should also be noted that this equation is essentially the same as Equation 8.27
with ()  () and [b]  1, with dimension reductions due to the fact that we have
a single ground motion component in the current example.

Transforming to modal coordinates with () = (), equations in modal coordi-
nates are obtained as

                                2  
    () + 2() +  () = - ()                                                     (8.29)
                                   

where the scalar coefficient , referred to as the earthquake excitation factor, is given

by   =  [M]1

                                                                              (8.30)

The earthquake excitation factor provides some measure of the extent the ground
motion excites a particular mode although it is not the only determinant in the
contributio of a mode to the overall response. In any case there is a trend that is
relatively easily spotted. Recall that as the mode number increases (in accordance
370CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
      Figure 8.6: 3 story shear building subject to unidirectional base excitation.
8.3. RESPONSE TO GROUND MOTION  371

with our convention of ordering modes in increasing order of frequency), the number
of sign changes in the mode shape also increases. For an -story shear building for
which the mass matrix will be diagonal with floor masses , for example, we have

                                                                                

                                  =  [M]1 =  

                                                                                

so that for the first mode we will have all positive terms in the summation but for the
second mode onward we will have both positive and negative terms. The earthquake
excitation factor therefore tends to decrease with increasing mode number. Further-
more, consider a conjugate SDOF system that has the same frequency and damping
ratio as the -th mode, subjected to the same ground motion (); this system's equa-
tion of motion will given by

() + 2() + 2() = -()

where () is the generalized coordinate for the conjugate SDOF system of the -th
mode. Since the equations of motion are linear, the response of the -th mode and the

response of the conjugate SDOF system are related through

() =  ()                        (8.31)
          

since, due to linearity, a scaling of the input leads directly to a scaling of the output
with the same factor. Consequently, if the peak absolute displacement of the conjugate
system is given by

                                        D = max |()|

                                                                      

such that D may be calculated or read from a spectrum, then we may estimate the peak
modal coordinate response as

                                           =  D
                                                  

Once the response in modal coordinates is known, the response in physical coordinates
may be obtained via modal superposition so that, for example, displacements are given
by

                               () = () =    ()
                                                      
372CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

8.3.2 Base Shear and Overturning Moment

Base shear  and overturning moment  play such an important role in aseismic
design that it is worthwhile to revisit them even though we had previously introduced
them in Section 8.1.2. The equivalent static loads for our simple shear building are
sketched in Figure 8.7. Recall that these forces are given by

                                        () = [K]()

and that the base shear, which may be obtained for a shear building as the sum of the
equivalent static loads, is given by

                               () = 1 () = 1 [K]()

Figure 8.7: Equaivelent static forces, base shear and overturning moment for the shear
building of Figure 8.6.

Modal expansion of the physical displacements as () = () allows us to express
equivalent static loads as

(1)  (2)
() = [K]() = [K]11 + [K]22 + ... =  +  + ...
8.3. RESPONSE TO GROUND MOTION                                             373

where, with the use of the conjugate SDOF response and Equation 8.31,

                          ()                      
                       () = [K] = [K] ()
                                                  

is the equivalent static force that would be associated with the -th mode alone. Since

                                  [K] = [M]2

we may also use                                2

                              ()
                               () = [M]  ()
                                              

to calculate the modal equivalent static force for the -th mode. Now the base shear

may be expressed as

                               (1)     (2)          (1)      (2)
       () = 1 () = 1  + 1  + ... =  () +  () + ...

where                                                       2

                ()     ()                         
          () = 1  = 1 [K] () = 1 [M]  ()
                                                           

is the contribution of the -th mode to the base shear. Furthermore, since

                               =  [M]1 = 1 [M]

we have                                    2

                                  ()         2
                               () =  ()
                                           

which is the simplest expression for modal base shear. The factor 2 / is referred to

as the effective modal mass. This nomenclature is more mnemonic than physical and

it aims to help via resemblance to force being the product of mass (in this context,
2 /, with units of mass) and acceleration (in this context, 2(), with units of

acceleration).

In shear buildings, the sum of effective modal masses equals the total mass of the struc-
ture; i.e., for an -story shear building we will have

                                      2    
                                  {        }
                                        1

                                  { 1 }
                                  { 2 }
                       2          { 2}                   
                                                
                     = 1  2  = 1 [M]1 =                                    (8.32)

                                  {}                     
                                  { 2}
                                  {  }
                                  { }
                                    
374CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

That this is so may be shown via writing the column matrix of ones as a linear combi-
nation of the mode shapes so that

                                  1 
                         { 1 =  {  } 2 } = 

                                 
                                 {{ }}
                                   

To find out what the coefficients  should be we can use the orthogonality of the mode
shapes whereby we get

                                1 
                               {{  } 2 }
                    [M]1 =  [M]   = 
                               {}
                               {    }
                                    

and since  [M]1 = , we obtain  = / and

                          = { 1 2   }        

                         1 2        

Therefore we have

         2
         = 1 [M]1 =   [M] =  [M]  =  
                                                  
       

as was the claim. This equality has presented itself as the basis for a commonly used
criterion in modal analysis regarding how many modes to include: it is possible to state
a normalized target such as to include as many modes as necessary so that effective
modal masses represent 90% (or more or less) of the total mass of the building.

We could proceed along similar lines to develop relationships regarding the overturn-
ing moment. Multiplying equivalent static loads with their respective heights leads to

                                    { ,1() } 
       () = {1 2 ...}  ,2()  =  ()

                                    {  }

                    (1)   (2)           (1)      (2)
         =   () +   () + ... =  () +  () + ...

where                                         2

                   ()     ()   
                    () =   () =  [M]  ()
                                        
8.3. RESPONSE TO GROUND MOTION  375

Figure 8.8: A 2-DOF system with translational and rotational degrees of freedom, and
the equivalent static loads associated with the ground motion.

is the modal overturning moment for the -th mode, i.e. the contribution of the -th
mode alone to the overturning moment.

It should be noted that the formulations for base shear and overturning moment devel-
oped above have to be modified for arbitrary systems. Obtaining the base shear via the
direct sum of all the equivalent static loads is a consequence of their common lateral
direction. If rotational or vertical degrees of freedom were present, a direct sum of all
equivalent static loads would not be meaningful. Consider as a simple example a heavy
rigid bar supported by a single column of negligible mass as shown in Figure 8.8. Even
if the bar is assumed axially rigid, the system has two degrees of freedom such that the
center of mass may translate laterally and the rigid bar may rotate about its center of
mass. The equivalent static loads  = [K] in this case would be a lateral force and a
moment, also shown in Figure 8.8, and the base shear and overturning moment would
be given by

                          = ,1 and  = ,1 + ,2

and it should be clear that these expressions differ from the previously derived ones.
On the other hand, in any case, the base shear and the overturning moment will be given
by some linear combination of the equivalent static loads. In an effort to generalize
the formulations we shall use the notation  and  to denote the column matrices
comprising the coefficients that multiply the equivalent static loads to obtain the base
shear and the overturning moment, respectively, so that in general

                              =   and  =   

In the case of a shear building we will have  = 1 and  = , whereas for example
376CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS
in the case of the column supported slab of Figure 8.8 we will have

                                 = { 10 } ;  = { 1 }

8.3.3 Spectral Analysis and Modal Combination

When the time history of base excitation is known, the modal analysis approach hereto
detailed allows us to derive the time history of any response quantity. In earthquake
analyses, however, the ground motion is more often than not unknown. The concepts
of response and design spectra were introduced previously in Chapter 5. Here we will
try to discuss how the use of such spectra may help in analysis of MDOF systems.

To remind ourselves the basic terminology and notation, assume that a spectrum for
some ground motion () is available. Such a spectrum would give the variation(s) of
peak response(s) for a SDOF system governed by

                             () + 2() + 2() = -()

The displacement spectrum D = D( , ) would show the variation of the maximum
absolute relative displacement (deformation), defined by

D = max |()|

           

as the period of the system varies for different values of damping ratio. The pseudo-
velocity V and the pseudo-acceleration A are defined through

D = V = A
              

so that knowing one, the other two may be easily calculated.

Say that we have the pseudo-acceleration spectrum A for a specific value of the damp-
ing ratio, as shown in Figure 8.9. For simplicity assume all modes have the same damp-
ing ratio with  = 0.05 so that this single spectrum is sufficient for the system we
are investigating. Our 3-DOF system of Figure 8.6 will have three periods, say 1, 2
and 3, corresponding to three frequencies 1, 2 and 3, respectively. Each period is
associated with a modal equation in the form

2               
() + 2() +  () = - ()
                
8.3. RESPONSE TO GROUND MOTION                        377

Figure 8.9: A pesudo-acceleration response spectrum.

and for each period, the corresponding pseudo-acceleration value will be read from the
spectrum as A1, A2 and A3. With these values, the peak modal coordinate responses
will be estimated by

1 = 2 1 A1 ,  2 = 2 2 A2 ,        3 = 2 3 A3
       1 1           2 2                 3 3

Now we have to make a choice: how do we want to combine the modal responses to
estimate a specific response quantity? Assume we would like to estimate the maximum
deformation suffered by the third story, i.e. the interstory drift between floors 2 and 3.
The quantity we are trying to estimate is the peak value of

23() = 3() - 2() = [ 3()] - [ 2()]

                                  

where, to remind ourselves,  denotes the component of the -th mode along the -th
generalized coordinate. We first have to figure out the contribution of each mode to

the interstory drift. Modal expansion of the displacements lead to

23() = (31 - 21)1() + (32 - 22)2() + (33 - 23)3()
378CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

The contributions of each of the modes to the interstory drift 23 are therefore given
by

     23 (1) = (31 - 21)1, 23 (2) = (32 - 22)2, 23 (3) = (33 - 23)3

The peak values for each of the modal contributions are then given by

                      23 (1) = (31 - 21)1 = (31 - 21) 2 1 A1
                                                                     1 1

                      23 (2) = (32 - 22)2 = (32 - 22) 2 2 A2
                                                                     2 2

                      23 (3) = (33 - 23)3 = (33 - 23) 2 3 A3
                                                                     3 3

where we note that the peak modal interstory drifts 23 () may be positive or negative
valued. Next step is to pick the method with which we would like to combine these

peak values. If, for example, we would like to use the SRSS approach we have:

              2                 2      2

              23 = (23 (1)) + (23 (2)) + (23 (3))

EXAMPLE 8 .3

A three-story shear building model has story stiffnesses and masses as shown in Fig-
ure 8.10 with  = 100 kg, and  = 9870 N/m. System is assumed to be classically
damped with all modes having a damping ratio of  = 5%. The ground motion ()
this structure will be subjected to is defined by the spectrum also shown in Figure 8.10,
scaled for a peak ground acceleration (PGA) of 0.5 g. We want to find, using the SRSS
combination rule, (i) an estimate for the maximum top displacement, (ii) an estimate for
the maximum deformation in the second story columns, (iii) an estimate for maximum
base shear.

a) Find the natural modes of vibration for this structure, as well as the modal
   masses and stiffnesses:

In order to find the vibration modes, we will need to determine the mass and stiffness
matrices and then solve the eigenvalue problem. The mass matrix [M] is given by

                 10 0
              [M] = 100 0 1     
                             0     kg

              0 0 1/3
8.3. RESPONSE TO GROUND MOTION                                379

              Figure 8.10: Three story shear building model.

and the stiffness matrix [K] by

                                 7 -3 0
              [K] = 9870  -3                       
                                 4  -1               N/m

                                  0 -1 1 

The eigenvalue problem we have to solve to find the natural frequencies and mode

shapes is

                                 [[K] - 2[M]] = 0

which yields

                                 1 = 0.63 s
              1 =  10 rad/s,      2 = 0.32 s
                                  3 = 0.21 s
                        
              2 = 210 rad/s,
              3 = 3 10 rad/s,

with mode shapes given in Table 8.1 and illustrated in Figure 8.11. These mode shapes
are scaled so that their largest (in absolute value) componenent is equal to unity. Ta-
ble 8.1 also includes the modal mass and stiffness values calculated with these mode
shapes.
380CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

     Table 8.1: Results from modal analysis.

                                                                   modal

                                              modal stiff-

                                              mass ness

   [rad/s]  [s]            1     2      3     [kg] [N/m]
   
1   10 0.63                0.33  0.67   1.00 88.89 8773.33

2  210 0.32                -0.33 -0.33  1.00  55.56 21933.33

3  3 10 0.21               1.00  -0.67  0.33 148.15 131600.00

   Figure 8.11: Mode shapes of the shear building of Figure 8.10.

   b) Determine the peak modal responses:

For the three periods of our system, the spectral accelerations we read from the
spectrum of Figure 8.10 scaled to 0.5g peak ground acceleration are

0.25 s < 1 = 0.63 s  1 s    A1 = ( 0.5g 1g ) (2g) = 1g
0.25 s < 2 = 0.32 s  1 s    A2 = ( 0.5g 1g ) (2g) = 1g
                            A3 = ( 0.5g 1g ) (1g + 2g - 1g 0.25 s 0.21 s) = 0.92g
       3 = 0.21 s  0.25 s
8.3. RESPONSE TO GROUND MOTION                                              381

whence the spectral displacements are calculated as:

D1 = 2 A1 = 0.0994 m,  D2 = 2 A2 = 0.0248 m,          D3 = 2 A3 = 0.0102 m
       1                      2                              3

The earthquake excitation factors are given by                 3 = 3 [M]1 = 44.44 kg
1 = 1 [M]1 = 133.33 kg, 2 = 2 [M]1 = -33.33 kg,

so that the peak modal coordinate responses are calculated as

1 = 1 D1 = 0.1491 m,   2 = 2 D2 = -0.0149 m,                   3 = 3 D3 = 0.0030 m
       1                      2                                       3

c) Determine the estimates for the maximum responses:

(i) The maximum top displacement is the maximum relative (to the ground) dis-
   placement of the third floor (i.e. the floor at the top). The time history of this
   displacement is given by

          3() = 311() + 322() + 333()

so that the peak modal top displacements are given by

3(1) = 311 = 0.1491 m, 3(2) = 322 = -0.0149 m, 3(3) = 333 = 0.0010 m

and the estimate we calculate via the SRSS rule for the maximum top displace-

ment is:

                       2        2                     2
          3 = (3(1)) + (3(2)) + (3(3)) = 0.1498 m

Note that this estimate is very close to the estimate we would obtain using only
mode 1, and the error we would make by not including mode 3 is completely
negligible.

(ii) The maximum deformation of the second story columns is governed by the in-
    terstory drift that occurs between the first and second floors. This interstory
    drift is given by

12 = (21 - 11)1() + (22 - 12)2 + (23 - 13)3()
382CHAPTER 8. FORCED VIBRATIONS OF LINEAR MULTI DEGREE OF FREEDOM SYSTEMS

so that peak modal interstory drifts are calculated as

              12 (1) = (21 - 11)1 = 0.0497 m
              12 (2) = (22 - 12)2 = 0 m
              12 (3) = (23 - 13)3 = -0.0051 m

and the SRSS estimate for the maximum interstory drift is given by:

                 2                                   2      2
              12 = (12 (1)) + (12 (2)) + (12 (3)) = 0.050 m

(iii) The base shear is calculated via

               (1)  (2)                               (3)   (1)  (2)       (3)
() = 1 () = 1  +1  ++1  =  ()+ ()+ ()

and we showed previously that for shear building systems the peak modal base
shears may be calculated as

                 ()                          2          2

                                               2          
                  =  D = A
                                                        

so that

(1)      2                              (2)     2                (3)  2

           1                                      2                     3
 = A1 = 1962 N,   = A2 = 196.2 N,                                 = A3 = 120.3 N
         1                                      2                     3

The SRSS estimate for the maximum base shear is therefore given by

              2                              2          2
          = ((1)) + ((2)) + ((3)) = 1975.5 N = 0.86

where  is the total weight of the structure.
