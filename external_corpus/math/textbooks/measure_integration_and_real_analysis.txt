Measure, Integration
  & Real Analysis

                        27 October 2025

            Sheldon Axler

| f g| dµ                 1/p                           1/p

            | f |p dµ                    |g|p dµ

© Sheldon Axler 2020. This book is an open access publication.

    This book is licensed under the terms of the Creative Commons Attribution-NonCommercial 4.0
International License (https://creativecommons.org/licenses/by-nc/4.0), which permits any noncommercial
use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author and the source, provide a link to the Creative Commons license,
and indicate if changes were made.

    The images or other third party material in this book are included in the book's Creative Commons
license, unless indicated otherwise in a credit line to the material. If material is not included in the book's
Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the
permitted use, you will need to obtain permission directly from the copyright holder.

                          The print version of this book appears in
                     Springer's Graduate Texts in Mathematics series.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                    Dedicated to
Paul Halmos, Don Sarason, and Allen Shields,

      the three mathematicians who most
      helped me become a mathematician.

          Measure, Integration & Real Analysis, by Sheldon Axler
         About the Author

Sheldon Axler was valedictorian of his high school in Miami, Florida. He received his
AB from Princeton University with highest honors, followed by a PhD in Mathematics
from the University of California at Berkeley.

   As a postdoctoral Moore Instructor at MIT, Axler received a university-wide
teaching award. He was then an assistant professor, associate professor, and professor
at Michigan State University, where he received the first J. Sutherland Frame Teaching
Award and the Distinguished Faculty Award.

   Axler received the Lester R. Ford Award for expository writing from the Mathe-
matical Association of America in 1996. In addition to publishing numerous research
papers, he is the author of six mathematics textbooks, ranging from freshman to
graduate level. His book Linear Algebra Done Right has been adopted as a textbook
at over 300 universities and colleges.

   Axler has served as Editor-in-Chief of the Mathematical Intelligencer and As-
sociate Editor of the American Mathematical Monthly. He has been a member of
the Council of the American Mathematical Society and a member of the Board of
Trustees of the Mathematical Sciences Research Institute. He has also served on the
editorial board of Springer's series Undergraduate Texts in Mathematics, Graduate
Texts in Mathematics, Universitext, and Springer Monographs in Mathematics.

   He has been honored by appointments as a Fellow of the American Mathematical
Society and as a Senior Fellow of the California Council on Science and Technology.

   Axler joined San Francisco State University as Chair of the Mathematics Depart-
ment in 1997. In 2002, he became Dean of the College of Science & Engineering at
San Francisco State University. After serving as Dean for thirteen years, he returned
to a regular faculty appointment as a professor in the Mathematics Department.

Cover figure: Hölder's Inequality, which is proved in Section 7A.
                                                                                                              vi

                     Measure, Integration & Real Analysis, by Sheldon Axler
               Contents

   About the Author vi

   Preface for Students xiii

   Preface for Instructors xiv

   Acknowledgments xviii

1 Riemann Integration 1
      1A Review: Riemann Integral 2

                  Exercises 1A 7

       1B Riemann Integral Is Not Good Enough 9

                  Exercises 1B 12

2 Measures 13
      2A Outer Measure on R 14

                  Motivation and Definition of Outer Measure 14
                  Good Properties of Outer Measure 15
                  Outer Measure of Closed Bounded Interval 18
                  Outer Measure is Not Additive 21
                  Exercises 2A 23

       2B Measurable Spaces and Functions 25

                   -Algebras 26
                  Borel Subsets of R 28
                  Inverse Images 29
                  Measurable Functions 31
                  Exercises 2B 38

       2C Measures and Their Properties 41

                  Definition and Examples of Measures 41
                  Properties of Measures 42
                  Exercises 2C 45

                                                                                                             vii
                      Measure, Integration & Real Analysis, by Sheldon Axler
viii Contents

      2D Lebesgue Measure 47

                  Additivity of Outer Measure on Borel Sets 47
                  Lebesgue Measurable Sets 52
                  Cantor Set and Cantor Function 55
                  Exercises 2D 60

       2E Convergence of Measurable Functions 62

                  Pointwise and Uniform Convergence 62
                  Egorov's Theorem 63
                  Approximation by Simple Functions 65
                  Luzin's Theorem 66
                  Lebesgue Measurable Functions 69
                  Exercises 2E 71

3 Integration 73

      3A Integration with Respect to a Measure 74

                  Integration of Nonnegative Functions 74
                  Monotone Convergence Theorem 77
                  Integration of Real-Valued Functions 81
                  Exercises 3A 84

       3B Limits of Integrals & Integrals of Limits 88

                  Bounded Convergence Theorem 88
                  Sets of Measure 0 in Integration Theorems 89
                  Dominated Convergence Theorem 90
                  Riemann Integrals and Lebesgue Integrals 93
                  Approximation by Nice Functions 95
                  Exercises 3B 99

4 Differentiation 101

      4A Hardy-Littlewood Maximal Function 102

                  Markov's Inequality 102
                  Vitali Covering Lemma 103
                  Hardy-Littlewood Maximal Inequality 104
                  Exercises 4A 106

       4B Derivatives of Integrals 108

                  Lebesgue Differentiation Theorem 108
                  Derivatives 110
                  Density 112
                  Exercises 4B 115

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                                                           Contents ix

5 Product Measures 116

      5A Products of Measure Spaces 117

                  Products of -Algebras 117
                  Monotone Class Theorem 120
                  Products of Measures 123
                  Exercises 5A 128

       5B Iterated Integrals 129

                  Tonelli's Theorem 129
                  Fubini's Theorem 131
                  Area Under Graph 133
                  Exercises 5B 135

       5C Lebesgue Integration on Rn 136

                  Borel Subsets of Rn 136
                  Lebesgue Measure on Rn 139
                  Volume of Unit Ball in Rn 140
                  Equality of Mixed Partial Derivatives Via Fubini's Theorem 142
                  Exercises 5C 144

6 Banach Spaces 146

      6A Metric Spaces 147

                  Open Sets, Closed Sets, and Continuity 147
                  Cauchy Sequences and Completeness 151
                  Exercises 6A 153

       6B Vector Spaces 155

                  Integration of Complex-Valued Functions 155
                  Vector Spaces and Subspaces 159
                  Exercises 6B 162

       6C Normed Vector Spaces 163

                  Norms and Complete Norms 163
                  Bounded Linear Maps 167
                  Exercises 6C 170

      6D Linear Functionals 172

                  Bounded Linear Functionals 172
                  Discontinuous Linear Functionals 174
                  Hahn-Banach Theorem 177
                  Exercises 6D 181

                      Measure, Integration & Real Analysis, by Sheldon Axler
x Contents

       6E Consequences of Baire's Theorem 184

                  Baire's Theorem 184
                  Open Mapping Theorem and Bounded Inverse Theorem 186
                  Closed Graph Theorem 188
                  Principle of Uniform Boundedness 189
                  Exercises 6E 190

7 Lp Spaces 193
      7A Lp(µ) 194

                  Hölder's Inequality 194
                  Minkowski's Inequality 198
                  Exercises 7A 199

      7B Lp(µ) 202

                  Definition of Lp(µ) 202
                  Lp(µ) Is a Banach Space 204
                  Duality 206
                  Exercises 7B 208

8 Hilbert Spaces 211

      8A Inner Product Spaces 212

                  Inner Products 212
                  Cauchy-Schwarz Inequality and Triangle Inequality 214
                  Exercises 8A 221

       8B Orthogonality 224

                  Orthogonal Projections 224
                  Orthogonal Complements 229
                  Riesz Representation Theorem 233
                  Exercises 8B 234

       8C Orthonormal Bases 237

                  Bessel's Inequality 237
                  Parseval's Identity 243
                  Gram-Schmidt Process and Existence of Orthonormal Bases 245
                  Riesz Representation Theorem, Revisited 250
                  Exercises 8C 251

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                                                             Contents xi

 9 Real and Complex Measures 255

        9A Total Variation 256

                    Properties of Real and Complex Measures 256
                    Total Variation Measure 259
                    The Banach Space of Measures 262
                    Exercises 9A 265

        9B Decomposition Theorems 267

                    Hahn Decomposition Theorem 267
                    Jordan Decomposition Theorem 268
                    Lebesgue Decomposition Theorem 270
                    Radon-Nikodym Theorem 272
                   Dual Space of Lp(µ) 275
                    Exercises 9B 278

10 Linear Maps on Hilbert Spaces 280

      10A Adjoints and Invertibility 281

                    Adjoints of Linear Maps on Hilbert Spaces 281
                    Null Spaces and Ranges in Terms of Adjoints 285
                    Invertibility of Operators 286
                    Exercises 10A 292

       10B Spectrum 294

                    Spectrum of an Operator 294
                    Self-adjoint Operators 299
                    Normal Operators 302
                    Isometries and Unitary Operators 305
                    Exercises 10B 309

       10C Compact Operators 312

                    The Ideal of Compact Operators 312
                    Spectrum of Compact Operator and Fredholm Alternative 316
                    Exercises 10C 323

      10D Spectral Theorem for Compact Operators 326

                    Orthonormal Bases Consisting of Eigenvectors 326
                    Singular Value Decomposition 332
                    Exercises 10D 336

                        Measure, Integration & Real Analysis, by Sheldon Axler
  xii Contents

11 Fourier Analysis 339
      11A Fourier Series and Poisson Integral 340

                    Fourier Coefficients and Riemann-Lebesgue Lemma 340
                    Poisson Kernel 344
                    Solution to Dirichlet Problem on Disk 348
                    Fourier Series of Smooth Functions 350
                    Exercises 11A 352

       11B Fourier Series and Lp of Unit Circle 355

                    Orthonormal Basis for L2 of Unit Circle 355
                    Convolution on Unit Circle 357
                    Exercises 11B 361

       11C Fourier Transform 363

                   Fourier Transform on L1(R) 363
                    Convolution on R 368
                    Poisson Kernel on Upper Half-Plane 370
                    Fourier Inversion Formula 374
                   Extending Fourier Transform to L2(R) 375
                    Exercises 11C 377

12 Probability Measures 380

                    Probability Spaces 381
                    Independent Events and Independent Random Variables 383
                    Variance and Standard Deviation 388
                    Conditional Probability and Bayes' Theorem 390
                    Distribution and Density Functions of Random Variables 392
                    Weak Law of Large Numbers 396
                    Exercises 12 398

    Photo Credits 400

    Bibliography 402

    Notation Index 403

    Index 406

    Colophon: Notes on Typesetting 411

                        Measure, Integration & Real Analysis, by Sheldon Axler
        Preface for Students

You are about to immerse yourself in serious mathematics, with an emphasis on
attaining a deep understanding of the definitions, theorems, and proofs related to
measure, integration, and real analysis. This book aims to guide you to the wonders
of this subject.

   You cannot read mathematics the way you read a novel. If you zip through a page
in less than an hour, you are probably going too fast. When you encounter the phrase
as you should verify, you should indeed do the verification, which will usually require
some writing on your part. When steps are left out, you need to supply the missing
pieces. You should ponder and internalize each definition. For each theorem, you
should seek examples to show why each hypothesis is necessary.

   Working on the exercises should be your main mode of learning after you have
read a section. Discussions and joint work with other students may be especially
effective. Active learning promotes long-term understanding much better than passive
learning. Thus you will benefit considerably from struggling with an exercise and
eventually coming up with a solution, perhaps working with other students. Finding
and reading a solution on the internet will likely lead to little learning.

   As a visual aid, throughout this book definitions are in yellow boxes and theorems
are in blue boxes, in both print and electronic versions. Each theorem has an informal
descriptive name. The electronic version of this manuscript has links in blue.

   Please check the website below (or the Springer website) for additional information
about the book. These websites link to the electronic version of this book, which is
free to the world because this book has been published under Springer's Open Access
program. Your suggestions for improvements and corrections for a future edition are
most welcome (send to the email address below).

   The prerequisite for using this book includes a good understanding of elementary
undergraduate real analysis. You can download from the website below or from the
Springer website the document titled Supplement for Measure, Integration & Real
Analysis. That supplement can serve as a review of the elementary undergraduate real
analysis used in this book.

   Best wishes for success and enjoyment in learning measure, integration, and real
analysis!
Sheldon Axler
Mathematics Department
San Francisco State University
San Francisco, CA 94132, USA
website: https://measure.axler.net
e-mail: measure@axler.net
Twitter: @AxlerLinear

                                                                                                            xiii
                      Measure, Integration & Real Analysis, by Sheldon Axler
      Preface for Instructors

You are about to teach a course, or possibly a two-semester sequence of courses, on
measure, integration, and real analysis. In this textbook, I have tried to use a gentle
approach to serious mathematics, with an emphasis on students attaining a deep
understanding. Thus new material often appears in a comfortable context instead
of the most general setting. For example, the Fourier transform in Chapter 11 is
introduced in the setting of R rather than Rn so that students can focus on the main
ideas without the clutter of the extra bookkeeping needed for working in Rn.

   The basic prerequisite for your students to use this textbook is a good understand-
ing of elementary undergraduate real analysis. Your students can download from the
book's website (https://measure.axler.net) or from the Springer website the document
titled Supplement for Measure, Integration & Real Analysis. That supplement can
serve as a review of the elementary undergraduate real analysis used in this book.

   As a visual aid, throughout this book definitions are in yellow boxes and theorems
are in blue boxes, in both print and electronic versions. Each theorem has an informal
descriptive name. The electronic version of this manuscript has links in blue.

   Mathematics can be learned only by doing. Fortunately, real analysis has many
good homework exercises. When teaching this course, during each class I usually
assign as homework several of the exercises, due the next class. I grade only one
exercise per homework set, but the students do not know ahead of time which one. I
encourage my students to work together on the homework or to come to me for help.
However, I tell them that getting solutions from the internet is not allowed and would
be counterproductive for their learning goals.

   If you go at a leisurely pace, then covering Chapters 1-5 in the first semester may
be a good goal. If you go a bit faster, then covering Chapters 1-6 in the first semester
may be more appropriate. For a second-semester course, covering some subset of
Chapters 6 through 12 should produce a good course. Most instructors will not have
time to cover all those chapters in a second semester; thus some choices need to
be made. The following chapter-by-chapter summary of the highlights of the book
should help you decide what to cover and in what order:
· Chapter 1: This short chapter begins with a brief review of Riemann integration.

   Then a discussion of the deficiencies of the Riemann integral helps motivate the
   need for a better theory of integration.
· Chapter 2: This chapter begins by defining outer measure on R as a natural
   extension of the length function on intervals. After verifying some nice properties
   of outer measure, we see that it is not additive. This observation leads to restricting
   our attention to the -algebra of Borel sets, defined as the smallest -algebra on R
   containing all the open sets. This path leads us to measures.

                                                                                                            xiv
                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                                        Preface for Instructors xv

   After dealing with the properties of general measures, we come back to the setting
   of R, showing that outer measure restricted to the -algebra of Borel sets is
   countably additive and thus is a measure. Then a subset of R is defined to be
   Lebesgue measurable if it differs from a Borel set by a set of outer measure 0. This
   definition makes Lebesgue measurable sets seem more natural to students than the
   other competing equivalent definitions. The Cantor set and the Cantor function
   then stretch students' intuition.
   Egorov's Theorem, which states that pointwise convergence of a sequence of
   measurable functions is close to uniform convergence, has multiple applications in
   later chapters. Luzin's Theorem, back in the context of R, sounds spectacular but
   has no other uses in this book and thus can be skipped if you are pressed for time.
· Chapter 3: Integration with respect to a measure is defined in this chapter in a
   natural fashion first for nonnegative measurable functions, and then for real-valued
   measurable functions. The Monotone Convergence Theorem and the Dominated
   Convergence Theorem are the big results in this chapter that allow us to interchange
   integrals and limits under appropriate conditions.
· Chapter 4: The highlight of this chapter is the Lebesgue Differentiation Theorem,
   which allows us to differentiate an integral. The main tool used to prove this
   result cleanly is the Hardy-Littlewood maximal inequality, which is interesting
   and important in its own right. This chapter also includes the Lebesgue Density
   Theorem, showing that a Lebesgue measurable subset of R has density 1 at almost
   every number in the set and density 0 at almost every number not in the set.
· Chapter 5: This chapter deals with product measures. The most important results
   here are Tonelli's Theorem and Fubini's Theorem, which allow us to evaluate
   integrals with respect to product measures as iterated integrals and allow us to
   change the order of integration under appropriate conditions. As an application of
   product measures, we get Lebesgue measure on Rn from Lebesgue measure on R.
   To give students practice with using these concepts, this chapter finds a formula for
   the volume of the unit ball in Rn. The chapter closes by using Fubini's Theorem to
   give a simple proof that a mixed partial derivative with sufficient continuity does
   not depend on the order of differentiation.
· Chapter 6: After a quick review of metric spaces and vector spaces, this chapter
   defines normed vector spaces. The big result here is the Hahn-Banach Theorem
   about extending bounded linear functionals from a subspace to the whole space.
   Then this chapter introduces Banach spaces. We see that completeness plays
   a major role in the key theorems: Open Mapping Theorem, Bounded Inverse
   Theorem, Closed Graph Theorem, and Principle of Uniform Boundedness.
· Chapter 7: This chapter introduces the important class of Banach spaces Lp(µ),
  where 1  p   and µ is a measure, giving students additional opportunities to
   use results from earlier chapters about measure and integration theory. The crucial
   results called Hölder's inequality and Minkowski's inequality are key tools here.
  This chapter also shows that the dual of p is p for 1  p < .
   Chapters 1 through 7 should be covered in order, before any of the later chapters.
   After Chapter 7, you can cover Chapter 8 or Chapter 12.

                     Measure, Integration & Real Analysis, by Sheldon Axler
xvi Preface for Instructors

· Chapter 8: This chapter focuses on Hilbert spaces, which play a central role in
   modern mathematics. After proving the Cauchy-Schwarz inequality and the Riesz
   Representation Theorem that describes the bounded linear functionals on a Hilbert
   space, this chapter deals with orthonormal bases. Key results here include Bessel's
   inequality, Parseval's identity, and the Gram-Schmidt process.

· Chapter 9: Only positive measures have been discussed in the book up until this
   chapter. In this chapter, real and complex measures get consideration. These con-
   cepts lead to the Banach space of measures, with total variation as the norm. Key
   results that help describe real and complex measures are the Hahn Decomposition
   Theorem, the Jordan Decomposition Theorem, and the Lebesgue Decomposition
   Theorem. The Radon-Nikodym Theorem is proved using von Neumann's slick
   Hilbert space trick. Then the Radon-Nikodym Theorem is used to prove that the
   dual of Lp(µ) can be identified with Lp(µ) for 1 < p <  and µ a (positive)
   measure, completing a project that started in Chapter 7.
   The material in Chapter 9 is not used later in the book. Thus this chapter can be
   skipped or covered after one of the later chapters.

· Chapter 10: This chapter begins by discussing the adjoint of a bounded linear
   map between Hilbert spaces. Then the rest of the chapter presents key results
   about bounded linear operators from a Hilbert space to itself. The proof that each
   bounded operator on a complex nonzero Hilbert space has a nonempty spectrum
   requires a tiny bit of knowledge about analytic functions. Properties of special
   classes of operators (self-adjoint operators, normal operators, isometries, and
   unitary operators) are described.
   Then this chapter delves deeper into compact operators, proving the Fredholm
   Alternative. The chapter concludes with two major results: the Spectral Theorem
   for compact operators and the popular Singular Value Decomposition for compact
   operators. Throughout this chapter, the Volterra operator is used as an example to
   illustrate the main results.
   Some instructors may prefer to cover Chapter 10 immediately after Chapter 8,
   because both chapters live in the context of Hilbert space. I chose the current order
   to give students a breather between the two Hilbert space chapters, thinking that
   being away from Hilbert space for a little while and then coming back to it might
   strengthen students' understanding and provide some variety. However, covering
   the two Hilbert space chapters consecutively would also work fine.

· Chapter 11: Fourier analysis is a huge subject with a two-hundred year history.
   This chapter gives a gentle but modern introduction to Fourier series and the
   Fourier transform.
   This chapter first develops results in the context of Fourier series, but then comes
   back later and develops parallel concepts in the context of the Fourier transform.
   For example, the Fourier coefficient version of the Riemann-Lebesgue Lemma is
   proved early in the chapter, with the Fourier transform version proved later in the
   chapter. Other examples include the Poisson kernel, convolution, and the Dirichlet
   problem, all of which are first covered in the context of the unit disk and unit circle;
   then these topics are revisited later in the context of the half-plane and real line.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                                       Preface for Instructors xvii

   Convergence of Fourier series is proved in the L2 norm and also (for sufficiently
   smooth functions) pointwise. The book emphasizes getting students to work with
   the main ideas rather than on proving all possible results (for example, pointwise
   convergence of Fourier series is proved only for twice continuously differentiable
   functions rather than using a weaker hypothesis).
   The proof of the Fourier Inversion Formula is the highlight of the material on the
   Fourier transform. The Fourier Inversion Formula is then used to show that the
   Fourier transform extends to a unitary operator on L2(R).
   This chapter uses some basic results about Hilbert spaces, so it should not be
   covered before Chapter 8. However, if you are willing to skip or hand-wave
   through one result that helps describe the Fourier transform as an operator on
   L2(R) (see 11.87), then you could cover this chapter without doing Chapter 10.
· Chapter 12: A thorough coverage of probability theory would require a whole
   book instead of a single chapter. This chapter takes advantage of the book's earlier
   development of measure theory to present the basic language and emphasis of
   probability theory. For students not pursuing further studies in probability theory,
   this chapter gives them a good taste of the subject. Students who go on to learn
   more probability theory should benefit from the head start provided by this chapter
   and the background of measure theory.
   Features that distinguish probability theory from measure theory include the
   notions of independent events and independent random variables. In addition to
   those concepts, this chapter discusses standard deviation, conditional probabilities,
   Bayes' Theorem, and distribution functions. The chapter concludes with a proof of
   the Weak Law of Large Numbers for independent identically distributed random
   variables.
  You could cover this chapter anytime after Chapter 7.

   Please check the website below (or the Springer website) for additional information
about the book. These websites link to the electronic version of this book, which is
free to the world because this book has been published under Springer's Open Access
program. Your suggestions for improvements and corrections for a future edition are
most welcome (send to the email address below).

   I enjoy keeping track of where my books are used as textbooks. If you use this
book as the textbook for a course, please let me know.

   Best wishes for teaching a successful class on measure, integration, and real
analysis!

Sheldon Axler                       Contact the author, or Springer if
Mathematics Department              the author is not available, for
San Francisco State University      permission for translations or other
San Francisco, CA 94132, USA        commercial re-use of the contents of
website: https://measure.axler.net  this book.
e-mail: measure@axler.net
Twitter: @AxlerLinear

Measure, Integration & Real Analysis, by Sheldon Axler
         Acknowledgments

I owe a huge intellectual debt to the many mathematicians who created real analysis
over the past several centuries. The results in this book belong to the common heritage
of mathematics. A special case of a theorem may first have been proved by one
mathematician and then sharpened and improved by many other mathematicians.
Bestowing accurate credit for all the contributions would be a difficult task that I have
not undertaken. In no case should the reader assume that any theorem presented here
represents my original contribution. However, in writing this book I tried to think
about the best way to present real analysis and to prove its theorems, without regard
to the standard methods and proofs used in most textbooks.

   The manuscript for this book received an unusually large amount of class testing
at several universities before publication. Thus I received many valuable suggestions
for improvements and corrections. I am deeply grateful to all the faculty and students
who helped class test the manuscript. I implemented suggestions or corrections from
the following people, all of whom helped make this a better book:

     Sunayan Acharya, Ali Al Setri, Nick Anderson, Aruna Bandara, Kevin Bui,
     Tony Cairatt, Eric Carmody, Timmy Chan, Felix Chern, Logan Clark, Sam
     Coskey, Yerbolat Dauletyarov, Evelyn Easdale, Adam Frank, Ben French,
     Loukas Grafakos, Gary Griggs, Michael Hanson, Michah Hawkins, Eric
     Hayashi, Nelson Huang, Jasim Ismaeel, Brody Johnson, William Jones,
     Mohsen Kalhori, Hannah Knight, Oliver Knitter, Chun-Kit Lai, Lee Larson,
     Vens Lee, Hua Lin, David Livnat, Shi Hao Looi, Dante Luber, Largo Luong,
     Stephanie Magallanes, Jan Mandel, Juan Manfredi, Zack Mayfield, Cesar
     Meza, Caleb Nastasi, Lamson Nguyen, Kiyoshi Okada, Curtis Olinger,
     Célio Passos, Linda Patton, Isabel Perez, Ricardo Pires, Hal Prince, Noah
     Rhee, Ken Ribet, Spenser Rook, Arnab Dey Sarkar, Wayne Small, Emily
     Smith, Jure Taslak, Keith Taylor, Ignacio Uriarte-Tuero, Alexander
     Wittmond, Run Yan, Edward Zeng.
   Loretta Bartolini, Mathematics Editor at Springer, is owed huge thanks for her
multiple major contributions to this project. Paula Francis, the copy editor for this
book, provided numerous useful suggestions and corrections that improved the book.
   Thanks also to the people who allowed photographs they produced to enhance this
book. For a complete list, see the Photo Credits pages near the end of the book.
   Special thanks to my wonderful partner Carrie Heeter, whose understanding and
encouragement enabled me to work intensely on this book. Our cat Moon, whose
picture is on page 44, helped provide relaxing breaks.

                                                                                   Sheldon Axler
                                                                                                           xviii

                     Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 1

       Riemann Integration

This brief chapter reviews Riemann integration. Riemann integration uses rectangles
to approximate areas under graphs. This chapter begins by carefully presenting
the definitions leading to the Riemann integral. The big result in the first section
states that a continuous real-valued function on a closed bounded interval is Riemann
integrable. The proof depends on the theorem that continuous functions on closed
bounded intervals are uniformly continuous.

   The second section of this chapter focuses on several deficiencies of Riemann
integration. As we will see, Riemann integration does not do everything we would
like an integral to do. These deficiencies provide motivation in future chapters for the
development of measures and integration with respect to measures.

                  Digital sculpture of Bernhard Riemann (1826-1866),
               whose method of integration is taught in calculus courses.

                                                              ©Doris Fiebig

                                                                                                               1
                     Measure, Integration & Real Analysis, by Sheldon Axler
2 Chapter 1 Riemann Integration

1A Review: Riemann Integral

We begin with a few definitions needed before we can define the Riemann integral.
Let R denote the complete ordered field of real numbers.

  1.1 Definition partition
  Suppose a, b  R with a < b. A partition of [a, b] is a finite list of the form
  x0, x1, . . . , xn, where

                              a = x0 < x1 < · · · < xn = b.
   We use a partition x0, x1, . . . , xn of [a, b] to think of [a, b] as a union of closed
subintervals, as follows:

                     [a, b] = [x0, x1]  [x1, x2]  · · ·  [xn-1, xn].
   The next definition introduces clean notation for the infimum and supremum of
the values of a function on some subset of its domain.

1.2 Definition notation for infimum and supremum of a function

If f is a real-valued function and A is a subset of the domain of f , then

inf f = inf{ f (x) : x  A} and sup f = sup{ f (x) : x  A}.
A                                   A

   The lower and upper Riemann sums, which we now define, approximate the
area under the graph of a nonnegative function (or, more generally, the signed area
corresponding to a real-valued function).

1.3 Definition lower and upper Riemann sums

Suppose f : [a, b]  R is a bounded function and P is a partition x0, . . . , xn
of [a, b]. The lower Riemann sum L( f , P, [a, b]) and the upper Riemann sum
U( f , P, [a, b]) are defined by

                                 n
   L( f , P, [a, b]) =  (xj - xj-1) inf f
   j=1                                       [xj-1, xj]

and n
   U( f , P, [a, b]) =  (xj - xj-1) sup f .
   j=1                                       [xj-1, xj]

   Our intuition suggests that for a partition with only a small gap between consecu-
tive points, the lower Riemann sum should be a bit less than the area under the graph,
and the upper Riemann sum should be a bit more than the area under the graph.

   Measure, Integration & Real Analysis, by Sheldon Axler
                                                            Section 1A Review: Riemann Integral 3

   The pictures in the next example help convey the idea of these approximations.
The base of the jth rectangle has length xj - xj-1 and has height inf f for the

                                                                                                      [xj-1, xj]

lower Riemann sum and height sup f for the upper Riemann sum.

                                                [xj-1, xj]

1.4 Example lower and upper Riemann sums

Define       f    :  [0, 1]             R    by   f (x)  =    x2.  Let     Pn       denote    the   partition      0,  1,       2  ,  .  .  .  ,  1
                                                                                                                                n
of [0, 1].                                                                                                             n

                                             The two figures here show
                                             the graph of f in red. The
                                             infimum of this function f
                                             is attained at the left end-
                                             point of each subinterval

                                              j-1 j

                                             [ n , n ]; the supremum is
                                             attained at the right end-
                                             point.

 L(x2, P16, [0, 1]) is the                                                                  U(x2, P16, [0, 1]) is the
sum of the areas of these                                                                   sum of the areas of these

        rectangles.                                                                                 rectangles.

For     the  partition             Pn,  we   have  xj    -  xj-1    =      1  for   each      j  =  1, . . . , n.  Thus
                                                                           n

                              2                          1 n (j - 1)2 2n2 - 3n + 1
                           L(x , Pn, [0, 1]) =  2 =
                                                         n j=1 n                                 6n  2

2 and 1 n j2 2n2 + 3n + 1
                              U(x , Pn, [0, 1]) =  2 =                                           2,
                                                              n j=1 n                      6n

                                                                                                 2 n(2n2+3n+1)
as you should verify [use the formula 1 + 4 + 9 + · · · + n =                                                 6 ].

   The next result states that adjoining more points to a partition increases the lower
Riemann sum and decreases the upper Riemann sum.

1.5 inequalities with Riemann sums

Suppose f : [a, b]  R is a bounded function and P, P are partitions of [a, b]
such that the list defining P is a sublist of the list defining P. Then

      L( f , P, [a, b])  L( f , P, [a, b])  U( f , P, [a, b])  U( f , P, [a, b]).

Proof To prove the first inequality, suppose P is the partition x0, . . . , xn and P is the
partition   x0 ,  .  .  .  ,  x    of   [a,  b].  For   each  j     1,  .  .  .  ,  n,  there    exist  k    {0,   .   .  .  ,  N           1}
                                                                 =                                                                    -
                                N
and  a  positive     integer       m    such      that  xj-1  =    x    <     x         <  ·  ·  ·  <   x     =    xj.       We          have

                                                                     k         k+1                       k+m

                           Measure, Integration & Real Analysis, by Sheldon Axler
4 Chapter 1 Riemann Integration

                               m
(xj - xj-1)  inf         f      (xk +i     x )     inf         f
             [xj-1, xj]     =           -          [xj-1, xj]
                                            k+i-1
                               i=1

                               m
                              (xk+i - xk+i-1)  inf  f .

                               i=1                 [xk+i-1, xk+i]

The inequality above implies that L( f , P, [a, b])  L( f , P, [a, b]).
   The middle inequality in this result follows from the observation that the infimum

of each nonempty set of real numbers is less than or equal to the supremum of that
set.

   The proof of the last inequality in this result is similar to the proof of the first
inequality and is left to the reader.

   The following result states that if the function is fixed, then each lower Riemann
sum is less than or equal to each upper Riemann sum.

  1.6 lower Riemann sums  upper Riemann sums

  Suppose f : [a, b]  R is a bounded function and P, P are partitions of [a, b].
  Then

                             L( f , P, [a, b])  U( f , P, [a, b]).

Proof Let P be the partition of [a, b] obtained by merging the lists that define P
and P. Then

                             L( f , P, [a, b])  L( f , P, [a, b])
                                               U( f , P, [a, b])
                                               U( f , P, [a, b]),

where all three inequalities above come from 1.5.

   We have been working with lower and upper Riemann sums. Now we define the
lower and upper Riemann integrals.

1.7 Definition lower and upper Riemann integrals

Suppose f : [a, b]  R is a bounded function. The lower Riemann integral
L( f , [a, b]) and the upper Riemann integral U( f , [a, b]) of f are defined by

                           L( f , [a, b]) = sup L( f , P, [a, b])

                                                               P

and
                          U( f , [a, b]) = inf U( f , P, [a, b]),

                                                              P

where the supremum and infimum above are taken over all partitions P of [a, b].

Measure, Integration & Real Analysis, by Sheldon Axler
                     Section 1A Review: Riemann Integral 5

   In the definition above, we take the supremum (over all partitions) of the lower
Riemann sums because adjoining more points to a partition increases the lower
Riemann sum (by 1.5) and should provide a more accurate estimate of the area under
the graph. Similarly, in the definition above, we take the infimum (over all partitions)
of the upper Riemann sums because adjoining more points to a partition decreases
the upper Riemann sum (by 1.5) and should provide a more accurate estimate of the
area under the graph.

   Our first result about the lower and upper Riemann integrals is an easy inequality.

  1.8 lower Riemann integral  upper Riemann integral
  Suppose f : [a, b]  R is a bounded function. Then

                                 L( f , [a, b])  U( f , [a, b]).
Proof The desired inequality follows from the definitions and 1.6.

   The lower Riemann integral and the upper Riemann integral can both be reasonably
considered to be the area under the graph of a function. Which one should we use?
The pictures in Example 1.4 suggest that these two quantities are the same for the
function in that example; we will soon verify this suspicion. However, as we will see
in the next section, there are functions for which the lower Riemann integral does not
equal the upper Riemann integral.

   Instead of choosing between the lower Riemann integral and the upper Riemann
integral, the standard procedure in Riemann integration is to consider only functions
for which those two quantities are equal. This decision has the huge advantage of
making the Riemann integral behave as we wish with respect to the sum of two
functions (see Exercise 4 in this section).

1.9 Definition Riemann integrable; Riemann integral

· A bounded function on a closed bounded interval is called Riemann
   integrable if its lower Riemann integral equals its upper Riemann integral.

· If f : [a, b]  R is Riemann integrable, then the Riemann integral   b

defined by                                                              f is

                                                                     a

                  b

                    f = L( f , [a, b]) = U( f , [a, b]).

                 a

Let Z denote the set of integers and Z+ denote the set of positive integers.

1.10 Example computing a Riemann integral
   Define f : [0, 1]  R by f (x) = x2. Then

U( f , [0, 1])  inf 2 2n = = 2 + 3n + 1 1 sup 2 2n  2 - 3n + 1 L( f , [0, 1]),
            nZ+  6n  3 nZ+                   6n

Measure, Integration & Real Analysis, by Sheldon Axler
6 Chapter 1 Riemann Integration

where the two inequalities above come from Example 1.4 and the two equalities
easily follow from dividing the numerators and denominators of both fractions above
by n2.
The paragraph above shows that
U( f , [0, 1])  3  L( f , [0, 1]). When1              Our definition of Riemann

combined with 1.8, this shows that integration is actually a small
L( f , [0, 1])      U( f , [0, 1])      1.  Thus      modification of Riemann's definition
                =                   =
                                        3             that was proposed by Gaston
f is Riemann integrable and
                                                      Darboux (1842-1917).

                    1 0 f = 13 .

   Now we come to a key result regarding Riemann integration. Uniform continuity
provides the major tool that makes the proof work.

1.11 continuous functions are Riemann integrable

Every continuous real-valued function on each closed bounded interval is
Riemann integrable.

Proof Suppose a, b  R with a < b and f : [a, b]  R is a continuous function
(thus by a standard theorem from undergraduate real analysis, f is bounded and is
uniformly continuous). Let  > 0. Because f is uniformly continuous, there exists
 > 0 such that

1.12               | f (s) - f (t)| <  for all s, t  [a, b] with |s - t| < .

Let  n    Z+    be  such  that  b-a  <  .
                                 n
Let P be the equally spaced partition a = x0, x1, . . . , xn = b of [a, b] with

                                        xj - xj-1 = b - a n

for each j = 1, . . . , n. Then

          U( f , [a, b]) - L( f , [a, b])  U( f , P, [a, b]) - L( f , P, [a, b])

                                               b-a n
                                            =          sup f - inf f
                                                  n j=1 [xj-1, xj]     [xj-1, xj]

                                             (b - a),

where the first line follows from the definitions of U( f , [a, b]) and L( f , [a, b]) and
the last line follows from 1.12.

   We have shown that U( f , [a, b]) - L( f , [a, b])  (b - a) for all  > 0. Thus
1.8 implies that L( f , [a, b]) = U( f , [a, b]). Hence f is Riemann integrable.

An alternative notation for a f is a f (x) dx. Here x is a dummy variable, sobb

we could also write a f (t) dt or use another variable. This notation becomes usefulb

when we want to write something like           1  x2  dx  instead  of  using  function  notation.
                                               0

                    Measure, Integration & Real Analysis, by Sheldon Axler
                            Section 1A Review: Riemann Integral 7

The next result gives a frequently used estimate for a Riemann integral.

1.13 bounds on Riemann integral

Suppose f : [a, b]  R is Riemann integrable. Then

                                    b
(b - a) inf f  f  (b - a) sup f
              [a, b]             a
                                                      [a, b]

Proof Let P be the trivial partition a = x0, x1 = b. Then

                                                                 b
(b - a) inf f = L( f , P, [a, b])  L( f , [a, b]) = f ,
[a, b]                                                        a

proving the first inequality in the result.
   The second inequality in the result is proved similarly and is left to the reader.

EXERCISES 1A

1 Suppose f : [a, b]  R is a bounded function such that
                                L( f , P, [a, b]) = U( f , P, [a, b])

    for some partition P of [a, b]. Prove that f is a constant function on [a, b].
2 Suppose a  s < t  b. Define f : [a, b]  R by

                                  f (x) = 1 if s < x < t, 0 otherwise.

                                                                                             b

    Prove that f is Riemann integrable on [a, b] and that a f = t - s.
3 Suppose f : [a, b]  R is a bounded function. Prove that f is Riemann inte-

    grable if and only if for each  > 0, there exists a partition P of [a, b] such that

U( f , P, [a, b]) - L( f , P, [a, b]) < .

4 Suppose f , g : [a, b]  R are Riemann integrable. Prove that f + g is Riemann
    integrable on [a, b] and

                 b                        b           b
                    ( f + g) = f + g.
              a                        a           a

5 Suppose f : [a, b]  R is Riemann integrable. Prove that the function - f is
    Riemann integrable on [a, b] and

                         b                      b
                            (- f ) = - f .
                      a                      a

Measure, Integration & Real Analysis, by Sheldon Axler
8 Chapter 1 Riemann Integration

6 Suppose f : [a, b]  R is Riemann integrable. Suppose g : [a, b]  R is a
    function such that g(x) = f (x) for all except finitely many x  [a, b]. Prove
    that g is Riemann integrable on [a, b] and

                                    b           b
                                       g = f.
                                 a           a

7 Suppose f : [a, b]  R is a bounded function. For n  Z+, let Pn denote the
    partition that divides [a, b] into 2n intervals of equal size. Prove that

L( f , [a, b]) = lim L( f , Pn, [a, b]) and U( f , [a, b]) = lim U( f , Pn, [a, b]).
            n                                                       n

8 Suppose f : [a, b]  R is Riemann integrable. Prove that

                     b              b-a n                   j(b-a)
                        f = lim               f a+ n .
                     a n n j=1

9 Suppose f : [a, b]  R is Riemann integrable. Prove that if c, d  R and
    a  c < d  b, then f is Riemann integrable on [c, d].
    [To say that f is Riemann integrable on [c, d] means that f with its domain
    restricted to [c, d] is Riemann integrable.]

10 Suppose f : [a, b]  R is a bounded function and c  (a, b). Prove that f is
Riemann integrable on [a, b] if and only if f is Riemann integrable on [a, c] and
f is Riemann integrable on [c, b]. Furthermore, prove that if these conditions
hold, then
                           b              c              b
                              f = f + f.
                        a              a              c

11 Suppose f : [a, b]  R is Riemann integrable. Define F : [a, b]  R by

                                             if t = a,
                                 0           if t  (a, b].
                        F(t) =  t f

                                          a

Prove that F is continuous on [a, b].

12 Suppose f : [a, b]  R is Riemann integrable. Prove that | f | is Riemann
integrable and that
                                    b           b
                                       f  | f |.
                                 a           a

13 Suppose f : [a, b]  R is an increasing function, meaning that c, d  [a, b] with
      c < d implies f (c)  f (d). Prove that f is Riemann integrable on [a, b].

14 Suppose f1, f2, . . . is a sequence of Riemann integrable functions on [a, b] such
      that f1, f2, . . . converges uniformly on [a, b] to a function f : [a, b]  R. Prove
      that f is Riemann integrable and

                              b                    b
                                 f = lim fn.
                           a           n a

            Measure, Integration & Real Analysis, by Sheldon Axler
Section 1B Riemann Integral Is Not Good Enough 9

1B Riemann Integral Is Not Good Enough

The Riemann integral works well enough to be taught to millions of calculus students
around the world each year. However, the Riemann integral has several deficiencies.
In this section, we discuss the following three issues:

  · Riemann integration does not handle functions with many discontinuities;
  · Riemann integration does not handle unbounded functions;
  · Riemann integration does not work well with limits.
In Chapter 2, we will start to construct a theory to remedy these problems.
   We begin with the following example of a function that is not Riemann integrable.

1.14 Example a function that is not Riemann integrable
   Define f : [0, 1]  R by

f (x) = 1 if x is rational, 0 if x is irrational.

If [a, b]  [0, 1] with a < b, then

inf f = 0 and sup f = 1
[a, b]
                                        [a, b]

because [a, b] contains an irrational number and contains a rational number. Thus
L( f , P, [0, 1]) = 0 and U( f , P, [0, 1]) = 1 for every partition P of [0, 1]. Hence
L( f , [0, 1]) = 0 and U( f , [0, 1]) = 1. Because L( f , [0, 1]) = U( f , [0, 1]), we
conclude that f is not Riemann integrable.

   This example is disturbing because (as we will see later), there are far fewer
rational numbers than irrational numbers. Thus f should, in some sense, have
integral 0. However, the Riemann integral of f is not defined.

   Trying to apply the definition of the Riemann integral to unbounded functions
would lead to undesirable results, as shown in the next example.

1.15 Example Riemann integration does not work with unbounded functions

Define f : [0, 1]  R by

f (x) = 1x if 0 < x  1,
           0 if x = 0.

If x0, x1, . . . , xn is a partition of [0, 1], then sup f = . Thus if we tried to apply

                                                                   [x0, x1]

the definition of the upper Riemann sum to f , we would have U( f , P, [0, 1]) = 
for every partition P of [0, 1].

   However, we should consider the area under the graph of f to be 2, not , because

lim 1 f = lim(2 - 2a) = 2.
a0 a                                a0

Measure, Integration & Real Analysis, by Sheldon Axler
10 Chapter 1 Riemann Integration

Calculus courses deal with the previous example by defining            1 1 dx to be

       1                                                               0x
       a
lima0     1x  dx.  If  using  this  approach     and

                              f (x) =  +  ,   1       1

                                              x 1-x

                                      1

then we would define 0 f to be

                                         1/2          b
                              lim             f + lim f .
                              a0 a               b1 1/2

However, the idea of taking Riemann integrals over subdomains and then taking
limits can fail with more complicated functions, as shown in the next example.

1.16 Example area seems to make sense, but Riemann integral is not defined

   Let r1, r2, . . . be a sequence that includes each rational number in (0, 1) exactly
once and that includes no other numbers. For k  Z+, define fk : [0, 1]  R by

                                                      if x > rk,
                                         1            if x  rk.
                              fk(x) = x-rk
                                        0

Define f : [0, 1]  [0, ] by

                                                    fk(x)

                                         f (x) =  k .

                                                  k=1 2

Because every nonempty open subinterval of [0, 1] contains a rational number, the
function f is unbounded on every such subinterval. Thus the Riemann integral of f
is undefined on every subinterval of [0, 1] with more than one element.

   However, the area under the graph of each fk is less than 2. The formula defining
f then shows that we should expect the area under the graph of f to be less than 2
rather than undefined.

   The next example shows that the pointwise limit of a sequence of Riemann
integrable functions bounded by 1 need not be Riemann integrable.

1.17 Example Riemann integration does not work well with pointwise limits

   Let r1, r2, . . . be a sequence that includes each rational number in [0, 1] exactly
once and that includes no other numbers. For k  Z+, define fk : [0, 1]  R by

                                              if x  {r1, . . . , rk},
                                 1            otherwise.
                       fk(x) = 0

                                                                   1

Then each fk is Riemann integrable and 0 fk = 0, as you should verify.

              Measure, Integration & Real Analysis, by Sheldon Axler
          Section 1B Riemann Integral Is Not Good Enough 11

Define f : [0, 1]  R by

          f (x) = 1 if x is rational, 0 if x is irrational.

Clearly   lim fk(x) = f (x) for each x  [0, 1].

          k

However, f is not Riemann integrable (see Example 1.14) even though f is the
pointwise limit of a sequence of integrable functions bounded by 1.

   Because analysis relies heavily on limits, a good theory of integration should allow
for interchange of limits and integrals, at least when the functions are appropriately
bounded. Thus the previous example points out a serious deficiency in Riemann
integration.

   Now we come to a positive result, but as we will see, even this result indicates that
Riemann integration has some problems.

1.18 interchanging Riemann integral and limit

Suppose a, b, M  R with a < b. Suppose f1, f2, . . . is a sequence of Riemann
integrable functions on [a, b] such that

                                      | fk(x)|  M
for all k  Z+ and all x  [a, b]. Suppose limk fk(x) exists for each
x  [a, b]. Define f : [a, b]  R by

                         f (x) = lim fk(x).

                                     k

If f is Riemann integrable on [a, b], then

                            b               b
                               f = lim fk.
                         a     k a

The result above suffers from two problems. The first problem is the undesirable
hypothesis that the limit function f is Riemann integrable. Ideally, that property
would follow from the other hypotheses, but Example 1.17 shows that this need not
be true.
   The second problem with the result
above is that its proof seems to be more    The difficulty in finding a simple

intricate than the proofs of other results Riemann-integration-based proof of
involving Riemann integration. We do not the result above suggests that
give a proof here of the result above. A Riemann integration is not the ideal
clean proof of a stronger result is given in theory of integration.
Chapter 3, using the tools of measure theory that we develop starting with the next
chapter.

          Measure, Integration & Real Analysis, by Sheldon Axler
12 Chapter 1 Riemann Integration

EXERCISES 1B

1 Define f : [0, 1]  R as follows:

             if a is irrational,
         0
f (a) = 1    if a is rational and n is the smallest positive integer
          n  such       that  a        m  for  some  integer                        m.
                                    =  n

                                                                                 1

Show that f is Riemann integrable and compute 0 f .

2 Suppose f : [a, b]  R is a bounded function. Prove that f is Riemann inte-
    grable if and only if

                        L(- f , [a, b]) = -L( f , [a, b]).

3 Suppose f , g : [a, b]  R are bounded functions. Prove that

L( f , [a, b]) + L(g, [a, b])  L( f + g, [a, b])

    and
                       U( f + g, [a, b])  U( f , [a, b]) + U(g, [a, b]).

4 Give an example of bounded functions f , g : [0, 1]  R such that

L( f , [0, 1]) + L(g, [0, 1]) < L( f + g, [0, 1])

    and
                       U( f + g, [0, 1]) < U( f , [0, 1]) + U(g, [0, 1]).

5 Give an example of a sequence of continuous real-valued functions f1, f2, . . .
    on [0, 1] and a continuous real-valued function f on [0, 1] such that

                        f (x) = lim fk(x)

                                    k

for each x  [0, 1] but           1             1

                                    f = lim fk.
                              0           k 0

Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 2

              Measures

The last section of the previous chapter discusses several deficiencies of Riemann
integration. To remedy those deficiencies, in this chapter we extend the notion of the
length of an interval to a larger collection of subsets of R. This leads us to measures
and then in the next chapter to integration with respect to measures.

   We begin this chapter by investigating outer measure, which looks promising but
fails to have a crucial property. That failure leads us to -algebras and measurable
spaces. Then we define measures in an abstract context that can be applied to settings
more general than R. Next, we construct Lebesgue measure on R as our desired
extension of the notion of the length of an interval.

Fifth-century AD Roman ceiling mosaic in what is now a UNESCO World Heritage
site in Ravenna, Italy. Giuseppe Vitali, who in 1905 proved result 2.18 in this chapter,

 was born and grew up in Ravenna, where perhaps he saw this mosaic. Could the
memory of the translation-invariant feature of this mosaic have suggested to Vitali

            the translation invariance that is the heart of his proof of 2.18?

                                                      CC-BY-SA Petar Milosevic´

                                                                                                             13
                     Measure, Integration & Real Analysis, by Sheldon Axler
14 Chapter 2 Measures

2A Outer Measure on R

Motivation and Definition of Outer Measure

The Riemann integral arises from approximating the area under the graph of a function
by sums of the areas of approximating rectangles. These rectangles have heights that
approximate the values of the function on subintervals of the function's domain. The
width of each approximating rectangle is the length of the corresponding subinterval.
This length is the term xj - xj-1 in the definitions of the lower and upper Riemann
sums (see 1.3).

   To extend integration to a larger class of functions than the Riemann integrable
functions, we will write the domain of a function as the union of subsets more
complicated than the subintervals used in Riemann integration. We will need to
assign a size to each of those subsets, where the size is an extension of the length of
intervals.

   For example, we expect the size of the set (1, 3)  (7, 10) to be 5 (because the
first interval has length 2, the second interval has length 3, and 2 + 3 = 5).

   Assigning a size to subsets of R that are more complicated than unions of open
intervals becomes a nontrivial task. This chapter focuses on that task and its extension
to other contexts. In the next chapter, we will see how to use the ideas developed in
this chapter to create a rich theory of integration.

   We begin by giving the expected definition of the length of an open interval, along
with a notation for that length.

2.1 Definition length of open interval; (I)

The length (I) of an open interval I is defined by

                if I = (a, b) for some a, b  R with a < b,
         b - a  if I = ,
                if I = (-, a) or I = (a, ) for some a  R,
(I) = 0         if I = (-, ).
         
         

            

   Suppose A  R. The size of A should be at most the sum of the lengths of a
sequence of open intervals whose union contains A. Taking the infimum of all such
sums gives a reasonable definition of the size of A, denoted |A| and called the outer
measure of A.

2.2 Definition outer measure; |A|

The outer measure |A| of a set A  R is defined by

                                                        
|A| = inf  (Ik) : I1, I2, . . . are open intervals such that A  Ik .
k=1                                                     k=1

Measure, Integration & Real Analysis, by Sheldon Axler
                                                  Section 2A Outer Measure on R 15

The    definition   of  outer  measure     involves  an  infinite   sum.  The     infinite  sum       tk

                                                                                                 k=1
of a sequence t1, t2, . . . of elements of [0, ] is defined to be  if some tk = .
Otherwise,          tk  is  defined  to  be  the  limit  (possibly    )  of  the  increasing  sequence

               k=1
t1, t1 + t2, t1 + t2 + t3, . . . of partial sums; thus

                                                           n
                                      tk = lim  tk.
                                     k=1 n k=1

2.3 Example finite sets have outer measure 0
   Suppose A = {a1, . . . , an} is a finite set of real numbers. Suppose  > 0. Define

a sequence I1, I2, . . . of open intervals by

                            Ik = (ak - , ak + ) if k  n,  if k > n.

Then I1, I2, . . . is a sequence of open intervals whose union contains A. Clearly
       ( Ik )     2n.   Hence  |A|       2n.      Because     is  an  arbitrary  positive   number,  this
               =                                           
k=1
implies that |A| = 0.

Good Properties of Outer Measure

Outer measure has several nice properties that are discussed in this subsection. We
begin with a result that improves the example above.

2.4 countable sets have outer measure 0
Every countable subset of R has outer measure 0.

Proof  Suppose A = {a1, a2, . . .} is a countable subset of R. Let  > 0. For k  Z+,
let                            Ik = ak - 2k , ak + 2k .

Then I1, I2, . . . is a sequence of open intervals whose union contains A. Because

                                            

                                            (Ik) = 2,

                                           k=1

we have |A|  2. Because  is an arbitrary positive number, this implies that
|A| = 0.

   The result above, along with the result that the set Q of rational numbers is
countable, implies that Q has outer measure 0. We will soon show that there are far
fewer rational numbers than real numbers (see 2.17). Thus the equation |Q| = 0
indicates that outer measure has a good property that we want any reasonable notion
of size to possess.

                  Measure, Integration & Real Analysis, by Sheldon Axler
16 Chapter 2 Measures

   The next result shows that outer measure does the right thing with respect to set
inclusion.

  2.5 outer measure preserves order
  Suppose A and B are subsets of R with A  B. Then |A|  |B|.
Proof Suppose I1, I2, . . . is a sequence of open intervals whose union contains B.
Then the union of this sequence of open intervals also contains A. Hence

                                                                  

                            |A|   (Ik).

                                                              k=1

Taking the infimum over all sequences of open intervals whose union contains B, we
have |A|  |B|.

   We expect that the size of a subset of R should not change if the set is shifted to
the right or to the left. The next definition allows us to be more precise.

  2.6 Definition translation; t + A
  If t  R and A  R, then the translation t + A is defined by

                                 t + A = {t + a : a  A}.

   If t > 0, then t + A is obtained by moving the set A to the right t units on the real
line; if t < 0, then t + A is obtained by moving the set A to the left |t| units.

   Translation does not change the length of an open interval. Specifically, if t  R
and a, b  [-, ], then t + (a, b) = (t + a, t + b) and thus  t + (a, b) =
 (a, b) . Here we are using the standard convention that t + (-) = - and
t +  = .

   The next result states that translation invariance carries over to outer measure.

2.7 outer measure is translation invariant
Suppose t  R and A  R. Then |t + A| = |A|.

Proof Suppose I1, I2, . . . is a sequence of open intervals whose union contains A.
Then t + I1, t + I2, . . . is a sequence of open intervals whose union contains t + A.
Thus
                                            
      |t + A|   (t + Ik) =  (Ik).
                       k=1  k=1

Taking the infimum of the last term over all sequences I1, I2, . . . of open intervals
whose union contains A, we have |t + A|  |A|.

   To get the inequality in the other direction, note that A = -t + (t + A). Thus
applying the inequality from the previous paragraph, with A replaced by t + A and t
replaced by -t, we have |A| = |-t + (t + A)|  |t + A|. Hence |t + A| = |A|.

      Measure, Integration & Real Analysis, by Sheldon Axler
                                   Section 2A Outer Measure on R 17

   The union of the intervals (1, 4) and (3, 5) is the interval (1, 5). Thus
                        (1, 4)  (3, 5) <  (1, 4) +  (3, 5)

because the left side of the inequality above equals 4 and the right side equals 5. The
direction of the inequality above is explained by noting that the interval (3, 4), which
is the intersection of (1, 4) and (3, 5), has its length counted twice on the right side
of the inequality above.

   The example of the paragraph above should provide intuition for the direction of
the inequality in the next result. The property of satisfying the inequality in the result
below is called countable subadditivity because it applies to sequences of subsets.

2.8 countable subadditivity of outer measure

Suppose A1, A2, . . . is a sequence of subsets of R. Then

                                              
                                  Ak   |Ak|.
                           k=1                k=1

Proof If |Ak| =  for some k  Z+, then the inequality above clearly holds. Thus
assume |Ak| <  for all k  Z+.

   Let  > 0. For each k  Z+, let I1,k, I2,k, . . . be a sequence of open intervals
whose union contains Ak such that

                                              
                          (Ij,k)  k + |Ak|.
                         j=1                  2

Thus                                               
2.9                        (Ij,k)   +  |Ak|.

                         k=1 j=1                   k=1

The doubly indexed collection of open intervals {Ij,k : j, k  Z+} can be rearranged
into a sequence of open intervals whose union contains        Ak  as  follows,        where
                                                         k=1
in step k (start with k = 2, then k = 3, 4, 5, . . . ) we adjoin the k - 1 intervals whose
indices add up to k:

I1,1 , I1,2, I2,1, I1,3, I2,2, I3,1, I1,4, I2,3, I3,2, I4,1, I1,5, I2,4, I3,3, I4,2, I5,1, . . . .

      2  3            4            5                     sum of the two indices is 6

Inequality 2.9 shows that the sum of the lengths of the intervals listed above is less
than or equal to  + k=1|Ak|. Thus                    + k=1|Ak|. Because  is an
                                                          k=1|Ak|.
                                   k=1 Ak
arbitrary positive number, this implies that     

                                                 k=1 Ak

Countable subadditivity implies finite subadditivity, meaning that

                          |A1  · · ·  An|  |A1| + · · · + |An|
for all A1, . . . , An  R, because we can take Ak =  for k > n in 2.8.

   The countable subadditivity of outer measure, as proved above, adds to our list of
nice properties enjoyed by outer measure.

            Measure, Integration & Real Analysis, by Sheldon Axler
18 Chapter 2 Measures

Outer Measure of Closed Bounded Interval

One more good property of outer measure that we should prove is that if a < b,
then the outer measure of the closed interval [a, b] is b - a. Indeed, if  > 0, then
(a - , b + ), , , . . . is a sequence of open intervals whose union contains [a, b].
Thus |[a, b]|  b - a + 2. Because this inequality holds for all  > 0, we conclude
that

                                       |[a, b]|  b - a.
   Is the inequality in the other direction obviously true to you? If so, think again,
because a proof of the inequality in the other direction requires that the completeness
of R is used in some form. For example, suppose R was a countable set (which is not
true, as we will soon see, but the uncountability of R is not obvious). Then we would
have |[a, b]| = 0 (by 2.4). Thus something deeper than you might suspect is going
on with the ingredients needed to prove that |[a, b]|  b - a.
   The following definition will be useful when we prove that |[a, b]|  b - a.

  2.10 Definition open cover; finite subcover
  Suppose A  R.

    · A collection C of open subsets of R is called an open cover of A if A is
       contained in the union of all the sets in C.

    · An open cover C of A is said to have a finite subcover if A is contained in
       the union of some finite list of sets in C.

2.11 Example open covers and finite subcovers

· The collection {(k, k + 2) : k  Z+} is an open cover of [2, 5] because
   [2, 5]  k=1(k, k + 2). This open cover has a finite subcover because [2, 5] 
  (1, 3)  (2, 4)  (3, 5)  (4, 6).

· The collection {(k, k + 2) : k  Z+} is an open cover of [2, ) because
   [2, )  k=1(k, k + 2). This open cover does not have a finite subcover
   because there do not exist finitely many sets of the form (k, k + 2) whose union
   contains [2, ).

·  The  collection    {(0, 2    -      1)  :  k    Z+}  is   an  open  cover        of  (1, 2)  because

                                       k
   (1, 2)   k=           0,  2  -  1 ).    This open cover does not have a finite subcover
                   1  (
                                   k
   because  there  do    not    exist  finitely  many  sets  of  the  form  (0,  2  -   1     whose  union
                                                                                        k  )

   contains (1, 2).

   The next result will be our major tool in the proof that |[a, b]|  b - a. Although
we need only the result as stated, be sure to see Exercise 4 in this section, which
when combined with the next result gives a characterization of the closed bounded
subsets of R. Note that the following proof uses the completeness property of the real
numbers (by asserting that the supremum of a certain nonempty bounded set exists).

            Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 2A Outer Measure on R 19

2.12 Heine-Borel Theorem
Every open cover of a closed bounded subset of R has a finite subcover.

Proof Suppose F is a closed bounded       To provide visual clues, we usually
subset of R and C is an open cover of F.  denote closed sets by F and open
                                          sets by G.
   First consider the case where F =
[a, b] for some a, b  R with a < b. Thus
C is an open cover of [a, b]. Let

      D = {d  [a, b] : [a, d] has a finite subcover from C}.

Note that a  D (because a  G for some G  C). Thus D is not the empty set. Let

                       s = sup D.

Thus s  [a, b]. Hence there exists an open set G  C such that s  G. Let  > 0
be such that (s - , s + )  G. Because s = sup D, there exist d  (s - , s] and
n  Z+ and G1, . . . , Gn  C such that

                       [a, d]  G1  · · ·  Gn.

Now

2.13                   [a, d]  G  G1  · · ·  Gn

for all d  [s, s + ). Thus d  D for all d  [s, s + )  [a, b]. This implies that
s = b. Furthermore, 2.13 with d = b shows that [a, b] has a finite subcover from C,
completing the proof in the case where F = [a, b].

   Now suppose F is an arbitrary closed bounded subset of R and that C is an open
cover of F. Let a, b  R be such that F  [a, b]. Now C  {R \ F} is an open cover
of R and hence is an open cover of [a, b] (here R \ F denotes the set complement of
F in R). By our first case, there exist G1, . . . , Gn  C such that

Thus                   [a, b]  G1  · · ·  Gn  (R \ F).
completing the proof.          F  G1  · · ·  Gn,

                                                        Saint-Affrique, the small
                                                        town in southern France
                                                        where Émile Borel
                                                        (1871-1956) was born.
                                                        Borel first stated and
                                                        proved what we call the
                                                        Heine-Borel Theorem in
                                                        1895. Earlier, Eduard
                                                        Heine (1821-1881) and
                                                        others had used similar
                                                        results.

                                                                              CC-BY-SA Fagairolles 34

      Measure, Integration & Real Analysis, by Sheldon Axler
20 Chapter 2 Measures

Now we can prove that closed intervals have the expected outer measure.

2.14 outer measure of a closed interval

Suppose a, b  R, with a < b. Then |[a, b]| = b - a.

Proof See the first paragraph of this subsection for the proof that |[a, b]|  b - a.
To prove the inequality in the other direction, suppose I1, I2, . . . is a sequence of
open intervals such that [a, b]                Ik.  By  the  Heine-Borel    Theorem  (2.12),  there
exists n  Z+ such that                 k=1

2.15                              [a, b]  I1  · · ·  In.

We will now prove by induction on n that the inclusion above implies that

                                       n
                                        (Ik)  b - a.
2.16

                                       k=1

This  will  then  imply     that       ( Ik )       n   ( Ik )    b  -  a,  completing  the   proof
that |[a, b]|  b - a.
                                  k=1            k=1

To get started with our induction, note that 2.15 clearly implies 2.16 if n = 1.
Now for the induction step: Suppose n > 1 and 2.15 implies 2.16 for all choices of
a, b  R with a < b. Suppose I1, . . . , In, In+1 are open intervals such that

                                  [a, b]  I1  · · ·  In  In+1.

Thus b is in at least one of the intervals I1, . . . , In, In+1. By relabeling, we can
assume that b  In+1. Suppose In+1 = (c, d). If c  a, then (In+1)  b - a and
there is nothing further to prove; thus we can assume that a < c < b < d, as shown
in the figure below.

Hence                                               Alice was beginning to get very tired
                                                    of sitting by her sister on the bank,
            [a, c]  I1  · · ·  In.                  and of having nothing to do: once or
                                                    twice she had peeped into the book
By our induction hypothesis, we have                her sister was reading, but it had no
   n  ( Ik )      c     a.  Thus                    pictures or conversations in it, "and
                     -                              what is the use of a book," thought
k=1                                                 Alice, "without pictures or
                                                    conversation?"
      n+1                                           - opening paragraph of Alice's
                                                    Adventures in Wonderland, by Lewis
       (Ik)  (c - a) + (In+1)                       Carroll

      k=1

                 = (c - a) + (d - c)

                  = d-a

                   b - a,

completing the proof.

   The result above easily implies that the outer measure of each open interval equals
its length (see Exercise 6).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 2A Outer Measure on R 21

   The previous result has the following important corollary. You may be familiar
with Georg Cantor's (1845-1918) original proof of the next result. The proof using
outer measure that is presented here gives an interesting alternative to Cantor's proof.

  2.17 nontrivial intervals are uncountable
  Every interval in R that contains at least two distinct elements is uncountable.

Proof Suppose I is an interval that contains a, b  R with a < b. Then
                                |I|  |[a, b]| = b - a > 0,

where the first inequality above holds because outer measure preserves order (see 2.5)
and the equality above comes from 2.14. Because every countable subset of R has
outer measure 0 (see 2.4), we can conclude that I is uncountable.

Outer Measure is Not Additive

We have had several results giving nice   Outer measure led to the proof
properties of outer measure. Now we
come to an unpleasant property of outer above that R is uncountable. This
measure.                                  application of outer measure to

If outer measure were a perfect way to prove a result that seems
assign a size as an extension of the lengths unconnected with outer measure is
of intervals, then the outer measure of the an indication that outer measure has
union of two disjoint sets would equal the serious mathematical value.
sum of the outer measures of the two sets. Sadly, the next result states that outer
measure does not have this property.
In the next section, we begin the process of getting around the next result, which
will lead us to measure theory.

2.18 nonadditivity of outer measure

There exist disjoint subsets A and B of R such that
                                 |A  B| = |A| + |B|.

Proof For a  [-1, 1], let a be the set of numbers in [-1, 1] that differ from a by a
rational number. In other words,

          a = {c  [-1, 1] : a - c  Q}.

   If a, b  [-1, 1] and a  b = , then     Think of a as the equivalence class
a = b. (Proof: Suppose there exists d     of a under the equivalence relation
a  b. Then a - d and b - d are rational that declares a, c  [-1, 1] to be
numbers; subtracting, we conclude that equivalent if a - c  Q.
a - b is a rational number. The equation
a - c = (a - b) + (b - c) now implies that if c  [-1, 1], then a - c is a rational

number if and only if b - c is a rational number. In other words, a = b.)

          Measure, Integration & Real Analysis, by Sheldon Axler
 7 Chapter 2 Measures

Clearly a  a for each a  [-1, 1]. Thus [-1, 1] =  a.

   Let V be a set that contains exactly one                     a[-1,1]
element in each of the distinct sets in
                                                This step involves the Axiom of
                                                Choice, as discussed after this proof.

         {a : a  [-1, 1]}.                      The set V arises by choosing one
                                                element from each equivalence

In other words, for every a  [-1, 1], the class.
set V  a has exactly one element.

   Let r1, r2, . . . be a sequence of distinct rational numbers such that

         [-2, 2]  Q = {r1, r2, . . .}.

Then                                          

                            [-1, 1]  (rk + V),

                                            k=1

where the set inclusion above holds because if a  [-1, 1], then letting v be the
unique element of V  a, we have a - v  Q, which implies that a = rk + v 
rk + V for some k  Z+.

   The set inclusion above, the order-preserving property of outer measure (2.5), and
the countable subadditivity of outer measure (2.8) imply

                                  

              |[-1, 1]|   |rk + V|.

                                k=1

We know that |[-1, 1]| = 2 (from 2.14). The translation invariance of outer measure
(2.7) thus allows us to rewrite the inequality above as

                                       

                               2   |V|.

                                      k=1

Thus |V| > 0.
   Note that the sets r1 + V, r2 + V, . . . are disjoint. (Proof: Suppose there exists

t  (rj + V)  (rk + V). Then t = rj + v1 = rk + v2 for some v1, v2  V, which
implies that v1 - v2 = rk - rj  Q. Our construction of V now implies that v1 = v2,
which implies that rj = rk, which implies that j = k.)

   Let n  Z+. Clearly

                                                  n

                                       (rk + V)  [-3, 3]

                                              k=1

because V  [-1, 1] and each rk  [-2, 2]. The set inclusion above implies that

                            n    (rk + V)  6.

2.19

                            k=1

However  n                                   n
2.20      |rk + V| =  |V| = n |V|.

         k=1                                 k=1

         Measure, Integration & Real Analysis, by Sheldon Axler
                     Section 2A Outer Measure on R 23

Now 2.19 and 2.20 suggest that we choose n  Z+ such that n|V| > 6. Thus

           n                             n
                (rk + V) <  |rk + V|.
2.21

           k=1                           k=1

If we had |A  B| = |A| + |B| for all disjoint subsets A, B of R, then by induction
      n         n
on n we would have Ak =  |Ak| for all disjoint subsets A1, . . . , An of R.
      k=1       k=1
However, 2.21 tells us that no such result holds. Thus there exist disjoint subsets
A, B of R such that |A  B| = |A| + |B|.

   The Axiom of Choice, which belongs to set theory, states that if E is a set whose
elements are disjoint nonempty sets, then there exists a set V that contains exactly
one element in each set that is an element of E . We used the Axiom of Choice to
construct the set V that was used in the last proof.

   A small minority of mathematicians objects to the use of the Axiom of Choice.
Thus we will keep track of where we need to use it. Even if you do not like to use the
Axiom of Choice, the previous result warns us away from trying to prove that outer
measure is additive (any such proof would need to contradict the Axiom of Choice,
which is consistent with the standard axioms of set theory).

EXERCISES 2A

 1 Prove that if A and B are subsets of R and |B| = 0, then |A  B| = |A|.
 2 Suppose A  R and t  R. Let tA = {ta : a  A}. Prove that |tA| = |t| |A|.

     [Assume that 0 ·  is defined to be 0.]
 3 Prove that if A, B  R and |A| < , then |B \ A|  |B| - |A|.
 4 Suppose F is a subset of R with the property that every open cover of F has a

     finite subcover. Prove that F is closed and bounded.
 5 Suppose A is a set of closed subsets of R such that FA F = . Prove that if A

     contains at least one bounded set, then there exist n  Z+ and F1, . . . , Fn  A
     such that F1  · · ·  Fn = .
 6 Prove that if a, b  R and a < b, then

                             |(a, b)| = |[a, b)| = |(a, b]| = b - a.
 7 Suppose a, b, c, d are real numbers with a < b and c < d. Prove that

         |(a, b)  (c, d)| = (b - a) + (d - c) if and only if (a, b)  (c, d) = .
 8 Prove that if A  R and t > 0, then |A| = |A  (-t, t)| + A  R \ (-t, t) .
 9 Prove that |A| = lim |A  (-t, t)| for all A  R.

                                  t

                     Measure, Integration & Real Analysis, by Sheldon Axler
24 Chapter 2 Measures

10 Prove that |[0, 1] \ Q| = 1.

11 Prove that if I1, I2, . . . is a disjoint sequence of open intervals, then

                                          
                                      Ik =  (Ik).
                                 k=1  k=1

12 Suppose r1, r2, . . . is a sequence that contains every rational number. Let

             11
F = R \ rk - k , rk + k .

           k=1 2 2

(a) Show that F is a closed subset of R.

(b) Prove that if I is an interval contained in F, then I contains at most one
     element.

(c) Prove that |F| = .

13 Suppose  > 0. Prove that there exists a subset F of [0, 1] such that F is closed,
      every element of F is an irrational number, and |F| > 1 - .

14 Consider the following figure, which is drawn accurately to scale.

(a) Show that the right triangle whose vertices are (0, 0), (20, 0), and (20, 9)
     has area 90.
     [We have not defined area yet, but just use the elementary formulas for the
     areas of triangles and rectangles that you learned long ago.]

(b) Show that the yellow (lower) right triangle has area 27.5.
(c) Show that the red rectangle has area 45.
(d) Show that the blue (upper) right triangle has area 18.
(e) Add the results of parts (b), (c), and (d), showing that the area of the colored

     region is 90.5.
(f) Seeing the figure above, most people expect parts (a) and (e) to have the

     same result. Yet in (a) we found area 90, and in (e) we found area 90.5.
     Explain why these results differ.
     [You may be tempted to think that what we have here is a two-dimensional
     example similar to the result about the nonadditivity of outer measure
     (2.18). However, genuine examples of nonadditivity require much more
     complicated sets than in this example.]

               Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 2B Measurable Spaces and Functions 25

2B Measurable Spaces and Functions

The last result in the previous section showed that outer measure is not additive.
Could this disappointing result perhaps be fixed by using some notion other than
outer measure for the size of a subset of R? The next result answers this question by
showing that there does not exist a notion of size, called the Greek letter mu (µ) in
the result below, that has all the desirable properties.

   Property (c) in the result below is called countable additivity. Countable additivity
is a highly desirable property because we want to be able to prove theorems about
limits (the heart of analysis!), which requires countable additivity.

2.22 nonexistence of extension of length to all subsets of R

There does not exist a function µ with all the following properties.

(a) µ is a function from the set of subsets of R to [0, ].

(b) µ(I) = (I) for every open interval I of R.

                     

(c) µ Ak        =  µ(Ak) for every disjoint sequence A1, A2, . . . of subsets

           k=1      k=1

     of R.

(d) µ(t + A) = µ(A) for every A  R and every t  R.

Proof Suppose there exists a function µ       We will show that µ has all the
with all the properties listed in the state-
ment of this result.                          properties of outer measure that

Observe that µ() = 0, as follows were used in the proof of 2.18.
from (b) because the empty set is an open interval with length 0.
If A  B  R, then µ(A)  µ(B), as follows from (c) because we can write B
as the union of the disjoint sequence A, B \ A, , , . . . ; thus

µ(B) = µ(A) + µ(B \ A) + 0 + 0 + · · · = µ(A) + µ(B \ A)  µ(A).

If a, b  R with a < b, then (a, b)  [a, b]  (a - , b + ) for every  > 0.
Thus b - a  µ([a, b])  b - a + 2 for every  > 0. Hence µ([a, b]) = b - a.
If A1, A2, . . . is a sequence of subsets of R, then A1, A2 \ A1, A3 \ (A1  A2), . . .
is a disjoint sequence of subsets of R whose union is       Ak.   Thus
                                                       k=1

                      = µ A1  (A2 \ A1)  A3 \ (A1  A2)  · · ·
                      = µ(A1) + µ(A2 \ A1) + µ A3 \ (A1  A2) + · · ·
µ Ak

    k=1

                           

                        µ(Ak),

                          k=1

where the second equality follows from the countable additivity of µ.

                Measure, Integration & Real Analysis, by Sheldon Axler
26 Chapter 2 Measures

   We have shown that µ has all the properties of outer measure that were used
in the proof of 2.18. Repeating the proof of 2.18, we see that there exist disjoint
subsets A, B of R such that µ(A  B) = µ(A) + µ(B). Thus the disjoint sequence
A, B, , , . . . does not satisfy the countable additivity property required by (c). This
contradiction completes the proof.

-Algebras

The last result shows that we need to give up one of the desirable properties in our
goal of extending the notion of size from intervals to more general subsets of R. We
cannot give up 2.22(b) because the size of an interval needs to be its length. We
cannot give up 2.22(c) because countable additivity is needed to prove theorems
about limits. We cannot give up 2.22(d) because a size that is not translation invariant
does not satisfy our intuitive notion of size as a generalization of length.

   Thus we are forced to relax the requirement in 2.22(a) that the size is defined for
all subsets of R. Experience shows that to have a viable theory that allows for taking
limits, the collection of subsets for which the size is defined should be closed under
complementation and closed under countable unions. Thus we make the following
definition.

  2.23 Definition -algebra
  Suppose X is a set and S is a set of subsets of X. Then S is called a -algebra
  on X if the following three conditions are satisfied:

    ·   S;
    · if E  S, then X \ E  S;

                                                                                           

    · if E1, E2, . . . is a sequence of elements of S, then Ek  S.

                                                                                      k=1

   Make sure you verify that the examples in all three bullet points below are indeed
-algebras. The verification is obvious for the first two bullet points. For the third
bullet point, you need to use the result that the countable union of countable sets
is countable (see the proof of 2.8 for an example of how a doubly indexed list can
be converted to a singly indexed sequence). The exercises contain some additional
examples of -algebras.
2.24 Example -algebras

  · Suppose X is a set. Then clearly {, X} is a -algebra on X.
  · Suppose X is a set. Then clearly the set of all subsets of X is a -algebra on X.
  · Suppose X is a set. Then the set of all subsets E of X such that E is countable or

     X \ E is countable is a -algebra on X.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                            Section 2B Measurable Spaces and Functions 27

Now we come to some easy but important properties of -algebras.

2.25 -algebras are closed under countable intersection

Suppose S is a -algebra on a set X. Then

(a) X  S;

(b) if D, E  S, then D  E  S and D  E  S and D \ E  S;

                                                                                        

(c) if E1, E2, . . . is a sequence of elements of S, then Ek  S.

                                                                                   k=1

Proof Because   S and X = X \ , the first two bullet points in the definition
of -algebra (2.23) imply that X  S, proving (a).

   Suppose D, E  S. Then D  E is the union of the sequence D, E, , , . . . of
elements of S. Thus the third bullet point in the definition of -algebra (2.23) implies
that D  E  S.

   De Morgan's Laws tell us that

                          X \ (D  E) = (X \ D)  (X \ E).

If D, E  S, then the right side of the equation above is in S; hence X \ (D  E)  S;
thus the complement in X of X \ (D  E) is in S; in other words, D  E  S.
Because D \ E = D  (X \ E), we see that if D, E  S, then D \ E  S,
completing the proof of (b).
   Finally, suppose E1, E2, . . . is a se-  De Morgan's Laws also show that if

quence of elements of S. De Morgan's a collection of subsets of X contains
Laws tell us that                           the empty set, is closed under

                                            complementation, and is closed

X \ Ek = (X \ Ek).                          under countable intersections, then

k=1                 k=1                     the collection is a -algebra.

The right side of the equation above is in S. Hence the left side is in S, which implies
that X \ (X \       Ek )    S.  In  other  words,       Ek    S,  proving                 (c).
               k=1                                 k=1      

   The word measurable is used in the terminology below because in the next section
we introduce a size function, called a measure, defined on measurable sets.

  2.26 Definition measurable space; measurable set

    · A measurable space is an ordered pair (X, S ), where X is a set and S is a
       -algebra on X.

    · An element of S is called an S-measurable set, or just a measurable set if S
       is clear from the context.

   For example, if X = R and S is the set of all subsets of R that are countable or
have a countable complement, then the set of rational numbers is S-measurable but
the set of positive real numbers is not S-measurable.

                     Measure, Integration & Real Analysis, by Sheldon Axler
28 Chapter 2 Measures

Borel Subsets of R

The next result guarantees that there is a smallest -algebra on a set X containing a
given set A of subsets of X.

2.27 smallest -algebra containing a collection of subsets

Suppose X is a set and A is a set of subsets of X. Then the intersection of all
-algebras on X that contain A is a -algebra on X.

Proof There is at least one -algebra on X that contains A because the -algebra
consisting of all subsets of X contains A.
Let S be the intersection of all -algebras on X that contain A. Then   S
because  is an element of each -algebra on X that contains A.
Suppose E  S. Thus E is in every -algebra on X that contains A. Thus X \ E
is in every -algebra on X that contains A. Hence X \ E  S.
Suppose E1, E2, . . . is a sequence of elements of S. Thus each Ek is in every -
algebra on X that contains A. Thus          Ek  is  in  every  -algebra    on  X  that  contains
A. Hence       Ek    S,  which      k=1     the     proof  that                      on  X.
          k=1                   completes                        S  is  a  -algebra

   Using the terminology smallest for the intersection of all -algebras that contain
a set A of subsets of X makes sense because the intersection of those -algebras is
contained in every -algebra that contains A.

2.28 Example smallest -algebra

  · Suppose X is a set and A is the set of subsets of X that consist of exactly one
     element:
                                      A = {x} : x  X .
     Then the smallest -algebra on X containing A is the set of all subsets E of X
     such that E is countable or X \ E is countable, as you should verify.

  · Suppose A = {(0, 1), (0, )}. Then the smallest -algebra on R containing
     A is {, (0, 1), (0, ), (-, 0]  [1, ), (-, 0], [1, ), (-, 1), R}, as you
     should verify.

Now we come to a crucial definition.

  2.29 Definition Borel set
  The smallest -algebra on R containing all open subsets of R is called the
  collection of Borel subsets of R. An element of this -algebra is called a Borel
  set.
   We have defined the collection of Borel subsets of R to be the smallest -algebra
on R containing all the open subsets of R. We could have defined the collection of
Borel subsets of R to be the smallest -algebra on R containing all the open intervals
(because every open subset of R is the union of a sequence of open intervals).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                 Section 2B Measurable Spaces and Functions 29

2.30 Example Borel sets

· Every closed subset of R is a Borel set because every closed subset of R is the
   complement of an open subset of R.

· Every countable subset of R is a Borel set because if B = {x1, x2, . . .}, then
   B = k=1{xk}, which is a Borel set because each {xk} is a closed set.

· Every half-open interval [a, b) (where a, b  R) is a Borel set because [a, b) =
 (a     1,  b).
     -
k=1     k

· If f : R  R is a function, then the set of points at which f is continuous is the
   intersection of a sequence of open sets (see Exercise 12 in this section) and thus
   is a Borel set.

   The intersection of every sequence of open subsets of R is a Borel set. However,
the set of all such intersections is not the set of Borel sets (this is not obvious, but it
is not closed under countable unions). The set of all countable unions of countable
intersections of open subsets of R is also not the set of Borel sets (again, this is not
obvious, but it is not closed under countable intersections). And so on ad infinitum--
there is no finite procedure involving countable unions, countable intersections, and
complements for constructing the collection of Borel sets.

   We will see later that there exist subsets of R that are not Borel sets. However, any
subset of R that you can write down in a concrete fashion is a Borel set.

Inverse Images

The next definition is used frequently in the rest of this chapter.

2.31 Definition inverse image; f -1(A)
If f : X  Y is a function and A  Y, then the set f -1(A) is defined by

                           f -1(A) = {x  X : f (x)  A}.

2.32 Example inverse images
   Suppose f : [0, 4]  R is defined by f (x) = sin x. Then

                        f -1 (0, ) = (0, )  (2, 3),
                          f -1([0, 1]) = [0, ]  [2, 3]  {4},
                        f -1({-1}) = { 3 , 7 },

                                                              22

                         f -1 (2, 3) = ,

as you should verify.

                     Measure, Integration & Real Analysis, by Sheldon Axler
30 Chapter 2 Measures

Inverse images have good algebraic properties, as is shown in the next two results.

2.33 algebra of inverse images

Suppose f : X  Y is a function. Then

(a) f -1(Y \ A) = X \ f -1(A) for every A  Y;
(b) f -1( AA A) = AA f -1(A) for every set A of subsets of Y;
(c) f -1( AA A) = AA f -1(A) for every set A of subsets of Y.

Proof  Suppose A  Y. For x  X we have
                     x  f -1(Y \ A)  f (x)  Y \ A
                                            f (x) / A
                                            x / f -1(A)
                                            x  X \ f -1(A).

Thus f -1(Y \ A) = X \ f -1(A), which proves (a).
   To prove (b), suppose A is a set of subsets of Y. Then

       x  f -1( A)  f (x)  A

       AA                       AA

                        f (x)  A for some A  A

                        x  f -1(A) for some A  A

                        x  f -1(A).

                                       AA

Thus f -1( AA A) = AA f -1(A), which proves (b).
   Part (c) is proved in the same fashion as (b), with unions replaced by intersections

and for some replaced by for every.

  2.34 inverse image of a composition

  Suppose f : X  Y and g : Y  W are functions. Then

                             (g  f )-1(A) = f -1 g-1(A)

  for every A  W.

Proof Suppose A  W. For x  X we have
        x  (g  f )-1(A)  (g  f )(x)  A  g f (x)  A
                                                           f (x)  g-1(A)
                                                           x  f -1 g-1(A) .

Thus (g  f )-1(A) = f -1 g-1(A) .

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                     Section 2B Measurable Spaces and Functions 31

Measurable Functions

The next definition tells us which real-valued functions behave reasonably with
respect to a -algebra on their domain.

  2.35 Definition measurable function
  Suppose (X, S ) is a measurable space. A function f : X  R is called
  S-measurable (or just measurable if S is clear from the context) if

                                         f -1(B)  S
  for every Borel set B  R.

2.36 Example measurable functions
  · If S = {, X}, then the only S-measurable functions from X to R are the
     constant functions.
  · If S is the set of all subsets of X, then every function from X to R is S-
     measurable.
  · If S = {, (-, 0), [0, ), R} (which is a -algebra on R), then a function
     f : R  R is S-measurable if and only if f is constant on (-, 0) and f is
     constant on [0, ).

   Another class of examples comes from characteristic functions, which are defined
below. The Greek letter chi () is traditionally used to denote a characteristic function.

2.37 Definition characteristic function; E

Suppose E is a subset of a set X. The characteristic function of E is the function
E : X  R defined by
                     1 if x  E,
                     E(x) = 0 if x / E.

The set X that contains E is not explicitly included in the notation E because X will
always be clear from the context.

2.38 Example inverse image with respect to a characteristic function

Suppose (X, S ) is a measurable space, E  X, and B  R. Then

                     if 0 / B and 1  B,
               E     if 0  B and 1 / B,
                     if 0  B and 1  B,
E-1(B) = X \ E       if 0 / B and 1 / B.
               X
               

                  

Thus we see that E is an S-measurable function if and only if E  S.

Measure, Integration & Real Analysis, by Sheldon Axler
32 Chapter 2 Measures

   The definition of an S-measurable         Note that if f : X  R is a function and
function requires the inverse image          a  R, then
of every Borel subset of R to be in
S. The next result shows that to ver-         f -1 (a, ) = {x  X : f (x) > a}.
ify that a function is S-measurable,
we can check the inverse images of
a much smaller collection of subsets
of R.

2.39 condition for measurable function

Suppose (X, S ) is a measurable space and f : X  R is a function such that
                                    f -1 (a, )  S

for all a  R. Then f is an S-measurable function.

Proof Let               T = {A  R : f -1(A)  S}.

We want to show that every Borel subset of R is in T . To do this, we will first show
that T is a -algebra on R.

   Certainly   T , because f -1() =   S.
   If A  T , then f -1(A)  S; hence

                        f -1(R \ A) = X \ f -1(A)  S

by 2.33(a), and thus R \ A  T . In other words, T is closed under complementation.
   If A1, A2, . . .  T , then f -1(A1), f -1(A2), . . .  S; hence

                        f -1                      

                                        Ak   = f -1(Ak)  S

                               k=1               k=1

by 2.33(b), and thus                    T.   In other words, T  is closed under countable

                      k=1 Ak
unions. Thus T is a -algebra on R.
By hypothesis, T contains {(a, ) : a  R}. Because T is closed under
complementation, T also contains {(-, b] : b  R}. Because the -algebra T is
closed under finite intersections (by 2.25), we see that T contains {(a, b] : a, b  R}.
Because (a, b) =  k=1 ( a,  b     1     and  (-,  b)     k=1(-k,  b     1     and     is closed
                               -  k  ]                =              -  k  ]       T

under countable unions, we can conclude that T contains every open subset of R.
Thus the -algebra T contains the smallest -algebra on R that contains all open
subsets of R. In other words, T contains every Borel subset of R. Thus f is an
S-measurable function.

   In the result above, we could replace the collection of sets {(a, ) : a  R}
by any collection of subsets of R such that the smallest -algebra containing that
collection contains the Borel subsets of R. For specific examples of such collections
of subsets of R, see Exercises 3-6.

                     Measure, Integration & Real Analysis, by Sheldon Axler
Section 2B Measurable Spaces and Functions 33

   We have been dealing with S-measurable functions from X to R in the context
of an arbitrary set X and a -algebra S on X. An important special case of this
setup is when X is a Borel subset of R and S is the set of Borel subsets of R that are
contained in X (see Exercise 11 for another way of thinking about this -algebra). In
this special case, the S-measurable functions are called Borel measurable.

  2.40 Definition Borel measurable function
  Suppose X  R. A function f : X  R is called Borel measurable if f -1(B) is
  a Borel set for every Borel set B  R.
   If X  R and there exists a Borel measurable function f : X  R, then X must
be a Borel set [because X = f -1(R)].
   If X  R and f : X  R is a function, then f is a Borel measurable function if
and only if f -1 (a, ) is a Borel set for every a  R (use 2.39).
   Suppose X is a set and f : X  R is a function. The measurability of f depends
on the choice of a -algebra on X. If the -algebra is called S, then we can discuss
whether f is an S-measurable function. If X is a Borel subset of R, then S might
be the set of Borel sets contained in X, in which case the phrase Borel measurable
means the same as S-measurable. However, whether or not S is a collection of Borel
sets, we consider inverse images of Borel subsets of R when determining whether a
function is S-measurable.
   The next result states that continuity interacts well with the notion of Borel
measurability.

2.41 every continuous function is Borel measurable

Every continuous real-valued function defined on a Borel subset of R is a Borel
measurable function.

Proof Suppose X  R is a Borel set and f : X  R is continuous. To prove that f
is Borel measurable, fix a  R.

   If x  X and f (x) > a, then (by the continuity of f ) there exists x > 0 such that
f (y) > a for all y  (x - x, x + x)  X. Thus

f -1 (a, ) =                (x - x, x + x)  X.

              x f -1 (a, )

The union inside the large parentheses above is an open subset of R; hence its
intersection with X is a Borel set. Thus we can conclude that f -1 (a, ) is a Borel
set.

   Now 2.39 implies that f is a Borel measurable function.

   Next we come to another class of Borel measurable functions. A similar definition
could be made for decreasing functions, with a corresponding similar result.

Measure, Integration & Real Analysis, by Sheldon Axler
34 Chapter 2 Measures

  2.42 Definition increasing function; strictly increasing
  Suppose X  R and f : X  R is a function.

    · f is called increasing if f (x)  f (y) for all x, y  X with x < y.
    · f is called strictly increasing if f (x) < f (y) for all x, y  X with x < y.

  2.43 every increasing function is Borel measurable
  Every increasing function defined on a Borel subset of R is a Borel measurable
  function.
Proof Suppose X  R is a Borel set and f : X  R is increasing. To prove that f
is Borel measurable, fix a  R.
   Let b = inf f -1 (a, ) . Then it is easy to see that

            f -1 (a, ) = (b, )  X or f -1 (a, ) = [b, )  X.
Either way, we can conclude that f -1 (a, ) is a Borel set.

   Now 2.39 implies that f is a Borel measurable function.
   The next result shows that measurability interacts well with composition.

2.44 composition of measurable functions

Suppose (X, S ) is a measurable space and f : X  R is an S-measurable
function. Suppose g is a real-valued Borel measurable function defined on a
subset of R that includes the range of f . Then g  f : X  R is an S-measurable
function.

Proof    Suppose B  R is a Borel set. Then (see 2.34)
                             (g  f )-1(B) = f -1 g-1(B) .

Because g is a Borel measurable function, g-1(B) is a Borel subset of R. Because f
is an S-measurable function, f -1 g-1(B)  S. Thus the equation above implies
that (g  f )-1(B)  S. Thus g  f is an S-measurable function.

2.45   Example      if  f  is  measurable,  then       so   are  -f,   1  f , | f |,  f2
                                                                       2

Suppose (X, S ) is a measurable space and f : X  R is S-measurable. Then 2.44
                                    1              f2
implies  that  the  functions  -f,  2  f,  | f |,      are  all  S -measurable            functions  because
each of these functions can be written as the composition of f with a continuous (and
thus Borel measurable) function g.
                                                                 1 x,
Specifically, take g(x)        =  -x, then g(x)             =          then  g(x)         =  |x|, and then
                                                                 2
g(x) = x2.

                    Measure, Integration & Real Analysis, by Sheldon Axler
                                   Section 2B Measurable Spaces and Functions 35

   Measurability also interacts well with algebraic operations, as shown in the next
result.

2.46 algebraic operations with measurable functions

Suppose (X, S ) is a measurable space and f , g : X  R are S-measurable. Then
(a) f + g, f - g, and f g are S-measurable functions;

                                                          f

(b) if g(x) = 0 for all x  X, then g is an S-measurable function.

Proof Suppose a  R. We will show that

2.47 ( f + g)-1 (a, ) =                          f -1 (r, )  g-1 (a - r, ) ,

                                         rQ

which implies that ( f + g)-1 (a, )  S.
   To prove 2.47, first suppose
                                  x  ( f + g)-1 (a, ) .

Thus a < f (x) + g(x). Hence the open interval a - g(x), f (x) is nonempty, and
thus it contains some rational number r. This implies that r < f (x), which means
that x  f -1 (r, ) , and a - g(x) < r, which implies that x  g-1 (a - r, ) .
Thus x is an element of the right side of 2.47, completing the proof that the left side
of 2.47 is contained in the right side.

   The proof of the inclusion in the other direction is easier. Specifically, suppose
x  f -1 (r, )  g-1 (a - r, ) for some r  Q. Thus

                               r < f (x) and a - r < g(x).

Adding these two inequalities, we see that a < f (x) + g(x). Thus x is an element of
the left side of 2.47, completing the proof of 2.47. Hence f + g is an S-measurable
function.

   Example 2.45 tells us that -g is an S-measurable function. Thus f - g, which
equals f + (-g) is an S-measurable function.

   The easiest way to prove that f g is an S-measurable function uses the equation

                                   f g = ( f + g)2 - f 2 - g2 2 .

The operation of squaring an S-measurable function produces an S-measurable
function  (see  Example     2.45),   as  does    the  operation  of  multiplication  by  1  (again,  see
                                                                                         2
Example 2.45). Thus the equation above implies that f g is an S-measurable function,
completing the proof of (a).
    Suppose g(x) = 0 for all x  X. The function defined on R \ {0} (a Borel subset
                            1
of  R)  that  takes  x  to  x  is  continuous    and  thus  is   a  Borel  measurable    function    (by
                                     1
2.41).  Now   2.44   implies   that  g   is  an  S -measurable      function.  Combining    this  result

with what we have already proved about the product of S-measurable functions, we
                f
conclude that g is an S-measurable function, proving (b).

                     Measure, Integration & Real Analysis, by Sheldon Axler
36 Chapter 2 Measures

   The next result shows that the pointwise limit of a sequence of S-measurable
functions is S-measurable. This is a highly desirable property (recall that the set of
Riemann integrable functions on some interval is not closed under taking pointwise
limits; see Example 1.17).

2.48 limit of S-measurable functions

Suppose (X, S ) is a measurable space and f1, f2, . . . is a sequence of
S-measurable functions from X to R. Suppose limk fk(x) exists for each
x  X. Define f : X  R by

                                   f (x) = lim fk(x).

                                                          k

Then f is an S-measurable function.

Proof      Suppose a  R. We will show that
2.49
                        f -1 (a, )                              fk-1 (a + 1 , ) ,

                                          =                                    j

                                               j=1 m=1 k=m

which implies that f -1 (a, )  S.
To prove 2.49, first suppose x  f -1 (a, ) . Thus there exists j  Z+ such that
                 1.
f (x)  >   a  +      The    definition    of  limit  now    implies  that   there      exists  m    Z+      such
                 j
                        1
that  fk(x)   >  a   +  j  for  all  k    m.   Thus  x  is  in  the  right  side   of  2.49,  proving   that  the

left side of 2.49 is contained in the right side.
To prove the inclusion in the other direction, suppose x is in the right side of 2.49.
Thus there exist        j, m     Z+     such that    fk(x)         a+  1    for all k         m.  Taking the
                                                                >      j               

limit  as  k     ,      we  see  that   f (x)    a+     1   >   a.   Thus   x  is  in  the  left  side  of  2.49,
                                                        j
completing the proof of 2.49. Thus f is an S-measurable function.

   Occasionally we need to consider functions that take values in [-, ]. For
example, even if we start with a sequence of real-valued functions in 2.53, we might
end up with functions with values in [-, ]. Thus we extend the notion of Borel
sets to subsets of [-, ], as follows.

  2.50 Definition Borel subsets of [-, ]
  A subset of [-, ] is called a Borel set if its intersection with R is a Borel set.
   In other words, a set C  [-, ] is a Borel set if and only if there exists
a Borel set B  R such that C = B or C = B  {} or C = B  {-} or
C = B  {, -}.
   You should verify that with the definition above, the set of Borel subsets of
[-, ] is a -algebra on [-, ].
   Next, we extend the definition of S-measurable functions to functions taking
values in [-, ].

                     Measure, Integration & Real Analysis, by Sheldon Axler
Section 2B Measurable Spaces and Functions 37

  2.51 Definition measurable function
  Suppose (X, S ) is a measurable space. A function f : X  [-, ] is called
  S-measurable if

                                         f -1(B)  S
  for every Borel set B  [-, ].

   The next result, which is analogous to 2.39, states that we need not consider all
Borel subsets of [-, ] when taking inverse images to determine whether or not a
function with values in [-, ] is S-measurable.

  2.52 condition for measurable function
  Suppose (X, S ) is a measurable space and f : X  [-, ] is a function such
  that

                                      f -1 (a, ]  S
  for all a  R. Then f is an S-measurable function.

   The proof of the result above is left to the reader (also see Exercise 27 in this
section).

   We end this section by showing that the pointwise infimum and pointwise supre-
mum of a sequence of S-measurable functions is S-measurable.

2.53 infimum and supremum of a sequence of S-measurable functions

Suppose (X, S ) is a measurable space and f1, f2, . . . is a sequence of
S-measurable functions from X to [-, ]. Define g, h : X  [-, ] by

      g(x) = inf{ fk(x) : k  Z+} and h(x) = sup{ fk(x) : k  Z+}.
Then g and h are S-measurable functions.

Proof Let a  R. The definition of the supremum implies that

h-1 (a, ]       

           = fk-1 (a, ] ,

               k=1

as you should verify. The equation above, along with 2.52, implies that h is an
S-measurable function.

   Note that
                            g(x) = - sup{- fk(x) : k  Z+}

for all x  X. Thus the result about the supremum implies that g is an S-measurable
function.

Measure, Integration & Real Analysis, by Sheldon Axler
38 Chapter 2 Measures

EXERCISES 2B

 1 Show that S = { nK(n, n + 1] : K  Z} is a -algebra on R.
 2 Verify both bullet points in Example 2.28.
 3 Suppose S is the smallest -algebra on R containing {(r, s] : r, s  Q}. Prove

     that S is the collection of Borel subsets of R.
 4 Suppose S is the smallest -algebra on R containing {(r, n] : r  Q, n  Z}.

     Prove that S is the collection of Borel subsets of R.
 5 Suppose S is the smallest -algebra on R containing {(r, r + 1) : r  Q}.

     Prove that S is the collection of Borel subsets of R.
 6 Suppose S is the smallest -algebra on R containing {[r, ) : r  Q}. Prove

     that S is the collection of Borel subsets of R.
 7 Prove that the collection of Borel subsets of R is translation invariant. More

     precisely, prove that if B  R is a Borel set and t  R, then t + B is a Borel set.

 8 Prove that the collection of Borel subsets of R is dilation invariant. More
      precisely, prove that if B  R is a Borel set and t  R, then tB (which is
      defined to be {tb : b  B}) is a Borel set.

 9 Give an example of a measurable space (X, S ) and a function f : X  R such
      that | f | is S-measurable but f is not S-measurable.

10 Show that the set of real numbers that have a decimal expansion with the digit 5
      appearing infinitely often is a Borel set.

11 Suppose T is a -algebra on a set Y and X  T . Let S = {E  T : E  X}.
      (a) Show that S = {F  X : F  T }.
      (b) Show that S is a -algebra on X.

12 Suppose f : R  R is a function.

(a) For k  Z+, let

Gk  =  {a           R  :  there  exists    >  0  such  that  | f (b)  -  f (c)|  <  1
                                                                                    k

                          for all b, c  (a - , a + )}.

     Prove that Gk is an open subset of R for each k  Z+.                        Gk.
(b) Prove that the set of points at which f is continuous equals         k=1

(c) Conclude that the set of points at which f is continuous is a Borel set.

13 Suppose (X, S ) is a measurable space, E1, . . . , En are disjoint subsets of X, and
      c1, . . . , cn are distinct nonzero real numbers. Prove that c1E1 + · · · + cnEn is
      an S-measurable function if and only if E1, . . . , En  S.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 2B Measurable Spaces and Functions 39

14 (a) Suppose f1, f2, . . . is a sequence of functions from a set X to R. Explain
           why

               {x  X : the sequence f1(x), f2(x), . . . has a limit in R}

                               ( fj - fk)-1  (- 1 , 1 )

               =                                  nn     .

                  n=1 j=1 k=j

(b) Suppose (X, S ) is a measurable space and f1, f2, . . . is a sequence of S-
     measurable functions from X to R. Prove that

               {x  X : the sequence f1(x), f2(x), . . . has a limit in R}

      is an S-measurable subset of X.

15 Suppose X is a set and E1, E2, . . . is a disjoint sequence of subsets of X such
that       Ek     X.  Let  S     {  kK Ek : K  Z+}.
      k=1      =              =

(a) Show that S is a -algebra on X.

(b) Prove that a function from X to R is S-measurable if and only if the function
     is constant on Ek for every k  Z+.

16 Suppose S is a -algebra on a set X and A  X. Let

                           SA = {E  S : A  E or A  E = }.
      (a) Prove that SA is a -algebra on X.
      (b) Suppose f : X  R is a function. Prove that f is measurable with respect

           to SA if and only if f is measurable with respect to S and f is constant
           on A.

17 Suppose X is a Borel subset of R and f : X  R is a function such that
      {x  X : f is not continuous at x} is a countable set. Prove f is a Borel
      measurable function.

18 Suppose f : R  R is differentiable at every element of R. Prove that f  is a
      Borel measurable function from R to R.

19 Suppose X is a nonempty set and S is the -algebra on X consisting of all
      subsets of X that are either countable or have a countable complement in X.
      Give a characterization of the S-measurable real-valued functions on X.

20 Suppose (X, S ) is a measurable space and f , g : X  R are S-measurable
      functions. Prove that if f (x) > 0 for all x  X, then f g (which is the function
      whose value at x  X equals f (x)g(x)) is an S-measurable function.

21 Prove 2.52.
22 Suppose B  R and f : B  R is an increasing function. Prove that f is

      continuous at every element of B except for a countable subset of B.
                      Measure, Integration & Real Analysis, by Sheldon Axler
40 Chapter 2 Measures

23 Suppose f : R  R is a strictly increasing function. Prove that the inverse
      function f -1 : f (R)  R is a continuous function.
      [Note that this exercise does not have as a hypothesis that f is continuous.]

24 Suppose f : R  R is a strictly increasing function and B  R is a Borel set.
      Prove that f (B) is a Borel set.

25 Suppose B  R and f : B  R is an increasing function. Prove that there exists
      a sequence f1, f2, . . . of strictly increasing functions from B to R such that

                       f (x) = lim fk(x)

                                   k

for every x  B.

26 Suppose B  R and f : B  R is a bounded increasing function. Prove that
      there exists an increasing function g : R  R such that g(x) = f (x) for all
      x  B.

27 Prove or give a counterexample: If (X, S ) is a measurable space and

                       f : X  [-, ]

is a function such that f -1 (a, )  S for every a  R, then f is an
S-measurable function.

28 Suppose f : B  R is a Borel measurable function. Define g : R  R by

                 g(x) = f (x) if x  B, 0 if x  R \ B.

      Prove that g is a Borel measurable function.
29 Give an example of a measurable space (X, S ) and a family { ft}tR such

      that each ft is an S-measurable function from X to [0, 1], but the function
      f : X  [0, 1] defined by

                       f (x) = sup{ ft(x) : t  R}

is not S-measurable.
[Compare this exercise to 2.53, where the index set is Z+ rather than R.]

30 Show that

              lim lim cos(j!x) 2k = 1 if x is rational,
              j k                         0 if x is irrational

for every x  R.
[This example is due to Henri Lebesgue.]

              Measure, Integration & Real Analysis, by Sheldon Axler
                         Section 2C Measures and Their Properties 41

2C Measures and Their Properties

Definition and Examples of Measures

The original motivation for the next definition came from trying to extend the notion
of the length of an interval. However, the definition below allows us to discuss size
in many more contexts. For example, we will see later that the area of a set in the
plane or the volume of a set in higher dimensions fits into this structure. The word
measure allows us to use a single word instead of repeating theorems for length, area,
and volume.

2.54 Definition measure

Suppose X is a set and S is a -algebra on X. A measure on (X, S ) is a function
µ : S  [0, ] such that µ() = 0 and

                              

µ Ek                     =  µ(Ek)

    k=1                      k=1

for every disjoint sequence E1, E2, . . . of sets in S.

   The countable additivity that forms the key      In the mathematical literature,
part of the definition above allows us to prove     sometimes a measure on (X, S )
good limit theorems. Note that countable ad-        is just called a measure on X if
ditivity implies finite additivity: if µ is a mea-  the -algebra S is clear from
sure on (X, S ) and E1, . . . , En are disjoint     the context.
sets in S, then
µ(E1  · · ·  En) = µ(E1) + · · · + µ(En),           The concept of a measure, as
as follows from applying the equation               defined here, is sometimes called
µ() = 0 and countable additivity to the dis-        a positive measure (although the
joint sequence E1, . . . , En, , , . . . of sets    phrase nonnegative measure
in S.                                               would be more accurate).

2.55 Example measures

  · If X is a set, then counting measure is the measure µ defined on the -algebra
     of all subsets of X by setting µ(E) = n if E is a finite set containing exactly n
     elements and µ(E) =  if E is not a finite set.

  · Suppose X is a set, S is a -algebra on X, and c  X. Define the Dirac measure
     c on (X, S ) by
                                     c(E) = 1 if c  E, 0 if c / E.
     This measure is named in honor of mathematician and physicist Paul Dirac (1902-
     1984), who won the Nobel Prize for Physics in 1933 for his work combining
     relativity and quantum mechanics at the atomic level.

                     Measure, Integration & Real Analysis, by Sheldon Axler
42 Chapter 2 Measures

  · Suppose X is a set, S is a -algebra on X, and w : X  [0, ] is a function.
     Define a measure µ on (X, S ) by

                              µ(E) =  w(x)

                                                                   xE

     for E  S. [Here the sum is defined as the supremum of all finite subsums
     xD w(x) as D ranges over all finite subsets of E.]
  · Suppose X is a set and S is the -algebra on X consisting of all subsets of X
     that are either countable or have a countable complement in X. Define a measure
     µ on (X, S) by

                               µ(E) = 0 if E is countable, 3 if E is uncountable.
  · Suppose S is the -algebra on R consisting of all subsets of R. Then the function

     that takes a set E  R to |E| (the outer measure of E) is not a measure because
     it is not finitely additive (see 2.18).
  · Suppose B is the -algebra on R consisting of all Borel subsets of R. We will
     see in the next section that outer measure is a measure on (R, B).
   The following terminology is frequently useful.

  2.56 Definition measure space
  A measure space is an ordered triple (X, S, µ), where X is a set, S is a -algebra
  on X, and µ is a measure on (X, S ).

Properties of Measures

The hypothesis that µ(D) <  is needed in part (b) of the next result to avoid
undefined expressions of the form  - .

  2.57 measure preserves order; measure of a set difference
  Suppose (X, S, µ) is a measure space and D, E  S are such that D  E. Then
  (a) µ(D)  µ(E);
  (b) µ(E \ D) = µ(E) - µ(D) provided that µ(D) < .
Proof Because E = D  (E \ D) and this is a disjoint union, we have

                           µ(E) = µ(D) + µ(E \ D)  µ(D),
which proves (a). If µ(D) < , then subtracting µ(D) from both sides of the
equation above proves (b).

                     Measure, Integration & Real Analysis, by Sheldon Axler
Section 2C Measures and Their Properties 43

   The countable additivity property of measures applies to disjoint countable unions.
The following countable subadditivity property applies to countable unions that may
not be disjoint unions.

2.58 countable subadditivity

Suppose (X, S, µ) is a measure space and E1, E2, . . .  S. Then

                                     
µ Ek   µ(Ek).
k=1                                  k=1

Proof Let D1 =  and Dk = E1  · · ·  Ek-1 for k  2. Then

E1 \ D1, E2 \ D2, E3 \ D3, . . .

is a disjoint sequence of subsets of X whose union equals       Ek.  Thus
                                                           k=1

                                          

µ Ek                            = µ (Ek \ Dk)

    k=1                                 k=1
                                     

                                =  µ(Ek \ Dk)

                                    k=1
                                     

                                  µ(Ek),

                                    k=1

where the second line above follows from the countable additivity of µ and the last
line above follows from 2.57(a).

   Note that countable subadditivity implies finite subadditivity: if µ is a measure on
(X, S ) and E1, . . . , En are sets in S, then

                       µ(E1  · · ·  En)  µ(E1) + · · · + µ(En),
as follows from applying the equation µ() = 0 and countable subadditivity to the
sequence E1, . . . , En, , , . . . of sets in S.

   The next result shows that measures behave well with increasing unions.

2.59 measure of an increasing union

Suppose (X, S, µ) is a measure space and E1  E2  · · · is an increasing
sequence of sets in S. Then

                                = lim µ(Ek).

µ Ek                                k

    k=1

Proof If µ(Ek) =  for some k  Z+, then the equation above holds because
both sides equal . Hence we can consider only the case where µ(Ek) <  for all
k  Z+.

                     Measure, Integration & Real Analysis, by Sheldon Axler
44 Chapter 2 Measures

For convenience, let E0 = . Then

                                     

                                   Ek = (Ej \ Ej-1),

             k=1                     j=1

where the union on the right side is a disjoint union. Thus

                  

µ Ek         =  µ(Ej \ Ej-1)

    k=1          j=1
                           k

             = lim  µ(Ej \ Ej-1)

                 k j=1
                           k

             = lim  µ(Ej) - µ(Ej-1)

                 k j=1

             = lim µ(Ek),

                 k

                                                      Another mew.

as desired.

   Measures also behave well with respect to decreasing intersections (but see Exer-
cise 10, which shows that the hypothesis µ(E1) <  below cannot be deleted).

2.60 measure of a decreasing intersection

Suppose (X, S, µ) is a measure space and E1  E2  · · · is a decreasing
sequence of sets in S, with µ(E1) < . Then

                                     = lim µ(Ek).

             µ Ek                        k

                 k=1

Proof One of De Morgan's Laws tells us that

                                          

             E1 \ Ek = (E1 \ Ek).

                         k=1              k=1

Now E1 \ E1  E1 \ E2  E1 \ E3  · · · is an increasing sequence of sets in S.
Thus 2.59, applied to the equation above, implies that

                                     = lim µ(E1 \ Ek).

             µ E1 \ Ek                   k

                         k=1

Use 2.57(b) to rewrite the equation above as

                                     = µ(E1) - lim µ(Ek),

             µ(E1) - µ Ek                              k

                                k=1

which implies our desired result.

             Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 2C Measures and Their Properties 45

   The next result is intuitively plausible--we expect that the measure of the union of
two sets equals the measure of the first set plus the measure of the second set minus
the measure of the set that has been counted twice.

  2.61 measure of a union
  Suppose (X, S, µ) is a measure space and D, E  S, with µ(D  E) < . Then

                        µ(D  E) = µ(D) + µ(E) - µ(D  E).
Proof We have

                D  E = D \ (D  E)  E \ (D  E)  D  E .
The right side of the equation above is a disjoint union. Thus

      µ(D  E) = µ D \ (D  E) + µ E \ (D  E) + µ D  E
                   = µ(D) - µ(D  E) + µ(E) - µ(D  E) + µ(D  E)
                   = µ(D) + µ(E) - µ(D  E),

as desired.

EXERCISES 2C

 1 Explain why there does not exist a measure space (X, S, µ) with the property
     that {µ(E) : E  S} = [0, 1).

Let 2Z+ denote the -algebra on Z+ consisting of all subsets of Z+.
 2 Suppose µ is a measure on (Z+, 2Z+ ). Prove that there is a sequence w1, w2, . . .

     in [0, ] such that

                               µ(E) =  wk

                                                                     kE

     for every set E  Z+.
 3 Give an example of a measure µ on (Z+, 2Z+ ) such that

                                   {µ(E) : E  Z+} = [0, 1].
 4 Give an example of a measure space (X, S, µ) such that

                                                                                 

                          {µ(E) : E  S} = {}  [3k, 3k + 1].

                                                                             k=0

                     Measure, Integration & Real Analysis, by Sheldon Axler
46 Chapter 2 Measures

5 Suppose (X, S, µ) is a measure space such that µ(X) < . Prove that if A is
    a set of disjoint sets in S such that µ(A) > 0 for every A  A, then A is a
    countable set.

6 Find all c  [3, ) such that there exists a measure space (X, S, µ) with

{µ(E) : E  S} = [0, 1]  [3, c].

7 Give an example of a measure space (X, S, µ) such that
                              {µ(E) : E  S} = [0, 1]  [3, ].

8 Give an example of a set X, a -algebra S of subsets of X, a set A of subsets of X
    such that the smallest -algebra on X containing A is S, and two measures µ and
     on (X, S ) such that µ(A) = (A) for all A  A and µ(X) = (X) < ,
    but µ = .

9 Suppose µ and  are measures on a measurable space (X, S ). Prove that µ + 
    is a measure on (X, S ). [Here µ +  is the usual sum of two functions: if E  S,
    then (µ + )(E) = µ(E) + (E).]

10 Give an example of a measure space (X, S, µ) and a decreasing sequence
      E1  E2  · · · of sets in S such that

                                = lim µ(Ek).

                       µ Ek         k

                           k=1

11 Suppose (X, S, µ) is a measure space and C, D, E  S are such that
                    µ(C  D) < , µ(C  E) < , µ(D  E) < .

      Find and prove a formula for µ(C  D  E) in terms of µ(C), µ(D), µ(E),
      µ(C  D), µ(C  E), µ(D  E), and µ(C  D  E).
12 Suppose X is a set and S is the -algebra of all subsets E of X such that E is
      countable or X \ E is countable. Give a complete description of the set of all
      measures on (X, S ).

Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 2D Lebesgue Measure 47

2D Lebesgue Measure

Additivity of Outer Measure on Borel Sets

Recall that there exist disjoint sets A, B  R such that |A  B| = |A| + |B| (see
2.18). Thus outer measure, despite its name, is not a measure on the -algebra of all
subsets of R.

   Our main goal in this section is to prove that outer measure, when restricted to the
Borel subsets of R, is a measure. Throughout this section, be careful about trying to
simplify proofs by applying properties of measures to outer measure, even if those
properties seem intuitively plausible. For example, there are subsets A  B  R
with |A| <  but |B \ A| = |B| - |A| [compare to 2.57(b)].

   The next result is our first step toward the goal of proving that outer measure
restricted to the Borel sets is a measure.

2.62 additivity of outer measure if one of the sets is open

Suppose A and G are disjoint subsets of R and G is open. Then
                                 |A  G| = |A| + |G|.

Proof We can assume that |G| <  because otherwise both |A  G| and |A| + |G|
equal .

   Subadditivity (see 2.8) implies that |A  G|  |A| + |G|. Thus we need to prove
the inequality only in the other direction.

   First consider the case where G = (a, b) for some a, b  R with a < b. We
can assume that a, b / A (because changing a set by at most two points does not
change its outer measure). Let I1, I2, . . . be a sequence of open intervals whose union
contains A  G. For each n  Z+, let

      Jn = In  (-, a), Kn = In  (a, b), Ln = In  (b, ).

Then                      (In) = (Jn) + (Kn) + (Ln).

Now J1, L1, J2, L2, . . . is a sequence of open intervals whose union contains A and
K1, K2, . . . is a sequence of open intervals whose union contains G. Thus

                                                             
                     (In) =  (Jn) + (Ln)
                    n=1   n=1                           +  (Kn)

                                                           n=1

                           |A| + |G|.

The inequality above implies that |A  G|  |A| + |G|, completing the proof that
|A  G| = |A| + |G| in this special case.
Using induction on m, we can now conclude that if m  Z+ and G is a union of
m disjoint open intervals that are all disjoint from A, then |A  G| = |A| + |G|.
Now suppose G is an arbitrary open subset of R that is disjoint from A. Then
G=         In  for  some  sequence  of  disjoint  open  intervals  I1,  I2,  .  .  .,  each  of  which
      n=1
is disjoint from A. Now for each m  Z+ we have

               Measure, Integration & Real Analysis, by Sheldon Axler
48 Chapter 2 Measures

Thus                                                          m

                               |A  G|  A  In

                                                           n=1
                                                             m

                                      = |A| +  (In).

                                                           n=1

                                                              

                               |A  G|  |A| +  (In)

                                                           n=1

                                          |A| + |G|,

completing the proof that |A  G| = |A| + |G|.

   The next result shows that the outer measure of the disjoint union of two sets is
what we expect if at least one of the two sets is closed.

2.63 additivity of outer measure if one of the sets is closed

Suppose A and F are disjoint subsets of R and F is closed. Then
                                 |A  F| = |A| + |F|.

Proof Suppose I1, I2, . . . is a sequence of open intervals whose union contains A  F.
Let G =          Ik.  Thus  G  is  an  open  set  with  A    F    G.  Hence  A    G  \  F,  which
            k=1
implies that

2.64                                   |A|  |G \ F|.

   Because G \ F = G  (R \ F), we know that G \ F is an open set. Hence we can
apply 2.62 to the disjoint union G = F  (G \ F), getting

                                       |G| = |F| + |G \ F|.

Adding |F| to both sides of 2.64 and then using the equation above gives

                                   |A| + |F|  |G|

                                                         

                                              (Ik).

                                                       k=1

Thus |A| + |F|  |A  F|, which implies that |A| + |F| = |A  F|.

   Recall that the collection of Borel sets is the smallest -algebra on R that con-
tains all open subsets of R. The next result provides an extremely useful tool for
approximating a Borel set by a closed set.

2.65 approximation of Borel sets from below by closed sets
Suppose B  R is a Borel set. Then for every  > 0, there exists a closed set
F  B such that |B \ F| < .

                 Measure, Integration & Real Analysis, by Sheldon Axler
                                                           Section 2D Lebesgue Measure 49

Proof Let

                   L = {D  R : for every  > 0, there exists a closed set
                                     F  D such that |D \ F| < }.

The strategy of the proof is to show that L is a -algebra. Then because L contains
every closed subset of R (if D  R is closed, take F = D in the definition of L), by
taking complements we can conclude that L contains every open subset of R and
thus every Borel subset of R.

   To get started with proving that L is a -algebra, we want to prove that L is closed
under countable intersections. Thus suppose D1, D2, . . . is a sequence in L. Let
 > 0. For each k  Z+, there exists a closed set Fk such that

                                   Fk  Dk and |Dk \ Fk| < 2k .

Thus            Fk  is  a  closed  set  and
           k=1

                                                                                   

                    Fk  Dk and                          Dk \ Fk  (Dk \ Fk).

              k=1          k=1                     k=1           k=1             k=1

The last set inclusion and the countable subadditivity of outer measure (see 2.8) imply
that  

                                              Dk \ Fk < .

                                        k=1             k=1

Thus            Dk      L,  proving     that  L  is   closed  under     countable    intersections.
           k=1
    Now we want to prove that L is closed under complementation. Suppose D  L
and  > 0. We want to show that there is a closed subset of R \ D whose set
difference with R \ D has outer measure less than , which will allow us to conclude
that R \ D  L.
    First we consider the case where |D| < . Let F  D be a closed set such that
|D     F|       .   The    definition   of  outer  measure    implies      that  there  exists  an  open  set  G
    \      <
                2
such   that  D      G   and  |G|   <    |D|  +     .  Now  R  \  G  is  a  closed  set  and  R  \  G    R  \   D.
                                                2
Also, we have

                                   (R \ D) \ (R \ G) = G \ D
                                                          G \ F.

Thus

                        |(R \ D) \ (R \ G)|  |G \ F|
                                                = |G| - |F|
                                                = (|G| - |D|) + (|D| - |F|)
                                                < 2 + |D \ F|
                                                < ,

                        Measure, Integration & Real Analysis, by Sheldon Axler
50 Chapter 2 Measures

where the equality in the second line above comes from applying 2.63 to the disjoint
union G = (G \ F)  F, and the fourth line above uses subadditivity applied to
the union D = (D \ F)  F. The last inequality above shows that R \ D  L, as
desired.
Now, still assuming that D  L and  > 0, we consider the case where |D| = .
For k  Z+, let Dk = D  [-k, k]. Because Dk  L and |Dk| < , the previous
case implies that R \ Dk  L. Clearly D =       Dk.  Thus
                                          k=1

                                       

                       R \ D = (R \ Dk).

                                     k=1

Because L is closed under countable intersections, the equation above implies that
R \ D  L, which completes the proof that L is a -algebra.

   Now we can prove that the outer measure of the disjoint union of two sets is what
we expect if at least one of the two sets is a Borel set.

  2.66 additivity of outer measure if one of the sets is a Borel set

  Suppose A and B are disjoint subsets of R and B is a Borel set. Then
                                    |A  B| = |A| + |B|.

Proof Let  > 0. Let F be a closed set such that F  B and |B \ F| <  (see 2.65).
Thus

                              |A  B|  |A  F|
                                        = |A| + |F|
                                        = |A| + |B| - |B \ F|
                                         |A| + |B| - ,

where the second and third lines above follow from 2.63 [use B = (B \ F)  F for
the third line].

   Because the inequality above holds for all  > 0, we have |A  B|  |A| + |B|,
which implies that |A  B| = |A| + |B|.

   You have probably long suspected that not every subset of R is a Borel set. Now
we can prove this suspicion.

  2.67 existence of a subset of R that is not a Borel set
  There exists a set B  R such that |B| <  and B is not a Borel set.
Proof In the proof of 2.18, we showed that there exist disjoint sets A, B  R such
that |A  B| = |A| + |B|. For any such sets, we must have |B| <  because
otherwise both |A  B| and |A| + |B| equal  (as follows from the inequality
|B|  |A  B|). Now 2.66 implies that B is not a Borel set.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                           Section 2D Lebesgue Measure 51

   The tools we have constructed now allow us to prove that outer measure, when
restricted to the Borel sets, is a measure.

2.68 outer measure is a measure on Borel sets

Outer measure is a measure on (R, B), where B is the -algebra of Borel subsets
of R.

Proof Suppose B1, B2, . . . is a disjoint sequence of Borel subsets of R. Then for
each n  Z+ we have
                           n

                           Bk  Bk

                      k=1  k=1

                                 n

                           =  |Bk|,

                               k=1

where the first line above follows from 2.5 and the last line follows from 2.66 (and
induction on n). Taking the limit as n  , we have                k=1|Bk|.

                                                   k=1 Bk
The inequality in the other directions follows from countable subadditivity of outer
measure (2.8). Hence
                           
                           Bk =  |Bk|.
                      k=1  k=1

Thus outer measure is a measure on the -algebra of Borel subsets of R.

The result above implies that the next definition makes sense.

  2.69 Definition Lebesgue measure
  Lebesgue measure is the measure on (R, B), where B is the -algebra of Borel
  subsets of R, that assigns to each Borel set its outer measure.
   In other words, the Lebesgue measure of a set is the same as its outer measure,
except that the term Lebesgue measure should not be applied to arbitrary sets but
only to Borel sets (and also to what are called Lebesgue measurable sets, as we will
soon see). Unlike outer measure, Lebesgue measure is actually a measure, as shown
in 2.68. Lebesgue measure is named in honor of its inventor, Henri Lebesgue.

                                               The cathedral in Beauvais, the
                                               French city where Henri
                                               Lebesgue (1875-1941) was
                                               born. Much of what we call
                                               Lebesgue measure and
                                               Lebesgue integration was
                                               developed by Lebesgue in his
                                               1902 PhD thesis. Émile Borel
                                               was Lebesgue's PhD thesis
                                               advisor. CC-BY-SA James Mitchell

Measure, Integration & Real Analysis, by Sheldon Axler
52 Chapter 2 Measures

Lebesgue Measurable Sets

We have accomplished the major goal of this section, which was to show that outer
measure restricted to Borel sets is a measure. As we will see in this subsection, outer
measure is actually a measure on a somewhat larger class of sets called the Lebesgue
measurable sets.

   The mathematics literature contains many different definitions of a Lebesgue
measurable set. These definitions are all equivalent--the definition of a Lebesgue
measurable set in one approach becomes a theorem in another approach. The ap-
proach chosen here has the advantage of emphasizing that a Lebesgue measurable set
differs from a Borel set by a set with outer measure 0. The attitude here is that sets
with outer measure 0 should be considered small sets that do not matter much.

  2.70 Definition Lebesgue measurable set
  A set A  R is called Lebesgue measurable if there exists a Borel set B  A
  such that |A \ B| = 0.
   Every Borel set is Lebesgue measurable because if A  R is a Borel set, then we
can take B = A in the definition above.
   The result below gives several equivalent conditions for being Lebesgue measur-
able. The equivalence of (a) and (d) is just our definition and thus is not discussed in
the proof.
   Although there exist Lebesgue measurable sets that are not Borel sets, you are
unlikely to encounter one. The most important application of the result below is that
if A  R is a Borel set, then A satisfies conditions (b), (c), (e), and (f). Condition (c)
implies that every Borel set is almost a countable union of closed sets, and condition
(f) implies that every Borel set is almost a countable intersection of open sets.

2.71 equivalences for being a Lebesgue measurable set

Suppose A  R. Then the following are equivalent.

(a) A is Lebesgue measurable.

(b) For each  > 0, there exists a closed set F  A with |A \ F| < .

                                                                                                             

(c) There exist closed sets F1, F2, . . . contained in A such that A \ Fk = 0.

                                                                                                       k=1

(d) There exists a Borel set B  A such that |A \ B| = 0.

(e) For each  > 0, there exists an open set G  A such that |G \ A| < .

(f) There exist open sets G1, G2, . . . containing A such that          \ A = 0.

                                                                    Gk

                                                                k=1

(g) There exists a Borel set B  A such that |B \ A| = 0.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                     Section 2D Lebesgue Measure 53

Proof Let L denote the collection of sets A  R that satisfy (b). We have already
proved that every Borel set is in L (see 2.65). As a key part of that proof, which we
will freely use in this proof, we showed that L is a -algebra on R (see the proof
of 2.65). In addition to containing the Borel sets, L contains every set with outer
measure 0 [because if |A| = 0, we can take F =  in (b)].
    (b) = (c): Suppose (b) holds. Thus for each n  Z+, there exists a closed set
Fn    A  such  that     |A \  Fn |     1.  Now
                                    <        
                                       n

                                        A \ Fk  A \ Fn

                                             k=1

for each n  Z+. Thus |A \                    Fk |    |A \ Fn|  <   1    for each n         Z+.  Hence
                                        k=1                        n
|A \  k=1   Fk |  =  0,  completing     the  proof  that  (b)  implies  (c).

    (c) = (d): Because every countable union of closed sets is a Borel set, we see
that (c) implies (d).
    (d) = (b): Suppose (d) holds. Thus there exists a Borel set B  A such that
|A \ B| = 0. Now
                                           A = B  (A \ B).

We know that B  L (because B is a Borel set) and A \ B  L (because A \ B has
outer measure 0). Because L is a -algebra, the displayed equation above implies
that A  L. In other words, (b) holds, completing the proof that (d) implies (b).

   At this stage of the proof, we now know that (b)  (c)  (d).
   (b) = (e): Suppose (b) holds. Thus A  L. Let  > 0. Then because
R \ A  L (which holds because L is closed under complementation), there exists a
closed set F  R \ A such that

                                        |(R \ A) \ F| < .

Now R \ F is an open set with R \ F  A. Because (R \ F) \ A = (R \ A) \ F,
the inequality above implies that |(R \ F) \ A| < . Thus (e) holds, completing the
proof that (b) implies (e).
    (e) = (f): Suppose (e) holds. Thus for each n  Z+, there exists an open set
Gn    A  such     that  |Gn      A|     1.   Now
                              \      <
                                        n
                                        

                                             Gk \ A  Gn \ A

                                        k=1

for each n  Z+. Thus |                       \  A|    |Gn  \   A|       1  for  each  n    Z+.  Hence
                                                                        n
                                     k=1 Gk
    k=1 Gk  \ A| = 0, completing the proof that (e) implies (f).
|

    (f) = (g): Because every countable intersection of open sets is a Borel set, we
see that (f) implies (g).
    (g) = (b): Suppose (g) holds. Thus there exists a Borel set B  A such that
|B \ A| = 0. Now
                                       A = B  R \ (B \ A) .

We know that B  L (because B is a Borel set) and R \ (B \ A)  L (because this
set is the complement of a set with outer measure 0). Because L is a -algebra, the
displayed equation above implies that A  L. In other words, (b) holds, completing
the proof that (g) implies (b).

   Our chain of implications now shows that (b) through (g) are all equivalent.

                  Measure, Integration & Real Analysis, by Sheldon Axler
54 Chapter 2 Measures

   In addition to the equivalences in the  In practice, the most useful part of
previous result, see Exercise 13 in this
section for another condition that is equiv- Exercise 6 is the result that every
alent to being Lebesgue measurable. Also Borel set with finite measure is
see Exercise 6, which shows that a set almost a finite disjoint union of
with finite outer measure is Lebesgue mea- bounded open intervals.
surable if and only if it is almost a finite disjoint union of bounded open intervals.
Now we can show that outer measure is a measure on the Lebesgue measurable
sets.

2.72 outer measure is a measure on Lebesgue measurable sets
(a) The set L of Lebesgue measurable subsets of R is a -algebra on R.
(b) Outer measure is a measure on (R, L).

Proof Because (a) and (b) are equivalent in 2.71, the set L of Lebesgue measurable
subsets of R is the collection of sets satisfying (b) in 2.71. As noted in the first
paragraph of the proof of 2.71, this set is a -algebra on R, proving (a).

   To prove the second bullet point, suppose A1, A2, . . . is a disjoint sequence of
Lebesgue measurable sets. By the definition of Lebesgue measurable set (2.70), for
each k  Z+ there exists a Borel set Bk  Ak such that |Ak \ Bk| = 0. Now

                                           

                                      Ak  Bk

                                 k=1       k=1

                                           

                                      =  |Bk|

                                          k=1

                                           

                                      =  |Ak|,

                                          k=1

where the second line above holds because B1, B2, . . . is a disjoint sequence of Borel
sets and outer measure is a measure on the Borel sets (see 2.68); the last line above
holds because Bk  Ak and by subadditivity of outer measure (see 2.8) we have
|Ak| = |Bk  (Ak \ Bk)|  |Bk| + |Ak \ Bk| = |Bk|.
The inequality above, combined with countable subadditivity of outer measure
(see 2.8), implies that          = k=1|Ak|, completing the proof of (b).

                         k=1 Ak

   If A is a set with outer measure 0, then A is Lebesgue measurable (because we
can take B =  in the definition 2.70). Our definition of the Lebesgue measurable
sets thus implies that the set of Lebesgue measurable sets is the smallest -algebra
on R containing the Borel sets and the sets with outer measure 0. Thus the set of
Lebesgue measurable sets is also the smallest -algebra on R containing the open
sets and the sets with outer measure 0.

   Because outer measure is not even finitely additive (see 2.18), 2.72(b) implies that
there exist subsets of R that are not Lebesgue measurable.

       Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 2D Lebesgue Measure 55

   We previously defined Lebesgue measure as outer measure restricted to the Borel
sets (see 2.69). The term Lebesgue measure is sometimes used in mathematical
literature with the meaning as we previously defined it and is sometimes used with
the following meaning.

2.73 Definition Lebesgue measure

Lebesgue measure is the measure on (R, L), where L is the -algebra of Lebesgue
measurable subsets of R, that assigns to each Lebesgue measurable set its outer
measure.

The two definitions of Lebesgue measure disagree only on the domain of the
measure--is the -algebra the Borel sets or the Lebesgue measurable sets? You
may be able to tell which is intended from the context. In this book, the domain is
specified unless it is irrelevant.
If you are reading a mathematics paper and the domain for Lebesgue measure
is not specified, then it probably does not matter whether you use the Borel sets
or the Lebesgue measurable sets (because every Lebesgue measurable set differs
from a Borel set by a set with outer measure 0, and when dealing with measures,
what happens on a set with measure 0 usually does not matter). Because all sets that
arise from the usual operations of analysis are Borel sets, you may want to assume
that Lebesgue measure means outer measure on the Borel sets, unless what you are
reading explicitly states otherwise.
   A mathematics paper may also refer to
a measurable subset of R, without further  The emphasis in some textbooks on

explanation. Unless some other -algebra Lebesgue measurable sets instead of
is clear from the context, the author prob- Borel sets probably stems from the
ably means the Borel sets or the Lebesgue historical development of the subject,
measurable sets. Again, the choice prob- rather than from any common use of
ably does not matter, but using the Borel Lebesgue measurable sets that are
sets can be cleaner and simpler.           not Borel sets.

Lebesgue measure on the Lebesgue measurable sets does have one small advantage
over Lebesgue measure on the Borel sets: every subset of a set with (outer) measure
0 is Lebesgue measurable but is not necessarily a Borel set. However, any natural
process that produces a subset of R will produce a Borel set. Thus this small
advantage does not often come up in practice.

Cantor Set and Cantor Function

Every countable set has outer measure 0 (see 2.4). A reasonable question arises
about whether the converse holds. In other words, is every set with outer measure
0 countable? The Cantor set, which is introduced in this subsection, provides the
answer to this question.

   The Cantor set also gives counterexamples to other reasonable conjectures. For
example, Exercise 17 in this section shows that the sum of two sets with Lebesgue
measure 0 can have positive Lebesgue measure.

                     Measure, Integration & Real Analysis, by Sheldon Axler
56 Chapter 2 Measures

   2.74 Definition Cantor set

   The Cantor set C is [0, 1] \ (                  Gn ),    where      G1      =        (1,    2)    and  Gn  for  n  >  1  is
                                        n=1
                                                                                          3    3                   n-1 Gj).
   the union of the middle-third open intervals in the intervals of [0, 1] \ (
                                                                                                                   j=1

    One way to envision the Cantor set C is to start with the interval [0, 1] and then
consider the process that removes at each step the middle-third open intervals of all
intervals    left  from  the  previous  step.      At   the    first   step,       we      remove         G1     (1,  2 ).
                                                                                                              =
                                                                                                                   3  3

                                        G1 is shown in red.

    After that first step, we have [0, 1] \ G1                      =    [0,      1  ]     [   2  ,  1].  Thus we take the
                                                                                  3            3
middle-third       open  intervals  of  [0,  1     and      2  ,  1].  In   other          words,    we   have
                                             3  ]       [   3

                                        G2   =     (1,  2)          (7,    8 ).

                                                     9  9             9    9

                                       G1  G2 is shown in red.

    Now  [0,  1]   \  (G1     G2)   =   [0,  1  ]    [  2,  1  ]    [  2,   7  ]        [  8,  1].   Thus
                                             9              3               9
                                                        9              3                   9

                      G3 = ( 1 , 2 )  ( 7 , 8 )  ( 19 , 20 )  ( 25 , 26 ).
                                 27 27             27 27               27 27                   27 27

                                    G1  G2  G3 is shown in red.

    Base 3 representations provide a useful way to think about the Cantor set. Just
as  1        0.1      0.09999 . . . in the decimal representation, base 3 representations
    10   =         =

are not unique for fractions whose denominator is a power of 3. For example,
1      0.13        0.02222 . . .3,  where    the   subscript        3  denotes             a   base  3    representation.
3   =         =

    Notice that G1 is the set of numbers in [0, 1] whose base 3 representations have
1 in the first digit after the decimal point (for those numbers that have two base 3
representations, this means both such representations must have 1 in the first digit).
Also, G1  G2 is the set of numbers in [0, 1] whose base 3 representations have 1 in
the first digit or the second digit after the decimal point. And so on. Hence                                            

                                                                                                                         n=1 Gn
is the set of numbers in [0, 1] whose base 3 representations have a 1 somewhere.
    Thus we have the following description of the Cantor set. In the following
result, the phrase a base 3 representation indicates that if a number has two base 3
representations, then it is in the Cantor set if and only if at least one of them contains
no  1s.  For  example,     both  1  (which   equals     0.02222          .  .  .3    and       equals     0.13)  and  2  (which
                                 3                                                                                    3
equals 0.23 and equals 0.12222 . . .3) are in the Cantor set.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 2D Lebesgue Measure 20103

2.75 base 3 description of the Cantor set
The Cantor set C is the set of numbers in [0, 1] that have a base 3 representation
containing only 0s and 2s.

   The two endpoints of each interval in      It is unknown whether or not every
each Gn are in the Cantor set. However,
many elements of the Cantor set are not number in the Cantor set is either
endpoints of any interval in any Gn. For rational or transcendental (meaning
example, Exercise 14 asks you to show not the root of a polynomial with
1that 4 and 13 are in the Cantor set; neither9integer coefficients).

of those numbers is an endpoint of any interval in any Gn. An example of an irrational
                            2
number in the Cantor set is  n! .
                  n=1 3
The next result gives some elementary properties of the Cantor set.

2.76 C is closed, has measure 0, and contains no nontrivial intervals

(a) The Cantor set is a closed subset of R.
(b) The Cantor set has Lebesgue measure 0.
(c) The Cantor set contains no interval with more than one element.

Proof Each set Gn used in the definition of the Cantor set is a union of open intervals.
Thus each Gn is open. Thus           Gn  is   open,  and    hence  its  complement  is  closed.
                                n=1  
The Cantor set equals [0, 1]  R \             , which is the intersection of two closed
                                     n=1 Gn
sets. Thus the Cantor set is closed, completing the proof of (a).
By induction on n, each Gn is the union of 2n-1 disjoint open intervals, each of
               1                     2n-1
which has length 3n . Thus |Gn| = 3n . The sets G1, G2, . . . are disjoint. Hence

                    Gn = 1 + 2 + 4 + · · ·
                  n=1 3 9 27

                                = 13 1 + 23 + 49 + · · ·
                                = 1 · 2 1

                                   3 1- 3

                                = 1.

Thus the Cantor set, which equals [0, 1] \           Gn  ,  has  Lebesgue  measure  1  -  1  [by
                                              n=1
2.57(b)]. In other words, the Cantor set has Lebesgue measure 0, completing the
proof of (b).
A set with Lebesgue measure 0 cannot contain an interval that has more than one
element. Thus (b) implies (c).

               Measure, Integration & Real Analysis, by Sheldon Axler
58 Chapter 2 Measures

   Now we can define an amazing function.

  2.77 Definition Cantor function
  The Cantor function  : [0, 1]  [0, 1] is defined by converting base 3 represen-
  tations into base 2 representations as follows.

    · If x  C, then (x) is computed from the unique base 3 representation of
       x containing only 0s and 2s by replacing each 2 by 1 and interpreting the
       resulting string as a base 2 number.

    · If x  [0, 1] \ C, then (x) is computed from a base 3 representation of x
       by truncating after the first 1, replacing each 2 before the first 1 by 1, and
       interpreting the resulting string as a base 2 number.

2.78 Example values of the Cantor function

·  (0.02023) = 0.01012; in other words,                  20     = 5.
                                                         81
                                                                    16

·  (0.2201213) = 0.11012; in other words                    664   = 13 .
                                                            729
                                                                      16

· Suppose x     1, 2        .  Then x / C because x was removed in the first step of

                33
   the definition of the Cantor set. Each base 3 representation of x begins with 0.1.
   Thus  we  truncate   and    interpret  0.1  as  a  base   2  number,   getting   1.  Hence  the
                                                      1                     1, 2
                               the  constant          2                             2
   Cantor   function    has                    value     on  the  interval  33      , as shown on
   the graph below.

· Suppose x     7, 8        . Then x / C because x was removed in the second step

                99
   of the definition of the Cantor set. Each base 3 representation of x begins with
   0.21. Thus we truncate, replace the 2 by 1, and interpret 0.11 as a base 2 number,
   getting  3.  Hence  the  Cantor  function       has   the    constant  value  3  on  the  interval
   7, 8                                                                          4
            4
   99    , as shown on the graph below.

   Graph of the Cantor function on the intervals from first three steps.
             Measure, Integration & Real Analysis, by Sheldon Axler
                                                         Section 2D Lebesgue Measure 59

   As shown in the next result, in some mysterious fashion the Cantor function
manages to map [0, 1] onto [0, 1] even though the Cantor function is constant on each
open interval in the complement of the Cantor set--see the graph in Example 2.78.

  2.79 Cantor function
  The Cantor function  is a continuous, increasing function from [0, 1] onto [0, 1].
  Furthermore, (C) = [0, 1].
Proof We begin by showing that (C) = [0, 1]. To do this, suppose y  [0, 1]. In
the base 2 representation of y, replace each 1 by 2 and interpret the resulting string in
base 3, getting a number x  [0, 1]. Because x has a base 3 representation consisting
only of 0s and 2s, the number x is in the Cantor set C. The definition of the Cantor
function shows that (x) = y. Thus y  (C). Hence (C) = [0, 1], as desired.
   Some careful thinking about the meaning of base 3 and base 2 representations and
the definition of the Cantor function shows that  is an increasing function. This step
is left to the reader.
   If x  [0, 1] \ C, then the Cantor function  is constant on an open interval
containing x and thus  is continuous at x. If x  C, then again some careful
thinking about base 3 and base 2 representations shows that  is continuous at x.
   Alternatively, you can skip the paragraph above and note that an increasing
function on [0, 1] whose range equals [0, 1] is automatically continuous (although
you should think about why that holds).
   Now we can use the Cantor function to show that the Cantor set is uncountable
even though it is a closed set with outer measure 0.
  2.80 C is uncountable
  The Cantor set is uncountable.
Proof If C were countable, then (C) would be countable. However, 2.79 shows
that (C) is uncountable.
   As we see in the next result, the Cantor function shows that even a continuous
function can map a set with Lebesgue measure 0 to nonmeasurable sets.

  2.81 continuous image of a Lebesgue measurable set can be nonmeasurable
  There exists a Lebesgue measurable set A  [0, 1] such that |A| = 0 and (A)
  is not a Lebesgue measurable set.
Proof Let E be a subset of [0, 1] that is not Lebesgue measurable (the existence
of such a set follows from the discussion after 2.72). Let A = C  -1(E). Then
|A| = 0 because A  C and |C| = 0 (by 2.76). Thus A is Lebesgue measurable
because every subset of R with outer measure 0 is Lebesgue measurable.
   Because  maps C onto [0, 1] (see 2.79), we have (A) = E.

                     Measure, Integration & Real Analysis, by Sheldon Axler
60 Chapter 2 Measures

EXERCISES 2D

1 (a) Show that the set consisting of those numbers in (0, 1) that have a decimal
          expansion containing one hundred consecutive 4s is a Borel subset of R.

    (b) What is the Lebesgue measure of the set in (a)?

2 Prove that there exists a bounded set A  R such that |F|  |A| - 1 for every
    closed set F  A.

3 Prove that there exists a set A  R such that |G \ A| =  for every open set G
    that contains A.

4 The phrase nontrivial interval is used to denote an interval of R that contains
    more than one element. Recall that an interval might be open, closed, or neither.

    (a) Prove that the union of each collection of nontrivial intervals of R is the
          union of a countable subset of that collection.

    (b) Prove that the union of each collection of nontrivial intervals of R is a Borel
          set.

    (c) Prove that there exists a collection of closed intervals of R whose union is
          not a Borel set.

5 Prove that if A  R is Lebesgue measurable, then there exists an increasing
    sequence F1  F2  · · · of closed sets contained in A such that

                                                                

                                         A \ Fk = 0.

                                                            k=1

6 Suppose A  R and |A| < . Prove that A is Lebesgue measurable if and
    only if for every  > 0 there exists a set G that is the union of finitely many
    disjoint bounded open intervals such that |A \ G| + |G \ A| < .

7 Prove that if A  R is Lebesgue measurable, then there exists a decreasing
    sequence G1  G2  · · · of open sets containing A such that

                               \ A = 0.

                           Gk

                       k=1

 8 Prove that the collection of Lebesgue measurable subsets of R is translation
      invariant. More precisely, prove that if A  R is Lebesgue measurable and
      t  R, then t + A is Lebesgue measurable.

 9 Prove that the collection of Lebesgue measurable subsets of R is dilation invari-
      ant. More precisely, prove that if A  R is Lebesgue measurable and t  R,
      then tA (which is defined to be {ta : a  A}) is Lebesgue measurable.

10 Prove that if A and B are disjoint subsets of R and B is Lebesgue measurable,
      then |A  B| = |A| + |B|.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                      Section 2D Lebesgue Measure 61

11 Prove that if A  R and |A| > 0, then there exists a subset of A that is not
      Lebesgue measurable.

12 Suppose b < c and A  (b, c). Prove that A is Lebesgue measurable if and
      only if |A| + |(b, c) \ A| = c - b.

13 Suppose A  R. Prove that A is Lebesgue measurable if and only if

                               |(-n, n)  A| + |(-n, n) \ A| = 2n

    for every n  Z+.

14  Show  that  1  and     9   are  both  in  the  Cantor  set.
                4          13

15  Show  that  13  is  not    in  the  Cantor  set.
                17

16 List the eight open intervals whose union is G4 in the definition of the Cantor
      set (2.74).

17  Let C denote the Cantor set. Prove that           1    x  +  1y  :  x,  y    C  = [0, 1].
                                                      2
                                                                 2

18 Prove that every open interval of R contains either infinitely many or no elements
      in the Cantor set.

                          1

19 Evaluate , where  is the Cantor function.

                         0

20 Evaluate each of the following:

    (a)    9    ;
           13

    (b) (0.93).

21 Find each of the following sets:

    (a)  -1     {1}     ;

                  3

    (b) -1 { 5 } .

                       16

22 (a) Suppose x is a rational number in [0, 1]. Explain why (x) is rational.
      (b) Suppose x  C is such that (x) is rational. Explain why x is rational.

23 Show that there exists a function f : R  R such that the image under f of
      every nonempty open interval is R.

24 For A  R, the quantity

                sup{|F| : F is a closed bounded subset of R and F  A}

    is called the inner measure of A.

    (a) Show that if A is a Lebesgue measurable subset of R, then the inner measure
         of A equals the outer measure of A.

    (b) Show that inner measure is not a measure on the -algebra of all subsets
         of R.

                Measure, Integration & Real Analysis, by Sheldon Axler
62 Chapter 2 Measures

2E Convergence of Measurable Functions

Recall that a measurable space is a pair (X, S ), where X is a set and S is a -algebra
on X. We defined a function f : X  R to be S-measurable if f -1(B)  S for
every Borel set B  R. In Section 2B we proved some results about S-measurable
functions; this was before we had introduced the notion of a measure.

   In this section, we return to study measurable functions, but now with an emphasis
on results that depend on measures. The highlights of this section are the proofs of
Egorov's Theorem and Luzin's Theorem.

Pointwise and Uniform Convergence

We begin this section with some definitions that you probably saw in an earlier course.

  2.82 Definition pointwise convergence; uniform convergence
  Suppose X is a set, f1, f2, . . . is a sequence of functions from X to R, and f is a
  function from X to R.

    · The sequence f1, f2, . . . converges pointwise on X to f if
                                        lim fk(x) = f (x)

                                                    k

       for each x  X.
       In other words, f1, f2, . . . converges pointwise on X to f if for each x  X
       and every  > 0, there exists n  Z+ such that | fk(x) - f (x)| <  for all
       integers k  n.
    · The sequence f1, f2, . . . converges uniformly on X to f if for every  > 0,
       there exists n  Z+ such that | fk(x) - f (x)| <  for all integers k  n and
       all x  X.

2.83 Example a sequence converging pointwise but not uniformly
    Suppose fk : [-1, 1]  R is the

function whose graph is shown here
and f : [-1, 1]  R is the function
defined by

f (x) = 1 if x = 0, 2 if x = 0.

Then f1, f2, . . . converges pointwise  The graph of fk.
on [-1, 1] to f but f1, f2, . . . does
not converge uniformly on [-1, 1] to
f , as you should verify.

Measure, Integration & Real Analysis, by Sheldon Axler
                                     Section 2E Convergence of Measurable Functions 63

   Like the difference between continuity and uniform continuity, the difference
between pointwise convergence and uniform convergence lies in the order of the
quantifiers. Take a moment to examine the definitions carefully. If a sequence of
functions converges uniformly on some set, then it also converges pointwise on the
same set; however, the converse is not true, as shown by Example 2.83.

   Example 2.83 also shows that the pointwise limit of continuous functions need not
be continuous. However, the next result tells us that the uniform limit of continuous
functions is continuous.

   2.84 uniform limit of continuous functions is continuous

   Suppose B  R and f1, f2, . . . is a sequence of functions from B to R that
   converges uniformly on B to a function f : B  R. Suppose b  B and fk is
   continuous at b for each k  Z+. Then f is continuous at b.

Proof  Suppose             >     0.   Let  n     Z+   be  such  that  | fn(x)  -  f (x)|   <         for  all  x     B.
                                                                                                  3
Because  fn  is    continuous         at   b,  there  exists    >  0  such  that  | fn(x)  -       fn(b)|  <         for
                                                                                                                  3
all x  (b - , b + )  B.
   Now suppose x  (b - , b + )  B. Then

       | f (x) - f (b)|  | f (x) - fn(x)| + | fn(x) - fn(b)| + | fn(b) - f (b)|
                        < .

Thus f is continuous at b.

Egorov's Theorem

A sequence of functions that converges                          Dmitri Egorov (1869-1931) proved
pointwise need not converge uniformly.
However, the next result says that a point- the theorem below in 1911. You may
wise convergent sequence of functions on encounter some books that spell his
a measure space with finite total measure last name as Egoroff.
almost converges uniformly, in the sense that it converges uniformly except on a set
that can have arbitrarily small measure.
   As an example of the next result, consider Lebesgue measure  on the inter-
val [-1, 1] and the sequence of functions f1, f2, . . . in Example 2.83 that con-
verges pointwise but not uniformly on [-1, 1]. Suppose  > 0. Then taking
E      [-1,                   ,  1],  we   have  ([-1, 1] \     E)          and   f1,  f2, . . .   converges         uni-
   =         -  4  ]    [  4                                          <  

formly on E, as in the conclusion of the next result.

   2.85 Egorov's Theorem
   Suppose (X, S, µ) is a measure space with µ(X) < . Suppose f1, f2, . . . is a
   sequence of S-measurable functions from X to R that converges pointwise on
   X to a function f : X  R. Then for every  > 0, there exists a set E  S such
   that µ(X \ E) <  and f1, f2, . . . converges uniformly to f on E.

                      Measure, Integration & Real Analysis, by Sheldon Axler
64 Chapter 2 Measures

Proof Suppose  > 0. Temporarily fix n  Z+. The definition of pointwise
convergence implies that

                                                                     1}

2.86                            {x      X  :  | fk(x) -  f (x)|   <  n    =  X.

                     m=1 k=m

For m  Z+, let

                                                                          1 }.

                     Am,n =          {x       X  :  | fk(x) -  f (x)|  <  n

                                k=m

Each Am,n  S because each fk - f is an S-measurable function (by 2.48 and 2.46).
   Now A1,n  A2,n  · · · is an increasing sequence of sets and 2.86 can be

rewritten as 
                                            Am,n = X.

                                                    m=1

The equation above implies (by 2.59) that limm µ(Am,n) = µ(X). Thus there
exists mn  Z+ such that

2.87                     µ(X) - µ(Amn, n) < 2n .
   Let
                                             
Then
                               E = Amn, n.

                                          n=1

                                                       

                     µ(X \ E) = µ X \ Amn, n

                                                    n=1

                                                     

                                           = µ (X \ Amn, n)

                                                   n=1

                                                

                                             µ(X \ Amn, n)

                                               n=1

                                           < ,

where the last inequality follows from 2.87.
    To complete the proof, we must verify that f1, f2, . . . converges uniformly to f
on  E.  To do this,  suppose        0.  Let   n     Z+   be such that  1     .   Then  E    Amn, n,
                                >                                      n  <               

which implies that              | fk(x) -        f (x)|     1     
                                                            n
                                                         <     <

for all k  mn and all x  E. Hence f1, f2, . . . does indeed converge uniformly to f
on E.

                Measure, Integration & Real Analysis, by Sheldon Axler
                                Section 2E Convergence of Measurable Functions 65

Approximation by Simple Functions

  2.88 Definition simple function

  A function is called simple if it takes on only finitely many values.

   Suppose (X, S ) is a measurable space, f : X  R is a simple function, and
c1, . . . , cn are the distinct nonzero values of f . Then

                                 f = c1E1 + · · · + cnEn ,
where Ek = f -1({ck}). Thus this function f is an S-measurable function if and
only if E1, . . . , En  S (as you should verify).

2.89 approximation by simple functions

Suppose (X, S ) is a measurable space and f : X  [-, ] is S-measurable.
Then there exists a sequence f1, f2, . . . of functions from X to R such that

(a) each fk is a simple S-measurable function;
(b) | fk(x)|  | fk+1(x)|  | f (x)| for all k  Z+ and all x  X;
(c) lim fk(x) = f (x) for every x  X;

       k

(d) f1, f2, . . . converges uniformly on X to f if f is bounded.

Proof The idea of the proof is that for each k  Z+ and n  Z, the interval
[n, n + 1) is divided into 2k equally sized half-open subintervals. If f (x)  [0, k],
we define fk(x) to be the left endpoint of the subinterval into which f (x) falls; if
f (x)  [-k, 0), we define fk(x) to be the right endpoint of the subinterval into
which f (x) falls; and if | f (x)| > k, we define fk(x) to be ±k. Specifically, let
      
      m              if 0  f (x)  k and m  Z is such that f (x)        m m+1
      k
                                                                       k, k ,
            2                                                          22

       m+1           if - k  f (x) < 0 and m  Z is such that f (x)         m m+1

               k                                                           k, k ,
fk(x) = 2                                                                  22

      k if f (x) > k,
      
            -k if f (x) < -k.

Each  f -1  [ m , m+1 )kk     S because f is an S-measurable function. Thus each fk
            22
is an S-measurable simple function; in other words, (a) holds.
Also, (b) holds because of how we have defined fk.
The definition of fk implies that

2.90  | fk(x)     -  f (x)|    1   for all x  X such that f (x)  [-k, k].
                               2k

Thus we see that (c) holds.
   Finally, 2.90 shows that (d) holds.

               Measure, Integration & Real Analysis, by Sheldon Axler
66 Chapter 2 Measures

Luzin's Theorem

Our next result is surprising. It says that     Nikolai Luzin (1883-1950) proved
an arbitrary Borel measurable function is
almost continuous, in the sense that its the theorem below in 1912. Most
restriction to a large closed set is contin- mathematics literature in English
uous. Here, the phrase large closed set refers to the result below as Lusin's
means that we can take the complement Theorem. However, Luzin is the
of the closed set to have arbitrarily small correct transliteration from Russian
measure.                                        into English; Lusin is the

Be careful about the interpretation of transliteration into German.
the conclusion of Luzin's Theorem that f |B is a continuous function on B. This is
not the same as saying that f (on its original domain) is continuous at each point
of B. For example, Q is discontinuous at every point of R. However, Q|R\Q is a
continuous function on R \ Q (because this function is identically 0 on its domain).

2.91 Luzin's Theorem

Suppose g : R  R is a Borel measurable function. Then for every  > 0, there
exists a closed set F  R such that |R \ F| <  and g|F is a continuous function
on F.

Proof First consider the special case where g = d1D1 + · · · + dnDn for some
distinct nonzero d1, . . . , dn  R and some disjoint Borel sets D1, . . . , Dn  R.
Suppose  > 0. For each k  {1, . . . , n}, there exist (by 2.71) a closed set Fk  Dk
and an open set Gk  Dk such that

                    |Gk \ Dk| < 2n and |Dk \ Fk| < 2n .

Because Gk \ Fk  =  (Gk \ Dk)  (Dk \ Fk), we have |Gk \ Fk|           <     for each k  
                                                                         n
{1, . . . , n}.
Let n n
                      F=                Fk  (R \ Gk).

                                   k=1       k=1

Then F is a closed subset of R and R \ F  nk=1(Gk \ Fk). Thus |R \ F| < .
   Because Fk  Dk, we see that g is identically dk on Fk. Thus g|Fk is continuous

for each k  {1, . . . , n}. Because

                      n                         n
                           (R \ Gk)  (R \ Dk),

                      k=1                    k=1

we see that g is identically 0 on  n (R      \  Gk  ).  Thus g|  n    (R\Gk) is continuous.
                                                                 k=1
                                   k=1
Putting all this together, we conclude that g|F is continuous (use Exercise 9 in this
section), completing the proof in this special case.
Now consider an arbitrary Borel measurable function g : R  R. By 2.89, there
exists a sequence g1, g2, . . . of functions from R to R that converges pointwise on R
to g, where each gk is a simple Borel measurable function.

                 Measure, Integration & Real Analysis, by Sheldon Axler
                          Section 2E Convergence of Measurable Functions 67

   Suppose  > 0. By the special case already proved, for each k  Z+, there exists
a  closed  set  Ck        such  that  |R \ Ck|           and  gk |Ck  is  continuous.  Let
                       R                        <  2k+1

                                                   

                                          C = Ck.

                                                 k=1

Thus C is a closed set and gk|C is continuous for every k  Z+. Note that

                                                      

                                      R \ C = (R \ Ck);

                                                    k=1

thus  |R  \  C|  <  .

                    2
   For each m  Z, the sequence g1|(m,m+1), g2|(m,m+1), . . . converges pointwise
on (m, m + 1) to g|(m,m+1). Thus by Egorov's Theorem (2.85), for each m  Z,
there is a Borel set Em  (m, m + 1) such that g1, g2, . . . converges uniformly to g
on Em and
                                |(m, m + 1) \ Em| < |m|+3  .
                                                         2

Thus g1, g2, . . . converges uniformly to g on C  Em for each m  Z. Because each
gk|C is continuous, we conclude (using 2.84) that g|CEm is continuous for each
m  Z. Thus g|D is continuous, where

                                      D = (C  Em).

                                              mZ

Because             R\D  Z                (m, m + 1) \ Em              (R \ C),

                                      mZ

we have |R \ D| < .
   There exists a closed set F  D such that |D \ F| <  - |R \ D| (by 2.65). Now

                 |R \ F| = |(R \ D)  (D \ F)|  |R \ D| + |D \ F| < .

Because the restriction of a continuous function to a smaller domain is also continuous,
g|F is continuous, completing the proof.

   We need the following result to get another version of Luzin's Theorem.

  2.92 continuous extensions of continuous functions
    · Every continuous function on a closed subset of R can be extended to a
       continuous function on all of R.
    · More precisely, if F  R is closed and g : F  R is continuous, then there
       exists a continuous function h : R  R such that h|F = g.

Proof Suppose F  R is closed and g : F  R is continuous. Thus R \ F is the
union of a collection of disjoint open intervals {Ik}. For each such interval of the
form (a, ) or of the form (-, a), define h(x) = g(a) for all x in the interval.

                     Measure, Integration & Real Analysis, by Sheldon Axler
68 Chapter 2 Measures

   For each interval Ik of the form (b, c) with b < c and b, c  R, define h on [b, c]
to be the linear function such that h(b) = g(b) and h(c) = g(c).

   Define h(x) = g(x) for all x  R for which h(x) has not been defined by the
previous two paragraphs. Then h : R  R is continuous and h|F = g.

   The next result gives a slightly modified way to state Luzin's Theorem. You can
think of this version as saying that the value of a Borel measurable function can be
changed on a set with small Lebesgue measure to produce a continuous function.

  2.93 Luzin's Theorem, second version
  Suppose E  R and g : E  R is a Borel measurable function. Then for every
   > 0, there exists a closed set F  E and a continuous function h : R  R such
  that |E \ F| <  and h|F = g|F.
Proof Suppose  > 0. Extend g to a function g : R  R by defining

                              g(x) = g(x) if x  E, 0 if x  R \ E.
By the first version of Luzin's Theorem (2.91), there is a closed set C  R such
that |R \ C| <  and g|C is a continuous function on C. There exists a closed set
F  C  E such that |(C  E) \ F| <  - |R \ C| (by 2.65). Thus

       |E \ F|  (C  E) \ F  (R \ C)  |(C  E) \ F| + |R \ C| < .
   Now g|F is a continuous function on F. Also, g|F = g|F (because F  E) . Use
2.92 to extend g|F to a continuous function h : R  R.

The building at Moscow State University where the mathematics seminar organized
by Egorov and Luzin met. Both Egorov and Luzin had been students at Moscow State
 University and then later became faculty members at the same institution. Luzin's

                               PhD thesis advisor was Egorov.

                                                          CC-BY-SA A. Savin

                      Measure, Integration & Real Analysis, by Sheldon Axler
                     Section 2E Convergence of Measurable Functions     100 ln 2

Lebesgue Measurable Functions

2.94 Definition Lebesgue measurable function

A function f : A  R, where A  R, is called Lebesgue measurable if f -1(B)
is a Lebesgue measurable set for every Borel set B  R.

   If f : A  R is a Lebesgue measurable function, then A is a Lebesgue measurable
subset of R [because A = f -1(R)]. If A is a Lebesgue measurable subset of R, then
the definition above is the standard definition of an S-measurable function, where S
is the -algebra of all Lebesgue measurable subsets of A.

   The following list summarizes and reviews some crucial definitions and results:

· A Borel set is an element of the smallest -algebra on R that contains all the
   open subsets of R.

· A Lebesgue measurable set is an element of the smallest -algebra on R that
   contains all the open subsets of R and all the subsets of R with outer measure 0.

· The terminology Lebesgue set would make good sense in parallel to the termi-
   nology Borel set. However, Lebesgue set has another meaning, so we need to
   use Lebesgue measurable set.

· Every Lebesgue measurable set differs from a Borel set by a set with outer
   measure 0. The Borel set can be taken either to be contained in the Lebesgue
   measurable set or to contain the Lebesgue measurable set.

· Outer measure restricted to the -algebra of Borel sets is called Lebesgue
   measure.

· Outer measure restricted to the -algebra of Lebesgue measurable sets is also
   called Lebesgue measure.

· Outer measure is not a measure on the -algebra of all subsets of R.

· A function f : A  R, where A  R, is called Borel measurable if f -1(B) is a
   Borel set for every Borel set B  R.

· A function f : A  R, where A  R, is called Lebesgue measurable if f -1(B)
   is a Lebesgue measurable set for every Borel set B  R.

   Although there exist Lebesgue measur-    "Passing from Borel to Lebesgue
able sets that are not Borel sets, you are
unlikely to encounter one. Similarly, a      measurable functions is the work of
Lebesgue measurable function that is not
Borel measurable is unlikely to arise in     the devil. Don't even consider it!"
anything you do. A great way to simplify    -Barry Simon (winner of the
the potential confusion about Lebesgue      American Mathematical Society
measurable functions being defined by in-
verse images of Borel sets is to consider    Steele Prize for Lifetime
only Borel measurable functions.            Achievement), in his five-volume
                                             series A Comprehensive Course in
                                             Analysis

Measure, Integration & Real Analysis, by Sheldon Axler
70 Chapter 2 Measures

   The next result states that if we adopt  "He professes to have received no
the philosophy that what happens on a
set of outer measure 0 does not matter       sinister measure."
much, then we might as well restrict our    - Measure for Measure,
attention to Borel measurable functions.     by William Shakespeare

2.95 every Lebesgue measurable function is almost Borel measurable

Suppose f : R  R is a Lebesgue measurable function. Then there exists a Borel
measurable function g : R  R such that

                            |{x  R : g(x) = f (x)}| = 0.

Proof There exists a sequence f1, f2, . . . of Lebesgue measurable simple functions
from R to R converging pointwise on R to f (by 2.89). Suppose k  Z+. Then there
exist c1, . . . , cn  R and disjoint Lebesgue measurable sets A1, . . . , An  R such
that

                                fk = c1A1 + · · · + cnAn.
For each j  {1, . . . , n}, there exists a Borel set Bj  Aj such that |Aj \ Bj| = 0
[by the equivalence of (a) and (d) in 2.71]. Let

                     gk = c1B1 + · · · + cnBn.

Then gk is a Borel measurable function and |{x  R : gk(x) = fk(x)}| = 0.
If x /   {x       :  gk(x)  =  fk(x)},      then  gk(x)     fk(x)  for  all  k    Z+  and
               R                                         =
        k=1
hence limk gk(x) = f (x). Let

                         E = {x  R : lim gk(x) exists in R}.

                                                         k

Then E is a Borel subset of R [by Exercise 14(b) in Section 2B]. Also,

                                                   

                         R \ E  {x  R : gk(x) = fk(x)}

                                                k=1

and thus |R \ E| = 0. For x  R, let

2.96                 g(x) = lim (Egk)(x).
                                     k

If x  E, then the limit above exists by the definition of E; if x  R \ E, then the
limit above exists because (Egk)(x) = 0 for all k  Z+.

   For each k  Z+, the function Egk is Borel measurable. Thus 2.96 implies that g
is a Borel measurable function (by 2.48). Because

                                                                  

              {x  R : g(x) = f (x)}  {x  R : gk(x) = fk(x)},

                                                              k=1

we have |{x  R : g(x) = f (x)}| = 0, completing the proof.

        Measure, Integration & Real Analysis, by Sheldon Axler
                               Section 2E Convergence of Measurable Functions 71

EXERCISES 2E

 1 Suppose X is a finite set. Explain why a sequence of functions from X to R that
     converges pointwise on X also converges uniformly on X.

 2 Give an example of a sequence of functions from Z+ to R that converges
     pointwise on Z+ but does not converge uniformly on Z+.

 3 Give an example of a sequence of continuous functions f1, f2, . . . from [0, 1] to
     R that converges pointwise to a function f : [0, 1]  R that is not a bounded
     function.

 4 Prove or give a counterexample: If A  R and f1, f2, . . . is a sequence of
     uniformly continuous functions from A to R that converges uniformly to a
     function f : A  R, then f is uniformly continuous on A.

 5 Give an example to show that Egorov's Theorem can fail without the hypothesis
     that µ(X) < .

 6 Suppose (X, S, µ) is a measure space with µ(X) < . Suppose f1, f2, . . . is a
     sequence of S-measurable functions from X to R such that limk fk(x) = 
     for each x  X. Prove that for every  > 0, there exists a set E  S such that
     µ(X \ E) <  and f1, f2, . . . converges uniformly to  on E (meaning that for
     every t > 0, there exists n  Z+ such that fk(x) > t for all integers k  n and
     all x  E).
     [The exercise above is an Egorov-type theorem for sequences of functions that
     converge pointwise to .]

 7 Suppose F is a closed bounded subset of R and g1, g2, . . . is an increasing
     sequence of continuous real-valued functions on F (thus g1(x)  g2(x)  · · ·
     for all x  F) such that sup{g1(x), g2(x), . . .} <  for each x  F. Define a
     real-valued function g on F by
                                       g(x) = lim gk(x).

                                                                 k

     Prove that g is continuous on F if and only if g1, g2, . . . converges uniformly on
      F to g.
     [The result above is called Dini's Theorem.]
 8 Suppose µ is the measure on (Z+, 2Z+ ) defined by

                               µ(E) =  n1 .

                                                      nE 2
     Prove that for every  > 0, there exists a set E  Z+ with µ(Z+ \ E) < 
     such that f1, f2, . . . converges uniformly on E for every sequence of functions
      f1, f2, . . . from Z+ to R that converges pointwise on Z+.
     [This result does not follow from Egorov's Theorem because here we are asking
     for E to depend only on . In Egorov's Theorem, E depends on  and on the
     sequence f1, f2, . . . .]

                     Measure, Integration & Real Analysis, by Sheldon Axler
72 Chapter 2 Measures

9 Suppose F1, . . . , Fn are disjoint closed subsets of R. Prove that if

                       g : F1  · · ·  Fn  R

      is a function such that g|Fk is a continuous function for each k  {1, . . . , n},
      then g is a continuous function.
10 Suppose F  R is such that every continuous function from F to R can be
      extended to a continuous function from R to R. Prove that F is a closed subset
      of R.

11 Prove or give a counterexample: If F  R is such that every bounded continuous
      function from F to R can be extended to a continuous function from R to R,
      then F is a closed subset of R.

12 Give an example of a Borel measurable function f from R to R such that there
      does not exist a set B  R such that |R \ B| = 0 and f |B is a continuous
      function on B.

13 Prove or give a counterexample: If ft : R  R is a Borel measurable function
      for each t  R and f : R  (-, ] is defined by

                       f (x) = sup{ ft(x) : t  R},

then f is a Borel measurable function.

14 Suppose b1, b2, . . . is a sequence of real numbers. Define f : R  [0, ] by

                                  1
                                           if x / {b1, b2, . . .},
f (x) =                     4k|x  -  bk |  if x  {b1, b2, . . .}.
                       k=1
         

      Prove that |{x  R : f (x) < 1}| = .
      [This exercise is a variation of a problem originally considered by Borel. If
      b1, b2, . . . contains all the rational numbers, then it is not even obvious that
      {x  R : f (x) < } = .]
15 Suppose B is a Borel set and f : B  R is a Lebesgue measurable function.
      Show that there exists a Borel measurable function g : B  R such that

         |{x  B : g(x) = f (x)}| = 0.

Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 3

             Integration

To remedy deficiencies of Riemann integration that were discussed in Section 1B,
in the last chapter we developed measure theory as an extension of the notion of the
length of an interval. Having proved the fundamental results about measures, we are
now ready to use measures to develop integration with respect to a measure.

   As we will see, this new method of integration fixes many of the problems with
Riemann integration. In particular, we will develop good theorems for interchanging
limits and integrals.

                         Statue in Milan of Maria Gaetana Agnesi,
                who in 1748 published one of the first calculus textbooks.
             A translation of her book into English was published in 1801.
          In this chapter, we develop a method of integration more powerful
                 than methods contemplated by the pioneers of calculus.

                                                          ©Giovanni Dall'Orto

                                                                                                             73
                     Measure, Integration & Real Analysis, by Sheldon Axler
74 Chapter 3 Integration

3A Integration with Respect to a Measure

Integration of Nonnegative Functions

We will first define the integral of a nonnegative function with respect to a measure.
Then by writing a real-valued function as the difference of two nonnegative functions,
we will define the integral of a real-valued function with respect to a measure. We
begin this process with the following definition.

3.1 Definition S-partition

Suppose S is a -algebra on a set X. An S-partition of X is a finite collection
A1, . . . , Am of disjoint sets in S such that A1  · · ·  Am = X.

   The next definition should remind you  We adopt the convention that 0 · 
of the definition of the lower Riemann
sum (see 1.3). However, now we are and  · 0 should both be interpreted
working with an arbitrary measure and to be 0.
thus X need not be a subset of R. More importantly, even in the case when X is a
closed interval [a, b] in R and µ is Lebesgue measure on the Borel subsets of [a, b],
the sets A1, . . . , Am in the definition below do not need to be subintervals of [a, b] as
they do for the lower Riemann sum--they need only be Borel sets.

3.2 Definition lower Lebesgue sum

Suppose (X, S, µ) is a measure space, f : X  [0, ] is an S-measurable
function, and P is an S-partition A1, . . . , Am of X. The lower Lebesgue sum
L( f , P) is defined by

                            m
L( f , P) =  µ(Aj) inf f .
                            j=1           Aj

   Suppose (X, S, µ) is a measure space. We will denote the integral of an S-
measurable function f with respect to µ by f dµ. Our basic requirements for
an integral are that we want E dµ to equal µ(E) for all E  S, and we want

  ( f + g) dµ = f dµ + g dµ. As we will see, the following definition satisfies
both of those requirements (although this is not obvious). Think about why the
following definition is reasonable in terms of the integral equaling the area under the
graph of the function (in the special case of Lebesgue measure on an interval of R).

3.3 Definition integral of a nonnegative function
Suppose (X, S, µ) is a measure space and f : X  [0, ] is an S-measurable
function. The integral of f with respect to µ, denoted f dµ, is defined by

f dµ = sup{L( f , P) : P is an S-partition of X}.

Measure, Integration & Real Analysis, by Sheldon Axler
                       Section 3A Integration with Respect to a Measure 75

Suppose (X, S, µ) is a measure space and f : X  [0, ] is an S-measurable
function. Each S-partition A1, . . . , Am of X leads to an approximation of f from
below  by  the  S  -measurable  simple  function               m  inf f  A . This suggests that
                                                                  Aj     j
                                                            j=1

                                        m
                                       µ(Aj) inf f
                                      j=1                   Aj

should be an approximation from below of our intuitive notion of f dµ. Taking the
supremum of these approximations leads to our definition of f dµ.

   The following result gives our first example of evaluating an integral.

3.4 integral of a characteristic function
Suppose (X, S, µ) is a measure space and E  S. Then

                                        E dµ = µ(E).

Proof If P is the S-partition of X con-                     The symbol d in the expression
sisting of E and its complement X \ E,                         f dµ has no independent meaning,
then clearly L(E , P) = µ(E). Thus
                                                            but it often usefully separates f from
  E dµ  µ(E).                                               µ. Because the d in f dµ does not
   To prove the inequality in the other                     represent another object, some
direction, suppose P is an S-partition
A1, . . . , Am of X. Then µ(Aj) inf E                       mathematicians prefer typesetting
                                                            an upright d in this situation,
                                                        Aj  producing f dµ. However, the
                                                            upright d looks jarring to some
equals µ(Aj) if Aj  E and equals 0                          readers who are accustomed to
otherwise. Thus
                                                            italicized symbols. This book takes
L(E , P) =  µ(Aj)
                                                            the compromise position of using
                    {j : AjE}
                                                            slanted d instead of math-mode
                   =µ             Aj                        italicized d in integrals.

                       {j : AjE}

                    µ(E).

Thus E dµ  µ(E), completing the proof.

3.5 Example integrals of Q and [0, 1] \ Q
   Suppose  is Lebesgue measure on R. As a special case of the result above, we

have Q d = 0 (because |Q| = 0). Recall that Q is not Riemann integrable on
[0, 1]. Thus even at this early stage in our development of integration with respect to
a measure, we have fixed one of the deficiencies of Riemann integration.

   Note also that 3.4 implies that [0, 1] \ Q d = 1 (because |[0, 1] \ Q| = 1),
which is what we want. In contrast, the lower Riemann integral of [0, 1] \ Q on [0, 1]
equals 0, which is not what we want.

                   Measure, Integration & Real Analysis, by Sheldon Axler
76 Chapter 3 Integration

3.6 Example integration with respect to counting measure is summation
   Suppose µ is counting measure on Z+ and b1, b2, . . . is a sequence of nonnegative

numbers. Think of b as the function from Z+ to [0, ) defined by b(k) = bk. Then

                                                                       

                               b dµ =  bk,

                                                                  k=1

as you should verify.

   Integration with respect to a measure can be called Lebesgue integration. The
next result shows that Lebesgue integration behaves as expected on simple functions
represented as linear combinations of characteristic functions of disjoint sets.

3.7 integral of a simple function

Suppose (X, S, µ) is a measure space, E1, . . . , En are disjoint sets in S, and
c1, . . . , cn  [0, ]. Then

       n                                           n

       ckEk                             dµ =  ckµ(Ek).

      k=1                                        k=1

Proof Without loss of generality, we can assume that E1, . . . , En is an S-partition of
X [by replacing n by n + 1 and setting En+1 = X \ (E1  . . .  En) and cn+1 = 0].
If P is the S-partition E1, . . . , En of X, then L nk=1 ckEk, P = nk=1 ckµ(Ek).
Thus
      n                                        n
       ckEk dµ   ckµ(Ek).
      k=1                                      k=1

   To prove the inequality in the other direction, suppose that P is an S-partition
A1, . . . , Am of X. Then

             n                     m
                          =  µ(Aj) min ci
      L  ckEk , P                  j=1         {i : AjEi =}

           k=1

                                   mn
                          =   µ(Aj  Ek) min ci
                                   j=1 k=1          {i : AjEi =}

                               mn

                             µ(Aj  Ek)ck

                              j=1 k=1

                                   n        m
                          =  ck  µ(Aj  Ek)
                                   k=1 j=1

                                n

                          =  ckµ(Ek).

                              k=1

The inequality above implies that  nk=1 ckEk dµ  nk=1 ckµ(Ek), completing
the proof.

      Measure, Integration & Real Analysis, by Sheldon Axler
       Section 3A Integration with Respect to a Measure 77

The next easy result gives an unsurprising property of integrals.

3.8 integration is order preserving

Suppose (X, S, µ) is a measure space and f , g : X  [0, ] are S-measurable
functions such that f (x)  g(x) for all x  X. Then f dµ  g dµ.

Proof  Suppose P is an S-partition A1, . . . , Am of X. Then

       inf f  inf g
       Aj                            Aj

for each j = 1, . . . , m. Thus L( f , P)  L(g, P). Hence f dµ     g dµ.

Monotone Convergence Theorem

For the proof of the Monotone Convergence Theorem (and several other results), we
will need to use the following mild restatement of the definition of the integral of a
nonnegative function.

  3.9 integrals via finite simple functions

  Suppose (X, S, µ) is a measure space and f : X  [0, ] is S-measurable. Then

                                         m

 3.10 f dµ = sup  cjµ(Aj) : A1, . . . , Am are disjoint sets in S,

                                      j=1

                                             c1, . . . , cm  [0, ), and

                                                                             m

                                  f (x)   cjA (x) for every x  X .

                                                                         j=1 j

Proof First note that the left side of 3.10 is bigger than or equal to the right side by
3.7 and 3.8.

   To prove that the right side of 3.10 is bigger than or equal to the left side, first
assume that inf f <  for every A  S with µ(A) > 0. Then for P an S-partition

                     A

A1, . . . , Am of nonempty subsets of X, take cj = inf f , which shows that L( f , P) is

                                                                               Aj

in the set on the right side of 3.10. Thus the definition of f dµ shows that the right
side of 3.10 is bigger than or equal to the left side.

   The only remaining case to consider is when there exists a set A  S such that
µ(A) > 0 and inf f =  [which implies that f (x) =  for all x  A]. In this case,

                         A

for arbitrary t  (0, ) we can take m = 1, A1 = A, and c1 = t. These choices
show that the right side of 3.10 is at least tµ(A). Because t is an arbitrary positive
number, this shows that the right side of 3.10 equals , which of course is greater
than or equal to the left side, completing the proof.

   The next result allows us to interchange limits and integrals in certain circum-
stances. We will see more theorems of this nature in the next section.

                     Measure, Integration & Real Analysis, by Sheldon Axler
78 Chapter 3 Integration

3.11 Monotone Convergence Theorem

Suppose (X, S, µ) is a measure space and 0  f1  f2  · · · is an increasing
sequence of S-measurable functions. Define f : X  [0, ] by

Then           f (x) = lim fk(x).

                            k

            lim fk dµ = f dµ.

            k

Proof The function f is S-measurable by 2.53.
   Because fk(x)  f (x) for every x  X, we have fk dµ  f dµ for each

k  Z+ (by 3.8). Thus limk fk dµ  f dµ.
   To prove the inequality in the other direction, suppose A1, . . . , Am are disjoint

sets in S and c1, . . . , cm  [0, ) are such that

                                                 m

                   f (x)   cjA (x) for every x  X.

3.12

                                                                                             j

                                              j=1

Let t  (0, 1). For k  Z+, let

      Ek =                                 m

            x  X : fk(x)  t  cjAj(x) .

                                         j=1

Then E1  E2  · · · is an increasing sequence of sets in S whose union equals X.
Thus limk µ(Aj  Ek) = µ(Aj) for each j  {1, . . . , m} (by 2.59).

   If k  Z+, then

                                                             m

                         fk(x)   tcjAj  Ek(x)

                                                          j=1

for every x  X. Thus (by 3.9)

                                                                m

                         fk dµ  t  cjµ(Aj  Ek).

                                                            j=1

Taking the limit as k   of both sides of the inequality above gives

                                   m
            lim fk dµ  t  cjµ(Aj).
            k                      j=1

Now taking the limit as t increases to 1 shows that

                                   m
            lim fk dµ   cjµ(Aj).
            k                      j=1

Taking the supremum of the inequality above over all S-partitions A1, . . . , Am
of X and all c1, . . . , cm  [0, ) satisfying 3.12 shows (using 3.9) that we have
limk fk dµ  f dµ, completing the proof.

      Measure, Integration & Real Analysis, by Sheldon Axler
                                   Section 3A Integration with Respect to a Measure 79

   The proof that the integral is additive will use the Monotone Convergence Theorem
and our next result. The representation of a simple function h : X  [0, ] in the
form nk=1 ckEk is not unique. Requiring the numbers c1, . . . , cn to be distinct and
E1, . . . , En to be nonempty and disjoint with E1  · · ·  En = X produces what
is called the standard representation of a simple function [take Ek = h-1({ck}),
where c1, . . . , cn are the distinct values of h]. The following lemma shows that all
representations (including representations with sets that are not disjoint) of a simple
measurable function give the same sum that we expect from integration.

3.13 integral-type sums for simple functions

Suppose (X, S, µ) is a measure space. Suppose a1, . . . , am, b1, . . . , bn  [0, ]
and A1, . . . , Am, B1, . . . , Bn  S are such that mj=1 ajAj = nk=1 bkBk. Then

                                       m                    n
                                       ajµ(Aj) =  bkµ(Bk).
                                      j=1                   k=1

Proof We assume A1  · · ·  Am = X (otherwise add the term 0X \ (A1  · · ·  Am)).
   Suppose A1 and A2 are not disjoint. Then we can write

3.14             a1A1 + a2A2 = a1A1 \ A2 + a2A2 \ A1 + (a1 + a2)A1  A2 ,

where the three sets appearing on the right side of the equation above are disjoint.
   Now A1 = (A1 \ A2)  (A1  A2) and A2 = (A2 \ A1)  (A1  A2); each

of these unions is a disjoint union. Thus µ(A1) = µ(A1 \ A2) + µ(A1  A2) and
µ(A2) = µ(A2 \ A1) + µ(A1  A2). Hence

a1µ(A1) + a2µ(A2) = a1µ(A1 \ A2) + a2µ(A2 \ A1) + (a1 + a2)µ(A1  A2).

The equation above, in conjunction with 3.14, shows that if we replace the two
sets A1, A2 by the three disjoint sets A1 \ A2, A2 \ A1, A1  A2 and make the
appropriate adjustments to the coefficients a1, . . . , am, then the value of the sum
   m     aj      Aj     is  unchanged  (although    m   has  increased  by   1).
             µ(      )
j=1
     Repeating this process with all pairs of subsets among A1, . . . , Am that are
not disjoint after each step, in a finite number of steps we can convert the ini-
tial list A1, . . . , Am into a disjoint list of subsets without changing the value of
   m     aj      Aj  ).
             µ(
j=1
     The next step is to make the numbers a1, . . . , am distinct. This is done by replacing
the sets corresponding to each aj by the union of those sets, and using finite additivity
of  the  measure            to  show  that  the  value  of  the  sum      m  aj      Aj     does  not  change.
                         µ                                                       µ(      )
                                                                       j=1
     Finally, drop any terms for which Aj = , getting the standard representation
for  a  simple   function.      We    have    now  shown    that  the  original   value     of     m   ajµ(Aj)

                                                                                                j=1
is equal to the value if we use the standard representation of the simple function
mj=1 ajAj. The same procedure can be used with the representation nk=1 bkBk to
show     that     n      bk  µ(Bk     equals  what  we  would     get  with  the  standard      representation.
                                   )
               k=1
Thus the equality of the functions mj=1 ajAj and nk=1 bkBk implies the equality
   m     ajµ(Aj)               n   bk µ( Bk ).
                         =
j=1                         k=1

                         Measure, Integration & Real Analysis, by Sheldon Axler
80 Chapter 3 Integration

   Now we can show that our definition         If we had already proved that
of integration does the right thing with
simple measurable functions that might         integration is linear, then we could
not be expressed in the standard represen-
tation. The result below differs from 3.7      quickly get the conclusion of the
mainly because the sets E1, . . . , En in the
result below are not required to be dis-       previous result by integrating both
joint. Like the previous result, the next
result would follow immediately from the       sides of the equation
linearity of integration if that property had     m                 n
already been proved.                                 ajAj     =         bk Bk  with
                                               j=1               k=1

                                               respect to µ. However, we need the

                                               previous result to prove the next

                                               result, which is used in our proof

                                               that integration is linear.

3.15 integral of a linear combination of characteristic functions

Suppose (X, S, µ) is a measure space, E1, . . . , En  S, and c1, . . . , cn  [0, ].
Then
         n                                     n
          ckEk dµ =  ckµ(Ek).
         k=1                                   k=1

Proof The desired result follows from writing the simple function nk=1 ckEk in
the standard representation for a simple function and then using 3.7 and 3.13.

Now we can prove that integration is additive on nonnegative functions.

3.16 additivity of integration

Suppose (X, S, µ) is a measure space and f , g : X  [0, ] are S-measurable
functions. Then

                            ( f + g) dµ = f dµ + g dµ.

Proof The desired result holds for simple nonnegative S-measurable functions (by
3.15). Thus we approximate by such functions.

   Specifically, let f1, f2, . . . and g1, g2, . . . be increasing sequences of simple non-
negative S-measurable functions such that

      lim fk(x) = f (x) and lim gk(x) = g(x)
      k                                        k

for all x  X (see 2.89 for the existence of such increasing sequences). Then

      ( f + g) dµ = lim ( fk + gk) dµ

                            k

                          = lim                fk dµ + lim       gk dµ

                              k                            k

                          = f dµ + g dµ,

where the first and third equalities follow from the Monotone Convergence Theorem
and the second equality holds by 3.15.

      Measure, Integration & Real Analysis, by Sheldon Axler
                                 Section 3A Integration with Respect to a Measure 81

   The lower Riemann integral is not additive, even for bounded nonnegative measur-
able functions. For example, if f = Q  [0, 1] and g = [0, 1] \ Q, then

        L( f , [0, 1]) = 0 and L(g, [0, 1]) = 0 but L( f + g, [0, 1]) = 1.
In contrast, if  is Lebesgue measure on the Borel subsets of [0, 1], then

                f d = 0 and g d = 1 and ( f + g) d = 1.
More generally, we have just proved that ( f + g) dµ = f dµ + g dµ for
every measure µ and for all nonnegative measurable functions f and g. Recall that
integration with respect to a measure is defined via lower Lebesgue sums in a similar
fashion to the definition of the lower Riemann integral via lower Riemann sums
(with the big exception of allowing measurable sets instead of just intervals in the
partitions). However, we have just seen that the integral with respect to a measure
(which could have been called the lower Lebesgue integral) has considerably nicer
behavior (additivity!) than the lower Riemann integral.

Integration of Real-Valued Functions

The following definition gives us a standard way to write an arbitrary real-valued
function as the difference of two nonnegative functions.

  3.17 Definition f +; f -
  Suppose f : X  [-, ] is a function. Define functions f + and f - from X to
  [0, ] by

    f +(x) = f (x) if f (x)  0, 0 if f (x) < 0 and f -(x) = 0 if f (x)  0, - f (x) if f (x) < 0.

   Note that if f : X  [-, ] is a function, then
                          f = f + - f - and | f | = f + + f -.

The decomposition above allows us to extend our definition of integration to functions
that take on negative as well as positive values.

  3.18 Definition integral of a real-valued function; f dµ
  Suppose (X, S, µ) is a measure space and f : X  [-, ] is an S-measurable
  function such that at least one of f + dµ and f - dµ is finite. The integral of
  f with respect to µ, denoted f dµ, is defined by

                                 f dµ = f + dµ - f - dµ.

   If f  0, then f + = f and f - = 0; thus this definition is consistent with the
previous definition of the integral of a nonnegative function.

                     Measure, Integration & Real Analysis, by Sheldon Axler
82 Chapter 3 Integration

The condition | f | dµ <  is equivalent to the condition  f + dµ <  and
f - dµ <  (because | f | = f + + f -).

3.19 Example a function whose integral is not defined
   Suppose  is Lebesgue measure on R and f : R  R is the function defined by
                                  f (x) = 1 if x  0, -1 if x < 0.

Then f d is not defined because f + d =  and f - d = .

   The next result says that the integral of a number times a function is exactly what
we expect.

3.20 integration is homogeneous
Suppose (X, S, µ) is a measure space and f : X  [-, ] is a function such
that f dµ is defined. If c  R, then

                                     c f dµ = c f dµ.

Proof First consider the case where f is a nonnegative function and c  0. If P is
an S-partition of X, then clearly L(c f , P) = cL( f , P). Thus c f dµ = c f dµ.

   Now consider the general case where f takes values in [-, ]. Suppose c  0.
Then

                             c f dµ = (c f )+ dµ - (c f )- dµ

                          = c f + dµ - c f - dµ

                          = c f + dµ - f - dµ

                                    = c f dµ,
where the third line follows from the first paragraph of this proof.

   Finally, now suppose c < 0 (still assuming that f takes values in [-, ]). Then
-c > 0 and

                           c f dµ = (c f )+ dµ - (c f )- dµ

                       = (-c) f - dµ - (-c) f + dµ

                       = (-c) f - dµ - f + dµ

                       = c f dµ,

completing the proof.

Measure, Integration & Real Analysis, by Sheldon Axler
                       Section 3A Integration with Respect to a Measure 83

   Now we prove that integration with respect to a measure has the additive property
required for a good theory of integration.

3.21 additivity of integration
Suppose (X, S, µ) is a measure space and f , g : X  R are S-measurable
functions such that | f | dµ <  and |g| dµ < . Then

                            ( f + g) dµ = f dµ + g dµ.

Proof Clearly

               ( f + g)+ - ( f + g)- = f + g

                                      = f + - f - + g+ - g-.

Thus           ( f + g)+ + f - + g- = ( f + g)- + f + + g+.

Both sides of the equation above are sums of nonnegative functions. Thus integrating
both sides with respect to µ and using 3.16 gives

( f + g)+ dµ + f - dµ + g- dµ = ( f + g)- dµ + f + dµ + g+ dµ.

Rearranging the equation above gives

( f + g)+ dµ - ( f + g)- dµ = f + dµ - f - dµ + g+ dµ - g- dµ,

where the left side is not of the form  -  because ( f + g)+  f + + g+ and
( f + g)-  f - + g-. The equation above can be rewritten as

( f + g) dµ = f dµ + g dµ,            Gottfried Leibniz (1646-1716)
                                      invented the symbol to denote

completing the proof.                 integration in 1675.

The next result resembles 3.8, but now the functions are allowed to be real valued.

  3.22 integration is order preserving

  Suppose (X, S, µ) is a measure space and f , g : X  R are S-measurable
  functions such that f dµ and g dµ are defined. Suppose also that f (x)  g(x)
  for all x  X. Then f dµ  g dµ.

Proof The cases where f dµ = ± or g dµ = ± are left to the reader. Thus
we assume that | f | dµ <  and |g| dµ < .

   The additivity (3.21) and homogeneity (3.20 with c = -1) of integration imply
that

                               g dµ - f dµ = (g - f ) dµ.
The last integral is nonnegative because g(x) - f (x)  0 for all x  X.

               Measure, Integration & Real Analysis, by Sheldon Axler
84 Chapter 3 Integration

The inequality in the next result receives frequent use.

3.23 absolute value of integral  integral of absolute value
Suppose (X, S, µ) is a measure space and f : X  [-, ] is a function such
that f dµ is defined. Then

                                      f dµ  | f | dµ.

Proof Because f dµ is defined, f is an S-measurable function and at least one of
   f + dµ and f - dµ is finite. Thus

              f dµ =       f + dµ - f - dµ
                          f + dµ + f - dµ
                    =     ( f + + f -) dµ

                          = | f | dµ,

as desired.

EXERCISES 3A

1 Suppose (X, S, µ) is a measure space and f : X  [0, ] is an S-measurable
    function such that f dµ < . Explain why

                          inf f = 0

                           E

for each set E  S with µ(E) = .

2 Suppose X is a set, S is a -algebra on X, and c  X. Define the Dirac measure
    c on (X, S ) by
                                    c(E) = 1 if c  E, 0 if c / E.

Prove that if f : X  [0, ] is S-measurable, then          f dc = f (c).
[Careful: {c} may not be in S.]

3 Suppose (X, S, µ) is a measure space and f : X  [0, ] is an S-measurable
    function. Prove that

             f dµ > 0 if and only if µ({x  X : f (x) > 0}) > 0.

             Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 3A Integration with Respect to a Measure 85

4 Give an example of a Borel measurable function f : [0, 1]  (0, ) such that
    L( f , [0, 1]) = 0.
    [Recall that L( f , [0, 1]) denotes the lower Riemann integral, which was defined
    in Section 1A. If  is Lebesgue measure on [0, 1], then the previous exercise
    states that f d > 0 for this function f , which is what we expect of a positive
    function. Thus even though both L( f , [0, 1]) and f d are defined by taking
    the supremum of approximations from below, Lebesgue measure captures the
    right behavior for this function f and the lower Riemann integral does not.]

5 Verify the assertion that integration with respect to counting measure is summa-
    tion (Example 3.6).

6 Suppose (X, S, µ) is a measure space, f : X  [0, ] is S-measurable, and P
    and P are S-partitions of X such that each set in P is contained in some set in
    P. Prove that L( f , P)  L( f , P).

7 Suppose X is a set, S is the -algebra of all subsets of X, and w : X  [0, ]
    is a function. Define a measure µ on (X, S ) by

                             µ(E) =  w(x)

                                                                 xE

    for E  X. Prove that if f : X  [0, ] is a function, then

                            f dµ =  w(x) f (x),

                                                              xX

    where the infinite sums above are defined as the supremum of all sums over
    finite subsets of E (first sum) or X (second sum).
8 Suppose  denotes Lebesgue measure on R. Give an example of a sequence
     f1, f2, . . . of simple Borel measurable functions from R to [0, ) such that
    limk fk(x) = 0 for every x  R but limk fk d = 1.
9 Suppose µ is a measure on a measurable space (X, S ) and f : X  [0, ] is an
    S-measurable function. Define  : S  [0, ] by

                                 (A) = A f dµ

for A  S. Prove that  is a measure on (X, S ).

10 Suppose (X, S, µ) is a measure space and f1, f2, . . . is a sequence of nonnegative
S -measurable   functions.  Define  f  :  X    [0, ]  by  f (x)          fk(x).  Prove
                                                                 =
                                                                    k=1
that 
                                 f dµ =  fk dµ.
                                             k=1

11 Suppose (X, S, µ) is a measure space and f1, f2, . . . are S-measurable functions
from  X  to     such  that       | fk| dµ < . Prove that there exists E  S such
             R
                            k=1
that µ(X \ E) = 0 and limk fk(x) = 0 for every x  E.

             Measure, Integration & Real Analysis, by Sheldon Axler
86 Chapter 3 Integration

12 Show that there exists a Borel measurable function f : R  (0, ) such that
        I f d =  for every nonempty open interval I  R, where  denotes

      Lebesgue measure on R.

13 Give an example to show that the Monotone Convergence Theorem (3.11) can
      fail if the hypothesis that f1, f2, . . . are nonnegative functions is dropped.

14 Give an example to show that the Monotone Convergence Theorem can fail if
      the hypothesis of an increasing sequence of functions is replaced by a hypothesis
      of a decreasing sequence of functions.
      [This exercise shows that the Monotone Convergence Theorem should be called
      the Increasing Convergence Theorem. However, see Exercise 20.]

15 Suppose  is Lebesgue measure on R and f : R  [-, ] is a Borel measur-
      able function such that f d is defined.

(a) For t  R, define ft : R  [-, ] by ft(x) = f (x - t). Prove that
        ft d = f d for all t  R.

(b) For t  R, define ft : R  [-, ] by ft(x) = f (tx). Prove that
ft d = 1          f d for all t  R \ {0}.

             |t|

16 Suppose S and T are -algebras on a set X and S  T . Suppose µ1 is a
      measure on (X, S ), µ2 is a measure on (X, T ), and µ1(E) = µ2(E) for all
      E  S. Prove that if f : X  [0, ] is S-measurable, then f dµ1 = f dµ2.

For x1, x2, . . . a sequence in [-, ], define lim inf xk by

                                                                           k

                  lim inf xk = lim inf{xk, xk+1, . . .}.
                  k       k

Note that inf{xk, xk+1, . . .} is an increasing function of k; thus the limit above
on the right exists in [-, ].

17 Suppose that (X, S, µ) is a measure space and f1, f2, . . . is a sequence of non-
      negative S-measurable functions on X. Define a function f : X  [0, ] by
      f (x) = lim inf fk(x).

                      k

(a) Show that f is an S-measurable function.

(b) Prove that

                          f dµ  lim inf fk dµ.

                                       k

(c) Give an example showing that the inequality in (b) can be a strict inequality
     even when µ(X) <  and the family of functions { fk}kZ+ is uniformly
     bounded.

[The result in (b) is called Fatou's Lemma. Some textbooks prove Fatou's Lemma
and then use it to prove the Monotone Convergence Theorem. Here we are taking

the reverse approach--you should be able to use the Monotone Convergence
Theorem to give a clean proof of Fatou's Lemma.]

Measure, Integration & Real Analysis, by Sheldon Axler
Section 3A Integration with Respect to a Measure 87

18 Give an example of a sequence x1, x2, . . . of real numbers such that

          n

lim  xk exists in R,

n k=1

but x dµ is not defined, where µ is counting measure on Z+ and x is the
function from Z+ to R defined by x(k) = xk.

19 Show that if (X, S, µ) is a measure space and f : X  [0, ) is S-measurable,
      then

µ(X) inf f                       f dµ  µ(X) sup f .

          X                                              X

20 Suppose (X, S, µ) is a measure space and f1, f2, . . . is a monotone (meaning
      either increasing or decreasing) sequence of S-measurable functions. Define
      f : X  [-, ] by
                                        f (x) = lim fk(x).

                                                                 k

Prove that if | f1| dµ < , then

                                      lim fk dµ = f dµ.

                                                 k

21 Henri Lebesgue wrote the following about his method of integration:
             I have to pay a certain sum, which I have collected in my pocket. I
             take the bills and coins out of my pocket and give them to the creditor
             in the order I find them until I have reached the total sum. This is the
             Riemann integral. But I can proceed differently. After I have taken
             all the money out of my pocket I order the bills and coins according
             to identical values and then I pay the several heaps one after the other
             to the creditor. This is my integral.

      Use 3.15 to explain what Lebesgue meant and to explain why integration of a
      function with respect to a measure can be thought of as partitioning the range of
      the function, in contrast to Riemann integration, which depends on partitioning
      the domain of the function.
      [The quote above is taken from page 796 of The Princeton Companion to
      Mathematics, edited by Timothy Gowers.]

Measure, Integration & Real Analysis, by Sheldon Axler
88 Chapter 3 Integration

3B Limits of Integrals & Integrals of Limits

The theorems about interchanging limits and integrals that we prove in this section
allow us to characterize the Riemann integrable functions. We also develop good
approximation tools that will be useful in later chapters.

Bounded Convergence Theorem

We begin this section by introducing some useful notation.

3.24 Definition integration on a subset; E f dµ
Suppose (X, S, µ) is a measure space and E  S. If f : X  [-, ] is an
S-measurable function, then E f dµ is defined by

                                f dµ =         E f dµ

                              E

if the right side of the equation above is defined; otherwise  E f dµ is undefined.

   Alternatively, you can think of E f dµ as f |E dµE, where µE is the measure
obtained by restricting µ to the elements of S that are contained in E.

   Notice that according to the definition above, the notation X f dµ means the same
as f dµ. The following easy result illustrates the use of this new notation.

3.25 bounding an integral

Suppose (X, S, µ) is a measure space, E  S, and f : X  [-, ] is a
function such that E f dµ is defined. Then

                           E  f dµ  µ(E) sup| f |.
                                               E

Proof  Let c = sup| f |. We have

                      E                        E f dµ

                                     f dµ =

                                            E

                               E| f | dµ

                                               cE dµ
                                              = cµ(E),
where the second line comes from 3.23, the third line comes from 3.8, and the fourth
line comes from 3.15.

       Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 3B Limits of Integrals & Integrals of Limits 89

   The next result could be proved as a special case of the Dominated Convergence
Theorem (3.31), which we prove later in this section. Thus you could skip the proof
here. However, sometimes you get more insight by seeing an easier proof of an
important special case. Thus you may want to read the easy proof of the Bounded
Convergence Theorem that is presented next.

3.26 Bounded Convergence Theorem

Suppose (X, S, µ) is a measure space with µ(X) < . Suppose f1, f2, . . . is a
sequence of S-measurable functions from X to R that converges pointwise on X
to a function f : X  R. If there exists c  (0, ) such that

                                       | fk(x)|  c
for all k  Z+ and all x  X, then

                           lim fk dµ = f dµ.

                           k

Proof The function f is S-measurable            Note the key role of Egorov's
by 2.48.                                        Theorem, which states that pointwise
Suppose c satisfies the hypothesis of           convergence is close to uniform
this theorem. Let  > 0. By Egorov's             convergence, in proofs involving
Theorem (2.85), there exists E  S such          interchanging limits and integrals.
that µ(X \ E)         and  f1, f2, . . .  con-
               <  4c

verges uniformly to f on E. Now

          fk dµ - f dµ = X\E fk dµ - X\E f dµ + E( fk - f ) dµ

                            X\E| fk| dµ + X\E| f | dµ +  E| fk - f | dµ

                           2<  + µ(E) sup| fk - f |,
                                                E

where the last inequality follows from 3.25. Because f1, f2, . . . converges uniformly
to f on E and µ(E) < , the right side of the inequality above is less than  for k
sufficiently large, which completes the proof.

Sets of Measure 0 in Integration Theorems

Suppose (X, S, µ) is a measure space. If f , g : X  [-, ] are S-measurable
functions and

                             µ({x  X : f (x) = g(x)}) = 0,
then the definition of an integral implies that f dµ = g dµ (or both integrals are
undefined). Because what happens on a set of measure 0 often does not matter, the
following definition is useful.

                     Measure, Integration & Real Analysis, by Sheldon Axler
90 Chapter 3 Integration

3.27 Definition almost every

Suppose (X, S, µ) is a measure space. A set E  S is said to contain µ-almost
every element of X if µ(X \ E) = 0. If the measure µ is clear from the context,
then the phrase almost every can be used (abbreviated by some authors to a. e.).

   For example, almost every real number is irrational (with respect to the usual
Lebesgue measure on R) because |Q| = 0.

   Theorems about integrals can almost always be relaxed so that the hypotheses
apply only almost everywhere instead of everywhere. For example, consider the
Bounded Convergence Theorem (3.26), one of whose hypotheses is that

                                      lim fk(x) = f (x)

                                                 k

for all x  X. Suppose that the hypotheses of the Bounded Convergence Theorem
hold except that the equation above holds only almost everywhere, meaning there
is a set E  S such that µ(X \ E) = 0 and the equation above holds for all x  E.
Define new functions g1, g2, . . . and g by

      gk(x) =  fk(x) if x  E,                   and g(x) =        f (x) if x  E,
                                                                  0 if x  X \ E.
               0  if x  X \ E

Then                      lim gk(x) = g(x)

                          k

for all x  X. Hence the Bounded Convergence Theorem implies that

                                    lim         gk dµ =    g dµ,

                                             k

which immediately implies that

because  gk dµ =           lim fk dµ = f dµ

                             k

                  fk dµ and g dµ = f dµ.

Dominated Convergence Theorem

The next result tells us that if a nonnegative function has a finite integral, then its
integral over all small sets (in the sense of measure) is small.

3.28 integrals on small sets are small
Suppose (X, S, µ) is a measure space, g : X  [0, ] is S-measurable, and

  g dµ < . Then for every  > 0, there exists  > 0 such that

                                           g dµ < 

                                                        B

for every set B  S such that µ(B) < .

               Measure, Integration & Real Analysis, by Sheldon Axler
                            Section 3B Limits of Integrals & Integrals of Limits 91

Proof Suppose  > 0. Let h : X  [0, ) be a simple S-measurable function such
that 0  h  g and

                                      g dµ - h dµ < 2 ;
the existence of a function h with these properties follows from 3.9. Let

                                  H = max{h(x) : x  X}

and  let    >  0  be  such  that  H  <  .

                                        2
Suppose B  S and µ(B) < . Then

                                  g dµ = (g - h) dµ + h dµ
                            B              B            B

                                      (g - h) dµ + Hµ(B)

                                     < 2 + H
                                     < ,

as desired.

   Some theorems, such as Egorov's Theorem (2.85) have as a hypothesis that the
measure of the entire space is finite. The next result sometimes allows us to get
around this hypothesis by restricting attention to a key set of finite measure.

3.29 integrable functions live mostly on sets of finite measure
Suppose (X, S, µ) is a measure space, g : X  [0, ] is S-measurable, and

  g dµ < . Then for every  > 0, there exists E  S such that µ(E) <  and

                                              g dµ < .

                                         X\E

Proof Suppose  > 0. Let P be an S-partition A1, . . . , Am of X such that

3.30                                    g dµ <  + L(g, P).

Let E be the union of those Aj such that inf g > 0. Then µ(E) <  (because

                                                                       Aj

otherwise we would have L(g, P) = , which contradicts the hypothesis that
  g dµ < ). Now

                                 g dµ =    g dµ -  Eg dµ

                            X\E

                                     <  + L(g, P) - L(Eg, P)

                                     = ,

where the second line follows from 3.30 and the definition of the integral of a
nonnegative function, and the last line holds because inf g = 0 for each Aj not
contained in E.                                             Aj

                  Measure, Integration & Real Analysis, by Sheldon Axler
92 Chapter 3 Integration

   Suppose (X, S, µ) is a measure space and f1, f2, . . . is a sequence of S-measurable
functions on X such that limk fk(x) = f (x) for every (or almost every) x  X.
In general, it is not true that limk fk dµ = f dµ (see Exercises 1 and 2).

   We already have two good theorems about interchanging limits and integrals.
However, both of these theorems have restrictive hypotheses. Specifically, the Mono-
tone Convergence Theorem (3.11) requires all the functions to be nonnegative and
it requires the sequence of functions to be increasing. The Bounded Convergence
Theorem (3.26) requires the measure of the whole space to be finite and it requires
the sequence of functions to be uniformly bounded by a constant.

   The next theorem is the grand result in this area. It does not require the sequence
of functions to be nonnegative, it does not require the sequence of functions to
be increasing, it does not require the measure of the whole space to be finite, and
it does not require the sequence of functions to be uniformly bounded. All these
hypotheses are replaced only by a requirement that the sequence of functions is
pointwise bounded by a function with a finite integral.

   Notice that the Bounded Convergence Theorem follows immediately from the
result below (take g to be an appropriate constant function and use the hypothesis in
the Bounded Convergence Theorem that µ(X) < ).

  3.31 Dominated Convergence Theorem
  Suppose (X, S, µ) is a measure space, f : X  [-, ] is S-measurable, and
  f1, f2, . . . are S-measurable functions from X to [-, ] such that

                                      lim fk(x) = f (x)

                                                 k

  for almost every x  X. If there exists an S-measurable function g : X  [0, ]
  such that

                              g dµ <  and | fk(x)|  g(x)
  for every k  Z+ and almost every x  X, then

                                  lim fk dµ = f dµ.

                                             k

Proof Suppose g : X  [0, ] satisfies the hypotheses of this theorem. If E  S,
then

         fk dµ - f dµ = X\E fk dµ - X\E f dµ + E fk dµ - E f dµ
                              X\E fk dµ + X\E f dµ + E fk dµ - E f dµ

3.32  2 X\E g dµ + E fk dµ - E f dµ .

                     Measure, Integration & Real Analysis, by Sheldon Axler
                               Section 3B Limits of Integrals & Integrals of Limits 93

Case 1: Suppose µ(X) < .
Let  > 0. By 3.28, there exists  > 0 such that

3.33 B g dµ < 4
for every set B  S such that µ(B) < . By Egorov's Theorem (2.85), there exists
a set E  S such that µ(X \ E) <  and f1, f2, . . . converges uniformly to f on E.
Now 3.32 and 3.33 imply that

                               fk dµ - f dµ < 2 + E( fk - f ) dµ .

Because f1, f2, . . . converges uniformly to f on E and µ(E) < , the last term on
the  right  is  less  than     for  all  sufficiently  large   k.  Thus  limk  fk dµ =  f dµ,
                            2
completing the proof of case 1.
Case 2: Suppose µ(X) = .
Let  > 0. By 3.29, there exists E  S such that µ(E) <  and

                                             X\E g dµ < 4 .

The inequality above and 3.32 imply that

                            fk dµ - f dµ < 2 + E fk dµ - E f dµ .

By case 1 as applied to the sequence f1|E, f2|E, . . ., the last term on the right is less
than     for  all  sufficiently  large   k.  Thus   limk             fk dµ =  f dµ, completing the
      2
proof of case 2.

Riemann Integrals and Lebesgue Integrals

We can now use the tools we have developed to characterize the Riemann integrable
functions. In the theorem below, the left side of the last equation denotes the Riemann
integral.

3.34 Riemann integrable  continuous almost everywhere

Suppose a < b and f : [a, b]  R is a bounded function. Then f is Riemann
integrable if and only if

                      |{x  [a, b] : f is not continuous at x}| = 0.

Furthermore, if f is Riemann integrable and  denotes Lebesgue measure on R,
then f is Lebesgue measurable and

                                             b  f=             f d.

                                         a             [a, b]

                      Measure, Integration & Real Analysis, by Sheldon Axler
94 Chapter 3 Integration

Proof Suppose n  Z+. Consider the partition Pn that divides [a, b] into 2n sub-
intervals of equal size. Let I1, . . . , I2n be the corresponding closed subintervals, each
of length (b - a)/2n. Let

      2n                        2n
      gn =  inf f I and hn =  sup f I .
3.35  j=1 Ij j                  j=1 Ij j

The lower and upper Riemann sums of f for the partition Pn are given by integrals.
Specifically,

[ 3.36 L( f , Pn, [a, b]) = a, b] gn [ d and U( f , Pn, [a, b]) = a, b] hn d,

where  is Lebesgue measure on R.
   The definitions of gn and hn given in 3.35 are actually just a first draft of the

definitions. A slight problem arises at each point that is in two of the intervals
I1, . . . , I2n (in other words, at endpoints of these intervals other than a and b). At
each of these points, change the value of gn to be the infimum of f over the union
of the two intervals that contain the point, and change the value of hn to be the
supremum of f over the union of the two intervals that contain the point. This change
modifies gn and hn on only a finite number of points. Thus the integrals in 3.36 are
not affected. This change is needed in order to make 3.38 true (otherwise the two
sets in 3.38 might differ by at most countably many points, which would not really
change the proof but which would not be as aesthetically pleasing).

   Clearly g1  g2  · · · is an increasing sequence of functions and h1  h2  · · ·
is a decreasing sequence of functions on [a, b]. Define functions f L : [a, b]  R and
f U : [a, b]  R by

      f L(x) = lim gn(x) and f U(x) = lim hn(x).
                        n           n

Taking the limit as n   of both equations in 3.36 and using the Bounded Conver-
gence Theorem (3.26) along with Exercise 7 in Section 1A, we see that f L and f U
are Lebesgue measurable functions and

3.37  L( f , [a, b]) =  [a, b]  f L d and U( f , [a, b]) =  [a, b]  f U d.

Now 3.37 implies that f is Riemann integrable if and only if

                                        ( f U - f L) d = 0.

                                               [a, b]

Because f L(x)  f (x)  f U(x) for all x  [a, b], the equation above holds if and
only if

                          |{x  [a, b] : f U(x) = f L(x)}| = 0.
The remaining details of the proof can be completed by noting that
3.38 {x  [a, b] : f U(x) = f L(x)} = {x  [a, b] : f is not continuous at x}.

      Measure, Integration & Real Analysis, by Sheldon Axler
      Section 3B Limits of Integrals & Integrals of Limits 95

                                                                    b

   We previously defined the notation a f to mean the Riemann integral of f .
Because the Riemann integral and Lebesgue integral agree for Riemann integrable

                                                               b

functions (see 3.34), we now redefine a f to denote the Lebesgue integral.

                                  b

3.39 Definition a f

Suppose -  a < b   and f : (a, b)  R is Lebesgue measurable. Then

b· a f and a f (x) dx mean (a,b) f d, where  is Lebesgue measure on R;b

a· b f is defined to be - a f .      b

The definition in the second bullet point above is made so that equations such as

                                        b     c     b
                                           f= f+ f
                                     a     a     c

remain valid even if, for example, a < b < c.

Approximation by Nice Functions

In the next definition, the notation  f 1 should be  f 1,µ because it depends on the
measure µ as well as on f . However, µ is usually clear from the context. In some
books, you may see the notation L1(X, S, µ) instead of L1(µ).

  3.40 Definition  f 1; L1(µ)

  Suppose (X, S, µ) is a measure space. If f : X  [-, ] is S-measurable,
  then the L1-norm of f is denoted by  f 1 and is defined by

                                       f 1 = | f | dµ.

  The Lebesgue space L1(µ) is defined by
    L1(µ) = { f : f is an S-measurable function from X to R and  f 1 < }.

   The terminology and notation used above are convenient even though ·1 might
not be a genuine norm (to be defined in Chapter 6).

3.41 Example L1(µ) functions that take on only finitely many values
   Suppose (X, S, µ) is a measure space and E1, . . . , En are disjoint subsets of X.

Suppose a1, . . . , an are distinct nonzero real numbers. Then
                              a1E1 + · · · + anEn  L1(µ)

if and only if Ek  S and µ(Ek) <  for all k  {1, . . . , n}. Furthermore,
              a1E1 + · · · + anEn1 = |a1|µ(E1) + · · · + |an|µ(En).

   Measure, Integration & Real Analysis, by Sheldon Axler
96 Chapter 3 Integration

3.42 Example 1
   If µ is counting measure on Z+ and x = (x1, x2, . . .) is a sequence of real numbers

(thought of as a function on Z+), then x1 = k=1|xk|. In this case, L1(µ) is
often denoted by 1 (pronounced little-el-one). In other words, 1 is the set of all
sequences (x1, x2, . . .) of real numbers such that k=1|xk| < .

   The easy proof of the following result is left to the reader.

  3.43 properties of the L1-norm
  Suppose (X, S, µ) is a measure space and f , g  L1(µ). Then

    ·  f 1  0;
    ·  f 1 = 0 if and only if f (x) = 0 for almost every x  X;
    · c f 1 = |c| f 1 for all c  R;
    ·  f + g1   f 1 + g1.
   The next result states that every function in L1(µ) can be approximated in L1-
norm by measurable functions that take on only finitely many values.

  3.44 approximation by simple functions
  Suppose µ is a measure and f  L1(µ). Then for every  > 0, there exists a
  simple function g  L1(µ) such that

                                         f - g1 < .
Proof Suppose  > 0. Then there exist simple functions g1, g2  L1(µ) such that
0  g1  f + and 0  g2  f - and

                    ( f + - g1) dµ < 2 and ( f - - g2) dµ < 2 ,
where we have used 3.9 to provide the existence of g1, g2 with these properties.

   Let g = g1 - g2. Then g is a simple function in L1(µ) and
                     f - g1 = ( f + - g1) - ( f - - g2)1
                                = ( f + - g1) dµ + ( f - - g2) dµ
                                < ,

as desired.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                              Section 3B Limits of Integrals & Integrals of Limits 97

3.45 Definition L1(R);  f 1
  · The notation L1(R) denotes L1(), where  is Lebesgue measure on either
     the Borel subsets of R or the Lebesgue measurable subsets of R.
  · When working with L1(R), the notation  f 1 denotes the integral of the
     absolute value of f with respect to Lebesgue measure on R.

3.46 Definition step function

A step function is a function g : R  R of the form

                               g = a1I1 + · · · + anIn ,
where I1, . . . , In are intervals of R and a1, . . . , an are nonzero real numbers.

   Suppose g is a step function of the form above and the intervals I1, . . . , In are
disjoint. Then

                            g1 = |a1| |I1| + · · · + |an| |In|.

In particular, g  L1(R) if and only if all the intervals I1, . . . , In are bounded.
   The intervals in the definition of a step
function can be open intervals, closed in-    Even though the coefficients

tervals, or half-open intervals. We will be a1, . . . , an in the definition of a step
using step functions in integrals, where function are required to be nonzero,
the inclusion or exclusion of the endpoints the function 0 that is identically 0 on
of the intervals does not matter.             R is a step function. To see this, take
                                              n = 1, a1 = 1, and I1 = .

3.47 approximation by step functions

Suppose f  L1(R).   Then for every  > 0, there exists a step function
g  L1(R) such that           f - g1 < .

Proof Suppose  > 0. By 3.44, there exist Borel (or Lebesgue) measurable subsets
A1, . . . , An of R and nonzero numbers a1, . . . , an such that |Ak| <  for all k 
{1, . . . , n} and
                                   n
                                   f -  akAk < .

                                   k=1        12

   For each k  {1, . . . , n}, there is an open subset Gk of R that contains Ak and
whose Lebesgue measure is as close as we want to |Ak| [by part (e) of 2.71]. Each
open subset of R, including each Gk, is a countable union of disjoint open intervals.
Thus for each k, there is a set Ek that is a finite union of bounded open intervals
contained in Gk whose Lebesgue measure is as close as we want to |Gk|. Hence for
each k, there is a set Ek that is a finite union of bounded intervals such that

                    Measure, Integration & Real Analysis, by Sheldon Axler
98 Chapter 3 Integration

                     |Ek \ Ak| + |Ak \ Ek|  |Gk \ Ak| + |Gk \ Ek|

                                                      <  2|ak|n ;

in other words,                 Ak - Ek 1 <  2|ak|n .

Now         n                          n                           n     n

          f -  akEk     1       f -  akAk +  akAk -  akEk
            k=1                        k=1            1 k=1              k=1  1

                              n

                           < +  |ak| Ak - Ek 1

                              2 k=1

                           < .

Each Ek is a finite union of bounded intervals. Thus the inequality above completes
the proof because nk=1 akEk is a step function.

   Luzin's Theorem (2.91 and 2.93) gives a spectacular way to approximate a Borel
measurable function by a continuous function. However, the following approximation
theorem is usually more useful than Luzin's Theorem. For example, the next result
plays a major role in the proof of the Lebesgue Differentiation Theorem (4.10).

3.48 approximation by continuous functions

Suppose f  L1(R). Then for every  > 0, there exists a continuous function
g : R  R such that

                                       f - g1 < 
and {x  R : g(x) = 0} is a bounded set.

Proof For every a1, . . . , an, b1, . . . , bn, c1, . . . , cn  R and g1, . . . , gn  L1(R),
we have n
                                       n                              n
          f -  ak gk  f -  ak[bk, ck] +  ak([bk, ck] - gk)
            k=1         1              k=1            1 k=1                   1

                                       n                           n
                            f -  ak[bk, ck] +  |ak| [bk, ck] - gk1,
                                       k=1            1 k=1

where the inequalities above follow
from 3.43. By 3.47, we can choose
a1, . . . , an, b1, . . . , bn, c1, . . . , cn  R to
make   f         n              as     small

          - k=1 ak[bk, ck]1
as we wish. The figure here then
shows that there exist continuous func-
tions g1, . . . , gn  L1(R) that make
nk=1|ak|[bk, ck] - gk1 as small as we
wish.  Now  take  g        n  ak gk .                 The graph of a continuous function gk
                     =                                 such that [bk, ck] - gk1 is small.
                        k=1

                  Measure, Integration & Real Analysis, by Sheldon Axler
Section 3B Limits of Integrals & Integrals of Limits 99

EXERCISES 3B

1 Give an example of a sequence f1, f2, . . . of functions from Z+ to [0, ) such
    that
                                         lim fk(m) = 0

                                                     k

    for every m  Z+ but lim fk dµ = 1, where µ is counting measure on Z+.

                                        k

2 Give an example of a sequence f1, f2, . . . of continuous functions from R to
    [0, 1] such that
                                         lim fk(x) = 0

                                                      k

    for every x  R but lim fk d = , where  is Lebesgue measure on R.

                                     k

3 Suppose  is Lebesgue measure on R and f : R  R is a Borel measurable
    function such that | f | d < . Define g : R  R by

              g(x) =     (-, x)             f d.

Prove that g is uniformly continuous on R.

4 (a) Suppose (X, S, µ) is a measure space with µ(X) < . Suppose that
          f : X  [0, ) is a bounded S-measurable function. Prove that

m
f dµ = inf  µ(Aj) sup f : A1, . . . , Am is an S-partition of X .
j=1                Aj

    (b) Show that the conclusion of (a) can fail if the hypothesis that f is bounded
         is replaced by the hypothesis that f dµ < .

    (c) Show that the conclusion of (a) can fail if the condition that µ(X) <  is
          deleted.

    [Part (a) of this exercise shows that if we had defined an upper Lebesgue sum,
    then it could be used to define f dµ when f is bounded and µ(X) < .
    However, parts (b) and (c) show that the hypotheses that f is bounded and that
    µ(X) <  are needed if defining the integral via the equation above. The
    definition of the integral via the lower Lebesgue sum does not require these
    hypotheses, showing the advantage of using the lower Lebesgue sum.]

5 Let  denote Lebesgue measure on R. Suppose f : R  R is a Borel measurable
    function such that | f | d < . Prove that

              lim        f d =              f d.
              k [-k, k]

6 Let  denote Lebesgue measure on R. Give an example of a continuous function
     f : [0, )  R such that limt [0, t] f d exists (in R) but [0, ) f d is not
    defined.

Measure, Integration & Real Analysis, by Sheldon Axler
100 Chapter 3 Integration

7 Let  denote Lebesgue measure on R. Give an example of a continuous function
     f : (0, 1)  R such that limn ( 1 , 1) f d exists (in R) but (0, 1) f d is not

                                                                                 n

    defined.

8 Verify the assertion in 3.38.

9 Verify the assertion in Example 3.41.

10 (a) Suppose (X, S, µ) is a measure space such that µ(X) < . Suppose
           p, r are positive numbers with p < r. Prove that if f : X  [0, ) is an
           S-measurable function such that f r dµ < , then f p dµ < .

      (b) Give an example to show that the result in (a) can be false without the
           hypothesis that µ(X) < .

11 Suppose (X, S, µ) is a measure space and f  L1(µ). Prove that the set
      {x  X : f (x) = 0} is the countable union of sets with finite µ-measure.

12 Suppose                                  x)k       k
                                                      x
                           fk(x) =  (1   -       cos     .

                                              x

                            1

Prove that lim fk = 0.

                k 0

13 Give an example of a sequence of nonnegative Borel measurable functions
      f1, f2, . . . on [0, 1] such that both the following conditions hold.

                            1

       · lim fk = 0;

                k 0

· sup fk(x) =  for every m  Z+ and every x  [0, 1].

      km

14 Let  denote Lebesgue measure on R.
                            

      (a) Let f (x) = 1/ x. Prove that [0, 1] f d = 2.

      (b) Let f (x) = 1/(1 + x2). Prove that R f d = .
      (c) Let f (x) = (sin x)/x. Show that the integral (0, ) f d is not defined

           but limt (0, t) f d exists in R.

15 Prove or give a counterexample: If G is an open subset of (0, 1), then G is
      Riemann integrable on [0, 1].

16 Suppose f  L1(R).
      (a) For t  R, define ft : R  R by ft(x) = f (x - t). Prove that
                                           lim f - ft1 = 0.

                                                        t0

      (b) For t > 0, define ft : R  R by ft(x) = f (tx). Prove that
                                           lim f - ft1 = 0.

                                                        t1

            Measure, Integration & Real Analysis, by Sheldon Axler
                                               Chapter 4

                                         Differentiation

Does there exist a Lebesgue measurable set that fills up exactly half of each interval?
To   get  a  feeling         for   this  question,  consider  the  set  E     [0,  1          1  ,  3          1  ,  5          3  ,  7  ].
                                                                           =       8  ]    [  4     8  ]    [  2     8  ]    [  4     8

This set E has the property that

                                                    |E  [0, b]| = b2

for  b  =    0,  1  ,  1  ,  3  ,  1.  Does  there  exist  a  Lebesgue  measurable         set      E       [0,      1],   perhaps
                 4     2     4
constructed in a fashion similar to the Cantor set, such that the equation above holds
for all b  [0, 1]?
     In this chapter we see how to answer this question by considering differentia-
tion issues. We begin by developing a powerful tool called the Hardy-Littlewood
maximal inequality. This tool is used to prove an almost everywhere version of the
Fundamental Theorem of Calculus. These results lead us to an important theorem
about the density of Lebesgue measurable sets.

      Trinity College at the University of Cambridge in England. G. H. Hardy
  (1877-1947) and John Littlewood (1885-1977) were students and later faculty
members here. If you have not already done so, you should read Hardy's remarkable
  book A Mathematician's Apology (do not skip the fascinating Foreword by C. P.
  Snow) and see the movie The Man Who Knew Infinity, which focuses on Hardy,

                   Littlewood, and Srinivasa Ramanujan (1887-1920).

                                                        CC-BY-SA Rafa Esteve

                                                                                                           101
                     Measure, Integration & Real Analysis, by Sheldon Axler
102 Chapter 4 Differentiation

4A Hardy-Littlewood Maximal Function

Markov's Inequality

The following result, called Markov's inequality, has a sweet, short proof. We will
make good use of this result later in this chapter (see the proof of 4.10). Markov's
inequality also leads to Chebyshev's inequality (see Exercise 2 in this section).

4.1 Markov's inequality

Suppose (X, S, µ) is a measure space and h  L1(µ). Then

                  µ({x  X : |h(x)|  c})  1c h1

for every c > 0.

Proof Suppose c > 0. Then

             µ({x  X : |h(x)|  c}) = 1c {xX : |h(x)|c} c dµ

                                1c {xX : |h(x)|c}|h| dµ

                                1c h1,

as desired.

  St. Petersburg University along the Neva River in St. Petersburg, Russia.
Andrey Markov (1856-1922) was a student and then a faculty member here.

                                                   CC-BY-SA A. Savin

                Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 4A Hardy-Littlewood Maximal Function 103

Vitali Covering Lemma

  4.2 Definition 3 times a bounded nonempty open interval
  Suppose I is a bounded nonempty open interval of R. Then 3  I denotes the
  open interval with the same center as I and three times the length of I.

4.3 Example 3 times an interval
   If I = (0, 10), then 3  I = (-10, 20).
   The next result is a key tool in the proof of the Hardy-Littlewood maximal

inequality (4.8).

  4.4 Vitali Covering Lemma
  Suppose I1, . . . , In is a list of bounded nonempty open intervals of R. Then there
  exists a disjoint sublist Ik1 , . . . , Ikm such that

                       I1  · · ·  In  (3  Ik1 )  · · ·  (3  Ikm ).

4.5 Example Vitali Covering Lemma

Suppose n = 4 and

      I1 = (0, 10), I2 = (9, 15), I3 = (14, 22), I4 = (21, 31).

Then

3  I1 = (-10, 20), 3  I2 = (3, 21), 3  I3 = (6, 30), 3  I4 = (11, 41).

Thus  I1  I2  I3  I4  (3  I1)  (3  I4).

In this example, I1, I4 is the only sublist of I1, I2, I3, I4 that produces the conclusion
of the Vitali Covering Lemma.

Proof of 4.4 Let k1 be such that
                               |Ik1 | = max{|I1|, . . . , |In|}.

   Suppose k1, . . . , kj have been chosen. The technique used here is called a
Let kj+1 be such that |Ikj+1 | is as large greedy algorithm because at each
as possible subject to the condition that stage we select the largest remaining
Ik1 , . . . , Ikj+1 are disjoint. If there is no interval that is disjoint from the
choice of kj+1 such that Ik1 , . . . , Ikj+1 are previously selected intervals.
disjoint, then the procedure terminates.
Because we start with a finite list, the procedure must eventually terminate after some
number m of choices.

                     Measure, Integration & Real Analysis, by Sheldon Axler
104 Chapter 4 Differentiation

   Suppose j  {1, . . . , n}. To complete the proof, we must show that
                              Ij  (3  Ik1 )  · · ·  (3  Ikm ).

If j  {k1, . . . , km}, then the inclusion above obviously holds.
   Thus assume that j / {k1, . . . , km}. Because the process terminated without

selecting j, the interval Ij is not disjoint from all of Ik1 , . . . , Ikm . Let IkL be the first
interval on this list not disjoint from Ij; thus Ij is disjoint from Ik1 , . . . , IkL-1 . Because
j was not chosen in step L, we conclude that |IkL |  |Ij|. Because IkL  Ij = , this
last inequality implies (easy exercise) that Ij  3  IkL , completing the proof.

Hardy-Littlewood Maximal Inequality

Now we come to a brilliant definition that turns out to be extraordinarily useful.

4.6 Definition Hardy-Littlewood maximal function; h

Suppose h : R  R is a Lebesgue measurable function. Then the Hardy-
Littlewood maximal function of h is the function h : R  [0, ] defined by

                                h(b) = sup 1   b+t

                                                  |h|.
                                t>0 2t b-t

   In other words, h(b) is the supremum over all bounded intervals centered at b of
the average of |h| on those intervals.

4.7 Example Hardy-Littlewood maximal function of [0, 1]
   As usual, let [0, 1] denote the characteristic function of the interval [0, 1]. Then

                  1             if b  0,       The graph of ([0, 1]) on [-2, 3].
                   2(1-b)       if 0 < b < 1,
([0, 1])(b) = 1                 if b  1,
                   1

                            2b

as you should verify.

   If h : R  R is Lebesgue measurable and c  R, then {b  R : h(b) > c} is
an open subset of R, as you are asked to prove in Exercise 9 in this section. Thus h
is a Borel measurable function.

   Suppose h  L1(R) and c > 0. Markov's inequality (4.1) estimates the size of
the set on which |h| is larger than c. Our next result estimates the size of the set on
which h is larger than c. The Hardy-Littlewood maximal inequality proved in the
next result is a key ingredient in the proof of the Lebesgue Differentiation Theorem
(4.10). Note that this next result is considerably deeper than Markov's inequality.

Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 4A Hardy-Littlewood Maximal Function 105

4.8 Hardy-Littlewood maximal inequality

Suppose h  L1(R). Then

                      |{b  R : h(b) > c}|  3c h1

for every c > 0.

Proof Suppose F is a closed bounded subset of {b  R : h(b) > c}. We will
show  that  |F|    3  
                   c
                      -|h|, which implies our desired result [see Exercise 24(a) in
Section 2D].
For each b  F, there exists tb > 0 such that

4.9 1 b+tb |h| > c.
                                       2tb b-tb

Clearly                 F  (b - tb, b + tb).

                        bF

The Heine-Borel Theorem (2.12) tells us that this open cover of a closed bounded set
has a finite subcover. In other words, there exist b1, . . . , bn  F such that

                 F  (b1 - tb1 , b1 + tb1 )  · · ·  (bn - tbn , bn + tbn ).
To make the notation cleaner, relabel the open intervals above as I1, . . . , In.

   Now apply the Vitali Covering Lemma (4.4) to the list I1, . . . , In, producing a
disjoint sublist Ik1 , . . . , Ikm such that

                       I1  · · ·  In  (3  Ik1 )  · · ·  (3  Ikm ).
Thus

                      |F|  |I1  · · ·  In|

                       |(3  Ik1 )  · · ·  (3  Ikm )|

                       |3  Ik1 | + · · · + |3  Ikm |

                      = 3(|Ik1 | + · · · + |Ikm |)

                      < 3 |h| + · · · + |h|
                        c Ik1                    Ikm

                       3  c -|h|,

where the second-to-last inequality above comes from 4.9 (note that |Ikj | = 2tb for
the choice of b corresponding to Ikj ) and the last inequality holds because Ik1 , . . . , Ikm
are disjoint.

   The last inequality completes the proof.

                 Measure, Integration & Real Analysis, by Sheldon Axler
106 Chapter 4 Differentiation

EXERCISES 4A

1 Suppose (X, S, µ) is a measure space and h : X  R is an S-measurable
    function. Prove that
                         µ({x  X : |h(x)|  c})  cp1 |h|p dµ
    for all positive numbers c and p.

2 Suppose (X, S, µ) is a measure space with µ(X) = 1 and h  L1(µ). Prove
    that

µ x  X : h(x) - h dµ  c  c21   h2 dµ -                           2

                                                        h dµ

for all c > 0.
[The result above is called Chebyshev's inequality; it plays an important role
in probability theory. Pafnuty Chebyshev (1821-1894) was Markov's thesis
advisor.]

3 Suppose (X, S, µ) is a measure space. Suppose h  L1(µ) and h1 > 0.
    Prove that there is at most one number c  (0, ) such that

µ({x  X : |h(x)|  c}) = 1c h1.

4 Show that the constant 3 in the Vitali Covering Lemma (4.4) cannot be replaced
    by a smaller positive constant.

5 Prove the assertion left as an exercise in the last sentence of the proof of the
    Vitali Covering Lemma (4.4).

6 Verify the formula in Example 4.7 for the Hardy-Littlewood maximal function
    of [0, 1].

7 Find a formula for the Hardy-Littlewood maximal function of the characteristic
    function of [0, 1]  [2, 3].

8 Find a formula for the Hardy-Littlewood maximal function of the function
    h : R  [0, ) defined by

              h(x) = x if 0  x  1, 0 otherwise.

9 Suppose h : R  R is Lebesgue measurable. Prove that
                                     {b  R : h(b) > c}

    is an open subset of R for every c  R.

Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 4A Hardy-Littlewood Maximal Function 107

10 Prove or give a counterexample: If h : R  [0, ) is an increasing function,
      then h is an increasing function.

11 Give an example of a Borel measurable function h : R  [0, ) such that
      h(b) <  for all b  R but sup{h(b) : b  R} = .

12 Show that |{b  R : h(b) = }| = 0 for every h  L1(R).
13 Show that there exists h  L1(R) such that h(b) =  for every b  Q.
14 Suppose h  L1(R). Prove that

                                |{b  R : h(b)  c}|  3c h1
      for every c > 0.
      [This result slightly strengthens the Hardy-Littlewood maximal inequality (4.8)
      because the set on the left side above includes those b  R such that h(b) = c.
      A much deeper strengthening comes from replacing the constant 3 in the Hardy-
      Littlewood maximal inequality with a smaller constant. In 2003, Antonios
      Melas answered what had been an open question about the best constant. He
      proved that the smallest constant that can replace 3 in the Hardy-Littlewood
      maximal inequality is (11 + 61)/12  1.56752; see Annals of Mathematics
      157 (2003), 647-688.]

                      Measure, Integration & Real Analysis, by Sheldon Axler
108 Chapter 4 Differentiation

4B Derivatives of Integrals

Lebesgue Differentiation Theorem

The next result states that the average amount by which a function in L1(R) differs
from its values is small almost everywhere on small intervals. The 2 in the denomi-
nator of the fraction in the result below could be deleted, but its presence makes the
length of the interval of integration nicely match the denominator 2t.

   The next result is called the Lebesgue Differentiation Theorem, even though no
derivative is in sight. However, we will soon see how another version of this result
deals with derivatives. The hard work takes place in the proof of this first version.

4.10 Lebesgue Differentiation Theorem, first version
Suppose f  L1(R). Then

                             lim 1 b+t| f - f (b)| = 0
                               t0 2t b-t
for almost every b  R.

   Before getting to the formal proof of this first version of the Lebesgue Differen-
tiation Theorem, we pause to provide some motivation for the proof. If b  R and
t > 0, then 3.25 gives the easy estimate

            1 b+t 2t b-t | f - f (b)|  sup{| f (x) - f (b)| : |x - b|  t}.

If f is continuous at b, then the right side of this inequality has limit 0 as t  0,
proving 4.10 in the special case in which f is continuous on R.

   To prove the Lebesgue Differentiation Theorem, we will approximate an arbitrary
function in L1(R) by a continuous function (using 3.48). The previous paragraph
shows that the continuous function has the desired behavior. We will use the Hardy-
Littlewood maximal inequality (4.8) to show that the approximation produces ap-
proximately the desired behavior. Now we are ready for the formal details of the
proof.
Proof of 4.10 Let  > 0. By 3.48, for each k  Z+ there exists a continuous
function hk : R  R such that

4.11                                     f - hk1 < k2k  .
Let
Then        Bk  =  {b    R  :  | f (b)  -  hk(b)|     1  and  (f  -  hk)(b)      1 }.
                                                      k
                                                                                 k

4.12  R  \  Bk  =  {b    R  :  | f (b)  -  hk(b)|  >  1}    {b    R  :  (f  -  hk)(b)  >  1 }.

                                                      k                                   k

                   Measure, Integration & Real Analysis, by Sheldon Axler
                                         Section 4B Derivatives of Integrals 109

Markov's inequality (4.1) as applied to the function f - hk and 4.11 imply that

4.13             |{b  R : | f (b) - hk(b)| > k }| < k .        1          

                                                                       2

The Hardy-Littlewood maximal inequality (4.8) as applied to the function f - hk
and 4.11 imply that

                                                         1             3
4.14             |{b  R : ( f - hk) (b) > k }| < k .
                                                                       2

Now 4.12, 4.13, and 4.14 imply that

   Let                             |R \ Bk| < 2k-2  .

Then                                             
4.15
                                      B = Bk.

                                               k=1

                   
             |R \ B| = (R \ Bk)   |R \ Bk| <  k-2 = 4.
                 k=1                           k=1                   k=1 2

Suppose b  B and t > 0. Then for each k  Z+ we have

1 b+t 2t b-t | f - f (b)|  1 b+t 2t b-t | f - hk| + |hk - hk(b)| + |hk(b) - f (b)|
                        ( f - hk)(b) + 1 b+t 2t b-t |hk - hk(b)| + |hk(b) - f (b)|
                        2k + 1 b+t 2t b-t |hk - hk(b)|.

Because  hk  is  continuous,  the  last  term  is  less  than  1  for  all  t  >  0  sufficiently  close
                                                               k
to 0 (how close is sufficiently close depends on k). In other words, for each k  Z+,
we have
                                   1 b+t| f - f (b)| < 3
                              2t b-t                              k

for all t > 0 sufficiently close to 0.
   Hence we conclude that
                                lim 1 b+t| f - f (b)| = 0
                                  t0 2t b-t

for all b  B.
   Let A denote the set of numbers a  R such that

                                   lim 1 a+t| f - f (a)|
                                   t0 2t a-t

either does not exist or is nonzero. We have shown that A  (R \ B). Thus

                                   |A|  |R \ B| < 4,

where the last inequality comes from 4.15. Because  is an arbitrary positive number,
the last inequality implies that |A| = 0, completing the proof.

                 Measure, Integration & Real Analysis, by Sheldon Axler
110 Chapter 4 Differentiation

Derivatives

You should remember the following definition from your calculus course.

4.16 Definition derivative; g; differentiable

Suppose g : I  R is a function defined on an open interval I of R and b  I.
The derivative of g at b, denoted g(b), is defined by

       g(b) = lim g(b + t) - g(b)      t
                               t0

if the limit above exists, in which case g is called differentiable at b.

   We now turn to the Fundamental Theorem of Calculus and a powerful extension
that avoids continuity. These results show that differentiation and integration can be
thought of as inverse operations.

   You saw the next result in your calculus class, except now the function f is
only required to be Lebesgue measurable (and its absolute value must have a finite
Lebesgue integral). Of course, we also need to require f to be continuous at the
crucial point b in the next result, because changing the value of f at a single number
would not change the function g.

4.17 Fundamental Theorem of Calculus

Suppose f  L1(R). Define g : R  R by

                                                                    x

                                     g(x) = - f .
Suppose b  R and f is continuous at b. Then g is differentiable at b and

                                      g(b) = f (b).

Proof  If t = 0, then                  b+t     b
4.18        g(b + t) - g(b) t - f (b)   f - - f
                                       =- t               - f (b)

                                               b+t

                                             bf
                                       = t - f (b)

                                               b+t

                                             b f - f (b)
                                       =t

                                        sup | f (x) - f (b)|.

                                           {xR : |x-b|<|t|}

If  > 0, then by the continuity of f at b, the last quantity is less than  for t
sufficiently close to 0. Thus g is differentiable at b and g(b) = f (b).

       Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 4B Derivatives of Integrals 111

   A function in L1(R) need not be continuous anywhere. Thus the Fundamental
Theorem of Calculus (4.17) might provide no information about differentiating the
integral of such a function. However, our next result states that all is well almost
everywhere, even in the absence of any continuity of the function being integrated.

4.19 Lebesgue Differentiation Theorem, second version

Suppose f  L1(R). Define g : R  R by

                                                                    x

                                     g(x) = - f .
Then g(b) = f (b) for almost every b  R.

Proof Suppose t = 0. Then from 4.18 we have

                    g(b + t) - g(b) t - f (b) =                        b+t

                                                                       b f - f (b)
                                                                               t

                                                  1 b+t t b | f - f (b)|

                                                  1 b+t t b-t | f - f (b)|

for all b  R. By the first version of the Lebesgue Differentiation Theorem (4.10),
the last quantity has limit 0 as t  0 for almost every b  R. Thus g(b) = f (b) for
almost every b  R.

Now we can answer the question raised on the opening page of this chapter.

4.20 no set constitutes exactly half of each interval

There does not exist a Lebesgue measurable set E  [0, 1] such that
                                     |E  [0, b]| = b2

for all b  [0, 1].

Proof Suppose there does exist a Lebesgue measurable set E  [0, 1] with the
property above. Define g : R  R by

                                                          b

                                          g(b) = - E .

Thus  g(b)  =  b  for  all  b    [0, 1].  Hence  g(b)   =              1  for  all  b      (0, 1).
               2                                                       2
The Lebesgue Differentiation Theorem (4.19) implies that g(b) = E(b) for
almost  every  b    R.  However,          never  takes  on             the  value      1,  which  contradicts  the
                                  E
                                                                                       2
conclusion of the previous paragraph. This contradiction completes the proof.

                  Measure, Integration & Real Analysis, by Sheldon Axler
112 Chapter 4 Differentiation

   The next result says that a function in L1(R) is equal almost everywhere to the
limit of its average over small intervals. These two-sided results generalize more
naturally to higher dimensions (take the average over balls centered at b) than the
one-sided results.

  4.21 L1(R) function equals its local average almost everywhere

  Suppose f  L1(R). Then
                                   f (b) = lim 1 b+t f
                                               t0 2t b-t

  for almost every b  R.

Proof Suppose t > 0. Then
                       1 b+t 2t b-t f - f (b) = 1 b+t 2t b-t f - f (b)
                                                 1 b+t 2t b-t | f - f (b)|.

The desired result now follows from the first version of the Lebesgue Differentiation
Theorem (4.10).

   Again, the conclusion of the result above holds at every number b at which f is
continuous. The remarkable part of the result above is that even if f is discontinuous
everywhere, the conclusion holds for almost every real number b.

Density

The next definition captures the notion of the proportion of a set in small intervals
centered at a number b.

4.22 Definition density

Suppose E  R. The density of E at a number b  R is

                         lim |E  (b - t, b + t)|
                         t0          2t

if this limit exists (otherwise the density of E at b is undefined).

4.23 Example density of an interval

                                         if b  (0, 1),
                                  1      if b = 0 or b = 1,
The density of [0, 1] at b =  21         otherwise.

                                     0

Measure, Integration & Real Analysis, by Sheldon Axler
                                      Section 4B Derivatives of Integrals 113

   The next beautiful result shows the power of the techniques developed in this
chapter.

4.24 Lebesgue Density Theorem

Suppose E  R is a Lebesgue measurable set. Then the density of E is 1 at
almost every element of E and is 0 at almost every element of R \ E.

Proof First suppose |E| < . Thus E  L1(R). Because

                           |E  (b - t, b + t)| = 1       b+t
                                 2t              2t b-t
                                                             E

for every t > 0 and every b  R, the desired result follows immediately from 4.21.
Now consider the case where |E| =  [which means that E / L1(R) and hence
4.21 as stated cannot be used]. For k  Z+, let Ek = E  (-k, k). If |b| < k, then the
density of E at b equals the density of Ek at b. By the previous paragraph as applied
to Ek, there are sets Fk  Ek and Gk  R \ Ek such that |Fk| = |Gk| = 0 and the
density of Ek equals 1 at every element of Ek \ Fk and the density of Ek equals 0 at
every element of (R \ Ek) \ Gk.
Let F =           Fk  and  G          Gk.  Then  |F|     |G|     0  and  the  density  of  E  is
         k=1                  =  k=1                  =       =

1 at every element of E \ F and is 0 at every element of (R \ E) \ G.

   The bad Borel set provided by the next  The Lebesgue Density Theorem
result leads to a bad Borel measurable
function. Specifically, let E be the bad makes the example provided by the
Borel set in 4.25. Then E is a Borel next result somewhat surprising. Be
measurable function that is discontinuous sure to spend some time pondering
everywhere. Furthermore, the function E why the next result does not
cannot be modified on a set of measure 0 contradict the Lebesgue Density
to be continuous anywhere (in contrast to Theorem. Also, compare the next
the function Q).                           result to 4.20.

Even though the function E discussed in the paragraph above is continuous
nowhere and every modification of this function on a set of measure 0 is also continu-
ous nowhere, the function g defined by

                                                                       b

                                        g(b) = 0 E
is differentiable almost everywhere (by 4.19).

   The proof of 4.25 given below is based on an idea of Walter Rudin.

4.25 bad Borel set
There exists a Borel set E  R such that

                                    0 < |E  I| < |I|
for every nonempty bounded open interval I.

         Measure, Integration & Real Analysis, by Sheldon Axler
114 Chapter 4 Differentiation

Proof We use the following fact in our construction:

4.26 Suppose G is a nonempty open subset of R. Then there exists a closed set
        F  G \ Q such that |F| > 0.

   To prove 4.26, let J be a closed interval contained in G such that 0 < |J |. Let
r1, r2, . . . be a list of all the rational numbers. Let

                                                 |J |              |J |

                       F = J \ rk - k+2 , rk + k+2 .
                                 k=1 2 2

Then   F  is a closed subset of  R  and  F       J  \Q          G \ Q.    Also,  |J  \ F|    1  |  J  |
                                                                                             2
                                 |J |         |J |
because J \ F  k=1 rk - 2k+2 , rk + 2k+2 . Thus

                       |F|  =    |J |  -  |J  \  F|    1  |  J  |  >  0,
                                                       2

completing the proof of 4.26.
   To construct the set E with the desired properties, let I1, I2, . . . be a sequence

consisting of all nonempty bounded open intervals of R with rational endpoints. Let
F0 = F0 = , and inductively construct sequences F1, F2, . . . and F1, F2, . . . of closed
subsets of R as follows: Suppose n  Z+ and F0, . . . , Fn-1 and F0, . . . , Fn-1 have
been chosen as closed sets that contain no rational numbers. Thus

                                 In \ (F0  . . .  Fn-1)

is a nonempty open set (nonempty because it contains all rational numbers in In).
Applying 4.26 to the open set above, we see that there is a closed set Fn contained in
the set above such that Fn contains no rational numbers and |Fn| > 0. Applying 4.26
again, but this time to the open set

                                 In \ (F0  . . .  Fn),

which is nonempty because it contains all rational numbers in In, we see that there is
a closed set Fn contained in the set above such that Fn contains no rational numbers
and |Fn| > 0.

   Now let 
                                         E = Fk.

                                                              k=1

Our construction implies that Fk  Fn =  for all k, n  Z+. Thus E  Fn =  for
all n  Z+. Hence Fn  In \ E for all n  Z+.

   Suppose I is a nonempty bounded open interval. Then In  I for some n  Z+.
Thus

                              0 < |Fn|  |E  In|  |E  I|.

Also,     |E  I| = |I| - |I \ E|  |I| - |In \ E|  |I| - |Fn| < |I|,

completing the proof.

          Measure, Integration & Real Analysis, by Sheldon Axler
                                               Section 4B Derivatives of Integrals 115

EXERCISES 4B

For f  L1(R) and I an interval of R with 0 < |I| < , let fI denote the
                                                       1
average  of  f  on  I.  In  other  words,  fI  =      |I|  I f.

1 Suppose f  L1(R). Prove that

                                   lim 1   b+t

                                              | f - f[b-t, b+t]| = 0
                                   t0 2t b-t

    for almost every b  R.
2 Suppose f  L1(R). Prove that

         lim sup 1 | f - fI | : I is an interval of length t containing b = 0
         t0         |I| I

   for almost every b  R.

3 Suppose f : R  R is a Lebesgue measurable function such that f 2  L1(R).
   Prove that
                                          1 b+t 2
                                   lim                | f - f (b)| = 0
                                   t0 2t b-t

   for almost every b  R.

4 Prove that the Lebesgue Differentiation Theorem (4.19) still holds if the hypoth-
                                                                                  x
   esis that -| f | <  is weakened to the requirement that -| f | <  for all
   x  R.

5 Suppose f : R  R is a Lebesgue measurable function. Prove that

                                           | f (b)|  f (b)

    for almost every b  R.
6 Prove that if h  L1(R) and -s  h = 0 for all s  R, then h(s) = 0 for almost

    every s  R.

7 Give an example of a Borel subset of R whose density at 0 is not defined.

8  Give  an     example     of  a  Borel  subset  of  R    whose  density  at  0  is  1.

                                                                                      3

9 Prove that if t  [0, 1], then there exists a Borel set E  R such that the density
    of E at 0 is t.

10 Suppose E is a Lebesgue measurable subset of R such that the density of E
      equals 1 at every element of E and equals 0 at every element of R \ E. Prove
      that E =  or E = R.

                    Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 5

         Product Measures

Lebesgue measure on R generalizes the notion of the length of an interval. In this
chapter, we see how two-dimensional Lebesgue measure on R2 generalizes the notion
of the area of a rectangle. More generally, we construct new measures that are the
products of two measures.

   Once these new measures have been constructed, the question arises of how to
compute integrals with respect to these new measures. Beautiful theorems proved in
the first decade of the twentieth century allow us to compute integrals with respect to
product measures as iterated integrals involving the two measures that produced the
product. Furthermore, we will see that under reasonable conditions we can switch
the order of an iterated integral.

  Main building of Scuola Normale Superiore di Pisa, the university in Pisa, Italy,
where Guido Fubini (1879-1943) received his PhD in 1900. In 1907 Fubini proved
that under reasonable conditions, an integral with respect to a product measure can
be computed as an iterated integral and that the order of integration can be switched.
Leonida Tonelli (1885-1943) also taught for many years in Pisa; he also proved a
crucial theorem about interchanging the order of integration in an iterated integral.

                                                          CC-BY-SA Lucarelli

                                                                                                            116
                     Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 5A Products of Measure Spaces 117

5A Products of Measure Spaces

Products of -Algebras

Our first step in constructing product measures is to construct the product of two
-algebras. We begin with the following definition.

  5.1 Definition rectangle
  Suppose X and Y are sets. A rectangle in X × Y is a set of the form A × B,
  where A  X and B  Y.

   Keep the figure shown here in mind
when thinking of a rectangle in the sense
defined above. However, remember that
A and B need not be intervals as shown
in the figure. Indeed, the concept of an
interval makes no sense in the generality
of arbitrary sets.

Now we can define the product of two -algebras.

5.2 Definition product of two -algebras; S  T ; measurable rectangle

Suppose (X, S ) and (Y, T ) are measurable spaces. Then
  · the product S  T is defined to be the smallest -algebra on X × Y that
     contains
                                 {A × B : A  S, B  T };

· a measurable rectangle in S  T is a set of the form A × B, where A  S
   and B  T .

   Using the terminology introduced in     The notation S × T is not used
the second bullet point above, we can say
that S  T is the smallest -algebra con- because S and T are sets (of sets),
taining all the measurable rectangles in and thus the notation S × T
S  T . Exercise 1 in this section asks already is defined to mean the set of
you to show that the measurable rectan- all ordered pairs of the form (A, B),
gles in S  T are the only rectangles in where A  S and B  T .
X × Y that are in S  T .
The notion of cross sections plays a crucial role in our development of product
measures. First, we define cross sections of sets, and then we define cross sections of
functions.

            Measure, Integration & Real Analysis, by Sheldon Axler
118 Chapter 5 Product Measures

  5.3 Definition cross sections of sets; [E]a and [E]b
  Suppose X and Y are sets and E  X × Y. Then for a  X and b  Y, the cross
  sections [E]a and [E]b are defined by

        [E]a = {y  Y : (a, y)  E} and [E]b = {x  X : (x, b)  E}.

5.4 Example cross sections of a subset of X × Y

5.5 Example cross sections of rectangles
   Suppose X and Y are sets and A  X and B  Y. If a  X and b  Y, then
         [A × B]a = B if a  A,  if a / A and [A × B]b = A if b  B,  if b / B,

as you should verify.
   The next result shows that cross sections preserve measurability.
  5.6 cross sections of measurable sets are measurable
  Suppose S is a -algebra on X and T is a -algebra on Y. If E  S  T , then
             [E]a  T for every a  X and [E]b  S for every b  Y.

Proof Let E denote the collection of subsets E of X × Y for which the conclusion
of this result holds. Then A × B  E for all A  S and all B  T (by Example 5.5).

   The collection E is closed under complementation and countable unions because
                                [(X × Y) \ E]a = Y \ [E]a

and
                         [E1  E2  · · · ]a = [E1]a  [E2]a  · · ·

for all subsets E, E1, E2, . . . of X × Y and all a  X, as you should verify, with
similar statements holding for cross sections with respect to all b  Y.

   Because E is a -algebra containing all the measurable rectangles in S  T , we
conclude that E contains S  T .

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                        Section 5A Products of Measure Spaces 119

 Now we define cross sections of functions.
5.7 Definition cross sections of functions; [ f ]a and [ f ]b
Suppose X and Y are sets and f : X × Y  R is a function. Then for a  X and
b  Y, the cross section functions [ f ]a : Y  R and [ f ]b : X  R are defined
by

       [ f ]a(y) = f (a, y) for y  Y and [ f ]b(x) = f (x, b) for x  X.

5.8 Example cross sections
  · Suppose f : R × R  R is defined by f (x, y) = 5x2 + y3. Then
                       [ f ]2(y) = 20 + y3 and [ f ]3(x) = 5x2 + 27
     for all y  R and all x  R, as you should verify.
  · Suppose X and Y are sets and A  X and B  Y. If a  X and b  Y, then
                    [A × B]a = A(a)B and [A × B]b = B(b)A ,
     as you should verify.

   The next result shows that cross sections preserve measurability, this time in the
context of functions rather than sets.

5.9 cross sections of measurable functions are measurable

Suppose S is a -algebra on X and T is a -algebra on Y.                 Suppose
 f : X × Y  R is an S  T -measurable function. Then

              [ f ]a is a T -measurable function on Y for every a  X
and

              [ f ]b is an S-measurable function on X for every b  Y.

Proof Suppose D is a Borel subset of R and a  X. If y  Y, then

      y  ([ f ]a)-1(D)  [ f ]a(y)  D
                             f (a, y)  D
                             (a, y)  f -1(D)
                             y  [ f -1(D)]a.

Thus  ([ f ]a)-1(D) = [ f -1(D)]a.

Because f is an S  T -measurable function, f -1(D)  S  T . Thus the equation
above and 5.6 imply that ([ f ]a)-1(D)  T . Hence [ f ]a is a T -measurable function.

   The same ideas show that [ f ]b is an S-measurable function for every b  Y.

      Measure, Integration & Real Analysis, by Sheldon Axler
120 Chapter 5 Product Measures

Monotone Class Theorem

The following standard two-step technique often works to prove that every set in a
-algebra has a certain property:

 1. show that every set in a collection of sets that generates the -algebra has the
     property;

 2. show that the collection of sets that has the property is a -algebra.
For example, the proof of 5.6 used the technique above--first we showed that every
measurable rectangle in S  T has the desired property, then we showed that the
collection of sets that has the desired property is a -algebra (this completed the proof
because S  T is the smallest -algebra containing the measurable rectangles).

   The technique outlined above should be used when possible. However, in some
situations there seems to be no reasonable way to verify that the collection of sets
with the desired property is a -algebra. We will encounter this situation in the next
subsection. To deal with it, we need to introduce another technique that involves
what are called monotone classes.

   The following definition will be used in our main theorem about monotone classes.

  5.10 Definition algebra
  Suppose W is a set and A is a set of subsets of W. Then A is called an algebra
  on W if the following three conditions are satisfied.

    ·   A.
    · If E  A, then W \ E  A.
    · If E and F are elements of A, then E  F  A.
   Thus an algebra is closed under complementation and under finite unions; a
-algebra is closed under complementation and countable unions.

5.11 Example collection of finite unions of intervals is an algebra
   Suppose A is the collection of all finite unions of intervals of R. Here we are in-

cluding all intervals--open intervals, closed intervals, bounded intervals, unbounded
intervals, sets consisting of only a single point, and intervals that are neither open nor
closed because they contain one endpoint but not the other endpoint.

   Clearly A is closed under finite unions. You should also verify that A is closed
under complementation. Thus A is an algebra on R.

5.12 Example collection of countable unions of intervals is not an algebra
   Suppose A is the collection of all countable unions of intervals of R.
   Clearly A is closed under finite unions (and also under countable unions). You

should verify that A is not closed under complementation. Thus A is neither an
algebra nor a -algebra on R.

                     Measure, Integration & Real Analysis, by Sheldon Axler
            Section 5A Products of Measure Spaces 121

   The following result provides an example of an algebra that we will exploit.

5.13 the set of finite unions of measurable rectangles is an algebra

Suppose (X, S ) and (Y, T ) are measurable spaces. Then
(a) the set of finite unions of measurable rectangles in S  T is an algebra

     on X × Y;
(b) every finite union of measurable rectangles in S  T can be written as a

     finite union of disjoint measurable rectangles in S  T .

Proof Let A denote the set of finite unions of measurable rectangles in S  T .
Obviously A is closed under finite unions.

   The collection A is also closed under finite intersections. To verify this claim,
note that if A1, . . . , An, C1, . . . , Cm  S and B1, . . . , Bn, D1, . . . , Dm  T , then

(A1 × B1)  · · ·  (An × Bn)        (C1 × D1)  · · ·  (Cm × Dm)

   nm       (Aj × Bj)  (Ck × Dk)

=

   j=1 k=1

   nm       (Aj  Ck) × (Bj  Dk) ,

=

   j=1 k=1

                                                Intersection of two rectangles is a rectangle.
which implies that A is closed under finite intersections.

   If A  S and B  T , then

            (X × Y) \ (A × B) = (X \ A) × Y  X × (Y \ B) .

Hence the complement of each measurable rectangle in S  T is in A. Thus the
complement of a finite union of measurable rectangles in S  T is in A (use De
Morgan's Laws and the result in the previous paragraph that A is closed under finite
intersections). In other words, A is closed under complementation, completing the
proof of (a).

   To prove (b), note that if A × B and C × D are measurable rectangles in S  T ,
then (as can be verified in the figure above)

5.14 (A × B)  (C × D) = (A × B)  C × (D \ B)  (C \ A) × (B  D) .

The equation above writes the union of two measurable rectangles in S  T as the
union of three disjoint measurable rectangles in S  T .

   Now consider any finite union of measurable rectangles in S  T . If this is not
a disjoint union, then choose any nondisjoint pair of measurable rectangles in the
union and replace those two measurable rectangles with the union of three disjoint
measurable rectangles as in 5.14. Iterate this process until obtaining a disjoint union
of measurable rectangles.

                     Measure, Integration & Real Analysis, by Sheldon Axler
122 Chapter 5 Product Measures

   Now we define a monotone class as a collection of sets that is closed under
countable increasing unions and under countable decreasing intersections.

  5.15 Definition monotone class
  Suppose W is a set and M is a set of subsets of W. Then M is called a monotone
  class on W if the following two conditions are satisfied.

                                                                                                               

    · If E1  E2  · · · is an increasing sequence of sets in M, then Ek  M.

                                                                                                         k=1
                                                                                                               

    · If E1  E2  · · · is a decreasing sequence of sets in M, then Ek  M.

                                                                                                         k=1

   Clearly every -algebra is a monotone class. However, some monotone classes
are not closed under even finite unions, as shown by the next example.

5.16 Example a monotone class that is not an algebra
   Suppose A is the collection of all intervals of R. Then A is closed under countable

increasing unions and countable decreasing intersections. Thus A is a monotone
class on R. However, A is not closed under finite unions, and A is not closed under
complementation. Thus A is neither an algebra nor a -algebra on R.

   If A is a collection of subsets of some set W, then the intersection of all mono-
tone classes on W that contain A is a monotone class that contains A. Thus this
intersection is the smallest monotone class on W that contains A.

   The next result provides a useful tool when the standard technique for showing
that every set in a -algebra has a certain property does not work.

  5.17 Monotone Class Theorem
  Suppose A is an algebra on a set W. Then the smallest -algebra containing A is
  the smallest monotone class containing A.

Proof Let M denote the smallest monotone class containing A. Because every -
algebra is a monotone class, M is contained in the smallest -algebra containing A.

   To prove the inclusion in the other direction, first suppose A  A. Let
                              E = {E  M : A  E  M}.

Then A  E (because the union of two sets in A is in A). A moment's thought
shows that E is a monotone class. Thus the smallest monotone class that contains A
is contained in E , meaning that M  E . Hence we have proved that A  E  M
for every E  M.

   Now let
                     D = {D  M : D  E  M for all E  M}.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 5A Products of Measure Spaces 123

The previous paragraph shows that A  D. A moment's thought again shows that D
is a monotone class. Thus, as in the previous paragraph, we conclude that M  D.
Hence we have proved that D  E  M for all D, E  M.

   The paragraph above shows that the monotone class M is closed under finite
unions. Now if E1, E2, . . .  M, then

           E1  E2  E3  · · · = E1  (E1  E2)  (E1  E2  E3)  · · · ,
which is an increasing union of a sequence of sets in M (by the previous paragraph).
We conclude that M is closed under countable unions.

   Finally, let
                             M = {E  M : W \ E  M}.

Then A  M (because A is closed under complementation). Once again, you
should verify that M is a monotone class. Thus M  M. We conclude that M is
closed under complementation.

   The two previous paragraphs show that M is closed under countable unions and
under complementation. Thus M is a -algebra that contains A. Hence M contains
the smallest -algebra containing A, completing the proof.

Products of Measures

The following definitions will be useful.

  5.18 Definition finite measure; -finite measure
    · A measure µ on a measurable space (X, S) is called finite if µ(X) < .
    · A measure is called -finite if the whole space can be written as the countable
       union of sets with finite measure.
    · More precisely, a measure µ on a measurable space (X, S ) is called -finite
       if there exists a sequence X1, X2, . . . of sets in S such that

                                       

                     X = Xk and µ(Xk) <  for every k  Z+.

                                    k=1

5.19 Example finite and -finite measures
  · Lebesgue measure on the interval [0, 1] is a finite measure.
  · Lebesgue measure on R is not a finite measure but is a -finite measure.
  · Counting measure on R is not a -finite measure (because the countable union
     of finite sets is a countable set).

                      Measure, Integration & Real Analysis, by Sheldon Axler
124 Chapter 5 Product Measures

The next result will allow us to define the product of two -finite measures.

5.20 measure of cross section is a measurable function

Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. If E  S  T ,
then

(a) x  ([E]x) is an S-measurable function on X;
(b) y  µ([E]y) is a T -measurable function on Y.

Proof We will prove (a). If E  S  T , then [E]x  T for every x  X (by 5.6);
thus the function x  ([E]x) is well defined on X.

   We first consider the case where  is a finite measure. Let

M = {E  S  T : x  ([E]x) is an S-measurable function on X}.

We need to prove that M = S  T .
   If A  S and B  T , then ([A × B]x) = (B)A(x) for every x  X (by

Example 5.5). Thus the function x  ([A × B]x) equals the function (B)A (as
a function on X), which is an S-measurable function on X. Hence M contains all
the measurable rectangles in S  T .

   Let A denote the set of finite unions of measurable rectangles in S  T . Suppose
E  A. Then by 5.13(b), E is a union of disjoint measurable rectangles E1, . . . , En.
Thus

([E]x) = ([E1  · · ·  En]x)
         = ([E1]x  · · ·  [En]x)
         = ([E1]x) + · · · + ([En]x),

where the last equality holds because  is a measure and [E1]x, . . . , [En]x are disjoint.
The equation above, when combined with the conclusion of the previous paragraph,
shows that x  ([E]x) is a finite sum of S-measurable functions and thus is an
S-measurable function. Hence E  M. We have now shown that A  M.

   Our next goal is to show that M is a monotone class on X × Y. To do this, first
suppose E1  E2  · · · is an increasing sequence of sets in M. Then

                                           

 [ Ek]x                          =  ([Ek]x)

     k=1                                 k=1

                                 = lim ([Ek]x),

                                     k

where we have used 2.59. Because the pointwise limit of S-measurable functions
is S-measurable (by 2.48), the equation above shows that x   [         Ek ]x    is
an S-measurable function. Hence       Ek     M.  We  have  now  k=1
                                 k=1                            shown  that  M  is

closed under countable increasing unions.

Measure, Integration & Real Analysis, by Sheldon Axler
                           Section 5A Products of Measure Spaces 125

Now suppose E1  E2  · · · is a decreasing sequence of sets in M. Then

                                                   

                  [ Ek]x                 =  ([Ek]x)

                      k=1                        k=1

                                         = lim ([Ek]x),

                                             k

where we have used 2.60 (this is where we use the assumption that  is a finite
measure). Because the pointwise limit of S-measurable functions is S-measurable
(by 2.48), the equation above shows that x   [                Ek ]x  is an S-measurable
                                                         k=1
function. Hence            M.         We have now shown that M is closed under
                 k=1 Ek
countable decreasing intersections.
We have shown that M is a monotone class that contains the algebra A of all
finite unions of measurable rectangles in S  T [by 5.13(a), A is indeed an algebra].
The Monotone Class Theorem (5.17) implies that M contains the smallest -algebra
containing A. In other words, M contains S  T . This conclusion completes the
proof of (a) in the case where  is a finite measure.
Now consider the case where  is a -finite measure. Thus there exists a sequence
Y1, Y2, . . . of sets in T such that             Y  and  (Yk )         for  each  k    Z+.
                                              =                 <                    
                                      k=1 Yk
Replacing each Yk by Y1  · · ·  Yk, we can assume that Y1  Y2  · · · . If
E  S  T , then
                 ([E]x) = lim ([E  (X × Yk)]x).
                                      k

The function x  ([E  (X × Yk)]x) is an S-measurable function on X, as follows
by considering the finite measure obtained by restricting  to the -algebra on Yk
consisting of sets in T that are contained in Yk. The equation above now implies that
x  ([E]x) is an S-measurable function on X, completing the proof of (a).

   The proof of (b) is similar.

5.21 Definition integration notation

Suppose (X, S, µ) is a measure space and g : X  [-, ] is a function. The
notation

                             g(x) dµ(x) means g dµ,

where dµ(x) indicates that variables other than x should be treated as constants.

5.22 Example integrals                           ( [0, 4] x2 + y) d(x) = 643 + 4y.
   If  is Lebesgue measure on [0, 4], then

          (x2 + y) d(y) = 4x2 + 8 and

        [0, 4]

   The intent in the next definition is that X Y f (x, y) d(y) dµ(x) is defined only
when the inner integral and then the outer integral both make sense.

Measure, Integration & Real Analysis, by Sheldon Axler
126 Chapter 5 Product Measures

5.23 Definition iterated integrals

Suppose (X, S, µ) and (Y, T , ) are measure spaces and f : X × Y  R is a
function. Then

           f (x, y) d(y) dµ(x) means                     f (x, y) d(y) dµ(x).

     XY                                           XY

In other words, to compute X Y f (x, y) d(y) dµ(x), first (temporarily) fix
x  X and compute Y f (x, y) d(y) [if this integral makes sense]. Then com-
pute the integral with respect to µ of the function x  Y f (x, y) d(y) [if this
integral makes sense].

5.24 Example iterated integrals
   If  is Lebesgue measure on [0, 4], then

              [0, 4] [0, 4]  (x2 + y) d(y) d(x) = (4x2 + 8) d(x)
                                                          [0, 4]

                                                     = 352 3
and

              ( [0, 4] [0, 4] x2 + y) d(x) d(y) = 64 + [0, 4] 3 4y d(y)

                                                  = 3523 .

The  two  iterated  integrals  in  this  example  turned  out  to  both  equal  352 ,  even  though

                                                                                 3
they do not look alike in the intermediate step of the evaluation. As we will see in the
next section, this equality of integrals when changing the order of integration is not a
coincidence.

   The definition of (µ × )(E) given below makes sense because the inner integral
below equals ([E]x), which makes sense by 5.6 (or use 5.9), and then the outer
integral makes sense by 5.20(a).

   The restriction in the definition below to -finite measures is not bothersome be-
cause the main results we seek are not valid without this hypothesis (see Example 5.30
in the next section).

5.25 Definition product of two measures; µ × 
Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. For E  S  T ,
define (µ × )(E) by

                    (µ × )(E) = X Y E(x, y) d(y) dµ(x).

              Measure, Integration & Real Analysis, by Sheldon Axler
Section 5A Products of Measure Spaces 127

5.26 Example measure of a rectangle
   Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. If A  S and

B  T , then

                  (µ × )(A × B) = X Y A × B(x, y) d(y) dµ(x)
                                      = X (B)A(x) dµ(x)
                                      = µ(A)(B).

Thus product measure of a measurable rectangle is the product of the measures of the
corresponding sets.

   For (X, S, µ) and (Y, T , ) -finite measure spaces, we defined the product µ × 
to be a function from S  T to [0, ] (see 5.25). Now we show that this function is
a measure.

5.27 product of two measures is a measure

Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. Then µ ×  is a
measure on (X × Y, S  T ).

Proof Clearly (µ × )() = 0.
   Suppose E1, E2, . . . is a disjoint sequence of sets in S  T . Then

                                   

(µ × ) Ek          = X k=1  [ Ek]x dµ(x)

              k=1                 

                   = X k=1  ([Ek]x) dµ(x)

                               

                   =  ([Ek]x) dµ(x)

                         X k=1

                        

                   =  ([Ek]x) dµ(x)

                       k=1 X

                        

                   =  (µ × )(Ek),

                       k=1

where the fourth equality follows from the Monotone Convergence Theorem (3.11;
or see Exercise 10 in Section 3A). The equation above shows that µ ×  satisfies the
countable additivity condition required for a measure.

Measure, Integration & Real Analysis, by Sheldon Axler
128 Chapter 5 Product Measures

EXERCISES 5A

 1 Suppose (X, S ) and (Y, T ) are measurable spaces. Prove that if A is a
     nonempty subset of X and B is a nonempty subset of Y such that A × B 
     S  T , then A  S and B  T .

 2 Suppose (X, S ) is a measurable space. Prove that if E  S  S, then
                                   {x  X : (x, x)  E}  S.

 3 Let B denote the -algebra of Borel subsets of R. Show that there exists a set
     E  R × R such that [E]a  B and [E]a  B for every a  R, but E / B  B.

4 Suppose (X, S ) and (Y, T ) are measurable spaces. Prove that if f : X  R is
    S-measurable and g : Y  R is T -measurable and h : X × Y  R is defined
    by h(x, y) = f (x)g(y), then h is (S  T )-measurable.

5 Verify the assertion in Example 5.11 that the collection of finite unions of
    intervals of R is closed under complementation.

6 Verify the assertion in Example 5.12 that the collection of countable unions of
    intervals of R is not closed under complementation.

7 Suppose A is a nonempty collection of subsets of a set W. Show that A is an
    algebra on W if and only if A is closed under finite intersections and under
    complementation.

8 Suppose µ is a measure on a measurable space (X, S ). Prove that the following
    are equivalent.

(a) The measure µ is -finite.

(b) There exists an increasing sequence X1  X2  · · · of sets in S such that
X=       Xk  and  µ(Xk)             for  every  k    Z+.
    k=1                        <

(c) There exists a disjoint sequence X1, X2, X3, . . . of sets in S such that
X=       Xk  and  µ(Xk)             for  every  k    Z+.
    k=1                        <

9 Suppose µ and  are -finite measures. Prove that µ ×  is a -finite measure.

10 Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. Prove that if  is
      a measure on S  T such that (A × B) = µ(A)(B) for all A  S and all
      B  T , then  = µ × .
      [The exercise above means that µ ×  is the unique measure on S  T that
      behaves as we expect on measurable rectangles.]

    Measure, Integration & Real Analysis, by Sheldon Axler
                      Section 5B Iterated Integrals 129

5B Iterated Integrals

Tonelli's Theorem

Relook at Example 5.24 in the previous section and notice that the value of the
iterated integral was unchanged when we switched the order of integration, even
though switching the order of integration led to different intermediate results. Our
next result states that the order of integration can be switched if the function being
integrated is nonnegative and the measures are -finite.

5.28 Tonelli's Theorem                                       Suppose
Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces.
f : X × Y  [0, ] is S  T -measurable. Then

(a)  x  f (x, y) d(y) is an S-measurable function on X,
     Y

(b)  y  f (x, y) dµ(x) is a T -measurable function on Y,
     X

and

X×Y  f d(µ × ) =  XY  f (x, y) d(y) dµ(x) =  YX  f (x, y) dµ(x) d(y).

Proof We begin by considering the special case where f = E for some E  S  T .
In this case,

                       Y E(x, y) d(y) = ([E]x) for every x  X
and

                      X E(x, y) dµ(x) = µ([E]y) for every y  Y.
Thus (a) and (b) hold in this case by 5.20.

   First assume that µ and  are finite measures. Let

M = E  S  T : X Y E(x, y) d(y) dµ(x) = Y X E(x, y) dµ(x) d(y) .
If A  S and B  T , then A × B  M because both sides of the equation defining
M equal µ(A)(B).

   Let A denote the set of finite unions of measurable rectangles in S  T . Then
5.13(b) implies that every element of A is a disjoint union of measurable rectangles
in S  T . The previous paragraph now implies A  M.

   The Monotone Convergence Theorem (3.11) implies that M is closed under
countable increasing unions. The Bounded Convergence Theorem (3.26) implies
that M is closed under countable decreasing intersections (this is where we use the
assumption that µ and  are finite measures).

   We have shown that M is a monotone class that contains the algebra A of all
finite unions of measurable rectangles in S  T [by 5.13(a), A is indeed an algebra].

                     Measure, Integration & Real Analysis, by Sheldon Axler
130 Chapter 5 Product Measures

The Monotone Class Theorem (5.17) implies that M contains the smallest -algebra
containing A. In other words, M contains S  T . Thus

5.29 X Y E(x, y) d(y) dµ(x) = Y X E(x, y) dµ(x) d(y)
for every E  S  T .

   Now relax the assumption that µ and  are finite measures. Write X as an
increasing union of sets X1  X2  · · · in S with finite measure, and write Y
as an increasing union of sets Y1  Y2  · · · in T with finite measure. Suppose
E  S  T . Applying the finite-measure case to the situation where the measures
and the -algebras are restricted to Xj and Yk, we can conclude that 5.29 holds
with E replaced by E  (Xj × Yk) for all j, k  Z+. Fix k  Z+ and use the
Monotone Convergence Theorem (3.11) to conclude that 5.29 holds with E replaced
by E  (X × Yk) for all k  Z+. One more use of the Monotone Convergence
Theorem then shows that

X×Y E d(µ × ) = X Y E(x, y) d(y) dµ(x) = Y X E(x, y) dµ(x) d(y)

for all E  S  T , where the first equality above comes from the definition of
(µ × )(E) (see 5.25).

   Now we turn from characteristic functions to the general case of an S  T -
measurable function f : X × Y  [0, ]. Define a sequence f1, f2, . . . of simple
S  T -measurable functions from X × Y to [0, ) by

                                                                       m m+1
            m
fk(x, y) = 2k if f (x, y) < k and m is the integer with f (x, y)  2k , 2k ,
           k if f (x, y)  k.

Note that

    0  f1(x, y)  f2(x, y)  f3(x, y)  · · · and lim fk(x, y) = f (x, y)

                                                                                     k

for all (x, y)  X × Y.
   Each fk is a finite sum of functions of the form cE, where c  R and E  S  T .

Thus the conclusions of this theorem hold for each function fk.
   The Monotone Convergence Theorem implies that

                  f (x, y) d(y) = lim fk(x, y) d(y)
               Y                k Y

for every x  X. Thus the function x  Y f (x, y) d(y) is the pointwise limit on
X of a sequence of S-measurable functions. Hence (a) holds, as does (b) for similar
reasons.

   The last line in the statement of this theorem holds for each fk. The Monotone
Convergence Theorem now implies that the last line in the statement of this theorem
holds for f , completing the proof.

               Measure, Integration & Real Analysis, by Sheldon Axler
                                              Section 5B Iterated Integrals 131

   See Exercise 1 in this section for an example (with finite measures) showing that
Tonelli's Theorem can fail without the hypothesis that the function being integrated
is nonnegative. The next example shows that the hypothesis of -finite measures also
cannot be eliminated.

5.30 Example Tonelli's Theorem can fail without the hypothesis of -finite
   Suppose B is the -algebra of Borel subsets of [0, 1],  is Lebesgue measure on

([0, 1], B), and µ is counting measure on ([0, 1], B). Let D denote the diagonal of
[0, 1] × [0, 1]; in other words,

                  D = {(x, x) : x  [0, 1]}.

Then  [0, 1] [0, 1] D [ (x, y) dµ(y) d(x) = 0, 1] 1 d = 1,
but   [0, 1] [0, 1] D [ (x, y) d(x) dµ(y) = 0, 1] 0 dµ = 0.

   The following useful corollary of Tonelli's Theorem states that we can switch the
order of summation in a double-sum of nonnegative numbers. Exercise 2 asks you
to find a double-sum of real numbers in which switching the order of summation
changes the value of the double sum.

5.31 double sums of nonnegative numbers

If {xj,k : j, k  Z+} is a doubly indexed collection of nonnegative numbers, then

                                              
                    xj,k =   xj,k.
                  j=1 k=1                     k=1 j=1

Proof Apply Tonelli's Theorem (5.28) to µ × µ, where µ is counting measure
on Z+.

Fubini's Theorem

Our next goal is Fubini's Theorem, which      Historically, Fubini's Theorem
has the same conclusions as Tonelli's         (proved in 1907) came before
Theorem but has a different hypothesis.       Tonelli's Theorem (proved in 1909).
Tonelli's Theorem requires the function       However, presenting Tonelli's
being integrated to be nonnegative. Fu-       Theorem first, as is done here, seems
bini's Theorem instead requires the inte-     to lead to simpler proofs and better
gral of the absolute value of the function    understanding. The hard work here
to be finite. When using Fubini's The-        went into proving Tonelli's Theorem;
orem to evaluate the integral of f , you      thus our proof of Fubini's Theorem
will usually first use Tonelli's Theorem as   consists mainly of bookkeeping
applied to | f | to verify the hypothesis of  details.
Fubini's Theorem.

      Measure, Integration & Real Analysis, by Sheldon Axler
132 Chapter 5 Product Measures

   As you will see in the proof of Fubini's Theorem, the function in 5.32(a) is defined
only for almost every x  X and the function in 5.32(b) is defined only for almost
every y  Y. For convenience, you can think of these functions as equaling 0 on the
sets of measure 0 on which they are otherwise undefined.

5.32 Fubini's Theorem

Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces. Suppose
f : X × Y  [-, ] is S  T -measurable and X×Y| f | d(µ × ) < .
Then

                     | f (x, y)| d(y) <  for almost every x  X

                           Y

and
                     | f (x, y)| dµ(x) <  for almost every y  Y.

                           X

Furthermore,

(a)   x  f (x, y) d(y) is an S-measurable function on X,
      Y

(b)   y  f (x, y) dµ(x) is a T -measurable function on Y,
      X

and

X×Y   f d(µ × ) =  XY  f (x, y) d(y) dµ(x) =  YX  f (x, y) dµ(x) d(y).

Proof Tonelli's Theorem (5.28) applied to the nonnegative function | f | implies that
x  Y| f (x, y)| d(y) is an S-measurable function on X. Hence

                       x  X : | f (x, y)| d(y) =   S.

                                               Y

Tonelli's Theorem applied to | f | also tells us that

                                    | f (x, y)| d(y) dµ(x) < 

                                         XY

because the iterated integral above equals X×Y| f | d(µ × ). The inequality above
implies that

                      µ x  X : | f (x, y)| d(y) =  = 0.

                                                     Y

   Recall that f + and f - are nonnegative S  T -measurable functions such that
| f | = f + + f - and f = f + - f - (see 3.17). Applying Tonelli's Theorem to f +
and f -, we see that

5.33  x  f +(x, y) d(y) and x  f -(x, y) d(y)
      Y                         Y

      Measure, Integration & Real Analysis, by Sheldon Axler
                                      Section 5B Iterated Integrals 133

are S-measurable functions from X to [0, ]. Because f +  | f | and f -  | f |, the
sets {x  X : Y f +(x, y) d(y) = } and {x  X : Y f -(x, y) d(y) = }
have µ-measure 0. Thus the intersection of these two sets, which is the set of x  X
such that Y f (x, y) d(y) is not defined, also has µ-measure 0.

   Subtracting the second function in 5.33 from the first function in 5.33, we see that
the function that we define to be 0 for those x  X where we encounter  -  (a
set of µ-measure 0, as noted above) and that equals Y f (x, y) d(y) elsewhere is an
S-measurable function on X.

   Now

X×Y  f d(µ × ) =  X×Y  f + d(µ × ) -  X×Y    f - d(µ × )

     =            XY   f +(x, y) d(y) dµ(x) -  XY  f -(x, y) d(y) dµ(x)

     =            XY   f +(x, y) - f -(x, y) d(y) dµ(x)

     =            XY   f (x, y) d(y) dµ(x),

where the first line above comes from the definition of the integral of a function that
is not nonnegative (note that neither of the two terms on the right side of the first line
equals  because X×Y| f | d(µ × ) < ) and the second line comes from applying
Tonelli's Theorem to f + and f -.

   We have now proved all aspects of Fubini's Theorem that involve integrating first
over Y. The same procedure provides proofs for the aspects of Fubini's theorem that
involve integrating first over X.

Area Under Graph

5.34 Definition region under the graph; U f
Suppose X is a set and f : X  [0, ] is a function. Then the region under the
graph of f , denoted Uf , is defined by

                   Uf = {(x, t)  X × (0, ) : 0 < t < f (x)}.

                                        The figure indicates why we call Uf
                                     the region under the graph of f , even
                                     in cases when X is not a subset of R.
                                     Similarly, the informal term area in the
                                     next paragraph should remind you of the
                                     area in the figure, even though we are
                                     really dealing with the measure of Uf in
                                     a product space.
     Measure, Integration & Real Analysis, by Sheldon Axler
134 Chapter 5 Product Measures

   The first equality in the result below can be thought of as recovering Riemann's
conception of the integral as the area under the graph (although now in a much more
general context with arbitrary -finite measures). The second equality in the result
below can be thought of as reinforcing Lebesgue's conception of computing the area
under a curve by integrating in the direction perpendicular to Riemann's.

5.35 area under the graph of a function equals the integral
Suppose (X, S, µ) is a -finite measure space and f : X  [0, ] is an
S-measurable function. Let B denote the -algebra of Borel subsets of (0, ),
and let  denote Lebesgue measure on (0, ), B . Then Uf  S  B and

(µ × )(Uf ) = X f ( dµ = 0, ) µ({x  X : t < f (x)}) d(t).

Proof For k  Z+, let

Ek =  k2-1  f -1 [ m , m+1 ) × 0, m   and Fk = f -1([k, ]) × (0, k).

      m=0   kk                     k

Then Ek is a finite union of S  B-measurable rectangles and Fk is an S  B-
measurable rectangle. Because

                                 

                      U f = (Ek  Fk),

                                k=1

we conclude that Uf  S  B.
   Now the definition of the product measure µ ×  implies that

                   (µ × )(U f ) = X (0, ) Uf (x, t) d(t) dµ(x)

                                    = f (x) dµ(x),

                                                        X

which completes the proof of the first equality in the conclusion of this theorem.
   Tonelli's Theorem (5.28) tells us that we can interchange the order of integration

in the double integral above, getting

                ( (µ × )(U f ) = 0, ) X Uf (x, t) dµ(x) d(t)

                                 ( = 0, ) µ({x  X : t < f (x)}) d(t),
which completes the proof of the second equality in the conclusion of this theorem.

Markov's inequality (4.1) implies that if f and µ are as in the result above, then

                      µ({x  X : f (x) > t})  X f dµ t

for all t > 0. Thus if X f dµ < , then the result above should be considered to be
somewhat stronger than Markov's inequality (because         1  d(t)     ).
                                                     (0, )  t        =

            Measure, Integration & Real Analysis, by Sheldon Axler
              Section 5B Iterated Integrals 135

EXERCISES 5B

1 (a) Let  denote Lebesgue measure on [0, 1]. Show that

[0, 1] [0, 1] (x2 + y2)2 x d( 2 - y2 y) d(x) = 4

and x2 - y2 d(x) d(y) = -  .
[0, 1] [0, 1] (x2 + y2)2                                 4

(b) Explain why (a) violates neither Tonelli's Theorem nor Fubini's Theorem.

2 (a) Give an example of a doubly indexed collection {xm,n : m, n  Z+} of
          real numbers such that

                          
  xm,n = 0 and   xm,n = .
m=1 n=1                   n=1 m=1

(b) Explain why (a) violates neither Tonelli's Theorem nor Fubini's Theorem.

3 Suppose (X, S ) is a measurable space and f : X  [0, ] is a function. Let B
    denote the -algebra of Borel subsets of (0, ). Prove that Uf  S  B if and
    only if f is an S-measurable function.

4 Suppose (X, S ) is a measurable space and f : X  R is a function. Let
    graph( f )  X × R denote the graph of f :

graph( f ) = { x, f (x) : x  X}.

Let B denote the -algebra of Borel subsets of R. Prove that graph( f )  S  B
if f is an S-measurable function.

Measure, Integration & Real Analysis, by Sheldon Axler
136 Chapter 5 Product Measures

5C Lebesgue Integration on Rn

Throughout this section, assume that m and n are positive integers. Thus, for example,
5.36 should include the hypothesis that m and n are positive integers, but theorems
and definitions become easier to state without explicitly repeating this hypothesis.

Borel Subsets of Rn

We begin with a quick review of notation and key concepts concerning Rn.
   Recall that Rn is the set of all n-tuples of real numbers:
                         Rn = {(x1, . . . , xn) : x1, . . . , xn  R}.

The function · from Rn to [0, ) is defined by
                        (x1, . . . , xn) = max{|x1|, . . . , |xn|}.

For x  Rn and  > 0, the open cube B(x, ) with side length 2 is defined by
                          B(x, ) = {y  Rn : y - x < }.

If n = 1, then an open cube is simply a bounded open interval. If n = 2, then an
open cube might more appropriately be called an open square. However, using the
cube terminology for all dimensions has the advantage of not requiring a different
word for different dimensions.

   A subset G of Rn is called open if for every x  G, there exists  > 0 such that
B(x, )  G. Equivalently, a subset G of Rn is called open if every element of G is
contained in an open cube that is contained in G.

   The union of every collection (finite or infinite) of open subsets of Rn is an open
subset of Rn. Also, the intersection of every finite collection of open subsets of Rn is
an open subset of Rn.

   A subset of Rn is called closed if its complement in Rn is open. A set A  Rn is
called bounded if sup{a : a  A} < .

   We adopt the following common convention:
                            Rm × Rn is identified with Rm+n.

To understand the necessity of this convention, note that R2 × R = R3 because
R2 × R and R3 contain different kinds of objects. Specifically, an element of R2 × R
is an ordered pair, the first of which is an element of R2 and the second of which is
an element of R; thus an element of R2 × R looks like (x1, x2), x3 . An element
of R3 is an ordered triple of real numbers that looks like (x1, x2, x3). However, we
can identify (x1, x2), x3 with (x1, x2, x3) in the obvious way. Thus we say that
R2 × R "equals" R3. More generally, we make the natural identification of Rm × Rn
with Rm+n.

   To check that you understand the identification discussed above, make sure that
you see why B(x, ) × B(y, ) = B (x, y),  for all x  Rm, y  Rn, and  > 0.

   We can now prove that the product of two open sets is an open set.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                             Section 5C Lebesgue Integration on Rn 137

  5.36 product of open sets is open
  Suppose G1 is an open subset of Rm and G2 is an open subset of Rn. Then
  G1 × G2 is an open subset of Rm+n.
Proof Suppose (x, y)  G1 × G2. Then there exists an open cube D in Rm centered
at x and an open cube E in Rn centered at y such that D  G1 and E  G2. By
reducing the size of either D or E, we can assume that the cubes D and E have the
same side length. Thus D × E is an open cube in Rm+n centered at (x, y) that is
contained in G1 × G2.
   We have shown that an arbitrary point in G1 × G2 is the center of an open cube
contained in G1 × G2. Hence G1 × G2 is an open subset of Rm+n.
   When n = 1, the definition below of a Borel subset of R1 agrees with our previous
definition (2.29) of a Borel subset of R.

  5.37 Definition Borel set; Bn
    · A Borel subset of Rn is an element of the smallest -algebra on Rn containing
       all open subsets of Rn.
    · The -algebra of Borel subsets of Rn is denoted by Bn.
   Recall that a subset of R is open if and only if it is a countable disjoint union of

open intervals. Part (a) in the result below provides a similar result in Rn, although
we must give up the disjoint aspect.

  5.38 open sets are countable unions of open cubes
  (a) A subset of Rn is open if and only if it is a countable union of open cubes

       in Rn.
  (b) Bn is the smallest -algebra on Rn containing all the open cubes in Rn.
Proof We will prove (a), which clearly implies (b).
   The proof that a countable union of open cubes is open is left as an exercise for
the reader (actually, arbitrary unions of open cubes are open).
   To prove the other direction, suppose G is an open subset of Rn. For each x  G,
there is an open cube centered at x that is contained in G. Thus there is a smaller
cube Cx such that x  Cx  G and all coordinates of the center of Cx are rational
numbers and the side length of Cx is a rational number. Now

                                         G = Cx.

                                                              xG

However, there are only countably many distinct cubes whose center has all rational
coordinates and whose side length is rational. Thus G is the countable union of open
cubes.

                     Measure, Integration & Real Analysis, by Sheldon Axler
138 Chapter 5 Product Measures

   The next result tells us that the collection of Borel sets from various dimensions
fit together nicely.

5.39 product of the Borel subsets of Rm and the Borel subsets of Rn

Bm  Bn = Bm+n.

Proof Suppose E is an open cube in Rm+n. Thus E is the product of an open cube
in Rm and an open cube in Rn. Hence E  Bm  Bn. Thus the smallest -algebra
containing all the open cubes in Rm+n is contained in Bm  Bn. Now 5.38(b) implies
that Bm+n  Bm  Bn.

   To prove the set inclusion in the other direction, temporarily fix an open set G
in Rn. Let

                           E = {A  Rm : A × G  Bm+n}.
Then E contains every open subset of Rm (as follows from 5.36). Also, E is closed
under countable unions because

                                      

                    Ak  × G = (Ak × G).

                k=1                 k=1

Furthermore, E is closed under complementation because

Rm \ A × G = (Rm × Rn) \ (A × G)  Rm × G .

Thus E is a -algebra on Rm that contains all open subsets of Rm, which implies that
Bm  E . In other words, we have proved that if A  Bm and G is an open subset of
Rn, then A × G  Bm+n.

   Now temporarily fix a Borel subset A of Rm. Let
                            F = {B  Rn : A × B  Bm+n}.

The conclusion of the previous paragraph shows that F contains every open subset of
Rn. As in the previous paragraph, we also see that F is a -algebra. Hence Bn  F .
In other words, we have proved that if A  Bm and B  Bn, then A × B  Bm+n.
Thus Bm  Bn  Bm+n, completing the proof.

   The previous result implies a nice associative property. Specifically, if m, n, and
p are positive integers, then two applications of 5.39 give

                     (Bm  Bn)  Bp = Bm+n  Bp = Bm+n+p.
Similarly, two more applications of 5.39 give

                     Bm  (Bn  Bp) = Bm  Bn+p = Bm+n+p.
Thus (Bm  Bn)  Bp = Bm  (Bn  Bp); hence we can dispense with parentheses
when taking products of more than two Borel -algebras. More generally, we could
have defined Bm  Bn  Bp directly as the smallest -algebra on Rm+n+p containing
{A × B × C : A  Bm, B  Bn, C  Bp} and obtained the same -algebra (see
Exercise 3 in this section).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                             Section 5C Lebesgue Integration on Rn 139

Lebesgue Measure on Rn

  5.40 Definition Lebesgue measure; n
  Lebesgue measure on Rn is denoted by n and is defined inductively by

                                      n = n-1 × 1,
  where 1 is Lebesgue measure on (R, B1).
   Because Bn = Bn-1  B1 (by 5.39), the measure n is defined on the Borel
subsets of Rn. Thinking of a typical point in Rn as (x, y), where x  Rn-1 and
y  R, we can use the definition of the product of two measures (5.25) to write

                     R n(E) = n-1 R E(x, y) d1(y) dn-1(x)
for E  Bn. Of course, we could use Tonelli's Theorem (5.28) to interchange the
order of integration in the equation above.

   Because Lebesgue measure is the most commonly used measure, mathematicians
often dispense with explicitly displaying the measure and just use a variable name.
In other words, if no measure is explicitly displayed in an integral and the context
indicates no other measure, then you should assume that the measure involved
is Lebesgue measure in the appropriate dimension. For example, the result of
interchanging the order of integration in the equation above could be written as

                            R R n(E) = n-1 E(x, y) dx dy
for E  Bn; here dx means dn-1(x) and dy means d1(y).

   In the equations above giving formulas for n(E), the integral over Rn-1 could be
rewritten as an iterated integral over Rn-2 and R, and that process could be repeated
until reaching iterated integrals only over R. Tonelli's Theorem could then be used
repeatedly to swap the order of pairs of those iterated integrals, leading to iterated
integrals in any order.

   Similar comments apply to integrating functions on Rn other than characteristic
functions. For example, if f : R3  R is a B3-measurable function such that either
f  0 or R3 | f | d3 < , then by either Tonelli's Theorem or Fubini's Theorem we
have

                     R3 f R R R d3 = f (x1, x2, x3) dxj dxk dxm,
where j, k, m is any permutation of 1, 2, 3.

   Although we defined n to be n-1 × 1, we could have defined n to be j × k
for any positive integers j, k with j + k = n. This potentially different definition
would have led to the same -algebra Bn (by 5.39) and to the same measure n
[because both potential definitions of n(E) can be written as identical iterations of
n integrals with respect to 1].

                     Measure, Integration & Real Analysis, by Sheldon Axler
140 Chapter 5 Product Measures

Volume of Unit Ball in Rn

The proof of the next result provides good experience in working with the Lebesgue
measure n. Recall that tE = {tx : x  E}.

5.41 measure of a dilation

Suppose t > 0. If E  Bn, then tE  Bn and n(tE) = tnn(E).

Proof Let       E = {E  Bn : tE  Bn}.

Then E contains every open subset of Rn (because if E is open in Rn then tE is open
in Rn). Also, E is closed under complementation and countable unions because

                                                  
             t(Rn \ E) = Rn \ (tE) and t Ek = (tEk).

                                             k=1  k=1
Hence E is a -algebra on Rn containing the open subsets of Rn. Thus E = Bn. In
other words, tE  Bn for all E  Bn.
To prove n(tE) = tnn(E), first consider the case n = 1. Lebesgue measure on
R is a restriction of outer measure. The outer measure of a set is determined by the
sum of the lengths of countable collections of intervals whose union contains the set.
Multiplying the set by t corresponds to multiplying each such interval by t, which
multiplies the length of each such interval by t. In other words, 1(tE) = t1(E).
Now assume n > 1. We will use induction on n and assume that the desired result
holds for n - 1. If A  Bn-1 and B  B1, then

             n t(A × B) = n (tA) × (tB)

                            = n-1(tA) · 1(tB)

                            = tn-1n-1(A) · t1(B)
                            = tnn(A × B),
5.42

giving the desired result for A × B.
   For m  Z+, let Cm be the open cube in Rn centered at the origin and with side

length m. Let
                 Em = {E  Bn : E  Cm and n(tE) = tnn(E)}.

From 5.42 and using 5.13(b), we see that finite unions of measurable rectangles
contained in Cm are in Em. You should verify that Em is closed under countable
increasing unions (use 2.59) and countable decreasing intersections (use 2.60, whose
finite measure condition holds because we are working inside Cm). From 5.13 and
the Monotone Class Theorem (5.17), we conclude that Em is the -algebra on Cm
consisting of Borel subsets of Cm. Thus n(tE) = tnn(E) for all E  Bn such that
E  Cm.

   Now suppose E  Bn. Then 2.59 implies that

      n(tE) = lim n t(E  Cm) = tn lim n(E  Cm) = tnn(E),
             m                      m

as desired.

             Measure, Integration & Real Analysis, by Sheldon Axler
Section 5C Lebesgue Integration on Rn                                           
                                                                          100 2

5.43 Definition open unit ball in Rn; Bn
The open unit ball in Rn is denoted by Bn and is defined by

                Bn = {(x1, . . . , xn)  Rn : x12 + · · · + xn2 < 1}.

   The open unit ball Bn is open in Rn (as you should verify) and thus is in the
collection Bn of Borel sets.

5.44 volume of the unit ball in Rn               if n is even,
                                                 if n is odd.
                                  n/2
                                 
                                (n/2)!

                  n(Bn) =  2(n+1)/2 (n-1)/2
                                 
                                    1·3·5·····n

Proof Because 1(B1) = 2 and 2(B2) = , the claimed formula is correct when
n = 1 and when n = 2.

   Now assume that n > 2. We will use induction on n, assuming that the claimed for-
mula is true for smaller values of n. Think of Rn = R2 × Rn-2 and n = 2 × n-2.
Then

R 5.45 n(Bn) = 2 Rn-2 Bn(x, y) dy dx.
   Temporarily fix x = (x1, x2)  R2. If x12 + x22  1, then Bn(x, y) = 0 for

all y  Rn-2. If x12 + x22 < 1 and y  Rn-2, then Bn(x, y) = 1 if and only if
y  (1 - x12 - x22)1/2Bn-2. Thus the inner integral in 5.45 equals

                        n-2 (1 - x12 - x22)1/2Bn-2 B2(x),
which by 5.41 equals

                      (1 - x12 - x22)(n-2)/2n-2(Bn-2)B2(x).
Thus 5.45 becomes the equation

n(Bn) = n-2(Bn-2) (1 - x12 - x22)(n-2)/2 d2(x1, x2).

                                         B2

To evaluate this integral, switch to the usual polar coordinates that you learned about
in calculus (d2 = r dr d), getting

                                              (1 1 - r2)(n-2)/2r dr d

n(Bn) = n-2(Bn-2) -                          0
          = 2n n-2(Bn-2).

The last equation and the induction hypothesis give the desired result.

Measure, Integration & Real Analysis, by Sheldon Axler
142 Chapter 5 Product Measures

   This table gives the first five values of  n n(Bn)  n(Bn)
n(Bn), using 5.44. The last column of         1     2  2.00
this table gives a decimal approximation
to n(Bn), accurate to two digits after the    2        3.14
decimal point. From this table, you might
guess that n(Bn) is an increasing func-       3 4/3    4.19
tion of n, especially because the small-
est cube containing the ball Bn has n-        4 2/2    4.93
dimensional Lebesgue measure 2n. How-
ever, Exercise 12 in this section shows       5 82/15  5.26
that n(Bn) behaves much differently.

Equality of Mixed Partial Derivatives Via Fubini's Theorem

5.46 Definition partial derivatives; D1 f and D2 f

Suppose G is an open subset of R2 and f : G  R is a function. For (x, y)  G,
the partial derivatives (D1 f )(x, y) and (D2 f )(x, y) are defined by

(D1 f )(x, y) = lim f (x + t, y) - f (x, y)      t
                        t0

and (D2 f )(x, y) = lim f (x, y + t) - f (x, y)  t
                        t0

if these limits exist.

   Using the notation for the cross section of a function (see 5.7), we could write the
definitions of D1 and D2 in the following form:

            (D1 f )(x, y) = ([ f ]y)(x) and (D2 f )(x, y) = ([ f ]x)(y).

5.47 Example partial derivatives of xy
   Let G = {(x, y)  R2 : x > 0} and define f : G  R by f (x, y) = xy. Then
                (D1 f )(x, y) = yxy-1 and (D2 f )(x, y) = xy ln x,

as you should verify. Taking partial derivatives of those partial derivatives, we have
                          D2(D1 f ) (x, y) = xy-1 + yxy-1 ln x

and
                          D1(D2 f ) (x, y) = xy-1 + yxy-1 ln x,

as you should also verify. The last two equations show that D1(D2 f ) = D2(D1 f )
as functions on G.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                       Section 5C Lebesgue Integration on Rn 143

In the example above, the two mixed partial derivatives turn out to equal each
other, even though the intermediate results look quite different. The next result shows
that the behavior in the example above is typical rather than a coincidence.
Some proofs of the result below do not use Fubini's Theorem. However, Fubini's
Theorem leads to the clean proof below.
The integrals that appear in the proof Although the continuity hypotheses
below make sense because continuous
                                              in the result below can be slightly
                                           2
real-valued functions on R are measur- weakened, they cannot be
able (because for a continuous function, eliminated, as shown by Exercise 14
the inverse image of each open set is open) in this section.
and because continuous real-valued func-
tions on closed bounded subsets of R2 are
bounded.

5.48 equality of mixed partial derivatives

Suppose G is an open subset of R2 and f : G  R is a function such that D1 f ,
D2 f , D1(D2 f ), and D2(D1 f ) all exist and are continuous functions on G. Then

                                 D1(D2 f ) = D2(D1 f )
on G.

Proof Fix (a, b)  G. For  > 0, let S = [a, a + ] × [b, b + ]. If S  G, then

                                  b+ a+

S D1(D2 f ) d2 = b a D1(D2 f ) (x, y) dx dy

                   b+  (D2 f )(a + , y) - (D2 f )(a, y) dy

          =

                b

          = f (a + , b + ) - f (a + , b) - f (a, b + ) + f (a, b),

where the first equality comes from Fubini's Theorem (5.32) and the second and third
equalities come from the Fundamental Theorem of Calculus.

   A similar calculation of S D2(D1 f ) d2 yields the same result. Thus

                            S [D1(D2 f ) - D2(D1 f )] d2 = 0
for all  such that S  G. If D1(D2 f ) (a, b) > D2(D1 f ) (a, b), then by
the continuity of D1(D2 f ) and D2(D1 f ), the integrand in the equation above is
positive on S for  sufficiently small, which contradicts the integral above equaling
0. Similarly, the inequality D1(D2 f ) (a, b) < D2(D1 f ) (a, b) also contradicts
the equation above for small . Thus we conclude that

                           D1(D2 f ) (a, b) = D2(D1 f ) (a, b),
as desired.

          Measure, Integration & Real Analysis, by Sheldon Axler
144 Chapter 5 Product Measures

EXERCISES 5C

 1 Show that a set G  Rn is open in Rn if and only if for each (b1, . . . , bn)  G,
     there exists r > 0 such that
             (a1, . . . , an)  Rn : (a1 - b1)2 + · · · + (an - bn)2 < r  G.

 2 Show that there exists a set E  R2 (thinking of R2 as equal to R × R) such
     that the cross sections [E]a and [E]a are open subsets of R for every a  R, but
     E / B2.

 3 Suppose (X, S ), (Y, T ), and (Z, U ) are measurable spaces. We can define
     S  T  U to be the smallest -algebra on X × Y × Z that contains
                            {A × B × C : A  S, B  T , C  U }.
     Prove that if we make the obvious identifications of the products (X × Y) × Z
     and X × (Y × Z) with X × Y × Z, then
                       S  T  U = (S  T )  U = S  (T  U ).

 4 Show that Lebesgue measure on Rn is translation invariant. More precisely,
     show that if E  Bn and a  Rn, then a + E  Bn and n(a + E) = n(E),
     where
                                    a + E = {a + x : x  E}.

 5 Suppose f : Rn  R is Bn-measurable and t  R \ {0}. Define ft : Rn  R
     by ft(x) = f (tx).
     (a) Prove that ft is Bn-measurable.
      (b) Prove that if Rn f dn is defined, then
                                      Rn ft dn = |t|n 1 Rn f dn.

 6 Suppose  denotes Lebesgue measure on (R, L), where L is the -algebra of
      Lebesgue measurable subsets of R. Show that there exist subsets E and F of R2
      such that
       · F  L  L and ( × )(F) = 0;
       · E  F but E / L  L.
     [The measure space (R, L, ) has the property that every subset of a measurable
      set with measure 0 is measurable. This exercise asks you to show that the
     measure space (R2, L  L,  × ) does not have this property.]

 7 Suppose m  Z+. Verify that the collection of sets Em that appears in the proof
      of 5.41 is a monotone class.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                               Section 5C Lebesgue Integration on Rn 145

 8 Show that the open unit ball in Rn is an open subset of Rn.

 9 Suppose G1 is a nonempty subset of Rm and G2 is a nonempty subset of Rn.
      Prove that G1 × G2 is an open subset of Rm × Rn if and only if G1 is an open
      subset of Rm and G2 is an open subset of Rn.
      [One direction of this result was already proved (see 5.36); both directions are
      stated here to make the result look prettier and to be comparable to the next
      exercise, where neither direction has been proved.]

10 Suppose F1 is a nonempty subset of Rm and F2 is a nonempty subset of Rn.
      Prove that F1 × F2 is a closed subset of Rm × Rn if and only if F1 is a closed
      subset of Rm and F2 is a closed subset of Rn.

11 Suppose E is a subset of Rm × Rn and

                        A = {x  Rm : (x, y)  E for some y  Rn}.

      (a) Prove that if E is an open subset of Rm × Rn, then A is an open subset
           of Rm.

      (b) Prove or give a counterexample: If E is a closed subset of Rm × Rn, then
            A is a closed subset of Rm.

12 (a) Prove that limn n(Bn) = 0.
      (b) Find the value of n that maximizes n(Bn).

13 For readers familiar with the gamma function : Prove that

                                               n/2
                               n(Bn) = n

                                            ( 2 + 1)

for every positive integer n.

14 Define f : R2  R by

                               xy(x2  -  y2)  if (x, y) = (0, 0),
                                              if (x, y) = (0, 0).
f (x, y) =  x2 + y2 0

(a) Prove that D1(D2 f ) and D2(D1 f ) exist everywhere on R2.
(b) Show that D1(D2 f ) (0, 0) = D2(D1 f ) (0, 0).
(c) Explain why (b) does not violate 5.48.

Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 6

           Banach Spaces

We begin this chapter with a quick review of the essentials of metric spaces. Then
we extend our results on measurable functions and integration to complex-valued
functions. After that, we rapidly review the framework of vector spaces, which
allows us to consider natural collections of measurable functions that are closed under
addition and scalar multiplication.

   Normed vector spaces and Banach spaces, which are introduced in the third section
of this chapter, play a hugely important role in modern analysis. Most interest focuses
on linear maps on these vector spaces. Key results about linear maps that we develop
in this chapter include the Hahn-Banach Theorem, the Open Mapping Theorem, the
Closed Graph Theorem, and the Principle of Uniform Boundedness.

 Market square in Lviv, a city that has had several names and has been in several
  countries because of changing international borders. From 1772 until 1918, the

       city was in Austria and was called Lemberg. Between World War I and
    World War II, the city was in Poland and was called Lwów. During this time,
     mathematicians in Lwów, particularly Stefan Banach (1892-1945) and his
    colleagues, developed the basic results of modern functional analysis, using
  tools of analysis to study infinite-dimensional vector spaces. Since World War II

      ended, Lviv has been in Ukraine, which was part of the Soviet Union until
                     Ukraine became an independent country in 1991.

                                                      CC-BY-SA Petar Milosevic´

                                                                                                            146
                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 6A Metric Spaces 147

6A Metric Spaces

Open Sets, Closed Sets, and Continuity

Much of analysis takes place in the context of a metric space, which is a set with a
notion of distance that satisfies certain properties. The properties we would like a
distance function to have are captured in the next definition, where you should think
of d( f , g) as measuring the distance between f and g.

   Specifically, we would like the distance between two elements of our metric space
to be a nonnegative number that is 0 if and only if the two elements are the same. We
would like the distance between two elements not to depend on the order in which
we list them. Finally, we would like a triangle inequality (the last bullet point below),
which states that the distance between two elements is less than or equal to the sum
of the distances obtained when we insert an intermediate element.

   Now we are ready for the formal definition.

  6.1 Definition metric space
  A metric on a nonempty set V is a function d : V × V  [0, ) such that

    · d( f , f ) = 0 for all f  V;
    · if f , g  V and d( f , g) = 0, then f = g;
    · d( f , g) = d(g, f ) for all f , g  V;
    · d( f , h)  d( f , g) + d(g, h) for all f , g, h  V.
  A metric space is a pair (V, d), where V is a nonempty set and d is a metric on V.

6.2 Example metric spaces
  · Suppose V is a nonempty set. Define d on V × V by setting d( f , g) to be 1 if
     f = g and to be 0 if f = g. Then d is a metric on V.
  · Define d on R × R by d(x, y) = |x - y|. Then d is a metric on R.
  · For n  Z+, define d on Rn × Rn by
            d (x1, . . . , xn), (y1, . . . , yn) = max{|x1 - y1|, . . . , |xn - yn|}.
     Then d is a metric on Rn.
  · Define d on C([0, 1]) × C([0, 1]) by d( f , g) = sup{| f (t) - g(t)| : t  [0, 1]};
     here C([0, 1]) is the set of continuous real-valued functions on [0, 1]. Then d is
     a metric on C([0, 1]).
  · Define d on 1 × 1 by d (a1, a2, . . .), (b1, b2, . . .) = k=1|ak - bk|; here 1
     is the set of sequences (a1, a2, . . .) of real numbers such that k=1|ak| < .
     Then d is a metric on 1.

                     Measure, Integration & Real Analysis, by Sheldon Axler
148 Chapter 6 Banach Spaces

   The material in this section is proba-  This book often uses symbols such as
bly review for most readers of this book.
Thus more details than usual are left to the f , g, h as generic elements of a
reader to verify. Verifying those details generic metric space because many
and doing the exercises is the best way of the important metric spaces in
to solidify your understanding of these analysis are sets of functions; for
concepts. You should be able to transfer example, see the fourth bullet point
familiar definitions and proofs from the of Example 6.2.
context of R or Rn to the context of a metric space.
We will need to use a metric space's topological features, which we introduce
now.

6.3 Definition open ball; B( f , r); closed ball; B( f , r)
Suppose (V, d) is a metric space, f  V, and r > 0.

  · The open ball centered at f with radius r is denoted B( f , r) and is defined by
                             B( f , r) = {g  V : d( f , g) < r}.

· The closed ball centered at f with radius r is denoted B( f , r) and is defined
   by
                          B( f , r) = {g  V : d( f , g)  r}.

   Abusing terminology, many books (including this one) include phrases such as
suppose V is a metric space without mentioning the metric d. When that happens,
you should assume that a metric d lurks nearby, even if it is not explicitly named.

   Our next definition declares a subset of a metric space to be open if every element
in the subset is the center of an open ball that is contained in the subset.

6.4 Definition open
A subset G of a metric space V is called open if for every f  G, there exists
r > 0 such that B( f , r)  G.

  6.5 open balls are open
  Suppose V is a metric space, f  V, and r > 0. Then B( f , r) is an open subset
  of V.
Proof Suppose g  B( f , r). We need to show that an open ball centered at g is
contained in B( f , r). To do this, note that if h  B g, r - d( f , g) , then

             d( f , h)  d( f , g) + d(g, h) < d( f , g) + r - d( f , g) = r,
which implies that h  B( f , r). Thus B g, r - d( f , g)  B( f , r), which implies
that B( f , r) is open.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                           Section 6A Metric Spaces 149

Closed sets are defined in terms of open sets.

  6.6 Definition closed
  A subset of a metric space V is called closed if its complement in V is open.
   For example, each closed ball B( f , r) in a metric space is closed, as you are asked
to prove in Exercise 3.
   Now we define the closure of a subset of a metric space.

6.7 Definition closure; E

Suppose V is a metric space and E  V. The closure of E, denoted E, is defined
by

                 E = {g  V : B(g, )  E =  for every  > 0}.

   Limits in a metric space are defined by reducing to the context of real numbers,
where limits have already been defined.

6.8 Definition limit in metric space; limk fk

Suppose (V, d) is a metric space, f1, f2, . . . is a sequence in V, and f  V. Then

lim fk = f means lim d( fk, f ) = 0.
k                          k

   In other words, a sequence f1, f2, . . . in V converges to f  V if for every  > 0,
there exists n  Z+ such that

                            d( fk, f ) <  for all integers k  n.
   The next result states that the closure of a set is the collection of all limits of
elements of the set. Also, a set is closed if and only if it equals its closure. The proof
of the next result is left as an exercise that provides good practice in using these
concepts.

6.9 closure

Suppose V is a metric space and E  V. Then

(a) E = {g  V : there exist f1, f2, . . . in E such that lim fk = g};

                                                                                     k

(b) E is the intersection of all closed subsets of V that contain E;
(c) E is a closed subset of V;
(d) E is closed if and only if E = E;
(e) E is closed if and only if E contains the limit of every convergent sequence

     of elements of E.

Measure, Integration & Real Analysis, by Sheldon Axler
150 Chapter 6 Banach Spaces

   The definition of continuity that follows uses the same pattern as the definition for
a function from a subset of R to R.

  6.10 Definition continuous
  Suppose (V, dV ) and (W, dW ) are metric spaces and T : V  W is a function.

    · For f  V, the function T is called continuous at f if for every  > 0, there
       exists  > 0 such that
                                      dW T( f ), T(g) < 
       for all g  V with dV ( f , g) < .

    · The function T is called continuous if T is continuous at f for every f  V.

   The next result gives equivalent conditions for continuity. Recall that T-1(E)
is called the inverse image of E and is defined to be { f  V : T( f )  E}. Thus
the equivalence of (a) and (c) below could be restated as saying that a function is
continuous if and only if the inverse image of every open set is open. The equivalence
of (a) and (d) below could be restated as saying that a function is continuous if and
only if the inverse image of every closed set is closed.

6.11 equivalent conditions for continuity

Suppose V and W are metric spaces and T : V  W is a function. Then the
following are equivalent.

(a) T is continuous.

(b) lim fk = f in V implies lim T( fk) = T( f ) in W.
k                     k
(c) T-1(G) is an open subset of V for every open set G  W.

(d) T-1(F) is a closed subset of V for every closed set F  W.

Proof We first prove that (b) implies (d). Suppose (b) holds. Suppose F is a closed
subset of W. We need to prove that T-1(F) is closed. To do this, suppose f1, f2, . . .
is a sequence in T-1(F) and limk fk = f for some f  V. Because (b) holds, we
know that limk T( fk) = T( f ). Because fk  T-1(F) for each k  Z+, we know
that T( fk)  F for each k  Z+. Because F is closed, this implies that T( f )  F.
Thus f  T-1(F), which implies that T-1(F) is closed [by 6.9(e)], completing the
proof that (b) implies (d).

   The proof that (c) and (d) are equivalent follows from the equation
                                T-1(W \ E) = V \ T-1(E)

for every E  W and the fact that a set is open if and only if its complement (in the
appropriate metric space) is closed.

   The proof of the remaining parts of this result are left as an exercise that should
help strengthen your understanding of these concepts.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 6A Metric Spaces 151

Cauchy Sequences and Completeness

The next definition is useful for showing (in some metric spaces) that a sequence has
a limit, even when we do not have a good candidate for that limit.

  6.12 Definition Cauchy sequence
  A sequence f1, f2, . . . in a metric space (V, d) is called a Cauchy sequence if for
  every  > 0, there exists n  Z+ such that d( fj, fk) <  for all integers j  n
  and k  n.

6.13 every convergent sequence is a Cauchy sequence

Every convergent sequence in a metric space is a Cauchy sequence.

Proof Suppose limk fk = f in a metric space (V, d). Suppose  > 0. Then
there  exists  n    Z+  such  that  d( fk,  f)        for  all  k     n.  If  j, k    Z+  are  such  that
                                                <  2

j  n and k  n, then

                    d( fj,  fk)     d( fj,  f ) + d( f ,   fk)  <     +       =  .
                                                                   2      2

Thus f1, f2, . . . is a Cauchy sequence, completing the proof.

Metric spaces that satisfy the converse of the result above have a special name.

6.14 Definition complete metric space
A metric space V is called complete if every Cauchy sequence in V converges to
some element of V.

6.15 Example
  · All five of the metric spaces in Example 6.2 are complete, as you should verify.
  · The metric space Q, with metric defined by d(x, y) = |x - y|, is not complete.
     To see this, for k  Z+ let
                                xk = 101! 1 + 102! 1 + · · · + 10k! 1 .
     If j < k, then
                       |xk - xj| = 10(j+1)! 1 + · · · + 10k! 1 < 10(j+1)! 2 .
     Thus x1, x2, . . . is a Cauchy sequence in Q. However, x1, x2, . . . does not con-
     verge to an element of Q because the limit of this sequence would have a decimal
     expansion 0.110001000000000000000001 . . . that is neither a terminating deci-
     mal nor a repeating decimal. Thus Q is not a complete metric space.

                     Measure, Integration & Real Analysis, by Sheldon Axler
152 Chapter 6 Banach Spaces

     Entrance to the École Polytechnique, Paris, where Augustin-Louis Cauchy
    (1789-1857) was a student and a faculty member. Cauchy wrote almost 800
mathematics papers and the highly influential textbook Cours d'Analyse (published

            in 1821), which greatly influenced the development of analysis.

                                                     CC-BY-SA NonOmnisMoriar

   Every nonempty subset of a metric space is a metric space. Specifically, suppose
(V, d) is a metric space and U is a nonempty subset of V. Then restricting d to
U × U gives a metric on U. Unless stated otherwise, you should assume that the
metric on a subset is this restricted metric that the subset inherits from the bigger set.

   Combining the two bullet points in the result below shows that a subset of a
complete metric space is complete if and only if it is closed.

  6.16 connection between complete and closed
  (a) A complete subset of a metric space is closed.
  (b) A closed subset of a complete metric space is complete.
Proof We begin with a proof of (a). Suppose U is a complete subset of a metric
space V. Suppose f1, f2, . . . is a sequence in U that converges to some g  V.
Then f1, f2, . . . is a Cauchy sequence in U (by 6.13). Hence by the completeness
of U, the sequence f1, f2, . . . converges to some element of U, which must be g
(see Exercise 7). Hence g  U. Now 6.9(e) implies that U is a closed subset of V,
completing the proof of (a).
   To prove (b), suppose U is a closed subset of a complete metric space V. To show
that U is complete, suppose f1, f2, . . . is a Cauchy sequence in U. Then f1, f2, . . . is
also a Cauchy sequence in V. By the completeness of V, this sequence converges to
some f  V. Because U is closed, this implies that f  U (see 6.9). Thus the Cauchy
sequence f1, f2, . . . converges to an element of U, showing that U is complete. Hence
(b) has been proved.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 6A Metric Spaces 153

EXERCISES 6A

 1 Verify that each of the claimed metrics in Example 6.2 is indeed a metric.
 2 Prove that every finite subset of a metric space is closed.
 3 Prove that every closed ball in a metric space is closed.
 4 Suppose V is a metric space.

      (a) Prove that the union of each collection of open subsets of V is an open
           subset of V.

      (b) Prove that the intersection of each finite collection of open subsets of V is
           an open subset of V.

 5 Suppose V is a metric space.
      (a) Prove that the intersection of each collection of closed subsets of V is a
           closed subset of V.
      (b) Prove that the union of each finite collection of closed subsets of V is a
           closed subset of V.

 6 (a) Prove that if V is a metric space, f  V, and r > 0, then B( f , r)  B( f , r).
      (b) Give an example of a metric space V, f  V, and r > 0 such that
           B( f , r) = B( f , r).

 7 Show that each sequence in a metric space has at most one limit.
 8 Prove 6.9.
 9 Prove that each open subset of a metric space V is the union of some sequence

      of closed subsets of V.
10 Prove or give a counterexample: If V is a metric space and U, W are subsets

      of V, then U  W = U  W.
11 Prove or give a counterexample: If V is a metric space and U, W are subsets

      of V, then U  W = U  W.
12 Suppose (U, dU), (V, dV ), and (W, dW ) are metric spaces. Suppose also that

      T : U  V and S : V  W are continuous functions.
      (a) Using the definition of continuity, show that S  T : U  W is continuous.
      (b) Using the equivalence of 6.11(a) and 6.11(b), show that S  T : U  W is

           continuous.
      (c) Using the equivalence of 6.11(a) and 6.11(c), show that S  T : U  W is

           continuous.

13 Prove the parts of 6.11 that were not proved in the text.
                      Measure, Integration & Real Analysis, by Sheldon Axler
154 Chapter 6 Banach Spaces
14 Suppose a Cauchy sequence in a metric space has a convergent subsequence.

      Prove that the Cauchy sequence converges.
15 Verify that all five of the metric spaces in Example 6.2 are complete metric

      spaces.
16 Suppose (U, d) is a metric space. Let W denote the set of all Cauchy sequences

      of elements of U.
      (a) For ( f1, f2, . . .) and (g1, g2, . . .) in W, define ( f1, f2, . . .)  (g1, g2, . . .)

           to mean that
                                           lim d( fk, gk) = 0.

                                                        k

           Show that  is an equivalence relation on W.
      (b) Let V denote the set of equivalence classes of elements of W under the

           equivalence relation above. For ( f1, f2, . . .)  W, let ( f1, f2, . . .) denote
           the equivalence class of ( f1, f2, . . .). Define dV : V × V  [0, ) by

                         dV ( f1, f2, . . .) , (g1, g2, . . .) = lim d( fk, gk).

                                                                                       k

           Show that this definition of dV makes sense and that dV is a metric on V.
      (c) Show that (V, dV ) is a complete metric space.
      (d) Show that the map from U to V that takes f  U to ( f , f , f , . . .) preserves

           distances, meaning that
                            d( f , g) = dV ( f , f , f , . . .) , (g, g, g, . . .)

           for all f , g  U.
      (e) Explain why (d) shows that every metric space is a subset of some complete

           metric space.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                            Section 6B Vector Spaces 155

6B Vector Spaces

Integration of Complex-Valued Functions

Complex numbers were invented so that we can take square roots of negative numbers.
The idea is to assume we have a square root of -1, denoted i, that obeys the usual
rules of arithmetic. Here are the formal definitions:

6.17 Definition complex numbers; C; addition and multiplication in C
  · A complex number is an ordered pair (a, b), where a, b  R, but we write
     this as a + bi or a + ib.
  · The set of all complex numbers is denoted by C:
                                  C = {a + bi : a, b  R}.

· Addition and multiplication in C are defined by

                       (a + bi) + (c + di) = (a + c) + (b + d)i,
                      (a + bi)(c + di) = (ac - bd) + (ad + bc)i;

       here a, b, c, d  R.

   If a  R, then we identify a + 0i         The symbol i was first used to denote
with a. Thus we think of R as a subset of   -1 by Leonhard Euler
C. We also usually write 0 + bi as bi, and
we usually write 0 + 1i as i. You should (1707-1783) in 1777.
verify that i2 = -1.
With the definitions as above, C satisfies the usual rules of arithmetic. Specifically,
with addition and multiplication defined as above, C is a field, as you should verify.
Thus subtraction and division of complex numbers are defined as in any field.
   The field C cannot be made into an or-
dered field. However, the useful concept    Much of this section may be review

of an absolute value can still be defined for many readers.
on C.

6.18 Definition real part; Re z; imaginary part; Im z; absolute value; limits

Suppose z = a + bi, where a and b are real numbers.

· The real part of z, denoted Re z, is defined by Re z = a.

· The imaginary part of z, denoted Im z, is defined by Im z = b.
· The absolute value of z, denoted |z|, is defined by |z| = a2 + b2.

· If z1, z2, . . .  C and L  C, then lim zk = L means lim |zk - L| = 0.
                            k                        k

       Measure, Integration & Real Analysis, by Sheldon Axler
156 Chapter 6 Banach Spaces

   For b a real number, the usual definition of |b| as a real number is consistent with
the new definition just given of |b| with b thought of as a complex number. Note that
if z1, z2, . . . is a sequence of complex numbers and L  C, then

lim zk = L  lim Re zk = Re L and lim Im zk = Im L.
k  k                         k

   We will reduce questions concerning measurability and integration of a complex-
valued function to the corresponding questions about the real and imaginary parts of
the function. We begin this process with the following definition.

  6.19 Definition measurable complex-valued function
  Suppose (X, S ) is a measurable space. A function f : X  C is called
  S-measurable if Re f and Im f are both S-measurable functions.
   See Exercise 5 in this section for two natural conditions that are equivalent to
measurability for complex-valued functions.
   We will make frequent use of the following result. See Exercise 6 in this section
for algebraic combinations of complex-valued measurable functions.
  6.20 | f |p is measurable if f is measurable
  Suppose (X, S ) is a measurable space, f : X  C is an S-measurable function,
  and 0 < p < . Then | f |p is an S-measurable function.
Proof The functions (Re f )2 and (Im f )2 are S-measurable because the square
of an S-measurable function is measurable (by Example 2.45). Thus the function
(Re f )2 + (Im f )2 is S-measurable (because the sum of two S-measurable functions
is S-measurable by 2.46). Now (Re f )2 + (Im f )2 p/2 is S-measurable because it
is the composition of a continuous function on [0, ) and an S-measurable function
(see 2.44 and 2.41). In other words, | f |p is an S-measurable function.
   Now we define integration of a complex-valued function by separating the function
into its real and imaginary parts.

6.21 Definition integral of complex-valued function
Suppose (X, S, µ) is a measure space and f : X  C is an S-measurable
function with | f | dµ < . Then f dµ is defined by

                          f dµ = (Re f ) dµ + i (Im f ) dµ.

   The integral of a complex-valued measurable function is defined only when the
absolute value of the function has a finite integral. In contrast, the integral of every
nonnegative measurable function is defined (although the value may be ), and if
f is real valued then f dµ is defined to be f + dµ - f - dµ if at least one of

   f + dµ and f - dµ is finite.
                     Measure, Integration & Real Analysis, by Sheldon Axler
        Section 6B Vector Spaces 157

   You can easily show that if f , g : X  C are S-measurable functions such that
  | f | dµ <  and |g| dµ < , then

                              ( f + g) dµ = f dµ + g dµ.
Similarly, the definition of complex multiplication leads to the conclusion that

                                        f dµ =  f dµ
for all   C (see Exercise 8).

   The inequality in the result below concerning integration of complex-valued
functions does not follow immediately from the corresponding result for real-valued
functions. However, the small trick used in the proof below does give a reasonably
simple proof.

6.22 bound on the absolute value of an integral
Suppose (X, S, µ) is a measure space and f : X  C is an S-measurable
function such that | f | dµ < . Then

                                      f dµ  | f | dµ.

Proof   The result clearly holds if f dµ = 0. Thus assume that  f dµ = 0.
   Let                                  = | f dµ| f dµ .

Then

        f dµ =  f dµ =  f dµ

        = Re( f ) dµ + i Im( f ) dµ

        = Re( f ) dµ

         | f | dµ

                                         = | f | dµ,
where the second equality holds by Exercise 8, the fourth equality holds because
| f dµ|  R, the inequality on the fourth line holds because Re z  |z| for every
complex number z, and the equality in the last line holds because || = 1.

   Because of the result above, the Bounded Convergence Theorem (3.26) and the
Dominated Convergence Theorem (3.31) hold if the functions f1, f2, . . . and f in the
statements of those theorems are allowed to be complex valued.

                     Measure, Integration & Real Analysis, by Sheldon Axler
158 Chapter 6 Banach Spaces

   We now define the complex conjugate of a complex number.

  6.23 Definition complex conjugate; z
  Suppose z  C. The complex conjugate of z  C, denoted z (pronounced z-bar),
  is defined by

                                    z = Re z - (Im z)i.

   For example, if z = 5 + 7i then z = 5 - 7i. Note that a complex number z is a
real number if and only if z = z.

   The next result gives basic properties of the complex conjugate.

  6.24 properties of complex conjugates
  Suppose w, z  C. Then

    · product of z and z
       z z = |z|2;

    · sum and difference of z and z
       z + z = 2 Re z and z - z = 2(Im z)i;

    · additivity and multiplicativity of complex conjugate
       w + z = w + z and wz = w z;

    · complex conjugate of complex conjugate
       z = z;

    · absolute value of complex conjugate
       |z| = |z|;

    · integral of complex conjugate of complex-valued function
           f dµ = f dµ whenever | f | dµ < .

Proof The first item holds because
         zz = (Re z + i Im z)(Re z - i Im z) = (Re z)2 + (Im z)2 = |z|2.

   To prove the last item, suppose (X, S, µ) is a measure space and f : X  C is an
S-measurable function such that | f | dµ < . Then

                f dµ = (Re f - i Im f ) dµ = Re f dµ - i Im f dµ

                                                   = Re f dµ + i Im f dµ

                                                   = f dµ.
   The straightforward proofs of the remaining items are left to the reader.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 6B Vector Spaces 159

Vector Spaces and Subspaces

The structure and language of vector spaces will help us focus on certain features of
collections of measurable functions. So that we can conveniently make definitions
and prove theorems that apply to both real and complex numbers, we adopt the
following notation.

  6.25 Definition F
  From now on, F stands for either R or C.

   In the definitions that follow, we use f and g to denote elements of V because in
the crucial examples the elements of V are functions from a set X to F.

  6.26 Definition addition; scalar multiplication
    · An addition on a set V is a function that assigns an element f + g  V to
       each pair of elements f , g  V.
    · A scalar multiplication on a set V is a function that assigns an element
        f  V to each   F and each f  V.

   Now we are ready to give the formal definition of a vector space.

  6.27 Definition vector space
  A vector space (over F) is a set V along with an addition on V and a scalar
  multiplication on V such that the following properties hold.

  commutativity
  f + g = g + f for all f , g  V.
  associativity
  ( f + g) + h = f + (g + h) and () f = ( f ) for all f , g, h  V and ,   F.
  additive identity
  There exists an element 0  V such that f + 0 = f for all f  V.
  additive inverse
  For every f  V, there exists g  V such that f + g = 0.
  multiplicative identity
  1 f = f for all f  V.
  distributive properties
  ( f + g) =  f + g and ( + ) f =  f +  f for all ,   F and f , g  V.
   Most vector spaces that you will encounter are subsets of the vector space FX
presented in the next example.

                     Measure, Integration & Real Analysis, by Sheldon Axler
160 Chapter 6 Banach Spaces

6.28 Example the vector space FX
   Suppose X is a nonempty set. Let FX denote the set of functions from X to F.

Addition and scalar multiplication on FX are defined as expected: for f , g  FX and
  F, define

               ( f + g)(x) = f (x) + g(x) and ( f )(x) =  f (x)
for x  X. Then, as you should verify, FX is a vector space; the additive identity in
this vector space is the function 0  FX defined by 0(x) = 0 for all x  X.

6.29 Example Fn; FZ+
   Special case of the previous example: if n  Z+ and X = {1, . . . , n}, then FX is

the familiar space Rn or Cn, depending on whether F = R or F = C.
   Another special case: FZ+ is the vector space of all sequences of real numbers or

complex numbers, again depending on whether F = R or F = C.
   By considering subspaces, we can greatly expand our examples of vector spaces.

  6.30 Definition subspace
  A subset U of V is called a subspace of V if U is also a vector space (using the
  same addition and scalar multiplication as on V).
   The next result gives the easiest way to check whether a subset of a vector space
is a subspace.

  6.31 conditions for a subspace
  A subset U of V is a subspace of V if and only if U satisfies the following three
  conditions.

    · additive identity
       0  U.

    · closed under addition
       f , g  U implies f + g  U.

    · closed under scalar multiplication
         F and f  U implies  f  U.

Proof If U is a subspace of V, then U satisfies the three conditions above by the
definition of vector space.

   Conversely, suppose U satisfies the three conditions above. The first condition
above ensures that the additive identity of V is in U.

   The second condition above ensures that addition makes sense on U. The third
condition ensures that scalar multiplication makes sense on U.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                              Section 6B Vector Spaces 161

   If f  V, then 0 f = (0 + 0) f = 0 f + 0 f . Adding the additive inverse of 0 f to
both sides of this equation shows that 0 f = 0. Now if f  U, then (-1) f is also in
U by the third condition above. Because f + (-1) f = 1 + (-1) f = 0 f = 0, we
see that (-1) f is an additive inverse of f . Hence every element of U has an additive
inverse in U.

   The other parts of the definition of a vector space, such as associativity and
commutativity, are automatically satisfied for U because they hold on the larger
space V. Thus U is a vector space and hence is a subspace of V.

   The three conditions in 6.31 usually enable us to determine quickly whether a
given subset of V is a subspace of V, as illustrated below. All the examples below
except for the first bullet point involve concepts from measure theory.
6.32 Example subspaces of FX

  · The set C([0, 1]) of continuous real-valued functions on [0, 1] is a vector space
     over R because the sum of two continuous functions is continuous and a constant
     multiple of a continuous functions is continuous. In other words, C([0, 1]) is a
     subspace of R[0,1].

  · Suppose (X, S ) is a measurable space. Then the set of S-measurable functions
     from X to F is a subspace of FX because the sum of two S-measurable functions
     is S-measurable and a constant multiple of an S-measurable function is S-
     measurable.

  · Suppose (X, S, µ) is a measure space. Then the set Z (µ) of S-measurable
     functions f from X to F such that f = 0 almost everywhere [meaning that
     µ {x  X : f (x) = 0} = 0] is a vector space over F because the union of
     two sets with µ-measure 0 is a set with µ-measure 0 [which implies that Z (µ)
     is closed under addition]. Note that Z (µ) is a subspace of FX.

  · Suppose (X, S ) is a measurable space. Then the set of bounded measurable
     functions from X to F is a subspace of FX because the sum of two bounded
     S-measurable functions is a bounded S-measurable function and a constant mul-
     tiple of a bounded S-measurable function is a bounded S-measurable function.

  · Suppose (X, S, µ) is a measure space. Then the set of S-measurable functions
     f from X to F such that f dµ = 0 is a subspace of FX because of standard
     properties of integration.

  · Suppose (X, S, µ) is a measure space. Then the set of S-measurable functions
     from X to F such that | f | dµ <  is a subspace of FX. This set is closed under
     addition because | f + g| dµ  | f | dµ + |g| dµ and is closed under scalar
     multiplication because | f | dµ = || | f | dµ.

  · The set 1 of all sequences (a1, a2, . . .) of elements of F such that k=1|ak| < 
     is a subspace of FZ+. Note that 1 is a special case of the previous bullet point
     (take µ to be counting measure on Z+).

                     Measure, Integration & Real Analysis, by Sheldon Axler
162 Chapter 6 Banach Spaces

EXERCISES 6B

1 Show that if a, b  R with a + bi = 0, then

                                a + bi 1 = a2 + b2 a - a2 + b2 b i.
2 Suppose z  C. Prove that

                 max{|Re z|, |Im z|}  |z|  2 max{|Re z|, |Im z|}.

3 Suppose z  C. Prove that  |Re z| + |Im z|   |z|  |Re z| + |Im z|.
                             
                               2

4 Suppose w, z  C. Prove that |wz| = |w| |z| and |w + z|  |w| + |z|.

5 Suppose (X, S ) is a measurable space and f : X  C is a complex-valued
    function. For conditions (b) and (c) below, identify C with R2. Prove that the
    following are equivalent.

(a) f is S-measurable.
(b) f -1(G)  S for every open set G in R2.
(c) f -1(B)  S for every Borel set B  B2.

6 Suppose (X, S ) is a measurable space and f , g : X  C are S-measurable.
    Prove that

    (a) f + g, f - g, and f g are S-measurable functions;

                                                                 f

    (b) if g(x) = 0 for all x  X, then g is an S-measurable function.

7 Suppose (X, S ) is a measurable space and f1, f2, . . . is a sequence of S-
    measurable functions from X to C. Suppose lim fk(x) exists for each x  X.

                                                                          k

    Define f : X  C by
                                       f (x) = lim fk(x).

                                                                k

    Prove that f is an S-measurable function.

8 Suppose (X, S, µ) is a measure space and f : X  C is an S-measurable
    function such that | f | dµ < . Prove that if   C, then

                                           f dµ =  f dµ.

 9 Suppose V is a vector space. Show that the intersection of every collection of
      subspaces of V is a subspace of V.

10 Suppose V and W are vector spaces. Define V × W by
                            V × W = {( f , g) : f  V and g  W}.

      Define addition and scalar multiplication on V × W by
           ( f1, g1) + ( f2, g2) = ( f1 + f2, g1 + g2) and ( f , g) = ( f , g).

      Prove that V × W is a vector space with these operations.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                   Section 6C Normed Vector Spaces 163

6C Normed Vector Spaces

Norms and Complete Norms

This section begins with a crucial definition.

  6.33 Definition norm; normed vector space

  A norm on a vector space V (over F) is a function · : V  [0, ) such that
    ·  f  = 0 if and only if f = 0 (positive definite);
    ·  f  = ||  f  for all   F and f  V (homogeneity);
    ·  f + g   f  + g for all f , g  V (triangle inequality).

  A normed vector space is a pair (V, ·), where V is a vector space and · is a
  norm on V.

6.34 Example norms
  · Suppose n  Z+. Define ·1 and · on Fn by
                              (a1, . . . , an)1 = |a1| + · · · + |an|
     and
                           (a1, . . . , an) = max{|a1|, . . . , |an|}.
     Then ·1 and · are norms on Fn, as you should verify.
  · On 1 (see the last bullet point in Example 6.32 for the definition of 1), define
     ·1 by 

                          (a1, a2, . . .)1 =  |ak|.

                                                                            k=1

     Then ·1 is a norm on 1, as you should verify.
  · Suppose X is a nonempty set and b(X) is the subspace of FX consisting of the

     bounded functions from X to F. For f a bounded function from X to F, define
      f  by

                                  f  = sup{| f (x)| : x  X}.
     Then · is a norm on b(X), as you should verify.
  · Let C([0, 1]) denote the vector space of continuous functions from the interval
     [0, 1] to F. Define · on C([0, 1]) by

                                                                          1

                                           f  = 0 | f |.
     Then · is a norm on C([0, 1]), as you should verify.

                     Measure, Integration & Real Analysis, by Sheldon Axler
164 Chapter 6 Banach Spaces

   Sometimes examples that do not satisfy a definition help you gain understanding.

6.35 Example not norms
  · Let L1(R) denote the vector space of Borel (or Lebesgue) measurable functions
     f : R  F such that | f | d < , where  is Lebesgue measure on R [we are
     now modifying the definition of L1(R) in 3.45 to allow for the possibility that
     F = C]. Define ·1 on L1(R) by
                                         f 1 = | f | d.
     Then ·1 satisfies the homogeneity condition and the triangle inequality on
     L1(R), as you should verify. However, ·1 is not a norm on L1(R) because
     the positive definite condition is not satisfied. Specifically, if E is a nonempty
     Borel subset of R with Lebesgue measure 0 (for example, E might consist of a
     single element of R), then E1 = 0 but E = 0. In the next chapter, we will
     discuss a modification of L1(R) that removes this problem.
  · If n  Z+ and · is defined on Fn by
                          (a1, . . . , an) = |a1|1/2 + · · · + |an|1/2,
     then · satisfies the positive definite condition and the triangle inequality (as
     you should verify). However, · as defined above is not a norm because it does
     not satisfy the homogeneity condition.
  · If ·1/2 is defined on Fn by
                      (a1, . . . , an)1/2 = |a1|1/2 + · · · + |an|1/2 2,
     then ·1/2 satisfies the positive definite condition and the homogeneity condi-
     tion. However, if n > 1 then ·1/2 is not a norm on Fn because the triangle
     inequality is not satisfied (as you should verify).
   The next result shows that every normed vector space is also a metric space in a

natural fashion.

  6.36 normed vector spaces are metric spaces

  Suppose (V, ·) is a normed vector space. Define d : V × V  [0, ) by

                                     d( f , g) =  f - g.

  Then d is a metric on V.

Proof Suppose f , g, h  V. Then
                      d( f , h) =  f - h = ( f - g) + (g - h)
                                                f - g + g - h
                                              = d( f , g) + d(g, h).

Thus the triangle inequality requirement for a metric is satisfied. The verification of
the other required properties for a metric are left to the reader.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                            Section 6C Normed Vector Spaces 165

   From now on, all metric space notions in the context of a normed vector space
should be interpreted with respect to the metric introduced in the previous result.
However, usually there is no need to introduce the metric d explicitly--just use the
norm of the difference of two elements. For example, suppose (V, ·) is a normed
vector space, f1, f2, . . . is a sequence in V, and f  V. Then in the context of a
normed vector space, the definition of limit (6.8) becomes the following statement:

        lim fk = f means lim  fk - f  = 0.
        k                                  k

   As another example, in the context of a normed vector space, the definition of a
Cauchy sequence (6.12) becomes the following statement:

A sequence f1, f2, . . . in a normed vector space (V, ·) is a Cauchy se-
quence if for every  > 0, there exists n  Z+ such that  fj - fk <  for
all integers j  n and k  n.

   Every sequence in a normed vector space that has a limit is a Cauchy sequence
(see 6.13). Normed vector spaces that satisfy the converse have a special name.

6.37 Definition Banach space
A complete normed vector space is called a Banach space.

   In other words, a normed vector space   In a slight abuse of terminology, we
V is a Banach space if every Cauchy se-
quence in V converges to some element      often refer to a normed vector space
of V.                                      V without mentioning the norm ·.
                                           When that happens, you should
   The verifications of the assertions in  assume that a norm · lurks nearby,
Examples 6.38 and 6.39 below are left to   even if it is not explicitly displayed.
the reader as exercises.

6.38 Example Banach spaces

· The vector space C([0, 1]) with the norm defined by  f  = sup| f | is a Banach
space.
                                                          [0, 1]

· The vector space 1 with the norm defined by (a1, a2, . . .)1 = k=1|ak| is a
   Banach space.

6.39 Example not a Banach space

                                                                                                             1

· The vector space C([0, 1]) with the norm defined by  f  = 0 | f | is not a
   Banach space.

· The vector space 1 with the norm defined by (a1, a2, . . .) = sup |ak| is
not a Banach space.                                               kZ+

        Measure, Integration & Real Analysis, by Sheldon Axler
166 Chapter 6 Banach Spaces

6.40 Definition infinite sum in a normed vector space

Suppose       g1,      g2,  .  .  .  is  a  sequence  in  a   normed       vector        space  V.     Then        gk   is
defined by
                                                                                                              k=1

                                                                        n
                                                   gk = lim  gk
                                                 k=1 n k=1

if this limit exists, in which case the infinite series is said to converge.

Recall from your calculus course that if a1, a2, . . . is a sequence of real numbers
such  that  k=1 | ak |                   ,  then          ak  converges.             The  next  result  states   that       the
                                  <
                                                  k=1
analogous property for normed vector spaces characterizes Banach spaces.

6.41        k=1gk <                         =                gk  converges                Banach space

                                                     k=1

Suppose V is a normed vector space. Then V is a Banach space if and only if
       gk   converges                for  every  sequence     g1,  g2,  .  .  .  in   V  such  that    k=1  gk          .
                                                                                                                   <
k=1

Proof First suppose V is a Banach space. Suppose g1, g2, . . . is a sequence in V such
that k=1gk < . Suppose  > 0. Let n  Z+ be such that m=ngm < .
For j  Z+, let fj denote the partial sum defined by

                                                  fj = g1 + · · · + gj.

If k > j  n, then

                                           fk - fj = gj+1 + · · · + gk

                                                       gj+1 + · · · + gk

                                                            

                                                        gm

                                                          m=n

                                                      < .

Thus f1, f2, . . . is a Cauchy sequence in V. Because V is a Banach space, we conclude
that f1, f2, . . . converges to some element of V, which is precisely what it means for
      gk  to  converge,              completing      one  direction     of       the  proof.
                          other                                               gk                       every
k=1
To     prove     the                     direction,   suppose      k=1               converges  for              sequence
g1, g2, . . . in V such that k=1gk < . Suppose f1, f2, . . . is a Cauchy sequence
in V. We want to prove that f1, f2, . . . converges to some element of V. It suffices to
show that some subsequence of f1, f2, . . . converges (by Exercise 14 in Section 6A).
Dropping to a subsequence (but not relabeling) and setting f0 = 0, we can assume
that 
                                                   fk - fk-1 < .
                                                 k=1

Hence         1  (  f  k  -    fk-1)      converges.  The     partial   sum       of     this  series  after  n  terms  is  fn.
          k=
Thus limn fn exists, completing the proof.

                          Measure, Integration & Real Analysis, by Sheldon Axler
                                                   Section 6C Normed Vector Spaces 167

Bounded Linear Maps

When dealing with two or more vector spaces, as in the definition below, assume that
the vector spaces are over the same field (either R or C, but denoted in this book as F
to give us the flexibility to consider both cases).

   The notation T f , in addition to the standard functional notation T( f ), is often
used when considering linear maps, which we now define.

  6.42 Definition linear map
  Suppose V and W are vector spaces. A function T : V  W is called linear if

    · T( f + g) = T f + Tg for all f , g  V;
    · T( f ) = T f for all   F and f  V.
  A linear function is often called a linear map.
   The set of linear maps from a vector space V to a vector space W is itself a vector
space, using the usual operations of addition and scalar multiplication of functions.
Most attention in analysis focuses on the subset of bounded linear functions, defined
below, which we will see is itself a normed vector space.
   In the next definition, we have two normed vector spaces, V and W, which may
have different norms. However, we use the same notation · for both norms (and
for the norm of a linear map from V to W) because the context makes the meaning
clear. For example, in the definition below, f is in V and thus  f  refers to the norm
in V. Similarly, T f  W and thus T f  refers to the norm in W.

  6.43 Definition bounded linear map; T; B(V, W)
  Suppose V and W are normed vector spaces and T : V  W is a linear map.

    · The norm of T, denoted T, is defined by
                          T = sup{T f  : f  V and  f   1}.

    · T is called bounded if T < .
    · The set of bounded linear maps from V to W is denoted B(V, W).

6.44 Example bounded linear map
   Let C([0, 3]) be the normed vector space of continuous functions from [0, 3] to F,

with  f  = sup| f |. Define T : C([0, 3])  C([0, 3]) by

                   [0, 3]

                                    (T f )(x) = x2 f (x).
Then T is a bounded linear map and T = 9, as you should verify.

                      Measure, Integration & Real Analysis, by Sheldon Axler
168 Chapter 6 Banach Spaces

6.45 Example linear map that is not bounded
   Let V be the normed vector space of sequences (a1, a2, . . .) of elements of F such

that ak = 0 for all but finitely many k  Z+, with (a1, a2, . . .) = maxkZ+ |ak|.
Define T : V  V by

                          T(a1, a2, a3, . . .) = (a1, 2a2, 3a3, . . .).
Then T is a linear map that is not bounded, as you should verify.

   The next result shows that if V and W are normed vector spaces, then B(V, W) is
a normed vector space with the norm defined above.

  6.46 · is a norm on B(V, W)

  Suppose V and W are normed vector spaces. Then S + T  S + T
  and T = || T for all S, T  B(V, W) and all   F. Furthermore, the
  function · is a norm on B(V, W).

Proof Suppose S, T  B(V, W). Then
          S + T = sup{(S + T) f  : f  V and  f   1}
                       sup{S f  + T f  : f  V and  f   1}
                       sup{S f  : f  V and  f   1}
                                          + sup{T f  : f  V and  f   1}
                      = S + T.

The inequality above shows that · satisfies the triangle inequality on B(V, W).
The verification of the other properties required for a normed vector space is left to
the reader.

   Be sure that you are comfortable using all four equivalent formulas for T shown
in Exercise 16. For example, you should often think of T as the smallest number
such that T f   T  f  for all f in the domain of T.

   Note that in the next result, the hypothesis requires W to be a Banach space but
there is no requirement for V to be a Banach space.

  6.47 B(V, W) is a Banach space if W is a Banach space

  Suppose V is a normed vector space and W is a Banach space. Then B(V, W) is
  a Banach space.

Proof Suppose T1, T2, . . . is a Cauchy sequence in B(V, W). If f  V, then
                             Tj f - Tk f   Tj - Tk  f ,

which implies that T1 f , T2 f , . . . is a Cauchy sequence in W. Because W is a Banach
space, this implies that T1 f , T2 f , . . . has a limit in W, which we call T f .

                     Measure, Integration & Real Analysis, by Sheldon Axler
        Section 6C Normed Vector Spaces 169

   We have now defined a function T : V  W. The reader should verify that T is a
linear map. Clearly

                           T f   sup{Tk f  : k  Z+}
                                   sup{Tk : k  Z+}  f 

for each f  V. The last supremum above is finite because every Cauchy sequence is
bounded (see Exercise 4). Thus T  B(V, W).

   We still need to show that limkTk - T = 0. To do this, suppose  > 0. Let
n  Z+ be such that Tj - Tk <  for all j  n and k  n. Suppose j  n and
suppose f  V. Then

                            (Tj - T) f  = lim Tj f - Tk f 

                                                               k

                                              f .
Thus Tj - T  , completing the proof.

   The next result shows that the phrase bounded linear map means the same as the
phrase continuous linear map.

6.48 continuity is equivalent to boundedness for linear maps

A linear map from one normed vector space to another normed vector space is
continuous if and only if it is bounded.

Proof Suppose V and W are normed vector spaces and T : V  W is linear.
   First suppose T is not bounded. Thus there exists a sequence f1, f2, . . . in V such

that  fk  1 for each k  Z+ and T fk   as k  . Hence

lim fk = 0 and T fk = T fk  0,
k T fk  T fk T fk

where the nonconvergence to 0 holds because T fk/T fk has norm 1 for every
k  Z+. The displayed line above implies that T is not continuous, completing the
proof in one direction.

   To prove the other direction, now suppose T is bounded. Suppose f  V and
f1, f2, . . . is a sequence in V such that limk fk = f . Then

T fk - T f  = T( fk - f )
                T  fk - f .

Thus limk T fk = T f . Hence T is continuous, completing the proof in the other
direction.

   Exercise 18 gives several additional equivalent conditions for a linear map to be
continuous.

Measure, Integration & Real Analysis, by Sheldon Axler
170 Chapter 6 Banach Spaces

EXERCISES 6C

1 Show that the map f   f  from a normed vector space V to F is continuous
    (where the norm on F is the usual absolute value).

2 Prove that if V is a normed vector space, f  V, and r > 0, then

                    B( f , r) = B( f , r).

3 Show that the functions defined in the last two bullet points of Example 6.35 are
    not norms.

4 Prove that each Cauchy sequence in a normed vector space is bounded (meaning
    that there is a real number that is greater than the norm of every element in the
    Cauchy sequence).

5 Show that if n  Z+, then Fn is a Banach space with both the norms used in the
    first bullet point of Example 6.34.

6 Suppose X is a nonempty set and b(X) is the vector space of bounded functions
from X to F. Prove that if · is defined on b(X) by  f  = sup| f |, then b(X)
is a Banach space.                          X

7 Show that 1 with the norm defined by (a1, a2, . . .) = sup |ak| is not a
Banach space.                               kZ+

8 Show that 1 with the norm defined by (a1, a2, . . .)1 = k=1|ak| is a Banach
    space.

 9 Show that the vector space C([0, 1]) of continuous functions from [0, 1] to F

                                                                1

      with the norm defined by  f  = 0 | f | is not a Banach space.
10 Suppose U is a subspace of a normed vector space V such that some open ball

      of V is contained in U. Prove that U = V.

11 Prove that the only subsets of a normed vector space V that are both open and
      closed are  and V.

12 Suppose V is a normed vector space. Prove that the closure of each subspace of
      V is a subspace of V.

13 Suppose U is a normed vector space. Let d be the metric on U defined by
      d( f , g) =  f - g for f , g  U. Let V be the complete metric space con-
      structed in Exercise 16 in Section 6A.

(a) Show that the set V is a vector space under natural operations of addition
     and scalar multiplication.

(b) Show that there is a natural way to make V into a normed vector space and
     that with this norm, V is a Banach space.

(c) Explain why (b) shows that every normed vector space is a subspace of
     some Banach space.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                   Section 6C Normed Vector Spaces 171

14 Suppose U is a subspace of a normed vector space V. Suppose also that W is a
      Banach space and S : U  W is a bounded linear map.
      (a) Prove that there exists a unique continuous function T : U  W such that
           T|U = S.
      (b) Prove that the function T in (a) is a bounded linear map from U to W and
           T = S.
      (c) Give an example to show that (a) can fail if the assumption that W is a
           Banach space is replaced by the assumption that W is a normed vector
           space.

15 For readers familiar with the quotient of a vector space and a subspace: Suppose
      V is a normed vector space and U is a subspace of V. Define · on V/U by
                               f + U = inf{ f + g : g  U}.
      (a) Prove that · is a norm on V/U if and only if U is a closed subspace of V.
      (b) Prove that if V is a Banach space and U is a closed subspace of V, then
           V/U (with the norm defined above) is a Banach space.
      (c) Prove that if U is a Banach space (with the norm it inherits from V) and
           V/U is a Banach space (with the norm defined above), then V is a Banach
           space.

16 Suppose V and W are normed vector spaces with V = {0} and T : V  W is
      a linear map.
      (a) Show that T = sup{T f  : f  V and  f  < 1}.
      (b) Show that T = sup{T f  : f  V and  f  = 1}.
      (c) Show that T = inf{c  [0, ) : T f   c f  for all f  V}.
      (d) Show that T = sup T f   f  : f  V and f = 0 .

17 Suppose U, V, and W are normed vector spaces and T : U  V and S : V  W
      are linear. Prove that S  T  S T.

18 Suppose V and W are normed vector spaces and T : V  W is a linear map.
      Prove that the following are equivalent.
      (a) T is bounded.
      (b) There exists f  V such that T is continuous at f .
      (c) T is uniformly continuous (which means that for every  > 0, there exists
            > 0 such that T f - Tg <  for all f , g  V with  f - g < ).
      (d) T-1 B(0, r) is an open subset of V for some r > 0.

                      Measure, Integration & Real Analysis, by Sheldon Axler
172 Chapter 6 Banach Spaces

6D Linear Functionals

Bounded Linear Functionals

Linear maps into the scalar field F are so important that they get a special name.

  6.49 Definition linear functional
  A linear functional on a vector space V is a linear map from V to F.
   When we think of the scalar field F as a normed vector space, as in the next
example, the norm z of a number z  F is always intended to be just the usual
absolute value |z|. This norm makes F into a Banach space.

6.50 Example linear functional

   Let V be the vector space of sequences (a1, a2, . . .) of elements of F such that
ak = 0 for all but finitely many k  Z+. Define  : V  F by

                            

(a1, a2, . . .) =  ak.

                         k=1

Then  is a linear functional on V. 
· If we make V a normed vector space with the norm (a1, a2, . . .)1 =  |ak|,
then  is a bounded linear functional on V, as you should verify.              k=1

· If we make V a normed vector space with the norm (a1, a2, . . .) = max|ak|,
   then  is not a bounded linear functional on V, as you should verify. kZ+

6.51 Definition null space; null T

Suppose V and W are vector spaces and T : V  W is a linear map. Then the
null space of T is denoted by null T and is defined by

                             null T = { f  V : T f = 0}.

   If T is a linear map on a vector space  The term kernel is also used in the
V, then null T is a subspace of V, as you
should verify. If T is a continuous linear mathematics literature with the
map from a normed vector space V to a same meaning as null space. This
normed vector space W, then null T is a book uses null space instead of
closed subspace of V because null T = kernel because null space better
T-1({0}) and the inverse image of the captures the connection with 0.
closed set {0} is closed [by 6.11(d)].
The converse of the last sentence fails, because a linear map between normed
vector spaces can have a closed null space but not be continuous. For example, the
linear map in 6.45 has a closed null space (equal to {0}) but it is not continuous.
However, the next result states that for linear functionals, as opposed to more
general linear maps, having a closed null space is equivalent to continuity.

Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 6D Linear Functionals 173

6.52 bounded linear functionals

Suppose V is a normed vector space and  : V  F is a linear functional that is
not identically 0. Then the following are equivalent.
(a)  is a bounded linear functional.
(b)  is a continuous linear functional.
(c) null  is a closed subspace of V.
(d) null  = V.

Proof The equivalence of (a) and (b) is just a special case of 6.48.
   To prove that (b) implies (c), suppose  is a continuous linear functional. Then

null , which is the inverse image of the closed set {0}, is a closed subset of V by
6.11(d). Thus (b) implies (c).

   To prove that (c) implies (a), we will show that the negation of (a) implies the
negation of (c). Thus suppose  is not bounded. Thus there is a sequence f1, f2, . . .
in V such that  fk  1 and |( fk)|  k for each k  Z+. Now

           f1 - fk  null          This proof makes major use of
         ( f1) ( fk)
                                  dividing by expressions of the form
for each k  Z+ and                ( f ), which would not make sense
                                  for a linear mapping into a vector
lim f1 - fk         = f1 ( f1) .
k ( f1) ( fk)                     space other than F.

Clearly   f1 ( f1) = 1 and thus f1 ( f1) / null .

The last three displayed items imply that null  is not closed, completing the proof
that the negation of (a) implies the negation of (c). Thus (c) implies (a).

   We now know that (a), (b), and (c) are equivalent to each other.
   Using the hypothesis that  is not identically 0, we see that (c) implies (d). To
complete the proof, we need only show that (d) implies (c), which we will do by
showing that the negation of (c) implies the negation of (d). Thus suppose null  is
not a closed subspace of V. Because null  is a subspace of V, we know that null 
is also a subspace of V (see Exercise 12 in Section 6C). Let f  null  \ null .
Suppose g  V. Then

                    g = g - (g) ( f ) f + (g) ( f ) f .

The term in large parentheses above is in null  and hence is in null . The term
above following the plus sign is a scalar multiple of f and thus is in null . Because
the equation above writes g as the sum of two elements of null , we conclude that
g  null . Hence we have shown that V = null , completing the proof that the
negation of (c) implies the negation of (d).

         Measure, Integration & Real Analysis, by Sheldon Axler
174 Chapter 6 Banach Spaces

Discontinuous Linear Functionals

The second bullet point in Example 6.50 shows that there exists a discontinuous linear
functional on a certain normed vector space. Our next major goal is to show that
every infinite-dimensional normed vector space has a discontinuous linear functional
(see 6.62). Thus infinite-dimensional normed vector spaces behave in this respect
much differently from Fn, where all linear functionals are continuous (see Exercise 4).

   We need to extend the notion of a basis of a finite-dimensional vector space to an
infinite-dimensional context. In a finite-dimensional vector space, we might consider
a basis of the form e1, . . . , en, where n  Z+ and each ek is an element of our vector
space. We can think of the list e1, . . . , en as a function from {1, . . . , n} to our vector
space, with the value of this function at k  {1, . . . , n} denoted by ek with a subscript
k instead of by the usual functional notation e(k). To generalize, in the next definition
we allow {1, . . . , n} to be replaced by an arbitrary set that might not be a finite set.

  6.53 Definition family
  A family {ek}k in a set V is a function e from a set  to V, with the value of
  the function e at k   denoted by ek.
   Even though a family in V is a function mapping into V and thus is not a subset
of V, the set terminology and the bracket notation {ek}k are useful, and the range
of a family in V really is a subset of V.
   We now restate some basic linear algebra concepts, but in the context of vector
spaces that might be infinite-dimensional. Note that only finite sums appear in the
definition below, even though we might be working with an infinite family.

  6.54 Definition linearly independent; span; finite-dimensional; basis
  Suppose {ek}k is a family in a vector space V.

    · {ek}k is called linearly independent if there does not exist a finite
       nonempty subset  of  and a family {j}j in F \ {0} such that
       j jej = 0.

    · The span of {ek}k is denoted by span{ek}k and is defined to be the set
       of all sums of the form

                                   jej,

                                                             j

       where  is a finite subset of  and {j}j is a family in F.
    · A vector space V is called finite-dimensional if there exists a finite set  and

       a family {ek}k in V such that span{ek}k = V.
    · A vector space is called infinite-dimensional if it is not finite-dimensional.
    · A family in V is called a basis of V if it is linearly independent and its span

       equals V.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                              Section 6D Linear Functionals 175

   For example, {xn}n{0, 1, 2, ...} is a ba-  The term Hamel basis is sometimes
sis of the vector space of polynomials.
Our definition of span does not take used to denote what has been called
advantage of the possibility of summing a basis here. The use of the term
an infinite number of elements in contexts Hamel basis emphasizes that only
where a notion of limit exists (as is the finite sums are under consideration.
case in normed vector spaces). When we get to Hilbert spaces in Chapter 8, we
consider another kind of basis that does involve infinite sums. As we will soon see,
the kind of basis as defined here is just what we need to produce discontinuous linear
functionals.
   Now we introduce terminology that
will be needed in our proof that every vec-   No one has ever produced a

tor space has a basis.                        concrete example of a basis of an

                                              infinite-dimensional Banach space.

6.55 Definition maximal element
Suppose A is a collection of subsets of a set V. A set   A is called a maximal
element of A if there does not exist   A such that   .

6.56 Example maximal elements
  For k  Z, let kZ denote the set of integer multiples of k; thus kZ = {km : m  Z}.

Let A be the collection of subsets of Z defined by A = {kZ : k = 2, 3, 4, . . .}.
Suppose k  Z+. Then kZ is a maximal element of A if and only if k is a prime
number, as you should verify.

   A subset  of a vector space V can be thought of as a family in V by considering
{e f } f , where e f = f . With this convention, the next result shows that the bases of
V are exactly the maximal elements among the collection of linearly independent
subsets of V.

  6.57 bases as maximal elements
  Suppose V is a vector space. Then a subset of V is a basis of V if and only if it is
  a maximal element of the collection of linearly independent subsets of V.
Proof Suppose  is a linearly independent subset of V.
   First suppose also that  is a basis of V. If f  V but f / , then f  span ,
which implies that   { f } is not linearly independent. Thus  is a maximal element
among the collection of linearly independent subsets of V, completing one direction
of the proof.
   To prove the other direction, suppose now that  is a maximal element of the
collection of linearly independent subsets of V. If f  V but f / span , then
  { f } is linearly independent, which would contradict the maximality of  among
the collection of linearly independent subsets of V. Thus span  = V, which means
that  is a basis of V, completing the proof in the other direction.

                     Measure, Integration & Real Analysis, by Sheldon Axler
176 Chapter 6 Banach Spaces
   The notion of a chain plays a key role in our next result.

  6.58 Definition chain
  A collection C of subsets of a set V is called a chain if ,   C implies   
  or   .

6.59 Example chains

· The collection C = {4Z, 6Z} of subsets of Z is not a chain because neither of
   the sets 4Z or 6Z is a subset of the other.

· The collection C = {2nZ : n  Z+} of subsets of Z is a chain because if
   m, n  Z+, then 2mZ  2nZ or 2nZ  2mZ.

   The next result follows from the Ax-     Zorn's Lemma is named in honor of
iom of Choice, although it is not as intu-
itively believable as the Axiom of Choice. Max Zorn (1906-1993), who
Because the techniques used to prove the published a paper containing the
next result are so different from tech- result in 1935, when he had a
niques used elsewhere in this book, the postdoctoral position at Yale.
reader is asked either to accept this result without proof or find one of the good proofs
available via the internet or in other books. The version of Zorn's Lemma stated here
is simpler than the standard more general version, but this version is all that we need.

  6.60 Zorn's Lemma
  Suppose V is a set and A is a collection of subsets of V with the property that
  the union of all the sets in C is in A for every chain C  A. Then A contains a
  maximal element.
   Zorn's Lemma now allows us to prove that every vector space has a basis. The
proof does not help us find a concrete basis because Zorn's Lemma is an existence
result rather than a constructive technique.

  6.61 bases exist
  Every vector space has a basis.

Proof Suppose V is a vector space. If C is a chain of linearly independent subsets
of V, then the union of all the sets in C is also a linearly independent subset of V (this
holds because linear independence is a condition that is checked by considering finite
subsets, and each finite subset of the union is contained in one of the elements of the
chain).

   Thus if A denotes the collection of linearly independent subsets of V, then A
satisfies the hypothesis of Zorn's Lemma (6.60). Hence A contains a maximal
element, which by 6.57 is a basis of V.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                       Section 6D Linear Functionals 177

   Now we can prove the promised result about the existence of discontinuous linear
functionals on every infinite-dimensional normed vector space.

6.62 discontinuous linear functionals

Every infinite-dimensional normed vector space has a discontinuous linear
functional.

Proof Suppose V is an infinite-dimensional vector space. By 6.61, V has a basis
{ek}k. Because V is infinite-dimensional,  is not a finite set. Thus we can assume
Z+   (by relabeling a countable subset of ).

   Define a linear functional  : V  F by setting (ej) equal to jej for j  Z+,
setting (ej) equal to 0 for j   \ Z+, and extending linearly. More precisely, define
a linear functional  : V  F by

  jej =  jjej
j  jZ+

for every finite subset    and every family {j}j in F.
   Because (ej) = jej for each j  Z+, the linear functional  is unbounded,

completing the proof.

Hahn-Banach Theorem

In the last subsection, we showed that there exists a discontinuous linear functional
on each infinite-dimensional normed vector space. Now we turn our attention to the
existence of continuous linear functionals.

   The existence of a nonzero continuous linear functional on each Banach space is
not obvious. For example, consider the Banach space /c0, where  is the Banach
space of bounded sequences in F with

                                (a1, a2, . . .) = sup |ak|

                                                                        kZ+

and c0 is the subspace of  consisting of those sequences in F that have limit 0. The
quotient space /c0 is an infinite-dimensional Banach space (see Exercise 15 in
Section 6C). However, no one has ever exhibited a concrete nonzero linear functional
on the Banach space /c0.

   In this subsection, we show that infinite-dimensional normed vector spaces have
plenty of continuous linear functionals. We do this by showing that a bounded linear
functional on a subspace of a normed vector space can be extended to a bounded
linear functional on the whole space without increasing its norm--this result is called
the Hahn-Banach Theorem (6.69).

   Completeness plays no role in this topic. Thus this subsection deals with normed
vector spaces instead of Banach spaces.

   We do most of the work needed to prove the Hahn-Banach Theorem in the next
lemma, which shows that we can extend a linear functional to a subspace generated
by one additional element, without increasing the norm. This one-element-at-a-time
approach, when combined with a maximal object produced by Zorn's Lemma, gives
us the desired extension to the full normed vector space.

                     Measure, Integration & Real Analysis, by Sheldon Axler
178 Chapter 6 Banach Spaces

   If V is a real vector space, U is a subspace of V, and h  V, then U + Rh is the
subspace of V defined by

                       U + Rh = { f + h : f  U and   R}.

6.63 Extension Lemma
Suppose V is a real normed vector space, U is a subspace of V, and  : U  R
is a bounded linear functional. Suppose h  V \ U. Then  can be extended to a
bounded linear functional  : U + Rh  R such that  = .

Proof Suppose c  R. Define (h) to be c, and then extend  linearly to U + Rh.
Specifically, define  : U + Rh  R by

                            ( f + h) = ( f ) + c

for f  U and   R. Then  is a linear functional on U + Rh.
   Clearly |U = . Thus   . We need to show that for some choice of

c  R, the linear functional  defined above satisfies the equation  = . In
other words, we want

6.64  |( f ) + c|    f + h for all f  U and all   R.

It would be enough to have

6.65       |( f ) + c|    f + h for all f  U,

because replacing f by f in the last inequality and then multiplying both sides by ||
would give 6.64.

   Rewriting 6.65, we want to show that there exists c  R such that

      -  f + h  ( f ) + c    f + h for all f  U.

Equivalently, we want to show that there exists c  R such that

      -  f + h - ( f )  c    f + h - ( f ) for all f  U.

The existence of c  R satisfying the line above follows from the inequality

6.66 sup -  f + h - ( f )  inf  g + h - (g) .
      f U                   gU

To prove the inequality above, suppose f , g  U. Then

-  f + h - ( f )  (g + h - g - f ) - ( f )

                            = (g + h - g - f ) + (g - f ) - (g)

                              g + h - (g).

The inequality above proves 6.66, which completes the proof.

           Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 6D Linear Functionals 179

   Because our simplified form of Zorn's Lemma deals with set inclusions rather
than more general orderings, we need to use the notion of the graph of a function.

  6.67 Definition graph
  Suppose T : V  W is a function from a set V to a set W. Then the graph of T
  is denoted graph(T) and is the subset of V × W defined by

                     graph(T) = { f , T( f )  V × W : f  V}.
   Formally, a function from a set V to a set W equals its graph as defined above.
However, because we usually think of a function more intuitively as a mapping, the
separate notion of the graph of a function remains useful.
   The easy proof of the next result is left to the reader. The first bullet point
below uses the vector space structure of V × W, which is a vector space with natural
operations of addition and scalar multiplication, as given in Exercise 10 in Section 6B.

6.68 function properties in terms of graphs

Suppose V and W are normed vector spaces and T : V  W is a function.
(a) T is a linear map if and only if graph(T) is a subspace of V × W.
(b) Suppose U  V and S : U  W is a function. Then T is an extension of S

     if and only if graph(S)  graph(T).
(c) If T : V  W is a linear map and c  [0, ), then T  c if and only if

     g  c f  for all ( f , g)  graph(T).

   The proof of the Extension Lemma        Hans Hahn (1879-1934) was a
(6.63) used inequalities that do not make  student and later a faculty member
sense when F = C. Thus the proof of the
Hahn-Banach Theorem below requires         at the University of Vienna, where
some extra steps when F = C.
                                           one of his PhD students was Kurt
                                           Gödel (1906-1978).

  6.69 Hahn-Banach Theorem
  Suppose V is a normed vector space, U is a subspace of V, and  : U  F is a
  bounded linear functional. Then  can be extended to a bounded linear functional
  on V whose norm equals .

Proof First we consider the case where F = R. Let A be the collection of subsets
E of V × R that satisfy all the following conditions:

  · E = graph() for some linear functional  on some subspace of V;
  · graph()  E;
  · ||    f  for every ( f , )  E.

                     Measure, Integration & Real Analysis, by Sheldon Axler
180 Chapter 6 Banach Spaces

   Then A satisfies the hypothesis of Zorn's Lemma (6.60). Thus A has a maximal
element. The Extension Lemma (6.63) implies that this maximal element is the graph
of a linear functional defined on all of V. This linear functional is an extension of 
to V and it has norm , completing the proof in the case where F = R.

   Now consider the case where F = C. Define 1 : U  R by

      1( f ) = Re ( f )

for f  U. Then 1 is an R-linear map from U to R and 1   (actually
1 = , but we need only the inequality). Also,

      ( f ) = Re ( f ) + i Im ( f )

      = 1( f ) + i Im -i(i f )

      = 1( f ) - i Re (i f )

6.70  = 1( f ) - i1(i f )

for all f  U.
   Temporarily forget that complex scalar multiplication makes sense on V and

temporarily think of V as a real normed vector space. The case of the result that
we have already proved then implies that there exists an extension 1 of 1 to an
R-linear functional 1 : V  R with 1 = 1  .

   Motivated by 6.70, we define  : V  C by

                                 ( f ) = 1( f ) - i1(i f )
for f  V. The equation above and 6.70 imply that  is an extension of  to V. The
equation above also implies that ( f + g) = ( f ) + (g) and ( f ) = ( f ) for
all f , g  V and all   R. Also,

(i f ) = 1(i f ) - i1(- f ) = 1(i f ) + i1( f ) = i 1( f ) - i1(i f ) = i( f ).
The reader should use the equation above to show that  is a C-linear map.

   The only part of the proof that remains is to show that   . To do this,
note that

     |( f )|2 =  ( f ) f = 1 ( f ) f   ( f ) f  =  |( f )|  f 

for all f  V, where the second equality holds because  ( f ) f  R. Dividing by
|( f )|, we see from the line above that |( f )|    f  for all f  V (no division
necessary if ( f ) = 0). This implies that   , completing the proof.

   We have given the special name linear functionals to linear maps into the scalar
field F. The vector space of bounded linear functionals now also gets a special name
and a special notation.

6.71 Definition dual space; V
Suppose V is a normed vector space. Then the dual space of V, denoted V, is the
normed vector space consisting of the bounded linear functionals on V. In other
words, V = B(V, F).
 By 6.47, the dual space of every normed vector space is a Banach space.

                   Measure, Integration & Real Analysis, by Sheldon Axler
                   Section 6D Linear Functionals 181

6.72  f  = max{|( f )| :   V and  = 1}

Suppose V is a normed vector space and f  V \ {0}. Then there exists   V
such that  = 1 and  f  = ( f ).

Proof Let U be the 1-dimensional subspace of V defined by

                   U = { f :   F}.

Define  : U  F by  ( f ) =  f 

for   F. Then  is a linear functional on U with  = 1 and ( f ) =  f . The
Hahn-Banach Theorem (6.69) implies that there exists an extension of  to a linear
functional  on V with  = 1, completing the proof.

   The next result gives another beautiful application of the Hahn-Banach Theorem,
with a useful necessary and sufficient condition for an element of a normed vector
space to be in the closure of a subspace.

  6.73 condition to be in the closure of a subspace

  Suppose U is a subspace of a normed vector space V and h  V. Then h  U if
  and only if (h) = 0 for every   V such that |U = 0.
Proof First suppose h  U. If   V and |U = 0, then (h) = 0 by the
continuity of , completing the proof in one direction.
   To prove the other direction, suppose now that h / U. Define  : U + Fh  F by

                                       ( f + h) = 
for f  U and   F. Then  is a linear functional on U + Fh with null  = U and
(h) = 1.

   Because h / U, the closure of the null space of  does not equal U + Fh. Thus
6.52 implies that  is a bounded linear functional on U + Fh.

   The Hahn-Banach Theorem (6.69) implies that  can be extended to a bounded
linear functional  on V. Thus we have found   V such that |U = 0 but
(h) = 0, completing the proof in the other direction.

EXERCISES 6D

 1 Suppose V is a normed vector space and  is a linear functional on V. Suppose
       F \ {0}. Prove that the following are equivalent.
     (a)  is a bounded linear functional.
     (b) -1() is a closed subset of V.
     (c) -1() = V.

                     Measure, Integration & Real Analysis, by Sheldon Axler
182 Chapter 6 Banach Spaces

 2 Suppose  is a linear functional on a vector space V. Prove that if U is a
     subspace of V such that null   U, then U = null  or U = V.

 3 Suppose  and  are linear functionals on the same vector space. Prove that
                                         null   null 

     if and only if there exists   F such that  = .

For the next two exercises, Fn should be endowed with the norm · as defined
in Example 6.34.

 4 Suppose n  Z+ and V is a normed vector space. Prove that every linear map
      from Fn to V is continuous.

 5 Suppose n  Z+, V is a normed vector space, and T : Fn  V is a linear map
      that is one-to-one and onto V.

     (a) Show that inf{Tx : x  Fn and x = 1} > 0.
     (b) Prove that T-1 : V  Fn is a bounded linear map.

6 Suppose n  Z+.

    (a) Prove that all norms on Fn have the same convergent sequences, the same
          open sets, and the same closed sets.

    (b) Prove that all norms on Fn make Fn into a Banach space.

7 Suppose V and W are normed vector spaces and V is finite-dimensional. Prove
    that every linear map from V to W is continuous.

8 Prove that every finite-dimensional normed vector space is a Banach space.

9 Prove that every finite-dimensional subspace of each normed vector space is
    closed.

10 Give a concrete example of an infinite-dimensional normed vector space and a
      basis of that normed vector space.

11 Show that the collection A = {kZ : k = 2, 3, 4, . . .} of subsets of Z satisfies
      the hypothesis of Zorn's Lemma (6.60).

12 Prove that every linearly independent family in a vector space can be extended
      to a basis of the vector space.

13 Suppose V is a normed vector space, U is a subspace of V, and  : U  R is a
      bounded linear functional. Prove that  has a unique extension to a bounded
      linear functional  on V with  =  if and only if

sup -  f + h - ( f ) = inf  g + h - (g)
f U                  gU

for every h  V \ U.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                         Section 6D Linear Functionals 183

14 Show that there exists a linear functional  :   F such that
                               |(a1, a2, . . .)|  (a1, a2, . . .)

      for all (a1, a2, . . .)   and
                                     (a1, a2, . . .) = lim ak

                                                                           k

      for all (a1, a2, . . .)   such that the limit above on the right exists.
15 Suppose B is an open ball in a normed vector space V such that 0 / B. Prove

      that there exists   V such that
                                            Re ( f ) > 0

      for all f  B.
16 Show that the dual space of each infinite-dimensional normed vector space is

      infinite-dimensional.

A normed vector space is called separable if it has a countable subset whose closure
equals the whole space.

17 Suppose V is a separable normed vector space. Explain how the Hahn-Banach
      Theorem (6.69) for V can be proved without using any results (such as Zorn's
      Lemma) that depend on the Axiom of Choice.

18 Suppose V is a normed vector space such that the dual space V is a separable
      Banach space. Prove that V is separable.

19 Prove that the dual of the Banach space C([0, 1]) is not separable; here the norm
      on C([0, 1]) is defined by  f  = sup| f |.

                                                           [0, 1]

The double dual space of a normed vector space is defined to be the dual space of

the dual space. If V is a normed vector space, then the double dual space of V is
denoted by V ; thus V  = (V ). The norm on V  is defined to be the norm it
receives as the dual space of V .

20 Define  : V  V by  ( f )() = ( f )

for f  V and   V. Show that  f  =  f  for every f  V.
[The map  defined above is called the canonical isometry of V into V.]

21 Suppose V is an infinite-dimensional normed vector space. Show that there is a
      convex subset U of V such that U = V and such that the complement V \ U is
      also a convex subset of V with V \ U = V.
      [See 8.25 for the definition of a convex set. This exercise should stretch your
      geometric intuition because this behavior cannot happen in finite dimensions.]

Measure, Integration & Real Analysis, by Sheldon Axler
184 Chapter 6 Banach Spaces

6E Consequences of Baire's Theorem

This section focuses on several important     The result here called Baire's
results about Banach spaces that depend       Theorem is often called the Baire
on Baire's Theorem. This result was first     Category Theorem. This book uses
proved by René-Louis Baire (1874-1932)        the shorter name of this result
as part of his 1899 doctoral dissertation at  because we do not need the
École Normale Supérieure (Paris).             categories introduced by Baire.
                                              Furthermore, the use of the word
   Even though our interest lies primar-      category in this context can be
ily in applications to Banach spaces, the     confusing because Baire's
proper setting for Baire's Theorem is the     categories have no connection with
more general context of complete metric       the category theory that developed
spaces.                                       decades after Baire's work.

Baire's Theorem

We begin with some key topological notions.

6.74 Definition interior
Suppose U is a subset of a metric space V. The interior of U, denoted int U, is
the set of f  U such that some open ball of V centered at f with positive radius
is contained in U.
 You should verify the following elementary facts about the interior.
· The interior of each subset of a metric space is open.
· The interior of a subset U of a metric space V is the largest open subset of V

   contained in U.

  6.75 Definition dense
  A subset U of a metric space V is called dense in V if U = V.

   For example, Q and R \ Q are both dense in R, where R has its standard metric
d(x, y) = |x - y|.

   You should verify the following elementary facts about dense subsets.
  · A subset U of a metric space V is dense in V if and only if every nonempty open

     subset of V contains at least one element of U.
  · A subset U of a metric space V has an empty interior if and only if V \ U is

     dense in V.
   The proof of the next result uses the following fact, which you should first prove:
If G is an open subset of a metric space V and f  G, then there exists r > 0 such
that B( f , r)  G.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 6E Consequences of Baire's Theorem 185

6.76 Baire's Theorem
(a) A complete metric space is not the countable union of closed subsets with

     empty interior.
(b) The countable intersection of dense open subsets of a complete metric space

     is nonempty.

Proof We will prove (b) and then use (b) to prove (a).
To prove (b), suppose (V, d) is a complete metric space and G1, G2, . . . is a
sequence of dense open subsets of V. We need to show that                       Gk    =  .
                                                                         k=1
Let f1  G1 and let r1  (0, 1) be such that B( f1, r1)  G1. Now suppose
n  Z+, and f1, . . . , fn and r1, . . . , rn have been chosen such that

6.77                       B( f1, r1)  B( f2, r2)  · · ·  B( fn, rn)

and

6.78           rj          0, 1   and B( fj, rj)  Gj for j = 1, . . . , n.

                               j

Because B( fn, rn) is an open subset of V and Gn+1 is dense in V, there exists
fn+1  B( fn, rn)  Gn+1. Let rn+1               0, 1       be such that

                                                   n+1

                           B( fn+1, rn+1)  B( fn, rn)  Gn+1.

Thus we inductively construct a sequence f1, f2, . . . that satisfies 6.77 and 6.78 for
all n  Z+.

   If j  Z+, then 6.77 and 6.78 imply that

6.79           fk  B( fj, rj)     and    d( fj,  fk)      rj  <  1  for all k > j.
                                                                 j

Hence f1, f2, . . . is a Cauchy sequence. Because (V, d) is a complete metric space,
there exists f  V such that limk fk = f .
Now 6.79 and 6.78 imply that for each j  Z+, we have f  B( fj, rj)  Gj.
Hence f             Gk  ,  which  means  that         Gk  is  not   the  empty  set,  completing  the
proof of (b).  k=1                               k=1

To prove (a), suppose (V, d) is a complete metric space and F1, F2, . . . is a se-
quence of closed subsets of V with empty interior. Then V \ F1, V \ F2, . . . is a
sequence of dense open subsets of V. Now (b) implies that

                                            

                                   = (V \ Fk).

                                          k=1

Taking complements of both sides above, we conclude that

                                                   

                                         V = Fk,

                                                 k=1

completing the proof of (a).

               Measure, Integration & Real Analysis, by Sheldon Axler
186 Chapter 6 Banach Spaces

Because  R = {x}

                 xR

and each set {x} has empty interior in R, Baire's Theorem implies R is uncountable.
Thus we have yet another proof that R is uncountable, different than Cantor's original
diagonal proof and different from the proof via measure theory (see 2.17).

   The next result is another nice consequence of Baire's Theorem.

6.80 the set of irrational numbers is not a countable union of closed sets

There does not exist a countable collection of closed subsets of R whose union
equals R \ Q.

Proof This will be a proof by contradiction. Suppose F1, F2, . . . is a countable
collection of closed subsets of R whose union equals R \ Q. Thus each Fk contains
no rational numbers, which implies that each Fk has empty interior. Now

                             

         R = {r}  Fk .

         rQ                  k=1

The equation above writes the complete metric space R as a countable union of
closed sets with empty interior, which contradicts Baire's Theorem [6.76(a)]. This
contradiction completes the proof.

Open Mapping Theorem and Bounded Inverse Theorem

The next result shows that a surjective bounded linear map from one Banach space
onto another Banach space maps open sets to open sets. As shown in Exercises 10
and 11, this result can fail if the hypothesis that both spaces are Banach spaces is
weakened to allow either of the spaces to be a normed vector space.

  6.81 Open Mapping Theorem
  Suppose V and W are Banach spaces and T is a bounded linear map of V onto W.
  Then T(G) is an open subset of W for every open subset G of V.
Proof Let B denote the open unit ball B(0, 1) = { f  V :  f  < 1} of V. For any
open ball B( f , a) in V, the linearity of T implies that

                                T B( f , a) = T f + aT(B).
   Suppose G is an open subset of V. If f  G, then there exists a > 0 such that
B( f , a)  G. If we can show that 0  int T(B), then the equation above shows that
T f  int T B( f , a) . This would imply that T(G) is an open subset of W. Thus to
complete the proof we need only show that T(B) contains some open ball centered
at 0.

         Measure, Integration & Real Analysis, by Sheldon Axler
                                     Section 6E Consequences of Baire's Theorem 187

   The surjectivity and linearity of T imply that

                                                                   

                                     W = T(kB) = kT(B).

                                               k=1              k=1

Thus W =               kT(B).     Baire's      Theorem       [6.76(a)]      now      implies          that  kT(B)   has   a
                 k=1
nonempty interior for some k  Z+. The linearity of T allows us to conclude that
T(B) has a nonempty interior.

   Thus there exists g  B such that Tg  int T(B). Hence

                       0  int T(B - g)  int T(2B) = int 2T(B).

Thus there exists r > 0 such that B(0, 2r)  2T(B) [here B(0, 2r) is the closed ball
in W centered at 0 with radius 2r]. Hence B(0, r)  T(B). The definition of what it
means to be in the closure of T(B) [see 6.7] now shows that

          h  W and h  r and  > 0 =  f  B such that h - T f  < .

For   arbitrary  h  =  0  in  W,  applying       the    result  in  the  line  above           to   rh      shows   that

                                                                                                   h

                                                             h
6.82        h  W and  > 0 =  f  r B such that h - T f  < .

Now    suppose    g    W      and    g      <  1.   Applying        6.82   with      h   =     g   and      =   1,  we    see

that                                                                                                            2

                       there  exists       f1       1B  such   that  g     -   T f1      <     1.

                                                    r                                          2

Now    applying     6.82  with    h  =   g  -  T f1     and     =   1,  we  see   that

                                                                    4

                  there   exists     f2     1B      such  that  g    -   T f1  -     T f2          <  1.

                                            2r                                                        4

Applying    6.82    again,  this  time     with     h  =  g  -  T f1    -  T f2   and          =   1,  we   see     that

                                                                                                   8

            there    exists   f3         1B    such    that  g  -   T f1   -   T f2     -   T f3       <    1.

                                         4r                                                                 8

Continue in this pattern, constructing a sequence f1, f2, . . . in V. Let

                                                            

                                                    f =  fk,

                                                          k=1

where the infinite sum converges in V because

                                                          1                 2
                                       fk <  k-1 = ;
                                     k=1                k=1 2 r r

here we are using 6.41 (this is the place in the proof where we use the hypothesis that
V  is  a  Banach    space).   The    inequality        displayed    above     shows         that   f            2.
                                                                                                            <
                                                                                                                r
   Because
                              g - T f1 - T f2 - · · · - T fn < n1
                                                                                     2
and because T is a continuous linear map, we have g = T f .
   We     have  now  shown    that       B(0, 1)        2r T(B).    Thus    r  B     0,  1         T(B),    completing
                                                                            2     (         )  

the proof.

                     Measure, Integration & Real Analysis, by Sheldon Axler
188 Chapter 6 Banach Spaces

   The next result provides the useful in-  The Open Mapping Theorem was
formation that if a bounded linear map
from one Banach space to another Banach first proved by Banach and his
space has an algebraic inverse (meaning colleague Juliusz Schauder
that the linear map is injective and surjec- (1899-1943) in 1929-1930.
tive), then the inverse mapping is automatically bounded.

  6.83 Bounded Inverse Theorem
  Suppose V and W are Banach spaces and T is a one-to-one bounded linear map
  from V onto W. Then T-1 is a bounded linear map from W onto V.
Proof The verification that T-1 is a linear map from W to V is left to the reader.
   To prove that T-1 is bounded, suppose G is an open subset of V. Then

                                   (T-1)-1(G) = T(G).
By the Open Mapping Theorem (6.81), T(G) is an open subset of W. Thus the
equation above shows that the inverse image under the function T-1 of every open
set is open. By the equivalence of parts (a) and (c) of 6.11, this implies that T-1 is
continuous. Thus T-1 is a bounded linear map (by 6.48).

   The result above shows that completeness for normed vector spaces sometimes
plays a role analogous to compactness for metric spaces (think of the theorem stating
that a continuous one-to-one function from a compact metric space onto another
compact metric space has an inverse that is also continuous).

Closed Graph Theorem

Suppose V and W are normed vector spaces. Then V × W is a vector space with
the natural operations of addition and scalar multiplication as defined in Exercise 10
in Section 6B. There are several natural norms on V × W that make V × W into a
normed vector space; the choice used in the next result seems to be the easiest. The
proof of the next result is left to the reader as an exercise.

6.84 product of Banach spaces

Suppose V and W are Banach spaces. Then V × W is a Banach space if given
the norm defined by

                             ( f , g) = max{ f , g}

for f  V and g  W. With this norm, a sequence ( f1, g1), ( f2, g2), . . . in
V × W converges to ( f , g) if and only if lim fk = f and lim gk = g.
                                            k              k

   The next result gives a terrific way to show that a linear map between Banach
spaces is bounded. The proof is remarkably clean because the hard work has been
done in the proof of the Open Mapping Theorem (which was used to prove the
Bounded Inverse Theorem).

                     Measure, Integration & Real Analysis, by Sheldon Axler
      Section 6E Consequences of Baire's Theorem 189

6.85 Closed Graph Theorem

Suppose V and W are Banach spaces and T is a function from V to W. Then T is
a bounded linear map if and only if graph(T) is a closed subspace of V × W.

Proof First suppose T is a bounded linear map. Suppose ( f1, T f1), ( f2, T f2), . . . is
a sequence in graph(T) converging to ( f , g)  V × W. Thus

      lim fk = f and lim T fk = g.
      k                                      k

Because T is continuous, the first equation above implies that limk T fk = T f ;
when combined with the second equation above this implies that g = T f . Thus
( f , g) = ( f , T f )  graph(T), which implies that graph(T) is closed, completing
the proof in one direction.

   To prove the other direction, now suppose graph(T) is a closed subspace of
V × W. Then T is a linear map [by 6.68(a)] and graph(T) is a Banach space with
the norm that it inherits from V × W [from 6.84 and 6.16(b)]. Consider the linear
map S : graph(T)  V defined by

                           S( f , T f ) = f .

Then  S( f , T f ) =  f   max{ f , T f } = ( f , T f )

for all f  V. Thus S is a bounded linear map from graph(T) onto V with S  1.
Clearly S is injective. Thus the Bounded Inverse Theorem (6.83) implies that S-1 is
bounded. Because S-1 : V  graph(T) satisfies the equation S-1 f = ( f , T f ), we
have

      T f   max{ f , T f }

                           = ( f , T f )

                           = S-1 f 

                            S-1  f 

for all f  V. The inequality above implies that T is a bounded linear map with
T  S-1, completing the proof.

Principle of Uniform Boundedness

The next result states that a family of      The Principle of Uniform
bounded linear maps on a Banach space        Boundedness was proved in 1927 by
that is pointwise bounded is bounded in      Banach and Hugo Steinhaus
norm (which means that it is uniformly       (1887-1972). Steinhaus recruited
bounded as a collection of maps on the       Banach to advanced mathematics
unit ball). This result is sometimes called  after overhearing him discuss
the Banach-Steinhaus Theorem. Exercise       Lebesgue integration in a park.
17 is also sometimes called the Banach-
Steinhaus Theorem.

      Measure, Integration & Real Analysis, by Sheldon Axler
190 Chapter 6 Banach Spaces

6.86 Principle of Uniform Boundedness

Suppose V is a Banach space, W is a normed vector space, and A is a family of
bounded linear maps from V to W such that

      sup{T f  : T  A} <  for every f  V.

Then                   sup{T : T  A} < .

Proof Our hypothesis implies that

                                       

                     V = { f  V : T f   n for all T  A} ,
                            n=1 Vn

where Vn is defined by the expression above. Because each T  A is continuous, Vn
is a closed subset of V for each n  Z+. Thus Baire's Theorem [6.76(a)] and the
equation above imply that there exist n  Z+ and h  Vand r > 0 such that

6.87                   B(h, r)  Vn.

   Now suppose g  V and g < 1. Thus rg + h and h are both in B(h, r). Hence
if T  A, then 6.87 implies T(rg + h)  n and Th  n, which implies that

      Tg = T(rg + h) r - Thr  T(rg + h) r + Th r  2nr .

Thus                   sup{T : T  A}  2nr < ,
completing the proof.

EXERCISES 6E

 1 Suppose U is a subset of a metric space V. Show that U is dense in V if and
     only if every nonempty open subset of V contains at least one element of U.

 2 Suppose U is a subset of a metric space V. Show that U has an empty interior if
     and only if V \ U is dense in V.

 3 Prove or give a counterexample: If V is a metric space and U, W are subsets
     of V, then (int U)  (int W) = int(U  W).

 4 Prove or give a counterexample: If V is a metric space and U, W are subsets
     of V, then (int U)  (int W) = int(U  W).

      Measure, Integration & Real Analysis, by Sheldon Axler
                       Section 6E Consequences of Baire's Theorem 191

5 Suppose                                     

                             X = {0}              1
                                                  k
                                            k=1

and d(x, y) = |x - y| for x, y  X.

(a) Show that (X, d) is a complete metric space.
(b) Each set of the form {x} for x  X is a closed subset of R that has an

     empty interior as a subset of R. Clearly X is a countable union of such sets.
     Explain why this does not violate the statement of Baire's Theorem that
     a complete metric space is not the countable union of closed subsets with
     empty interior.

6 Give an example of a metric space that is the countable union of closed subsets
    with empty interior.
    [This exercise shows that the completeness hypothesis in Baire's Theorem cannot
    be dropped.]

7 (a) Define f : R  R as follows:
           
           0 if a is irrational,
           f (a) = 1
                    n  if a is rational and n is the smallest positive integer
                       such  that  a     m  for  some    integer  m.
                                      =  n

At which numbers in R is f continuous?

(b) Show that there does not exist a countable collection of open subsets of R
     whose intersection equals Q.

(c) Show that there does not exist a function f : R  R such that f is continu-
     ous at each element of Q and discontinuous at each element of R \ Q.

8 Suppose (X, d) is a complete metric space and G1, G2, . . . is a sequence of
dense open subsets of X. Prove that           Gk  is  a  dense  subset  of  X.
                                         k=1

9 Prove that there does not exist an infinite-dimensional Banach space with a
    countable basis.
    [This exercise implies, for example, that there is not a norm that makes the
    vector space of polynomials with coefficients in F into a Banach space.]

10 Give an example of a Banach space V, a normed vector space W, a bounded
      linear map T of V onto W, and an open subset G of V such that T(G) is not an
      open subset of W.
      [This exercise shows that the hypothesis in the Open Mapping Theorem that
      W is a Banach space cannot be relaxed to the hypothesis that W is a normed
      vector space.]

11 Show that there exists a normed vector space V, a Banach space W, a bounded
      linear map T of V onto W, and an open subset G of V such that T(G) is not an
      open subset of W.
      [This exercise shows that the hypothesis in the Open Mapping Theorem that V
      is a Banach space cannot be relaxed to the hypothesis that V is a normed vector
      space.]

           Measure, Integration & Real Analysis, by Sheldon Axler
192 Chapter 6 Banach Spaces

A linear map T : V  W from a normed vector space V to a normed vector space
W is called bounded below if there exists c  (0, ) such that  f   cT f 
for all f  V.
12 Suppose T : V  W is a bounded linear map from a Banach space V to a

      Banach space W. Prove that T is bounded below if and only if T is injective and
      the range of T is a closed subspace of W.
13 Give an example of a Banach space V, a normed vector space W, and a one-to-
      one bounded linear map T of V onto W such that T-1 is not a bounded linear
      map of W onto V.
      [This exercise shows that the hypothesis in the Bounded Inverse Theorem (6.83)
      that W is a Banach space cannot be relaxed to the hypothesis that W is a
      normed vector space.]
14 Show that there exists a normed space V, a Banach space W, and a one-to-one
      bounded linear map T of V onto W such that T-1 is not a bounded linear map
      of W onto V.
      [This exercise shows that the hypothesis in the Bounded Inverse Theorem (6.83)
      that V is a Banach space cannot be relaxed to the hypothesis that V is a normed
      vector space.]
15 Prove 6.84.
16 Suppose V is a Banach space with norm · and that  : V  F is a linear
      functional. Define another norm · on V by

                                       f  =  f  + |( f )|.
      Prove that if V is a Banach space with the norm ·, then  is a continuous
      linear functional on V (with the original norm).
17 Suppose V is a Banach space, W is a normed vector space, and T1, T2, . . . is a
      sequence of bounded linear maps from V to W such that limk Tk f exists for
      each f  V. Define T : V  W by

                                          T f = lim Tk f

                                                                  k

      for f  V. Prove that T is a bounded linear map from V to W.
      [This result states that the pointwise limit of a sequence of bounded linear maps
      on a Banach space is a bounded linear map.]
18 Suppose that V is a normed vector space and B is a subset of V such that
      sup f B|( f )| <  for every   V. Prove that sup f  < .

                                                                                     f B

19 Suppose T : V  W is a linear map from a Banach space V to a Banach space
      W such that
                                      T  V for all   W.
      Prove that T is a bounded linear map.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 7

              Lp Spaces

Fix a measure space (X, S, µ) and a positive number p. We begin this chapter by
looking at the vector space of measurable functions f : X  F such that

                                          | f |p dµ < .
Important results called Hölder's inequality and Minkowski's inequality help us
investigate this vector space. A useful class of Banach spaces appears when we
identify functions that differ only on a set of measure 0 and require p  1.

   The main building of the Swiss Federal Institute of Technology (ETH Zürich).
   Hermann Minkowski (1864-1909) taught at this university from 1896 to 1902.

      During this time, Albert Einstein (1879-1955) was a student in several of
    Minkowski's mathematics classes. Minkowski later created mathematics that

                   helped explain Einstein's special theory of relativity.

                                                         CC-BY-SA Roland zh

                                                                                                            193
                     Measure, Integration & Real Analysis, by Sheldon Axler
194 Chapter 7 Lp Spaces

7A Lp(µ)

Hölder's Inequality

Our next major goal is to define an important class of vector spaces that generalize
the vector spaces L1(µ) and 1 that were defined earlier (and we are now allowing
for the possibility that F = R or F = C). We begin this process with the definition
below. The terminology p-norm introduced below is convenient, even though it is
not necessarily a norm.

7.1 Definition  f p; essential supremum
Suppose that (X, S, µ) is a measure space, 0 < p < , and f : X  F is
S-measurable. Then the p-norm of f is denoted by  f p and is defined by

                                f p = | f |p dµ 1/p.

Also,  f , which is called the essential supremum of f , is defined by
               f  = inf t > 0 : µ {x  X : | f (x)| > t} = 0 .

   The exponent 1/p appears in the definition of the p-norm  f p because we want
the equation  f p = ||  f p to hold for all   F.

   For 0 < p < , the p-norm  f p does not change if f changes on a set of
µ-measure 0. By using the essential supremum rather than the supremum in the defi-
nition of  f , we arrange for the -norm  f  to enjoy this same property. Think
of  f  as the smallest that you can make the supremum of | f | after modifications
on sets of measure 0.

7.2 Example p-norm for counting measure

Suppose µ is counting measure on Z+. If a = (a1, a2, . . .) is a sequence in F and
0 < p < , then
                
ap =  |ak|p          1/p  and a = sup{|ak| : k  Z+}.

                k=1
Note that for counting measure, the essential supremum and the supremum are the
same because in this case there are no sets of measure 0 other than the empty set.

   If p = 1 and F = R, then the next definition agrees with our previous definition
of L1(µ).

7.3 Definition Lebesgue space; Lp(µ)
Suppose (X, S, µ) is a measure space and 0 < p  . The Lebesgue space
Lp(µ), sometimes denoted Lp(X, S, µ), is defined to be the set of S-measurable
functions f : X  F such that  f p < .

Measure, Integration & Real Analysis, by Sheldon Axler
                                             Section 7A Lp(µ) 195

7.4 Example p
   When µ is counting measure on Z+, the set Lp(µ) is often denoted by p (pro-

nounced little el-p). Thus if 0 < p < , then

                                                                                      

            p = {(a1, a2, . . .) : each ak  F and  |ak|p < }

                                                                                 k=1

and
                 = {(a1, a2, . . .) : each ak  F and sup |ak| < }.

                                                                                 kZ+

   Inequality 7.5(a) below provides an easy proof that Lp(µ) is closed under addition.
Soon we will prove Minkowski's inequality (7.14), which provides an important
improvement of 7.5(a) when p  1 but is more complicated to prove.

7.5 Lp(µ) is a vector space

Suppose (X, S, µ) is a measure space and 0 < p < . Then

(a)          f + gp  2 ( f p + gp)ppp        p

and

(b)                           f p = ||  f p

for all f , g  Lp(µ) and all   F. Furthermore, with the usual operations of
addition and scalar multiplication of functions, Lp(µ) is a vector space.

Proof  Suppose f , g  Lp(µ). If x  X, then
                   | f (x) + g(x)|p  (| f (x)| + |g(x)|)p
                                       (2 max{| f (x)|, |g(x)|})p
                                       2p(| f (x)|p + |g(x)|p).

Integrating both sides of the inequality above with respect to µ gives the desired
inequality
             f + gp  2 ( f p + gp).ppp       p

This inequality implies that if  f p <  and gp < , then  f + gp < . Thus
Lp(µ) is closed under addition.

   The proof that
                                      f p = ||  f p

follows easily from the definition of ·p. This equality implies that Lp(µ) is closed
under scalar multiplication.

   Because Lp(µ) contains the constant function 0 and is closed under addition and
scalar multiplication, Lp(µ) is a subspace of FX and thus is a vector space.

            Measure, Integration & Real Analysis, by Sheldon Axler
196 Chapter 7 Lp Spaces
   What we call the dual exponent in the definition below is often called the conjugate

exponent or the conjugate index. However, the terminology dual exponent conveys
more meaning because of results (7.25 and 7.26) that we will see in the next section.

  7.6 Definition dual exponent; p
  For 1  p  , the dual exponent of p is denoted by p and is the element of
  [1, ] such that

                                         1p + p1 = 1.

7.7 Example dual exponents
               1 = ,  = 1, 2 = 2, 4 = 4/3, (4/3) = 4

   The result below is a key tool in proving Hölder's inequality (7.9).

7.8 Young's inequality

Suppose 1 < p < . Then

                               ap bp
                        ab  + 

                                pp

for all a  0 and b  0.

Proof Fix b > 0 and define a function  William Henry Young (1863-1942)
f : (0, )  R by                        published what is now called
                                       Young's inequality in 1912.
                    ap bp
          f (a) = +  - ab.

                     pp

Thus f (a) = ap-1 - b. Hence f is decreasing on the interval 0, b1/(p-1) and f is
increasing on the interval b1/(p-1),  . Thus f has a global minimum at b1/(p-1).
A tiny bit of arithmetic [use p/(p - 1) = p] shows that f b1/(p-1) = 0. Thus
f (a)  0 for all a  (0, ), which implies the desired inequality.

   The important result below furnishes a key tool that is used in the proof of
Minkowski's inequality (7.14).

7.9 Hölder's inequality
Suppose (X, S, µ) is a measure space, 1  p  , and f , h : X  F are
S-measurable. Then

                                  f h1   f p hp .

Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 7A Lp(µ) 197

Proof Suppose 1 < p < , leaving the cases p = 1 and p =  as exercises for
the reader.
First consider the special case where  f p = hp = 1. Young's inequality (7.8)
tells us that
                                               | f (x)|p |h(x)|p
                              | f (x)h(x)|  p + p

for all x  X. Integrating both sides of the inequality above with respect to µ shows
that  f h1  1 =  f p hp , completing the proof in this special case.

   If  f p = 0 or hp = 0, then Hölder's inequality was proved in
 f h1 = 0 and the desired inequal- 1889 by Otto Hölder (1859-1937).
ity holds. Similarly, if  f p =  or
hp = , then the desired inequality clearly holds. Thus we assume that
0 <  f p <  and 0 < hp < .

   Now define S-measurable functions f1, h1 : X  F by

                              f1 = f  f p and h1 = h hp .

Then  f1p = 1 and h1p = 1. By the result for our special case, we have
 f1h11  1, which implies that  f h1   f p hp .

   The next result gives a key containment among Lebesgue spaces with respect to a
finite measure. Note the crucial role that Hölder's inequality plays in the proof.

7.10 Lq(µ)  Lp(µ) if p < q and µ(X) < 

Suppose (X, S, µ) is a finite measure space and 0 < p < q < . Then

                              f p  µ(X)(q-p)/(pq) f q
for all f  Lq(µ). Furthermore, Lq(µ)  Lp(µ).

Proof  Fix     f    Lq(µ).    Let r  =  q      Thus r  >  1.   A short calculation shows that

                                        p.
r = q-q p . Now Hölder's inequality (7.9) with p replaced by r and f replaced by | f |p
and h replaced by the constant function 1 gives

                    | f |p dµ  (| f |p)r dµ 1/r 1r 1/r dµ

                                   = µ(X)(q-p)/q | f |q dµ p/q.

Now  raise   both  sides  of  the  inequality  above  to  the  power  1,  getting

                                                                      p

                    | f |p dµ 1/p  µ(X)(q-p)/(pq) | f |q dµ 1/q,

which is the desired inequality.
   The inequality above shows that f  Lp(µ). Thus Lq(µ)  Lp(µ).

                   Measure, Integration & Real Analysis, by Sheldon Axler
198 Chapter 7 Lp Spaces

7.11 Example Lp(E)
   We adopt the common convention that if E is a Borel (or Lebesgue measurable)

subset of R and 0 < p  , then Lp(E) means Lp(E), where E denotes
Lebesgue measure  restricted to the Borel (or Lebesgue measurable) subsets of R
that are contained in E.

   With this convention, 7.10 implies that
         if 0 < p < q < , then Lq([0, 1])  Lp([0, 1]) and  f p   f q

for f  Lq([0, 1]). See Exercises 12 and 13 in this section for related results.

Minkowski's Inequality

The next result is used as a tool to prove Minkowski's inequality (7.14). Once again,
note the crucial role that Hölder's inequality plays in the proof.

7.12 formula for  f p

Suppose (X, S, µ) is a measure space, 1  p < , and f  Lp(µ). Then

 f p = sup                                      p

                         f h dµ : h  L (µ) and hp  1 .

Proof If  f p = 0, then both sides of the equation in the conclusion of this result
equal 0. Thus we assume that  f p = 0.

                                                                              p

   Hölder's inequality (7.9) implies that if h  L (µ) and hp  1, then

f h dµ  | f h| dµ   f p hp   f p.

                                               p

Thus sup f h dµ : h  L (µ) and hp  1   f p.
   To prove the inequality in the other direction, define h : X  F by

h(x) = p/p f (x) | f (x)|p-2  (set h(x) = 0 when f (x) = 0).
              f p

                                                                                                               p

Then f h dµ =  f p and hp = 1, as you should verify (use p - p = 1). Thus

                                                    p

 f p  sup f h dµ : h  L (µ) and hp  1 , as desired.

7.13 Example a point with infinite measure
   Suppose X is a set with exactly one element b and µ is the measure such that

µ() = 0 and µ({b}) = . Then L1(µ) consists only of the 0 function. Thus if
p =  and f is the function whose value at b equals 1, then  f  = 1 but the right
side of the equation in 7.12 equals 0. Thus 7.12 can fail when p = .

   Example 7.13 shows that we cannot take p =  in 7.12. However, if µ is a
-finite measure, then 7.12 holds even when p =  (see Exercise 9).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                                       Section 7A Lp(µ) 199

   The next result, which is called Minkowski's inequality, is an improvement for
p  1 of the inequality 7.5(a).

  7.14 Minkowski's inequality
  Suppose (X, S, µ) is a measure space, 1  p  , and f , g  Lp(µ). Then

                                 f + gp   f p + gp.

Proof Assume that 1  p <  (the case p =  is left as an exercise for the reader).
Inequality 7.5(a) implies that f + g  Lp(µ).

                             p

   Suppose h  L (µ) and hp  1. Then
            ( f + g)h dµ  | f h| dµ + |gh| dµ  ( f p + gp)hp
                                                             f p + gp,

where the second inequality comes from Hölder's inequality (7.9). Now take the

                                                                                                                    p

supremum of the left side of the inequality above over the set of h  L (µ) such
that hp  1. By 7.12, we get  f + gp   f p + gp, as desired.

EXERCISES 7A

 1 Suppose µ is a measure. Prove that
                   f + g   f  + g and  f  = ||  f 

     for all f , g  L(µ) and all   F. Conclude that with the usual operations of
     addition and scalar multiplication of functions, L(µ) is a vector space.
 2 Suppose a  0, b  0, and 1 < p < . Prove that

                                                   ap bp
                                          ab = + 

                                                    pp
     if and only if ap = bp [compare to Young's inequality (7.8)].
 3 Suppose a1, . . . , an are nonnegative numbers. Prove that

                           (a1 + · · · + an)5  n4(a15 + · · · + an5).
 4 Prove Hölder's inequality (7.9) in the cases p = 1 and p = .
 5 Suppose that (X, S, µ) is a measure space, 1 < p < , f  Lp(µ), and

                  p

     h  L (µ). Prove that Hölder's inequality (7.9) is an equality if and only if
      there exist nonnegative numbers a and b, not both 0, such that

                                      a| f (x)|p = b|h(x)|p
     for almost every x  X.

                     Measure, Integration & Real Analysis, by Sheldon Axler
200 Chapter 7 Lp Spaces

6 Suppose (X, S, µ) is a measure space, f  L1(µ), and h  L(µ). Prove that
     f h1 =  f 1 h if and only if

                                      |h(x)| = h

for almost every x  X such that f (x) = 0.

7 Suppose (X, S, µ) is a measure space and f , h : X  F are S-measurable.
    Prove that
                                       f hr   f p hq

for  all  positive  numbers  p, q, r  such  that  1  +  1  =  1.
                                                  p     q
                                                              r

8 Suppose (X, S, µ) is a measure space and n  Z+. Prove that

                     f1 f2 · · · fn1   f1p1  f2p2 · · ·  fnpn

      for all positive numbers p1, . . . , pn such that p11 + p12 + · · · + p1n = 1 and all
      S-measurable functions f1, f2, . . . , fn : X  F.
 9 Show that the formula in 7.12 holds for p =  if µ is a -finite measure.

10 Suppose 0 < p < q  .
      (a) Prove that p  q.
      (b) Prove that (a1, a2, . . .)p  (a1, a2, . . .)q for every sequence a1, a2, . . .
           of elements of F.

11 Show that p = 1.

                        p>1

12 Show that Lp([0, 1]) = L([0, 1]).

                        p<

13 Show that Lp([0, 1]) = L1([0, 1]).

                        p>1

14 Suppose p, q  (0, ], with p = q. Prove that neither of the sets Lp(R) and
      Lq(R) is a subset of the other.

15 Show that there exists f  L2(R) such that f / Lp(R) for all p  (0, ] \ {2}.

16 Suppose (X, S, µ) is a finite measure space. Prove that

                             lim  f p =  f 

                             p

      for every S-measurable function f : X  F.
17 Suppose µ is a measure, 0 < p  , and f  Lp(µ). Prove that for every

       > 0, there exists a simple function g  Lp(µ) such that  f - gp < .
      [This exercise extends 3.44.]

          Measure, Integration & Real Analysis, by Sheldon Axler
                                                                       Section 7A Lp(µ) 201

18 Suppose 0 < p <  and f  Lp(R). Prove that for every  > 0, there exists a
      step function g  Lp(R) such that  f - gp < .
      [This exercise extends 3.47.]

19 Suppose 0 < p <  and f  Lp(R). Prove that for every  > 0, there
      exists a continuous function g : R  F such that  f - gp <  and the set
      {x  R : g(x) = 0} is bounded.
      [This exercise extends 3.48.]

20 Suppose (X, S, µ) is a measure space, 1 < p < , and f , g  Lp(µ). Prove
      that Minkowski's inequality (7.14) is an equality if and only if there exist
      nonnegative numbers a and b, not both 0, such that
                                          a f (x) = bg(x)
      for almost every x  X.

21 Suppose (X, S, µ) is a measure space and f , g  L1(µ). Prove that
                                     f + g1 =  f 1 + g1

      if and only if f (x) g(x)  0 for almost every x  X.
22 Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces and 0 < p < .

      Prove that if f  Lp(µ × ), then
                             [ f ]x  Lp() for almost every x  X

      and
                             [ f ]y  Lp(µ) for almost every y  Y,

      where [ f ]x and [ f ]y are the cross sections of f as defined in 5.7.
23 Suppose 1  p <  and f  Lp(R).

      (a) For t  R, define ft : R  R by ft(x) = f (x - t). Prove that the function
           t   f - ftp is bounded and uniformly continuous on R.

      (b) For t > 0, define ft : R  R by ft(x) = f (tx). Prove that
                                           lim f - ftp = 0.

                                                        t1

24 Suppose 1  p <  and f  Lp(R). Prove that
                                  lim 1 b+t| f - f (b)|p = 0
                                    t0 2t b-t

      for almost every b  R.

                      Measure, Integration & Real Analysis, by Sheldon Axler
202 Chapter 7 Lp Spaces

7B Lp(µ)

Definition of Lp(µ)

Suppose (X, S, µ) is a measure space and 1  p  . If there exists a nonempty set
E  S such that µ(E) = 0, then Ep = 0 even though E = 0; thus ·p is not a
norm on Lp(µ). The standard way to deal with this problem is to identify functions
that differ only on a set of µ-measure 0. To help make this process more rigorous, we
introduce the following definitions.

  7.15 Definition Z (µ); f
  Suppose (X, S, µ) is a measure space and 0 < p  .

    · Z (µ) denotes the set of S-measurable functions from X to F that equal 0
       almost everywhere.

    · For f  Lp(µ), let f be the subset of Lp(µ) defined by
                                    f = { f + z : z  Z(µ)}.

   The set Z (µ) is clearly closed under scalar multiplication. Also, Z (µ) is closed
under addition because the union of two sets with µ-measure 0 is a set with µ-
measure 0. Thus Z (µ) is a subspace of Lp(µ), as we had noted in the third bullet
point of Example 6.32.

   Note that if f , F  Lp(µ), then f = F if and only if f (x) = F(x) for almost
every x  X.

  7.16 Definition Lp(µ)
  Suppose µ is a measure and 0 < p  .

    · Let Lp(µ) denote the collection of subsets of Lp(µ) defined by
                                   Lp(µ) = { f : f  Lp(µ)}.

    · For f , g  Lp(µ) and   F, define f + g and  f by
                             f + g = ( f + g) and  f = ( f ) .

   The last bullet point in the definition above requires a bit of care to verify that it
makes sense. The potential problem is that if Z (µ) = {0}, then f is not uniquely
represented by f . Thus suppose f , F, g, G  Lp(µ) and f = F and g = G. For
the definition of addition in Lp(µ) to make sense, we must verify that ( f + g) =
(F + G) . This verification is left to the reader, as is the similar verification that the
scalar multiplication defined in the last bullet point above makes sense.

   You might want to think of elements of Lp(µ) as equivalence classes of functions
in Lp(µ), where two functions are equivalent if they agree almost everywhere.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                        Section 7B Lp(µ) 203

   Mathematicians often pretend that ele-     Note the subtle typographic
ments of Lp(µ) are functions, where two       difference between Lp(µ) and
functions are considered to be equal if       Lp(µ). An element of the
they differ only on a set of µ-measure 0.     calligraphic Lp(µ) is a function; an
This fiction is harmless provided that the    element of the italic Lp(µ) is a set
operations you perform with such "func-       of functions, any two of which agree
tions" produce the same results if the func-  almost everywhere.
tions are changed on a set of measure 0.

7.17 Definition ·p on Lp(µ)

Suppose µ is a measure and 0 < p  . Define ·p on Lp(µ) by

                                    f p = f p

for f  Lp(µ).

   Note that if f , F  Lp(µ) and f = F, then  f p = Fp. Thus the definition
above makes sense.

   In the result below, the addition and scalar multiplication on Lp(µ) come from
7.16 and the norm comes from 7.17.

7.18 Lp(µ) is a normed vector space

Suppose µ is a measure and 1  p  . Then Lp(µ) is a vector space and ·p
is a norm on Lp(µ).

The proof of the result above is left to the reader, who will surely use Minkowski's
inequality (7.14) to verify the triangle inequality. Note that the additive identity of
Lp(µ) is 0, which equals Z (µ).
For readers familiar with quotients of If µ is counting measure on Z+, then
vector spaces: you may recognize that
Lp(µ) is the quotient space
                                               Lp(µ) = Lp(µ) = p
L p (µ)/Z (µ).
                                              because counting measure has no
For readers who want to learn about quo- sets of measure 0 other than the
tients of vector spaces: see a textbook for empty set.
a second course in linear algebra.
In the next definition, note that if E is a Borel set then 2.95 implies Lp(E) using
Borel measurable functions equals Lp(E) using Lebesgue measurable functions.

7.19 Definition Lp(E) for E  R
If E is a Borel (or Lebesgue measurable) subset of R and 0 < p  , then
Lp(E) means Lp(E), where E denotes Lebesgue measure  restricted to the
Borel (or Lebesgue measurable) subsets of R that are contained in E.

Measure, Integration & Real Analysis, by Sheldon Axler
204 Chapter 7 Lp Spaces

Lp(µ) Is a Banach Space

The proof of the next result does all the hard work we need to prove that Lp(µ) is a
Banach space. However, we state the next result in terms of Lp(µ) instead of Lp(µ)
so that we can work with genuine functions. Moving to Lp(µ) will then be easy (see
7.24).

7.20 Cauchy sequences in Lp(µ) converge

Suppose (X, S, µ) is a measure space and 1  p  . Suppose f1, f2, . . . is a
sequence of functions in Lp(µ) such that for every  > 0, there exists n  Z+
such that

                                      fj - fkp < 
for all j  n and k  n. Then there exists f  Lp(µ) such that

                                   lim  fk - f p = 0.

                                             k

Proof The case p =  is left as an exercise for the reader. Thus assume 1  p < .
   It suffices to show that limm fkm - f p = 0 for some f  Lp(µ) and some

subsequence fk1 , fk2 , . . . (see Exercise 14 of Section 6A, whose proof does not require
the positive definite property of a norm).

   Thus dropping to a subsequence (but not relabeling) and setting f0 = 0, we can
assume that 

                            fk - fk-1p < .

                                             k=1

Define functions g1, g2, . . . and g from X to [0, ] by

        m                                        
      gm(x) =  | fk(x) - fk-1(x)| and g(x) =  | fk(x) - fk-1(x)|.
        k=1                                      k=1

Minkowski's inequality (7.14) implies that

                         m
             gmp    fk - fk-1p.
7.21

                         k=1

Clearly limm gm(x) = g(x) for every x  X. Thus the Monotone Convergence
Theorem (3.11) and 7.21 imply

                                                      p
        gp dµ = lim      gm p dµ    fk - fk-1p < .
7.22         m k=1

Thus g(x) <  for almost every x  X.
   Because every infinite series of real numbers that converges absolutely also con-

verges, for almost every x  X we can define f (x) by

                                            m
f (x) =  fk(x) - fk-1(x) = lim  fk(x) - fk-1(x) = lim fm(x).
      k=1 m k=1 m

In particular, limm fm(x) exists for almost every x  X. Define f (x) to be 0 for
those x  X for which the limit does not exist.

        Measure, Integration & Real Analysis, by Sheldon Axler
                                                            Section 7B Lp(µ) 205

   We now have a function f that is the pointwise limit (almost everywhere) of
f1, f2, . . .. The definition of f shows that | f (x)|  g(x) for almost every x  X.
Thus 7.22 shows that f  Lp(µ).

   To show that limk fk - f p = 0, suppose  > 0 and let n  Z+ be such that
 fj - fkp <  for all j  n and k  n. Suppose k  n. Then

                        fk - f p = | fk - f |p dµ 1/p

              lim inf  | fk - fj|p dµ 1/p

                   j

             = lim inf fk - fjp

                   j

              ,

where the second line above comes from Fatou's Lemma (Exercise 17 in Section 3A).
Thus limk fk - f p = 0, as desired.

   The proof that we have just completed contains within it the proof of a useful
result that is worth stating separately. A sequence can converge in p-norm without
converging pointwise anywhere (see, for example, Exercise 12). However, the next
result guarantees that some subsequence converges pointwise almost everywhere.

7.23 convergent sequences in Lp have pointwise convergent subsequences

Suppose (X, S, µ) is a measure space and 1  p  . Suppose f  Lp(µ)
and f1, f2, . . . is a sequence of functions in Lp(µ) such that lim  fk - f p = 0.

                                                                                           k

Then there exists a subsequence fk1 , fk2 , . . . such that
                                   lim fkm (x) = f (x)

                                             m

for almost every x  X.

Proof Suppose fk1 , fk2 , . . . is a subsequence such that

              

               fkm - fkm-1 p < .

             m=2

An examination of the proof of 7.20 shows that lim fkm (x) = f (x) for almost
                       m
every x  X.

7.24 Lp(µ) is a Banach space
Suppose µ is a measure and 1  p  . Then Lp(µ) is a Banach space.

Proof  This result follows immediately from 7.20 and the appropriate definitions.
                  Measure, Integration & Real Analysis, by Sheldon Axler
206 Chapter 7 Lp Spaces

Duality

Recall that the dual space of a normed vector space V is denoted by V and is defined
to be the Banach space of bounded linear functionals on V (see 6.71).

   In the statement and proof of the next result, an element of an Lp space is denoted
by a symbol that makes it look like a function rather than like a collection of functions
that agree except on a set of measure 0. However, because integrals and Lp-norms
are unchanged when functions change only on a set of measure 0, this notational
convenience causes no problems.

7.25 natural map of L (µ) into L (µ) preserves normspp     

Suppose  µ  is  a  measure  and  1  <     p    .  For        h      p           define  h :  Lp(µ)              F

by                                                                L (µ),

                                    h( f ) = f h dµ.

                                                                             p  Lp(µ)      Furthermore,

Then h  h is a one-to-one linear map from L (µ) to                                      .

h = hp for all h  L (µ).         p

Proof  Suppose     h      p    and     f     Lp(µ).        Then   Hölder's      inequality   (7.9)       tells  us

                        L (µ)
that f h  L1(µ) and that
                                     f h1  hp  f p.

Thus h, as defined above, is a bounded linear map from Lp(µ) to F. Also, the map
                                                        p    Lp(µ) . Now 7.12 (with the roles of

h  h is clearly a linear map of L (µ) into
p and p reversed) shows that

         h = sup{|h( f )| : f  Lp(µ) and  f p  1} = hp.

                    p

If h1, h2  L (µ) and h1 = h2 , then
             h1 - h2p = h1-h2  = h1 - h2  = 0 = 0,

                                                                                                      p  Lp(µ)  

which implies h1 = h2. Thus h  h is a one-to-one map from L (µ) to                                              .

The result in 7.25 fails for some measures µ if p = 1. However, if µ is a -finite
measure, then 7.25 holds even if p = 1 (see Exercise 14).
Is the range of the map h  h in 7.25 all of Lp(µ) ? The next result provides
an affirmative answer to this question in the special case of p for 1  p < .
We will deal with this question for more general measures later (see 9.42; also see
Exercise 25 in Section 8B).
When thinking of p as a normed vector space, as in the next result, unless stated
otherwise you should always assume that the norm on p is the usual norm ·p that
is associated with Lp(µ), where µ is counting measure on Z+. In other words, if
1  p < , then
                                                                  1/p
                        (a1, a2, . . .)p =  |ak|p .
                                                           k=1

                   Measure, Integration & Real Analysis, by Sheldon Axler
                                                              Section 7B Lp(µ) 207

7.26 dual space of p can be identified with p

Suppose 1  p < . For b = (b1, b2, . . .)  p, define b : p  F by

                              

              b(a) =  akbk,

                            k=1

where a = (a1, a2, . . .). Then b  b is a one-to-one linear map from p onto
p                                                          p
 . Furthermore, b = bp for all b   .

Proof For k  Z+, let ek  p be the sequence in which each term is 0 except that
the kth term is 1; thus ek = (0, . . . , 0, 1, 0, . . .).
           p  
Suppose  
              . Define a sequence b = (b1, b2, . . .) of numbers in F by

                                         bk = (ek).
Suppose a = (a1, a2, . . .)  p. Then

                                                                

                              a =  akek,

                                                             k=1

where the infinite sum converges in the norm of p (the proof would fail here if we
allowed p to be ). Because  is a bounded linear functional on p, applying  to
both sides of the equation above shows that

                                                                   

                            (a) =  akbk.

                                                               k=1

   We still need to prove that b  p. To do this, for n  Z+ let µn be counting
measure on {1, 2, . . . , n}. We can think of Lp(µn) as a subspace of p by identi-
fying each (a1, . . . , an)  Lp(µn) with (a1, . . . , an, 0, 0, . . .)  p. Restricting the
linear functional  to Lp(µn) gives the linear functional on Lp(µn) that satisfies the
following equation:

                                                                                n

                     |Lp(µn)(a1, . . . , an) =  akbk.

                                                                           k=1

Now 7.25 [also see Exercise 14(b) for the case where p = 1] gives

              (b1, . . . , bn)p = |Lp(µn)
                                   .

Because limn(b1, . . . , bn)p = bp , the inequality above implies the in-
equality bp  . Thus b  p , which implies that  = b, completing the
proof.

   The previous result does not hold when p = . In other words, the dual space of
 cannot be identified with 1. However, see Exercise 15, which shows that the dual
space of a natural subspace of  can be identified with 1.

                     Measure, Integration & Real Analysis, by Sheldon Axler
208 Chapter 7 Lp Spaces

EXERCISES 7B

1 Suppose n > 1 and 0 < p < 1. Prove that if · is defined on Fn by

                        (a1, . . . , an) = |a1|p + · · · + |an|p 1/p,

    then · is not a norm on Fn.

2 (a) Suppose 1  p < . Prove that there is a countable subset of p whose
         closure equals p.

    (b) Prove that there does not exist a countable subset of  whose closure
         equals .

3 (a) Suppose 1  p < . Prove that there is a countable subset of Lp(R)
         whose closure equals Lp(R).

    (b) Prove that there does not exist a countable subset of L(R) whose closure
         equals L(R).

4 Suppose (X, S, µ) is a -finite measure space and 1  p  . Prove that
if f : X  F is an S-measurable function such that f h  L1(µ) for every
        p               Lp(µ).
h            then  f  
     L (µ),

5 (a) Prove that if µ is a measure, 1 < p < , and f , g  Lp(µ) are such that

                         f p = gp = f + g 2 p ,

     then f = g.
(b) Give an example to show that (a) can fail if p = 1.
(c) Give an example to show that (a) can fail if p = .

6 Suppose (X, S, µ) is a measure space and 0 < p < 1. Show that

                         f + gp   f p + gpp   p  p

    for all S-measurable functions f , g : X  F.
7 Prove that Lp(µ), with addition and scalar multiplication as defined in 7.16 and

    norm defined as in 7.17, is a normed vector space. In other words, prove 7.18.

8 Prove 7.20 for the case p = .

9 Prove that 7.20 also holds for p  (0, 1).

10 Prove that 7.23 also holds for p  (0, 1).

11 Suppose 1  p  . Prove that

                  {(a1, a2, . . .)  p : ak = 0 for every k  Z+}
is not an open subset of p.

     Measure, Integration & Real Analysis, by Sheldon Axler
                                    Section 7B Lp(µ) 209

12 Show that there exists a sequence f1, f2, . . . of functions in L1([0, 1]) such that
      lim  fk1 = 0 but

        k

                                   sup{ fk(x) : k  Z+} = 
      for every x  [0, 1].
      [This exercise shows that the conclusion of 7.23 cannot be improved to conclude
      that limk fk(x) = f (x) for almost every x  X.]
13 Suppose (X, S, µ) is a measure space, 1  p  , f  Lp(µ), and f1, f2, . . .
      is a sequence in Lp(µ) such that limk fk - f p = 0. Show that if
      g : X  F is a function such that limk fk(x) = g(x) for almost every
      x  X, then f (x) = g(x) for almost every x  X.

14 (a) Give an example of a measure µ such that 7.25 fails for p = 1.
      (b) Show that if µ is a -finite measure, then 7.25 holds for p = 1.

15 Let     c0 = {(a1, a2, . . .)   : lim ak = 0}.

                                                    k

Give c0 the norm that it inherits as a subspace of .

(a) Prove that c0 is a Banach space.
(b) Prove that the dual space of c0 can be identified with 1.

16 Suppose 1  p  2.

(a) Prove that if w, z  C, then

        |w + z| 2  | p + |w - z|p w|p + |z|p  2p-1 |w + z|p + |w - z|p .

(b) Prove that if µ is a measure and f , g  Lp(µ), then

         f + gp +  f - gppp      p  p  f + gp +  f - gp        p           p

           2   f p + gp  2p-1 .

17 Suppose 2  p < .

(a) Prove that if w, z  C, then

        2p-1 |w + z|  | p + |w - z|p w|p + |z|p  |w + z|p + |w - z|p 2 .

(b) Prove that if µ is a measure and f , g  Lp(µ), then

        p f + gp +  f - gpp      p  p  f + gp +  f - gp        p           p

        2p-1                  f p + gp                            2.

[The inequalities in the two previous exercises are called Clarkson's inequalities.
They were discovered by James Clarkson in 1936.]

        Measure, Integration & Real Analysis, by Sheldon Axler
210 Chapter 7 Lp Spaces

18 Suppose (X, S, µ) is a measure space, 1  p, q  , and h : X  F is an
      S-measurable function such that h f  Lq(µ) for every f  Lp(µ). Prove that
      f  h f is a continuous linear map from Lp(µ) to Lq(µ).

A Banach space is called reflexive if the canonical isometry of the Banach space
into its double dual space is surjective (see Exercise 20 in Section 6D for the
definitions of the double dual space and the canonical isometry).
19 Prove that if 1 < p < , then p is reflexive.
20 Prove that 1 is not reflexive.
21 Show that with the natural identifications, the canonical isometry of c0 into its

      double dual space is the inclusion map of c0 into  (see Exercise 15 for the
      definition of c0 and an identification of its dual space).
22 Suppose 1  p <  and V, W are Banach spaces. Show that V × W is a
      Banach space if the norm on V × W is defined by

                                 ( f , g) =  f p + gp 1/p
      for f  V and g  W.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 8

           Hilbert Spaces

Normed vector spaces and Banach spaces, which were introduced in Chapter 6,
capture the notion of distance. In this chapter we introduce inner product spaces,
which capture the notion of angle. The concept of orthogonality, which corresponds
to right angles in the familiar context of R2 or R3, plays a particularly important role
in inner product spaces.

   Just as a Banach space is defined to be a normed vector space in which every
Cauchy sequence converges, a Hilbert space is defined to be an inner product space
that is a Banach space. Hilbert spaces are named in honor of David Hilbert (1862-
1943), who helped develop parts of the theory in the early twentieth century.

   In this chapter, we will see a clean description of the bounded linear functionals
on a Hilbert space. We will also see that every Hilbert space has an orthonormal
basis, which makes Hilbert spaces look much like standard Euclidean spaces but with
infinite sums replacing finite sums.

The Mathematical Institute at the University of Göttingen, Germany. This building
   was opened in 1930, when Hilbert was near the end of his career there. Other
  prominent mathematicians who taught at the University of Göttingen and made

major contributions to mathematics include Richard Courant (1888-1972), Richard
  Dedekind (1831-1916), Gustav Lejeune Dirichlet (1805-1859), Carl Friedrich

Gauss (1777-1855), Hermann Minkowski (1864-1909), Emmy Noether (1882-1935),
                            and Bernhard Riemann (1826-1866).

                                                      CC-BY-SA Daniel Schwen

                                                                                                            211
                      Measure, Integration & Real Analysis, by Sheldon Axler
212 Chapter 8 Hilbert Spaces

8A Inner Product Spaces

Inner Products

If p = 2, then the dual exponent p also equals 2. In this special case Hölder's
inequality (7.9) implies that if µ is a measure, then

                                                 f g dµ   f 2g2

for all f , g  L2(µ). Thus we can associate with each pair of functions f , g  L2(µ)
a number f g dµ. An inner product is almost a generalization of this pairing, with a
slight twist to get a closer connection to the L2(µ)-norm.
    If  g     f   and         R,  then  the    left   side   of  the  inequality  above  is    f    2  .  However,
           =           F  =                                                                         2

if  g  =   f  and  F  =   C,  then   the   left  side   of   the  inequality  above  need    not    equal    f    2  .
                                                                                                                  2
Instead,      we  should  take    g     f  to    get    f    2  above.
                                     =                       2

    The observations above suggest that we should consider the pairing that takes f , g
to      f  g dµ.  Then    pairing    f  with   itself   gives      f    2  .
                                                                        2

    Now we are ready to define inner products, which abstract the key properties of
the pairing f , g  f g dµ on L2(µ), where µ is a measure.

  8.1 Definition inner product; inner product space
  An inner product on a vector space V is a function that takes each ordered pair
  f , g of elements of V to a number  f , g  F and has the following properties.

    · positivity
        f , f   [0, ) for all f  V.

    · definiteness
        f , f  = 0 if and only if f = 0.

    · linearity in first slot
        f + g, h =  f , h + g, h and  f , g =  f , g for all f , g, h  V and
       all   F.

    · conjugate symmetry
        f , g = g, f  for all f , g  V.

  A vector space with an inner product on it is called an inner product space. The
  terminology real inner product space indicates that F = R; the terminology
  complex inner product space indicates that F = C.

   If F = R, then the complex conjugate above can be ignored and the conjugate
symmetry property above can be rewritten more simply as  f , g = g, f  for all
f , g  V.

   Although most mathematicians define an inner product as above, many physicists
use a definition that requires linearity in the second slot instead of the first slot.

                       Measure, Integration & Real Analysis, by Sheldon Axler
                                       Section 8A Inner Product Spaces 213

8.2 Example inner product spaces

· For n  Z+, define an inner product on Fn by

                    (a1, . . . , an), (b1, . . . , bn) = a1b1 + · · · + anbn
   for (a1, . . . , an), (b1, . . . , bn)  Fn. When thinking of Fn as an inner product
   space, we always mean this inner product unless the context indicates some other
   inner product.
· Define an inner product on 2 by

                                                 

(a1, a2, . . .), (b1, b2, . . .) =  akbk

                                             k=1

for (a1, a2, . . .), (b1, b2, . . .)  2. Hölder's inequality (7.9), as applied to count-
ing measure on Z+ and taking p = 2, implies that the infinite sum above
converges absolutely and hence converges to an element of F. When thinking
of 2 as an inner product space, we always mean this inner product unless the
context indicates some other inner product.

· Define an inner product on C([0, 1]), which is the vector space of continuous
   functions from [0, 1] to F, by

                  1

 f , g = 0 f g

for f , g  C([0, 1]). The definiteness requirement for an inner product is
                                                                       1| f |2 = 0,
satisfied because if f : [0, 1]  F is a continuous function such that
then the function f is identically 0.                                  0

· Suppose (X, S, µ) is a measure space. Define an inner product on L2(µ) by

 f , g = f g dµ

for f , g  L2(µ). Hölder's inequality (7.9) with p = 2 implies that the integral
above makes sense as an element of F. When thinking of L2(µ) as an inner
product space, we always mean this inner product unless the context indicates
some other inner product.

Here we use L2(µ) rather than L2(µ) because the definiteness requirement fails
on L2(µ) if there exist nonempty sets E  S such that µ(E) = 0 (consider
E, E to see the problem).
The first two bullet points in this example are special cases of L2(µ), taking µ to
be counting measure on either {1, . . . , n} or Z+.

Measure, Integration & Real Analysis, by Sheldon Axler
214 Chapter 8 Hilbert Spaces

   As we will see, even though the main examples of inner product spaces are L2(µ)
spaces, working with the inner product structure is often cleaner and simpler than
working with measures and integrals.

8.3 basic properties of an inner product
Suppose V is an inner product space. Then
(a) 0, g = g, 0 = 0 for every g  V;
(b)  f , g + h =  f , g +  f , h for all f , g, h  V;
(c)  f , g =  f , g for all   F and f , g  V.

Proof

(a) For g  V, the function f   f , g is a linear map from V to F. Because
     every linear map takes 0 to 0, we have 0, g = 0. Now the conjugate symmetry
     property of an inner product implies that
                                    g, 0 = 0, g = 0 = 0.

(b) Suppose f , g, h  V. Then

 f , g + h = g + h, f  = g, f  + h, f  = g, f  + h, f  =  f , g +  f , h.

(c) Suppose   F and f , g  V. Then

              f , g = g, f  = g, f  =  g, f  =  f , g,

as desired.

   If F = R, then (b) and (c) of 8.3 imply that for f  V, the function g   f , g
is a linear map from V to R. However, if F = C and f = 0, then the function
g   f , g is not a linear map from V to C because of the complex conjugate in
part (c) of 8.3.

Cauchy-Schwarz Inequality and Triangle Inequality

Now we can define the norm associated with each inner product. We use the word
norm (which will turn out to be correct) even though it is not yet clear that all the
properties required of a norm are satisfied.

8.4 Definition norm associated with an inner product; ·

Suppose V is an inner product space. For f  V, define the norm of f , denoted
 f , by

                                      f  =  f , f .

             Measure, Integration & Real Analysis, by Sheldon Axler
Section 8A Inner Product Spaces 215

8.5 Example norms on inner product spaces
   In each of the following examples, the inner product is the standard inner product

as defined in Example 8.2.
  · If n  Z+ and (a1, . . . , an)  Fn, then

(a1, . . . , an) = |a1|2 + · · · + |an|2.

Thus the norm on Fn associated with the standard inner product is the usual
Euclidean norm.

· If (a1, a2, . . .)  2, then                        1/2
                             (a1, a2, . . .) =   |ak|2 .
                                                k=1

  Thus the norm associated with the inner product on 2 is just the standard norm
   ·2 on 2 as defined in Example 7.2.
· If µ is a measure and f  L2(µ), then

 f  = | f |2 dµ 1/2.

     Thus the norm associated with the inner product on L2(µ) is just the standard
     norm ·2 on L2(µ) as defined in 7.17.
   The definition of an inner product (8.1) implies that if V is an inner product space
and f  V, then
  ·  f   0;
  ·  f  = 0 if and only if f = 0.
   The proof of the next result illustrates a frequently used property of the norm on
an inner product space: working with the square of the norm is often easier than
working directly with the norm.

  8.6 homogeneity of the norm
  Suppose V is an inner product space, f  V, and   F. Then

                                       f  = ||  f .

Proof We have
                f 2 =  f ,  f  =  f ,  f  =  f , f  = ||2 f 2.

Taking square roots now gives the desired equality.

Measure, Integration & Real Analysis, by Sheldon Axler
216 Chapter 8 Hilbert Spaces

   The next definition plays a crucial role in the study of inner product spaces.

  8.7 Definition orthogonal
  Two elements of an inner product space are called orthogonal if their inner
  product equals 0.
   In the definition above, the order of the two elements of the inner product space
does not matter because  f , g = 0 if and only if g, f  = 0. Instead of saying that
f and g are orthogonal, sometimes we say that f is orthogonal to g.

8.8 Example orthogonal elements of an inner product space
  · In C3, (2, 3, 5i) and (6, 1, -3i) are orthogonal because
          (2, 3, 5i), (6, 1, -3i) = 2 · 6 + 3 · 1 + 5i · (3i) = 12 + 3 - 15 = 0.
  · The elements of L2 (-, ] represented by sin(3t) and cos(8t) are orthogo-
     nal because
                  - sin(3t) cos(8t) dt = cos(5t) 10 - cos(11t) t 22 t=- = = 0,
     where dt denotes integration with respect to Lebesgue measure on (-, ].
   Exercise 8 asks you to prove that if a and b are nonzero elements in R2, then
                                  a, b = a b cos ,

where  is the angle between a and b (thinking of a as the vector whose initial point is
the origin and whose end point is a, and similarly for b). Thus two elements of R2 are
orthogonal if and only if the cosine of the angle between them is 0, which happens if
and only if the vectors are perpendicular in the usual sense of plane geometry. Thus
you can think of the word orthogonal as a fancy word meaning perpendicular.

  Law professor Richard Friedman presenting a case before the U.S.
  Supreme Court in 2010:
  Mr. Friedman: I think that issue is entirely orthogonal to the issue here

                    because the Commonwealth is acknowledging--
  Chief Justice Roberts: I'm sorry. Entirely what?
  Mr. Friedman: Orthogonal. Right angle. Unrelated. Irrelevant.
  Chief Justice Roberts: Oh.
  Justice Scalia: What was that adjective? I liked that.
  Mr. Friedman: Orthogonal.
  Chief Justice Roberts: Orthogonal.
  Mr. Friedman: Right, right.
  Justice Scalia: Orthogonal, ooh. (Laughter.)
  Justice Kennedy: I knew this case presented us a problem. (Laughter.)

                     Measure, Integration & Real Analysis, by Sheldon Axler
                               Section 8A Inner Product Spaces 217

   The next theorem was known (in the context of R2) over 3,500 years ago in
Babylonia and then rediscovered and proved over 2,500 years ago in Greece.

8.9 Pythagorean Theorem

Suppose f and g are orthogonal elements of an inner product space. Then
                               f + g2 =  f 2 + g2.

Proof We have   f + g2 =  f + g, f + g
as desired.                =  f , f  +  f , g + g, f  + g, g
                           =  f 2 + g2,

   Exercise 3 shows that whether or not the converse of the Pythagorean Theorem
holds depends on whether F = R or F = C.

   Suppose f and g are elements of an inner product space V,
with g = 0. Frequently it is useful to write f as some number c
times g plus an element h of V that is orthogonal to g. The figure
here suggests that such a decomposition should be possible. To
find the appropriate choice for c, note that if f = cg + h for
some c  F and some h  V with h, g = 0, then we must
have

                   f , g = cg + h, g = cg2,

which implies that c = g2  f , g , which then implies that                Here
h = f - 2  f , g g. Hence we are led to the following result.         f = cg + h,
                                                                       where h is
           g                                                        orthogonal to g.

8.10 orthogonal decomposition

Suppose f and g are elements of an inner product space, with g = 0. Then there
exists h  V such that
                                f , g
               h, g = 0 and f = 2 g + h.
                               g

Proof Set h = f - g2  f , g g. Then
               h, g = f - g2  f , g g, g =  f , g - g2  f , g g, g = 0,

giving the first equation in the conclusion. The second equation in the conclusion
follows immediately from the definition of h.

Measure, Integration & Real Analysis, by Sheldon Axler
218 Chapter 8 Hilbert Spaces

   The orthogonal decomposition 8.10 is the main ingredient in our proof of the next
result, which is one of the most important inequalities in mathematics.

8.11 Cauchy-Schwarz inequality

Suppose f and g are elements of an inner product space. Then
                                  | f , g|   f  g,

with equality if and only if one of f , g is a scalar multiple of the other.

Proof If g = 0, then both sides of the desired inequality equal 0. Thus we can
assume g = 0. Consider the orthogonal decomposition

f = g2  f , g g + h

given by 8.10, where h is orthogonal to g. The Pythagorean Theorem (8.9) implies

 f 2 =                           f , g 2 2 g + h2
                                g

= g2 | f , g| +  2 h2

8.12  g2 | f , g|2 .

Multiplying both sides of this inequality by g2 and then taking square roots gives
the desired inequality.

   The proof above shows that the Cauchy-Schwarz inequality is an equality if and
only if 8.12 is an equality. This happens if and only if h = 0. But h = 0 if and only
if f is a scalar multiple of g (see 8.10). Thus the Cauchy-Schwarz inequality is an
equality if and only if f is a scalar multiple of g or g is a scalar multiple of f (or
both; the phrasing has been chosen to cover cases in which either f or g equals 0).

8.13 Example Cauchy-Schwarz inequality for Fn
   Applying the Cauchy-Schwarz inequality with the standard inner product on Fn

to (|a1|, . . . , |an|) and (|b1|, . . . , |bn|) gives the inequality

|a1b1| + · · · + |anbn|  |a1|2 + · · · + |an|2 |b1|2 + · · · + |bn|2

for all (a1, . . . , an), (b1, . . . , bn)  Fn.  The inequality in this example was
   Thus we have a new and clean proof            first proved by Cauchy in 1821.

of Hölder's inequality (7.9) for the spe-
cial case where µ is counting measure on
{1, . . . , n} and p = p = 2.

Measure, Integration & Real Analysis, by Sheldon Axler
                Section 8A Inner Product Spaces 219

8.14 Example Cauchy-Schwarz inequality for L2(µ)
   Suppose µ is a measure and f , g  L2(µ). Applying the Cauchy-Schwarz

inequality with the standard inner product on L2(µ) to | f | and |g| gives the inequality

                        | f g| dµ  | f |2 dµ 1/2 |g|2 dµ 1/2.

   The inequality above is equivalent to       In 1859 Viktor Bunyakovsky
Hölder's inequality (7.9) for the special      (1804-1889), who had been
case where p = p = 2. However,                 Cauchy's student in Paris, first
the proof of the inequality above via the      proved integral inequalities like the
Cauchy-Schwarz inequality still depends        one above. Similar discoveries by
on Hölder's inequality to show that the        Hermann Schwarz (1843-1921) in
definition of the standard inner product       1885 attracted more attention and
on L2(µ) makes sense. See Exercise 18          led to the name of this inequality.
in this section for a derivation of the in-
equality above that is truly independent of  Hölder's inequality.

   If we think of the norm determined by an
inner product as a length, then the triangle in-
equality has the geometric interpretation that the
length of each side of a triangle is less than the
sum of the lengths of the other two sides.

8.15 triangle inequality
Suppose f and g are elements of an inner product space. Then

                                 f + g   f  + g,
with equality if and only if one of f , g is a nonnegative multiple of the other.

Proof  We have

8.16             f + g2 =  f + g, f + g
8.17                        =  f , f  + g, g +  f , g + g, f 

                            =  f , f  + g, g +  f , g +  f , g
                            =  f 2 + g2 + 2 Re f , g
                              f 2 + g2 + 2| f , g|
                              f 2 + g2 + 2 f  g
                            = ( f  + g)2,

where 8.17 follows from the Cauchy-Schwarz inequality (8.11). Taking square roots
of both sides of the inequality above gives the desired inequality.

       Measure, Integration & Real Analysis, by Sheldon Axler
220 Chapter 8 Hilbert Spaces

   The proof above shows that the triangle inequality is an equality if and only if we
have equality in 8.16 and 8.17. Thus we have equality in the triangle inequality if
and only if

8.18   f , g =  f  g.

If one of f , g is a nonnegative multiple of the other, then 8.18 holds, as you should
verify. Conversely, suppose 8.18 holds. Then the condition for equality in the Cauchy-
Schwarz inequality (8.11) implies that one of f , g is a scalar multiple of the other.
Clearly 8.18 forces the scalar in question to be nonnegative, as desired.

   Applying the previous result to the inner product space L2(µ), where µ is a
measure, gives a new proof of Minkowski's inequality (7.14) for the case p = 2.

   Now we can prove that what we have been calling a norm on an inner product
space is indeed a norm.

  8.19 · is a norm
  Suppose V is an inner product space and  f  is defined as usual by

                                       f = f, f
  for f  V. Then · is a norm on V.
Proof The definition of an inner product implies that · satisfies the positive defi-
nite requirement for a norm. The homogeneity and triangle inequality requirements
for a norm are satisfied because of 8.6 and 8.15.
   The next result has the geometric in-
terpretation that the sum of the squares
of the lengths of the diagonals of a
parallelogram equals the sum of the
squares of the lengths of the four sides.

  8.20 parallelogram equality

  Suppose f and g are elements of an inner product space. Then

                        f + g2 +  f - g2 = 2 f 2 + 2g2.

Proof We have
             f + g2 +  f - g2 =  f + g, f + g +  f - g, f - g
                                       =  f 2 + g2 +  f , g + g, f 
                                             +  f 2 + g2 -  f , g - g, f 
                                       = 2 f 2 + 2g2,

as desired.

      Measure, Integration & Real Analysis, by Sheldon Axler
              Section 8A Inner Product Spaces 221

EXERCISES 8A

1 Let V denote the vector space of bounded continuous functions from R to F.
    Let r1, r2, . . . be a list of the rational numbers. For f , g  V, define

               f , g =  f (rk) g(rk)
                            k.
              k=1        2

    Show that ·, · is an inner product on V.
2 Prove that if µ is a measure and f , g  L2(µ), then

 f 2 g2 - | f , g|2 = 12 | f (x)g(y) - g(x) f (y)|2 dµ(y) dµ(x).

3 Suppose f and g are elements of an inner product space and

               f + g2 =  f 2 + g2.

(a) Prove that if F = R, then f and g are orthogonal.
(b) Give an example to show that if F = C, then f and g can satisfy the

     equation above without being orthogonal.

4 Find a, b  R3 such that a is a scalar multiple of (1, 6, 3), b is orthogonal to
    (1, 6, 3), and (5, 4, -2) = a + b.

5 Prove that  16  (a + b + c + d) 1a + 1b + 1c + 1d

for all positive numbers a, b, c, d, with equality if and only if a = b = c = d.

6 Prove that the square of the average of each finite list of real numbers containing
    at least two distinct real numbers is less than the average of the squares of the
    numbers in that list.

7 Suppose f and g are elements of an inner product space and  f   1 and
    g  1. Prove that

              1 -  f 2 1 - g2  1 - | f , g|.

8 Suppose a and b are nonzero elements of R2. Prove that
                                    a, b = a b cos ,

    where  is the angle between a and b (thinking of a as the vector whose initial
    point is the origin and whose end point is a, and similarly for b).
    Hint: Draw the triangle formed by a, b, and a - b; then use the law of cosines.

              Measure, Integration & Real Analysis, by Sheldon Axler
222 Chapter 8 Hilbert Spaces

9 The angle between two vectors (thought of as arrows with initial point at the
origin) in R2 or R3 can be defined geometrically. However, geometry is not as
clear in Rn for n > 3. Thus the angle between two nonzero vectors a, b  Rn
is defined to be
                              arccos a, b ,
                              a b

where the motivation for this definition comes from the previous exercise. Ex-
plain why the Cauchy-Schwarz inequality is needed to show that this definition
makes sense.

10 (a) Suppose f and g are elements of a real inner product space. Prove that f
           and g have the same norm if and only if f + g is orthogonal to f - g.

      (b) Use (a) to show that the diagonals of a parallelogram are perpendicular to
           each other if and only if the parallelogram is a rhombus.

11 Suppose f and g are elements of an inner product space. Prove that  f  = g
      if and only if s f + tg = t f + sg for all s, t  R.

12 Suppose f and g are elements of an inner product space and  f  = g = 1
      and  f , g = 1. Prove that f = g.

13 Suppose f and g are elements of a real inner product space. Prove that

                         f , g =  f + g2 -  f - g2 4 .

14 Suppose f and g are elements of a complex inner product space. Prove that

 f , g =  f + g2 -  f - g2 +  f + ig2i -  f - ig2i 4 .

15 Suppose f , g, h are elements of an inner product space. Prove that

                  1     2 h - f 2 + h - g2  f - g2                      .
h - 2 ( f + g) =              2               -         4

16 Prove that a norm satisfying the parallelogram equality comes from an inner
      product. In other words, show that if V is a normed vector space whose norm
      · satisfies the parallelogram equality, then there is an inner product ·, · on
      V such that  f  =  f , f 1/2 for all f  V.

17 Let  denote Lebesgue measure on [1, ).

(a) Prove that if f : [1, )  [0, ) is Borel measurable, then

                     1   f (x) d(x) 2   x2 f (x) 2 d(x).
                                           1

(b) Describe the set of Borel measurable functions f : [1, )  [0, ) such
     that the inequality in (a) is an equality.

Measure, Integration & Real Analysis, by Sheldon Axler
                                 Section 8A Inner Product Spaces 223

18 Suppose µ is a measure. For f , g  L2(µ), define  f , g by

                           f , g = f g dµ.

(a) Using the inequality

| f (x)                   g(x)|    1  | f (x)|2 + |g(x)|2      ,
                                   2

     verify that the integral above makes sense and the map sending f , g to  f , g
     defines an inner product on L2(µ) (without using Hölder's inequality).
(b) Show that the Cauchy-Schwarz inequality implies that

                               f g1   f 2 g2
for all f , g  L2(µ) (again, without using Hölder's inequality).

19 Suppose V1, . . . , Vm are inner product spaces. Show that the equation

                 ( f1, . . . , fm), (g1, . . . , gm) =  f1, g1 + · · · +  fm, gm

      defines an inner product on V1 × · · · × Vm.
      [Each of the inner product spaces V1, . . . , Vm may have a different inner product,
      even though the same inner product notation is used on all these spaces.]
20 Suppose V is an inner product space. Make V × V an inner product space
      as in the exercise above. Prove that the function that takes an ordered pair
      ( f , g)  V × V to the inner product  f , g  F is a continuous function from
      V × V to F.
21 Suppose 1  p  .
      (a) Show the norm on p comes from an inner product if and only if p = 2.
      (b) Show the norm on Lp(R) comes from an inner product if and only if p = 2.

22 Use inner products to prove Apollonius's identity:
      In a triangle with sides of length a, b, and c, let d
      be the length of the line segment from the midpoint
      of the side of length c to the opposite vertex. Then
                      a2 + b2 = 1 c2 + 2d2.

                                                 2

Measure, Integration & Real Analysis, by Sheldon Axler
224 Chapter 8 Hilbert Spaces

8B Orthogonality

Orthogonal Projections

The previous section developed inner product spaces following a standard linear
algebra approach. Linear algebra focuses mainly on finite-dimensional vector spaces.
Many interesting results about infinite-dimensional inner product spaces require an
additional hypothesis, which we now introduce.

  8.21 Definition Hilbert space
  A Hilbert space is an inner product space that is a Banach space with the norm
  determined by the inner product.

8.22 Example Hilbert spaces
  · Suppose µ is a measure. Then L2(µ) with its usual inner product is a Hilbert
     space (by 7.24).
  · As a special case of the first bullet point, if n  Z+ then taking µ to be counting
     measure on {1, . . . , n} shows that Fn with its usual inner product is a Hilbert
     space.
  · As another special case of the first bullet point, taking µ to be counting measure
     on Z+ shows that 2 with its usual inner product is a Hilbert space.
  · Every closed subspace of a Hilbert space is a Hilbert space [by 6.16(b)].

8.23 Example not Hilbert spaces

·  The inner product space 1, where (a1, a2, . . .), (b1, b2, . . .)  =       ak bk ,  is

                                                                         k=1
   not a Hilbert space because the associated norm is not complete on 1.

· The inner product space C([0, 1]) of continuous F-valued functions on the inter-

                                                1

  val [0, 1], where  f , g = 0 f g, is not a Hilbert space because the associated
   norm is not complete on C([0, 1]).

The next definition makes sense in the context of normed vector spaces.

8.24 Definition distance from a point to a set
Suppose U is a nonempty subset of a normed vector space V and f  V. The
distance from f to U, denoted distance( f , U), is defined by

                     distance( f , U) = inf{ f - g : g  U}.
 Notice that distance( f , U) = 0 if and only if f  U.

                   Measure, Integration & Real Analysis, by Sheldon Axler
                                                             Section 8B Orthogonality 225

8.25 Definition convex
  · A subset of a vector space is called convex if the subset contains the line
     segment connecting each pair of points in it.
  · More precisely, suppose V is a vector space and U  V. Then U is called
     convex if
                 (1 - t) f + tg  U for all t  [0, 1] and all f , g  U.

          Convex subset of R2.                             Nonconvex subset of R2.

8.26 Example convex sets
  · Every subspace of a vector space is convex, as you should verify.
  · If V is a normed vector space, f  V, and r > 0, then the open ball centered at
     f with radius r is convex, as you should verify.

   The next example shows that the distance from an element of a Banach space to a
closed subspace is not necessarily attained by some element of the closed subspace.
After this example, we will prove that this behavior cannot happen in a Hilbert space.

8.27 Example no closest element to a closed subspace of a Banach space

   In the Banach space C([0, 1]) with norm g = sup|g|, let

                                                                               [0, 1]
                                                                   1

                   U = g  C([0, 1]) : 0 g = 0 and g(1) = 0 .

Then U is a closed subspace of C([0, 1]).
   Let f  C([0, 1]) be defined by f (x) = 1 - x. For k  Z+, let

                             gk(x) = 12 - x + x2 + k x - 1 k + 1 .

Then  gk    U  and  limk f        -  gk  =     1,  which   implies     that  distance( f , U)    1.

                    1                1         2                                                 2
                                     2
   If g  U, then    0 (f  -  g)   =     and    (f  -  g)(1)  =    0.  These  conditions  imply  that

f  -  g   >  1.

             2                 1                                                                  1.
   Thus   distance( f , U)     2  but   there  does   not  exist  g    U  such  that  f     g
                            =                                                            -     =  2

                 Measure, Integration & Real Analysis, by Sheldon Axler
226 Chapter 8 Hilbert Spaces

In the next result, we use for the first time the hypothesis that V is a Hilbert space.

8.28 distance to a closed convex set is attained in a Hilbert space

· The distance from an element of a Hilbert space to a nonempty closed convex
   set is attained by a unique element of the nonempty closed convex set.

· More specifically, suppose V is a Hilbert space, f  V, and U is a nonempty
   closed convex subset of V. Then there exists a unique g  U such that
                               f - g = distance( f , U).

Proof First we prove the existence of an element of U that attains the distance to f .
To do this, suppose g1, g2, . . . is a sequence of elements of U such that

8.29  lim  f - gk = distance( f , U).
      k

Then for j, k  Z+ we have

      gj - gk2 = ( f - gk) - ( f - gj)2

      = 2 f - gk2 + 2 f - gj2 - 2 f - (gk + gj)2

      = 2 f - gk2 + 2 f - gj2 - 4 f - gk + gj 2 2

8.30   2 f - gk2 + 2 f - gj2 - 4 distance( f , U) 2,

where the second equality comes from the parallelogram equality (8.20) and the
last line holds because the convexity of U implies that (gk + gj)/2  U. Now the
inequality above and 8.29 imply that g1, g2, . . . is a Cauchy sequence. Thus there
exists g  V such that

8.31                       lim gk - g = 0.
                           k

Because U is a closed subset of V and each gk  U, we know that g  U. Now 8.29
and 8.31 imply that

                                 f - g = distance( f , U),

which completes the proof of the existence part of this result.
   To prove the uniqueness part of this result, suppose g and g are elements of U

such that

8.32   f - g =  f - g = distance( f , U).

Then  g - g2  2 f - g2 + 2 f - g2 - 4 distance( f , U) 2
8.33             = 0,

where the first line above follows from 8.30 (with gj replaced by g and gk replaced
by g) and the last line above follows from 8.32. Now 8.33 implies that g = g,
completing the proof of uniqueness.

      Measure, Integration & Real Analysis, by Sheldon Axler
                                                                Section 8B Orthogonality 227

   Example 8.27 showed that the existence part of the previous result can fail in a
Banach space. Exercise 13 shows that the uniqueness part can also fail in a Banach
space. These observations highlight the advantages of working in a Hilbert space.

  8.34 Definition orthogonal projection; PU
  Suppose U is a nonempty closed convex subset of a Hilbert space V. The
  orthogonal projection of V onto U is the function PU : V  V defined by setting
  PU( f ) equal to the unique element of U that is closest to f .
   The definition above makes sense because of 8.28. We will often use the notation
PU f instead of PU( f ). To test your understanding of the definition above, make sure
that you can show that if U is a nonempty closed convex subset of a Hilbert space V,
then
  · PU f = f if and only if f  U;
  · PU  PU = PU.

8.35 Example orthogonal projection onto closed unit ball

Suppose U is the closed unit ball {g  V : g  1} in a Hilbert space V. Then

                                      if  f   1,
                                 f    if  f  > 1,
                       PU f =  f

                                   f

as you should verify.

8.36 Example orthogonal projection onto a closed subspace
   Suppose U is the closed subspace of 2 consisting of the elements of 2 whose

even coordinates are all 0:

                                                                                           

      U = {(a1, 0, a3, 0, a5, 0, . . .) : each ak  F and  |a2k-1|2 < }.

                                                                                      k=1

Then for b = (b1, b2, b3, b4, b5, b6, . . .)  2, we have
                               PUb = (b1, 0, b3, 0, b5, 0, . . .),

as you should verify.
   Note that in this example the function PU is a linear map from 2 to 2 (unlike the

behavior in Example 8.35).
   Also, notice that b - PUb = (0, b2, 0, b4, 0, b6, . . .) and thus b - PUb is orthogonal

to every element of U.

   The next result shows that the properties stated in the last two paragraphs of the
example above hold whenever U is a closed subspace of a Hilbert space.

                     Measure, Integration & Real Analysis, by Sheldon Axler
228 Chapter 8 Hilbert Spaces

  8.37 orthogonal projection onto closed subspace

  Suppose U is a closed subspace of a Hilbert space V and f  V. Then

  (a) f - PU f is orthogonal to g for every g  U;
  (b) if h  U and f - h is orthogonal to g for every g  U, then h = PU f ;
  (c) PU : V  V is a linear map;
  (d) PU f    f , with equality if and only if f  U.

Proof The figure below illustrates (a). To prove (a), suppose g  U. Then for all
  F we have

           f - PU f 2   f - PU f + g2
                          =  f - PU f + g, f - PU f + g
                          =  f - PU f 2 + ||2g2 + 2 Re  f - PU f , g.

Let  = -t f - PU f , g for t > 0. A tiny bit of algebra applied to the inequality
above implies

                       2| f - PU f , g|2  t| f - PU f , g|2g2
for all t > 0. Thus  f - PU f , g = 0, completing the proof of (a).

   To prove (b), suppose h  U and f - h is orthogonal to g for every g  U. If
g  U, then h - g  U and hence f - h is orthogonal to h - g. Thus

 f - h2   f - h2 + h - g2

= ( f - h) + (h - g)2

=  f - g2,                    f - PU f is orthogonal to each element of U.

where the first equality above follows from the Pythagorean Theorem (8.9). Thus

             f - h   f - g

for all g  U. Hence h is the element of U that minimizes the distance to f , which
implies that h = PU f , completing the proof of (b).

   To prove (c), suppose f1, f2  V. If g  U, then (a) implies that  f1 - PU f1, g =
 f2 - PU f2, g = 0, and thus

                          ( f1 + f2) - (PU f1 + PU f2), g = 0.
The equation above and (b) now imply that

                               PU ( f1 + f2) = PU f1 + PU f2.
The equation above and the equation PU( f ) = PU f for   F (whose proof is left
to the reader) show that PU is a linear map, proving (c).

   The proof of (d) is left as an exercise for the reader.

Measure, Integration & Real Analysis, by Sheldon Axler
                        Section 8B Orthogonality 229

Orthogonal Complements

  8.38 Definition orthogonal complement; U
  Suppose U is a subset of an inner product space V. The orthogonal complement
  of U is denoted by U and is defined by

                       U = {h  V : g, h = 0 for all g  U}.

   In other words, the orthogonal complement of a subset U of an inner product
space V is the set of elements of V that are orthogonal to every element of U.

8.39 Example orthogonal complement
   Suppose U is the set of elements of 2 whose even coordinates are all 0:

                                                                                           

      U = {(a1, 0, a3, 0, a5, 0, . . .) : each ak  F and  |a2k-1|2 < }.

                                                                                      k=1

Then U is the set of elements of 2 whose odd coordinates are all 0:

                                                                                             

       U = {0, a2, 0, a4, 0, a6, . . .) : each ak  F and  |a2k|2 < },

as you should verify. k=1

  8.40 properties of orthogonal complement
  Suppose U is a subset of an inner product space V. Then
  (a) U is a closed subspace of V;
  (b) U  U  {0};
  (c) if W  U, then U  W;
  (d) U = U;
  (e) U  (U).

Proof To prove (a), suppose h1, h2, . . . is a sequence in U that converges to some
h  V. If g  U, then

            |g, h| = |g, h - hk|  g h - hk for each k  Z+;
hence g, h = 0, which implies that h  U. Thus U is closed. The proof of (a)
is completed by showing that U is a subspace of V, which is left to the reader.

   To prove (b), suppose g  U  U. Then g, g = 0, which implies that g = 0,
proving (b).

   To prove (e), suppose g  U. Thus g, h = 0 for all h  U, which implies that
g  (U). Hence U  (U), proving (e).

   The proofs of (c) and (d) are left to the reader.

                     Measure, Integration & Real Analysis, by Sheldon Axler
230 Chapter 8 Hilbert Spaces

   The results in the rest of this subsection have as a hypothesis that V is a Hilbert
space. These results do not hold when V is only an inner product space.

8.41 orthogonal complement of the orthogonal complement

Suppose U is a subspace of a Hilbert space V. Then
                                      U = (U).

Proof Applying 8.40(a) to U, we see that (U) is a closed subspace of V. Now
taking closures of both sides of the inclusion U  (U) [8.40(e)] shows that
U  (U).

   To prove the inclusion in the other direction, suppose f  (U). Because
f  (U) and PU f  U  (U) (by the previous paragraph), we see that

                               f - PU f  (U).

Also,                          f - PU f  U
by 8.37(a) and 8.40(d). Hence

f - PU f  U  (U).

Now 8.40(b) (applied to U in place of U) implies that f - PU f = 0, which implies
that f  U. Thus (U)  U, completing the proof.

   As a special case, the result above implies that if U is a closed subspace of a
Hilbert space V, then U = (U).

   Another special case of the result above is sufficiently useful to deserve stating
separately, as we do in the next result.

  8.42 necessary and sufficient condition for a subspace to be dense
  Suppose U is a subspace of a Hilbert space V. Then

                            U = V if and only if U = {0}.

Proof First suppose U = V. Then using 8.40(d), we have
                                 U = U = V = {0}.

   To prove the other direction, now suppose U = {0}. Then 8.41 implies that
                                U = (U) = {0} = V,

completing the proof.

Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 8B Orthogonality 231

   The next result states that if U is a
closed subspace of a Hilbert space V,
then V is the direct sum of U and U,
often written V = U  U, although
we do not need to use this terminology
or notation further.

   The key point to keep in mind is
that the next result shows that the pic-
ture here represents what happens in
general for a closed subspace U of a
Hilbert space V: every element of V
can be uniquely written as an element
of U plus an element of U.

  8.43 orthogonal decomposition
  Suppose U is a closed subspace of a Hilbert space V. Then every element f  V
  can be uniquely written in the form

                                          f = g + h,
  where g  U and h  U. Furthermore, g = PU f and h = f - PU f .
Proof Suppose f  V. Then

                                   f = PU f + ( f - PU f ),
where PU f  U [by definition of PU f as the element of U that is closest to f ] and
f - PU f  U [by 8.37(a)]. Thus we have the desired decomposition of f as the
sum of an element of U and an element of U.

   To prove the uniqueness of this decomposition, suppose
                                  f = g1 + h1 = g2 + h2,

where g1, g2  U and h1, h2  U. Then g1 - g2 = h2 - h1  U  U, which
implies that g1 = g2 and h1 = h2, as desired.

   In the next definition, the function I depends on the vector space V. Thus a
notation such as IV might be more precise. However, the domain of I should always
be clear from the context.

  8.44 Definition identity map; I
  Suppose V is a vector space. The identity map I is the linear map from V to V
  defined by I f = f for f  V.
   The next result highlights the close relationship between orthogonal projections
and orthogonal complements.

                     Measure, Integration & Real Analysis, by Sheldon Axler
232 Chapter 8 Hilbert Spaces

  8.45 range and null space of orthogonal projections
  Suppose U is a closed subspace of a Hilbert space V. Then
  (a) range PU = U and null PU = U;
  (b) range PU = U and null PU = U;
  (c) PU = I - PU.
Proof The definition of PU f as the closest point in U to f implies range PU  U.
Because PU g = g for all g  U, we also have U  range PU. Thus range PU = U.
   If f  null PU, then f  U [by 8.37(a)]. Thus null PU  U. Conversely, if
f  U, then 8.37(b) (with h = 0) implies that PU f = 0; hence U  null PU.
Thus null PU = U, completing the proof of (a).
   Replace U by U in (a), getting range PU = U and null PU = (U) = U
(where the last equality comes from 8.41), completing the proof of (b).
   Finally, if f  U, then

                          PU f = 0 = f - PU f = (I - PU) f ,
where the first equality above holds because null PU = U [by (b)].

   If f  U, then
                          PU f = f = f - PU f = (I - PU) f ,

where the second equality above holds because null PU = U [by (a)].
   The last two displayed equations show that PU and I - PU agree on U and agree

on U. Because PU and I - PU are both linear maps and because each element of
V equals some element of U plus some element of U (by 8.43), this implies that
PU = I - PU, completing the proof of (c).

8.46 Example PU = I - PU
   Suppose U is the closed subspace of L2(R) defined by
                U = { f  L2(R) : f (x) = 0 for almost every x < 0}.

Then, as you should verify,
               U = {g  L2(R) : g(x) = 0 for almost every x  0}.

Furthermore, you should also verify that if h  L2(R), then
                       PU h = h[0, ) and PU h = h(-, 0).

Thus PU h = h(1 - [0, )) = (I - PU)h and hence PU = I - PU, as asserted in
8.45(c).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                   Section 8B Orthogonality 233

Riesz Representation Theorem

Suppose h is an element of a Hilbert space V. Define  : V  F by ( f ) =  f , h
for f  V. The properties of an inner product imply that  is a linear functional.
The Cauchy-Schwarz inequality (8.11) implies that |( f )|   f  h for all f  V,
which implies that  is a bounded linear functional on V. The next result states that
every bounded linear functional on V arises in this fashion.

   To motivate the proof of the next result, note that if  is as in the paragraph above,
then null  = {h}. Thus h  (null ) [by 8.40(e)]. Hence in the proof of the
next result, to find h we start with an element of (null ) and then multiply it by a
scalar to make everything come out right.

8.47 Riesz Representation Theorem

Suppose  is a bounded linear functional on a Hilbert space V. Then there exists
a unique h  V such that

                                      ( f ) =  f , h
for all f  V. Furthermore,  = h.

Proof If  = 0, take h = 0. Thus we can assume  = 0. Hence null  is a closed
subspace of V not equal to V (see 6.52). The subspace (null ) is not {0} (by
8.42). Thus there exists g  (null ) with g = 1. Let

      h = (g)g.

Taking the norm of both sides of the equation above, we get h = |(g)|. Thus

8.48  (h) = |(g)|2 = h2.

Now suppose f  V. Then
                     f , h = f - h2 ( f ) h, h + h2 ( f ) h, h

8.49 = h2 ( f ) h, h

      = ( f ),

where 8.49 holds because f - h2 ( f ) h  null  (by 8.48) and h is orthogonal to all
elements of null .

   We have now proved the existence of h  V such that ( f ) =  f , h for all
f  V. To prove uniqueness, suppose h  V has the same property. Then

      h - h, h - h = h - h, h - h - h, h = (h - h) - (h - h) = 0,

which implies that h = h, which proves uniqueness.
   The Cauchy-Schwarz inequality implies that |( f )| = | f , h|   f  h for

all f  V, which implies that   h. Because (h) = h, h = h2, we also
have   h. Thus  = h, completing the proof.

      Measure, Integration & Real Analysis, by Sheldon Axler
234 Chapter 8 Hilbert Spaces

Suppose that µ is a measure and Frigyes Riesz (1880-1956) proved
1 < p  . In 7.25 we considered the
      p                                8.47 in 1907.
natural map of L (µ) into L (µ) , andp

we showed that this map preserves norms. In the special case where p = p = 2,
the Riesz Representation Theorem (8.47) shows that this map is surjective. In other
words, if  is a bounded linear functional on L2(µ), then there exists h  L2(µ) such
that

            ( f ) = f h dµ

for all f  L2(µ) (take h to be the complex conjugate of the function given by 8.47).
Hence we can identify the dual of L2(µ) with L2(µ). In 9.42 we will deal with other
values of p. Also see Exercise 25 in this section.

EXERCISES 8B

 1 Show that each of the inner product spaces in Example 8.23 is not a Hilbert
     space.

 2 Prove or disprove: The inner product space in Exercise 1 in Section 8A is a
     Hilbert space.

 3 Suppose V1, V2, . . . are Hilbert spaces. Let

                                                                                        

              V = ( f1, f2, . . .)  V1 × V2 × · · · :   fk2 <  .

                                                                                   k=1

     Show that the equation

                                                                                       

                    ( f1, f2, . . .), (g1, g2, . . .) =   fk, gk

                                                                                  k=1

     defines an inner product on V that makes V a Hilbert space.
     [Each of the Hilbert spaces V1, V2, . . . may have a different inner product, even
     though the same notation is used for the norm and inner product on all these
     Hilbert spaces.]
 4 Suppose V is a real Hilbert space. The complexification of V is the complex
     vector space VC defined by VC = V × V, but we write a typical element of VC
     as f + ig instead of ( f , g). Addition and scalar multiplication are defined on
     VC by

                     ( f1 + ig1) + ( f2 + ig2) = ( f1 + f2) + i(g1 + g2)
     and

                        ( + i)( f + ig) = ( f - g) + i(g +  f )
     for f1, f2, f , g1, g2, g  V and ,   R. Show that

             f1 + ig1, f2 + ig2 =  f1, f2 + g1, g2 + i(g1, f2 -  f1, g2)
     defines an inner product on VC that makes VC into a complex Hilbert space.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                                Section 8B Orthogonality 235

 5 Prove that if V is a normed vector space, f  V, and r > 0, then the open ball
      B( f , r) centered at f with radius r is convex.

 6 (a) Suppose V is an inner product space and B is the open unit ball in V (thus
           B = { f  V :  f  < 1}). Prove that if U is a subset of V such that
           B  U  B, then U is convex.

      (b) Give an example to show that (a) can fail if the phrase inner product space
           is replaced by Banach space.

 7 Suppose V is a normed vector space and U is a closed subset of V. Prove that
      U is convex if and only if
                                   f + g 2  U for all f , g  U.

 8 Prove that if U is a convex subset of a normed vector space, then U is also
      convex.

 9 Prove that if U is a convex subset of a normed vector space, then the interior of
      U is also convex.
      [The interior of U is the set { f  U : B( f , r)  U for some r > 0}.]

10 Suppose V is a Hilbert space, U is a nonempty closed convex subset of V, and
      g  U is the unique element of U with smallest norm (obtained by taking f = 0
      in 8.28). Prove that
                                         Reg, h  g2
      for all h  U.

11 Suppose V is a Hilbert space. A closed half-space of V is a set of the form
                                     {g  V : Reg, h  c}

      for some h  V and some c  R. Prove that every closed convex subset of V is
      the intersection of all the closed half-spaces that contain it.
12 Give an example of a nonempty closed subset U of the Hilbert space 2 and
      a  2 such that there does not exist b  U with a - b = distance(a, U).
      [By 8.28, U cannot be a convex subset of 2.]
13 In the real Banach space R2 with norm defined by (x, y) = max{|x|, |y|},
      give an example of a closed convex set U  R2 and z  R2 such that there
      exist infinitely many choices of w  U with z - w = distance(z, U).
14 Suppose f and g are elements of an inner product space. Prove that  f , g = 0
      if and only if

                                          f    f + g
      for all   F.
15 Suppose U is a closed subspace of a Hilbert space V and f  V. Prove that
      PU f    f , with equality if and only if f  U.
      [This exercise asks you to prove 8.37(d).]

                      Measure, Integration & Real Analysis, by Sheldon Axler
236 Chapter 8 Hilbert Spaces

16 Suppose V is a Hilbert space and P : V  V is a linear map such that P2 = P
      and P f    f  for every f  V. Prove that there exists a closed subspace U
      of V such that P = PU.

17 Suppose U is a subspace of a Hilbert space V. Suppose also that W is a Banach
      space and S : U  W is a bounded linear map. Prove that there exists a bounded
      linear map T : V  W such that T|U = S and T = S.
      [If W = F, then this result is just the Hahn-Banach Theorem (6.69) for Hilbert
      spaces. The result here is stronger because it allows W to be an arbitrary
      Banach space instead of requiring W to be F. Also, the proof in this Hilbert
      space context does not require use of Zorn's Lemma or the Axiom of Choice.]

18 Suppose U and W are subspaces of a Hilbert space V. Prove that U = W if and
      only if U = W.

19 Suppose U and W are closed subspaces of a Hilbert space. Prove that PU PW = 0
      if and only if  f , g = 0 for all f  U and all g  W.

20 Verify the assertions in Example 8.46.

21 Show that every inner product space is a subspace of some Hilbert space.

Hint: See Exercise 13 in Section 6C.

22 Prove that if V is a Hilbert space and T : V  V is a bounded linear map such
      that the dimension of range T is 1, then there exist g, h  V such that

                                    T f =  f , gh

for all f  V.

23 (a) Give an example of a Banach space V and a bounded linear functional 
           on V such that |( f )| <   f  for all f  V \ {0}.

      (b) Show there does not exist an example in part (a) where V is a Hilbert space.

24 (a) Suppose  and  are bounded linear functionals on a Hilbert space V such
           that  +  =  + . Prove that one of ,  is a scalar multiple of
           the other.

      (b) Give an example to show that (a) can fail if the hypothesis that V is a Hilbert
           space is replaced by the hypothesis that V is a Banach space.

25 (a) Suppose that µ is a finite measure, 1  p  2, and  is a bounded
                             Lp(µ).                                          p
linear  functional       on          Prove   that  there    exists  h              such   that
( f ) = f h dµ for every f  Lp(µ).                                         L (µ)

(b) Same as (a), but with the hypothesis that µ is a finite measure replaced by
     the hypothesis that µ is a measure, and assume that 1 < p  2.

[See 7.25, which along with this exercise shows that we can identify the dual of
Lp(µ)          p         1     p    2.                                          p    (1,  ).]
       with         for     <           See  9.42  for  an  extension  to  all     
             L (µ)

26 Prove that if V is an infinite-dimensional Hilbert space, then the Banach space
      B(V, V) is nonseparable.

        Measure, Integration & Real Analysis, by Sheldon Axler
                                   Section 8C Orthonormal Bases 237

8C Orthonormal Bases

Bessel's Inequality

Recall that a family {ek}k in a set V is a function e from a set  to V, with the
value of the function e at k   denoted by ek (see 6.53).

8.50 Definition orthonormal family

A family {ek}k in an inner product space is called an orthonormal family if
                               ej, ek = 0 if j = k, 1 if j = k

for all j, k  .

   In other words, a family {ek}k is an orthonormal family if ej and ek are orthog-
onal for all distinct j, k   and ek = 1 for all k  .

8.51 Example orthonormal families

· For k  Z+, let ek be the element of 2 all of whose coordinates are 0 except for
   the kth coordinate, which is 1:

                                  ek = (0, . . . , 0, 1, 0, . . .).
  Then {ek}kZ+ is an orthonormal family in 2. In this case, our family is a
   sequence; thus we can call {ek}kZ+ an orthonormal sequence.
· More generally, suppose  is a nonempty set. The Hilbert space L2(µ), where
   µ is counting measure on , is often denoted by 2(). For k  , define a
   function ek :   F by

                 ek(j) = 1 if j = k, 0 if j = k.

Then {ek}k is an orthonormal family in 2().

· For k  Z, define ek : (-, ]  R by

                 1                 sin(kt)  if k > 0,
                                            if k = 0,
                                            if k < 0.

                 ek(t) = 1
                            2
                  1 cos(kt)
                   

Then {ek}kZ is an orthonormal family in L2 (-, ] , as you should verify
(see Exercise 1 for useful formulas that will help with this verification).
This orthonormal family {ek}kZ leads to the classical theory of Fourier series,
as we will see in more depth in Chapter 11.

Measure, Integration & Real Analysis, by Sheldon Axler
238 Chapter 8 Hilbert Spaces

· For k a nonnegative integer, define ek : [0, 1)  F by

                          if x    n-1 n       for some odd integer n,
                       1  if x                for some even integer n.
             ek(x) = -1            2k , 2k

                                  n-1 n

                                   2k , 2k

The figure below shows the graphs      This orthonormal family was
of e0, e1, e2, and e3. The pattern of
these graphs should convince you that  invented by Hans Rademacher
{ek}k{0,1,...} is an orthonormal fam-  (1892-1969).
ily in L2 [0, 1) .

The graph of e0. The graph of e1. The graph of e2. The graph of e3.

· Now we modify the example in the previous bullet point by translating the
   functions in the previous bullet point by arbitrary integers. Specifically, for k a
   nonnegative integer and m  Z, define ek,m : R  F by

                   if x   m+  n-1 , m +2 2n   for some odd integer n  [1, 2k],
             1                                for some even integer n  [1, 2k],
                                 k         k
ek,m(x) = -1
                   if x   m+  2n-1 , m + 2n

                0                k         k

                   if x / [m, m + 1).

Then {ek,m}(k,m){0, 1, ...}×Z is an orthonormal family in L2(R).
This example illustrates the usefulness of considering families that are not
sequences. Although {0, 1, . . .} × Z is a countable set and hence we could
rewrite {ek,m}(k,m){0, 1, ...}×Z as a sequence, doing so would be awkward and
would be less clean than the ek,m notation.

The next result gives our first indication of why orthonormal families are so useful.

8.52 finite orthonormal families

Suppose  is a finite set and {ej}j is an orthonormal family in an inner product
space. Then
                           jej 2 =  |j|2
                          j              j

for every family {j}j in F.

             Measure, Integration & Real Analysis, by Sheldon Axler
                                                 Section 8C Orthonormal Bases 239

Proof Suppose {j}j is a family in F. Standard properties of inner products
show that

                                jej 2 =           jej,  kek
                                                 j     k
                               j

                                        =  jkej, ek

                                            j,k

                                        =  |j|2,

                                            j

as desired.

    Suppose  is a finite set and {ej}j is an orthonormal family in an inner product
space. The result above implies that if j jej = 0, then j = 0 for every j  .
    Linear algebra, and algebra more generally, deals with sums of only finitely many
terms. However, in analysis we often want to sum infinitely many terms. For example,
earlier we defined the infinite sum of a sequence g1, g2, . . . in a normed vector space
to  be  the  limit  as  n      of  the  partial  sums     n  gk  if  that  limit  exists  (see  6.40).

                                                       k=1
    The next definition captures a more powerful method of dealing with infinite sums.
The sum defined below is called an unordered sum because the set  is not assumed
to come with any ordering. A finite unordered sum is defined in the obvious way.

  8.53 Definition unordered sum; k fk
  Suppose { fk}k is a family in a normed vector space V. The unordered sum
  k fk is said to converge if there exists g  V such that for every  > 0, there
  exists a finite subset  of  such that

                             g -  fj < 

                                                           j

  for all finite sets  with     . If this happens, we set k fk = g. If
  there is no such g  V, then k fk is left undefined.
   Exercises at the end of this section ask you to develop basic properties of unordered
sums, including the following:
  · Suppose {ak}k is a family in R and ak  0 for each k  . Then the unordered

     sum k ak converges if and only if

                  sup  aj :  is a finite subset of  < .

                                         j

     Furthermore, if k ak converges then it equals the supremum above. If
     k ak does not converge, then the supremum above is  and we write
     k ak =  (this notation should be used only when ak  0 for each k  ).

                    Measure, Integration & Real Analysis, by Sheldon Axler
240 Chapter 8 Hilbert Spaces

· Suppose {ak}k is a family in R. Then the unordered sum k ak converges
   if and only if k|ak| < . Thus convergence of an unordered summation in
   R is the same as absolute convergence. As we are about to see, the situation in
   more general Hilbert spaces is quite different.

 Now we can extend 8.52 to infinite sums.

8.54 linear combinations of an orthonormal family

Suppose {ek}k is an orthonormal family in a Hilbert space V. Suppose {k}k
is a family in F. Then

(a)  the unordered sum  kek converges   |k|2 < .

     k                                             k

Furthermore, if k kek converges, then

(b)  kek 2 =  |k|2.
     k                                 k

Proof First suppose k kek converges, with k kek = g. Suppose  > 0.
Then there exists a finite set    such that

                                 g -  jej < 

                                       j

for all finite sets  with     . If  is a finite set with     , then
the inequality above implies that

     g -  <  jej < g + ,

                         j

which (using 8.52) implies that   |j|2 1/2 < g + .
                         g -  <
                                 j

Thus g = k|k|2 1/2, completing the proof of one direction of (a) and the
proof of (b).

   To prove the other direction of (a), now suppose k|k|2 < . Thus there
exists an increasing sequence 1  2  · · · of finite subsets of  such that for
each m  Z+,

8.55  |j|2 < 2 1                          m
     j\m

for every finite set  such that m    . For each m  Z+, let

                             gm =  jej.

                                                             jm

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                          Section 8C Orthonormal Bases 241

If n > m, then 8.52 implies that

                    gn - gm2 =  |j|2 < 2 1 .

                                               jn\m m

Thus g1, g2, . . . is a Cauchy sequence and hence converges to some element g of V.
Temporarily fixing m  Z+ and taking the limit of the equation above as n  ,
we see that
                                                  g - gm  1 .
                                                                  m

To    show   that  k kek             =        g,  suppose     >   0.  Let  m    Z+  be   such   that  2  <  .
                                                                                                      m
Suppose  is a finite set with m    . Then

                      g -  jej                     g - gm + gm -  jej

                            j                                                         j

                                                   1m +         jej

                                                             j\m

                                                  = 1m +        |j|2 1/2

                                                             j\m

                                                  < ,

where the third line comes from 8.52 and the last line comes from 8.55. Thus
k kek = g, completing the proof.

8.56 Example a convergent unordered sum need not converge absolutely

Suppose {ek}kZ+ is the orthonormal family in 2 defined by setting ek equal to
the sequence that is 0 everywhere except for a 1 in the kth slot. Then by 8.54, the
unordered sum
                                                            1 ek
                                                       kZ+
                                                            k

converges in 2 (because kZ+                        1   <  )   even    though  kZ+        1  ek  =  .     Note
                                                   k2                                    k
that         1 ek     (1,  1,  1  ,  .  .  .       2.
      kZ+          =           3              )  
             k             2

Now we prove an important inequality.

8.57 Bessel's inequality
Suppose {ek}k is an orthonormal family in an inner product space V and f  V.
Then

                          | f , ek|2   f 2.

                                            k

                   Measure, Integration & Real Analysis, by Sheldon Axler
242 Chapter 8 Hilbert Spaces

Proof Suppose  is a finite subset of .  Bessel's inequality is named in
Then                                    honor of Friedrich Bessel

f =   f , ejej + f -   f , ejej ,       (1784-1846), who discovered this
     j            j                     inequality in 1828 in the special
                                        case of the trigonometric

where the first sum above is orthogonal orthonormal family given by the
to the term in parentheses above (as you third bullet point in Example 8.51.
should verify).

   Applying the Pythagorean Theorem (8.9) to the equation above gives

         f 2 =   f , ejej 2 +           f -   f , ejej 2

                       j                      j

                f , ejej 2

                       j

             =  | f , ej|2,

                     j

where the last equality follows from 8.52. Because the inequality above holds for
every finite set   , we conclude that  f 2  k| f , ek|2, as desired.

   Recall that the span of a family {ek}k in a vector space is the set of finite sums
of the form

                                 jej,

                                                         j

where  is a finite subset of  and {j}j is a family in F (see 6.54). Bessel's
inequality now allows us to prove the following beautiful result showing that the
closure of the span of an orthonormal family is a set of infinite sums.

8.58 closure of the span of an orthonormal family

Suppose {ek}k is an orthonormal family in a Hilbert space V. Then

(a) span {ek}k =   kek : {k}k is a family in F and  |k|2 <  .
Furthermore,      k                                k

(b)                            f =   f , ekek

                                   k

     for every f  span {ek}k.

Proof The right side of (a) above makes sense because of 8.54(a). Furthermore, the
right side of (a) above is a subspace of V because 2() [which equals L2(µ), where
µ is counting measure on ] is closed under addition and scalar multiplication by 7.5.

        Measure, Integration & Real Analysis, by Sheldon Axler
                         Section 8C Orthonormal Bases 243

   Suppose first {k}k is a family in F and k|k|2 < . Let  > 0. Then
there is a finite subset  of  such that

                               |j|2 < 2.

                                                   j\

The inequality above and 8.54(b) imply that

                    kek -  jej < .
                   k  j

The definition of the closure (see 6.7) now implies that k kek  span {ek}k,
showing that the right side of (a) is contained in the left side of (a).

   To prove the inclusion in the other direction, now suppose f  span {ek}k. Let

8.59                  g =   f , ekek,

                      k

where the sum above converges by Bessel's inequality (8.57) and by 8.54(a). The
direction of the inclusion that we just proved implies that g  span {ek}k. Thus

8.60               g - f  span {ek}k.

   Equation 8.59 implies that g, ej =  f , ej for each j  , as you should verify
(which will require using the Cauchy-Schwarz inequality if done rigorously). Hence

                   g - f , ek = 0 for every k  .

This implies that

                                                  
                   g - f  span{ej}j = span{ej}j ,

where the equality above comes from 8.40(d). Now 8.60 and the inclusion above
imply that f = g [see 8.40(b)], which along with 8.59 implies that f is in the right
side of (a), completing the proof of (a).

   The equations f = g and 8.59 also imply (b).

Parseval's Identity

Note that 8.52 implies that every orthonormal family in an inner product space is
linearly independent (see 6.54 to review the definition of linearly independent and
basis). Linear algebra deals mainly with finite-dimensional vector spaces, but infinite-
dimensional vector spaces frequently appear in analysis. The notion of a basis is not
so useful when doing analysis with infinite-dimensional vector spaces because the
definition of span does not take advantage of the possibility of summing an infinite
number of elements.

   However, 8.58 tells us that taking the closure of the span of an orthonormal
family can capture the sum of infinitely many elements. Thus we make the following
definition.

                     Measure, Integration & Real Analysis, by Sheldon Axler
244 Chapter 8 Hilbert Spaces

  8.61 Definition orthonormal basis
  An orthonormal family {ek}k in a Hilbert space V is called an orthonormal
  basis of V if

                                    span {ek}k = V.
   In addition to requiring orthonormality (which implies linear independence), the
definition above differs from the definition of a basis by considering the closure of
the span rather than the span. An important point to keep in mind is that despite the
terminology, an orthonormal basis is not necessarily a basis in the sense of 6.54. In
fact, if  is an infinite set and {ek}k is an orthonormal basis of V, then {ek}k is
not a basis of V (see Exercise 9).

8.62 Example orthonormal bases

  · For n  Z+ and k  {1, . . . , n}, let ek be the element of Fn all of whose
     coordinates are 0 except the kth coordinate, which is 1:
                                   ek = (0, . . . , 0, 1, 0, . . . , 0).
     Then {ek}k{1,...,n} is an orthonormal basis of Fn.

  · Let e1 = 13 , 13 , 13 , e2 = - 12 , 12 , 0 , and e3 = 16 , 16 , - 26 . Then
     {ek}k{1,2,3} is an orthonormal basis of F3, as you should verify.

  · The first three bullet points in 8.51 are examples of orthonormal families that are
     orthonormal bases. The exercises ask you to verify that we have an orthonormal
     basis in the first and second bullet points of 8.51. For the third bullet point
     (trigonometric functions), see Exercise 11 in Section 10D or see Chapter 11.

   The next result shows why orthonormal bases are so useful--a Hilbert space with
an orthonormal basis {ek}k behaves like 2().

  8.63 Parseval's identity
  Suppose {ek}k is an orthonormal basis of a Hilbert space V and f , g  V. Then

 (a) f =   f , ekek;

                 k

 (b)  f , g =   f , ek g, ek;

                        k

 (c)  f 2 =  | f , ek|2.

                       k

Proof The equation in (a) follows immediately from 8.58(b) and the definition of an
orthonormal basis.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                           Section 8C Orthonormal Bases 245

To prove (b), note that    Equation (c) is called Parseval's
                           identity in honor of Marc-Antoine
    f , g =   f , ekek, g  Parseval (1755-1836), who
                           discovered a special case in 1799.
                      k

         =   f , ekek, g

                    k

=   f , ek g, ek,

    k

where the first equation follows from (a) and the second equation follows from the
definition of an unordered sum and the Cauchy-Schwarz inequality.

   Equation (c) follows from setting g = f in (b). An alternative proof: equation (c)

follows from 8.54(b) and the equation f =   f , ekek from (a).

                                                                  k

Gram-Schmidt Process and Existence of Orthonormal Bases

8.64 Definition separable
A normed vector space is called separable if it has a countable subset whose
closure equals the whole space.

8.65 Example separable normed vector spaces

  · Suppose n  Z+. Then Fn with the usual Hilbert space norm is separable
     because the closure of the countable set
                           {(c1, . . . , cn)  Fn : each cj is rational}
     equals Fn (in case F = C: to say that a complex number is rational in this
     context means that both the real and imaginary parts of the complex number are
     rational numbers in the usual sense).

  · The Hilbert space 2 is separable because the closure of the countable set

                             

                        {(c1, . . . , cn, 0, 0, . . .)  2 : each cj is rational}

                           n=1

     is 2.
  · The Hilbert spaces L2([0, 1]) and L2(R) are separable, as Exercise 13 asks you

     to verify [hint: consider finite linear combinations with rational coefficients of
     functions of the form (c, d), where c and d are rational numbers].

Measure, Integration & Real Analysis, by Sheldon Axler
246 Chapter 8 Hilbert Spaces

   A moment's thought about the definition of closure (see 6.7) shows that a normed
vector space V is separable if and only if there exists a countable subset C of V such
that every open ball in V contains at least one element of C.
8.66 Example nonseparable normed vector spaces

· Suppose  is an uncountable set. Thenthe Hilbert space 2() is not separable.
  To see this, note that {j} - {k} = 2 for all j, k   with j = k. Hence

                                                              

                                    B {k} , 22 : k  

   is an uncountable collection of disjoint open balls in 2(); no countable set can
   have at least one element in each of these balls.
· The Banach space L([0, 1]) is not separable. Here [0, s] - [0, t] = 1 for all
   s, t  [0, 1] with s = t. Thus

      B  ,1                   : t  [0, 1]

            [0, t] 2

      is an uncountable collection of disjoint open balls in L([0, 1]).

   We present two proofs of the existence of orthonormal bases of Hilbert spaces.
The first proof works only for separable Hilbert spaces, but it gives a useful algorithm,
called the Gram-Schmidt process, for constructing orthonormal sequences. The
second proof works for all Hilbert spaces, but it uses a result that depends on the
Axiom of Choice.

   Which proof should you read? In practice, the Hilbert spaces you will encounter
will almost certainly be separable. Thus the first proof suffices, and it has the
additional benefit of introducing you to a widely used algorithm. The second proof
uses an entirely different approach and has the advantage of applying to separable
and nonseparable Hilbert spaces. For maximum learning, read both proofs!

8.67 existence of orthonormal bases for separable Hilbert spaces

Every separable Hilbert space has an orthonormal basis.

Proof Suppose V is a separable Hilbert space and { f1, f2, . . .} is a countable subset
of V whose closure equals V. We will inductively define an orthonormal sequence
{ek}kZ+ such that

8.68  span{ f1, . . . , fn}  span{e1, . . . , en}

for each n  Z+. This will imply that span{ek}kZ+ = V, which will mean that
{ek}kZ+ is an orthonormal basis of V.

   To get started with the induction, set e1 = f1/ f1 (we can assume that f1 = 0).

      Measure, Integration & Real Analysis, by Sheldon Axler
                                             Section 8C Orthonormal Bases 247

   Now suppose n  Z+ and e1, . . . , en have been chosen so that {ek}k{1,...,n} is
an orthonormal family in V and 8.68 holds. If fk  span{e1, . . . , en} for every
k  Z+, then {ek}k{1,...,n} is an orthonormal basis of V (completing the proof) and
the process should be stopped. Otherwise, let m be the smallest positive integer such
that

8.69            fm / span{e1, . . . , en}.

Define en+1 by  en+1 = fm -  fm, e1e1 - · · · -  fm, enen  fm -  fm, e1e1 - · · · -  fm, enen .
8.70

   Clearly en+1 = 1 (8.69 guaran-            Jørgen Gram (1850-1916) and
tees there is no division by 0). If          Erhard Schmidt (1876-1959)
k  {1, . . . , n}, then the equation above   popularized this process that
implies that en+1, ek = 0. Thus              constructs orthonormal sequences.
{ek}k{1,...,n+1} is an orthonormal fam-
ily in V. Also, 8.68 and the choice of m
as the smallest positive integer satisfying
8.69 imply that

                span{ f1, . . . , fn+1}  span{e1, . . . , en+1},

completing the induction and completing the proof.

   Before considering nonseparable Hilbert spaces, we take a short detour to illustrate
how the Gram-Schmidt process used in the previous proof can be used to find closest
elements to subspaces. We begin with a result connecting the orthogonal projection
onto a closed subspace with an orthonormal basis of that subspace.

8.71 orthogonal projection in terms of an orthonormal basis

Suppose that U is a closed subspace of a Hilbert space V and {ek}k is an
orthonormal basis of U. Then

                         PU f =   f , ekek

                                                         k

for all f  V.

Proof Let f  V. If k  , then

8.72             f , ek =  f - PU f , ek + PU f , ek = PU f , ek,

where the last equality follows from 8.37(a). Now

                PU f =  PU f , ekek =   f , ekek,
                k                            k

where the first equality follows from Parseval's identity [8.63(a)] as applied to U and
its orthonormal basis {ek}k, and the second equality follows from 8.72.

                Measure, Integration & Real Analysis, by Sheldon Axler
248 Chapter 8 Hilbert Spaces

8.73 Example best approximation
   Find the polynomial g of degree at most 10 that minimizes

                                 1                          2
                                     |x| - g(x) dx.
                                 -1

Solution We will work in the real Hilbert space L2([-1, 1]) with the usual inner
                1
product g, h =  -1  gh.  For  k      {0, 1, .  .  . , 10},  let  fk    L2([-1, 1])  be  defined  by

fk(x) = xk. Let U be the subspace of L2([-1, 1]) defined by

                         U = span{ fk}k{0, ..., 10}.

Apply the Gram-Schmidt process from the proof of 8.67 to { fk}k{0, ..., 10}, pro-
ducing an orthonormal basis {ek}k{0,...,10} of U, which is a closed subspace of
L2([-1, 1]) (see Exercise 8). The point here is that {ek}k{0, ..., 10} can be computed
explicitly and exactly by using 8.70 and evaluating some integrals (using software that
can do exact rational arithmetic will make the process easier), getting e0(x) = 1/ 2,
e1(x) = 6x/2, . . . up to

            
               42 (-63 + 3465x2 - 30030x4 + 90090x6 - 109395x8 + 46189x10).

e10(x) = 512

   Define f  L2([-1, 1]) by f (x) = |x|. Because U is the subspace of
L2([-1, 1]) consisting of polynomials of degree at most 10 and PU f equals the
element of U closest to f (see 8.34), the formula in 8.71 tells us that the solution g to
our minimization problem is given by the formula

                                                             10

                            g =   f , ekek.

                                                         k=0

Using the explicit expressions for e0, . . . , e10 and again evaluating some integrals,
this gives

g(x) = 693 + 15015x2 - 64350x4 + 139230x6 - 138567x8 + 51051x10 2944 .

   The figure here shows the graph of
f (x) = |x| (red) and the graph of
its closest polynomial g (blue) of de-
gree at most 10; here closest means as
measured in the norm of L2([-1, 1]).

   The approximation of f by g is
pretty good, especially considering
that f is not differentiable at 0 and thus
a Taylor series expansion for f does
not make sense.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                        Section 8C Orthonormal Bases 249

   Recall that a subset  of a set V can be thought of as a family in V by considering
{e f } f , where e f = f . With this convention, a subset  of an inner product space
V is an orthonormal subset of V if  f  = 1 for all f   and  f , g = 0 for all
f , g   with f = g.

   The next result characterizes the orthonormal bases as the maximal elements
among the collection of orthonormal subsets of a Hilbert space. Recall that a set
  A in a collection of subsets of a set V is a maximal element of A if there does
not exist   A such that    (see 6.55).

  8.74 orthonormal bases as maximal elements
  Suppose V is a Hilbert space, A is the collection of all orthonormal subsets of V,
  and  is an orthonormal subset of V. Then  is an orthonormal basis of V if and
  only if  is a maximal element of A.
Proof First suppose  is an orthonormal basis of V. Parseval's identity [8.63(a)]
implies that the only element of V that is orthogonal to every element of  is 0. Thus
there does not exist an orthonormal subset of V that strictly contains . In other
words,  is a maximal element of A.
   To prove the other direction, suppose now that  is a maximal element of A. Let
U denote the span of . Then

                                          U = {0}
because if f is a nonzero element of U, then   { f / f } is an orthonormal subset
of V that strictly contains . Hence U = V (by 8.42), which implies that  is an
orthonormal basis of V.

   Now we are ready to prove that every Hilbert space has an orthonormal basis.
Before reading the next proof, you may want to review the definition of a chain (6.58),
which is a collection of sets such that for each pair of sets in the collection, one of
them is contained in the other. You should also review Zorn's Lemma (6.60), which
gives a way to show that a collection of sets contains a maximal element.

  8.75 existence of orthonormal bases for all Hilbert spaces
  Every Hilbert space has an orthonormal basis.
Proof Suppose V is a Hilbert space. Let A be the collection of all orthonormal
subsets of V. Suppose C  A is a chain. Let L be the union of all the sets in C. If
f  L, then  f  = 1 because f is an element of some orthonormal subset of V that
is contained in C.
   If f , g  L with f = g, then there exist orthonormal subsets  and  in C such
that f   and g  . Because C is a chain, either    or   . Either way,
there is an orthonormal subset of V that contains both f and g. Thus  f , g = 0.
   We have shown that L is an orthonormal subset of V; in other words, L  A.
Thus Zorn's Lemma (6.60) implies that A has a maximal element. Now 8.74 implies
that V has an orthonormal basis.

                     Measure, Integration & Real Analysis, by Sheldon Axler
250 Chapter 8 Hilbert Spaces

Riesz Representation Theorem, Revisited

Now that we know that every Hilbert space has an orthonormal basis, we can give a
completely different proof of the Riesz Representation Theorem (8.47) than the proof
we gave earlier.

   Note that the new proof below of the Riesz Representation Theorem gives the
formula 8.77 for h in terms of an orthonormal basis. One interesting feature of this
formula is that h is uniquely determined by  and thus h does not depend on the
choice of an orthonormal basis. Hence despite its appearance, the right side of 8.77
is independent of the choice of an orthonormal basis.

8.76 Riesz Representation Theorem

Suppose  is a bounded linear functional on a Hilbert space V and {ek}k is an
orthonormal basis of V. Let

8.77        h =  (ek) ek.

                              k

Then

8.78        ( f ) =  f , h

for all f  V. Furthermore,  = k|(ek)|2 1/2.

Proof First we must show that the sum defining h makes sense. To do this, suppose
 is a finite subset of . Then

 |(ej)|2 =   (ej) ej    (ej) ej                         =   |(ej)|2 1/2,
j        j                         j
                                                                     j 1/2
where the last equality follows from 8.52. Dividing by
                                                        j|(ej)|2 gives

                           |(ej)|2 1/2  .

                                              j

Because the inequality above holds for every finite subset  of , we conclude that

                            |(ek)|2  2.

                                               k

Thus the sum defining h makes sense (by 8.54) in equation 8.77.
   Now 8.77 shows that h, ej = (ej) for each j  . Thus if f  V then

( f ) =    f , ekek =   f , ek(ek) =   f , ek h, ek =  f , h,
      k     k                         k

where the first and last equalities follow from 8.63 and the second equality follows
from the boundedness/continuity of . Thus 8.78 holds.

   Finally, the Cauchy-Schwarz inequality, equation 8.78, and the equation (h) =
h, h show that  = h = k|(ek)|2 1/2.

      Measure, Integration & Real Analysis, by Sheldon Axler
                                    Section 8C Orthonormal Bases 251

EXERCISES 8C

1 Verify that the family {ek}kZ as defined in the third bullet point of Example
    8.51 is an orthonormal family in L2 (-, ] . The following formulas should
    help:

             (sin x)(cos y) = sin(x - y) + sin(x + y) 2 ,
             (sin x)(sin y) = cos(x - y) - cos(x + y) 2 ,
             (cos x)(cos y) = cos(x - y) + cos(x + y) 2 .

2 Suppose {ak}k is a family in R and ak  0 for each k  . Prove the
    unordered sum k ak converges if and only if

             sup  aj :  is a finite subset of  < .

                      j

Furthermore, prove that if k ak converges then it equals the supremum above.

3 Suppose {ek}k is an orthonormal family in an inner product space V. Prove
    that if f  V, then {k   :  f , ek = 0} is a countable set.

4 Suppose { fk}k and {gk}k are families in a normed vector space such that
    k fk and k gk converge. Prove that k( fk + gk) converges and

                         ( fk + gk) =  fk +  gk.
                        k                      k    k

5 Suppose { fk}k is a family in a normed vector space such that k fk con-
    verges. Prove that if c  F, then k(c fk) converges and

                              (c fk) = c  fk.
                             k                 k

6 Suppose {ak}k is a family in R. Prove that the unordered sum  ak con-

                                                                                                             k

   verges if and only if  |ak| < .

                                     k

7 Suppose { fk}kZ+ is a family in a normed vector space V and f  V. Prove
that the unordered sum kZ+ fk equals f if and only if the usual ordered sum
     f p(k)  equals  f  for  every  injective  and  surjective  function  p:  Z+    Z+.

k=1

8 Explain why 8.58 implies that if  is a finite set and {ek}k is an orthonormal
    family in a Hilbert space V, then span{ek}k is a closed subspace of V.

9 Suppose V is an infinite-dimensional Hilbert space. Prove that there does not
    exist a basis of V that is an orthonormal family.

             Measure, Integration & Real Analysis, by Sheldon Axler
252 Chapter 8 Hilbert Spaces

10 (a) Show that the orthonormal family given in the first bullet point of Exam-
           ple 8.51 is an orthonormal basis of 2.

      (b) Show that the orthonormal family given in the second bullet point of Exam-
           ple 8.51 is an orthonormal basis of 2().

      (c) Show that the orthonormal family given in the fourth bullet point of Exam-
           ple 8.51 is not an orthonormal basis of L2 [0, 1) .

      (d) Show that the orthonormal family given in the fifth bullet point of Exam-
           ple 8.51 is not an orthonormal basis of L2(R).

11 Suppose µ is a -finite measure on (X, S ) and  is a -finite measure on (Y, T ).
      Suppose also that {ej}j is an orthonormal basis of L2(µ) and { fk}k is an
      orthonormal basis of L2() for some countable set . For j   and k  ,
      define gj,k : X × Y  F by

                                     gj,k(x, y) = ej(x) fk(y).
      Prove that {gj,k}j, k is an orthonormal basis of L2(µ × ).
12 Prove the converse of Parseval's identity. More specifically, prove that if {ek}k
      is an orthonormal family in a Hilbert space V and

                              f 2 =  | f , ek|2

                                                                 k

      for every f  V, then {ek}k is an orthonormal basis of V.
13 (a) Show that the Hilbert space L2([0, 1]) is separable.

      (b) Show that the Hilbert space L2(R) is separable.
      (c) Show that the Banach space  is not separable.
14 Prove that every subspace of a separable normed vector space is separable.
15 Suppose V is an infinite-dimensional Hilbert space. Prove that there does not
      exist a translation invariant measure on the Borel subsets of V that assigns
      positive but finite measure to each open ball in V.
      [A subset of V is called a Borel set if it is in the smallest -algebra containing
      all the open subsets of V. A measure µ on the Borel subsets of V is called
      translation invariant if µ( f + E) = µ(E) for every f  V and every Borel set
      E of V.]
16 Find the polynomial g of degree at most 4 that minimizes 1 x5 - g(x) 2 dx.

                                                                                                       0

17 Prove that each orthonormal family in a Hilbert space can be extended to
      an orthonormal basis of the Hilbert space. Specifically, suppose {ej}j is
      an orthonormal family in a Hilbert space V. Prove that there exists a set 
      containing  and an orthonormal basis { fk}k of V such that fj = ej for every
      j  .

18 Prove that every vector space has a basis.

                      Measure, Integration & Real Analysis, by Sheldon Axler
Section 8C Orthonormal Bases 253

19 Find the polynomial g of degree at most 4 such that

f1 =      1                                  fg

    2  0

for every polynomial f of degree at most 4.

Exercises 20-25 are for readers familiar with analytic functions.
20 Suppose G is a nonempty open subset of C. The Bergman space L2a(G) is

      defined to be the set of analytic functions f : G  C such that

                                             | f |2 d2 < ,

                                                          G

      where 2 is the usual Lebesgue measure on R2, which is identified with C. For
      f , h  L2a(G), define  f , h to be G f h d2.
      (a) Show that L2a(G) is a Hilbert space.
      (b) Show that if w  G, then f  f (w) is a bounded linear functional on

           L2a (G).

21 Let D denote the open unit disk in C; thus
                                     D = {z  C : |z| < 1}.

      (a) Find an orthonormal basis of L2a(D).
      (b) Suppose f  L2a(D) has Taylor series

                                                                            

                                 f (z) =  akzk

                                                                       k=0

           for z  D. Find a formula for  f  in terms of a0, a1, a2, . . . .
      (c) Suppose w  D. By the previous exercise and the Riesz Representation

           Theorem (8.47 and 8.76), there exists w  L2a(D) such that
                                 f (w) =  f , w for all f  L2a(D).

           Find an explicit formula for w.

22 Suppose G is the annulus defined by
                                  G = {z  C : 1 < |z| < 2}.

      (a) Find an orthonormal basis of L2a(G).
      (b) Suppose f  L2a(G) has Laurent series

                                                                            

                                f (z) =  akzk

                                                                     k=-

           for z  G. Find a formula for  f  in terms of . . . , a-1, a0, a1, . . . .

                      Measure, Integration & Real Analysis, by Sheldon Axler
254 Chapter 8 Hilbert Spaces

23  Prove that if  f    L2   (D  \  {0}),  then  f  has a removable singularity at 0 (meaning

                          a
    that f can be extended to a function that is analytic on D).

24 The Dirichlet space D is defined to be the set of analytic functions f : D  C
      such that
                                            | f |2 d2 < .

                                                          D

      For f , g  D, define  f , g to be f (0) g(0) + D f  g d2.
      (a) Show that D is a Hilbert space.
      (b) Show that if w  D, then f  f (w) is a bounded linear functional on D.
      (c) Find an orthonormal basis of D.
      (d) Suppose f  D has Taylor series

                                                        

                                           f (z) =  akzk

                                                       k=0

         for z  D. Find a formula for  f  in terms of a0, a1, a2, . . . .
    (e) Suppose w  D. Find an explicit formula for w  D such that

                                    f (w) =  f , w for all f  D.

25 (a) Prove that the Dirichlet space D is contained in the Bergman space L2a(D).
      (b) Prove that there exists a function f  L2a(D) such that f is uniformly
           continuous on D and f / D.

    Measure, Integration & Real Analysis, by Sheldon Axler
                        Chapter 9

      Real and Complex Measures

A measure is a countably additive function from a -algebra to [0, ]. In this chapter,
we consider countably additive functions from a -algebra to either R or C. The first
section of this chapter shows that these functions, called real measures or complex
measures, form an interesting Banach space with an appropriate norm.
The second section of this chapter focuses on decomposition theorems that help
us understand real and complex measures. These results will lead to a proof that the
                 Lp(µ)                               p
dual  space  of         can  be  identified  with
                                                   L (µ).

   Dome in the main building of the University of Vienna, where Johann Radon
(1887-1956) was a student and then later a faculty member. The Radon-Nikodym

  Theorem, which will be proved in this chapter using Hilbert space techniques,
           provides information analogous to differentiation for measures.

                                                          CC-BY-SA Hubertl

                                                                                                          255
                    Measure, Integration & Real Analysis, by Sheldon Axler
256 Chapter 9 Real and Complex Measures

9A Total Variation

Properties of Real and Complex Measures

Recall that a measurable space is a pair (X, S ), where S is a -algebra on X. Recall
also that a measure on (X, S ) is a countably additive function from S to [0, ] that
takes  to 0. Countably additive functions that take values in R or C give us new
objects called real measures or complex measures.

9.1 Definition countably additive; real measure; complex measure

Suppose (X, S ) is measurable space.

· A function  : S  F is called countably additive if

                                               

 Ek                                       =  (Ek)

    k=1                                       k=1

for every disjoint sequence E1, E2, . . . of sets in S.

· A real measure on (X, S ) is a countably additive function  : S  R.

· A complex measure on (X, S ) is a countably additive function  : S  C.

   The word measure can be ambiguous      The terminology nonnegative
in the mathematical literature. The most
common use of the word measure is as measure would be more appropriate
we defined it in Chapter 2 (see 2.54). than positive measure because the
However, some mathematicians use the function µ : S  F defined by
word measure to include what are here µ(E) = 0 for every E  S is a
called real and complex measures; they positive measure. However, we will
then use the phrase positive measure to stick with tradition and use the
refer to what we defined as a measure in phrase positive measure.
2.54. To help relieve this ambiguity, in this chapter we usually use the phrase
(positive) measure to refer to measures as defined in 2.54. Putting positive in paren-
theses helps reinforce the idea that it is optional while distinguishing such measures
from real and complex measures.

9.2 Example real and complex measures
  · Let  denote Lebesgue measure on [-1, 1]. Define  on the Borel subsets of
     [-1, 1] by
                           (E) =  E  [0, 1] -  E  [-1, 0) .
     Then  is a real measure.

  · If µ1 and µ2 are finite (positive) measures, then µ1 - µ2 is a real measure and
     1µ1 + 2µ2 is a complex measure for all 1, 2  C.

  · If  is a complex measure, then Re  and Im  are real measures.

Measure, Integration & Real Analysis, by Sheldon Axler
                                             Section 9A Total Variation 257

   Note that every real measure is a complex measure. Note also that by definition,
 is not an allowable value for a real or complex measure. Thus a (positive) measure
µ on (X, S) is a real measure if and only if µ(X) < .

   Some authors use the terminology signed measure instead of real measure; some
authors allow a real measure to take on the value  or - (but not both, because the
expression  -  must be avoided). However, real measures as defined here serve
us better because we need to avoid ± when considering the Banach space of real
or complex measures on a measurable space (see 9.18).

   For (positive) measures, we had to make µ() = 0 part of the definition to avoid
the function µ that assigns  to all sets, including the empty set. But  is not an
allowable value for real or complex measures. Thus () = 0 is a consequence of
our definition rather than part of the definition, as shown in the next result.

9.3 absolute convergence for a disjoint union

Suppose  is a complex measure on a measurable space (X, S ). Then
(a) () = 0;

        

(b)  |(Ek)| <  for every disjoint sequence E1, E2, . . . of sets in S.

      k=1

Proof To prove (a), note that , , . . . is a disjoint sequence of sets in S whose
union equals . Thus

                                                                   

                            () =  ().

                                                               k=1

The right side of the equation above makes sense as an element of R or C only when
() = 0, which proves (a).

   To prove (b), suppose E1, E2, . . . is a disjoint sequence of sets in S. First suppose
 is a real measure. Thus

                      Ek  =  (Ek) =  |(Ek)|

        {k : (Ek)>0}           {k : (Ek)>0}    {k : (Ek)>0}

and                   Ek = -  (Ek) =  |(Ek)|.

     -

        {k : (Ek)<0}           {k : (Ek)<0}    {k : (Ek)<0}

Because (E)  R for every E  S, the right side of the last two displayed equations
is finite. Thus k=1|(Ek)| < , as desired.

   Now consider the case where  is a complex measure. Then

                          
         |(Ek)|   |(Re )(Ek)| + |(Im )(Ek)| < ,
        k=1               k=1

where the last inequality follows from applying the result for real measures to the
real measures Re  and Im .

        Measure, Integration & Real Analysis, by Sheldon Axler
258 Chapter 9 Real and Complex Measures

   The next definition provides an important class of examples of real and complex
measures.

9.4 measure determined by an L1-function

Suppose µ is a (positive) measure on a measurable space (X, S ) and h  L1(µ).
Define  : S  F by

                                    (E) = h dµ.

                                                                  E

Then  is a real measure on (X, S ) if F = R and is a complex measure on (X, S )
if F = C.

Proof Suppose E1, E2, . . . is a disjoint sequence of sets in S. Then

                                                               
                    E (x)h(x) dµ(x) = 
9.5  Ek =          k=1 k k=1                  h dµ =  (Ek),

              k=1                           Ek

                                                             k=1

where the first equality holds because the sets E1, E2, . . . are disjoint and the second
equality follows from the inequality

                      m

                      E (x)h(x)  |h(x)|,

                     k=1 k

which along with the assumption that h  L1(µ) allows us to interchange the integral
and limit of the partial sums by the Dominated Convergence Theorem (3.31).

   The countable additivity shown in 9.5 means  is a real or complex measure.

   The next definition simply gives a notation for the measure defined in the previous
result. In the notation that we are about to define, the symbol d has no separate
meaning--it functions to separate h and µ.

  9.6 Definition h dµ
  Suppose µ is a (positive) measure on a measurable space (X, S ) and h  L1(µ).
  Then h dµ is the real or complex measure on (X, S ) defined by

                                   (h dµ)(E) = h dµ.

                                                                         E

   Note that if a function h  L1(µ) takes values in [0, ), then h dµ is a finite
(positive) measure.

   The next result shows some basic properties of complex measures. No proofs
are given because the proofs are the same as the proofs of the corresponding results
for (positive) measures. Specifically, see the proofs of 2.57, 2.61, 2.59, and 2.60.
Because complex measures cannot take on the value , we do not need to worry
about hypotheses of finite measure that are required of the (positive) measure versions
of all but (c).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                    Section 9A Total Variation 259

9.7 properties of complex measures

Suppose  is a complex measure on a measurable space (X, S ). Then

(a) (E \ D) = (E) - (D) for all D, E  S with D  E;

(b) (D  E) = (D) + (E) - (D  E) for all D, E  S;

      

(c)        Ek = lim (Ek)

      k=1             k

for all increasing sequences E1  E2  · · · of sets in S;

      

(d)        Ek = lim (Ek)

      k=1             k

for all decreasing sequences E1  E2  · · · of sets in S.

Total Variation Measure

We use the terminology total variation measure below even though we have not
yet shown that the object being defined is a measure. Soon we will justify this
terminology (see 9.11).

  9.8 Definition total variation measure; ||
  Suppose  is a complex measure on a measurable space (X, S ). The total
  variation measure is the function || : S  [0, ] defined by

        ||(E) = sup |(E1)| + · · · + |(En)| : n  Z+ and E1, . . . , En
                           are disjoint sets in S such that E1  · · ·  En  E .

   To start getting familiar with the definition above, you should verify that if  is a
complex measure on (X, S ) and E  S, then

  · |(E)|  ||(E);
  · ||(E) = (E) if  is a finite (positive) measure;
  · ||(E) = 0 if and only if (A) = 0 for every A  S such that A  E.
   The next result states that for real measures, we can consider only n = 2 in the
definition of the total variation measure.

  9.9 total variation measure of a real measure
  Suppose  is a real measure on a measurable space (X, S ) and E  S. Then
   ||(E) = sup{|(A)| + |(B)| : A, B are disjoint sets in S and A  B  E}.

                      Measure, Integration & Real Analysis, by Sheldon Axler
260 Chapter 9 Real and Complex Measures

Proof Suppose that n  Z+ and E1, . . . , En are disjoint sets in S such that
E1  · · ·  En  E. Let

     A=                Ek and B =                            Ek.

         {k : (Ek)>0}                       {k : (Ek)<0}

Then A, B are disjoint sets in S and A  B  E. Furthermore,

     |(A)| + |(B)| = |(E1)| + · · · + |(En)|.

Thus in the supremum that defines ||(E), we can take n = 2.

   The next result could be rephrased as stating that if h  L1(µ), then the total
variation measure of the measure h dµ is the measure |h| dµ. In the statement below,
the notation d = h dµ means the same as  = h dµ; the notation d is commonly
used when considering expressions involving measures of the form h dµ.

9.10 total variation measure of h dµ

Suppose µ is a (positive) measure on a measurable space (X, S ), h  L1(µ),
and d = h dµ. Then

                                   ||(E) = |h| dµ

                                                                  E

for every E  S.

Proof Suppose that E  S. If E1, . . . , En is a disjoint sequence in S such that
E1  · · ·  En  E, then

n        n                            n
 |(Ek)| =              h dµ   |h| dµ                          |h| dµ.
k=1      k=1  Ek                      k=1 Ek
                                                             E

The inequality above implies that ||(E)  E|h| dµ.
   To prove the inequality in the other direction, first suppose F = R; thus h is a

real-valued function and  is a real measure. Let

A = {x  E : h(x) > 0} and B = {x  E : h(x) < 0}.

Then A and B are disjoint sets in S and A  B  E. We have

   |(A)| + |(B)| = h dµ - h dµ = |h| dµ.
                       A                 B    E

Thus ||(E)  E|h| dµ, completing the proof in the case F = R.
   Now suppose F = C; thus  is a complex measure. Let  > 0. There exists a

simple function g  L1(µ) such that g - h1 <  (by 3.44). There exist disjoint
sets E1, . . . , En  S and c1, . . . , cn  C such that E1  · · ·  En  E and

                                           n

                 g|E =  ckEk.

                                       k=1

   Measure, Integration & Real Analysis, by Sheldon Axler
                                                   Section 9A Total Variation 261

Now

      n                          n
       |(Ek)| =                           h dµ
      k=1                       k=1
                                       Ek

                                 n                 n
                                           g dµ -         (g - h) dµ
                                       Ek          k=1
                                                        Ek
                               k=1

                                 n                 n
                           =  |ck|µ(Ek) -                 (g - h) dµ
                                k=1                k=1
                                                        Ek

                                                n
                           = |g| dµ -  (g - h) dµ
                                 E         k=1 Ek

                                                n
                            |g| dµ -  |g - h| dµ
                                 E         k=1 Ek

                                 |h| dµ - 2.

                                                   E

The inequality above implies that ||(E)  E|h| dµ - 2. Because  is an arbitrary
positive number, this implies ||(E)  E|h| dµ, completing the proof.

   Now we justify the terminology total variation measure.

9.11 total variation measure is a measure

Suppose  is a complex measure on a measurable space (X, S ). Then the total
variation function || is a (positive) measure on (X, S ).

Proof The definition of || and 9.3(a) imply that ||() = 0.
   To show that || is countably additive, suppose A1, A2, . . . are disjoint sets in S.

Fix m  Z+. For each k  {1, . . . , m}, suppose E1,k, . . . , Enk,k are disjoint sets in S
such that

9.12                            E1,k  . . .  Enk,k  Ak.

Then {Ej,k : 1  k  m and 1  j  nk} is a disjoint collection of sets in S that
are all contained in       Ak.  Hence
                      k=1

                           m nk                       
                             |(Ej,k)|  || Ak .
                           k=1 j=1                 k=1

Taking the supremum of the left side of the inequality above over all choices of {Ej,k}
satisfying 9.12 shows that

                           m                       
                            ||(Ak)  || Ak .
                           k=1                     k=1

Because the inequality above holds for all m  Z+, we have

                                                   
                            ||(Ak)  || Ak .
                           k=1                     k=1

      Measure, Integration & Real Analysis, by Sheldon Axler
262 Chapter 9 Real and Complex Measures

To prove the inequality above in the other direction, suppose E1, . . . , En  S are
disjoint sets such that E1  · · ·  En        Ak.   Then
                                        k=1

                                        n
                        ||(Ak)   |(Ej  Ak)|
                       k=1              k=1 j=1

                                       n

                                 =   |(Ej  Ak)|

                                     j=1 k=1

                                       n

                                    (Ej  Ak)

                                     j=1 k=1

                                       n

                                 = |(Ej)|,

                                     j=1

where the first line above follows from the definition of ||(Ak) and the last line
above follows from the countable additivity of .
The inequality above and the definition of ||                 imply that

                                                      k=1 Ak

                                                 
                             ||(Ak)  || Ak ,
                            k=1                  k=1

completing the proof.

The Banach Space of Measures

In this subsection, we make the set of complex or real measures on a measurable
space into a vector space and then into a Banach space.

  9.13 Definition addition and scalar multiplication of measures
  Suppose (X, S ) is a measurable space. For complex measures , µ on (X, S )
  and   F, define complex measures  + µ and  on (X, S ) by

              ( + µ)(E) = (E) + µ(E) and ()(E) =  (E) .
   You should verify that if , µ, and  are as above, then  + µ and  are complex
measures on (X, S ). You should also verify that these natural definitions of addition
and scalar multiplication make the set of complex (or real) measures on a measurable
space (X, S ) into a vector space. We now introduce notation for this vector space.

9.14 Definition MF(S )
Suppose (X, S ) is a measurable space. Then MF(S ) denotes the vector space
of real measures on (X, S ) if F = R and denotes the vector space of complex
measures on (X, S ) if F = C.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                               Section 9A Total Variation 263
   We use the terminology total variation norm below even though we have not yet
shown that the object being defined is a norm (especially because it is not obvious

that  <  for every complex measure ). Soon we will justify this terminology.
  9.15 Definition total variation norm of a complex measure; 
  Suppose  is a complex measure on a measurable space (X, S ). The total
  variation norm of , denoted , is defined by
                                        = ||(X).

9.16 Example total variation norm
  · If µ is a finite (positive) measure, then µ = µ(X), as you should verify.
  · If µ is a (positive) measure, h  L1(µ), and d = h dµ, then  = h1 (as
     follows from 9.10).

   The next result implies that if  is a complex measure on a measurable space
(X, S ), then ||(E) <  for every E  S.

9.17 total variation norm is finite

Suppose (X, S ) is a measurable space and   MF(S ). Then  < .

Proof First consider the case where F = R. Thus  is a real measure on (X, S ). To
begin this proof by contradiction, suppose  = ||(X) = .

   We inductively choose a decreasing sequence E0  E1  E2  · · · of sets in S
as follows: Start by choosing E0 = X. Now suppose n  0 and En  S has been
chosen with ||(En) =  and |(En)|  n. Because ||(En) = , 9.9 implies that
there exists A  S such that A  En and |(A)|  n + 1 + |(En)|, which implies
that

           |(En \ A)| = |(En) - (A)|  |(A)| - |(En)|  n + 1.

Now
                         ||(A) + ||(En \ A) = ||(En) = 

because the total variation measure || is a (positive) measure (by 9.11). The equation
above shows that at least one of ||(A) and ||(En \ A) is . Let En+1 = A
if ||(A) =  and let En+1 = En \ A if ||(A) < . Thus En  En+1,
||(En+1) = , and |(En+1)|  n + 1.
Now 9.7(d) implies that              = limn (En). However, |(En)|  n

                          n=1 En
for each n  Z+, and thus the limit in the last equation does not exist (in R). This
contradiction completes the proof in the case where  is a real measure.
Consider now the case where F = C; thus  is a complex measure on (X, S ).
Then
      ||(X)  |Re |(X) + |Im |(X) < ,

where the last inequality follows from applying the real case to Re  and Im .

      Measure, Integration & Real Analysis, by Sheldon Axler
264 Chapter 9 Real and Complex Measures

   The previous result tells us that if (X, S ) is a measurable space, then  < 
for all   MF(S ). This implies (as the reader should verify) that the total variation
norm · is a norm on MF(S ). The next result shows that this norm makes MF(S )
into a Banach space (in other words, every Cauchy sequence in this norm converges).

9.18 the set of real or complex measures on (X, S ) is a Banach space

Suppose (X, S ) is a measurable space. Then MF(S ) is a Banach space with the
total variation norm.

Proof Suppose 1, 2, . . . is a Cauchy sequence in MF(S ). For each E  S, we
have

                            |j(E) - k(E)| = |(j - k)(E)|
                                                 |j - k|(E)
                                                 j - k.

Thus 1(E), 2(E), . . . is a Cauchy sequence in F and hence converges. Thus we can
define a function  : S  F by

                       (E) = lim j(E).

                                    j

   To show that   MF(S ), we must verify that  is countably additive. To do this,
suppose E1, E2, . . . is a disjoint sequence of sets in S. Let  > 0. Let m  Z+ be
such that

9.19                   j - k   for all j, k  m.

If n  Z+ is such that

                       
                        |m(Ek)|  
9.20

                       k=n

[such an n exists by applying 9.3(b) to m] and if j  m, then

                                                 
       |j(Ek)|   |(j - m)(Ek)| +  |m(Ek)|
      k=n              k=n               k=n

                            

                         |j - m|(Ek) + 

                           k=n

                                              

                       = |j - m| Ek + 

                                            k=n

9.21                    2,

where the second line uses 9.20, the third line uses the countable additivity of the
measure |j - m| (see 9.11), and the fourth line uses 9.19.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                               Section 9A Total Variation 265

If  and n are as in the paragraph above, then

                  n-1                                             n-1

       Ek      -  (Ek)    = lim j Ek                   - lim  j(Ek)

          k=1      k=1         j                           j k=1
                                            k=1

                                        

                          = lim  j(Ek)

                              j k=n

                           2,

where the second line uses the countable additivity of the measure j and the third line
                                                             
uses 9.21. The inequality above implies that           =       ( Ek ),  completing
                                               k=1 Ek     k=1
the proof that   MF(S ).
We still need to prove that limk - k = 0. To do this, suppose  > 0. Let
m  Z+ be such that

9.22                j - k   for all j, k  m.

Suppose k  m. Suppose also that E1, . . . , En  S are disjoint subsets of X. Then

      n                   n
       |( - k)(E)| = lim  |(j - k)(E)|  ,
      =1                  j =1

where the last inequality follows from 9.22 and the definition of the total variation
norm. The inequality above implies that  - k  , completing the proof.

EXERCISES 9A

1 Prove or give a counterexample: If  is a real measure on a measurable
    space (X, S ) and A, B  S are such that (A)  0 and (B)  0, then
    (A  B)  0.

2 Suppose  is a real measure on (X, S ). Define µ : S  [0, ) by

                          µ(E) = |(E)|.

      Prove that µ is a (positive) measure on (X, S ) if and only if the range of  is
      contained in [0, ) or the range of  is contained in (-, 0].

3 Suppose  is a complex measure on a measurable space (X, S ). Prove that
    ||(X) = (X) if and only if  is a (positive) measure.

4 Suppose  is a complex measure on a measurable space (X, S ). Prove that if
    E  S then

      ||(E) = sup    

                     |(Ek)| : E1, E2, . . . is a disjoint sequence in S

                    k=1 

                                   such that E = Ek .

                                                              k=1

      Measure, Integration & Real Analysis, by Sheldon Axler
266 Chapter 9 Real and Complex Measures

 5 Suppose µ is a (positive) measure on a measurable space (X, S ) and h is a
      nonnegative function in L1(µ). Let  be the (positive) measure on (X, S )
      defined by d = h dµ. Prove that

                                            f d = f h dµ

      for all S-measurable functions f : X  [0, ].
 6 Suppose (X, S, µ) is a (positive) measure space. Prove that

                                       {h dµ : h  L1(µ)}
      is a closed subspace of MF(S ).
 7 (a) Suppose B is the collection of Borel subsets of R. Show that the Banach

           space MF(B) is not separable.
      (b) Give an example of a measurable space (X, S ) such that the Banach space

           MF(S ) is infinite-dimensional and separable.
 8 Suppose t > 0 and  is Lebesgue measure on the -algebra of Borel subsets of

      [0, t]. Suppose h : [0, t]  C is the function defined by
                                      h(x) = cos x + i sin x.

      Let  be the complex measure defined by d = h d.
      (a) Show that  = t.
      (b) Show that if E1, E2, . . . is a sequence of disjoint Borel subsets of [0, t], then

                                                               

                                  |(Ek)| < t.

                                                           k=1

      [This exercise shows that the supremum in the definition of ||([0, t]) is not
      attained, even if countably many disjoint sets are allowed.]
 9 Give an example to show that 9.9 can fail if the hypothesis that  is a real
      measure is replaced by the hypothesis that  is a complex measure.
10 Suppose (X, S ) is a measurable space with S = {, X}. Prove that the total
      variation norm on MF(S ) does not come from an inner product. In other
      words, show that there does not exist an inner product ·, · on MF(S ) such
      that  = , 1/2 for all   MF(S ), where · is the usual total variation
      norm on MF(S ).
11 For (X, S ) a measurable space and b  X, define a finite (positive) measure b
      on (X, S) by

                                     b(E) = 1 if b  E, 0 if b / E
      for E  S.
      (a) Show that if b, c  X, then b + c = 2.
      (b) Give an example of a measurable space (X, S ) and b, c  X with b = c

           such that b - c = 2.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                               Section 9B Decomposition Theorems 267

9B Decomposition Theorems

Hahn Decomposition Theorem

The next result shows that a real measure on a measurable space (X, S ) decomposes
X into two disjoint measurable sets such that every measurable subset of one of these
two sets has nonnegative measure and every measurable subset of the other set has
nonpositive measure.

   The decomposition in the result below is not unique because a subset D of X with
||(D) = 0 could be shifted from A to B or from B to A. However, Exercise 1 at
the end of this section shows that the Hahn decomposition is almost unique.

  9.23 Hahn Decomposition Theorem
  Suppose  is a real measure on a measurable space (X, S ). Then there exist sets
  A, B  S such that
  (a) A  B = X and A  B = ;
  (b) (E)  0 for every E  S with E  A;
  (c) (E)  0 for every E  S with E  B.

9.24 Example Hahn decomposition
   Suppose µ is a (positive) measure on a measurable space (X, S ), h  L1(µ) is

real valued, and d = h dµ. Then a Hahn decomposition of the real measure  is
obtained by setting

            A = {x  X : h(x)  0} and B = {x  X : h(x) < 0}.

Proof of 9.23 Let  a = sup{(E) : E  S}.

Thus a   < , where the last inequality comes from 9.17. For each j  Z+, let
Aj  S be such that

9.25 (Aj)  a - 2j1 .

   Temporarily fix k  Z+. We will show by induction on n that if n  Z+ with
n  k, then

                   n n1
9.26                Aj  a -  j .
                        j=k 2
                   j=k

To get started with the induction, note that if n = k then 9.26 holds because in this
case 9.26 becomes 9.25. Now for the induction step, assume that n  k and that 9.26
holds. Then

      Measure, Integration & Real Analysis, by Sheldon Axler
268 Chapter 9 Real and Complex Measures

         n+1  Aj                n      + (An+1) -             n            An+1

                      =  Aj                                      Aj

         j=k                  j=k                            j=k

                                n1                        1
                       a -  j + a - n+1                      -a
                                j=k 2                  2

                              n+1 1

                      = a-  j,

                              j=k 2

where the first line follows from 9.7(b) and the second line follows from 9.25 and
9.26. We have now verified that 9.26 holds if n is replaced by n + 1, completing the
proof by induction of 9.26.

   The sequence of sets Ak, Ak  Ak+1, Ak  Ak+1  Ak+2, . . . is increasing. Thus
taking the limit as n   of both sides of 9.26 and using 9.7(c) gives

                                1
9.27                        Aj  a - k-1 .
                                j=k 2

Now let                                   

                                A=                     Aj.

                                       k=1 j=k

The sequence of sets       Aj,       Aj,  .  .  .  is  decreasing.  Thus  9.27  and  9.7(d)  imply
                      j=1       j=2
that (A)  a. The definition of a now implies that

                                       (A) = a.

   Suppose E  S and E  A. Then (A) = a  (A \ E). Thus we have
(E) = (A) - (A \ E)  0, which proves (b).

   Let B = X \ A; thus (a) holds. Suppose E  S and E  B. Then we have
(A  E)  a = (A). Thus (E) = (A  E) - (A)  0, which proves (c).

Jordan Decomposition Theorem

You should think of two complex or positive measures on a measurable space (X, S )
as being singular with respect to each other if the two measures live on different sets.
Here is the formal definition.

  9.28 Definition singular measures;   µ
  Suppose  and µ are complex or positive measures on a measurable space (X, S ).
  Then  and µ are called singular with respect to each other, denoted   µ, if
  there exist sets A, B  S such that

    · A  B = X and A  B = ;
    · (E) = (E  A) and µ(E) = µ(E  B) for all E  S.

         Measure, Integration & Real Analysis, by Sheldon Axler
                       Section 9B Decomposition Theorems 269

9.29 Example singular measures

Suppose  is Lebesgue measure on the -algebra B of Borel subsets of R.

· Define positive measures , µ on (R, B) by

      (E) =  E  (-, 0) and µ(E) =  E  (2, 3)

for E  B. Then   µ because  lives on (-, 0) and µ lives on [0, ).
Neither  nor µ is singular with respect to .

· Let r1, r2, . . . be a list of the rational numbers. Suppose w1, w2, . . . is a bounded
   sequence of complex numbers. Define a complex measure  on (R, B) by

                       (E) =                 wk
                                                  k
                                   {kZ+ : rkE} 2

for E  B. Then    because  lives on Q and  lives on R \ Q.

   The hard work for proving the next result has already been done in proving the
Hahn Decomposition Theorem (9.23).

9.30 Jordan Decomposition Theorem

· Every real measure is the difference of two finite (positive) measures that are
   singular with respect to each other.

· More precisely, suppose  is a real measure on a measurable space (X, S ).
  Then there exist unique finite (positive) measures + and - on (X, S ) such
   that

9.31                    = + - - and +  -.

Furthermore,           || = + + -.

Proof Let X = A  B be a Hahn decomposition of  as in 9.23. Define functions
+ : S  [0, ) and - : S  [0, ) by

      +(E) = (E  A) and -(E) = -(E  B).

The countable additivity of  implies + and - are finite (positive) measures on
(X, S ), with  = + - - and +  -.
The definition of the total vari- Camille Jordan (1838-1922) is also
ation measure and 9.31 imply that
|| = + + -, as you should verify.  known for certain matrices that are

The equations  = + - - and 0 except along the diagonal and the
|| = + + - imply that              line above it.

                          + = || +  2 and - = || -  2 .
Thus the finite (positive) measures + and - are uniquely determined by  and the
conditions in 9.31.

      Measure, Integration & Real Analysis, by Sheldon Axler
270 Chapter 9 Real and Complex Measures

Lebesgue Decomposition Theorem

The next definition captures the notion of one measure having more sets of measure 0
than another measure.

  9.32 Definition absolutely continuous; 
  Suppose  is a complex measure on a measurable space (X, S ) and µ is a
  (positive) measure on (X, S ). Then  is called absolutely continuous with respect
  to µ, denoted   µ, if

                     (E) = 0 for every set E  S with µ(E) = 0.

9.33 Example absolute continuity
   The reader should verify all the following examples:
  · If µ is a (positive) measure and h  L1(µ), then h dµ  µ.
  · If  is a real measure, then +  || and -  ||.
  · If  is a complex measure, then   ||.
  · If  is a complex measure, then Re   || and Im   ||.
  · Every measure on a measurable space (X, S ) is absolutely continuous with
     respect to counting measure on (X, S ).
   The next result should help you think that absolute continuity and singularity are

two extreme possibilities for the relationship between two complex measures.

  9.34 absolutely continuous and singular implies 0 measure
  Suppose µ is a (positive) measure on a measurable space (X, S ). Then the only
  complex measure on (X, S ) that is both absolutely continuous and singular with
  respect to µ is the 0 measure.
Proof Suppose  is a complex measure on (X, S ) such that   µ and   µ. Thus
there exist sets A, B  S such that A  B = X, A  B = , and (E) = (E  A)
and µ(E) = µ(E  B) for every E  S.
   Suppose E  S. Then

                      µ(E  A) = µ (E  A)  B = µ() = 0.
Because   µ, this implies that (E  A) = 0. Thus (E) = 0. Hence  is the 0
measure.

   Our next result states that a (positive) measure on a measurable space (X, S )
determines a decomposition of each complex measure on (X, S ) as the sum of the
two extreme types of complex measures (absolute continuity and singularity).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 9B Decomposition Theorems 271

9.35 Lebesgue Decomposition Theorem

Suppose µ is a (positive) measure on a measurable space (X, S ).
  · Every complex measure on (X, S ) is the sum of a complex measure
     absolutely continuous with respect to µ and a complex measure singular
     with respect to µ.
  · More precisely, suppose  is a complex measure on (X, S ). Then there exist
     unique complex measures a and s on (X, S ) such that  = a + s and
                                   a  µ and s  µ.

Proof Let  b = sup{||(B) : B  S and µ(B) = 0}.

For each k  Z+, let Bk  S be such that

                   ||( Bk )    b  -  1  and                        µ(Bk) = 0.
                                     k

Let 
                                         B = Bk.

                                                              k=1

Then µ(B) = 0 and ||(B) = b.
   Let A = X \ B. Define complex measures a and s on (X, S ) by

           a(E) = (E  A) and s(E) = (E  B).

Clearly  = a + s.
   If E  S, then

           µ(E) = µ(E  A) + µ(E  B) = µ(E  A),

where the last equality holds because µ(B) = 0. The equation above implies that
s  µ.

   To prove that a  µ, suppose E  S and µ(E) = 0. Then µ(B  E) = 0 and
hence

              b  ||(B  E) = ||(B) + ||(E \ B) = b + ||(E \ B),
which implies that ||(E \ B) = 0. Thus

  a(E) = (E  A) = (E \ B) = 0,          The construction of a and s shows
which implies that a  µ.                that if  is a positive (or real)
                                        measure, then so are a and s.

   We have now proved all parts of this result except the uniqueness of the Lebesgue
decomposition. To prove the uniqueness, suppose 1 and 2 are complex measures
on (X, S ) such that 1  µ, 2  µ, and  = 1 + 2. Then

                                     1 - a = s - 2.
The left side of the equation above is absolutely continuous with respect to µ and the
right side is singular with respect to µ. Thus both sides are both absolutely continuous
and singular with respect to µ. Thus 9.34 implies that 1 = a and 2 = s.

           Measure, Integration & Real Analysis, by Sheldon Axler
 100e Chapter 9 Real and Complex Measures

Radon-Nikodym Theorem

If µ is a (positive) measure, h  L1(µ), The result below was first proved by
and d = h dµ, then   µ. The next Radon and Otto Nikodym
result gives the important converse--if µ (1887-1974).
is -finite, then every complex measure
that is absolutely continuous with respect to µ is of the form h dµ for some h  L1(µ).
The hypothesis that µ is -finite cannot be deleted.

9.36 Radon-Nikodym Theorem

Suppose µ is a (positive) -finite measure on a measurable space (X, S ). Suppose
 is a complex measure on (X, S ) such that   µ. Then there exists h  L1(µ)
such that d = h dµ.

Proof First consider the case where both µ and  are finite (positive) measures.
Define  : L2( + µ)  R by

9.37                        ( f ) = f d.

To show that  is well defined, first note that if f  L2( + µ), then

9.38 | f | d  | f | d( + µ)  (X) + µ(X) 1/2 f L2(+µ) < ,

where the middle inequality follows from Hölder's inequality (7.9) applied to the
functions 1 and f . Now 9.38 shows that f d makes sense for f  L2( + µ).
Furthermore, if two functions in L2( + µ) differ only on a set of ( + µ)-measure
0, then they differ only on a set of -measure 0. Thus  as defined in 9.37 makes
sense as a linear functional on L2( + µ).
Because |( f )|  | f | d, 9.38 The clever idea of using Hilbert
shows that  is a bounded linear func-
      2                                    space techniques in this proof comes
tional on L ( + µ). The Riesz Represen- from John von Neumann
tation Theorem (8.47) now implies that
                                           (1903-1957).
                             2
there exists g  L ( + µ) such that

                            f d = f g d( + µ)

for all f  L2( + µ). Hence

9.39                        f (1 - g) d = f g dµ

for all f  L2( + µ).
   If f equals the characteristic function of {x  X : g(x)  1}, then the left side

of 9.39 is less than or equal to 0 and the right side of 9.39 is greater than or equal to
0; hence both sides are 0. Thus f g dµ = 0, which implies (with this choice of f )
that µ({x  X : g(x)  1}) = 0.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 9B Decomposition Theorems 273

   Similarly, if f equals the characteristic function of {x  X : g(x) < 0}, then the
left side of 9.39 is greater than or equal to 0 and the right side of 9.39 is less than
or equal to 0; hence both sides are 0. Thus f g dµ = 0, which implies (with this
choice of f ) that µ({x  X : g(x) < 0}) = 0.

   Because   µ, the two previous paragraphs imply that

      ({x  X : g(x)  1}) = 0 and ({x  X : g(x) < 0}) = 0.

Thus  we  can  modify  g  (for  example   by  redefining  g  to  be  1  on  the  two  sets  appearing
                                                                     2
above; both those sets have -measure 0 and µ-measure 0) and from now on we can
assume that 0  g(x) < 1 for all x  X and that 9.39 holds for all f  L2( + µ).
Hence we can define h : X  [0, ) by

                                     h(x) = g(x) 1 - g(x) .

Suppose E  S. For each k  Z+, let                  Taking f = E/(1 - g) in 9.39
                                                   would give (E) = E h dµ, but this
           E(x)               E(x)                 function f might not be in
f (x) = 1-g(x)                                     L2( + µ) and thus we need to be a
k 0                       if 1-g(x)  k,            bit more careful.

                          otherwise.

Then fk  L2( + µ). Now 9.39 implies

                                   fk(1 - g) d = fkg dµ.

Taking the limit as k   and using the Monotone Convergence Theorem (3.11)
shows that

9.40                                 E    1 d = h dµ.
                                                   E

Thus d = h dµ, completing the proof in the case where both  and µ are (positive)
finite measures [note that h  L1(µ) because h is a nonnegative function and we can
take E = X in the equation above].
Now relax the assumption on µ to the hypothesis that µ is a -finite measure.
Thus there exists an increasing sequence X1  X2  · · · of sets in S such that
      Xk       X  and  µ(Xk)         for  each  k     Z+.  For   k      Z+,  let      and       denote
k=1       =                     <                                                 k         µk

the restrictions of  and µ to the -algebra on Xk consisting of those sets in S that
are subsets of Xk. Then k  µk. Thus by the case we have already proved, there
exists a nonnegative function hk  L1(µk) such that dk = hk dµk. If j < k, then

                                 E hj dµ = (E) = E hk dµ
for every set E  S with E  Xj; thus µ({x  Xj : hj(x) = hk(x)}) = 0. Hence
there exists an S-measurable function h : X  [0, ) such that

                            µ {x  Xk : h(x) = hk(x)} = 0
for every k  Z+. The Monotone Convergence Theorem (3.11) can now be used to
show that 9.40 holds for every E  S. Thus d = h dµ, completing the proof in the
case where  is a (positive) finite measure.

                  Measure, Integration & Real Analysis, by Sheldon Axler
274 Chapter 9 Real and Complex Measures

   Now relax the assumption on  to the assumption that  is a real measure. The
measure  equals one-half the difference of the two (positive) finite measures || + 
and || - , each of which is absolutely continuous with respect to µ. By the case
proved in the previous paragraph, there exist h+, h-  L1(µ) such that

                   d(|| + ) = h+ dµ and d(|| - ) = h- dµ.
Taking h = 12 (h+ - h-), we have d = h dµ, completing the proof in the case
where  is a real measure.

   Finally, if  is a complex measure, apply the result in the previous paragraph to the
real measures Re , Im , producing hRe, hIm  L1(µ) such that d(Re ) = hRe dµ
and d(Im ) = hIm dµ. Taking h = hRe + ihIm, we have d = h dµ, completing
the proof in the case where  is a complex measure.

The function h provided by the Radon-Nikodym Theorem is unique up to changes
on sets with µ-measure 0. If we think of h as an element of L1(µ) instead of L1(µ),
then the choice of h is unique.
When        h dµ,  the  notation  h     d   is  used  by  some  authors,  and  h  is  called
      d  =                           =  dµ

the Radon-Nikodym derivative of  with respect to µ.
The next result is a nice consequence of the Radon-Nikodym Theorem.

  9.41 if  is a complex measure, then d = h d|| for some h with |h(x)| = 1
  (a) Suppose  is a real measure on a measurable space (X, S ). Then there exists

       an S-measurable function h : X  {-1, 1} such that d = h d||.
  (b) Suppose  is a complex measure on a measurable space (X, S ). Then there

       exists an S-measurable function h : X  {z  C : |z| = 1} such that
       d = h d||.
Proof Because   ||, the Radon-Nikodym Theorem (9.36) tells us that there
exists h  L1(||) (with h real valued if  is a real measure) such that d = h d||.
Now 9.10 implies that d|| = |h| d||, which implies that |h| = 1 almost everywhere
(with respect to ||). Redefine h to be 1 on the set {x  X : |h(x)| = 1}, which
gives the desired result.
   We could have proved (a) of the result above by taking h = A - B in the Hahn
Decomposition Theorem (9.23).
   Conversely, we could give a new proof of the Hahn Decomposition Theorem by
using (a) of the result above and taking

           A = {x  X : h(x) = 1} and B = {x  X : h(x) = -1}.
We could also give a new proof of the Jordan Decomposition Theorem (9.30) by
using (a) of the result above and taking

          + = {x  X : h(x) = 1} d|| and - = {x  X : h(x) = -1} d||.

            Measure, Integration & Real Analysis, by Sheldon Axler
                                                  Section 9B Decomposition Theorems 275

Dual Space of Lp(µ)

Recall that the dual space of a normed vector space V is the Banach space of bounded
linear functionals on V; the dual space of V is denoted by V. Recall also that if
1     p     , then the dual exponent              p    is defined by the equation             1     1     1.
                                                                                              p  +  p  =

   The dual space of p can be identified with p for 1  p < , as we saw in 7.26.
We are now ready to prove the analogous result for an arbitrary (positive) measure,
                                         Lp(µ)            p
identifying        the  dual  space  of           with             [with    the  mild  restriction        that  µ   is
                                                        L (µ)
-finite if p = 1]. In the special case where µ is counting measure on Z+, this new
result reduces to the previous result about p.
   For 1 < p < , the next result differs from 7.25 by only one word, with "to" in
7.25 changed to "onto" below. Thus we already know (and will use in the proof)
                                                                                           p     Lp(µ)  and that

that the map h  h is a one-to-one linear map from L (µ) to
                                     p
h = hp for all h  L (µ). The new aspect of the result below is the assertion
                                                       Lp(µ)                                                   p
that  every     bounded  linear   functional      on           is  of  the  form  h   for     some     h  
                                                                                                             L (µ).
The key tool we use in proving this new assertion is the Radon-Nikodym Theorem.

   9.42     dual   space      of  Lp(µ)  is      p

                                               L (µ)

   Suppose µ is a (positive) measure and 1  p <  [with the additional hypothesis
                                                                     p                           Lp(µ)
   that  µ  is  a  -finite    measure  if  p   =  1].  For  h               define    h :                    F  by
                                                                   L (µ),

                                               h( f ) = f h dµ.

                                                                                   p   Lp(µ)              Further-

   Then h  h is a one-to-one linear map from L (µ) onto                                             .

   more, h = hp for all h  L (µ).                 p

Proof The case p = 1 is left to the reader as an exercise. Thus assume that
1 < p < .
   Suppose µ is a (positive) measure on a measurable space (X, S ) and  is a
                                                                                                          
bounded linear functional on Lp(µ); in other words, suppose                                      Lp(µ)
                                                                                                          .
   Consider first the case where µ is a finite (positive) measure. Define a function
 : S  F by
                                               (E) = (E).

If E1, E2, . . . are disjoint sets in S, then

                                                                                                 
                                                                   =  (Ek) =  (Ek),
          Ek            =                      =   Ek                  k=1                    k=1

             k=1                       k=1 Ek           k=1

where the infinite sum in the third term converges in the Lp(µ)-norm to   E , and

                                                                                                                                                                             k=1 k

the third equality holds because  is a continuous linear functional. The equation
above shows that  is countably additive. Thus  is a complex measure on (X, S )
[and is a real measure if F = R].

                        Measure, Integration & Real Analysis, by Sheldon Axler
276 Chapter 9 Real and Complex Measures

   If E  S and µ(E) = 0, then E is the 0 element of Lp(µ), which implies that
(E) = 0, which means that (E) = 0. Hence   µ. By the Radon-Nikodym
Theorem (9.36), there exists h  L1(µ) such that d = h dµ. Hence

                         (E) = (E) = E h dµ = Eh dµ
for every E  S. The equation above, along with the linearity of , implies that

9.43 ( f ) = f h dµ for every simple S-measurable function f : X  F.

   Because every bounded S-measurable function is the uniform limit on X of a
sequence of simple S-measurable functions (see 2.89), we can conclude from 9.43
that

9.44               ( f ) = f h dµ for every f  L(µ).

For k  Z+, let     Ek = {x  X : 0 < |h(x)|  k}

and define fk  Lp(µ) by

9.45 fk(x) = h(x) |h(x)|p-2 if x  Ek,0
                                                        otherwise.

Now

           |h|p Ek dµ = ( fk)    fkp =  |h|p Ek dµ 1/p,

where the first equality follows from 9.44 and 9.45, and the last equality follows from
9.45 [which implies that | fk(x)|p = |h(x)|p Ek(x) for x  X]. Taking the limit as
k   shows, via the Monotone Convergence Theorem (3.11), that

                                     p              p/p
                            hp   hp ,

which implies (using the equation p - p/p = 1) that

                                     hp  .

Thus  h      p     Because  each  f     Lp(µ)  can  be  approximated  in  the  Lp(µ)  norm

           L (µ).
by functions in L(µ), 9.44 now shows that  = h, completing the proof in the
case where µ is a finite (positive) measure.
Now relax the assumption that µ is a finite (positive) measure to the hypothesis
that µ is a (positive) measure. For E  S, let SE = {A  S : A  E} and let µE
be the (positive) measure on (E, SE) defined by µE(A) = µ(A) for A  SE. We
can identify Lp(µE) with the subspace of functions in Lp(µ) that vanish (almost
everywhere) outside E. With this identification, let E = |Lp(µE). Then E is a
bounded linear functional on Lp(µE) and E  .

           Measure, Integration & Real Analysis, by Sheldon Axler
                                         Section 9B Decomposition Theorems 277

   If E  S and µ(E) < , then the finite measure case that we have already proved

                                                                                            p

as applied to E implies that there exists a unique hE  L (µE) such that

9.46                 ( f ) = f hE dµ for all f  Lp(µE).
                                 E

If D, E  S and D  E with µ(E) < , then hD(x) = hE(x) for almost every
x  D (use the uniqueness part of the result).

   For each k  Z+, there exists fk  Lp(µ) such that

9.47                  fkp  1             and   |(        fk)|   >         -    1.

                                                                               k

The Dominated Convergence Theorem (3.31) implies that

                     lim     fk{x        X  :  | fk(x)|  >  1}  -     fk  p=0

                     n                                      n

for each k  Z+. Thus we can replace fk by fk{x  X : | fk(x)| > 1 } for sufficiently
                                                                                                                                                               n

large n and still have 9.47 hold. In other words, for each k  Z+, we can assume that
there exists nk  Z+ such that for each x  X, either | fk(x)| > 1/nk or fk(x) = 0.

   Set Dk = {x  X : | fk(x)| > 1/nk}. Then µ(Dk) <  [because fk  Lp(µ)]
and

9.48                      fk(x) = 0 for all x  X \ Dk.

   For k  Z+, let Ek = D1  · · ·  Dk. Because E1  E2  · · · , we see that if
j < k, then hEj (x) = hEk (x) for almost every x  Ej. Also, 9.47 and 9.48 imply
that

9.49                 lim hEk p = lim Ek  = .
                     k                         k

Let E =         Ek.  Let  h  be  the  function  that        equals        hEk  almost  everywhere  on  Ek
         k=1
for each k  Z+ and equals 0 on X \ E. The Monotone Convergence Theorem and
9.49 show that
                                      hp = .

   If f  Lp(µE), then limk f - f Ekp = 0 by the Dominated Convergence
Theorem. Thus if f  Lp(µE), then

9.50     ( f ) = lim ( f E ) = lim f E h dµ = f h dµ,
                     k                k        k                   k

where the first equality follows from the continuity of , the second equality follows
from 9.46 as applied to each Ek [valid because µ(Ek) < ], and the third equality
follows from the Dominated Convergence Theorem.

   If D is an S-measurable subset of X \ E with µ(D) < , then hDp = 0
because otherwise we would have h + hDp > hp and the linear functional on
Lp(µ) induced by h + hD would have norm larger than  even though it agrees
with  on Lp(µED). Because hDp = 0, we see from 9.50 that ( f ) = f h dµ
for all f  Lp(µED).

   Every element of Lp(µ) can be approximated in norm by elements of Lp(µE)
plus functions that live on subsets of X \ E with finite measure. Thus the previous
paragraph implies that ( f ) = f h dµ for all f  Lp(µ), completing the proof.

                Measure, Integration & Real Analysis, by Sheldon Axler
278 Chapter 9 Real and Complex Measures

EXERCISES 9B

 1 Suppose  is a real measure on a measurable space (X, S ). Prove that the Hahn
      decomposition of  is almost unique, in the sense that if A, B and A, B are
      pairs satisfying the Hahn Decomposition Theorem (9.23), then
               ||(A \ A) = ||(A \ A) = ||(B \ B) = ||(B \ B) = 0.

 2 Suppose µ is a (positive) measure and g, h  L1(µ). Prove that g dµ  h dµ if
     and only if g(x)h(x) = 0 for almost every x  X.

 3 Suppose  and µ are complex measures on a measurable space (X, S ). Show
      that the following are equivalent.
     (a)   µ.
     (b) ||  |µ|.
     (c) Re   µ and Im   µ.

 4 Suppose  and µ are complex measures on a measurable space (X, S ). Prove
     that if   µ, then | + µ| = || + |µ| and  + µ =  + µ.

 5 Suppose  and µ are finite (positive) measures on a measurable space (X, S ).
     Prove that   µ if and only if  - µ =  + µ.

 6 Suppose µ is a complex or positive measure on a measurable space (X, S ).
      Prove that
                                     {  MF(S) :   µ}
     is a closed subspace of MF(S ).

 7 Use the Cantor set to prove that there exists a (positive) measure  on (R, B)
     such that    and (R) = 0 but ({x}) = 0 for every x  R; here 
     denotes Lebesgue measure on the -algebra B of Borel subsets of R.
      [The second bullet point in Example 9.29 does not provide an example of the
     desired behavior because in that example, ({rk}) = 0 for all k  Z+ with
     wk = 0.]

 8 Suppose  is a real measure on a measurable space (X, S ). Prove that
                          +(E) = sup{(D) : D  S and D  E}

      and
                         -(E) = - inf{(D) : D  S and D  E}

     for all E  S.
 9 Suppose µ is a (positive) finite measure on a measurable space (X, S ) and h is a

     nonnegative function in L1(µ). Thus h dµ  dµ. Find a reasonable condition
     on h that is equivalent to the condition dµ  h dµ.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                Section 9B Decomposition Theorems 279

10 Suppose µ is a (positive) measure on a measurable space (X, S ) and  is a
      complex measure on (X, S ). Show that the following are equivalent.
      (a)   µ.
      (b) ||  µ.
      (c) Re   µ and Im   µ.

11 Suppose µ is a (positive) measure on a measurable space (X, S ) and  is a real
      measure on (X, S ). Show that   µ if and only if +  µ and -  µ.

12 Suppose µ is a (positive) measure on a measurable space (X, S ). Prove that
                                     {  MF(S) :   µ}

      is a closed subspace of MF(S ).
13 Give an example to show that the Radon-Nikodym Theorem (9.36) can fail if

      the -finite hypothesis is eliminated.
14 Suppose µ is a (positive) -finite measure on a measurable space (X, S ) and 

      is a complex measure on (X, S ). Show that the following are equivalent.
      (a)   µ.
      (b) For every  > 0, there exists  > 0 such that |(E)| <  for every set

           E  S with µ(E) < .
      (c) For every  > 0, there exists  > 0 such that ||(E) <  for every set

           E  S with µ(E) < .
15 Prove 9.42 [with the extra hypothesis that µ is a -finite (positive) measure] in

      the case where p = 1.
16 Explain where the proof of 9.42 fails if p = .
17 Prove that if µ is a (positive) measure and 1 < p < , then Lp(µ) is reflexive.

      [See the definition before Exercise 19 in Section 7B for the meaning of reflexive.]
18 Prove that L1(R) is not reflexive.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                     Chapter 10

 Linear Maps on Hilbert Spaces

A special tool called the adjoint helps provide insight into the behavior of linear maps
on Hilbert spaces. This chapter begins with a study of the adjoint and its connection
to the null space and range of a linear map.

   Then we discuss various issues connected with the invertibility of operators on
Hilbert spaces. These issues lead to the spectrum, which is a set of numbers that
gives important information about an operator.

   This chapter then looks at special classes of operators on Hilbert spaces: self-
adjoint operators, normal operators, isometries, unitary operators, integral operators,
and compact operators.

   Even on infinite-dimensional Hilbert spaces, compact operators display many
characteristics expected from finite-dimensional linear algebra. We will see that
the powerful Spectral Theorem for compact operators greatly resembles the finite-
dimensional version. Also, we develop the Singular Value Decomposition for an
arbitrary compact operator, again quite similar to the finite-dimensional result.

   The Botanical Garden at Uppsala University (the oldest university in Sweden,
 founded in 1477), where Erik Fredholm (1866-1927) was a student. The theorem

    called the Fredholm Alternative, which we prove in this chapter, states that a
     compact operator minus a nonzero scalar multiple of the identity operator

                           is injective if and only if it is surjective.

                                                        CC-BY-SA Per Enström

                                                                                                            280
                     Measure, Integration & Real Analysis, by Sheldon Axler
                              Section 10A Adjoints and Invertibility 281

10A Adjoints and Invertibility

Adjoints of Linear Maps on Hilbert Spaces

The next definition provides a key tool for studying linear maps on Hilbert spaces.

10.1 Definition adjoint; T
Suppose V and W are Hilbert spaces and T : V  W is a bounded linear map.
The adjoint of T is the function T : W  V such that

                                  T f , g =  f , Tg
for every f  V and every g  W.

   To see why the definition above makes   The word adjoint has two unrelated
sense, fix g  W. Consider the linear       meanings in linear algebra. We need
functional on V defined by f  T f , g.     only the meaning defined above.
This linear functional is bounded because

      |T f , g|  T f  g  T g  f 

for all f  V; thus the linear functional f  T f , g has norm at most T g. By
the Riesz Representation Theorem (8.47), there exists a unique element of V (with
norm at most T g) such that this linear functional is given by taking the inner
product with it. We call this unique element Tg. In other words, Tg is the unique
element of V such that

10.2                          T f , g =  f , Tg

for every f  V. Furthermore,

10.3                          Tg  Tg.

In 10.2, notice that the inner product on the left is the inner product in W and the
inner product on the right is the inner product in V.

10.4 Example multiplication operators
   Suppose (X, S, µ) is a measure space and h  L(µ). Define the multiplication

operator Mh : L2(µ)  L2(µ) by

                              Mh f = f h.

Then Mh is a bounded linear map and Mh  h. Because

  Mh f , g = f hg dµ =  f , Mhg            The complex conjugates that appear
for all f , g  L2(µ), we have Mh = Mh.     in this example are unnecessary (but
                                           they do no harm) if F = R.

      Measure, Integration & Real Analysis, by Sheldon Axler
282 Chapter 10 Linear Maps on Hilbert Spaces

10.5 Example linear maps induced by integration
   Suppose (X, S, µ) and (Y, T , ) are -finite measure spaces and K  L2(µ × ).

Define a linear map IK : L2()  L2(µ) by

10.6 (IK f )(x) = Y K(x, y) f (y) d(y)
for f  L2() and x  X. To see that this definition makes sense, first note that
there are no worrisome measurability issues because for each x  X, the function
y  K(x, y) is a T -measurable function on Y (see 5.9).

   Suppose f  L2(). Use the Cauchy-Schwarz inequality (8.11) or Hölder's
inequality (7.9) to show that

10.7 |K(x, y)| | f (y)| d(y)  |K(x, y)|2 d(y) 1/2 f L2().
      Y                                           Y

for every x  X. Squaring both sides of the inequality above and then integrating on
X with respect to µ gives

                                               2     X Y|K(x, y)|2 d(y) dµ(x)  f 2L2()

      |K(x, y)| | f (y)| d(y) dµ(x) 

XY

                        =                         K22           f    2

                                                        L (µ×)     L2(),

where the last line holds by Tonelli's Theorem (5.28). The inequality above implies
that the integral on the left side of 10.7 is finite for µ-almost every x  X. Thus
the integral in 10.6 makes sense for µ-almost every x  X. Now the last inequality
above shows that

            IK f 2L2(µ) = X|(IK f )(x)|2 dµ(x)  K2L2(µ×) f 2L2().
Thus IK is a bounded linear map from L2() to L2(µ) and

10.8                    IK  KL2(µ×).

Define K : Y × X  F by

                        K(y, x) = K(x, y),

and note that K  L2( × µ). Thus IK : L2(µ)  L2() is a bounded linear map.
Using Tonelli's Theorem (5.28) and Fubini's Theorem (5.32), we have

         IK f , g = X Y K(x, y) f (y) d(y) g(x) dµ(x)

         = f (y) K(x, y) g(x) dµ(x) d(y)
         Y              X

         = Y f (y) (IK g)(y) d(y) =  f , IK g

for all f  L2() and all g  L2(µ). Thus

10.9                    (IK) = IK.

         Measure, Integration & Real Analysis, by Sheldon Axler
     Section 10A Adjoints and Invertibility 283

10.10 Example linear maps induced by matrices
   As a special case of the previous example, suppose m, n  Z+, µ is counting

measure on {1, . . . , m},  is counting measure on {1, . . . , n}, and K is an m-by-n
matrix with entry K(i, j)  F in row i, column j. In this case, the linear map
IK : L2()  L2(µ) induced by integration is given by the equation

                                                                   n

                        (IK f )(i) =  K(i, j) f (j)

                                                              j=1

for f  L2(). If we identify L2() and L2(µ) with Fn and Fm and then think of
elements of Fn and Fm as column vectors, then the equation above shows that the
linear map IK : Fn  Fm is simply matrix multiplication by K.

   In this setting, K is called the conjugate transpose of K because the n-by-m
matrix K is obtained by interchanging the rows and the columns of K and then
taking the complex conjugate of each entry.

   The previous example now shows that

     mn       1/2
      |K(i, j)|2 .
IK   i=1 j=1

Furthermore, the previous example shows that the adjoint of the linear map of
multiplication by the matrix K is the linear map of multiplication by the conjugate
transpose matrix K, a result that may be familiar to you from linear algebra.

   If T is a bounded linear map from a Hilbert space V to a Hilbert space W, then
the adjoint T has been defined as a function from W to V. We now show that the
adjoint T is linear and bounded. Recall that B(V, W) denotes the Banach space of
bounded linear maps from V to W.

10.11 T is a bounded linear map
Suppose V and W are Hilbert spaces and T  B(V, W). Then

               T  B(W, V), (T) = T, and T = T.

Proof Suppose g1, g2  W. Then
             f , T(g1 + g2) = T f , g1 + g2 = T f , g1 + T f , g2
                                                      =  f , Tg1 +  f , Tg2
                                                      =  f , Tg1 + Tg2

for all f  V. Thus T(g1 + g2) = Tg1 + Tg2.
   Suppose   F and g  W. Then
           f , T(g) = T f , g = T f , g =  f , Tg =  f , Tg

for all f  V. Thus T(g) = Tg.
   We have now shown that T : W  V is a linear map. From 10.3, we see that T

is bounded. In other words, T  B(W, V).

                     Measure, Integration & Real Analysis, by Sheldon Axler
284 Chapter 10 Linear Maps on Hilbert Spaces

   Because T  B(W, V), its adjoint (T) : V  W is defined. Suppose f  V.
Then

           (T) f , g = g, (T) f  = Tg, f  =  f , Tg = T f , g
for all g  W. Thus (T) f = T f , and hence (T) = T.

   From 10.3, we see that T  T. Applying this inequality with T replaced
by T we have

                            T  T = (T)  T.
Because the first and last terms above are the same, the first inequality must be an
equality. In other words, we have T = T.

   Parts (a) and (b) of the next result show that if V and W are real Hilbert spaces,
then the function T  T from B(V, W) to B(W, V) is a linear map. However,
if V and W are nonzero complex Hilbert spaces, then T  T is not a linear map
because of the complex conjugate in (b).

10.12 properties of the adjoint

Suppose V, W, and U are Hilbert spaces. Then
(a) (S + T) = S + T for all S, T  B(V, W);
(b) (T) =  T for all   F and all T  B(V, W);
(c) I = I, where I is the identity operator on V;
(d) (S  T) = T  S for all T  B(V, W) and S  B(W, U).

Proof

(a) The proof of (a) is left to the reader as an exercise.
(b) Suppose   F and T  B(V, W). If f  V and g  W, then

              f , (T)g = T f , g = T f , g =  f , Tg =  f ,  Tg.

Thus (T)g =  Tg, as desired.

(c) If f , g  V, then   f , Ig = I f , g =  f , g.

Thus Ig = g, as desired.

(d) Suppose T  B(V, W) and S  B(W, U). If f  V and g  U, then

 f , (S  T)g = (S  T) f , g = S(T f ), g = T f , Sg =  f , T(Sg).

Thus (S  T)g = T(Sg) = (T  S)(g). Hence (S  T) = T  S, as
desired.

       Measure, Integration & Real Analysis, by Sheldon Axler
       Section 10A Adjoints and Invertibility 285

Null Spaces and Ranges in Terms of Adjoints

The next result shows the relationship between the null space and the range of a linear
map and its adjoint. The orthogonal complement of each subset of a Hilbert space is
closed [see 8.40(a)]. However, the range of a bounded linear map on a Hilbert space
need not be closed (see Example 10.15 or Exercises 9 and 10 for examples). Thus in
parts (b) and (d) of the result below, we must take the closure of the range.

10.13 null space and range of T

Suppose V and W are Hilbert spaces and T  B(V, W). Then
(a) null T = (range T);
(b) range T = (null T);
(c) null T = (range T);
(d) range T = (null T).

Proof  We begin by proving (a). Let g  W. Then

                   g  null T  Tg = 0
                                    f , Tg = 0 for all f  V
                                   T f , g = 0 for all f  V
                                   g  (range T).

Thus null T = (range T), proving (a).
   If we take the orthogonal complement of both sides of (a), we get (d), where we

have used 8.41. Replacing T with T in (a) gives (c), where we have used 10.11.
Finally, replacing T with T in (d) gives (b).

   As a corollary of the result above, we have the following result, which gives a
useful way to determine whether or not a linear map has a dense range.

  10.14 necessary and sufficient condition for dense range
  Suppose V and W are Hilbert spaces and T  B(V, W). Then T has dense range
  if and only if T is injective.
Proof From 10.13(d) we see that T has dense range if and only if (null T) = W,
which happens if and only if null T = {0}, which happens if and only if T is
injective.
   The advantage of using the result above is that to determine whether or not a
bounded linear map T between Hilbert spaces has a dense range, we need only
determine whether or not 0 is the only solution to the equation Tg = 0. The next
example illustrates this procedure.

                     Measure, Integration & Real Analysis, by Sheldon Axler
286 Chapter 10 Linear Maps on Hilbert Spaces

10.15 Example Volterra operator
   The Volterra operator is the linear map V : L2([0, 1])  L2([0, 1]) defined by

                                                                       x

                                  (V f )(x) = 0 f (y) dy
for f  L2([0, 1]) and x  [0, 1]; here dy means d(y), where  is the usual
Lebesgue measure on the interval [0, 1].

   To show that V is a bounded linear map from L2([0, 1]) to L2([0, 1]), let K be the
function on [0, 1] × [0, 1] defined by

       K(x, y) = 1 if x > y, 0 if x  y.

In other words, K is the characteristic  Vito Volterra (1860-1940) was a
function of the open triangle below the
diagonal of the unit square. Clearly pioneer in developing functional
K  L2( × ) and V = IK as defined analytic techniques to study integral
in 10.6. Thus V is a bounded linear map equations.
from L2([0, 1]) to L2([0, 1]) and V   12 (by 10.8).
Let K(y, x) = K(x, y). Then K is the characteristic function of the open
triangle above the diagonal of the unit square and V  = IK (see 10.9). Thus

       1                                    1           x
       (V f )(x) = f (y) dy = f (y) dy - f (y) dy
10.16  x                                 0           0

for f  L2([0, 1]) and x  [0, 1].
   Now we can show that V  is injective. To do this, suppose f  L2([0, 1]) and

V  f = 0. Differentiating both sides of 10.16 with respect to x and using the Lebesgue
Differentiation Theorem (4.19), we conclude that f = 0. Hence V  is injective. Thus
the Volterra operator V has dense range (by 10.14).

   Although range V is dense in L2([0, 1]), it does not equal L2([0, 1]) (because
every element of range V is a continuous function on [0, 1] that vanishes at 0). Thus
the Volterra operator V has dense but not closed range in L2([0, 1]).

Invertibility of Operators

Linear maps from a vector space to itself are so important that they get a special name
and special notation.

  10.17 Definition operator; B(V)
    · An operator is a linear map from a vector space to itself.
    · If V is a normed vector space, then B(V) denotes the normed vector space
       of bounded operators on V. In other words, B(V) = B(V, V).

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                 Section 10A Adjoints and Invertibility 287

  10.18 Definition invertible; T-1
    · An operator T on a vector space V is called invertible if T is a one-to-one
       and surjective linear map of V onto V.
    · Equivalently, an operator T : V  V is invertible if and only if there exists
       an operator T-1 : V  V such that T-1  T = T  T-1 = I.
   The second bullet point above is equivalent to the first bullet point because if

a linear map T : V  V is one-to-one and surjective, then the inverse function
T-1 : V  V is automatically linear (as you should verify).

   Also, if V is a Banach space and T is a bounded operator on V that is invertible,
then the inverse T-1 is automatically bounded, as follows from the Bounded Inverse
Theorem (6.83).

   The next result shows that inverses and adjoints work well together. In the proof,
we use the common convention of writing composition of linear maps with the same
notation as multiplication. In other words, if S and T are linear maps such that S  T
makes sense, then from now on

                                         ST = S  T.

  10.19 inverse of the adjoint equals adjoint of the inverse
  A bounded operator T on a Hilbert space is invertible if and only if T is invertible.
  Furthermore, if T is invertible, then (T)-1 = (T-1).
Proof First suppose T is invertible. Taking the adjoint of all three sides of the
equation T-1T = TT-1 = I, we get

                               T(T-1) = (T-1)T = I,
which implies that T is invertible and (T)-1 = (T-1).

   Now suppose T is invertible. Then by the direction just proved, (T) is invert-
ible. Because (T) = T, this implies that T is invertible, completing the proof.

   Norms work well with the composition of linear maps, as shown in the next result.

  10.20 norm of a composition of linear maps
  Suppose U, V, W are normed vector spaces, T  B(U, V), and S  B(V, W).
  Then

                                     ST  S T.
Proof If f  U, then

                (ST)( f ) = S(T f )  S T f   S T  f .
Thus ST  S T, as desired.

                     Measure, Integration & Real Analysis, by Sheldon Axler
288 Chapter 10 Linear Maps on Hilbert Spaces

   Unlike linear maps from one vector space to a different vector space, operators on
the same vector space can be composed with each other and raised to powers.

10.21 Definition Tk

Suppose T is an operator on a vector space V.
  · For k  Z+, the operator Tk is defined by Tk = TT · · · T.

                                                                                       k times

  · T0 is defined to be the identity operator I : V  V.

   You should verify that powers of an operator satisfy the usual arithmetic rules:
TjTk = Tj+k and (Tj)k = Tjk for j, k  Z+. Also, if V is a normed vector space
and T  B(V), then

                                        Tk  Tk

for every k  Z+, as follows from using induction on 10.20.
Recall that if z  C with |z| < 1, then the formula for the sum of a geometric
series shows that
                                          1 k
                                                 = z .
                                     1 - z k=0

The next result shows that this formula carries over to operators on Banach spaces.

10.22 operators in the open unit ball centered at the identity are invertible

If T is a bounded operator on a Banach space and T < 1, then I - T is
invertible and 

                         (I - T)-1 =  Tk.

                                                                  k=0

Proof Suppose T is a bounded operator on a Banach space V and T < 1. Then

                                                           1
                         Tk   Tk =                                  < .
                                                        1 - T
                        k=0          k=0

Hence  6.47  and  6.41  imply  that  the  infinite  sum         Tk  converges                   in  B(V).  Now

                                                           k=0

                                                        n
             I - T)  Tk = lim (I - T)  Tk = lim (I - Tn+1) = I,
10.23        ( k=0 n                                k=0 n

where the last equality holds because Tn+1  Tn+1 and T < 1. Similarly,

                                              n
              Tk (I - T) = lim  Tk(I - T) = lim (I - Tn+1) = I.
10.24        k=0 n k=0 n

Equations  10.23  and  10.24  imply  that  I  -  T  is  invertible  and  (I  -  T)-1                =       Tk.

                                                                                                       k=0

                  Measure, Integration & Real Analysis, by Sheldon Axler
      Section 10A Adjoints and Invertibility 289

   Now we use the previous result to show that the set of invertible bounded operators
on a Banach space is open.

10.25 invertible bounded operators form an open set

Suppose V is a Banach space. Then {T  B(V) : T is invertible} is an open
subset of B(V).

Proof Suppose T  B(V) is invertible. Suppose S  B(V) and

      T - S < T-1 1  .

Then  I - T-1S = T-1T - T-1S  T-1 T - S < 1.

Hence 10.22 implies that I - (I - T-1S) is invertible; in other words, T-1S is
invertible.

   Now S = T(T-1S). Thus S is the product of two invertible operators, which
implies that S is invertible with S-1 = (T-1S)-1T-1.

   We have shown that every element of the open ball of radius T-1-1 centered at
T is invertible. Thus the set of invertible elements of B(V) is open.

  10.26 Definition left invertible; right invertible
  Suppose T is a bounded operator on a Banach space V.

    · T is called left invertible if there exists S  B(V) such that ST = I.
    · T is called right invertible if there exists S  B(V) such that TS = I.

   One of the wonderful theorems of linear algebra states that left invertibility and
right invertibility and invertibility are all equivalent to each other for operators on
a finite-dimensional vector space. The next example shows that this result fails on
infinite-dimensional Hilbert spaces.

10.27 Example left invertibility is not equivalent to right invertibility
   Define the right shift T : 2  2 and the left shift S : 2  2 by
                          T(a1, a2, a3, . . .) = (0, a1, a2, a3, . . .)

and
                            S(a1, a2, a3, . . .) = (a2, a3, a4, . . .).

Because ST = I, we see that T is left invertible and S is right invertible. However, T
is neither invertible nor right invertible because it is not surjective, and S is neither
invertible nor left invertible because it is not injective.

                     Measure, Integration & Real Analysis, by Sheldon Axler
290 Chapter 10 Linear Maps on Hilbert Spaces

   The result 10.29 below gives equivalent conditions for an operator on a Hilbert
space to be left invertible. On finite-dimensional vector spaces, left invertibility
is equivalent to injectivity. The example below shows that this fails on infinite-
dimensional Hilbert spaces. Thus we cannot eliminate the closed range requirement
in part (c) of 10.29.

10.28 Example injective but not left invertible
   Define T : 2  2 by
                          T(a1, a2, a3, . . .) = a1, a22 , a33 , . . . .

Then T is an injective bounded operator on 2.
   Suppose S is an operator on 2 such that ST = I. For n  Z+, let en  2 be the

vector with 1 in the nth-slot and 0 elsewhere. Then
                          Sen = S(nTen) = n(ST)(en) = nen.

The equation above implies that S is unbounded. Thus T is not left invertible, even
though T is injective.

10.29 left invertibility

Suppose V is a Hilbert space and T  B(V). Then the following are equivalent.
(a) T is left invertible.
(b) There exists   (0, ) such that  f   T f  for all f  V.
(c) T is injective and has closed range.
(d) TT is invertible.

Proof First suppose (a) holds. Thus there exists S  B(V) such that ST = I. If
f  V, then

                               f  = S(T f )  S T f .
Thus (b) holds with  = S, proving that (a) implies (b).

   Now suppose (b) holds. Thus there exists   (0, ) such that

10.30                      f   T f  for all f  V.

The inequality above shows that if f  V and T f = 0, then f = 0. Thus T is
injective. To show that T has closed range, suppose f1, f2, . . . is a sequence in V such
that T f1, T f2, . . . converges in V to some g  V. Thus the sequence T f1, T f2, . . . is
a Cauchy sequence in V. The inequality 10.30 then implies that f1, f2, . . . is a Cauchy
sequence in V. Thus f1, f2, . . . converges in V to some f  V, which implies that
T f = g. Hence g  range T, completing the proof that T has closed range, and
completing the proof that (b) implies (c).

       Measure, Integration & Real Analysis, by Sheldon Axler
                             Section 10A Adjoints and Invertibility 291

   Now suppose (c) holds, so T is injective and has closed range. We want to prove
that (a) holds. Let R : range T  V be the inverse of the one-to-one linear function
f  T f that maps V onto range T. Because range T is a closed subspace of V and
thus is a Banach space [by 6.16(b)], the Bounded Inverse Theorem (6.83) implies
that R is a bounded linear map. Let P denote the orthogonal projection of V onto the
closed subspace range T. Define S : V  V by

                             Sg = R(Pg).

Then for each g  V, we have

                    Sg = R(Pg)  R Pg  Rg,

where the last inequality comes from 8.37(d). The inequality above implies that S is
a bounded operator on V. If f  V, then

                    S(T f ) = R P(T f ) = R(T f ) = f .

Thus ST = I, which means that T is left invertible, completing the proof that (c)
implies (a).

   At this stage of the proof we know that (a), (b), and (c) are equivalent. To prove
that one of these implies (d), suppose (b) holds. Squaring the inequality in (b), we
see that if f  V, then

 f 2  2T f 2 = 2TT f , f   2TT f   f ,

which implies that            f   2TT f .

In other words, (b) holds with T replaced by TT (and  replaced by 2). By the
equivalence we already proved between (a) and (b), we conclude that TT is left
invertible. Thus there exists S  B(V) such that S(TT) = I. Taking adjoints of
both sides of the last equation shows that (TT)S = I. Thus TT is also right
invertible, which implies that TT is invertible. Thus (b) implies (d).

   Finally, suppose (d) holds, so TT is invertible. Hence there exists S  B(V)
such that I = S(TT) = (ST)T. Thus T is left invertible, showing that (d) implies
(a), completing the proof that (a), (b), (c), and (d) are equivalent.

   You may be familiar with the finite-dimensional result that right invertibility is
equivalent to surjectivity. The next result shows that this equivalency also holds on
infinite-dimensional Hilbert spaces.

10.31 right invertibility

Suppose V is a Hilbert space and T  B(V). Then the following are equivalent.
(a) T is right invertible.
(b) T is surjective.
(c) TT is invertible.

Measure, Integration & Real Analysis, by Sheldon Axler
292 Chapter 10 Linear Maps on Hilbert Spaces

Proof Taking adjoints shows that an operator is right invertible if and only if its
adjoint is left invertible. Thus the equivalence of (a) and (c) in this result follows
immediately from the equivalence of (a) and (d) in 10.29 applied to T instead of T.

   Suppose (a) holds, so T is right invertible. Hence there exists S  B(V) such
that TS = I. Thus T(S f ) = f for every f  V, which implies that T is surjective,
completing the proof that (a) implies (b).

   To prove that (b) implies (a), suppose T is surjective. Define R : (null T)  V
by R = T|(null T) . Clearly R is injective because

                         null R = (null T)  (null T) = {0}.
If f  V, then f = g + h for some g  null T and some h  (null T) (by
8.43); thus T f = Th = Rh, which implies that range T = range R. Because T is
surjective, this implies that range R = V. In other words, R is a continuous injective
linear map of (null T) onto V. The Bounded Inverse Theorem (6.83) now implies
that R-1 : V  (null T) is a bounded linear map on V. We have TR-1 = I. Thus
T is right invertible, completing the proof that (b) implies (a).

EXERCISES 10A

 1 Define T : 2  2 by T(a1, a2, . . .) = (0, a1, a2, . . .). Find a formula for T.
 2 Suppose V is a Hilbert space, U is a closed subspace of V, and T : U  V is

     defined by T f = f . Describe the linear operator T : V  U.
 3 Suppose V and W are Hilbert spaces and g  V, h  W. Define T  B(V, W)

     by T f =  f , gh. Find a formula for T.
 4 Suppose V and W are Hilbert spaces and T  B(V, W) has finite-dimensional

      range. Prove that T also has finite-dimensional range.
 5 Prove or give a counterexample: If V is a Hilbert space and T : V  V is a

     bounded linear map such that dim null T < , then dim null T < .
 6 Suppose T is a bounded linear map from a Hilbert space V to a Hilbert space W.

     Prove that TT = T2.
     [This formula for TT leads to the important subject of C-algebras.]
 7 Suppose V is a Hilbert space and Inv(V) is the set of invertible bounded oper-
     ators on V. Think of Inv(V) as a metric space with the metric it inherits as a
     subset of B(V). Show that T  T-1 is a continuous function from Inv(V) to
     Inv(V).
 8 Suppose T is a bounded operator on a Hilbert space.
      (a) Prove that T is left invertible if and only if T is right invertible.
      (b) Prove that T is invertible if and only if T is both left and right invertible.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                 Section 10A Adjoints and Invertibility 293

 9 Suppose b1, b2, . . . is a bounded sequence in F. Define a bounded linear map
      T : 2  2 by
                                T(a1, a2, . . .) = (a1b1, a2b2, . . .).
      (a) Find a formula for T.
      (b) Show that T is injective if and only if bk = 0 for every k  Z+.
      (c) Show that T has dense range if and only if bk = 0 for every k  Z+.
      (d) Show that T has closed range if and only if
                                 inf{|bk| : k  Z+ and bk = 0} > 0.
      (e) Show that T is invertible if and only if inf{|bk| : k  Z+} > 0.

10 Suppose h  L(R) and Mh : L2(R)  L2(R) is the bounded operator
      defined by Mh f = f h.
      (a) Show that Mh is injective if and only if |{x  R : h(x) = 0}| = 0.
      (b) Find a necessary and sufficient condition (in terms of h) for Mh to have
           dense range.
      (c) Find a necessary and sufficient condition (in terms of h) for Mh to have
           closed range.
      (d) Find a necessary and sufficient condition (in terms of h) for Mh to be
           invertible.

11 (a) Prove or give a counterexample: If T is a bounded operator on a Hilbert
           space such that T and T are both injective, then T is invertible.

      (b) Prove or give a counterexample: If T is a bounded operator on a Hilbert
           space such that T and T are both surjective, then T is invertible.

12 Define T : 2  2 by T(a1, a2, a3, . . . ) = (a2, a3, a4, . . .). Suppose   F.
      (a) Prove that T - I is injective if and only if ||  1.
      (b) Prove that T - I is invertible if and only if || > 1.
      (c) Prove that T - I is surjective if and only if || = 1.
      (d) Prove that T - I is left invertible if and only if || > 1.

13 Suppose V is a Hilbert space.
      (a) Show that {T  B(V) : T is left invertible} is an open subset of B(V).
      (b) Show that {T  B(V) : T is right invertible} is an open subset of B(V).

14 Suppose T is a bounded operator on a Hilbert space V.
      (a) Prove that T is invertible if and only if T has a unique left inverse. In
           other words, prove that T is invertible if and only if there exists a unique
           S  B(V) such that ST = I.
      (b) Prove that T is invertible if and only if T has a unique right inverse. In
           other words, prove that T is invertible if and only if there exists a unique
           S  B(V) such that TS = I.

                      Measure, Integration & Real Analysis, by Sheldon Axler
294 Chapter 10 Linear Maps on Hilbert Spaces

10B Spectrum

Spectrum of an Operator

The following definitions play key roles in operator theory.

  10.32 Definition eigenvalue; eigenvector; spectrum; sp(T)

  Suppose T is a bounded operator on a Banach space V.
    · A number   F is called an eigenvalue of T if T - I is not injective.
    · A nonzero vector f  V is called an eigenvector of T corresponding to an
       eigenvalue   F if
                                             Tf = f.
    · The spectrum of T is denoted sp(T) and is defined by
                         sp(T) = {  F : T - I is not invertible}.

   If T - I is not injective, then T - I is not invertible. Thus the set of eigenvalues
of a bounded operator T is contained in the spectrum of T. If V is a finite-dimensional
Banach space and T  B(V), then T - I is not injective if and only if T - I is
not invertible. Thus if T is an operator on a finite-dimensional Banach space, then
the spectrum of T equals the set of eigenvalues of T.

   However, on infinite-dimensional Banach spaces, the spectrum of an operator does
not necessarily equal the set of eigenvalues, as shown in the next example.

10.33 Example eigenvalues and spectrum
   Verifying all the assertions in this example should help solidify your understanding

of the definition of the spectrum.
  · Suppose b1, b2, . . . is a bounded sequence in F. Define a bounded linear map
     T : 2  2 by
                               T(a1, a2, . . .) = (a1b1, a2b2, . . .).
     Then the set of eigenvalues of T equals {bk : k  Z+} and the spectrum of T
     equals the closure of {bk : k  Z+}.
  · Suppose h  L(R). Define a bounded linear map Mh : L2(R)  L2(R) by
                                            Mh f = f h.
     Then   F is an eigenvalue of Mh if and only if |{t  R : h(t) = }| > 0.
     Also,   sp(Mh) if and only if |{t  R : |h(t) - | < }| > 0 for all  > 0.
  · Define the right shift T : 2  2 and the left shift S : 2  2 by
      T(a1, a2, a3, . . .) = (0, a1, a2, a3, . . .) and S(a1, a2, a3, . . .) = (a2, a3, a4, . . .).
     Then T has no eigenvalues, and sp(T) = {  F : ||  1}. Also, the set of
     eigenvalues of S is the open set {  F : || < 1}, and the spectrum of S is the
     closed set {  F : ||  1}.

                     Measure, Integration & Real Analysis, by Sheldon Axler
           Section 10B Spectrum 295

   If  is an eigenvalue of an operator T  B(V) and f is an eigenvector of T
corresponding to , then

                                 T f  =  f  = ||  f ,
which implies that ||  T. The next result states that the same inequality holds
for elements of sp(T).

10.34 T - I is invertible for || large

Suppose T is a bounded operator on a Banach space. Then
(a) sp(T)  {  F : ||  T};
(b) T - I is invertible for all   F with || > T;
(c) lim (T - I)-1 = 0.

       ||

Proof We begin by proving (b). Suppose   F and || > T. Then

10.35  T - I = - I - T .
                               

Because T/ < 1, the equation above and 10.22 imply that T - I is invertible,
completing the proof of (b).

   Using the definition of spectrum, (a) now follows immediately from (b).
   To prove (c), again suppose   F and || > T. Then 10.35 and 10.22 imply

                  -1 1  Tk

       (T - I) = -  k .

                             k=0 

Thus

       -1  1  Tk
       (T - I)    k
           || k=0 ||

           =1 1
              || 1 - T ||

           = 1 || - T .

The inequality above implies (c), completing the proof.

   The set of eigenvalues of a bounded operator on a Hilbert space can be any
bounded subset of F, even a nonmeasurable set (see Exercise 3). In contrast, the next
result shows that the spectrum of a bounded operator is a closed subset of F. This
result provides one indication that the spectrum of an operator may be a more useful
set than the set of eigenvalues.

                     Measure, Integration & Real Analysis, by Sheldon Axler
296 Chapter 10 Linear Maps on Hilbert Spaces

  10.36 spectrum is closed

  The spectrum of a bounded operator on a Banach space is a closed subset of F.

Proof Suppose T is a bounded operator on a Banach space V. Suppose 1, 2, . . .
is a sequence in sp(T) that converges to some   F. Thus each T - n I is not
invertible and

                                 lim (T - n I) = T - I.

                                           n

   The set of noninvertible elements of B(V) is a closed subset of B(V) (by 10.25).
Hence the equation above implies that T - I is not invertible. In other words,
  sp(T), which implies that sp(T) is closed.

   Our next result provides the key tool used in proving that the spectrum of a
bounded operator on a nonzero complex Hilbert space is nonempty (see 10.38). The
statement of the next result and the proofs of the next two results use a bit of basic
complex analysis. Because sp(T) is a closed subset of C (by 10.36), C \ sp(T) is
an open subset of C and thus it makes sense to ask whether the function in the result
below is analytic.

   To keep things simple, the next two results are stated for complex Hilbert spaces.
See Exercise 6 for the analogous results for complex Banach spaces.

10.37 analyticity of (T - I)-1

Suppose T is a bounded operator on a complex Hilbert space V. Then the function
                                  (T - I)-1 f , g

is analytic on C \ sp(T) for every f , g  V.

Proof Suppose   C \ sp(T). Then for   C with | - | < (T-1I)-1 , we
see from 10.22 that I - ( - )(T - I)-1 is invertible and

                                                   

I - ( - )(T - I)-1 -1 =  ( - )k (T - I)-1 k.

                                                k=0

Multiplying both sides of the equation above by (T - I)-1 and using the equation
A-1B-1 = (BA)-1 for invertible operators A and B, we get

                            -1  k             -1 k+1
(T - I) =  ( - ) (T - I)                              .

                            k=0

Thus for f , g  V, we have

                                    (T - I)-1 k+1 f , g ( - )k.

(T - I)-1 f , g = 

                               k=0

The equation above shows that the function   (T - I)-1 f , g has a power se-
ries expansion as powers of  -  for  near . Thus this function is analytic near .

Measure, Integration & Real Analysis, by Sheldon Axler
                                           Section 10B Spectrum 297

   A major result in finite-dimensional    The spectrum of a bounded operator
linear algebra states that every operator
on a nonzero finite-dimensional complex on a nonzero real Hilbert space can
vector space has an eigenvalue. We have be the empty set. This can happen
seen examples showing that this result     even in finite dimensions, where an
                                           2
does not extend to bounded operators on operator on R might have no
complex Hilbert spaces. However, the eigenvalues. Thus the restriction in
next result is an excellent substitute. Al- the next result to the complex case
though a bounded operator on a nonzero cannot be removed.
complex Hilbert space need not have an eigenvalue, the next result shows that for
each such operator T, there exists   C such that T - I is not invertible.

  10.38 spectrum is nonempty

  The spectrum of a bounded operator on a complex nonzero Hilbert space is a
  nonempty subset of C.

Proof Suppose T  B(V), where V is a complex Hilbert space with V = {0},
and sp(T) = . Thus T - I is invertible for all   C. Let f  V with f = 0.
Because sp(T) = , 10.37 with g = T-1 f implies that the function

                                  (T - I)-1 f , T-1 f
is analytic on all of C. The value of the function above at  = 0 equals the average
value of the function on each circle in C centered at 0 (because analytic functions
satisfy the mean value property). But 10.34(c) implies that this function has limit 0
as ||  . Thus taking the average over large circles, we see that the value of the
function above at  = 0 is 0. In other words,

                                      T-1 f , T-1 f = 0.
Hence T-1 f = 0. Applying T to both sides of the equation T-1 f = 0 shows that
f = 0, which contradicts our assumption that f = 0. This contradiction means that
our assumption that sp(T) =  was false, completing the proof.

  10.39 Definition p(T)
  Suppose T is an operator on a vector space V and p is a polynomial with coeffi-
  cients in F:

                              p(z) = b0 + b1z + · · · + bnzn.
  Then p(T) is the operator on V defined by

                            p(T) = b0 I + b1T + · · · + bnTn.
   You should verify that if p and q are polynomials with coefficients in F and T is
an operator, then

                                  (pq)(T) = p(T) q(T).

                     Measure, Integration & Real Analysis, by Sheldon Axler
298 Chapter 10 Linear Maps on Hilbert Spaces

   The next result provides a nice way to compute the spectrum of a polynomial
applied to an operator. For example, this result implies that if T is a bounded operator
on a complex Banach space, then the spectrum of T2 consists of the squares of all
numbers in the spectrum of T.

   As with the previous result, the next result fails on real Banach spaces. As you
can see, the proof below uses factorization of a polynomial with complex coefficients
as the product of polynomials with degree 1, which is not necessarily possible when
restricting to the field of real numbers.

10.40 Spectral Mapping Theorem
Suppose T is a bounded operator on a complex Banach space and p is a
polynomial with complex coefficients. Then

                                sp p(T) = p sp(T) .

Proof If p is a constant polynomial, then both sides of the equation above consist
of the set containing just that constant. Thus we can assume that p is a nonconstant
polynomial.

   First suppose   sp p(T) . Thus p(T) - I is not invertible. By the Funda-
mental Theorem of Algebra, there exist c, 1, . . . n  C with c = 0 such that

10.41               p(z) -  = c(z - 1) · · · (z - n)

for all z  C. Thus

                    p(T) - I = c(T - 1 I) · · · (T - n I).

The left side of the equation above is not invertible. Hence T - k I is not invertible
for some k  {1, . . . , n}. Thus k  sp(T). Now 10.41 implies p(k) = . Hence
  p sp(T) , completing the proof that sp p(T)  p sp(T) .

   To prove the inclusion in the other direction, now suppose   sp(T). The
polynomial z  p(z) - p() has a zero at . Hence there exists a polynomial q
with degree 1 less than the degree of p such that

                    p(z) - p() = (z - )q(z)

for all z  C. Thus

10.42               p(T) - p()I = (T - I)q(T)

and

10.43               p(T) - p()I = q(T)(T - I).

Because T - I is not invertible, T - I is not surjective or T - I is not injective.
If T - I is not surjective, then 10.42 shows that p(T) - p()I is not surjective. If
T - I is not injective, then 10.43 shows that p(T) - p()I is not injective. Either
way, we see that p(T) - p()I is not invertible. Thus p()  sp p(T) , completing
the proof that sp p(T)  p sp(T) .

       Measure, Integration & Real Analysis, by Sheldon Axler
                                                                   Section 10B Spectrum 299

Self-adjoint Operators

In this subsection, we look at a nice special class of bounded operators.

  10.44 Definition self-adjoint

  A bounded operator T on a Hilbert space is called self-adjoint if T = T.

   The definition of the adjoint implies that a bounded operator T on a Hilbert space
V is self-adjoint if and only if T f , g =  f , Tg for all f , g  V. See Exercise 7 for
an interesting result regarding this last condition.

10.45 Example self-adjoint operators

  · Suppose b1, b2, . . . is a bounded sequence in F. Define a bounded operator
     T : 2  2 by
                               T(a1, a2, . . .) = (a1b1, a2b2, . . .).
     Then T : 2  2 is the operator defined by
                               T(a1, a2, . . .) = (a1b1, a2b2, . . .).
     Hence T is self-adjoint if and only if bk  R for all k  Z+.

  · More generally, suppose (X, S, µ) is a -finite measure space and h  L(µ).
     Define a bounded operator Mh  B L2(µ) by Mh f = f h. Then Mh = Mh.
     Thus Mh is self-adjoint if and only if µ({x  X : h(x) / R}) = 0.

  · Suppose n  Z+, K is an n-by-n matrix, and IK : Fn  Fn is the operator of
     matrix multiplication by K (thinking of elements of Fn as column vectors). Then
     (IK) is the operator of multiplication by the conjugate transpose of K, as shown
     in Example 10.10. Thus IK is a self-adjoint operator if and only if the matrix K
     equals its conjugate transpose.

  · More generally, suppose (X, S, µ) is a -finite measure space, K  L2(µ × µ),
     and IK is the integral operator on L2(µ) defined in Example 10.5. Define
     K : X × X  F by K(y, x) = K(x, y). Then (IK) is the integral operator
     induced by K, as shown in Example 10.5. Thus if K = K, or in other words if
     K(x, y) = K(y, x) for all (x, y)  X × X, then IK is self-adjoint.

  · Suppose U is a closed subspace of a Hilbert space V. Recall that PU denotes the
     orthogonal projection of V onto U (see Section 8B). We have
                            PU f , g = PU f , PU g + (I - PU)g
                                        = PU f , PU g
                                        =  f - (I - PU) f , PU g
                                        =  f , PU g,
     where the second and fourth equalities above hold because of 8.37(a). The
     equation above shows that PU is a self-adjoint operator.

                     Measure, Integration & Real Analysis, by Sheldon Axler
300 Chapter 10 Linear Maps on Hilbert Spaces

   For real Hilbert spaces, the next result requires the additional hypothesis that T
is self-adjoint. To see that this extra hypothesis cannot be eliminated, consider the
operator T : R2  R2 defined by T(x, y) = (-y, x). Then, T = 0, but with the
standard inner product on R2, we have T f , f  = 0 for all f  R2 (which you can
verify either algebraically or by thinking of T as counterclockwise rotation by a right
angle).

10.46 T f , f  = 0 for all f implies T = 0

Suppose V is a Hilbert space, T  B(V), and T f , f  = 0 for all f  V.
(a) If F = C, then T = 0.
(b) If F = R and T is self-adjoint, then T = 0.

Proof First suppose F = C. If g, h  V, then

              Tg, h = T(g + h), g + h - T(g - h), g - h 4
                           + T(g + ih), g + ih - T(g - ih), g - ih 4 i,

as can be verified by computing the right side. Our hypothesis that T f , f  = 0
for all f  V implies that the right side above equals 0. Thus Tg, h = 0 for all
g, h  V. Taking h = Tg, we can conclude that T = 0, which completes the proof
of (a).

   Now suppose F = R and T is self-adjoint. Then

10.47  Tg, h = T(g + h), g + h - T(g - h), g - h 4 ;

this is proved by computing the right side using the equation

       Th, g = h, Tg = Tg, h,

where the first equality holds because T is self-adjoint and the second equality holds
because we are working in a real Hilbert space. Each term on the right side of 10.47
is of the form T f , f  for appropriate f . Thus Tg, h = 0 for all g, h  V. This
implies that T = 0 (take h = Tg), completing the proof of (b).

   Some insight into the adjoint can be obtained by thinking of the operation T  T
on B(V) as analogous to the operation z  z on C. Under this analogy, the
self-adjoint operators (characterized by T = T) correspond to the real numbers
(characterized by z = z). The first two bullet points in Example 10.45 illustrate this
analogy, as we saw that a multiplication operator on L2(µ) is self-adjoint if and only
if the multiplier is real-valued almost everywhere.

   The next two results deepen the analogy between the self-adjoint operators and
the real numbers. First we see this analogy reflected in the behavior of T f , f , and
then we see this analogy reflected in the spectrum of T.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                              Section 10B Spectrum 301

10.48 self-adjoint characterized by T f , f 

Suppose T is a bounded operator on a complex Hilbert space V.  Then T is
self-adjoint if and only if

                                       T f , f   R
for all f  V.

Proof Let f  V. Then
T f , f  - T f , f  = T f , f  -  f , T f  = T f , f  - T f , f  = (T - T) f , f .
If T f , f   R for every f  V, then the left side of the equation above equals 0, so
(T - T) f , f  = 0 for every f  V. This implies that T - T = 0 [by 10.46(a)].
Hence T is self-adjoint.

   Conversely, if T is self-adjoint, then the right side of the equation above equals
0, so T f , f  = T f , f  for every f  V. This implies that T f , f   R for every
f  V, as desired.

  10.49 self-adjoint operators have real spectrum

  Suppose T is a bounded self-adjoint operator on a Hilbert space. Then
  sp(T)  R.

Proof The desired result holds if F = R because the spectrum of every operator on
a real Hilbert space is, by definition, contained in R.

   Thus we assume that T is a bounded operator on a complex Hilbert space V.
Suppose ,   R, with  = 0. If f  V, then

               T - ( + i)I f   f   T - ( + i)I f , f
                                             = T f , f  -  f 2 -  f 2i
                                              ||  f 2,

where the first inequality comes from the Cauchy-Schwarz inequality (8.11) and the
last inequality holds because T f , f  -  f 2  R (by 10.48).

   The inequality above implies that
                              f   1  T - ( + i)I f 
                                       ||

for all f  V. Now the equivalence of (a) and (b) in 10.29 shows that T - ( + i)I
is left invertible.

   Because T is self-adjoint, the adjoint of T - ( + i)I is T - ( - i)I, which
is left invertible by the same argument as above (just replace  by -). Hence
T - ( + i)I is right invertible (because its adjoint is left invertible). Because the
operator T - ( + i)I is both left and right invertible, it is invertible. In other words,
 + i / sp(T). Thus sp(T)  R, as desired.

                     Measure, Integration & Real Analysis, by Sheldon Axler
302 Chapter 10 Linear Maps on Hilbert Spaces

   We showed that a bounded operator on a complex nonzero Hilbert space has a
nonempty spectrum. That result can fail on real Hilbert spaces (where by definition
the spectrum is contained in R). For example, the operator T on R2 defined by
T(x, y) = (-y, x) has empty spectrum. However, the previous result and 10.38 can
be used to show that every self-adjoint operator on a nonzero real Hilbert space has
nonempty spectrum (see Exercise 9 for the details).

   Although the spectrum of every self-adjoint operator is nonempty, it is not true that
every self-adjoint operator has an eigenvalue. For example, the self-adjoint operator
Mx  B L2([0, 1]) defined by (Mx f )(x) = x f (x) has no eigenvalues.

Normal Operators

Now we consider another nice special class of operators.

  10.50 Definition normal operator
  A bounded operator T on a Hilbert space is called normal if it commutes with its
  adjoint. In other words, T is normal if

                                         TT = TT.
   Clearly every self-adjoint operator is normal, but there exist normal operators that
are not self-adjoint, as shown in the next example.

10.51 Example normal operators
  · Suppose µ is a positive measure, h  L(µ), and Mh  B L2(µ) is the
     multiplication operator defined by Mh f = f h. Then Mh = Mh, which means
     that Mh is self-adjoint if h is real valued. If F = C, then h can be complex
     valued and Mh is not necessarily self-adjoint. However,
                                  Mh Mh = M|h|2 = Mh Mh
     and thus Mh is a normal operator even when h is complex valued.
  · Suppose T is the operator on F2 whose matrix with respect to the standard basis
     is
                                              2 -3 .
                                                32
     Then T is not self-adjoint because the matrix above is not equal to its conjugate
     transpose. However, TT = 13I and TT = 13I, as you should verify. Because
     TT = TT, we conclude that T is a normal operator.

10.52 Example an operator that is not normal
   Suppose T is the right shift on 2; thus T(a1, a2, . . .) = (0, a1, a2, . . .). Then T

is the left shift: T(a1, a2, . . .) = (a2, a3, . . .). Hence TT is the identity operator
on 2 and TT is the operator (a1, a2, a3, . . .)  (0, a2, a3, . . .). Thus TT = TT,
which means that T is not a normal operator.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                                   Section 10B Spectrum 303

  10.53 normal in terms of norms
  Suppose T is a bounded operator on a Hilbert space V. Then T is normal if and
  only if

                                       T f  = T f 
  for all f  V.

Proof If f  V, then
       T f 2 - T f 2 = T f , T f  - T f , T f  = (TT - TT) f , f .

If T is normal, then the right side of the equation above equals 0, which implies that
the left side also equals 0 and hence T f  = T f .

   Conversely, suppose T f  = T f  for all f  V. Then the left side of the
equation above equals 0, which implies that the right side also equals 0 for all f  V.
Because TT - TT is self-adjoint, 10.46 now implies that TT - TT = 0. Thus
T is normal, completing the proof.

   Each complex number can be written in the form a + bi, where a and b are real
numbers. Part (a) of the next result gives the analogous result for bounded operators
on a complex Hilbert space, with self-adjoint operators playing the role of real
numbers. We could call the operators A and B in (a) the real and imaginary parts of
the operator T. Part (b) below shows that normality depends on whether these real
and imaginary parts commute.

  10.54 operator is normal if and only if its real and imaginary parts commute
  Suppose T is a bounded operator on a complex Hilbert space V.
  (a) There exist unique self-adjoint operators A, B on V such that T = A + iB.
  (b) T is normal if and only if AB = BA, where A, B are as in (a).
Proof Suppose T = A + iB, where A and B are self-adjoint. Then T = A - iB.
Adding these equations for T and T and then dividing by 2 produces a formula for
A; subtracting the equation for T from the equation for T and then dividing by 2i
produces a formula for B. Specifically, we have

                           A = T + T 2 and B = T - T 2i ,
which proves the uniqueness part of (a). The existence part of (a) is proved by
defining A and B by the equations above and noting that A and B as defined above
are self-adjoint and T = A + iB.

   To prove (b), verify that if A and B are defined as in the equations above, then
                                 AB - BA = TT - TT 2i .

Thus AB = BA if and only if T is normal.

                     Measure, Integration & Real Analysis, by Sheldon Axler
304 Chapter 10 Linear Maps on Hilbert Spaces

   An operator on a finite-dimensional vector space is left invertible if and only if
it is right invertible. We have seen that this result fails for bounded operators on
infinite-dimensional Hilbert spaces. However, the next result shows that we recover
this equivalency for normal operators.

  10.55 invertibility for normal operators
  Suppose V is a Hilbert space and T  B(V) is normal. Then the following are
  equivalent.
  (a) T is invertible.
  (b) T is left invertible.
  (c) T is right invertible.
  (d) T is surjective.
  (e) T is injective and has closed range.
  (f) TT is invertible.
  (g) TT is invertible.
Proof Because T is normal, (f) and (g) are clearly equivalent. From 10.29, we know
that (f), (b), and (e) are equivalent to each other. From 10.31, we know that (g),
(c), and (d) are equivalent to each other. Thus (b), (c), (d), (e), (f), and (g) are all
equivalent to each other.
   Clearly (a) implies (b).
   Suppose (b) holds. We already know that (b) and (c) are equivalent; thus T is left
invertible and T is right invertible. Hence T is invertible, proving that (b) implies (a)
and completing the proof that (a) through (g) are all equivalent to each other.
   The next result shows that a normal operator and its adjoint have the same eigen-
vectors, with eigenvalues that are complex conjugates of each other. This result can
fail for operators that are not normal. For example, 0 is an eigenvalue of the left shift
on 2 but its adjoint the right shift has no eigenvectors and no eigenvalues.

  10.56 T normal and T f =  f implies T f =  f
  Suppose T is a normal operator on a Hilbert space V,   F, and f  V. Then 
  is an eigenvalue of T with eigenvector f if and only if  is an eigenvalue of T
  with eigenvector f .
Proof Because (T - I) = T - I and T is normal, T - I commutes with its
adjoint. Thus T - I is normal. Hence 10.53 implies that

                             (T - I) f  = (T - I) f .
Thus (T - I) f = 0 if and only if (T - I) f = 0, as desired.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                                   Section 10B Spectrum 305

   Because every self-adjoint operator is normal, the following result also holds for
self-adjoint operators.

  10.57 orthogonal eigenvectors for normal operators
  Eigenvectors of a normal operator corresponding to distinct eigenvalues are
  orthogonal.
Proof Suppose  and  are distinct eigenvalues of a normal operator T, with
corresponding eigenvectors f and g. Then 10.56 implies that T f =  f . Thus

           ( - )g, f  = g, f  - g,  f  = Tg, f  - g, T f  = 0.
Because  = , the equation above implies that g, f  = 0, as desired.

Isometries and Unitary Operators

  10.58 Definition isometry; unitary operator
  Suppose T is a bounded operator on a Hilbert space V.

    · T is called an isometry if T f  =  f  for every f  V.
    · T is called unitary if TT = TT = I.

10.59 Example isometries and unitary operators

· Suppose T  B 2 is the right shift defined by

                         T(a1, a2, a3, . . .) = (0, a1, a2, a3, . . .).

Then T is an isometry but is not a unitary operator because TT = I (as is clear
without even computing T because T is not surjective).

· Suppose T  B 2(Z) is the right shift defined by

                                       (T f )(n) = f (n - 1)

for  f  :  Z    F  with        -    |  f  (  k  )  |  2  <  .  Then  T  is  an  isometry  and  is  unitary.
                           k=

· Suppose b1, b2, . . . is a bounded sequence in F. Define T  B 2 by

                           T(a1, a2, . . .) = (a1b1, a2b2, . . .).

Then T is an isometry if and only if T is unitary if and only if |bk| = 1 for all
k  Z+.

· More generally, suppose (X, S, µ) is a -finite measure space and h  L(µ).
   Define Mh  B L2(µ) by Mh f = f h. Then T is an isometry if and only if T
   is unitary if and only if µ({x  X : |h(x)| = 1}) = 0.

              Measure, Integration & Real Analysis, by Sheldon Axler
306 Chapter 10 Linear Maps on Hilbert Spaces

   By definition, isometries preserve norms. The equivalence of (a) and (b) in the
following result shows that isometries also preserve inner products.

10.60 isometries preserve inner products

Suppose T is a bounded operator on a Hilbert space V. Then the following are
equivalent.

(a) T is an isometry.
(b) T f , Tg =  f , g for all f , g  V.
(c) TT = I.
(d) {Tek}k is an orthonormal family for every orthonormal family {ek}k

     in V.
(e) {Tek}k is an orthonormal family for some orthonormal basis {ek}k

     of V.

Proof If f  V, then

T f 2 -  f 2 = T f , T f  -  f , f  = (TT - I) f , f .

Thus T f  =  f  for all f  V if and only if the right side of the equation above
is 0 for all f  V. Because TT - I is self-adjoint, this happens if and only if
TT - I = 0 (by 10.46). Thus (a) is equivalent to (c).

   If TT = I, then T f , Tg = TT f , g =  f , g for all f , g  V. Thus (c)
implies (b).

   Taking g = f in (b), we see that (b) implies (a). Hence we now know that (a), (b),
and (c) are equivalent to each other.

   To prove that (b) implies (d), suppose (b) holds. If {ek}k is an orthonormal
family in V, then Tej, Tek = ej, ek for all j, k  , and thus {Tek}k is an
orthonormal family in V. Hence (b) implies (d).

   Because V has an orthonormal basis (see 8.67 or 8.75), (d) implies (e).
   Finally, suppose (e) holds. Thus {Tek}k is an orthonormal family for some
orthonormal basis {ek}k of V. Suppose f  V. Then by 8.63(a) we have

                             f =  f , ejej,

                                                          j

which implies that      TT f =   f , ejTTej.

                                      j

Thus if k  , then

TT f , ek =  f , ejTTej, ek =  f , ejTej, Tek =  f , ek,
                     j                    j

where the last equality holds because Tej, Tek equals 1 if j = k and equals 0
otherwise. Because the equality above holds for every ek in the orthonormal basis
{ek}k, we conclude that TT f = f . Thus (e) implies (c), completing the proof.

Measure, Integration & Real Analysis, by Sheldon Axler
                                                                   Section 10B Spectrum 307

   The equivalence between (a) and (c) in the previous result shows that every unitary
operator is an isometry.

   Next we have a result giving conditions that are equivalent to being a unitary
operator. Notice that parts (d) and (e) of the previous result refer to orthonormal
families, but parts (f) and (g) of the following result refer to orthonormal bases.

  10.61 unitary operators and their adjoints are isometries
  Suppose T is a bounded operator on a Hilbert space V. Then the following are
  equivalent.
  (a) T is unitary.
  (b) T is a surjective isometry.
  (c) T and T are both isometries.
  (d) T is unitary.
  (e) T is invertible and T-1 = T.
  (f) {Tek}k is an orthonormal basis of V for every orthonormal basis {ek}k

       of V.
  (g) {Tek}k is an orthonormal basis of V for some orthonormal basis {ek}k

       of V.
Proof The equivalence of (a), (d), and (e) follows easily from the definition of
unitary.

   The equivalence of (a) and (c) follows from the equivalence in 10.60 of (a) and (c).
   To prove that (a) implies (b), suppose (a) holds, so T is unitary. As we have
already noted, this implies that T is an isometry. Also, the equation TT = I implies
that T is surjective. Thus (b) holds, proving that (a) implies (b).
   Now suppose (b) holds, so T is a surjective isometry. Because T is surjective and
injective, T is invertible. The equation TT = I [which follows from the equivalence
in 10.60 of (a) and (c)] now implies that T-1 = T. Thus (b) implies (e). Hence at
this stage of the proof, we know that (a), (b), (c), (d), and (e) are all equivalent to
each other.
   To prove that (b) implies (f), suppose (b) holds, so T is a surjective isometry.
Suppose {ek}k is an orthonormal basis of V. The equivalence in 10.60 of (a) and (d)
implies that {Tek}k is an orthonormal family. Because {ek}k is an orthonormal
basis of V and T is surjective, the closure of the span of {Tek}k equals V. Thus
{Tek}k is an orthonormal basis of V, which proves that (b) implies (f).
   Obviously (f) implies (g).
   Now suppose (g) holds. The equivalence in 10.60 of (a) and (e) implies that T
is an isometry, which implies that the range of T is closed. Because {Tek}k is an
orthonormal basis of V, the closure of the range of T equals V. Thus T is a surjective
isometry, proving that (g) implies (b) and completing the proof that (a) through (g)
are all equivalent to each other.

                     Measure, Integration & Real Analysis, by Sheldon Axler
308 Chapter 10 Linear Maps on Hilbert Spaces

   The equations TT = TT = I are analogous to the equation |z|2 = 1 for z  C.
We now extend this analogy to the behavior of the spectrum of a unitary operator.

10.62 spectrum of a unitary operator

Suppose T is a unitary operator on a Hilbert space. Then
                             sp(T)  {  F : || = 1}.

Proof Suppose   F with || = 1. Then
                 (T - I)(T - I) = (T - I)(T - I)

       = (1 + ||2)I - (T + T)

10.63  = (1 + ||2) I - 1 + ||2 T + T .

Looking at the last term in parentheses above, we have

10.64  1 + ||2 T  1 + ||2 <  + T 2|| 1,

where the last inequality holds because || = 1. Now 10.64, 10.63, and 10.22 imply
that (T - I)(T - I) is invertible. Thus T - I is left invertible. Because T - I
is normal, this implies that T - I is invertible (see 10.55). Hence  / sp(T). Thus
sp(T)  {  F : || = 1}, as desired.

   As a special case of the next result, we can conclude (without doing any calcula-
tions!) that the spectrum of the right shift on 2 is {  F : ||  1}.

  10.65 spectrum of an isometry

  Suppose T is an isometry on a Hilbert space and T is not unitary. Then
                               sp(T) = {  F : ||  1}.

Proof Because T is an isometry but is not unitary, we know that T is not surjective
[by the equivalence of (a) and (b) in 10.61]. In particular, T is not invertible. Thus
T is not invertible.

   Suppose   F with || < 1. Because TT = I, we have
                                  T(T - I) = I - T.

The right side of the equation above is invertible (by 10.22). If T - I were invertible,
then the equation above would imply T = (I - T)(T - I)-1, which would
make T invertible as the product of invertible operators. However, the paragraph
above shows T is not invertible. Thus T - I is not invertible. Hence   sp(T).

   Thus {  F : || < 1}  sp(T). Because sp(T) is closed (see 10.36), this
implies {  F : ||  1}  sp(T). The inclusion in the other direction follows
from 10.34(a). Thus sp(T) = {  F : ||  1}.

       Measure, Integration & Real Analysis, by Sheldon Axler
                                               Section 10B Spectrum 309

EXERCISES 10B

1 Verify all the assertions in Example 10.33.

2 Suppose T is a bounded operator on a Hilbert space V.

(a) Prove that sp(S-1TS) = sp(T) for all bounded invertible operators S on V.

(b) Prove that sp(T) = { :   sp(T)}.

(c) Prove that if T is invertible, then sp(T-1) =  1  :      sp(T)  .
                                                   

3 Suppose E is a bounded subset of F. Show that there exists a Hilbert space V
    and T  B(V) such that the set of eigenvalues of T equals E.

4 Suppose E is a nonempty closed bounded subset of F. Show that there exists
    T  B 2 such that sp(T) = E.

5 Give an example of a bounded operator T on a normed vector space such that
    for every   F, the operator T - I is not invertible.

6 Suppose T is a bounded operator on a complex nonzero Banach space V.

(a) Prove that the function

                                (T - I)-1 f

     is analytic on C \ sp(T) for every f  V and every   V.
(b) Prove that sp(T) = .

7 Prove that if T is an operator on a Hilbert space V such that T f , g =  f , Tg
    for all f , g  V, then T is a bounded operator.

8 Suppose P is a bounded operator on a Hilbert space V such that P2 = P. Prove
    that P is self-adjoint if and only if there exists a closed subspace U of V such
    that P = PU.

9 Suppose V is a real Hilbert space and T  B(V). The complexification of T is
    the function TC : VC  VC defined by

                                   TC( f + ig) = T f + iTg

    for f , g  V (see Exercise 4 in Section 8B for the definition of VC).

    (a) Show that TC is a bounded operator on the complex Hilbert space VC and
         TC = T.

    (b) Show that TC is invertible if and only if T is invertible.
    (c) Show that (TC) = (T)C.
    (d) Show that T is self-adjoint if and only if TC is self-adjoint.
    (e) Use the previous parts of this exercise and 10.49 and 10.38 to show that if

         T is self-adjoint and V = {0}, then sp(T) = .

Measure, Integration & Real Analysis, by Sheldon Axler
310 Chapter 10 Linear Maps on Hilbert Spaces

10 Suppose T is a bounded operator on a Hilbert space V such that T f , f   0
      for all f  V. Prove that sp(T)  [0, ).

11 Suppose P is a bounded operator on a Hilbert space V such that P2 = P. Prove
      that P is self-adjoint if and only if P is normal.

12 Prove that a normal operator on a separable Hilbert space has at most countably
      many eigenvalues.

13 Prove or give a counterexample: If T is a normal operator on a Hilbert space and
      T = A + iB, where A and B are self-adjoint, then T = A2 + B2.

A number   F is called an approximate eigenvalue of a bounded operator T on
a Hilbert space V if

                      inf{(T - I) f  : f  V and  f  = 1} = 0.
14 Suppose T is a normal operator on a Hilbert space and   F. Prove that

        sp(T) if and only if  is an approximate eigenvalue of T.
15 Suppose T is a normal operator on a Hilbert space.

      (a) Prove that if  is an eigenvalue of T, then ||2 is an eigenvalue of TT.
      (b) Prove that if   sp(T), then ||2  sp(TT).

16 Suppose {ek}kZ+ is an orthonormal basis of a Hilbert space V. Suppose also
      that T is a normal operator on V and ek is an eigenvector of T for every k  2.
      Prove that e1 is an eigenvector of T.

17 Prove that if T is a self-adjoint operator on a Hilbert space, then Tn = Tn
      for every n  Z+.

18 Prove that if T is a normal operator on a Hilbert space, then Tn = Tn for
      every n  Z+.

19 Suppose T is an invertible operator on a Hilbert space. Prove that T is unitary if
      and only if T = T-1 = 1.

20 Suppose T is a bounded operator on a complex Hilbert space, with T = A + iB,
      where A and B are self-adjoint (see 10.54). Prove that T is unitary if and only if
      T is normal and A2 + B2 = I.
      [If z = x + yi, where x, y  R, then |z| = 1 if and only if x2 + y2 = 1. Thus
      this exercise strengthens the analogy between the unit circle in the complex
      plane and the unitary operators.]

21 Suppose T is a unitary operator on a complex Hilbert space such that T - I is
      invertible. Prove that
                                        i(T + I)(T - I)-1
      is a self-adjoint operator.
      [The function z  i(z + 1)(z - 1)-1 maps {z  C : |z| = 1} \ {1} to R.
      Thus this exercise provides another useful illustration of the analogies showing
      unitary  {z  C : |z| = 1} and self-adjoint  R.]

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                                    Section 10B Spectrum 311
22 Suppose T is a self-adjoint operator on a complex Hilbert space. Prove that

                                        (T + iI)(T - iI)-1
      is a unitary operator.
      [The function z  (z + i)(z - i)-1 maps R to {z  C : |z| = 1} \ {1}.
      Thus this exercise provides another useful illustration of the analogies showing
      (a) unitary  {z  C : |z| = 1}; (b) self-adjoint  R.]
For T a bounded operator on a Banach space, define eT by

                                                       Tk

                                eT =  .

                                                    k=0 k!
23 (a) Prove that if T is a bounded operator on a Banach space V, then the infinite

           sum above converges in B(V) and eT  eT.
      (b) Prove that if S, T are bounded operators on a Banach space V such that

           ST = TS, then eSeT = eS+T.
      (c) Prove that if T is a self-adjoint operator on a complex Hilbert space, then

           eiT is unitary.
A bounded operator T on a Hilbert space is called a partial isometry if

                             T f  =  f  for all f  (null T).
24 Suppose (X, S, µ) is a -finite measure space and h  L(µ). As usual, let

      Mh  B L2(µ) denote the multiplication operator defined by Mh f = f h.
      Prove that Mh is a partial isometry if and only if there exists a set E  S such
      that |h| = E .
25 Suppose T is an isometry on a Hilbert space. Prove that T is a partial isometry.
26 Suppose T is a bounded operator on a Hilbert space V. Prove that T is a partial
      isometry if and only if TT = PU for some closed subspace U of V.

                      Measure, Integration & Real Analysis, by Sheldon Axler
312 Chapter 10 Linear Maps on Hilbert Spaces

10C Compact Operators

The Ideal of Compact Operators

A rich theory describes the behavior of compact operators, which we now define.

  10.66 Definition compact operator; C(V)
    · An operator T on a Hilbert space V is called compact if for every bounded
       sequence f1, f2, . . . in V, the sequence T f1, T f2, . . . has a convergent
       subsequence.
    · The collection of compact operators on V is denoted by C(V).
   The next result provides a large class of examples of compact operators. We will

see more examples after proving a few more results.

  10.67 bounded operators with finite-dimensional range are compact
  If T is a bounded operator on a Hilbert space and range T is finite-dimensional,
  then T is compact.
Proof Suppose T is a bounded operator on a Hilbert space V and range T is
finite-dimensional. Suppose e1, . . . , em is an orthonormal basis of range T (a finite
orthonormal basis of range T exists because the Gram-Schmidt process applied to
any basis of range T produces an orthonormal basis; see the proof of 8.67).
   Now suppose f1, f2, . . . is a bounded sequence in V. For each n  Z+, we have

                        T fn = T fn, e1e1 + · · · + T fn, emem.
The Cauchy-Schwarz inequality shows that |T fn, ej|  T sup  fk for every

                                                                                                  kZ+

n  Z+ and j  {1, . . . , m}. Thus there exists a subsequence fn1 , fn2 , . . . such that
limkT fnk , ej exists in F for each j  {1, . . . , m}. The equation displayed above
now implies that limk T fnk exists in V. Thus T is compact.

   Not every bounded operator is compact. For example, the identity map on an
infinite-dimensional Hilbert space is not compact (to see this, consider an orthonormal
sequence, which does not have a convergent subsequence because the distance
between any two distinct elements of the orthonormal sequence is 2).

  10.68 compact operators are bounded
  Every compact operator on a Hilbert space is a bounded operator.
Proof We show that if T is an operator that is not bounded, then T is not compact.
To do this, suppose V is a Hilbert space and T is an operator on V that is not bounded.
Thus there exists a bounded sequence f1, f2, . . . in V such that limnT fn = .
Hence no subsequence of T f1, T f2, . . . converges, which means T is not compact.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                        Section 10C Compact Operators 313

   If V is a Hilbert space, then a two-        If V is finite-dimensional, then the
sided ideal of B(V) is a subspace of           only two-sided ideals of B(V) are
B(V) that is closed under multiplication       {0} and B(V). In contrast, if V is
on either side by bounded operators on V.
The next result states that the set of com-    infinite-dimensional, then the next
pact operators on V is a two-sided ideal       result shows that B(V) has a closed
of B(V) that is closed in the topology on      two-sided ideal that is neither {0}
B(V) that comes from the norm.                 nor B(V).

10.69 C(V) is a closed two-sided ideal of B(V)

Suppose V is a Hilbert space.
(a) C(V) is a closed subspace of B(V).
(b) If T  C(V) and S  B(V), then ST  C(V) and TS  C(V).

Proof Suppose f1, f2, . . . is a bounded sequence in V.
To prove that C(V) is closed under addition, suppose S, T  C(V). Because
S is compact, S f1, S f2, . . . has a convergent subsequence S fn1 , S fn2 , . . .. Because
T is compact, some subsequence of T fn1 , T fn2 , . . . converges. Thus we have a
subsequence of (S + T) f1, (S + T) f2, . . . that converges. Hence S + T  C(V).
The proof that C(V) is closed under scalar multiplication is easier and is left to
the reader. Thus we now know that C(V) is a subspace of B(V).
To show that C(V) is closed in B(V), suppose T  B(V) and there is a sequence
T1, T2, . . . in C(V) such that limmT - Tm = 0. To show that T is compact, we
need to show that T fn1 , T fn2 , . . . is a Cauchy sequence for some increasing sequence
of positive integers n1 < n2 < · · · .
Because T1 is compact, there is an infinite set Z1  Z+ with T1 fj - T1 fk < 1
for all j, k  Z1. Let n1 be the smallest element of Z1.
Now suppose m  Z+ with m > 1 and an infinite set Zm-1  Z+ and
nm-1  Zm-1 have been chosen. Because Tm is compact, there is an infinite set
Zm  Zm-1 with
                       Tm fj            - Tm fk       1
                                                 <    m

for all j, k  Zm. Let nm be the smallest element of Zm such that nm > nm-1.
   Thus we produce an increasing sequence n1 < n2 < · · · of positive integers and

a decreasing sequence Z1  Z2  · · · of infinite subsets of Z+.
   If m  Z+ and j, k  m, then

T fnj - T fnk   T fnj - Tm fnj  + Tm fnj - Tm fnk  + Tm fnk - T fnk 

                 T  -  Tm (  fnj        +      fnk )  +  1.

                                                         m

We can make the first term on the last line above as small as we want by choosing
m large (because limmT - Tm = 0 and the sequence f1, f2, . . . is bounded).
Thus T fn1 , T fn2 , . . . is a Cauchy sequence, as desired, completing the proof of (a).

   To prove (b), suppose T  C(V) and S  B(V). Hence some subsequence of
T f1, T f2, . . . converges, and applying S to that subsequence gives another convergent
sequence. Thus ST  C(V). Similarly, S f1, S f2, . . . is a bounded sequence, and thus
T(S f1), T(S f2), . . . has a convergent subsequence; thus TS  C(V).

Measure, Integration & Real Analysis, by Sheldon Axler
 100 Chapter 10 Linear Maps on Hilbert Spaces

The previous result now allows us to see many new examples of compact operators.

10.70 compact integral operators
Suppose (X, S, µ) is a -finite measure space, K  L2(µ × µ), and IK is the
integral operator on L2(µ) defined by

                         (IK f )(x) = X K(x, y) f (y) dµ(y)
for f  L2(µ) and x  X. Then IK is a compact operator.

Proof Example 10.5 shows that IK is a bounded operator on L2(µ).
   First consider the case where there exist g, h  L2(µ) such that

10.71       K(x, y) = g(x)h(y)

for almost every (x, y)  X × X. In that case, if f  L2(µ) then

                  (IK f )(x) = X g(x)h(y) f (y) dµ(y) =  f , hg(x)
for almost every x  X. Thus IK f =  f , hg. In other words, IK has a one-
dimensional range in this case (or a zero-dimensional range if g = 0). Hence 10.67
implies that IK is compact.

   Now consider the case where K is a finite sum of functions of the form given by
the right side of 10.71. Then because the set of compact operators on V is closed
under addition [by 10.69(a)], the operator IK is compact in this case.

   Next, consider the case of K  L2(µ × µ) such that K is the limit in L2(µ × µ)
of a sequence of functions K1, K2, . . ., each of which is of the form discussed in the
previous paragraph. Then

                        IK - IKn  = IK-Kn   K - Kn2,
where the inequality above comes from 10.8. Thus IK = limn IKn . By the
previous paragraph, each IKn is compact. Because the set of compact operators is a
closed subset of B(V) [by 10.69(a)], we conclude that IK is compact.

   We finish the proof by showing that the case considered in the previous paragraph
includes all K  L2(µ × µ). To do this, suppose F  L2(µ × µ) is orthogonal to all
the elements of L2(µ × µ) of the form considered in the previous paragraph. Thus

0=     X×X  g(x)h(y) F(x, y) d(µ×µ)(x, y) = g(x) h(y) F(x, y) dµ(y) dµ(x)
            X                   X

for all g, h  L2(µ) where we have used Tonelli's Theorem, Fubini's Theorem, and
Hölder's inequality (with p = 2). For fixed h  L2(µ), the right side above equalling
0 for all g  L2(µ) implies that

                                    h(y) F(x, y) dµ(y) = 0

                                               X

for almost every x  X. Now F(x, y) = 0 for almost every (x, y)  X × X [because
the equation above holds for all h  L2(µ)], which by 8.42 completes the proof.

            Measure, Integration & Real Analysis, by Sheldon Axler
                                                      Section 10C Compact Operators 315

   As a special case of the previous result, we can now see that the Volterra operator
V : L2([0, 1])  L2([0, 1]) defined by

                                                                            x

                                      (V f )(x) = 0 f
is compact. This holds because, as shown in Example 10.15, the Volterra operator is
an integral operator of the type considered in the previous result.

  xThe Volterra operator is injective [because differentiating both sides of the equation
 0 f = 0 with respect to x and using the Lebesgue Differentiation Theorem (4.19)
shows that f = 0]. Thus the Volterra operator is an example of a compact operator
with infinite-dimensional range. The next example provides another class of compact
operators that do not necessarily have finite-dimensional range.

10.72 Example compact multiplication operators on 2
   Suppose b1, b2, . . . is a sequence in F such that limn bn = 0. Define a bounded

linear map T : 2  2 by
                             T(a1, a2, . . .) = (a1b1, a2b2, . . .)

and for n  Z+, define a bounded linear map Tn : 2  2 by
                    Tn(a1, a2, . . .) = (a1b1, a2b2, . . . , anbn, 0, 0, . . .).

Note that each Tn is a bounded operator with finite-dimensional range and thus is
compact (by 10.67). The condition limn bn = 0 implies that limn Tn = T.
Thus T is compact because C(V) is a closed subset of B(V) [by 10.69(a)].

   The next result states that an operator is compact if and only if its adjoint is
compact.

  10.73 T compact  T compact

  Suppose T is a bounded operator on a Hilbert space. Then T is compact if and
  only if T is compact.

Proof First suppose T is compact. We want to prove that T is compact. To do
this, suppose f1, f2, . . . is a bounded sequence in V. Because TT is compact [by
10.69(b)], some subsequence TT fn1 , TT fn2 , . . . converges. Now

                 T fnj - T fnk 2 = T( fnj - fnk ), T( fnj - fnk )
                                       = TT( fnj - fnk ), fnj - fnk
                                        TT( fnj - fnk )  fnj - fnk .

The inequality above implies that T fn1 , T fn2 , . . . is a Cauchy sequence and hence
converges. Thus T is a compact operator, completing the proof that if T is compact,
then T is compact.

   Now suppose T is compact. By the result proved in the paragraph above, (T)
is compact. Because (T) = T (see 10.11), we conclude that T is compact.

                      Measure, Integration & Real Analysis, by Sheldon Axler
316 Chapter 10 Linear Maps on Hilbert Spaces

Spectrum of Compact Operator and Fredholm Alternative

We noted earlier that the identity map on an infinite-dimensional Hilbert space is not
compact. The next result shows that much more is true.

10.74 no infinite-dimensional closed subspace in range of compact operator

The range of each compact operator on a Hilbert space contains no infinite-
dimensional closed subspaces.

Proof Suppose T is a bounded operator on a Hilbert space V and U is an infinite-
dimensional closed subspace contained in range T. We want to show that T is not
compact.

   Because T is a continuous operator, T-1(U) is a closed subspace of V. Let
S = T|T-1(U). Thus S is a surjective bounded linear map from the Hilbert space
T-1(U) onto the Hilbert space U [here T-1(U) and U are Hilbert spaces by 6.16(b)].
The Open Mapping Theorem (6.81) implies S maps the open unit ball of T-1(U) to
an open subset of U. Thus there exists r > 0 such that

10.75  {g  U : g < r}  {T f : f  T-1(U) and  f  < 1}.

Because U is an infinite-dimensional Hilbert space, there exists an orthonormal
sequence e1, e2, . . . in U, as can be seen by applying the Gram-Schmidt process (see
                                                                                 ren
the proof of 8.67) to any linearly independent sequence in U. Each 2 is in the left
side of 10.75. Thus for each n  Z+, there exists fn  T-1(U) such that  fn < 1
              ren
and T fn = . The sequence f1, f2, . . . is bounded, but the sequence T f1, T f2, . . .
       2                                      
has no convergent subsequence because rej - rek = 2r for j = k. Thus T is
                          22                  2
not compact, as desired.

   Suppose T is a compact operator on an infinite-dimensional Hilbert space. The
result above implies that T is not surjective. In particular, T is not invertible. Thus
we have the following result.

  10.76 compact implies not invertible on infinite-dimensional Hilbert spaces

  If T is a compact operator on an infinite-dimensional Hilbert space, then
  0  sp(T).

   Although 10.74 shows that if T is compact then range T contains no infinite-
dimensional closed subspaces, the next result shows that the situation differs drasti-
cally for T - I if   F \ {0}.

   The proof of the next result makes use of the restriction of T - I to the closed

                                       

subspace null(T - I) . As motivation for considering this restriction, recall that
each f  V can be written uniquely as f = g + h, where g  null(T - I) and
h  null(T - I)  (see 8.43). Thus (T - I) f = (T - I)h, which implies that
range(T - I) = (T - I) null(T - I)  .

                     Measure, Integration & Real Analysis, by Sheldon Axler
                         Section 10C Compact Operators 317

10.77 closed range

If T is a compact operator on a Hilbert space, then T - I has closed range for
every   F with  = 0.

Proof Suppose T is a compact operator on a Hilbert space V and   F is such that
 = 0.

10.78  Claim: there exists r > 0 such that

                                                                                               

                f   r(T - I) f  for all f  null(T - I) .

To prove the claim above, suppose it is false. Then for each n  Z+, there exists
fn  null(T - I)  such that

        fn = 1      and  (T                 - I) fn  <  1.

                                                        n

Because T is compact, there exists a subsequence T fn1 , T fn2 , . . . such that

10.79               lim T fnk = g

                    k

for some g  V. Subtracting the equation

10.80               lim (T - I) fnk = 0

                    k

from 10.79 and then dividing by  shows that

                    lim  fnk             =   1 g.
                    k
                                             

The equation above implies g = ||; hence g = 0. Each fnk  null(T - I) ;

                                                                          

hence we also conclude that g  null(T - I) . Applying T - I to both sides of
the equation above and using 10.80 shows that g  null(T - I). Thus g is a nonzero
element of both null(T - I) and its orthogonal complement. This contradiction
completes the proof of the claim in 10.78.

   To show that range(T - I) is closed, suppose h1, h2, . . . is a sequence in
range(T - I) that converges to some h  V. For each n  Z+, there exists
fn  null(T - I)  such that (T - I) fn = hn. Because h1, h2, . . . is a Cauchy
sequence, 10.78 shows that f1, f2, . . . is also a Cauchy sequence. Thus there exists
f  V such that limn fn = f , which implies h = (T - I) f  range(T - I).
Hence range(T - I) is closed.

   Suppose T is a compact operator on a Hilbert space V and f  V and   F \ {0}.
An immediate consequence (often useful when investigating integral equations) of
the result above and 10.13(d) is that the equation

                                        Tg - g = f
has a solution g  V if and only if  f , h = 0 for every h  V such that Th = h.

                     Measure, Integration & Real Analysis, by Sheldon Axler
318 Chapter 10 Linear Maps on Hilbert Spaces

  10.81 Definition geometric multiplicity
    · The geometric multiplicity of an eigenvalue  of an operator T is defined to
       be the dimension of null(T - I).
    · In other words, the geometric multiplicity of an eigenvalue  of T is the
       dimension of the subspace consisting of 0 and all the eigenvectors of T
       corresponding to .
   There exist compact operators for which the eigenvalue 0 has infinite geometric

multiplicity. The next result shows that this cannot happen for nonzero eigenvalues.

  10.82 nonzero eigenvalues of compact operators have finite multiplicity
  Suppose T is a compact operator on a Hilbert space and   F with  = 0. Then
  null(T - I) is finite-dimensional.
Proof Suppose f  null(T - I). Then f = T f . Hence f  range T.
   Thus we have shown that null(T - I)  range T. Because T is continuous,
null(T - I) is closed. Thus 10.74 implies that null(T - I) is finite-dimensional.
   The next lemma is used in our proof of the Fredholm Alternative (10.85). Note
that this lemma implies that every injective operator on a finite-dimensional vector
space is surjective (because a finite-dimensional vector space cannot have an infinite
chain of strictly decreasing subspaces--the dimension decreases by at least 1 in each
step). Also, see Exercise 10 for the analogous result implying that every surjective
operator on a finite-dimensional vector space is injective.

10.83 injective but not surjective

If T is an injective but not surjective operator on a vector space, then
                     range T  range T2  range T3  · · · .

Proof Suppose T is an injective but not surjective operator on a vector space V.
Suppose n  Z+. If g  V, then

       Tn+1g = Tn(Tg)  range Tn.

Thus range Tn  range Tn+1.
   To show that the last inclusion is not an equality, note that because T is not

surjective, there exists f  V such that

10.84  f / range T.

Now Tn f  range Tn. However, Tn f / range Tn+1 because if g  V and
Tn f = Tn+1g, then Tn f = Tn(Tg), which would imply that f = Tg (because Tn
is injective), which would contradict 10.84. Thus range Tn  range Tn+1.

                     Measure, Integration & Real Analysis, by Sheldon Axler
       Section 10C Compact Operators 319

   Compact operators behave, in some respects, like operators on a finite-dimensional
vector space. For example, the following important theorem should be familiar to you
in the finite-dimensional context (where the choice of  = 0 need not be excluded).

10.85 Fredholm Alternative
Suppose T is a compact operator on a Hilbert space and   F with  = 0. Then
the following are equivalent.
(a)   sp(T).
(b)  is an eigenvalue of T.
(c) T - I is not surjective.

Proof Clearly (b) implies (a) and (c) implies (a).
   To prove that (a) implies (b), suppose   sp(T) but  is not an eigenvalue of T.

Thus T - I is injective but T - I is not surjective. Thus 10.83 applied to T - I
shows that

10.86  range(T - I)  range(T - I)2  range(T - I)3  · · · .

If n  Z+, then the Binomial Theorem and 10.69 show that

       (T - I)n = S + (-)n I

for some compact operator S. Now 10.77 shows that range(T - I)n is a closed
subspace of the Hilbert space on which T operates. Thus 10.86 implies that for each
n  Z+, there exists

10.87  fn  range(T - I)n  range(T - I)n+1 

such that  fn = 1.
   Now suppose j, k  Z+ with j < k. Then

10.88  T fj - T fk = (T - I) fj - (T - I) fk -  fk +  fj.

Because fj and fk are both in range(T - I)j, the first two terms on the right side of
10.88 are in range(T - I)j+1. Because j + 1  k, the third term in 10.88 is also in
range(T - I)j+1. Now 10.87 implies that the last term in 10.88 is orthogonal to
the sum of the first three terms. Thus 10.88 leads to the inequality

                               T fj - T fk   fj = ||.
The inequality above implies that T f1, T f2, . . . has no convergent subsequence, which
contradicts the compactness of T. This contradiction means the assumption that  is
not an eigenvalue of T was false, completing the proof that (a) implies (b).

   At this stage, we know that (a) and (b) are equivalent and that (c) implies (a). To
prove that (a) implies (c), suppose   sp(T). Thus   sp(T). Applying the
equivalence of (a) and (b) to T, we conclude that  is an eigenvalue of T. Thus
applying 10.13(d) to T - I shows that T - I is not surjective, completing the proof
that (a) implies (c).

       Measure, Integration & Real Analysis, by Sheldon Axler
320 Chapter 10 Linear Maps on Hilbert Spaces

   The previous result traditionally has the word alternative in its name because it
can be rephrased as follows.

      If T is a compact operator on a Hilbert space V and   F \ {0}, then
      exactly one of the conditions below holds.

        · The equation T f =  f has a nonzero solution f  V.
        · The equation g = T f -  f has a solution f  V for every g  V.
   The next example shows the power of the Fredholm Alternative. In this example,
we want to show that V - I is invertible for all   F \ {0}. The verification
that V - I is injective is straightforward. Showing that V - I is surjective would
require more work. However, the Fredholm Alternative tells us, with no further work,
that V - I is invertible.

10.89 Example spectrum of the Volterra operator

   We want to show that the spectrum of the Volterra operator V is {0} (see Example
10.15 for the definition of V). The Volterra operator V is compact (see the comment
after the proof of 10.70). Thus 0  sp(V ), by 10.76.

   Suppose   F \ {0}. To show that  / sp(V ), we need only show that  is not
an eigenvalue of V (by 10.85). Thus suppose f  L2([0, 1]) and V f =  f . Hence

10.90   x

       0 f =  f (x)

for almost every x  [0, 1]. The left side of 10.90 is a continuous function of x and
thus so is the right side, which implies that f is continuous. The continuity of f
now implies that the left side of 10.90 has a continuous derivative, and thus f has a
continuous derivative.

   Now differentiate both sides of 10.90 with respect to x, getting

       f (x) =  f (x)

for all x  (0, 1). Standard calculus shows that the equation above implies that

       f (x) = cex/

for some constant c. However, 10.90 implies that the continuous function f must
satisfy the equation f (0) = 0. Thus c = 0, which implies f = 0.

   The conclusion of the last paragraph shows that  is not an eigenvalue of V. The
Fredholm Alternative (10.85) now shows that  / sp(V ). Thus sp(V ) = {0}.

   If  is an eigenvalue of an operator T on a finite-dimensional Hilbert space,
then  is an eigenvalue of T. This result does not hold for bounded operators on
infinite-dimensional Hilbert spaces.

   However, suppose T is a compact operator on a Hilbert space and  is a nonzero
eigenvalue of T. Thus   sp(T), which implies that   sp(T) (because a
bounded operator is invertible if and only if its adjoint is invertible). The Fredholm
Alternative (10.85) now shows that  is an eigenvalue of T. Thus compactness
allows us to recover the finite-dimensional result (except for the case  = 0).

       Measure, Integration & Real Analysis, by Sheldon Axler
       Section 10C Compact Operators 321

   Our next result states that if T is a compact operator and  = 0, then null(T - I)
and null(T - I) have the same dimension (denoted dim). This result about
the dimensions of spaces of eigenvectors is easier to prove in finite dimensions.
Specifically, suppose S is an operator on a finite-dimensional Hilbert space V (you
can think of S = T - I). Then

     dim null S = dim V - dim range S = dim(range S) = dim null S,
where the justification for each step should be familiar to you from finite-dimensional
linear algebra. This finite-dimensional proof does not work in infinite dimensions
because the expression dim V - dim range S could be of the form  - .

   Although the dimensions of the two null spaces in the result below are the same,
even in finite dimensions the two null spaces are not necessarily equal to each other
(but we do have equality of the two null spaces when T is normal; see 10.56).

   Note that both dimensions in the result below are finite (by 10.82 and 10.73).

10.91 null spaces of T - I and T - I have same dimensions

Suppose T is a compact operator on a Hilbert space and   F with  = 0. Then
                     dim null(T - I) = dim null(T - I).

Proof Suppose dim null(T - I) < dim null(T - I). Because null(T - I)

                                      

equals range(T - I) , there is a bounded injective linear map

       R : null(T - I)  range(T - I) 

that is not surjective. Let V denote the Hilbert space on which T operates, and let P
be the orthogonal projection of V onto null(T - I). Define a linear map S : V  V
by

                                        S = T + RP.
Because RP is a bounded operator with finite-dimensional range, S is compact. Also,

       S - I = (T - I) + RP.

   Every element of range(T - I) is orthogonal to every element of range RP.
Suppose f  V and (S - I) f = 0. The equation above shows that (T - I) f = 0
and RP f = 0. Because f  null(T - I), we see that P f = f , which then implies
that R f = RP f = 0, which then implies that f = 0 (because R is injective). Hence
S - I is injective.

                                                                                                           

   However, because R maps onto a proper subset of range(T - I) , we see that
S - I is not surjective, which contradicts the equivalence of (b) and (c) in 10.85. This
contradiction means the assumption that dim null(T - I) < dim null(T - I)
was false. Hence we have proved that

10.92  dim null(T - I)  dim null(T - I)

for every compact operator T and every   F \ {0}.
   Now apply the conclusion of the previous paragraph to T (which is compact by

10.73) and , getting 10.92 with the inequality reversed, completing the proof.

       Measure, Integration & Real Analysis, by Sheldon Axler
322 Chapter 10 Linear Maps on Hilbert Spaces

   The spectrum of an operator on a finite-dimensional Hilbert space is a finite set,
consisting just of the eigenvalues of the operator. The spectrum of a compact operator
on an infinite-dimensional Hilbert space can be an infinite set. However, our next
result implies that if a compact operator has infinite spectrum, then that spectrum
consists of 0 and a sequence in F with limit 0.

10.93 spectrum of a compact operator

Suppose T is a compact operator on a Hilbert space. Then
                                {  sp(T) : ||  }

is a finite set for every  > 0.

Proof Fix  > 0. Suppose there exist distinct 1, 2, . . . in sp(T) with |n|  
for every n  Z+. The Fredholm Alternative (10.85) implies that each n is an
eigenvalue of T. For n  Z+, let

       Un = null (T - 1 I) · · · (T - n I)

and let U0 = {0}. Because T is continuous, each Un is a closed subspace of the
Hilbert space on which T operates. Furthermore, Un-1  Un for each n  Z+
because operators of the form T - j I and T - k I commute with each other.

   If n  Z+ and g is an eigenvector of T corresponding to the eigenvalue n, then
g  Un but g / Un-1 because

       (T - 1 I) · · · (T - n-1 I)g = (n - 1) · · · (n - n-1)g = 0.

In other words, we have U1  U2  U3  · · · .
Thus for each n  Z+, there exists

10.94  en  Un  Un-1

such that en = 1.
   Now suppose j, k  Z+ with j < k. Then

10.95  Tej - Tek = (T - j I)ej - (T - k I)ek + jej - kek.

Because j  k - 1, the first three terms on the right side of 10.95 are in Uk-1. Now
10.94 implies that the last term in 10.95 is orthogonal to the sum of the first three
terms. Thus 10.95 leads to the inequality

       Tej - Tek  kek = |k|  .

The inequality above implies that Te1, Te2, . . . has no convergent subsequence, which
contradicts the compactness of T. This contradiction means that the assumption that
sp(T) contains infinitely many elements with absolute value at least  was false.

       Measure, Integration & Real Analysis, by Sheldon Axler
                  Section 10C Compact Operators 323

EXERCISES 10C

1 Prove that if T is a compact operator on a Hilbert space V and e1, e2, . . . is an
    orthonormal sequence in V, then limn Ten = 0.

2 Prove that if T is a compact operator on L2([0, 1]), then lim nT(xn)2 = 0,

                                                                                         n

    where xn means the element of L2([0, 1]) defined by x  xn.
3 Suppose T is a compact operator on a Hilbert space V and f1, f2, . . . is a

    sequence in V such that limn fn, g = 0 for every g  V. Prove that
    limnT fn = 0.
4 Suppose h  L(R). Define Mh  B L2(R) by Mh f = f h. Prove that if
    h > 0, then Mh is not compact.
5 Suppose (b1, b2, . . .)  . Define T : 2  2 by

                              T(a1, a2, . . .) = (a1b1, a2b2, . . .).
    Prove that T is compact if and only if lim bn = 0.

                                                                n

6 Suppose T is a bounded operator on a Hilbert space V. Prove that if there exists
    an orthonormal basis {ek}k of V such that

                               Tek2 < ,

                                                     k

    then T is compact.
7 Suppose T is a bounded operator on a Hilbert space V. Prove that if {ek}k

    and { fj}j are orthonormal bases of V, then

                Tek2 =  T fj2.
               k  j

 8 Suppose T is a bounded operator on a Hilbert space. Prove that T is compact if
      and only if TT is compact.

 9 Prove that if T is a compact operator on an infinite-dimensional Hilbert space,
      then I - T  1.

10 Show that if T is a surjective but not injective operator on a vector space V, then
                              null T  null T2  null T3  · · · .

11 Suppose T is a compact operator on a Hilbert space and   F \ {0}.

      (a) Prove that range(T - I)m-1 = range(T - I)m for some m  Z+.
      (b) Prove that null(T - I)n-1 = null(T - I)n for some n  Z+.
      (c) Show that the smallest positive integer m that works in (a) equals the

           smallest positive integer n that works in (b).

Measure, Integration & Real Analysis, by Sheldon Axler
324 Chapter 10 Linear Maps on Hilbert Spaces

12 Prove that if f : [0, 1]  F is a continuous function, then there exists a continu-
      ous function g : [0, 1]  F such that

                                                                                   x

                                       f (x) = g(x) + 0 g
      for all x  [0, 1].
13 Suppose S is a bounded invertible operator on a Hilbert space V and T is a
      compact operator on V.
      (a) Prove that S + T has closed range.
      (b) Prove that S + T is injective if and only if S + T is surjective.
      (c) Prove that null(S + T) and null(S + T) are finite-dimensional.
      (d) Prove that dim null(S + T) = dim null(S + T).
      (e) Prove that there exists R  B(V) such that range R is finite-dimensional

           and S + T + R is invertible.

14 Suppose T is a compact operator on a Hilbert space V. Prove that range T is a
      separable subspace of V.

15 Suppose T is a compact operator on a Hilbert space V and e1, e2, . . . is an
      orthonormal basis of range T. Let Pn denote the orthogonal projection of V
      onto span{e1, . . . , en}.
      (a) Prove that lim T - PnT = 0.

                               n

      (b) Prove that a bounded operator on a Hilbert space V is compact if and
           only if it is the limit in B(V) of a sequence of bounded operators with
           finite-dimensional range.

16 Prove that if T is a compact operator on a Hilbert space V, then there exists a
      sequence S1, S2, . . . of invertible operators on V such that lim T - Sn = 0.

                                                                                                 n

17 Suppose T is a bounded operator on a Hilbert space such that p(T) is compact
      for some nonzero polynomial p with coefficients in F. Prove that sp(T) is a
      countable set.

Suppose T is a bounded operator on a Hilbert space. The algebraic multiplicity of
an eigenvalue  of T is defined to be the dimension of the subspace

                                                       

                                            null(T - I)n.

                                                   n=1

As an easy example, if T is the left shift as defined in the next exercise, then the
eigenvalue 0 of T has geometric multiplicity 1 but algebraic multiplicity .

The definition above of algebraic multiplicity is equivalent on finite-dimensional
spaces to the common definition involving the multiplicity of a root of the charac-
teristic polynomial. However, the definition used here is cleaner (no determinants
needed) and has the advantage of working on infinite-dimensional Hilbert spaces.

                      Measure, Integration & Real Analysis, by Sheldon Axler
                                                      Section 10C Compact Operators 325

18 Suppose T  B 2 is defined by T(a1, a2, a3, . . .) = (a2, a3, a4, . . .). Suppose
      also that   F and || < 1.
      (a) Show that the geometric multiplicity of  as an eigenvalue of T equals 1.
      (b) Show that the algebraic multiplicity of  as an eigenvalue of T equals .

19 Prove that the geometric multiplicity of an eigenvalue of a normal operator on a
      Hilbert space equals the algebraic multiplicity of that eigenvalue.

20 Prove that every nonzero eigenvalue of a compact operator on a Hilbert space
      has finite algebraic multiplicity.

21 Prove that if T is a compact operator on a Hilbert space and  is a nonzero
      eigenvalue of T, then the algebraic multiplicity of  as an eigenvalue of T equals
      the algebraic multiplicity of  as an eigenvalue of T.

22 Prove that if V is a separable Hilbert space, then C(V), the Banach space of
      compact operators on V, is separable.

                      Measure, Integration & Real Analysis, by Sheldon Axler
326 Chapter 10 Linear Maps on Hilbert Spaces

10D Spectral Theorem for Compact
       Operators

Orthonormal Bases Consisting of Eigenvectors

We begin this section with the following useful lemma.

10.96 TT - T2 I is not invertible

If T is a bounded operator on a nonzero Hilbert space, then T2  sp(TT).

Proof Suppose T is a bounded operator on a nonzero Hilbert space V. Let f1, f2, . . .
be a sequence in V such that  fn = 1 for each n  Z+ and

10.97                 lim T fn = T.

                      n

Then   TT fn - T2 fn  2 = TT fn2 - 2T2TT fn, fn + T4
10.98                   = TT fn2 - 2T2 T fn2 + T4
                         2T4 - 2T2 T fn2,

where the last line holds because TT fn  T T fn  T2. Now 10.97 and
10.98 imply that

                                lim (TT - T2 I) fn = 0.

                                          n

Because  fn = 1 for each n  Z+, the equation above implies that TT - T2 I
is not invertible, as desired.

   The next result indicates one way in which self-adjoint compact operators behave
like self-adjoint operators on finite-dimensional Hilbert spaces.

  10.99 every self-adjoint compact operator has an eigenvalue.
  Suppose T is a self-adjoint compact operator on a nonzero Hilbert space. Then
  either T or -T is an eigenvalue of T.
Proof Because T is self-adjoint, 10.96 states that T2 - T2 I is not invertible. Now

                        T2 - T2 I = T - TI T + TI .
Thus T - TI and T + TI cannot both be invertible. Hence T  sp(T) or
-T  sp(T). Because T is compact, 10.85 now implies that T or -T is an
eigenvalue of T, as desired, or that T = 0, which means that T = 0, in which case
0 is an eigenvalue of T.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                        Section 10D Spectral Theorem for Compact Operators 327

   If T is an operator on a vector space V and U is a subspace of V, then T|U is a
linear map from U to V. For T|U to be an operator (meaning that it is a linear map
from a vector space to itself), we need T(U)  U. Thus we are led to the following
definition.

  10.100 Definition invariant subspace
  Suppose T is an operator on a vector space V. A subspace U of V is called an
  invariant subspace for T if T f  U for every f  U.

10.101 Example invariant subspaces
   You should verify each of the assertions below.
  · For b  [0, 1], the subspace
                   { f  L2([0, 1]) : f (t) = 0 for almost every t  [0, b]}
     is an invariant subspace for the Volterra operator V : L2([0, 1])  L2([0, 1])

                                               x

     defined by (V f )(x) = 0 f .
  · Suppose T is an operator on a Hilbert space V and f  V with f = 0. Then

     span{ f } is an invariant subspace for T if and only if f is an eigenvector of T.
  · Suppose T is an operator on a Hilbert space V. Then {0}, V, null T, and range T

     are invariant subspaces for T.
  · If T is a bounded operator on a Hilbert space and U is an invariant subspace for

     T, then U is an invariant subspace for T.

   If T is a compact operator on a Hilbert    The most important open question in
space and U is a closed invariant subspace    operator theory is the invariant
for T, then T|U is a compact operator on      subspace problem, which asks
U, as follows from the definitions.           whether every bounded operator on
                                              a Hilbert space with dimension
   If U is a closed invariant subspace for    greater than 1 has a closed invariant
a self-adjoint operator T, then T|U is self-  subspace other than {0} and V.
adjoint because

                   (T|U) f , g = T f , g =  f , Tg =  f , (T|U)g
for all f , g  U. The next result shows that a bit more is true.

10.102 U invariant for self-adjoint T implies U invariant for T
Suppose U is an invariant subspace for a self-adjoint operator T. Then
(a) U is also an invariant subspace for T;
(b) T|U is a self-adjoint operator on U.

Measure, Integration & Real Analysis, by Sheldon Axler
328 Chapter 10 Linear Maps on Hilbert Spaces

Proof To prove (a), suppose f  U. If g  U, then
                                  T f , g =  f , Tg = 0,

where the first equality holds because T is self-adjoint and the second equality holds
because Tg  U and f  U. Because the equation above holds for all g  U, we
conclude that T f  U. Thus U is an invariant subspace for T, proving (a).

   By (a), we can think of T|U as an operator on U. To prove (b), suppose h  U.
If f  U, then

          f , (T|U )h = T|U f , h = T f , h =  f , Th =  f , T|U h.
Because (T|U )h and T|U h are both in U and the equation above holds for all
f  U, we conclude that (T|U )h = T|U h, proving (b).

   Operators for which there exists an orthonormal basis consisting of eigenvectors
may be the easiest operators to understand. The next result states that any such
operator must be self-adjoint in the case of a real Hilbert space and normal in the
case of a complex Hilbert space.

10.103 orthonormal basis of eigenvectors implies self-adjoint or normal

Suppose T is a bounded operator on a Hilbert space V and there is an orthonormal
basis of V consisting of eigenvectors of T.

(a) If F = R, then T is self-adjoint.
(b) If F = C, then T is normal.

Proof Suppose {ej}j is an orthonormal basis of V such that ej is an eigenvector
of T for each j  . Thus there exists a family {j}j in F such that

10.104                           Tej = jej

for each j  . If k   and f  V, then

 f , Tek = T f , ek = T  f , ejej , ek

                                             j

        =  j f , ejej, ek = k f , ek =  f , kek.

              j

The equation above implies that

10.105                           Tek = kek.

   To prove (a), suppose F = R. Then 10.105 and 10.104 imply Tek = kek = Tek
for each k  . Hence T = T, completing the proof of (a).

   To prove (b), now suppose F = C. If k  , then 10.105 and 10.104 imply that

        (TT)(ek) = T(kek) = |k|2ek = T(kek) = (TT)(ek).

Because the equation above holds for all k  , we conclude that TT = TT. Thus
T is normal, completing the proof of (b).

        Measure, Integration & Real Analysis, by Sheldon Axler
Section 10D Spectral Theorem for Compact Operators 329

   The next result is one of the major highlights of the theory of compact operators
on Hilbert spaces. The result as stated below applies to both real and complex Hilbert
spaces. In the case of a real Hilbert space, the result below can be combined with
10.103(a) to produce the following result: A compact operator on a real Hilbert
space is self-adjoint if and only if there is an orthonormal basis of the Hilbert space
consisting of eigenvectors of the operator.

10.106 Spectral Theorem for self-adjoint compact operators

Suppose T is a self-adjoint compact operator on a Hilbert space V. Then
(a) there is an orthonormal basis of V consisting of eigenvectors of T;
(b) there is a countable set , an orthonormal family {ek}k in V, and a family

     {k}k in R \ {0} such that

                           T f =  k f , ekek

                                                         k

     for every f  V.

Proof Let U denote the span of all the eigenvectors of T. Then U is an invariant
subspace for T. Hence U is also an invariant subspace for T and T|U is a self-
adjoint operator on U (by 10.102). However, T|U has no eigenvalues, because
all the eigenvectors of T are in U. Because all self-adjoint compact operators on a
nonzero Hilbert space have an eigenvalue (by 10.99), this implies that U = {0}.
Hence U = V (by 8.42).

   For each eigenvalue  of T, there is an orthonormal basis of null(T - I) consist-
ing of eigenvectors corresponding to the eigenvalue . The union (over all eigenvalues
 of T) of all these orthonormal bases is an orthonormal family in V because eigen-
vectors corresponding to distinct eigenvalues are orthogonal (see 10.57). The previous
paragraph tells us that the closure of the span of this orthonormal family is V (here
we are using the set itself as the index set). Hence we have an orthonormal basis of
V consisting of eigenvectors of T, completing the proof of (a).

   By (a), there is an orthonormal basis {ek}k of V and a family {k}k in R
such that Tek = kek for each k   (even if F = C, the eigenvalues of T are in R
by 10.49). Thus if f  V, then

T f = T   f , ekek =   f , ekTek =  k f , ekek.
k  k                  k

Letting  = {k   : k = 0}, we can rewrite the equation above as

   T f =  k f , ekek

             k

for every f  V. The set  is countable because T has only countably many
eigenvalues (by 10.93) and each nonzero eigenvalue can appear only finitely many
times in the sum above (by 10.82), completing the proof of (b).

Measure, Integration & Real Analysis, by Sheldon Axler
330 Chapter 10 Linear Maps on Hilbert Spaces

   A normal compact operator on a nonzero real Hilbert space might have no eigen-
values [consider, for example the normal operator T of counterclockwise rotation by
a right angle on R2 defined by T(x, y) = (-y, x)]. However, the next result shows
that normal compact operators on complex Hilbert spaces behave better. The key idea
in proving this result is that on a complex Hilbert space, the real and imaginary parts
of a normal compact operator are commuting self-adjoint compact operators, which
then allows us to apply the Spectral Theorem for self-adjoint compact operators.

  10.107 Spectral Theorem for normal compact operators
  Suppose T is a compact operator on a complex Hilbert space V. Then there is an
  orthonormal basis of V consisting of eigenvectors of T if and only if T is normal.
Proof One direction of this result has already been proved as part (b) of 10.103.
   To prove the other direction, suppose T is a normal compact operator. We can
write

                                         T = A + iB,
where A and B are self-adjoint operators and, because T is normal, AB = BA (see
10.54). Because A = (T + T)/2 and B = (T - T)/(2i), the operators A and B
are both compact.

   If   R and f  null(A - I), then
(A - I)(B f ) = A(B f ) - B f = B(A f ) - B f = B (A - I) f = B(0) = 0
and thus B f  null(A - I). Hence null(A - I) is an invariant subspace for B.

   Applying the Spectral Theorem for self-adjoint compact operators [10.106(a)] to
B|null(A-I) shows that for each eigenvalue  of A, there is an orthonormal basis of
null(A - I) consisting of eigenvectors of B. The union (over all eigenvalues  of
A) of all these orthonormal bases is an orthonormal family in V (use the set itself as
the index set) because eigenvectors of A corresponding to distinct eigenvalues of A
are orthogonal (see 10.57). The Spectral Theorem for self-adjoint compact operators
[10.106(a)] as applied to A tells us that the closure of the span of this orthonormal
family is V. Hence we have an orthonormal basis of V, each of whose elements is an
eigenvector of A and an eigenvector of B.

   If f  V is an eigenvector of both A and B, then there exist ,   R such
that A f =  f and B f =  f . Thus T f = (A + iB)( f ) = ( + i) f ; hence f is
an eigenvector of T. Thus the orthonormal basis of V constructed in the previous
paragraph is an orthonormal basis consisting of eigenvectors of T, completing the
proof.

   The following example shows the power of the Spectral Theorem for normal
compact operators. Finding the eigenvalues and eigenvectors of the normal compact
operator V - V  in the next example leads us to an orthonormal basis of L2([0, 1]).
Easy calculus shows that the family {ek}kZ, where ek is defined as in 10.112, is
an orthonormal family in L2([0, 1]). The hard part of showing that {ek}kZ is an
orthonormal basis of L2([0, 1]) is to show that the closure of the span of this family
is L2([0, 1]). However, the Spectral Theorem for normal compact operators (10.107)
provides this information with no further work required.

                      Measure, Integration & Real Analysis, by Sheldon Axler
        Section 10D Spectral Theorem for Compact Operators 331

10.108 Example an orthonormal basis of eigenvectors

Suppose V : L2([0, 1])  L2([0, 1]) is the Volterra operator defined by

                                  x

           (V f )(x) = 0 f .

The operator V is compact (see the paragraph after the proof of 10.70), but it is not
normal. Because V is compact, so is V  (by 10.73). Hence V - V  is compact. Also,
(V - V ) = V  - V = -(V - V ). Because every operator commutes with its
negative, we conclude that V - V  is a compact normal operator. Because we want
to apply the Spectral Theorem, for the rest of this example we will take F = C.

   If f  L2([0, 1]) and x  [0, 1], then the formula for V  given by 10.16 shows
that

              x                         1
           V - V) f (x) = 2 f - f .
10.109  (  0                         0

The right side of the equation above is a continuous function of x whose value at
x = 0 is the negative of its value at x = 1.

   Differentiating both sides of the equation above and using the Lebesgue Differen-
tiation Theorem (4.19) shows that

           (V - V) f (x) = 2 f (x)

for almost every x  [0, 1]. If f  null(V - V ), then differentiating both sides
of the equation (V - V ) f = 0 shows that 2 f (x) = 0 for almost every x  [0, 1];
hence f = 0, and we conclude that V - V  is injective (so 0 is not an eigenvalue).

   Suppose f is an eigenvector of V - V  with eigenvalue . Thus f is in the range
of V - V , which by 10.109 implies that f is continuous on [0, 1], which by 10.109
again implies that f is continuously differentiable on (0, 1). Differentiating both
sides of the equation (V - V ) f =  f gives

           2 f (x) =  f (x)

for all x  (0, 1). Hence the function whose value at x is e-(2/)x f (x) has derivative
0 everywhere on (0, 1) and thus is a constant function. In other words,

10.110     f (x) = ce(2/)x

for some constant c = 0. Because f  range(V - V ), we have f (0) = - f (1),
which with the equation above implies that there exists k  Z such that

10.111     2/ = i(2k + 1).

   Replacing 2/ in 10.110 with the value of 2/ derived in 10.111 shows that for
k  Z, we should define ek  L2([0, 1]) by

10.112     ek(x) = ei(2k+1)x.

Clearly {ek}kZ is an orthonormal family in L2([0, 1]) [the orthogonality can be
verified by a straightforward calculation or by using 10.57]. The paragraph above
and the Spectral Theorem for compact normal operators (10.107) imply that this
orthonormal family is an orthonormal basis of L2([0, 1]).

        Measure, Integration & Real Analysis, by Sheldon Axler
332 Chapter 10 Linear Maps on Hilbert Spaces

Singular Value Decomposition

The next result provides an important generalization of 10.106(b) to arbitrary compact
operators that need not be self-adjoint or normal. This generalization requires two
orthonormal families, as compared to the single orthonormal family in 10.106(b).

10.113 Singular Value Decomposition

Suppose T is a compact operator on a Hilbert space V. Then there exist a
countable set , orthonormal families {ek}k and {hk}k in V, and a family
{sk}k of positive numbers such that

10.114                  T f =  sk f , ekhk

                                  k

for every f  V.

Proof If  is an eigenvalue of TT, then (TT) f =  f for some f = 0 and

         f 2 =  f , f  = TT f , f  = T f , T f  = T f 2.

Thus   0. Hence all eigenvalues of TT are nonnegative.
   Apply 10.106(b) and the conclusion of the paragraph above to the self-adjoint

compact operator TT, getting a countable set , an orthonormal family {ek}k in
                                                                  

V, and a family {sk}k of positive numbers (take sk = k ) such that

10.115              (TT) f =  sk2 f , ekek

                                     k

for every f  V. The equation above implies that (TT)ej = sj2ej for each j  .
   For k  , let
                                          hk = Tes kk .

For j, k  , we have

        hj, hk = 1 sjsk Tej, Tek = 1 sjsk TTej, ek = sjsk ej, ek.

The equation above implies that {hk}k is an orthonormal family in V.
   If f  span {ek}k , then

        T f = T   f , ekek =   f , ekTek =  sk f , ekhk,
                 k                      k               k

showing that 10.114 holds for such f .

If f    span {ek}k      then  10.115       shows  that  (TT)  f  =  0, which implies

                     ,
that T f = 0 (because 0 = TT f , f  = T f 2); thus both sides of 10.114 are 0.
Hence the two sides of 10.114 agree for f in a closed subspace of V and for f in
the orthogonal complement of that closed subspace, which by linearity implies that
the two sides of 10.114 agree for all f  V.

        Measure, Integration & Real Analysis, by Sheldon Axler
                         Section 10D Spectral Theorem for Compact Operators 333

   An expression of the form 10.114 is called a singular value decomposition of
the compact operator T. The orthonormal families {ek}k and {hk}k in the
singular value decomposition are not uniquely determined by T. However, the
positive numbers {sk}k are uniquely determined as positive square roots of positive
eigenvalues of TT. These positive numbers can be placed in decreasing order
(because if there are infinitely many of them, then they form a sequence with limit 0,
by 10.93). This procedure leads to the definition of singular values given below.

   Suppose T is a compact operator. Recall that the geometric multiplicity of a
positive eigenvalue  of TT is defined to be dimnull(TT - I) [see 10.81]. This
geometric multiplicity is the number of times that  appears in the family {sk}k
corresponding to a singular value decomposition of T. By 10.82, this geometric
multiplicity is finite.

   Now we can define the singular values of a compact operator T, where we are
careful to list the square root of each positive eigenvalue of TT as many times as its
geometric multiplicity.

  10.116 Definition singular values; sn(T)
    · Suppose T is a compact operator on a Hilbert space. The singular values
       of T, denoted s1(T)  s2(T)  s3(T)  · · · , are the positive square roots
       of the positive eigenvalues of TT, arranged in decreasing order with each
       singular value s listed as many times as the geometric multiplicity of s2 as
       an eigenvalue of TT.
    · If TT has only finitely many positive eigenvalues, then define sn(T) = 0
       for all n  Z+ for which sn(T) is not defined by the first bullet point.

10.117 Example singular values on a finite-dimensional Hilbert space
   Define T : F4  F4 by
                          T(z1, z2, z3, z4) = (0, 3z1, 2z2, -3z4).

A calculation shows that
                        (TT)(z1, z2, z3, z4) = (9z1, 4z2, 0, 9z4).

Thus the eigenvalues of TT are 9, 4, 0 and
                  dim(TT - 9I) = 2 and dim(TT - 4I) = 1.

Taking square roots of the positive eigenvalues of TT and then adjoining an infinite
string of 0's shows that the singular values of T are 3  3  2  0  0  · · · .

   Note that -3 and 0 are the only eigenvalues of T. Thus in this case, the list of
eigenvalues of T did not pick up the number 2 that appears in the definition (and
hence the behavior) of T, but the list of singular values of T does include 2.

   If T is a compact operator, then the first singular value s1(T) equals T, as you
are asked to verify in Exercise 12.

                     Measure, Integration & Real Analysis, by Sheldon Axler
334 Chapter 10 Linear Maps on Hilbert Spaces

10.118 Example singular values of V - V 
   Let V denote the Volterra operator and let T = V - V . In Example 10.108, we

saw that if ek is defined by 10.112 then {ek}kZ is an orthonormal basis of L2([0, 1])
and Tek = 2 ek

                                             i(2k + 1)
for each k  Z, where the eigenvalue shown above corresponding to ek comes from
10.111. Now 10.56 implies that

                                   Tek = -2 i(2k + 1) ek

for each k  Z. Hence  TTek = (2k + 1)22 4 ek

10.119

for each k  Z. After taking positive square roots of the eigenvalues, we see that the
equation above shows that the singular values of T are

                       2  2  23  23  25  25  · · · ,
where the first two singular values above come from taking k = -1 and k = 0 in
10.119, the next two singular values above come from taking k = -2 and k = 1,
the next two singular values above come from taking k = -3 and k = 2, and so on.
Each singular value of T appears twice in the list of singular values above because
each eigenvalue of TT has geometric multiplicity 2.

   For n  Z+, the singular value sn(T) of a compact operator T tells us how well
we can approximate T by operators whose range has dimension less than n (see
Exercise 15).

   The next result makes an important connection between K  L2(µ × µ) and the
singular values of the integral operator associated with K.

10.120 sum of squares of singular values of integral operator

Suppose µ is a -finite measure and K  L2(µ × µ). Then

                                              2 2

                     KL2(µ×µ) =  sn(IK) .

                                                             n=1

Proof Consider a singular value decomposition

10.121                IK( f ) =  sk f , ekhk

                                     k

of the compact operator IK. Extend {ej}j to an orthonormal basis {ej}j of
L2(µ), and extend {hk}k to an orthonormal basis {hk}k of L2(µ).

        Measure, Integration & Real Analysis, by Sheldon Axler
              Section 10D Spectral Theorem for Compact Operators 335

   Let X denote the set on which the measure µ lives. For j   and k  , define
gj,k : X × X  F by

                                  gj,k(x, y) = ej(y)hk(x).

Then {gj,k}j, k is an orthonormal basis of L2(µ × µ), as you should verify. Thus

        K2 2     =   |K, gj,k|2
        L (µ×µ)
                    j, k

                 =                                                                       2

                     j, k           K(x, y)ej(y) hk(x) dµ(y) dµ(x)

                 =                                               2

                     j, k  (IKej)(x) hk(x) dµ(x)

10.122           =                                                 2

                     j, k         sjhj(x) hk(x) dµ(x)

10.123           =  sj2

                     j

                                         2

                   =  sn(IK) ,

                                      n=1

where 10.122 holds because 10.121 shows that IKej = sjhj for j   and IKej = 0
for j   \ ; 10.123 holds because {hk}k is an orthonormal family.

Now we can give a spectacular application of the previous result.

                 111                2
10.124  Example     + 2 + 2 +··· =
                 12 3 5                8

Define K : [0, 1] × [0, 1]  R by

                                    if x > y,
                                 1  if x = y,
                    K(x, y) = 0-1   if x < y.

Letting µ be Lebesgue measure on [0, 1], we note that IK is the normal compact
operator V - V  examined in Example 10.118.

   Clearly KL2(µ×µ) = 1. Using the list of singular values for IK obtained in
Example 10.118, the formula in 10.120 tells us that

                                    4
                    1=2                   2 2.
                           k=0 (2k + 1) 

Thus                121 + 321 + 521 + · · · = 2 8 .

              Measure, Integration & Real Analysis, by Sheldon Axler
336 Chapter 10 Linear Maps on Hilbert Spaces

EXERCISES 10D

1 Prove that if T is a compact operator on a nonzero Hilbert space, then T2 is
    an eigenvalue of TT.

2 Prove that if T is a self-adjoint operator on a nonzero Hilbert space V, then
                       T = sup{|T f , f | : f  V and  f  = 1}.

3 Suppose T is a bounded operator on a Hilbert space V and U is a closed subspace
    of V. Prove that the following are equivalent.

    (a) U is an invariant subspace for T.
    (b) U is an invariant subspace for T.
    (c) TPU = PU TPU.

4 Suppose T is a bounded operator on a Hilbert space V and U is a closed subspace
    of V. Prove that the following are equivalent.

    (a) U and U are invariant subspaces for T.
    (b) U and U are invariant subspaces for T.
    (c) TPU = PU T.

5 Suppose T is a bounded operator on a nonseparable normed vector space V.
    Prove that T has a closed invariant subspace other than {0} and V.

6 Suppose T is an operator on a Banach space V with dimension greater than 2.
    Prove that T has an invariant subspace other than {0} and V.
    [For this exercise, T is not assumed to be bounded and the invariant subspace is
    not required to be closed.]

7 Suppose T is a self-adjoint compact operator on a Hilbert space that has only
    finitely many distinct eigenvalues. Prove that T has finite-dimensional range.

8 (a) Prove that if T is a self-adjoint compact operator on a Hilbert space, then
         there exists a self-adjoint compact operator S such that S3 = T.

    (b) Prove that if T is a normal compact operator on a complex Hilbert space,
         then there exists a normal compact operator S such that S2 = T.

9 Suppose T is a compact normal operator on a nonzero Hilbert space V. Prove
    that there is a subspace of V with dimension 1 or 2 that is an invariant subspace
    for T.
    [If F = C, the desired result follows immediately from the Spectral Theorem for
    compact normal operators. Thus you can assume that F = R.]

10  Suppose  T  is  a  self-adjoint  compact  operator  on  a  Hilbert  space  and  T    1.

                                                                                         4
    Prove that there exists a self-adjoint compact operator S such that S2 + S = T.

                Measure, Integration & Real Analysis, by Sheldon Axler
Section 10D Spectral Theorem for Compact Operators 337

11 For k  Z, define gk  L2 (-, ] and hk  L2 (-, ] by

gk(t) = 1 eit/2eikt and hk(t) = 1 eikt;
2                                 2

here we are assuming that F = C.

(a) Use the conclusion of Example 10.108 to show that {gk}kZ is an ortho-
     normal basis of L2 (-, ] .

(b) Use (a) to show that {hk}kZ is an orthonormal basis of L2 (-, ] .
(c) Use (b) to show that the orthonormal family in the third bullet point of

     Example 8.51 is an orthonormal basis of L2 (-, ] .

12 Suppose T is a compact operator on a Hilbert space. Prove that s1(T) = T.
13 Suppose T is a compact operator on a Hilbert space and n  Z+. Prove that

      dim range T < n if and only if sn(T) = 0.
14 Suppose T is a compact operator on a Hilbert space V with singular value

      decomposition

                                                              

                           T f =  sk(T) f , ekhk

                                                          k=1

      for all f  V. For n  Z+, define Tn : V  V by

                                                               n

                          Tn f =  sk(T) f , ekhk.

                                                           k=1

      Prove that limnT - Tn = 0.
      [This exercise gives another proof, in addition to the proof suggested by Exercise
      15 in Section 10C, that an operator on a Hilbert space is compact if and only if
      it is the limit of bounded operators with finite-dimensional range.]

15 Suppose T is a compact operator on a Hilbert space V and n  Z+. Prove that

                inf{T - S : S  B(V) and dim range S < n} = sn(T).

16 Suppose T is a compact operator on a Hilbert space V and n  Z+. Prove that
             sn(T) = inf{T|U  : U is a subspace of V with dim U < n}.

17 Suppose T is a compact operator on a Hilbert space V with singular value
      decomposition

                             T f =  sk f , ekhk

                                                             k

      for all f  V. Prove that

                            T f =  sk f , hkek

                                                              k

      for all f  V.

                      Measure, Integration & Real Analysis, by Sheldon Axler
338 Chapter 10 Linear Maps on Hilbert Spaces

18 Suppose that T is an operator on a finite-dimensional Hilbert space V with
      dim V = n.

      (a) Prove that T is invertible if and only if sn(T) = 0.
      (b) Suppose T is invertible and T has a singular value decomposition

                    T f = s1(T) f , e1h1 + · · · + sn(T) f , enhn

     for all f  V. Show that

                         T-1 f =  f , h1 s1(T) e1 + · · · +  f , hn sn(T) en

     for all f  V.

19 Suppose T is a compact operator on a Hilbert space V. Prove that

                                       2 2
                              Tek =  sn(T)
                             k         n=1

      for every orthonormal basis {ek}k of V.
                                                              1

20 Use the result of Example 10.124 to evaluate  2 .

                                                             n=1 n
21 Suppose T is a normal compact operator on a complex Hilbert space. Prove that

      the following are equivalent.

(a) range T is finite-dimensional.
(b) sp(T) is a finite set.
(c) sn(T) = 0 for some n  Z.

22 Find the singular values of the Volterra operator.
[Your answer, when combined with Exercise 12, should show that the norm of
                             2.
the  Volterra  operator  is      This  appearance  of    can  be  surprising  because  the
                             
definition of the Volterra operator does not involve .]

     Measure, Integration & Real Analysis, by Sheldon Axler
                      Chapter 11

          Fourier Analysis

This chapter uses Hilbert space theory to motivate the introduction of Fourier coeffi-
cients and Fourier series. The classical setting applies these concepts to functions
defined on bounded intervals of the real line. However, the theory becomes easier and
cleaner when we instead use a modern approach by considering functions defined on
the unit circle of the complex plane.

   The first section of this chapter shows how consideration of Fourier series leads us
to harmonic functions and a solution to the Dirichlet problem. In the second section
of this chapter, convolution becomes a major tool for the Lp theory.

   The third section of this chapter changes the context to functions defined on the
real line. Many of the techniques introduced in the first two sections of the chapter
transfer easily to provide results about the Fourier transform on the real line. The
highlights of our treatment of the Fourier transform are the Fourier Inversion Formula
and the extension of the Fourier transform to a unitary operator on L2(R).

   The vast field of Fourier analysis cannot be completely covered in a single chapter.
Thus this chapter gives readers just a taste of the subject. Readers who go on from
this chapter to one of the many book-length treatments of Fourier analysis will then
already be familiar with the terminology and techniques of the subject.

 The Giza pyramids, near where the Battle of Pyramids took place in 1798 during
Napoleon's invasion of Egypt. Joseph Fourier (1768-1830) was one of the scientific
advisors to Napoleon in Egypt. While in Egypt as part of Napoleon's invading force,
 Fourier began thinking about the mathematical theory of heat propagation, which

    eventually led to what we now call Fourier series and the Fourier transform.

                                                     CC-BY-SA Ricardo Liberato

                                                                                                            339
                     Measure, Integration & Real Analysis, by Sheldon Axler
340 Chapter 11 Fourier Analysis

11A Fourier Series and Poisson Integral

Fourier Coefficients and Riemann-Lebesgue Lemma

For k  Z, suppose ek : (-, ]  R is defined by

      1                          sin(kt)  if k > 0,
        
          

11.1  ek(t) = 1                           if k = 0,
       2
       1 cos(kt) if k < 0.
        

The classical theory of Fourier series features {ek}kZ as an orthonormal basis of
L2 (-, ] . The trigonometric formulas displayed in Exercise 1 in Section 8C can
be used to show that {ek}kZ is indeed an orthonormal family in L2 (-, ] .

   To show that {ek}kZ is an orthonormal basis of L2 (-, ] requires more
work. One slick possibility is to note that the Spectral Theorem for compact operators
produces orthonormal bases; an appropriate choice of a compact normal operator
can then be used to show that {ek}kZ is an orthonormal basis of L2 (-, ] [see
Exercise 11(c) in Section 10D].

   In this chapter we take a cleaner approach to Fourier series by working on the unit
circle in the complex plane instead of on the interval (-, ]. The map

11.2  t  eit = cos t + i sin t

can be used to identify the interval (-, ] with the unit circle; thus the two ap-
proaches are equivalent. However, the calculations are easier in the unit circle context.
In addition, we will see that the unit circle context provides the huge benefit of
making a connection with harmonic functions.

   We begin by introducing notation for the open unit disk and the unit circle in the
complex plane.

  11.3 Definition D; D
    · D denotes the open unit disk in the complex plane:
                                    D = {w  C : |w| < 1}.

    · D is the unit circle in the complex plane:
                                    D = {z  C : |z| = 1}.

   The function given in 11.2 is a one-to-one map of (-, ] onto D. We use
this map to define a -algebra on D by transferring the Borel subsets of (-, ]
to subsets of D that we will call the measurable subsets of D. We also transfer
Lebesgue measure on the Borel subsets of (-, ] to a measure called  on the
measurable subsets of D, except that for convenience we normalize by dividing
by 2 so that the measure of D is 1 rather than 2. We are now ready to give the
formal definitions.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                          Section 11A Fourier Series and Poisson Integral 341

  11.4 Definition measurable subsets of D; 

    · A subset E of D is measurable if {t  (-, ] : eit  E} is a Borel subset
       of R.

    ·  is the measure on the measurable subsets of D obtained by transferring
       Lebesgue measure from (-, ] to D, normalized so that (D) = 1. In
       other words, if E  D is measurable, then
                              (E) = |{t  (-, ] : eit  E}| 2 .

   Our definition of the measure  on D allows us to transfer integration on D to
the familiar context of integration on (-, ]. Specifically,

                       D f d = D f (z) d(z) =  - f (eit) dt 2
for all measurable functions f : D  C such that any of these integrals is defined.

   Throughout this chapter, we assume that the scalar field F is the complex field C.
Furthermore, Lp(D) is defined as follows.

11.5 Definition Lp(D)

For 1  p  , define Lp(D) to mean the complex version (F = C) of Lp().

Note that if z    =  eit  for some t    R, then z  =  e-it  =  1  and zn  =  eint  and
                                                               z
zn = e-int for all n  Z. These observations make the proof of the next result
much simpler than the proof of the corresponding result for the trigonometric family
defined by 11.1.
In the statement of the next result, zn means the function on D defined by z  zn.

11.6 orthonormal family in L2(D)

{zn}nZ is an orthonormal family in L2(D).

Proof If n  Z, then

                   zn, zn = |zn|2 d(z) =              1 d = 1.

                                              D    D

If m, n  Z with m = n, then

zm, zn =  - eimte-int dt 2 =  - ei(m-n)t dt 2 = ei(m-n)t i(m - n)2        t= = 0,

                                                                          t=-

as desired.

   In the next section, we improve the result above by showing that {zn}nZ is an
orthonormal basis of L2(D) (see 11.30).

                  Measure, Integration & Real Analysis, by Sheldon Axler
342 Chapter 11 Fourier Analysis

   Hilbert space theory tells us that if f is in the closure in L2(D) of span{zn}nZ,
then

                            f =   f , znzn,

                                                         nZ

where the infinite sum above converges as an unordered sum in the norm of L2(D)
(see 8.58). The inner product  f , zn above equals

                                           f (z) zn d(z).

                                                     D

Because |zn| = 1 for every z  D, the integral above makes sense not only for
f  L2(D) but also for f in the larger space L1(D). Thus we make the following
definition.

  11.7 Definition Fourier coefficient; f (n); Fourier series
  Suppose f  L1(D).

    · For n  Z, the nth Fourier coefficient of f is denoted f (n) and is defined by
                      f (n) = D f (z) zn d(z) =  - f (eit)e-int dt 2 .

    · The Fourier series of f is the formal sum

                                                              

                                  f (n)zn.

                                                        n=-

   As we will see, Fourier analysis helps describe the sense in which the Fourier
series of f represents f .

11.8 Example Fourier coefficients

  · Suppose h is an analytic function on an open set that contains the closed unit
     disk D. Then h has a power series representation

                                                                      

                              h(z) =  anzn,

                                                                  n=0

     where the sum on the right converges uniformly on D to h. Because uniform
     convergence on D implies convergence in L2(D), 8.58(b) and 11.6 now imply
     that

                                 (h|D) (n) = an if n  0, 0 if n < 0
     for all n  Z. In other words, for functions analytic on an open set containing
     D, the Fourier series is the same as the Taylor series.

                     Measure, Integration & Real Analysis, by Sheldon Axler
               Section 11A Fourier Series and Poisson Integral 343

· Suppose f : D  R is defined by

                  f (z) = |3 - z|2 1 .

Then for z  D we have
                          f (z) = 1 (3 - z)(3 - z)

               = 1 z 8 3 - z + 3 3 - z

                  13              z                 1

               =                     z+                z
                  8 1- 3 1- 3

                  1 z  zn  (z)n
               =                   n+ n
                  8 3 n=0 3 n=0 3

                  1  zn

               = 8  3|n| ,

                      n=-

where the infinite sums above converge uniformly on D. Thus we see that

                  f (n) = 18 · 13|n|

for all n  Z.

   We begin with some simple algebraic properties of Fourier coefficients, whose
proof is left to the reader.

  11.9 algebraic properties of Fourier coefficients
  Suppose f , g  L1(D) and n  Z. Then

  (a) f + g(n) = f (n) + g(n);
  (b)  f (n) =  f (n) for all   C;
  (c) | f (n)|   f 1.
   Parts (a) and (b) above could be restated by saying that for each n  Z, the
function f  f (n) is a linear functional from L1(D) to C. Part (c) could be
restated by saying that this linear functional has norm at most 1.
   Part (c) above implies that the set of Fourier coefficients { f (n)}nZ is bounded
for each f  L1(D). The Fourier coefficients of the functions in Example 11.8
have the stronger property that limn± f (n) = 0. The next result shows that this
stronger conclusion holds for all functions in L1(D).

                     Measure, Integration & Real Analysis, by Sheldon Axler
344 Chapter 11 Fourier Analysis

    11.10 Riemann-Lebesgue Lemma

    Suppose f  L1(D). Then lim f (n) = 0.

                                                n±

Proof Suppose  > 0. There exists g  L2(D) such that  f - g1 <  (by 3.44).
By 11.6 and Bessel's inequality (8.57), we have

                                               

                          |g(n)|2  g22 < .

                                          n=-

Thus there exists M  Z+ such that |g(n)| <  for all n  Z with |n|  M. Now if
n  Z and |n|  M, then

                            | f (n)|  | f (n) - g(n)| + |g(n)|

                                             < | f - g(n)| + 
                                               f - g1 + 
                                             < 2.

Thus lim f (n) = 0.

        n±

Poisson Kernel

Suppose f : D  C is continuous and z  D. For this fixed z  D, the Fourier
series 

                                f (n)zn

                                                     n=-

is  a  series  of  complex      numbers.     It  would    be  nice  if  f (z)  =             f (n)zn,  but  this

    not  necessarily                             series             f (n)zn       n=-
is                     true  because      the                                  might  not    converge,  as  you
can see in Exercise 11.                                  n=-

    Various techniques exist for trying to assign some meaning to a series of complex
numbers that does not converge. In one such technique, called Abel summation, the
nth-term of the series is multiplied by rn and then the limit is taken as r  1. For
example, if the nth-term of the divergent series

                                          1-1+1-1+···

is  multiplied     by  rn  for   r    [0, 1),  we   get   a  convergent  series   whose      sum  equals     r.

Taking                                as  r      1        gives  1                      the                 1+r
         the   limit   of  this  sum                then         2  as  the  value  of       Abel  sum  of  the
                                             

series above.
    The next definition can be motivated by applying a similar technique to the Fourier
series             f (n)zn.      Here  we    have   a  series  of   complex    numbers       whose  terms   are

         n=-
indexed by Z rather than by Z+. Thus we use r|n| rather than rn because we want
these multipliers to have limit 0 as n  ± for each r  [0, 1) (and to have limit 1
as r  1 for each n  Z).

                       Measure, Integration & Real Analysis, by Sheldon Axler
       Section 11A Fourier Series and Poisson Integral 345

11.11 Definition Pr f

For f  L1(D) and 0  r < 1, define Pr f : D  C by

                                                              

                    (Pr f )(z) =  r|n| f (n) zn.

                                                        n=-

No convergence problems arise in the series above because

                       r|n| f (n) zn   f 1 r|n|

for each z  D, which implies that

        |n| n                                  1+r
        |r f (n) z |   f 1                          < .
                                               1-r
       n=-

Thus for each r  [0, 1), the partial sums of the series above converge uniformly on
D, which implies that Pr f is a continuous function from D to C (for r = 0 and
n = 0, interpret the expression 00 to be 1).

   Let's unravel the formula in 11.11. If f  L1(D), 0  r < 1, and z  D, then

                               

       (Pr f )(z) =  r|n| f (n) zn

                           n=-

                       
                       =  r|n| f (w) wn d(w)zn
                       n=-           D

                                        
                       = f (w)  r|n|(zw)n d(w),
11.12

                       D             n=-

where interchanging the sum and integral above is justified by the uniform conver-
gence of the series on D. To evaluate the sum in parentheses in the last line above,
let   D (think of  = zw in the formula above). Thus ()-n = ()n and

                                               
        r|n|n =  (r)n +  (r)n
       n=-                         n=0         n=1

                          = 1 1 - r + r 1 - r

                          =        (1 - r) + (1 - r)r

                                        |1 - r|2

11.13                     = |1 - r|2 1 - r2 .

   Motivated by the formula above, we now make the following definition. Notice
that 11.11 uses calligraphic P, while the next definition uses italic P.

       Measure, Integration & Real Analysis, by Sheldon Axler
346 Chapter 11 Fourier Analysis

11.14 Definition Pr(); Poisson kernel
  · For 0  r < 1, define Pr : D  (0, ) by
                                     Pr() = |1 - r|2 1 - r2 .

· The family of functions {Pr}r[0,1) is called the Poisson kernel on the open
    unit disk D.

Combining 11.12 and 11.13 now gives the following result.

  11.15 integral formula for Pr f
  If f  L1(D), 0  r < 1, and z  D, then

       (Pr f )(z) = D f (w)Pr(zw) d(w) = D f (w) |1 - rzw|2 1 - r d( 2 w).
   The terminology approximate identity is sometimes used to describe the three
properties for the Poisson kernel given in the next result.

11.16 properties of Pr

(a) Pr() > 0 for all r  [0, 1) and all   D.

(b) Pr() d() = 1 for each r  [0, 1).

         D

(c) lim                       Pr() d() = 0 for each  > 0.
    r1 {D:|1-|}

Proof Part (a) follows immediately from the definition of Pr() given in 11.14.
   Part (b) follows from integrating the series representation for Pr given by 11.13

termwise and noting that

     n d() =  D - eint dt 2 = ein2 t=- = int t= 0 for all n  Z \ {0};

for n = 0, we have D n d() = 1.                      |1 -                1-          ,
To  prove  (c),  suppose         0.  If         D,               ,  and        r        then
                              >                            |                      <  2

           |1  -  r|  =   |1  -    -     (r  -  1)|    |1  -  |  -  (1  -  r)  >  .

                                                                                  2

Thus as r  1, the denominator in the definition of Pr() is uniformly bounded away
from 0 on {  D : |1 - |  } and the numerator goes to 0. Thus the integral of
Pr over {  D : |1 - |  } goes to 0 as r  1.

                 Measure, Integration & Real Analysis, by Sheldon Axler
   Section 11A Fourier Series and Poisson Integral 347

    Here is the intuition behind the proof of the    The graphs of P1 (eit) [red] and
next result: Parts (a) and (b) of the previous re-
sult and 11.15 mean that (Pr f )(z) is a weighted                                     2
average of f . Part (c) of the previous result says
that for r close to 1, most of the weight in this       P3 (eit) [blue] on (-, ].
weighted average is concentrated near z. Thus
(Pr f )(z)  f (z) as r  1.                                    4

    The figure here transfers the context from       is rotation and reflection invariant.
D to (-, ]. The area under both curves               ({  D : h()  E}) for all
is 2 [corresponding to 11.16(b)] and Pr(eit)
becomes more concentrated near t = 0 as r  1
[corresponding to 11.16(c)]. See Exercise 3 for
the formula for Pr(eit).

    One more ingredient is needed for the next
proof: If h  L1(D) and z  D, then

11.17 h(zw) d(w) = h() d().
D     D

The equation above holds because the measure 
In other words, ({w  D : h(zw)  E}) =
measurable E  D.

11.18 if f is continuous, then lim f - Pr f  = 0

                                                   r1

Suppose f : D  C is continuous. Then Pr f converges uniformly to f on D
as r  1.

Proof Suppose  > 0. Because f is uniformly continuous on D, there exists  > 0
such that

                | f (z) - f (w)| <  for all z, w  D with |z - w| < .
If z  D, then

         | f (z) - (Pr f )(z)| = f (z) - f (w)Pr(zw) d(w)

                                                                D

   =        f (z) - f (w) Pr(zw) d(w)

         D

     {wD : |z-w|<} Pr(zw) d(w)
        + 2 f  {wD : |z-w|} Pr(zw) d(w)

                                  + 2 f  {D : |1-|} Pr() d(),
where we have used 11.17, 11.16(a), 11.16(b), and the equality |z - w| = |1 - |,
which holds when  = zw. Now 11.16(c) shows that the last integral above, which
does not depend on z, has limit 0 as r  1, giving the desired uniform convergence.

                     Measure, Integration & Real Analysis, by Sheldon Axler
348 Chapter 11 Fourier Analysis

Solution to Dirichlet Problem on Disk

As a bonus to our investigation into Fourier series, the previous result provides the
solution to the Dirichlet problem on the unit disk. To state the Dirichlet problem, we
first need a few definitions. As usual, we identify C with R2. Thus for x, y  R, we
can think of w = x + yi  C or w = (x, y)  R2. Hence

              D = {w  C : |w| < 1} = {(x, y)  R2 : x2 + y2 < 1}.
   For a function u : G  C on an open subset G of C (or an open subset G of
R2), the partial derivatives D1u and D2u are defined as in 5.46 except that now we
allow u to be a complex-valued function. Clearly Dju = Dj(Re u) + iDj(Im u) for
j = 1, 2.

  11.19 Definition harmonic function; Laplacian; u
  A function u : G  C on an open subset G of R2 is called harmonic if

                          D1(D1u) (w) + D2(D2u) (w) = 0
  for all w  G. The left side of the equation above is called the Laplacian of u at
  w and is often denoted by (u)(w).

11.20 Example harmonic functions

· If g : G  C is an analytic function on an open set G  C, then the functions
   Re g, Im g, g, and g are all harmonic functions on G, as is usually discussed
   near the beginning of a course on complex analysis.

· If   D, then the function
                                       w  1 - |w|2
                                              |1 - w|2

   is harmonic on C \ {} (see Exercise 7).
· The function u : C \ {0}  R defined by u(w) = log|w| is harmonic on

   C \ {0}, as you should verify. However, there does not exist a function g
   analytic on C \ {0} such that u = Re g.

   The Dirichlet problem asks to extend a continuous function on the boundary of an
open subset of R2 to a function that is harmonic on the open set and continuous on
the closure of the open set. Here is a more formal statement:

11.21  Dirichlet problem on G: Suppose G  R2 is an open set and
       f : G  C is a continuous function. Find a continuous function
       u : G  C such that u|G is harmonic and u|G = f .

       Measure, Integration & Real Analysis, by Sheldon Axler
                                 Section 11A Fourier Series and Poisson Integral 349

   For some open sets G  R2, there exist continuous functions f on G whose
Dirichlet problem has no solution. However, the situation on the open unit disk D is
much nicer, as we will soon see.

   The function u defined in the result below is called the Poisson integral of f on D.

11.22 Poisson integral is harmonic

Suppose f  L1(D). Define u : D  C by
                                   u(rz) = (Pr f )(z)

for r  [0, 1) and z  D. Then u is harmonic on D.

Proof If w  D, then w = rz for some r  [0, 1) and some z  D. Thus

u(w) = (Pr f )(z)

                                      
=  f (n)(rz)n +  f (-n)(rz)n
n=0                                 n=1

                                    
=  f (n)wn +  f (-n)wn.
n=0                                 n=1

Every function that has a power series representation on D is analytic on D. Thus
the equation above shows that u is the sum of an analytic function and the complex
conjugate of an analytic function. Hence u is harmonic.

  11.23 Poisson integral solves Dirichlet problem on unit disk
  Suppose f : D  C is continuous. Define u : D  C by

                   u(rz) = (Pr f )(z) if 0  r < 1 and z  D, f (z) if r = 1 and z  D.
  Then u is continuous on D, u|D is harmonic, and u|D = f .
Proof The function u|D is harmonic on D (and hence continuous on D) by 11.22.
   Suppose   D. To prove that u is continuous at , we need to show that if
w  D is close to , then u(w) is close to u(). Because u|D = f and f is
continuous on D, we do not need to worry about the case where w  D. Thus
assume w  D. We can write w = rz, where r  [0, 1) and z  D. Now

                |u() - u(w)| = | f () - (Pr f )(z)|
                                   | f () - f (z)| + | f (z) - (Pr f )(z)|.

                     Measure, Integration & Real Analysis, by Sheldon Axler
350 Chapter 11 Fourier Analysis

If w is close to , then z is also close to , and hence by the continuity of f the first
term in the last line above is small. Also, if w is close to , then r is close to 1, and
hence by 11.18 the second term in the last line above is small. Thus if w is close to ,
then u(w) is close to u(), as desired. Hence u is continuous at , showing that u
solves the Dirichlet problem on D for the function f : D  C.

Fourier Series of Smooth Functions

The Fourier series of a continuous function on D need not converge pointwise (see
Exercise 11). However, in this subsection we will see that Fourier series behave well
for functions that are twice continuously differentiable.
   We need to define what we mean for a
function on D to be differentiable. The  The idea here is that we transfer a

formal definition is given below, with the function defined on D to R, take
introduction of the notations f for the the usual derivative there, then
transfer of f to R and f [k] for the transfer transfer back to D.
back to D of the kth-derivative of f .

  11.24 Definition f ; k times continuously differentiable; f [k]

  Suppose f : D  C is a complex-valued function on D and k  Z+  {0}.
    · Define f : R  C by f (t) = f (eit).
    · f is called k times continuously differentiable if f is k times differentiable
       everywhere on R and its kth-derivative f (k) : R  C is continuous.
    · If f is k times continuously differentiable, then f [k] : D  C is defined by
                                        f [k](eit) = f (k)(t)
       for t  R. Here f (0) is defined to be f , which means that f [0] = f .

   Note that the function f defined above is periodic on R because f (t + 2) = f (t)
for all t  R. Thus all derivatives of f are also periodic on R.

11.25 Example Suppose n  Z and f : D  C is defined by f (z) = zn. Then
f : R  C is defined by f (t) = eint.

   If k  Z+, then f (k)(t) = iknkeint. Thus f [k](z) = iknkzn for z  D.
   Our next result gives a formula for the Fourier coefficients of a derivative.

Measure, Integration & Real Analysis, by Sheldon Axler
                 Section 11A Fourier Series and Poisson Integral 351

11.26 Fourier coefficients of differentiable functions

Suppose k  Z+ and f : D  C is k times continuously differentiable. Then

                           f [k](n) = iknk f (n)

for every n  Z.

Proof First suppose n = 0. By the Fundamental Theorem of Calculus, we have
    f [k](0) =  - f [k](eit) dt 2 =  - f (k)(t) dt 2 = 12 f (k-1)(t) tt=- = = 0,

which is the desired result for n = 0.
   Now suppose n  Z \ {0}. Then
           f [k](n) =  - f (k)(t)e-int dt 2

                    = 12 f (k-1)(t)e-int tt=- + = in  - f (k-1)(t)e-int dt 2

                    = in f [k-1](n),
where the second equality above follows from integration by parts.

   Iterating the equation above now produces the desired result.

   Now we can prove the beautiful result that a twice continuously differentiable func-
tion on D equals its Fourier series, with uniform convergence of the Fourier series.
This conclusion holds with the weaker hypothesis that the function is continuously
differentiable, but the proof is easier with the hypothesis used here.

11.27 Fourier series of twice continuously differentiable functions converge

Suppose f : D  C is twice continuously differentiable. Then

                                                              

                         f (z) =  f (n)zn

                                                        n=-
                                                                            M

for all z  D. Furthermore, the partial sums  f (n)zn converge uniformly

                                                                      n=-K

on D to f as K, M  .

Proof If n  Z \ {0}, then

11.28            | f (n)| = n2 f  [2](n) f [2] n2 1 ,

where the equality above follows from 11.26 and the inequality above follows
from 11.9(c). Now 11.28 implies that

       Measure, Integration & Real Analysis, by Sheldon Axler
352 Chapter 11 Fourier Analysis

                                           
                         | f (n)zn| =  | f (n)| < 
11.29

                        n=-                n=-

for  all  z    D.  The  inequality  above  implies  that       f (n)zn  converges  and  that

the partial sums converge uniformly on D.                 n=-

     Furthermore, for each z  D we have

                                                             
                   f (z) = lim  r|n| f (n)zn =  f (n)zn,
                        r1 n=-                            n=-

where the first equality holds by 11.18 and 11.11, and the second equality holds by
the Dominated Convergence Theorem (use counting measure on Z) and 11.29.

   In 1923 Andrey Kolmogorov (1903-1987) published a proof that there exists
a function in L1(D) whose Fourier series diverges almost everywhere on D.
Kolmogorov's result and the result in Exercise 11 probably led most mathematicians
to suspect that there exists a continuous function on D whose Fourier series diverges
almost everywhere. However, in 1966 Lennart Carleson (1928-) showed that if
f  L2(D) (and in particular if f is continuous on D), then the Fourier series of f
converges to f almost everywhere.

EXERCISES 11A

1 Prove that f (n) = f (-n) for all f  L1(D) and all n  Z.

2 Suppose 1  p   and n  Z.

    (a) Show that the function f  f (n) is a bounded linear functional on Lp(D)
          with norm 1.

    (b) Find all f  Lp(D) such that  f p = 1 and | f (n)| = 1.

3 Show that if 0  r < 1 and t  R, then
                                 Pr(eit) = 1 - 2r cos t + r2 1 - r2 .

4 Suppose f  L1(D), z  D, and f is continuous at z. Prove that

                                    lim(Pr f )(z) = f (z).

                                    r1

     [The result in this exercise differs from 11.18 because here we are assuming
     continuity only at a single point and we are not even assuming that f is bounded,
     as compared to 11.18, which assumed continuity at all points of D.]

5 Suppose a, b  C, f  L1(D), z  D, lim f (eitz) = a, and lim f (eitz) = b.
                                                    t0                     t0
     Prove that
                                    lim(Pr f )(z) = a + b .
                                    r1                    2

     [If a = b, then f is said to have a jump discontinuity at z.]

                   Measure, Integration & Real Analysis, by Sheldon Axler
                                 Section 11A Fourier Series and Poisson Integral 353

 6 Prove that for each p  [1, ), there exists f  L1(D) such that

                                                          

                                | f (n)|p = .

                                                    n=-

 7 Suppose   D. Show that the function
                                          w  1 - |w|2
                                                 |1 - w|2

      is harmonic on C \ {} by finding an analytic function on C \ {} whose real
      part is the function above.
 8 Suppose f : D  R is the function defined by

                                           f (x, y) = x4y
      for (x, y)  R2 with x2 + y2 = 1. Find a polynomial u of two variables x, y
      such that u is harmonic on R2 and u|D = f .
      [Of course, u|D is the Poisson integral of f . However, here you are asked to
      find an explicit formula for u in closed form, without involving or computing
      an integral. It may help to think of f as defined by f (z) = (Re z)4(Im z) for
      z  D.]
 9 Find a formula (in closed form, not as an infinite sum) for Pr f , where f is the
      function in the second bullet point of Example 11.8.
10 Suppose f : D  C is three times continuously differentiable. Prove that

                                                                       

                           f [1](z) = i  n f (n)zn

                                                                 n=-

      for all z  D.

                      Measure, Integration & Real Analysis, by Sheldon Axler
354 Chapter 11 Fourier Analysis

11 Let C(D) denote the Banach space of continuous function from D to C, with
the supremum norm. For M  Z+, define a linear functional M : C(D)  C
by
                                       M
                       M( f ) =  f (n).
                                       n=-M
                                                          
Thus M( f ) is a partial sum of the Fourier series  f (n)zn, evaluated at
z = 1.                                                 n=-

(a) Show that  M( f ) =  f (eit) t sin(M + 12 )t dt

                                 -            sin 2 2

    for every f  C(D) and every M  Z+.

(b) Show that          lim t =  sin(M + 21 )t dt .

                       M -             sin 2           2

(c) Show that limMM = .                                      M
(d) Show that there exists f  C(D) such that lim  f (n) does not
    exist (as an element of C).                        M n=-M

[Because the sum in (d) is a partial sum of the Fourier series evaluated at z = 1,
part (d) shows that the Fourier series of a continuous function on D need not
converge pointwise on D.
The family of functions (one for each M  Z+) on D defined by

                                 eit  t sin(M + 21 )t
                                                sin 2

is called the Dirichlet kernel.]

12 Define f : D  R by

                                       if Im z > 0,
                                1      if Im z < 0,
                       f (z) = -1 0    if Im z = 0.

(a) Show that if n  Z, then

                       f (n) = - n2i if n is odd,
                                    0         if n is even.

(b) Show that          (Pr f )(z) = 2 arctan 1 - r2 2r Im z

    for every r  [0, 1) and every z  D.

(c) Verify that limr1(Pr f )(z) = f (z) for every z  D.

(d) Prove that Pr f does not converge uniformly to f on D as r  1.

        Measure, Integration & Real Analysis, by Sheldon Axler
                          Section 11B Fourier Series and Lp of Unit Circle  113

11B Fourier Series and Lp of Unit Circle

The last paragraph of the previous section mentioned the result that the Fourier series
of a function in L2(D) converges pointwise to the function almost everywhere. This
terrific result had been an open question until 1966. Its proof is not included in this
book, partly because the proof is difficult and partly because pointwise convergence
has turned out to be less useful than norm convergence.

   Thus we begin this section with the easy proof that the Fourier series converges
in the norm of L2(D). The remainder of this section then concentrates on issues
connected with norm convergence.

Orthonormal Basis for L2 of Unit Circle

We already showed that {zn}nZ is an orthonormal family in L2(D) (see 11.6).
Now we show that {zn}nZ is an orthonormal basis of L2(D).

11.30 orthonormal basis of L2(D)

The family {zn}nZ is an orthonormal basis of L2(D).

Proof  Suppose f   span{zn }nZ      Thus  f , zn = 0 for all n   Z.  In other

                                 .

words, f (n) = 0 for all n  Z.
   Suppose  > 0. Let g : D  C be a twice continuously differentiable function

such that  f - g2 < . [To prove the existence of g  L2(D) with this property,
first approximate f by step functions as in 3.47, but use the L2-norm instead of the
L1-norm. Then approximate the characteristic function of an interval as in 3.48, but
again use the L2-norm and round the corners of the graph in the proof of 3.48 to get a
twice continuously differentiable function.]

   Now

        f 2   f - g2 + g2

                   =  f - g2 +  |g(n)|2 1/2

                                             nZ

                   =  f - g2 +  g - f (n) 2 1/2

                                             nZ

                     f - g2 + g - f 2

                              < 2,

where the second line above follows from 11.27, the third line above holds because
f (n) = 0 for all n  Z, and the fourth line above follows from Bessel's inequality
(8.57).

   Because the inequality above holds for all  > 0, we conclude that f = 0. We
have now shown that span{zn}nZ  = {0}. Hence span{zn}nZ = L2(D)
by 8.42, which implies that {zn}nZ is an orthonormal basis of L2(D).

       Measure, Integration & Real Analysis, by Sheldon Axler
356 Chapter 11 Fourier Analysis

   Now the convergence of the Fourier series of f  L2(D) to f follows immedi-
ately from standard Hilbert space theory [see 8.63(a)] and the previous result. Thus
with no further proof needed, we have the following important result.

11.31 convergence of Fourier series in the norm of L2(D)

Suppose f  L2(D). Then

                                                           

                          f =  f (n)zn,

                                                     n=-

where the infinite sum converges to f in the norm of L2(D).

The next example is a spectacular ap-          Euler's proof, which would not be
plication of Hilbert space theory and the      considered sufficiently rigorous by
orthonormal basis {zn}nZ of L2(D).             today's standards, was quite
The  evaluation  of       1   had    been  an  different from the technique used in
                          n2                   the example below.
                     n=1
open question until Euler discovered in
                                        2
1734 that this infinite sum equals 6 .

                     111                       2
11.32  Example       + 2 + 2 +··· =
                     12 2 3                    6

   Define f  L2(D) by f (eit) = t for t  (-, ]. Then f (0) =              dt
For n  Z \ {0}, we have
                                                                         - t 2 = 0.

                     f (n) =  - te-int dt 2

                          = te -2in t=- + -int t= 1  in - e-int dt 2

                              = (-1)ni n ,
where the second line above follows from integration by parts. The equation above
implies that

                                                  1
                                 | f (n)|2 = 2  2 .
11.33                                          n=1 n

                              n=-

Also,

11.34                           f  2    =   t2 dt = 2 .
                                           - 2 3
                                     2

Parseval's identity [8.63(c)] implies that the left side of 11.33 equals the left side of
11.34. Setting the right side of 11.33 equal to the right side of 11.34 shows that

                                         1 2
                                         2= .
                                        n=1 n  6

                 Measure, Integration & Real Analysis, by Sheldon Axler
             Section 11B Fourier Series and Lp of Unit Circle 357

Convolution on Unit Circle

Recall that

11.35        (Pr f )(z) = f (w)Pr(zw) d(w)

                                    D

for f  L1(D), 0  r < 1, and z  D (see 11.15). The kind of integral formula
that appears in the result above is so useful that it gets a special name and notation.

11.36 Definition convolution; f  g
Suppose f , g  L1(D). The convolution of f and g is denoted f  g and is the
function defined by

                          ( f  g)(z) = f (w)g(zw) d(w)

                                                             D

  for those z  D for which the integral above makes sense.
   Thus 11.35 states that Pr f = f  Pr. Here f  L1(D) and Pr  L(D); hence
there is no problem with the integral in the definition of f  Pr being defined for all
z  D. See Exercise 11 for an interpretation of convolution when the functions are
transferred to the real line.
   The definition above of the convolution of two functions allows both functions to
be in L1(D). The product of two functions in L1(D) is not, in general, in L1(D).
Thus it is not obvious that the convolution of two functions in L1(D) is defined
anywhere. However, the next result shows that all is well.

11.37 convolution of two functions in L1(D) is in L1(D)

If f , g  L1(D), then ( f  g)(z) is defined for almost every z  D. Further-
more, f  g  L1(D) and  f  g1   f 1 g1.

Proof Suppose f , g  L1(D). The function (w, z)  f (w)g(zw) is a measur-
able function on D × D, as you are asked to show in Exercise 4. Now Tonelli's
Theorem (5.28) and 11.17 imply that

             | f (w)g(zw)| d(w) d(z) = | f (w)| |g(zw)| d(z) d(w)
D D                         D  D

                                              = | f (w)|g1 d(w)

                                                                      D

                                              =  f 1 g1.
The equation above implies that D| f (w)g(zw)| d(w) <  for almost every
z  D. Thus ( f  g)(z) is defined for almost every z  D.

   The equation above also implies that  f  g1   f 1 g1.
   Soon we will apply convolution results to Poisson integrals. However, first we
need to extend the previous result by bounding  f  gp when g  Lp(D).

                     Measure, Integration & Real Analysis, by Sheldon Axler
358 Chapter 11 Fourier Analysis

11.38 Lp-norm of a convolution

Suppose 1  p  , f  L1(D), and g  Lp(D). Then

           f  gp   f 1 gp.

Proof We use the following result to estimate the norm in Lp(D):

       If F : D  C is measurable and 1  p  , then

11.39                                                         p

       Fp = sup |Fh| d : h  L (D) and hp = 1 .

                                D

Hölder's inequality (7.9) shows that the left side of the equation above is greater
than or equal to the right side. The inequality in the other direction almost follows
from 7.12, but 7.12 would require the hypothesis that F  Lp(D) (and we want the
equation above to hold even if Fp = ). To get around this problem, apply 7.12
to truncations of F and use the Monotone Convergence Theorem (3.11); the details
of verifying 11.39 are left to the reader.

                             p

   Suppose h  L (D) and hp = 1. Then

D      |( f  g)(z)h(z)| d(z)   D D  | f (w)g(zw)| d(w)|h(z)| d(z)

          = | f (w)| |g(zw)h(z)| d(z) d(w)
                               D    D

           | f (w)|gphp d(w)

                D

11.40     =  f 1 gp,

where the second line above follows from Tonelli's Theorem (5.28) and the third line
follows from Hölder's inequality (7.9) and 11.17. Now 11.39 (with F = f  g) and
11.40 imply that  f  gp   f 1 gp.

Order does not matter in convolutions, as we now prove.

11.41 convolution is commutative
Suppose f , g  L1(D). Then f  g = g  f .

Proof Suppose z  D is such that ( f  g)(z) is defined. Then

( f  g)(z) = f (w)g(zw) d(w) = f (z)g() d() = (g  f )(z),
       D                            D

where the second equality follows from making the substitution  = zw (which
implies that w = z); the invariance of the integral under this substitution is explained
in connection with 11.17.

       Measure, Integration & Real Analysis, by Sheldon Axler
                                 Section 11B Fourier Series and Lp of Unit Circle 359

   Now we come to a major result, stating that for p  [1, ), the Poisson integrals
of functions in Lp(D) converge in the norm of Lp(D). This result fails for p = 
[see, for example, Exercise 12(d) in Section 11A].

  11.42 if f  Lp(D), then Pr f converges to f in Lp(D)
  Suppose 1  p <  and f  Lp(D). Then lim f - Pr f p = 0.

                                                                          r1

Proof Suppose  > 0. Let g : D  C be a continuous function on D such that
                                         f - gp < .

By 11.18, there exists R  [0, 1) such that
                                      g - Prg < 

for all r  (R, 1). If r  (R, 1), then
              f - Pr f p   f - gp + g - Prgp + Prg - Pr f p
                             <  + g - Prg + Pr(g - f )p
                             < 2 + Pr  (g - f )p
                              2 + Pr1 g - f p
                             < 3,

where the third line above is justified by 11.41, the fourth line above is justified by
11.38, and the last line above is justified by the equation Pr1 = 1, which follows
from 11.16(a) and 11.16(b). The last inequality implies that lim f - Pr f p = 0.

                                                                                            r1

   As a consequence of the result above, we can now prove that functions in L1(D),
and thus functions in Lp(D) for every p  [1, ], are uniquely determined by
their Fourier coefficients. Specifically, if g, h  L1(D) and g(n) = h(n) for every
n  Z, then applying the result below to g - h shows that g = h.

  11.43 functions are determined by their Fourier coefficients
  Suppose f  L1(D) and f (n) = 0 for every n  Z. Then f = 0.
Proof Because Pr f is defined in terms of Fourier coefficients (see 11.11), we know
that Pr f = 0 for all r  [0, 1). Because Pr f  f in L1(D) as r  1 [by 11.42]),
this implies that f = 0.
   Our next result shows that multiplication of Fourier coefficients corresponds to
convolution of the corresponding functions.

                      Measure, Integration & Real Analysis, by Sheldon Axler
360 Chapter 11 Fourier Analysis

11.44 Fourier coefficients of a convolution

Suppose f , g  L1(D). Then

                 f  g(n) = f (n) g(n)

for every n  Z.

Proof First note that if w  D and n  Z, then

11.45          g(zw) zn d(z) = g() nwn d() = wn g(n),

            D               D

where the first equality comes from the substitution  = zw (equivalent to z = w),
which is justified by the rotation invariance of .

   Now

               f  g(n) = ( f  g)(z) zn d(z)

                                    D

                 = zn f (w)g(zw) d(w) d(z)

                       D D

                 = f (w) g(zw) zn d(z) d(w)
                 D               D

                              = f (w) wn g(n) d(w)

                                                D

                              = f (n) g(n),
where the interchange of integration order in the third equality is justified by the same
steps used in the proof of 11.37 and the fourth equality above is justified by 11.45.

   The next result could be proved by appropriate uses of Tonelli's Theorem and
Fubini's Theorem. However, the slick proof technique used in the proof below should
be useful in dealing with some of the exercises.

11.46 convolution is associative
Suppose f , g, h  L1(D). Then ( f  g)  h = f  (g  h).

Proof Suppose n  Z. Using 11.44 twice, we have

            ( f  g)  h (n) = f  g(n) h(n) = f (n) g(n) h(n).

Similarly,

                  f  (g  h) (n) = f (n) g  h(n) = f (n) g(n) h(n).
Hence ( f  g)  h and f  (g  h) have the same Fourier coefficients. Because
functions in L1(D) are determined by their Fourier coefficients (see 11.43), this
implies that ( f  g)  h = f  (g  h).

            Measure, Integration & Real Analysis, by Sheldon Axler
                          Section 11B Fourier Series and Lp of Unit Circle 361

EXERCISES 11B

1 Show that the family {ek}kZ of trigonometric functions defined by 11.1 is an
    orthonormal basis of L2 (-, ] .

2 Use the result of Exercise 12(a) in Section 11A to show that

                              1 + 321 + 521 + 721 + · · · = 2 8 .
                                                                      1
3 Use techniques similar to Example 11.32 to evaluate  4 .
                                                                      n=1 n
[If                                                                                 1/n6.
     you  feel  industrious,       you  may     also  want  to  evaluate                   Similar
                                                                           n=1
                                                1/nk                                         k.
techniques      work  to  evaluate      n=1           for   each  positive   even   integer      You
                                                                               n3,
can  become     famous    if  you  figure  out  how   to  evaluate    n=1  1/       which  currently

is an open question.]

4 Suppose f , g : D  C are measurable functions. Prove that the function
    (w, z)  f (w)g(zw) is a measurable function from D × D to C.
    [Here the -algebra on D × D is the usual product -algebra as defined in
    5.2.]

5 Where does the proof of 11.42 fail when p = ?

6 Suppose f  L1(D). Prove that f is real valued (almost everywhere) if and
    only if f (-n) = f (n) for every n  Z.

                                                                                                        

7 Suppose f  L1(D). Show that f  L2(D) if and only if  | f (n)|2 < .

                                                                                                n=-

8 Suppose f  L2(D). Prove that | f (z)| = 1 for almost every z  D if and
only if
                              
                               f (k) f (k - n) =            1 if n = 0,

                          k=-                               0 if n = 0

for all n  Z.

9 For this exercise, for each r  [0, 1) think of Pr as an operator on L2(D).

(a) Show that Pr is a self-adjoint compact operator for each r  [0, 1).
(b) For each r  [0, 1), find all eigenvalues and eigenvectors of Pr.
(c) Prove or disprove: limr1I - Pr = 0.

10 Suppose f  L1(D). Define T : L2(D)  L2(D) by Tg = f  g.

      (a) Show that T is a compact operator on L2(D).
      (b) Prove that T is injective if and only if f (n) = 0 for every n  Z.
      (c) Find a formula for T.
      (d) Prove: T is self-adjoint if and only if all Fourier coefficients of f are real.
      (e) Show that T is a normal operator.

            Measure, Integration & Real Analysis, by Sheldon Axler
362 Chapter 11 Fourier Analysis

11 Show that if f , g  L1(D) then
                           ( f  g) (t) = 1  2 - f (x) g(t - x) dx,

      for those t  R such that ( f  g)(eit) makes sense; here ( f  g) , f , and g
      denote the transfers to the real line as defined in 11.24.
12 Suppose 1  p  . Prove that if f  Lp(D) and g  Lp(D), then f  g
      is a continuous function on D.
13 Suppose g  L1(D) is such that g(n) = 0 for infinitely many n  Z. Prove
      that if f  L1(D), then f  g = g.
14 Show that there exists a two-sided sequence . . . , b-2, b-1, b0, b1, b2, . . . such
      that lim bn = 0 but there does not exist f  L1(D) with f (n) = bn for all

              n±

      n  Z.
15 Prove that if f , g  L2(D), then

                                                                 

                         f g(n) =  f (k) g(n - k)

                                                            k=-

      for every n  Z.
16 Suppose f  L1(D). Prove that Pr(Ps f ) = Prs f for all r, s  [0, 1).
17 Suppose p  [1, ] and f  Lp(D). Prove that if 0  r < s < 1, then

   Pr f p  Ps f p.

18 Prove Wirtinger's inequality: If f : R  R is a continuously differentiable
      2-periodic function and -  f (t) dt = 0, then

 f (t) 2 dt   f (t) 2 dt,
-                                -

with equality if and only if f (t) = a sin(t) + b cos(t) for some constants a, b.

Measure, Integration & Real Analysis, by Sheldon Axler
                                  Section 11C Fourier Transform 363

11C Fourier Transform

Fourier Transform on L1(R)

We now switch from consideration of functions defined on the unit circle D to
consideration of functions defined on the real line R. Instead of dealing with Fourier
coefficients and Fourier series, we now deal with Fourier transforms.

Recall that - f (x) dx means R f d, where  denotes Lebesgue measure
on R, and similarly if a dummy variable other than x is used (see 3.39). Similarly,
Lp(R) means Lp() (the version that allows the functions to be complex valued).
                                  p 1/p
Thus in this section,  f p = -| f (x)| dx for 1  p < .

11.47 Definition Fourier transform; f

For f  L1(R), the Fourier transform of f is the function f : R  C defined by
                             f (t) =  f (x) e-2itx dx.

                                                    -

   We use the same notation f for the Fourier transform as we did for Fourier
coefficients. The analogies that we will see between the two concepts make using
the same notation reasonable. The context should make it clear whether this notation
refers to Fourier transforms (when we are working with functions defined on R)
or whether the notation refers to Fourier coefficients (when we are working with
functions defined on D).

   The factor 2 that appears in the exponent in the definition above of the Fourier
transform is a normalization factor. Without this normalization, we would lose the
beautiful result that  f 2 =  f 2 (see 11.82). Another possible normalization,
which is used by some books, is to define the Fourier transform of f at t to be

                                  -itx dx
                                 f (x) e  .
               -                       2

There is no right or wrong way to do the normalization--pesky 's will pop up
somewhere regardless of the normalization or lack of normalization. However, the
choice made in 11.47 seems to cause fewer problems than other choices.

11.48 Example Fourier transforms

(a) Suppose b  c. If t  R, then

  [b, c](t) =   c e-2itx dx

               b

                                             if t = 0,
      i e-2ict - e-2ibt                      if t = 0.
     
  =  2t c - b

Measure, Integration & Real Analysis, by Sheldon Axler
364 Chapter 11 Fourier Analysis

(b) Suppose f (x) = e-2|x| for x  R. If t  R, then
                    f (t) =  e-2|x| e-2itx dx

                                         -

= 0 e2x e-2itx dx +  e-2x e-2itx dx
-                                0

= 1 2(1 - it) + 1 2(1 + it)

= (t21+ 1) .

   Recall that the Riemann-Lebesgue Lemma on the unit circle D states that if
f  L1(D), then limn± f (n) = 0 (see 11.10). Now we come to the analogous
result in the context of the real line.

  11.49 Riemann-Lebesgue Lemma

  Suppose f  L1(R). Then f is uniformly continuous on R. Furthermore,

                          f    f 1 and lim f (t) = 0.

                                                                     t±

Proof Because |e-2itx| = 1 for all t  R and all x  R, the definition of the
Fourier transform implies that if t  R then

                                                           

                             | f (t)|  -| f (x)| dx =  f 1.
Thus  f    f 1.

   If f is the characteristic function of a bounded interval, then the formula in
Example 11.48(a) shows that f is uniformly continuous on R and limt± f (t) = 0.
Thus the same result holds for finite linear combinations of such functions. Such
finite linear combinations are called step functions (see 3.46).

   Now consider arbitrary f  L1(R). There exists a sequence f1, f2, . . . of step
functions in L1(R) such that limk f - fk1 = 0 (by 3.47). Thus

                                    lim  f - fk = 0.

                                               k

In other words, the sequence f1, f2, . . . converges uniformly on R to f . Because the
uniform limit of uniformly continuous functions is uniformly continuous, we can
conclude that f is uniformly continuous on R. Furthermore, the uniform limit of
functions on R each of which has limit 0 at ± also has limit 0 at ±, completing
the proof.

   The next result gives a condition that forces the Fourier transform of a function to
be continuously differentiable. This result also gives a formula for the derivative of
the Fourier transform. See Exercise 8 for a formula for the nth derivative.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                     Section 11C Fourier Transform 365

11.50 derivative of a Fourier transform

Suppose f  L1(R). Define g : R  C by g(x) = x f (x). If g  L1(R), then
f is a continuously differentiable function on R and

                      ( f )(t) = -2i g(t)

for all t  R.

Proof Fix t  R. Then

       lim f (t + s) - f (t) = lim  f (x) e-2itx e d -2isx - 1 xss
       s0                    s0 -

                      =  f (x) e-2itx lim e d -2isx - 1 xs
                             -                       s0

                      = -2i  x f (x) e-2itx dx

                                     -

                      = -2i g(t),

where the second equality is justified by using the inequality |ei - 1|  || (valid
for all   R, as the reader should verify) to show that |(e-2isx - 1)/s|  2|x|
for all s  R \ {0} and all x  R; the hypothesis that x f (x)  L1(R) and the
Dominated Convergence Theorem (3.31) then allow for the interchange of the limit
and the integral that is used in the second equality above.

   The equation above shows that f is differentiable and that ( f )(t) = -2i g(t)
for all t  R. Because g is continuous on R (by 11.49), we can also conclude that f
is continuously differentiable.

11.51 Example e-x2 equals its Fourier transform

Suppose  f     L1(R)  is defined by  f (x)  =   -x2  Then the function  g:  R    C

                                               e.
defined by g(x) = x f (x) = xe-x2 is in L1(R). Hence 11.50 implies that if t  R
then

       ( f )(t) = -2i  xe-x2 e-2itx dx

                                   -

               = ie-x2 e-2itx        x= - 2t  e-x2 e-2itx dx
                                     x=-             -

11.52          = -2t f (t),

where the second equality follows from integration by parts (if you are nervous about
doing an integration by parts from - to , change each integral to be the limit as
M   of the integral from -M to M).

               Measure, Integration & Real Analysis, by Sheldon Axler
366 Chapter 11 Fourier Analysis

   Note that f (t) = -2te-t2 = -2t f (t). Combining this equation with 11.52
shows that

       f  f (t) = f (t) 2 f (t) ( f ) = - (t) - f (t) f (t) 2t f (t) 2 f (t) f (t) - f (t) f (t) = 0

for all t  R. Thus f / f is a constant function. In other words, there exists c  C
such that f = c f . To evaluate c, note that

11.53                    f (0) =  e-x2 dx = 1 = f (0),

                                       -

where the integral above is evaluated by writing its square as the integral times the
same integral but using y instead of x for the dummy variable and then converting to
polar coordinates (dx dy = r dr d).

   Clearly 11.53 implies that c = 1. Thus f = f .

   The next result gives a formula for the Fourier transform of a derivative. See
Exercise 9 for a formula for the Fourier transform of the nth derivative.

11.54 Fourier transform of a derivative

Suppose f  L1(R) is a continuously differentiable function and f   L1(R).
If t  R, then

                                 ( f ) (t) = 2it f (t).

Proof Suppose  > 0. Because f and f  are in L1(R), there exists a  R such that

                          

                            | f (x)| dx <  and | f (a)| < .

                         a

Now if b > a then

                      b                     
       | f (b)| =        f (x) dx + f (a)  | f (x)| dx + | f (a)| < 2.
                   a                     a

Hence limx f (x) = 0. Similarly, limx- f (x) = 0.
   If t  R, then

       ( f ) (t) =  f (x) e-2itx dx

                           -

                   = f (x) e-2itx x + = 2it  f (x) e-2itx dx
                         x=-                  -

                       = 2it f (t),
where the second equality comes from integration by parts and the third equality
holds because we showed in the paragraph above that limx± f (x) = 0.

   The next result gives formulas for the Fourier transforms of some algebraic
transformations of a function. Proofs of these formulas are left to the reader.

       Measure, Integration & Real Analysis, by Sheldon Axler
                                                    Section 11C Fourier Transform 367

11.55 Fourier transforms of translations, rotations, and dilations

Suppose f  L1(R), b  R, and t  R.

(a) If g(x) = f (x - b) for all x  R, then g(t) = e-2ibt f (t).

(b) If g(x) = e2ibx f (x) for all x  R, then g(t) = f (t - b).

(c)    If  b  =  0  and  g(x)  =  f (bx)  for  all  x    R,  then  g(t)  =  1    f  t  .
                                                                            |b|     b

11.56 Example Fourier transform of a rotation of an exponential function

   Suppose y > 0, x  R, and h(t) = e-2y|t| e2ixt. To find the Fourier transform
of h, first consider the function g defined by g(t) = e-2y|t|. By 11.48(b) and
11.55(c), we have

11.57                    g(t) = 1          1             =  t2 + y2 1 y .
                                  y
                                          t2

                                          y +1

Now 11.55(b) implies that

11.58                             h(t) =  (t - x)2 + y2 1 y ;

note that x is a constant in the definition of h, which has t as the variable, but x is the
variable in 11.55(b)--this slightly awkward permutation of variables is done in this
example to make a later reference to 11.58 come out cleaner.

The next result will be immensely useful later in this section.

11.59 integral of a function times a Fourier transform

Suppose f , g  L1(R). Then                              

                                                       - f (t) g(t) dt.

                         - f (t) g(t) dt =

Proof Both integrals in the equation above make sense because f , g  L1(R) and
f , g  L(R) (by 11.49). Using the definition of the Fourier transform, we have

                     f (t) g(t) dt =  g(t)  f (x) e-2itx dx dt
                    -                     -              -

                                  =  f (x)  g(t) e-2itx dt dx
                                          -              -

                                          

                                  = - f (x) g(x) dx,

where Tonelli's Theorem and Fubini's Theorem justify the second equality. Changing
the dummy variable x to t in the last expression gives the desired result.

                    Measure, Integration & Real Analysis, by Sheldon Axler
368 Chapter 11 Fourier Analysis

Convolution on R

Our next big goal is to prove the Fourier Inversion Formula. This remarkable formula,
discovered by Fourier, states that if f  L1(R) and f  L1(R), then

11.60     f (x) =  f (t) e2ixt dt

                        -

for almost every x  R. We will eventually prove this result (see 11.76), but first we
need to develop some tools that will be used in the proof. To motivate these tools, we
look at the right side of the equation above for fixed x  R and see what we would
need to prove that it equals f (x).

   To get from the right side of 11.60 to an expression involving f rather than f , we
should be tempted to use 11.59. However, we cannot use 11.59 because the function
t  e2ixt is not in L1(R), which is a hypothesis needed for 11.59. Thus we throw
in a convenient convergence factor, fixing y > 0 and considering the integral

11.61       f (t) e-2y|t| e2ixt dt.

          -

The convergence factor above is a good choice because for fixed y > 0 the function
t  e-2y|t| is in L1(R), and limy0 e-2y|t| = 1 for every t  R (which means
that 11.61 may be a good approximation to 11.60 for y close to 0).

   Now let's be rigorous. Suppose f  L1(R). Fix y > 0 and x  R. Define
h : R  C by h(t) = e-2y|t|e2ixt. Then h  L1(R) and

        f (t) e-2y|t| e2ixt dt =  f (t) h(t) dt
       -                         -

                                         

                                 = - f (t) h(t) dt

11.62                            = 1   - f (t) (x - t)2 + y2 y dt,

where the second equality comes from 11.59 and the third equality comes from 11.58.
We will come back to the specific formula in 11.62 later, but for now we use 11.62 as

                                                                              

motivation for study of expressions of the form - f (t)g(x - t) dt. Thus we have
been led to the following definition.

11.63 Definition convolution; f  g

Suppose f , g : R  C are measurable functions. The convolution of f and g is
denoted f  g and is the function defined by

                                                             

                         ( f  g)(x) = - f (t) g(x - t) dt
for those x  R for which the integral above makes sense.

          Measure, Integration & Real Analysis, by Sheldon Axler
                                          Section 11C Fourier Transform 369

   Here we are using the same terminology and notation as was used for the convolu-
tion of functions on the unit circle. Recall that if F, G  L1(D), then

                    (F  G)(ei ) =  - F(eis) G(ei(-s)) ds 2

for   R (see 11.36). The context should always indicate whether f  g denotes
convolution on the unit circle or convolution on the real line. The formal similarities
between the two notions of convolution make many of the proofs transfer in either
direction from one context to the other.
If f , g  L1(R), then f  g is defined If 1  p  , f  Lp(R), and
for almost every x  R, and furthermore    p
 f  g1   f 1 g1 (as you should g  L (R), then Hölder's
verify by translating the proof of 11.37 to inequality (7.9) and the translation
the context of R).                        invariance of Lebesgue measure

If p  (1, ], then neither L1(R) nor imply ( f  g)(x) is defined for all
Lp(R) is a subset of the other [unlike the x  R and  f  g   f p gp
inclusion Lp(D)  L1(D)]. Thus we (more is true; with these hypotheses,
do not yet know that f  g makes sense f  g is a uniformly continuous
for f  L1(R) and g  Lp(R). However, function on R, as you are asked to
the next result shows that all is well.   show in Exercise 10).

  11.64 Lp-norm of a convolution
  Suppose 1  p  , f  L1(R), and g  Lp(R). Then ( f  g)(x) is defined
  for almost every x  R. Furthermore,

                                   f  gp   f 1 gp.
Proof First consider the case where f (x)  0 and g(x)  0 for almost every
x  R. Thus ( f  g)(x) is defined for each x  R, although its value might equal .
Apply the proof of 11.38 to the context of R, concluding that  f  gp   f 1 gp
[which implies that ( f  g)(x) <  for almost every x  R].

   Now consider arbitrary f  L1(R), and g  Lp(R). Apply the case of the
previous paragraph to | f | and |g| to get the desired conclusions.

   The next proof, as is the case for several other proofs in this section, asks the
reader to transfer the proof of the analogous result from the context of the unit circle
to the context of the real line. This should require only minor adjustments of a proof
from one of the two previous sections. The best way to learn this material is to write
out for yourself the required proof in the context of the real line.

11.65 convolution is commutative
Suppose f , g : R  C are measurable functions and x  R is such that
( f  g)(x) is defined. Then ( f  g)(x) = (g  f )(x).

Proof  Adjust the proof of 11.41 to the context of R.
                  Measure, Integration & Real Analysis, by Sheldon Axler
370 Chapter 11 Fourier Analysis
   Our next result shows that multiplication of Fourier transforms corresponds to

convolution of the corresponding functions.

  11.66 Fourier transform of a convolution
  Suppose f , g  L1(R). Then

                                         f  g = f g.
Proof Adjust the proof of 11.44 to the context of R.

Poisson Kernel on Upper Half-Plane

As usual, we identify R2 with C, as illustrated in the following definition. We will
see that the upper half-plane plays a role in the context of R similar to the role that
the open unit disk plays in the context of D.

  11.67 Definition H; upper half-plane
    · H denotes the open upper half-plane in R2:
                    H = {(x, y)  R2 : y > 0} = {z  C : Im z > 0}.
    · H is identified with the real line:
                H = {(x, y)  R2 : y = 0} = {z  C : Im z = 0} = R.
   Recall that we defined a family of functions on D called the Poisson kernel on D

(see 11.14, where the family is called the Poisson kernel on D because 0  r < 1 and
  D implies r  D). Now we are ready to define a family of functions on R that
is called the Poisson kernel on H [because x  R and y > 0 implies (x, y)  H].

   The following definition is motivated by 11.62. The notation Pr for the Poisson
kernel on the unit disk D and the notation Py for the Poisson kernel on the upper-half
plane H is potentially ambiguous (what is P1/2?), but the intended meaning should
always be clear from the context.

  11.68 Definition Py; Poisson kernel
    · For y > 0, define Py : R  (0, ) by
                                      Py(x) =  x2 + y2 1 y .
    · The family of functions {Py}y>0 is called the Poisson kernel on the upper
       half-plane H.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                    Section 11C Fourier Transform 371

   The properties of the Poisson kernel on H listed in the result below should be
compared to the corresponding properties (see 11.16) of the Poisson kernel on D.

11.69 properties of Py

(a) Py(x) > 0 for all y > 0 and all x  R.

          

(b) - Py(x) dx = 1 for each y > 0.

(c) lim                        Py(x) dx = 0 for each  > 0.
      y0 {xR:|x|}

Proof Part (a) follows immediately from the definition of Py(x) given in 11.68.
Parts (b) and (c) follow from explicitly evaluating the integrals, using the result
that  for  each  y     0,  an  anti-derivative  of  Py ( x)  (as  a  function  of  x)  is  1  arctan  x.
                    >                                                                      
                                                                                                      y

   If p  [1, ] and f  Lp(R) and y > 0, then f  Py makes sense because
Py  Lp(R). Thus the following definition makes sense.

11.70 Definition Py f
For f  Lp(R) for some p  [1, ] and for y > 0, define Py f : R  C by

      (Py f )(x) =  - f (t) Py(x - t) dt = 1   - f (t) (x - t)2 + y2 y dt
for x  R. In other words, Py f = f  Py.

   The next result is analogous to 11.18,           When Napoleon appointed Fourier
except that now we need to include in the           to an administrative position in
hypothesis that our function is uniformly           1806, Siméon-Denis Poisson
continuous and bounded (those conditions            (1781-1840) was appointed to the
follow automatically from continuity in             professor position at École
the context of the unit circle).                    Polytechnique vacated by Fourier.
                                                    Poisson published over 300
   For the proof of the result below, you           mathematical papers in his lifetime.
should use the properties in 11.69 instead
of the corresponding properties in 11.16.

  11.71 if f is uniformly continuous and bounded, then lim f - Py f  = 0

                                                                                           y0

  Suppose f : R  C is uniformly continuous and bounded. Then Py f converges
  uniformly to f on R as y  0.
Proof Adjust the proof of 11.18 to the context of R.

                    Measure, Integration & Real Analysis, by Sheldon Axler
372 Chapter 11 Fourier Analysis

The function u defined in the result below is called the Poisson integral of f on H.

11.72 Poisson integral is harmonic

Suppose f  Lp(R) for some p  [1, ]. Define u : H  C by
                                  u(x, y) = (Py f )(x)

for x  R and y > 0. Then u is harmonic on H.

Proof We assume that f is real valued (otherwise apply the real-valued case to the
real and imaginary parts of f ). For x  R and y > 0, let z = x + iy. Then

                               (x - t)2 + y2 y = - Im 1 z - t

for t  R. Thus u(x, y) = - Im 1  f (t) 1 dt.
                                                           - z - t
                          
The function z  -         -  f  (  t  )  z  1  t  dt  is  analytic  on  H;  its  derivative  is  the  function
                                            -
z       f (t) (z-1t)2  dt  (justification             for  this  statement  is   in  the  next   paragraph).
   -
In other words, we can differentiate (with respect to z) under the integral sign in
the expression above. Because u is the imaginary part of an analytic function, u is
harmonic on H, as desired.
To justify the differentiation under the integral sign, fix z  H and define a
function g : H  C by g(z) = -                              1
                                                  - f (t) z-t dt. Then

   g(z) - g(w) z - w -  - f (t) (z - t)2 1 dt =  - f (t) (z - t)2 z - w (w - t) dt.

As w  z, the function t                           z-w      goes to 0 in the norm of Lp(R). Thus

                                                    2
                                         (z-t) (w-t)
Hölder's inequality (7.9) and the equation above imply that g(z) exists and that
                       1
g(z) =  - f (t) (z-t)2 dt, as desired.

   We have now solved the Dirichlet problem on the upper half-plane for uniformly
continuous, bounded functions on R (see 11.21 for statement of Dirichlet problem).

  11.73 Poisson integral solves Dirichlet problem on half-plane

  Suppose f : R  C is uniformly continuous and bounded. Define u : H  C
  by

                     u(x, y) = (Py f )(x) if x  R and y > 0, f (x) if x  R and y = 0.
  Then u is continuous on H, u|H is harmonic, and u|R = f .

Proof Adjust the proof of 11.23 to the context of R; now you will need to use 11.71
and 11.72 instead of the corresponding results for the unit circle.

          Measure, Integration & Real Analysis, by Sheldon Axler
                                                       Section 11C Fourier Transform 373

The next result, which states that the                 Poisson and Fourier are two of the

                                                    p
Poisson integrals of functions in L (R)
                p                                      72 mathematicians/scientists whose
converge in the norm of L (R), will be names are prominently inscribed on
a major tool in proving the Fourier Inver- the Eiffel Tower in Paris.
sion Formula and other results later in this
section.
For the result below, the proof of the corresponding result on the unit circle (11.42)
does not transfer to the context of R (because the inequality ·p  · fails in the
context of R).

11.74 if f  Lp(R), then Py f converges to f in Lp(R)
Suppose 1  p <  and f  Lp(R). Then lim f - Py f p = 0.

                                                                    y0

Proof     If y > 0 and x  R, then
            | f (x) - (Py f )(x)| =
                                                      
                                    =
                                       f (x) - - f (x - t) Py(t) dt

                                          

                                        - f (x) - f (x - t) Py(t) dt

11.75                     f (x) - f (x - t) p Py(t) dt 1/p,

                                -

where the inequality comes from applying 7.10 to the measure Py dt (note that the
measure of R with respect to this measure is 1).

   Define h : R  [0, ) by

                h(t) =  f (x) - f (x - t) p dx.

                             -

Then h is a bounded function that is uniformly continuous on R [by Exercise 23(a) in
Section 7A]. Furthermore, h(0) = 0.

   Raising both sides of 11.75 to the pth power and then integrating over R with
respect to x, we have

                p                      f (x) - f (x - t) Py(t) dt dxp
           f - Py f p 
                        - -

                =  Py(t)  f (x) - f (x - t) p dx dt
                        -                              -

                        

                = - Py(-t) h(t) dt

                = (Pyh)(0).

Now 11.71 implies that lim(Pyh)(0) = h(0) = 0. Hence the last inequality above

                                     y0

implies that lim f - Py f p = 0.

                   y0

                Measure, Integration & Real Analysis, by Sheldon Axler
374 Chapter 11 Fourier Analysis

Fourier Inversion Formula

Now we can prove the remarkable Fourier Inversion Formula.

11.76 Fourier Inversion Formula

Suppose f  L1(R) and f  L1(R). Then
                               f (x) =  f (t) e2ixt dt

                                                       -

for almost every x  R. In other words,
                                   f (x) = f (-x)

for almost every x  R.

Proof Equation 11.62 states that

11.77    f (t) e-2y|t| e2ixt dt = (Py f )(x)

       -

for every x  R and every y > 0.
   Because f  L1(R), the Dominated Convergence Theorem (3.31) implies that for

every x  R, the left side of 11.77 has limit f (-x) as y  0.
   Because f  L1(R), 11.74 implies that limy0 f - Py f 1 = 0. Now 7.23 im-

plies that there is a sequence of positive numbers y1, y2, . . . such that limn yn = 0
and limn(Pyn f )(x) = f (x) for almost every x  R.

   Combining the results in the two previous paragraphs and equation 11.77 shows
that f (x) = f (-x) for almost every x  R.

   The Fourier transform of a function in L1(R) is a uniformly continuous function on
R (by 11.49). Thus the Fourier Inversion Formula (11.76) implies that if f  L1(R)
and f  L1(R), then f can be modified on a set of measure zero to become a
uniformly continuous function on R.

   The Fourier Inversion Formula now allows us to calculate the Fourier transform
of Py for each y > 0.

11.78 Example Fourier transform of Py
   Suppose y > 0. Define f : R  (0, 1] by

                                  f (t) = e-2y|t|.

Then f = Py by 11.57. Hence both f and f are in L1(R). Thus we can apply the
Fourier Inversion Formula (11.76), concluding that

11.79  (Py) (x) = f (x) = f (-x) = e-2y|x|

for almost every x  R. The continuity of these functions (see 11.49) implies that
the equation above holds for all x  R.

       Measure, Integration & Real Analysis, by Sheldon Axler
                                     Section 11C Fourier Transform 375

Now we can prove that the map on L1(R) defined by f  f is one-to-one.

11.80 functions are determined by their Fourier transforms

Suppose f  L1(R) and f (t) = 0 for every t  R. Then f = 0.

Proof Because f = 0, we also have f  = 0. The Fourier Inversion Formula
(11.76) now implies that f = 0.

   The next result could be proved directly using the definition of convolution and
Tonelli's/Fubini's Theorems. However, the following cute proof deserves to be seen.

  11.81 convolution is associative
  Suppose f , g, h  L1(R). Then ( f  g)  h = f  (g  h).

Proof The Fourier transform of ( f  g)  h and the Fourier transform of f  (g  h)
both equal f gh (by 11.66). Because the Fourier transform is a one-to-one mapping
on L1(R) [see 11.80], this implies that ( f  g)  h = f  (g  h).

Extending Fourier Transform to L2(R)

We now prove that the map f  f preserves L2(R) norms on L1(R)  L2(R).

11.82 Plancherel's Theorem: Fourier transform preserves L2(R) norms

Suppose f  L1(R)  L2(R). Then  f 2 =  f 2.

Proof First consider the case where f  L1(R) in addition to the hypothesis that
f  L1(R)  L2(R). Define g : R  C by g(x) = f (-x). Then g(t) = f (t) for
all t  R, as is easy to verify. Now

         f  2          f (x) f (x) dx

              2  =  -

                         

                 = - f (-x) f (-x) dx

11.83                                (x) g(x) dx

                 = - f

11.84                    

                 = - f (x) g(x) dx

                         

                 = - f (x) f (x) dx

                 =  f 22,

       Measure, Integration & Real Analysis, by Sheldon Axler
376 Chapter 11 Fourier Analysis

where 11.83 holds by the Fourier Inversion Formula (11.76) and 11.84 follows from
11.59. The equation above shows that our desired result holds in the case when
f  L1(R).

   Now consider arbitrary f  L1(R)  L2(R). If y > 0, then f  Py  L1(R) by
11.64. If x  R, then

       ( f  Py) (x) = f (x)(Py) (x)

11.85                            = f (x) e-2y|x|,

where the first equality above comes from 11.66 and the second equality comes from
11.79. The equation above shows that ( f  Py)  L1(R). Thus we can apply the
first case to f  Py, concluding that

        f  Py2 = ( f  Py) 2.

As y  0, the left side of the equation above converges to  f 2 [by 11.74]. As y  0,
the right side of the equation above converges to  f 2 [by the explicit formula for
f  Py given in 11.85 and the Monotone Convergence Theorem (3.11)]. Thus the

equation above implies that  f 2 =  f 2.

   Because L1(R)  L2(R) is dense in L2(R), Plancherel's Theorem (11.82) allows
us to extend the map f  f uniquely to a bounded linear map from L2(R) to L2(R)
(see Exercise 14 in Section 6C). This extension is called the Fourier transform on
L2(R); it gets its own notation, as shown below.

  11.86 Definition Fourier transform on L2(R); F

  The Fourier transform F on L2(R) is the bounded operator on L2(R) such that
  F f = f for all f  L1(R)  L2(R).

   For f  L1(R)  L2(R), we can use either f or F f to denote the Fourier
transform of f . But if f  L1(R) \ L2(R), we will use only the notation f , and if
f  L2(R) \ L1(R), we will use only the notation F f .

   Suppose f  L2(R) \ L1(R) and t  R. Do not make the mistake of thinking
that (F f )(t) equals 

                                          f (x) e-2itx dx.

                                                 -

Indeed, the integral above makes no sense because f (x) e-2itx = | f (x)| and
f / L1(R). Instead of defining F f via the equation above, F f must be defined as the
limit in L2(R) of ( f1) , ( f2) , . . ., where f1, f2, . . . is a sequence in L1(R)  L2(R)
such that

                                 f - fn2  0 as n  .
For example, one could take fn = f [-n, n] because  f - f [-n, n]2  0 as n  
by the Dominated Convergence Theorem (3.31).

       Measure, Integration & Real Analysis, by Sheldon Axler
                                       Section 11C Fourier Transform 377

   Because F is obtained by continuously extending [in the norm of L2(R)] the
Fourier transform from L1(R)  L2(R) to L2(R), we know that F f 2 =  f 2 for
all f  L2(R). In other words, F is an isometry on L2(R). The next result shows
that even more is true.

11.87 properties of the Fourier transform on L2(R)

(a) F is a unitary operator on L2(R).
(b) F 4 = I.
(c) sp(F ) = {1, i, -1, -i}.

Proof First we prove (b). Suppose f  L1(R)  L2(R). If y > 0, then Py  L1(R)
and hence 11.64 implies that

11.88  f  Py  L1(R)  L2(R).

Also,

11.89  ( f  Py)  L1(R)  L2(R),

as follows from the equation ( f  Py) = f · (Py) [see 11.66] and the observation
that f  L(R), (Py)  L1(R) [see 11.49 and 11.79] and the observation that
f  L2(R), (Py)  L(R) [see 11.82 and 11.49].

   Now the Fourier Inversion Formula (11.76) as applied to f  Py (which is valid by
11.88 and 11.89) implies that

                                    F 4( f  Py) = f  Py.
Taking the limit in L2(R) of both sides of the equation above as y  0, we have
F 4 f = f (by 11.74), completing the proof of (b).

   Plancherel's Theorem (11.82) tells us that F is an isometry on L2(R). Part (b)
implies that F is surjective. Because a surjective isometry is unitary (see 10.61), we
conclude that F is unitary, completing the proof of (a).

   The Spectral Mapping Theorem [see 10.40--take p(z) = z4] and (b) imply that
4 = 1 for each   sp(F ). In other words, sp(F )  {1, i, -1, -i}. However, 1,
i, -1, -i are all eigenvalues of F (see Example 11.51 and Exercises 2, 3, and 4) and
thus are all in sp(F ). Hence sp(F ) = {1, i, -1, -i}, completing the proof of (c).

EXERCISES 11C

 1 Suppose f  L1(R). Prove that  f  =  f 1 if and only if there exists
       D and t  R such that  f (x)e-itx  0 for almost every x  R.

 2 Suppose f (x) = xe-x2 for all x  R. Show that f = -i f .

                     Measure, Integration & Real Analysis, by Sheldon Axler
378 Chapter 11 Fourier Analysis

3 Suppose f (x) = 4x2 e-x2 - e-x2 for all x  R. Show that f = - f .

4 Find f  L1(R) such that f = 0 and f = i f .

5 Prove that if p is a polynomial on R with complex coefficients and f : R  C
                                                  2
is  defined  by  f (x)  =  p  (  x  )  e  -    x     then  there  exists  a  polynomial  q  on  R  with
                                                  ,
complex coefficients such that deg q = deg p and f (t) = q(t) e-t2 for all
t  R.

6 Suppose

                              f (x) =                xe-2x  if x > 0,
                                                     0      if x  0.

Show that f (t) = 42(1 + it)2 1 for all t  R.

7 Prove the formulas in 11.55 for the Fourier transforms of translations, rotations,
    and dilations.

8 Suppose f  L1(R) and n  Z+. Define g : R  C by g(x) = xn f (x). Prove
    that if g  L1(R), then f is n times continuously differentiable on R and

                                 ( f )(n)(t) = (-2i)n g(t)

    for all t  R.
9 Suppose n  Z+ and f  L1(R) is n times continuously differentiable and

     f (k)  L1(R) for k = 1, . . . , n. Prove that if t  R, then

                                       f (n)(t) = (2it)n f (t).

10 Suppose 1  p  , f  Lp(R), and g  Lp(R). Prove that f  g is a
      uniformly continuous function on R.

11 Suppose f  L(R), x  R, and f is continuous at x. Prove that

                                       lim(Py f )(x) = f (x).

                                       y0

12 Suppose p  [1, ] and f  Lp(R). Prove that Py(Py f ) = Py+y f for all
      y, y > 0.

13 Suppose p  [1, ] and f  Lp(R). Prove that if 0 < y < y, then

                                       Py f p  Py f p.

14 Suppose f  L1(R).

(a) Prove that f (t) = f (-t) for all t  R.
(b) Prove that f (x)  R for almost every x  R if and only if f (t) = f (-t)

     for all t  R.

             Measure, Integration & Real Analysis, by Sheldon Axler
                                                         Section 11C Fourier Transform 379

15 Define f  L1(R) by f (x) = e-x4 [0, )(x). Show that f / L1(R).
16 Suppose f  L1(R) and f  L1(R). Prove that f  L2(R) and f  L2(R).
17 Prove there exists a continuous function g : R  R such that lim g(t) = 0

                                                                                                        t±

      and g / { f : f  L1(R)}.
18 Prove that if f  L1(R), then  f 2 =  f 2.

      [This exercise slightly improves Plancherel's Theorem (11.82) because here we
      have the weaker hypothesis that f  L1(R) instead of f  L1(R)  L2(R).
      Because of Plancherel's Theorem, here you need only prove that if f  L1(R)
      and  f 2 = , then  f 2 = .]
19 Suppose y > 0. Define on operator T on L2(R) by T f = f  Py.
      (a) Show that T is a self-adjoint operator on L2(R).
      (b) Show that sp(T) = [0, 1].
      [Because the spectrum of each compact operator is a countable set (by 10.93),
      part (b) above implies that T is not a compact operator. This conclusion differs
      from the situation on the unit circle--see Exercise 9 in Section 11B.]
20 Prove that if f  L1(R) and g  L2(R), then F ( f  g) = f F g.
21 Prove that if f , g  L2(R), then f g = (F f )  (F g).

                      Measure, Integration & Real Analysis, by Sheldon Axler
                     Chapter 12

       Probability Measures

Probability theory has become increasingly important in multiple parts of science.
Getting deeply into probability theory requires a full book, not just a chapter. For
readers who intend to pursue further studies in probability theory, this chapter gives
you a good head start. For readers not intending to delve further into probability
theory, this chapter gives you a taste of the subject.

   Modern probability theory makes major use of measure theory. As we will see, a
probability measure is simply a measure such that the measure of the whole space
equals 1. Thus a thorough understanding of the chapters of this book dealing with
measure theory and integration provides a solid foundation for probability theory.

   However, probability theory is not simply the special case of measure theory where
the whole space has measure 1. The questions that probability theory investigates
differ from the questions natural to measure theory. For example, the probability
notions of independent sets and independent random variables, which are introduced
in this chapter, do not arise in measure theory.

   Even when concepts in probability theory have the same meaning as well-known
concepts in measure theory, the terminology and notation can be quite different. Thus
one goal of this chapter is to introduce the vocabulary of probability theory. This
difference in vocabulary between probability theory and measure theory occurred
because the two subjects had different historical developments, only coming together
in the first half of the twentieth century.

Dice used in games of chance. The beginning of probability theory can be traced to
correspondence in 1654 between Pierre de Fermat (1601-1665) and Blaise Pascal
(1623-1662) about how to distribute fairly money bet on an unfinished game of dice.

                                                    CC-BY-SA Alexander Dreyer

                                                                                                            380
                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                          Chapter 12 Probability Measures 381

Probability Spaces

We begin with an intuitive and nonrigorous motivation. Suppose we pick a real
number at random from the interval (0, 1), with each real number having an equal
probability of being chosen (whatever that means). What is the probability that the
chosen  number  is  in  the  interval         9   ,  1)?  The  only  reasonable     answer  to  this  question
                                           (  10

is  1.  More  generally,  if  I1,  I2,  .  .  .  is  a  disjoint  sequence  of  open  intervals   contained
                                                                                                       
    10
in (0, 1), then the probability that our randomly chosen real number is in                             n=1 In
should  be          In  ),   where      (I)          denotes   the  length  of  an  interval  I.  Still  more
                 (
            n=1
generally, if A is a Borel subset of (0, 1), then the probability that our random number
is in A should be the Lebesgue measure of A.
    With the paragraph above as motivation, we are now ready to define a probability
measure. We will use the notation and terminology common in probability theory
instead of the conventions of measure theory.
    In particular, the set in which everything takes place is now called  instead of
the usual X in measure theory. The -algebra on  is called F instead of S, which
we have used in previous chapters. Our measure is now called P instead of µ. This
new notation and terminology can be disorienting when first encountered. However,
reading this chapter should help you become comfortable with this notation and
terminology, which are standard in probability theory.

    12.1 Definition probability measure; sample space; event; probability space

    Suppose F is a -algebra on a set .
      · A probability measure on (, F ) is a measure P on (, F ) such that
         P() = 1.
      ·  is called the sample space.
      · An event is an element of F (F need not be mentioned if it is clear from the
         context).
      · If A is an event, then P(A) is called the probability of A.
      · If P is a probability measure on (, F ), then the triple (, F , P) is called a
         probability space.

12.2 Example probability measures

  · Suppose n  Z+ and  is a sample space containing exactly n elements. Let F
     denote the collection of all subsets of . Then
                                       counting measure on 
                                                    n
     is a probability measure on (, F ).

                     Measure, Integration & Real Analysis, by Sheldon Axler
382 Chapter 12 Probability Measures

· As a more specific example of                   This example illustrates the common
   the previous item, suppose that
 = {40, 41, . . . , 49} and P = practice in probability theory of
(counting measure on )/10. Let using lower case  to denote a
A = {   :  is even} and typical element of upper case .
B = {   :  is prime}. Then P(A) [which is the probability that an
element   of  this  sample    space    is  even]  is  1  and  P(B)    [which  is  the  probability
                                                      2           3.
that  an  element   of  this  sample  space       is  prime]  is
                                                                  10

· Let  denote Lebesgue measure on the interval [0, 1]. Then  is a probability
   measure on ([0, 1], B), where B denotes the -algebra of Borel subsets of [0, 1].

· Let  denote Lebesgue measure on R, and let B denote the -algebra of Borel
subsets of R. Define h : R  (0, ) by h(x) = 1                          -x2/2
                                                                  2               Then  h d  is  a
                                                                      e.

probability measure on (R, B) [see 9.6 for the definition of h d].

   In measure theory, we used the notation A to denote the characteristic function
of a set A. In probability theory, this function has a different name and different
notation, as we see in the next definition.

12.3 Definition indicator function; 1A
If  is a sample space and A  , then the indicator function of A is the
function 1A :   R defined by

                               1A() = 1 if   A, 0 if  / A.

   The next definition gives the replacement in probability theory for measure theory's
phrase almost every.

12.4 Definition almost surely
Suppose (, F , P) is a probability space. An event A is said to happen almost
surely if the probability of A is 1, or equivalently if P( \ A) = 0.

12.5 Example almost surely
   Let P denote Lebesgue measure on the interval [0, 1]. If   [0, 1], then  is

almost surely an irrational number (because the set of rational numbers has Lebesgue
measure 0).

   This example shows that an event having probability 1 (equivalent to happening
almost surely) does not mean that the event definitely happens. Conversely, an event
having probability 0 does not mean that the event is impossible. Specifically, if a real
number is chosen at random from [0, 1] using Lebesgue measure as the probability,
then the probability that the number is rational is 0, but that event can still happen.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                              Chapter 12 Probability Measures 383

   The following result is frequently useful in probability theory. A careful reading of
the proof of this result, as our first proof in this chapter, should give you good practice
using some of the notation and terminology commonly used in probability theory.
This proof also illustrates the point that having a good understanding of measure
theory and integration can often be extremely useful in probability theory--here we
use the Monotone Convergence Theorem.

12.6 Borel-Cantelli Lemma

Suppose (, F , P) is a probability space and A1, A2, . . . is a sequence of events
such  that       P(An)          .  Then
                             <
            n=1

            P({   :   An for infinitely many n  Z+}) = 0.

Proof Let A = {   :   An for infinitely many n  Z+}. Then

                                              

                                     A=              An.

                                         m=1 n=m

Thus A  F , and hence P(A) makes sense.
   The Monotone Convergence Theorem (3.11) implies that

                                                           
                                dP =  1An dP =  P(An) < .
                1An                  n=1                   n=1

             n=1

Thus        1An  is  almost  surely  finite.  Hence  P(A)  =  0.

      n=1

Independent Events and Independent Random Variables

The notion of independent events, which we now define, is one of the key concepts
that distinguishes probability theory from measure theory.

  12.7 Definition independent events
  Suppose (, F , P) is a probability space.

    · Two events A and B are called independent if
                                   P(A  B) = P(A) · P(B).

    · More generally, a family of events {Ak}k is called independent if
                          P(Ak1  · · ·  Akn ) = P(Ak1) · · · P(Akn )

       whenever k1, . . . , kn are distinct elements of .
   The next two examples should help develop your intuition about independent
events.

                     Measure, Integration & Real Analysis, by Sheldon Axler
384 Chapter 12 Probability Measures

12.8 Example independent events: coin tossing
   Suppose  = {H, T}4, where H and T are symbols that you can think of as

denoting "heads" and "tails". Thus elements of  are 4-tuples of the form

                                       = (1, 2, 3, 4),

where each j is H or T. Let F be the collection of all subsets of , and let
P = (counting measure on )/16, as we expect from a fair coin toss.

   Let

A = {   : 1 = 2 = 3 = H} and B = {   : 4 = H}.

Then   A  contains   two   elements   and   thus   P(A)     =  1,   corresponding    to  probability  1
                                                                                                      8
                                                               8
that the first three coin tosses are all heads. Also, B contains eight elements and thus
P(B)      1,  corresponding     to  probability    1  that  the  fourth  coin  toss  is  heads.
       =                                           2
          2
Now
                                P(A     B)     1         P(A)       P(B),
                                            =  16     =          ·

where the first equality holds because A  B consists of only the one element
(H, H, H, H) and the second equality holds because                    P(A)        1  and    P(B)      1.
                                                                               =  8                =
                                                                                                      2
The equation above shows that A and B are independent events.
If we toss a fair coin many times, we expect that about half the time it will be
heads. Thus some people mistakenly believe that if the first three tosses of a fair
coin are heads, then the fourth toss should have a higher probability of being tails,
to balance out the previous heads. However, the coin cannot remember that it had
three  heads  in  a  row,  and  thus  the  fourth  coin  toss    has  probability    1  of  being  heads
                                                                                     2
regardless of the results of the three previous coin tosses. The independence of the
events A and B above captures the notion that the results of a fair coin toss do not
depend on previous results.

12.9 Example independent events: product probability space
   Suppose (1, F1, P1) and (2, F2, P2) are probability spaces. Then
                              (1 × 2, F1  F2, P1 × P2),

as defined in Chapter 5, is also a probability space.
   If A  F1 and B  F2, then (A × 2)  (1 × B) = A × B. Thus

(P1 × P2) (A × 2)  (1 × B) = (P1 × P2)(A × B)
                                           = P1(A) · P2(B)
                                           = (P1 × P2)(A × 2) · (P1 × P2)(1 × B),

where the second equality follows from the definition of the product measure, and
the third equality holds because of the definition of the product measure and because
P1 and P2 are probability measures.

   The equation above shows that the events A × 2 and 1 × B are independent
events in F1  F2.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                       Chapter 12 Probability Measures 385

Compare the next result to the Borel-Cantelli Lemma (12.6).

12.10 relative of Borel-Cantelli Lemma

Suppose (, F , P) is a probability space and {An}nZ+ is an independent family
of  events  such  that       P(An)     .  Then
                                    =
                        n=1

            P({   :   An for infinitely many n  Z+}) = 1.

Proof Let A = {   :   An for infinitely many n  Z+}. Then

                                       

12.11                        \ A =             ( \ An).

                                      m=1 n=m

If m, M  Z+ are such that m  M, then

                         M                    M
                        P ( \ An) =  P( \ An)
                        n=m               n=m

                                                M

                                          =  1 - P(An)

                                              n=m

12.12                                      e- nM=m P(An),

where the first line holds because the family { \ An}nZ+ is independent (see
Exercise 4) and the third line holds because 1 - t  e-t for all t  0.
Because           P(An)      ,  by  choosing  M  large  we  can  make     the  right  side  of
                         =
            n=1
12.12 as close to 0 as we wish. Thus

                                    

                             P ( \ An) = 0

                                 n=m

for all m  Z+. Now 12.11 implies that P( \ A) = 0. Thus we conclude that
P(A) = 1, as desired.

   For the rest of this chapter, assume that F = R. Thus, for example, if (, F , P) is
a probability space, then L1(P) will always refer to the vector space of real-valued
F -measurable functions on  such that | f | dP < .

12.13 Definition random variable; expectation; EX

Suppose (, F , P) is a probability space.
  · A random variable on (, F ) is a measurable function from  to R.
  · If X  L1(P), then the expectation (sometimes called the expected value)
     of the random variable X is denoted EX and is defined by

                                    EX =  X dP.

                  Measure, Integration & Real Analysis, by Sheldon Axler
386 Chapter 12 Probability Measures

   If F is clear from the context, the phrase "random variable on " can be used
instead of the more precise phrase "random variable on (, F )". If both  and F
are clear from the context, then the phrase "random variable" has no ambiguity and
is often used.

   Because P() = 1, the expectation EX of a random variable X  L1(P) can be
thought of as the average or mean value of X.

   The next definition illustrates a convention often used in probability theory: the
variable is often omitted when describing an event. Thus, for example, {X  U}
means {   : X()  U}, where U is a subset of R. Furthermore, probabilists
sometimes also omit the set brackets, as we do in the second bullet point of 12.15
when writing P(X = 3) instead of P({X = 3}).

  12.14 Definition independent random variables
  Suppose (, F , P) is a probability space.

    · Two random variables X and Y are called independent if {X  U} and
       {Y  V} are independent events for all Borel sets U, V in R.

    · More generally, a family of random variables {Xk}k is called independent
       if {Xk  Uk}k is independent for all families of Borel sets {Uk}k in R.

12.15 Example independent random variables

· Suppose (, F , P) is a probability space and A, B  F . Then 1A and 1B are
   independent random variables if and only if A and B are independent events, as
   you should verify.

· Suppose  = {H, T}4 is the sample space of four coin tosses, with F and P as
   in Example 12.8. Define random variables X and Y by

          X(1, 2, 3, 4) = number of 1, 2, 3 that equal H

and
              Y(1, 2, 3, 4) = number of 3, 4 that equal H.

Then  X  and  Y  are  not  independent   random  variables  because  P(X   =  3)  =  1
                                                                                     8
and  P(Y     0)     1  but  P({X     3}    {Y     0})     P()     0     1     1.
          =      =  4             =            =       =       =     =  8  ·
                                                                              4

· Suppose (1, F1, P1) and (2, F2, P2) are probability spaces, Z1 is a random
   variable on 1, and Z2 is a random variable on 2. Define random variables X
   and Y on 1 × 2 by

              X(1, 2) = Z1(1) and Y(1, 2) = Z2(2).

Then X and Y are independent random variables on 1 × 2 (with respect to
the probability measure P1 × P2), as you should verify.

   If X is a random variable and f : R  R is Borel measurable, then f  X is a
random variable (by 2.44). For example, if X is a random variable, then X2 and eX
are random variables. The next result states that compositions preserve independence.

             Measure, Integration & Real Analysis, by Sheldon Axler
               Chapter 12 Probability Measures 387

  12.16 functions of independent random variables are independent

  Suppose (, F , P) is a probability space, X and Y are independent random
  variables, and f , g : R  R are Borel measurable. Then f  X and g  Y are
  independent random variables.

Proof Suppose U, V are Borel subsets of R. Then
    P { f  X  U}  {g  Y  V} = P {X  f -1(U)}  {Y  g-1(V)}
                                            = P X  f -1(U) · P Y  g-1(V)
                                            = P( f  X  U) · P(g  Y  V),

where the second equality holds because X and Y are independent random variables.
The equation above shows that f  X and g  Y are independent random variables.

   If X, Y  L1(P), then clearly E(X + Y) = E(X) + E(Y). The next result gives
a nice formula for the expectation of XY when X and Y are independent. This
formula has sometimes been called the dream equation of calculus students.

12.17 expectation of product of independent random variables

Suppose (, F , P) is a probability space and X and Y are independent random
variables in L2(P). Then

                                  E(XY) = EX · EY.

Proof First consider the case where X and Y are each simple functions, taking
on only finitely many values. Thus there are distinct numbers a1, . . . , aM  R and
distinct numbers b1, . . . , bN  R such that

X = a11{X=a1} + · · · + aM1{X=aM} and Y = b11{Y=b1} + · · · + bN1{Y=bN}.
Now

      MN                      MN
      XY =   ajbk1{X=aj}1{Y=bk} =   ajbk1{X=aj}{Y=bk}.
      j=1 k=1                 j=1 k=1

Thus

                        MN

      E(XY) =   ajbkP {X = aj}  {Y = bk}

                      j=1 k=1

                       M       N

               =  ajP X = aj   bkP Y = bk

                     j=1      k=1

                            = EX · EY,
where the second equality above comes from the independence of X and Y. The last
equation gives the desired conclusion in the case where X and Y are simple functions.

      Measure, Integration & Real Analysis, by Sheldon Axler
388 Chapter 12 Probability Measures

   Now consider arbitrary independent random variables X and Y in L2(P). Let
f1, f2, . . . be a sequence of Borel measurable simple functions from R to R that
approximate the identity function on R (the function t  t) in the sense that
limn fn(t) = t for every t  R and | fn(t)|  |t| for all t  R and all n  Z+
(see 2.89, taking f to be the identity function, for construction of this sequence). The
random variables fn  X and fn  Y are independent (by 12.16). Thus the result in
the first paragraph of this proof shows that

                     E ( fn  X)( fn  Y) = E( fn  X) · E( fn  Y)
for each n  Z+. The limit as n   of the right side of the equation above equals
EX · EY [by the Dominated Convergence Theorem (3.31)]. The limit as n  
of the left side of the equation above equals E(XY) [use Hölder's inequality (7.9)].
Thus the equation above implies that E(XY) = EX · EY.

Variance and Standard Deviation

The variance and standard deviation of a random variable, defined below, measure
how much a random variable differs from its expectation.

12.18 Definition variance; standard deviation; (X)

Suppose (, F , P) is a probability space and X  L2(P) is a random variable.
  · The variance of X is defined to be E (X - EX)2 .
  · The standard deviation of X is denoted (X) and is defined by

(X) = E (X - EX)2 .

In other words, the standard deviation of X is the square root of the variance
of X.

The notation 2(X) means  (X)  2  Thus 2(X) is the variance of X.

                              .

12.19 Example variance and standard deviation of an indicator function
   Suppose (, F , P) is a probability space and A  F is an event. Then
                      2(1A) = E (1A - E1A)2
                               = E (1A - P(A))2
                               = E 1A - 2P(A) · 1A + P(A) 2
                               = P(A) - 2 P(A) 2 + P(A) 2
                               = P(A) · 1 - P(A) .

Thus (1A) = P(A) · 1 - P(A) .

Measure, Integration & Real Analysis, by Sheldon Axler
                              Chapter 12 Probability Measures 389

   The next result gives a formula for the variance of a random variable. This formula
is often more convenient to use than the formula that defines the variance.

12.20 variance formula
Suppose (, F , P) is a probability space and X  L2(P) is a random variable.
Then

                              2(X) = E(X2) - (EX)2.

Proof We have   2(X) = E (X - EX)2
as desired.             = E X2 - 2(EX)X + (EX)2
                        = E(X2) - 2(EX)2 + (EX)2
                        = E(X2) - (EX)2,

Our next result is called Chebyshev's inequality. It states, for example (take t = 2
below) that the probability that a random variable X differs from its average by more
than twice its standard deviation is at most  1.  Note that P  |X - EX|   t(X)  is

                                              4
shorthand for P {   : |X() - EX|  t(X)} .

12.21 Chebyshev's inequality

Suppose (, F , P) is a probability space and X  L2(P) is a random variable
with (X) > 0. Then

                P |X - EX|  t(X)  t21

for all t > 0.

Proof  Suppose t > 0. Then
              P |X - EX|  t(X) = P |X - EX|2  t22(X)

                               t221(X) E (X - EX)2

                                             = t21 ,
where the second line above comes from applying Markov's inequality (4.1) with
h = |X - EX|2 and c = t22(X).

   The next result gives a beautiful formula for the variance of the sum of independent
random variables.

                     Measure, Integration & Real Analysis, by Sheldon Axler
390 Chapter 12 Probability Measures

12.22 variance of sum of independent random variables

Suppose (, F , P) is a probability space and X1, . . . , Xn  L2(P) are indepen-
dent random variables. Then

                 2(X1 + · · · + Xn) = 2(X1) + · · · + 2(Xn).

Proof Using the variance formula given by 12.20, we have

2n              n2        n             2
  Xk = E  Xk - E  Xk
k=1           k=1         k=1

     n                               n     2
=E  Xk2 + 2E  XjXk -  EXk
    k=1            1j<kn             k=1

n          n
=  E(Xk2) -  (EXk)2 + 2  E(XjXk) - 2  EXj · EXk
k=1        k=1            1j<kn                           1j<kn

     n

=  2(Xk),

   k=1

where the last equality uses 12.20, 12.17, and the hypothesis that X1, . . . , Xn are
independent random variables.

Conditional Probability and Bayes' Theorem

The conditional probability PB(A) that we are about to define should be interpreted
to mean the probability that  will be in A given that   B. Because  is in A  B
if and only if   B and   A, and because we expect probabilities to multiply, it
is reasonable to expect that

                                P(B) · PB(A) = P(A  B).
Thus we are led to the following definition.

  12.23 Definition conditional probability; PB
  Suppose (, F , P) is a probability space and B is an event with P(B) > 0.
  Define PB : F  [0, 1] by

                                    PB(A) = P(A  B) P(B) .
  If A  F , then PB(A) is called the conditional probability of A given B.

   You should verify that with B as above, PB is a probability measure on (, F ). If
A  F , then PB(A) = P(A) if and only if A and B are independent events.

   We now present two versions of what is called Bayes' Theorem. You should
do a web search and read about the many uses of these results, including some
controversial applications.

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                     Chapter 12 Probability Measures 391

12.24 Bayes' Theorem, first version

Suppose (, F , P) is a probability space and A, B are events with positive
probability. Then

                               PB(A) = PA(B) · P(A) P(B) .

Proof  We have
          PB(A) = P(A  B) P(B) = P(A  B) · P(A) P(A) · P(B) = PA(B) · P(A) P(B) .

                                                    Plaque honoring Thomas
                                                    Bayes in Tunbridge Wells,
                                                    England.

                                                    CC-BY-SA Alexander Dreyer

12.25 Bayes' Theorem, second version

Suppose (, F , P) is a probability space, B is an event with positive probability,
and A1, . . . , An are pairwise disjoint events, each with positive probability, such
that A1  · · ·  An = . Then

            PB(Ak) =               PAk (B) · P(Ak)

                                   n
                             j=1 PAj (B) · P(Aj)

for each k  {1, . . . , n}.

Proof  Consider the denominator of the expression above. We have
12.26
       n                             n
        PAj (B) · P(Aj) =  P(Aj  B) = P(B).
       j=1                           j=1

Now suppose k  {1, . . . , n}. Then

       PB(Ak) = PAk (B) · P(Ak) = nPAk (B) · P(Ak) ,
                             P(B)         j=1 PAj (B) · P(Aj)

where the first equality comes from the first version of Bayes's Theorem (12.24) and
the second equality comes from 12.26.

       Measure, Integration & Real Analysis, by Sheldon Axler
392 Chapter 12 Probability Measures

Distribution and Density Functions of Random Variables

For the rest of this chapter, let B denote the -algebra of Borel subsets of R.
   Each random variable X determines a probability measure PX on (R, B) and a

function X : R  [0, 1] as in the next definition.

12.27 Definition probability distribution; PX; distribution function; X
Suppose (, F , P) is a probability space and X is a random variable.

  · The probability distribution of X is the probability measure PX defined on
     (R, B) by
                           PX(B) = P(X  B) = P X-1(B) .

  · The distribution function of X is the function X : R  [0, 1] defined by
                           X(s) = PX (-, s] = P(X  s).

   You should verify that the probability distribution PX as defined above is indeed
a probability measure on (R, B). Note that the distribution function X depends on
the probability measure P as well as the random variable X, even though P is not
included in the notation X (because P is usually clear from the context).

12.28 Example probability distribution and distribution function of an indicator function
   Suppose (, F , P) is a probability space and A  F is an event. Then you should

verify that
                             P1A = 1 - P(A) 0 + P(A)1,

where for t  R the measure t on (R, B) is defined by

                                  t(B) = 1 if t  B, 0 if t / B.

The distribution function of 1A is the function 1A : R  [0, 1] given by

                                     if s < 0,
           0                         if 0  s < 1,
1A(s) = 1 - P(A) 1                   if s  1,

as you should verify.
   One direction of the next result states that every distribution function is a right-

continuous increasing function, with limit 0 at - and limit 1 at . The other
direction of the next result states that every function with those properties is the
distribution function of some random variable on some probability space. The proof
shows that we can take the sample space to be (0, 1), the -algebra to be the Borel
subsets of (0, 1), and the probability measure to be Lebesgue measure on (0, 1).

Measure, Integration & Real Analysis, by Sheldon Axler
             Chapter 12 Probability Measures 393

   Your understanding of the proof of the next result should be enhanced by Exercise
13, which asserts that if the function H : R  (0, 1) appearing in the next result is
continuous and injective, then the random variable X : (0, 1)  R in the proof is the
inverse function of H.

12.29 characterization of distribution functions

Suppose H : R  [0, 1] is a function. Then there exists a probability space
(, F , P) and a random variable X on (, F ) such that H = X if and only if
the following conditions are all satisfied.

(a) s < t  H(s)  H(t) (in other words, H is an increasing function).
(b) lim H(t) = 0.

       t-

(c) lim H(t) = 1.

       t

(d) lim H(t) = H(s) for every s  R (in other words, H is right continuous).

       ts

Proof First suppose H = X for some probability space (, F , P) and some random
variable X on (, F ). Then (a) holds because s < t implies (-, s]  (-, t].
Also, (b) and (d) follow from 2.60. Furthermore, (c) follows from 2.59, completing
the proof in this direction.

   To prove the other direction, now suppose that H satisfies (a) through (d). Let
 = (0, 1), let F be the collection of Borel subsets of the interval (0, 1), and let P
be Lebesgue measure on F . Define a random variable X by

12.30        X() = sup{t  R : H(t) < }

for   (0, 1). Clearly X is an increasing function and thus is measurable (in other
words, X is indeed a random variable).

   Suppose s  R. If   0, H(s) , then

             X()  X H(s) = sup{t  R : H(t) < H(s)}  s,

where the first inequality holds because X is an increasing function and the last
inequality holds because H is an increasing function. Hence

12.31        0, H(s)  {X  s}.

If   (0, 1) and X()  s, then H(t)   for all t > s (by 12.30). Thus

                                  H(s) = lim H(t)  ,

                                                            ts

where the equality above comes from (d). Rewriting the inequality above, we have
  0, H(s) . Thus we have shown that {X  s}  0, H(s) , which when
combined with 12.31 shows that {X  s} = 0, H(s) . Hence

             X(s) = P(X  s) = P 0, H(s) = H(s),

as desired.

             Measure, Integration & Real Analysis, by Sheldon Axler
394 Chapter 12 Probability Measures

   In the definition below and in the following discussion,  denotes Lebesgue
measure on R, as usual.

12.32 Definition density function

Suppose X is a random variable on some probability space.            If there exists
h  L1(R) such that

                                                                  s

                                   X(s) = - h d
for all s  R, then h is called the density function of X.

   If there is a density function of a random variable X, then it is unique [up to
changes on sets of Lebesgue measure 0, which is already taken into account because
we are thinking of density functions as elements of L1(R) instead of elements of
L1(R)]; see Exercise 6 in Section 4B.

   If X is a random variable that has a density function h, then the distribution
function X is differentiable almost everywhere (with respect to Lebesgue measure)
and X(s) = h(s) for almost every s  R (by the second version of the Lebesgue
Differentiation Theorem; see 4.19). Because X is an increasing function, this implies
that h(s)  0 for almost every s  R. In other words, we can assume that a density
function is nonnegative.

   In the definition above of a density function, we started with a probability space
and a random variable on it. Often in probability theory, the procedure goes in the
other direction. Specifically, we can start with a nonnegative function h  L1(R)

                 

such that - h d = 1. We use h to define a probability measure on (R, B) and then
consider the identity random variable X on R. The function h that we started with is
then the density function of X. The following result formalizes this procedure and
gives formulas for the mean and standard deviation in terms of the density function h.

12.33 mean and variance of random variable generated by density function

Suppose h  L1(R) is such that  

                               - h d = 1 and h(x)  0 for almost every
x  R. Let P be the probability measure on (R, B) defined by

                      P(B) = h d.

                                      B

Let X be the random variable on (R, B) defined by X(x) = x for each x  R.
Then h is the density function of X. Furthermore, if X  L1(P) then

                                    

                      EX = - xh(x) d(x),

and if X  L2(P) then

2(X) =  x2h(x) d(x) -                                                2
                                           xh(x) d(x) .
                 -                   -

Measure, Integration & Real Analysis, by Sheldon Axler
                                       Chapter 12 Probability Measures 395

Proof The equation X(s) = -s  h d holds by the definitions of X and P. Thus h
is the density function of X.
                                                                          
Our definition of P to equal h d implies that - f dP = - f h d for all
f  L1(P) [see Exercise 5 in Section 9A]. Thus the formula for the mean EX
follows immediately from the definition of EX, and the formula for the variance
2(X) follows from 12.20.

   The following example illustrates the result above with a few especially useful
choices of the density function h.

12.34 Example density functions

· Suppose h = 1[0,1]. This density function h is called the uniform density on
   [0, 1]. In this case, P(B) = (B  [0, 1]) for each Borel set B  R. For the
   corresponding random variable X(x) = x for x  R, the distribution function
   X is given by the formula

                                              if s  0,
                                         0    if 0 < s < 1,
                               X(s) = s1      if s  1.

The formulas in 12.33 show that EX = 12 and (X) = 21 3 .

· Suppose  > 0 and

                               h(x) =    0       if x < 0,
                                         e-x     if x  0.

This density function h is called the exponential density on [0, ). For the
corresponding random variable X(x) = x for x  R, the distribution function
X is given by the formula

                               X(s) =  0              if s < 0,
                                       1 - e-s        if s  0.

The  formulas  in  12.33  show  that   EX  =  1  and  (X)      =  1.
                                              
                                                                  

· Suppose                                   1 -x2/2
                                h(x) =  e

                                             2

for x  R. This density function is called the standard normal density. For
the  corresponding  random     variable  X(x)       x  for  x     R,  we  have  X(0)     1.
                                                 =                                    =
                                                                                         2
For general s  R, no formula exists for X(s) in terms of elementary functions.
However, the formulas in 12.33 show that EX = 0 and (with the help of some
calculus) (X) = 1.

           Measure, Integration & Real Analysis, by Sheldon Axler
396 Chapter 12 Probability Measures

Weak Law of Large Numbers

Families of random variables all of which look the same in terms of their distribution
functions get a special name, as we see in the next definition.

  12.35 Definition identically distributed; i.i.d.
  Suppose (, F , P) is a probability space.

    · A family of random variables on (, F ) is called identically distributed if
       all the random variables in the family have the same distribution function.

    · More specifically, a family {Xk}k of random variables on (, F ) is called
       identically distributed if
                                    P Xj  s = P Xk  s
       for all j, k   and all s  R.

    · A family of random variables that is independent and identically distributed
       is said to be independent identically distributed, often abbreviated as i.i.d.

12.36 Example family of random variables for decimal digits is i.i.d.
   Consider the probability space ([0, 1], B, P), where B is the collection of Borel

subsets of the interval [0, 1] and P is Lebesgue measure on ([0, 1], B). For k  Z+,
define a random variable Xk : [0, 1]  R by

                     Xk() = kth-digit in decimal expansion of ,
where for those numbers  that have two different decimal expansions we use the
one that does not end in an infinite string of 9s.

   Notice that P Xk   = 0.4 for every k  Z+. More generally, the family
{Xk}kZ+ is identically distributed, as you should verify.

   The family {Xk}kZ+ is also independent, as you should verify. Thus {Xk}kZ+
is an i.i.d. family of random variables.

   Identically distributed random variables have the same expectation and the same
standard deviation, as the next result shows.

  12.37 identically distributed random variables have same mean and variance
  Suppose (, F , P) is a probability space and {Xk}k is an identically dis-
  tributed family of random variables in L2(P). Then

                           EXj = EXk and (Xj) = (Xk)
  for all j, k  .

                     Measure, Integration & Real Analysis, by Sheldon Axler
                                                 Chapter 12 Probability Measures 397

Proof Suppose j  Z+. Let f1, f2, . . . be the sequence of simple functions converg-
ing pointwise to Xj as constructed in the proof of 2.89. The Dominated Convergence
Theorem (3.31) implies that EXj = limn E fn. Because of how each fn is con-
structed, each E fn depends only on n and the numbers P c  Xj < d for c < d.
However,

              P c  Xj < d         = lim     P  Xj       d  -  1  -P     Xj       c  -  1
                                  m                           m                        m

for c < d. Because {Xk}k is an identically distributed family, the numbers above
on the right are independent of j. Thus EXj = EXk for all j, k  Z+.

   Apply the result from the paragraph above to the identically distributed family
{Xk2}k and use 12.20 to conclude that (Xj) = (Xk) for all j, k  .

   The next result has the nicely intuitive interpretation that if we repeat a random
process many times, then the probability that the average of our results differs from
our expected average by more than any fixed positive number  has limit 0 as we
increase the number of repetitions of the process.

12.38 Weak Law of Large Numbers

Suppose (, F , P) is a probability space and {Xk}kZ+ is an i.i.d. family of
random variables in L2(P), each with expectation µ. Then

                                            n
                         lim P           1       Xk              =0
                                         n           -µ 
                         n
                                            k=1

for all  > 0.

Proof Because the random variables {Xk}kZ+ all have the same expectation and
same standard deviation, by 12.37 there exist µ  R and s  [0, ) such that

                                  EXk = µ and (Xk) = s

for all k  Z+. Thus

                  1n                           21n               1 2 n s2
12.39         E  Xk = µ and   Xk = 2   Xk = ,
                  n k=1                            n k=1         n                        n
                                                                                 k=1

where the last equality follows from 12.22 (this is where we use the independent part
of the hypothesis).
Now suppose  > 0. In the special case where s = 0, all the Xk are almost surely
equal to the same constant function and the desired result clearly holds. Thus we
assume s > 0. Let t = n/s and apply Chebyshev's inequality (12.21) with this
value  of  t  to  the  random  variable  1     n   Xk,  using    12.39  to  get
                                         n
                                            k=1

                                  1n                             s2
                               P   Xk - µ    2 .
                                  n k=1                          n

Taking the limit as n   of both sides of the inequality above gives the desired
result.

                       Measure, Integration & Real Analysis, by Sheldon Axler
398 Chapter 12 Probability Measures

EXERCISES 12

1 Suppose (, F , P) is a probability space and A  F . Prove that A and  \ A
    are independent if and only if P(A) = 0 or P(A) = 1.

2 Suppose P is Lebesgue measure on [0, 1]. Give an example of two disjoint
Borel  subsets  A  and  B     of  [0, 1]  such  that  P(A)     P(B)      1,  [0,  1]  and  A  are
                                                            =        =
                                                                         2        2
independent,  and  [0,  1     and  B  are  independent.
                        2  ]

3 Suppose (, F , P) is a probability space and A, B  F . Prove that the follow-
    ing are equivalent.

· A and B are independent events.
· A and  \ B are independent events.
·  \ A and B are independent events.
·  \ A and  \ B are independent events.

4 Suppose (, F , P) is a probability space and {Ak}k is a family of events.
    Prove the family {Ak}k is independent if and only if the family { \ Ak}k
    is independent.

5 Give an example of a probability space (, F , P) and events A, B1, B2 such
    that A and B1 are independent, A and B2 are independent, but A and B1  B2
    are not independent.

6 Give an example of a probability space (, F , P) and events A1, A2, A3 such
    that A1 and A2 are independent, A1 and A3 are independent, and A2 and A3
    are independent, but the family A1, A2, A3 is not independent.

7 Suppose (, F , P) is a probability space, A  F , and B1  B2  · · · is an
increasing sequence of events such that A and Bn are independent events for
each n  Z+. Show that A and                     Bn    are  independent.
                                           n=1

8 Suppose (, F , P) is a probability space and {At}tR is an independent family
of events such that P(At) < 1 for each t  R. Prove that there exists a sequence
t1, t2, . . . in R such that P                  = 0.

                                   n=1 Atn

9 Suppose (, F , P) is a probability space and B1, . . . , Bn  F are such that
    P(B1  · · ·  Bn) > 0. Prove that

P(A  B1  · · ·  Bn) = P(B1) · PB1 (B2) · · · PB1···Bn-1 (Bn) · PB1···Bn (A)
for every event A  F .

10 Suppose (, F , P) is a probability space and A  F is an event such that
      0 < P(A) < 1. Prove that

                P(B) = PA(B) · P(A) + P\A(B) · P( \ A)

for every event B  F .

       Measure, Integration & Real Analysis, by Sheldon Axler
                                   Chapter 12 Probability Measures 399

11 Give an example of a probability space (, F , P) and X, Y  L2(P) such
      that 2(X + Y) = 2(X) + 2(Y) but X and Y are not independent random
      variables.

12 Suppose (, F , P) and (, F , P) are probability spaces, X is a random

variable  on  ,  Y  is  a  random  variable  on  ,  and  X  =  Y.  Prove  that  PX  =  P .

                                                                                         Y

13 Suppose H : R  (0, 1) is a continuous one-to-one function satisfying condi-
      tions (a) through (d) of 12.29. Show that the function X : (0, 1)  R produced
      in the proof of 12.29 is the inverse function of H.

14 Suppose (, F , P) is a probability space and X is a random variable. Prove
      that the following are equivalent.

· X is a continuous function on R.
· X is a uniformly continuous function on R.
· P(X = t) = 0 for every t  R.

· (X  X) (s) = s for all s  [0, 1].

15 Suppose  > 0 and h(x) = 2xe-x 0 if x < 0, if x  0.
      Let P = h d and let X be the random variable defined by X(x) = x for x  R.

                                    

      (a) Verify that - h d = 1.
      (b) Find a formula for the distribution function X.
      (c) Find a formula (in terms of ) for EX.
      (d) Find a formula (in terms of ) for (X).

16 Suppose B is the -algebra of Borel subsets of [0, 1) and P is Lebesgue measure
      on [0, 1), B . Let {ek}kZ+ be the family of functions defined by the fourth
      bullet point of Example 8.51 (notice that k = 0 is excluded). Show that the
      family {ek}kZ+ is an i.i.d.

17 Suppose B is the -algebra of Borel subsets of (-, ] and P is Lebesgue
      measure on (-, ], B divided by 2. Let {ek}kZ\{0} be the family of
      trigonometric functions defined by the third bullet point of Example 8.51 (notice
      that k = 0 is excluded).

      (a) Show that {ek}kZ\{0} is not an independent family of random variables.
      (b) Show that {ek}kZ\{0} is an identically distributed family.

              Measure, Integration & Real Analysis, by Sheldon Axler
          Photo Credits

· page vi: photos by Carrie Heeter and Sheldon Axler
· page 1: digital sculpture created by Doris Fiebig; all rights reserved
· page 13: photo by Petar Milosevic´; Creative Commons Attribution-Share Alike

   4.0 International license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Mausoleum_of_Galla_Placidia_ceiling_mosaics.jpg
· page 19: photo by Fagairolles 34; Creative Commons Attribution-Share Alike
   4.0 International license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Saint-Affrique_pont.JPG
· page 44: photo by Sheldon Axler
· page 51: photo by James Mitchell; Creative Commons Attribution-Share Alike
   2.0 Generic license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Beauvais_Cathedral_SE_exterior.jpg
· page 68: photo by A. Savin; Creative Commons Attribution-Share Alike 3.0
   Unported license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Moscow_05-2012_Mokhovaya_05.jpg
· page 73: photo by Giovanni Dall'Orto; permission to use verified on 11 July
   2019 at https://en.wikipedia.org/wiki/Maria_Gaetana_Agnesi
· page 101: photo by Rafa Esteve; Creative Commons Attribution-Share Alike 4.0
   International license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Trinity_College_-_Great_Court_02.jpg
· page 102: photo by A. Savin; Creative Commons Attribution-Share Alike 3.0
   Unported license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Spb_06-2012_University_Embankment_01.jpg
· page 116: photo by Lucarelli; Creative Commons Attribution-Share Alike 3.0
   Unported license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Palazzo_Carovana_Pisa.jpg
· page 146: photo by Petar Milosevic´; Creative Commons Attribution-Share Alike
   3.0 Unported license; verified on 9 July 2019 at https://
   en.wikipedia.org/wiki/Lviv
· page 152: photo by NonOmnisMoriar; Creative Commons Attribution-Share
   Alike 3.0 Unported license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Ecole_polytechnique_former_building_entrance.jpg

                                                                                                         400
                   Measure, Integration & Real Analysis, by Sheldon Axler
                                                                                Photo Credits 401

· page 193: photo by Roland zh; Creative Commons Attribution-Share Alike 3.0
   Unported license; verified on 9 July 2019 at https://

   commons.wikimedia.org/wiki/File:ETH_Zürich_-_Polyterasse_2011-04-11_19-03-06_ShiftN.jpg

· page 211: photo by Daniel Schwen; Creative Commons Attribution-Share Alike
   2.5 Generic license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Mathematik_Göttingen.jpg

· page 255: photo by Hubertl; Creative Commons Attribution-Share Alike 4.0
   International license; verified on 11 July 2019 at https://
   en.wikipedia.org/wiki/University_of_Vienna

· page 280: copyright Per Enström; Creative Commons Attribution-Share Alike
   4.0 International license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Botaniska_trädgården,_Uppsala_II.jpg

· page 339: photo by Ricardo Liberato, Creative Commons Attribution-Share
   Alike 2.0 Generic license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:All_Gizah_Pyramids.jpg

· page 380: photo by Alexander Dreyer, Creative Commons Attribution-Share
   Alike 3.0 Unported license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Dices6-5.png

· page 391: photo by Simon Harriyott, Creative Commons Attribution 2.0
   Generic license; verified on 9 July 2019 at https://
   commons.wikimedia.org/wiki/File:Bayes_tab.jpg

                   Measure, Integration & Real Analysis, by Sheldon Axler
            Bibliography

The chapters of this book on linear operators on Hilbert spaces, Fourier analysis, and
probability only introduce these huge subjects, all of which have a vast literature.
This bibliography gives book recommendations for readers who want to go into these
topics in more depth.

  · Sheldon Axler, Linear Algebra Done Right, third edition, Springer, 2015.
  · Leo Breiman, Probability, Society for Industrial and Applied Mathematics,

     1992.
  · John B. Conway, A Course in Functional Analysis, second edition, Springer,

     1990.
  · Ronald G. Douglas, Banach Algebra Techniques in Operator Theory, second

     edition, Springer, 1998.
  · Rick Durrett, Probability: Theory and Examples, fifth edition, Cambridge

     University Press, 2019.
  · Paul R. Halmos, A Hilbert Space Problem Book, second edition, Springer,

     1982.
  · Yitzhak Katznelson, An Introduction to Harmonic Analysis, second edition,

     Dover, 1976.
  · T. W. Körner, Fourier Analysis, Cambridge University Press, 1988.
  · Michael Reed and Barry Simon, Functional Analysis, Academic Press, 1980.
  · Walter Rudin, Functional Analysis, second edition, McGraw-Hill, 1991.
  · Barry Simon, A Comprehensive Course in Analysis, American Mathematical

     Society, 2015.
  · Elias M. Stein and Rami Shakarchi, Fourier Analysis, Princeton University

     Press, 2003.

                                                                                                            402
                     Measure, Integration & Real Analysis, by Sheldon Axler
                   Notation Index

\, 19                  d, 260
1A, 382                d , 274
3  I, 103
                       dµ
|A|, 14
                       E, 149
  b                    [E]a, 118
                       [E]b, 118
 a f , 5, 95
                        E f dµ, 88
  b                    EX, 385

 a f (x) dx, 6
a + bi, 155

B, 51                  F, 159
B( f , r), 148
B( f , r), 148         F , 376
Bn, 137
Bn, 141                 f , 163, 214
B(V), 286              f , 202, 350
B(V, W), 167           f +, 81
B(x, ), 136            f -, 81
                        f 1, 95, 97
C, 56                  f -1(A), 29
                       [ f ]a, 119
                       [ f ]b, 119

C, 155                  f , g, 212

c0, 177, 209           f (n), 342

E , 31                 f (t), 363
Cn, 160
C(V), 312              fI, 115
                       f [k], 350

D, 253, 340               f dµ, 74, 81, 156
D, 340                 Fn, 160
d, 75
D1 f , D2 f , 142       f p, 194
, 348                   f p, 203
dim, 321                f , 194
                       FX, 160

distance( f , U), 224  g, 110                                         403

              Measure, Integration & Real Analysis, by Sheldon Axler
404 Notation Index

     gk,   166        ||, 259
                      , 263
k=1                   a, 271
                      null T, 172
graph(T), 179         -, 269
                        µ, 270
g(x) dµ(x), 125         µ, 268
                      +, 269
H, 370                s, 271
h dµ, 258
h, 104                p, 196
                      PB, 390
I, 231                Pr, 346
IK, 282               Pr, 345
Im z, 155             p(T), 297
inf, 2                PU, 227
                      PX, 392
 A                    Py, 370
                      Py, 371
K, 282
k fk, 239             Q, 15

, 63                  R, 2
                      Re z, 155
n, 139                Rn, 136
, 58
1, 96                 , 341
2(), 237              (X), 388
, 177, 195            sn(T), 333
p, 195                span{ek}k, 174
                      sp(T), 294
(I), 14               S  T , 117
                      sup, 2
L( f , P), 74
L1(µ), 95               A
L1(R), 97, 164
Lp(E), 198            T, 167
Lp(µ), 194            T, 281
                      T-1, 287
L( f , [a, b]), 4     t + A, 16

L( f , P, [a, b]), 2
Lp(D), 341
Lp(E), 203
Lp(µ), 202

MF(S ), 262
Mh, 281
µ × , 127

           Measure, Integration & Real Analysis, by Sheldon Axler
                               Notation Index 405

tA, 23
TC, 309
Tk, 288

U, 229
Uf , 133
U( f , [a, b]), 4
U( f , P, [a, b]), 2

V, 180
V, 183
V, 286
VC, 234

X, 392
(x1, . . . , xn), 136

 X Y f (x, y) d(y) dµ(x), 126

Z, 5
|z|, 155
z, 158
Z (µ), 202
Z+, 5

Measure, Integration & Real Analysis, by Sheldon Axler
Index

Abel summation, 344                               Bergman space, 253
absolute value, 155                               Bessel's inequality, 241
absolutely continuous, 270                        Bessel, Friedrich, 242
additivity of outer measure, 47-48, 50,           Borel measurable function, 33
                                                  Borel set, 28, 36, 137, 252
        60                                        Borel, Émile, 19
adjoint of a linear map, 281                      Borel-Cantelli Lemma, 383
a. e., 90                                         bounded, 136
Agnesi, Maria Gaetana, 73
algebra, 120                                            linear functional, 173
algebraic multiplicity, 324                             linear map, 167
almost every, 90                                  bounded below, 192
almost surely, 382                                Bounded Convergence Theorem, 89
Apollonius's identity, 223                        Bounded Inverse Theorem, 188
approximate eigenvalue, 310                       Bunyakovsky, Viktor, 219
approximate identity, 346
approximation of Borel set, 48, 52                Cantor function, 58
approximation of function                         Cantor set, 56, 278
                                                  Carleson, Lennart, 352
      by continuous functions, 98                 Cauchy sequence, 151, 165
      by dilations, 100                           Cauchy, Augustin-Louis, 152
      by simple functions, 96                     Cauchy-Schwarz inequality, 218
      by step functions, 97                       chain, 176
      by translations, 100                        characteristic function, 31
area paradox, 24                                  Chebyshev's inequality, 106, 389
area under graph, 134                             Chebyshev, Pafnuty, 106
average, 386                                      Clarkson's inequalities, 209
Axiom of Choice, 22-23, 176, 183,                 Clarkson, James, 209
                                                  closed, 136
        236
                                                        ball, 148
bad Borel set, 113                                      half-space, 235
Baire Category Theorem, 184                             set, 149
Baire's Theorem, 184-185                          Closed Graph Theorem, 189
Baire, René-Louis, 184                            closure, 149
Banach space, 165                                 compact operator, 312
Banach, Stefan, 146                               complete metric space, 151
Banach-Steinhaus Theorem, 189, 192                complex conjugate, 158
basis, 174                                        complex inner product space, 212
Bayes' Theorem, 391                               complex measure, 256
Bayes, Thomas, 391                                complex number, 155
Bengal, vi
                                                                                                406
                 Measure, Integration & Real  Analysis, by Sheldon Axler
                                                        Index 407

complexification, 234, 309                   exponent, 196
conditional probability, 390                of p, 207
conjugate symmetry, 212                     of Lp(µ), 275
conjugate transpose, 283                     space, 180
continuous function, 150               École Polytechnique, Paris, 152, 371
continuous linear map, 169             Egorov's Theorem, 63
continuously differentiable, 350       Egorov, Dmitri, 63, 68
convex set, 225                        Eiffel Tower, 373
convolution on D, 357                  eigenvalue, 294
convolution on R, 368                  eigenvector, 294
countable additivity, 25               Einstein, Albert, 193
countable subadditivity, 17, 43        essential supremum, 194
countably additive, 256                ETH Zürich, 193
counting measure, 41                   Euler, Leonhard, 155, 356
Courant, Richard, 211                  event, 381
cross section                          expectation, 385
                                       exponential density, 395
      of function, 119                 Extension Lemma, 178
      of rectangle, 118                family, 174
      of set, 118                      Fatou's Lemma, 86
                                       Fermat, Pierre de, 380
Darboux, Gaston, 6                     finite measure, 123
Dedekind, Richard, 211                 finite subadditivity, 17
dense, 184                             finite subcover, 18
density function, 394                  finite-dimensional, 174
density of a set, 112                  Fourier coefficient, 342
derivative, 110                        Fourier Inversion Formula, 374
differentiable, 110                    Fourier series, 342
dilation, 60, 140                      Fourier transform
Dini's Theorem, 71                          on L1(R), 363
Dirac measure, 84                           on L2(R), 376
Dirichlet kernel, 353                  Fourier, Joseph, 339, 371, 373
Dirichlet problem, 348                 Fredholm Alternative, 319
                                       Fredholm, Erik, 280
      on half-plane, 372               Fubini's Theorem, 132
      on unit disk, 349                Fubini, Guido, 116
Dirichlet space, 254                   Fundamental Theorem of Calculus,
Dirichlet, Gustav Lejeune, 211
discontinuous linear functional, 177           110
distance                               Gauss, Carl Friedrich, 211
      from point to set, 224           geometric multiplicity, 318
      to closed convex set in Hilbert  Giza pyramids, 339
                                       Gödel, Kurt, 179
        space, 226                     Gram, Jørgen, 247
      to closed subspace of Banach     Gram-Schmidt process, 246
                                       graph, 135, 179
        space not attained, 225
distribution function, 392
Dominated Convergence Theorem, 92
dual

      double, 183

Measure, Integration & Real Analysis, by Sheldon Axler
408 Index

Hahn Decomposition Theorem, 267          invariant subspace, 327
Hahn, Hans, 179                          inverse image, 29
Hahn-Banach Theorem, 179, 236            invertible, 287
Hamel basis, 175                         isometry, 305
Hardy, Godfrey H., 101                   iterated integral, 126, 129
Hardy-Littlewood maximal function,       Jordan Decomposition Theorem, 269
                                         Jordan, Camille, 269
        104                              jump discontinuity, 352
Hardy-Littlewood maximal inequality,     kernel, 172
                                         Kolmogorov, Andrey, 352
        105                              L1-norm, 95
      best constant, 107                 Laplacian, 348
harmonic function, 348                   Lebesgue Decomposition Theorem,
Heine, Eduard, 19
Heine-Borel Theorem, 19                          271
Hilbert space, 224                       Lebesgue Density Theorem, 113
Hilbert, David, 211                      Lebesgue Differentiation Theorem,
Hölder, Otto, 197
Hölder's inequality, 196                         108, 111, 112
                                         Lebesgue measurable function, 69
i.i.d., 396                              Lebesgue measurable set, 52
identically distributed, 396             Lebesgue measure
identity map, 231
imaginary part, 155                            on R, 51, 55
increasing function, 34                        on Rn, 139
independent events, 383                  Lebesgue space, 95, 194
independent random variables, 386        Lebesgue, Henri, 40, 87
indicator function, 382                  left invertible, 289
infinite sum in normed vector space,     left shift, 289, 294
                                         length of open interval, 14
        166                              lim inf, 86
infinite-dimensional, 174                limit, 149, 165
inner measure, 61                        linear functional, 172
inner product, 212                       linear map, 167
inner product space, 212                 linearly independent, 174
integral                                 Littlewood, John, 101
                                         lower Lebesgue sum, 74
      iterated, 126                      lower Riemann integral, 4, 85
      of characteristic function, 75     lower Riemann sum, 2
      of complex-valued function, 156    Luzin's Theorem, 66, 68
      of linear combination of charac-   Luzin, Nikolai, 66, 68
                                         Lviv, 146
        teristic functions, 80           Lwów, 146
      of nonnegative function, 74        Markov's inequality, 102
      of real-valued function, 81        Markov, Andrey, 102, 106
      of simple function, 76             maximal element, 175
      on a subset, 88                    mean value, 386
      on small sets, 90
      with respect to counting measure,

        76
integration operator, 282, 314
interior, 184

           Measure, Integration & Real Analysis, by Sheldon Axler
                                                        Index 409

measurable                                      projection, 227, 232, 247
      function, 31, 37, 156               orthonormal
      rectangle, 117
      set, 27, 55                               basis, 244
      space, 27                                 family, 237
                                                sequence, 237
measure, 41                                     subset, 249
      of decreasing intersection, 44, 46  outer measure, 14
      of increasing union, 43
      of intersection of two sets, 45     parallelogram equality, 220
      of union of three sets, 46          Parseval's identity, 244
      of union of two sets, 45            Parseval, Marc-Antoine, 245
                                          partial derivative, 142
measure space, 42                         partial derivatives, order does not mat-
Melas, Antonios, 107
metric, 147                                       ter, 143
metric space, 147                         partial isometry, 311
Minkowski's inequality, 199               partition, 2
Minkowski, Hermann, 193, 211              Pascal, Blaise, 380
monotone class, 122                       photo credits, 400-401
Monotone Class Theorem, 122               Plancherel's Theorem, 375
Monotone Convergence Theorem, 78          p-norm, 194
Moon, 44                                  pointwise convergence, 62
Moscow State University, 68               Poisson integral
multiplication operator, 281
                                                on unit disk, 349
Napoleon, 339, 371                              on upper half-plane, 372
Nikodym, Otto, 272                        Poisson kernel, 346, 370
Noether, Emmy, 211                        Poisson, Siméon-Denis, 371, 373
norm, 163                                 positive measure, 41, 256
                                          Principle of Uniform Boundedness,
      coming from inner product, 214
      of a linear map, 167                        190
normal, 302                               probability distribution, 392
normed vector space, 163                  probability measure, 381
null space, 172                           probability of a set, 381
      of T, 285                           probability space, 381
                                          product
open
      ball, 148                                 of Banach spaces, 188
      cover, 18                                 of Borel sets, 138
      cube, 136                                 of measures, 127
      set, 136, 137, 148                        of open sets, 137
      unit ball, 141                            of scalar and vector, 159
      unit disk, 253, 340                       of -algebras, 117
                                          Pythagorean Theorem, 217
Open Mapping Theorem, 186
operator, 286                             Rademacher, Hans, 238
orthogonal, 216                           Radon, Johann, 255
                                          Radon-Nikodym derivative, 274
      complement, 229                     Radon-Nikodym Theorem, 272
      decomposition, 217, 231             Ramanujan, Srinivasa, 101

Measure, Integration & Real Analysis, by Sheldon Axler
410 Index

random variable, 385                   step function, 97
range                                  St. Petersburg University, 102
                                       subspace, 160
      dense, 285
      of T, 285                              dense, 230
real inner product space, 212          Supreme Court, 216
real measure, 256                      Swiss Federal Institute of Technology,
real part, 155
rectangle, 117                                 193
reflexive, 210                         Tonelli's Theorem, 129, 131
region under graph, 133                Tonelli, Leonida, 116
Riemann integrable, 5                  total variation measure, 259
Riemann integral, 5, 93                total variation norm, 263
Riemann sum, 2                         translation of set, 16, 60
Riemann, Bernhard, 1, 211              triangle inequality, 163, 219
Riemann-Lebesgue Lemma, 344, 364       Trinity College, Cambridge, 101
Riesz Representation Theorem, 233,     two-sided ideal, 313
                                       unbounded linear functional, 177
        250                            uniform convergence, 62
Riesz, Frigyes, 234                    uniform density, 395
right invertible, 289                  unit circle, 340
right shift, 289, 294                  unit disk, 253, 340
                                       unitary, 305
sample space, 381                      University of Göttingen, 211
scalar multiplication, 159             University of Vienna, 255
Schmidt, Erhard, 247                   unordered sum, 239
Schwarz, Hermann, 219                  upper half-plane, 370
Scuola Normale Superiore di Pisa, 116  upper Riemann integral, 4
self-adjoint, 299                      upper Riemann sum, 2
separable, 183, 245                    Uppsala University, 280
Shakespeare, William, 70               variance, 388
-algebra, 26                           vector space, 159
                                       Vitali Covering Lemma, 103
      smallest, 28                     Vitali, Giuseppe, 13
-finite measure, 123                   Volterra operator, 286, 315, 320, 331,
signed measure, 257
Simon, Barry, 69                               334, 338
simple function, 65                    Volterra, Vito, 286
singular measures, 268                 volume of unit ball, 141
Singular Value Decomposition, 332      von Neumann, John, 272
singular values, 333                   Weak Law of Large Numbers, 397
span, 174                              Wirtinger's inequality, 362
S-partition, 74                        Young's inequality, 196
Spectral Mapping Theorem, 298          Young, William Henry, 196
Spectral Theorem, 329-330              Zorn's Lemma, 176, 183, 236
spectrum, 294                          Zorn, Max, 176
standard deviation, 388
standard normal density, 395
standard representation, 79
Steinhaus, Hugo, 189

           Measure, Integration & Real Analysis, by Sheldon Axler
Colophon: Notes on Typesetting

· This book was typeset in pdfLATEX by the author, who wrote the LATEX code to
   implement the book's design. The pdfLATEX software was developed by Hàn Th
   Thành.

· The LATEX software used for this book was written by Leslie Lamport. The TEX
   software, which forms the base for LATEX, was written by Donald Knuth.

· The main text font in this book is Nimbus Roman No. 9 L, created by URW
   as a legal clone of Times, which was designed by Stanley Morison and Victor
   Lardent for the British newspaper The Times in 1931.

· The math fonts in this book are various versions of Pazo Math, URW Palladio,
   and Computer Modern. Pazo Math was created by Diego Puga; URW Palladio
   is a legal clone of Palatino, which was designed by Hermann Zapf; Computer
   Modern was designed by Donald Knuth.

· The sans serif font used for page headings, section titles, subsection titles, and
   some other design elements is NimbusSanL, a legal clone of Helvetica, which
   was designed by Max Miedinger and Eduard Hoffmann.

· The figures in the book were produced by Mathematica, using Mathematica
   code written by the author. Mathematica was created by Stephen Wolfram.

· The Mathematica package MaTeX, written by Szabolcs Horvát, was used to
   place LATEX-generated labels in the Mathematica figures.

· The LATEX package graphicx, written by David Carlisle and Sebastian Rahtz,
   was used to integrate into the manuscript photos and the figures produced by
   Mathematica.

· The LATEX package multicol, written by Frank Mittelbach, was used to get around
   LATEX's limitation that two-column format must start on a new page (needed for
   the Notation Index and the Index).

· The LATEX packages Tik Z, written by Till Tantau, and tcolorbox, written by
   Thomas Sturm, were used to produce the definition boxes and result boxes.

· The LATEX package color, written by David Carlisle, was used to add appropriate
   color to various design elements, such as used on the first page of each chapter.

· The LATEX package wrapfig, written by Donald Arseneau, was used to wrap text
   around the comment boxes.

· The LATEX package microtype, written by Robert Schlicht, was used to reduce
   hyphenation and produce more pleasing right justification.

                                                                                                         411
                   Measure, Integration & Real Analysis, by Sheldon Axler
