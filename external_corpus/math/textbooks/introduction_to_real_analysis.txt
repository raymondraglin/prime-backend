Trinity University

Digital Commons @ Trinity

Faculty Authored and Edited Books & CDs
12-2013

Introduction to Real Analysis

William F. Trench

Trinity University, wtrench@trinity.edu

Follow this and additional works at: https://digitalcommons.trinity.edu/mono
   Part of the Mathematics Commons

Recommended Citation

Trench, William F., "Introduction to Real Analysis" (2013). Faculty Authored and Edited Books & CDs. 7.
https://digitalcommons.trinity.edu/mono/7
This Book is brought to you for free and open access by Digital Commons @ Trinity. It has been accepted for inclusion in Faculty Authored and Edited
Books & CDs by an authorized administrator of Digital Commons @ Trinity. For more information, please contact jcostanz@trinity.edu.
       INTRODUCTION
     TO REAL ANALYSIS

           William F. Trench

       Andrew G. Cowles Distinguished Professor Emeritus
                       Department of Mathematics
                             Trinity University
                        San Antonio, Texas, USA
                           wtrench@trinity.edu

This book has been judged to meet the evaluation criteria set by
the Editorial Board of the American Institute of Mathematics in
connection with the Institute's Open Textbook Initiative. It may
be copied, modified, redistributed, translated, and built upon sub-
ject to the Creative Commons
Attribution-NonCommercial-ShareAlike 3.0 Unported License.

         FREE DOWNLOADABLE SUPPLEMENTS
FUNCTIONS DEFINED BY IMPROPER INTEGRALS

    THE METHOD OF LAGRANGE MULTIPLIERS
Library of Congress Cataloging-in-Publication Data

Trench, William F.

Introduction to real analysis / William F. Trench

                    p. cm.

ISBN 0-13-045786-8

                    1. Mathematical Analysis. I. Title.

QA300.T667 2003

515-dc21                    2002032369

Free Hyperlinked Edition 2.04 December 2013

This book was published previously by Pearson Education.

This free edition is made available in the hope that it will be useful as a textbook or refer-
ence. Reproduction is permitted for any valid noncommercial educational, mathematical,
or scientific purpose. However, charges for profit beyond reasonable printing costs are
prohibited.

A complete instructor's solution manual is available by email to wtrench@trinity.edu, sub-
ject to verification of the requestor's faculty status. Although this book is subject to a
Creative Commons license, the solutions manual is not. The author reserves all rights to
the manual.
TO BEVERLY
                        Contents

Preface                                       vi

Chapter 1 The Real Numbers                    1

1.1 The Real Number System                    1

1.2 Mathematical Induction                    10

1.3 The Real Line                             19

Chapter 2 Differential Calculus of Functions of One Variable 30

2.1 Functions and Limits                      30

2.2 Continuity                                53

2.3 Differentiable Functions of One Variable  73

2.4 L'Hospital's Rule                         88

2.5 Taylor's Theorem                          98

Chapter 3 Integral Calculus of Functions of One Variable 113

3.1 Definition of the Integral                113

3.2 Existence of the Integral                 128

3.3 Properties of the Integral                135

3.4 Improper Integrals                        151

3.5 A More Advanced Look at the Existence

of the Proper Riemann Integral                171

Chapter 4 Infinite Sequences and Series       178

4.1 Sequences of Real Numbers                 179

4.2 Earlier Topics Revisited With Sequences   195

4.3 Infinite Series of Constants              200

                                  iv
                                                         Contents v

4.4 Sequences and Series of Functions                    234

4.5 Power Series                                         257

Chapter 5 Real-Valued Functions of Several Variables     281

5.1 Structure of Rn                                      281

5.2 Continuous Real-Valued Function of n Variables       302

5.3 Partial Derivatives and the Differential             316

5.4 The Chain Rule and Taylor's Theorem                  339

Chapter 6 Vector-Valued Functions of Several Variables 361

6.1 Linear Transformations and Matrices                  361

6.2 Continuity and Differentiability of Transformations  378

6.3 The Inverse Function Theorem                         394

6.4. The Implicit Function Theorem                       417

Chapter 7 Integrals of Functions of Several Variables    435

7.1 Definition and Existence of the Multiple Integral    435

7.2 Iterated Integrals and Multiple Integrals            462

7.3 Change of Variables in Multiple Integrals            484

Chapter 8 Metric Spaces                                  518

8.1 Introduction to Metric Spaces                        518

8.2 Compact Sets in a Metric Space                       535

8.3 Continuous Functions on Metric Spaces                543

Answers to Selected Exercises                            549

Index                                                    563
                 Preface

This is a text for a two-term course in introductory real analysis for junior or senior math-
ematics majors and science students with a serious interest in mathematics. Prospective
educators or mathematically gifted high school students can also benefit from the mathe-
matical maturity that can be gained from an introductory real analysis course.

   The book is designed to fill the gaps left in the development of calculus as it is usually
presented in an elementary course, and to provide the background required for insight into
more advanced courses in pure and applied mathematics. The standard elementary calcu-
lus sequence is the only specific prerequisite for Chapters 1-5, which deal with real-valued
functions. (However, other analysis oriented courses, such as elementary differential equa-
tion, also provide useful preparatory experience.) Chapters 6 and 7 require a working
knowledge of determinants, matrices and linear transformations, typically available from a
first course in linear algebra. Chapter 8 is accessible after completion of Chapters 1-5.

   Without taking a position for or against the current reforms in mathematics teaching, I
think it is fair to say that the transition from elementary courses such as calculus, linear
algebra, and differential equations to a rigorous real analysis course is a bigger step to-
day than it was just a few years ago. To make this step today's students need more help
than their predecessors did, and must be coached and encouraged more. Therefore, while
striving throughout to maintain a high level of rigor, I have tried to write as clearly and in-
formally as possible. In this connection I find it useful to address the student in the second
person. I have included 295 completely worked out examples to illustrate and clarify all
major theorems and definitions.

   I have emphasized careful statements of definitions and theorems and have tried to be
complete and detailed in proofs, except for omissions left to exercises. I give a thorough
treatment of real-valued functions before considering vector-valued functions. In making
the transition from one to several variables and from real-valued to vector-valued functions,
I have left to the student some proofs that are essentially repetitions of earlier theorems. I
believe that working through the details of straightforward generalizations of more elemen-
tary results is good practice for the student.

   Great care has gone into the preparation of the 761 numbered exercises, many with
multiple parts. They range from routine to very difficult. Hints are provided for the more
difficult parts of the exercises.

                                                     vi
                                                                                            Preface vii

Organization

Chapter 1 is concerned with the real number system. Section 1.1 begins with a brief dis-
cussion of the axioms for a complete ordered field, but no attempt is made to develop the
reals from them; rather, it is assumed that the student is familiar with the consequences of
these axioms, except for one: completeness. Since the difference between a rigorous and
nonrigorous treatment of calculus can be described largely in terms of the attitude taken
toward completeness, I have devoted considerable effort to developing its consequences.
Section 1.2 is about induction. Although this may seem out of place in a real analysis
course, I have found that the typical beginning real analysis student simply cannot do an
induction proof without reviewing the method. Section 1.3 is devoted to elementary set the-
ory and the topology of the real line, ending with the Heine-Borel and Bolzano-Weierstrass
theorems.

   Chapter 2 covers the differential calculus of functions of one variable: limits, continu-
ity, differentiablility, L'Hospital's rule, and Taylor's theorem. The emphasis is on rigorous
presentation of principles; no attempt is made to develop the properties of specific ele-
mentary functions. Even though this may not be done rigorously in most contemporary
calculus courses, I believe that the student's time is better spent on principles rather than
on reestablishing familiar formulas and relationships.

   Chapter 3 is to devoted to the Riemann integral of functions of one variable. In Sec-
tion 3.1 the integral is defined in the standard way in terms of Riemann sums. Upper and
lower integrals are also defined there and used in Section 3.2 to study the existence of the
integral. Section 3.3 is devoted to properties of the integral. Improper integrals are studied
in Section 3.4. I believe that my treatment of improper integrals is more detailed than in
most comparable textbooks. A more advanced look at the existence of the proper Riemann
integral is given in Section 3.5, which concludes with Lebesgue's existence criterion. This
section can be omitted without compromising the student's preparedness for subsequent
sections.

   Chapter 4 treats sequences and series. Sequences of constant are discussed in Sec-
tion 4.1. I have chosen to make the concepts of limit inferior and limit superior parts
of this development, mainly because this permits greater flexibility and generality, with
little extra effort, in the study of infinite series. Section 4.2 provides a brief introduction
to the way in which continuity and differentiability can be studied by means of sequences.
Sections 4.3-4.5 treat infinite series of constant, sequences and infinite series of functions,
and power series, again in greater detail than in most comparable textbooks. The instruc-
tor who chooses not to cover these sections completely can omit the less standard topics
without loss in subsequent sections.

   Chapter 5 is devoted to real-valued functions of several variables. It begins with a dis-
cussion of the toplogy of Rn in Section 5.1. Continuity and differentiability are discussed
in Sections 5.2 and 5.3. The chain rule and Taylor's theorem are discussed in Section 5.4.
viii Preface

   Chapter 6 covers the differential calculus of vector-valued functions of several variables.
Section 6.1 reviews matrices, determinants, and linear transformations, which are integral
parts of the differential calculus as presented here. In Section 6.2 the differential of a
vector-valued function is defined as a linear transformation, and the chain rule is discussed
in terms of composition of such functions. The inverse function theorem is the subject of
Section 6.3, where the notion of branches of an inverse is introduced. In Section 6.4. the
implicit function theorem is motivated by first considering linear transformations and then
stated and proved in general.

   Chapter 7 covers the integral calculus of real-valued functions of several variables. Mul-
tiple integrals are defined in Section 7.1, first over rectangular parallelepipeds and then
over more general sets. The discussion deals with the multiple integral of a function whose
discontinuities form a set of Jordan content zero. Section 7.2 deals with the evaluation by
iterated integrals. Section 7.3 begins with the definition of Jordan measurability, followed
by a derivation of the rule for change of content under a linear transformation, an intuitive
formulation of the rule for change of variables in multiple integrals, and finally a careful
statement and proof of the rule. The proof is complicated, but this is unavoidable.

   Chapter 8 deals with metric spaces. The concept and properties of a metric space are
introduced in Section 8.1. Section 8.2 discusses compactness in a metric space, and Sec-
tion 8.3 discusses continuous functions on metric spaces.

   Corrections-mathematical and typographical-are welcome and will be incorporated when
received.

                                                                       William F. Trench
                                                                       wtrench@trinity.edu
                                                                       Home: 659 Hopkinton Road

                                                                                Hopkinton, NH 03229
                                       CHAPTER 1

                                   The Real Numbers

IN THIS CHAPTER we begin the study of the real number system. The concepts discussed
here will be used throughout the book.
SECTION 1.1 deals with the axioms that define the real numbers, definitions based on
them, and some basic properties that follow from them.
SECTION 1.2 emphasizes the principle of mathematical induction.
SECTION 1.3 introduces basic ideas of set theory in the context of sets of real num-
bers. In this section we prove two fundamental theorems: the Heine-Borel and Bolzano-
Weierstrass theorems.

1.1 THE REAL NUMBER SYSTEM

Having taken calculus, you know a lot about the real number system; however, you prob-
ably do not know that all its properties follow from a few basic ones. Although we will
not carry out the development of the real number system from these basic properties, it is
useful to state them as a starting point for the study of real analysis and also to focus on
one property, completeness, that is probably new to you.

Field Properties
The real number system (which we will often call simply the reals) is first of all a set
fa; b; c; : : : g on which the operations of addition and multiplication are defined so that
every pair of real numbers has a unique sum and product, both real numbers, with the
following properties.
(A) a C b D b C a and ab D ba (commutative laws).
(B) .a C b/ C c D a C .b C c/ and .ab/c D a.bc/ (associative laws).
(C) a.b C c/ D ab C ac (distributive law).
(D) There are distinct real numbers 0 and 1 such that a C 0 D a and a1 D a for all a.
(E) For each a there is a real number a such that a C . a/ D 0, and if a ¤ 0, there is

      a real number 1=a such that a.1=a/ D 1.

                                                      1
2 Chapter 1 The Real Numbers

The manipulative properties of the real numbers, such as the relations

                   .a C b/2 D a2 C 2ab C b2;
     .3a C 2b/.4c C 2d / D 12ac C 6ad C 8bc C 4bd;

                        . a/ D . 1/a; a. b/ D . a/b D ab;

and

                   a C c D ad C bc .b; d ¤ 0/;
                   bd          bd

all follow from (A)-(E). We assume that you are familiar with these properties.

  A set on which two operations are defined so as to have properties (A)-(E) is called a
field. The real number system is by no means the only field. The rational numbers (which
are the real numbers that can be written as r D p=q, where p and q are integers and q ¤ 0)
also form a field under addition and multiplication. The simplest possible field consists of
two elements, which we denote by 0 and 1, with addition defined by

                   0 C 0 D 1 C 1 D 0; 1 C 0 D 0 C 1 D 1;                (1.1.1)

and multiplication defined by

                   0 0 D 0 1 D 1 0 D 0; 1 1 D 1                         (1.1.2)

(Exercise 1.1.2).

The Order Relation
The real number system is ordered by the relation <, which has the following properties.

(F) For each pair of real numbers a and b, exactly one of the following is true:

                                       a D b; a < b; or b < a:

(G) If a < b and b < c, then a < c. (The relation < is transitive.)
(H) If a < b, then a C c < b C c for any c, and if 0 < c, then ac < bc.

  A field with an order relation satisfying (F)-(H) is an ordered field. Thus, the real
numbers form an ordered field. The rational numbers also form an ordered field, but it is
impossible to define an order on the field with two elements defined by (1.1.1) and (1.1.2)
so as to make it into an ordered field (Exercise 1.1.2).

   We assume that you are familiar with other standard notation connected with the order
relation: thus, a > b means that b < a; a b means that either a D b or a > b; a Ä b
means that either a D b or a < b; the absolute value of a, denoted by jaj, equals a if
a 0 or a if a Ä 0. (Sometimes we call jaj the magnitude of a.)

   You probably know the following theorem from calculus, but we include the proof for
your convenience.
                                             Section 1.1 The Real Number System 3

Theorem 1.1.1 (The Triangle Inequality) If a and b are any two real numbers;

then

                              ja C bj Ä jaj C jbj:                          (1.1.3)

Proof There are four possibilities:
(a) If a 0 and b 0, then a C b 0, so ja C bj D a C b D jaj C jbj.

(b) If a Ä 0 and b Ä 0, then a C b Ä 0, so ja C bj D a C . b/ D jaj C jbj.

(c) If a 0 and b Ä 0, then a C b D jaj jbj.

(d) If a Ä 0 and b 0, then a C b D jaj C jbj.
Eq. 1.1.3 holds in cases (c) and (d), since

                                             (
                                ja C bj D jaj jbj if jaj jbj;

                                               jbj jaj if jbj jaj:

   The triangle inequality appears in various forms in many contexts. It is the most impor-
tant inequality in mathematics. We will use it often.

Corollary 1.1.2 If a and b are any two real numbers; then

                              ja bj jaj jbj                                 (1.1.4)

and                           ja C bj jaj jbj:     

                                                                            (1.1.5)

Proof Replacing a by a b in (1.1.3) yields
                                          jaj Ä ja bj C jbj;

so                                                                          (1.1.6)
                                          ja bj jaj jbj:

Interchanging a and b here yields

                              jb aj jbj jaj;

which is equivalent to

                              ja bj        jbj jaj;                         (1.1.7)

since jb  aj D ja  bj. Since

                                   (                      jaj > jbj;
                               jaj         jbj if         jbj > jaj;
                        jaj jbj D          jaj if
                                      jbj

(1.1.6) and (1.1.7) imply (1.1.4). Replacing b by b in (1.1.4) yields (1.1.5), since j bj D

jbj.                                                          Supremum of a Set

A set S of real numbers is bounded above if there is a real number b such that x Ä b
whenever x 2 S . In this case, b is an upper bound of S . If b is an upper bound of S ,
then so is any larger number, because of property (G). If  is an upper bound of S , but no
number less than  is, then  is a supremum of S , and we write

                                                D sup S:
4 Chapter 1 The Real Numbers

   With the real numbers associated in the usual way with the points on a line, these defini-
tions can be interpreted geometrically as follows: b is an upper bound of S if no point of S
is to the right of b;  D sup S if no point of S is to the right of , but there is at least one
point of S to the right of any number less than  (Figure 1.1.1).

                            b

(S = dark line segments)

Figure 1.1.1

Example 1.1.1 If S is the set of negative numbers, then any nonnegative number is an
upper bound of S , and sup S D 0. If S1 is the set of negative integers, then any number a
such that a 1 is an upper bound of S1, and sup S1 D 1.

   This example shows that a supremum of a set may or may not be in the set, since S1
contains its supremum, but S does not.

   A nonempty set is a set that has at least one member. The empty set, denoted by ;, is the
set that has no members. Although it may seem foolish to speak of such a set, we will see
that it is a useful idea.

The Completeness Axiom

It is one thing to define an object and another to show that there really is an object that
satisfies the definition. (For example, does it make sense to define the smallest positive
real number?) This observation is particularly appropriate in connection with the definition
of the supremum of a set. For example, the empty set is bounded above by every real
number, so it has no supremum. (Think about this.) More importantly, we will see in
Example 1.1.2 that properties (A)-(H) do not guarantee that every nonempty set that
is bounded above has a supremum. Since this property is indispensable to the rigorous
development of calculus, we take it as an axiom for the real numbers.

(I) If a nonempty set of real numbers is bounded above, then it has a supremum.
  Property (I) is called completeness, and we say that the real number system is a complete

ordered field. It can be shown that the real number system is essentially the only complete
ordered field; that is, if an alien from another planet were to construct a mathematical
system with properties (A)-(I), the alien's system would differ from the real number
system only in that the alien might use different symbols for the real numbers and C, ,
and <.

Theorem 1.1.3 If a nonempty set S of real numbers is bounded above; then sup S is
the unique real number  such that
(a) x Ä  for all x in SI

(b) if > 0 .no matter how small/; there is an x0 in S such that x0 >  :
                     Section 1.1 The Real Number System 5

Proof We first show that  D sup S has properties (a) and (b). Since  is an upper
bound of S , it must satisfy (a). Since any real number a less than  can be written as 
with D  a > 0, (b) is just another way of saying that no number less than  is an
upper bound of S . Hence,  D sup S satisfies (a) and (b).

  Now we show that there cannot be more than one real number with properties (a) and
(b). Suppose that 1 < 2 and 2 has property (b); thus, if > 0, there is an x0 in S
such that x0 > 2 . Then, by taking D 2 1, we see that there is an x0 in S such
that

                                     x0 > 2 .2 1/ D 1;

so 1 cannot have property (a). Therefore, there cannot be more than one real number
that satisfies both (a) and (b).

Some Notation

                                                       ° «
We will often define a set S by writing S D x  , which means that S consists of all

x that satisfy the conditions to the right of the vertical bar; thus, in Example 1.1.1,

                  °        «
               S D xx < 0                                                                (1.1.8)

and            °                         «
               S1 D x  x is a negative integer :

We will sometimes abbreviate "x is a member of S " by x 2 S , and "x is not a member of
S " by x ... S . For example, if S is defined by (1.1.8), then

               1 2 S but 0 ... S:

The Archimedean Property

The property of the real numbers described in the next theorem is called the Archimedean
property. Intuitively, it states that it is possible to exceed any positive number, no matter
how large, by adding an arbitrary positive number, no matter how small, to itself sufficiently
many times.

Theorem 1.1.4 (Archimedean Property) If and are positive; then n >
  for some integer n:

Proof    The proof is by contradiction. If the statement is false,  is an upper bound of
the set                                                                              (1.1.9)
               °                         «
               S D x  x D n ; n is an integer :

Therefore, S has a supremum , by property (I). Therefore,

               n Ä  for all integers n:
6 Chapter 1 The Real Numbers

Since n C 1 is an integer whenever n is, (1.1.9) implies that

                              .n C 1/ Ä 

and therefore                        n Ä                       < , this contradicts
                             is an upper bound of S . Since 
for all integers n. Hence, 
the definition of .

Density of the Rationals and Irrationals

Definition 1.1.5 A set D is dense in the reals if every open interval .a; b/ contains a
member of D.

Theorem 1.1.6 The rational numbers are dense in the reals I that is, if a and b are
real numbers with a < b; there is a rational number p=q such that a < p=q < b.

Proof From Theorem 1.1.4 with D 1 and D b a, there is a positive integer q such
that q.b a/ > 1. There is also an integer j such that j > qa. This is obvious if a Ä 0,
and it follows from Theorem 1.1.4 with D 1 and D qa if a > 0. Let p be the smallest
integer such that p > qa. Then p 1 Ä qa, so

                                           qa < p Ä qa C 1:

Since 1 < q.b a/, this implies that

                                  qa < p < qa C q.b a/ D qb;

so qa < p < qb. Therefore, a < p=q < b.

Example 1.1.2 The rational number system is not complete; that is, a set of rational
numbers may be bounded above (by rationals), but not have a rational upper bound less
than any other rational upper bound. To see this, let

                                 S D °r  r is rational and r 2 < 2« :
                         p
   If r 2 Sp, then r < 2.pTheorem 1.1.6 implies that if > 0pthere is a rational numbper r0
such that 2 < r0 < 2, so Theorem 1.1.3 implies that 2 D sup S . However, 2 is
irrational; that is, it cannot be written as thpe ratio of integers (Exercise 1.1.3). Therefore,
if r1 is any rational uppper bound of S , then 2 < r1. By Theorem 1.1.6, there is a rational
number r2 such that 2 < r2 < r1. Since r2 is also a rational upper bound of S , this shows
that S has no rational supremum.

Since the rational numbers have properties (A)-(H), but not (I), this example shows
that (I) does not follow from (A)-(H).

Theorem 1.1.7 The set of irrational numbers is dense in the reals I that is, if a and b
are real numbers with a < b; there is an irrational number t such that a < t < b:
                                            Section 1.1 The Real Number System 7

Proof From Theorem 1.1.6, there are rational numbers r1 and r2 such that       (1.1.10)
                                            a < r1 < r2 < b:

Let
                                                      1

                                        t D r1 C p .r2 r1/:
                                                       2

Then t is irrational (why?) and r1 < t < r2, so a < t < b, from (1.1.10).

Infimum of a Set

A set S of real numbers is bounded below if there is a real number a such that x a

whenever x 2 S . In this case, a is a lower bound of S . If a is a lower bound of S , so is
any smaller number, because of property (G). If  is a lower bound of S , but no number
greater than  is, then  is an infimum of S , and we write

                                                 D inf S:

Geometrically, this means that there are no points of S to the left of , but there is at least
one point of S to the left of any number greater than .

Theorem 1.1.8 If a nonempty set S of real numbers is bounded below; then inf S is
the unique real number  such that

(a) x  for all x in SI
(b) if > 0 .no matter how small /, there is an x0 in S such that x0 <  C :

Proof (Exercise 1.1.6)

   A set S is bounded if there are numbers a and b such that a Ä x Ä b for all x in S . A
bounded nonempty set has a unique supremum and a unique infimum, and

                                        inf S Ä sup S                          (1.1.11)

(Exercise 1.1.7).

The Extended Real Number System

A nonempty set S of real numbers is unbounded above if it has no upper bound, or un-
 bounded below if it has no lower bound. It is convenient to adjoin to the real number
 system two fictitious points, C1 (which we usually write more simply as 1) and 1,
 and to define the order relationships between them and any real number x by

                                        1 < x < 1:                             (1.1.12)

We call 1 and 1 points at infinity. If S is a nonempty set of reals, we write

                                        sup S D 1                              (1.1.13)

to indicate that S is unbounded above, and

                                        inf S D 1                              (1.1.14)

to indicate that S is unbounded below.
8 Chapter 1 The Real Numbers

Example 1.1.3 If                   °  «
then sup S D 2 and inf S D         S D xx < 2 ;

                            1. If

                                   °  «
                              S D xx 2 ;

then sup S D 1 and inf S D 2. If S is the set of all integers, then sup S D 1 and
inf S D 1.

   The real number system with 1 and 1 adjoined is called the extended real number
system, or simply the extended reals. A member of the extended reals differing from 1
and 1 is finite; that is, an ordinary real number is finite. However, the word "finite" in
"finite real number" is redundant and used only for emphasis, since we would never refer
to 1 or 1 as real numbers.

   The arithmetic relationships among 1, 1, and the real numbers are defined as follows.

(a) If a is any real number, then

                              a C 1 D 1 C a D 1;

                              a 1 D 1 C a D 1;
                                   aa
                                   1 D 1 D 0:

(b) If a > 0, then

                                a 1 D 1 a D 1;
                              a . 1/ D . 1/ a D 1:

(c) If a < 0, then

                                a 1 D 1 a D 1;
                              a . 1/ D . 1/ a D 1:

   We also define   1 C 1 D 11 D . 1/. 1/ D 1
and                 1 1 D 1. 1/ D . 1/1 D 1:
Finally, we define
                               j1j D j 1j D 1:

   The introduction of 1 and 1, along with the arithmetic and order relationships defined
above, leads to simplifications in the statements of theorems. For example, the inequality
(1.1.11), first stated only for bounded sets, holds for any nonempty set S if it is interpreted
properly in accordance with (1.1.12) and the definitions of (1.1.13) and (1.1.14). Exer-
cises 1.1.10(b) and 1.1.11(b) illustrate the convenience afforded by some of the arith-
metic relationships with extended reals, and other examples will illustrate this further in
subsequent sections.
                                                         Section 1.1 The Real Number System 9

   It is not useful to define 1 1, 0 1, 1=1, and 0=0. They are called indeterminate
forms, and left undefined. You probably studied indeterminate forms in calculus; we will
look at them more carefully in Section 2.4.

                                       1.1 Exercises

1. Write the following expressions in equivalent forms not involving absolute values.

(a) a C b C ja bj           (b) a C b ja bj          
(c) a C b C 2c C ja
(d) a C b C 2c ja       bj C a C b 2c C ja bj
                                                  
                        bj a C b 2c ja bj

2. Verify that the set consisting of two members, 0 and 1, with operations defined by

Eqns. (1.1.1) and (1.1.2), is a field. Then show that it is impossible to define an order

< on this field that has properties (F), (G), and (H).
p                                                 p
3. Show that 2 is irrational. HINT: Show that if 2 D m=n; where m and n are

integers; then both m and n must be even: Obtain a contradiction from this:

4. Show that pp is irrational if p is prime.

5. Find the supremum and infimum of each S . State whether they are in S .
°                                                      «
                                              n2
(a) S D x x D .1=n/ C OE1 C . 1/  n ; n 1
°                    «
   2
(b) S D x x < 9
°                    «
   2
(c) S D x x Ä 7
°                        «
(d) S D x  j2x C 1j < 5
°                       1 1«
                  2
(e) S D °x  2 .x C 1/ > 2 «
(f ) S D x x D rational and x Ä 7 °  «
6. Prove Theorem 1.1.8. HINT: The set T D x  x 2 S is bounded above if S is

bounded below: Apply property (I) and Theorem 1.1.3 to T:

7. (a) Show that

                              inf S Ä sup S                                  .A/

             for any nonempty set S of real numbers, and give necessary and sufficient
             conditions for equality.
     (b) Show that if S is unbounded then (A) holds if it is interpreted according to
             Eqn. (1.1.12) and the definitions of Eqns. (1.1.13) and (1.1.14).

8. Let S and T be nonempty sets of real numbers such that every real number is in S
      or T and if s 2 S and t 2 T , then s < t. Prove that there is a unique real number 
      such that every real number less than  is in S and every real number greater than
       is in T . (A decomposition of the reals into two sets with these properties is a
      Dedekind cut. This is known as Dedekind's theorem.)
10 Chapter 1 The Real Numbers

9. Using properties (A)-(H) of the real numbers and taking Dedekind's theorem
      (Exercise 1.1.8) as given, show that every nonempty set U of real numbers that is
      bounded above has a supremum. HINT: Let T be the set of upper bounds of U and
      S be the set of real numbers that are not upper bounds of U:

10. Let S and T be nonempty sets of real numbers and define
                               °            «
               S C T D s C t  s 2 S; t 2 T :

(a) Show that

                               sup.S C T / D sup S C sup T   .A/

if S and T are bounded above and

                               inf.S C T / D inf S C inf T   .B/

if S and T are bounded below.

(b) Show that if they are properly interpreted in the extended reals, then (A) and
      (B) hold if S and T are arbitrary nonempty sets of real numbers.

11. Let S and T be nonempty sets of real numbers and define
                               °            «
               S T D s t  s 2 S; t 2 T :

(a) Show that if S and T are bounded, then

                               sup.S T / D sup S inf T       .A/

and

                               inf.S T / D inf S sup T:      .B/

(b) Show that if they are properly interpreted in the extended reals, then (A) and
      (B) hold if S and T are arbitrary nonempty sets of real numbers.

12. Let S be a bounded n°onempty set of «real numbers, and let a and b be fixed real
        numbers. Define T D as C b  s 2 S . Find formulas for sup T and inf T in terms
        of sup S and inf S . Prove your formulas.

1.2 MATHEMATICAL INDUCTION

If a flight of stairs is designed so that falling off any step inevitably leads to falling off the
next, then falling off the first step is a sure way to end up at the bottom. Crudely expressed,
this is the essence of the principle of mathematical induction: If the truth of a statement
depending on a given integer n implies the truth of the corresponding statement with n
replaced by n C 1, then the statement is true for all positive integers n if it is true for n D 1.
Although you have probably studied this principle before, it is so important that it merits
careful review here.

Peano's Postulates and Induction

The rigorous construction of the real number system starts with a set N of undefined ele-
ments called natural numbers, with the following properties.
                           Section 1.2 Mathematical Induction 11

(A) N is nonempty.
(B) Associated with each natural number n there is a unique natural number n0 called

      the successor of n.

(C) There is a natural number n that is not the successor of any natural number.
(D) Distinct natural numbers have distinct successors; that is, if n ¤ m, then n0 ¤ m0.

(E) The only subset of N that contains n and the successors of all its elements is N
      itself.

   These axioms are known as Peano's postulates. The real numbers can be constructed
from the natural numbers by definitions and arguments based on them. This is a formidable
task that we will not undertake. We mention it to show how little you need to start with to
construct the reals and, more important, to draw attention to postulate (E), which is the
basis for the principle of mathematical induction.

   It can be shown that the positive integers form a subset of the reals that satisfies Peano's
postulates (with n D 1 and n0 D n C 1), and it is customary to regard the positive integers
and the natural numbers as identical. From this point of view, the principle of mathematical
induction is basically a restatement of postulate (E).

Theorem 1.2.1 (Principle of Mathematical Induction)                  Let P1; P2;. . . ;
Pn; . . . be propositions; one for each positive integer; such that
(a) P1 is trueI
(b) for each positive integer n; Pn implies PnC1:
Then Pn is true for each positive integer n:

Proof Let            °                        «
                     M D n  n 2 N and Pn is true :

From (a), 1 2 M, and from (b), n C 1 2 M whenever n 2 M. Therefore, M D N, by
postulate (E).

Example 1.2.1 Let Pn be the proposition that

                     1C2C  C n D n.n C 1/ :                          (1.2.1)
                                         2

Then P1 is the proposition that 1 D 1, which is certainly true. If Pn is true, then adding
n C 1 to both sides of (1.2.1) yields

           .1 C 2 C  C n/ C .n C 1/ D n.n C 1/ C .n C 1/
                                                 2n Á

                                         D .n C 1/ 2 C 1

                           D .n C 1/.n C 2/ ;
                                       2

or

           1C2C      C .n C 1/ D .n C 1/.n C 2/ ;
                                              2
12 Chapter 1 The Real Numbers

which is PnC1, since it has the form of (1.2.1), with n replaced by nC 1. Hence, Pn implies
PnC1, so (1.2.1) is true for all n, by Theorem 1.2.1.

   A proof based on Theorem 1.2.1 is an induction proof , or proof by induction. The
assumption that Pn is true is the induction assumption. (Theorem 1.2.3 permits a kind of
induction proof in which the induction assumption takes a different form.)

   Induction, by definition, can be used only to verify results conjectured by other means.
Thus, in Example 1.2.1 we did not use induction to find the sum

                              sn D 1 C 2 C C nI                         (1.2.2)

rather, we verified that

                                      sn D n.n C 1/ :                   (1.2.3)
                                                  2

How you guess what to prove by induction depends on the problem and your approach to

it. For example, (1.2.3) might be conjectured after observing that

                          12             23                         43
s1 D 1 D 2 ; s2 D 3 D 2 ; s3 D 6 D 2 :

However, this requires sufficient insight to recognize that these results are of the form
(1.2.3) for n D 1, 2, and 3. Although it is easy to prove (1.2.3) by induction once it has
been conjectured, induction is not the most efficient way to find sn, which can be obtained
quickly by rewriting (1.2.2) as

                             sn D n C .n 1/ C C 1

and adding this to (1.2.2) to obtain

2sn D OEn C 1 C OE.n 1/ C 2 C C OE1 C n:

There are n bracketed expressions on the right, and the terms in each add up to n C 1;
hence,

                                            2sn D n.n C 1/;

which yields (1.2.3).

   The next two examples deal with problems for which induction is a natural and efficient
method of solution.

Example 1.2.2 Let a1 D 1 and

                                          1                             (1.2.4)
                             anC1 D n C 1 an; n 1

(we say that an is defined inductively), and suppose that we wish to find an explicit formula
for an. By considering n D 1, 2, and 3, we find that

                          1           1                1
a1 D 1 ; a2 D 1 2 ; and a3 D 1 2 3 ;
                                      Section 1.2 Mathematical Induction 13

and therefore we conjecture that

                                          1                                               (1.2.5)
                                  an D nS :

This is given for n D 1. If we assume it is true for some n, substituting it into (1.2.4) yields

                                  11         1
                               anC1 D n C 1 nS D .n C 1/S ;

which is (1.2.5) with n replaced by n C 1. Therefore, (1.2.5) is true for every positive
integer n, by Theorem 1.2.1.

Example 1.2.3 For each nonnegative integer n, let xn be a real number and suppose

that

      jxnC1 xnj Ä r jxn xn 1j; n 1;                                                       (1.2.6)

where r is a fixed positive number. By considering (1.2.6) for n D 1, 2, and 3, we find that

      jx2 x1j Ä r jx1 x0j;
      jx3 x2j Ä r jx2 x1j Ä r 2jx1 x0j;
      jx4 x3j Ä r jx3 x2j Ä r 3jx1 x0j:

Therefore, we conjecture that

      jxn xn 1j Ä r n 1jx1 x0j if n 1:                                                    (1.2.7)

This is trivial for n D 1. If it is true for some n, then (1.2.6) and (1.2.7) imply that
            jxnC1 xnj Ä r .r n 1jx1 x0j/; so jxnC1 xnj Ä r njx1 x0j;

which is proposition (1.2.7) with n replaced by n C 1. Hence, (1.2.7) is true for every
positive integer n, by Theorem 1.2.1.

   The major effort in an induction proof (after P1, P2, . . . , Pn, . . . have been formulated)
is usually directed toward showing that Pn implies PnC1. However, it is important to verify
P1, since Pn may imply PnC1 even if some or all of the propositions P1, P2, . . . , Pn, . . .
are false.

Example 1.2.4 Let Pn be the proposition that 2n 1 is divisible by 2. If Pn is true
then PnC1 is also, since

                                       2n C 1 D .2n 1/ C 2:

However, we cannot conclude that Pn is true for n 1. In fact, Pn is false for every n.

   The following formulation of the principle of mathematical induction permits us to start
induction proofs with an arbitrary integer, rather than 1, as required in Theorem 1.2.1.
14 Chapter 1 The Real Numbers

Theorem 1.2.2 Let n0 be any integer .positive; negative; or zero/: Let Pn0; Pn0C1;
. . . ; Pn; . . . be propositions; one for each integer n n0; such that
(a) Pn0 is true I
(b) for each integer n n0; Pn implies PnC1:

Then Pn is true for every integer n n0:

Proof For m 1, let Qm be the proposition defined by Qm D PmCn0 1. Then Q1 D
Pn0 is true by (a). If m 1 and Qm D PmCn0 1 is true, then QmC1 D PmCn0 is true by
(b) with n replaced by m C n0 1. Therefore, Qm is true for all m 1 by Theorem 1.2.1

with P replaced by Q and n replaced by m. This is equivalent to the statement that Pn is

true for all n n0.

Example 1.2.5 Consider the proposition Pn that
                                              3n C 16 > 0:

If Pn is true, then so is PnC1, since
           3.n C 1/ C 16 D 3n C 3 C 16
                             D .3n C 16/ C 3 > 0 C 3 (by the induction assumption)
                             > 0:

The smallest n0 for which Pn0 is true is n0 D 5. Hence, Pn is true for n            5, by
Theorem 1.2.2.

Example 1.2.6 Let Pn be the proposition that
                                               nS 3n > 0:

If Pn is true, then   3nC1 D nS.n C 1/    3nC1
            .n C 1/S         > 3n.n C 1/  3nC1
                            D 3n.n 2/:
                                                (by the induction assumption)

Therefore, Pn implies PnC1 if n > 2. By trial and error, n0 D 7 is the smallest integer
such that Pn0 is true; hence, Pn is true for n 7, by Theorem 1.2.2.

The next theorem is a useful consequence of the principle of mathematical induction.

Theorem 1.2.3 Let n0 be any integer .positive; negative; or zero/: Let Pn0; Pn0C1;. . . ;
Pn; . . . be propositions; one for each integer n n0; such that
(a) Pn0 is true I
(b) for n n0; PnC1 is true if Pn0 ; Pn0C1;. . . ; Pn are all true.

Then Pn is true for n n0:
                                               Section 1.2 Mathematical Induction 15

Proof For n n0, let Qn be the proposition that Pn0 , Pn0C1, . . . , Pn are all true. Then
Qn0 is true by (a). Since Qn implies PnC1 by (b), and QnC1 is true if Qn and PnC1 are
both true, Theorem 1.2.2 implies that Qn is true for all n n0. Therefore, Pn is true for

all n n0.

Example 1.2.7 An integer p > 1 is a prime if it cannot be factored as p D rs where
r and s are integers and 1 < r , s < p. Thus, 2, 3, 5, 7, and 11 are primes, and, although 4,
6, 8, 9, and 10 are not, they are products of primes:

          4 D 2 2; 6 D 2 3; 8 D 2 2 2; 9 D 3 3; 10 D 2 5:

These observations suggest that each integer n 2 is a prime or a product of primes. Let

this proposition be Pn. Then P2 is true, but neither Theorem 1.2.1 nor Theorem 1.2.2

apply, since Pn does not imply PnC1 in any obvious way. (For example, it is not evident

from 24 D 2 2 2 3 that 25 is a product of primes.) However, Theorem 1.2.3 yields the

stated result, as follows. Suppose that n 2 and P2, . . . , Pn are true. Either n C 1 is a

prime or

                                 n C 1 D rs;                          (1.2.8)

where r and s are integers and 1 < r , s < n, so Pr and Ps are true by assumption. Hence, r
and s are primes or products of primes and (1.2.8) implies that n C 1 is a product of primes.
We have now proved PnC1 (that n C 1 is a prime or a product of primes). Therefore, Pn is
true for all n 2, by Theorem 1.2.3.

                             1.2 Exercises

Prove the assertions in Exercises 1.2.1-1.2.6 by induction.

1. The sum of the first n odd integers is n2.

2. 12 C 22 C  C n2 D n.n C 1/.2n C 1/ :
                                   6

3. 12 C 32 C  C .2n 1/2 D n.4n2 1/ :
                                       3

4. If a1, a2, . . . , an are arbitrary real numbers, then

              ja1 C a2 C C anj Ä ja1j C ja2j C               C janj:

5. If ai  0, i 1, then
               .1 C a1/.1 C a2/
                                 .1 C an/      1 C a1 C a2 C  C an:

6. If 0 Ä ai Ä 1, i 1, then

              .1 a1/.1 a2/ .1 an/ 1 a1 a2                     an:
16 Chapter 1 The Real Numbers

7. Suppose that s0 > 0 and sn D 1 e sn 1, n 1. Show that 0 < sn < 1, n 1.
8. Suppose that R > 0, x0 > 0, and

                                               1ÂR Ã
                                    xnC1 D 2 xn C xn ; n 0:

                                              p
      Prove: For n 1, xn > xnC1 > R and

                                             p 1 .x0 pR/2
                                      xn R Ä 2n x0 :

9. Find and prove by induction an explicit formula for an if a1 D 1 and, for n 1,

(a) anC1 D an                             (b) anC1 D 3an
                .n C 1/.2n C 1/                           .2n C 2/.2n C 3/

(c) anC1 D 2n C 1 an                                      Â 1 Ãn
                 nC1                      (d) anC1 D 1 C n an

10. Let a1 D 0 and anC1 D .n C 1/an for n      1, and let Pn be the proposition that
        an D nS

(a) Show that Pn implies PnC1.
(b) Is there an integer n for which Pn is true?

11. Let Pn be the proposition that

                            1C2C    C n D .n C 2/.n 1/ :
                                                     2

(a) Show that Pn implies PnC1.
(b) Is there an integer n for which Pn is true?

12. For what integers n is                 8n

                                    1  >       <

                                    nS .2n/S

Prove your answer by induction.

13. Let a be an integer 2.

(a) Show by induction that if n is a nonnegative integer, then n D aq C r , where
      q (quotient) and r (remainder) are integers and 0 Ä r < a.

(b) Show that the result of (a) is true if n is an arbitrary integer (not necessarily
      nonnegative).

(c) Show that there is only one way to write a given integer n in the form n D
      aq C r , where q and r are integers and 0 Ä r < a.

14. Take the following statement as given: If p is a prime and a and b are integers such
        that p divides the product ab, then p divides a or b.
                                            Section 1.2 Mathematical Induction 17

(a) Prove: If p, p1, . . . , pk are positive primes and p divides the product p1 pk ,
      then p D pi for some i in f1; : : : ; kg.

(b) Let n be an integer > 1. Show that the prime factorization of n found in
      Example 1.2.7 is unique in the following sense: If

                             n D p1 pr and n D q1q2 qs;

               where p1, . . . , pr , q1, . . . , qs are positive primes, then r D s and fq1; : : : ; qr g
               is a permutation of fp1; : : : ; pr g.

15. Let a1 D a2 D 5 and

                                        anC1 D an C 6an 1; n 2:
        Show by induction that an D 3n . 2/n if n 1.
16. Let a1 D 2, a2 D 0, a3 D 14, and

                                anC1 D 9an 23an 1 C 15an 2; n 3:
        Show by induction that an D 3n 1 5n 1 C 2, n 1.
17. The Fibonacci numbers fFng1 nD1 are defined by F1 D F2 D 1 and

                             FnC1 D Fn C Fn 1; n 2:

Prove by induction that

Fn D                         .1 C p5/n .1 p5/n
                                      p            ; n 1:
                                   2n 5

18. Prove by induction that

Z1                           y/r dy D nS
    yn.1                                 .r C 1/.r C 2/ .r C n C 1/

  0

if n is a nonnegative integer and r > 1. !

19. Suppose that m and n are integers, with 0 Ä m Ä n. The binomial coefficient n
                                                                                                        m

is the coefficient of tm in the expansion of .1 C t/n; that is,
                                             n!
                                .1 C t/n D  Xn m
                                                   t:
                                            mD0 m

From this definition it follows immediately that
                                !  !

                                n  n
                                0 D n D 1; n 0:

For convenience we define ! !

                             n        n
                             1 D n C 1 D 0; n 0:
18 Chapter 1 The Real Numbers

(a) Show that         !                   !         !
               nC1 D                    n      n
                                        mC                0 Ä m Ä n;
                 m                                    ;
                                             m1

and use this to show by induction on n that

                                  !

                               n        nS
                               m D mS.n m/S ;             0 Ä m Ä n:

(b) Show that

               n!                                          n!
               X                     n                    Xn
                  . 1/m                 D 0 and
               mD0 m                                                  D 2n:
                                                          mD0 m

(c) Show that                                               !
                                                          n xmyn m:
                                              Xn          m
                               .x C y/n D

                                                     mD0

(This is the binomial theorem.)

20. Use induction to find an nth antiderivative of log x, the natural logarithm of x.

21. Let f1.x1/ D g1.x1/ D x1. For n 2, let

fn.x1; x2; : : : ; xn/ D fn 1.x1; x2; : : : ; xn 1/ C 2n 2xn C
                             jfn 1.x1; x2; : : : ; xn 1/ 2n 2xnj

and

              gn.x1; x2; : : : ; xn/ D gn 1.x1; x2; : : : ; xn 1/ C 2n 2xn
                                           jgn 1.x1; x2; : : : ; xn 1/ 2n 2xnj:

        Find explicit formulas for fn.x1; x2; : : : ; xn/ and gn.x1; x2; : : : ; xn/.
22. Prove by induction that

                    sin x C sin 3x C C sin.2n 1/x D 1 cos 2nx ; n 1:
                                                                         2 sin x

        HINT: You will need trigonometric identities that you can derive from the identities

               cos.A B/ D cos A cos B C sin A sin B;
               cos.A C B/ D cos A cos B sin A sin B:

Take these two identities as given:
                                                           Section 1.3 The Real Line 19

23. Suppose that a1 Ä a2 Ä Ä an and b1 Ä b2 Ä              Ä bn. Let f`1; `2; : : : `ng be a
        permutation of f1; 2; : : : ; ng, and define

                                          Xn                 b`i /2:
                 Q.`1 ; `2; : : : ; `n/ D .ai

                                                     i D1

Show that

                   Q.`1; `2; : : : ; `n/ Q.1; 2; : : : ; n/:

1.3 THE REAL LINE

One of our objectives is to develop rigorously the concepts of limit, continuity, differen-
tiability, and integrability, which you have seen in calculus. To do this requires a better
understanding of the real numbers than is provided in calculus. The purpose of this section
is to develop this understanding. Since the utility of the concepts introduced here will not
become apparent until we are well into the study of limits and continuity, you should re-
serve judgment on their value until they are applied. As this occurs, you should reread the
applicable parts of this section. This applies especially to the concept of an open covering
and to the Heine-Borel and Bolzano-Weierstrass theorems, which will seem mysterious at
first.

   We assume that you are familiar with the geometric interpretation of the real numbers as
points on a line. We will not prove that this interpretation is legitimate, for two reasons: (1)
the proof requires an excursion into the foundations of Euclidean geometry, which is not
the purpose of this book; (2) although we will use geometric terminology and intuition in
discussing the reals, we will base all proofs on properties (A)-(I) (Section 1.1) and their
consequences, not on geometric arguments.

   Henceforth, we will use the terms real number system and real line synonymously and
denote both by the symbol R; also, we will often refer to a real number as a point (on the
real line).

Some Set Theory

In this section we are interested in sets of points on the real line; however, we will consider
other kinds of sets in subsequent sections. The following definition applies to arbitrary
sets, with the understanding that the members of all sets under consideration in any given
context come from a specific collection of elements, called the universal set. In this section
the universal set is the real numbers.

Definition 1.3.1 Let S and T be sets.

(a) S contains T , and we write S      T or T  S , if every member of T is also in S . In
      this case, T is a subset of S .

(b) S T is the set of elements that are in S but not in T .

(c) S equals T , and we write S D T , if S contains T and T contains S ; thus, S D T if
      and only if S and T have the same members.
20 Chapter 1 The Real Numbers

(d) S strictly contains T if S contains T but T does not contain S ; that is, if every
      member of T is also in S , but at least one member of S is not in T (Figure 1.3.1).

(e) The complement of S , denoted by S c , is the set of elements in the universal set that
      are not in S .

(f ) The union of S and T , denoted by S [ T , is the set of elements in at least one of S
      and T (Figure 1.3.1(b)).

(g) The intersection of S and T , denoted by S \ T , is the set of elements in both S and
      T (Figure 1.3.1(c)). If S \ T D ; (the empty set), then S and T are disjoint sets
      (Figure 1.3.1(d)).

(h) A set with only one member x0 is a singleton set, denoted by fx0g.

     S     T                              S                   T

           S T                            S  T = shaded region
            (a)                                     (b)

        S          T                         S                   T

        S  T = shaded region                    S  T = 
                  (c)                                    (d)

                            Figure 1.3.1

Example 1.3.1 Let

        °          «   °                                            «
     S D x0 < x < 1 ;  T D x  0 < x < 1 and x is rational ;

and                °                            «
                   U D x  0 < x < 1 and x is irrational :

   Then S T and S U , and the inclusion is strict in both cases. The unions of pairs of
these sets are

                        S [ T D S; S [ U D S; and T [ U D S;

and their intersections are

           S \ T D T; S \ U D U; and T \ U D ;:
                                                                   Section 1.3 The Real Line 21

Also,

                             S U D T and S T D U:

   Every set S contains the empty set ;, for to say that ; is not contained in S is to say that

some member of ; is not in S , which is absurd since ; has no members. If S is any set,

then
                                  .S c /c D S and S \ S c D ;:

If S is a set of real numbers, then S [ S c D R.

The definitions of un°ion and int«ersection have generalizations: If F is an arbitrary col-
lection of sets, then [  S   S   2  F   is «the set of all elements that are members of at least
                              °
one of the sets in F , and \ S  S 2 F is the set of all elements that are members of every

Sset in F . TheTunion and intersection of finitely many sets S1, . . . , Sn are also written as
n      Sk  and      n  Sk .  TheTunion  and  intersection  of  an  infinite  sequence  fSk g1 kD1  of  sets
kD1
                SkD1
                1                1
are written as kD1 Sk and kD1 Sk.

Example 1.3.2 If F is the collection of sets

                                 °                «
                         S D x  < x Ä 1 C ; 0 < Ä 1=2;

then

[°              « °                          «    \°                         « °                       «
       S  S 2 F D x  0 < x Ä 3=2 and                       S  S 2 F D x  1=2 < x Ä 1 :

Example 1.3.3 If, for each positive integer k, the set SSk is the set of real numbers
that can be wTritten as x D m= k for some integer m, then kD1 1 Sk is the set of rational
numbers and kD1 1 Sk is the set of integers.

Open and Closed Sets

If a and b are in the extended reals and a < b, then the open interval .a; b/ is defined by

                                             °                 «
                                    .a; b/ D x  a < x < b :

The open intervals .a; 1/ and . 1; b/ are semi-infinite if a and b are finite, and . 1; 1/
is the entire real line.

Definition 1.3.2 If x0 is a real number and > 0, then the open interval .x0 ; x0C /

is an -neighborhood of x0. If a set S contains an -neighborhood of x0, then S is a

neighborhood of x0, and x0 is an interior point of S (Figure 1.3.2). The set of interior
points of S is the interior of S , denoted by S 0. If every point of S is an interior point (that
is, S 0 D S ), then S is open. A set S is closed if S c is open.
22 Chapter 1 The Real Numbers

                                                                x0 -     x0 x0 +
                                                                  (                )

                                    S = four line segments
                                   x0 = interior point of S

                                   Figure 1.3.2

   The idea of neighborhood is fundamental and occurs in many other contexts, some of
which we will see later in this book. Whatever the context, the idea is the same: some defi-
nition of "closeness" is given (for example, two real numbers are "close" if their difference
is "small"), and a neighborhood of a point x0 is a set that contains all points sufficiently
close to x0.

Example 1.3.4 An open interval .a; b/ is an open set, because if x0 2 .a; b/ and
  Ä minfx0 a; b x0g, then

                                      .x0 ; x0 C / .a; b/:

The entire line R D . 1; 1/ is open, and therefore ; .D Rc/ is closed. However, ; is
also open, for to deny this is to say that ; contains a point that is not an interior point,
which is absurd because ; contains no points. Since ; is open, R .D ;c / is closed. Thus,
R and ; are both open and closed. They are the only subsets of R with this property
(Exercise 1.3.18).

A deleted neighborhood of a point x0 is a set that contains every point of some neigh-

borhood of x0 except for x0 itself. For example,

                                   °                                  «
                S D x  0 < jx x0j <

is a deleted neighborhood of x0. We also say that it is a deleted -neighborhood of x0.

Theorem 1.3.3
(a) The union of open sets is open:
(b) The intersection of closed sets is closed:
These statements apply to arbitrary collections, finite or infinite, of open and closed sets:

Proof  (a) Let G be a collection of open sets and

                                      °            «
                                   S D[ GG 2 G :

If x0 2 S , then x0 2 G0 for some G0 in G , and since G0 is open, it contains some -

neighborhood of x0. Since G0 S , this -neighborhood is in S , which is consequently a

neighborhood of x0. Thus, S is a neighborhood of each of its points, and therefore open,

by definition.                                                           °            «

°(b) Let F «be a collection of closed sets and T D \ F F 2 F . Then T D                  c

[ F c  F 2 F (Exercise 1.3.7) and, since each F c is open, T c is open, from (a). There-

fore, T is closed, by definition.
                                                    Section 1.3 The Real Line 23

Example 1.3.5 If 1 < a < b < 1, the set

                                              °  «
                         OEa; b D x  a Ä x Ä b

is closed, since its complement is the union of the open sets .  1; a/ and .b; 1/. We say

that OEa; b is a closed interval. The set

                                              °  «
                         OEa; b/ D x  a Ä x < b

is a half-closed or half-open interval if 1 < a < b < 1, as is

                                              °  «
                         .a; b D x  a < x Ä b I

however, neither of these sets is open or closed. (Why not?) Semi-infinite closed intervals

are sets of the form

                      °                    «        °            «
OEa; 1/ D x  a Ä x and . 1; a D x  x Ä a ;

where a is finite. They are closed sets, since their complements are the open intervals
. 1; a/ and .a; 1/, respectively.

   Example 1.3.4 shows that a set may be both open and closed, and Example 1.3.5 shows
that a set may be neither. Thus, open and closed are not opposites in this context, as they
are in everyday speech.

Example 1.3.6 From Theorem 1.3.3 and Example 1.3.4, the union of any collection of
open intervals is an open set. (In fact, it can be shown that every nonempty open subset of
R is the union of open intervals.) From Theorem 1.3.3 and Example 1.3.5, the intersection
of any collection of closed intervals is closed.

   It can be shown that the intersection of finitely many open sets is open, and that the
union of finitely many closed sets is closed. However, the intersection of infinitely many
open sets need not be open, and the union of infinitely many closed sets need not be closed
(Exercises 1.3.8 and 1.3.9).

Definition 1.3.4 Let S be a subset of R. Then
(a) x0 is a limit point of S if every deleted neighborhood of x0 contains a point of S .

(b) x0 is a boundary point of S if every neighborhood of x0 contains at least one point
      in S and one not in S . The set of boundary points of S is the boundary of S , denoted
      by @S . The closure of S , denoted by S , is S D S [ @S .

(c) x0 is an isolated point of S if x0 2 S and there is a neighborhood of x0 that contains
      no other point of S .

(d) x0 is exterior to S if x0 is in the interior of S c . The collection of such points is the
      exterior of S .

Example 1.3.7 Let S D . 1; 1 [ .1; 2/ [ f3g. Then
24 Chapter 1 The Real Numbers

(a) The set of limit points of S is . 1; 1 [ OE1; 2.
(b) @S D f 1; 1; 2; 3g and S D . 1; 1 [ OE1; 2 [ f3g.
(c) 3 is the only isolated point of S .
(d) The exterior of S is . 1; 1/ [ .2; 3/ [ .3; 1/.

Example 1.3.8 For n 1, let                                         [ 1
                                    Ä1 1             and S D In:

                             In D 2n C 1 ; 2n                           nD1

Then

(a) The set of limit points of S is S [ f0g.
      °                                        «
(b) @S D x  x D 0 or x D 1=n .n 2/ and S D S [ f0g.

(c) S has no isolated points.

(d) The exterior of S is

                               "1 Â                     Ã# Â Ã
                               [1                    1  1
         . 1; 0/ [                                ;     [ ;1 :
                               nD1 2n C 2 2n C 1 2

Example 1.3.9 Let S be the set of rational numbers. Since every interval contains a
rational number (Theorem 1.1.6), every real number is a limit point of S ; thus, S D R.
Since every interval also contains an irrational number (Theorem 1.1.7), every real number
is a boundary point of S ; thus @S D R. The interior and exterior of S are both empty, and
S has no isolated points. S is neither open nor closed.

   The next theorem says that S is closed if and only if S D S (Exercise 1.3.14).

Theorem 1.3.5 A set S is closed if and only if no point of S c is a limit point of S:

Proof Suppose that S is closed and x0 2 S c. Since S c is open, there is a neighborhood
of x0 that is contained in S c and therefore contains no points of S . Hence, x0 cannot be a
limit point of S . For the converse, if no point of S c is a limit point of S then every point in
S c must have a neighborhood contained in S c . Therefore, S c is open and S is closed.

   Theorem 1.3.5 is usually stated as follows.

Corollary 1.3.6 A set is closed if and only if it contains all its limit points:

   Theorem 1.3.5 and Corollary 1.3.6 are equivalent. However, we stated the theorem as
we did because students sometimes incorrectly conclude from the corollary that a closed
set must have limit points. The corollary does not say this. If S has no limit points, then
the set of limit points is empty and therefore contained in S . Hence, a set with no limit
points is closed according to the corollary, in agreement with Theorem 1.3.5. For example,
any finite set is closed. More generally, S is closed if there is a i > 0 such jx yj i for
every pair fx; yg of distinct points in S .
                                                                   Section 1.3 The Real Line 25

Open Coverings
A collection H of open sets is an open cover°ing of a set S« if every point in S is contained
in a set H belonging to H ; that is, if S [ H  H 2 H .

Example 1.3.10 The sets

                  S1 D OE0; 1; S2 D f1; 2; : : : ; n; : : : g;
                              11

                  S3 D 1; 2 ; : : : ; n ; : : : ; and S4 D .0; 1/

are covered by the families of open intervals

               Â                Ã
         H 1 1  1 D x ; x C  0 < x < 1 ;
                     N       N                                     (N D positive integer),

               Â             Ã
                     1       1
         H2 D  n        ;nC        n  D  1;  2;  :  :  :     ;
               ( 4 4 ! )        

         H3 D     1  1;  1           n  D  1;  2;   :  :  :     ;
                                   
                  nC2 n 2    1

and

           H4 D f.0; /j 0 < < 1g;
respectively.

Theorem 1.3.7 (Heine-Borel Theorem) If H is an open covering of a closed
and bounded subset S of the real line; then S has an open covering He consisting of finitely
many open sets belonging to H :

Proof Since S is bounded, it has an infimum  and a supremum , and, since S is
closed,  and  belong to S (Exercise 1.3.17). Define

                             St D S \ OE; t for t ;

and let           °                                                «
         F D t   Ä t Ä  and finitely many sets from H cover St :

Since S D S , the theorem will be proved if we can show that  2 F . To do this, we use
the completeness of the reals.

   Since  2 S , S is the singleton set fg, which is contained in some open set H from
H because H covers S ; therefore,  2 F . Since F is nonempty and bounded above by ,
it has a supremum . First, we wish to show that D . Since Ä  by definition of F ,
it suffices to rule out the possibility that < . We consider two cases.
26 Chapter 1 The Real Numbers

   CASE 1. Suppose that <  and 62 S . Then, since S is closed, is not a limit point
of S (Theorem 1.3.5). Consequently, there is an > 0 such that

OE ; C  \ S D ;;

so S D S C . However, the definition of implies that S  has a finite subcovering
from H , while S C does not. This is a contradiction.

   CASE 2. Suppose that <  and 2 S . Then there is an open set H in H that
contains and, along with , an interval OE ; C  for some positive . Since S has
a finite covering fH1; : : : ; Hng of sets from H , it follows that S C has the finite covering
fH1; : : : ; Hn; H g. This contradicts the definition of .

   Now we know that D , which is in S . Therefore, there is an open set H in H that
contains  and along with , an interval of the form OE ;  C , for some positive .
Since S is covered by a finite collection of sets fH1; : : : ; Hkg, S is covered by the
finite collection fH1; : : : ; Hk; H g. Since S D S , we are finished.

   Henceforth, we will say that a closed and bounded set is compact. The Heine-Borel
theorem says that any open covering of a compact set S contains a finite collection that
also covers S . This theorem and its converse (Exercise 1.3.21) show that we could just
as well define a set S of reals to be compact if it has the Heine-Borel property; that is, if
every open covering of S contains a finite subcovering. The same is true of Rn, which we
study in Section 5.1. This definition generalizes to more abstract spaces (called topological
spaces) for which the concept of boundedness need not be defined.

Example 1.3.11 Since S1 in Example 1.3.10 is compact, the Heine-Borel theorem
implies that S1 can be covered by a finite number of intervals from H1. This is easily veri-
fied, since, for example, the 2N intervals from H1 centered at the points xk D k=2N .0 Ä
k Ä 2N 1/ cover S1.

   The Heine-Borel theorem does not apply to the other sets in Example 1.3.10 since they
are not compact: S2 is unbounded and S3 and S4 are not closed, since they do not contain
all their limit points (Corollary 1.3.6). The conclusion of the Heine-Borel theorem does
not hold for these sets and the open coverings that we have given for them. Each point in
S2 is contained in exactly one set from H2, so removing even one of these sets leaves a
point of S2 uncovered. If He 3 is any finite collection of sets from H3, then

1 °                                              «
                               62 [ H  H 2 He 3
n

for n sufficiently large. Any finite collection f.0; 1/; : : : ; .0; n/g from H4 covers only the
interval .0; max/, where

                                      max D maxf 1; : : : ; ng < 1:

The Bolzano-Weierstrass Theorem

As an application of the Heine-Borel theorem, we prove the following theorem of Bolzano
and Weierstrass.
                                                     Section 1.3 The Real Line 27

Theorem 1.3.8 (Bolzano-Weierstrass Theorem) Every bounded infinite set
of real numbers has at least one limit point:

Proof We will show that a bounded nonempty set without a limit point can contain only

a finite number of points. If S has no limit points, then S is closed (Theorem 1.3.5) and

every point x of S has an open neighborhood Nx that contains no point of S other than x.

The collection              °                     «
                           H D Nx  x 2 S

is an open covering for S . Since S is also bounded, Theorem 1.3.7 implies that S can be

covered by a finite collection of sets from H , say Nx1, . . . , Nxn. Since these sets contain
only x1, . . . , xn from S , it follows that S D fx1; : : : ; xng.

                           1.3 Exercises

1. Find S \ T , .S \ T /c , S c \ T c, S [ T , .S [ T /c , and S c [ T c.
                                             °            «      °         «
(a) S D .0; 1/, T D 21 ; 23 (b) S D x x > 4 , T D x x < 92            2

(c) S D . 1; 1/, T D ; (d) S D . 1; 1/, T D .1; 1/

2. Let Sk D .1 1= k; 2 C 1= k, k 1. Find

      [ 1             \ 1       [ 1                   \ 1
(a) Sk          (b) Sk     (c) S ck             (d) S ck

kD1             kD1         kD1                      kD1

3. Prove: If A and B are sets and there is a set X such that A [ X D B [ X and

A \ X D B \ X, then A D B.

4. Find the largest such that S contains an -neighborhood of x0.

(a) x0 D 34 , S D 12 ; 1   (b) x0 D 23 , S D 21 ; 23

(c) x0 D 5, S D . 1; 1/ (d) x0 D 1, S D .0; 2/

5. Describe the following sets as open, closed, or neither, and find S 0, .S c /0, and
      .S 0/c .

(a) S D . 1; 2/ [ OE3; 1/  (b) S D . 1; 1/ [ .2; 1/
(c) S D OE 3; 2 [ OE7; 8         °                           «
                           (d) S D x  x D integer

6. Prove that .S \ T /c D S c [ T c and .S [ T /c D S c \ T c .

7. Let F be a collection of sets and define

                °           «                             °           «
                I D \ F  F 2 F and U D [ F  F 2 F :

Prove that (a) I c D [ °F c  F 2 F « and (b) U c D °\F c  F 2 F «.

8. (a) Show that the intersection of finitely many open sets is open.
28 Chapter 1 The Real Numbers

(b) Give an example showing that the intersection of infinitely many open sets
      may fail to be open.

9. (a) Show that the union of finitely many closed sets is closed.
     (b) Give an example showing that the union of infinitely many closed sets may
             fail to be closed.

10. Prove:

       (a) If U is a neighborhood of x0 and U V , then V is a neighborhood of x0.
                                                                      Tn

       (b) If U1, . . . , Un are neighborhoods of x0, so is iD1 Ui .
11. Find the set of limit points of S , @S , S , the set of isolated points of S , and the

        exterior of S .

(a) S D . 1; 2/ [ .2; 3/ [ f4g [.7; 1/

(b) S D fall integersg°                         «

(c) S D [ .n; n C 1/  n D integer
                °                                  «
(d) S D x  x D 1=n; n D 1; 2; 3; : : :

12. Prove: A limit point of a set S is either an interior point or a boundary point of S .

13. Prove: An isolated point of S is a boundary point of S c .

14. Prove:

(a) A boundary point of a set S is either a limit point or an isolated point of S .
(b) A set S is closed if and only if S D S .

15. Prove or disprove: A set has no limit points if and only if each of its points is
        isolated.

16. (a) Prove: If S is bounded above and  D sup S , then  2 @S .
       (b) State the analogous result for a set bounded below.

17. Prove: If S is closed and bounded, then inf S and sup S are both in S .

18. If a nonempty subset S of R is both open and closed, then S D R.

19. Let S be an arbitrary set. Prove: (a) @S is closed. (b) S 0 is open. (c) The exterior

of S is open. (d) The limit points of S form a closed set. (e) S D S .

20. Give counterexamples to the following false statements.

(a) The isolated points of a set form a closed set.

(b) Every open set contains at least two points.

(c) If S1 and S2 are arbitrary sets, then @.S1 [ S2/ D @S1 [ @S2.

(d) If S1 and S2 are arbitrary sets, then @.S1 \ S2/ D @S1 \ @S2.

(e) The supremum of a bounded nonempty set is the greatest of its limit points.

(f ) If S is any set, then @.@S / D @S .

(g) If S is any set, then @S D @S .

(h)  If     S1  and  S2  are  arbitrary  sets,  then  .S1  [  S2/0  D  S0   [  S20.

                                                                         1
                                               Section 1.3 The Real Line 29

21. Let S be a nonempty subset of R such that if H is any open covering of S , then S
        has an open covering He comprised of finitely many open sets from H . Show that
        S is compact.

22. A set S is. in a set T if S T S .

       (a) Prove: If S and T are sets of real numbers and S T , then S is dense in T
               if and only if every neighborhood of each point in T contains a point from S .

       (b) State how (a) shows that the definition given here is consistent with the re-
               stricted definition of a dense subset of the reals given in Section 1.1.

23. Prove:

(a)  .S1    \  S2/0  D  S0   \  S0   (b)  S0   [  S0   .S1 [ S2/0

                          1       2         1       2

24. Prove:

(a) @.S1 [ S2/ @S1 [ @S2             (b) @.S1 \ S2/ @S1 [ @S2

(c) @S @S                            (d) @S D @S c

(e) @.S T / @S [ @T
                                       CHAPTER 2

                                Differential Calculus of
                             Functions of One Variable

IN THIS CHAPTER we study the differential calculus of functions of one variable.
SECTION 2.1 introduces the concept of function and discusses arithmetic operations on
functions, limits, one-sided limits, limits at 1, and monotonic functions.
SECTION 2.2 defines continuity and discusses removable discontinuities, composite func-
tions, bounded functions, the intermediate value theorem, uniform continuity, and addi-
tional properties of monotonic functions.
SECTION 2.3 introduces the derivative and its geometric interpretation. Topics covered in-
clude the interchange of differentiation and arithmetic operations, the chain rule, one-sided
derivatives, extreme values of a differentiable function, Rolle's theorem, the intermediate
value theorem for derivatives, and the mean value theorem and its consequences.
SECTION 2.4 presents a comprehensive discussion of L'Hospital's rule.
SECTION 2.5 discusses the approximation of a function f by the Taylor polynomials of
f and applies this result to locating local extrema of f . The section concludes with the
extended mean value theorem, which implies Taylor's theorem.

2.1 FUNCTIONS AND LIMITS

In this section we study limits of real-valued functions of a real variable. You studied
limits in calculus. However, we will look more carefully at the definition of limit and prove
theorems usually not proved in calculus.

   A rule f that assigns to each member of a nonempty set D a unique member of a set Y
is a function from D to Y . We write the relationship between a member x of D and the
member y of Y that f assigns to x as

                                                y D f .x/:
The set D is the domain of f , denoted by Df . The members of Y are the possible values
of f . If y0 2 Y and there is an x0 in D such that f .x0/ D y0 then we say that f attains

                                                     30
                                          Section 2.1 Functions and Limits 31

or assumes the value y0. The set of values attained by f is the range of f . A real-valued
function of a real variable is a function whose domain and range are both subsets of the
reals. Although we are concerned only with real-valued functions of a real variable in this
section, our definitions are not restricted to this situation. In later sections we will consider
situations where the range or domain, or both, are subsets of vector spaces.

Example 2.1.1 The functions f , g, and h defined on . 1; 1/ by
                        f .x/ D x2; g.x/ D sin x; and h.x/ D ex

have ranges OE0; 1/, OE 1; 1, and .0; 1/, respectively.

Example 2.1.2 The equation

                            OEf .x/2 D x                         (2.1.1)

does not define a function except on the singleton set f0g. If x < 0, no real number satisfies
(2.1.1), while if x > 0, two real numbers satisfy (2.1.1). However, the conditions

                                   OEf .x/2 D x and f .x/ 0
                                                                      p

define a function f on Df D OE0; 1/ with values f .x/ D x. Similarly, the conditions

                                   OEg.x/2 D x and g.x/ Ä 0
                                                                       p

define a function g on Dg D OE0; 1/ with values g.x/ D x. The ranges of f and g are
OE0; 1/ and . 1; 0, respectively.

   It is important to understand that the definition of a function includes the specification
of its domain and that there is a difference between f , the name of the function, and f .x/,
the value of f at x. However, strict observance of these points leads to annoying verbosity,
such as "the function f with domain . 1; 1/ and values f .x/ D x." We will avoid this
in two ways: (1) by agreeing that if a function f is introduced without explicitly defining
Df , then Df will be understood to consist of all points x for which the rule defining
f .x/ makes sense, and (2) by bearing in mind the distinction between f and f .x/, but not
emphasizing it when itpwould be a nuisance to do so. For example, we will write "consider
the functionpf .x/ D 1 x2," rather than "consider the function f defined on OE 1; 1
by f .x/ D 1 x2," or "consider the function g.x/ D 1= sin x," rather than "consider
the function g defined for x ¤ k (k D integer) by g.x/ D 1= sin x." We will also write
f D c (constant) to denote the function f defined by f .x/ D c for all x.

Our definition of function is somewhat intuitive, but adequate for our purposes. More-

over, it is the working form of the definition, even if the idea is introduced more rigorously

to begin with. For a more precise definition, we first define the Cartesian product X Y

of two nonempty sets X and Y to be the set of all ordered pairs .x; y/ such that x 2 X and

y 2 Y ; thus,  X Y D .x; y/  x 2 X; y 2 Y :°«
32 Chapter 2 Differential Calculus of Functions of One Variable

A nonempty subset f of X Y is a function if no x in X occurs more than once as a first
member among the elements of f . Put another way, if .x; y/ and .x; y1/ are in f , then
y D y1. The set of x's that occur as first members of f is the of f . If x is in the domain
of f , then the unique y in Y such that .x; y/ 2 f is the value of f at x, and we write
y D f .x/. The set of all such values, a subset of Y , is the range of f .

Arithmetic Operations on Functions

Definition 2.1.1 If Df \Dg ¤ ;; then f C g; f g; and fg are defined on Df \Dg
by

                                    .f C g/.x/ D f .x/ C g.x/;
                                     .f g/.x/ D f .x/ g.x/;
and

                                         .fg/.x/ D f .x/g.x/:

The quotient f =g is defined by

                                    Âf Ã     f .x/
                                    g .x/ D g.x/

for x in Df \ Dg such that g.x/ ¤ 0:

                                 p                    p
Example 2.1.3 If f .x/ D 4 x2 and g.x/ D x 1; then Df D OE              2; 2 and

Dg D OE1; 1/; so f C g; f g; and fg are defined on Df \ Dg D OE1; 2 by

                                          p         p
     .f C g/.x/ D 4 x2 C x 1;
                                          p  p
     .f g/.x/ D 4 x2 x 1;

and  p                                    p  p

     .fg/.x/ D . 4 x2/. x 1/ D .4 x2/.x 1/:                                  (2.1.2)
                                                                     2; it does not
The quotient f =g is defined on .1; 2 by

                                 Âf Ã        r
                                                4 x2
                                    g .x/ D x 1 :

Although the last expression in (2.1.2) is also defined for 1 < x <
represent fg for such x; since f and g are not defined on . 1; 2.

Example 2.1.4 If c is a real number, the function cf defined by .cf /.x/ D cf .x/ can
be regarded as the product of f and a constant function. Its domain is Df . The sum and
product of n . 2/ functions f1, . . . , fn are defined by

                   .f1 C f2 C C fn/.x/ D f1.x/ C f2.x/ C C fn.x/
                                         Section 2.1 Functions and Limits 33

and                                                                                   (2.1.3)
                             .f1f2 fn/.x/ D f1.x/f2.x/ fn.x/            D fn, then (2.1.3)

on D D iD1 Tn Dfi , provided that D is nonempty. If f1 D f2 D
defines the nth power of f :

                                          .f n/.x/ D .f .x//n:

From these definitions, we can build the set of all polynomials

                   p.x/ D a0 C a1x C C anxn;

starting from the constant functions and f .x/ D x. The quotient of two polynomials is a

rational function                        C anxn
                                         C bmxm
                   r .x/ D a0 C a1x C            .bm ¤ 0/:
                             b0 C b1x C

The domain of r is the set of points where the denominator is nonzero.

Limits

The essence of the concept of limit for real-valued functions of a real variable is this: If L
is a real number, then limx!x0 f .x/ D L means that the value f .x/ can be made as close
to L as we wish by taking x sufficiently close to x0. This is made precise in the following
definition.

                     y

                                                                      y = f (x)

                L +

                   L

                 L -

                                                      x
                   x0 -  x0 x0 + 

                   Figure 2.1.1
34 Chapter 2 Differential Calculus of Functions of One Variable

Definition 2.1.2 We say that f .x/ approaches the limit L as x approaches x0, and
write

                                             lim f .x/ D L;

                                                               x!x0

if f is defined on some deleted neighborhood of x0 and, for every     > 0, there is a i > 0
such that                                                                              (2.1.4)

                                             jf .x/ Lj <

if

                                 0 < jx x0j < i:                              (2.1.5)

Figure 2.1.1 depicts the graph of a function for which limx!x0 f .x/ exists.

Example 2.1.5 If c and x are arbitrary real numbers and f .x/ D cx, then

                                  lim f .x/ D cx0:

                                 x!x0

To prove this, we write

                         jf .x/ cx0j D jcx cx0j D jcjjx x0j:

If c ¤ 0, this yields

                                 jf .x/ cx0j <                                      (2.1.6)
                                                                      cx0 D 0 for all x,
if
                                              jx x0j < i;

where i is any number such that 0 < i Ä =jcj. If c D 0, then f .x/
so (2.1.6) holds for all x.

   We emphasize that Definition 2.1.2 does not involve f .x0/, or even require that it be
defined, since (2.1.5) excludes the case where x D x0.

Example 2.1.6 If                                  1
                                 f .x/ D x sin x ; x ¤ 0;

then

                                 lim f .x/ D 0

                                 x!0

even though f is not defined at x0 D 0, because if

                                 0 < jxj < i D ;

then                              1             

                         jf .x/  0j D x sin  x      Ä      jxj  <  :
                                                

On the other hand, the function

                                               1
                                 g.x/ D sin x ; x ¤ 0;

has no limit as x approaches 0, since it assumes all values between   1 and 1 in every
neighborhood of the origin (Exercise 2.1.26).
                                  Section 2.1 Functions and Limits 35

The next theorem says that a function cannot have more than one limit at a point.

Theorem 2.1.3 If limx!x0 f .x/ exists; then it is unique I that is; if

                  lim f .x/ D L1 and lim f .x/ D L2;                               (2.1.7)
                  x!x0            x!x0

then L1 D L2:

Proof Suppose that (2.1.7) holds and let > 0. From Definition 2.1.2, there are positive
numbers i1 and i2 such that

                 jf .x/ Li j < if 0 < jx x0j < ii ; i D 1; 2:

If i D min.i1; i2/, then

      jL1 L2j D jL1 f .x/ C f .x/ L2j                         if 0 < jx x0j < i:
                   Ä jL1 f .x/j C jf .x/ L2j < 2

We have now established an inequality that does not depend on x; that is,

                                            jL1 L2j < 2 :

Since this holds for any positive , L1 D L2.
   Definition 2.1.2 is not changed by replacing (2.1.4) with

                          jf .x/ Lj < K ;                                          (2.1.8)

where K is a positive constant, because if either of (2.1.4) or (2.1.8) can be made to hold
for any > 0 by making jx x0j sufficiently small and positive, then so can the other
(Exercise 2.1.5). This may seem to be a minor point, but it is often convenient to work with
(2.1.8) rather than (2.1.4), as we will see in the proof of the following theorem.

A Useful Theorem about Limits

Theorem 2.1.4 If

                          lim f .x/ D L1 and lim g.x/ D L2;                        (2.1.9)
                  x!x0            x!x0
                                                                                  (2.1.10)
then                                                                              (2.1.11)
                                                                                  (2.1.12)
                           lim .f C g/.x/ D L1 C L2;                              (2.1.13)
                                                                                  (2.1.14)
                          x!x0

                           lim .f g/.x/ D L1 L2;

                          x!x0

                               lim .fg/.x/ D L1L2;

                                x!x0

and, if L2 ¤ 0,                Â f Ã L1

                          lim     .x/ D :
                          x!x0 g  L2
36 Chapter 2 Differential Calculus of Functions of One Variable

Proof From (2.1.9) and Definition 2.1.2, if > 0, there is a i1 > 0 such that

                                  jf .x/ L1j <                                      (2.1.15)

if 0 < jx x0j < i1, and a i2 > 0 such that

                                  jg.x/ L2j <                                       (2.1.16)

if 0 < jx x0j < i2. Suppose that

                             0 < jx x0j < i D min.i1; i2/;                          (2.1.17)

so that (2.1.15) and (2.1.16) both hold. Then

j.f  g/.x/                   .L1  L2/j D j.f .x/ L1/  .g.x/ L2/j
                                            Ä jf .x/ L1j C jg.x/ L2j < 2 ;

which proves (2.1.10) and (2.1.11).
   To prove (2.1.12), we assume (2.1.17) and write

j.f g/.x /  L1L2j D jf .x/g.x/ L1L2j
                    D jf .x/.g.x/ L2/ C L2.f .x/ L1/j
                    Ä jf .x/jjg.x/ L2j C jL2jjf .x/ L1j
                    Ä .jf .x/j C jL2j/ (from (2.1.15) and (2.1.16))
                    Ä .jf .x/ L1j C jL1j C jL2j/
                    Ä . C jL1j C jL2j/ from (2.1.15)
                    Ä .1 C jL1j C jL2j/

if < 1 and x satisfies (2.1.17). This proves (2.1.12).
   To prove (2.1.14), we first observe that if L2 ¤ 0, there is a i3 > 0 such that

so                                jg.x/ L2j < jL2j ;                                (2.1.18)
if                                                     2
To see this, let L D L2 and
                                      jg.x/j > jL2j
                                                    2

                                   0 < jx x0j < i3:
                             D jL2j=2 in (2.1.4). Now suppose that

                             0 < jx x0j < min.i1; i2; i3/;

so that (2.1.15), (2.1.16), and (2.1.18) all hold. Then
                                                     Section 2.1 Functions and Limits 37

Â Ã                       f .x/           
f                L1                   L1  
            .x/  L2  D  g.x/ L2 
  g

                         D jL2f .x/ L1g.x/j
                                   jg.x /L2 j

                               2               L1 g.x /j
                         Ä jL2j2 jL2f .x/

                               2               L1 C L1OEL2        g.x/j     (from (2.1.18))
                         D jL2j2 jL2OEf .x/

                               2                L1j C jL1jjL2        g.x/j
                         Ä jL2j2 OEjL2jjf .x/

                               2                    (from (2.1.15) and (2.1.16)):
                         Ä jL2j2 .jL2j C jL1j/

This proves (2.1.14).

   Successive applications of the various parts of Theorem 2.1.4 permit us to find limits
without the -i arguments required by Definition 2.1.2.

Example 2.1.7 Use Theorem 2.1.4 to find

                         lim  9 x2    and      lim .9     x2/.x C 1/:

                         x!2 x C 1             x!2

Solution If c is a constant, then limx!x0 c D c, and, from Example 2.1.5, limx!x0 x D
x0. Therefore, from Theorem 2.1.4,

                              lim .9  x2/ D lim 9 lim x2
                                               x!2        x!2
                              x!2

                                            D lim 9 . lim x/2
                                               x!2        x!2

                                            D 9 22 D 5;

and                      lim .x C 1/ D lim x C lim 1 D 2 C 1 D 3:
Therefore,             x!2            x!2       x!2

and                                9x     2 lim .9 x2/            5
                                               x!2
                              lim           D                  D
                              x!2 x C 1 lim .x C 1/ 3
                                               x!2

            lim .9       x2/.x C 1/ D lim .9 x2/ lim .x C 1/ D 5 3 D 15:
                                      x!2           x!2
            x!2

One-Sided Limits

The function                                            p
                                      f .x/ D 2x sin x
38 Chapter 2 Differential Calculus of Functions of One Variable

satisfies the inequality

                                  jf .x/j <

if 0 < x < i D =2. However, this does not mean that limx!0 f .x/ D 0, since f is
not defined for negative x, as it must be to satisfy the conditions of Definition 2.1.2 with
x0 D 0 and L D 0. The function

                          g.x/ D x C jxj ; x ¤ 0;
                                           x

can be rewritten as

                          g.x/ D x C 1; x > 0;
                                     x 1; x < 0I

hence, every open interval containing x0 D 0 also contains points x1 and x2 such that
jg.x1/ g.x2/j is as close to 2 as we please. Therefore, limx!x0 g.x/ does not exist
(Exercise 2.1.26).

   Although f .x/ and g.x/ do not approach limits as x approaches zero, they each exhibit
a definite sort of limiting behavior for small positive values of x, as does g.x/ for small
negative values of x. The kind of behavior we have in mind is defined precisely as follows.

                       y
                                                                  y = f (x)

                     µ

                     

                                        x0 x

                          lim f (x) =        lim f (x) = µ

                          x x0 -             x x0 +

                                  Figure 2.1.2

Definition 2.1.5
(a) We say that f .x/ approaches the left-hand limit L as x approaches x0 from the left,

      and write
                                                 lim f .x/ D L;

                                                                   x!x0

      if f is defined on some open interval .a; x0/ and, for each > 0, there is a i > 0
      such that

                                 jf .x/ Lj < if x0 i < x < x0:
                                                  Section 2.1 Functions and Limits 39

(b) We say that f .x/ approaches the right-hand limit L as x approaches x0 from the
      right, and write
                                                 lim f .x/ D L;

                                                                  x!x0 C

      if f is defined on some open interval .x0; b/ and, for each > 0, there is a i > 0
      such that

                                 jf .x/ Lj < if x0 < x < x0 C i:

   Figure 2.1.2 shows the graph of a function that has distinct left- and right-hand limits at
a point x0.

Example 2.1.8 Let                        x   x ¤ 0:
If x < 0, then f .x/ D x=x D  f .x/ D jxj ;
                              1, so

                                            lim f .x/ D 1:

                                                              x!0

If x > 0, then f .x/ D x=x D 1, so

                               lim f .x/ D 1:

                              x!0C

Example 2.1.9 Let

                   g.x/ D x C jxj.1 C x/ sin 1 ; x ¤ 0:
                              x                   x

If x < 0, then                                   1
so                            g.x/ D x sin x ;
since
                               lim g.x/ D 0;

                              x!0

                                  1             

                   jg.x/      0j D x sin     x    Ä                jxj  <
                                                

if < x < 0; that is, Definition 2.1.5(a) is satisfied with i D . If x > 0, then

                                                      1
                              g.x/ D .2 C x/ sin x ;

which takes on every value between 2 and 2 in every interval .0; i/. Hence, g.x/ does not
approach a right-hand limit at x approaches 0 from the right. This shows that a function
may have a limit from one side at a point but fail to have a limit from the other side.
40 Chapter 2 Differential Calculus of Functions of One Variable

Example 2.1.10 We leave it to you to verify that

                                  Â jxj Ã
                      lim          C x D 1;
                      x!0C x
                                  Â jxj Ã
                      lim          C x D 1;
                      x!0 x
                                   p
                                  lim x sin x D 0;
                      x!0C

                    p
and limx!0 sin x does not exist.

   Left- and right-hand limits are also called one-sided limits. We will often simplify the
notation by writing

                lim f .x/ D f .x0 / and lim f .x/ D f .x0C/:
                x!x0                  x!x0 C

   The following theorem states the connection between limits and one-sided limits. We
leave the proof to you (Exercise 2.1.12).

Theorem 2.1.6 A function f has a limit at x0 if and only if it has left- and right-hand
limits at x0; and they are equal. More specifically;

                                   lim f .x/ D L

                                  x!x0

if and only if

                      f .x0C/ D f .x0 / D L:

   With only minor modifications of their proofs (replacing the inequality 0 < jx x0j < i
by x0 i < x < x0 or x0 < x < x0 C i), it can be shown that the assertions of Theo-
rems 2.1.3 and 2.1.4 remain valid if "limx!x0 " is replaced by "limx!x0 " or "limx!x0C"
throughout (Exercise 2.1.13).

Limits at 1

Limits and one-sided limits have to do with the behavior of a function f near a limit point
of Df . It is equally reasonable to study f for large positive values of x if Df is unbounded
above or for large negative values of x if Df is unbounded below.

Definition 2.1.7 We say that f .x/ approaches the limit L as x approaches 1, and
write

                                             lim f .x/ D L;

                                                               x!1

if f is defined on an interval .a; 1/ and, for each > 0, there is a number  such that

                      jf .x/ Lj <     if x > :
                                                          Section 2.1 Functions and Limits 41
Figure 2.1.3 provides an illustration of the situation described in Definition 2.1.7.

              y

         L +
         L
         L -

                                                               lim f (x) = L
                                                                x 

                                                                                 x
                                         

                              Figure 2.1.3

   We leave it to you to define the statement "limx! 1 f .x/ D L" (Exercise 2.1.14) and
to show that Theorems 2.1.3 and 2.1.4 remain valid if x0 is replaced throughout by 1 or

  1 (Exercise 2.1.16).

Example 2.1.11 Let

       f .x/ D 1         12 ; g.x/ D  2jxj  ; and h.x/ D sin x:

                       x              1Cx

Then

                               lim f .x/ D 1;

                              x!1

since                                 1                  1
                    jf .x/ 1j D x2 <        if x > p ;

and
                                              lim g.x/ D 2;

                                                                x!1

since                   2x               2                           2             2
                                                                        if x > :
       jg.x/  2j    D         2 D           <<
                         1Cx          1Cx x

However, limx!1 h.x/ does not exist, since h assumes all values between 1 and 1 in any
semi-infinite interval . ; 1/.

   We leave it to you to show that limx! 1 f .x/ D 1, limx! 1 g.x/ D                  2, and
limx! 1 h.x/ does not exist (Exercise 2.1.17).
42 Chapter 2 Differential Calculus of Functions of One Variable

   We will sometimes denote limx!1 f .x/ and limx! 1 f .x/ by f .1/ and f . 1/,
respectively.

Infinite Limits

The functions         1           1                             1

                 f .x/ D x ; g.x/ D x2 ; p.x/ D sin x ;

and
                                                       11

                                            q.x/ D x2 sin x

do not have limits, or even one-sided limits, at x0 D 0. They fail to have limits in different
ways:

     f .x/ increases beyond bound as x approaches 0 from the right and decreases beyond
     bound as x approaches 0 from the left;
     g.x/ increases beyond bound as x approaches zero;
     p.x/ oscillates with ever-increasing frequency as x approaches zero;
     q.x/ oscillates with ever-increasing amplitude and frequency as x approaches 0.

   The kind of behavior exhibited by f and g near x0 D 0 is sufficiently common and
simple to lead us to define infinite limits.

Definition 2.1.8 We say that f .x/ approaches 1 as x approaches x0 from the left,
and write

                                lim f .x/ D 1 or f .x0 / D 1;

                                          x!x0

if f is defined on an interval .a; x0/ and, for each real number M , there is a i > 0 such
that

                                f .x/ > M if x0 i < x < x0:

Example 2.1.12 We leave it to you to define the other kinds of infinite limits (Exer-
cises 2.1.19 and 2.1.21) and show that

                        1                1
                  lim D 1;        lim D 1I
                 x!0 x           x!0C x

                      1        1                             1
                 lim 2 D lim 2 D lim 2 D 1I
                 x!0 x   x!0C x      x!0 x

                 lim x2 D lim x2 D 1I
                 x!1     x! 1

and

                 lim x3 D 1; lim x3 D 1:
                 x!1           x! 1
                                                       Section 2.1 Functions and Limits 43

   Throughout this book, "limx!x0 f .x/ exists" will mean that
                                 lim f .x/ D L; where L is finite.

                                              x!x0

To leave open the possibility that L D 1, we will say that

                               lim f .x/ exists in the extended reals.

                                          x!x0

This convention also applies to one-sided limits and limits as x approaches 1.

   We mentioned earlier that Theorems 2.1.3 and 2.1.4 remain valid if "limx!x0 " is re-
placed by "limx!x0 " or "limx!x0C." They are also valid with x0 replaced by 1.
Moreover, the counterparts of (2.1.10), (2.1.11), and (2.1.12) in all these versions of The-
orem 2.1.4 remain valid if either or both of L1 and L2 are infinite, provided that their
right sides are not indeterminate (Exercises 2.1.28 and 2.1.29). Equation (2.1.14) and its
counterparts remain valid if L1=L2 is not indeterminate and L2 ¤ 0 (Exercise 2.1.30).

Example 2.1.13 Results like Theorem 2.1.4 yield

     lim sinh x D lim ex e x D 1 lim ex                                    Á
     x!1                      x!1 2              2 x!1           lim e x

                                                                x!1

                              1
                           D 2 .1 0/ D 1;
                                      ex e x 1                                   Á
     lim sinh x D lim                            D      lim ex       lim e x
     x! 1                     x! 1 2                2
                                                       x! 1         x! 1

                              1
                           D 2 .0 1/ D 1;

and           x lim e x

           e               D  x!1         0
     lim                                 D D 0:
     x!1 x                       lim x 1
                                 x!1

Example 2.1.14 If                     f .x/ D e2x ex;

we cannot obtain limx!1 f .x/ by writing

                              lim f .x/ D lim e2x lim ex;
                           x!1           x!1           x!1

because this produces the indeterminate form 1 1. However, by writing

                                 f .x/ D e2x.1 e x /;

we find that                          Á   lim 1             Á       0/ D 1:
              lim f .x/ D   lim e2x               lim e x D 1.1
                                         x!1
                  x!1      x!1                   x!1
44 Chapter 2 Differential Calculus of Functions of One Variable

Example 2.1.15 Let                        2x2 x C 1
                               g.x/ D 3x2 C 2x 1 :

Trying to find limx!1 g.x/ by applying a version of Theorem 2.1.4 to this fraction as it is
written leads to an indeterminate form (try it!). However, by rewriting it as

                                    2 1=x C 1=x2              x ¤ 0;
                          g.x/ D 3 C 2=x 1=x2 ;

we find that

                          lim 2 lim 1=x C lim 1=x2                    2 0C0 2
                          x!1  x!1                    x!1
              lim g.x/ D                                          2D     D:
x!1                       lim 3 C lim 2=x lim 1=x 3 C 0 0 3

                          x!1  x!1                    x!1

Monotonic Function

A function f is nondecreasing on an interval I if

f .x1/ Ä f .x2/ whenever x1 and x2 are in I and x1 < x2;                       (2.1.19)

or nonincreasing on I if

f .x1/ f .x2/ whenever x1 and x2 are in I and x1 < x2:                         (2.1.20)

In either case, f is on I . If Ä can be replaced by < in (2.1.19), f is increasing on I . If
can be replaced by > in (2.1.20), f is decreasing on I . In either of these two cases, f is
strictly monotonic on I .

Example 2.1.16 The function                           0 Ä x < 1;
                                                (     1 Ä x Ä 2;
                                                  x;

                                     f .x/ D
                                                  2;

is nondecreasing on I D OE0; 2 (Figure 2.1.4), and f is nonincreasing on I D OE0; 2.

                                                        y

                          2

                          1

                                                                      x

                                    1                      2
                                                             Section 2.1 Functions and Limits 45
                                        Figure 2.1.4
The function g.x/ D x2 is increasing on OE0; 1/ (Figure 2.1.5),

                                              y

                                                                        y = x2
                                                                                                  x

                                        Figure 2.1.5
and h.x/ D x3 is decreasing on . 1; 1/ (Figure 2.1.6).

                                                             y

                                                                                                          x
                                                                                   y = -x3

                                        Figure 2.1.6
46 Chapter 2 Differential Calculus of Functions of One Variable

   In the proof of the following theorem, we assume that you have formulated the definitions
called for in Exercise 2.1.19.

Theorem 2.1.9 Suppose that f is monotonic on .a; b/ and define

 D inf f .x/ and  D sup f .x/:
                        a<x<b
                               a<x<b

(a) If f is nondecreasing; then f .aC/ D  and f .b / D :
(b) If f is nonincreasing; then f .aC/ D  and f .b / D :

      .Here aC D 1 if a D 1 and b D 1 if b D 1:/

(c) If a < x0 < b, then f .x0C/ and f .x0 / exist and are finite I moreover;

                               f .x0 / Ä f .x0/ Ä f .x0C/

if f is nondecreasing; and

                               f .x0 / f .x0/ f .x0C/

if f is nonincreasing:

Proof (a) We first show that f .aC/ D . If

   M > , there is an x0 in .a; b/ such that f .x0/ < M . Since f is nondecreasing,
f .x/ < M if a < x < x0. Therefore, if  D 1, then f .aC/ D 1. If  > 1, let
M D  C , where > 0. Then  Ä f .x/ <  C , so

                        jf .x/ j < if a < x < x0:                             (2.1.21)

If a D 1, this implies that f . 1/ D . If a > 1, let i D x0      a. Then (2.1.21) is
equivalent to

                               jf .x/ j < if a < x < a C i;

which implies that f .aC/ D .

   We now show that f .b / D . If M < , there is an x0 in .a; b/ such that f .x0/ > M .
Since f is nondecreasing, f .x/ > M if x0 < x < b. Therefore, if  D 1, then
f .b / D 1. If  < 1, let M D  , where > 0. Then  < f .x/ Ä , so

                        jf .x/ j < if x0 < x < b:                             (2.1.22)

If b D 1, this implies that f .1/ D . If b < 1, let i D b        x0. Then (2.1.22) is
equivalent to

                               jf .x/ j < if b i < x < b;

which implies that f .b / D .

  (b) The proof is similar to the proof of (a) (Exercise 2.1.34).
  (c) Suppose that f is nondecreasing. Applying (a) to f on .a; x0/ and .x0; b/ sepa-
rately shows that

f .x0 / D sup f .x/ and f .x0C/ D inf f .x/:
                                      x0 <x<b
a<x<x0
                                                         Section 2.1 Functions and Limits 47

However, if x1 < x0 < x2, then

                                f .x1/ Ä f .x0/ Ä f .x2/I

hence,

        f .x0 / Ä f .x0/ Ä f .x0C/:

We leave the case where f is nonincreasing to you (Exercise 2.1.34).

Limits Inferior and Superior

We now introduce some concepts related to limits. We leave the study of these concepts
mainly to the exercises.

   We say that f is bounded on a set S if there is a constant M < 1 such that jf .x/j Ä M
for all x in S .

Definition 2.1.10 Suppose that f is bounded on OEa; x0/, where x0 may be finite or 1.
For a Ä x < x0, define

                                Sf .xI x0/ D sup f .t/

                                                       xÄt <x0

and
                                        If .xI x0/ D inf f .t/:

                                                                                 xÄt <x0

Then the left limit superior of f at x0 is defined to be

        lim f .x/ D lim Sf .xI x0/;
        x!x0                                x!x0

and the left limit inferior of f at x0 is defined to be

        lim f .x/ D lim If .xI x0/:
        x!x0                                x!x0

(If x0 D 1, we define x0 D 1.)

Theorem 2.1.11 If f is bounded on OEa; x0/; then  D limx!x0                               f .x/ exists and is
the unique real number with the following properties W                                                (2.1.23)
(a) If > 0, there is an a1 in OEa; x0/ such that

                                    f .x/ <  C if a1 Ä x < x0:

(b) If > 0 and a1 is in OEa; x0/; then      for some x 2 OEa1; x0/:
                                  f .x/ > 

Proof Since f is bounded on OEa; x0/, Sf .xI x0/ is nonincreasing and bounded on
OEa; x0/. By applying Theorem 2.1.9(b) to Sf .xI x0/, we conclude that  exists (finite).

Therefore, if > 0, there is an a in OEa; x0/ such that

         =2 < Sf .xI x0/ <  C =2 if a Ä x < x0:                                           (2.1.24)
48 Chapter 2 Differential Calculus of Functions of One Variable

                                 °              «
Since Sf .xI x0/ is an upper bound of f .t/  x Ä t < x0 , f .x/ Ä Sf .xI x0/. Therefore,

the second inequality in (2.1.24) implies (2.1.23) with a1 D a. This proves (a). To prove

(b), let a1 be given and define x1 D max.a1; a/. Then the first inequality in (2.1.24)

implies that

                         Sf .x1I x0/ >  =2:                            (2.1.25)
                                 °                 «
Since Sf .x1I x0/ is the supremum of f .t/  x1 < t < x0 , there is an x in OEx1; x0/ such

that

                         f .x/ > Sf .x1I x0/ =2:

This and (2.1.25) imply that f .x/ >  . Since x is in OEa1; x0/, this proves (b).

  Now we show that there cannot be more than one real number with properties (a) and
(b). Suppose that 1 < 2 and 2 has property (b); thus, if > 0 and a1 is in OEa; x0/,
there is an x in OEa1; x0/ such that f .x/ > 2 . Letting D 2 1, we see that there
is an x in OEa1; b/ such that

                         f .x/ > 2 .2 1/ D 1;

so 1 cannot have property (a). Therefore, there cannot be more than one real number
that satisfies both (a) and (b).

   The proof of the following theorem is similar to this (Exercise 2.1.35).

Theorem 2.1.12 If f is bounded on OEa; x0/; then  D limx!x0            f .x/ exists and is
the unique real number with the following properties:

(a) If > 0; there is an a1 in OEa; x0/ such that

                         f .x/ >              if a1 Ä x < x0:

(b) If > 0 and a1 is in OEa; x0/; then        for some x 2 OEa1; x0/:
                                  f .x/ <  C

                                 2.1 Exercises

1. Each of the following conditions fails to define a function on any domain. State
      why.

      (a) sin f .x/ D x                       (b) ef .x/ D jxj

      (c) 1 C x2 C OEf .x/2 D 0               (d) f .x/OEf .x/ 1 D x2

2. If                    r                            x2 16 p 2
                            .x 3/.x C 2/
              f .x/ D                         and g.x/ D x 7 x 9;
                         x1

      find Df , Df g , Dfg , and Df =g .
                                           Section 2.1 Functions and Limits 49

3. Find Df .                            (b) f .x/ D p 1
     (a) f .x/ D tan x                                     1 j sin xj

     (c) f .x/ D 1                      (d) f .x/ D sin x
                      x.x 1/                              x

     (e) eOEf .x/2 D x; f .x/ 0

4. Find limx!x0 f .x/, and justify your answers with an -i proof.

(a) x2 C 2x C 1; x0 D 1                 (b)  x3 8    ; x0 D 2
         1
                                              x2
(c) 2 ; x0 D 0                               p
     x1                                 (d) x; x0 D 4

(e)  x3 1              C x; x0 D 1

     .x 1/.x 2/

5. Prove that Definition 2.1.2 is unchanged if Eqn. (2.1.4) is replaced by

                                 jf .x/ Lj < K ;

where K is any positive constant. (That is, limx!x0 f .x/ D L according to Defini-
tion 2.1.2 if and only if limx!x0 f .x/ D L according to the modified definition.)

6. Use Theorem 2.1.4 and the known limits limx!x0 x D x0, limx!x0 c D c to find

the indicated limits.                              Â1      1Ã
           x2 C 2x C 3                  (b) lim          x1

(a) lim 3                                    x!2 x C 1
     x!2 2x C 1

                x1                                 x8 1
(c) lim 3 2                             (d) lim 4

     x!1 x C x 2x                            x!1 x 1

7. Find limx!x0 f .x/ and limx!x0C f .x/, if they exist. Use -i proofs, where ap-

plicable, to justify your answers.

(a) x C jxj; x0 D 0              (b) x cos 1 C sin 1 C sin 1 ;     x0 D 0
         x                              x         x      jxj
                                    x2 C x 2
(c) x2jx 1j C x 2 ; x0 D 1       (d) p        ; x0 D 2
                                      xC2

8. Prove: If h.x/ 0 for a < x < x0 and limx!x0 h.x/ exists, then limx!x0 h.x/
          0. Conclude from this that if f2.x/ f1.x/ for a < x < x0, then

                         lim f2.x/ lim f1.x/
                        x!x0            x!x0

if both limits exist.
50 Chapter 2 Differential Calculus of Functions of One Variable

9. (a) Prove: If limx!x0 f .x/ exists, there is a constant M and a > 0 such that

°jf .x/j Ä M if 0 <« jx         x0j < . (We say then that f is bounded on
 x  0 < jx x0j < .)

(b) State similar results with "limx!x0 " replaced by "limx!x0 ."
(c) State similar results with "limx!x0 " replaced by "limx!x0C."

10. Suppose that limx!x0 f .x/ D L and n is a positive integer. Prove that limx!x0 OEf .x/n D
       Ln (a) by using Theorem 2.1.4 and induction; (b) directly from Definition 2.1.2.
        HINT: You will find Exercise 2.1.9 useful for .b/:p p

11. Prove: If limx!x0 f .x/ D L > 0, then limx!x0 f .x/ D L.

12. Prove Theorem 2.1.6.

13. (a) Using the hint stated after Theorem 2.1.6, prove that Theorem 2.1.3 remains
               valid with "limx!x0 " replaced by "limx!x0 ."

       (b) Repeat (a) for Theorem 2.1.4.

14. Define the statement "limx! 1 f .x/ D L."

15. Find limx!1 f .x/ if it exists, and justify your answer directly from Definition 2.1.7.

         1                            sin x                      sin x
(a) 2                           (b)  . > 0/                 (c)  . Ä 0/

     x C1                             jxj                         jxj

(d) e x sin x                   (e) tan x                   (f ) e x2 e2x

16. Theorems 2.1.3 and 2.1.4 remain valid with "limx!x0 " replaced throughout by
        "limx!1" ("limx! 1"). How would their proofs have to be changed?

17. Using the definition you gave in Exercise 2.1.14, show that
            Â               Ã
                      1                    (b) lim 2jxj D 2
(a) lim 1 2 D 1          x                     x! 1 1 C x
x! 1

       (c) lim sin x does not exist

                   x! 1

18. Find limx! 1 f .x/, if it exists, for each function in Exercise 2.1.15. Justify your
        answers directly from the definition you gave in Exercise 2.1.14.

19. Define

(a) lim f .x/ D 1 (b) lim f .x/ D 1                         (c) lim f .x/ D 1
x!x0                            x!x0 C
                                                                   x!x0 C

20. Find                                                 1
                      1                    (b) lim 3

       (a) lim 3                                x!0 x
              x!0C x

              1                                          1
(c) lim 6                                  (d) lim 6

     x!0C x                                     x!0 x
                                           (f ) lim
(e) lim                  1                                        1
     x!x0C .x            x0/2k                  x!x0 .x          x0/2kC1

(k D positive integer)
                                Section 2.1 Functions and Limits 51

21. Define                      (b) lim f .x/ D 1
       (a) lim f .x/ D 1
                                        x!x0
                    x!x0
                                            1
22. Find                        (b) lim 6
                    1
                                     x!0 x
       (a) lim 3                (d) lim
              x!0 x
                                     x!x0 .x
(c) lim       1                                         1
     x!x0 .x  x0/2k                                    x0/2kC1

(k D positive integer)

23. Define

(a) lim f .x/ D 1               (b) lim f .x/ D 1

        x!1                             x! 1

24. Find                        (b) lim x2k

(a) lim x2k                             x! 1

        x!1

(c) lim x2kC1                   (d) lim x2kC1

       x!1                              x! 1

(k=positive integer)            (f ) lim ex
(e) lim px sin x
                                       x!1
       x!1

25. Suppose that f and g are defined on .a; 1/ and .c; 1/ respectively, and that
        g.x/ > a if x > c. Suppose also that limx!1 f .x/ D L, where 1 Ä L Ä 1,
        and limx!1 g.x/ D 1. Show that limx!1 f .g.x// D L.

26. (a) Prove: limx!x0 f .x/ does not exist (finite) if for some 0 > 0, every deleted
               neighborhood of x0 contains points x1 and x2 such that

                                jf .x1/ f .x2/j 0:

(b) Give analogous conditions for the nonexistence of

              lim f .x/; lim f .x/; lim f .x/; and      lim f .x/:
            x!x0 C        x!x0  x!1
                                                       x! 1

27. Prove: If 1 < x0 < 1, then limx!x0 f .x/ exists in the extended reals if and
        only if limx!x0 f .x/ and limx!x0C f .x/ both exist in the extended reals and are
        equal, in which case all three are equal.

In Exercises 2.1.28-2.1.30 consider only the case where at least one of L1 and L2 is 1.

28. Prove: If limx!x0 f .x/ D L1, limx!x0 g.x/ D L2, and L1 C L2 is not indetermi-
        nate, then
                                         lim .f C g/.x/ D L1 C L2:

                                                         x!x0
52 Chapter 2 Differential Calculus of Functions of One Variable

29. Prove: If limx!1 f .x/ D L1, limx!1 g.x/ D L2, and L1L2 is not indeterminate,
        then
                                             lim .fg/.x/ D L1L2:

                                                               x!1

30. (a) Prove: If limx!x0 f .x/ D L1, limx!x0 g.x/ D L2 ¤ 0, and L1=L2 is not

          indeterminate, then             Â f Ã L1

                                     lim         .x/ D :
                                     x!x0 g            L2

(b) Show that it is necessary to assume that L2 ¤ 0 in(a) by considering f .x/ D
      sin x, g.x/ D cos x, and x0 D =2.

31. Find

                x3 C 2x C 3                            x3 C 2x C 3
(a) lim 4                                 (b) lim 4
x!0C 2x C 3x C 22                                  x!0 2x C 3x C 22

            2x4 C 3x2 C 2                               2x4 C 3x2 C 2
(c) lim 3                                 (d) lim 3

     x!1 x C 2x C 3                            x! 1 x C 2x C 3

(e) limx!1.ex2 ex/                        (f ) lim     x C px sin x

                                                   x!1 2x C e    x

32. Find limx!1 r .x/ and limx! 1 r .x/ for the rational function

                           r .x/ D a0 C a1x C      C anxn ;
                                     b0 C b1x C    C bmxm

where an ¤ 0 and bm ¤ 0.

33. Suppose that limx!x0 f .x/ exists for every x0 in .a; b/ and g.x/ D f .x/ except
        on a set S with no limit points in .a; b/. What can be said about limx!x0 g.x/ for
        x0 in .a; b/? Justify your answer.

34. Prove Theorem 2.1.9(b), and complete the proof of Theorem 2.1.9(b) in the case
        where f is nonincreasing.

35. Prove Theorem 2.1.12.

36. Show that if f is bounded on OEa; x0/, then

(a) lim f .x/ Ä lim f .x/.
                x!x0
          x!x0

(b) lim . f /.x/ D lim f .x/ and lim . f /.x/ D lim f .x/.
                               x!x0              x!x0
          x!x0                                                       x!x0

(c) lim f .x/ D lim f .x/ if and only if limx!x0 f .x/ exists, in which
          x!x0     x!x0

          case

                           lim f .x/ D lim f .x/ D lim f .x/:
                   x!x0                                x!x0
                                          x!x0

37. Suppose that f and g are bounded on OEa; x0/.
                                                   Section 2.2 Continuity 53

(a) Show that

                lim .f C g/.x/ Ä lim f .x/ C lim g.x/:
                x!x0              x!x0             x!x0

(b) Show that

                  lim .f C g/.x/       lim f .x/ C lim g.x/:

                x!x0              x!x0             x!x0

(c) State inequalities analogous to those in (a) and (b) for

                lim .f g/.x/ and lim .f g/.x/:
                                             x!x0
                x!x0

38. Prove: limx!x0 f .x/ exists (finite) if and only if for each > 0 there is a i > 0
        such that jf .x1/ f .x2/j < if x0 i < x1, x2 < x0. HINT: For sufficiency;
        show that f is bounded on some interval .a; x0/ and

                       lim f .x/ D lim f .x/:
                       x!0
                                       x!x0

        Then use Exercise 2.1.36.c/:

39. Suppose that f is bounded on an interval .x0; b. Using Definition 2.1.10 as a guide,
        define limx!x0C f .x/ (the right limit superior of f at x0) and limx!x0C f .x/ (the
        right limit inferior of f at x0). Then prove that they exist. HINT: Use Theorem 2.1.9:

40. Suppose that f is bounded on an interval .x0; b. Show that limx!x0C f .x/ D
        limx!x0C f .x/ if and only if limx!x0C f .x/ exists, in which case

                lim f .x/ D lim f .x/ D lim f .x/:
               x!x0 C                        x!x0 C
                               x!x0 C

41. Suppose that f is bounded on an open interval containing x0. Show that limx!x0 f .x/
        exists if and only if

lim f .x/ D lim f .x/ D lim f .x/ D lim f .x/;
x!x0                   x!x0 C
                                       x!x0          x!x0 C

in which case limx!x0 f .x/ is the common value of these four expressions.

2.2 CONTINUITY

In this section we study continuous functions of a real variable. We will prove some impor-
tant theorems about continuous functions that, although intuitively plausible, are beyond
the scope of the elementary calculus course. They are accessible now because of our better
understanding of the real number system, especially of those properties that stem from the
completeness axiom.
54 Chapter 2 Differential Calculus of Functions of One Variable

The definitions of

f .x0 / D lim f .x/; f .x0C/ D lim f .x/; and lim f .x/
               x!x0  x!x0 C                                      x!x0

do not involve f .x0/ or even require that it be defined. However, the case where f .x0/ is
defined and equal to one or more of these quantities is important.

Definition 2.2.1

(a) We say that f is continuous at x0 if f is defined on an open interval .a; b/ containing
      x0 and limx!x0 f .x/ D f .x0/.

(b) We say that f is continuous from the left at x0 if f is defined on an open interval
      .a; x0/ and f .x0 / D f .x0/.

(c) We say that f is continuous from the right at x0 if f is defined on an open interval
      .x0; b/ and f .x0C/ D f .x0/.

   The following theorem provides a method for determining whether these definitions are
satisfied. The proof, which we leave to you (Exercise 2.2.1), rests on Definitions 2.1.2,
2.1.5, and 2.2.1.

Theorem 2.2.2

(a) A function f is continuous at x0 if and only if f is defined on an open interval .a; b/
      containing x0 and for each > 0 there is a i > 0 such that

                     jf .x/ f .x0/j <                                  (2.2.1)

      whenever jx x0j < i:

(b) A function f is continuous from the right at x0 if and only if f is defined on an
      interval OEx0; b/ and for each > 0 there is a i > 0 such that (2.2.1) holds whenever
      x0 Ä x < x0 C i:

(c) A function f is continuous from the left at x0 if and only if f is defined on an interval
      .a; x0 and for each > 0

      there is a i > 0 such that (2.2.1) holds whenever x0 i < x Ä x0:

   From Definition 2.2.1 and Theorem 2.2.2, f is
   continuous at x0 if and only if

                                    f .x0 / D f .x0C/ D f .x0/
or, equivalently, if and only if it is continuous from the right and left at x0 (Exercise 2.2.2).

Example 2.2.1 Let f be defined on OE0; 2 by
                                   f .x/ D x2; 0 Ä x < 1;
                                               x C 1; 1 Ä x Ä 2
                                                                   Section 2.2 Continuity 55

(Figure 2.2.1); then

                            f .0C/ D 0 D f .0/;
                            f .1 / D 1 ¤ f .1/ D 2;
                            f .1C/ D 2 D f .1/;
                            f .2 / D 3 D f .2/:

Therefore, f is continuous from the right at 0 and 1 and continuous from the left at 2, but
not at 1. If 0 < x, x0 < 1, then

    jf .x/                  f .x0/j D jx2   x02j D jx x0j jx C x0j
                                     Ä 2jx  x0j < if jx x0j < =2:

Hence, f is continuous at each x0 in .0; 1/. If 1 < x, x0 < 2, then

                      jf .x/ f .x0/j D j.x C 1/ .x0 C 1/ D jx x0j
                                         < if jx x0j < :

Hence, f is continous at each x0 in .1; 2/.

                         y

                      3                        y = x + 1, 1  x  2

                      2

                      1        y = x2, 0  x < 1

                                                                     x

                            1               2

                               Figure 2.2.1

Definition 2.2.3 A function f is continuous on an open interval .a; b/ if it is continu-
ous at every point in .a; b/. If, in addition,

                               f .b / D f .b/                           (2.2.2)

or

                               f .aC/ D f .a/                           (2.2.3)
56 Chapter 2 Differential Calculus of Functions of One Variable

then f is continuous on .a; b or OEa; b/, respectively. If f is continuous on .a; b/ and
(2.2.2) and (2.2.3) both hold, then f is continuous on OEa; b. More generally, if S is a subset

of Df consisting of finitely or infinitely many disjoint intervals, then f is continuous on S
if f is continuous on every interval in S . (Henceforth, in connection with functions of one

variable, whenever we say "f is continuous on S " we mean that S is a set of this kind.)

Example 2.2.2 Let f .x/ D px, 0 Ä x < 1. Then

                             p                         if 0 Ä x < 2;
        jf .x/ f .0/j D x <

so f .0C/ D f .0/. If x0 > 0 and x 0, then

                     p  p                              jx x0j
jf .x/  f .x0/j D j x                                  x0j D p p
                                                       x C x0

           jx x0j                                      if jx x0j <    px0;
        Äp <

                x0

so limx!x0 f .x/ D f .x0/. Hence, f is continuous on OE0; 1/.

Example 2.2.3 The function

                                                           1
                                             g.x/ D sin x
is continuous on S D nD 1 S1 .n; n C 1/. However, g is not continuous at any x0 D n
(integer), since it is not defined at such points.

   The function f defined in Example 2.2.1 (see also Figure 2.2.1) is continuous on OE0; 1/
and OE1; 2, but not on any open interval containing 1. The discontinuity of f there is of the
simplest kind, described in the following definition.

Definition 2.2.4 A function f is piecewise continuous on OEa; b if                    has a
(a) f .x0C/ exists for all x0 in OEa; b/;
(b) f .x0 / exists for all x0 in .a; b;
(c) f .x0C/ D f .x0 / D f .x0/ for all but finitely many points x0 in .a; b/.
If (c) fails to hold at some x0 in .a; b/, f has a jump discontinuity at x0. Also, f
jump discontinuity at a if f .aC/ ¤ f .a/ or at b if f .b / ¤ f .b/.

Example 2.2.4 The function                             x D 0;
                                               8       0 < x < 1;
                                               ^^ 1;   x D 1;
                                               ^^^ x;  1 < x Ä 2;
                                               ^<      2 < x < 3;
                                                       x D 3;
                                    f .x/ D 2;
                                               ^^ x;
                                               ^^^ 1;
                                               ^:
                                                   0;

(Figure 2.2.2) is the graph of a piecewise continuous function on OE0; 3, with jump discon-
tinuities at x0 D 0, 1, 2, and 3.
                                                                Section 2.2 Continuity 57

                  y

                 3

                 2

                 1

                                                                    x

                     1                2          3

                 -1

                        Figure 2.2.2

   The reason for the adjective "jump" can be seen in Figures 2.2.1 and 2.2.2, where the
graphs exhibit a definite jump at each point of discontinuity. The next example shows that
not all discontinuities are of this kind.

Example   2.2.5  The function
                             f .x/ D
                                      8          x ¤ 0;
                                      ^<sin 1 ;  x D 0;

                                            x
                                      ^:

                                        0;

is continuous at all x0 except x0 D 0. As x approaches 0 from either side, f .x/ oscillates
between 1 and 1 with ever-increasing frequency, so neither f .0C/ nor f .0 / exists.
Therefore, the discontinuity of f at 0 is not a jump discontinuity, and if > 0, then f is
not piecewise continuous on any interval of the form OE ; 0, OE ; , or OE0; .

Theorems 2.1.4 and 2.2.2 imply the next theorem (Exercise 2.2.18).

Theorem 2.2.5 If f and g are continuous on a set S; then so are f C g; f  g; and
fg: In addition; f =g is continuous at each x0 in S such that g.x0/ ¤ 0:

Example 2.2.6 Since the constant functions and the function f .x/ D x are continu-

ous for all x, successive applications of the various parts of Theorem 2.2.5 imply that the

function                          9 x2
                        r .x/ D x C 1
58 Chapter 2 Differential Calculus of Functions of One Variable

is continuous for all x except x D 1 (see Example 2.1.7). More generally, by starting
from Theorem 2.2.5 and using

   induction, it can be shown that if f1, f2, . . . , fn are continuous on a set S , then so are
f1 C f2 C C fn and f1f2 fn. Therefore, any rational function

                        r .x/ D a0 C a1x C    C anxn      .bm ¤ 0/
                                  b0 C b1x C  C bmxm

is continuous for all values of x except those for which its denominator vanishes.

Removable Discontinuities

Let f be defined on a deleted neighborhood of x0 and discontinuous (perhaps even unde-

fined) at x0. We say that f has a at x0 if limx!x0 f .x/ exists. In this case, the function

                        8                     if x 2 Df and x ¤ x0;
                        <f .x/

                      g.x/ D : lim f .x/      if x D x0;

                                       x!x0

is continuous at x0.

Example 2.2.7 The function

                                                 1
                                f .x/ D x sin x

is not defined at x0 D 0, and therefore certainly not continuous there, but limx!0 f .x/ D 0
(Example 2.1.6). Therefore, f has a removable discontinuity at 0.

The function                                   1
                                f1.x/ D sin x

is undefined at 0 and its discontinuity there is not removable, since limx!0 f1.x/ does not

exist (Example 2.2.5).

Composite Functions

We have seen that the investigation of limits and continuity can be simplified by regarding a
given function as the result of addition, subtraction, multiplication, and division of simpler
functions. Another operation useful in this connection is composition of functions; that is,
substitution of one function into another.

Definition 2.2.6 Suppose that f and g are functions with domains Df and Dg . If
Dg has a nonempty subset T such that g.x/ 2 Df whenever x 2 T , then the composite
function f i g is defined on T by

                                        .f i g/.x/ D f .g.x//:
                                                                Section 2.2 Continuity 59

Example 2.2.8 If

                           f .x/ D log x and               1
                                              g.x/ D 1 x2 ;

then                                                °           «
                  Df D .0; 1/ and Dg D x  x ¤ 1 :

Since g.x/ > 0 if x 2 T D . 1; 1/, the composite function f i g is defined on . 1; 1/ by

                                                    1
                           .f i g/.x/ D log 1 x2 :

We leave it to you to verify that g i f is defined on .0; 1=e/ [ .1=e; e/ [ .e; 1/ by

                                                   1
                           .g i f /.x/ D 1 .log x/2 :

The next theorem says that the composition of continuous functions is continuous.

Theorem 2.2.7 Suppose that g is continuous at x0; g.x0/ is an interior point of Df ;
and f is continuous at g.x0/: Then f i g is continuous at x0:

Proof Suppose that > 0. Since g.x0/ is an interior point of Df and f is continuous
at g.x0/, there is a i1 > 0 such that f .t/ is defined and

      jf .t/ f .g.x0//j < if jt g.x0/j < i1:                                           (2.2.4)

Since g is continuous at x0, there is a i > 0 such that g.x/ is defined and

                           jg.x/ g.x0/j < i1 if jx x0j < i:                            (2.2.5)

Now (2.2.4) and (2.2.5) imply that

      jf .g.x// f .g.x0//j < if jx x0j < i:

Therefore, f i g is continuous at x0.
   See Exercise 2.2.22 for a related result concerning limits.

Example 2.2.9 In Examples 2.2.2 and 2.2.6 we saw that the function
                                                         p

                                               f .x/ D x

is continuous for x > 0, and the function

                                              9 x2
                                    g.x/ D x C 1

is continuous for x ¤ 1. Since g.x/ > 0 if x < 3 or             1 < x < 3, Theorem 2.2.7

implies that the function                     s

                           .f i g/.x/ D          9 x2
                                                 xC1

is continuous on . 1; 3/ [ . 1; 3/. It is also continuous from the left at 3 and 3.
60 Chapter 2 Differential Calculus of Functions of One Variable

Bounded Functions
A function f is bounded below on a set S if there is a real number m such that

                               f .x/ m for all x 2 S:

In this case, the set          °                 «
                               V D f .x/  x 2 S

has an infimum , and we write

                                D inf f .x/:

                                       x2S

If there is a point x1 in S such that f .x1/ D , we say that  is the minimum of f on S ,
and write

                                              D min f .x/:

                                                                         x2S

Similarly, f is bounded above on S if there is a real number M such that f .x/ Ä M for
all x in S . In this case, V has a supremum , and we write

                                              D sup f .x/:

                                                                         x2S

If there is a point x2 in S such that f .x2/ D , we say that  is the maximum of f on S ,
and write

                                              D max f .x/:

                                                                         x2S

If f is bounded above and below on a set S , we say that f is bounded on S .

   Figure 2.2.3 illustrates the geometric meaning of these definitions for a function f
bounded on an interval S D OEa; b. The graph of f lies in the strip bounded by the
lines y D M and y D m, where M is any upper bound and m is any lower bound
for f on OEa; b. The narrowest strip containing the graph is the one bounded above by
y D  D supaÄxÄb f .x/ and below by y D  D infaÄxÄb f .x/.

                       y

                                                                 y = M
                                                                 y = 

                                                                 y = 

                                                                 y = m
                                                                        x

                               Figure 2.2.3
                                                               Section 2.2 Continuity 61

Example 2.2.10 The function                    x D 0 or     x D 1;
                                      2 ( 1 ;  0 < x < 1;             C

                            g.x/ D
                                        1 x;

(Figure 2.2.4(a)) is bounded on OE0; 1, and

                        sup g.x/ D 1; inf g.x/ D 0:
                                               0ÄxÄ1
                   0ÄxÄ1

Therefore, g has no maximum or minimum on OE0; 1, since it does not assume either of the
values 0 and 1.

The function

                        h.x/ D 1 x; 0 Ä x Ä 1;

which differs from g only at 0 and 1 (Figure 2.2.4(b)), has the same supremum and infi-
mum as g, but it attains these values at x D 0 and x D 1, respectively; therefore,

                   max h.x/ D 1 and min h.x/ D 0:
              0ÄxÄ1                            0ÄxÄ1

   y                                                        y

1                                                           1
                                                                         y = 1 - x
1             y = g(x)

2

                                    x                                                     x
                   1                                                     1

              (a)                                              (b)

                          Figure 2.2.4

Example 2.2.11 The function                                 0 < x < 1;
                           f .x/ D ex.x 1/ sin 1 ;
                                                    x.x 1/

oscillates between ex.x 1/ infinitely often in every interval of the form .0; / or .1 ; 1/,
where 0 < < 1, and

                   sup f .x/ D 1; inf f .x/ D 1:
                                               0<x<1
                   0<x<1

However, f does not assume these values, so f has no maximum or minimum on .0; 1/.
62 Chapter 2 Differential Calculus of Functions of One Variable

Theorem 2.2.8 If f is continuous on a finite closed interval OEa; b; then f is bounded
on OEa; b:

Proof Suppose that t 2 OEa; b. Since f is continuous at t, there is an open interval It
containing t such that

              jf .x/ f .t/j < 1 if x 2 It \ OEa; b:                                  (2.2.6)

                                                                 °                   «
(To see this, set D 1 in (2.2.1), Theorem 2.2.2.) The collection H D It  a Ä t Ä b is

an open covering of OEa; b. Since OEa; b is compact, the Heine-Borel theorem implies that

there are finitely many points t1, t2, . . . , tn such that the intervals It1 , It2 , . . . , Itn cover

OEa; b. According to (2.2.6) with t D ti ,

              jf .x/ f .ti /j < 1 if x 2 Iti \ OEa; b:

Therefore,

     jf .x/j D j.f .x/ f .ti // C f .ti /j Ä jf .x/ f .ti /j C jf .ti /j             (2.2.7)
             Ä 1 C jf .ti /j if x 2 Iti \ OEa; b:

Let

Since OEa; b                        M D 1 C max jf .ti /j:

                                                                1Äi Än

              iD1 Sn Iti \ OEa; b , (2.2.7) implies that jf .x/j Ä M if x 2 OEa; b.

This proof illustrates the utility of the Heine-Borel theorem, which allows us to choose

M as the largest of a finite set of numbers.

Theorem 2.2.8 and the completeness of the reals imply that

   if f is continuous on a finite closed interval OEa; b, then f has an infimum and a supre-
mum on OEa; b. The next theorem shows that f actually assumes these values at some
points in OEa; b.

Theorem 2.2.9 Suppose that f is continuous on a finite closed interval OEa; b: Let

               D inf f .x/ and  D sup f .x/:
              aÄxÄb
                                              aÄxÄb

Then  and  are respectively the minimum and maximum of f on OEa; bI that is; there are
points x1 and x2 in OEa; b such that

              f .x1/ D  and f .x2/ D :

Proof We show that x1 exists and leave it to you to show that x2 exists (Exercise 2.2.24).
   Suppose that there is no x1 in OEa; b such that f .x1/ D . Then f .x/ >  for all

x 2 OEa; b. We will show that this leads to a contradiction.
   Suppose that t 2 OEa; b. Then f .t/ > , so

                                        f .t/ > f .t/ C  > :
                                                       2
                                                                 Section 2.2 Continuity 63

Since f is continuous at t, there is an open interval It about t such that

                    f .x/ > f .t/ C  if x 2 It \ OEa; b                              (2.2.8)
                                   2

                                     °                      «
(Exercise 2.2.15). The collection H D It  a Ä t Ä b is an open covering of OEa; b. Since

OEa; b is compact, the Heine-Borel theorem implies that there are finitely many points t1,

t2, . . . , tn such that the intervals It1 , It2 , . . . , Itn cover OEa; b. Define

                    1 D min f .ti / C  :
                                     1Äi Än     2

Then, since OEa; b  iD1 Sn .Iti \ OEa; b/, (2.2.8) implies that

                    f .t/ > 1; a Ä t Ä b:

But 1 > , so this contradicts the definition of . Therefore, f .x1/ D  for some x1 in
OEa; b.

Example 2.2.12 We used the compactness of OEa; b in the proof of Theorem 2.2.9
when we invoked the Heine-Borel theorem. To see that compactness is essential to the
proof, consider the function

                                                 1
                    g.x/ D 1 .1 x/ sin x ;

which is continuous and has supremum 2 on the noncompact interval .0; 1, but does not

assume its supremum on .0; 1, since

                                        
                                         1
                    g.x/ Ä 1 C .1    x/ sin     
                                             x  

                    Ä 1 C .1 x/ < 2 if 0 < x Ä 1:

As another example, consider the function
                                              f .x/ D e x;

which is continuous and has infimum 0, which it does not attain, on the noncompact interval
.0; 1/.

   The next theorem shows that if f is continuous on a finite closed interval OEa; b, then f
assumes every value between f .a/ and f .b/ as x varies from a to b (Figure 2.2.5, page 64).

Theorem 2.2.10 (Intermediate Value Theorem) Suppose that f is con-
tinuous on OEa; b; f .a/ ¤ f .b/; and is between f .a/ and f .b/: Then f .c/ D for
some c in .a; b/:
64 Chapter 2 Differential Calculus of Functions of One Variable

                   y
                                                                                        y = f (x)

                                                                                                           y = µ

a                                            b                                                                    x

                             x

                             Figure 2.2.5

Proof Suppose that f .a/ < < f .b/. The set
                    °                           «
   S D x  a Ä x Ä b and f .x/ Ä

is bounded and nonempty. Let c D sup S . We will show that f .c/ D . If f .c/ > ,
then c > a and, since f is continuous at c, there is an > 0 such that f .x/ > if
c < x Ä c (Exercise 2.2.15). Therefore, c is an upper bound for S , which
contradicts the definition of c as the supremum of S . If f .c/ < , then c < b and there is
an > 0 such that f .x/ < for c Ä x < c C , so c is not an upper bound for S . This is
also a contradiction. Therefore, f .c/ D .

   The proof for the case where f .b/ < < f .a/ can be obtained by applying this result
to f .

Uniform Continuity

   Theorem 2.2.2 and Definition 2.2.3 imply that a
   function f is continuous on a subset S of its domain if for each > 0 and each x0 in S ,
there is a i > 0, which may depend upon x0 as well as , such that

                   jf .x/ f .x0/j < if jx x0j < i and x 2 Df :

The next definition introduces another kind of continuity on a set S .

Definition 2.2.11 A function f is uniformly continuous on a subset S of its domain
if, for every > 0, there is a i > 0 such that

                  jf .x/ f .x0/j < whenever jx x0j < i and x; x0 2 S:

   We emphasize that in this definition i depends only on and S and not on the particular
choice of x and x0, provided that they are both in S .

Example 2.2.13 The function

                             f .x/ D 2x
                                                           Section 2.2 Continuity 65

is uniformly continuous on . 1; 1/, since             if jx x0j < =2:
                     jf .x/ f .x0/j D 2jx x0j <

Example 2.2.14 If 0 < r < 1, then the function
                                                g.x/ D x2

is uniformly continuous on OE r; r . To see this, note that
               jg.x/ g.x0/ D jx2 .x0/2j D jx x0j jx C x0j Ä 2r jx x0j;

so

    jg.x/ g.x0/j <     if jx x0j < i D                2r   and r Ä x; x0 Ä r:

   Often a concept is clarified by considering its negation: a function f is not uniformly

continuous on S if there is an 0 > 0 such that if i is any positive number, there are points
x and x0 in S such that

                       jx x0j < i but jf .x/ f .x0/j 0:

Example 2.2.15 The function g.x/ D x2 is uniformly continuous on OE r; r for any
finite r (Example 2.2.14), but not on . 1; 1/. To see this, we will show that if i > 0
there are real numbers x and x0 such that

                           jx x0j D i=2 and jg.x/ g.x0/j 1:

To this end, we write

              jg.x/ g.x0/j D jx2 .x0/2j D jx x0j jx C x0j:

If jx x0j D i=2 and x; x0 > 1=i, then

                       jx x0j jx C x0j >  i Â1 1Ã
                                                      C D 1:
                                          2i i

Example 2.2.16 The function

                                            1
                             f .x/ D cos x

is continuous on .0; 1 (Exercise 2.2.23(i)). However, f is not uniformly continuous on

.0; 1, since  Â Ã         Â               Ã
              1                        1
              f        f                           D  2;   n D 1; 2; : : : :
                             .n C 1/             
                    n

   Examples 2.2.15 and 2.2.16 show that a function may be continuous but not uniformly
continuous on an interval. The next theorem shows that this cannot happen if the interval
is closed and bounded, and therefore compact.
66 Chapter 2 Differential Calculus of Functions of One Variable

Theorem 2.2.12 If f is continuous on a closed and bounded interval OEa; b; then f
is uniformly continuous on OEa; b:

Proof Suppose that > 0. Since f is continuous on OEa; b, for each t in OEa; b there is
a positive number it such that

            jf .x/ f .t/j < 2 if jx tj < 2it and                  x 2 OEa; b:  (2.2.9)

If It D .t  it ; t C it /, the collection

                                           °                «
                               H D It  t 2 OEa; b

is an open covering of OEa; b. Since OEa; b is compact, the Heine-Borel theorem implies that

there are finitely many points t1, t2, . . . , tn in OEa; b such that It1 , It2 , . . . , Itn cover OEa; b.

Now define

                               i D minfit1 ; it2; : : : ; itn g:               (2.2.10)

We will show that if

                         jx x0j < i and       x; x0 2 OEa; b;                  (2.2.11)

then jf .x/ f .x0/j < .

From the triangle inequality,

            jf .x/ f .x0/j D j .f .x/ f .tr // C .f .tr / f .x0// j            (2.2.12)
                               Ä jf .x/ f .tr /j C jf .tr / f .x0/j:

Since It1 , It2 , . . . , Itn cover OEa; b, x must be in one of these intervals. Suppose that x 2 Itr ;

that is,

                                           jx tr j < itr :                     (2.2.13)

From (2.2.9) with t D tr ,                                                     (2.2.14)
                                          jf .x/ f .tr /j < 2 :

From (2.2.11), (2.2.13), and the triangle inquality,

          jx0 tr j D j.x0 x/ C .x tr /j Ä jx0 xj C jx tr j < i C itr Ä 2itr :

Therefore, (2.2.9) with t D tr and x replaced by x0 implies that

                                         jf .x0/ f .tr /j < :
                                                                 2

This, (2.2.12), and (2.2.14) imply that jf .x/ f .x0/j < .

   This proof again shows the utility of the Heine-Borel theorem, which allowed us to
define i in (2.2.10) as the smallest of a finite set of positive numbers, so that i is sure to be
positive. (An infinite set of positive numbers may fail to have a smallest positive member;
for example, consider the open interval .0; 1/.)

Corollary 2.2.13 If f is continuous on a set T; then f is uniformly continuous on
any finite closed interval contained in T:
                                                               Section 2.2 Continuity 67

   Applied to Example 2.2.16, Corollary 2.2.13 implies that the function g.x/ D cos 1=x
is uniformly continuous on OE ; 1 if 0 < < 1.

More About Monotonic Functions

Theorem 2.1.9 implies that if f is monotonic on an interval I , then f is either continuous
or has a jump discontinuity at each x0 in I . This and Theorem 2.2.10 provide the key to
the proof of the following theorem.

Theorem 2.2.14 If f is monot°onic an d noncons«tant on OEa; b; then f is continuous on
OEa; b if and only if its range Rf D f .x/  x 2 OEa; b is the closed interval with endpoints
f .a/ and f .b/:

Proof We assume that f is nondecreasing, and leave the case where°f is no nincreasing«
to you (Exercise 2.2.34). Theorem 2.1.9(a) implies that the set Ref D f .x/  x 2 .a; b/
is a subset of the open interval .f .aC/; f .b //. Therefore,

      Rf D ff .a/g [ Ref [ ff .b/g ff .a/g [ .f .aC/; f .b // [ ff .b/g: (2.2.15)

Now suppose that f is continuous on OEa; b. Then f .a/ D f .aC/, f .b / D f .b/, so
(2.2.15) implies that Rf OEf .a/; f .b/. If f .a/ < < f .b/, then Theorem 2.2.10
implies that D f .x/ for some x in .a; b/. Hence, Rf D OEf .a/; f .b/.

   For the converse, suppose that Rf D OEf .a/; f .b/. Since f .a/ Ä f .aC/ and f .b / Ä
f .b/, (2.2.15) implies that f .a/ D f .aC/ and f .b / D f .b/. We know from Theo-
rem 2.1.9(c) that if f is nondecreasing and a < x0 < b, then

                                    f .x0 / Ä f .x0/ Ä f .x0C/:

If either of these inequalities is strict, Rf cannot be an interval. Since this contradicts
our assumption, f .x0 / D f .x0/ D f .x0C/. Therefore, f is continuous at x0 (Exer-
cise 2.2.2). We can now conclude that f is continuous on OEa; b.

   Theorem 2.2.14 implies the following theorem.

Theorem 2.2.15 Suppose that f is increasing and continuous on OEa; b; and let f .a/ D
c and f .b/ D d: Then there is a unique function g defined on OEc; d  such that

      g.f .x// D x; a Ä x Ä b;                                 (2.2.16)

and                                                            (2.2.17)
                                     f .g.y// D y; c Ä y Ä d:

Moreover; g is continuous and increasing on OEc; d :

Proof We first show that there is a function g satisfying (2.2.16) and (2.2.17). Since f

is continuous, Theorem 2.2.14 implies that for each y0 in OEc; d  there is an x0 in OEa; b such

that

      f .x0/ D y0;                                             (2.2.18)
68 Chapter 2 Differential Calculus of Functions of One Variable

and, since f is increasing, there is only one such x0. Define

                 g.y0/ D x0:                                     (2.2.19)

The definition of x0 is illustrated in Figure 2.2.6: with OEc; d  drawn on the y-axis, find the
intersection of the line y D y0 with the curve y D f .x/ and drop a vertical from the
intersection to the x-axis to find x0.

              y

          d                                        y = f (x)

          y0

          c

                 a x0 b x

                 Figure 2.2.6

Substituting (2.2.19) into (2.2.18) yields

                 f .g.y0 // D y0;

and substituting (2.2.18) into (2.2.19) yields

                 g.f .x0// D x0:

Dropping the subscripts in these two equations yields (2.2.16) and (2.2.17).

   The uniqueness of g follows from our assumption that f is increasing, and therefore
only one value of x0 can satisfy (2.2.18) for each y0.

   To see that g is increasing, suppose that y1 < y2 and let x1 and x2 be the points in OEa; b
such that f .x1/ D y1 and f .x2/ D y2. Since f is increasing, x1 < x2. Therefore,

                 g.y1/ D x1 < x2 D g.y2/;

                 °                              «
so g is increasing. Since Rg D g.y/  y 2 OEc; d  is the interval OEg.c/; g.d / D OEa; b,

Theorem 2.2.14 with f and OEa; b replaced by g and OEc; d  implies that g is continuous on

OEc; d .

The function g of Theorem 2.2.15 is the inverse of f , denoted by f 1. Since (2.2.16)

and (2.2.17) are symmetric in f and g, we can also regard f as the inverse of g, and denote
it by g 1.
                                                      Section 2.2 Continuity 69

Example 2.2.17 If                    f .x/ D x2; 0 Ä x Ä R;
                                 1.y/ D g.y/ D py; 0 Ä y Ä R2:
then
                              f

Example 2.2.18 If                  f .x/ D 2x C 4; 0 Ä x Ä 2;
                                 1.y/ D g.y/ D y 4 ; 4 Ä y Ä 8:
then
                             f                         2

                                       2.2 Exercises

1. Prove Theorem 2.2.2.
2. Prove that a function f is continuous at x0 if and only if

                                 lim f .x/ D lim f .x/ D f .x0/:
                                 x!x0     x!x0 C

3. Determine whether f is continuous or discontinuous from the right or left at x0.
       (a) f .x/ D px .x0 D 0/ (b) f .x/ D px .x0 > 0/

(c) f .x/ D 1 .x0 D 0/                 (d) f .x/ D x2 .x0 arbitrary/
                x

(e) f .x/ D x sin 1=x; x ¤ 0; 1; x D 0 .x0 D 0/

(f ) f .x/ D x sin 1=x; x ¤ 0 80; x D 0 .x0 D 0/
        <x C jxj.1 C x/ sin 1 ; x ¤ 0
(g) f .x/ D :1; x                         x           .x0 D 0/
                                                xD0

4. Let f be defined on OE0; 2 by

                                           ( x2;     0 Ä x < 1;
                                 f .x/ D             1 Ä x Ä 2:

                                             x C 1;

On which of the following intervals is f continuous according to Definition 2.2.3:
OE0; 1/, .0; 1/, .0; 1, OE0; 1, OE1; 2/, .1; 2/, .1; 2, OE1; 2?

5. Let                                            px
                                       g.x/ D x 1 :

On which of the following intervals is g continuous according to Definition 2.2.3:

OE0; 1/, .0; 1/, .0; 1, OE1; 1/, .1; 1/?
70 Chapter 2 Differential Calculus of Functions of One Variable

6. Let            (              if x is irrational;
                    -1           if x is rational:

        f .x/ D
                     1

Show that f is not continuous anywhere.

7. Let f .x/ D 0 if x is irrational and f .p=q/ D 1=q if p and q are positive inte-
      gers with no common factors. Show that f is discontinuous at every rational and
      continuous at every irrational on .0; 1/.

8. Prove: If f assumes only finitely many values, then f is continuous at a point x0 in
      D0f if and only if f is constant on some interval .x0 i; x0 C i/.

9. The characteristic function T of a set T is defined by

                  (                      x 2 T;
                    1;                   x 62 T:

        T .x/ D
                    0;

Show that T is continuous at a point x0 if and only if x0 2 T 0 [ .T c/0.

10. Prove: If f and g are continuous on .a; b/ and f .x/ D g.x/ for every x in a dense
        subset (Definition 1.1.5) of .a; b/, then f .x/ D g.x/ for all x in .a; b/.

11. Prove that the function g.x/ D log x is continuous on .0; 1/. Take the following
        properties as given.

(a) limx!1 g.x/ D 0.
(b) g.x1/ C g.x2/ D g.x1x2/ if x1; x2 > 0.

12. Prove that the function f .x/ D eax is continuous on . 1; 1/. Take the following
        properties as given.

(a) limx!0 f .x/ D 1.            1 < x1; x2 < 1.
(b) f .x1 C x2/ D f .x1/f .x2/;

13. (a) Prove that the functions sinh x and cosh x are continuous for all x.
       (b) For what values of x are tanh x and coth x continuous?

14. Prove that the functions s.x/ D sin x and c.x/ D cos x are continuous on . 1; 1/.
        Take the following properties as given.

(a) limx!0 c.x/ D 1.                        1 < x1; x2 < 1.
(b) c.x1 x2/ D c.x1/c.x2/ C s.x1/s.x2/;
(c) s2.x/ C c2.x/ D 1; 1 < x < 1.

15. (a) Prove: If f is continuous at x0 and f .x0/ > , then f .x/ > for all x in
               some neighborhood of x0.

       (b) State a result analogous to (a) for the case where f .x0/ < .
       (c) Prove: If f .x/ Ä for all x in S and x0 is a limit point of S at which f is

               continuous, then f .x0/ Ä .
       (d) State results analogous to (a), (b), and (c) for the case where f is contin-

               uous from the right or left at x0.
                                                 Section 2.2 Continuity 71

16. Let jf j be the function whose value at each x in Df is jf .x/j. Prove: If f is
        continuous at x0, then so is jf j. Is the converse true?

17. Prove: If f is monotonic on OEa; b, then f is piecewise continuous on OEa; b if and
        only if f has only finitely many discontinuities in OEa; b.

18. Prove Theorem 2.2.5.

19. (a) Show that if f1, f2, . . . , fn are continuous on a set S then so are f1 C f2 C
                  C fn and f1f2 fn.

       (b) Use (a) to show that a rational function is continuous for all values of x
               except the zeros of its denominator.

20. (a) Let f1 and f2 be continuous at x0 and define

                    F .x/ D max .f1.x/; f2.x// :

      Show that F is continuous at x0.
(b) Let f1, f2, . . . , fn be continuous at x0 and define

                    F .x/ D max .f1.x/; f2.x/; : : : ; fn.x// :

Show that F is continuous at x0.

21. Find the domains of f i g and g i f .     (b) f .x/ D log x; g.x/ D sin x
       (a) f .x/ D px; g.x/ D 1 x2

(c) f .x/ D     1  2 ; g.x/ D cos x           (d) f .x/ D px; g.x/ D sin 2x

             1x

22. (a) Suppose that y0 D limx!x0 g.x/ exists and is an interior point of Df , and

that f is continuous at y0. Show that

                     lim .f i g/.x/ D f .y0/:

                    x!x0

(b) State an analogous result for limits from the right.
(c) State an analogous result for limits from the left.

23. Use Theorem 2.2.7 to find all points x0 at which the following functions are contin-

uous.               (b) sin e x2                           (c) log.1 C sin x/
     p

(a) 1 x2

(d) e 1=.1 2x/      (e) sin                1                        Â1Ã
                                                           (f ) sin cos x
                             .x 1/            2

(g) .1 sin2 x/ 1=2  (h) cot.1 e x2 /                       (i) cos 1
                                                                    x

24. Complete the proof of Theorem 2.2.9 by showing that there is an x2 such that

f .x2/ D .
72 Chapter 2 Differential Calculus of Functions of One Variable

25. °Prove: If f is nonco«nstant and continuous on an interval I , then the set S D
         y  y D f .x/; x 2 I is an interval. Moreover, if I is a finite closed interval, then
        so is S .

26. Suppose that f and g are defined on . 1; 1/, f is increasing, and f i g is con-
        tinuous on . 1; 1/. Show that g is continuous on . 1; 1/.

27. Let f be continuous on OEa; b/, and define

F .x/ D max f .t/; a Ä x < b:

               aÄt Äx

        (How do we know that F is well defined?) Show that F is continuous on OEa; b/.

28. Let f and g be uniformly continuous on an interval S .

       (a) Show that f C g and f g are uniformly continuous on S .
       (b) Show that fg is uniformly continuous on S if S is compact.
       (c) Show that f =g is uniformly continuous on S if S is compact and g has no

               zeros in S .
       (d) Give examples showing that the conclusion of (b) and (c) may fail to hold

               if S is not compact.
       (e) State additional conditions on f and g which guarantee that fg is uniformly

               continuous on S even if S is not compact. Do the same for f =g.

29. Suppose that f is uniformly continuous on a set S , g is uniformly continuous on a
        set T , and g.x/ 2 S for every x in T . Show that f i g is uniformly continuous on
        T.

In, then f is uniformly continuous on 30. (a) Prove: If f is uniformly continuous oSn nj D1 Ij . disjoint closed intervals I1, I2, . . . ,
       (b) Is (a) valid without the word "closed"?

31. (a) Prove: If f is uniformly continuous on a bounded open interval .a; b/, then
               f .aC/ and f .b / exist and are finite. HINT: See Exercise 2.1.38:

       (b) Show that the conclusion in (a) does not follow if .a; b/ is unbounded.

32. Prove: If f is continuous on OEa; 1/ and f .1/ exists (finite), then f is uniformly
        continuous on OEa; 1/.

33. Suppose that f is defined on . 1; 1/ and has the following properties.

(i) lim f .x/ D 1 and (ii) f .x1Cx2/ D f .x1/f .x2/;             1 < x1; x2 < 1:

          x!0

Prove:
(a) f .x/ > 0 for all x.
(b) f .r x/ D OEf .x/r if r is rational.
(c) If f .1/ D 1 then f is constant.
                         Section 2.3 Differentiable Functions of One Variable 73

(d) If f .1/ D > 1, then f is increasing,

                         lim f .x/ D 1; and lim f .x/ D 0:
                         x!1                       x! 1

          (Thus, f .x/ D eax has these properties if a > 0.)

HINT: See Exercises 2.2.10 and 2.2.12:

34. Prove Theorem 2.2.14 in the case where f is nonincreasing.

2.3 DIFFERENTIABLE FUNCTIONS OF ONE VARIABLE

In calculus you studied differentiation, emphasizing rules for calculating derivatives. Here

we consider the theoretical properties of differentiable functions. In doing this, we assume
that you know how to differentiate elementary functions such as xn, ex, and sin x, and we

will use such functions in examples.

Definition of the Derivative

Definition 2.3.1 A function f is differentiable at an interior point x0 of its domain if

the difference quotient

                         f .x/  f .x0/ ;  x ¤ x0;
                             x  x0

approaches a limit as x approaches x0, in which case the limit is called the derivative of f
at x0, and is denoted by f 0.x0/; thus,

                         f 0.x0/ D lim f .x/       f .x0/ :        (2.3.1)
                                     x!x0 x        x0

It is sometimes convenient to let x D x0 C h and write (2.3.1) as

                         f 0.x0/ D lim f .x0 C h/  f .x0/ :
                                h!0           h

   If f is defined on an open set S , we say that f is differentiable on S if f is differentiable
at every point of S . If f is differentiable on S , then f 0 is a function on S . We say that
f is continuously differentiable on S if f 0 is continuous on S . If f is differentiable on a
neighborhood of x0, it is reasonable to ask if f 0 is differentiable at x0. If so, we denote the
derivative of f 0 at x0 by f 00.x0/. This is the second derivative of f at x0, and it is also
denoted by f .2/.x0/. Continuing inductively, if f .n 1/ is defined on a neighborhood of
x0, then the nth derivative of f at x0, denoted by f .n/.x0/, is the derivative of f .n 1/ at

x0. For convenience we define the zeroth derivative of f to be f itself; thus

                                                f .0/ D f:

We assume that you are familiar with the other standard notations for derivatives; for

example,

                         f .2/ D f 00; f .3/ D f 000;
74 Chapter 2 Differential Calculus of Functions of One Variable

and so on, and

                       d nf D f .n/:
                       dxn

Example 2.3.1 If n is a positive integer and
                                               f .x/ D xn;

then

                f .x/  f .x0/ xn      x0n D x               x0 X xn k n 1  1 x0k ;
                    x  x0 D x         x0 x                  x0 kD0

so

                       f 0.x0/ D lim  nX1  xn k 1xk0 D nxn 1 0 :

                       x!x0           kD0

Since this holds for every x0, we drop the subscript and write

                       f 0.x/ D nxn 1 or   d .xn/ D nxn 1:
                                           dx

   To derive differentiation formulas for elementary functions such as sin x, cos x, and ex
directly from Definition 2.3.1 requires estimates based on the properties of these functions.
Since this is done in calculus, we will not repeat it here.

Interpretations of the Derivative

If f .x/ is the position of a particle at time x ¤ x0, the difference quotient

                       f .x/               f .x0/
                           x               x0

is the average velocity of the particle between times x0 and x. As x approaches x0, the

average applies to shorter and shorter intervals. Therefore, it makes sense to regard the limit

(2.3.1), if it exists, as the particle's instantaneous velocity at time x0. This interpretation
may be useful even if x is not time, so we often regard f 0.x0/ as the instantaneous rate of
change of f .x/ at x0, regardless of the specific nature of the variable x. The derivative also
has a geometric interpretation. The equation of the line through two points .x0; f .x0// and
.x1; f .x1// on the curve y D f .x/ (Figure 2.3.1) is

                       y D f .x0/ C f .x1/ f .x0/ .x x0/:
                                             x1 x0

Varying x1 generates lines through .x0; f .x0// that rotate into the line           (2.3.2)
                                    y D f .x0/ C f 0.x0/.x x0/
                                      Section 2.3 Differentiable Functions of One Variable 75
as x1 approaches x0. This is the tangent to the curve y D f .x/ at the point .x0; f .x0//.
Figure 2.3.2 depicts the situation for various values of x1.

                                  y

                                                                                               y = f (x)

                                            x0 x1 x

                                        Figure 2.3.1

                     y

                                                                                                            y = f (x)
Tange
    nt line

                                     x'1'  x1      x1                              x

x0

                                     Figure 2.3.2

Here is a less intuitive definition of the tangent line: If the function

             T .x/ D f .x0/ C m.x x0/

approximates f so well near x0 that

             lim                     f .x/ T .x/  D 0;

             x!x0 x x0

we say that the line y D T .x/ is tangent to the curve y D f .x/ at .x0; f .x0//.
76 Chapter 2 Differential Calculus of Functions of One Variable

This tangent line exists if and only if f 0.x0/ exists, in which case m is uniquely determined
by m D f 0.x0/ (Exercise 2.3.1). Thus, (2.3.2) is the equation of the tangent line.

   We will use the following lemma to study differentiable functions.

Lemma 2.3.2 If f is differentiable at x0; then                           (2.3.3)
                           f .x/ D f .x0/ C OEf 0.x0/ C E.x/.x x0/;

where E is defined on a neighborhood of x0 and
                                        lim E.x/ D E.x0/ D 0:

                                                       x!x0

Proof  Define
                      8
                      <f .x/  f .x0/     f 0.x0/;  x 2 Df and x ¤ x0;    (2.3.4)
                              x0                   x D x0:
            E.x/ D : x
                         0;

Solving (2.3.4) for f .x/ yields (2.3.3) if x ¤ x0, and (2.3.3) is obvious if x D x0. Defini-
tion 2.3.1 implies that limx!x0 E.x/ D 0. We defined E.x0/ D 0 to make E continuous
at x0.

   Since the right side of (2.3.3) is continuous at x0, so is the left. This yields the following
theorem.

Theorem 2.3.3 If f is differentiable at x0; then f is continuous at x0:

   The converse of this theorem is false, since a function may be continuous at a point
without being differentiable at the point.

Example 2.3.2 The function       f .x/ D jxj
can be written as

                              f .x/ D x; x > 0;                          (2.3.5)

or as

                              f .x/ D x; x < 0:                          (2.3.6)

 From (2.3.5),                f 0.x/ D 1; x > 0;
and from (2.3.6),             f 0.x/ D 1; x < 0:

Neither (2.3.5) nor (2.3.6) holds throughout any neighborhood of 0, so neither can be used
alone to calculate f 0.0/. In fact, since the one-sided limits

                          f .x/       f .0/  D lim  x                    (2.3.7)
                    lim
                   x!0C x             0      x!0C x

and

                              f .x/ f .0/              x
                   lim                       D lim D 1                   (2.3.8)
                   x!0        x0             x!0 x
                               Section 2.3 Differentiable Functions of One Variable 77

are different,

                                    f .x/      f .0/
                               lim             0
                               x!0 x

does not exist (Theorem 2.1.6); thus, f is not differentiable at 0, even though it is continu-

ous at 0.

Interchanging Differentiation and Arithmetic Operations

The following theorem should be familiar from calculus.

Theorem 2.3.4 If f and g are differentiable at x0; then so are f C g; f      g; and fg;
with

(a) .f C g/0.x0/ D f 0.x0/ C g0.x0/I

(b) .f g/0.x0/ D f 0.x0/ g.x0/I

(c) .fg/0 .x0/ D f 0.x0/g.x0/ C f .x0/g0.x0/:

The quotient f =g is differentiable at x0 if g.x0/ ¤ 0; with
Â f Ã0
(d) g .x0/ D    f 0.x0/g.x0 / f .x0/g0.x0/
                               OEg.x0/2 :

Proof The proof is accomplished by forming the appropriate difference quotients and
applying Definition 2.3.1 and Theorem 2.1.4. We will prove (c) and leave the rest to you

(Exercises 2.3.9, 2.3.10, and 2.3.11).

   The trick is to add and subtract the right quantity in the numerator of the difference
quotient for .fg/0 .x0/; thus,

f .x/g.x/       f .x0/g.x0/ D f .x/g.x/      f .x0/g.x/ C f .x0/g.x/  f .x0/g.x0/
          x     x0                                       x x0

                                  f .x/  f .x0/ g.x/ C f .x0/ g.x/  g.x0/ :
                               Dx        x0                   x     x0

The difference quotients on the right approach f 0.x0/ and g0.x0/ as x approaches x0, and
limx!x0 g.x/ D g.x0/ (Theorem 2.3.3). This proves (c).

The Chain Rule

Here is the rule for differentiating a composite function.

Theorem 2.3.5 (The Chain Rule) Suppose that g is differentiable at x0 and f
is differentiable at g.x0/: Then the composite function h D f i g; defined by

                               h.x/ D f .g.x//;

is differentiable at x0; with

                               h0.x0/ D f 0.g.x0 //g0.x0/:
78 Chapter 2 Differential Calculus of Functions of One Variable

Proof       Since f is differentiable at g.x0/, Lemma 2.3.2 implies that
                      f .t/ f .g.x0// D OEf 0.g.x0// C E.t/OEt g.x0/;

where                      lim E.t/ D E.g.x0// D 0:                                (2.3.9)
Letting t D g.x/ yields
                         t !g.x0/

            f .g.x// f .g.x0// D OEf 0.g.x0// C E.g.x//OEg.x/      g.x0/:

Since h.x/ D f .g.x//, this implies that

                  h.x/ h.x0/ D OEf 0.g.x0// C E.g.x// g.x/ g.x0/ :                 (2.3.10)
                  x x0                                       x x0

Since g is continuous at x0 (Theorem 2.3.3), (2.3.9) and Theorem 2.2.7 imply that

                          lim E.g.x// D E.g.x0// D 0:

                         x!x0

Therefore, (2.3.10) implies that

                  h0.x0/ D lim h.x/       h.x0/ D f 0.g.x0//g0 .x0/;
                             x!x0 x       x0

as stated.

Example 2.3.3 If

                                                       1
                  f .x/ D sin x and g.x/ D x ; x ¤ 0;

then
                                                             1

                                h.x/ D f .g.x// D sin x ; x ¤ 0;

and                                       Â ÃÂ Ã
                  h0.x/ D f 0.g.x//g.x/ D cos 1             1
                                                         x  x2 ; x ¤ 0:

It may seem reasonable to justify the chain rule by writing

                  h.x/ h.x0/ D f .g.x// f .g.x0//
                  x x0                    x x0

                                     f .g.x//  f .g.x0// g.x/     g.x0 /
                                  D g.x/                          x0
                                               g.x0 /        x

and arguing that

                                f .g.x//  f .g.x0// D f 0.g.x0//
                          lim             g.x0 /
                         x!x0 g.x/
                         Section 2.3 Differentiable Functions of One Variable 79

(because limx!x0 g.x/ D g.x0// and

                             g.x/              g.x0/ D g0.x0/:
                       lim                     x0
                      x!x0 x

However, this is not a valid proof (Exercise 2.3.13).

One-Sided Derivatives

One-sided limits of difference quotients such as (2.3.7) and (2.3.8) in Example 2.3.2 are
called one-sided or right- and left-hand derivatives. That is, if f is defined on OEx0; b/, the
right-hand derivative of f at x0 is defined to be

                      0fC.x0/ D lim                 f .x/  f .x0/
                                                           x0
                                         x!x0 C x

if the limit exists, while if f is defined on .a; x0, the left-hand derivative of f at x0 is

defined to be         f 0 .x0/ D lim f .x/                 f .x0/
                                                           x0
                                         x!x0       x

if the limit exists.  Theorem 2.1.6 implies that f  is differentiable at x0  if  and  only  if  f0   .x0  /

and f 0 .x0/ exist and are equal, in which case                                                   C

                      f 0.x0/ D fC0 .x0/ D f 0 .x0/:

In Example 2.3.2, fC0 .0/ D 1 and f 0 .0/ D 1.

Example 2.3.4 If

                                         83            x Ä 0;
                                         <x ;

                      f .x/ D :x2 sin 1 ; x > 0;                                                (2.3.11)
                                          x

then                                 8
                                     <3x2;
                                                              x < 0;

                      f 0.x/ D :2x sin 1 cos 1 ; x > 0:                                         (2.3.12)

                                            x       x

Since neither formula in (2.3.11) holds for all x in any neighborhood of 0, we cannot simply

differentiate either to obtain f 0.0/; instead, we calculate

                                     x2 sin 1    0                 1
                      fC0 .0/ D lim         x
                                                    D lim x sin D 0;
                      x!0C x 0                      x!0C           x

                      f 0 .0/ D lim x3   0 D lim x2 D 0I
                                  x!0 x  0 x!0

hence, f 0.0/ D fC0 .0/ D f 0 .0/ D 0.
80 Chapter 2 Differential Calculus of Functions of One Variable

   This example shows that there is a difference between a one-sided derivative and a one-
sided limit of a derivative, since fC0 .0/ D 0, but, from (2.3.12), f 0.0C/ D limx!0C f 0.x/
does not exist. It also shows that a derivative may exist in a neighborhood of a point x0
(D 0 in this case), but be discontinuous at x0.

   Exercise 2.3.4 justifies the method used in Example 2.3.4 to compute f 0.x/ for x ¤ 0.

Definition 2.3.6
(a) We say that f is differentiable on the closed interval OEa; b if f is differentiable on

      the open interval .a; b/ and fC0 .a/ and f 0 .b/ both exist.
(b) We say that f is continuously differentiable on OEa; b if f is differentiable on OEa; b,

      f 0 is continuous on .a; b/, fC0 .a/ D f 0.aC/, and f 0 .b/ D f 0.b /.

Extreme Values

We say that f .x0/ is a local extreme value of f if there is a i > 0 such that f .x/ f .x0/

does not change sign on

                                  .x0 i; x0 C i/ \ Df :           (2.3.13)

More specifically, f .x0/ is a local maximum value of f if

                                  f .x/ Ä f .x0/                  (2.3.14)

or a local minimum value of f if

                                  f .x/ f .x0/                    (2.3.15)

for all x in the set (2.3.13). The point x0 is called a local extreme point of f , or, more
specifically, a local maximum or local minimum point of f .

                y

-1 -1                                                          x

                         11       2               3         4

2                        2

                                  Figure 2.3.3
                                  Section 2.3 Differentiable Functions of One Variable 81

Example 2.3.5 If

                                  8                                        1
                                  ^^ 1;                  1<xÄ              2
                                  ^^<
                        f .x/ D jxj;                     12 < x Ä 12 ;
                                  ^^^ 1
                                                x
                                  ^:p sin ;              1    <  x   Ä  4
                                         22              2

(Figure 2.3.3), then 0, 3, and every x in . 1;     1  /  are  local  minimum  points  of  f  ,  while  1,
                                                   2
                        1
4, and every x in . 1;  2    are  local  maximum   points.

   It is geometrically plausible that if the curve y D f .x/ has a tangent at a local extreme
point of f , then the tangent must be horizontal; that is, have zero slope. (For example, in
Figure 2.3.3, see x D 1, x D 3, and every x in . 1; 1=2/.) The following theorem shows
that this must be so.

Theorem 2.3.7 If f is differentiable at a local extreme point x0 2 D0f ; then f 0.x0/ D 0:

Proof We will show that x0 is not a local extreme point of f if f 0.x0/ ¤ 0. From

Lemma 2.3.2,

                             f .x/       f .x0/ D f 0.x0/ C E.x/;                               (2.3.16)
                                 x       x0

where limx!x0 E.x/ D 0. Therefore, if f 0.x0/ ¤ 0, there is a i > 0 such that

                           jE.x/j < jf 0.x0/j if jx x0j < i;

and the right side of (2.3.16) must have the same sign as f 0.x0/ for jx x0j < i. Since
the same is true of the left side, f .x/ f .x0/ must change sign in every neighborhood of
x0 (since x x0 does). Therefore, neither (2.3.14) nor (2.3.15) can hold for all x in any
interval about x0.

   If f 0.x0/ D 0, we say that x0 is a critical point of f . Theorem 2.3.7 says that every
local extreme point of f at which f is differentiable is a critical point of f . The converse
is false. For example, 0 is a critical point of f .x/ D x3, but not a local extreme point.

Rolle's Theorem

The use of Theorem 2.3.7 for finding local extreme points is covered in calculus, so we will
not pursue it here. However, we will use Theorem 2.3.7 to prove the following fundamental
theorem, which says that if a curve y D f .x/ intersects a horizontal line at x D a and
x D b and has a tangent at .x; f .x// for every x in .a; b/, then there is a point c in .a; b/
such that the tangent to the curve at .c; f .c// is horizontal (Figure 2.3.4).
82 Chapter 2 Differential Calculus of Functions of One Variable

                                  y

                                                     a cb x

                                        Figure 2.3.4

Theorem 2.3.8 (Rolle's Theorem) Suppose that f is continuous on the closed
interval OEa; b and differentiable on the open interval .a; b/; and f .a/ D f .b/: Then
f 0.c/ D 0 for some c in the open interval .a; b/:

Proof Since f is continuous on OEa; b, f attains a maximum and a minimum value on
OEa; b (Theorem 2.2.9). If these two extreme values are the same, then f is constant on
.a; b/, so f 0.x/ D 0 for all x in .a; b/. If the extreme values differ, then at least one must
be attained at some point c in the open interval .a; b/, and f 0.c/ D 0, by Theorem 2.3.7.

Intermediate Values of Derivatives

A derivative may exist on an interval OEa; b without being continuous on OEa; b. Neverthe-
less, an intermediate value theorem similar to Theorem 2.2.10 applies to derivatives.

Theorem 2.3.9 (Intermediate Value Theorem for Derivatives) Suppose
that f is differentiable on OEa; b; f 0.a/ ¤ f 0.b/; and is between f 0.a/ and f 0.b/: Then

f 0.c/ D for some c in .a; b/:

Proof Suppose first that   f 0.a/ < < f 0.b/

                                                                 (2.3.17)

and define

                           g.x/ D f .x/ x:

Then

                           g0.x/ D f 0.x/ ; a Ä x Ä b;           (2.3.18)

and (2.3.17) implies that

                           g0.a/ < 0 and g0.b/ > 0:              (2.3.19)

Since g is continuous on OEa; b, g attains a minimum at some point c in OEa; b. Lemma 2.3.2
and (2.3.19) imply that there is a i > 0 such that

      g.x/ < g.a/; a < x < a C i; and g.x/ < g.b/; b i < x < b
                       Section 2.3 Differentiable Functions of One Variable 83

(Exercise 2.3.3), and therefore c ¤ a and c ¤ b. Hence, a < c < b, and therefore
g0.c/ D 0, by Theorem 2.3.7. From (2.3.18), f 0.c/ D .

   The proof for the case where f 0.b/ < < f 0.a/ can be obtained by applying this result
to f .

Mean Value Theorems

Theorem 2.3.10 (Generalized Mean Value Theorem) If f and g are con-
tinuous on the closed interval OEa; b and differentiable on the open interval .a; b/; then

                       OEg.b/ g.a/f 0.c/ D OEf .b/ f .a/g0.c/         (2.3.20)

for some c in .a; b/:

Proof The function                                         f .a/g.x/
                        h.x/ D OEg.b/ g.a/f .x/ OEf .b/

is continuous on OEa; b and differentiable on .a; b/, and

                              h.a/ D h.b/ D g.b/f .a/ f .b/g.a/:
Therefore, Rolle's theorem implies that h0.c/ D 0 for some c in .a; b/. Since

                       h0.c/ D OEg.b/ g.a/f 0.c/ OEf .b/ f .a/g0.c/;
this implies (2.3.20).

   The following special case of Theorem 2.3.10 is important enough to be stated separately.

Theorem 2.3.11 (Mean Value Theorem) If f is continuous on the closed
interval OEa; b and differentiable on the open interval .a; b/; then

                                        f 0.c/ D f .b/ f .a/
                                                        ba

for some c in .a; b/:

Proof Apply Theorem 2.3.10 with g.x/ D x.

   Theorem 2.3.11 implies that the tangent to the curve y D f .x/ at .c; f .c// is parallel to
the line connecting the points .a; f .a// and .b; f .b// on the curve (Figure 2.3.5, page 84).

Consequences of the Mean Value Theorem

If f is differentiable on .a; b/ and x1, x2 2 .a; b/ then f is continuous on the closed

interval with endpoints x1 and x2 and differentiable on its interior. Hence, the mean value

theorem implies that

                       f .x2/ f .x1/ D f 0.c/.x2 x1/

for some c between x1 and x2. (This is true whether x1 < x2 or x2 < x1.) The next three
theorems follow from this.
84 Chapter 2 Differential Calculus of Functions of One Variable

Theorem 2.3.12 If f 0.x/ D 0 for all x in .a; b/; then f is constant on .a; b/:

Theorem 2.3.13 If f 0 exists and does not change sign on .a; b/; then f is monotonic
on .a; b/ W increasing; nondecreasing; decreasing; or nonincreasing as

                   f 0.x/ > 0; f 0.x/ 0; f 0.x/ < 0; or f 0.x/ Ä 0;

respectively; for all x in .a; b/:

Theorem 2.3.14 If                 jf 0.x/j Ä M;    a < x < b;                (2.3.21)
                                  f .x0/j Ä M jx   x0j; x; x0 2 .a; b/:
then
                          jf .x/

   A function that satisfies an inequality like (2.3.21) for all x and x0 in an interval is said
to satisfy a Lipschitz condition on the interval.

       y

f (b)                                                          y = f (x)

f (c)

f (a)

                                  a             c   b                     x

                                     Figure 2.3.5

                                     2.3 Exercises

1. Prove that a function f is differentiable at x0 if and only if

                                         f .x/     f .x0/ m.x  x0/ D 0
                                   lim               x x0

                                  x!x0

for some constant m. In this case, f 0.x0/ D m.
               Section 2.3 Differentiable Functions of One Variable 85

2. Prove: If f is defined on a neighborhood of x0, then f is differentiable at x0 if and
      only if the discontinuity of

                         f .x/      f .x0/
               h.x/ D x             x0

      at x0 is removable.
3. Use Lemma 2.3.2 to prove that if f 0.x0/ > 0, there is a i > 0 such that

f .x/ < f .x0/ if x0 i < x < x0 and f .x/ > f .x0/ if x0 < x < x0 C i:

4. Suppose that p is continuous on .a; c and differentiable on .a; c/, while q is con-

tinuous on OEc; b/ and differentiable on .c; b/. Let

                         (        a < x Ä c;
                           p.x/;  c < x < b:

               f .x/ D
                           q.x/;

(a) Show that             ( p0.x/;
               f 0.x/ D
                                    a < x < c;
                            q0.x/;  c < x < b:

     (b) Under what additional conditions on p and q does f 0.c/ exist? Prove that
             your stated conditions are necessary and sufficient.

5. Find all derivatives of f .x/ D xn 1jxj, where n is a positive integer.
6. Suppose that f 0.0/ exists and f .x C y/ D f .x/f .y/ for all x and y. Prove that f 0

      exists for all x.

7. Suppose that c0.0/ D a and s0.0/ D b where a2 C b2 ¤ 0, and

               c.x C y/ D c.x/c.y/ s.x/s.y/
               s.x C y/ D s.x/c.y/ C c.x/s.y/

      for all x and y.

     (a) Show that c and s are differentiable on . 1; 1/, and find c0 and s0 in terms
             of c, s, a, and b.

     (b) (For those who have studied differential equations.) Find c and s explicitly.

8. (a) Suppose that f and g are differentiable at x0, f .x0/ D g.x0/ D 0, and
             g0.x0/ ¤ 0. Without using L'Hospital's rule, show that

                    f .x/ f 0.x0/
               lim                D0 :
               x!x0 g.x/ g .x0/

     (b) State the corresponding results for one-sided limits.
9. Prove Theorem 2.3.4(a).
86 Chapter 2 Differential Calculus of Functions of One Variable

10. Prove Theorem 2.3.4(b).

11. Prove Theorem 2.3.4(d).

12. Prove by induction: If n 1 and f .n/.x0/ and g.n/.x0/ exist, then so does .fg/.n/ .x0/,

and Xn n !                                     f .m/.x0/g.n m/.x0/:
                  .fg/.n/ .x0/ D
                                  mD0 m

HINT: See Exercise 1.2.19: This is Leibniz's rule for differentiating a product.

13. What is wrong with the "proof" of the chain rule suggested after Example 2.3.3?
        Correct it.

14. Suppose that f is continuous and increasing on OEa; b. Let f be differentiable at a

        point x0 in .a; b/, with f 0.x0/ ¤ 0. If g is the inverse of f Theorem 2.2.15), show
        that g0.f .x0// D 1=f 0.x0/.

15. (a) Show that fC0 .a/ D f 0.aC/ if both quantities exist.

(b) Example 2.3.4 shows that fC0 .a/ may exist even if f 0.aC/ does not. Give an
      example where f 0.aC/ exists but fC0 .a/ does not.

(c) Complete the following statement so it becomes a theorem, and prove the

         theorem: "If f 0.aC/ exists and f is  at a, then fC0 .a/ D f 0.aC/."

16. Show that f .aC/ and f .b / exist (finite) if f 0 is bounded on .a; b/. HINT: See

Exercise 2.1.38:

17. Suppose that f is continuous on OEa; b, fC0 .a/ exists, and is between fC0 .a/ and
        .f .b/ f .a//=.b a/. Show that f .c/ f .a/ D .c a/ for some c in .a; b/.

18. Suppose that f is continuous on OEa; b, fC0 .a/ < < f 0 .b/, and

                             .f .b/ f .a//=.b a/ ¤ :

Show that either f .c/ f .a/ D .c a/ or f .c/ f .b/ D .c b/ for some c
in .a; b/.

19. Let                      f .x/ D sin x ; x ¤ 0:
                                         x

(a) Define f .0/ so that f is continuous at x D 0. HINT: Use Exercise 2.3.8:
(b) Show that if x is a local extreme point of f , then

                             jf .x/j D .1 C x2/ 1=2:

      HINT: Express sin x and cos x in terms of f .x/ and f 0.x/; and add their
      squares to obtain a useful identity:
(c) Show that jf .x/j Ä 1 for all x. For what value of x is equality attained?
      Section 2.3 Differentiable Functions of One Variable 87

20. Let n be a positive integer and                      (k D integer):
                                           sin nx

                                f .x/ D n sin x ; x ¤ k

(a) Define f .k / so that f is continuous at k . HINT: Use Exercise 2.3.8:
(b) Show that if x is a local extreme point of f , then

      jf .x/j D 1 C .n2 1/ sin2 x 1=2 :

               HINT: Express sin nx and cos nx in terms of f .x/ and f 0.x/; and add their
               squares to obtain a useful identity:

       (c) Show that jf .x/j Ä 1 for all x. For what values of x is equality attained?

21. We say that f has at least n zeros, counting multiplicities, on an interval I if there
        are distinct points x1, x2, . . . , xp in I such that

f .j /.xi / D 0; 0 Ä j Ä ni 1; 1 Ä i Ä p;

        and n1 C C np D n. Prove: If f is differentiable and has at least n zeros,
        counting multiplicities, on an interval I , then f 0 has at least n 1 zeros, counting
        multiplicities, on I .

22. Give an example of a function f such that f 0 exists on an interval .a; b/ and has a
        jump discontinuity at a point x0 in .a; b/, or show that there is no such function.

23. Let x1, x2, . . . , xn and y1, y2, . . . , yn be in .a; b/ and yi < xi , 1 Ä i Ä n. Show
        that if f is differentiable on .a; b/, then

Xn                                                       Xn
      OEf .xi / f .yi / D f 0.c/ .xi yi /

i D1                                                     i D1

        for some c in .a; b/.
24. Prove or give a counterexample: If f is differentiable on a neighborhood of x0, then

        f satisfies a Lipschitz condition on some neighborhood of x0.
25. Let

              f 00.x/ C p.x/f .x/ D 0 and g00.x/ C p.x/g.x/ D 0; a < x < b:

(a) Show that W D f 0g fg0 is constant on .a; b/.

(b) Prove: If W ¤ 0 and f .x1/ D f .x2/ D 0 where a < x1 < x2 < b, then
      g.c/ D 0 for some c in .x1; x2/. HINT: Consider f =g:
88 Chapter 2 Differential Calculus of Functions of One Variable

26. Suppose that we extend the definition of differentiability by saying that f is differ-

entiable at x0 if  f 0.x0/ D lim f .x/              f .x0/
                               x!x0 x               x0

exists in the extended reals. Show that if          x 0;
                                           (p       x < 0;
                                                x;

                                f .x/ D p x;

        then f 0.0/ D 1.
27. Prove or give a counterexample: If f is differentiable at x0 in the extended sense of

        Exercise 2.3.26, then f is continuous at x0.
28. Assume that f is differentiable on . 1; 1/ and x0 is a critical point of f .

       (a) Let h.x/ D f .x/g.x/, where g is differentiable on . 1; 1/ and

                                                   f .x0/g0.x0/ ¤ 0:

      Show that the tangent line to the curve y D h.x/ at .x0; h.x0// and the tangent
      line to the curve y D g.x/ at .x0; g.x0/ intersect on the x-axis.
(b) Suppose that f .x0/ ¤ 0. Let h.x/ D f .x/.x x1/, where x1 is arbitrary.
      Show that the tangent line to the curve y D h.x/ at .x0; h.x0// intersects the
      x-axis at x D x1.
(c) Suppose that f .x0/ ¤ 0. Let h.x/ D f .x/.x x1/2, where x1 ¤ x0. Show
      that the tangent line to the curve y D h.x/ at .x0; h.x0// intersects the x-axis
      at the midpoint of the interval with endpoints x0 and x1.
(d) Let h.x/ D .ax2 C bx C c/.x x1/, where a ¤ 0 and b2 4ac ¤ 0. Let

                 b
      x0 D 2a . Show that the tangent line to the curve y D h.x/ at .x0; h.x0//
      intersects the x-axis at x D x1.

(e) Let h be a cubic polynomial with zeros , , and , where  and  are distinct
      and is real. Let x0 D  C  . Show that the tangent line to the curve
                                           2
      y D h.x/ at .x0; h.x0// intersects the axis at x D .

2.4 L'HOSPITAL'S RULE

The method of Theorem 2.1.4 for finding limits of the sum, difference, product, and quo-
tient of functions breaks down in connection with indeterminate forms. The generalized
mean value theorem (Theorem 2.3.10) leads to a method for evaluating limits of indetermi-
nate forms.

Theorem 2.4.1 (L'Hospital's Rule) Suppose that f and g are differentiable
and g0 has no zeros on .a; b/: Let

                   lim f .x/ D lim g.x/ D 0                      (2.4.1)
                   x!b  x!b
                                                          Section 2.4 L'Hospital's Rule 89

or                       lim f .x/ D 1 and lim g.x/ D 1;                 (2.4.2)
and suppose that  x!b                               x!b                  (2.4.3)
Then                                                                     (2.4.4)
                                  f 0.x/
                            lim 0 D L .finite or 1/:
                           x!b g .x/

                                      lim    f .x/  D L:

                                    x!b g.x/

Proof We prove the theorem for finite L and leave the case where L D 1 to you
(Exercise 2.4.1).

Suppose that      > 0. From (2.4.3), there is an x0 in .a; b/ such that

                            f 0.c/           if x0 < c < b:              (2.4.5)
                            g0.c/       
                                      L <

Theorem 2.3.10 implies that if x and t are in OEx0; b/, then there is a c between them, and
therefore in .x0; b/, such that

                         OEg.x/ g.t/f 0.c/ D OEf .x/ f .t/g0.c/:         (2.4.6)

Since g0 has no zeros in .a; b/, Theorem 2.3.11 implies that

                           g.x/ g.t/ ¤ 0 if x; t 2 .a; b/:

This means that g cannot have more than one zero in .a; b/. Therefore, we can choose x0
so that, in addition to (2.4.5), g has no zeros in OEx0; b/. Then (2.4.6) can be rewritten as

                           f .x/           f .t/ f 0.c/
                           g.x/            g.t/ D g0.c/ ;

so (2.4.5) implies that

                          f .x/ f .t/   L <

                           g.x/ g.t/                if x; t 2 OEx0; b/:  (2.4.7)

If (2.4.1) holds, let x be fixed in OEx0; b/, and consider the function

                                     f .x/ f .t/
                           G.t/ D g.x/ g.t/ L:

From (2.4.1),              lim f .t/ D lim g.t/ D 0;
so                         t !b              t !b

                           lim G.t/ D        f .x/        L:             (2.4.8)

                           t !b              g.x/
90 Chapter 2 Differential Calculus of Functions of One Variable

Since

                                        jG.t/j < if x0 < t < b;

because of (2.4.7), (2.4.8) implies that                    
                                                            
                                             f .x/  g.x/  L Ä :

This holds for all x in .x0; b/, which implies (2.4.4).

The proof under assumption (2.4.2) is more complicated. Again choose x0 so that (2.4.5)

holds and g has no zeros in OEx0; b/. Letting t D x0 in (2.4.7), we see that

                                        f .x0/            if x0 Ä x < b:           (2.4.9)
                       f .x/  g.x/      g.x0 /    
                                                L <

Since limx!b f .x/ D 1, we can choose x1 > x0 so that f .x/ ¤ 0 and f .x/ ¤ f .x0/
if x1 < x < b. Then the function

                                       u.x/ D 1 g.x0/=g.x/
                                                 1 f .x0/=f .x/

is defined and nonzero if x1 < x < b, and

                                                lim u.x/ D 1;                      (2.4.10)

                                               x!b

because of (2.4.2).

Since         f .x/ f .x0/ D f .x/ 1 f .x0/=f .x/ D f .x/ ;
              g.x/ g.x0/ g.x/ 1 g.x0/=g.x/ g.x/u.x/

(2.4.9) implies that                              
                              f .x/  g.x/u.x/     
                                                L <       if x1 < x < b;

which can be rewritten as                                        x1 < x < b:       (2.4.11)
                                               
                           f .x/  g.x/  Lu.x/ < ju.x/j if

From this and the triangle inequality,

                                                          Lj Ä ju.x/j C jLj ju.x/  1j: (2.4.12)
 f .x/  g.x/  L   Ä  f .x/                 
                                    Lu.x/ C jLu.x/
                      g.x/

Because of (2.4.10), there is a point x2 in .x1; b/ such that

              ju.x/ 1j < and therefore ju.x/j < 1 C if x2 < x < b:

This, (2.4.11), and (2.4.12) imply that

                                                                 if x2 < x < b;
                       f .x/  g.x/        
                                        L < .1 C / C jLj
                                                          Section 2.4 L'Hospital's Rule 91

which proves (2.4.4) under assumption (2.4.2).

   Theorem 2.4.1 and the proof given here remain valid if b D 1 and "x ! b " is
replaced by "x ! 1" throughout. Only minor changes in the proof are required to show
that similar theorems are valid for limits from the right, limits at 1, and ordinary (two-
sided) limits. We will take these as given.

The Indeterminate Forms 0=0 and 1=1

We say that f =g is of the form 0=0 as x ! b if

                 lim f .x/ D lim g.x/ D 0;
                 x!b                         x!b

or of the form 1=1 as x ! b if

                                            lim f .x/ D 1

                                                             x!b

and
                                            lim g.x/ D 1:

                                                             x!b

The corresponding definitions for x ! bC and x ! 1 are similar. If f =g is of one of
these forms as x ! b and as x ! bC, then we say that it is of that form as x ! b.

Example 2.4.1 The ratio sin x=x is of the form 0=0 as x ! 0, and L'Hospital's rule

yields

                 lim sin x D lim cos x D 1:
                 x!0 x                       x!0 1

Example 2.4.2 The ratio e x=x is of the form 1=1 as x !         1, and L'Hospital's

rule yields           ex                          ex

                 lim            D lim                     D 1:
                 x! 1 x                  x! 1 1

Example 2.4.3 Using L'Hospital's rule may lead to another indeterminate form; thus,

                                         ex           ex
                                lim 2 D lim
                      x!1 x                  x!1 2x

if the limit on the right exists in the extended reals. Applying L'Hospital's rule again yields

                                ex                ex
                      lim D lim D 1:
                 x!1 2x x!1 2

Therefore,                             ex
                                 lim 2 D 1:
                                x!1 x

More generally,                        ex
                                 lim  D 1
                                x!1 x

for any real number  (Exercise 2.4.33).
92 Chapter 2 Differential Calculus of Functions of One Variable

Example 2.4.4 Sometimes it pays to combine L'Hospital's rule with other manipula-
tions. For example,

                 4  4 cos x   2 sin2 x  D lim    4 sin x 4 sin x cos x
            lim           x4
                                           x!0              4x  3
            x!0                            Â            ÃÂ                    Ã

                                        D lim sin x          lim   1 cos x

                                           Âx!0 x Ã Âx!0 x Ã              2

                                        D lim    sin x       lim   sin x

                                              x!0 x         x!0 2x
                                           1 Â sin x Ã2
                                        D lim
                                           2 x!0 x

                                        D 1 .1/2 D 1 (Example 2.4.1):
                                           2         2

As another example, L'Hospital's rule yields

       lim  e x2 log.1 C x/  D lim  2xe x2 log.1 C x/ C e x2 .1 C x/ 1
                                                        1 D 1:
       x!0       x            x!0

However, it is better to remove the "determinate" part of the ratio before using L'Hospital's

rule:

                    e x2 log.1 C x/ Â              ÃÂ           log.1 C x/ Ã
            lim                     D lim e             lim
                                                 x2

            x!0     x                   x!0             x!0        x

                                    D .1/ lim log.1 C x/
                                           x!0       x

                                    D lim 1=.1 C x/ D 1:
                                        x!0      1

In using L'Hospital's rule we usually write, for example,

                                    f .x/           f 0.x/
                              lim          D lim 0                               (2.4.13)
                              x!b g.x/ x!b g .x/

and then try to find the limit on the right. This is convenient, but technically incorrect, since
(2.4.13) is true only if the limit on the right exists in the extended reals. It may happen that
the limit on the left exists but the one on the right does not. In this case, (2.4.13) is incorrect.

Example 2.4.5 If

                    f .x/ D x x2 sin 1 and g.x/ D sin x;
                                           x

then        f 0.x/ D 1 2x sin 1 C cos 1 and g0.x/ D cos x:

                                    x         x
                                      Section 2.4 L'Hospital's Rule 93

Therefore, limx!0 f 0.x/=g0.x/ does not exist. However,

lim f .x/ D lim 1 x sin.1=x/ D 1 D 1:
x!0 g.x/ x!0 .sin x/=x                                      1

The Indeterminate Form 0 1

We say that a product fg is of the form 0 1 as x ! b if one of the factors approaches
0 and the other approaches 1 as x ! b . In this case, it may be useful to apply
L'Hospital's rule after writing

           f .x/                                               g.x/
f .x/g.x/ D 1=g.x/ or f .x/g.x/ D 1=f .x/ ;

since one of these ratios is of the form 0=0 and the other is of the form 1=1 as x ! b .
   Similar statements apply to limits as x ! bC, x ! b, and x ! 1.

Example 2.4.6 The product x log x is of the form 0 1 as x ! 0C. Converting it to
an 1=1 form yields

     lim x log x D lim log x
     x!0C                   x!0C 1=x

                            D lim     1=x

                            x!0C 1=x                     2

                            D lim x D 0:

                                    x!0C

Converting to a 0=0 form leads to a more complicated problem:

     lim x log x D lim             x

     x!0C                   x!0C 1= log x

           D lim                      1

                            x!0C 1=x.log x/                 2

           D lim x.log x/2 D <

                   x!0C

Example 2.4.7 The product x log.1C1=x/ is of the form 0 1 as x ! 1. Converting
it to a 0=0 form yields

lim x log.1 C 1=x/ D lim log.1 C 1=x/
x!1                         x!1    1=x

           D lim                 OE1=.1 C 1=x/ . 1=x2/

                            x!1                          1=x   2

           D lim                   1                     D 1:

                            x!1 1 C 1=x
94 Chapter 2 Differential Calculus of Functions of One Variable

In this case, converting to an 1=1 form complicates the problem:

        lim x log.1 C 1=x/ D lim               x

        x!1                        x!1 1= log.1 C 1=x/

                                   D lim Â              1
                                                  1 Ã Â 1=x2 Ã
                                       x!1

                                            OElog.1 C 1=x/2 1 C 1=x

                                   D lim x.x C 1/OElog.1 C 1=x/2 D <

                                       x!1

The Indeterminate Form 1 1
A difference f g is of the form 1 1 as x ! b if

                       lim f .x/ D lim g.x/ D 1:
                  x!b              x!b

In this case, it may be possible to manipulate f g into an expression that is no longer
indeterminate, or is of the form 0=0 or 1=1 as x ! b . Similar remarks apply to limits
as x ! bC, x ! b, or x ! 1.

Example 2.4.8 The difference

                                   sin x 1
                                    x2 x

is of the form 1 1 as x ! 0, but it can be rewritten as the 0=0 form

                                   sin x x :
                                      x2

Hence,

                       Â sin x  1 Ã sin x x              cos x 1
                  lim 2            D lim 2 D lim
                  x!0 x         x  x!0 x                 x!0 2x

                                   D lim    sin x D 0:
                                            2
                                       x!0

Example 2.4.9 The difference x2 x

is of the form 1  1 as x ! 1. Rewriting it as

                                   Â 1Ã
                                   x2 1        ;
                                            x

which is no longer indeterminate as x ! 1, we find that

                                               Â 1Ã
                  lim .x2 x/ D lim x2 1
                  x!1              x!1 Á x Â Ã

                                   D lim x2 lim 1 1
                                   x!1         x!1       x

                                   D .1/.1/ D 1
                                             Section 2.4 L'Hospital's Rule 95

The Indeterminate Forms 00, 11, and 10
The function f g is defined by

                         f .x/g.x/ D eg.x/ log f .x/ D exp.g.x/ log f .x//

for all x such that f .x/ > 0. Therefore, if f and g are defined and f .x/ > 0 on an interval

.a; b/, Exercise 2.2.22 implies that

                                      Â                           Ã

                 lim OEf .x/g.x/ D exp lim g.x/ log f .x/                   (2.4.14)
                 x!b                  x!b

if limx!b g.x/ log f .x/ exists in the extended reals. (If this limit is 1 then (2.4.14) is
valid if we define e 1 D 0 and e1 D 1.) The product g log f can be of the form 0 1
in three ways as x ! b :

(a) If limx!b g.x/ D 0 and limx!b f .x/ D 0.
(b) If limx!b g.x/ D 1 and limx!b f .x/ D 1.
(c) If limx!b g.x/ D 0 and limx!b f .x/ D 1.

In these three cases, we say that f g is of the form 00, 11, and 10, respectively, as x !
b . Similar definitions apply to limits as x ! bC, x ! b, and x ! 1.

Example 2.4.10 The function xx is of the form 00 as x ! 0C. Since
                                               xx D ex log x

and limx!0C x log x D 0 (Example 2.4.6),
                                           lim xx D e0 D 1:

                                                            x!0C

 Example 2.4.11 The function x1=.x 1/ is of the form 11 as x ! 1. Since
                                                          Â log x Ã

                                       x1=.x 1/ D exp
                                                             x1

and
                                    lim log x D lim 1=x D 1;
                                   x!1 x 1 x!1 1

it follows that

                      lim x1=.x 1/ D e1 D e:

                      x!1

Example 2.4.12 The function x1=x is of the form 10 as x ! 1. Since
                                                          Â log x Ã

                                            x1=x D exp
                                                               x

and

                      lim log x D lim 1=x D 0;
                      x!1 x           x!1 1
96 Chapter 2 Differential Calculus of Functions of One Variable

it follows that

                                lim x1=x D e0 D 1:

                               x!1

                                 2.4 Exercises

1. Prove Theorem 2.4.1 for the case where limx!b f 0.x/=g0.x/ D 1.

In Exercises 2.4.2-2.4.40, find the indicated limits.

            tan 1 x            3. lim 2 1 cos x        4. lim x 1 C cos x
2. lim 1                             x!0 log.1 C x /         x!0C e 1

      x!0 sin x

5. lim sin nx                  6. lim log.1 C x/       7. lim ex sin e x2
      x! sin x                 x!0  x
                                                                x!1

8. lim x sin.1=x/              9. lim px.e 1=x 1/ 10. lim tan x log x
x!1                            x!1                     Ä x!0C

11. lim sin x log.j tan xj/         12. lim 1 C log.tan x/
x!                                     x!0C x
                                                       Â 1 1Ã
     p                 p            14. lim x
13. lim . x C 1 x/                          x!0 e 1 x
                                                       Â 1 1Ã
            x!1

15. lim .cot x csc x/               16. lim
x!0                                    x!0 sin x x

17. lim j sin xjtan x               18. lim j tan xjcosx

            x!                                  x! =2

19. lim j sin xjx                   20. lim .1 C x/1=x
                                            x!0 Â Ã
            x!0
                                    22. lim x 2
21. lim xsin.1=x/                           x!0 1 cos x x

            x!1                     24. lim log.log x/
                                            x!e sin.x e/
23. lim x log x                                     Â x C 1 Ãpx2 1

            x!0C                    26. lim
                                            x!1C x 1
               Â x C 1 Ãpx2 1
25. lim

        x!1 x 1

27. lim .log x/                     28. lim .cosh x sinh x/
        x!1 x
                                                x!1
29. lim .x log x/
                                    30. lim ex2 sin.ex /
            x!1
                                                x! 1
                                                   Section 2.4 L'Hospital's Rule 97

31. lim x.x C 1/ OElog.1 C 1=x/2      32. lim    sin x x C x3=6

            x!1                             x!0        x  5

               ex                     34. lim etanx cos x
33. lim 
                                                  x!3 =2
        x!1 x
35. lim .log x/ log.log x/            36. lim xx
                                              x!1 x log x
            x!1C

37. lim .sin x/tan x

            x! =2

         ex  Xn  xrrS

38. lim n rD0x           .n D integer 1/
x!0

         sin x Xn . 1/r x2rC1
                rD0 .2r C 1/S
39. lim                               .n D integer 0/
x!0              x    2nC1

              e 1=x2
40. lim n D 0 (n D integer)

        x!0 x

41. (a) Prove: If f is continuous at x0 and limx!x0 f 0.x/ exists, then f 0.x0/ exists
               and f 0 is continuous at x0.

(b) Give an example to show that it is necessary to assume in (a) that f is con-

         tinuous at x0.

42. The iterated logarithms are defined by L0.x/ D x and

                         Ln.x/ D log.Ln 1.x//; x > an; n 1;

        where a1 D 0 and an D ean 1; n 1. Show that

       (a) Ln.x/ D Ln 1.log x/; x > an; n 1.
       (b) Ln 1.anC/ D 0 and Ln.anC/ D 1.
       (c) lim .Ln 1.x// Ln.x/ D 0 if  > 0 and n 1.

                      x!an C

       (d) lim .Ln.x// =Ln 1.x/ D 0 if  is arbitrary and n 1.

                      x!1

43. Let f be positive and differentiable on .0; 1/, and suppose that

                         lim  f 0.x/  D L;  where  0 < L Ä 1:

                         x!1 f .x/

Define f0.x/ D x and

                              fn.x/ D f .fn 1.x// ; n 1:

Use L'Hospital's rule to show that
                     lim .fn.x// D 1 if  > 0 and n 1:
                    x!1 fn 1.x/
98 Chapter 2 Differential Calculus of Functions of One Variable

44. Let f be differentiable on some deleted neighborhood N of x0, and suppose that f
        and f 0 have no zeros in N . Find

(a) lim jf .x/jf .x/ if lim f .x/ D 0;
    x!x0       x!x0

(b) lim jf .x/j1=.f .x/ 1/ if lim f .x/ D 1;
    x!x0             x!x0

(c) lim jf .x/j1=f .x/ if limx!x0 f .x/ D 1.

          x!x0

45. Suppose that f and g are differentiable and g0 has no zeros on .a; b/. Suppose also
        that limx!b f 0.x/=g0.x/ D L and either

               lim f .x/ D lim g.x/ D 0
               x!b                      x!b

or

          lim f .x/ D 1 and lim g.x/ D 1:
          x!b                           x!b

        Find limx!b .1 C f .x//1=g.x/ .

46. We distinguish between 1 1 .D 1/ and . 1/1 .D 1/ and between 1 C 1
        .D 1/ and 1 1 .D 1/. Why don't we distinguish between 0 1 and
        0 . 1/, 1 1 and 1 C 1, 1=1 and 1=1, and 11 and 1 1?

2.5 TAYLOR'S THEOREM

A polynomial is a function of the form

          p.x/ D a0 C a1.x x0/ C C an.x x0/n;                        (2.5.1)

where a0, . . . , an and x0 are constants. Since it is easy to calculate the values of a polyno-
mial, considerable effort has been devoted to using them to approximate more complicated
functions. Taylor's theorem is one of the oldest and most important results on this question.

   The polynomial (2.5.1) is said to be written in powers of x x0, and is of degree n if
an ¤ 0. If we wish to leave open the possibility that an D 0, we say that p is of degree
Ä n. In particular, a constant polynomial p.x/ D a0 is of degree zero if a0 ¤ 0. If
a0 D 0, so that p vanishes identically, then p has no degree according to our definition,
which requires at least one coefficient to be nonzero. For convenience we say that the
identically zero polynomial p has degree 1. (Any negative number would do as well as

  1. The point is that with this convention, the statement that p is a polynomial of degree
Ä n includes the possibility that p is identically zero.)

Taylor Polynomials
We saw in Lemma 2.3.2 that if f is differentiable at x0, then

                       f .x/ D f .x0/ C f 0.x0/.x x0/ C E.x/.x x0/;
                                                            Section 2.5 Taylor's Theorem 99

where

                                       lim E.x/ D 0:

                                      x!x0

To generalize this result, we first restate it: the polynomial

            T1.x/ D f .x0/ C f 0.x0/.x x0/;

which is of degree Ä 1 and satisfies                    T10.x0/ D f 0.x0/;        (2.5.2)
                               T1.x0/ D f .x0/;         T1.x/ D 0:
                                                        x0
approximates f so well near x0 that
                                              f .x/

                                        lim
                                       x!x0 x

Now suppose that f has n derivatives at x0 and Tn is the polynomial of degree Ä n

such that

            Tn.r/.x0/ D f .r/.x0/; 0 Ä r Ä n:                                     (2.5.3)

How well does Tn approximate f near x0?

   To answer this question, we must first find Tn. Since Tn is a polynomial of degree Ä n,
it can be written as

            Tn.x/ D a0 C a1.x x0/ C C an.x x0/n;                                  (2.5.4)

where a0, . . . , an are constants. Differentiating (2.5.4) yields

            Tn.r/.x0/ D r Sar ; 0 Ä r Ä n;

so (2.5.3) determines ar uniquely as

            ar D                      f .r/.x0/      ;  0 Ä r Ä n:

                                       rS

Therefore,

            Tn.x/ D f .x0/ C  f 0.x0/  .x            x0/ C  C f .n/.x0/ .x  x0/n
                                                                   nS
                              1S

               Xn f .r/.x0/            x0/r :
            D r S .x

                r D0

We call Tn the nth Taylor polynomial of f about x0.
   The following theorem describes how Tn approximates f near x0.

Theorem 2.5.1 If f .n/.x0/ exists for some integer n                1 and Tn is the nth Taylor
polynomial of f about x0; then                                                               (2.5.5)

                                      f .x/ Tn.x/
                              lim                       n D 0:
                              x!x0 .x x0/
100 Chapter 2 Differential Calculus of Functions of One Variable

Proof The proof is by induction. Let Pn be the assertion of the theorem. From (2.5.2)

we know that (2.5.5) is true if n D 1; that is, P1 is true. Now suppose that Pn is true for
some integer n 1, and f .nC1/ exists. Since the ratio

                                          f .x/ TnC1.x/
                                            .x x0/nC1

is indeterminate of the form 0=0 as x ! x0, L'Hospital's rule implies that

              f .x/            TnC1 .x /  D     1   lim       f 0.x/    Tn0C1 .x /  (2.5.6)
        lim                                                             x0/n
       x!x0 .x                 x0/nC1           n C 1 x!x0 .x

if the limit on the right exists. But f 0 has an nth derivative at x0, and

                      Tn0C1.x/ D          Xn f .rC1/.x0/      .x  x0/r

                                          rD0 r S

is the nth Taylor polynomial of f 0 about x0. Therefore, the induction assumption, applied

to f 0, implies that                  f 0.x/    Tn0C1.x/ D 0:
                                lim             x0/n
                               x!x0 .x

This and (2.5.6) imply that

                                lim nC1 f .x/ TnC1.x/ D 0;
                               x!x0 .x x0/

which completes the induction.

It can be shown (Exercise 2.5.8) that if

                      pn D a0 C a1.x x0/ C C an.x x0/n

is a polynomial of degree Ä n such that

                                          f .x/ pn.x/
                                     lim            n D 0;
                                     x!x0 .x x0/

then                                            f .r/.x0/

                                          ar D  rS         I

that is, pn D Tn. Thus, Tn is the only polynomial of degree Ä n that approximates f near

x0 in the manner indicated in (2.5.5).

Theorem 2.5.1 can be restated as a generalization of Lemma 2.3.2.

Lemma 2.5.2 If f .n/.x0/ exists; then

                      f .x/ D  Xn f .r/.x0/     x0/r C En.x/.x          x0 /n ;
                                           .x                                       (2.5.7)
                                     rS
                               r D0

where

                                lim En.x/ D En.x0/ D 0:

                               x!x0
                                                   Section 2.5 Taylor's Theorem 101

Proof Define

                          8           Tn.x/ ;      x 2 Df   fx0g;
                          <f .x/      x0/n         x D x0:
              En.x/ D : .x

                            0;

Then (2.5.5) implies that limx!x0 En.x/ D En.x0/ D 0, and it is straightforward to verify
(2.5.7).

Example 2.5.1 If f .x/ D ex, then f .n/.x/ D ex. Therefore, f .n/.0/ D 1 for n 0,
so the nth Taylor polynomial of f about x0 D 0 is

                             Xn xr            x x2             xn
              Tn.x/ D r S D 1 C 1S C 2S C                   C nS :  (2.5.8)

                             r D0

Theorem 2.5.1 implies that        ex      Xn xr    D 0:
(See also Exercise 2.4.38.)  lim
                                          rD0 r S
                             x!0          xn

Example 2.5.2 If f .x/ D log x, then f .1/ D 0 and

                   f .r/.x/ D . 1/ xr .r 1/ .r 1/S ; r 1;

so the nth Taylor polynomial of f about x0 D 1 is

                             Tn.x/ D  Xn . 1/r 1   .x 1/r

                                      r D1 r

if n 1. (T0 D 0.) Theorem 2.5.1 implies that

                   log x     Xn    . 1/r 1r .x 1/r

              lim n rD1                             D 0; n 1:
              x!1                  .x 1/

Example 2.5.3 If f .x/ D .1 C x/q , then

                            f 0.x/ D q.1 C x/q 1
                           f 00.x/ D q.q 1/.1 C x/q 2

                                     ::
                                     :
                         f .n/.x/ D q.q 1/ .q n C 1/.1 C x/q n:
102 Chapter 2 Differential Calculus of Functions of One Variable

If we define      !         !
                 q
                 0 D 1 and  q D q.q 1/ .q n C 1/ ; n 1;
                            n                            nS

then                                                     !

                               f .n/.0/ q
                                         nS D n ;

and the nth Taylor polynomial of f about 0 can be written as

                                       Xn             !                (2.5.9)
                            Tn.x/ D                  q xr:
                                                     r
                                            r D0

Theorem 2.5.1 implies that

                            .1 C x/q      n!         xr
                                         Xq

                 lim                     r D0 r          D 0; n 0:

                 x!0                  x  n

If q is a nonnegative integer, then       !
                                         q

                                              is the binomial coefficient defined in Exer-
                                         n

cise 1.2.19. In this case, we see from (2.5.9) that

                 Tn.x/ D .1 C x/q D f .x/; n q:

Applications to Finding Local Extrema

Lemma 2.5.2 yields the following theorem.

Theorem 2.5.3 Suppose that f has n derivatives at x0 and n is the smallest positive
integer such that f .n/.x0/ ¤ 0:

(a) If n is odd; x0 is not a local extreme point of f:

(b) If n is even; x0 is a local maximum of f if f .n/.x0/ < 0; or a local mininum of f if
      f .n/.x0/ > 0:

Proof  Since f .r/.x0/ D 0 for 1 Ä r Ä n 1, (2.5.7) implies that

                                      "                      #
                 f .x/ f .x f .n/.x0/ 0/ D C En.x/ .x x0/n
                                            nS                         (2.5.10)

in some interval containing x0. Since limx!x0 En.x/ D 0 and f .n/.x0/ ¤ 0, there is a

i > 0 such that   jEn.x/j <  f .n/.x0/          

                             nS                      if jx   x0j < i:
                                            Section 2.5 Taylor's Theorem 103

This and (2.5.10) imply that

                              f .x/ f .x0/                                    (2.5.11)
                                .x x0/n

has the same sign as f .n/.x0/ if 0 < jx x0j < i. If n is odd the denominator of (2.5.11)

changes sign in every neighborhood of x0, and therefore so must the numerator (since the

ratio has constant sign for 0 < jx x0j < i). Consequently, f .x0/ cannot be a local
extreme value of f . This proves (a). If n is even, the denominator of (2.5.11) is positive
for x ¤ x0, so f .x/ f .x0/ must have the same sign as f .n/.x0/ for 0 < jx x0j < i.
This proves (b).

For n D 2,(b) is called the second derivative test for local extreme points.

 Example 2.5.4 If f .x/ D ex3 , then f 0.x/ D 3x2ex3, and 0 is the only critical point
 of f . Since

                                   f 00.x/ D .6x C 9x4/ex3

and
                                   f 000.x/ D .6 C 54x3 C 27x6/ex3 ;

 f 00.0/ D 0 and f 000.0/ ¤ 0. Therefore, Theorem 2.5.3 implies that 0 is not a local extreme
 point of f . Since f is differentiable everywhere, it has no local maxima or minima.

Examplep2.5.5 If f .x/ D sin x2, then f 0.x/ D 2x cos x2, so the critical points of f
are 0 and  .k C 1=2/ , k D 0; 1; 2; : : : . Since

                                   f 00.x/ D 2 cos x2 4x2 sin x2;
              f 00.0/ D 2 and f 00 p.k C 1=2/ / D . 1/ Á kC1.4k C 2/ :

                                                                                       p
Therefore, Theorem 2.5.3 implies that pf attains local minima at 0 and  .k C 1=2/ for
odd integers k, and local maxima at  .k C 1=2/ for even integers k.

Taylor's theorem

Theorem 2.5.1 implies that the error in approximating f .x/ by Tn.x/ approaches zero
faster than .x x0/n as x approaches x0; however, it gives no estimate of the error in

approximating f .x/ by Tn.x/ for a fixed x. For instance, it provides no estimate of the

error in the approximation

e0:1 T 0:1 .0:1/2 2.0:1/ D 1 C C D 1:105                                      (2.5.12)
                              1S            2S

obtained by setting n D 2 and x D 0:1 in (2.5.8). The following theorem provides a way
of estimating errors of this kind under the additional assumption that f .nC1/ exists in a

neighborhood of x0.
104 Chapter 2 Differential Calculus of Functions of One Variable

Theorem 2.5.4 (Taylor's Theorem) Suppose that f .nC1/ exists on an open in-
terval I about x0; and let x be in I: Then the remainder

                   Rn.x/ D f .x/ Tn.x/

can be written as              f .nC1/.c/
                   Rn.x/ D .n C 1/S .x
                                                             x0 /nC1 ;

where c depends upon x and is between x and x0:

   This theorem follows from an extension of the mean value theorem that we will prove
below. For now, let us assume that Theorem 2.5.4 is correct, and apply it.

Example 2.5.6 If f .x/ D ex, then f 000.x/ D ex, and Theorem 2.5.4 with n D 2

implies that

                   ex D 1 C x C x C ; 2 ecx3
                                      2S 3S

where c is between 0 and x. Hence, from (2.5.12),

                   e0:1 D 1:105 C ec.0:1/3 ;
                                           6

where 0 < c < 0:1. Since 0 < ec < e0:1, we know from this that

                   1:105 < e0:1 < 1:105 C e0:1.0:1/3 :
                                                       6

The second inequality implies that            .0:1/3
                                           Ä            < 1:105;

                                     e0:1 1     6

so
                                             e0:1 < 1:1052:

Therefore,

                   1:105 < e0:1 < 1:1052;

and the error in (2.5.12) is less than 0:0002.

Example 2.5.7 In numerical analysis, forward differences are used to approximate
derivatives. If h > 0, the first and second forward differences with spacing h are defined
by

                                     f .x/ D f .x C h/ f .x/

and                                                                        (2.5.13)
             2f .x/ D  OEf .x/ D f .x C h/ f .x/
                                         D f .x C 2h/ 2f .x C h/ C f .x/:

Higher forward differences are defined inductively (Exercise 2.5.18).
                                                      Section 2.5 Taylor's Theorem 105

     We will find upper bounds for the magnitudes of the errors in the approximations

                                 f 0.x0/      f .x0/                                (2.5.14)
                                                  h

and

                                 f 00.x0/     2f .x0/                               (2.5.15)
                                                  h2 :

   If f 00 exists on an open interval containing x0 and x0 C h, we can use Theorem 2.5.4 to
estimate the error in (2.5.14) by writing

                        f .x0 C h/ D f .x0/ C f 0.x f 00.c/h2 0/h C ;               (2.5.16)
                                                                       2

where x0 < c < x0 C h. We can rewrite (2.5.16) as

                        f .x0 C h/    f .x0/  f 0.x f 0.c/h 0/ D ;
                                   h                          2

which is equivalent to           f .x0/      f 0.x f 00.c/h 0/ D :
Therefore,                           h                       2

                                                       
                                  f .x0/  h   f 0.x  0/ M2h  Ä ;

                                                              2

where M2 is an upper bound for jf 00j on .x0; x0 C h/.
   If f 000 exists on an open interval containing x0 and x0 C 2h, we can use Theorem 2.5.4

to estimate the error in (2.5.15) by writing

     f .x0 C h/ D f .x0/ C hf 0.x0/ C h f 2 00.x0/ C h f 3 000.c0/
                                              2                     6

and
                 f .x0 C 2h/ D f .x0/ C 2hf 0.x0/ C 2h2f 00.x 4h3 0/ C f 000.c1/;
                                                                                 3

where x0 < c0 < x0 C h and x0 < c1 < x0 C 2h. These two equations imply that
                                                          Ä
     f .x0 C 2h/ 2f .x0 C h/ C f .x0/ D h2f 00.x0/ C 4 f 000.c1/ 1 f 000.c0/ h3;
                                                             3            3

which can be rewritten as                     Ä           1 f 000.c0/ h;
                                                4 000     3
                        2f .x0/
                            h2   f 00.x0/ D f .c1/
                                                3

because of (2.5.13). Therefore,                       
                                   2f .x0/   f 00.x  0/ 5M3h  Ä ;
                                   h2
                                                              3

where M3 is an upper bound for jf 000j on .x0; x0 C 2h/.
106 Chapter 2 Differential Calculus of Functions of One Variable

The Extended Mean Value Theorem

We now consider the extended mean value theorem, which implies Theorem 2.5.4 (Exer-
cise 2.5.24). In the following theorem, a and b are the endpoints of an interval, but we do
not assume that a < b.

Theorem 2.5.5 (Extended Mean Value Theorem) Suppose that f is con-
tinuous on a finite closed interval I with endpoints a and b .that is, either I D .a; b/ or
I D .b; a//; f .nC1/ exists on the open interval I 0; and; if n > 0; that f 0, . . . , f .n/ exist

and are continuous at a: Then

                    f .b/     Xn f .r/.a/       a/r D f .b .nC1/.c/  a/nC1    (2.5.17)
                                            .b           .n C 1/S

                              rD0 r S

for some c in I 0:

Proof The proof is by induction. The mean value theorem (Theorem 2.3.11) implies
the conclusion for n D 0. Now suppose that n 1, and assume that the assertion of the
theorem is true with n replaced by n 1. The left side of (2.5.17) can be written as

                      f .b/   Xn f .r/.a/        a/r D K .b a/nC1             (2.5.18)
                                             .b               .n C 1/S

                              rD0 r S

for some number K. We must prove that K D f .nC1/.c/ for some c in I 0. To this end,
consider the auxiliary function

                    h.x/ D f .x/ Xn f .r/.a/ .x a/r K .x a/nC1 ;
                              rD0 r S                      .n C 1/S

which satisfies

                              h.a/ D 0; h.b/ D 0;

(the latter because of (2.5.18)) and is continuous on the closed interval I and differentiable

on I 0, with

                 n h0.x/ D f 0.x/ X1 f .rC1/.a/ .x a/r K .x a/n :             (2.5.19)
                                      rD0 r S nS

Therefore, Rolle's theorem (Theorem 2.3.8) implies that h0.b1/ D 0 for some b1 in I 0;

thus, from (2.5.19),

                    f 0.b1/   nX1 f .rC1/.a/    .b1 a/r K  .b1 a/n      D 0:

                              rD0 r S nS

If we temporarily write f 0 D g, this becomes

                      g.b1 /  nX1 g.r/.a/  .b1 a/r K  .b1 a/n        D 0:     (2.5.20)

                              rD0 r nS
                                                  Section 2.5 Taylor's Theorem 107

Since b1 2 I 0, the hypotheses on f imply that g is continuous on the closed interval J
with endpoints a and b1, g.n/ exists on J 0, and, if n 1, g0, . . . , g.n 1/ exist and are

continuous at a (also at b1, but this is not important). The induction hypothesis, applied to

g on the interval J , implies that

        g.b1 /  nX1 g.r/.a/  .b1 a/r D            g.n/ .c /  .b1 a/n

                rD0 r S nS

for some c in J 0. Comparing this with (2.5.20) and recalling that g D f 0 yields

                      K D g.n/.c/ D f .nC1/.c/:

Since c is in I 0, this completes the induction.

                      2.5 Exercises

1. Let                f .x/ D e 1=x2 ; x ¤ 0;

                                         0;       x D 0:

Show that f has derivatives of all orders on . 1; 1/ and every Taylor polynomial

of f about 0 is identically zero. HINT: See Exer ci se 2.4.40:

2. Suppose that f .nC1/.x0/ exists, and let Tn be the nth Taylor polynomial of f about

x0. Show that the function               Tn.x/ ;  x 2 Df     fx0g;
                                 8       x0/n     x D x0;
                                 <f .x/

                     En.x/ D : .x
                                   0;

      is differentiable at x0, and find En0 .x0/.
3. (a) Prove: If f is continuous at x0 and there are constants a0 and a1 such that

                      lim f .x/ a0 a1.x x0/ D 0;
                      x!x0                        x x0

      then a0 D f .x0/, f 0 is differentiable at x0, and f 0.x0/ D a1.
(b) Give a counterexample to the following statement: If f and f 0 are continuous

      at x0 and there are constants a0, a1, and a2 such that

                lim   f .x/ a0 a1.x x0/ a2.x x0/2                     D 0;

                x!x0                              .x x0/2

             then f 00.x0/ exists.
4. (a) Prove: if f 00.x0/ exists, then

                lim f .x0 C h/           2f .x0/ C f .x0     h/ D f 00.x0/:
                                           h2
                h!0
108 Chapter 2 Differential Calculus of Functions of One Variable

     (b) Prove or give a counterexample: If the limit in (a) exists, then so does
             f 00.x0/, and they are equal.

5. A function f has a simple zero (or a zero of multiplicity 1) at x0 if f is differentiable
      in a neighborhood of x0 and f .x0/ D 0, while f 0.x0/ ¤ 0.

     (a) Prove that f has a simple zero at x0 if and only if

                   f .x/ D g.x/.x x0/;

             where g is continuous at x0 and differentiable on a deleted neighborhood of
             x0, and g.x0/ ¤ 0.
     (b) Give an example showing that g in(a) need not be differentiable at x0.
6. A function f has a double zero (or a zero of multiplicity 2) at x0 if f is twice dif-
      ferentiable on a neighborhood of x0 and f .x0/ D f 0.x0/ D 0, while f 00.x0/ ¤ 0.
     (a) Prove that f has a double zero at x0 if and only if

                                             f .x/ D g.x/.x x0/2;

where g is continuous at x0 and twice differentiable on a deleted neighborhood
of x0, g.x0/ ¤ 0, and

                                 lim .x x0/g0.x/ D 0:

                                             x!x0

(b) Give an example showing that g in(a) need not be differentiable at x0.

7. Let n be a positive integer. A function f has a zero of multiplicity n at x0 if f
      is n times differentiable on a neighborhood of x0, f .x0/ D f 0.x0/ D D

f .n 1/.x0/ D 0 and f .n/.x0/ ¤ 0. Prove that f has a zero of multiplicity n at

x0 if and only if  f .x/ D g.x/.x x0/n;

where g is continuous at x0 and n times differentiable on a deleted neighborhood of
x0, g.x0/ ¤ 0, and

                    lim .x x0/j g.j /.x/ D 0; 1 Ä j Ä n 1:

                   x!x0

HINT: Use Exercise 2.5.6 and induction:

8. (a) Let                                     C n.x x0/n

                   Q.x/ D 0 C 1.x x0/ C

be a polynomial of degree Ä n such that

                   lim                   Q.x/  n D 0:

                   x!x0 .x x0/

Show that 0 D 1 D D n D 0.
                                                  Section 2.5 Taylor's Theorem 109

(b) Suppose that f is n times differentiable at x0 and p is a polynomial
                         p.x/ D a0 C a1.x x0/ C C an.x x0/n

of degree Ä n such that

                              f .x/ p.x/
                         lim                      n D 0:
                         x!x0 .x x0/

Show that                     f .r/.x0/

                       ar D   rS                  if 0 Ä r Ä nI

that is, p D Tn, the nth Taylor polynomial of f about x0.

9. Show that if f .n/.x0/ and g.n/.x0/ exist and

                              f .x/ g.x/
                         lim                      n D 0;
                         x!x0 .x x0/

        then f .r/.x0/ D g.r/.x0/, 0 Ä r Ä n.

10. (a) Let Fn, Gn, and Hn be the nth Taylor polynomials about x0 of f , g, and
               their product h D fg. Show that Hn can be obtained by multiplying Fn
               by Gn and retaining only the powers of x x0 through the nth. HINT: Use
               Exercise 2.5.8.b/:

       (b) Use the method suggested by (a) to compute h.r/.x0/, r D 1; 2; 3; 4.
                (i) h.x/ D ex sin x; x0 D 0
               (ii) h.x/ D .cos x=2/.log x/; x0 D 1

              (iii) h.x/ D x2 cos x; x0 D =2
              (iv) h.x/ D .1 C x/ 1e x; x0 D 0

11. (a) It can be shown that if g is n times differentiable at x and f is n times dif-
               ferentiable at g.x/, then the composite function h.x/ D f .g.x// is n times
               differentiable at x and

           Xn            X                        Â 0 Ãr1 Â 00 Ãr2  g.n/ .x /!rn
.n/              .r /             r S g .x/ g .x/                      nS
h .x/ D f .g.x//
                             r r1S rnS 1S                 2S
           r D1

        P
where r is over all n-tuples .r1; r2; : : : ; rn/ of nonnegative integers such that

                                  r1 C r2 C C rn D r
and

                              r1 C 2r2 C C nrn D n:

(This is Faa di Bruno's formula). However, this formula is quite complicated.
Justify the following alternative method for computing the derivatives of a
composite function at a point x0:
110 Chapter 2 Differential Calculus of Functions of One Variable

               Let Fn be the nth Taylor polynomial of f about y0 D g.x0/, and let Gn and
               Hn be the nth Taylor polynomials of g and h about x0. Show that Hn can
               be obtained by substituting Gn into Fn and retaining only powers of x x0
               through the nth. HINT: See Exercise 2.5.8.b/:

       (b) Compute the first four derivatives of h.x/ D cos.sin x/ at x0 D 0, using the
             method suggested by (a).

12. (a) If g.x0/ ¤ 0 and g.n/.x0/ exists, then the reciprocal h D 1=g is also n times
             differentiable at x0, by Exercise 2.5.11(a), with f .x/ D 1=x. Let Gn and Hn
             be the nth Taylor polynomials of g and h about x0. Use Exercise 2.5.11(a) to
               prove that if g.x0/ D 1, then Hn can be obtained by expanding the polynomial

                                  Xn       Gn.x/r
                                      OE1

                                  r D1

in powers of x x0 and retaining only powers through the nth.

(b) Use the method of (a) to compute the first four derivatives of the following

functions at x0.

 (i)         h.x/ D csc x; x0 D =2
(ii)         h.x/ D .1 C x C x2/ 1; x0 D 0
(iii)
(iv)         h.x/ D sec x; x0 D =4
             h.x/ D OE1 C log.1 C x/ 1 ; x0 D 0

(c) Use Exercise 2.5.10 to justify the following alternative procedure for obtaining

Hn, again assuming that g.x0/ D 1: If

                      Gn.x/ D 1 C a1.x x0/ C C an.x x0/n

(where, of course, ar D g.r/.x0/=r S/ and

                   Hn.x/ D b0 C b1.x x0/ C C bn.x x0/n;

then                                Xk

                      b0 D 1; bk D         ar bk r ; 1 Ä k Ä n:

                                    r D1

13. Determine whether x0 D 0 is a local maximum, local minimum, or neither.

(a) f .x/ D x2ex3                          (b) f .x/ D x3ex2

(c) f .x/ D  1 C x2                        (d) f .x/ D  1 C x3

             1Cx   3                                    1Cx       2

(e) f .x/ D x2 sin3 x C x2 cos x           (f ) f .x/ D ex2 sin x

(g) f .x/ D ex sin x2                      (h) f .x/ D ex2 cos x

14. Give an example of a function that has zero derivatives of all orders at a local mini-
        mum point.
                                               Section 2.5 Taylor's Theorem 111

15. Find the critical points of

                                           x3 bx2
                                 f .x/ D 3 C 2 C cx C d

and identify them as local maxima, local minima, or neither.

16. Find an upper bound for the magnitude of the error in the approximation.

(a) sin x x; jxj < 20
(b) p1 C x 1 C x ; jxj < 1
                      2             8

(c) cos x p                      1

               2 1 x 4 ; 4 < x < 16            5

(d) log x      .x 1/             .x 1/2 .x 1/3                1
                                     2 C 3 ; jx        1j < 64

17. Prove: If

                                            Xn xr
                                 Tn.x/ D r S ;

                                                 r D0

xnC1 then Ä 1
               Tn.x/ < TnC1.x/ < ex < 1                         Tn.x/
                                                      .n C 1/S

if 0 < x < OE.n C 1/S1=.nC1/.

18. The forward difference operators with spacing h > 0 are defined by

               0f .x/ D f .x/; f .x/ D f .x C h/ f .x/;

                      nC1f .x/ D  OEnf .x/ ; n 1:

(a) Prove by induction on n: If k 2, c1, . . . , ck are constants, and n 1, then
             nOEc1f1.x/ C C ckfk .x/ D c1nf1.x/ C C cknfk .x/:

(b) Prove by induction: If n 1, then

                                    Xn         1/n m    !
                      nf .x/ D .                      n
                                                      m f .x C mh/:
                                          mD0

HINT: See Exercise 1.2.19:

In Exercises 2.5.19-2.5.22,  is the forward difference operator with spacing h > 0.
112 Chapter 2 Differential Calculus of Functions of One Variable

19. Let m and n be nonnegative integers, and let x0 be any real number. Prove by
        induction on n that

n.x x0/m D nShn 0 if 0 Ä m Ä n; if m D n:

        Does this suggest an analogy between "differencing" and differentiation?
20. Find an upper bound for the magnitude of the error in the approximation

f 00.x0/     2f .x0 h/ ;
                   h2

       (a) assuming that f 000 is bounded on .x0 h; x0 C h/;
       (b) assuming that f .4/ is bounded on .x0 h; x0 C h/.

21. Let f 000 be bounded on an open interval containing x0 and x0 C 2h. Find a constant
        k such that the magnitude of the error in the approximation

f 0.x0/   f .x0/ 2f .x0/h  h
                    Ck 2

is not greater than M h2, where M D sup °jf 000.c/j  jx0 < c < x0«.

22. Prove: If f .nC1/ is bounded on an open interval containing x0 and x0 C nh, then

 nf .x0/              
 hn
          f  .n/ .x0 /  Ä  An MnC1 h;
                     

where An is a constant independent of f and

                             MnC1 D sup jf .nC1/.c/j:

                                                           x0 <c <x0Cnh

        HINT: See Exercises 2.5.18 and 2.5.19:
23. Suppose that f .nC1/ exists on .a; b/, x0, . . . , xn are in .a; b/, and p is the polyno-

        mial of degree Ä n such that p.xi / D f .xi /, 0 Ä i Ä n. Prove: If x 2 .a; b/,
        then

                                            f .nC1/.c/
                       f .x/ D p.x/ C .n C 1/S .x x0/.x x1/ .x xn/;

        where c, which depends on x, is in .a; b/. HINT: Let x be fixed; distinct from x0;
        x1; . . . , xn; and consider the function

                                                     K
                    g.y/ D f .y/ p.y/ .n C 1/S .y x0/.y x1/ .y xn/;

        where K is chosen so that g.x/ D 0: Use Rolle's theorem to show that K D
        f .nC1/.c/ for some c in .a; b/:

24. Deduce Theorem 2.5.4 from Theorem 2.5.5.
                                       CHAPTER 3

                                  Integral Calculus of
                             Functions of One Variable

IN THIS CHAPTER we discuss the Riemann on a finite interval OEa; b, and improper inte-
grals in which either the function or the interval of integration is unbounded.
SECTION 3.1 begins with the definition of the Riemann integral and presents the geo-
metrical interpretation of the Riemann integral as the area under a curve. We show that
an unbounded function cannot be Riemann integrable. Then we define upper and lower
sums and upper and lower integrals of a bounded function. The section concludes with the
definition of the Riemann-Stieltjes integral.
SECTION 3.2 presents necessary and sufficient conditions for the existence of the Riemann
integral in terms of upper and lower sums and upper and lower integrals. We show that
continuous functions and bounded monotonic functions are Riemann integrable.
SECTION 3.3 begins with proofs that the sum and product of Riemann integrable functions
are integrable, and that jf j is Riemann integrable if f is Riemann integrable. Other topics
covered include the first mean value theorem for integrals, antiderivatives, the fundamental
theorem of calculus, change of variables, integration by parts, and the second mean value
theorem for integrals.
SECTION 3.4 presents a comprehensive discussion of improper integrals. Concepts de-
fined and considered include absolute and conditional convergence of an improper integral,
Dirichlet's test, and change of variable in an improper integral.
SECTION 3.5 defines the notion of a set with Lebesgue measure zero, and presents a
necessary and sufficient condition for a bounded function f to be Riemann integrable on
an interval OEa; b; namely, that the discontinuities of f form a set with Lebesgue masure
zero.

3.1 DEFINITION OF THE INTEGRAL

The integral that you studied in calculus is the Riemann integral, named after the German
mathematician Bernhard Riemann, who provided a rigorous formulation of the integral to

                                                    113
114 Chapter 3 Integral Calculus of Functions of One Variable

replace the intuitive notion due to Newton and Leibniz. Since Riemann's time, other kinds

of integrals have been defined and studied; however, they are all generalizations of the

Riemann integral, and it is hardly possible to understand them or appreciate the reasons for

developing them without a thorough understanding of the Riemann integral. In this section

we deal with functions defined on a finite interval OEa; b. A partition of OEa; b is a set of

subintervals

              OEx0; x1; OEx1; x2; : : : ; OExn 1; xn;         (3.1.1)

where

              a D x0 < x1 < xn D b:                           (3.1.2)

Thus, any set of n C 1 points satisfying (3.1.2) defines a partition P of OEa; b, which we

denote by
                                         P D fx0; x1; : : : ; xng:

The points x0, x1, . . . , xn are the partition points of P . The largest of the lengths of the
subintervals (3.1.1) is the norm of P , written as kP k; thus,

              kP k D max .xi xi 1/:

                           1Äi Än

If P and P 0 are partitions of OEa; b, then P 0 is a refinement of P if every partition point
of P is also a partition point of P 0; that is, if P 0 is obtained by inserting additional points
between those of P . If f is defined on OEa; b, then a sum

                 Xn         xj 1/;
              D f .cj /.xj

                  j D1

where

              xj 1 Ä cj Ä xj ; 1 Ä j Ä n;

is a Riemann sum of f over the partition P D fx0; x1; : : : ; xng. (Occasionally we will say
more simply that is a Riemann sum of f over OEa; b.) Since cj can be chosen arbitrarily
in OExj ; xj 1, there are infinitely many Riemann sums for a given function f over a given
partition P .

Definition 3.1.1 Let f be defined on OEa; b. We say that f is Riemann integrable on
OEa; b if there is a number L with the following property: For every > 0, there is a i > 0
such that

                                               j Lj <

if is any Riemann sum of f over a partition P of OEa; b such that kP k < i. In this case,
we say that L is the Riemann integral of f over OEa; b, and write

                                           Zb
                                                f .x/ dx D L:

                                                                a
                                             Section 3.1 Definition of the Integral 115

   We leave it to you (Exercise 3.1.1) to show that a R b f .x/ dx is unique, if it exists; that is,
there cannot be more than one number L that satisfies Definition 3.1.1.

   For brevity we will say "integrable" and "integral" when we mean "Riemann integrable"
                                              Rb

and "Riemann integral." Saying that a f .x/ dx exists is equivalent to saying that f is
integrable on OEa; b.

Example 3.1.1 If

                                f .x/ D 1; a Ä x Ä b;

then                Xn                          Xn

                          f .cj /.xj xj 1/ D .xj xj 1/:

                    j D1                        j D1

Most of the terms in the sum on the right cancel in pairs; that is,

      Xn         xj 1/ D .x1 x0/ C .x2 x1/ C          C .xn xn 1/
          .xj

      j D1

                    D x0 C .x1 x1/ C .x2 x2/ C C .xn 1                      xn 1/ C xn

                    D xn x0

                    D b a:

Thus, every Riemann sum of f over any partition of OEa; b equals b a, so
                                            Zb

                                                 dx D b a:

                                                                 a

Example 3.1.2 Riemann sums for the function

                                f .x/ D x; a Ä x Ä b;

are of the form                    Xn
                                D cj .xj
                                                xj 1/:                                   (3.1.3)
                                                                     1; xj , we can write
                                  j D1
                                                                                         (3.1.4)
Since xj 1 Ä cj Ä xj and .xj C xj 1/=2 is the midpoint of OExj
                                                                                         (3.1.5)
                                cj D xj C xj 1 C dj ;
                                             2

where                       jdj j Ä xj     xj 1 Ä kP k :

                                          2           2

Substituting (3.1.4) into (3.1.3) yields

                    Xn xj C xj 1                      Xn
                 D 2 .xj xj 1/ C dj .xj                              xj 1/

                    j D1                              j D1                  (3.1.6)
                    1 Xn                   Xn
                 D        .xj2  xj2 1/ C dj .xj           xj 1/:
                    2 j D1
                                          j D1
116 Chapter 3 Integral Calculus of Functions of One Variable

Because of cancellations like those in Example 3.1.1,

                                    Xn
                                        .xj2 xj 1 2 / D b2 a2;

                                    j D1

so (3.1.6) can be rewritten as

                                   b2 a2 Xn                    xj 1/:
                                D 2 C dj .xj

                                                         j D1

Hence,  b2     a  2       Xn                              kP k Xn
                                               xj 1/ Ä 2 .xj
                       Ä        jdj j.xj                                      xj 1/ (see (3.1.5))
            2                                                           j D1
     

                          j D1

                       D kP k .b a/:
                            2

Therefore, every Riemann sum of f over a partition P of OEa; b satisfies

                                b2     a  2                                   2
                                             
                                               <  if kP k < i D                   :
                                    2                                         ba

Hence,                                    Z b b2 a2

                                             x dx D       :
                                                     2
                                          a

The Integral as the Area Under a Curve

An important application of the integral, indeed, the one invariably used to motivate its
definition, is the computation of the area bounded by a curve y D f .x/, the x-axis, and
the lines x D a and x D b ("the area under the curve"), as in Figure 3.1.1.

                                    y

                                                               y = f (x)

                                                               b                     x

                                    a

                                             Figure 3.1.1
                                                  Section 3.1 Definition of the Integral 117

   For simplicity, suppose that f .x/ > 0. Then f .cj /.xj xj 1/ is the area of a rectangle
with base xj xj 1 and height f .cj /, so the Riemann sum

   Xn                                             xj 1/
        f .cj /.xj

   j D1

can be interpreted as the sum of the areas of rectangles related to the curve y D f .x/, as
shown in Figure 3.1.2.

y

                                                         y = f (x)

                                                        x
   a c1 x1 c2 x2 c3 x3 c4 b

       Figure 3.1.2

   An apparently plausible argument, that the Riemann sums approximate the area under
the curve more and more closely as the number of rectangles increases and the largest of

                                                                                 Rb
their widths is made smaller, seems to support the assertion that a f .x/ dx equals the
area under the curve. This argument is useful as a motivation for Definition 3.1.1, which
without it would seem mysterious. Nevertheless, the logic is incorrect, since it is based
on the assumption that the area under the curve has been previously defined in some other
way. Although this is true for certain curves such as, for example, those consisting of line
segments or circular arcs, it is not true in general. In fact, the area under a more complicated
curve is defined to be equal to the integral, if the integral exists. That this new definition is
consistent with the old one, where the latter applies, is evidence that the integral provides
a useful generalization of the definition of area.

Example 3.1.3 Let f .x/ D x, 1 Ä x Ä 2 (Figure 3.1.3, page 118). The region under

the curve consists of a square of unit area, surmounted by a triangle of area 1=2; thus, the

area of the region is 3=2. From Example 3.1.2,

   Z2 1 2                                         12/ D 3 ;
    1 x dx D 2 .2                                         2

so the integral equals the area under the curve.
118 Chapter 3 Integral Calculus of Functions of One Variable

                                        y
                                                          y = x

                         1          2                            x

                                    Figure 3.1.3

                      y

                         y = x2

                      1          2                                  x

                         Figure 3.1.4

Example 3.1.4 If      f .x/ D x2; 1 Ä x Ä 2

(Figure 3.1.4), then  Z2 1 3
                       1 f .x/ dx D 3 .2
                                          13/ D 7
                                                  3

(Exercise 3.1.4), so we say that the area under the curve is 7=3. However, this is the defini-
tion of the area rather than a confirmation of a previously known fact, as in Example 3.1.3.
                                                     Section 3.1 Definition of the Integral 119

Theorem 3.1.2 If f is unbounded on OEa; b; then f is not integrable on OEa; b:

Proof We will show that if f is unbounded on OEa; b, P is any partition of OEa; b, and
M > 0, then there are Riemann sums and 0 of f over P such that

                                     j            0j M:                           (3.1.7)

We leave it to you (Exercise 3.1.2) to complete the proof by showing from this that f
cannot satisfy Definition 3.1.1.

Let
                                         Xn

                                     D f .cj /.xj xj 1/

                                                          j D1

be a Riemann sum of f        over a partition P      of OEa; b.     There must be an integer i in
f1; 2; : : : ; ng such that      jf .c/ f .ci /j
                                                           M                                       (3.1.8)
                                                       xi xi
                                                                    1

for some c in OExi 1xi , because if there were not so, we would have

      jf .x/                         M               xj 1 Ä x Ä xj ;  1 Ä j Ä n:
                    f .cj /j < xj xj 1 ;

Then

      jf .x/j D jf .cj / C f .x/ f .cj /j Ä jf .cj /j C jf .x/ f .cj /j

                                         M           xj 1 Ä x Ä xj ;  1 Ä j Ä n:
                    Ä jf .cj /j C xj xj 1 ;

which implies that

                    jf .x/j Ä max jf .cj /j C             M      ;  a Ä x Ä b;

                             1Äj Än                  xj xj 1

contradicting the assumption that f is unbounded on OEa; b.
   Now suppose that c satisfies (3.1.8), and consider the Riemann sum

                             0D      Xn    f  .c  0  /.x     xj 1/
                                                  j
                                                          j

                                     j D1

over the same partition P , where

                                      0 cj ; j ¤ i;
                                     cj D

                                             c; j D i:
120 Chapter 3 Integral Calculus of Functions of One Variable

Since                             0j D jf .c/ f .ci /j.xi xi 1/;
                               j

(3.1.8) implies (3.1.7).

Upper and Lower Integrals

Because of Theorem 3.1.2, we consider only bounded functions throughout the rest of this

section.
                                                       Rb

   To prove directly from Definition 3.1.1 that a f .x/ dx exists, it is necessary to discover
its value L in one way or another and to show that L has the properties required by the

definition. For a specific function it may happen that this can be done by straightforward

calculation, as in Examples 3.1.1 and 3.1.2. However, this is not so if the objective is to find
                                            Rb

general conditions which imply that a f .x/ dx exists. The following approach avoids the
difficulty of having to discover L in advance, without knowing whether it exists in the first

place, and requires only that we compare two numbers that must exist if f is bounded on
                            Rb

OEa; b. We will see that a f .x/ dx exists if and only if these two numbers are equal.

Definition 3.1.3 If f is bounded on OEa; b and P D fx0; x1; : : : ; xng is a partition of
OEa; b, let

                                  Mj D sup f .x/

                                              xj 1ÄxÄxj

and
                                          mj D inf f .x/:

                                                                       xj 1ÄxÄxj

The upper sum of f over P is                                             xj 1/;
                                               Xn

                                    S.P / D Mj .xj

                                                                   j D1

and the upper integral of f over, OEa; b, denoted by

                                    Zb
                                        f .x/ dx;

                                      a

is the infimum of all upper sums. The lower sum of f over P is

                                            Xn                           xj 1/;
                                  s.P / D mj .xj

                                                j D1

and the lower integral of f over OEa; b, denoted by
                                              Zb
                                                   f .x/ dx;

                                                                     a

is the supremum of all lower sums.
                                             Section 3.1 Definition of the Integral 121

   If m Ä f .x/ Ä M for all x in OEa; b, then

                              m.b a/ Ä s.P / Ä S.P / Ä M.b a/

for every partition P ; thus, the set of upper sums of f over all partitions P of OEa; b is
bounded, as is the set of lower sums. Therefore, Theorems 1.1.3 and 1.1.8 imply that
a R bf .x/ dx and a R bf .x/ dx exist, are unique, and satisfy the inequalities

                                               Zb
                               m.b a/ Ä f .x/ dx Ä M.b a/

                                                                     a

and Z b
                               m.b a/ Ä f .x/ dx Ä M.b a/:

                                                                    a

Theorem 3.1.4 Let f be bounded on OEa; b, and let P be a partition of OEa; b: Then
(a) The upper sum S.P / of f over P is the supremum of the set of all Riemann sums of

      f over P:

(b) The lower sum s.P / of f over P is the infimum of the set of all Riemann sums of f
      over P:

Proof (a) If P D fx0; x1; : : : ; xng, then

                        Xn                   xj 1/;
             S.P / D Mj .xj

                            j D1

where

                      Mj D sup f .x/:

                                  xj 1ÄxÄxj

An arbitrary Riemann sum of f over P is of the form

                         Xn                  xj 1/;
                      D f .cj /.xj

                          j D1

where xj 1 Ä cj Ä xj . Since f .cj / Ä Mj , it follows that  Ä S.P /.
   Now let > 0 and choose cj in OExj 1; xj  so that

             f .cj / > Mj n.xj xj 1/ ; 1 Ä j Ä n:

The Riemann sum produced in this way is

       Xn             Xn Ä  Mj n.xj xj 1/ / .xj xj 1/ D S.P / :
D f .cj /.xj xj 1/ >

       j D1           j D1

Now Theorem 1.1.3 implies that S.P / is the supremum of the set of Riemann sums of f
over P .

  (b) Exercise 3.1.7.
122 Chapter 3 Integral Calculus of Functions of One Variable

Example 3.1.5 Let

                   f .x/ D 0 if x is irrational;
                               1 if x is rational;

and P D fx0; x1; : : : ; xng be a partition of OEa; b. Since every interval contains both ratio-
nal and irrational numbers (Theorems 1.1.6 and 1.1.7),

                   mj D 0 and Mj D 1; 1 Ä j Ä n:

Hence,

                             Xn
                   S.P / D 1 .xj xj 1/ D b a

                                  j D1

and

                             Xn   xj 1/ D 0:
                   s.P / D 0 .xj

                   j D1

Since all upper sums equal b a and all lower sums equal 0, Definition 3.1.3 implies that

        Zb                        Zb

          f .x/ dx D b a and        f .x/ dx D 0:

        a                         a

Example 3.1.6 Let f be defined on OE1; 2 by f .x/ D 0 if x is irrational and f .p=q/ D
1=q if p and q are positive integers with no common factors (Exercise 2.2.7). If P D

fx0; x1; : : : ; xng is any partition of OE1; 2, then mj D 0, 1 Ä j Ä n, so s.P / D 0; hence,
                                            Z2

                                                f .x/ dx D 0:

                                                                 1

We now show that Z 2                                                                   (3.1.9)
                                                f .x/ dx D 0

                                                                 1

also. Since S.P / > 0 for every P , Definition 3.1.3 implies that

                   Z2
                       f .x/ dx 0;

                     1

so we need only show that
                                            Z2
                                                f .x/ dx Ä 0;

                                                                 1

which will follow if we show that no positive number is less than every upper sum. To this
end, we observe that if 0 < < 2, then f .x/ =2 for only finitely many values of x in
OE1; 2.

     Let k be the number of such points and let P0 be a partition of OE1; 2 such that

                   kP0k < 2k :                                                         (3.1.10)
                                       Section 3.1 Definition of the Integral 123

Consider the upper sum

                                    Xn     xj 1/:
                        S.P0/ D Mj .xj

                            j D1

There are at most k values of j in this sum for which Mj =2, and Mj Ä 1 even for
these. The contribution of these terms to the sum is less than k. =2k/ D =2, because of
(3.1.10). Since Mj < =2 for all other values of j , the sum of the other terms is less than

  Xn                    xj 1/ D 2 .xn     x0/ D 2 .2  1/ D 2:
2 .xj

   j D1

Therefore, S.P0/ < and, since can be chosen as small as we wish, no positive number
is less than all upper sums. This proves (3.1.9).

   The motivation for Definition 3.1.3 can be seen by again considering the idea of area
under a curve. Figure 3.1.5 shows the graph of a positive function y D f .x/, a Ä x Ä b,
with OEa; b partitioned into four subintervals.

y

                            y = f (x)

                        a x1 x2 x3 b x

                            Figure 3.1.5

The upper and lower sums of f over this partition can be interpreted as the sums of the areas
of the rectangles surmounted by the solid and dashed lines, respectively. This indicates that
a sensible definition of area A under the curve must admit the inequalities

                            s.P / Ä A Ä S.P /

for every partition P of OEa; b. Thus, A must be an upper bound for all lower sums and a

lower bound for all upper sums of f over partitions of OEa; b. If

                        Zb             Zb

                            f .x/ dx D f .x/ dx;                   (3.1.11)

                        a              a
124 Chapter 3 Integral Calculus of Functions of One Variable

there is only one number, the common value of the upper and lower integrals, with this
property, and we define A to be that number; if (3.1.11) does not hold, then A is not defined.
We will see below that this definition of area is consistent with the definition stated earlier
in terms of Riemann sums.

Example 3.1.7 Returning to Example 3.1.3, consider the function

                           f .x/ D x; 1 Ä x Ä 2:

If P D fx0; x1; : : : ; xng is a partition of OE1; 2, then, since f is increasing,

        Mj D f .xj / D xj and mj D f .xj 1/ D xj 1:

Hence,

                                     Xn                xj 1/                        (3.1.12)
                           S.P / D xj .xj                                           (3.1.13)

                                          j D1                                      (3.1.14)

and

                                     Xn                   xj 1/:
                           s.P / D xj 1.xj

                                    j D1

By writing                 xj D xj C xj 1 C xj xj 1 ;
we see from (3.1.12) that                 2               2

        S.P / D            1 Xn     .x2j     xj2 1/ C  1 Xn  .xj  xj 1/2

                           2 j D1            1 Xn      2 j D1

                           D 1 .22  12/ C          .xj       xj 1/2:
                           2 2 j D1

Since   Xn                                   Xn

        0 < .xj xj 1/2 Ä kP k .xj xj 1/ D kP k.2 1/;

        j D1                                 j D1

(3.1.14) implies that

                           3 < S.P / Ä 3 C kP k :
                           2                 22

Since kP k can be made as small as we please, Definition 3.1.3 implies that

                                    Zb 3
                                          f .x/ dx D :
                                                       2
                                    a

A similar argument starting from (3.1.13) shows that

                           3 kP k Ä s.P / < 3 ;
                           22                             2
                                                       Section 3.1 Definition of the Integral 125

so Z b 3
                                             a f .x/ dx D 2 :

Since the upper and lower integrals both equal 3=2, the area under the curve is 3=2 accord-
ing to our new definition. This is consistent with the result in Example 3.1.3.

The Riemann-Stieltjes Integral

The Riemann-Stieltjes integral is an important generalization of the Riemann integral. We
define it here, but confine our study of it to the exercises in this and other sections of this
chapter.

Definition 3.1.5 Let f and g be defined on OEa; b. We say that f is Riemann-Stieltjes

integrable with respect to g on OEa; b if there is a number L with the following property:

For every > 0, there is a i > 0 such that

         Xn                                           
                                                      
         j D1  f .cj / g.xj /              g.xj 1/                                    (3.1.15)
                                                    L < ;

provided only that P D fx0; x1; : : : ; xng is a partition of OEa; b such that kP k < i and

           xj 1 Ä cj Ä xj ; j D 1; 2; : : : ; n:

In this case, we say that L is the Riemann-Stieltjes integral of f with respect to g over

OEa; b, and write Z b
                                              f .x/ dg.x/ D L:

                                                             a

The sum        Xn
                    f .cj / g.xj /
                                           g.xj 1 /
               j D1

in (3.1.15) is a Riemann-Stieltjes sum of f with respect to g over the partition P .

               3.1 Exercises

1. Show that there cannot be more than one number L that satisfies Definition 3.1.1.
2. (a) Prove: If a R b f .x/ dx exists, then for every > 0, there is a i > 0 such that

             j 1 2j < if 1 and 2 are Riemann sums of f over partitions P1 and P2

             of OEa; b with norms less than i.
126 Chapter 3 Integral Calculus of Functions of One Variable

     (b) Suppose that there is an M > 0 such that, for every i > 0, there are Riemann

             sums 1 and 2 over a partition P of OEa; b with kP k < i such that j 1 2j
            M . Use (a) to prove that f is not integrable over OEa; b.

3. Suppose that a R b f .x/ dx exists and there is a number A such that, for every > 0
      and i > 0, there is a partition P of OEa; b with kP k < i and a Riemann sum of f
                                                                              Rb
      over P that satisfies the inequality j Aj < . Show that a f .x/ dx D A.

4. Prove directly from Definition 3.1.1 that

                             Z b x2 dx D b3 a3 :
                                                  3
                             a

Do not assume in advance that the integral exists. The proof of this is part of the
problem. HINT: Let P D fx0; x2; : : : ; xng be an arbitrary partition of OEa; b: Use
the mean value theorem to show that

                       b3 a3 Xn                      xj 1/
                                 D dj2.xj

                           3 j D1

for some points d1; . . . , dn; where xj 1 < dj < xj . Then relate this sum to
arbitrary Riemann sums for f .x/ D x2 over P:

5. Generalize the proof of Exercise 3.1.4 to show directly from Definition 3.1.1 that

                       Z b xm dx D bmC1 amC1
                                                 mC1
                          a

if m is an integer 0.

6. Prove directly from Definition 3.1.1 that f .x/ is integrable on OEa; b if and only if
      f . x/ is integrable on OE b; a, and, in this case,

                       Zb                     Za

                           f .x/ dx D f . x/ dx:

                       a                      b

7. Let f be bounded on OEa; b and let P be a partition of OEa; b. Prove: The lower sum
      s.P / of f over P is the infimum of the set of all Riemann sums of f over P .

8. Let f be defined on OEa; b and let P D fx0; x1; : : : ; xng be a partition of OEa; b.

     (a) Prove: If f is continuous on OEa; b, then s.P / and S.P / are Riemann sums of
             f over P .

     (b) Name another class of functions for which the conclusion of (a) is valid.
     (c) Give an example where s.P / and S.P / are not Riemann sums of f over P .
                                            Section 3.1 Definition of the Integral 127

9. Find 0 R 1f .x/ dx and 0 R 1f .x/ dx if

(a) f .x/ D  x if x is rational;            (b) f .x/ D 1 if x is rational; x if x is irrational:
             x if x is irrational:

10. Given that a R b ex dx exists, evaluate it by using the formula

             1 C r C r2 C                   C r n D 1 r nC1  .r ¤ 1/
                                                         1r

        to calculate certain Riemann sums. HINT: See Exercise 3.1.3:
11. Given that 0 R b sin x dx exists, evaluate it by using the identity

             cos.j 1/Â cos.j C 1/Â D 2 sin Â sin jÂ

        to calculate certain Riemann sums. HINT: See Exercise 3.1.3:
12. Given that 0 R b cos x dx exists, evaluate it by using the identity

                                sin.j C 1/Â sin.j 1/Â D 2 sin Â cos jÂ

        to calculate certain Riemann sums. HINT: See Exercise 3.1.3:
13. Show that if g.x/ D x C c (c=constant), then a R b f .x/ dg.x/ exists if and only if

        Rb
         a f .x/ dx exists, in which case

             Zb                             Zb

                 f .x/ dg.x/ D f .x/ dx:

             a                              a

14. Suppose that 1 < a < d < c < 1 and

             g.x/ D g1; a < x < d; (g1; g2 D constants),
                        g2; d < x < b;

        and let g.a/, g.b/, and g.d / be arbitrary. Suppose that f is defined on OEa; b,

        continuous from the right at a and from the left at b, and continuous at d . Show that
        Rb
         a f .x/ dg.x/ exists, and find its value.

15. Suppose that 1 < a D a0 < a1 < < ap D b < 1, let g.x/ D gm
        (constant) on .am 1; am/, 1 Ä m Ä p, and let g.a0/, g.a1/, . . . , g.ap / be arbitrary.
        Suppose that f is defined on OEa; b, continuous from the right at a and from the
                                                                            Rb
        left at b, and continuous at a1, a2, . . . , ap 1. Evaluate a f .x/ dg.x/. HINT: See
        Exercise 3.1.14:

16. (a) Give an example where a R b f .x/ dg.x/ exists even though f is unbounded
               on OEa; b. (Thus, the analog of Theorem 3.1.2 does not hold for the Riemann-

               Stieltjes integral.)

       (b) State and prove an analog of Theorem 3.1.2 for the case where g is increasing.
128 Chapter 3 Integral Calculus of Functions of One Variable

17. For the case where g is nondecreasing and f is bounded on OEa; b, define upper and
        lower Riemann-Stieltjes integrals in a way analogous to Definition 3.1.3.

3.2 EXISTENCE OF THE INTEGRAL

The following lemma is the starting point for our study of the integrability of a bounded
function f on a closed interval OEa; b.

Lemma 3.2.1 Suppose that

                                   jf .x/j Ä M; a Ä x Ä b;           (3.2.1)

and let P 0 be a partition of OEa; b obtained by adding r points to a partition P D fx0; x1; : : : ; xng
of OEa; b: Then

                            S.P / S.P 0/ S.P / 2M r kP k             (3.2.2)

and

                            s.P / Ä s.P 0/ Ä s.P / C 2M r kP k:      (3.2.3)

Proof We will prove (3.2.2) and leave the proof of (3.2.3) to you (Exercise 3.2.1).
First suppose that r D 1, so P 0 is obtained by adding one point c to the partition P D

fx0; x1; : : : ; xng; then xi 1 < c < xi for some i in f1; 2; : : : ; ng. If j ¤ i , the prod-
uct Mj .xj xj 1/ appears in both S.P / and S.P 0/ and cancels out of the difference
S.P / S.P 0/. Therefore, if

     Mi1 D sup f .x/ and Mi2 D sup f .x/;
                            xi 1 ÄxÄc              c ÄxÄxi

then                                                                 (3.2.4)
          S.P / S.P 0/ D Mi .xi xi 1/ Mi1.c xi 1/ Mi2.xi c/
                             D .Mi Mi1/.c xi 1/ C .Mi Mi2/.xi c/:

Since (3.2.1) implies that

                            0 Ä Mi Mir Ä 2M; r D 1; 2;

(3.2.4) implies that               S.P 0/ Ä 2M.xi  xi 1/ Ä 2M kP k:
                        0 Ä S.P /

This proves (3.2.2) for r D 1.
   Now suppose that r > 1 and P 0 is obtained by adding points c1, c2, . . . , cr to P . Let

P .0/ D P and, for j 1, let P .j / be the partition of OEa; b obtained by adding cj to
P .j 1/. Then the result just proved implies that

                   0 Ä S.P .j 1// S.P .j // Ä 2M kP .j 1/k; 1 Ä j Ä r:
                                             Section 3.2 Existence of the Integral 129

Adding these inequalities and taking account of cancellations yields

0 Ä S.P .0// S.P .r// Ä 2M.kP .0/k C kP .1/k C C kP .r 1/k/:          (3.2.5)

Since P .0/ D P , P .r/ D P 0, and kP .k/k Ä kP .k 1/k for 1 Ä k Ä r  1, (3.2.5) implies

that
                                  0 Ä S.P / S.P 0/ Ä 2M r kP k;

which is equivalent to (3.2.2).

Theorem 3.2.2 If f is bounded on OEa; b; then

                                 Zb          Zb

                                     f .x/ dx Ä f .x/ dx:             (3.2.6)

                                 a           a

Proof Suppose that P1 and P2 are partitions of OEa; b and P 0 is a refinement of both.
Letting P D P1 in (3.2.3) and P D P2 in (3.2.2) shows that

                              s.P1/ Ä s.P 0/ and S.P 0/ Ä S.P2/:

Since s.P 0/ Ä S.P 0/, this implies that s.P1/ Ä S.P2/. Thus, every lower sum is a lower
bound for the set of all upper sums. Since a R bf .x/ dx is the infimum of this set, it follows
that Z b

                                         s.P1/ Ä f .x/ dx

                                                                             a

for every partition P1 of OEa; b. This means that a R bf .x/ dx is an upper bound for the set
                              Rb

of all lower sums. Since a f .x/ dx is the supremum of this set, this implies (3.2.6).

Theorem 3.2.3 If f is integrable on OEa; b; then

              Zb                     Zb             Zb

                  f .x/ dx D f .x/ dx D f .x/ dx:

              a                      a               a

Proof We prove that a R bf .x/ dx D a R b f .x/ dx and leave it to you to show that a R bf .x/ dx D
a R b f .x/ dx (Exercise 3.2.2).

Suppose that P is a partition of OEa; b and is a Riemann sum of f over P . Since

Zb            Zb                         Zb                !

    f .x/ dx         f .x/ dx D f .x/ dx S.P / C .S.P / /

a                 a                      a

                                                 Zb        !

                                         C           f .x/ dx ;

                                                 a
130 Chapter 3 Integral Calculus of Functions of One Variable

the triangle inequality implies that

       Z b Z b    Z b 
        f .x/ dx           f .x/ dx Ä  f .x/ dx S.P / C jS.P / j
       a                               a                       
                     a                          Z b                      (3.2.7)

                                            C              f .x/ dx:

                                                        a

Now suppose that > 0. From Definition 3.1.3, there is a partition P0 of OEa; b such that

                     Zb                                Zb

                     a a f .x/ dx Ä S.P0/ < f .x/ dx C 3 :               (3.2.8)

From Definition 3.1.1, there is a i > 0 such that

                               Z b 
                                            f .x/ dx <                   (3.2.9)
                                                           3
                                         a

if kP k < i. Now suppose that kP k < i and P is a refinement of P0. Since S.P / Ä S.P0/
by Lemma 3.2.1, (3.2.8) implies that

                     Zb                             Zb

                           f .x/ dx Ä S.P / < f .x/ dx C ;
                                                                      3
                     a                                 a

so                                       Zb                

                           S.P /                 f .x/ dx <              (3.2.10)

                                            a              3

in addition to (3.2.9). Now (3.2.7), (3.2.9), and (3.2.10) imply that

                  Z b Z b  2
                   f .x/ dx              f .x/ dx < C jS.P / j           (3.2.11)
                  a                                 3
                                      a

for every Riemann sum of f over P . Since S.P / is the supremum of these Riemann
sums (Theorem 3.1.4), we may choose so that

                                      jS.P / j < 3 :

Now (3.2.11) implies that

                           Z b                 Z b 
                            f .x/ dx                f .x/ dx < :
                           a                                 
                                                 a

Since  is an arbitrary positive number, it follows that

                           Zb                       Zb

                                      f .x/ dx D f .x/ dx:

                           a                        a
                                                 Section 3.2 Existence of the Integral 131

Lemma 3.2.4 If f is bounded on OEa; b and > 0; there is a i > 0 such that

              Zb                                 Zb

                              f .x/ dx Ä S.P / < f .x/ dx C                (3.2.12)

              a                                  a

and Z b Z b

                              f .x/ dx s.P / > f .x/ dx

              a                                  a

if kP k < i.

Proof We show that (3.2.12) holds if kP k is sufficiently small, and leave the rest of the
proof to you (Exercise 3.2.3).

   The first inequality in (3.2.12) follows immediately from Definition 3.1.3. To establish
the second inequality, suppose that jf .x/j Ä K if a Ä x Ä b. From Definition 3.1.3, there
is a partition P0 D fx0; x1; : : : ; xrC1g of OEa; b such that

                                         Zb                                (3.2.13)
                              a S.P0/ < f .x/ dx C 2 :

If P is any partition of OEa; b, let P 0 be constructed from the partition points of P0 and P .

Then

                              S.P 0/ Ä S.P0 /;                             (3.2.14)

by Lemma 3.2.1. Since P 0 is obtained by adding at most r points to P , Lemma 3.2.1

implies that

                              S.P 0/ S.P / 2Kr kP k:                       (3.2.15)

Now (3.2.13), (3.2.14), and (3.2.15) imply that

              S.P / Ä S.P 0/ C 2Kr kP k

                     Ä S.P0/ C 2Kr kP k
                          Zb

                     a < f .x/ dx C 2 C 2Kr kP k:

Therefore, (3.2.12) holds if

                              kP k < i D 4Kr :
132 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.2.5 If f is bounded on OEa; b and

Zb                                  Zb

    f .x/ dx D f .x/ dx D L;                                  (3.2.16)
                                                              (3.2.17)
a                                   a

then f is integrable on OEa; b and

                                    Zb

                                        f .x/ dx D L:

                                      a
                                                           Section 3.2 Existence of the Integral 133

Proof If > 0, there is a i > 0 such that

Zb                                                           Zb                 (3.2.18)
    f .x/ dx
                                     < s.P / Ä S.P / < f .x/ dx C
  a
                                                                         a

if kP k < i (Lemma 3.2.4). If is a Riemann sum of f over P , then

                                     s.P / Ä Ä S.P /;

so (3.2.16) and (3.2.18) imply that

                                     L < <LC

if kP k < i. Now Definition 3.1.1 implies (3.2.17).
   Theorems 3.2.3 and 3.2.5 imply the following theorem.

Theorem 3.2.6 A bounded function f is integrable on OEa; b if and only if

              Zb                                           Zb

                                     f .x/ dx D f .x/ dx:

              a                                            a

The next theorem translates this into a test that can be conveniently applied.

Theorem 3.2.7 If f is bounded on OEa; b; then f is integrable on OEa; b if and only if
for each > 0 there is a partition P of OEa; b for which

                                     S.P / s.P / < :                            (3.2.19)

Proof We leave it to you (Exercise 3.2.4) to show that if a R b f .x/ dx exists, then (3.2.19)
holds for kP k sufficiently small. This implies that the stated condition is necessary for in-

tegrability. To show that it is sufficient, we observe that since

              Zb                                           Zb

s.P / Ä f .x/ dx Ä f .x/ dx Ä S.P /

              a                                            a

for all P , (3.2.19) implies that                          Zb
                                                               f .x/ dx < :
                                     Zb
                                0 Ä f .x/ dx                 a

                                                        a

Since can be any positive number, this implies that

              Zb                                           Zb

                                     f .x/ dx D f .x/ dx:

              a                                            a

Therefore, a R b f .x/ dx exists, by Theorem 3.2.5.
   The next two theorems are important applications of Theorem 3.2.7.
134 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.2.8 If f is continuous on OEa; b; then f is integrable on OEa; b.

Proof Let P D fx0; x1; : : : ; xng be a partition of OEa; b. Since f is continuous on OEa; b,

there  are  points  cj  and  c0  in  OExj   1; xj  such that

                              j

                                     f .cj / D Mj D sup f .x/

                                                                 xj 1ÄxÄxj

and

                                     f  .c  0  /  D  mj  D    inf         f .x/
                                            j               xj 1ÄxÄxj

(Theorem 2.2.9). Therefore,

                        S.P /              Xn                 f    .c  0  /  .xj             xj 1/:                   (3.2.20)
                                 s.P / D f .cj /                       j

                                               j D1

Since f is uniformly continuous on OEa; b (Theorem 2.2.12), there is for each > 0 a i > 0

such that

                                            jf .x0/ f .x/j <
                                                                  ba

if x and x0 are in OEa; b and jx        x0j < i. If kP k < i, then jcj                       c0  j  <  i  and,  from  (3.2.20),

                                                                                              j

                        S.P /           s.P / <            Xn             xj 1/ D :
                                                  b      a .xj

                                                            j D1

Hence, f is integrable on OEa; b, by Theorem 3.2.7.

Theorem 3.2.9 If f is monotonic on OEa; b; then f is integrable on OEa; b.

Proof Let P D fx0; x1; : : : ; xng be a partition of OEa; b. Since f is nondecreasing,

                                     f .xj / D Mj D sup f .x/

                                                                                  xj 1ÄxÄxj

and
                                  f .xj 1/ D mj D inf f .x/:

                                                                                 xj 1ÄxÄxj

Hence,                  S.P /              Xn                 f .xj 1//.xj                   xj 1/:
Since 0 < xj                     s.P / D .f .xj /

                                               j D1

                    xj 1 Ä kP k and f .xj / f .xj 1/ 0,

                        S.P /                           Xn
                                        s.P / Ä kP k .f .xj / f .xj 1//

                                                               j D1

                                              D kP k.f .b/ f .a//:
                                                 Section 3.2 Existence of the Integral 135

Therefore,

               S.P / s.P / < if kP k.f .b/ f .a// < ;

so f is integrable on OEa; b, by Theorem 3.2.7.

The proof for nonincreasing f is similar.

   We will also use Theorem 3.2.7 in the next section to establish properties of the integral.
In Section 3.5 we will study more general conditions for integrability.

                           3.2 Exercises

1. Complete the proof of Lemma 3.2.1 by verifying Eqn. (3.2.3).

2. Show that if f is integrable on OEa; b, then

                           Zb                    Zb

                               f .x/ dx D f .x/ dx:

                           a                     a

3. Prove: If f is bounded on OEa; b, there is for each > 0 a i > 0 such that

               Zb                          Zb

                   f .x/ dx                      f .x/ dx < s.P /

               a                           a

if kP k < i.

4. Prove: If f is integrable on OEa; b and > 0, then S.P / s.P / < if kP k is
      sufficiently small. HINT: Use Theorem 3.1.4:

5. Suppose that f is integrable and g is bounded on OEa; b, and g differs from f only
      at points in a set H with the following property: For each > 0, H can be covered

by a finite number of closed subintervals of OEa; b, the sum of whose lengths is less

than . Show that g is integrable on OEa; b and that

                           Zb                    Zb

                                 g.x/ dx D f .x/ dx:

                           a                     a

HINT: Use Exercise 3.1.3:

6. Suppose that g is bounded on OE; , and let Q W  D v0 < v1 <      < vL D  be
      a fixed partition of OE; . Prove:

            Z  XL Z v`                               Z              XL Z v`

(a) g.u/ du D                    g.u/ duI (b)            g.u/ du D            g.u/ du:

               `D1 v` 1                                             `D1 v` 1

7. A function f is of bounded variation on OEa; b if there is a number K such that

                           Xn    f .aj / f .aj 1/ Ä K

                           j D1

whenever a D a0 < a1 < < an D b. (The smallest number with this property
is the total variation of f on OEa; b.)
136 Chapter 3 Integral Calculus of Functions of One Variable

(a) Prove: If f is of bounded variation on OEa; b, then f is bounded on OEa; b.

(b) Prove: If f is of bounded variation on OEa; b, then f is integrable on OEa; b.
      HINT: Use Theorems 3.1.4 and 3.2.7:

8. Let P D fx0; x1; : : : ; xng be a partition of OEa; b, c0 D x0 D a, cnC1 D xn D b,
      and xj 1 Ä cj Ä xj , j D 1, 2, . . . , n. Verify that

Xn    g.cj /OEf .xj / f .xj 1/ D g.b/f .b/ g.a/f .a/  Xn      f .xj /OEg.cj C1 / g.cj /:

j D1                                                  j D0

Use this to prove that if a R b f .x/ dg.x/ exists, then so does a R b g.x/ df .x/, and

      Zb                                              Zb

         g.x/ df .x/ D f .b/g.b/ f .a/g.a/                       f .x/ dg.x/:

      a                                                       a

(This is the integration by parts formula for Riemann-Stieltjes integrals.)

9. Let f be continuous and g be of bounded variation (Exercise 3.2.7) on OEa; b.

(a) Show that if > 0, there is a i > 0 such that j            0j < =2 if and 0

      are Riemann-Stieltjes sums of f with respect to g over partitions P and P 0

      of OEa; b, where P 0 is a refinement of P and kP k < i. HINT: Use Theo-

      rem 2.2.12:

(b) Let i be as chosen in (a). Suppose that 1 and 2 are Riemann-Stieltjes
      sums of f with respect to g over any partitions P1 and P2 of OEa; b with norm
      less than i. Show that j 1 2j < .

       (c) If i > 0, let L.i/ be the supremum of all Riemann-Stieltjes sums of f with

               respect to g over partitions of OEa; b with norms less than i. Show that L.i/ is

               finite. Then show that L D limi!0C L.i/ exists. HINT: Use Theorem 2.1.9:
       (d) Show that a R b f .x/ dg.x/ D L.

10. Show that a R b f .x/ dg.x/ exists if f is of bounded variation and g is continuous on
        OEa; b. HINT: See Exercises 3.2.8 and 3.2.9:

3.3 PROPERTIES OF THE INTEGRAL

We now use the results of Sections 3.1 and 3.2 to establish the properties of the integral.
You are probably familiar with most of these properties, but not with their proofs.

Theorem 3.3.1 If f and g are integrable on OEa; b; then so is f C g; and

      Zb           Zb           Zb

          .f C g/.x/ dx D f .x/ dx C g.x/ dx:

      a            a            a
                                                Section 3.3 Properties of the Integral 137

Proof Any Riemann sum of f C g over a partition P D fx0; x1; : : : ; xng of OEa; b can
be written as

                        Xn                             xj 1/
               f Cg D OEf .cj / C g.cj /.xj

                             j D1                 Xn                  xj 1/
                                       xj 1/ C g.cj /.xj
                            Xn
                         D f .cj /.xj

                           j D1                     j D1

                         D f C g;

where f and g are Riemann sums for f and g. Definition 3.1.1 implies that if > 0

there are positive numbers i1 and i2 such that
                          Z b 
                         f             f .x/ dx < if kP k < i1
                                         2
                                    a

and                              Zb      

                                         

                         g             g.x/ dx < if kP k < i2:
                                         2
                                    a

If kP k < i D min.i1; i2/, then                                              Z b !
 Z b                       Z b     Z b !
 f Cg          f .x/ dx       g.x/ dx D  f                f .x/ dx C  g         g.x/ dx 
                                                                                          
          a                a                        a                        a
                                       Z                              Z b 
                                                   b          
                                                              
                                       Ä f            f .x/ dx C  g          g.x/ dx
                                                                                    
                                                a                         a

                                               < 2C2D ;
so the conclusion follows from Definition 3.1.1.

   The next theorem also follows from Definition 3.1.1 (Exercise 3.3.1).

Theorem 3.3.2 If f is integrable on OEa; b and c is a constant; then cf is integrable

on OEa; b and                 Zb                Zb

                                       cf .x/ dx D c f .x/ dx:

                                 a              a

     Theorems 3.3.1 and 3.3.2 and induction yield the following result (Exercise 3.3.2).

Theorem 3.3.3 If f1; f2; . . . ; fn are integrable on OEa; b and c1; c2; . . . ; cn are

constants; then c1f1 C c2f2 C C cnfn is integrable on OEa; b and

     Zb                                             Zb                Zb

          .c1f1 C c2f2 C C cnfn/.x/ dx D c1 f1.x/ dx C c2 f2.x/ dx

       a                                               a      Zb          a

                                                C C cn fn.x/ dx:

                                                              a
138 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.3.4 If f and g are integrable on OEa; b and f .x/ Ä g.x/ for a Ä x Ä b;

then Z b Z b

                             f .x/ dx Ä g.x/ dx:                   (3.3.1)

                         a        a

Proof Since g.x/ f .x/    0, every lower sum of g f over any partition of OEa; b is
nonnegative. Therefore,
                         Zb
                             .g.x/ f .x// dx 0:

                           a

Hence,      Zb           Zb       Zb

                g.x/ dx      f .x/ dx D .g.x/ f .x// dx

            a a Zab                                                (3.3.2)

                                D .g.x/ f .x// dx 0;

                                  a

which yields (3.3.1). (The first equality in (3.3.2) follows from Theorems 3.3.1 and 3.3.2;
the second, from Theorem 3.2.3.)

Theorem 3.3.5 If f is integrable on OEa; b; then so is jf j, and

                         Z b  Z b
                          f .x/ dx Ä jf .x/j dx:                   (3.3.3)
                         a      a

Proof   Let P be a partition of OEa; b and define

                             °                     «
                Mj D sup f .x/  xj 1 Ä x Ä xj ;
                             °                     «
                mj D inf f .x/  xj 1 Ä x Ä xj ;
                             °                        «
                M j D sup jf .x/j  xj 1 Ä x Ä xj ;
                             °                        «
                mj D inf jf .x/j  xj 1 Ä x Ä xj :

Then        M j mj D sup °°jf .x/j jf .x0/j  xj 1 Ä x; x0 Ä x«j «
                         Ä sup jf .x/ f .x0/j  xj 1 Ä x; x0 Ä xj
                         D Mj mj :                                 (3.3.4)

Therefore,

                         S .P / s.P / Ä S.P / s.P /;

where the upper and lower sums on the left are associated with jf j and those on the right are
associated with f . Now suppose that > 0. Since f is integrable on OEa; b, Theorem 3.2.7
implies that there is a partition P of OEa; b such that S.P / s.P / < . This inequality
and (3.3.4) imply that S .P / s.P / < . Therefore, jf j is integrable on OEa; b, again by
Theorem 3.2.7.

Since

            f .x/ Ä jf .x/j and f .x/ Ä jf .x/j; a Ä x Ä b;
                                     Section 3.3 Properties of the Integral 139

Theorems 3.3.2 and 3.3.4 imply that

Zb                      Zb                      Zb             Zb

    f .x/ dx Ä jf .x/j dx and                       f .x/ dx Ä jf .x/j dx;

a                       a                       a              a

which implies (3.3.3).

Theorem 3.3.6 If f and g are integrable on OEa; b; then so is the product fg:

Proof We consider the case where f and g are nonnegative, and leave the rest of the
proof to you (Exercise 3.3.4). The subscripts f , g, and fg in the following argument
identify the functions with which the various quantities are associated. We assume that
neither f nor g is identically zero on OEa; b, since the conclusion is obvious if one of them
is.

   If P D fx0; x1; : : : ; xng is a partition of OEa; b, then

    Sfg .P /                         Xn            mfg;j /.xj  xj 1/:            (3.3.5)
                        sfg.p/ D .Mfg;j

                                          j D1

Since f and g are nonnegative, Mfg;j Ä Mf;j Mg;j and mfg;j mf;j mg;j . Hence,

    Mfg;j mfg;j Ä Mf;j Mg;j mf;j mg;j

                            D .Mf;j mf;j /Mg;j C mf;j .Mg;j mg;j /

                            Ä Mg .Mf;j mf;j / C Mf .Mg;j mg;j /;

where Mf and Mg are upper bounds for f and g on OEa; b. From (3.3.5) and the last
inequality,

Sfg.P / sfg .P / Ä Mg OESf .P / sf .P / C Mf OESg.P / sg.P /:                    (3.3.6)

Now suppose that > 0. Theorem 3.2.7 implies that there are partitions P1 and P2 of
OEa; b such that

                Sf .P1/ sf .P1/ < 2Mg and Sg .P2/ sg.P2/ < 2Mf :                 (3.3.7)
If P is a refinement of both P1 and P2, then (3.3.7) and Lemma 3.2.1 imply that

                  Sf .P / sf .P / < 2Mg and Sg .P / sg .P / < 2Mf :

This and (3.3.6) yield
                                  Sfg .P / sfg .P / < 2 C 2 D :

Therefore, fg is integrable on OEa; b, by Theorem 3.2.7.
140 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.3.7 (First Mean Value Theorem for Integrals) Suppose that
u is continuous and v is integrable and nonnegative on OEa; b: Then

                           Zb                   Zb

                               u.x/v.x/ dx D u.c/ v.x/ dx     (3.3.8)

                           a                    a

for some c in OEa; b.

Proof From Theorem 3.2.8, u is integrabl°e on OEa; b. Therefo«re, Theorem 3.3°.6 implies            «
that the integral on the left exists. If m D min u.x/  a Ä x Ä b and M D max u.x/  a Ä x Ä b

(recall Theorem 2.2.9), then

                               m Ä u.x/ Ä M

and, since v.x/ 0,

                              mv.x/ Ä u.x/v.x/ Ä M v.x/:

Therefore, Theorems 3.3.2 and 3.3.4 imply that

                       Zb      Zb                      Zb

m v.x/ dx Ä u.x/v.x/ dx Ä M v.x/ dx:                          (3.3.9)

                       a       a                          a

   This implies that (3.3.8) holds for any c in OEa; b if a R b v.x/ dx D 0. If a R b v.x/ dx ¤ 0,
let

                                  Zb

                                          u.x/v.x/ dx         (3.3.10)
                               u D aZ b

                                          v.x/ dx

                                       a

Since a R b v.x/ dx > 0 in this case (why?), (3.3.9) implies that m Ä u Ä M , and the
intermediate value theorem (Theorem 2.2.10) implies that u D u.c/ for some c in OEa; b.

This implies (3.3.8).

If v.x/ Á 1, then (3.3.10) reduces to

                                        1 Zb
                               u D b a a u.x/ dx;

so u is the average of u.x/ over OEa; b. More generally, if v is any nonnegative integrable
                      Rb

function such that a v.x/ dx ¤ 0, then u in (3.3.10) is the weighted average of u.x/ over
OEa; b with respect to v. Theorem 3.3.7 says that a continuous function assumes any such

weighted average at some point in OEa; b.

Theorem 3.3.8 If f is integrable on OEa; b and a Ä a1 < b1 Ä b; then f is integrable
on OEa1; b1:
                                        Section 3.3 Properties of the Integral 141

Proof Suppose that > 0. From Theorem 3.2.7, there is a partition P D fx0; x1; : : : ; xng
of OEa; b such that

             S.P /            Xn        mj /.xj     xj 1/ < :  (3.3.11)
                    s.P / D .Mj

                                  j D1

We may assume that a1 and b1 are partition points of P , because if not they can be inserted
to obtain a refinement P 0 such that S.P 0/ s.P 0/ Ä S.P / s.P / (Lemma 3.2.1). Let

a1 D xr and b1 D xs. Since every term in (3.3.11) is nonnegative,

                     Xs         mj /.xj    xj 1/ < :
                           .Mj

                    j Dr C1

Thus, P D fxr ; xrC1; : : : ; xsg is a partition of OEa1; b1 over which the upper and lower
sums of f satisfy

                                           S.P / s.P / < :

Therefore, f is integrable on OEa1; b1, by Theorem 3.2.7.
   We leave the proof of the next theorem to you (Exercise 3.3.8).

Theorem 3.3.9 If f is integrable on OEa; b and OEb; c; then f is integrable on OEa; c;

and Z c Z b Z c

                    f .x/ dx D f .x/ dx C f .x/ dx:            (3.3.12)

             a                  a                b

                            R
So far we have defined  f .x/ dx only for the case where  < . Now we define

                    Z                   Z

                       f .x/ dx D           f .x/ dx

                                         

if  < , and            Z

                            f .x/ dx D 0:

                         

With these conventions, (3.3.12) holds no matter what the relative order of a, b, and c,

provided that f is integrable on some closed interval containing them (Exercise 3.3.9).
                                                                                               Rx

   Theorem 3.3.8 and these definitions enable us to define a function F .x/ D c f .t/ dt,
where c is an arbitrary, but fixed, point in OEa; b.

Theorem 3.3.10 If f is integrable on OEa; b and a Ä c Ä b; then the function F
defined by Z x

                                          F .x/ D f .t/ dt

                                                                             c

satisfies a Lipschitz condition on OEa; b; and is therefore continuous on OEa; b:
142 Chapter 3 Integral Calculus of Functions of One Variable

Proof  If x and x0 are in OEa; b, then

                                    Zx           Z x0                 Zx
                         F .x0/ D f .t/ dt
              F .x/                                    f .t/ dt D f .t/ dt;
                                           c
                                                 c                    x0

by Theorem 3.3.9 and the conventions just adopted. Since jf .t/j Ä K .a Ä t Ä b/ for

some constant K,         Z x       
                                   
                          f .t/ dt Ä Kjx x j; a Ä x; x Ä b0        0

                           x0

(Theorem 3.3.5), so

                     jF .x/ F .x0/j Ä Kjx x0j; a Ä x; x0 Ä b:

Theorem 3.3.11 If f is integrable on OEa; b and a Ä c Ä b; then F .x/ D c R x f .t/ dt
is differentiable at any point x0 in .a; b/ where f is continuous; with F 0.x0/ D f .x0/: If
f is continuous from the right at a; then FC0 .a/ D f .a/. If f is continuous from the left
at b; then F 0 .b/ D f .b/:

Proof We consider the case where a < x0 < b and leave the rest to you (Exer-

cise 3.3.14). Since               1 Zx
                               x x0 x0 f .x0/ dt D f .x0/;

we can write

                  F .x/    F .x0/  f .x0/ D      1 Zx     OEf .t/     f .x0/ dt:
                      x    x0
                                                 x x0 x0

From this and Theorem 3.3.5,

                     F .x0/              1       Z x                                   
        F .x/  x     x0
                               f .x0/ Ä  jx x0j x0      jf .t/     f  .x  0  /j  d  t    :  (3.3.13)
                                                                                       

(Why do we need the absolute value bars outside the integral?) Since f is continuous at
x0, there is for each > 0 a i > 0 such that

                             jf .t/ f .x0/j < if jx x0j < i

and t is between x and x0. Therefore, from (3.3.13),

                     F .x0/                      x0j D    if 0 < jx x0j < i:
        F .x/  x     x0                jx        x0j
                               f .x0/ <

                                             jx

Hence, F 0.x0/ D f .x0/.
                                                       Section 3.3 Properties of the Integral 143

Example 3.3.1 If                         (
                                           x;
                                                         0 Ä x Ä 1;
                               f .x/ D                   1 < x Ä 2;
                                           x C 1;

then the function                                8

                            Z                    ^^ x 2
                                  x              <;               0 < x Ä 1;
                                                     2       1; 1 < x Ä 2;
                   F .x/ D           f .t/ dt D  ^^:x
                                                      2
                               0
                                                     2 Cx

is continuous on OE0; 2. As implied by Theorem 3.3.11,

                  8                              0 < x < 1;
                  <x D f .x/;                    1 < x < 2;
       F 0.x/ D :

                    x C 1 D f .x/;

       FC.0/ D lim0            F .x/ F .0/       D lim       .x 2 =2/  0
                                                                         D 0 D f .0/;
                   x!0C              x                 x!0C  x

       F 0 .2/ D lim F .x/ F .2/ D lim .x2=2/ C x 1 3
                   x!2               x2              x!2        x2

                   D lim x C 4 D 3 D f .2/:
                      x!2 2

F does not have a derivative at x D 1, where f is discontinuous, since

                                  F 0 .1/ D 1 and FC0 .1/ D 2:

The next theorem relates integration and differentiation in another way.

Theorem 3.3.12 Suppose that F is continuous on the closed interval OEa; b and dif-
ferentiable on the open interval .a; b/; and f is integrable on OEa; b: Suppose also that

                                    F 0.x/ D f .x/; a < x < b:

Then                              Zb

                                      f .x/ dx D F .b/       F .a/:                    (3.3.14)

                                    a

Proof  If P D fx0; x1; : : : ; xng is a partition of OEa; b, then

                   F .b/                       Xn            F .xj 1//:                (3.3.15)
                                     F .a/ D .F .xj /

                                                    j D1

From Theorem 2.3.11, there is in each open interval .xj 1; xj / a point cj such that

                   F .xj / F .xj 1/ D f .cj /.xj xj 1/:
144 Chapter 3 Integral Calculus of Functions of One Variable

Hence, (3.3.15) can be written as

            F .b/                       Xn             xj 1/ D ;
                              F .a/ D f .cj /.xj

                                             j D1

where is a Riemann sum for f over P . Since f is integrable on OEa; b, there is for each

> 0 a i > 0 such that         Z b 
                                     f .x/ dx <  if kP k < i:
                                            
                              a
                            
                            

Therefore,                                    Z b 
                              
                                     F .a/       f .x/ dx <
                              F .b/
                                              a

for every > 0, which implies (3.3.14).

Corollary 3.3.13 If f 0 is integrable on OEa; b; then

                              Zb                     f .a/:
                                  f 0.x/ dx D f .b/

                                a

Proof Apply Theorem 3.3.12 with F and f replaced by f and f 0, respectively.

A function F is an antiderivative of f on OEa; b if F is continuous on OEa; b and differ-

entiable on .a; b/, with

                              F 0.x/ D f .x/; a < x < b:

If F is an antiderivative of f on OEa; b, then so is F C c for any constant c. Conversely,
if F1 and F2 are antiderivatives of f on OEa; b, then F1 F2 is constant on OEa; b (Theo-
rem 2.3.12). Theorem 3.3.12 shows that antiderivatives can be used to evaluate integrals.

Theorem 3.3.14 (Fundamental Theorem of Calculus) If f is continu-
ous on OEa; b; then f has an antiderivative on OEa; b: Moreover; if F is any antiderivative
of f on OEa; b; then Z b

                                         f .x/ dx D F .b/ F .a/:

                                                      a

Proof The function F0.x/ D a R x f .t/ dt is continuous on OEa; b by Theorem 3.3.10,
and F00.x/ D f .x/ on .a; b/ by Theorem 3.3.11. Therefore, F0 is an antiderivative of f
on OEa; b. Now let F D F0 C c (c D constant) be an arbitrary antiderivative of f on OEa; b.
Then

F .b/                 Zb                      Za                  Zb

            F .a/ D f .x/ dx C c                   f .x/ dx  c D f .x/ dx:

                             a                  a                      a
                                                 Section 3.3 Properties of the Integral 145

When applying this theorem, we will use the familiar notation

                                  F .b/                      b
                                                             
                                             F .a/ D F .x/ :

                                                                      a

Theorem 3.3.15 (Integration by Parts) If u0 and v0 are integrable on OEa; b;

then              Z                               b Z

                        b  u.x/v0.x/ dx D u.x/v.x/           b

                                                                         v.x/u0.x/ dx:  (3.3.16)

                     a                              a     a

Proof Since u and v are continuous on OEa; b (Theorem 2.3.3), they are integrable on
OEa; b. Therefore, Theorems 3.3.1 and 3.3.6 imply that the function

                                  .uv/0 D u0v C uv0

is integrable on OEa; b, and Theorem 3.3.12 implies that

                        Zb                                                   b
                                                                             
                              OEu.x/v0.x/ C u0.x/v.x/ dx D u.x/v.x/ ;
                           a                                                 a

which implies (3.3.16).

We will use Theorem 3.3.15 here and in the next section to obtain other results.

Theorem 3.3.16 (Second Mean Value Theorem for Integrals) Suppose
that f 0 is nonnegative and integrable and g is continuous on OEa; b: Then

      Zb                                  Zc                             Zb

          f .x/g.x/ dx D f .a/ g.x/ dx C f .b/ g.x/ dx                                  (3.3.17)

      a                                   a                              c

for some c in OEa; b:

Proof Since f is differentiable on OEa; b, it is continuous on OEa; b (Theorem 2.3.3).

Since g is continuous on OEa; b, so is fg (Theorem 2.2.5). Therefore, Theorem 3.2.8 implies

that the integrals in (3.3.17) exist. If

                                              Zx

                                  G.x/ D g.t/ dt;                                       (3.3.18)

                                              a

then G0.x/ D g.x/; a < x < b (Theorem 3.3.11). Therefore, Theorem 3.3.15 with u D f

and v D G yields

          Zb            f .x/g.x/ dx D f .x/G.x/  b    Zb
                                                           f 0.x/G.x/ dx:
                                                                                        (3.3.19)
                                                         a
                  a                               a

Since f 0 is nonnegative and G is continuous, Theorem 3.3.7 implies that

                              Zb                       Zb

                                  f 0.x/G.x/ dx D G.c/ f 0.x/ dx                        (3.3.20)

                              a                        a
146 Chapter 3 Integral Calculus of Functions of One Variable

for some c in OEa; b. From Corollary 3.3.12,                f .a/:

                                    Zb
                                         f 0.x/ dx D f .b/

                                                      a

From this and (3.3.18), (3.3.20) can be rewritten as

              Zb                                             Zc
                  f 0.x/G.x/ dx D .f .b/              f .a// g.x/ dx:

                a                                                  a

Substituting this into (3.3.19) and noting that G.a/ D 0 yields

Zb                               Zb                                 Zc

   f .x/g.x/ dx D f .b/ g.x/ dx .f .b/ f .a// g.x/ dx;
a Z c a Z b a Z a !

              D f .a/ g.x/ dx C f .b/ g.x/ dx                              g.x/ dx

                                 a                             a        c

                                 Zc                         Zb

              D f .a/ g.x/ dx C f .b/ g.x/ dx:

                                 a                          c

Change of Variable

The following theorem on change of variable is useful for evaluating integrals.

Theorem 3.3.17 Suppose that the transformation x D .t/ maps the interval c Ä

t Ä d into the interval a Ä x Ä b; with .c/ D  and .d / D ; and let f be continuous
on OEa; b: Let 0 be integrable on OEc; d : Then

              Z                      Zd

                                 f .x/ dx D f . .t// 0 .t/ dt:                      (3.3.21)

                                     c

Proof Both integrals in (3.3.21) exist: the one on the left by Theorem 3.2.8, the one on
the right by Theorems 3.2.8 and 3.3.6 and the continuity of f . .t//. By Theorem 3.3.11,

the function                         Zx

                                 F .x/ D f .y/ dy

                                                  a

is an antiderivative of f on OEa; b and, therefore, also on the closed interval with endpoints

 and . Hence, by Theorem 3.3.14,

                      Z                                     F ./:                   (3.3.22)

                           f .x/ dx D F ./

                        

By the chain rule, the function

                                     G.t/ D F . .t//
                                               Section 3.3 Properties of the Integral 147

is an antiderivative of f . .t// 0 .t/ on OEc; d , and Theorem 3.3.12 implies that

        Zd                                     G.c/ D F . .d //                 F . .c//
             f . .t// 0 .t/ dt D G.d /

          c

                                          D F ./ F ./:

Comparing this with (3.3.22) yields (3.3.21).

Example 3.3.2 To evaluate the integral

                              Z 1=p2

                          ID            p .1  2x2/.1       x2/ 1=2dx

                                      1= 2

we let                                                             p            p

                 f .x/ D .1 2x2/.1 x2/ 1=2;                1= 2 Ä x Ä 1= 2;

and                       x D .t/ D sin t;             =4 Ä t Ä =4:
Then
        0.t/ D cos t and

        Z 1=p2                     Z      =4

        I D p f .x/ dx D                     f .sin t/ cos t dt
        1= 2
                                   Z      =4                                                (3.3.23)
                                          =4
                          D                                        sin2 t / 1=2 cos t dt :
                                            .1 2 sin2 t/.1

                                          =4

                               .1 sin2 t/1=2 D cos t; =4 Ä t Ä =4

and
                                   1 2 sin2 t D cos 2t;

(3.3.23) yields                 Z                             
                          ID                           sin 2t 
                                      =4                           =4

                                          cos 2t dt D  2                  D 1:
                                                                 
                                      =4                              =4

Example 3.3.3 To evaluate the integral
                                              Z 5 sin t

                                        0 I D 2 C cos t dt;

we take .t/ D cos t. Then 0.t/ D sin t and

                         Z5           0.t/ Z 5 dt D f . .t// 0 .t/ dt;
                 ID
                          0 2 C .t/
                                                       0

where                                                  1
                                          f .x/ D 2 C x :
148 Chapter 3 Integral Calculus of Functions of One Variable

     Therefore, since  .0/ D 1 and .5 / D     1,
                               Z 1 dx                      1
                                                           
                       1 I D 2 C x D
                                              log.2 C x/ D log 3:

                                                                   1

   These examples illustrate two ways to use Theorem 3.3.17. In Example 3.3.2 we evalu-
ated the left side of (3.3.21) by transforming it to the right side with a suitable substitution
x D .t/, while in Example 3.3.3 we evaluated the right side of (3.3.21) by recognizing
that it could be obtained from the left side by a suitable substitution.

   The following theorem shows that the rule for change of variable remains valid under
weaker assumptions on f if is monotonic.

Theorem 3.3.18 Suppose that 0 is integrable and is monotonic on OEc; d ; and the
transformation x D .t/ maps OEc; d  onto OEa; b: Let f be bounded on OEa; b: Then

                                         g.t/ D f . .t// 0 .t/

is integrable on OEc; d  if and only if f is integrable over OEa; b; and in this case

                       Zb          Zd

                             f .x/ dx D f . .t//j 0 .t/j dt:

                       a                   c

Proof We consider the case where f is nonnegative and is nondecreasing, and leave
the the rest of the proof to you (Exercises 3.3.20 and 3.3.21).

     First assume that is increasing. We show first that

                       Zb          Zd

                             f .x/ dx D f . .t// 0 .t/ dt:                             (3.3.24)

                          a                c

Let P D ft0; t1; : : : ; tng be a partition of OEc; d  and P D fx0; x1; : : : ; xng with xj D .tj /

be the corresponding partition of OEa; b. Define

                             °0                           «
                       Uj D sup .t /  tj 1 Ä t Ä tj ;
                             °0                           «
                       uj D inf .t / tj 1 Ä t Ä tj ;
                             °                               «
                       Mj D sup f .x/  xj 1 Ä x Ä xj ;

and                          °                                  «
                                                  
                       M j D sup f . .t// .t/ tj 1 Ä t Ä tj :0

Since  is increasing, uj 0. Therefore,
                           0 Ä uj Ä 0.t / Ä Uj ;
                                                    tj 1 Ä t Ä tj :

Since f is nonnegative, this implies that                       tj 1 Ä t Ä tj :
               0 Ä f . .t//uj Ä f . .t// 0 .t/ Ä f . .t//Uj ;

Therefore,

                             Mj uj Ä M j Ä Mj Uj ;
                                                  Section 3.3 Properties of the Integral 149

which implies that                       M j D Mj j ;                                             (3.3.25)
where                                    uj Ä j Ä Uj :                                            (3.3.26)
                                                                                                  (3.3.27)
Now consider the upper sums
                                                                                                  (3.3.28)
                    Xn                                    Xn                            xj 1/:    (3.3.29)
         S .P / D M j .tj     tj 1/ and S.P / D Mj .xj                                            (3.3.30)

                        j D1                                         j D1

From the mean value theorem,                      .tj 1/ D 0. j /.tj tj 1/;
                       xj xj 1 D .tj /

where tj 1 < j < tj , so               uj Ä 0. j / Ä Uj :

From (3.3.25), (3.3.27), and (3.3.28),

                                         Xn                    0. j //.tj         tj 1/:
                    S .P / S.P / D Mj . j

                                         j D1

Now suppose that jf .x/j Ä M , a Ä x Ä b. Then (3.3.26), (3.3.29), and (3.3.30) imply

that                                              Xn

                    S.P / S.P / Ä M .Uj uj /.tj tj 1/:

                                                  j D1

The sum on the right is the difference between the upper and lower sums of 0 over P .
Since 0 is integrable on OEc; d , this can be made as small as we please by choosing kP k

sufficiently small (Exercise 3.2.4).

From (3.3.28), kP k Ä KkP k if j 0.t/j Ä K, c Ä t Ä d . Hence, Lemma 3.2.4 implies

that   Z b                                      Z d                                       

                                                                                  0       

      S.P /      f .x/ dx < and S .P /                            f . .t// .t/ dt <               (3.3.31)
                          3                                                               3
             a                                                 c

if kP k is sufficiently small. Now        Z                                          
      Z b Z d
                                          b                                          
                                    0                                                
       f .x/ dx        f . .t//        .t/ dt Ä  f .x/ dx S.P / C jS.P / S .P /j
      a                                   a                                          
                    c
                                                         Z d                                    
                                                                                                
                                                                                            0   
                                                      C S.P /                  f . .t// .t/ dt :
                                                                                                
                                                                          c

Choosing P so that jS.P / S .P j <       =3 in addition to (3.3.31) yields
                            Z b                                              
                             f .x/ dx    Zd                                  
                            a                                             dt
                                                  f.    .t //     0 .t /       <     :

                                               c

Since is an arbitrary positive number, this implies (3.3.24).
150 Chapter 3 Integral Calculus of Functions of One Variable

   If is nondecreasing (rather than increasing), it may happen that xj 1 D xj for some
values of j ; however, this is no real complication, since it simply means that some terms in
S.P / vanish.

By applying (3.3.24) to  f , we infer that

                                Zb          Zd

                                    f .x/ dx D f . .t// 0 .t/ dt;   (3.3.32)

                                a           c

since                    Zb                 Zb
and                                             f .x/ dx
                             . f /.x/ dx D
                                              a
                           a

                 Zd                         Zd
                     . f . .t/ 0 .t// dt D      f . .t// 0 .t/ dt:

                   c                          c

Now suppose that f is integrable on OEa; b. Then

                 Zb                 Zb                Zb

                         f .x/ dx D f .x/ dx D f .x/ dx;

                 a                  a                 a

by Theorem 3.2.3. From this, (3.3.24), and (3.3.32),

             Zd                     Zd                    Zb

                 f . .t// 0 .t/ dt D f . .t// 0 .t/ dt D f .x/ dx:

             c                      c                     a

This and Theorem 3.2.5 (applied to f . .t// 0 .t/) imply that f . .t// 0 .t/ is integrable on

OEc; d  and              Zb             Zd

                                f .x/ dx D f . .t// 0 .t/ dt:       (3.3.33)

                         a              c

A similar argument shows that if f . .t// 0 .t/ is integrable on OEc; d , then f is integrable

on OEa; b, and (3.3.33) holds.

                                    3.3 Exercises

1. Prove Theorem 3.3.2.

2. Prove Theorem 3.3.3.

3. Can jf j be integrable on OEa; b if f is not?

4. Complete the proof of Theorem 3.3.6. HINT: The partial proof given above implies
      that if m1 and m2 are lower bounds for f and g respectively on OEa; b; then
      .f m1/.g m2/ is integrable on OEa; b:

5. Prove: If f is integrable on OEa; b and jf .x/j        > 0 for a Ä x Ä b, then 1=f is
      integrable on OEa; b
                                         Section 3.3 Properties of the Integral 151

6. Suppose that f is integrable on OEa; b and define

            (          if f .x/ 0;                       (  0            if f .x/ 0;
f C.x/ D f .x/                                                           if f .x/ < 0.
                       if f .x/ < 0,     and f .x/ D        f .x/
              0

Show that f C and f are integrable on OEa; b, and

               Zb                 Zb                  Zb

                    f .x/ dx D f C.x/ dx C f                   .x/ dx:

                 a                a                   a

7. Find the weighted average u of u.x/ over OEa; b with respect to v, and find a point c
      in OEa; b such that u.c/ D u.

(a) u.x/ D x,       v.x/ D x, OEa; b D OE0; 1

(b) u.x/ D sin x, v.x/ D x2, OEa; b D OE 1; 1

     (c) u.x/ D x2, v.x/ D ex, OEa; b D OE0; 1
8. Prove Theorem 3.3.9.

9. Show that Z c Z b Z c

                       f .x/ dx D f .x/ dx C f .x/ dx

                    a                 a               b

for all possible relative orderings of a, b, and c, provided that f is integrable on a

closed interval containing them.

10. Prove: If f is integrable on OEa; b and a D a0 < a1 < < an D b, then

Zb                     Z a1              Z a2                      Z an

    f .x/ dx D f .x/ dx C f .x/ dx C C                                         f .x/ dx:

a                      a0                a1                        an 1

11. Suppose that f is continuous on OEa; b and P D fx0; x1; : : : ; xng is a partition of
                                                                                        Rb

        OEa; b. Show that there is a Riemann sum of f over P that equals a f .x/ dx.

12. Suppose that f 0 exists and jf 0.x/j Ä M on OEa; b. Show that any Riemann sum

of f over any partition P of OEa; b satisfies

                        Z b 
                                  f .x/ dx Ä M.b a/kP k:
                                         
                             a

        HINT: See Exercise 3.3.11:                                             0, with strict
                                                                           Rb

13. Prove: If f is integrable and f .x/ 0 on OEa; b, then a f .x/ dx
        inequality if f is continuous and positive at some point in OEa; b.

14. Complete the proof of Theorem 3.3.11.

15. State theorems analogous to Theorems 3.3.10 and 3.3.11 for the function
                                                        Zc

                                              G.x/ D f .t/ dt;

                                                                                   x

and show how your theorems can be obtained from them.
152 Chapter 3 Integral Calculus of Functions of One Variable

16. The symbol R f .x/ dx denotes an antiderivative of f . A plausible analog of The-
        orem 3.3.1 would state that if f and g have antiderivatives on OEa; b, then so does

f C g, which is true, and

Z                                       Z               Z

    .f C g/.x/ dx D f .x/ dx C g.x/ dx:                                      .A/

However, this is not true in the usual sense.

(a) Why not?
(b) State a correct interpretation of (A).

17. (See Exercise 3.3.16.) Formulate a valid interpretation of the relation

    Z                                   Z

         .cf /.x/ dx D c f .x/ dx .c ¤ 0/:

Is your interpretation valid if c D 0?

18. (a) Let f .nC1/ be integrable on OEa; b. Show that

         Xn f .r/.a/                    a/r C 1 f .nC1/ Z b .t /.b  t/n dt:
f .b/ D                             .b          nS a
                              rS
         r D0

      HINT: Integrate by parts and use induction:
(b) What is the connection between (a) and Theorem 2.5.5?

19. In addition to the assumptions of Theorem 3.3.16, suppose that f .a/ D 0, f 6Á 0,
        and g.x/ > 0 .a < x < b/. Show that there is only one point c in OEa; b with the
        property stated in Theorem 3.3.16. HINT: Use Exercise 3.3.13:

20. Assuming that Theorem 3.3.18 is true under the additional assumption that f is
        nonnegative on OEa; b, show that it is true without this assumption.

21. Assuming that the conclusion of Theorem 3.3.18 is true if is nondecreasing, show

that it is true if is nonincreasing. HINT: Use Exercise 3.1.6:
22. Suppose g0 is integrable and f is continuous on OEa; b. Show that a R b f .x/ dg.x/
Rb
exists and equals a f .x/g .x/ dx.0

23. Suppose f and g00 are bounded and fg0 is integrable on OEa; b. Show that a R b f .x/ dg.x/
Rb
exists and equals a f .x/g .x/ dx. HINT: Use Theorem 2.5.4:0

3.4 IMPROPER INTEGRALS

So far we have confined our study of the integral to bounded functions on finite closed
intervals. This was for good reasons:

       From Theorem 3.1.2, an unbounded function cannot be integrable on a finite closed
       interval.
                         Section 3.4 Improper Integrals 153

Attempting to formulate Definition 3.1.1 for a function defined on an infinite or semi-
infinite interval would introduce questions concerning convergence of the resulting
Riemann sums, which would be infinite series.

   In this section we extend the definition of integral to include cases where f is unbounded
or the interval is unbounded, or both.

   We say f is locally integrable on an interval I if f is integrable on every finite closed
subinterval of I . For example,

                                              f .x/ D sin x

is locally integrable on . 1; 1/;

                                                           1
                                           g.x/ D x.x 1/

is locally integrable on . 1; 0/, .0; 1/, and .1; 1/; and
                                                         p

                                               h.x/ D x

is locally integrable on OE0; 1/.

Definition 3.4.1 If f is locally integrable on OEa; b/, we define

    Zb                  Zc

        f .x/ dx D lim f .x/ dx                                    (3.4.1)
        c!b a
    a

if the limit exists (finite). To include the case where b D 1, we adopt the convention that
1 D 1.

   The limit in (3.4.1) always exists if OEa; b/ is finite and f is locally integrable and bounded
                                                                                           Rb

on OEa; b/. In this case, Definitions 3.1.1 and 3.4.1 assign the same value to a f .x/ dx no
matter how f .b/ is defined (Exercise 3.4.1). However, the limit may also exist in cases

where b D 1 or b < 1 and f is unbounded as x approaches b from the left. In these

cases, Definition 3.4.1 assigns a value to an integral that does not exist in the sense of Def-
                     Rb

inition 3.1.1, and a f .x/ dx is said to be an improper integral that converges to the limit
                                                                                       Rb

in (3.4.1). We also say in this case that f is integrable on OEa; b/ and that a f .x/ dx exists.
                                                                                               Rb

If the limit in (3.4.1) does not exist (finite), we say that the improper integral a f .x/ dx
                                                                                    Rc

diverges, and f is nonintegrable on OEa; b/. In particular, if limc!b a f .x/ dx D 1,
              Rb

we say that a f .x/ dx diverges to 1, and we write

Zb                   Zb

    f .x/ dx D 1 or      f .x/ dx D 1;

a                    a

whichever the case may be.
   Similar comments apply to the next two definitions.
154 Chapter 3 Integral Calculus of Functions of One Variable

Definition 3.4.2 If f is locally integrable on .a; b, we define

                           Zb                               Zb

                               f .x/ dx D lim f .x/ dx
                                         c!aC c
                           a

provided that the limit exists (finite). To include the case where a D         1, we adopt the
convention that 1C D 1.

Definition 3.4.3 If f is locally integrable on .a; b/; we define

                       Zb          Z                            Zb

                           f .x/ dx D f .x/ dx C f .x/ dx;

                       a           a                            

where a <  < b, provided that both improper integrals on the right exist (finite).

   The existence and value of a R b f .x/ dx according to Definition 3.4.3 do not depend on
the particular choice of  in .a; b/ (Exercise 3.4.2).

   When we wish to distinguish between improper integrals and integrals in the sense of
Definition 3.1.1, we will call the latter proper integrals.

   In stating and proving theorems on improper integrals, we will consider integrals of
the kind introduced in Definition 3.4.1. Similar results apply to the integrals of Defini-
tions 3.4.2 and 3.4.3. We leave it to you to formulate and use them in the examples and
exercises as the need arises.

Example 3.4.1 The function

                                                         1       1
                                      f .x/ D 2x sin x      cos
is locally integrable and the derivative of
                                                                x

                                   F .x/ D x2 sin 1
                                                     x

on OE 2= ; 0/. Hence,

Zc                         f .x/ dx D x2 sin    c           D c2 sin 1c C 2 4
                                              1
    2=
                                              x 2=

and Z 0                                  Â 1 4Ã 4

                           f .x/ dx D lim c2 sin C 2 D 2 ;  c
                       2=          c !0

according to Definition 3.4.1. However, this is not an improper integral, even though f .0/

is not defined and cannot be defined so as to make f continuous at 0. If we define f .0/

arbitrarily (say f .0/ D 10), then f is bounded on the closed interval OE 2= ; 0 and con-
                               R0
tinuous except at 0. Therefore, 2= f .x/ dx exists and equals 4= as a proper integral2

(Exercise 3.4.1), in the sense of Definition 3.1.1.
                                                 Section 3.4 Improper Integrals 155

Example 3.4.2 The function
                                           f .x/ D .1 x/ p

is locally integrable on OE0; 1/ and, if p ¤ 1 and 0 < c < 1,

            Zc                   .1  x/  pC1  c             .1 c/ pC1 1
                                              
                .1 x/ p dx D                     D                                :
                                     p1 0                            p1
            0

Hence,                 Zc       x/ p dx D .1 p/ 1; p < 1;
For p D 1,       lim .1                  1;                          p > 1:
Hence,
                c!1 0

                      Zc   x/ 1 dx D      lim log.1                      c/ D 1:
                lim .1
                                         c !1
               c!1 0

                Z1         x/ p dx D .1 p/ 1;                     p < 1;
                    .1                     1;                     p 1:

                  0

Example 3.4.3 The function f .x/ D x p

is locally integrable on OE1; 1/ and, if p ¤ 1 and c > 1,

                Z c x pC1 c c pC1 1      
                   x p dx D                   D                             :
                                     pC1 1                     pC1
                1

Hence,             Zc                    .p 1/ 1; p > 1;
For p D 1,
Hence,                        p
                lim x dx D
                c!1 1                    1;                       p < 1:

                           Zc

                   lim x 1 dx D lim log c D 1:
                c!1 1                    c !1

                Z1                   .p 1/ 1; p > 1;

                             p
                1 x dx D 1;
                                                            p Ä 1:

Example 3.4.4 If 1 < c < 1, then

        Zc1 1              Zc1                   1                       c     1 .log c/2:
         1 x log x dx D     1 x log x dx D                                     2
                                                 2  .l      o  g  x  /2     D
                                                                         
                                                                         1

Hence,                          Zc1 1
so                        lim        log dx D 1;
                         c!1 1 x x

                           Z11 1
                            1 x log x dx D 1:
156 Chapter 3 Integral Calculus of Functions of One Variable

Example 3.4.5 The function f .x/ D cos x is locally integrable on OE0; 1/ and

                                 Zc

                            lim cos x dx D lim sin c
                            c!1 0        c !1

does not exist; thus, 0 R 1 cos x dx diverges, but not to 1.

Example 3.4.6 The function f .x/ D log x is locally integrable on .0; 1, but un-

bounded as x ! 0C. Since

    Z1                                     1
                                           
    lim log x dx D lim .x log x          x/ D 1      lim .c log c            c/ D 1;
    c!0C c                c !0C
                                              c     c !0C

Definition 3.4.2 yields          Z1

                                     log x dx D 1:

                                   0

Example 3.4.7 In connection with Definition 3.4.3, it is important to recognize that
            R                        Rb                                      Rb
the improper integrals a f .x/ dx and  f .x/ dx must converge separately for a f .x/ dx

to converge. For example, the existence of the symmetric limit

                                     ZR

                                  lim f .x/ dx;

                                 R!1 R

which is called the principal value of 1 R 1 f .x/ dx, does not imply that 1 R 1 f .x/ dx
converges; thus, Z R

                            lim x dx D lim 0 D 0;
                            R!1 R        R!1

but 0 R 1 x dx and 1 R 0 x dx diverge and therefore so does 1 R 1 x dx.

Theorem 3.4.4 Suppose that f1; f2; . . . ; fn are locally integrable on OEa; b/ and that
Rb  Rb                      Rb
a f1.x/ dx; a f2.x/ dx; . . . ; a fn.x/ dx converge: Let c1; c2; . . . ; cn be constants:
     Rb
Then a .c1f C c2f1 C C cnfn/.x/ dx converges and

    Zb                                   Zb                              Zb

        .c1f1 C c2f2 C      C cnfn/.x/ dx D c1 f1.x/ dx C c2 f2.x/ dx

      a                                  a                    Zb         a

                                         C C cn fn.x/ dx:

                                                              a

Proof If a < c < b, then                 Zc                              Zc

       Zc                   C cnfn/.x/ dx D c1 f1.x/ dx C c2 f2.x/ dx
            .c1f1 C c2f2 C
                                         a Zc a
             a

                                         C C cn fn.x/ dx;

                                                              a

by Theorem 3.3.3. Letting c ! b yields the stated result.
                                      Section 3.4 Improper Integrals 157

Improper Integrals of Nonnegative Functions

The theory of improper integrals of nonnegative functions is particularly simple.

Theorem 3.4.5 If f is nonnegative and locally integrable on OEa; b/; then a R b f .x/ dx
converges if the function Z x

                        F .x/ D f .t/ dt

                                                                             a

                              Rb
is bounded on OEa; b/, and a f .x/ dx D 1 if it is not. These are the only possibilities, and

                     Zb

                         f .t/ dt D sup F .x/

                     a   aÄx<b

in either case:

Proof Since F is nondecreasing on OEa; b/, Theorem 2.1.9(a) implies the conclusion.

We often write

                                           Zb
                                                f .x/ dx < 1

                                                                a

to indicate that an improper integral of a nonnegative function converges. Theorem 3.4.5
justifies this convention, since it asserts that a divergent integral of this kind can only di-

                                                        Rb
verge to 1. Similarly, if f is nonpositive and a f .x/ dx converges, we write

                                          Zb
                                               f .x/ dx > 1

                                                              a

because a divergent integral of this kind can only diverge to 1. (To see this, apply
Theorem 3.4.5 to f .) These conventions do not apply to improper integrals of functions
that assume both positive and negative values in .a; b/, since they may diverge without
diverging to 1.

Theorem 3.4.6 (Comparison Test) If f and g are locally integrable on OEa; b/

and

                 0 Ä f .x/ Ä g.x/; a Ä x < b;                                      (3.4.2)

then             Zb                   Zb

(a)                  f .x/ dx < 1 if      g.x/ dx < 1

                 a                    a

and

                 Zb                   Zb

(b)                  g.x/ dx D 1 if       f .x/ dx D 1.

                 a                    a
158 Chapter 3 Integral Calculus of Functions of One Variable

Proof  (a) Assumption (3.4.2) implies that
                        Zx                Zx

                              f .t/ dt Ä g.t/ dt;       aÄx<b

                           a                 a

(Theorem 3.3.4), so             Zx                      Zx

                           sup       f .t/ dt Ä sup          g.t/ dt:

                        aÄx<b a                 aÄxÄb a

If a R b g.x/ dx < 1, the right side of this inequality is finite by Theorem 3.4.5, so the left
                                    Rb

side is also. This implies that a f .x/ dx < 1, again by Theorem 3.4.5.
  (b) The proof is by contradiction. If a R b g.x/ dx < 1, then (a) implies that a R b f .x/ dx <
                                             Rb

1, contradicting the assumption that a f .x/ dx D 1.

   The comparison test is particularly useful if the integrand of the improper integral is
complicated but can be compared with a function that is easy to integrate.

Example 3.4.8 The improper integral
                                              Z 1 2 C sin x

                                        0 I D .1 x/p dx

converges if p < 1, since

                              2 C sin x         3
                     0<              pÄ             p ; 0 Ä x < 1;
                              .1 x/             .1 x/

and, from Example 3.4.2,

                                Z 1 3 dx                p < 1:
                                 0 .1 x/p < 1;

However, I diverges if p 1, since

                     0<         1   pÄ       2 C sin x
                                                  p ; 0 Ä x < 1;
                              .1 x/          .1 x/

and Z 1 dx
                                      0 .1 x/p D 1; p 1:

If f is any function (not necessarily nonnegative) locally integrable on OEa; b/, then

                     Zc                   Z a1          Zc

                           f .x/ dx D f .x/ dx C f .x/ dx

                     a                    a              a1
if a1 and c are in OEa; b/. Since a R a1 f .x/ dx is a proper integral, on letting c ! b we
                                                    Rb                 Rb
conclude that if either of the improper integrals a f .x/ dx and a1 f .x/ dx converges
then so does the other, and in this case

                     Zb              Z a1               Zb

                           f .x/ dx D f .x/ dx C f .x/ dx:

                     a                    a              a1
                                            Section 3.4 Improper Integrals 159

This means that any theorem implying convergence or divergence of an improper integral
Rb
 a f .x/ dx in the sense of Definition 3.4.1 remains valid if its hypotheses are satisfied
on a subinterval OEa1; b/ of OEa; b/ rather than on all of OEa; b/. For example, Theorem 3.4.6

remains valid if (3.4.2) is replaced by

                   0 Ä f .x/ Ä g.x/; a1 Ä x < b;

where a1 is any point in OEa; b/.

   From this, you can see that if f .x/ 0 on some subinterval OEa1; b/ of OEa; b/, but not
necessarily for all x in OEa; b/, we can still use the convention introduced earlier for positive

                                        Rb
functions; that is, we can write a f .x/ dx < 1 if the improper integral converges or
Rb
 a f .x/ dx D 1 if it diverges.

Example 3.4.9 If p 0, then

                   x p .x   1/p.2 C sin x/                    p
                         Ä              2p Ä 4x
                   2        .x 1=3/

for x sufficiently large. Therefore, Theorem 3.4.6 and Example 3.4.3 imply that
                                     Z 1 .x 1/p.2 C sin x/
                                      1 .x 1=3/2p dx

converges if p > 1 or diverges if p Ä 1.

Theorem 3.4.7 Suppose that f and g are locally integrable on OEa; b/; g.x/ > 0 and
f .x/ 0 on some subinterval OEa1; b/ of OEa; b/; and

                            lim  f .x/  D M:                                     (3.4.3)

                            x!b g.x/

(a) If 0 < M < 1; then a R b f .x/ dx and a R b g.x/ dx converge or diverge together.
(b) If M D 1 and a R b g.x/ dx D 1; then a R b f .x/ dx D 1.
(c) If M D 0 and a R b g.x/ dx < 1; then a R b f .x/ dx < 1.

Proof (a) From (3.4.3), there is a point a2 in OEa1; b/ such that

                    M f .x/ 3M
               0 < 2 < g.x/ < 2 ; a2 Ä x < b;

and therefore  M                 3M

               2 g.x/ < f .x/ < 2 g.x/; a2 Ä x < b:                              (3.4.4)

Theorem 3.4.6 and the first inequality in (3.4.4) imply that

               Zb                       Zb

                  g.x/ dx < 1 if           f .x/ dx < 1:

               a2                       a2
160 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.4.6 and the second inequality in (3.4.4) imply that

                       Zb                     Zb

                           f .x/ dx < 1 if        g.x/ dx < 1:

                         a2                     a2

          Rb               Rb
Therefore, a2 f .x/ dx and a2 g.x/ dx converge or diverge together, and in the latter case
they must diverge to 1, since their integrands are nonnegative (Theorem 3.4.5).

(b) If M D 1, there is a point a2 in OEa1; b/ such that

                                    f .x/ g.x/; a2 Ä x Ä b;

so Theorem 3.4.6(b) implies that a R b f .x/ dx D 1.
  (c) If M D 0, there is a point a2 in OEa1; b/ such that

                           f .x/ Ä g.x/; a2 Ä x Ä b;

so Theorem 3.4.6(a) implies that a R b f .x/ dx < 1.
  The hypotheses of Theorem 3.4.7(b) and (c) do not imply that a R b f .x/ dx and a R b g.x/ dx

necessarily converge or diverge together. For example, if b D 1, then f .x/ D 1=x

and g.x/ D 1=x2 satisfy the hypotheses of Theorem 3.4.7(b), while Rf .x/ D 1=x2 and

                                                                                                                              1
g.x/ DR 1=x satisfy the hypotheses of Theorem 3.4.7(c). However, 1 1=x dx D 1,
while  1  1=x2  dx  <  1.
       1

Example 3.4.10 Let f .x/ D .1 C x/ p and g.x/ D x p. Since

                                  lim  f .x/  D1

                               x!1 g.x/

and 1 R 1 x p dx converges if p > 1 or diverges if p Ä 1 (Example 3.4.3), Theorem 3.4.7
implies that the same is true of

                               Z1
                                    .1 C x/ p dx:

                               1

Example 3.4.11 The function
                                        f .x/ D x p.1 C x/ q

is locally integrable on .0; 1/. To see whether

                                           Z1
                                     I D x p.1 C x/ q dx

                                                                0

converges according to Definition 3.4.3, we consider the improper integrals

                Z1                                Z1

          I1 D x p.1 C x/ q dx and I2 D x p.1 C x/ q dx

                    0                              1
                                                    Section 3.4 Improper Integrals 161

separately. (The choice of 1 as the upper limit of I1 and the lower limit of I2 is completely
arbitrary; any other positive number would do just as well.) Since

                           lim p f .x/ D lim .1 C x/ q D 1
                           x!0C x        x!0C

and Z 1 p .1 p/ 1; p < 1;
                           0 x dx D 1;
                                                    p 1;

Theorem 3.4.7 implies that I1 converges if and only if p < 1. Since

                           lim p q f .x/ D lim .1 C x/ q xq D 1
                           x!1 x         x!1

and Z 1 p q .p C q 1/ 1; p C q > 1;
                           x dx D
                                         1;         p C q Ä 1;
                       1

Theorem 3.4.7 implies that I2 converges if and only if p C q > 1. Combining these
results, we conclude that I converges according to Definition 3.4.3 if and only if p < 1
and p C q > 1.

Absolute Integrability

Definition 3.4.8 We say that f is absolutely integrable on OEa; b/ if f is locally inte-
                       Rb                                            Rb
grable on OEa; b/ and a jf .x/j dx < 1. In this case we also say that a f .x/ dx converges

absolutely or is absolutely convergent.

Example 3.4.12 If f is nonnegative and integrable on OEa; b/, then f is absolutely
integrable on OEa; b/, since jf j D f .

Example 3.4.13 Since               
                                    sin x  1
                                    Ä
                                    xp  xp
and 1 R 1 x p dx < 1 if p > 1 (Example 3.4.3), Theorem 3.4.6 implies that

                           Z 1 j sin xj             p > 1I
                            1 xp dx < 1;

that is, the function                        sin x
                                   f .x/ D xp

is absolutely integrable on OE1; 1/ if p > 1. It is not absolutely integrable on OE1; 1/ if

p Ä 1. To see this, we first consider the case where p D 1. Let k be an integer greater
than 3. Then
162 Chapter 3 Integral Calculus of Functions of One Variable

          Z k j sin xj            dx >     Z k j sin xj  dx

          1                 x                         x

                                     D  X k 1 Z .j C1/ j sin xj    dx

                                        j D1 j x                                      (3.4.5)
                                           X k 1 1 Z .j C1/                           (3.4.6)
                                     >                                  j sin xj dx:
                                                   .j C 1/ j
                                           j D1

But Z .j C1/ Z

                                     j sin xj dx D sin x dx D 2;

                               j                      0

so (3.4.5) implies that           Z k j sin xj

                                                dx >  2 X k 1 1      :

                                  1     x                j D1 j C 1

However,                             Z j C2 dx
                                                 ;
                                 1                       j D 1; 2; : : : ;
                               j C1   j C1 x

so (3.4.6) implies that

             Z k j sin xj               >       2 X k 1 Z j C2 dx

                         1        x                j D1 j C1 x

                                           2 Z kC1 dx 2 k C 1
                                        D                x D log 2 :

                                                   2

Since limk!1 logOE.k C 1/=2 D 1, Theorem 3.4.5 implies that

                                     Z 1 j sin xj     dx D 1:

                                     1          x

Now Theorem 3.4.6(b) implies that                        p Ä 1:                       (3.4.7)
                                   Z 1 j sin xj
                                     1 xp dx D 1;

Theorem 3.4.9 If f is locally integrable on OEa; b/ and a R b jf .x/j dx < 1; then
Rb
 a f .x/ dx convergesI that is; an absolutely convergent integral is convergent:

Proof If

                                     g.x/ D jf .x/j f .x/;
                                                Section 3.4 Improper Integrals 163

then
                                          0 Ä g.x/ Ä 2jf .x/j

and a R b g.x/ dx < 1, because of Theorem 3.4.6 and the absolute integrability of f . Since

                                              f D jf j g;
Theorem 3.4.4 implies that a R b f .x/ dx converges.

Conditional Convergence

We say that f is nonoscillatory at b .D 1 if b D 1/ if f is defined on OEa; b/ and
does not change sign on some subinterval OEa1; b/ of OEa; b/. If f changes sign on every
such subinterval, f is oscillatory at b . For a function that is locally integrable on OEa; b/

                                                                                     Rb
and nonoscillatory at b , convergence and absolute convergence of a f .x/ dx amount
to the same thing (Exercise 3.4.16), so absolute convergence is not an interesting concept

in connection with such functions. However, an oscillatory function may be integrable,

but not absolutely integrable, on OEa; b/, as the next example shows. We then say that f is
                                                    Rb

conditionally integrable on OEa; b/, and that a f .x/ dx converges conditionally.

Example 3.4.14 We saw in Example 3.4.13 that the integral

                                 Z 1 sin x
       I.p/ D                      xp dx

                       1

is not absolutely convergent if 0 < p Ä 1. We will show that it converges conditionally for
these values of p.

Integration by parts yields      cos c C cos 1    Z c cos x                   (3.4.8)
                    Z c sin x    cp             1 p xpC1 dx:
                      1 xp dx D

Since                            
                                  cos x  1
                                  xpC1  Ä xpC1
and 1 R 1 x p 1 dx < 1 if p > 0, Theorem 3.4.6 implies that x p 1 cos x is absolutely
integrable OE1; 1/ if p > 0. Therefore, Theorem 3.4.9 implies that x p 1 cos x is integrable

OE1; 1/ if p > 0. Letting c ! 1 in (3.4.8), we find that I.p/ converges, and

                             Z 1 cos x
       1 I.p/ D cos 1 p xpC1 dx if p > 0:

This and (3.4.7) imply that I.p/ converges conditionally if 0 < p Ä 1.

   The method used in Example 3.4.14 is a special case of the following test for convergence
of improper integrals.
164 Chapter 3 Integral Calculus of Functions of One Variable

Theorem 3.4.10R(Dirichlet's Test) Suppose that f is continuous and its an-
tiderivative F .x/ D  x    f .t/ dt  is  bounded  on  OEa; b/:          Let  g0  be  absolutely  integrable     on
                      a

OEa; b/; and suppose that

                                          lim g.x/ D 0:                                                 (3.4.9)

                                         x!b

Then a R b f .x/g.x/ dx converges:

Proof The continuous function fg is locally integrable on OEa; b/. Integration by parts

yields

        Zc                               Zc                                      a Ä c < b:             (3.4.10)
            f .x/g.x/ dx D F .c/g.c/         F .x/g0 .x/ dx;

        a                                a

Theorem 3.4.6 implies that the integral on the right converges absolutely as c ! b , since
Rb 0
 a jg .x/j dx < 1 by assumption, and

                               jF .x/g0 .x/j Ä M jg0.x/j;

where M is an upper bound for jF j on OEa; b/. Moreover, (3.4.9) and the boundedness of F

imply that limc!b F .c/g.c/ D 0. Letting c ! b in (3.4.10) yields

                           Zb                     Zb

                               f .x/g.x/ dx D            F .x/g0.x/ dx;

                           a                          a

where the integral on the right converges absolutely.

   Dirichlet's test is useful only if f is oscillatory at b R b, since it can be shown that if f is
nonoscillatory at b and F is bounded on OEa; b/, then a jf .x/g.x/j dx < 1 if only g is
locally integrable and bounded on OEa; b/ (Exercise 3.4.14).

Example 3.4.15 Dirichlet's test can also be used to show that certain integrals di-

verge. For example,                      Z1
                                               xq sin x dx

                                           1

diverges if q > 0, but none of the other tests that we have studied so far implies this. It

is not enough to argue that the integrand does not approach zero as x ! 1 (a common

mistake), since this does not imply divergence (Exercise 4.4.31). To see thRat the integral
diverges, we observe that if it converged for some q > 0, then F .x/ D                           x  xq  sin  x  dx
                                                                                                 1

would be bounded on OE1; 1/, and we could let

                           f .x/ D xq sin x and g.x/ D x q

in Theorem 3.4.10 and conclude that
                                              Z1
                                                    sin x dx

                                                                     1

also converges. This is false.
                                                    Section 3.4 Improper Integrals 165

   The method used in Example 3.4.15 is a special case of the following test for divergence
of improper integrals.

Theorem 3.4.11 Suppose that u is continuous on OEa; b/ and a R b u.x/ dx diverges: Let
v be positive and differentiable on OEa; b/; and suppose that limx!b v.x/ D 1 and v0=v2

                                               Rb
is absolutely integrable on OEa; b/: Then a u.x/v.x/ dx diverges:

Proof The proof is by contradiction. Let f D uv and g D 1=v, and suppose that
Rb                                                                 Rx
a u.x/v.x/ dx converges. Then f has the bounded antiderivative F .x/ D a u.t/v.t/ dt
on OEa; b/, limx!1 g.x/ D 0 and g0 D v0=v2 is absolutely integrable on OEa; b/. Therefore,
                                   Rb
Theorem 3.4.10 implies that a u.x/ dx converges, a contradiction.
If Dirichlet's test shows that a R b f .x/g.x/ dx converges, there remains the question of

whether it converges absolutely or conditionally. The next theorem sometimes answers this

question. Its proof can be modeled after the method of Example 3.4.13 (Exercise 3.4.17).

The idea of an infinite sequence, which we will discuss in Section 4.1, enters into the

statement of this theorem. We assume that you recall the concept sufficiently well from

calculus to understand the meaning of the theorem.

Theorem 3.4.12 Suppose that g is monotonic on OEa; b/ and a R b g.x/ dx D 1: Let f
be locally integrable on OEa; b/ and

                                  Z xj C1
                                            jf .x/j dx ; j 0;

                                                    xj

for some positive ; where fxj g is an increasing infinite sequence of points in OEa; b/ such
that limj !1 xj D b and xj C1 xj Ä M; j 0; for some M: Then

                                       Zb
                                            jf .x/g.x/j dx D 1:

                                                          a

Change of Variable in an Improper Integral

The next theorem enables us to investigate an improper integral by transforming it into
 another whose convergence or divergence is known. It follows from Theorem 3.3.18 and
 Definitions 3.4.1, 3.4.2, and 3.4.3. We omit the proof.

Theorem 3.4.13 Suppose that is monotonic and 0 is locally integrable on either
of the half-open intervals I D OEc; d / or .c; d ; and let x D .t/ map I onto either of the
half-open intervals J D OEa; b/ or J D .a; b: Let f be locally integrable on J: Then the

improper integrals

                    Zb                Zd

                        f .x/ dx and      f . .t// j 0.t/j dt

                    a                 c
166 Chapter 3 Integral Calculus of Functions of One Variable

diverge or converge together; in the latter case to the same value. The same conclusion
holds if and 0 have the stated properties only on the open interval .a; b/; the transfor-

mation x D .t/ maps .c; d / onto .a; b/; and f is locally integrable on .a; b/:

Example 3.4.16 To apply Theorem 3.4.13 to

                                Z1
                                      sin x2 dx;

                                0

                                                    p
we use the change of varia OE0; 1/, with 0.t/ D 1=.2pble x D .t/ D t , which takes OEc; d / D OE0; 1/ into OEa; b/ D t/. Theorem 3.4.13 implies that

                       Z1                 1 Z 1 sin t

                                       2
                          sin x dx D              p dt:
                                          20      t
                       0

Since the integral on the right converges (Example 3.4.14), so does the one on the left.

Example 3.4.17 The integral

                                Z1
                                     x p dx

                                  1

converges if and only if p > 1 (Example 3.4.3). Defining .t/ D 1=t and applying

Theorem 3.4.13 yields

Z1                              Z1                    Z1
                                          t 2j dt D tp 2 dt;
                       x p dx D tpj
                                                              0
1                               0

which implies that 0 R 1 tq dt converges if and only if q > 1.

                                3.4 Exercises

1. (a) Let f be locally integrable and bounded on OEa; b/, and let f .b/ be defined
                                                                                      Rb

             arbitrarily. Show that f is properly integrable on OEa; b, that a f .x/ dx does
             not depend on f .b/, and that

                          Zb                      Zc

                                f .x/ dx D lim f .x/ dx:
                                          c!b a
                             a

(b) State a result analogous to (a) which ends with the conclusion that

                          Zb                      Zb

                                f .x/ dx D lim f .x/ dx:
                                          c!aC c
                             a

2. Show that neither the existence nor the value of the improper integral of Defini-
      tion 3.4.3 depends on the choice of the intermediate point .
                                            Section 3.4 Improper Integrals 167

3. Prove: If a R b f .x/ dx exists according to Definition 3.4.1 or 3.4.2, then a R b f .x/ dx
      also exists according to Definition 3.4.3.

4. Find all values of p for which the following integrals exist (i) as proper integrals
     (perhaps after defining f at the endpoints of the interval) or (ii) as improper inte-
     grals. (iii) Evaluate the integrals for the values of p for which they converge.

(a) pxp 1 Z 1= Â sin 1                     1Ã
                               xp 2 cos dx
                         x            x
        0                                Ã
     Z 2= Â
(b) pxp 1 cos x C xp 2 sin 1 dx
                     1                x
        0                Z1                 Z1
     Z1
(c) e px dx (d) x p dx (e) x p dx.

     0                      0                  0

5. Evaluate                                   Z1
            Z1                           (b) e x sin x dx

     (a) e xxn dx .n D 0; 1; : : : /

     0                                            0

     Z 1 x dx                                 Z 1 x dx
1 (c) x2 C 1                             (d) p

                                                0 1 x2

     Z Â cos x sin x Ã                        Z 1 Â sin x cos x Ã
0 (e) x              x2 dx               =2 (f ) x C x2 dx

6. Prove: If a R b f .x/ dx exists as a proper or improper integral, then

                                  Zb

                                lim f .t/ dt D 0:

                               x!b x

7. Prove: If f is locally integrable on OEa; b/, then a R b f .x/ dx exists if and only if for
      each > 0 there is a number r in .a; b/ such that

                               Z  x2  f .t/ dt <
                                            

                                  x1

whenever r Ä x1, x2 < b. HINT: See Exercise 2.1.38.

8. Determine whether the integral converges or diverges.
     Z 1 log x C sin x                   Z 1 (b) .x2 C 3/3=2 sin2 x dx
(a)           p         dx
               x                                     1 .x C 1/43=2
     1

(c)  Z 1 1 C cos2 x  dx                  (d)   Z 1 4 C cos x
           p                                                 p dx
            1 C x2                                0 .1 C x/ x
     0

     Z1                                       Z1
(e) .x27 C sin x/e x dx                  (f ) x p.2 C sin x/ dx

          0                                       0
168 Chapter 3 Integral Calculus of Functions of One Variable

9. Find all values of p for which the integral converges.
     Z =2 sin x                Z =2 cos x                       Z1
(a)          p dx         (b)             p dx             (c) xpe x dx
     0x                                x
                               0                                  0

     Z =2 sin x                Z 1 dx                           Z 1 dx
(d)          .tan x/p dx  1 (e) x.log x/p                  0 (f ) x.j log xj/p

          0

     Z        x dx
             .sin x/p
(g)

          0

10. Let Ln.x/ be the iterated logarithm defined in Exercise 2.4.42. Show that

                       Z 1 dx

                       a L0.x/L1.x/ Lk .x/OELkC1.x/p

converges if and only if p > 1. Here a is any number such that LkC1.x/ > 0 for
x a.

11. Find conditions on p and q such that the integral converges.
     Z 1 .cos x=2/q                            Z1
(a)              2 p dx                   (b) .1           x/p.1 C x/q dx
             1 .1 x /
                                                       1

     Z 1 xp dx                                Z 1 OElog.1 C x/p .log x/q
0 (c) .1 C x2/q                           (d)                     xpCq dx

                                                    1

     Z 1 .log.1 C x/      log x/q              Z 1 .x      sin x/q
1 (e) xp                           dx     (f )             xp dx

                                                   0

12. Let f and g be polynomials and suppose that g has no real zeros. Find necessary

and sufficient conditions for convergence of

                               Z 1 f .x/
                                            dx:

                                  1 g.x/

13. Prove: If f and g are locally integrable on OEa; b/ and the improper integrals a R b f 2.x/ dx
     Rb 2                      Rb
and a g .x/ dx converge, then a f .x/g.x/ dx converges absolutely. HINT: .f 
g/2 0:
14. Suppose that f is locally integrable and F .x/ D a R x f .t/ dt is bounded on OEa; b/,

and let f be nonoscillatory at b . Let g be locally integrable and bounded on OEa; b/.

Show that Z b

                             jf .x/g.x/j dx < 1:

                          a

15. Suppose that g is positive and nonincreasing on OEa; b/ and a R b f .x/ dx exists as
                                                                                         Rb

        a proper or absolutely convergent improper integral. Show that a f .x/g.x/ dx
        exists and
                                                           Section 3.4 Improper Integrals 169

                              lim       1 Zb        f .t/g.t/ dt D 0:

                          x!b g.x/ x

        HINT: Use Exercise 3.4.6:
16. Show that if f is locally integrable on OEa; b/ and nonoscillatory at b , then a R b f .x/ dx

                                Rb
        exists if and only if a jf .x/j dx < 1.

17. (a) Prove Theorem 3.4.12. HINT: See Example 3.4.13:
       (b) Show that g satisfies the assumptions of Theorem 3.4.10 if g0 is locally inte-
               grable, g is monotonic on OEa; b/, and limx!b g.x/ D 0.

18. Find all values of p for which the integral converges (i) absolutely; (ii) condition-

ally.  Z 1 cos x                   Z 1 sin x                          Z 1 sin x
                              2 (b) x.log x/p dx                 2 (c) xp log x dx
(a)          xp dx

          1

       Z 1 sin 1=x                      Z 1 sin2 x sin 2x                 Z 1 sin x
(d)          xp dx            (e)                   xp 1 dx (f ) .1 C x2/p dx

          1                             0

19. Suppose that g00 is absolutely inteRgrable on OE0; 1/, limx!1 g0.x/ D 0, and limx!1 g.x/ D

                                                                       1

        L (finite or infinite). Show that 0 g.x/ sin x dx converges if and only if L D 0.
        HINT: Integrate by parts:

20. Let h be continuous on OE0; 1/. Prove:
       (a) If 0 R 1 e s0x h.x/ dx converges absolutely, then 0 R 1 e sx h.x/ dx converges

       absolutely if s > s0.                        R 1 sx
          R 1 s0x
(b) If 0 e h.x/ dx converges, then 0 e h.x/ dx converges if s > s0.

21. Suppose that f is locRally integrable on OE0; 1/, limx!1 f .x/ D A, and  > 1.
Find limx!1 x       1  x  f   .t  /t    dt  ,  and  prove  your  answer.
                       0
22. Suppose that f is continuous and F .x/ D a R x f .t/ dt is bounded on OEa; b/. Suppose
also that g > 0, g0 is nonnegative and locally integrable on OEa; b/, and limx!b g.x/ D

1. Show that

                    lim           1 Zx         f .t/g.t/ dt D 0; > 1:

                    x!b OEg.x/ a

HINT: Integrate by parts:

23. In addition to the assumptions of Exercise 3.4.22, assume that a R b f .t/ dt converges.

Show that                               1 Zx

                              lim                   f .t/g.t/ dt D 0:
                          x!b g.x/ a

HINT: Let F .x/ D x R b f .t/ dt; integrate by parts; and use Exercise 3.4.6:
170 Chapter 3 Integral Calculus of Functions of One Variable

24. Suppose that f is continuous, g0.x/ Ä 0, and g.x/ > 0 on OEa; b/. Show that if g0 is
                   Rb                         Rb
integrable on OEa; b/ and a f .x/ dx exists, then a f .x/g.x/ dx exists and

                   lim        1 Zb  f .t/g.t/ dt D 0:

                   x!b g.x/ x

HINT: Let F .x/ D x R b f .t/ dt; integrate by parts; and use Exercise 3.4.6:

25. Find all values of p for which the integral converges (i) absolutely; (ii) condition-

ally.                       Z1                                     Z1
     Z1                (b) j log xjp dx                       (c) xp cos.log x/ dx

(a) xp sin 1=x dx                0                                      1

          0

     Z1                     Z1
(d) .log x/p dx        (e) sin xp dx

1                             0

26. Let u1 be positive and satisfy the differential equation

                   u00 C p.x/u D 0; 0 Ä x < 1:                                 .A/

(a) Prove: If                    Z 1 dx
                                         2 < 1;

                                  0 u1.x/

then the function                          Z 1 dt

                        u2.x/ D u1.x/         x u1.t /2

also satisfies (A), while if

                                 Z 1 dx
                                         2 D 1;

                                  0 u1.x/

then the function                                Z x dt
                              0 u2.x/ D u1.x/ u12.t /

      also satisfies (A).
(b) Prove: If (A) has a solution that is positive on OE0; 1/, then (A) has solutions

      y1 and y2 that are positive on .0; 1/ and have the following properties:

                   y1.x/y20 .x/  y10 .x/y2.x/ D 1; x > 0;
                                 Ä
                                    y1.x/ < 0; x > 0;0

                                    y2.x/

and
                                        lim y1.x/ D 0:
                                       x!1 y2.x/
                                            Section 3.4 Improper Integrals 171

27. (a) Prove: If h is continuous on OE0; 1/, then the function
                                                               Zx

                                u.x/ D c1e x C c2ex C h.t/ sinh.x t/ dt

                                                                                             0

               satisfies the differential equation

                                              u00 u D h.x/; x > 0:

(b) Rewrite u in the form

                           u.x/ D a.x/e x C b.x/ex

and show that

                           u0.x/ D a.x/e x C b.x/ex:

(c) Show that if limx!1 a.x/ D A (finite), then

                            lim e2x OEb.x/ B D 0

                           x!1

for some constant B. HINT: Use Exercise 3.4.24: Show also that

                lim ex OEu.x/ Ae x Bex D 0:

               x!1

(d) Prove: If limx!1 b.x/ D B (finite), then

               lim u.x/e x D lim u0.x/e x D B:
               x!1                          x!1

               HINT: Use Exercise 3.4.23:
28. Suppose that the differential equation

                           u00 C p.x/u D 0                                                      .A/

has a positive solution on OE0; 1/, and therefore has two solutions y1 and y2 with the
properties given in Exercise 3.4.26(b).

(a) Prove: If h is continuous on OE0; 1/ and c1 and c2 are constants, then

                                     Zx                    y1.x/y2.t/ dt .B/

u.x/ D c1y1.x/ C c2y2.x/ C h.t/ OEy1.t/y2.x/

                                                        0

satisfies the differential equation

                           u00 C p.x/u D h.x/:

For convenience in (b) and (c), rewrite (B) as

               u.x/ D a.x/y1.x/ C b.x/y2.x/:
172 Chapter 3 Integral Calculus of Functions of One Variable

(b) Prove: If 0 R 1 h.t/y2.t/ dt converges, then 0 R 1 h.t/y1.t/ dt converges, and

               u.x/                   Ay1.x/ By2.x/ D 0
         lim                            y1.x/

        x!1

      for some constants A and B. HINT: Use Exercise 3.4.24 with f D hy2 and
      g D y1=y2:

                  R1
(c) Prove: If 0 h.t/y1.t/ dt converges, then

                               lim        u.x/  DB

                               x!1 y2.x/

for some constant B. HINT: Use Exercise 3.4.23 with f D hy1 and g D

y2=y1:

29. Suppose that f , f1, and g are continuous, f > 0, and .f1=f /0 is absolutely inte-
        Rb                                                    Rb
grable on OEa; b/. Show that a f1.x/g.x/ dx converges if a f .x/g.x/ dx does.

30. Let g be locally integrable and f continuous, with f .x/ > 0 on OEa; b/. Sup-

pose that for some positive M and for every r in OEa; b/ there are points x1 and x2

such that (a) r < x1 < x2 < b; (b) g does not change sign in OEx1; x2; and
R x2                                  Rb
(c) x1 jg.x/j dx M . Show that a f .x/g.x/ dx diverges. HINT: Use Exer-
cise 3.4.7 and Theorem 3.3.7:

3.5 A MORE ADVANCED LOOK AT THE EXISTENCE OF
THE PROPER RIEMANN INTEGRAL

In Section 3.2 we found necessary and sufficient conditions for existence of the proper
Riemann integral, and in Section 3.3 we used them to study the properties of the integral.
However, it is awkward to apply these conditions to a specific function and determine
whether it is integrable, since they require computations of upper and lower sums and
upper and lower integrals, which may be difficult. The main result of this section is an
integrability criterion due to Lebesgue that does not require computation, but has to do
with how badly discontinuous a function may be and still be integrable.

   We emphasize that we are again considering proper integrals of bounded functions on
finite intervals.

Definition 3.5.1 If f is bounded on OEa; b, the oscillation of f on OEa; b is defined by

                                Wf OEa; b D sup jf .x/ f .x0/j;

                                                                   aÄx;x0 Äb

which can also be written as

        Wf OEa; b D sup f .x/ inf f .x/
                                          aÄxÄb
                               aÄxÄb
Section 3.5 Advanced Look at the Existence of the Proper Riemann Integral 173

( Exercise 3.5.1). If a < x < b, the oscillation of f at x is defined by

                        wf .x/ D lim Wf .x h; x C h/:

                                         h!0C

The corresponding definitions for x D a and x D b are

wf .a/ D lim Wf .a; a C h/ and wf .b/ D lim Wf .b                         h; b/:
                  h!0C                                   h!0C

   For a fixed x in .a; b/, Wf .x h; x C h/ is a nonnegative and nondecreasing function
of h for 0 < h < min.x a; b x/; therefore, wf .x/ exists and is nonnegative, by
Theorem 2.1.9. Similar arguments apply to wf .a/ and wf .b/.

Theorem 3.5.2 Let f be defined on OEa; b: Then f is continuous at x0 in OEa; b if
and only if wf .x0/ D 0: .Continuity at a or b means continuity from the right or left,
respectively./

Proof Suppose that a < x0 < b. First, suppose that wf .x0/ D 0 and > 0. Then

                        Wf OEx0 h; x0 C h <

for some h > 0, so                          if x0 h Ä x; x0 Ä x0 C h:
                       jf .x/ f .x0/j <

Letting x0 D x0, we conclude that

                  jf .x/ f .x0/j < if jx x0j < h:

Therefore, f is continuous at x0.
   Conversely, if f is continuous at x0 and > 0, there is a i > 0 such that

                  jf .x/ f .x0/j < and jf .x0/ f .x0/j <       2
                                         2

if x0 i Ä x, x0 Ä x0 C i. From the triangle inequality,

jf .x/ f .x0/j Ä jf .x/ f .x0/j C jf .x0/ f .x0/j < ;

so
                               Wf OEx0 h; x0 C h Ä if h < iI

therefore, wf .x0/ D 0. Similar arguments apply if x0 D a or x0 D b.

Lemma 3.5.3 If wf .x/ < for a Ä x Ä b; then there is a i > 0 such that
Wf OEa1; b1 Ä ; provided that OEa1; b1 OEa; b and b1 a1 < i:

Proof We use the Heine-Borel theorem (Theorem 1.3.7). If wf .x/ <            , there is an
                                                                                   (3.5.1)
hx > 0 such that        jf .x0/ f .x00/j <
174 Chapter 3 Integral Calculus of Functions of One Variable

if          x 2hx < x0; x00 < x C 2hx and x0; x00 2 OEa; b:     (3.5.2)
If Ix D .x
            hx; x C hx/, then the collection
               °                                       «
            H D Ix  a Ä x Ä b

is an open covering of OEa; b, so the Heine-Borel theorem implies that there are finitely
many points x1, x2, . . . , xn in OEa; b such that Ix1 , Ix2 , . . . , Ixn cover OEa; b. Let

               h D min hxi

                       1Äi Än

and suppose that OEa1; b1 OEa; b and b1       a1 < h.  If x0 and x00 are in OEa1; b1, then
x0 2 Ixr for some r .1 Ä r Ä n/, so

               jx0 xr j < hxr :

Therefore,

                       jx00 xr j Ä jx00 x0j C jx0 xr j < b1 a1 C hxr

                                   < h C hxr Ä 2hxr :

Thus, any two points x0 and x00 in OEa1; b1 satisfy (3.5.2) with x D xr , so they also satisfy
(3.5.1). Therefore, is an upper bound for the set

                               °jf .x0/ f .x00/j  x0; x00 2 OEa1; b1« ;

which has the supremum Wf OEa1; b1. Hence, Wf OEa1; b1 Ä .
   In the following, L.I / is the length of the interval I .

Lemma 3.5.4 Let f be bounded on OEa; b and define
                                              
            E D x 2 OEa; b  wf .x/°                       «  :

Then E is closed; and f is integrable on OEa; b if and only if for every pair of positive

numbers and i; E can be covered by finitely many open intervals I1; I2;. . . ; Ip such

that           Xp

                     L.Ij / < i:                                (3.5.3)

               j D1

Proof We first show that E is closed. Suppose that x0 is a limit point of E . If h > 0,
there is an x from E in .x0 h; x0 C h/. Since OEx h1; x C h1 OEx0 h; x0 C h for
sufficiently small h1 and Wf OEx h1; x C h1 , it follows that Wf OEx0 h; x0 C h
for all h > 0. This implies that x0 2 E , so E is closed (Corollary 1.3.6).

   Now we will show that the stated condition in necessary for integrability. Suppose that
the condition is not satisfied; that is, there is a > 0 and a i > 0 such that

                                             Xp
                                                  L.Ij / i

                                                                 j D1
       Section 3.5 Advanced Look at the Existence of the Proper Riemann Integral 175

for every finite set fI1; I2; : : : ; Ipg of open intervals covering E . If P D fx0; x1; : : : ; xng
is a partition of OEa; b, then

                    X      mj /.xj                    X  mj /.xj  xj 1/;     (3.5.4)
S.P / s.P / D .Mj                          xj 1/ C .Mj

                     j 2A                        j 2B

where

       °                                «           °                     «
       A D j  OExj 1; xj  \ E ¤ ; and B D j  OExj 1; xj  \ E D ; :

          S
   Since j 2A.xj 1; xj / contains all points of E except any of x0, x1, . . . , xn that may
be in E , and each of these finitely many possible exceptions can be covered by an open
interval of length as small as we please, our assumption on E implies that

                                         X
                                              .xj xj 1/ i:

                                                           j 2A

Moreover, if j 2 A, then

                           Mj mj ;

so (3.5.4) implies that

                           S.P / s.P /     X  .xj xj 1/ i:

                                           j 2A

Since this holds for every partition of OEa; b, f is not integrable on OEa; b, by Theorem 3.2.7.
This proves that the stated condition is necessary for integrability.

   For sufficiency, let and i be positive numbers and let I1, I2, . . . , Ip be open intervals
that cover E and satisfy (3.5.3). Let

                                           eI j D OEa; b \ I j :

(I j D closure of I .) After combining any of eI 1, eI 2, . . . , eI p that overlap, we obtain a set
of pairwise disjoint closed subintervals

                           Cj D OEj ; j ; 1 Ä j Ä q .Ä p/;

of OEa; b such that

       a Ä 1 < 1 < 2 < 2 < q 1 < q 1 < q < q Ä b;                            (3.5.5)
                                                                             (3.5.6)
                           Xq              i / < i
                               .i

                           i D1

and                    wf .x/ < ; j Ä x Ä j C1; 1 Ä j Ä q 1:
Also, wf .x/ <       for a Ä x Ä 1 if a < 1 and for q Ä x Ä b if q < b.
176 Chapter 3 Integral Calculus of Functions of One Variable

   Let P0 be the partition of OEa; b with the partition points indicated in (3.5.5), and refine
P0 by partitioning each subinterval OEj ; j C1 (as well as OEa; 1 if a < 1 and OEq; b
if q < b) into subintervals on which the oscillation of f is not greater than . This is
possible by Lemma 3.5.3. In this way, after renaming the entire collection of partition
points, we obtain a partition P D fx0; x1; : : : ; xng of OEa; b for which S.P / s.P / can be
written as in (3.5.4), with

                               X                    Xq         i / < i
                                    .xj  xj 1/ D .i

                               j 2A                      i D1

(see (3.5.6)) and              Mj mj Ä ; j 2 B:

For this partition,            mj /.xj                   X           xj 1/ < 2Ki;
                  X                      xj 1/ Ä 2K .xj
                      .Mj
                                                               j 2A
                         j 2A

where K is an upper bound for jf j on OEa; b and
                             X
                                  .Mj mj /.xj xj 1/ Ä .b a/:

                                          j 2B

We have now shown that if and i are arbitrary positive numbers, there is a partition P of

OEa; b such that

                               S.P / s.P / < 2Ki C .b a/:                             (3.5.7)

If > 0, let

                               i D 4K and D 2.b a/ :

Then (3.5.7) yields

                                         S.P / s.P / < ;

and Theorem 3.2.7 implies that f is integrable on OEa; b.
   We need the next definition to state Lebesgue's integrability condition.

Definition 3.5.5 A subset S of the real line is of Lebesgue measure zero if for every

> 0 there is a finite or infinite sequence of open intervals I1, I2, . . . such that

                                         S  [  Ij

                                                                                      (3.5.8)

                                            j

and                            Xn

                                         L.Ij / < ; n 1:                              (3.5.9)

                               j D1
       Section 3.5 Advanced Look at the Existence of the Proper Riemann Integral 177

   Note that any subset of a set of Lebesgue measure zero is also of Lebesgue measure zero.
(Why?)

Example 3.5.1 The empty set is of Lebesgue measure zero, since it is contained in
any open interval.

Example 3.5.2 Any finite set S D fx1; x2; : : : ; xng is of Lebesgue measure zero,
since we can choose open intervals I1, I2, . . . , In such that xj 2 Ij and L.Ij / < =n,
1 Ä j Ä n.

Example 3.5.3 An infinite set is denumerable if its members can be listed in a se-
quence (that is, in a one-to-one correspondence with the positive integers); thus,

                            S D fx1; x2; : : : ; xn; : : : g:                                 (3.5.10)

An infinite set that does not have this property is nondenumerable. Any denumerable set

(3.5.10) is of Lebesgue measure zero, since if > 0, it is possible to choose open intervals
I1, I2, . . . , so that xj 2 Ij and L.Ij / < 2 j , j 1. Then (3.5.9) holds because

       11 1                           1         1                                             (3.5.11)
       2 C 22 C 23 C              C 2n D 1      2n < 1:

   There are also nondenumerable sets of Lebesgue measure zero, but it is beyond the scope
of this book to discuss examples.

   The next theorem is the main result of this section.

Theorem 3.5.6 A bounded function f is integrable on a finite interval OEa; b if and
only if the set S of discontinuities of f in OEa; b is of Lebesgue measure zero:

Proof  From Theorem 3.5.2,

       S D x 2 OEa; b  wf .x/ > 0 :°                           «

Since wf .x/ > 0 if and only if wf .x/ 1= i for some positive integer i , we can write

                                        [ 1                                                   (3.5.12)
                                  S D Si ;

                                          i D1

where  Si D x 2 OEa; b  wf .x/ 1= i :°                            «

   Now suppose that f is integrable on OEa; b and > 0. From Lemma 3.5.4, each Si can

be covered by a finite number of open intervals Ii1, Ii2, . . . , Iin of total length less than
 =2i . We simply renumber these intervals consecutively; thus,

       I1; I2; D I11; : : : ; I1n1 ; I21; : : : ; I2n2 ; : : : ; Ii1; : : : ; Iini ; : : : :

Now (3.5.8) and (3.5.9) hold because of (3.5.11) and (3.5.12), and we have shown that the
stated condition is necessary for integrability.
178 Chapter 3 Integral Calculus of Functions of One Variable

For sufficiency, suppose that the stated condition holds and > 0. Then S can be

covered by open intervals I1; I2; : : : that satisfy (3.5.9). If > 0, then the set
                            °                      «
                     E D x 2 OEa; b  wf .x/

of Lemma 3.5.4 is contained in S (Theorem 3.5.2), and therefore E is covered by I1; I2; : : : .
Since E is closed (Lemma 3.5.4) and bounded, the Heine-Borel theorem implies that E
is covered by a finite number of intervals from I1; I2; : : : . The sum of the lengths of the
latter is less than , so Lemma 3.5.4 implies that f is integrable on OEa; b.

                              3.5 Exercises

1. In connection with Definition 3.5.1, show that

   sup jf .x/                     f .x0/j D sup f .x/           inf f .x/:

x;x0 2OEa;b                                        aÄxÄb      aÄxÄb

2. Use Theorem 3.5.6 to show that if f is integrable on OEa; b, then so is jf j and, if
      f .x/ > 0 .a Ä x Ä b/, so is 1=f .

3. Prove: The union of two sets of Lebesgue measure zero is of Lebesgue measure
      zero.

4. Use Theorem 3.5.6 and Exercise 3.5.3 to show that if f and g are integrable on
      OEa; b, then so are f C g and fg.

5. Suppose f is integrable on OEa; b,  D infaÄxÄb f .x/, and  D supaÄxÄb f .x/.
      Let g be continuous on OE; . Show that the composition h D g i f is integrable
      on OEa; b.

6. Let f be integrable on OEa; b, let  D infaÄxÄb f .x/ and  D supaÄxÄb f .x/, and
      suppose that G is continuous on OE; . For each n 1, let

                 .j  1/.b a/                       j.b a/
           aC        n Ä uj n; vj n Ä a C n ; 1 Ä j Ä n:
Show that
                     1 Xn
                      lim         jG.f .uj n//     G.f .vj n//j D 0:
                     n!1 n
                            j D1

7. Let h.x/ D 0 for all x in OEa; b except for x in a set of Lebesgue measure zero.
                      Rb

      Show that if a h.x/ dx exists, it equals zero. HINT: Any subset of a set of measure
      zero is also of measure zero:

8. Suppose that f and g are integrable on OEa; b and f .x/ D g.x/ except for x in a set

of Lebesgue measure zero. Show that

                            Zb         Zb

                                f .x/ dx D g.x/ dx:

                            a                   a
                                       CHAPTER 4

                           Infinite Sequences and Series

IN THIS CHAPTER we consider infinite sequences and series of constants and functions
of a real variable.

SECTION 4.1 introduces infinite sequences of real numbers. The concept of a limit of a
sequence is defined, as is the concept of divergence of a sequence to 1. We discuss
bounded sequences and monotonic sequences. The limit inferior and limit superior of a
sequence are defined. We prove the Cauchy convergence criterion for sequences of real
numbers.

SECTION 4.2 defines a subsequence of an infinite sequence. We show that if a sequence
converges to a limit or diverges to 1, then so do all subsequences of the sequence. Limit
points and boundedness of a set of real numbers are discussed in terms of sequences of
members of the set. Continuity and boundedness of a function are discussed in terms of the
values of the function at sequences of points in its domain.

SECTION 4.3 introduces concepts of convergence and divergence to 1 for infinite series
of constants. We prove Cauchy's convergence criterion for a series of constants. In con-
nection with series of positive terms, we consider the comparison test, the integral test, the
ratio test, and Raabe's test. For general series, we consider absolute and conditional con-
vergence, Dirichlet's test, rearrangement of terms, and multiplication of one infinite series
by another.

SECTION 4.4 deals with pointwise and uniform convergence of sequences and series of
functions. Cauchy's uniform convergence criteria for sequences and series are proved, as
is Dirichlet's test for uniform convergence of a series. We give sufficient conditions for
the limit of a sequence of functions or the sum of an infinite series of functions to be
continuous, integrable, or differentiable.
SECTION 4.5 considers power series. It is shown that a power series that converges on
an open interval defines an infinitely differentiable function on that interval. We define
the Taylor series of an infinitely differentiable function, and give sufficient conditions for
the Taylor series to converge to the function on some interval. Arithmetic operations with
power series are discussed.

                                                    178
                                                   Section 4.1 Sequences of Real Numbers 179
4.1 SEQUENCES OF REAL NUMBERS

An infinite sequence (more°briefly, a «sequence) of real numbers is a real-valued function
defined on a set of integers n  n k . We call the values of the function the terms of the
sequence. We denote a sequence by listing its terms in order; thus,

              fsngk1 D fsk; skC1; : : : g:                             (4.1.1)

For example,

                 1 1 11 1
              n2 C 1 0 D 1; 2 ; 5 ; : : : ; n2 C 1 ; : : : ;
              f. 1/ng01 D f1; 1; 1; : : : ; . 1/n; : : : g ;

and           1 1 11 1

                    D 1; ; ; : : : ;        ;::: :
              n 23  23 n 2

The real number sn is the nth term of the sequence. Usually we are interested only in the
terms of a sequence and the order in which they appear, but not in the particular value of k
in (4.1.1). Therefore, we regard the sequences

                11                    11
                             and      n1

              n 23

as identical.

   We will usually write fsng rather than fsng1 k . In the absence of any indication to the
contrary, we take k D 0 unless sn is given by a rule that is invalid for some nonnegative
integer, in which case k is understood to be the smallest positive integer such that sn is
defined for all n k. For example, if

                                   1
                    sn D .n 1/.n 5/ ;

then k D 6.
   The interesting questions about a sequence fsng concern the behavior of sn for large n.

Limit of a Sequence                                                    > 0 there is an
                                                                                 (4.1.2)
Definition 4.1.1 A sequence fsng converges to a limit s if for every
integer N such that

                                      jsn sj < if n N:
In this case we say that fsng is convergent and write

                                               lim sn D s:

                                                                  n!1

A sequence that does not converge diverges, or is divergent
180 Chapter 4 Infinite Sequences and Series

   As we saw in Section 2.1 when discussing limits of functions, Definition 4.1.1 is not
changed by replacing (4.1.2) with

                                     jsn   sj < K  if n N;
where K is a positive constant.

Example 4.1.1 If sn D c for n k, then jsn cj D 0 for n k, and limn!1 sn D c.

Example 4.1.2 If

                                           sn D 2n C 1 ;
                                                     nC1

then limn!1 sn D 2, since                                   
                             jsn  2j D  2n C 1     2n C 2  1  D I
                                                   nC1 nC1
                                          nC1

hence, if > 0, then (4.1.2) holds with s D 2 if N 1= .

   Definition 4.1.1 does not require that there be an integer N such that (4.1.2) holds for
all ; rather, it requires that for each positive there be an integer N that satisfies (4.1.2)
for that particular . Usually, N depends on and must be increased if is decreased. The
constant sequences (Example 4.1.1) are essentially the only ones for which N does not
depend on (Exercise 4.1.5).

   We say that the terms of a sequence fsng1 k satisfy a given condition for all n if sn satisfies
the condition for all n k, or for large n if there is an integer N > k such that sn satisfies
the condition whenever n N . For example, the terms of f1=ng1 1 are positive for all n,
while those of f1 7=ng1 1 are positive for large n (take N D 8).

Uniqueness of the Limit

Theorem 4.1.2 The limit of a convergent sequence is unique:

Proof Suppose that

                                   lim sn D s and   lim sn D s0:

                                  n!1              n!1

We must show that s D s0. Let > 0. From Definition 4.1.1, there are integers N1 and N2
such that

                                      jsn sj < if n N1

(because limn!1 sn D s), and               s0j <   if n N2
                                      jsn
                                       Section 4.1 Sequences of Real Numbers 181

(because limn!1 sn D s0). These inequalities both hold if n  N D max.N1; N2/, which
implies that

                      js s0j D j.s sN / C .sN s0/j
                               Ä js sN j C jsN s0j < C D 2 :

Since this inequality holds for every  > 0 and js   s0j is independent of , we conclude
that js s0j D 0; that is, s D s0.

Sequences Diverging to 1

We say that

                                        lim sn D 1

                                       n!1

if for any real number a, sn > a for large n. Similarly,

                                              lim sn D 1

                                                                n!1

if for any real number a, sn < a for large n. However, we do not regard fsng as convergent
unless limn!1 sn is finite, as required by Definition 4.1.1. To emphasize this distinction,
we say that fsng diverges to 1 . 1/ if limn!1 sn D 1 . 1/.

Example 4.1.3 The sequence fn=2 C 1=ng diverges to 1, since, if a is any real num-

ber, then             n1
                      2 C n > a if n 2a:

The sequence fn n2g diverges to 1, since, if a is any real number, then

                      n2 C n D n.n 1/ < a if n > 1 C pjaj:

 Therefore, we write        Ân 1Ã
and                    lim C D 1
                      n!1 2 n
                       lim . n2 C n/ D 1:

                      n!1

The sequence f. 1/nn3g diverges, but not to 1 or 1.

Bounded Sequences

Definition 4.1.3 A sequence fsng is bounded above if there is a real number b such
that

                                           sn Ä b for all n;
bounded below if there is a real number a such that

                                           sn a for all n;

or bounded if there is a real number r such that

                                          jsnj Ä r for all n:
182 Chapter 4 Infinite Sequences and Series

Example 4.1.4 If sn D OE1 C . 1/nn, then fsng is bounded below .sn 0/ but

unbounded above, and f sng is bounded above . sn Ä 0/ but unbounded below. If sn D
. 1/n, then fsng is bounded. If sn D . 1/nn, then fsng is not bounded above or below.

Theorem 4.1.4 A convergent sequence is bounded:

Proof By taking  D 1 in (4.1.2), we see that if limn!1 sn D s, then there is an integer
N such that                 jsn sj < 1 if n N:

Therefore,

       jsnj D j.sn s/ C sj Ä jsn sj C jsj < 1 C jsj if n N;

and
                             jsnj Ä maxfjs0j; js1j; : : : ; jsN 1j; 1 C jsjg

for all n, so fsng is bounded.

Monotonic Sequences

Definition 4.1.5 A sequence fsng is nondecreasing if sn sn 1 for all n, or nonin-
creasing if sn Ä sn 1 for all n: A monotonic sequence is a sequence that is either nonin-
creasing or nondecreasing. If sn > sn 1 for all n, then fsng is increasing, while if sn < sn 1
for all n, fsng is decreasing.

Theorem 4.1.6
(a) If fsng is nondecreasing; then limn!1 sn D supfsng:
(b) If fsng is nonincreasing; then limn!1 sn D inffsng:

Proof (a). Let  D supfsng. If  < 1, Theorem 1.1.3 implies that if > 0 then

                                             < sN Ä 
for some integer N . Since sN Ä sn Ä  if n N , it follows that

                      < sn Ä  if n N:

This implies that jsn j < if n N , so limn!1 sn D , by Definition 4.1.1. If  D 1
and b is any real number, then sN > b for some integer N . Then sn > b for n N , so
limn!1 sn D 1.

  We leave the proof of (b) to you (Exercise 4.1.8)

Example 4.1.5 If s0 D 1 and sn D 1 e sn 1, then 0 < sn Ä 1 for all n, by induction.

Since

                 snC1 sn D .e sn esn 1 / if n 1;
                                    Section 4.1 Sequences of Real Numbers 183

the mean value theorem (Theorem 2.3.11) implies that

                       snC1 sn D e tn.sn sn 1/ if n 1;             (4.1.3)

where tn is between sn 1 and sn. Since s1 s0 D 1=e < 0, it follows by induction from
(4.1.3) that snC1 sn < 0 for all n. Hence, fsng is bounded and decreasing, and therefore
convergent.

Sequences of Functional Values

The next theorem enables us to apply the theory of limits developed in Section 2.1 to some
sequences. We leave the proof to you (Exercise 4.1.13).

Theorem 4.1.7 Let limx!1 f .x/ D L; where L is in the extended reals; and suppose
that sn D f .n/ for large n: Then

                                               lim sn D L:

                                                                  n!1

Example 4.1.6 Let

                       sn D  log n  and f .x/ D       log x  :

                             n                         x

By L'Hospital's rule,

                            lim log x D lim 1=x D 0:
                            x!1 x   x!1 1

Hence, limn!1 log n=n D 0.

Example 4.1.7 Let sn D .1 C 1=n/n and
                                           Â 1 x log.1C1=x/ Ãx

                                f .x/ D 1 C x D e :

By L'Hospital's rule,

                            Â 1Ã                  log.1 C 1=x/
                       lim x log 1 C D lim
        x!1                     x   x!1               1=x

                                                  11

                                    D lim         x2 1 C 1=x D 1I
                                                     1=x2
                                        x!1

hence,                 Â 1 1 Ãx                        Â 1 Ãn

        lim 1 C        x     D e D e and          lim 1 C D e:
        x!1                                       n!1           n

The last equation is sometimes used to define e.
184 Chapter 4 Infinite Sequences and Series

Example 4.1.8 Suppose that sn D            n with   > 0, and let f .x/ D  x D ex log . Since

                  lim ex log         8      if log  < 0 .0 < < 1/;
                                     ^<0;   if log  D 0 . D 1/;
                 x!1              D 1;      if log  > 0 . > 1/;
                                     ^:

                                       1;

it follows that                        8
                                       <0;
                    lim           n D 1;            0 < < 1;
                                       :              D 1;
                   n!1                                > 1:
                                         1;

Therefore,                                 8

                                           <0;    1 < r < 1;
                   lim rn D 1;                  r D 1;
                   n!1                     :    r > 1;
                                            1;

a result that we will use often.

A Useful Limit Theorem

The next theorem enables us to investigate convergence of sequences by examining simpler
sequences. It is analogous to Theorem 2.1.4.

Theorem 4.1.8 Let

                   lim sn D s and lim tn D t;                             (4.1.4)
                   n!1                              n!1
                                                                          (4.1.5)
where s and t are finite: Then     lim .csn/ D cs
if c is a constantI                                                       (4.1.6)
                                  n!1                                     (4.1.7)
                                                                          (4.1.8)
                                          lim .sn C tn/ D s C t;
                                                                          (4.1.9)
                                                           n!1

                                           lim .sn tn/ D s t;

                                                            n!1

                                              lim .sntn/ D st;

                                                                 n!1

and
                                                  lim sn D s
                                                 n!1 tn t

 if tn is nonzero for all n and t ¤ 0.

Proof We prove (4.1.8) and (4.1.9) and leave the rest to you (Exercises 4.1.15 and
4.1.17). For (4.1.8), we write

                 sntn st D sntn stn C stn st D .sn s/tn C s.tn t /I
                                  Section 4.1 Sequences of Real Numbers 185

hence,

                        jsntn stj Ä jsn sj jtnj C jsj jtn tj:       (4.1.10)

Since ftng converges, it is bounded (Theorem 4.1.4). Therefore, there is a number R such
that jtnj Ä R for all n, and (4.1.10) implies that

                        jsntn stj Ä Rjsn sj C jsj jtn tj:           (4.1.11)

From (4.1.4), if > 0 there are integers N1 and N2 such that

                        jsn sj < if n N1                            (4.1.12)

and

                        jtn tj < if n N2:                           (4.1.13)

If N D max.N1; N2/, then (4.1.12) and (4.1.13) both hold when n     N , and (4.1.11)
implies that

                               jsntn stj Ä .R C jsj/ if n N:

This proves (4.1.8).

     Now consider (4.1.9) in the special case where sn D 1 for all n and t ¤ 0; thus, we want

to show that                          11
                                lim D :
                               n!1 tn t

   First, observe that since limn!1 tn D t ¤ 0, there is an integer M such that jtnj jtj=2
if n M . To see this, we apply Definition 4.1.1 with D jtj=2; thus, there is an integer
M such that jtn tj < jt=2j if n M . Therefore,

              jtnj D jt C .tn t/j jjtj jtn tjj jtj if n M:
                                                                2

If > 0, choose N0 so that jtn tj < if n N0, and let N D max.N0; M /. Then
                        
                       1 1    jt tnj 2  D Ä 2 if n N I
                        tn t jtnj jtj jtj

hence, limn!1 1=tn D 1=t. Now we obtain (4.1.9) in the general case from (4.1.8) with
ftng replaced by f1=tng.

Example 4.1.9 To determine the limit of the sequence defined by

                        sn D 1 sin n C 2.1 C 3=n/ ;
                          n4         1 C 1=n

we apply the applicable parts of Theorem 4.1.8 as follows:
                                  h                              i

                          1n      2 lim 1 C 3 lim .1=n/
                                  n!1                       n!1
              lim sn D lim sin C
              n!1       n!1 n  4     lim 1 C lim .1=n/
                                  n!1                       n!1

                        D 0 C 2.1 C 3 0/ D 2:
                                    1C0
186 Chapter 4 Infinite Sequences and Series

Example 4.1.10 Sometimes preliminary manipulations are necessary before applying
Theorem 4.1.8. For example,

                      .n=2/ C log n         1=2 C .log n/=n
                 lim  p D lim
                 n!1 3n C 4 n n!1 3 C 4n                1=2

                                        lim 1=2 C lim .log n/=n
                                     D n!1        n!1

                                        lim 3 C 4 lim n 1=2
                                        n!1          n!1

                                     D 1=2 C 0    (see Example 4.1.6)
                                          3C0

                                        1
                                     D 6:

Example 4.1.11 Suppose that 1 < r < 1 and

       s0 D 1; s1 D 1 C r; s2 D 1 C r C r 2; : : : ; sn D 1 C r C C r n:

Since

       sn r sn D .1 C r C C r n/ .r C r 2 C C r nC1/ D 1 r nC1;

it follows that                             1 r nC1
                                     sn D 1 r :
                                                                           (4.1.14)

From Example 4.1.8, limn!1 r nC1 D 0, so (4.1.14) and Theorem 4.1.8 yield

                  lim .1 C r C     C rn/ D 1 if              1 < r < 1:
                                              1r
                 n!1

   Equations (4.1.5)-(4.1.8) are valid even if s and t are arbitrary extended reals, provided
that their right sides are defined in the extended reals (Exercises 4.1.16, 4.1.18, and 4.1.21);
(4.1.9) is valid if s=t is defined in the extended reals and t ¤ 0 (Exercise 4.1.22).

Example 4.1.12 If 1 < r < 1, then

                                r  n lim rn          0
                                        n!1
                      lim D                     D D 0;
                      n!1 nS lim nS 1
                                        n!1

from (4.1.9) and Example 4.1.8. However, if r > 1, (4.1.9) and Example 4.1.8 yield

                                     r  n lim rn        1
                                        n!1
                      lim D                       D;
                      n!1 nS lim nS 1
                                        n!1

an indeterminate form. If r Ä 1, then limn!1 r n does not exist in the extended reals, so

(4.1.9) is not applicable. Theorem 4.1.7 does not help either, since there is no elementary
function f such that f .n/ D r n=nS. However, the following argument shows that
                                              Section 4.1 Sequences of Real Numbers 187

                                          rn     1 < r < 1:                     (4.1.15)
                                    lim D 0;                                  N , which
                                   n!1 nS
There is an integer M such that

                       jrj < 1                if n M:
                       n2

Let K D r m=M S. Then

     jr jn             jrj jrj                jr j Â 1 Ãn M
     nS Ä K M C 1 M C 2                          <K           ;       n > M:
                                              n      2

Given > 0, choose N    M so that K=2N M < . Then jr jn=nS < if n
verifies (4.1.15).

Limits Superior and Inferior

Requiring a sequence to converge may be unnecessarily restrictive in some situations. Of-
ten, useful results can be obtained from assumptions on the limit superior and limit inferior
of a sequence, which we consider next.

Theorem 4.1.9                                           1; then there is a unique real

(a) If fsng is bounded above and does not diverge to
      number s such that; if > 0;

                       sn < s C for large n                                   (4.1.16)

and

                       sn > s                 for infinitely many n:          (4.1.17)

(b) If fsng is bounded below and does not diverge to 1; then there is a unique real
      number s such that; if > 0;

                       sn > s                    for large n                  (4.1.18)

and

                       sn < s C for infinitely many n:                        (4.1.19)

Proof We will prove (a) and leave the proof of (b) to you (Exercise 4.1.23). Since
fsng is bounded above, there is a number  such that sn <  for all n. Since fsng does not
diverge to 1, there is a number  such that sn >  for infinitely many n. If we define

                                Mk D supfsk; skC1; : : : ; skCr ; : : : g;
188 Chapter 4 Infinite Sequences and Series

then  Ä Mk Ä , so fMkg is bounded. Since fMkg is nonincreasing (why?), it converges,

by Theorem 4.1.6. Let

                                    s D lim Mk :                                  (4.1.20)

                                           k!1

If > 0, then Mk < s C for large k, and since sn Ä Mk for n k, s satisfies (4.1.16).

If (4.1.17) were false for some positive , there would be an integer K such that

                            sn Ä s           if n K:

However, this implies that

                            Mk Ä s           if k K;

which contradicts (4.1.20). Therefore, s has the stated properties.

Now we must show that s is the only real number with the stated properties. If t < s, the

inequality

                                    st            st
                            sn < t C 2 D s 2

cannot hold for all large n, because this would contradict (4.1.17) with D .s t/=2. If

s < t, the inequality

                            sn > t  ts            ts
                                    2 DsC 2

cannot hold for infinitely many n, because this would contradict (4.1.16) with D .t s/=2.
Therefore, s is the only real number with the stated properties.

Definition 4.1.10 The numbers s and s defined in Theorem 4.1.9 are called the limit
superior and limit inferior, respectively, of fsng, and denoted by

                            s D lim sn and s D lim sn:
                            n!1
                                                  n!1

We also define

                        lim sn D 1 if fsng is not bounded above;

                       n!1

                       lim sn D 1 if lim sn D 1;
                       n!1          n!1

                        lim sn D 1 if fsng is not bounded below;

                       n!1

and lim sn D 1 if lim sn D 1:
                                    n!1
                       n!1

Theorem 4.1.11 Every sequence fsng of real numbers has a unique limit superior; s;
and a unique limit inferior; s, in the extended reals; and

                                    s Ä s:                                        (4.1.21)
                                    Section 4.1 Sequences of Real Numbers 189

Proof The existence and uniqueness of s and s follow from Theorem 4.1.9 and Defini-
tion 4.1.10. If s and s are both finite, then (4.1.16) and (4.1.18) imply that

                                              s <sC

for every > 0, which implies (4.1.21). If s D 1 or s D 1, then (4.1.21) is obvious. If
s D 1 or s D 1, then (4.1.21) follows immediately from Definition 4.1.10.

Example 4.1.13              8
and                         <1;           jrj > 1;
                     lim rn D 1;          jrj D 1;
                     n!1    :             jrj < 1I
                                    0;

                            8
                            ^^ 1;          r > 1;
                            ^^< 1;         r D 1;
                     lim rn D 0;           jrj < 1;
                            ^^^ 1;         r D 1;
                     n!1    ^:             r < 1:

                                      1;

Also,           lim n2 D lim n2 D 1;
and             n!1
                       n!1                          Â  1Ã
                                                1/n n  n D 1;
                     ÂÃ
                lim . 1/n 1 1 D 1;
                n!1  n                   lim .

                                        n!1

                lim OE1 C . 1/n n2 D 1; lim OE1 C . 1/n n2 D 0:
                n!1
                                        n!1

Theorem 4.1.12 If fsng is a sequence of real numbers, then

                             lim sn D s                          (4.1.22)
                                                                 (4.1.23)
                            n!1

if and only if

                     lim sn D lim sn D s:
                     n!1
                                      n!1

Proof If s D 1, the equivalence of (4.1.22) and (4.1.23) follows immediately from
their definitions. If limn!1 sn D s (finite), then Definition 4.1.1 implies that (4.1.16)-
(4.1.19) hold with s and s replaced by s. Hence, (4.1.23) follows from the uniqueness of
s and s. For the converse, suppose that s D s and let s denote their common value. Then
(4.1.16) and (4.1.18) imply that

                          s < sn < s C

for large n, and (4.1.22) follows from Definition 4.1.1 and the uniqueness of limn!1 sn
(Theorem 4.1.2).
190 Chapter 4 Infinite Sequences and Series

Cauchy's Convergence Criterion

To determine from Definition 4.1.1 whether a sequence has a limit, it is necessary to guess
what the limit is. (This is particularly difficult if the sequence diverges!) To use Theo-
rem 4.1.12 for this purpose requires finding s and s. The following convergence criterion
has neither of these defects.

Theorem 4.1.13 (Cauchy's Convergence Criterion) A sequence fsng of
real numbers converges if and only if; for every > 0; there is an integer N such that

                              jsn smj < if m; n N:              (4.1.24)

Proof Suppose that limn!1 sn D s and                > 0. By Definition 4.1.1, there is an integer
N such that                                         if r N:

                                      jsr sj < 2

Therefore,

jsn smj D j.sn s/ C .s sm/j Ä jsn sj C js smj < if n; m N:

Therefore, the stated condition is necessary for convergence of fsng. To see that it is suffi-

cient, we first observe that it implies that fsng is bounded (Exercise 4.1.27), so s and s are

finite (Theorem 4.1.9). Now suppose that > 0 and N satisfies (4.1.24). From (4.1.16)

and (4.1.17),

                                jsn sj < ;                      (4.1.25)

for some integer n > N and, from (4.1.18) and (4.1.19),

                                jsm sj <                        (4.1.26)

for some integer m > N . Since

                        js sj D j.s sn/ C .sn sm/ C .sm s/j
                                Ä js snj C jsn smj C jsm sj;

(4.1.24)-(4.1.26) imply that

                                js sj < 3 :

Since is an arbitrary positive number, this implies that s D s, so fsng converges, by
Theorem 4.1.12.

Example 4.1.14 Suppose that                         1 < x < 1:  (4.1.27)
                                 jf 0.x/j Ä r < 1;              (4.1.28)

Show that the equation          x D f .x/
has a unique solution.
                                       Section 4.1 Sequences of Real Numbers 191

Solution To see that (4.1.28) cannot have more than one solution, suppose that x D
f .x/ and x0 D f .x0/. From (4.1.27) and the mean value theorem (Theorem 2.3.11),

                                        x x0 D f 0.c/.x x0/

for some c between x and x0. This and (4.1.27) imply that

                                         jx x0j Ä r jx x0j:

Since r < 1, x D x0.
   We will now show that (4.1.28) has a solution. With x0 arbitrary, define

                            xn D f .xn 1/; n 1:                              (4.1.29)

We will show that fxng converges. From (4.1.29) and the mean value theorem,
                     xnC1 xn D f .xn/ f .xn 1/ D f 0.cn/.xn xn 1/;

where cn is between xn 1 and xn. This and (4.1.27) imply that

                            jxnC1 xnj Ä r jxn xn 1j if n 1:                  (4.1.30)

The inequality

                            jxnC1 xnj Ä r njx1 x0j if n 0;                   (4.1.31)

follows by induction from (4.1.30). Now, if n > m,

jxn xmj D j.xn xn 1/ C .xn 1 xn 2/ C C .xmC1 xm/j
             Ä jxn xn 1j C jxn 1 xn 2j C C jxmC1 xmj;

and (4.1.31) yields         xmj Ä jx1  x0j r m.1 C r C  C r n m 1/:          (4.1.32)
                       jxn

In Example 4.1.11 we saw that the sequence fskg defined by
                                        sk D 1 C r C C rk

converges to 1=.1 r / if jr j < 1; moreover, since we have assumed here that 0 < r < 1,
fskg is nondecreasing, and therefore sk < 1=.1 r / for all k. Therefore, (4.1.32) yields

                              jxn xmj < jx1 x0j r m if n > m:
                                                 1r

Now it follows that

                            jxn xmj < jx1 x0j r N if n; m > N;
                                               1r

and, since limN!1 r N D 0, fxng converges, by Theorem 4.1.13. If bx D limn!1 xn, then
(4.1.29) and the continuity of f imply that bx D f .bx/.
192 Chapter 4 Infinite Sequences and Series
                                       4.1 Exercises

1. Prove: If sn 0 for n k and limn!1 sn D s, then s 0.

2. (a) Show that limn!1 sn D s (finite) if and only if limn!1 jsn sj D 0.
     (b) Suppose that jsn sj Ä tn for large n and limn!1 tn D 0. Show that
             limn!1 sn D s.

3. Find limn!1 sn. Justify your answers from Definition 4.1.1.

(a) sn D 2 C 1                 (b) sn D  C n              (c) sn D 1 sin n
                  nC1                       Cn                        n4

4. Find limn!1 sn. Justify your answers from Definition 4.1.1.

(a) sn D           n                        n2 C 2n C 2
                   p           (b) sn D 2
          2n C n C 1
            sin n                              n Cn
(c) sn D p                                 p
          n                    (d) sn D n2 C n n

5. State necessary and sufficient conditions on a convergent sequence fsng such that
      the integer N in Definition 4.1.1 does not depend upon .

6. Prove: If limn!1 sn D s then limn!1 jsnj D jsj.

7. Suppose that limn!1 sn D s (finite) and, for each > 0, jsn tnj < for large n.
      Show that limn!1 tn D s.

8. Complete the proof of Theorem 4.1.6.

9. Use Theorem 4.1.6 to show that fsng converges.

(a) sn D  C n . > 0/                                  nS
            Cn                           (b) sn D n

                                                      n

(c) sn D  rn          .r > 0/                           .2n/S
                                         (d) sn D 2n 2
          1Cr  n
                                                      2 .nS/

10. Let y D Tan 1x be the solution of x D tan y such that =2 < y < =2. Prove:
        If x0 > 0 and xnC1 D Tan 1xn .n 0/, then fxng converges.

11. Suppose that s0 and A are positive numbers. Let
                                                 1Â AÃ

                                       snC1 D 2 sn C sn ; n 0:
                                      p
       (a) Show that snC1 A if n 0.
       (b) Show that snC1 Ä sn if n 1.

       (c) Show that s D limn!1 sn exists.

       (d) Find s.

12. Prove: If fsng is unbounded and monotonic, then either limn!1 sn D 1 or limn!1 sn D
          1.

13. Prove Theorem 4.1.7.
                                Section 4.1 Sequences of Real Numbers 193

14. Use Theorem 4.1.7 to find limn!1 sn.

(a) sn D  C n         . > 0/              (b) sn D cos 1
            Cn                                             n

(c) sn D n sin 1                          (d) sn D log n n
                  n

(e) sn D log.n C 1/ log.n 1/

15. Suppose that limn!1 sn D s (finite). Show that if c is a constant, then limn!1.csn/ D
        cs.

16. Suppose that limn!1 sn D s where s D 1. Show that if c is a nonzero constant,
        then limn!1.csn/ D cs.

17. Prove: If limn!1 sn D s and limn!1 tn D t, where s and t are finite, then

               lim .sn C tn/ D s C t and lim .sn tn/ D s t:
               n!1                         n!1

18. Prove: If limn!1 sn D s and limn!1 tn D t, where s and t are in the extended
        reals, then
                                              lim .sn C tn/ D s C t

                                                                n!1

if s C t is defined.

19. Suppose that limn!1 tn D t, where 0 < jtj < 1, and let 0 < < 1. Show that
        there is an integer N such that tn > t for n N if t > 0, or tn < t for n N if
        t < 0. In either case, jtnj > jtj if n N .

20. Prove: If          lim sn s D 0; then
                      n!1 sn C s
                                                     lim sn D s:

                                                    n!1

HINT: Define tn D .sn s/=.sn C s/ and solve for sn:

21. Prove: if limn!1 sn D s and limn!1 tn D t, where s and t are in the extended
        reals, then
                                                  lim sntn D st

                                                                       n!1

provided that st is defined in the extended reals.

22. Prove: If limn!1 sn D s and limn!1 tn D t, then

                                 lim sn D s .A/
                                n!1 tn t

if s=t is defined in the extended reals and t ¤ 0. Give an example where s=t is
defined in the extended plane, but (A) does not hold.

23. Prove Theorem 4.1.9(b).

24. Find s and s.                         (b) sn D .1 r n/ sin n
       (a) sn D OE. 1/n C 1 n2                                         2
194 Chapter 4 Infinite Sequences and Series

(c) sn D  r 2n     n .r ¤ 1/                 (d) sn D n2 n

          1Cr

(e) sn D . 1/ntn where limn!1 tn D t

25. Find s and s.                                     Â     Ã

(a) sn D . 1/n                       (b) sn D . 1/n 2 C 3
                                                         n
          n C . 1/n.2n C 1/
(c) sn D                             (d) sn D sin  n

                   n                               3

26. Suppose that limn!1 jsnj D (finite). Show that fsng diverges unless D 0 or the

terms in fsng have the same sign for large n. HINT: Use Exercise 4.1.19:

27. Prove: The sequence fsng is bounded if, for some positive , there is an integer N
        such that jsn smj < whenever n, m N .

In Exercises 4.1.28-4.1.31, assume that s, s .or s/, t , and t are in the extended reals, and
show that the given inequalities or equations hold whenever their right sides are defined
.not indeterminate/.

28. (a) lim . sn/ D s                        (b) lim . sn/ D s

                    n!1                              n!1

29. (a) lim .sn C tn/ Ä s C t                (b) lim .sn C tn/ s C t

                    n!1                              n!1

30. (a) If sn 0, tn 0, then (i) lim sntn Ä st and (ii) lim sntn st.
                                     n!1
                                                         n!1

(b) If sn Ä 0, tn 0, then (i) lim sntn Ä st and (ii) lim sntn st.
                                     n!1
                                                         n!1

31. (a) If lim sn D s > 0 and tn 0, then (i) lim sntn D st and (ii) lim sntn D st.
n!1                                          n!1
                                                                n!1

(b) If lim sn D s < 0 and tn 0, then (i) lim sntn D st and (ii) lim sntn D st.
n!1                                          n!1
                                                                      n!1

32. Suppose that fsng converges and has only finitely many distinct terms. Show that sn

is constant for large n.

33. Let s0 and s1 be arbitrary, and

                          snC1 D sn C sn 1 ; n 1:
                                         2

        Use Cauchy's convergence criterion to show that fsng converges.
34. Let tn D s1 C s2 C C sn , n 1.

                              n
       (a) Prove: If limn!1 sn D s then limn!1 tn D s.
       (b) Give an example to show that ftng may converge even though fsng does not.
                        Section 4.2 Earlier Topics Revisited with Sequences 195

35. (a) Show that

                   lim 1  Á  1    Á                     Á
                                                   1 n D 0; if  > 0:
                   n!1    1       2

HINT: Look at the logarithm of the absolute value of the product:

(b) Conclude from (a) that

                                             !

                             lim  q             D 0 if     q > 1;

                             n!1 n

where   !
       q

           is the generalized binomial coefficient of Example 2.5.3.
       n

4.2 EARLIER TOPICS REVISITED WITH SEQUENCES

In Chapter 2.3 we used -i definitions and arguments to develop the theory of limits,
continuity, and differentiability; for example, f is continuous at x0 if for each > 0 there
is a i > 0 such that jf .x/ f .x0/j < when jx x0j < i. The same theory can be
developed by methods based on sequences. Although we will not carry this out in detail,
we will develop it enough to give some examples. First, we need another definition about
sequences.

Definition 4.2.1 A sequence ftkg is a subsequence of a sequence fsng if

                                           tk D snk ; k 0;

where fnkg is an increasing infinite sequence of integers in the domain of fsng. We denote
the subsequence ftkg by fsnk g.

   Note that fsng is a subsequence of itself, as can be seen by taking nk D k. All other
subsequences of fsng are obtained by deleting terms from fsng and leaving those remaining
in their original relative order.

Example 4.2.1 If

                          1                  11 1
                   fsng D n D 1; 2 ; 3 ; : : : ; n ; : : : ;

then letting nk D 2k yields the subsequence

                          1                  11         1
                   fs2kg D 2k D 2 ; 4 ; : : : ; 2k ; : : : ;

and letting nk D 2k C 1 yields the subsequence

                          1                     1          1
       fs2kC1g D 2k C 1 D 1; 3 ; : : : ; 2k C 1 ; : : : :
196 Chapter 4 Infinite Sequences and Series

   Since a subsequence fsnk g is again a sequence (with respect to k), we may ask whether
fsnk g converges.

Example 4.2.2 The sequence fsng defined by
                                                        Â 1Ã

                                         sn D . 1/n 1 C
                                                                n

does not converge, but fsng has subsequences that do. For example,

                                     1       and lim s2k D 1;
                  fs2kg D 1 C 2k
                                                        k!1

while                      1
                  1
       fs2kC1g D                             and lim s2kC1 D 1:
                       2k C 1
                                                        k!1

It can be shown (Exercise 4.2.1) that a subsequence fsnk g of fsng converges to 1 if and
only if nk is even for k sufficiently large, or to 1 if and only if nk is odd for k sufficiently
large. Otherwise, fsnk g diverges.

   The sequence in this example has subsequences that converge to different limits. The
next theorem shows that if a sequence converges to a finite limit or diverges to 1, then
all its subsequences do also.

Theorem 4.2.2 If

                   lim sn D s . 1 Ä s Ä 1/;                                (4.2.1)
                                                                           (4.2.2)
                  n!1

then
                                               lim snk D s

                                                                  k!1

for every subsequence fsnk g of fsng:

Proof We consider the case where s is finite and leave the rest to you (Exercise 4.2.4).
If (4.2.1) holds and > 0, there is an integer N such that

                                      jsn sj < if n N:

Since fnkg is an increasing sequence, there is an integer K such that nk N if k K.
Therefore,

                                     jsnk Lj < if k K;
which implies (4.2.2).

Theorem 4.2.3 If fsng is monotonic and has a subsequence fsnk g such that

                                   lim snk D s . 1 Ä s Ä 1/;

                                                 k!1

then
                                               lim sn D s:

                                                                  n!1
                                 Section 4.2 Earlier Topics Revisited with Sequences 197

Proof We consider the case where fsng is nondecreasing and leave the rest to you (Ex-
ercise 4.2.6). Since fsnk g is also nondecreasing in this case, it suffices to show that

                                 supfsnk g D supfsng                          (4.2.3)

and then apply Theorem 4.1.6(a). Since the set of terms of fsnk g is contained in the set of

terms of fsng,

                                 supfsng supfsnk g:                           (4.2.4)

Since fsng is nondecreasing, there is for every n an integer nk such that sn Ä snk . This
implies that

                                          supfsng Ä supfsnk g:

This and (4.2.4) imply (4.2.3).

Limit Points in Terms of Sequences

In Section 1.3 we defined limit point in terms of neighborhoods: x is a limit point of a set
S if every neighborhood of x contains points of S distinct from x. The next theorem shows
that an equivalent definition can be stated in terms of sequences.

Theorem 4.2.4 A point x is a limit point of a set S if and only if there is a sequence
fxng of points in S such that xn ¤ x for n 1; and

                                               lim xn D x:

                                                                  n!1

Proof For sufficiency, suppose that the stated condition holds. Then, for each > 0,
there is an integer N such that 0 < jxn xj < if n N . Therefore, every -neighborhood
of x contains infinitely many points of S . This means that x is a limit point of S .

   For necessity, let x be a limit point of S . Then, for every integer n 1, the interval
.x 1=n; x C 1=n/ contains a point xn .¤ x/ in S . Since jxm xj Ä 1=n if m n,
limn!1 xn D x.

   We will use the next theorem to show that continuity can be defined in terms of se-
quences.

Theorem 4.2.5
(a) If fxng is bounded; then fxng has a convergent subsequence:
(b) If fxng is unbounded above; then fxng has a subsequence fxnk g such that

                                                 lim xnk D 1:

                                                                     k!1

(c) If fxng is unbounded below; then fxng has a subsequence fxnk g such that
                                                lim xnk D 1:

                                                                   k!1
198 Chapter 4 Infinite Sequences and Series

Proof We prove (a) and leave (b) and (c) to you (Exercise 4.2.7). Let S be the

set of distinct numbers that occur as terms of fxng. (For example, if fxng D f. 1/ng,

S D f1;  1g; if fxng        D  f1;  12 ; 1;  1  ;  :  :  :  ;  1  ;  1  =  n  ;  :  :  :  g  ,  S  D  f1;  1  ;  :  :  :  ;  1=n;  :  :  :  g.)  If S
                                             3                                                             2
contains only finitely many points, then some x in S occurs infinitely often in fxng; that is,

fxng has a subsequence fxnk g such that xnk D x for all k. Then limk!1 xnk D x, and we

are finished in this case.

   If S is infinite, then, since S is bounded (by assumption), the Bolzano-Weierstrass the-
orem (Theorem 1.3.8) implies that S has a limit point x. From Theorem 4.2.4, there is a
sequence of points fyj g in S , distinct from x, such that

                                                    lim yj D x:                                                                             (4.2.5)

                                                   j !1

Although each yj occurs as a term of fxng, fyj g is not necessarily a subsequence of fxng,
because if we write

                                                yj D xnj ;

there is no reason to expect that fnj g is an increasing sequence as required in Defini-
tion 4.2.1. However, it is always possible to pick a subsequence fnjk g of fnj g that is
increasing, and then the sequence fyjk g D fsnjk g is a subsequence of both fyj g and fxng.
Because of (4.2.5) and Theorem 4.2.2 this subsequence converges to x.

Continuity in Terms of Sequences

We now show that continuity can be defined and studied in terms of sequences.

Theorem 4.2.6 Let f be defined on a closed interval OEa; b containing x: Then f is
continuous at x .from the right if x D a; from the left if x D b/ if and only if

                                           lim f .xn/ D f .x/                                                                               (4.2.6)

                                                            n!1

whenever fxng is a sequence of points in OEa; b such that

                                                    lim xn D x:                                                                             (4.2.7)

                                                   n!1

Proof Assume that a < x < b; only minor changes in the proof are needed if x D a or
x D b. First, suppose that f is continuous at x and fxng is a sequence of points in OEa; b
satisfying (4.2.7). If > 0, there is a i > 0 such that

                               jf .x/ f .x/j < if jx xj < i:                                                                                (4.2.8)

From (4.2.7), there is an integer N such that jxn xj < i if n N . This and (4.2.8)
imply that jf .xn/ f .x/j < if n N . This implies (4.2.6), which shows that the stated
condition is necessary.

   For sufficiency, suppose that f is discontinuous at x. Then there is an 0 > 0 such that,
for each positive integer n, there is a point xn that satisfies the inequality

                                                             1
                                              jxn xj < n
                           Section 4.2 Earlier Topics Revisited with Sequences 199

while

                                   jf .xn/ f .x/j 0:

The sequence fxng therefore satisfies (4.2.7), but not (4.2.6). Hence, the stated condition
cannot hold if f is discontinuous at x. This proves sufficiency.

   Armed with the theorems we have proved so far in this section, we could develop the
theory of continuous functions by means of definitions and proofs based on sequences and
subsequences. We give one example, a new proof of Theorem 2.2.8, and leave others for
exercises.

Theorem 4.2.7 If f is continuous on a closed interval OEa; b; then f is bounded on
OEa; b:

Proof The proof is by contradiction. If f is not bounded on OEa; b, there is for each
positive integer n a point xn in OEa; b such that jf .xn/j > n. This implies that

                                    lim jf .xn/j D 1:                                 (4.2.9)

                                   n!1

Since fxng is bounded, fxng has a convergent subsequence fxnk g (Theorem 4.2.5(a)). If

                                   x D lim xnk ;

                                           k!1

then x is a limit point of OEa; b, so x 2 OEa; b. If f is continuous on OEa; b, then

                                    lim f .xnk / D f .x/

                                   k!1

by Theorem 4.2.6, so                                               cannot be both continuous and
                                         lim jf .xnk /j D jf .x/j

                                                         k!1

(Exercise 4.1.6), which contradicts (4.2.9). Therefore, f
unbounded on OEa; b

                                   4.2 Exercises

1. Let sn D . 1/n.1 C 1=n/. Show that limk!1 snk D 1 if and only if nk is even for
      large k, limk!1 snk D 1 if and only if nk is odd for large k, and fsnk g diverges
      otherwise.

2. Find all numbers L in the extended reals that are limits of some subsequence of fsng

       and, for each such L, choose a subsequence fsnk g such that limk!1 snk D L.
                                                                   Â 1Ã n
       (a) sn D . 1/nn             (b) sn D 1 C cos
       Â                Ã                                               n     2

       (c) sn D 1  1       n       (d) sn D 1
                    2 sin
                   n            2                                  nÁ

       (e) sn D OE. 1/n C 1 n2     (f ) sn D n C 1 sin n C cos n                      4
                                                                   nC2     4
200 Chapter 4 Infinite Sequences and Series

3. Construct a sequence fsng with the following property, or show that none exists: for
      each positive integer m, fsng has a subsequence converging to m.

4. Complete the proof of Theorem 4.2.2.
5. Prove: If limn!1 sn D s and fsng has a subsequence fsnk g such that . 1/k snk 0,

      then s D 0.

6. Complete the proof of Theorem 4.2.3.

7. Prove Theorem 4.2.5(b) and (c).

8. Suppose that fsng is bounded and all convergent subsequences of fsng converge to
      the same limit. Show that fsng is convergent. Give an example showing that the
      conclusion need not hold if fsng is unbounded.

9. (a) Let f be defined on a deleted neighborhood N of x. Show that

         lim f .x/ D L

         x!x

      if and only if limn!1 f .xn/ D L whenever fxng is a sequence of points in N
      such that limn!1 xn D x. HINT: See the proof of Theorem 4.2.6:
(b) State a result like (a) for one-sided limits.

10. Give a proof based on sequences for Theorem 2.2.9. HINT: Use Theorems 4.1.6;
        4.2.2; 4.2.5; and 4.2.6:

11. Give a proof based on sequences for Theorem 2.2.12.

12. Suppose that f is defined on a deleted neighborhood N of x and ff .xn/g ap-
        proaches a limit whenever fxng is a sequence of points in N and limn!1 xn D
        x. Show that if fxng and fyng are two such sequences, then limn!1 f .xn/ D
        limn!1 f .yn/. Infer from this and Exercise 4.2.9 that limx!x f .x/ exists.

13. Prove: If f is defined on a neighborhood N of x, then f is differentiable at x if and

only if

          lim f .xn/                         f .x/
         n!1 xn                              x

exists whenever fxng is a sequence of points in N such that xn ¤ x and limn!1 xn D
x. HINT: Use Exercise 4.2.12:

4.3 INFINITE SERIES OF CONSTANTS

The theory of sequences developed in the last two sections can be combined with the fa-
miliar notion of a finite sum to produce the theory of infinite series. We begin the study of
infinite series in this section.

Definition 4.3.1 If fang1 k is an infinite sequence of real numbers, the symbol
                                                  X 1
                                                       an

                                                                        nDk
                                          Section 4.3 Infinite Series of Constants 201

is an infinite series, and an is the nth term of the series. We say that nDk P1 an converges to

the sum A, and write                X 1
                                        an D A;

                                    nDk

if the sequence fAng1 k defined by

                              An D ak C akC1 C C an; n k;
converges toPA. The finite sum An is the nth partial sum of nDk P1 an. If fAngk1 diverges,
P we say that nDk 1 an diverges; in particular, if limn!1 An D 1 or 1, we say that

    1

   nDk an diverges to 1 or 1, and write

                         X 1  an D 1 or   X 1    an D 1:

                         nDk              nDk

A divergent infinite series that does not diverge to 1 is said to oscillate, or be oscillatory.

We will usually refer to infinite series more briefly as series.

Example 4.3.1 Consider the series

                              X 1         1 < r < 1:
                                   rn;

                              nD0

Here an D r n .n 0/ and

                      An D 1 C r C r 2 C  C r n D 1 r ; nC1                        (4.3.1)
                                                       1r

which converges to 1=.1 r / as n ! 1 (Example 4.1.11); thus, we write

                         X 1 r n D 1 ;    1 < r < 1:
                         nD0 1 r

If jr j > 1, then (4.3.1) is still valid, but nD0 P1 r n diverges; if r > 1, then

                                    X 1                                            (4.3.2)
                                        r n D 1;

                                    nD0

while if r < 1, nD0 P1 r n oscillates, since its partial sums alternate in sign and their
magnitudes become arbitrarily large for large n. If r D 1, then A2mC1 D 0 and A2m D 1

for m 0, while if r D 1, An D n C 1; in both cases the series diverges, and (4.3.2) holds

if r D 1.
202 Chapter 4 Infinite Sequences and Series

   The series nD0 P1 r n is called the geometric series with ratio r . It occurs in many appli-
cations.

     An infinite series can be viewed as a generalization of a finite sum

                                     X N                               C aN
                               A D an D ak C akC1 C

                                        nDk

by thinking of the finite sequence fak; akC1; : : : ; aN g as being ePxtended to an infinite se-
quence fang1 k with an D 0 for n > N . Then the partial sums of nDk 1 an are

                          An D ak C akC1 C C an; k Ä n < N;

and                                                                    k. Therefore, limn!1 An
                                          An D A; n N I

that is, the terms of fAng1 k equal the finite sum A for n
D A.

   The next two theorems can be proved by applying Theorems 4.1.2 and 4.1.8 to the partial
sums of the series in question (Exercises 4.3.1 and 4.3.2).

Theorem 4.3.2 The sum of a convergent series is unique:

Theorem 4.3.3 Let

                               X 1      an D A and            X 1  bn D B;

                               nDk                      nDk

where A and B are finite: Then                 X 1
                                                   .can/ D cA

if c is a constant;                            nDk

                                        X 1
                                            .an C bn/ D A C B;

                                        nDk

and
                                        X 1
                                            .an bn/ D A B:

                                                         nDk

These relations also hold if one or both of A and B is infinite, provided that the right sides
are not indeterminate:

     Dropping finitely many terms from a series does not alter convergence or divergence,

although it does change the sum of a convergent series if the terms dPropped have a nonzero
sum. For examPple, suppose that we drop the first k terms of a series nD0 1 an, and consider
the new series       1    an.  Denote   the    partial  sums  of  the  two  series  by
                     nDk

                               An D a0 C a1 C C an; n 0;

and

                                  0  D  ak  C  akC1  C  C an; n k:

                               An
                                                        Section 4.3 Infinite Series of Constants 203

Since

                         An D .a0 C a1 C           C ak       1/  C     0  ;      n    k;

                                                                     An

it  follows  that  A  D  limn!1  An   exists  (in  the  extended  reals)      if  and  only  if  A0  D  limn!1  A0

                                                                                                                   n

does, and in this case

                             A D .a0 C a1 C C ak 1/ C A0:

An important principle follows from this.

Lemma 4P.3.4 Suppose that for n sufficiently large .that is; for n some integer N /
the teP rms of     1     an  satisfy  some  condition   that  implies  convergence         of    an  infiniPte series:
                   nDk
Then nDk 1 an converges: Similarly, suppose that for n sufficiently largePthe terms nDk 1 an
satisfy some condition that implies divergence of an infinite series: Then nDk 1 an diverges:

Example 4.3.2 Consider the alternating series test, which we will establish later as a
special case of a more general test:

   The series k P1 an converges if . 1/nan > 0; janC1j < janj; and limn!1 an D 0:

    The terms of                            X 1 16 C . 2/n
                                            nD1 n2n

do not satisfy these conditions for all n 1, but they do satisfy them for sufficiently large
n. Hence, the series converges, by Lemma 4.3.4.

   We will soon give several conditions concerning convergence of a series nDk P1 an with
nonnegative terms. According to Lemma 4.3.4, these results apply to series that have at

most finitely many negative terms, as long as an is nonnegative and satisfies the conditions

for n sufficiently large.
                                                     P1

   When we are interested oPnly in whether nDkPan converges or diverges and not in its
sum, we will simply say " an converges" or "P an diverges."PLemma 4.3.4 justifies
this convention, subject to the understanding that an stands for nDk 1 an, where k is an
integer such that an is defined for n k. (For example,

                             X1               stands for          X 1 1
                                  .n 6/2                               .n 6/2 ;

                                                                  nDk

                             P                          P
where k         7.) We write an D 1 . 1/ if an diverges to 1 .                               1/. Finally, let us
agree that

                                      X 1                X 1
                                           an and               anCj

                                      nDk               nDk j

(where we obtain the second expression by shifting the index in the first) both represent the
same series.
204 Chapter 4 Infinite Sequences and Series

Cauchy's Convergence Criterion for Series

The Cauchy convergence criterion for sequences (Theorem 4.1.13) yields a useful criterion
for convergence of series.

TPheorem 4.3.5 (Cauchy's Convergence Criterion for Series) A series
   an converges if and only if for every > 0 there is an integer N such that

                         jan C anC1 C C amj < if m n N:                           (4.3.3)
Proof In terms of the partial sums fAng of P an,

an C anC1 C C am D Am An 1:

Therefore, (4.3.3) can be written as

                                jAm An 1j < if m n N:
       P
Since an converges if and only if fAng converges, Theorem 4.1.13 implies the conclu-
sion. P
   Intuitively, Theorem 4.3.5 means that an converges if and only if arbitrarily long sums

                           an C anC1 C C am; m n;

can be made as small as we please by picking n large enough.

Example 4.3.3 Consider the geometricPseries P rn of Example 4.3.1. If jrj 1, then
fr ng does not converge to zero. Therefore r n diverges, as we saw in Example 4.3.1. If
jr j < 1 and m n, then

jAm Anj D jr nC1 C r nC2 C C r mj                                                 (4.3.4)
              Ä jr jnC1.1 C jr j C C jr jm n 1/
              D jr jnC1 1 jr jm n < jr jnC1 :
                            1 jrj 1 jrj

If > 0, choose N so that              jr jN C1
Then (4.3.4) implies that                      <:

                                      1 jrj

                                 jAm Anj < if m n N:
Now Theorem 4.3.5 implies that P r n converges if jr j < 1, as in Example 4.3.1.

   Letting m D n in (4.3.3) yields the following important corollary of Theorem 4.3.5.
Corollary 4.3.6 If P an converges; then limn!1 an D 0:
                                            Section 4.3 Infinite Series of Constants 205

   It muPst be emphasized that Corollary 4.3.6 gives a necessary condition for convergPence;
that is, an cannot converge unless limn!1 an D 0. The condition is not sufficient; an
may diverge even if limn!1 an D 0. We will see examples below.

   We leave the proof of the following corollary of Theorem 4.3.5 to you (Exercise 4.3.5).

Corollary 4.3.7 If P an converges; then for each > 0 there is an integer K such

that                 X 1               

                      an < if k KI     

                       nDk             

that is;                                     X 1
                                        lim an D 0:

                                       k!1
                                                nDk

Example        4.3.4 If jrj < 1, then

                                                          
               X 1   X 1                      X 1           jr jk
                     n  k                n  k  k       n          :
                r  D r r                     D r       r D
                                                            1r
               nDk         nDk                    nD0

Therefore, if                          jr jK
                                              <;

                                       1r

then                 X 1               

                      n
                      r <                   if k K;
                                       
                       nDk
which implies that limk!1 nDk P1 r n D 0.

Series of Nonnegative Terms
                        P

The theory of series an with terms that are nonnegative for sufficiently large n is simpler
than the general theory, since such a series either converges to a finite limit or diverges to
1, as the next theorem shows.

Theorem 4.3.8 If an  0 for n                          P
                                            k; then an converges if its partial sums are

bounded; or diverges to 1 if they are not: These are the only possibilities and; in either

case;                X 1

                                            °          «
                           an D sup An  n k ;

                     nDk

where

                    An D ak C akC1 C C an; n k:
206 Chapter 4 Infinite Sequences and Series

Proof Since An D An 1Can and an 0 .n k/, the sequence fAng is nondecreasing,
so the conclusion follows from Theorem 4.1.6(a) and Definition 4.3.1.

                                             P             P
If an 0 for sufficiently large n, we will write an < 1 if an converges. TPhis con-
vention is based on Theorem 4.3.8, which says that such a series diverges only if an D

1. The convention does not apply to series with infinitely many negativePterms, because
such series may diverge without diverging to 1; for example, the series nD0 1 . 1/n os-

cillates, since its partial sums are alternately 1 and 0.

Theorem 4.3.9 (The Comparison Test) Suppose that              (4.3.5)
                                        0 Ä an Ä bn; n k:

Then P P
(a) an < 1 if bn < 1:
(b) P bn D 1 if P an D 1:

Proof (a) If

An D ak C akC1 C C an and Bn D bk C bkC1 C C bn; n k;

then, from (4.3.5),

                     An Ä Bn:                                 (4.3.6)

                                     P
Now we use Theorem 4.3.8. IPf bn < 1, then fBng is boundedPabove and (4.3.6) implies
that fAng is also; therefore, an < 1. On the other hand, if Pan D 1, then fAng is
unbounded above and (4.3.6) implies that fBng is also; therefore, bn D 1.

We leave it to you to show that (a) implies (b).

Example 4.3.5 Since  r < r n n; n 1;

Pn                   n
                        Pn
and r < 1 if 0 < r < 1, the series r =n converges if 0 < r < 1, by the comparison

test. Comparing that the terms of Pthese two series is inconclusive if r > 1, since it doe r n=n are smaller than those of the divergent series Ps not help to know r n. If r < 0, the

comparison test does not apply, since the series then have infinitely many negative terms.

Example 4.3.6 Since  rn < nrn

and P r n D 1 if r 1, the comparison test implies that P nr n D 1 if r 1. Compar-

ing these terms of Ptwo series is inconclusive if 0 < r < 1, since it do nr n are larger than those of the convergent series Pes not help to know that the r n.
                                         Section 4.3 Infinite Series of Constants 207

   The comparison test is useful if we have a collection of series with nonnegative terms
and known convergence properties. We will now use the comparison test to build such a
collection.

Theorem 4.3.10 (The Integral Test) Let                                        (4.3.7)
                                                                              (4.3.8)
                                         cn D f .n/; n k;

where f is positive; nonincreasing; and locally integrable on OEk; 1/: Then
                                               X
                                                    cn < 1

if and only if                    Z1

                                        f .x/ dx < 1:                         (4.3.9)

                                    k

Proof  We first observe that (4.3.9) holds if and only if

                                  X 1 Z nC1                                   (4.3.10)
                                               f .x/ dx < 1

                                              nDk n

(Exercise 4.3.9), so it is enough to show that (4.3.8) holds if and only if (4.3.10) does. From
(4.3.7) and the assumption that f is nonincreasing,

       cnC1 D f .n C 1/ Ä f .x/ Ä f .n/ D cn; n Ä x Ä n C 1; n k:

Therefore,

                Z nC1             Z nC1              Z nC1

       cnC1 D          cnC1 dx Ä         f .x/ dx Ä          cn dx D cn; n k

                n                 n                  n

(Theorem 3.3.4). From the first inequality and Theorem 4.3.9(a) with an D cnC1 and
R nC1                                    P
bn D n f .x/ dx, (4.3.10) implies that cnC1 < 1, which is equivalent to (4.3.8).
                                                                           R nC1
From the second inequality and Theorem 4.3.9(a) with an D n f .x/ dx and bn D cn,

(4.3.8) implies (4.3.10).

Example 4.3.7 The integral test implies that the series

                X1 X 1                      X                1
                   np ; n.log n/p ; and n log n OElog.log n/p

converge if p > 1 and diverge if 0 < p Ä 1, because the same is true of the integrals

                Z 1 dx Z 1 dx               Z 1 dx
                a xp ; a x.log x/p ; and a x log x OElog.log x/p

if a is sufficiently large. (See Example 3.4.3 and Exercise 3.4.10.) The three series di-
verge iPf p Ä 0: the first by Corollary 4.3.6, the second by comparisoPn with the divergent
series 1=n, and the third by comparison with the divergent series 1=.n log n/. (The
208 Chapter 4 Infinite Sequences and Series

divergence of the last two series for p Ä 0 also follows from the integral test, but the
divergence of the first does not. Why not?) These results can be generalized: If

                      L0.x/ D x and Lk .x/ D logOELk 1.x/; k 1;

then X 1
                                    L0.n/L1 .n/ Lk.n/OELkC1 .n/p

converges if and only if p > 1 (Exercise 4.3.11).

   This example provides an infinite family of series with known convergence properties
that can be used as standards for the comparison test.

   Except for the series of Example 4.3.7, the integral test is of limited practical value,
since convergence or divergence of most of the series to which it can be applied can be
determined by simpler tests that do not require integration. However, the method used to
prove the integral test is often useful for estimating the rate of convergence or divergence
of a series. This idea is developed in Exercises 4.3.13 and 4.3.14.

Example 4.3.8 The series        X 1 1

                                                   .n2 C n/q                   (4.3.11)
converges if q > 1=2, by comparison with the convergent series P 1=n2q, since

                             1               1
                          .n2 C n/q < n2q ; n 1:

This comparison is inconclusive if q Ä 1=2, since then

                                X1
                                     n2q D 1;

and it does not help to know that the terms of (4.3.11) are smaller than those of a divergent

series. However, we can use the comparison test here, after a little trickery. We observe

that  X 1                          X 1 1

                          1
             .n C 1/2q D n2q D 1; q Ä 1=2;
      nDk 1                        nDk

and                             1               1

                          .n C 1/2q < .n2 C n/q :

Therefore, the comparison test implies that

             X1                                    q Ä 1=2:
                  .n2 C n/q D 1;
                                       Section 4.3 Infinite Series of Constants 209

   The next theorem is often applicable where the integral test is not. It does not require the
kind of trickery that we used in Example 4.3.8.

Theorem 4.3.11 Suppose that an           0 and bn > 0 for n k: Then
      X            X
(a) an < 1 if               bn < 1     and lim an=bn < 1:

      X            X                              n!1
(b) an D 1 if               bn D 1
                                       and lim an=bn > 0:

                                                   n!1

Proof (a) If limn!1 an=bn < 1, then fan=bng is bounded, so there is a constant M

and an integer k such that

                            an Ä M bn; n k:

      P                                   P             P
Since bn < 1, Theorem 4.3.3 implies that .M bn/ < 1. Now an < 1, by the

comparison test.

(b) If limn!1 an=bn > 0, there is a constant m and an integer k such that

                            an mbn; n k:

      P                                   P             P
Since bn D 1, Theorem 4.3.3 implies that .mbn/ D 1. Now an D 1, by the

comparison test.

Example 4.3.9 Let

         X        X1                   X          X 2 C sin n =6
                  bn D npCq and           an D .n C 1/p.n 1/q :

Then                        an D       2 C sin n =6
                                             p q;
                            bn .1 C 1=n/ .1 1=n/

so an an
                            lim D 3 and lim D 1:
                            n!1 bn        n!1 bn
      P                                              P
Since bn < 1 if and only if p C q > 1, the same is true of an, by Theorem 4.3.11.

   The following corollary of Theorem 4.3.11 is often useful, although it does not apply to
the series of Example 4.3.9.

Corollary 4.3.12 Suppose that an 0 and bn > 0 for n k; and

                                     lim an D L;
                                    n!1 bn

                   P                P
where 0 < L < 1: Then an and bn converge or diverge together:
210 Chapter 4 Infinite Sequences and Series

Example 4.3.10 With this corollary we can avoid the kind of trickery used in the
second part of Example 4.3.8, since

     lim                       1          1    D lim          1     D 1;
                                                        .1 C 1=n/q
    n!1         .n2            C  n/q     n2q      n!1
                                                        X1
so X 1                                           and         n2q

                                  .n2 C n/q

converge or diverge together.

The Ratio Test

It is sometimes possible to determine whether a series with positive terms converges by
comparing the ratios of successive terms with the corresponding ratios of a series known to
converge or diverge.

Theorem 4.3.13 Suppose that an > 0; bn > 0; and

                                       anC1 Ä bnC1 :                      (4.3.12)
                                          an   bn

Then P P
(a) an < 1 if bn < 1:
(b) P bn D 1 if P an D 1:

Proof Rewriting (4.3.12) as               anC1 Ä an ;
                                          bnC1 bn

we see that fan=bng is nonincreasing. Therefore, limn!1 an=bn < 1, and Theorem 4.3.11(a)
implies (a). P

  To prove (b), suppose that an D 1. SincePfan=bng is noninPcreasing, there is a
number such that bn an for large n. Since P. an/ D 1 if an D 1, Theo-
rem 4.3.9(b) (with an replaced by an) implies that bn D 1.

   We will use this theorem to obtain two other widely applicable tests: the ratio test and
Raabe's test.

Theorem 4.3.14 (The Ratio Test) Suppose that an > 0 for n                 k: Then
                                                                                 (4.3.13)
(a) P an < 1 if limn!1 anC1=an < 1:
(b) P an D 1 if limn!1 anC1=an > 1:

If                             lim anC1 Ä 1 Ä lim anC1 ;

                               n!1 an          n!1 an
                                       P
then the test is inconclusiveI that is; an may converge or diverge:
                                             Section 4.3 Infinite Series of Constants 211

Proof (a) If                         lim anC1 < 1;
                                    n!1 an

there is a number r such that 0 < r < 1 and

                                         anC1 < r
                                          an

for n sufficiently large. This can be rewritten as

                                    anC1 < r nC1 :  r

                                                        n
                                    an

Since P r n < 1, Theorem 4.3.13(a) with bn D r n implies that P an < 1.

(b) If                               lim anC1 > 1;
                                    n!1 an

there is a number r such that r > 1 and

                                         anC1 > r
                                          an

for n sufficiently large. This can be rewritten as

                                    anC1 > r nC1 :
                                    an              rn

Since P r n D 1, Theorem 4.3.13(b) with an D r n implies that P bn D 1.

To see that no conclusion can be drawn if (4.3.13) holds, consider

                                    X        X1
                                         an D np :

This series converges if p > 1 or diverges if p Ä 1; however,

                              lim anC1 D lim anC1 D 1
                              n!1 an         n!1 an

for every p.

 Example 4.3.11 If            X an D X 2 C sin n r Á n;
then                                                       2

                              anC1       2 C sin .n C 1/
                                                        2
                                    Dr                  n
                              an
                                         2 C sin
                                                        2

which assumes the values 3r=2, 2r=3, r=2, and 2r , each infinitely many times; hence,

              lim anC1 D 2r and                            lim anC1 D r :
              n!1 an                                    n!1 an  2

              P
Therefore, an converges if 0 < r < 1=2 and diverges if r > 2. The ratio test is

inconclusive if 1=2 Ä r Ä 2.
212 Chapter 4 Infinite Sequences and Series

The following corollary of the ratio test is the familiar ratio rest from calculus.

Corollary 4.3.15 Suppose that an > 0 .n k/ and

                                     lim anC1 D L:
                                    n!1 an

   Then
       P

(a) an < 1 if L < 1:
(b) P an D 1 if L > 1:

The test is inconclusive if L D 1:

Example 4.3.12 The series P an D P nr n 1 converges if 0 < r < 1 or diverges if

r > 1, since             anC1 .n C 1/r n Â 1 Ã
                          an D nr n 1 D 1 C n r;

so anC1                                      D r:
                                    lim
                                    n!1 an

Corollary 4.3.15 is inconclusive if r D 1, but then Corollary 4.3.6 implies that the series
diverges.

                                        P
The ratio test does not imply that an < 1 if merely

                                    anC1 < 1                                         (4.3.14)
                                     an

for large n, since this could occur with limn!1 anCP1=an D 1, in which case the test is
inconclusive. However, the next theorem shows that an < 1 if (4.3.14) is replaced by
the stronger condition that

                                             anC1 Ä 1 p
                                               an P n

for some p > 1 and large n. It also shows that an D 1 if

                                    anC1          q
                                     an      1

                                                  n

for some q < 1 and large n.

Theorem 4.3.16 (Raabe's Test) Suppose that an > 0 for large n: Let

                         Â anC1 Ã                         Â anC1 Ã
              M D lim n             1 and m D lim n           1:
              n!1            an                           an
                                                     n!1

Then P                           1 Ä M:
(a) an < 1 if M < 1:
(b) P an D 1 if m > 1:
The test is inconclusive if m Ä
                                            Section 4.3 Infinite Series of Constants 213

Proof (a) We need the inequality

                      1                                                     (4.3.15)
                  .1 C x/p > 1 px; x > 0; p > 0:

This follows from Taylor's theorem (Theorem 2.5.4), which implies that

                      1                   px C 2 .1 C c/pC2 1 p.p C 1/ x2;
                  .1 C x/p D 1

where 0 < c < x. (Verify.) Since the last term is positive if p > 0, this implies (4.3.15).

Now suppose that M <  p < 1. Then there is an integer k such that

                      n           Â anC1 Ã
                                          1 < p; n k;
                                      an

so                                anC1 < 1 p ; n k:
Hence,                            an        n

                      anC1 a < n .1 C 1=n/p 1 ; n k;

as can be seen by letting x D 1=n in (4.3.15). From this,

                                 anC1 a < n .n C 1/p np 1 1 ; n k:
Since P 1=np < 1 if p > 1, Theorem 4.3.13(a) implies that P an < 1.

  (b) Here we need the inequality

                  .1 x/q < 1 qx; 0 < x < 1; 0 < q < 1:                      (4.3.16)

This also follows from Taylor's theorem, which implies that

                  .1 x/q D 1 qx C q.q 1/.1 c/q 2 x2 ;
                                                                      2

where 0 < c < x.

Now suppose that 1 < q < m. Then there is an integer k such that

                      n           Â anC1 Ã
                                          1 > q; n k;
                                      an

so anC1 q
                                                  1 ; n k:

                 P an n
If q Ä 0, then an D 1, by Corollary 4.3.6. Hence, we may assume that 0 < q < 1, so

the last inequality implies that

                                  anC1 Â 1 Ãq  ; n k;
                                      >1
                                  an        n
214 Chapter 4 Infinite Sequences and Series

as can be seen by setting x D 1=n in (4.3.16). Hence,

                              anC1 1         1
                                     >q          q ; n k:
                              an n .n 1/
Since P 1=nq D 1 if q < 1, Theorem 4.3.13(b) implies that P an D 1.

Example 4.3.13 If

         X                    X              nS
              an D                                                       ;  > 0;
                                 . C 1/. C 2/ . C n 1/

then                          lim anC1 D lim n C 1 D 1;

                              n!1 an         n!1  C n

so the ratio test is inconclusive. However,         ÂnC1 Ã
                              Â anC1 Ã
                 lim n               1 D lim n                    1
                 n!1             an          n!1  C n

                                             D lim  n.1 /     D 1 ;

                                             n!1  C n
                              P                          P
so Raabe's test implies that an < 1 if  > 2 and an D 1 if 0 <  < 2. Raabe's

test is inconclusive if  D 2, but then the series becomes

                                 X nS            X1
                                     .n C 1/S D            ;
                                                    nC1

which we know is divergent.
Example 4.3.14 Consider the series P an, where

              a2m D . C 1/                   .mS/2            . C m/
                                      . C m/. C 1/

and

         a2mC1 D . C 1/                   .mS/2.m C 1/                        ;
                                      . C m/. C 1/            . C m C 1/

with 0 <  < . Since            Ã Â mC1                    Ã             2m
                     Â a2mC1  1 D 2m  C m C 1            1D          CmC1

                2m
                         a2m

and Â Ã Â Ã
      .2m C 1/ a2mC2 1 D .2m C 1/ m C 1 1 D .2m C 1/ ;
              a2mC1                              CmC1                   CmC1

we have       Â                  Ã                         Â         Ã

         lim n anC1 1 D 2 and lim n anC1 1 D 2:
         n!1     an                                           an
                     P                              n!1P

Raabe's test implies that an < 1 if  > 1=2 and an D 1 if  < 1=2. The test is

inconclusive if 0 <  Ä 1=2 Ä .
                                            Section 4.3 Infinite Series of Constants 215

   The next theorem, which will be useful when we study power series (Section 4.5), con-
cludes our discussion of series with nonnegative terms.

Theorem 4.3.17 (Cauchy's Root Test) If an                                      0 for n  k; then
      P
                                1= n
(a) an < 1 if limn!1 an < 1:
      P
                                1= n
(b) an D 1 if limn!1 an > 1:

                                                              1= n

The test is inconclusive if limn!1 an D 1:

Proof (a) If limn!1 an1=n < 1, there is aPn r such that 0 < r < 1 and an1=n < r for
P large n. Therefore, an < r n for large n. Since r n < 1, the comparison test implies that
an < 1.
                                                                                            P
                     1= n             1= n
(b) If limn!1 an > 1, then an > 1 for infinitely many values of n, so an D 1,

by Corollary 4.3.6.

Example 4.3.15 Cauchy's root test is inconclusive if

                                      X                             X1
                                            an D np ;

because then

                     1=n Â 1 Ã1=n                                              pÁ
              lim an D lim p                                        D lim exp  n log n D 1
              n!1          n!1 n                                    n!1

P for all p. However, we know from the integral test that P 1=np < 1 if p > 1 and
   1=np D 1 if p Ä 1.

Example 4.3.16 If

                           X an D X 2 C sin n r Án n;
                                                        4

then                                                                    nÁ

                           lim an1=n D lim 2 C sin                       4     r D 3r;
                           n!1        n!1
      P                               P
and so an < 1 if r < 1=3 and an DP1 if r > 1=3. The test is inconclusive if
r D 1=3, but then ja8mC2j D 1 for m 0, so an D 1, by Corollary 4.3.6.

Absolute and Conditional Convergence
                                                          P

We noPw drop the assumption that the terms of an are nonnegative for large n. In this
case, an may converge in two quite different ways. The first is defined as follows.

                                      P
P Definition 4.3.18 A series an converges absolutely, or is absolutely convergent; if

   janj < 1:
216 Chapter 4 Infinite Sequences and Series

                                                   P
ExampleP4.3.17 P A convergent series an of nonnegative terms is absolutely conver-
gent, since an and janj are the same. More generally, any convergent series whose
terms are of the same sign for sufficiently large n converges absolutely (Exercise 4.3.22).

Example 4.3.18 Consider the series                                         (4.3.17)
                                                X sin nÂ
                                                       np ;

where Â is arbitrary and p > 1. Since

                                      sin nÂ   np  1  Ä np

and P 1=np < 1 if p > 1, the comparison test implies that

                      X  sin nÂ               

                                     n  p       <  1;        p > 1:
                                              

Therefore, (4.3.17) converges absolutely if p > 1.

Example 4.3.19 If 0 < p < 1, then the series

                                          X . 1/n
                                                 np

does not converge absolutely, since

                                       1  /n  D    X1
                      X.                                     p D 1:

                       p             n                 n

However, the series converges, by the alternating series test, which we prove below.

   Any test fPor convergence of a series with nonnegative termPs can be used to test an arbi-
trary series an for absolute convergence by applying it to janj. We used the compar-
ison test this way in Examples 4.3.18 and 4.3.19.

Example 4.3.20 To test the series
                     X an D X. 1/n nS ;  > 0;
                                             . C 1/ . C n 1/

for absolute convergence, we apply Raabe's test to

                   X        X                          nS
                      an D                                              :
                                          . C 1/ . C n 1/

                   P                                   P                              P
From Example 4.3.13, janj < 1 if  > 2 and janj D 1 if  < 2. Therefore, P an
converges absolutely if  > 2, but not if  < 2. Notice that this does not imply that an

diverges if  < 2.
                                     Section 4.3 Infinite Series of Constants 217

   The proof of the next theorem is analogous to the proof of Theorem 3.4.9. We leave it to
you (Exercise 4.3.24).

Theorem 4.3.19 If P an converges absolutely; then P an converges:

   For example, Theorem 4.3.19 implies that
                                                X sin nÂ
                                                       np

converges if p > 1, since it then converges absolutely (Example 4.3.18).

   The converse of Theorem 4.3.19 is false; a series may converge without converging abso-
lutely thus, P. We say then that the series converges conditionally, or is conditionally convergent; . 1/n=np converges conditionally if 0 < p Ä 1.

Dirichlet's Test for Series

Except for Theorem 4.3.5 and Corollary 4.3.6, the convergence tests we have studied so

far apply only to series whose terms have the same sign for large n. The following theo-

rem does not require this. It is analogous to Dirichlet's test for improper integrals (Theo-

rem 3.4.10).

Theorem 4.3.20 (Dirichlet's Test for Series) The series nDk P1 anbn con-

verges if limn!1 an D 0;  X
                              janC1
                                     anj < 1;                                      (4.3.18)

and                   jbk C bkC1 C  C bnj Ä M; n k;                                (4.3.19)
for some constant M:

Proof The proof is similar to the proof of Dirichlet's test for integrals. Define

                               Bn D bk C bkC1 C C bn; n k
and consider the partial sums of nDk P1 anbn:

                 Sn D ak bk C akC1bkC1 C C anbn; n k:                              (4.3.20)

By substituting

                        bk D Bk and bn D Bn Bn 1; n k C 1;
into (4.3.20), we obtain

                  Sn D ak Bk C akC1.BkC1 Bk/ C C an.Bn Bn 1/;                      (4.3.21)

which we rewrite as

                       Sn D .ak akC1/Bk C .akC1 akC2/BkC1 C
                              C .an 1 an/Bn 1 C anBn:
218 Chapter 4 Infinite Sequences and Series

(The procedure that led from (4.3.20) to (4.3.21) is called summation by parts. It is analo-
gous to integration by parts.) Now (4.3.21) can be viewed as

                                Sn D Tn 1 C anBn;                      (4.3.22)

where

       Tn 1 D .ak akC1/Bk C .akC1 akC2/BkC1 C C .an 1 an/Bn 1I

that is, fTng is the sequence of partial sums of the series

                                X 1        aj C1/Bj :                  (4.3.23)
                                    .aj

                                j Dk

Since

                         j.aj aj C1/Bj j Ä M jaj aj C1j

from (4.3.19), the comparison test and (4.3.18) imply that the series (4.3.23) converges
absolutely. Theorem 4.3.19 now implies that fTng converges. Let T D limn!1 Tn. Since
fBng is bounded and limn!1 an D 0, we infer from (4.3.22) that

              lim Sn D lim Tn 1 C lim anBn D T C 0 D T:
              n!1           n!1            n!1

             P
Therefore, anbn converges.

Example 4.3.21 To apply Dirichlet's test to

              X 1 sin nÂ                 Â ¤k   (k D integer);
                   n C . 1/n ;

              nD2

we take                         1
                   an D n C . 1/n
                                           and bn D sin nÂ:

Then limn!1 an D 0, and                        3
                                   anj < n.n 1/
                            janC1

(verify), so                    X
                                    janC1
                                             anj < 1:

Now
                               Bn D sin 2Â C sin 3Â C C sin nÂ:

To show that fBng is bounded, we use the trigonometric identity

                         cos r   12 Â cos r C 12 Â ;         Â ¤ 2k ;
              sin r Â D          2 sin.Â=2/
                                           Section 4.3 Infinite Series of Constants 219

to write
 B .cos 3 n D 2 Â cos 52 Â / C .cos 52 Â cos 72 Â / C C cos n 21 Â cos.n C 12 /Â
                                                    2 sin.Â=2/

D cos 32 Â cos.n C 12 /Â ;
           2 sin.Â=2/

which implies that                       1           

                                jBnj  Ä    sin.Â=2/   ; n 2:
                                         

                                                                   P
Since fang and fbng satisfy the hypotheses of Dirichlet's theorem, anbn converges.

   Dirichlet's test takes a simpler form if fang is nonincreasing, as follows.
Corollary 4.3.21 (Abel's Test) The series P anbn converges if anC1 Ä an for
n k; limn!1 an D 0; and

                              jbk C bkC1 C C bnj Ä M; n k;

for some constant M:

Proof If anC1 Ä an, then

                    X m                 X m            anC1/ D ak  amC1 :
                         janC1  anj D .an

                    nDk                    nDk

Since limm!1 amC1 D 0, it follows that

                                X 1        anj D ak < 1:
                                    janC1

                                                     nDk

                                                                         P
Therefore, the hypotheses of Dirichlet's test are satisfied, so anbn converges.

Example 4.3.22 The series                  X sin nÂ
                                                  np ;

which we know is convergent if p > 1 (Example 4.3.18), also converges if 0 < p Ä 1.
This follows from Abel's test, with an D 1=np and bn D sin nÂ (see Example 4.3.21).

   The alternating series test from calculus follows easily from Abel's test.

Corollary 4.3.22 (Alternating Series Test) The series P. 1/nan converges
if 0 Ä anC1 Ä an and limn!1 an D 0:
220 Chapter 4 Infinite Sequences and Series

Proof Let bn D . 1/n; then fjBnjg is a sequence of zeros and ones and therefore
bounded. The conclusion now follows from Abel's test.

Grouping Terms in a Series

The terms of a finite sum can be grouped by inserting parentheses arbitrarily. For example,

      .1 C 7/ C .6 C 5/ C 4 D .1 C 7 C 6/ C .5 C 4/ D .1 C 7/ C .6 C 5 C 4/:

According to the next theorem, the same is true of an infinite series that converges or
diverges to 1.

Theorem 4.3.23 Suppose that nDk P1 an D A; where       1  Ä    A  Ä  1:  Let  fnj  g1  be
an increasing sequence of integers, with n1 k. Define
                                                                                    1

           b1 D ak C C an1 ;

           b2 D an1C1 C                      C an2 ;
               ::
               :

           br D anr 1C1 C C anr :

Then                        X 1
                                 bnj D A:

                            j D1

Proof If Tr is the r th partial sum of j D1 P1 bnj and fAng is the nth partial sum of
P1

   sDk as, then

      Tr D b1 C b2 C C br               C an2 / C      C .anr 1C1 C      C anr /
         D .a1 C C an1 / C .an1C1 C
         D Anr :

Thus, fTr g is a subsequence of fAng, so limr!1 Tr D limn!1 An D A by Theorem 4.2.2.

Example 4.3.23 If nD0 P1 . 1/nan satisfies the hypotheses of the alternating series
test and converges to the sum S , Theorem 4.3.23 enables us to write

      Xk                             X 1
      S D . 1/nan C . 1/kC1 .akC2j 1                  akC2j /

      nD0                            j D1                            3
                                     2
      Xk                                     X 1
and   S D . 1/nan C . 1/kC1 4akC1                  .akC2j akC2j 1/5:

      nD0                                    j D1

Since 0 Ä anC1 Ä an, these two equations imply that S Sk is between 0 and . 1/k 1akC1.
                         Section 4.3 Infinite Series of Constants 221

Example 4.3.24 Introducing parentheses in some divergent series can yield seem-
ingly contradictory results. For example, it is tempting to write

           X 1                                               D0C0C
               . 1/nC1 D .1 1/ C .1 1/ C

                              nD1

and conclude that nD1 P1 . 1/n D 0, but equally tempting to write

                            X 1
                                . 1/nC1 D 1 .1 1/ .1 1/

                                        nD1

                                            D1 0 0
and conclude that nD1 P1 . 1/nC1 D 1. Of course, there is no contradiction here, since
Theorem 4.3.23 does not apply to this series, and neither of these operations is legitimate.

Rearrangement of Series

A finite sum is not changed by rearranging its terms; thus,

1 C 3 C 7 D 1 C 7 C 3 D 3 C 1 C 7 D 3 C 7 C 1 D 7 C 1 C 3 D 7 C 3 C 1:

                                P                                         P
This is not true of all infinite series. Let us say that bn is a rearrangement of an if

the two series have the same terms, written in possibly different orders. Since the partial

sums of the two series may form entirely different sequences, there is no apparent reason

to expect them to exhibit the same convergence properties, and in general they do not.

   We are interested in what happens if we rearrange the terms of a convergent series. We
will see that every rearrangement of an absolutely convergent series has the same sum, but
that conditionally convergent series fail, spectacularly, to have this property.

TPheorem 4.P3.24 If nD1 P1 bn is a rearrangement of an absolutely convergent series
   nD1 1 an; then nD1 1 bn also converges absolutely; and to the same sum:

Proof Let

An D ja1j C ja2j C C janj and Bn D jb1j C jb2j C C jbnj:

For each n 1, there is an integer kn such that b1, b2, . . . , bn are included aPmong a1, a2,
. . . , akn , so Bn Ä Akn. Since fAng is bounded, so is fBng, and therefore jbnj < 1
(Theorem 4.3.8).

   Now let

           An D a1 C a2 C C an; Bn D b1 C b2 C                     C bn;

           X 1           X 1
           A D an; and B D bn:

           nD1           nD1
222 Chapter 4 Infinite Sequences and Series

We must show that A D B. Suppose thPat > 0. From Cauchy's convergence criterion for
series and the absolute convergence of an, there is an integer N such that

                         jaN C1j C jaN C2j C C jaN Ck j < ; k 1:

Choose N1 so that a1, a2, . . . , aN are included among b1, b2, . . . , bN1 . If n N1,
then An and Bn both include the terms a1, a2, . . . , aN , which cancel on subtraction;Pthus,
jAn Bnj is dominated by the sum of the absolute values of finitely many terms from an
with subscripts greater than N . Since every such sum is less than ,

                                    jAn Bnj < if n N1:

Therefore, limn!1.An Bn/ D 0 and A D B.
   To investigate the consequences of rearranging a conditionally convergent series, we

need the next theorem, which is itself important.

Theorem    4.3.25  If P    D  fani  g1  and  Q  D  famj  g1  are  respectivePly  the  subsequences

                                     1                    1

of all positive and negative terms in a conditionally convergent series an; then

                   X 1                             X 1                                (4.3.24)
                       ani D 1 and                     amj D 1:

                   i D1                            j D1

                                                            P
Proof If both series in (4.3.24) convePrge, then an converges absolutely, while if one
converges and the other diverges, then an diverges to 1 or 1. Hence, both must
diverge.

   The next theorem implies that a conditionally convergent series can be rearranged to
produce a series that converges to any given number, diverges to 1, or oscillates.

Theorem 4.3.26 Suppose that nD1 P1 an is conditionally convergentPand and are
arbitrarily given in the extePnded reals; with Ä : Then the terms of nD1 1 an can be
rearranged to form a series nD1 1 bn with partial sums

                           Bn D b1 C b2 C C bn; n 1;

such that

                            lim Bn D         and lim Bn D :                           (4.3.25)

                           n!1                          n!1

Proof We consider the case where and are finite and lPeave the other cases to you
(Exercise 4.3.36). We may ignore any zero terms that occur in nD1 1 an. For convenience,
we denote the positive terms by P D fi g1 1 and and the negative terms by Q D f             1
                                                                                      j  g  1  .

We construct the sequence

fbng1 1 D f1; : : : ; m1; 1; : : : ; n1 ; m1C1; : : : ; m2 ; n1C1; : : : ; n2 ; : : : g;
                                                                                                (4.3.26)
                                       Section 4.3 Infinite Series of Constants 223

with segments chosen alternately from P and Q. Let m0 D n0 D 0. If k     1, let mk and
nk be the smallest integers such that mk > mk 1, nk > nk 1,

      X mk   nX k 1                    ; and  X mk      X nk
          i       j                               i         j Ä :

      i D1   j D1                             i D1      j D1

                                                              P       P
Theorem 4.3.25 implies that this construction is possible: since i D j D 1, we

can choose mk and nk so that

                              X mk            X nk
                                     i and           j

                              i Dmk 1         j Dnk 1

are as large as we please, no matter how large mk 1 and nk 1 are (Exercise 4.3.23). Since
mk and nk are the smallest integers with the specified properties,

             Ä Bmk Cnk 1 < C mk ; k 2;                                              (4.3.27)

and

                              nk < BmkCnk Ä ; k 2:                                  (4.3.28)

From (4.3.26), bn < 0 if mk C nk 1 < n Ä mk C nk, so

      BmkCnk Ä Bn Ä BmkCnk 1 ; mk C nk 1 Ä n Ä mk C nk;                             (4.3.29)

while bn > 0 if mk C nk < n Ä mkC1 C nk , so

      BmkCnk Ä Bn Ä BmkC1Cnk ; mk C nk Ä n Ä mkC1 C nk:                             (4.3.30)

Because of (4.3.27) and (4.3.28), (4.3.29) and (4.3.30) imply that

      nk < Bn < C mk ; mk C nk 1 Ä n Ä mk C nk;                                     (4.3.31)

and

      nk < Bn < C mkC1 ; mk C nk Ä n Ä mkC1 C nk:                                   (4.3.32)

     From the first inequality of (4.3.27), Bn for infinitely many values of n. However,

since limi!1 i D 0, the second inequalities in (4.3.31) and (4.3.32) imply that if > 0

then Bn > C for only finitely many values of n. Therefore, limn!1 Bn D . From

the second inequality in (4.3.28), Bn Ä for infinitely many values of n. However, since

limj !1 j D 0, the first inequalities in (4.3.31) and (4.3.32) imply that if > 0 then

Bn <  for only finitely many values of n. Therefore, limn!1 Bn D .

Multiplication of Series

The product of two finite sums can be written as another finite sum: for example,

                    .a0 C a1 C a2/.b0 C b1 C b2/ D a0b0 C a0b1 C a0b2
                                                              Ca1b0 C a1b1 C a1b2
                                                              Ca2b0 C a2b1 C a2b2;
224 Chapter 4 Infinite Sequences and Series

where the sum on the right contains each product ai bj .i; j D 0; 1; 2/ exactly once. These
products can be rearranged arbitrarily without changing their sum. The corresponding
situation for series is more complicated.

   Given two series

            X 1  an and       X 1  bn

            nD0               nD0

(because of applications in Section 4.5, it is convenient here to start the summation index
at zero), we can arrange all possible products ai bj .i; j 0/ in a two-dimensional array:

      a0b0    a0b1  a0 b2     a0 b3          (4.3.33)
      a1b0    a1b1  a1 b2     a1 b3
      a2b0    a2b1  a2 b2     a2 b3
      a3b0    a3b1  a3 b2     a3 b3

        ::      ::    ::        ::
        :       :     :         :

where the subscript on a is constant in each row and the subscript on b is constant in each
column. Any sensible definition of the product

               1!         1!
              X          X

                   an         bn

              nD0        nD0

clearly must involve every product in this Parray exactly once; thus, we might define the
product of the two series to be the series nD0 1 pn, where fpng is a sequence obtained
by ordering the products in (4.3.33) according to some method that chooses every product

exactly once. One way to do this is indicated by

a0b0 ! a0b1            a0b2 ! a0b3

            #            "             #

a1b0        a1 b1      a1b2            a1b3

#                        "             #

a2b0 ! a2b1 ! a2b2                     a2b3  (4.3.34)

                                       #

a3b0        a3 b1      a3b2            a3b3

#

:::         :::          :::           :::
                                       Section 4.3 Infinite Series of Constants 225

and another by

a0b0 ! a0b1                     a0b2 ! a0b3           a0 b4

                  .        %           .           %

a1b0                 a1b1       a1 b2       a1b3

#%                         .           %

a2b0                 a2b1       a2 b2       a2b3                       (4.3.35)

                  .        %

a3b0                 a3b1       a3 b2       a3b3

#%

a4b0                 :::        :::         :::

There are infinitely many others, and to each corresponds a series that we might consider
to be the product of the given series. This raises a question: If

                           X 1  an D A and  X 1    bn D B

                           nD0              nD0

where A and B are finite, does every product series nD0 P1 pn constructed by ordering the
products in (4.3.33) converge to AB?

The next theorem tells us when the answer is yes.

Theorem 4.3.27 Let

                          X 1   an D A and  X 1    bn D B;

                          nD0               nD0

where A and B are finite, and at least one term of each series is nonzero. Then nD0 P1 pn D
P AB for evePry sequence fpng obtained by ordering the produPcts in (4.3.33) if and only if

   an and bn converge absolutely: Moreover; in this case, pn converges absolutely:

Proof First, let fpng be the sequence obtained by arranging the products fai bj g accord-
ing to the scheme indicated in (4.3.34), and define

                An D a0 C a1 C  C an;  An D ja0j C ja1j C    C janj;
                Bn D b0 C b1 C  C bn;  Bn D jb0j C jb1j C    C jbnj;
                Pn D p0 C p1 C  C pn;  P n D jp0j C jp1j C    C jpnj:
From (4.3.34), we see that

and, in general,     P0 D A0B0; P3 D A1B1; P8 D A2B2;
                                  P.mC1/2 1 D AmBm:
                                                                       (4.3.36)
226 Chapter 4 Infinite Sequences and Series

Similarly,

                                     P .mC1/2 1 D AmB m:                                     (4.3.37)

P               P
If janj < 1 and jbnj < 1, then fAmBmg is bounded and, since P m Ä P .mC1/2 1,
                                                    P                         P
(4.3.37) implies that fP mg is bounded. Therefore, jpnj < 1, so pn converges. Now

                X 1                                        (by definition)
                     pn D lim Pn                           (by Theorem 4.2.2)
                                                           (from (4.3.36))
                                 n!1                       (by Theorem 4.1.8)
                nD0

                         D lim P.mC1/2 1

                                 m!1

                        D lim AmBm
                            m!1 Á                   Á

                        D lim Am lim Bm
                             m!1              m!1

                        D AB:

Since any other ordering ofPthe products in (4.3.33) produces a aPrearrangement of the
absolutely convergent sPeries nD0 1 pn, Theorem 4.3.24 implies that jqnj < 1 for every
such ordering and that      1    qn  D  AB .  This  shows  that  the  stated  condition  is  sufficient.
                            nD0
                            P1
For necessity, aPgain let nD0 pn be obtained from the ordering indicated Pin (4.3.34),
and suppose that nD0 1 pn and all its rearrangements converge to AB. Then pn must

converge absolutely, by Theorem 4.3.26. Therefore, fP m2 1g is bounded, and (4.P3.37)
implPies that fAmg and fBmg are bounded. (Here we neePd the assumption Pthat neither an
nor bn consists entirely of zeros. Why?) Therefore, janj < 1 and jbnj < 1.

   The following definition of the product of two series is due to Cauchy. We will see the
importance of this definition in Section 4.5.

Definition 4.3.28 The Cauchy product of nD0 P1 an and nD0 P1 bn is nD0 P1 cn, where

                cn D a0bn C a1bn 1 C C an 1b1 C anb0:                                        (4.3.38)

Thus, cn is the sum of all products ai bj , where i 0, j 0, and i C j D n; thus,

                                     Xn             Xn
                             cn D ar bn r D br an r :
                                                                                             (4.3.39)

                                     r D0           r D0

   Henceforth,  nD0 P1 an nD0 P1 bn should be interpreted as the Cauchy product. Notice
that
                        1!            1!            1!           1!
                        X            X              X            X

                            an           bn D           bn           an ;

                        nD0          nD0            nD0          nD0

and that the Cauchy product of two series is defined even if one or both diverge. In the case

where both converge, it is natural to inquire about the relationship between the product of

their sums and the sum of the Cauchy product. Theorem 4.3.27 yields a partial answer to

this question, as follows.
                                           Section 4.3 Infinite Series of Constants 227

                         P1            P1
Theorem 4.3.29 If PnD0 an and PnD0 bn converge absolutely to sums A and B;
                              1            1
then the Cauchy product of nD0 an and nD0 bn converges absolutely to AB:

Proof Let Cn be the nth partial sum of the Cauchy product; that is,

                                       Cn D c0 C c1 C C cn

(see (4.3.38)). Let nD0 P1 pn be the series obtained by ordering the products fai ; bj g ac-
cording to the scheme indicated in (4.3.35), and define Pn to be its nth partial sum; thus,

                              Pn D p0 C p1 C C pn:

Inspection of (4.3.35) shows that cn is the sum of the nC 1 terms connected by the diagonal
arrows. Therefore, Cn D Pmn , where

                          mn D 1 C 2 C C .n C 1/ 1 D n.n C 3/ :
                                                                           2
                                                                                                  P

From Theorem 4.3.27, limn!1 Pmn D AB, so limn!1 Cn D AB. To see that jcnj <

1, we observe that                 Xn      X mn

                                       jcrj Ä jpsj

                 P r D0 sD0
and recall that jpsj < 1, from Theorem 4.3.27.

Example 4.3.25 Consider the Cauchy product of nD0 P1 r n with itself. Here an D
bn D r n and (4.3.39) yields

       cn D r 0r n C r 1r n 1 C C r n 1r 1 C r nr 0 D .n C 1/r n;

X 1 so !2 X 1
                                            r n D .n C 1/r n:

                                 nD0       nD0

Since                         X 1 r n D 1 ;
                              nD0 1 r
                                                 jrj < 1;

and the convergence is absolute, Theorem 4.3.29 implies that

                         X 1                  1        jrj < 1:
                             .n C 1/r n D           ;
                                           .1 r /2
                         nD0

Example 4.3.26 If

                    X 1       X 1 n              X 1           X 1 n
                         an D nS and                   bn D nS ;
                    nD0       nD0                nD0           nD0
228 Chapter 4 Infinite Sequences and Series

then (4.3.39) yields

                      Xn n mm        1 Xn       !
                                                n n mm D . C /n I
           cn D .n m/SmS D nS                   m                  nS
                      mD0                 mD0

thus,                        X 1 n ! X 1 n ! X 1 . C /n

                                  nS nS D nS :                                (4.3.40)

                             nD0     nD0        nD0
                                     P1 n
You probably know from calculus that nD0 x =nS converges absolutely for all x to e .x

Thus, (4.3.40) implies that

                                     ee D eC ;

a familiar result.

   The Cauchy product of two series may converge under conditions weaker than those
of Theorem 4.3.29. If one series converges absolutely and the other converges condi-
tionally, the Cauchy product of the two series converges to the product of the two sums
(Exercise 4.3.40). If two series and their Cauchy product all converge, then the sum of
the Cauchy product equals the product of the sums of the two series (Exercise 4.5.32).
However, the next example shows that the Cauchy product of two conditionally convergent
series may diverge.

Example 4.3.27 If                            . 1/nC1

                                  an D bn D p   nC1   ;

       P1             P1
then nD0 an and nD0 bn converge conditionally. From (4.3.39), the general term of

their Cauchy product is

                    Xn . 1/rC1. 1/n rC1            Xn 1            1
           cn D p p                       D . 1/n p          p             ;
                    rD0 r C 1 n r C 1              rD0 r C 1 n
                                                                    r C1

so                           Xn 1

                      jcnj        p       p  1     D  nC1    D 1:

                             rD0 n C 1 n C 1 n C 1

Therefore, the Cauchy product diverges, by Corollary 4.3.6.

                                  4.3 Exercises

1. Prove Theorem 4.3.2.

2. Prove Theorem 4.3.3.
3. (a) Prove: If an D bn except for finitely many values of n, then P an and P bn

             converge or diverge together.
                                     Section 4.3 Infinite Series of Constants 229

(b) Let bnk D ak for some increasing sequence fnkg1 1 of positive integers, and
      bn D 0 if n is any other positive integer. Show that

                                X 1  bn and       X 1  an

                                nD1               nD1

             diverge or converge together, and that in the latter case they have the same sum.

             (Thus, the convergence properties of a series are not changed by inserting zeros

             between its terms.)
4. (a) Prove: If P an converges, then

                          lim .an C anC1 C C anCr / D 0; r 0:

                                    n!1

(b) Does (a) imply that P an converges? Give a reason for your answer.

5. Prove Corollary 4.3.7.

6. (a) Verify Corollary 4.3.7 for the convergent series P 1=np .p > 1/. HINT: See

the proof of Theorem 4.3.10: (b) Verify Corollary 4.3.7 for the convergent series P. 1/n=n.
                                     P            P
7. Prove: If 0 Ä bn Ä an Ä bnC1, then an and bn converge or diverge together.

8. Determine convergence or divergence.     (b)  X              1
            X pn2 1
                                                     2n 1 C 2 sin.n =4/1
     (a) p
                    n5 C 1

(c) X 1     e n log n                            X
              n                             (d) cos n2

     X                                      (f ) tan X 1
(e) sin n2                                            nn

(g) cot X 1                                 (h)  X log n

     nn                                                n2
                                               R1
9. Suppose that f .x/ 0 for x k. Prove that k f .x/ dx < 1 if and only if

                           X 1 Z nC1
                                        f .x/ dx < 1:

                           nDk n

HINT: Use Theorems 3.4.5 and 4.3.8.

10. Use the integral test to find all values of p for which the series converges.

(a)  Xn                    (b)  X n2                       (c)  X sinh n

     .n 1/2  p                       .n C 4/3  p                   .cosh n/                  p
230 Chapter 4 Infinite Sequences and Series

11. Let Ln be the nth iterated logarithm. Show that

                    X                        1
                         L0 .n/L1 .n/        Lk.n/ OELkC1.n/p

        converges if and only if p > 1. HINT: See Exercise 3.4.10.
12. Suppose that g, g0, and .g0/2 gg00 are all positive on OER; 1/. Show that

                            X g0.n/
                                 g.n/ < 1

if and only if limx!1 g.x/ < 1.

13. Let                            X 1 1
                         S.p/ D np ;
                                                     p > 1:
                                        nD1

Show that

                    1                        X N 1                 1
           .p 1/.N C 1/p 1 < S.p/                    np < .p 1/N p 1 :
                                             nD1

HINT: See the proof of Theorem 4.3.10.

14. Suppose that f is positive, decreasing, and locally integrable on OE1; 1, and let

                              Xn             Zn
                       an D f .k/                f .x/ dx:

                                 kD1           1

(a) Show that fang is nonincreasing and nonnegative, and

                            0 < lim an < f .1/:

                                   n!1

(b) Deduce from(a) that

                            Â 11                             1Ã
                       D lim 1 C C C C log n
                       n!1                   23              n

         exists, and 0 < < 1. ( is Euler's constant; 0:577.)

15. Determine convergence or divergence.     (b) X n C 1 r n .r > 0/
       (a) 2 X 2 C sin nÂ                                 n
                   n C sin nÂ

     X                                       (d) 2 2 X n C log n
(c) e n cosh n . > 0/                                   n .log n/

(e) 2 X n C log n                            (f )  X .1 C 1=n/n
           n log n
                                                             2  n
                                Section 4.3 Infinite Series of Constants 231

16. Let Ln be the nth iterated logarithm. Prove that

                 X                            1

                      OEL0.n/q0C1 OEL1.n/q1C1         OELm.n/qmC1

converges if and only if there is at least one nonzero number in fq0; q1; : : : ; qmg and
the first such is positive. HINT: See Exercises 4.3.11 and 2.4.42.b/:

17. Determine convergence or divergence.

(a)  X 2 C sin2.n =4/                     (b) n X n.n C 1/

     X3     3n                                   X        4  1/n
         sin.n =2/                                       C.
(c) n.n C 1/                                          n
                                          (d) n.n C 1/

18. Determine convergence or divergence, with r > 0.

     X nS                       X                            (c) X r n
(a) n                      (b) npr n                                   nS
                           (e) X r 2n
          r
(d) X r 2nC1                         .2n/S

           .2n C 1/S

19. Determine convergence or divergence.

(a)  X .2n/S               (b)  X                     .3n/S

         2n 2                             3n
         2 .nS/                           3 nS.n C 1/S.n C 3/S

     X    2nnS             (d) X . C 1/               . C n 1/ .;  > 0/
(c) 5    7 .2n C 3/                   . C 1/          . C n 1/

20. Determine convergence or divergence.       X Â 1 C sin 3nÂ Ãn
                                          (b) 3
(a)  X nn .2 C . 1/n/

         2  n

     X Â 1 C sin.n =6/ Ãn                      XÂ            1 Ãn2
(c) .n C 1/ 3                             (d) 1              n

21. Give counterexamples showing that the following statements are false unless it is

        assumed that the terms of the series have the same sign for n sufficiently large.
       (a) P an converges if its partial sums are bounded. P
       (b) If bP n ¤ 0 for n k and limn!1 an=bn D L, where 0 < L < 1, then an

               and bn converge or diverge together. P
       (c) If an ¤ 0 and limn!1 anC1=an < 1, then an converges.

                                                                                 P
       (d) If an ¤ 0 and limn!1 n OE.anC1 =an/ 1 < 1, then an converges.

                                                           P
22. P Prove: If the terms of a convergent series an have the same sign for n k, then

            an converges absolutely. P
23. Suppose that an 0 for n m and an D 1. Prove: If N is an arbitrary integer

                                                                    PN Ck
           m and J is an arbitrary positive number, then nDN an > J for some positive
        integer k.

24. Prove Theorem 4.3.19.
232 Chapter 4 Infinite Sequences and Series

25. Show that the series converges absolutely.

(a) X. 1/n        1                          (b)    X sin nÂ

                         2                             2  n
               n.log n/

     X n1                                         X cos nÂ
(c) . 1/ p sin                               (d) p

                    nn                                    n3 1

26. Show that the series converges.

(a) 2 n X n sin nÂ       . 1 < Â < 1/ (b) X cos nÂ                 .Â ¤ 2k ; k D integer/
          n C . 1/                                           n

27. Determine whether the series is absolutely convergent, conditionally convergent, or

divergent.

     X bn      .b4m D b4mC1 D 1; b4mC2 D b4mC3 D 1/
(a) p
            n

(b) sin X 1 n                                (c)    X1 n
           n6                                        2 cos
                                                    n           7

(d) sin X 1 3 5 .2n C 1/ nÂ
          4 6 8 .2n C 4/
                                                                   P
28. Let g be a rational function (ratio of two polynomials). Show that g.n/r con-n

verges absolutely if jr j < 1 or diverges if jr j > 1. Discuss the possibilities for

jrj D 1.  P2                P2                   P

29. Prove: If an < 1 and bn < 1, then anbn converges absolutely.
               P                     P2                      P
30. (a) Prove: If an converges and an D 1, then an converges condition-

ally.

(b) Give an example of a series with the properties described in (a).

31. Suppose that 0 Ä anC1 < an and

                            lim b1 C b2 C           C bn > 0;
                                             wn
                            n!1

where fwng is a sequence of positive numbers such that

                            X                anC1/ D 1:
                                wn.an

            P
Show that anbn D 1. HINT: Use summation by parts.

32. (a) Prove: If 0 < 2 < Â < 2 , then

                  lim j sin Âj C j sin 2Âj C        C j sin nÂj    sin :
                                                                    2
                  n!1                        n

HINT: Show that j sin nÂj > sin at least "half the time"; more precisely,
show that if j sin mÂj Ä sin for some integer m then j sin.m C 1/Âj > sin .
                                  Section 4.3 Infinite Series of Constants 233

(b) Show that                     X sin nÂ

                                                                          np

converges conditionally if 0 < p Ä 1 and Â ¤ k (k D integer). HINT: Use
Exercise 4.3.31 and see Example 4.3.22.

33. Show that       X 1 . 1/nC1 1 X 1 1

                          n D 2 n.2n 1/ :
                    nD1                                                   nD1

34. Let b3mC1, b3mC2 D 2, and b3mC3 D 1 for m 0. Show that

               X 1 bn 2 X 1                                                    1
                    n D3                                           :
               nD1        mD0     .m C 1/.3m C 1/.3m C 2/

             P
35. P Let bn be obtained by rearranging finitely many terms of a convergent series

            an. Show that the two series have the same sum.

36. Prove Theorem 4.3.26 for the case where (a) is finite and D 1; (b) D 1
       and D 1; (c) D D 1.

37. Give necessary and sufficient conditions for a divergent series to have a convergent
        rearrangement.

38. A series diverges unconditionally to 1 if every rearrangement of the series diverges
        to 1. State necessary and sufficient conditions for a series to have this property.

39. Suppose that f and g have derivatives of all orders at 0, and let h D fg. Show

formally that

               X 1 f .n/.0/ !     X 1 g.n/.0/ ! X 1 h.n/.0/
                              xn                                          xn D              xn
                                  nD0 nS                                            nD0 nS
               nD0 nS

        in the sense of the Cauchy product. HINT: See Exercise 2.3.12.
40. Prove:PIf P janj < 1 and P bn converges (perhaps conditionally), with nD0 P1 an D

        A and nD0 1 bn D B, then the Cauchy product

                    X 1           1!                                           1!
                        cn D      X                                            X

                                      an                                           bn

                    nD0           nD0                                          nD0

converges to AB. HINT: Let fAng, fBng, and fCng be the partial sums of the series.

Show that                            Xn
                    Cn AnB D ar .Bn r B/

                                                                    r D0

                                  P
and apply Theorem 4.3.5 to janj.
234 Chapter 4 Infinite Sequences and Series

41. Suppose that ar 0 for all r 0 and and 0 P1 ar D A < 1. Show that

1 nX1         arCs D 0 and                              1 nX1         ar s D 2A a0:
 lim                                                     lim
n!1 n  r;sD0                                            n!1 n  r;sD0

42. Prove: If limi!1 aj.i/ D aj (j 1) and jaj.i/j Ä j (i; j 1), where j D1 j P1 <
        1, then limi!1 j D1 P1 aj.i/ D j D1 P1 aj .

43. Prove: If an > 0, n 1, and nD1 P1 an D 1, then nD1 P1 an=.1 C an/ D 1.

4.4 SEQUENCES AND SERIES OF FUNCTIONS

Until now we have considered sequences and series of constants. Now we turn our attention
to sequences and series of real-valued functions defined on subsets of the reals. Throughout
this section, "subset" means "nonempty subset."

   If Fk , FkC1, . . . , Fn; : : : are real-valued functions defined on a subset D of the reals,
we say that fFng is an infinite sequence or (simply a sequence) of functions on D. If the
sequence of values fFn.x/g converges for each x in some subset S of D, then fFng defines
a limit function on S . The formal definition is as follows.

Definition 4.4.1 Suppose that fFng is a sequence of functions on D and the sequence
of values fFn.x/g converges for each x in some subset S of D. Then we say that fFng
converges pointwise on S to the limit function F , defined by

       F .x/ D lim Fn.x/; x 2 S:

                      n!1

Example 4.4.1 The functions
                                           Â nx Ãn=2

                               Fn.x/ D 1 n C 1 ; n 1;

define a sequence on D D . 1; 1, and                    x < 0;
                                                   8    x D 0;
                                                   <1;  0 < x Ä 1:

       lim Fn.x/ D 1;
       n!1    :
               0;

Therefore, fFng converges pointwise on S D OE0; 1 to the limit function F defined by

              F .x/ D 1; x D 0;
                          0; 0 < x Ä 1:

Example 4.4.2 Consider the functions
                                Fn.x/ D xne nx ; x 0; n 1;

(Figure 4.4.1).
                                        Section 4.4 Sequences and Series of Functions 235

            y

                                                  y =Fn(x)=xne-nx  y = e-n
                                                                        x

                               Figure 4.4.1

Equating the derivative

                           Fn0 .x/ D nxn 1e nx.1 x/

to zero shows that the maximum value of Fn.x/ on OE0; 1/ is e n, attained at x D 1.

Therefore,

                               jFn.x/j Ä e n; x 0;

so limn!1 Fn.x/ D 0 for all x  0. The limit function in this case is identically zero on
OE0; 1/.

Example     4.4.3  For n 1, let Fn be defined on . 1; 1/ by

                              8                   x < 2n ;
                              ^^0;                  2n Ä x < 1n ;
                              ^^^                   1n Ä x < 1n ;
                              ^^^^^ n.2 < C nx/;
                   Fn.x/ D n2x;                   1n Ä x < 2n ;
                              ^^^                 x n2
                              ^^^^^^n.2 nx/; ^
                              :

                                0;

(Figure 4.4.2, page 236),

Since Fn.0/ D 0 for all n, limn!1 Fn.0/ D 0. If x ¤ 0, then Fn.x/ D 0 if n  2=jxj.

Therefore,

                            lim Fn.x/ D 0;        1 < x < 1;

                           n!1

so the limit function is identically zero on . 1; 1/.

Example 4.4.4 For each positive integer n, let Sn be the set of numbers of the form
x D p=q, where p and q are integers with no common factors and 1 Ä q Ä n. Define

                                       Fn.x/ D 1; x 2 Sn; 0; x 62 Sn:
236 Chapter 4 Infinite Sequences and Series

If x is irrational, then x 62 Sn for any n, so Fn.x/ D 0, n 1. If x is rational, then x 2 Sn
and Fn.x/ D 1 for all sufficiently large n. Therefore,

lim Fn.x/ D F .x/ D 1 if x is rational;
n!1                                          0 if x is irrational:

           y

                                                                    y = n

                                                y =Fn(x)

- 2n - 1n                                                           x

                                             1  2

                                             n  n

                                                                    y = -n

           Figure 4.4.2

 Uniform Convergence

The pointwise limit of a sequence of functions may differ radically from the functions in
 the sequence. In Example 4.4.1, each Fn is continuous on . 1; 1, but F is not. In
 Example 4.4.3, the graph of each Fn has two triangular spikes with heights that tend to
 1 as n ! 1, while the graph of F (the x-axis) has none. In Example 4.4.4, each Fn
 is integrable, while F is nonintegrable on every finite interval. (Exercise 4.4.3). There is
 nothing in Definition 4.4.1 to preclude these apparent anomalies; although the definition
 implies that for each x0 in S , Fn.x0/ approximates F .x0/ if n is sufficiently large, it
 does not imply that any particular Fn approximates F well over all of S . To formulate a
 definition that does, it is convenient to introduce the notation

                                            kgkS D sup jg.x/j

                                                                               x2S

 and to state the following lemma. We leave the proof to you (Exercise 4.4.4).

 Lemma 4.4.2 If g and h are defined on S; then

                                       kg C hkS Ä kgkS C khkS

and
                                           kghkS Ä kgkS khkS :

 Moroever; if either g or h is bounded on S; then

                                     kg hkS jkgkS khkS kj :
   Section 4.4 Sequences and Series of Functions 237

Definition 4.4.3 A sequence fFng of functions defined on a set S converges uniformly
to the limit function F on S if

                                         lim jjFn F kS D 0:

                                                          n!1

Thus, fFng converges uniformly to F on S if for each > 0 there is an integer N such that

kFn F kS < if n N:     (4.4.1)

   If S D OEa; b and F is the function with graph shown in Figure 4.4.3, then (4.4.1) implies
that the graph of

                                      y D Fn.x/; a Ä x Ä b;
lies in the shaded band

                             F .x/ < y < F .x/ C ; a Ä x Ä b;

if n N .
   From Definition 4.4.3, if fFng converges uniformly on S , then fFng converges uniformly

on any subset of S (Exercise 4.4.6).

                                   y

      y =F (x) +
      y =F (x)
      y =F (x) -

a  b                x

                                        Figure 4.4.3

Example 4.4.5 The sequence fFng defined by
                                     Fn.x/ D xne nx ; n 1;

converges uniformly to F Á 0 (that is, to the identically zero function) on S D OE0; 1/,
since we saw in Example 4.4.2 that

                                    kFn F kS D kFnkS D e n;
238 Chapter 4 Infinite Sequences and Series

so                                       kFn F kS <
if n >  log . For these values of n, the graph of

                   y D Fn.x/; 0 Ä x < 1;

lies in the strip  ÄyÄ ; x 0
(Figure 4.4.4).

   The next theorem provides alternative definitions of pointwise and uniform convergence.
It follows immediately from Definitions 4.4.1 and 4.4.3.

Theorem 4.4.4 Let fFng be defined on S: Then                              > 0 and x 2 S,

(a) fFng converges pointwise to F on S if and only if there is, for each
      an integer N .which may depend on x as well as / such that

                   jFn.x/ F .x/j < if n N:

(b) fFng converges uniformly to F on S if and only if there is for each > 0 an integer
      N .which depends only on and not on any particular x in S / such that

                              jFn.x/ F .x/j < for all x in S if n N :

        y

                                             y =xne-nx                    y = e
                                                                          y = e-n

                                                                             x

                                                                           y = -e

                                     Figure 4.4.4
The next theorem follows immediately from Theorem 4.4.4 and Example 4.4.6.
                    Section 4.4 Sequences and Series of Functions 239

Theorem 4.4.5 If fFng converges uniformly to F on S; then fFng converges pointwise
to F on S: The converse is falseI that is; pointwise convergence does not imply uniform
convergence.

Example 4.4.6 The sequence fFng of Example 4.4.3 converges pointwise to F Á 0

on . 1; 1/, but not uniformly, since

                                                         Â Ã  Â Ã
                                                         1               1
                    kFn F k. 1;1/ D Fn                      D Fn            D  n;
                                                         n        n       

so                                                       F k. 1;1/ D 1:
                                     lim kFn

                                                    n!1

However, the convergence is uniform on

                    S D . 1;  [ OE ; 1/

for any > 0, since

                                                       2
                    kFn F kS D 0 if n > :

Example 4.4.7 If Fn.x/ D xn, n                           1, then fFng converges pointwise on S D OE0; 1
to
                                                         1; x D 1;
                                      F .x/ D            0; 0 Ä x < 1:

The convergence is not uniform on S . To see this, suppose that 0 < < 1. Then

jFn.x/ F .x/j > 1                                        if .1 /1=n < x < 1:

Therefore,                      1 Ä kFn F kS Ä 1
for all n 1. Since  can be arbitrarily small, it follows that

                    kFn F kS D 1

for all n 1.
   However, the convergence is uniform on OE0;  if 0 < < 1, since then

                                          kFn F kOE0;  D n

and limn!1 n D 0. Another way to say the same thing: fFng converges uniformly on
every closed subset of OE0; 1/.

   The next theorem enables us to test a sequence for uniform convergence without guessing
what the limit function might be. It is analogous to Cauchy's convergence criterion for
sequences of constants (Theorem 4.1.13).
240 Chapter 4 Infinite Sequences and Series

Theorem 4.4.6 (Cauchy's Uniform Convergence Criterion) A sequence

of functions fFng converges uniformly on a set S if and only if for each > 0 there is an

integer N such that

                             kFn FmkS < if n; m N:              (4.4.2)

Proof For necessity, suppose that fFng converges uniformly to F on S . Then, if > 0,
there is an integer N such that

                             kFk F kS < 2 if k N:

Therefore,

            kFn FmkS D k.Fn F / C .F Fm/kS
                            Ä kFn F kS C kF FmkS (Lemma 4.4.2)
                            < 2 C 2 D if m; n N:

For sufficiency, we first observe that (4.4.2) implies that

                     jFn.x/ Fm.x/j < if n; m N;

for any fixed x in S . Therefore, Cauchy's convergence criterion for sequences of constants
(Theorem 4.1.13) implies that fFn.x/g converges for each x in S ; that is, fFng converges
pointwise to a limit function F on S . To see that the convergence is uniform, we write

            jFm.x/   F .x/j D jOEFm.x/ Fn.x/ C OEFn.x/ F .x/j
                             Ä jFm.x/ Fn.x/j C jFn.x/ F .x/j
                             Ä kFm FnkS C jFn.x/ F .x/j:

This and (4.4.2) imply that

            jFm.x/ F .x/j < C jFn.x/ F .x/j if n; m N:          (4.4.3)

Since limn!1 Fn.x/ D F .x/,

                             jFn.x/ F .x/j <

for some n N , so (4.4.3) implies that

                             jFm.x/ F .x/j < 2 if m N:

But this inequality holds for all x in S , so

                             kFm F kS Ä 2 if m N:

Since is an arbitrary positive number, this implies that fFng converges uniformly to F
on S.

   The next example is similar to Example 4.1.14.
                                        Section 4.4 Sequences and Series of Functions 241

Example 4.4.8 Suppose that g is differentiable on S D . 1; 1/ and             (4.4.4)
                                 jg0.x/j Ä r < 1; 1 < x < 1:

Let F0 be bounded on S and define

                 Fn.x/ D g.Fn 1 .x//; n 1:                                    (4.4.5)

We will show that fFng converges uniformly on S . We first note that if u and v are any two
real numbers, then (4.4.4) and the mean value theorem imply that

                 jg.u/ g.v/j Ä r ju vj:                                       (4.4.6)

Recalling (4.4.5) and applying this inequality with u D Fn 1.x/ and v D 0 shows that

jFn.x/j D jg.0/ C .g.Fn 1.x//           g.0//j Ä jg.0/j C jg.Fn 1.x//  g.0/j
          Ä jg.0/j C r jFn 1.x/jI

therefore, since F0 is bounded on S , it follows by induction that Fn is bounded on S for
n 1. Moreover, if n 1, then (4.4.5) and (4.4.6) with u D Fn.x/ and v D Fn 1.x/
imply that

jFnC1.x/ Fn.x/j D jg.Fn.x// g.Fn 1 .x//j Ä r jFn.x/ Fn 1.x/j; 1 < x < 1;

so                                      FnkS Ä r kFn  Fn 1kS :
                                 kFnC1

By induction, this implies that

                 kFnC1 FnkS Ä r nkF1 F0kS :                                   (4.4.7)

If n > m, then

kFn FmkS D k.Fn Fn 1/ C .Fn 1 Fn 2/ C C .FmC1 Fm/kS
                Ä kFn Fn 1kS C kFn 1 Fn 2kS C C kFmC1 FmkS ;

from Lemma 4.4.2. Now (4.4.7) implies that

kFn FmkS Ä kF1 F0kS .1 C r C r 2 C                    C r n m 1/r m

                 < kF1                          rm
                                        F0kS 1 r :

Therefore, if                              rN
                          kF1 F0kS 1 r < ;
then kFn FmkS <  if n, m N . Therefore, fFng converges uniformly on S , by
Theorem 4.4.6.
242 Chapter 4 Infinite Sequences and Series

Properties Preserved by Uniform Convergence

We now study properties of the functions of a uniformly convergent sequence that are
inherited by the limit function. We first consider continuity.

Theorem 4.4.7 If fFng converges uniformly to F on S and each Fn is continuous at
a point x0 in S; then so is F . Similar statements hold for continuity from the right and left:

Proof Suppose that each Fn is continuous at x0. If x 2 S and n 1, then

jF .x/  F .x0/j Ä jF .x/ Fn.x/j C jFn.x/ Fn.x0/j C jFn.x0/       F .x0/j  (4.4.8)
                 Ä jFn.x/ Fn.x0/j C 2kFn F kS :

Suppose that > 0. Since fFng converges uniformly to F on S , we can choose n so that
kFn F kS < . For this fixed n, (4.4.8) implies that

                   jF .x/ F .x0/j < jFn.x/ Fn.x0/j C 2 ; x 2 S:           (4.4.9)

Since Fn is continuous at x0, there is a i > 0 such that

                   jFn.x/ Fn.x0/j < if jx x0j < i;

so, from (4.4.9),

                   jF .x/ F .x0/j < 3 ; if jx x0j < i:

Therefore, F is continuous at x0. Similar arguments apply to the assertions on continuity
from the right and left.

Corollary 4.4.8 If fFng converges uniformly to F on S and each Fn is continuous on
S; then so is F I that is; a uniform limit of continuous functions is continuous.

   Now we consider the question of integrability of the uniform limit of integrable func-
tions.

Theorem 4.4.9 Suppose that fFng converges uniformly to F on S D OEa; b. Assume
that F and all Fn are integrable on OEa; b: Then

                   Zb                        Zb

                          F .x/ dx D lim Fn.x/ dx:                        (4.4.10)
                             n!1 a
                   a

Proof   Since
               Z b
                Fn.x/ dx  Z b  Z b
               a             F .x/ dx Ä jFn.x/            F .x/j dx
                                             a            F kS
                          a

                                             Ä .b a/kFn

and limn!1 kFn F kS D 0, the conclusion follows.
                                Section 4.4 Sequences and Series of Functions 243

   In particular, this theorem implies that (4.4.10) holds if each Fn is continuous on OEa; b,
because then F is continuous (Corollary 4.4.8) and therefore integrable on OEa; b.

   The hypotheses of Theorem 4.4.9 are stronger than necessary. We state the next theorem
so that you will be better informed on this subject. We omit the proof, which is inaccessible
if you skipped Section 3.5, and quite involved in any case.

Theorem 4.4.10 Suppose that fFng converges pointwise to F and each Fn is inte-
grable on OEa; b:

(a) If the convergence is uniform; then F is integrable on OEa; b and (4.4.10) holds.

(b) If the sequence fkFnkOEa;bg is bounded and F is integrable on OEa; b; then (4.4.10)
      holds.

    Part (a) of this theorem shows that it is not necessary to assume in Theorem 4.4.9 that F

is integrable on OEa; b, since this follows from the uniform convergence. Part (b) is known

as the bounded convergence theorem. Neither of the assumptions of (b) can be omitted.

Thus, in Example 4.4.3, where fkFnkOE0;1g is unbounded while F is integrable on OE0; 1,

         Z1                                              Z1

             Fn.x/ dx D 1; n 1; but                           F .x/ dx D 0:

         0                                                0

In Example 4.4.4, where kFnkOEa;b D 1 for every finite interval OEa; b, Fn is integrable for
all n 1, and F is nonintegrable on every interval (Exercise 4.4.3).

    After Theorems 4.4.7 and 4.4.9, it may seem reasonable to expect that if a sequence fFng

of  differentiable functions converges  uniformly to  F  on  S,  then  F0   D    limn!1  F0   on  S.

                                                                                           n

The next example shows that this is not true in general.

Example 4.4.9 The sequence fFng defined by

                                         Fn.x/ D xn sin xn 1 1
converges uniformly to F Á 0 on OEr1; r2 if 0 < r1 < r2 < 1 (or, equivalently, on every
compact subset of .0; 1/). However,

                 0        n1                1                       1
                 Fn.x/ D nx sin n 1 .n                    1/ cos xn 1 ;
                                        x

so fFn0 .x/g does not converge for any x in .0; 1/.

Theorem  4.4.11  Suppose  that  F0      is  continuous    on  OEa; b   for  all  n  1 and fFn0 g

                                  n

converges uniformly on OEa; b: Suppose also that fFn.x0/g converges for some x0 in OEa; b:

Then fFng converges uniformly on OEa; b to a differentiable limit function F; and

                    F 0.x/ D lim Fn0 .x/; a < x < b;                                     (4.4.11)

                                    n!1

while

         FC0 .a/ D lim Fn0 .aC/ and F 0 .b/ D lim Fn0 .b /:                              (4.4.12)
                    n!1                                       n!1
244 Chapter 4 Infinite Sequences and Series

Proof       Since  F0   is  continuous   on  OEa;  b,  we   can      write

                     n

                                                   Zx

                        Fn.x/ D Fn.x0/ C                      0  .t  /  d  t  ;      aÄx Äb                         (4.4.13)

                                                       x0  Fn

(Theorem 3.3.12). Now let

                                             L D lim Fn.x0/

                                                     n!1

and

                                         G.x/ D lim Fn0 .x/:                                                        (4.4.14)

                                                        n!1

Since  F0   is  continuous  and  fFn0 g  converges     uniformly                 to  G  on  OEa;  b,  G   is  continuous  on

         n

OEa; b (Corollary 4.4.8); therefore, (4.4.13) and Theorem 4.4.9 (with F and Fn replaced by
G and Fn0 ) imply that fFng converges pointwise on OEa; b to the limit function

                                                           Zx

                                 F .x/ D L C G.t/ dt:                                                               (4.4.15)

                                                            x0

The convergence is actually uniform          on OEa; b, since subtracting (4.4.13)                            from  (4.4.15)
yields
                                                                     Z        x                           
                  jF .x/ Fn.x/j Ä jL                                                                      
                                      Ä jL         Fn  .x0  /j  C                jG.t /     Fn.t/j dt0
                                                                     
                                                                        x0

                                                   Fn.x0/j C jx x0j kG                         0

                                                                                            Fn kOEa ;b ;

so

                   kF       FnkOEa;b Ä jL Fn.x0/j C .b                           a/kG          0

                                                                                            Fn kOEa ;b ;

where the right side approaches zero as n ! 1.

   Since G is continuous on OEa; b, (4.4.14), (4.4.15), Definition 2.3.6, and Theorem 3.3.11
imply (4.4.11) and (4.4.12).

Infinite Series of Functions

In Section 4.3 we defined the sum of an infinite series of constants as the limit of the
sequence of partial sums. The same definition can be applied to series of functions, as
follows.

Definition P4.4.12 If ffj g1 k is a sequence of real-valued functions defined on a set D
of reals, then j Dk 1 fj is an infinite series (or simply a series) of functions on D. The

                    P1
partial sums of , j Dk fj are defined by

                                                Xn
                                        Fn D fj ; n k:

                                                                    j Dk

If fFngk1 converges pointwise to a function F on a subset S of D, we say that j Dk P1 fj
converges pointwise to the sum F on S , and write

                                               X 1               x 2 S:
                                         F D fj ;

                                                  j Dk
                                            Section 4.4 Sequences and Series of Functions 245

If fFng converges uniformly to F on S , we say that j Dk P1 fj converges uniformly to F
on S.

Example 4.4.10 The functions
                                         fj .x/ D xj ; j 0;

define the infinite series               X 1
                                              xj

                                         j D0

on D D . 1; 1/. The nth partial sum of the series is

                            Fn.x/ D 1 C x C x2 C C xn;

or, in closed form,                    8 nC1
                                       <1 x
                            Fn.x/ D : 1 x ;              x ¤ 1;
                                                         xD1
                                         n C 1;

(Example 4.1.11). We have seen earlier that fFng converges pointwise to

                                                      1
                                         F .x/ D 1 x

if jxj < 1 and diverges if jxj 1; hence, we write

                            X 1 xj D 1 ;           1 < x < 1:
                            j D0 1 x

Since the difference                                 x nC1
                                         Fn.x/ D 1 x
                            F .x/

can be made arbitrarily large by taking x close to 1,

                            kF Fnk. 1;1/ D 1;

so the convergence is not uniform on . 1; 1/. Neither is it uniform on any interval . 1; r 

with 1 < r < 1, since                              1
                            kF Fnk. 1;r/ 2

for every n on every such interval. (Why?) The series does converge uniformly on any

interval OE r; r  with 0 < r < 1, since

                                                               r nC1
                                       kF FnkOE r;r D 1 r

and limn!1 r n D 0. Put another way, the series converges uniformly on closed subsets of
. 1; 1/.
246 Chapter 4 Infinite Sequences and Series

   As for series of constants, the convergence, pointwise or uniform, of a series of functions
is not changed by altering or omitting finitely many terms. This justifies adopting the
convention that we used for series of constants: when we are interested only in whether a
series of functions conPverges, and not in its sum, we will omit the limits on the summation
sign and write simply fn.

Tests for Uniform Convergence of Series

Theorem 4.4.6 is easily converted to a theorem on uniform convergence of series, as fol-
lows.

P Theorem 4.4.13 (Cauchy's Uniform Convergence Criterion) A series
   fn converges uniformly on a set S if and only if for each > 0 there is an integer N

such that

                    kfn C fnC1 C C fmkS < if m n N:                     (4.4.16)
                                                              P
Proof
         Apply Theorem 4.4.6 to the partial sums of fn, observing that
                           fn C fnC1 C C fm D Fm Fn 1:

   Setting m D n in (4.4.16) yields the following necessary, but not sufficient, condition
for uniform convergence of series. It is analogous to Corollary 4.3.6.

Corollary 4.4.14 If P fn converges uniformly on S; then limn!1 kfnkS D 0:

Theorem 4.4.13 leads immediately to the following important test for uniform conver-

gence of series.

Theorem 4.4.15 (Weierstrass's Test) The series P fn converges uniformly

on S if

        P         kfnkS Ä Mn; n k;                                      (4.4.17)
where Mn < 1:

Proof From Cauchy's convergence criterion for series of constants, there is for each
  > 0 an integer N such that

                        Mn C MnC1 C C Mm < if m n N;

which, because of (4.4.17), implies that

                    kfnkS C kfnC1kS C C kfmkS < if m; n N:
                                                       P

Lemma 4.4.2 and Theorem 4.4.13 imply that fn converges uniformly on S .
                                       Section 4.4 Sequences and Series of Functions 247

Example 4.4.11 Taking Mn D 1=n2 and recalling that

                                       X1
                                            n2 < 1;

we see that  X1                                         X sin nx

                                    x2 C n2 and n2

converge uniformly on . 1; 1/.

Example 4.4.12 The series

                                  X    fn.x/ D   X Â x Ãn

                                                        1Cx

converges uniformly on any set S such that

                                  x      

                                    1Cx    Ä  r  <  1;  x 2 S;    (4.4.18)
                                         

because if S is such a set, then

                                         kfnkS Ä r n

and Weierstrass's test applies, with

                                    X            X
                                       Mn D r n < 1:

Since (4.4.18) is equivalent to

                                    r            r
                                 1 C r Ä x Ä 1 r ; x 2 S;

this means that the series converges uniformly on any compact subset of . 1=2; 1/.
(Why?) From Corollary 4.4.14, the series does not converge uniformly on S D . 1=2; b/
with b < 1 or on S D OEa; 1/ with a > 1=2, because in these cases kfnkS D 1 for all
n.

   Weierstrass's test is very important, but applicable only to series that acPtually exhibit a
stronger kind of conPvergence than we have considered so far. We say that fn converges
aPbsolutely on S if jfnj converges pointwise on S , and absolutely uniformly on S if

   jfnj converges uniformly on S . We leave iPt to you (Exercise 4.4.21) to verify that our
proof of Weierstrass's test actually shows that fn converges absolutely uniformly on S .
We also leave it to you to show that if a series converges absolutely uniformly on S , then it
converges uniformly on S (Exercise 4.4.20).

   The next theorem applies to series that converge uniformly, but perhaps not absolutely
uniformly, on a set S .
248 Chapter 4 Infinite Sequences and Series

Theorem 4.4.16 (Dirichlet's Test for Uniform Convergence) The se-
ries

                                                 X 1
                                                      fngn

                                                nDk P                            fn/ con-
converges uniformly on S if ffng converges uniformly to zero on S; .fnC1
verges absolutely uniformly on S; and

                            kgk C gkC1 C C gnkS Ä M; n k;                        (4.4.19)
for some constant M:

Proof The proof is similar to the proof of Theorem 4.3.20. Let

                                    Gn D gk C gkC1 C  C gn;
and consider the partial sums of nDk P1 fngn:

                          Hn D fkgk C fkC1gkC1 C C fngn:                         (4.4.20)

By substituting

                 gk D Gk and gn D Gn Gn 1; n k C 1;

into (4.4.20), we obtain

             Hn D fk Gk C fkC1.GkC1 Gk/ C C fn.Gn Gn 1/;

which we rewrite as

Hn D .fk fkC1/Gk C .fkC1 fkC2/GkC1 C C .fn 1 fn/Gn 1 C fnGn;

or                        Hn D Jn 1 C fnGn;                                      (4.4.21)
where

Jn 1 D .fk fkC1/Gk C .fkC1 fkC2/GkC1 C C .fn 1 fn/Gn 1: (4.4.22)

That is, fJng is the sequence of partial sums of the series

                          X 1             fj C1/Gj :                             (4.4.23)
                              .fj

                          j Dk

From (4.4.19) and the definition of Gj ,

       X m                
                          
                                             X m
            OEfj .x/      fj C1.x/Gj .x/ Ä M jfj .x/         fj C1.x/j;  x 2 S;
       j Dn               

                                             j Dn
                               Section 4.4 Sequences and Series of Functions 249

so

    X m               fj C1/Gj              ÄM              X m  jfj fj C1j :
        .fj

                                   j Dn   S j Dn S

                                      P  fj C1/ converges absolutely uniformly on S , The-
Now suppose that > 0. Since .fj

orem 4.4.13 implies that there is an integer N such that the right side of the last inequality

is less than if m n N . The same is then true of the left side, so Theorem 4.4.13

implies that (4.4.23) converges uniformly on S .

   We have now shown that fJng as defined in (4.4.22) converges uniformly to a limit
function J on S . Returning to (4.4.21), we see that

                      Hn J D Jn 1 J C fnGn:

Hence, from Lemma 4.4.2 and (4.4.19),

                      kHn J kS Ä kJn 1 J kS C kfnkS kGnkS
                                     Ä kJn 1 J kS C M kfnkS :

Since fJn 1 J g and ffng converge uniformly to zero on S , it now follows that limn!1 kHn
J kS D 0. Therefore, fHng converges uniformly on S .

Corollary 4.4.17 The series nDk P1 fngn converges uniformly on S if
                               fnC1.x/ Ä fn.x/; x 2 S; n k;

ffng converges uniformly to zero on S; and

                      kgk C gkC1 C C gnkS Ä M; n k;

for some constant M:

    The proof is similar to that of Corollary 4.3.21. We leave it to you (Exercise 4.4.22).

Example 4.4.13 Consider the series

                                                X 1 sin nx
                                                nD1 n

with fn D 1=n (constant), gn.x/ D sin nx, and

                      Gn.x/ D sin x C sin 2x C C sin nx:

We saw in Example 4.3.21 that

                       1                                         (k D integer):
    jGn.x/j Ä j sin.x=2/j ; n 1; n ¤ 2k
250 Chapter 4 Infinite Sequences and Series

Therefore, fkGnkS g is bounded, and the series converges uniformly on any set S on which

sin x=2 is bounded away from zero. For example, if 0 < i < , then

                                     sin x  sin i
                                        2           2

if x is at least i away from any multiple of 2 ; hence, the series converges uniformly on

                           SD  [ 1   OE2k C i; 2.k C 1/ i:

                               kD 1

Since                      X  sin nx    

                                     n    D  1;     x¤k
                                        

(Exercise 4.3.32(b)), this result cannot be obtained from Weierstrass's test.

Example 4.4.14 The series               X 1 . 1/n

                                        nD1 n C x2

satisfies the hypotheses of Corollary 4.4.17 on . 1; 1/, with

       fn.x/ D n C x2 1 ; gn D . 1/n; G2m D 0; and G2mC1 D 1:

Therefore, the series converges uniformly on . 1; 1/. This result cannot be obtained by

Weierstrass's test, since           X1
                                         n C x2 D 1

for all x.

Continuity, Differentiability, and Integrability of Series

We can obtain results on the continuity, differentiability, and integrability of infinite series
by applying Theorems 4.4.7, 4.4.9, and 4.4.11 to their partial sums. We will state the
theorems and give some examples, leaving the proofs to you.

   Theorem 4.4.7 implies the following theorem (Exercise 4.4.23).

Theorem 4.4.18 If nDk P1 fn converges uniformly to F on S and each fn is contin-
uous at a point x0 in S; then so is F: Similar statements hold for continuity from the right
and left:

Example 4.4.15 In Example 4.4.12 we saw that the series

                               F .x/ D  X 1 Â x Ãn

                                        nD0  1Cx
                                         Section 4.4 Sequences and Series of Functions 251

converges uniformly on every compact subset of . 1=2; 1/. Since the terms of the series
are continuous on every such subset, Theorem 4.4.4 implies that F is also. In fact, we can
state a stronger result: F is continuous on . 1=2; 1/, since every point in . 1=2; 1/ lies
in a compact subinterval of . 1=2; 1/.

   The same argument and the results of Example 4.4.13 show that the function

                                                     X 1 sin nx
                                          G.x/ D n

                                                                            nD1

is continuous except perhaps at xk D 2k (k D integer).
   From Example 4.4.14, the function
                                      H.x/ D X 1 . 1/n 1
                                                 nD1 n C x2

is continuous for all x.

    The next theorem gives conditions that permit the interchange of summation and inte-

gration of infinite series. It follows from Theorem 4.4.9 (Exercise 4.4.25). We leave it to

you to formulate an analog of Theorem 4.4.10 for series (Exercise 4.4.26).

Theorem 4.4.19 Suppose that nDk P1 fn converges uniformly to F on S D OEa; b:
Assume that F and fn; n k; are integrable on OEa; b: Then

                               Zb              X 1 Z b

                                   F .x/ dx D           fn.x/ dx:

                               a nDk a

    We say in this case that nDk P1 fn can be integrated term by term over OEa; b.

Example 4.4.16 From Example 4.4.10,

                                 1 D X 1 xn;   1 < x < 1:
                               1 x nD0

The series converges uniformly, and the limit function is integrable on any closed subinter-

val OEa; b of . 1; 1/; hence,

                               Z b dx          X 1 Z b

                                                               n
                                         D              x dx;
                                   a 1 x nD0 a

so                                             X 1 bnC1 anC1

    log.1 a/ log.1 b/ D                                                       :
                                                                  nC1
                                               nD0

Letting a D 0 and b D x yields

    log.1                          x/ D  X 1 xnC1                 1 < x < 1:
                                                     ;

                                         nD0 n C 1
252 Chapter 4 Infinite Sequences and Series

   The next theorem gives conditions that permit the interchange of summation and differ-
entiation of infinite series. It follows from Theorem 4.4.11 (Exercise 4.4.28).

ThPeorem 4.4.20 Suppose that fn is continuously dPifferentiable on OEa; b for each n
k;     nDk 1 fnP.x0/ converges for some x0 in OEa; b; and              1    f0   converges  uniformly    on
               1                                                       nDk
               nDk                                                            n

OEa; b: Then        fn  converges  uniformly      on  OEa;  b  to  a  differentiable  function  F;  and

                                         X 1                a < x < b;
                              F 0.x/ D fn0.x/;

                                              nDk

while                         X 1                                      X 1

               F 0.aC/ D fn0.aC/ and F 0.b / D fn0.b /:

                              nDk                                      nDk

     We say in this case that nDk P1 fnPcan be differentiated term by term on OEa; b. To apply
Theorem 4.4.P20, we first verify that nDk 1 fn.x0/ converges for some x0 in OEa; b and then
differentiate  1    fn  term  by  term.  If  the  resulting    series  converges  uniformly,    then  term
               nDk

by term differentiation was legitimate.

Example 4.4.17 The series

                                       X 1 . 1/n 1 cos x                                            (4.4.24)
                                       nD1 n n

converges at x0 D 0. Differentiating term by term yields the series

                                   X 1 . 1/nC1 1 sin x                                              (4.4.25)
                                   nD1 n2 n

of continuous functions. This series converges uniformly on . 1; 1/, by Weierstrass's
test. By Theorem 4.4.20, the series (4.4.24) converges uniformly on every finite interval to
the differentiable function

                    F .x/ D X 1 . 1/n 1 cos x ;                1 < x < 1;
                              nD1 n n

and

                    F 0.x/ D X 1 . 1/nC1 1 sin x ;                    1 < x < 1:
                               nD1 n2 n

Example 4.4.18 The series

                                  X 1 xn                       x2 x3
                        E.x/ D nS D 1 C x C 2S C 3S C                                               (4.4.26)

                                  nD0
                                   Section 4.4 Sequences and Series of Functions 253

converges uniformly on every interval OE r; r  by Weierstrass's test, because

                              jxjn r n                jxj Ä r;
                               nS Ä nS ;

and
                                         X rn
                                              nS < 1

for all r , by the ratio test. Differentiating the right side of (4.4.26) term by term yields the

series                        X 1 xn 1                X 1 xn

                                   .n 1/S D nS ;
                              nD1                     nD0

which is the same as (4.4.26). Therefore, the differentiated series is also uniformly conver-
gent on OE r; r  for every r , so the term by term differentiation is legitimate and

                       E0.x/ D E.x/; 1 < x < 1:

This is not surprising if you recognize that E.x/ D ex.

Example 4.4.19 Failure to verify that the given series converges at some point can
lead to erroneous conclusions. For example, differentiating

                                   X 1 x                                       (4.4.27)
                                       cos n

                                   nD1

term by term yields

                                   X 1 1 x
                                          sin ;

                                   nD1 n n

which converges uniformly on OE r; r  for every r , since

                      1 x   sin  jxj  Ä 2

                       nn n                (Exercise 2.3.19)

                                    r
                                Ä n2 if jxj Ä r;

and P 1=n2 < 1. We cannot conclude from this that (4.4.27) converges uniformly on

OE r; r . In fact, it diverges for every x. (Why?)

                                4.4 Exercises

1. Find the set S on which fFng converges pointwise, and find the limit function.

        (a) Fn.x/ D xn.1 x2/                          (b) Fn.x/ D nxn.1 x2/
254 Chapter 4 Infinite Sequences and Series

(c) Fn.x/ D xn.1 xn/                                              Â 1Ã
                                             (d) Fn.x/ D sin 1 C n x
(e) Fn.x/ D  1 C xn                          (f ) Fn.x/ D n sin x

                       2n                                           n
             2 1 C x x Á
(g) Fn.x/ D n 1 cos                          (h) Fn.x/ D nxe nx2
                           n
                .x C n/2
(i) Fn.x/ D 2 2
             x Cn

2. Prove: If fFng converges to F on OEa; b and Fn is nondecreasing for each n, then F

is nondecreasing.

3. Show that the functions fFng of Example 4.4.4 are integrable and F D limn!1 Fn.x/
      is nonintegrable on every finite interval.

4. Prove Lemma 4.4.2.

5. Find F .x/ D limn!1 Fn.x/ on S . Show that fFng converges uniformly to F on
      closed subsets of S , but not on S .

(a) Fn.x/ D xn sin nx, S D . 1; 1/

(b) Fn.x/ D        1
                     2n , S D fx j x ¤ 1g
             1Cx

(c) Fn.x/ D  n2 sin x
                       2 , S D .0; 1/ HINT: See Exercise 2.3.19:
             1Cn x

6. (a) Show that if fFng converges uniformly on S , then fFng converges uniformly
             on every subset of S .

(b) Show that if fFng cSonverges uniformly on S1, S2, . . . , Sm, then fFng con-
      verges uniformly on kD1 m Sk.

(c) Give an example where fFng convergSes uniformly on each of an infinite se-
      quence of sets S1, S2, . . . , but not on kD1 1 Sk.

7. Describe the sets on which the sequences of Exercise 4.4.1 converge uniformly. Re-

strict your attention to sets that are the union of finitely many intervals and singleton

sets.

8. Suppose that fFng converges pointwise on OEa; b and, for each x in OEa; b, there is
      an open interval Ix containing x such that fFng converges uniformly on Ix \ OEa; b.
      Show that fFng converges uniformly on OEa; b.

9. Prove: If fFng converges uniformly to F on S , then limn!1 kFnkS D kF kS .

10. Prove: If fFng converges uniformly to F on S , then F is bounded on S if and only
        if limn!1fkFnkS g < 1.

11. Prove: If fFng and fGng converge uniformly to F and G on S , then fFn C Gng
        converges uniformly to F C G on S .

12. (a) Prove: If fFng and fGng converge uniformly to bounded functions F and G
               on S , then fFnGng converges uniformly to F G on S .
                                             Section 4.4 Sequences and Series of Functions 255

       (b) Give an example showing that the conclusion of (a) may fail to hold if F or
               G is unbounded on S .

13. (a) Suppose that fFng converges uniformly to F on .a; b/. Prove: If x0 < a < b
               and Ln D limx!x0 Fn.x/ exists (finite) for every n, then L D limn!1 Ln
               exists (finite) and
                                                     lim F .x/ D L:

                                                                          x!x0

(b) State similar results for limits from the right and left.

14. Find the limits.  nx                                        Z 2 dx
                    Z4  sin dx

(a) lim                                                (b) lim            2n
     n!1 Z11 x n                                            n!1 Z0 1 C x
                                                                   1      x Án
                                          2
(c) lim nxe nx dx                                      (d) lim        1 C dx
     n!1 0                                                  n!1 0         n

15. Prove (without using Theorem 4.4.10): If each Fn is integrable and fFng converges
                                                 Rb

        uniformly on OEa; b, then limn!1 a Fn.x/ dx exists.

16. Prove (without using Theorem 4.4.10): If each Fn is nondecreasing and fFng con-

verges uniformly to F on OEa; b, then

                                             Zb             Zb

                                             lim Fn.x/ dx D F .x/ dx:
                                             n!1 a
                                                            a

17. Use Weierstrass's test to determine sets on which the series converges absolutely

uniformly.                                                  X 1 Â x Ãn
     X 1 Â x Ãn                                        (b) n3=2 1 C x

(a) n1=2 1 C x

(c) X nxn.1 x/n                                        (d)  X1

                                                                n.x C n/2

(e)  X1                                                (f ) X .1      x2/n
                                                                       2 n sin nx
     nP  x                                                      .1 C x /

                                                    P           P
18. Show that if janj < 1, then an cos nx and an sin nx define continuous

functions on . 1; 1/.

19. (a) PGive an example showing that the following "comparison tePst" is invalid: If
                  fn converges uniformly on S and kgnkS Ä kfnkS , then gn converges

               uniformly on S .

       (b) This "comparison test" can be corrected by adding one word to its hypothesis
               and conclusion. What is the word?
                                                                                         P

20. (a) Explain the difference between the follP owing statements: (i) fn converges
             absolutely and uniformly on S ; (ii) fn converges absolutely uniformly
               on S.
256 Chapter 4 Infinite Sequences and Series

       (b) Show that if P fn converges absolutely uniformly on S , then P fn converges

               uniformly on S .
21. Show that the hypotheses of Weierstrass's test imply that P fn converges absolutely

        uniformly on S .

22. Prove Corollary 4.4.17.

23. Prove Theorem 4.4.18.

24. Suppose that fang1 1 is monotonic and limn!1 an D 0. Show that

                             X 1  an sin nx and  X 1  an cos nx

                             nD1                 nD1

define functions continuous for all x ¤ 2k (k D integer).

25. Prove Theorem 4.4.19.

26. Formulate an analog of Theorem 4.4.10 for series.

27. In Section 4.5 we will see that

            e x2 D X 1 . 1/n x2n X 1 and sin x D . 1/n x2nC1
                     nD0 nS                            nD0 .2n C 1/S

for all x, and in both cases the convergence is uniform on every finite interval. Find

series that converge to

            (a) F .x/ D e t2 Z x Z x dt and (b) G.x/ D sin t dt
                                                                 0t
                                  0

for all x.

28. Prove Theorem 4.4.20.
29. Show from Example 4.4.17 that nD1 P1 . 1/n sin.x=n/ converges uniformly on any

        finite interval.
                                                  Pk

30. P Prove: If 0 < anC1 < an and an < 1 for some positive integer k, then
           . 1/n sin anx converges uniformly on any finite interval.

31. For n 2, define

                       8             n C 1=n3/;  n 1=n3 Ä x Ä n;
                       ^^ n4.x       n 1=n3/;    n Ä x Ä n C 1=n3;
                       <                         jx nj > 1=n3;
            fn.x/ D n4.x
                       ^^:

                         0;

and let F .x/ D nD2 P1 fn.x/. Show that R0 R 1 F .x/ dx < 1, and conclude that ab-
solute convergence of an improper integral 01 F .x/ dx does not imply that limn!1 F .x/ D
0, even if F is continuous on OE0; 1/.
                                                       Section 4.5 Power Series 257

4.5 POWER SERIES

We now consider a class of series sufficiently general to be interesting, but sufficiently
specialized to be easily understood.

Definition 4.5.1 An infinite series of the form

                               X 1       x0 /n ;                               (4.5.1)
                                   an.x

                               nD0

where x0 and a0, a1, . . . , are constants, is called a power series in x x0.

The following theorem summarizes the convergence properties of power series.

Theorem 4.5.2 In connection with the power series (4.5.1); define R in the extended

reals by

                               1 D lim janj1=n:                                (4.5.2)
                               R n!1

In particular; R D 0 if limn!1 janj1=n D 1, and R D 1 if limn!1 janj1=n D 0: Then
the power series converges

(a) only for x D x0 if R D 0I

(b) for all x if R D 1; and absolutely uniformly in every bounded setI

(c) for x in .x0 R; x0 C R/ if 0 < R < 1; and absolutely uniformly in every closed
      subset of this interval.

The series diverges if jx x0j > R: No general statement can be made concerning conver-
gence at the endpoints x D x0 C R and x D x0 R W the series may converge absolutely
or conditionally at both; converge conditionally at one and diverge at the other; or diverge
at both:

Proof     In any case, the series (4.5.1) converges to a0 if x D x0. If
                                          X
                                               janjr n < 1                     (4.5.3)

for some r > 0, then P an.x x0/n converges absolutely uniformly in OEx0 r; x0 C
r , by Weierstrass's test (Theorem 4.4.15) and Exercise 4.4.21. From Cauchy's root test
(Theorem 4.3.17), (4.5.3) holds if

                                lim .janjr n/1=n < 1;

                               n!1

which is equivalent to

                               r lim janj1=n < 1

                                  n!1

(Exercise 4.1.30(a)). From (4.5.2), this can be rewritten as r < R, which proves the
assertions concerning convergence in (b) and (c).

If 0 Ä R < 1 and jx x0j > R, then
258 Chapter 4 Infinite Sequences and Series

                                 1      >     1        ;

                                 R jx x0j

so (4.5.2) implies that

         janj1=n            1                             jan.x x0/nj 1
                                     and therefore         x0/n diverges (Corollary 4.3.6) if
                         jx x0j
                                              P
for infinitely many values of n. Therefore, an.x

jx x0j > R. In particular, the series diverges for all x ¤ x0 if R D 0.

To prove the assertions concerning the possibilities at x D x0 C R and x D x0 R

requires examples, which follow. (Also, see Exercise 4.5.1.) P                  x0/n. If
   The number R defined by (4.5.2) is the radius of convergence of an.x

R > 0, the open interval .x0 R; x0 C R/, or . 1; 1/ if R D 1, is the interval of

convergence of the series. Theorem 4.5.2 says that a power series with a nonzero radius

of convergence converges absolutely uniformly in every compact subset of its interval of

convergence and diverges at every point inPthe exterior of this interval. On this last we can
make a stronger statement: Not only does an.x x0/n diverge if jx x0j > R, but the
sequence fan.x x0/ng is unbounded in this case (Exercise 4.5.3(b)).

Example 4.5.1 For the series

                              n X sin n =6 .x 1/n;
                                       2

we have

                         1=n Â j sin n =6 Ã1=n
         lim janj D lim
         n!1             n!1            2  n

                            1                 =6j/1=n     (Exercise 4.1.30(a))
                         D lim .j sin n

                            2 n!1

                         1       1
                         D 2 .1/ D 2 :

Therefore, R D 2 and Theorem 4.5.2 implies that the series converges absolutely uniformly
in closed subintervals of . 1; 3/ and diverges if x < 1 or x > 3. Theorem 4.5.2 does not
tell us what happens when x D 1 or x D 3, but we can see that the series diverges in both
these cases since its general term does not approach zero.

Example 4.5.2 For the series               X xn

                                              n  ;

              1=n Â 1 Ã1=n                                Â 1 1 0 Ã
         lim janj D lim                       D lim exp log D e D 1:
         n!1             n!1 n                n!1         nn

Therefore, R D 1 and the series converges absolutely uniformly in cPlosed subintervals
of . 1; 1/ and diverges if jxj > 1. For x D 1 the serPies becomes . 1/n=n, which
converges conditionally, and at x D 1 the series becomes 1=n, which diverges.
                                                        Section 4.5 Power Series 259

   The next theorem provides an expression for R that, if applicable, is usually easier to use
than (4.5.2).

Theorem 4.5.3 The radius of convergence of P an.x            x0/n is given by
                                                         

                                            1 D lim  a nC1 
                                           R n!1 an

if the limit exists in the extended reals:

Proof  From Theorem 4.5.2, it suffices to show that if
                                                   
                                                                               (4.5.4)
                                      L D lim  a nC1 
                                            n!1 an

exists in the extended reals, then

                                    L D lim janj1=n:                           (4.5.5)

                                             n!1

We will show that this is so if 0 < L < 1 and leave the cases where L D 0 or L D 1 to
you (Exercise 4.5.7).

   If (4.5.4) holds with 0 < L < 1 and 0 < < L, there is an integer N such that
                                        

                             L <  am  C1  < L C if m N;
                                           am

so
                      jamj.L / < jamC1j < jamj.L C / if m N:

By induction,

               jaN j.L /n N < janj < jaN j.L C /n N if n > N:

Therefore, if

               K1 D jaN j.L / N and K2 D jaN j.L C / N ;

then                                                                           (4.5.6)
                             K11=n.L / < janj1=n < K21=n.L C /:

Since limn!1 K1=n D 1 if K is any positive number, (4.5.6) implies that

               L Ä lim janj1=n Ä lim janj1=n Ä L C :
                                            n!1
                        n!1

Since is an arbitrary positive number, it follows that

                                     lim janj1=n D L;

                                    n!1

which implies (4.5.5).
260 Chapter 4 Infinite Sequences and Series

Example 4.5.3 For the power series

                                          X xn  ;

                                           nS

      lim  a nC1  D lim                    nS            D lim  1  D 0:

      n!1 an                  n!1 .n C 1/S n!1 n C 1

Therefore, R D 1; that is, the series converges for all x, and absolutely uniformly in every
bounded set.

Example 4.5.4 For the power series
                                                X nSxn;

            
      lim  an  C1  .n C 1/S  D lim D lim .n C 1/ D 1:
      n!1 an                  n!1 nS                     n!1

Therefore, R D 0, and the series converges only if x D 0.

Example 4.5.5 Theorem 4.5.3 does not apply directly to

                              X . 1/n 2n   (p D constant);                   (4.5.7)
                                   4nnp x

which has infinitely many zero coefficients (of odd powers of x).     However, by setting
                                                                                      (4.5.8)
y D x2, we obtain the series  X . 1/n yn;
                                   4n np

which has nonzero coefficients for which
    
      anC1                    4n np                      1 Â 1Ã p 1
lim          D lim nC1                         p D lim 1 C               D:
n!1 an        n!1 4 .n C 1/                              4 n!1     n     4

Therefore, (4.5.8) converges if jyj < 4 and diverges if jyj > 4. Setting y D x2, we
conclude becomes Pthat (4.5.7) converges if jxj < 2 and diverges if jxj > 2. At x D 2, (4.5.7) . 1/n=np, which diverges if p Ä 0, converges conditionally if 0 < p Ä 1, and
converges absolutely if p > 1.

Properties of Functions Defined by Power Series

We now study the properties of functions defined by power series. Henceforth, we consider
only power series with nonzero radii of convergence.

Theorem 4.5.4 A power series

                                        X 1              x0/n
                              f .x/ D an.x

                                             nD0
                                                                   Section 4.5 Power Series 261

with positive radius of convergence R is continuous and differentiable in its interval of
convergence; and its derivative can be obtained by differentiating term by termI that is;

                X 1                               x0/n 1;                                (4.5.9)
     f 0.x/ D nan.x

                     nD1

which can also be written as                                       x0/n :            (4.5.10)
                                            X 1

                                f 0.x/ D .n C 1/anC1 .x

                                                              nD0

This series also has radius of convergence R:

Proof First, the series in (4.5.9) and (4.5.10) are the same, since the latter is obtained
by shifting the index of summation in the former. Since

lim ..n C 1/janj/1=n D lim .n C 1/1=njanj1=n
n!1  n!1 Á Á

     D lim .n C 1/1=n lim janj1=n (Exercise 4.1.30(a)/
     Än!1 Â                                       n!1
                                                                           Á0
                                                      Ã
     D lim exp log.n C 1/ lim janj1=n D e D 1 ;
     n!1                                       n                   n!1               RR

the radius of convergence of the power series in (4.5.10) is R (Theorem 4.5.2). Therefore,
the power series in (4.5.10) converges uniformly in every interval OEx0 r; x0 C r  such that
0 < r < R, and Theorem 4.4.20 now implies (4.5.10) for all x in .x0 R; x0 C R/.

   Theorem 4.5.4 can be strengthened as follows.

Theorem 4.5.5 A power series

               X 1                                x0/n
     f .x/ D an.x

                    nD0

with positive radius of convergence R has derivatives of all orders in its interval of convergence;
which can be obtained by repeated term by term differentiationI thus;

                   X 1        .n k C 1/an.x                                x0/n k :  (4.5.11)
     f .k/.x/ D n.n 1/

                         nDk

The radius of convergence of each of these series is R:

Proof The proof is by induction. The assertion is true for k D 1, by Theorem 4.5.4.
Suppose that it is true for some k 1. By shifting the index of summation, we can rewrite
(4.5.11) as

                    X 1
      f .k/.x/ D .n C k/.n C k 1/ .n C 1/anCk .x x0/n; jx x0j < R:

                             nD0
262 Chapter 4 Infinite Sequences and Series

Defining                 bn D .n C k/.n C k 1/ .n C 1/anCk ;               (4.5.12)
we rewrite this as
                                      X 1
                        f .k/.x/ D bn.x x0/n; jx x0j < R:

                                            nD0

By Theorem 4.5.4, we can differentiate this series term by term to obtain

                                     X 1
                    f .kC1/.x/ D nbn.x x0/n 1; jx x0j < R:

                                            nD1

Substituting from (4.5.12) for bn yields

                     X 1
    f .kC1/.x/ D .n C k/.n C k 1/ .n C 1/nanCk .x x0/n 1; jx x0j < R:

                            nD1

Shifting the summation index yields

    f .kC1/.x/ D        X 1    n.n 1/     .n k/an.x  x0/n k 1 ; jx         x0j < R;

                        nDkC1

which is (4.5.11) with k replaced by k C 1. This completes the induction.

Example 4.5.6 In Example 4.4.10 we saw that

                                   1 D X 1 xn;  jxj < 1:
                                 1 x nD0

Repeated differentiation yields

                    kS         X 1           .n k C 1/xn k
    .1 x/kC1 D n.n 1/
                               nDk

                           X 1                                jxj < 1;
                        D .n C k/.n C k 1/ .n C 1/xn;

                               nD0

so                                        !

          1                    X 1 n C k n
    .1 x/kC1 D                      k x ; jxj < 1:
                               nD0

Example 4.5.7 By the method of Example 4.5.5, it can be shown that the series

    S.x/ D X 1 . 1/n x2nC1 X 1 and C.x/ D . 1/n x2n
                        nD0 .2n C 1/S                     nD0 .2n/S
                                                       Section 4.5 Power Series 263

converge for all x. Differentiating yields                            S.x/:
                                  S 0.x/ D X 1 . 1/n xn D C.x/
                                             nD0 .2n/S

and
              C 0.x/ D X 1 . 1/n x2n 1 D X 1 . 1/n x2nC1 D
                         nD1 .2n 1/S nD0 .2n C 1/S

These results should not surprise you if you recall that

                                S.x/ D sin x and C.x/ D cos x:

(We will soon prove this.)

Theorem 4.5.5 has two important corollaries.

Corollary 4.5.6 If

                                 X 1                   x0j < R;
                       f .x/ D an.x x0/n; jx

                                      nD0

then                                     f .n/.x0/

                                  an D   nS         :

Proof Setting x D x0 in (4.5.11) yields

                                  f .k/.x0/ D kSak:

Corollary 4.5.7 (Uniqueness of Power Series) If

                       X 1                  X 1        x0/n                    (4.5.13)
                            an.x  x0/n D bn.x                                  (4.5.14)

                       nD0                      nD0                            (4.5.15)

for all x in some interval .x0 r; x0 C r /; then

                             an D bn; n 0:

Proof Let

                       X 1                             X 1
           f .x/ D an.x x0/n and g.x/ D bn.x                          x0 /n :

                       nD0                             nD0

From Corollary 4.5.6,

                       an D  f .n/.x0/   and bn D      g.n/ .x0 /  :

                             nS                        nS
264 Chapter 4 Infinite Sequences and Series

From (4.5.13), f D g in .x0 r; x0 C r /. Therefore,
                                   f .n/.x0/ D g.n/.x0/; n 0:

This and (4.5.15) imply (4.5.14).
   Theorems 4.4.19 and 4.5.2 imply the following theorem. We leave the proof to you

(Exercise 4.5.15).

Theorem 4.5.8 If x1 and x2 are in the interval of convergence of

                                       X 1       x0 /n ;
                             f .x/ D an.x

                                           nD0

then Z x2                    X 1 an .x2 x0/nC1 .x1 x0/nC1 I

                 f .x/ dx D  nD0 n C 1

x1

that is; a power series may be integrated term by term between any two points in its interval
of convergence:

Example 4.5.16 presents an application of this theorem.

Taylor's Series

So far we have asked for what values of x a given power series converges, and what are

the properties of its sum. Now we ask a related question: What properties guarantee that a

given function f can be represented as the sum of a convergent power series in x x0? A

partial answer to this question is provided by what we already know: Theorem 4.5.5 tells us

that f must have derivatives of all orders in some neighborhood of x0, and Corollary 4.5.6

tells us that the only power series in x x0 that can possibly converge to f in such a

neighborhood is              X 1 f .n/.x0/
                                             .x
                                                 x0 /n :          (4.5.16)
                             nD0 nS

This is called the Taylor series of f about x0 (also, the Maclaurin series of f , if x0 D 0).
The mth partial sum of (4.5.16) is the Taylor polynomial

                             X m f .n/.x0/         x0 /n ;
                 Tm.x/ D                       .x
                                        nS
                             nD0

defined in Section 2.5.

   The Taylor series of an infinitely differentiable function f may converge to a sum dif-
ferent from f . For example, the function

                 f .x/ D e 1=x2 ; x ¤ 0;
                                    0;           x D 0;
                                                                 Section 4.5 Power Series 265

is infinitely differentiable on . 1; 1/ and f .n/.0/ D 0 for n           0 (Exercise 2.5.1), so its
Maclaurin series is identically zero.

The answer to our question is provided by Taylor's theorem (Theorem 2.5.4), which

says that if f is infinitely differentiable on .a; b/ and x and x0 are in .a; b/ then, for every

integer n 0,

              f .x/                Tn.x/ D     f .nC1/.cn/  .x   x0/n 1;                  (4.5.17)

                                                 .n C 1/S

where cn is between x and x0. Therefore,

                             f .x/ D      X 1 f .n/.x0/         x0/n
                                                        .x
                                          nD0    nS

for an x in .a; b/ if and only if

                       lim f .nC1/.cn/ .x               x0/nC1 D 0:
                      n!1 .n C 1/S

It is not always easy to check this condition, because the sequence fcng is usually not pre-
cisely known, or even uniquely defined; however, the next theorem is sufficiently general
to be useful.

Theorem 4.5.9 Suppose that f is infinitely differentiable on an interval I and

                                    lim r kf n .n/kI D 0:                                 (4.5.18)
                                   n!1 nS

Then; if x0 2 I 0; the Taylor series

                                   X 1 f .n/.x0/           x0/n
                                                   .x

                                   nD0 nS

converges uniformly to f on

                                   Ir D I \ OEx0 r; x0 C r :

Proof From (4.5.17),

              kf TnkIr Ä           r nC1     kf  .nC1/  kIr Ä   r nC1    kf  .nC1/  kI ;

                                   .n C 1/S                    .n C 1/S

so (4.5.18) implies the conclusion.

Example 4.5.8 If f .x/ D sin x, then kf .k/k. 1;1/ D 1; k                    0. Since

                                          rn            0<r <1
                                    lim D 0;
                                   n!1 nS
266 Chapter 4 Infinite Sequences and Series

(Example 4.1.12), (4.5.18) holds for all r . Since
                     f .2m/.0/ D 0 and f .2mC1/.0/ D . 1/m; m 0;

we see from Theorem 4.5.9, with I D . 1; 1/, x0 D 0, and r arbitrary, that

                     X 1 sin x D . 1/n x2nC1 ;                                 1 < x < 1;
                               nD0 .2n C 1/S

and the convergence is uniform on bounded sets.
   A similar argument shows that

                     X 1 cos x D . 1/n x2n ;                                   1 < x < 1;
                               nD0 .2n/S

with uniform convergence on bounded sets.

Example 4.5.9 If f .x/ D ex, then f .k/.x/ D ex and kf .k/kI D er, k 0, if

I D OE r; r . Since             lim r n er D 0;
                               n!1 nS

we conclude as in Example 4.5.8 that

                          x X 1 xn                                       1 < x < 1;
                         e D nS ;

                                   nD0

with uniform convergence on bounded sets.

Example 4.5.10 If f .x/ D .1 C x/q , then

                            !                                                                   !
       f .n/.x/ D q .1 C x/q n; so                                             f .n/.0/ q
                     nS     n                                                                      (4.5.19)
                                                                                  nS D n

(Example 2.5.3). The Maclaurin series                                     !
                                               X 1                       q xn
                                                                         n
                                                                    nD0

is called the binomial series. We saw in Example 2.5.3 that this series equals .1 C x/q for

all x if q is a nonnegative integer. We will now show that if q is an arbitrary real number,

then X 1 q!                 xn D f .x/ D .1 C x/q; 0 Ä x < 1:                                      (4.5.20)

                     nD0 n

Since
                                                               Section 4.5 Power Series 267

 lim  q                       !                     !       q n   
                                                      
                                                    q             
                                                      D lim        D 1;
n!1  n C 1                                          n  n!1 n C 1

the radius of convergence of the series in (4.5.20) is 1. From (4.5.19),

                                                            !
kf .n/kOE0;1 Ä OEmax.1; 2q  /  q  ; n 0:
                          nS                               n

Therefore, if 0 < r < 1,

lim r n  kf .n/kOE0;1 Ä OEmax.1; 2q/ lim                          !
                                                                 q  r n D 0;
n!1 nS                                                     n!1   n

where the last equality follows from the absolute convergence of the series in (4.5.20) on
. 1; 1/. Now Theorem 4.5.9 implies (4.5.20).

We cannot prove in this way that the binomial series converges to .1 C x/q on . 1; 0/.

This requires a form of the remainder in Taylor's theorem that we have not considered, or

a different kind of proof altogether (Exercise 4.5.20). The complete result is that

                                         X 1         !     1 < x < 1;                (4.5.21)
                          .1 C x/q D                q xn;
                                                    n
                                               nD0

for all q, and, as we said earlier, the identity holds for all x if q is a nonnegative integer.

Arithmetic Operations with Power Series

We now consider addition and multiplication of power series, and division of one by an-
other.

   We leave the proof of the next theorem to you (Exercise 4.5.21).

Theorem 4.5.10 If                                                                    (4.5.22)
                                                                                     (4.5.23)
                                      X 1
                           f .x/ D an.x x0/n; jx x0j < R1;

                                                      nD0

                                      X 1
                            g.x/ D bn.x x0/n; jx x0j < R2;

                                                      nD0

and  and  are constants; then

                                       X 1
               f .x/ C g.x/ D .an C bn/.x x0/n; jx x0j < R;

                                                        nD0

where R minfR1; R2g:
268 Chapter 4 Infinite Sequences and Series

Theorem 4.5.11 If f and g are given by (4.5.22) and (4.5.23); then

                                  X 1            x0/n; jx x0j < R;              (4.5.24)
                  f .x/g.x/ D cn.x
where                                               Xn
                                         nD0   r D an r br

                                  Xn                   r D0
                           cn D ar bn

                                         r D0

and R minfR1; R2g:

Proof Suppose that R1 Ä R2. Since the series (4.5.22) and (4.5.23) converge abso-

lutely to f .x/ and g.x/ if jx x0j < R1, their Cauchy product converges to f .x/g.x/ if

jx x0j < R1, by Theorem 4.3.29. The nth term of this product is

       Xn         x0/r bn r .x  x0/n r D       Xn !                x0/n D cn.x  x0/n :
           ar .x                                   ar bn r .x

       r D0                                    r D0

Example 4.5.11 If

                    f .x/ D 1 D X 1 xn;               jxj < 1;
                              1 x nD0

and
                                            X 1

                                  g.x/ D bnxn; jxj < R;

                                                              nD0

then

                    g.x/ D X 1 snxn;           jxj < minf1; Rg;
                    1 x nD0

where

                    sn D .1/b0 C .1/b1 C C .1/bn
                       D b0 C b1 C C bn:

Example 4.5.12 From the paragraph following Example 4.5.10,

                                   X 1          !     jxj < 1;
                    .1 C x/p D                 p xn;
                                               n
                                          nD0

and X 1 q!                                           xn; jxj < 1:
                    .1 C x/q D
                                nD0 n
                                                                              Section 4.5 Power Series 269

Since                                               X 1                                      !
       .1 C x/p.1 C x/q D .1 C x/pCq D                                                p C q xn;

                                                                                 nD0    n

while the Cauchy product is nD0 P1 cnxn, with                                 !
                                                n!                        q
                                              Xp
                                                                                ;
                                       cn D r                           nr

                                                                  r D0

Corollary 4.5.7 implies that                       !
                                            pCq :
                                      cn D
                                              n

This yields the identity             !       n!                             !
valid for all p and q.        pCq           Xp                          q
                              nD                                                      ;
                                            r D0                        r nr

   The quotient                                 h.x/                                             (4.5.25)
of two power series                   f .x/ D g.x/                                               (4.5.26)

                                      X 1
                            h.x/ D cn.x x0/n; jx x0j < R1;

                                                      nD0

and
                                      X 1

                            g.x/ D bn.x x0/n; jx x0j < R2;

                                                      nD0

can be represented as a power series

                                        X 1                             x0/n
                              f .x/ D an.x

                                             nD0

with a positive radius of convergence, provided that

                                      b0 D g.x0/ ¤ 0:

This is surely plausible. Since g.x0/ ¤ 0 and g is continuous near x0, the denominator
of (4.5.25) differs from zero on an interval about x0. Therefore, f has derivatives of all
orders on this interval, because g and h do. However, the proof that the Taylor series of f
about x0 converges to f near x0 requires the use of the theory of functions of a complex
variable. Therefore, we omit it. However, it is straightforward to compute the coefficients
in (4.5.26) if we accept the validity of the expansion. Since

                              f .x/g.x/ D h.x/;
270 Chapter 4 Infinite Sequences and Series

Theorem 4.5.11 implies that

                             Xn
                                 ar bn r D cn; n 0:

                             r D0

Solving these equations successively yields

                      a0 D c0 ;
                             b0 !

                                              n1
                             1           X
                      an D           cn      bn r ar ; n 1:
                             b0 r D0

   It is not worthwhile to memorize these formulas. Rather, it is usually better to view the
procedure as follows: Multiply the series f (with unknown coefficients) and g according
to the procedure of Theorem 4.5.11, equate the resulting coefficients with those of h, and
solve the resulting equations successively for a0, a1, . . . .

Example 4.5.13 Suppose that we wish to find the coefficients in the Maclaurin series
                                  tan x D a0 C a1x C a2x2 C :

We first observe that since tan x is an odd function, its derivatives of even order vanish at
x0 D 0, so a2m D 0, m 0. Therefore,

                                tan x D a1x C a3x3 C a5x5 C :

Since                                          sin x
it follows from Example 4.5.8 that   tan x D cos x ;

            a1x C a3x3 C a5x5 C                 x     x3 x5
                                             D        6 C 120 C
                                                      x2 x4
                                                 1     2 C 24 C

so

            3 5 Â x2 x4 Ã                                     x3 x5
    .a1x C a3x C a5x C / 1 2 C 24 C D x 6 C 120 C ;

or, according to Theorem 4.5.11,

    a a1 Á 1x C a3 x3 C a a3 a1 Á 5 C x5 C D x x3 C x5 C :
            2                            2 24                 6 120

From Corollary 4.5.7, coefficients of like powers of x on the two sides of this equation
must be equal; hence,

   a1 D 1;  a3 a1                 1                   a5 a3 C a1 D 1 ;
                   2         D 6;                            2 24 120
so
   a1 D 1;  11                    1               1 1 Â1Ã  1     2
            a3 D 6 C 2 .1/ D 3 ;         a5 D 120 C 2 3    24 .1/ D 15 :
                                                 Section 4.5 Power Series 271

Therefore,                    tan x D x C x3 C 2 x5 C :
                                               3 15

Example 4.5.14 To find the reciprocal of the power series

                              g.x/ D 1 C ex D 2 C X 1 xn ;
                                                          nD1 nS

we let h D 1 in (4.5.25). If       1 X 1
                                        D anxn;

                                 g.x/ nD0

then

                                             Â                    x2 x3 Ã

            1 D .a0 C a1x C a2x C a3x C / 2 C x C 2 C 6 C23

            D 2a a0 Á 0 C .a0 C 2a1/x C C a1 C 2a2 x2
                                    2
            a0 a1                   Á

                                          3
            C 6 C 2 C a2 C 2a3 x C :

From Corollary 4.5.7,

                                                   2a0 D 1;
                                            a0 C 2a1 D 0;
                                     a0 C a1 C 2a2 D 0;
                                      2
                              a0 C a1 C a2 C 2a3 D 0:
                              62

Solving these equations successively yields

            a0 D       1
            a1 D        ;
            a2 D
            a3 D       2

                       a0 D 1 ;
                       2      4
                                 Á     1 Â1 1Ã
                       1 a0
                       2 2 C a1 D 2 4 4 D 0;
                                    Á 1Â1 1 Ã 1
                       1 a0 a1
                       2 6 C 2 C a2 D 2 12 8 C 0 D 48 ;

so                                  1 x x3

                              1
                              1 C ex D 2 4 C 48 C :
272 Chapter 4 Infinite Sequences and Series

Example 4.5.15 To find the reciprocal of

                                    g.x/ D ex D X 1 xn ;                    (4.5.27)
                                                     nD0 nS

we again let h D 1 in (4.5.25). If

                                                X 1
                                    .ex / 1 D anxn;

                                                      nD0

then                          X 1 ! X 1 xn ! X 1

                        1D          an x n           D cnxn;
                              nD0 nD0 nS nD0

where                                       Xn ar

                                    cn D                    :
                                                  .n r /S
                                            r D0

From Corollary 4.5.7, c0 D a0 D 1 and cn D 0 if n 1; hence,

                              an D     nX1 ar
                                                       ; n 1:               (4.5.28)
                                             .n r /S
                                       r D0

Solving these equations successively for a0, a1, . . . yields

       a1 D             1
       a2 D               (4.5.1) D 1;
       a3 D             1ÄS                       1
       a4 D                1        1
                           2S .1/ C 1S . 1/ D 2 ;
                        Ä1 1                      1 Â1Ã 1
                           3S .1/ C 2S . 1/ C 1S 2 D 6
                        Ä1 1                      1 Â1Ã 1 Â 1Ã 1
                           4S .1/ C 3S . 1/ C 2S 2 C 1S 6 D 24 :

From this, we see that

                                              . 1/k
                                       ak D kS

for 0 Ä k Ä 4 and are led to conjecture that this holds for all k. To prove this by induction,

we assume that it is so for 0 Ä k Ä n 1 and compute from (4.5.28):

       an D                   X n 1 1 . 1/r
          D
                              r D0  .n r /S r S
                                             !
                              1 nX1 r n
                                    . 1/             (Exercise 1.2.19(a))
                              nS rD0 r               (Exercise 1.2.19(b)):

                           . 1/n
                        D nS
                                                                                    Section 4.5 Power Series 273

Thus, we have shown that  .ex / 1 D X 1 . 1/n xn :
                                      nD0 nS

Since this is precisely the series that results if x is replaced by                             x in (4.5.27), we have
verified a fundamental property of the exponential function: that

                                      .ex / 1 D e x:

This also follows from Example 4.3.26.

Abel's Theorem

From Theorem 4.5.4, we know that a function f defined by a convergent power series

                                X 1                                                             (4.5.29)
                      f .x/ D an.x x0/n; jx x0j < R;

                                     nD0

is continuous in the open interval .x0 R; x0CR/. The next theorem concerns the behavior
of f as x approaches an endpoint of the interval of convergence.

Theorem 4.5.12 (Abel's Theorem) Let f be defined by a power series (4.5.29)

with finite radius of convergence R:
P1
(a) If nD0 anR converges; thenn

                              lim                  X 1
                                         f .x/ D anRn:
                          x!.x0 CR/
                                                       nD0

(b) If nD0 P1 . 1/nanRn converges; then

                                         X 1                                        1/n anRn :
                          lim f .x/ D .
                          x!.x0 R/C
                                         nD0

Proof We consider a simpler problem first. Let

                                                       X 1
                                             g.y/ D bnyn

                                                                               nD0

and
                                           X 1
                                                bn D s (finite):

                                                              nD0

We will show that

                                       lim g.y/ D s:                                            (4.5.30)

                                      y!1
274 Chapter 4 Infinite Sequences and Series

From Example 4.5.11,          g.y/ D .1      X 1                              (4.5.31)
where                                     y/ snyn;                            (4.5.32)

                                              nD0

                              sn D b0 C b1 C C bn:

Since

         1 D X 1 yn        and therefore  1 D .1        X 1         jyj < 1;
       1 y nD0                                       y/ yn;

                                                         nD0

we can multiply through by s and write

                              s D .1      X 1        jyj < 1:
                                       y/ syn;

                                           nD0

Subtracting this from (4.5.31) yields

                     g.y/     s D .1      X 1     s/yn;     jyj < 1:
                                       y/ .sn

                                           nD0

If > 0, choose N so that

                              jsn sj < if n N C 1:

Then, if 0 < y < 1,

       jg.y/         sj Ä .1     X N      sjyn C .1     y/     X 1  jsn sjyn
                       < .1   y/ jsn      sjyn C .1
                       < .1               sj C ;            nDN C1
                                  nD0
                                                                    X 1
                                 X N                    y/ yN C1 yn
                              y/ jsn
                                                                    nD0
                                  nD0

                                 X N
                              y/ jsn

                                  nD0

because of the second equality in (4.5.32). Therefore,

                                       jg.y/ sj < 2

if
                                                 X N

                                       .1 y/ jsn sj < :

                                                                      nD0

This proves (4.5.30).
  To obtain (a) from this, let bn D anRn and g.y/ D f .x0 C Ry/; to obtain (b), let

bn D . 1/nanRn and g.y/ D f .x0 Ry/.
                                                      Section 4.5 Power Series 275

Example 4.5.16 The series

                       f .x/ D 1 D X 1 . 1/nxn
                                 1 C x nD0

diverges at x D 1, while limx!1 f .x/ D 1=2. This shows that the converse of Abel's
theorem is false. Integrating the series term by term yields

          X 1 log.1 C x/ D . 1/n xnC1 ;               jxj < 1;
                           nD0 n C 1

where the power series converges at x D 1, and Abel's theorem implies that

                                     X 1 . 1/nC1
                            log 2 D                :
                                          nC1
                                     nD0

Example 4.5.17 If q    0, the binomial series
                                    1!
                                   Xq
                                             xn
                                   nD0 n

converges absolutely for x D 1. This is obvious if q is a nonnegative integer, and it

follows from Raabe's test for other positive values of q, since

          anC1                  !     !
                            q        q  D n q ;
                                     n  nC1
          an         D      nC1                                  n > q;
                          

and       Â  Ã                            Â           Ã

     lim n  a nC1  n q  1 D lim n 1
     n!1             an              n!1 n C 1

                            D lim         n        . q 1/ D q 1:

                                     n!1 n C 1

Therefore, Abel's theorem and (4.5.21) imply that

     1!                              1!
     Xq                              X             q
                       D 2q and           . 1/n D 0; q 0:
     nD0 n                           nD0 n

                            4.5 Exercises

1. The possibilities listed in Theorem 4.5.2(c) for behavior of a power series at the
      endpoints of its interval of convergence do not include absolute convergence at one
      endpoint and conditional convergence or divergence at the other. Why can't these
      occur?
276 Chapter 4 Infinite Sequences and Series

2. Find the radius of convergence.           (b) P 2 .x 1/ pn n
     (a) X Â n C 1 OE2 C . 1/nn xn Ãn2
                      n

(c) X 2 C sin n .x C 2/ Án n                 (d) P npnxn
                      6

X x Án
(e) n
                                                               P
3. (a) Prove: If fanr ng is bounded and jx1 x0j < r , then an.x1 x0/ con-n

      verges. P        x0/n has radius of convergence R and jx1          x0j > R,
(b) Prove: If an.x

             then fan.x1 x0/ng is unbounded.
4. ProvPe: If g is a rational function defined for all nonnegative integers, then P anxn

      and ang.n/xn have the same radius of convergence. HINT: Use Exercise 4.1.30.a/:
5. Suppose that f .x/ D P an.x x0/n has radius of convergence R and 0 < r <

R1 < R. Show that there is an integer k such that

                       Xk                    n Â r ÃkC1 R1
                           an.x         x0/  Ä
                                              R1           R1 r
                f .x/  nD0
                

      if jx x0j Ä r and k k.
6. Suppose that k is a positive integer and

                                              X 1
                                    f .x/ D anxn

                                                  nD0

has radius of convergence R. Show that the series

                                             X 1
                       g.x/ D f .xk/ D anxkn

                                                      nD0

has radius of convergence R1=k.

7. Complete the proof of Theorem 4.5.3 by showing that
                                            i

     (a) R D 0 if limn!1 janC1j janj D 1;
                                             i

     (b) R D 1 if limn!1 janC1j janj D 0.

8. Find the radius of convergence.
(a) P.log n/xn                               (b) P 2nnp.x C 1/n
                 !
X n 2n n                                        X n n2 C 1        n
(c) . 1/        x                            (d) . 1/ n .x 1/
          n                                                n4

(e) X n .x C 2/ n n                          (f ) X . C 1/       . C n 1/ xn
          nS                                           . C 1/    . C n 1/

                                                (,  ¤ negative integer)
                                                        Section 4.5 Power Series 277

9. Suppose that an ¤ 0 for n sufficiently large. Show that

                                                                         
(a) lim  an  C1  Ä lim janj1=n and (b) lim janj1=n Ä lim  an  C1  :
              n!1 an          n!1                       n!1       n!1 an

Show that this implies Theorem 4.5.3.

10. Given that
                                            1 D X 1 xn; jxj < 1;

                                          1 x nD0
        use Theorem 4.5.4 to express nD0 P1 n2xn in closed form.
11. The function

                              X 1 . 1/n x Á2nCp         .p D integer 0/
                  Jp.x/ D nS.n C p/S 2
                              nD0

is the Bessel function of order p. Show that

(a)      J0   D   J1.

           0

(b)      J0   D   12 .Jp   1  JpC1/; p  1.

           p

(c)      x2J 00   C  xJp0  C  .x2  p2/Jp D 0.

               p
12. Given that the power series f .x/ D nD0 P1 anxn satisfies

                              f 0.x/ D 2xf .x/; f .0/ D 1;

find fang. Do you recognize f ?

13. Let                                      X 1
                                   f .x/ D anxn; jxj < R;

                                        nD0

and g.x/ D f .xk/, where k is a positive integer. Show that

         g.r/.0/ D 0 if r ¤ k n and g.kn/.0/ D .k n/S f .n/.0/; n 0:
                                                                    nS

14. Let                              X 1
                           f .x/ D an.x x0/n; jx x0j < R;

                                   nD0

and f .tn/ D 0, where tn ¤ x0 and limn!1 tn D x0. Show that f .x/ Á 0
.jx x0j < R/. HINT: Rolle's theorem helps here:

15. Prove Theorem 4.5.8.

16. Express                             Z x log t
                                                    dt

                                         1t 1

as a power series in x 1 and find the radius of convergence of the series.
278 Chapter 4 Infinite Sequences and Series

17. By substituting x2 for x in the geometric series, we obtain

                              1 D X 1 . 1/nx2n;            jxj < 1:
                           1 C x2 nD0

Use this to express f .x/ D Tan 1x .f .0/ D 0/ as a power series in x. Then
evaluate all derivatives of f at x0 D 0, and find a series of constants that converges
to =6.

18. Prove: If                      X 1
                         f .x/ D an.x x0/n; jx x0j < R;

                                        nD0

and F is an antiderivative of f on .x0 R; x0 C R/, then

               F .x/ D C C X 1 an .x x0/nC1 ; jx x0j < R;
                                nD0 n C 1

where C is a constant.

19. Suppose that some derivative of f can be represented by a power series in x x0
        in an interval about x0. Show that f and all its derivatives can also.

20. Verify Eqn. (4.5.21) by showing that

                                      X 1        !         jxj < 1;
                         .1 C x/ q              q xn D 1;
                                                n
                                           nD0

HINT: Differentiate:

21. Prove Theorem 4.5.10.

22. Find the Maclaurin series of cosh x and sinh x from the definition in Eqn. (4.5.16),
        and also by applying Theorem 4.5.10 to the Maclaurin series for ex and e x.

23. Give an example where the radius of convergence of the product of two power series
        is greater than the smaller of the radii of convergence of the factors.

24. Use Theorem 4.5.11 to find the first four nonzero terms in the Maclaurin.

(a) ex sin x   (b)         ex     (c) 1 C x6 cos x  (d) .sin x/ log.1 C x/

                         1Cx   2

25. Derive the identity

                                  2 sin x cos x D sin 2x

        from the Maclaurin series for sin x, cos x, and sin 2x.
26. (a) Given that

                                                X 1
                         .1 2xt C x2/ 1=2 D Pn.t /xn; jxj < 1;                 .A/

                                                nD0
                                                       Section 4.5 Power Series 279

if 1 < t < 1, show that P0.t/ D 1, P1.t/ D t, and

             PnC1.t / D 2n C 1 tPn.t /              n
                                                        Pn 1.t /; n 1:
                              nC1                   nC1

HINT: First differentiate (A) with respect to x:

(b) Show from (a) that Pn is a polynomial of degree n. It is the nth Legendre
      polynomial, and .1 2xt C x2/ 1=2 is the generating function of the sequence

      fPng.

27. Define (if necessary) the given function so as to be continuous at x0 D 0, and find

the first four nonzero terms of its Maclaurin series.

(a) xex                       (b) 1 C x C x2 cos x        (c) sec x
     sin x

(d) x csc x                   (e) sin 2x
                                    sin x

28. Let a0 D a1 D 5 and anC1 D an 6an 1; n 1.
                       P1
(a) Express F .x/ D nD0 anx in closed form.n

(b) Write F as the difference of two geometric series, and find an explicit formula

for an.

29. Starting from the Maclaurin series

                       log.1  x/ D      X 1 xnC1          jxj < 1;
                                                    ;

                                        nD0 n C 1

use Abel's theorem to evaluate

                                   X 1     1           :

                                   nD0 .n C 1/.n C 2/

30. In Example 4.5.17 we saw that
                              1!
                              Xq
                                        D 2 ; q 0:q

                              nD0 n

Show that this also holds for 1 < q < 0, but not for q Ä 1. HINT: See Exer-

cise 4.1.35:                                              P1            n
                   P1
31. (a) Prove: If nD0 bn converges, then the series g.x/ D nD0 bnx converges

uniformly on OE0; 1. HINT: If > 0, there is an integer N such that

                       jbn C bnC1 C C bmj < if n; m N:

Use summation by parts to show that then
   jbnxn C bn 1xn 1 C C bmxmj < 2 if 0 Ä x < 1; n; m N:

This is also known as Abel's theorem:
280 Chapter 4 Infinite Sequences and Series

(b) Show that (a) implies the restricted form of Theorem 4.5.12 (concerning g)

               proved in the text.
32. P Use Exercise 4.5.31 to show that if nD0 P1 an, nD0 P1 bn, and their Cauchy product

           nD0 1 cn all converge, then

                        1!                             1! 1
                        X                              X       X
                                                            bn D cn:
                            an

                        nD0                            nD0     nD0

33. Prove: If                     X 1                          jxj < 1;
        and bn 0, then  g.x/ D bnxn;

                                      nD0

                        X 1                                    (finite or infinite):
                            bn D lim g.x/

                                         x!1
                        nD0

34. Use the binomial series and the relation

                        d .sin 1 x/ D .1                       x2/ 1=2
                        dx

to obtain the Maclaurin series                     for sin 1 x .sin 1 0 D 0/.  Deduce  from this series
and Exercise 4.5.33 that
                                                   !
                                X 1
                                                   2n       1
                                              nD0  n 22n.2n C 1/ D 2 :
                                       CHAPTER 5

                                Real-Valued Functions
                                  of Several Variables

IN THIS CHAPTER we consider real-valued function of n variables, where n > 1.
SECTION 5.1 deals with the structure of Rn, the space of ordered n-tuples of real numbers,
which we call vectors. We define the sum of two vectors, the product of a vector and a
real number, the length of a vector, and the inner product of two vectors. We study the
arithmetic properties of Rn, including Schwarz's inequality and the triangle inequality. We
define neighborhoods and open sets in Rn, define convergence of a sequence of points in
Rn, and extend the Heine-Borel theorem to Rn. The section concludes with a discussion
of connected subsets of Rn.
SECTION 5.2 deals with boundedness, limits, continuity, and uniform continuity of a func-
tion of n variables; that is, a function defined on a subset of Rn.
SECTION 5.3 defines directional and partial derivatives of a real-valued function of n
variables. This is followed by the definition of differentiablity of such functions. We define
the differential of such a function and give a geometric interpretation of differentiablity.
SECTION 5.4 deals with the chain rule and Taylor's theorem for a real-valued function of
n variables.

5.1 STRUCTURE OF Rn

In this chapter we study functions defined on subsets of the real n-dimensional space Rn,
which consists of all ordered n-tuples X D .x1; x2; : : : ; xn/ of real numbers, called the
coordinates or components of X. This space is sometimes called Euclidean n-space.

   In this section we introduce an algebraic structure for Rn. We also consider its topologi-
cal properties; that is, properties that can be described in terms of a special class of subsets,
the neighborhoods in Rn. In Section 1.3 we studied the topological properties of R1, which
we will continue to denote simply as R. Most of the definitions and proofs in Section 1.3
were stated in terms of neighborhoods in R. We will see that they carry over to Rn if the
concept of neighborhood in Rn is suitably defined.

                                                    281
282 Chapter 5 Real-Valued Functions of n Variables

   Members of R have dual interpretations: geometric, as points on the real line, and alge-
braic, as real numbers. We assume that you are familiar with the geometric interpretation
of members of R2 and R3 as the rectangular coordinates of points in a plane and three-
dimensional space, respectively. Although Rn cannot be visualized geometrically if n 4,
geometric ideas from R, R2, and R3 often help us to interpret the properties of Rn for
arbitrary n.

   As we said in Section 1.3, the idea of neighborhood is always associated with some

definition of "closeness" of points. The following definition imposes an algebraic structure
on Rn, in terms of which the distance between two points can be defined in a natural way.
In addition, this algebraic structure will be useful later for other purposes.

Definition 5.1.1 The vector sum of                                            (5.1.1)

                       X D .x1; x2; : : : ; xn/ and Y D .y1; y2; : : : ; yn/

is
                           X C Y D .x1 C y1; x2 C y2; : : : ; xn C yn/:

If a is a real number, the scalar multiple of X by a is

                          aX D .ax1; ax2; : : : ; axn/:                       (5.1.2)

   Note that "C" has two distinct meanings in (5.1.1): on the left, "C" stands for the newly
defined addition of members of Rn and, on the right, for addition of real numbers. However,
this can never lead to confusion, since the meaning of "C" can always be deduced from
the symbols on either side of it. A similar comment applies to the use of juxtaposition to

indicate scalar multiplication on the left of (5.1.2) and multiplication of real numbers on

the right.

Example 5.1.1 In R4, let

      X D .1;             2; 6; 5/  and  Y D 3;          5;  4;  1  :
                                                                 2

Then                      X C Y D 4; 7; 10; 112
and                        6X D .6; 12; 36; 30/:

We leave the proof of the following theorem to you (Exercise 5.1.2).
                                          Section 5.1 Structure of Rn 283

Theorem 5.1.2 If X; Y; and Z are in Rn and a and b are real numbers; then
(a) X C Y D Y C X .vector addition is commutative/:
(b) .X C Y/ C Z D X C .Y C Z/ .vector addition is associative/:
(c) There is a unique vector 0; called the zero vector; such that X C 0 D X for all X in

      Rn:
(d) For each X in Rn there is a unique vector X such that X C . X/ D 0:
(e) a.bX/ D .ab/X:
(f ) .a C b/X D aX C bX:
(g) a.X C Y/ D aX C aY:
(h) 1X D X:

   Clearly, 0 D .0; 0; : : : ; 0/ and, if X D .x1; x2; : : : ; xn/, then

                                       X D . x1; x2; : : : ; xn/:

We write X C . Y/ as X Y. The point 0 is called the origin.
   A nonempty set V D fX; Y; Z; : : : g, together with rules such as (5.1.1), associating a

unique member of V with every ordered pair of its members, and (5.1.2), associating a
unique member of V with every real number and member of V , is said to be a vector space
if it has the properties listed in Theorem 5.1.2. The members of a vector space are called
vectors. When we wish to emphasize that we are regarding a member of Rn as part of this
algebraic structure, we will speak of it as a vector; otherwise, we will speak of it as a point.

Length, Distance, and Inner Product

Definition 5.1.3 The length of the vector X D .x1; x2; : : : ; xn/ is

                                   jXj D .x21 C x22 C C x2n/1=2:

The distance between points X and Y is jX Yj; in particular, jXj is the distance between
X and the origin. If jXj D 1, then X is a unit vector.

   If n D 1, this definition of length reduces to the familiar absolute value, and the distance
between two points is the length of the interval having them as endpoints; for n D 2 and
n D 3, the length and distance of Definition 5.1.3 reduce to the familiar definitions for the
plane and three-dimensional space.

Example 5.1.2 The lengths of the vectors

     X D .1;  2; 6; 5/  and               Y D 3;  5;  4  ;  1
                                                            2

are                                                   p

     jXj D .12 C . 2/2 C 62 C 52/1=2 D 66
284 Chapter 5 Real-Valued Functions of n Variables

and                                                            p

                jYj D .32 C . 5/2 C 42 C . 12 /2/1=2 D          201
                                                                    :

                                                                2

The distance between X and Y is                                             p149
          jX Yj D ..1 3/2 C . 2 C 5/2 C .6                                       :
                                                  4/2 C .5     21 /2/1=2 D
                                                                             2

Definition 5.1.4 The inner product X Y of X D .x1; x2; : : : ; xn/ and Y D .y1; y2; : : : ; yn/
is

                                X Y D x1y1 C x2y2 C C xnyn:

Lemma 5.1.5 (Schwarz's Inequality) If X and Y are any two vectors in Rn;

then

                                   jX Yj Ä jXj jYj;                                 (5.1.3)

with equality if and only if one of the vectors is a scalar multiple of the other:

Proof If Y D 0, then both sides of (5.1.3) are 0, so (5.1.3) holds, with equality. In this
case, Y D 0X. Now suppose that Y ¤ 0 and t is any real number. Then

                     Xn            tyi /2
                0 Ä .xi
                                            Xn           Xn                         (5.1.4)
                        i D1       2t xi yi C t 2 yi2

                     Xn                     i D1         i D1
                  D xi2

                        i D1

                D jXj2 2.X Y/t C t2jYj2:

The last expression is a second-degree polynomial p in t. From the quadratic formula, the

zeros of p are                    p
                     .X Y/  .X Y/2
                t D jYj2                             jXj2jYj2
                                                                :

Hence,

                                   .X Y/2 Ä jXj2jYj2;                               (5.1.5)

because if not, then p would have two distinct real zeros and therefore be negative between
them (Figure 5.1.1), contradicting the inequality (5.1.4). Taking square roots in (5.1.5)
yields (5.1.3) if Y ¤ 0.

   If X D tY, then jX Yj D jXjjYj D jtjjYj2 (verify), so equality holds in (5.1.3).
Conversely, if equality holds in (5.1.3), then p has the real zero t0 D .X Y/=jYk2, and

                                   Xn       t0yi /2 D 0
                                       .xi

                                   i D1

from (5.1.4); therefore, X D t0Y.
                                                     Section 5.1 Structure of Rn 285

             y

                                                y = p (t)

                      r1             r2                           t

                              Figure 5.1.1

Theorem 5.1.6 (Triangle Inequality) If X and Y are in Rn; then

                      jX C Yj Ä jXj C jYj;                                               (5.1.6)

with equality if and only if one of the vectors is a nonnegative multiple of the other:

Proof By definition,

             Xn               Xn     Xn                     Xn
        jX C Yj2 D .xi C yi /2 D xi2 C 2 xi yi C yi2

             i D1             i D1   i D1                   i D1

             D jXj2 C 2.X Y/ C jYj2                                                      (5.1.7)

             Ä jXj2 C 2jXj jYj C jYj2 (by Schwarz's inequality)

             D .jXj C jYj/2:

Hence,

                      jX C Yj2 Ä .jXj C jYj/2:

Taking square roots yields (5.1.6).

   From the third line of (5.1.7), equality holds in (5.1.6) if and only if X Y D jXjjYj,
which is true if and only if one of the vectors X and Y is a nonnegative scalar multiple of
the other (Lemma 5.1.5).

Corollary 5.1.7 If X; Y; and Z are in Rn; then
                                    jX Zj Ä jX Yj C jY Zj:

Proof Write

                      X Z D .X Y/ C .Y Z/;

and apply Theorem 5.1.6 with X and Y replaced by X Y and Y Z.
286 Chapter 5 Real-Valued Functions of n Variables

Corollary 5.1.8 If X and Y are in Rn; then
                                        jX Yj jjXj jYjj :

Proof Since                    X D Y C .X Y/;
Theorem 5.1.6 implies that    jXj Ä jYj C jX Yj;
which is equivalent to        jXj jYj Ä jX Yj:
Interchanging X and Y yields

                                         jYj jXj Ä jY Xj:
Since jX Yj D jY Xj, the last two inequalities imply the stated conclusion.

Example 5.1.3 The angle between two nonzero vectors X D .x1; x2; x3/ and Y D
.y1; y2; y3/ in R3 is the angle between the directed line segments from the origin to the
points X and Y (Figure 5.1.2).

                                                                                        X

                                                               X

            0

                                                           X-Y

                              Y

                                                              Y

                              Figure 5.1.2

Applying the law of cosines to the triangle in Figure 5.1.2 yields              (5.1.8)
                             jX Yj2 D jXj2 C jYj2 2jXjjYj cos Â:

However,    Yj2 D .x1 y1/2 C .x2 y2/2 C .x3 y3/2
        jX       D .x12 C x22 C x32/ C .y12 C y22 C y32/ 2.x1y1 C x2y2 C x3y3/
                 D jXj2 C jYj2 2X Y:
                                                                   Section 5.1 Structure of Rn 287

Comparing this with (5.1.8) yields
                                         X Y D jXj jYj cos Â:

Since j cos Âj Ä 1, this verifies Schwarz's inequality in R3.
Example 5.1.4 Connecting the points 0, X, Y, and X C Y in R2 or R3 (Figure 5.1.3)
produces a parallelogram with sides of length jXj and jYj and a diagonal of length jX C Yj.

                                                             X

X  Y

0 X+Y X+Y

Y  X

                                                             Y

                                        Figure 5.1.3

Thus, there is a triangle with sides jXj, jYj, and jX C Yj. From this, we see geometrically
that

                                         jX C Yj Ä jXj C jYj
in R2 or R3, since the length of one side of a triangle cannot exceed the sum of the lengths
of the other two. This verifies (5.1.6) for R2 and R3 and indicates why (5.1.6) is called the
triangle inequality.

   The next theorem lists properties of length, distance, and inner product that follow di-
rectly from Definitions 5.1.3 and 5.1.4. We leave the proof to you (Exercise 5.1.6).

Theorem 5.1.9 If X; Y; and Z are members of Rn and a is a scalar, then
(a) jaXj D jaj jXj:
(b) jXj 0; with equality if and only if X D 0:
(c) jX Yj 0; with equality if and only if X D Y:
(d) X Y D Y X:
(e) X .Y C Z/ D X Y C X Z:
(f ) .cX/ Y D X .cY/ D c.X Y/:
288 Chapter 5 Real-Valued Functions of n Variables

Line Segments in Rn

The equation of a line through a point X0 D .x0; y0; ´0/ in R3 can be written parametri-
cally as

             x D x0 C u1t; y D y0 C u2t; ´ D ´0 C u3t; 1 < t < 1;
where u1, u2, and u3 are not all zero. We write this in vector form as

                           X D X0 C tU; 1 < t < 1;                                    (5.1.9)

with U D .u1; u2; u3/, and we say that the line is through X0 in the direction of U.
   There are many ways to represent a given line parametrically. For example,

                           X D X0 C sV; 1 < s < 1;                            (5.1.10)

represents the same line as (5.1.9) if and only if V D aU for some nonzero real number a.
Then the line is traversed in the same direction as s and t vary from 1 to 1 if a > 0, or
in opposite directions if a < 0.

   To write the parametric equation of a line through two points X0 and X1 in R3, we take
U D X1 0 in (5.1.9), which yields

       X D X0 C t.X1 X0/ D tX1 C .1 t/X0; 1 < t < 1:

The line segment from X0 to X1 consists of those points for which 0 Ä t Ä 1.

Example 5.1.5 The line L defined by                  1 < t < 1;
                   x D 1 C 2t; y D 3 4t; ´ D 1;

which can be rewritten as

                X D . 1; 3; 1/ C t.2; 4; 0/; 1 < t < 1;                       (5.1.11)

is through X0 D . 1; 3; 1/ in the direction of U D .2; 4; 0/. The same line can be

represented by

                X D . 1; 3; 1/ C s.1; 2; 0/; 1 < s < 1;                       (5.1.12)

or by

                X D . 1; 3; 1/ C . 4; 8; 0/; 1 < < 1:                         (5.1.13)

Since                                      1
                           .1; 2; 0/ D 2 .2; 4; 0/;

L is traversed in the same direction as t and s vary from 1 to 1 in (5.1.11) and (5.1.12).
However, since

                           . 4; 8; 0/ D 2.2; 4; 0/;
                                                                   Section 5.1 Structure of Rn 289

L is traversed in opposite directions as t and vary from 1 to 1 in (5.1.11) and (5.1.13).
   Setting t D 1 in (5.1.11), we see that X1 D .1; 1; 1/ is also on L. The line segment

from X0 to X1 consists of all points of the form

                      X D t.1; 1; 1/ C .1 t/. 1; 3; 1/; 0 Ä t Ä 1:

   These familiar notions can be generalized to Rn, as follows:

Definition 5.1.10 Suppose that X0 and U are in Rn and U ¤ 0. Then the line through
X0 in the direction of U is the set of all points in Rn of the form

                                  X D X0 C tU; 1 < t < 1:

A set of points of the form

                                    X D X0 C t U; t1 Ä t Ä t2;

is called a line segment. In particular, the line segment from X0 to X1 is the set of points of
the form

                   X D X0 C t.X1 X0/ D tX1 C .1 t/X0; 0 Ä t Ä 1:

Neighborhoods and Open Sets in Rn

Having defined distance in Rn, we are now able to say what we mean by a neighborhood
of a point in Rn.

Definition 5.1.11 If  > 0, the -neighborhood of a point X0 in Rn is the set

                                 °  «
                      N .X0/j D X  jX X0j < :

   An -neighborhood of a point X0 in R2 is the inside, but not the circumference, of the
circle of radius about X0. In R3 it is the inside, but not the surface, of the sphere of radius

  about X0.

   In Section 1.3 we stated several other definitions in terms of -neighborhoods: neigh-

borhood, interior point, interior of a set, open set, closed set,limit point, boundary point,

boundary of a set, closure of a set, isolated point, exterior point, and exterior of a set. Since
these definitions are the same for Rn as for R, we will not repeat them. We advise you to
read them again in Section 1.3, substituting Rn for R and X0 for x0.

Example 5.1.6 Let S be the set of points in R2 in the square bounded by the lines

x D 1, y D 1, except for the origin and the points on the vertical lines x D 1

(Figure 5.1.4, page 290); thus,

°S D .x; y/  .x; y/ ¤ .0; 0/; 1 < x < 1; 1 Ä y Ä 1 :«
290 Chapter 5 Real-Valued Functions of n Variables

Every point of S not on the lines y D 1 is an interior point, so
                        S 0 D °.x; y/  .x; y/ ¤ .0; 0/; 1 < x; y < 1« :

S is a deleted neighborhood of .0; 0/ and is neither open nor closed. The closure of S is

                          S D .x; y/  1 Ä x; y Ä 1 ;°         «

and every point of S is a limit point of S . The origin and the perimeter of S form @S , the

boundary of S . The exterior of S consists of all points .x; y/ such that jxj > 1 or jyj > 1.
The origin is an isolated point of S c .

                                                y

                (-1, 1)                                          (1, 1)

                                                x                                x

                (-1, -1)                                         (1, -1)

                                    Figure 5.1.4

Example  5.1.7  If X0  is a  point      in  Rn  and  r  is a  posit«ive number,  the  open n-ball  of
                                             °
radius r about X0 is the set Br .X0/ D X  jX X0j < r . (Thus, -neighborhoods are

open n-balls.) If X1 is in Sr .X0/ and

                          jX X1j < D r jX X0j;

then X is in Sr .X0/. (The situation is depicted in Figure 5.1.5 for n D 2.)

   Thus, Sr .X0/ contains an -neighborhood of each of its points, and is therefore open.
We leave it to you (Exercise 5.1.13) to show that the closure of Br .X0/ is the closed n-ball
of radius r about X0, defined by
                                           Section 5.1 Structure of Rn 291

                                    °             «
                        Sr .X0/ D X  jX X0j Ä r :

                                           r - X1- X0

                                           X
                                              X1

                                       X0
                                       r

                        Figure 5.1.5

   Open and closed n-balls are generalizations to Rn of open and closed intervals.

   The following lemma will be useful later in this section, when we consider connected
sets.

Lemma 5.1.12 If X1 and X2 are in Sr .X0/ for some r > 0, then so is every point on
the line segment from X1 to X2:

Proof The line segment is given by

                        X D tX2 C .1 t/X1; 0 < t < 1:

Suppose that r > 0. If  jX1 X0j < r; jX2 X0j < r;
and 0 < t < 1, then

jX X0j D jtX2 C .1 t/X1 tX0 .1 t/X0j
           D jt .X2 X0/ C .1 t /X1 X0/j
           Ä t jX2 X0j C .1 t /jX1 X0j
           < t r C .1 t/r D r:

   The proofs in Section 1.3 of Theorem 1.3.3 (the union of open sets is open, the intersec-

tion of closed sets is closed) and Theorem 1.3.5 and its Corollary 1.3.6 (a set is closed if
and only if it contains all its limit points) are also valid in Rn. You should reread them now.
292 Chapter 5 Real-Valued Functions of n Variables

The Heine-Borel theorem (Theorem 1.3.7) also holds in Rn, but the proof in Section 1.3
is valid only for n D 1. To prove the Heine-Borel theorem for general n, we need some
preliminary definitions and results that are of interest in their own right.

Definition 5.1.13 A sequence of points fXr g in Rn converges to the limit X if

                              lim jXr Xj D 0:

                             r !1

In this case we write

                             lim Xr D X:

                             r !1

   The next two theorems follow from this, the definition of distance in Rn, and what we
already know about convergence in R. We leave the proofs to you (Exercises 5.1.16 and
5.1.17).

Theorem 5.1.14 Let
              X D .x1; x2; : : : ; xn/ and Xr D .x1r ; x2r ; : : : ; xnr /; r 1:

Then limr!1 Xr D X if and only if
                                      lim xir D xi ; 1 Ä i Ä nI

                                                     r !1

that is; a sequence fXr g of points in Rn converges to a limit X if and only if the sequences
of components of fXr g converge to the respective components of X:

Theorem 5.1.15 (Cauchy's Convergence Criterion) A sequence fXrg in
Rn converges if and only if for each > 0 there is an integer K such that

                                    jXr Xsj < if r; s K:

The next definition generalizes the definition of the diameter of a circle or sphere.

Definition 5.1.16 If S is a nonempty subset of Rn, then
                                    °                     «
                             d.S / D sup jX Yj  X; Y 2 S

is the diameter of S . If d.S / < 1; S is boundedI if d.S / D 1, S is unbounded.

Theorem 5.1.17 (Principle of Nested Sets) If S1; S2; . . . are closed nonempty
subsets of Rn such that

                             S1 S2     Sr                                         (5.1.14)

and

                              lim d.Sr / D 0;                                     (5.1.15)

                             r !1

then the intersection              \ 1
contains exactly one point:  I D Sr

                                     r D1
                           Section 5.1 Structure of Rn 293

Proof Let fXr g be a sequence such that Xr 2 Sr .r 1/. Because of (5.1.14), Xr 2 Sk
if r k, so

                                 jXr Xsj < d.Sk / if r; s k:

From (5.1.15) and Theorem 5.1.15, Xr converges to a limit X. Since X is a limit point of
every Sk and every Sk is closed, X is in every Sk (Corollary 1.3.6). Therefore, X 2 I , so
I ¤ ;. Moreover, X is the only point in I , since if Y 2 I , then

       jX Yj Ä d.Sk/; k 1;

and (5.1.15) implies that Y D X.

   We can now prove the Heine-Borel theorem for Rn. This theorem concerns compact
sets. As in R, a compact set in Rn is a closed and bounded set.

Recall that a collection H of open sets is an open covering of a set S if

              °         «
       S [ H H 2 H :

Theorem 5.1.18 (Heine-Borel Theorem) If H is an open covering of a com-
pact subset S; then S can be covered by finitely many sets from H :

Proof The proof is by contradiction. We first consider the case where n D 2, so that
you can visualize the method. Suppose that there is a covering H for S from which it is
impossible to select a finite subcovering. Since S is bounded, S is contained in a closed
square

                       T D f.x; y/ja1 Ä x Ä a1 C L; a2 Ä x Ä a2 C Lg

with sides of length L (Figure 5.1.6).

T (1)                       T (2)

       S (1)     S (2)

       S (4)     S (3)

T (4)                       T (3)

       Figure 5.1.6
294 Chapter 5 Real-Valued Functions of n Variables

   Bisecting the sides of T as shown by the dashed lines in Figure 5.1.6 leads to four closed
squares, T .1/; T .2/, T .3/, and T .4/, with sides of length L=2. Let

                                   S .i/ D S \ T .i/; 1 Ä i Ä 4:

Each S .i/, being the intersection of closed sets, is closed, and

                                                [4
                                          S D S .i/:

                                                  i D1

Moreover, H covers each S .i/, but at least one S .i/ cannot be covered by any finite sub-

collection of H , since if all the S .i/ could be, then so could S . Let S1 be a set with this
property, chosen from S .1/, S .2/, S .3/, and S .4/. We are now back to the situation we

started from: a compact set S1 covered by H , but not by any finite subcollection of H .

However, S1 is contained in a square T1 with sides of length L=2 instead of L. Bisecting

the sides of T1 and repeating the argument, we obtain a subset S2 of S1 that has the same

properties as S , except that it is contained in a square with sides of length L=4. Continuing

in this way produces a sequence of nonempty closed sets S0 .D S /, S1, S2, . . . , such that

STk SkC1 and d.Sk / Ä L=2k 1=2 .k 0/. From Theorem 5.1.17, there is a point X in
1    Sk.  Since  X  2  S,  there  is  an  open  set  H  in  H  that  contains  X,  and  this  H  must  also
kD1

contain some -neighborhood of X. Since every X in Sk satisfies the inequality

                                      jX Xj Ä 2 kC1=2L;

it follows that Sk H for k sufficiently large. This contradicts our assumption on H ,
which led us to believe that no Sk could be covered by a finite number of sets from H .
Consequently, this assumption must be false: H must have a finite subcollection that covers
S . This completes the proof for n D 2.

The idea of the proof is the same for n > 2. The counterpart of the square T is the

hypercube with sides of length L:

          T D .x1; x2; : : : ; xn/  ai Ä xi Ä ai C L; i D 1; 2; : : : ; n :°            «

Halving the intervals of variation of the n coordinates x1, x2, . . . , xn divides T into 2n
closed hypercubes with sides of length L=2:

                 T .i/ D °.x1; x2; : : : ; xn/  bi Ä xi Ä bi C L=2; 1 Ä i Ä n« ;

where bi D ai or bi D ai C L=2. If no finite subcollection of H covers S , then at least
one of these smaller hypercubes must contain a subset of S that is not covered by any finite
subcollection of S . Now the proof proceeds as for n D 2.

   The Bolzano-Weierstrass theorem is valid in Rn; its proof is the same as in R.

Connected Sets and Regions
Although it is legitimate to consider functions defined on arbitrary domains, we restricted
Section 5.1 Structure of Rn 295

our study of functions of one variable mainly to functions defined on intervals. There are
good reasons for this. If we wish to raise questions of continuity and differentiability at
every point of the domain D of a function f , then every point of D must be a limit point

                                                                               Rb
of D0. Intervals have this property. Moreover, the definition of a f .x/ dx is obviously
applicable only if f is defined on OEa; b.

   It is not productive to consider questions of continuity and differentiability of functions
defined on the union of disjoint intervals, since many important results simply do not hold
for such domains. For example, the intermediate value theorem (Theorem 2.2.10; see also
Exercise 2.2.25) says that if f is continuous on an interval I and f .x1/ < < f .x2/
for some x1 and x2 in I , then f .x/ D for some x in I . Theorem 2.3.12 says that f is
constant on an interval I if f 0 Á 0 on I . Neither of these results holds if I is the union of
disjoint intervals rather than a single interval; thus, if f is defined on I D .0; 1/ [ .2; 3/
by

                                      f .x/ D 1; 0 < x < 1;
                                                  0; 2 < x < 3;

then f is continuous on I , but does not assume any value between 0 and 1, and f 0 Á 0 on
I , but f is not constant.

   It is not difficult to see why these results fail to hold for this function: the domain of f
consists of two disconnected pieces. It would be more sensible to regard f as two entirely
different functions, one defined on .0; 1/ and the other on .2; 3/. The two results mentioned
are valid for each of these functions.

   As we will see when we study functions defined on subsets of Rn, considerations like
those just cited as making it natural to consider functions defined on intervals in R lead
us to single out a preferred class of subsets as domains of functions of n variables. These
subsets are called regions. To define this term, we first need the following definition.

Definition 5.1.19 A subset S of Rn is connected if it is impossible to represent S as
the union of two disjoint nonempty sets such that neither contains a limit point of the other;
that is, if S cannot be expressed as S D A [ B, where

A ¤ ;; B ¤ ;; A \ B D ;; and A \ B D ;:                     (5.1.16)

If S can be expressed in this way, then S is disconnected.

Example 5.1.8 The empty set and singleton sets are connected, because they cannot
be represented as the union of two disjoint nonempty sets.

Example 5.1.9 The space Rn is connected, because if Rn D A [ B with A \ B D ;

and A \ B D ;, then A A and B B; that is, A and B are both closed and therefore
are both open. Since the only nonempty subset of Rn that is both open and closed is Rn
itself (Exercise 5.1.21), one of A and B is Rn and the other is empty.
296 Chapter 5 Real-Valued Functions of n Variables

                                y

                                                                           (3, 3)

         (1, 2)          (3, 2)

                 (1, 1)

                                                                                   x

                 Figure 5.1.7

   If X1; X2; : : : ; Xk are points in Rn and Li is the line segment from Xi to XiC1, 1 Ä i Ä
k 1, we say that L1, L2, . . . , Lk 1 form a polygonal path from X1 to Xk, and that X1
and Xk are connected by the polygonal path. For example, Figure 5.1.7 shows a polygonal
path in R2 connecting .0; 0/ to .3; 3/. A set S is polygonally connected if every pair of
points in S can be connected by a polygonal path lying entirely in S .

Theorem 5.1.20 An open set S in Rn is connected if and only if it is polygonally
connected:

Proof For sufficiency, we will show that if S is disconnected, then S is not polygonally
connected. Let S D A [ B, where A and B satisfy (5.1.16). Suppose that X1 2 A and
X2 2 B, and assume that there is a polygonal path in S connecting X1 to X2. Then some
line segment L in this path must contain a point Y1 in A and a point Y2 in B. The line
segment

                                X D tY2 C .1 t/Y1; 0 Ä t Ä 1;

is part of L and therefore in S . Now define                                           «
                                 °                                                 Ä1 ;

                         D sup  tY2 C .1 t/Y1 2 A; 0 Ä t Ä

and let

                 X D Y2 C .1 /Y1:

Then X 2 A\B. However, since X 2 A[B and A\B D A\B D ;, this is impossible.
Therefore, the assumption that there is a polygonal path in S from X1 to X2 must be false.
                                 Section 5.1 Structure of Rn 297

   For necessity, suppose that S is a connected open set and X0 2 S . Let A be the set
consisting of X0 and the points in S can be connected to X0 by polygonal paths in S . Let
B be set of points in S that cannot be connected to X0 by polygonal paths. If Y0 2 S , then
S contains an -neighborhood N .Y0/ of Y0, since S is open. Any point Y1 in N .Y0 can
be connected to Y0 by the line segment

                                X D tY1 C .1 t/Y0; 0 Ä t Ä 1;

which lies in N .Y0/ (Lemma 5.1.12) and therefore in S . This implies that Y0 can be
connected to X0 by a polygonal path in S if and only if every member of N .Y0/ can also.
Thus, N .Y0/ A if Y0 2 A, and N .Y0/ 2 B if Y0 2 B. Therefore, A and B are open.
Since A \ B D ;, this implies that A \ B D A \ B D ; (Exercise 5.1.14). Since A is
nonempty .X0 2 A/, it now follows that B D ;, since if B ¤ ;, S would be disconnected
(Definition 5.1.19). Therefore, A D S , which completes the proof of necessity.

   We did not use the assumption that S is open in the proof of sufficiency. In fact, we actu-
ally proved that any polygonally connected set, open or not, is connected. The converse is
false. A set (not open) may be connected but not polygonally connected (Exercise 5.1.29).

   Our study of functions on Rn will deal mostly with functions whose domains are regions,
defined next.

Definition 5.1.21 A region S in Rn is the union of an open connected set with some,
all, or none of its boundary; thus, S 0 is connected, and every point of S is a limit point of

S0.

Example 5.1.10 Intervals are the only regions in R (Exercise 5.1.31).           The n-ball
Br .X0/ (Example 5.1.7) is a region in Rn, as is its closure S r .X0/. The set

                         S D °.x; y/  x2 C y2 Ä 1 or x2 C y2 4«

(Figure 5.1.8(a), page 298) is not a region in R2, since it is not connected. The set S1
obtained by adding the line segment

L1W X D t.0; 2/ C .1 t/.0; 1/; 0 < t < 1;

to S (Figure 5.1.8(b)) is connected but is not a region, since points on the line segment are
not limit points of S10. The set S2 obtained by adding to S1 the points in the first quadrant
bounded by the circles x2 C y2 D 1 and x2 C y2 D 4 and the line segments L1 and

L2W X D t.2; 0/ C .1 t/.1; 0/; 0 < t < 1

(Figure 5.1.8(c)), is a region.

More about Sequences in Rn

From Definition 5.1.13, a sequence fXr g of points in Rn converges to a limit X if and only
if for every > 0 there is an integer K such that

                                 jXr Xj < if r K:
298 Chapter 5 Real-Valued Functions of n Variables

The Rn definitions of divergence, boundedness, subsequence, and sums, differences, and
constant multiples of sequences are analogous to those given in Sections 4.1 and 4.2 for
the case where n D 1. Since Rn is not ordered for n > 1, monotonicity, limits inferior and
superior of sequences in Rn, and divergence to 1 are undefined for n > 1. Products and
quotients of members of Rn are also undefined if n > 1.

y                                  y

                                      L1

     x                                    x

(a)                                (b)

        y

        L1
                                x

                 L2

                                                                (c)

                                        Figure 5.1.8

   Several theorems from Sections 4.1 and 4.2 remain valid for sequences in Rn, with proofs
unchanged, provided that "j j" is interpreted as distance in Rn. (A trivial change is re-
quired: the subscript n, used in Sections 4.1 and 4.2 to identify the terms of the sequence,
must be replaced, since n here stands for the dimension of the space.) These include The-
orems 4.1.2 (uniqueness of the limit), 4.1.4 (boundedness of a convergent sequence), parts
of 4.1.8 (concerning limits of sums, differences, and constant multiples of convergent se-
quences), and 4.2.2 (every subsequence of a convergent sequence converges to the limit of
the sequence).
                                                       Section 5.1 Structure of Rn 299
                                5.1 Exercises

With R replaced by Rn, the following exercises from Section 1:3 are also suitable for this
section: 1.3.7-1.3.10; 1.3.12-1.3.15; 1.3.19; 1.3.20 .except (e)/; and 1.3.21:

1. Find aX C bY.

(a) X D .1; 2; 3; 1/, Y D .0; 1; 2; 0/, a D 3, b D 6

(b) X D .1; 1; 2/, Y D .0; 1; 3/, a D 1, b D 2

(c) X D . 12 ; 32 ; 14 ; 16 /,  YD.  1  ;  1  ;  5  ;  13 /,  a  D  21 ,  b  D  1
                                     2                                          6

2. Prove Theorem 5.1.2.

3. Find jXj.

(a) .1; 2; 3; 1/                                       (b) 12 ; 13 ; 14 ; 16
(c) .1; 2; 1; 3; 4/                                    (d) .0; 1; 0; 1; 0; 1/

4. Find jX Yj.

(a) X D .3; 4; 5; 4/, Y D .2; 0; 1; 2/

(b) X D . 12 ; 12 ; 14 ; 14 /, Y D . 13 ; 16 ; 16 ; 13 /
(c) X D .0; 0; 0/, Y D .2; 1; 2/

(d) X D .3; 1; 4; 0; 1/, Y D .2; 0; 1; 4; 1/

5. Find X Y.

(a) X D .3; 4; 5; 4/, Y D .3; 0; 3; 3/

(b) X D . 16 ; 11 12 ; 98 ; 52 /, Y D . 12 ; 12 ; 14 ; 14 /
(c) X D .1; 2; 3; 1; 4/, Y D .1; 2; 1; 3; 4/

6. Prove Theorem 5.1.9.

7. Find a parametric equation of the line through X0 in the direction of U.

     (a) X0 D .1; 2; 3; 1/, U D .3; 4; 5; 4/
     (b) X0 D .2; 0; 1; 2; 4/, U D . 1; 0; 1; 3; 2/
     (c) X0 D . 12 ; 12 ; 14 ; 14 /, U D . 13 ; 16 ; 16 ; 13 /
8. Suppose that U ¤ 0 and V ¤ 0. Complete the sentence: The equations

                                X D X0 C tU; 1 < t < 1;

      and
                                    X D X1 C sV; 1 < s < 1;

      represent the same line in Rn if and only if ...

9. Find the equation of the line segment from X0 to X1.
     (a) X0 D .1; 3; 4; 2/, X1 D .2; 0; 1; 5/
     (b) X0 D .3; 1 2; 1; 4/, X1 D .2; 0; 1; 4; 3/
     (c) X0 D .1; 2; 1/, X1 D .0; 1; 1/
300 Chapter 5 Real-Valued Functions of n Variables

°                             «
10. Find sup  N .X0/ S .

(a) X0 D .1; 2; 1; 3/; S D the open 4-ball of radius 7 about .0; 3; 2; 2/
                                     °                               «
(b) X0 D .1; 2; 1; 3/; S D .x1; x2; x3; x4/  jxi j Ä 5; 1 Ä i Ä 4

(c) X0 D .3; 52 /; S D the closed triangle with vertices .2; 0/, .2; 2/, and .4; 4/

11. Find (i) @S; (ii) S; (iii) S0; (iv) exterior of S.
°                                                       «
(a) S D .x1; x2; x3; x4/  jxi j < 3; i D 1; 2; 3
(b) S D °.x; y; 1/  x2 C y2 Ä 1«

12. Describe the following sets as open, closed, or neither.
°                                                             «
(a) S D .x1; x2; x3; x4/  jx1j > 0; x2 < 1; x3 ¤ 2
°                                                  «
(b) S D .x1; x2; x3; x4/  x1 D 1; x3 ¤ 4
°                                                                «
(c) S D .x1; x2; x3; x4/  x1 D 1; 3 Ä x2 Ä 1; x4 D 5

13. Show that the closure of the open n-ball

                                        °                     «
                              Br .X0/ D X  jX X0j < r

is the closed n-ball                    °                     «
                           Br .X0/ D X  jX X0j Ä r :

14. Prove: If A and B are open and A \ B D ;, then A \ B D A \ B D ;.

15. Show that if limr!1 Xr exists, then it is unique.

16. Prove Theorem 5.1.14.

17. Prove Theorem 5.1.15.

18. Find limr!1 Xr . Á
(a) Xr D r sin ; cos ; e r
   Âr                         rÂ
           1                  r C1         1 Ãr Ã
(b) Xr D 1 r 2 ; log r C 2 ; 1 C r

19. Find d.S/. °  «
       (a) S D .x; y; x/  jxj Ä 2; jyj Ä 1; j´ 2j Ä 2

(b) S D .x; y/         .x 1/2 .y 2/2          D1
                                     C
                           9            4

(c) S D the triangle in R2 with vertices .2; 0/, .2; 2/, and .4; 4/
°                                                             «
(d) S D .x1; x2; : : : ; xn/  jxi j Ä L; i D 1; 2; : : : ; n
°                                             «
(e) S D .x; y; ´/  x ¤ 0; jyj Ä 1; ´ > 2

20. Prove that d.S / D d.S / for any set S in Rn.

21. Prove: If a nonempty subset S of Rn is both open and closed, then S D Rn.
                                                          Section 5.1 Structure of Rn 301

22. Use the Bolzano-Weierstrass theorem to show that if S1, S2, . . . , Sm, . . . is an

iTnfinite sequence of nonempty compact sets and S1 S2                   Sm  , then
mD1 1 Sm is nonempty. Show that the conclusion does not follow if the sets are

assumed to be closed rather than compact.

23. Suppose that a sequence U1, U2, . . . of open sets covers a compact set S . Without
                                                                      SN
using the Heine-Borel theorem, show that S                  mD1 Um for some N . HINT:
                                                      Sn
                                                                 c
Apply Exercise 5.1.22 to the sets Sn D S \ mD1 Um :

(This is a seemingly restricted version of the Heine-Borel theorem, valid for the
case where the covering collection H is denumerable. However, it can be shown
that there is no loss of generality in assuming this.)

24. The distance from a point X0 to a nonempty set S is defined by

   dist.X0; S / D inf jX X0j  X 2 S :°                         «

(a) Prove: If S is closed and X0 2 Rn, there is a point X in S such that

                            jX X0j D dist.X0; S /:

HINT: Apply Exercise 5.1.22 to the sets

°                                                                    «
Cm D X  X 2 S and jX X0j Ä dist.X0; S / C 1=m ; m 1:

(b) Show that if S is closed and X0 62 S , then dist.X0; S / > 0.

(c) Show that the conclusions of (a) and (b) may fail to hold if S is not closed.

25. The distance between two nonempty sets S and T is defined by

dist.S; T / D inf jX Yj  X 2 S; Y 2 T :°                          «

(a) Prove: If S is closed and T is compact, there are points X in S and Y in T
      such that
                                        jX Yj D dist.S; T /:

      HINT: Use Exercises 5.1.22 and 5.1.24:
(b) Under the assumptions of (a), show that dist.S; T / > 0 if S \ T D ;.
(c) Show that the conclusions of (a) and (b) may fail to hold if S or T is not

      closed or T is unbounded.

26. (a) Prove: If a compact set S is contained in an open set U , there is a positive

number r such that the set

                            °                               «
   Sr D X  dist.X; S / Ä r

      is contained in U . (You will need Exercise 5.1.24 here.)
(b) Show that Sr is compact.
302 Chapter 5 Real-Valued Functions of Several Variables

27. Let D1 and D2 be compact subsets of Rn. Show that
                                 °                         «
                           D D .X; Y/  X 2 D1; Y 2 D2

    is a compact subset of R2n.

28. Prove: If S is open and S D A [ B where A \ B D A \ B D ;, then A and B are
        open.

29. Give an example of a connected set in Rn that is not polygonally connected.
30. Prove that a region is connected.

31. Show that the intervals are the only regions in R.
32. Prove: A bounded sequence in Rn has a convergent subsequence. HINT: Use Theo-

        rems 5.1.14; 4.2.2; and 4.2.5.a/:

33. Define "limr!1 Xr D 1" if fXr g is a sequence in Rn, n 2.

5.2 CONTINUOUS REAL-VALUED FUNCTIONS OF n VARI-
ABLES

We now study real-valued functions of n variables. We denote the domain of a function f
by Df and the value of f at a point X D .x1; x2; : : : ; xn/ by f .X/ or f .x1; x2; : : : ; xn/.
We continue the convention adopted in Section 2.1 for functions of one variable: If a func-
tion is defined by a formula such as

                           f .X/ D 1 x12 x22      xn2 1=2     (5.2.1)

or

                           g.X/ D 1 x12 x22       xn2 1       (5.2.2)

without specification of its domain, it is to be understood that its domain is the largest
subset of Rn for which the formula defines a unique real number. Thu°s, in the abs«ence of
any other stipulation, the domain of°f in (5.2.1)«is the closed n-ball X  jXj Ä 1 , while
the domain of g in (5.2.2) is the set X  jXj ¤ 1 .

   The main objective of this section is to study limits and continuity of functions of n
variables. The proofs of many of the theorems here are similar to the proofs of their coun-
terparts in Sections 2.1 and . We leave most of them to you.

Definition 5.2.1 We say that f .X/ approaches the limit L as X approaches X0 and
write

                                             lim f .X/ D L

                                                               X!X0

if X0 is a limit point of Df and, for every > 0, there is a i > 0 such that

                                 jf .X/ Lj <

for all X in Df such that

                                 0 < jX X0j < i:
                    Section 5.2 Continuous Real-Valued Functions of n Variables 303

Example 5.2.1 If         g.x; y/ D 1 x2 2y2;

then

                              lim g.x; y/ D 1 x02 2y02                            (5.2.3)
                                                                                  (5.2.4)
                         .x;y/!.x0 ;y0 /

for every .x0; y0/. To see this, we write

      jg.x; y/  .1  x2   2y02/j D j.1      x2      2y 2 /     .1     x2   2y02/j

                      0                                                0

                         Ä jx2             x2   j  C  2jy  2  y02 j

                                             0

                         D j.x C x0/.x x0/j C 2j.y C y0/.y y0/j

                         Ä jX X0j.jx C x0j C 2jy C y0/j/;

since                jx x0j Ä jX X0j and jy y0j Ä jX X0j:
If jX  X0j < 1, then jxj < jx0j C 1 and jyj < jy0j C 1. This and (5.2.4) imply that

              jg.x; y/ .1 x02 2y02/j < KjX X0j if jX X0j < 1;

where                    K D .2jx0j C 1/ C 2.2jy0j C 1/:
Therefore, if > 0 and
then                      jX X0j < i D minf1; =Kg;
This proves (5.2.3).     g.x; y/ .1 x02 2y02/ < :

   Definition 5.2.1 does not require that f be defined at X0, or even on a deleted neighbor-
hood of X0.

Example 5.2.2 The function
                                                     p

                                                 sin 1 x2 2y2
                                    h.x; y/ D p

                                                      1 x2 2y2

is defined only on the interior of the region bounded by the ellipse
                                             x2 C 2y2 D 1

(Figure 5.2.1(a), page 304). It is not defined at any point of the ellipse itself or on any
deleted neighborhood of such a point. Nevertheless,

                              lim h.x; y/ D 1                                     (5.2.5)

                         .x;y/!.x0 ;y0 /
304 Chapter 5 Real-Valued Functions of Several Variables

if                                                                                            (5.2.6)
                                             x02 C 2y20 D 1:                                  (5.2.7)
                                                                                              (5.2.8)
To see this, let                      p
                         u.x; y/ D 1 x2 2y2:

Then                        h.x; y/ D sin u.x; y/ :
                                           u.x; y/

Recall that                         lim sin r D 1I
therefore, if                       r !0 r

               > 0, there is a i1 > 0 such that
                                    
                        sin u   1 < if
                         u                       0 < juj < i1:

From (5.2.3),

                              lim .1 x2 2y2/ D 0

                         .x;y/!.x0 ;y0 /

if (5.2.6) holds, so there is a i > 0 such that

                       0 < u2.x; y/ D .1 x2 2y2/ < i12

if X D .x; y/ is in the interior of the ellipse and jX X0j < i; that is, if X is in the shaded
region of Figure 5.2.1(b).

Therefore,                          p
                         0 < u D 1 x2 2y2 < i1
                                                                                              (5.2.9)

if X is in the interior of the ellipse and jX X0j < i; that is, if X is in the shaded region of
Figure 5.2.1(b). This, (5.2.7), and (5.2.8) imply that

                                    jh.x; y/ 1j <

for such X, which implies (5.2.5).

                  y                                           y

                                        x                           X0 X - X = 
                       x2+ 2y2 = 1
                                                                                           0

                                                                                    x

                                                                   x2+ 2y2 = 1

                  (a)                                         (b)

                                    Figure 5.2.1
                   Section 5.2 Continuous Real-Valued Functions of n Variables 305

   The following theorem is analogous to Theorem 2.1.3. We leave its proof to you (Exer-
cise 5.2.2).

Theorem 5.2.2 If limX!X0 f .X/ exists; then it is unique.

   When investigating whether a function has a limit at a point X0, no restriction can be
made on the way in which X approaches X0, except that X must be in Df . The next
example shows that incorrect restrictions can lead to incorrect conclusions.

Example 5.2.3 The function
                                                           xy

                                          f .x; y/ D x2 C y2

is defined everywhere in R2 except at .0; 0/. Does lim.x;y/!.0;0/ f .x; y/ exist? If we try

to answer this question by letting .x; y/ approach .0; 0/ along the line y D x, we see the

functional values                           x2 1
                              f .x; x/ D 2x2 D 2

and conclude that the limit is 1=2. However, if we let .x; y/ approach .0; 0/ along the line
y D x, we see the functional values

                                      x2                       1
                              f .x; x/ D 2x2 D 2

and conclude that the limit equals 1=2. From Theorem 5.2.2, these two conclusions
cannot both be correct. In fact, they are both incorrect. What we have shown is that

                                   1                              1
                   lim f .x; x/ D and lim f .x; x/ D :
                   x!0             2  x!0                         2

Since limx!0 f .x; x/ and limx!0 f .x; x/ must both equal lim.x;y/!.0;0/ f .x; y/ if the
latter exists (Exercise 5.2.3(a)), we conclude that the latter does not exist.

   The sum, difference, and product of functions of n variables are defined in the same
way as they are for functions of one variable (Definition 2.1.1), and the proof of the next
theorem is the same as the proof of Theorem 2.1.4.

Theorem 5.2.3 Suppose that f and g are defined on a set D; X0 is a limit point of

D; and

                        lim f .X/ D L1; lim g.X/ D L2:
                        X!X0          X!X0

Then

                         lim .f C g/.X/ D L1 C L2;                   (5.2.10)
                                                                     (5.2.11)
                        X!X0                                         (5.2.12)

                         lim .f g/.X/ D L1 L2;                       (5.2.13)

                        X!X0

                             lim .fg/.X/ D L1L2;

                              X!X0

and; if L2 ¤ 0;                    Â f Ã L1

                              lim     .X/ D :
                              X!X0 g      L2
306 Chapter 5 Real-Valued Functions of Several Variables

Infinite Limits and Limits as jXj!1

Definition 5.2.4 We say that f .X/ approaches 1 as X approaches X0 and write

                                             lim f .X/ D 1

                                                               X!X0

if X0 is a limit point of Df and, for every real number M , there is a i > 0 such that

             f .X/ > M whenever 0 < jX X0j < i and X 2 Df :

We say that

                                                lim f .X/ D 1

                                                                  X!X0

if
                                           lim . f /.X/ D 1:

                                                            X!X0

Example 5.2.4 If                                     xn2/ 1=2;
                              f .X/ D .1 x12 x22

then                                   lim f .X/ D 1
if jX0j D 1, because
so                                          X!X0

                                                    1
                                    f .X/ D jX X0j ;

                                                                       1
                      f .X/ > M if 0 < jX X0j < i D M :

Example 5.2.5 If                                  1
                              f .x; y/ D x C 2y C 1 ;

then lim.x;y/!.1; 1/ f .x; y/ does not exist (why not?), but

                                   lim jf .x; y/j D 1:

                              .x;y/!.1; 1/

To see this, we observe that

             jx C 2y C 1j D j.x 1/ C 2.y C 1/j
                                 p

                              Ä 5jX X0j (by Schwarz's inequality),

where X0 D .1;  1/, so
                                             1
                                                  p                     1  :
                     jf .x; y/j D jx C 2y C 1j
                                                   5jX X0j
                     Section 5.2 Continuous Real-Valued Functions of n Variables 307

Therefore,                                                             1
                     jf .x; y/j > M if 0 < jX X0j < p :

                                                                    M5

Example     5.2.6    The function
                           f .x; y; ´/ D
                                          Â    1              Ã

                                          sin  2 2 2           
                                               x Cy C´

                                               x2 C y2 C ´2

assumes arbitrarily large values in every neighborhood of .0; 0; 0/. For example, if Xk D

.xk; yk; ´k/, where    xk D yk D ´k D q 1 ;
                                                3 k C 12

then Â 1 Ã
                                        f .Xk/ D k C 2 :

However, this does not imply that limX!0 f .X/ D 1, since, for example, every neighbor-
hood of .0; 0; 0/ also contains points

                                          Â1 1 1Ã
                                  Xk D p ; p ; p

                                               3k 3k 3k

for which f .Xk/ D 0.

Definition 5.2.5 If Df is unbounded; we say that

                                      lim f .X/ D L (finite)

                                                    jXj!1

if for every > 0, there is a number R such that

            jf .X/ Lj < whenever jXj R and X 2 Df :

Example 5.2.7 If

                                            Â1Ã
                       f .x; y; ´/ D cos x2 C 2y2 C ´2 ;

then                                                                                 (5.2.14)
                                              lim f .X/ D 1:                        > 0 there

                                                               jXj!1

To see this, we recall that the continuity of cos u at u D 0 implies that for each
is a i > 0 such that

                                    j cos u 1j < if juj < i:
308 Chapter 5 Real-Valued Functions of Several Variables

Since                                  1                1

                        p        x2 C 2y2 C ´2 Ä jXj2 ;

it follows that if jXj > 1= i, then

                                             1
                                     x2 C 2y2 C ´2 < i:

Therefore,

                                     jf .X/ 1j < :

This proves (5.2.14).

Example 5.2.8 Consider the function defined only on the domain

                        D D .x; y/  0 < y Ä ax ; 0 < a < 1°«

(Figure 5.2.2), by

                                                     1
                                     f .x; y/ D x y :

We will show that

                                      lim f .x; y/ D 0:            (5.2.15)

                                     jXj!1

It is important to keep in mind that we need only consider .x; y/ in D, since f is not
defined elsewhere.

In D,

                                     x y x.1 a/                    (5.2.16)

and
                                   jXj2 D x2 C y2 Ä x2.1 C a2/;

so                                   x p jXj :
This and (5.2.16) imply that                 1 C a2

                              xy     p 1a      jXj;     X 2 D;

                                       1 C a2

so                                     p                   X 2 D:
Therefore,                                1 C a2 1

                        jf .x; y/j Ä 1 a jXj ;

                                       jf .x; y/j <

if X 2 D and                                 p
This implies (5.2.15).                          1 C a2 1

                                     jXj > 1 a :
                          Section 5.2 Continuous Real-Valued Functions of n Variables 309

                        y

                                           y = ax

                                                                       x

                                        Figure 5.2.2
   We leave it to you to define limjXj!1 f .X/ D 1 and limjXj!1 f .X/ D 1 (Exer-
cise 5.2.6).
   We will continue the convention adopted in Section 2.1: "limX!X0 f .X/ exists" means
that limX!X0 f .X/ D L, where L is finite; to leave open the possibility that L D 1, we
will say that "limX!X0 f .X/ exists in the extended reals." A similar convention applies to
limits as jXj ! 1.
   Theorem 5.2.3 remains valid if "limX!X0 " is replaced by "limjXj!1," provided that
D is unbounded. Moreover, (5.2.10), (5.2.11), and (5.2.12) are valid in either version of
Theorem 5.2.3 if either or both of L1 and L2 is infinite, provided that their right sides are
not indeterminate, and (5.2.13) remains valid if L2 ¤ 0 and L1=L2 is not indeterminate.
Continuity
We now define continuity for functions of n variables. The definition is quite similar to the
definition for functions of one variable.
Definition 5.2.6 If X0 is in Df and is a limit point of Df , then we say that f is
continuous at X0 if

                                          lim f .X/ D f .X0/:

                                                           X!X0

   The next theorem follows from this and Definition 5.2.1.
310 Chapter 5 Real-Valued Functions of Several Variables

Theorem 5.2.7 Suppose that X0 is in Df and is a limit point of Df : Then f is con-
tinuous at X0 if and only if for each > 0 there is a i > 0 such that

              jf .X/ f .X0/j <

whenever

          jX X0j < i and X 2 Df :

   In applying this theorem when X0 2 D0f , we will usually omit "and X 2 Df ," it being
understood that Si .X0/ Df .

   We will say that f is continuous on S if f is continuous at every point of S .

Example 5.2.9 From Example 5.2.1, we now see that the function
                                       f .x; y/ D 1 x2 2y2

is continuous on R2.

Example 5.2.10 If we extend the definition of h in Example 5.2.2 so that

          8p
          ^<sin 1 x2 2y2
              p                  ;  x2 C 2y2 < 1;
          h.x; y/ D ^: 1 x2 2y2     x2 C 2y2 D 1;
          1;

then it follows from Example 5.2.2 that h is continuous on the ellipse
                                             x2 C 2y2 D 1:

We will see in Example 5.2.13 that h is also continuous on the interior of the ellipse.

Example 5.2.11 It is impossible to define the function
                                                           xy

                                          f .x; y/ D x2 C y2
at the origin to make it continuous there, since we saw in Example 5.2.3 that

                                               lim f .x; y/

                                                              .x;y/!.0;0/

does not exist.

   Theorem 5.2.3 implies the next theorem, which is analogous to Theorem 2.2.5 and, like
the latter, permits us to investigate continuity of a given function by regarding the function
as the result of addition, subtraction, multiplication, and division of simpler functions.
                          Section 5.2 Continuous Real-Valued Functions of n Variables 311

Theorem 5.2.8 If f and g are continuous on a set S in Rn; then so are f C g; f g;
and fg: Also; f =g is continuous at each X0 in S such that g.X0/ ¤ 0:

Vector-Valued Functions and Composite Functions

Suppose that g1, g2, . . . , gn are real-valued functions defined on a subset T of Rm, and
define the vector-valued function G on T by

                          G.U/ D .g1.U/; g2.U/; : : : ; gn.U// ; U 2 T:

Then g1, g2, . . . , gn are the component functions of G D .g1; g2; : : : ; gn/. We say that

                                 lim G.U/ D L D .L1; L2; : : : ; Ln/

                                             U!U0

if
                                    lim gi .U/ D Li ; 1 Ä i Ä n;

                                                 U!U0

and that G is continuous at U0 if g1, g2, . . . , gn are each continuous at U0.
   The next theorem follows from Theorem 5.1.14 and Definitions 5.2.1 and 5.2.6. We omit

the proof.

Theorem 5.2.9 For a vector-valued function G;
                                             lim G.U/ D L

                                                               U!U0

if and only if for each > 0 there is a i > 0 such that
              jG.U/ Lj < whenever 0 < jU U0j < i and U 2 DG:

Similarly, G is continuous at U0 if and only if for each > 0 there is a i > 0 such that
              jG.U/ G.U0/j < whenever jU U0j < i and U 2 DG:

   The following theorem on the continuity of a composite function is analogous to Theo-
rem 2.2.7.

Theorem 5.2.10 Let f be a real-valued function defined on a subset of Rn; and let
the vector-valued function G D .g1; g2; : : : ; gn/ be defined on a domain DG in Rm: Let

the set  °                            «
         T D U  U 2 DG and G.U/ 2 Df

.Figure 5.2.3/, be nonempty; and define the real-valued composite function

            hDf iG

on T by

         h.U/ D f .G.U//; U 2 T:

Now suppose that U0 is in T and is a limit point of T; G is continuous at U0; and f is
continuous at X0 D G.U0/: Then h is continuous at U0:
312 Chapter 5 Real-Valued Functions of Several Variables

                                                                           R(G) = range of G

                                                                                                                                                             n
                                        m

                                                      G

                      DG
                                                                             Df

                                  Figure 5.2.3

Proof Suppose that    > 0. Since f is continuous at X0 D G.U0/, there is an 1 > 0
such that

                      jf .X/ f .G.U0//j <                                                                                                                       (5.2.17)

if

                      jX G.U0/j < 1 and X 2 Df :                                                                                                                (5.2.18)

Since G is continuous at U0, there is a i > 0 such that

    jG.U/ G.U0/j < 1 if jU U0j < i and U 2 DG:

By taking X D G.U/ in (5.2.17) and (5.2.18), we see that

                      jh.U/ h.U0/j D jf .G.U/ f .G.U0//j <

if
                                     jU U0j < i and U 2 T:

Example 5.2.12 If               p
                      f .s/ D s

and
                                       g.x; y/ D 1 x2 2y2;

then Df D OE0; 1, Dg D R2, and
                                    T D °.x; y/  x2 C 2y2 Ä 1« :

From Theorem 5.2.7 and Example 5.2.1, g is continuous on R2. (We can obtain the same

conclusion by observing that the functions p1.x; y/ D x and p2.x; y/ D y are continuous
on R2 and applying Theorem 5.2.8.) Since f is continuous on Df , the function

                                                            p
                             h.x; y/ D f .g.x; y// D 1 x2 2y2

is continuous on T .
     Section 5.2 Continuous Real-Valued Functions of n Variables 313

Example 5.2.13 If                      p
                          g.x; y/ D 1 x2 2y2

and                              8
                                 <sin s
                          f .s/ D s ; s ¤ 0;
                                 :
                                  1;     s D 0;

then Df D . 1; 1/ and
                               Dg D T D °.x; y/  x2 C 2y2 Ä 1« :

In Example 5.2.12 we saw that g (we called it h there) is continuous on T . Since f is

continuous on Df , the composite function h D f i g defined by

                          8p
                          ^<sin 1 x2 2y2
                              p           ;       x2 C 2y2 < 1;
     h.x; y/ D ^: 1 x2 2y2                        x2 C 2y2 D 1;
                          1;

is continuous on T . This implies the result of Example 5.2.2.

 Bounded Functions

The definitions of bounded above, bounded below, and bounded on a set S are the same for
 functions of n variables as for functions of one variable, as are the definitions of supremum
 and infimum of a function on a set S (Section 2.2). The proofs of the next two theorems are
 similar to those of Theorems 2.2.8 and 2.2.9 (Exercises 5.2.12 and 5.2.13).

Theorem 5.2.11 If f is continuous on a compact set S in Rn; then f is bounded
on S:

Theorem 5.2.12 Let f be continuous on a compact set S in Rn and

                           D inf f .X/;  D sup f .X/:
                          X2S
                                          X2S

Then                      f .X1/ D  and f .X2/ D 
for some X1 and X2 in S:

The next theorem is analogous to Theorem 2.2.10.

Theorem 5.2.13 (Intermediate Value Theorem) Let f be continuous on
a region S in Rn: Suppose that A and B are in S and

                                          f .A/ < u < f .B/:

Then f .C/ D u for some C in S:
314 Chapter 5 Real-Valued Functions of Several Variables

 Proof  If there is no such C, then S D R [ T , where
and
                       °                               «
                       R D X  X 2 S and f .X/ < u

                       °                               «
                       T D X  X 2 S and f .X/ > u :

If X0 2 R, the continuity of f implies that there is a i > 0 such that f .X/ < u if jX X0j <
i and X 2 S . This means that X0 62 T . Therefore, R \ T D ;. Similarly, R \ T D ;.
Therefore, S is disconnected (Definition 5.1.19), which contradicts the assumption that S
is a region (Exercise 5.1.30). Hence, we conclude that f .C/ D u for some C in S .

 Uniform Continuity

The definition of uniform continuity for functions of n variables is the same as for functions
 of one variable; f is uniformly continuous on a subset S of its domain in Rn if for every

   > 0 there is a i > 0 such that

                                           jf .X/ f .X0/j <

 whenever jX X0j < i and X; X0 2 S . We emphasize again that i must depend only on
 and S , and not on the particular points X and X0.

    The proof of the next theorem is analogous to that of Theorem 2.2.12. We leave it to you
 (Exercise 5.2.14).

 Theorem 5.2.14 If f is continuous on a compact set S in Rn; then f is uniformly
 continuous on S:

                       5.2 Exercises

With R replaced by Rn; the following exercises from Sections 2:1 and 2:2 have analogs for
this section: 2.1.5, 2.1.8-2.1.11, 2.1.26, 2.1.28, 2.1.29, 2.1.33, 2.2.8; 2.2.9; 2.2.10, 2.2.15,
2.2.16, 2.2.20, 2.2.29, 2.2.30.

1. Find limX!X0 f .X/ and justify your answer with an -i argument, as required by
      Definition 5.2.1. HINT: See Examples 5.2.1 and 5.2.2:

     (a) f .X/ D 3x C 4y C ´ 2, X0 D .1; 2; 1/

(b) f .X/ D x3         y3
                    x  y , X0 D .1; 1/

(c) f .X/ D sin.x C 4y C 2´/ , X0 D . 2; 1; 1/
                     x C 4y C 2´
             Section 5.2 Continuous Real-Valued Functions of n Variables 315

(d) f .X/ D .x2 C y2/ log.x2 C y2/1=2, X0 D .0; 0/

             sin.x y/
(e) f .X/ D p            ,  X0 D .2; 2/
               xy           X0 D 0

(f ) f .X/ D 1 e 1=jXj,
                  jXj

2. Prove Theorem 5.2.2.

3. If limx!x0 y.x/ D y0 and limx!x0 f .x; y.x// D L, we say that f .x; y/ ap-
      proaches L as .x; y/ approaches .x0; y0/ along the curve y D y.x/.

     (a) Prove: If lim.x;y/!.x0;y0/ f .x; y/ D L, then f .x; y/ approaches L as .x; y/
             approaches .x0; y0/ along any curve y D y.x/ through .x0; y0/.

     (b) We saw in Example 5.2.3 that if

                                                                 xy
                                               f .x; y/ D x2 C y2 ;

      then lim.x;y/!.0;0/ f .x; y/ does not exist. Show, however, that f .x; y/ ap-
      proaches a value La as .x; y/ approaches .0; 0/ along any curve y D y.x/
      that passes through .0; 0/ with slope a. Find La.

(c) Show that the function

                                                        x3y4
                                       g.x; y/ D .x2 C y6/3

approaches 0 as .x; y/ approaches .0; 0/ along a curve as described in (b),
but that lim.x;y/!.0;0/ f .x; y/ does not exist.

4. Determine whether limX!X0 f .X/ D 1.

(a) f .X/ D .x C 2y C 4´/2 j sin.x C 2y C 4´/j , X0 D .2; 1; 0/

(b) f .X/ D p 1 , X0 D .0; 0/
                     xy

             sin 1=x
(c) f .X/ D p         , X0 D .0; 0/
             xy

(d) f .X/ D  4y2 x2
                      3 , X0 D .2; 1/
             .x 2y/

(e) f .X/ D .x C 2y C 4´/2 sin.x C 2y C 4´/ , X0 D .2; 1; 0/

5. Find limjXj!1 f .X/, if it exists.

(a) f .X/ D  log.x2 C 2y2 C 4´2/                          sin.x2 C y2/
                                         (b) f .X/ D p
               x Cy C´22    2
                                                              x2 C y2

(c) f .X/ D e .xCy/2                     (d) f .X/ D e x2 y2
316 Chapter 5 Real-Valued Functions of Several Variables

                8 22          x ¤ y;
                <sin.x y / ;  x D y
(e) f .X/ D : x2 y2

                  1;

6. Define (a) limjXj!1 f .X/ D 1 and (b) limjXj!1 f .X/ D 1.

7. Let  f .X/ D jx1ja1jx2ja2          jxnjan :
                              Xjb

For what nonnegative values of a1, a2, . . . , an, b does limX!0 f .X/ exist in the
extended reals?

8. Let                                  .x2 C y4/3
                              g.X/ D 1 C x6y4 :

Show that limjxj!1 g.x; ax/ D 1 for any real number a. Does

                               lim g.X/ D 1<

                              jXj!1

 9. For each f in Exercise 5.2.1, find the largest set S on which f is continuous or can
        be defined so as to be continuous.

10. Repeat Exercise 5.2.9 for the functions in Exercise 5.2.5.
11. Give an example of a function f on R2 such that f is not continuous at .0; 0/,

        but f .0; y/ is a continuous function of y on . 1; 1/ and f .x; 0/ is a continuous
        function of x on . 1; 1/.

12. Prove Theorem 5.2.11. HINT: See the proof of Theorem 2.2.8:

13. Prove Theorem 5.2.12. HINT: See the proof of Theorem 2.2.9:

14. Prove Theorem 5.2.14. HINT: See the proof of Theorem 2.2.12:
15. Suppose that X 2 Df Rn and X is a limit point of Df . Show that f is continuous

        at X if and only if limk!1 f .Xk/ D f .X/ whenever fXkg is a sequence of points
        in Df such that limk!1 Xk D X. HINT: See the proof of Theorem 4.2.6:

5.3 PARTIAL DERIVATIVES AND THE DIFFERENTIAL

To say that a function of one variable has a derivative at x0 is the same as to say that it
is differentiable at x0. The situation is not so simple for a function f of more than one
variable. First, there is no specific number that can be called the derivative of f at a point
X0 in Rn. In fact, there are infinitely many numbers, called the directional derivatives of
f at X0 (defined below), that are analogous to the derivative of a function of one variable.
Second, we will see that the existence of directional derivatives at X0 does not imply that f
is differentiable at X0, if differentiability at X0 is to imply (as it does for functions of one
variable) that f .X/ f .X0/ can be approximated well near X0 by a simple linear function,
or even that f is continuous at X0.
                                Section 5.3 Partial Derivatives and the Differential 317

   We will now define directional derivatives and partial derivatives of functions of several
variables. However, we will still have occasion to refer to derivatives of functions of one
variable. We will call them ordinary derivatives when we wish to distinguish between them
and the partial derivatives that we are about to define.

Definition 5.3.1 Let ^ be a unit vector and X a point in Rn. The directional derivative
of f at X in the direction of ^ is defined by

                            @f .X/ D lim f .X C t^/ f .X/
                            @^    t !0  t

if the limit exists. That is, @f .X/=@^ is the ordinary derivative of the function

                                  h.t/ D f .X C t^/

at t D 0, if h0.0/ exists.

Example 5.3.1 Let ^ D . 1; 2; 3/ and
                                  f .x; y; ´/ D 3xy´ C 2x2 C ´2:

Then

            h.t/ D f .x C t 1; y C t 2; ´ C t 3/;                                         (5.3.1)
                  D 3.x C t 1/.y C t 2/.´ C t 3/ C 2.x C t 1/2 C .´ C t 3/2

and
            h0.t / D 3 1.y C t 2/.´ C t 3/ C 3 2.x C t 1/.´ C t 3/
                      C 3 3.x C t 1/.y C t 2/ C 4 1.x C t 1/ C 2 3.´ C t 3/:

Therefore,
                 @f .X/ D h0.0/ D .3y´ C 4x/ 1 C 3x´ 2 C .3xy C 2´/ 3:
                   @^

   The directional derivatives that we are most interested in are those in the directions of
the unit vectors

      E1 D .1; 0; : : : ; 0/; E2 D .0; 1; 0; : : : ; 0/; : : : ; En D .0; : : : ; 0; 1/:

(All components of Ei are zero except for the i th, which is 1.) Since X and X C tEi differ
only in the i th coordinate, @f .X/=@Ei is called the partial derivative of f with respect to
xi at X. It is also denoted by @f .X/=@xi or fxi .X/; thus,

      @f .X/ D fx1 .X/ D lim f .x1 C t; x2; : : : ; xn/t f .x1; x2; : : : ; xn/ ;
      @x1                   t !0
318 Chapter 5 Real-Valued Functions of Several Variables

     @f .X/ D fxi .X/ D lim f .x1; : : : ; xi 1; xi C t; xiC1; : : : ; xn/  f .x1; x2; : : : ; xn/

     @xi              t !0                         t

if 2 Ä i Ä n, and

          @f .X/ D fxn .X/ D lim f .x1; : : : ; xn 1; xn C t /t    f .x1; : : : ; xn 1; xn/ ;
          @xn               t !0

if the limits exist.

     If we write X D .x; y/, then we denote the partial derivatives accordingly; thus,

                      @f .x; y/ D fx.x; y/ D lim f .x C h; y/ f .x; y/
                      @x             h!0                        h

and

                      @f .x; y/ D fy.x; y/ D lim f .x; y C h/ f .x; y/ :
                      @y             h!0                        h

   It can be seen from these definitions that to compute fxi .X/ we simply differentiate f
with respect to xi according to the rules for ordinary differentiation, while treating the other

variables as constants.

Example 5.3.2 Let f .x; y; ´/ D 3xy´ C 2x2 C ´2                                                (5.3.2)

as in Example 5.3.1. Taking ^ D E1 (that is, setting 1 D 1 and 2 D 3 D 0) in (5.3.1),

we find that                @f .X/ @f .X/

                            @x    D  @E1   D 3y´ C 4x;

which is the result obtained by regarding y and ´ as constants in (5.3.2) and taking the

ordinary derivative with respect to x. Similarly,

                            @f .X/ @f .X/  D 3x´
                                  D
                            @y       @E2

and

                            @f .X/ @f .X/  D 3xy C 2´:
                                  D
                            @´       @E3

   The next theorem follows from the rule just given for calculating partial derivatives.

Theorem 5.3.2 If fxi .X/ and gxi .X/ exist; then
                           @.f C g/.X/
                                            D fxi .X/ C gxi .X/;
                                 @xi
                               @.f g/.X/
                                   @xi D fxi .X/g.X/ C f .X/gxi .X/;
                                Section 5.3 Partial Derivatives and the Differential 319

and; if g.X/ ¤ 0;

                        @.f =g/.X/ @x D i OEg.X/2 g.X/fxi .X/ f .X/gxi .X/ :

If fxi .X/ exists at every point of a set D, then it defines a function fxi on D. If this

function has a partial derivative with respect to xj on a subset of D, we denote the partial

derivative by               @ Â @f Ã @2f
                           @xj @xi D @xj @xi D fxi xj :

Similarly,               @ Â @2f Ã @3f
                        @xk @xj @xi D @xk@xj @xi D fxi xj xk :

The function obtained by differentiating f successively with respect to xi1; xi2; : : : ; xir is

denoted by                      @r f
                        @xir @xir 1
                                      @xi1 D fxi1       xir 1xir I

it is an r th-order partial derivative of f .

Example 5.3.3 The function
                                        f .x; y/ D 3x2y3 C xy

has partial derivatives everywhere. Its first-order partial derivatives are
                        fx .x; y/ D 6xy3 C y; fy.x; y/ D 9x2y2 C x:

Its second-order partial derivatives are       fyy.x; y/ D 18x2y;
                                               fyx.x; y/ D 18xy2 C 1:
                      fxx .x; y/ D 6y3;
                      fxy .x; y/ D 18xy2 C 1;

There are eight third-order partial derivatives. Some examples are
              fxxy .x; y/ D 18y2; fxyx .x; y/ D 18y2; fyxx .x; y/ D 18y2:

Example 5.3.4 Compute fxx.0; 0/, fyy.0; 0/, fxy.0; 0/, and fyx.0; 0/ if
                           82 2
                           <.x y C xy / sin.x y/        ; .x; y/ ¤ .0; 0/;

               f .x; y/ D  :          x2 C y2

                            0;                                 .x; y/ D .0; 0/:

Solution If .x; y/ ¤ .0; 0/, the ordinary rules for differentiation, applied separately to
x and y, yield

            fx.x; y/ D  .2xy C y2/ sin.x y/ C .x2y C xy2/ cos.x y/

                                               x2 C y2                           (5.3.3)
                        2x.x2y C xy2/ sin.x y/
                                                ; .x; y/ ¤ .0; 0/;
                                .x2 C y2/2
320 Chapter 5 Real-Valued Functions of Several Variables

and              .x2 C 2xy/ sin.x y/ .x2y C xy2/ cos.x y/

     fy.x; y/ D                              x2 C y2

                 2y.x2y C xy2/ sin.x y/                                     (5.3.4)

                      .x2 C y2/2                ; .x; y/ ¤ .0; 0/:

These formulas do not apply if .x; y/ D .0; 0/, so we find fx.0; 0/ and fy.0; 0/ from their
definitions as difference quotients:

     fx.0; 0/ D lim   f .x; 0/ f .0; 0/               D lim  00     D 0;

                 x!0                         x        x!0 x

     fy.0; 0/ D lim   f .0; y/ f .0; 0/               D lim  00     D 0:

                 y!0                         y        y!0 y

Setting y D 0 in (5.3.3) and (5.3.4) yields

                 fx.x; 0/ D 0; fy.x; 0/ D sin x; x ¤ 0;

so

     fxx.0; 0/ D lim fx.x; 0/ fx.0; 0/ D lim 0 0 D 0;
                 x!0     x                            x!0 x

     fyx.0; 0/ D lim fy.x; 0/ fy .0; 0/ D lim sin x 0 D 1:
                 x!0     x                            x!0 x

Setting x D 0 in (5.3.3) and (5.3.4) yields

                 fx.0; y/ D sin y; fy.0; y/ D 0; y ¤ 0;

so

     fxy.0; 0/ D lim fx.0; y/ fx.0; 0/ D lim                 sin y  0
                 y!0  y                               y!0       y     D 1;

     fyy.0; 0/ D lim fy.0; y/ fy .0; 0/ D lim 0 0 D 0:
                 y!0  y                               y!0 y

   This example shows that fxy.X0/ and fyx.X0/ may differ. However, the next theorem
shows that they are equal if f satisfies a fairly mild condition.

Theorem 5.3.3 Suppose that f; fx; fy; and fxy exist on a neighborhood N of .x0; y0/;
and fxy is continuous at .x0; y0/: Then fyx .x0; y0/ exists, and

                      fyx .x0; y0/ D fxy .x0; y0/:                          (5.3.5)

Proof Suppose that > 0. Choose i > 0 so that the open square
                                    Section 5.3 Partial Derivatives and the Differential 321

              Si D .x; y/  jx x0j < i; jy y0j < i°                    «

is in N and

              jfxy.bx; by/ fxy.x0; y0/j <                   if .bx; by/ 2 Si:          (5.3.6)

This is possible because of the continuity of fxy at .x0; y0/. The function

A.h; k/ D f .x0 C h; y0 C k/ f .x0 C h; y0/ f .x0; y0 C k/ C f .x0; y0/ (5.3.7)

is defined if i < h, k < i; moreover,

                                 A.h; k/ D .x0 C h/ .x0/;                              (5.3.8)

where

                                 .x/ D f .x; y0 C k/ f .x; y0/:

Since

              0.x/ D fx .x; y0 C k/ fx .x; y0/; jx x0j < i;

(5.3.8) and the mean value theorem imply that

              A.h; k/ D OEfx.bx; y0 C k/ fx.bx; y0/ h;                                 (5.3.9)

where bx is between x0 and x0 C h. The mean value theorem, applied to fx.bx; y/ (where bx
is regarded as constant), also implies that

              fx .bx; y0 C k/ fx.bx; y0/ D fxy.bx; by/k;

where by is between y0 and y0 C k. From this and (5.3.9),

                                    A.h; k/ D fxy.bx; by/hk:

Now (5.3.6) implies that

                                                                      if 0 < jhj; jkj < i:
 A.h; k/  hk                                  fxy .x0; y0/ <                              (5.3.10)
              fxy.x0; y0/ D fxy .bx; by/

Since (5.3.7) implies that

              lim A.h; k/ D lim f .x0 C h; y0 C k/ f .x0 C h; y0/
              k!0 hk                k!0                 hk

                                    lim f .x0; y0 C k/ f .x0; y0/
                                    k!0                 hk

                                 D fy.x0 C h; y0/       fy.x0; y0/ ;
                                                     h

it follows from (5.3.10) that    fy .x0; y0/                          if 0 < jhj < i:
                                                            
             fy .x0 C h; y0/  h               fxy.x0; y0/ Ä
322 Chapter 5 Real-Valued Functions of Several Variables

Taking the limit as h ! 0 yields

                                  jfyx.x0; y0/ fxy .x0; y0/j Ä :

Since is an arbitrary positive number, this proves (5.3.5).
   Theorem 5.3.3 implies the following theorem. We leave the proof to you (Exercises 5.3.10

and 5.3.11).

Theorem 5.3.4 Suppose that f and all its partial derivatives of order Ä r are contin-
uous on an open subset S of Rn: Then

                         fxi1 xi2 ;:::;xir .X/ D fxj1 xj2 ;:::;xjr .X/; X 2 S;    (5.3.11)
if each of the variables x1; x2; . . . ; xn appears the same number of times in

fxi1; xi2 ; : : : ; xir g and fxj1; xj2; : : : ; xjr g:

If this number is rk; we denote the common value of the two sides of (5.3.11) by

                          @r f .X/   rn ;                                         (5.3.12)

                          r1 r2                                                   (5.3.13)
                          @x1 @x2 @xn                                             (5.3.14)

it being understood that

                          0 Ä rk Ä r; 1 Ä k Ä n;

                                        r1 C r2 C C rn D r;
and; if rk D 0; we omit the symbol @x0k from the "denominator" of (5.3.12):

   For example, if f satisfies the hypotheses of Theorem 5.3.4 with k D 4 at a point X0 in
Rn (n 2), then

   fxxyy .X0/ D fxyxy .X0/ D fxyyx .X0/ D fyyxx .X0/ D fyxyx .X0/ D fyxxy .X0/;

and their common value is denoted by
                                                @4f .X0/
                                                 @x2@y2 :

   It can be shown (Exercise 5.3.12) that if f is a function of .x1; x2; : : : ; xn/ and .r1; r2; : : : ; rn/
is a fixed ordered n-tuple that satisfies (5.3.13) and (5.3.14), then the number of partial
derivatives fxi1 xi2 xir that involve differentiation ri times with respect to xi , 1 Ä i Ä n,
equals the multinomial coefficient

                                                     rS
                                                              :

                                              r1Sr2S rnS
                      Section 5.3 Partial Derivatives and the Differential 323

Differentiable Functions of Several Variables

A function of several variables may have first-order partial derivatives at a point X0 but fail
to be continuous at X0. For example, if

                                   ( xy          .x; y/ ¤ .0; 0/;         (5.3.15)
                      f .x; y/ D x2 C y2 ;       .x; y/ D .0; 0/;

                                     0;

then

      fx.0; 0/ D lim                f .h; 0/ f .0; 0/  D lim  00    D0

                      h!0           h                    h!0 h

and

      fy.0; 0/ D lim                f .0; k/ f .0; 0/  D lim  00    D 0;

                      k!0           k                    k!0 k

but f is not continous at .0; 0/. (See Examples 5.2.3 and 5.2.11.) Therefore, if differentia-

bility of a function of several variables is to be a stronger property than continuity, as it is

for functions of one variable, the definition of differentiability must require more than the

existence of first partial derivatives. Exercise 2.3.1 characterizes differentiability of a func-

tion f of one variable in a way that suggests the proper generalization: f is differentiable

at x0 if and only if

                             f .x/  f .x0/ m.x            x0/ D 0
                       lim            x x0

                      x!x0

for some constant m, in which case m D f 0.x0/.

     The generalization to functions of n variables is as follows.

Definition 5.3.5 A function f is differentiable at

                      X0 D .x10; x20; : : : ; xn0//

if X0 2 D0f and there are constants m1, m2, . . . ; mn such that

                             f .X/  f .X0/   Xn           xi 0 /          (5.3.16)
                       lim               jX      mi .xi         D 0:

                      X!X0                   i D1

                                             X0j

Example 5.3.5 Let                   f .x; y/ D x2 C 2xy:

We will show that f is differentiable at any point .x0; y0/, as follows:
324 Chapter 5 Real-Valued Functions of Several Variables

f .x; y/    f .x0; y0/ D x2 C 2xy x02           2x0y0
                        D x2 x02 C 2.xy          x0y0 /

            D .x x0/.x C x0/ C 2.xy                      x0y/ C 2.x0y     x0y0/

            D .x C x0 C 2y/.x x0/ C 2x0.y y0/

            D 2.x0 C y0/.x x0/ C 2x0.y y0/

            C .x x0/.x x0 C 2y 2y0/

            D m1.x x0/ C m2.y y0/ C .x x0/.x x0 C 2y 2y0/;

where

          m1 D 2.x0 C y0/ D fx .x0; y0/ and m2 D 2x0 D fy.x0; y0/:               (5.3.17)

Therefore,

jf .x; y/ f .x0; y0/ m1.x x0/ m2.y y0/j D jx x0jj.x x0/ C 2.y y0/j
            jX X0j                                       p jX X0j

                                                         Ä 5jX X0j;

by Schwarz's inequality. This implies that

                   f .x; y/  f .x0; y0/ m1.x x0/              m2.y  y0/ D 0;
             lim                         jX X0j

            X!X0

so f is differentiable at .x0; y0/.

   From (5.3.17), m1 D fx.x0; y0/ and m2 D fy.x0; y0/ in Example 5.3.5. The next
theorem shows that this is not a coincidence.

Theorem 5.3.6 If f is differentiable at X0 D .x10; x20; : : : ; xn0/; then fx1.X0/;
fx2 .X0/; . . . ; fxn .X0/ exist and the constants m1; m2; . . . ; mn in (5.3.16) are given by

                             mi D fxi .X0/; 1 Ä i Ä nI                           (5.3.18)

that is;                                     Xn
                                                 fxi .X0/.xi
                   f .X/             f .X0/                   xi 0/
             lim                                                    D 0:
                                             i D1
            X!X0
                                             jX X0j

Proof Let i be a given integer in f1; 2; : : : ; ng. Let X D X0 C tEi , so that xi D xi0 C t,

xj D xj 0 if j ¤ i , and jX X0j D jtj. Then (5.3.16) and the differentiability of f at X0

imply that

            lim f .X0 C tEi / f .X0/                     mi t D 0:
            t !0                             t
                              Section 5.3 Partial Derivatives and the Differential 325

Hence,

        lim f .X0 C tEi /                       f .X0/ D mi :
        t !0                  t

This proves (5.3.18), since the limit on the left is fxi .X0/, by definition.
   A linear function is a function of the form

        L.X/ D m1x1 C m2x2 C C mnxn;                                           (5.3.19)

where m1, m2, . . . ; mn are constants. From Definition 5.3.5, f is differentiable at X0 if
and only if there is a linear function L such that f .X/ f .X0/ can be approximated so
well near X0 by

                                    L.X/ L.X0/ D L.X X0/

that

        f .X/ f .X0/ D L.X X0/ C E.X/.jX X0j/;                                 (5.3.20)

where

                               lim E.X/ D 0:                                   (5.3.21)

                              X!X0

Theorem 5.3.7 If f is differentiable at X0; then f is continuous at X0.

Proof From (5.3.19) and Schwarz's inequality,
                                     jL.X X0/j Ä M jX X0j;

where

                              M D .m21 C m22 C  C m2n/1=2:

This and (5.3.20) imply that

        jf .X/ f .X0/j Ä .M C jE.X/j/jX X0j;

which, with (5.3.21), implies that f is continuous at X0.

   Theorem 5.3.7 implies that the function f defined by (5.3.15) is not differentiable at
.0; 0/, since it is not continuous at .0; 0/. However, fx.0; 0/ and fy.0; 0/ exist, so the
converse of Theorem 5.3.7 is false; that is, a function may have partial derivatives at a
point without being differentiable at the point.

The Differential

Theorem 5.3.7 implies that if f is differentiable at X0, then there is exactly one linear
function L that satisfies (5.3.20) and (5.3.21):

                     L.X/ D fx1 .X0/x1 C fx2 .X0/x2 C C fxn .X0/xn:
326 Chapter 5 Real-Valued Functions of Several Variables

   This function is called the differential of f at X0. We will denote it by dX0f and its
value by .dX0 f /.X/; thus,

.dX0 f /.X/ D fx1 .X0/x1 C fx2 .X0/x2 C C fxn .X0/xn:                 (5.3.22)

In terms of the differential, (5.3.16) can be rewritten as

       f .X/  f .X0/ .dX0 f /.X                             X0/ D 0:
 lim               jX X0j

X!X0

   For convenience in writing dX0f , and to conform with standard notation, we introduce
the function dxi , defined by

                                              dxi .X/ D xi I

that is, dxi is the function whose value at a point in Rn is the i th coordinate of the point. It
is the differential of the function gi .X/ D xi . From (5.3.22),

dX0 f D fx1 .X0/ dx1 C fx2 .X0 dx2 C C fxn .X0/ dxn:                  (5.3.23)

   If we write X D .x; y; : : : ; /, then we write
                             dX0 f D fx .X0/ dx C fy.X0/ dy C ;

where dx, dy, . . . are the functions defined by
                                   dx.X/ D x; dy.X/ D y; : : :

    When it is not necessary to emphasize the specific point X0, (5.3.23) can be written more
 simply as

                             df D fx1 dx1 C fx2 dx2 C C fxn dxn:
 When dealing with a specific function at an arbitrary point of its domain, we may use the
 hybrid notation

                       df D fx1 .X/ dx1 C fx2 .X/ dx2 C C fxn .X/ dxn:

 Example 5.3.6 We saw in Example 5.3.5 that the function
                                           f .x; y/ D x2 C 2xy

 is differentiable at every X in Rn, with differential

                                     df D .2x C 2y/ dx C 2x dy:

 To find dX0 f with X0 D .1; 2/, we set x0 D 1 and y0 D 2; thus,

                                            dX0 f D 6 dx C 2 dy
and

                              .dX0 f /.X X0/ D 6.x 1/ C 2.y 2/:
                              Section 5.3 Partial Derivatives and the Differential 327

Since f .1; 2/ D 5, the differentiability of f at .1; 2/ implies that

                              f .x; y/ 5 6.x 1/ 2.y        2/
                 lim          p                               D 0:
                 .x;y/!.1;2/   .x 1/2 C .y 2/2

Example 5.3.7 The differential of a function f D f .x/ of one variable is given by
                                          dx0 f D f 0.x0/ dx;

where dx is the identity function; that is,

                                 dx.t/ D t:

For example, if                f .x/ D 3x2 C 5x3;
then                          df D .6x C 15x2/ dx:
If x0 D 1, then

                 dx0 f D 9 dx; .dx0 f /.x x0/ D 9.x C 1/;

and, since f . 1/ D 2,

                              lim f .x/ C 2 9.x C 1/ D 0:
                        x! 1     xC1

   Unfortunately, the notation for the differential is so complicated that it obscures the
simplicity of the concept. The peculiar symbols df , dx, dy, etc., were introduced in
the early stages of the development of calculus to represent very small ("infinitesimal")
increments in the variables. However, in modern usage they are not quantities at all, but

                                                                                              Rb
linear functions. This meaning of the symbol dx differs from its meaning in a f .x/ dx,
where it serves merely to identify the variable of integration; indeed, some authors omit it

                                             Rb
in the latter context and write simply a f .

   Theorem 5.3.7 implies the following lemma, which is analogous to Lemma 2.3.2. We
leave the proof to you (Exercise 5.3.13).

Lemma 5.3.8 If f is differentiable at X0; then
                     f .X/ f .X0/ D .dX0 f /.X X0/ C E.X/jX X0j;

where E is defined in a neighborhood of X0 and
                                       lim E.X/ D E.X0/ D 0:

                                                      X!X0

   Theorems 5.3.2 and 5.3.7 and the definition of the differential imply the following
theorem.
328 Chapter 5 Real-Valued Functions of Several Variables

Theorem 5.3.9 If f and g are differentiable at X0; then so are f C g and fg. The
same is true of f =g if g.X0/ ¤ 0. The differentials are given by

       dX0 .f C g/ D dX0 f C dX0 g;

       dX0 .fg/ D f .X0/dX0 g C g.X0/dX0 f;

and Â f Ã g.X0/dX0 f f .X0/dX0 g
       dX0 g D                                    OEg.X0/2 :

The next theorem provides a widely applicable sufficient condition for differentiability.

Theorem 5.3.10 If fx1 ; fx2 ; . . . ; fxn exist on a neighborhood of X0 and are contin-
uous at X0; then f is differentiable at X0:

Proof Let X0 D .x10; x20; : : : ; xn0/ and suppose that > 0. Our assumptions imply

that there is a i > 0 such that fx1 ; fx2 ; : : : ; fxn are defined in the n-ball

                                      °                           «
       Si.X0/ D X  jX X0j < i

and                                               X0j < i;        1 Ä j Ä n:       (5.3.24)
             jfxj .X/ fxj .X0/j < if jX

Let X D .x1; x; : : : ; xn/ be in Si.X0/. Define

       Xj D .x1; : : : ; xj ; xj C1;0; : : : ; xn0/; 1 Ä j Ä n 1;

and Xn D X. Thus, for 1 Ä j Ä n, Xj differs from Xj 1 in the j th component only, and
the line segment from Xj 1 to Xj is in Si .X0/. Now write

f .X/  f .X0/ D f .Xn/                            Xn                 f .Xj 1/;     (5.3.25)
                                      f .X0/ D OEf .Xj /

                                                       j D1

and consider the auxiliary functions

g1.t / D f .t; x20; : : : ; xn0/;                                                  (5.3.26)
gj .t / D f .x1; : : : ; xj 1; t; xj C1;0; : : : ; xn0/; 2 Ä j Ä n 1;
gn.t/ D f .x1; : : : ; xn 1; t/;

where, in each case, all variables except t are temporarily regarded as constants. Since

       f .Xj / f .Xj 1/ D gj .xj / gj .xj 0/;

the mean value theorem implies that

       f .Xj /  f .Xj                 1/  D         0  .  j /.xj     xj 0/;

                                                  gj
                                Section 5.3 Partial Derivatives and the Differential 329

where j is between xj and xj 0. From (5.3.26),

                                     0  .  j/  D  fxj .bXj /;

                                   gj

where bXj is on the line segment from Xj 1 to Xj . Therefore,

                         f .Xj / f .Xj 1/ D fxj .bXj /.xj xj 0/;

and (5.3.25) implies that

f .X/              Xn                         xj 0/
       f .X0/ D fxj .bXj /.xj
                                                       Xn           fxj .X0/.xj  xj 0/:
                        j D1                  xj 0/ C OEfxj .bXj /

                   Xn                                      j D1
               D fxj .X0/.xj

                        j D1

From this and (5.3.24),

                                                    
                                                    
f .X/ f .X0/               Xn   fxj .X0/.xj xj 0/ Ä   Xn       jxj xj 0j Ä n jX X0j;

                         j D1                         j D1

which implies that f is differentiable at X0.

   We say that f is continuously differentiable on a subset S of Rn if S is contained in an
open set on which fx1 , fx2 , . . . ; fxn are continuous. Theorem 5.3.10 implies that such a
function is differentiable at each X0 in S .

Example 5.3.8 If                              x2 C y2
                                f .x; y/ D x y ;
then
                            2x  x2 C y2                             2y  x2 C y2
                                .x y/2         and fy.x; y/ D x y C .x y/2 :
           fx.x; y/ D x y

Since fx and fy are continuous on

                                S D .x; y/  x ¤ y ;°  «

f is continuously differentiable on S .

Example 5.3.9 The conditions of Theorem 5.3.10 are not necessary for differentiabil-

ity; that is, a function may be differentiable at a point X0 even if its first partial derivatives

are not continuous at X0. For example, let

                           8                  y/2 sin 1 ;      x ¤ y;
                           <                           xy      x D y:

                             .x
              f .x; y/ D :

                             0;
330 Chapter 5 Real-Valued Functions of Several Variables

Then                                               1           1
                                         y/ sin
                    fx.x; y/ D 2.x                       cos  xy    ;  x ¤ y;
                                                xy

and                                                              h2 sin.1= h/ 0

       fx.x; x/ D lim    f .x C h; x/ f .x; x/        D lim                       D 0;

                    h!0                  h               h!0           h

so fx exists for all .x; y/, but is not continuous on the line y D x. The same is true of fy ,

since                                       1                    1

                 fy.x; y/ D 2.x y/ sin x y C cos x y ; x ¤ y;

and                                                            k2 sin. 1= k/ 0

       fy.x; x/ D lim    f .x; x C k/ f .x; x/        D lim                       D 0:

                    k!0                  k               k!0           k

Now,                                                  8             2
    f .x; y/                                          < .x y/             1
                f .0; 0/ fx.0; 0/x       fy.0; 0/y D px2 C y2 sin x y ;           x ¤ y;
                      p                               :                           x D y;
                         x2 C y2                         0;

and Schwarz's inequality implies that

                    y/2                     2.x2 C y2/        p
                                       
                .x            1                          D 2 x2 C y2;
              p          sin           Ä p                                x ¤ y:
               x2 C y2 x y                  x2 C y2

Therefore,

                             f .x; y/    f .0; 0/ fx.0; 0/x       fy.0; 0/y D 0;
                    lim                        p
                                                  x2 C y2
                .x;y/!.0;0/

so f is differentiable at .0; 0/, but fx and fy are not continuous at .0; 0/.

Geometric Interpretation of Differentiability

In Section 2.3 we saw that if a function f of one variable is differentiable at x0, then the
curve y D f .x/ has a tangent line

                               y D T .x/ D f .x0/ C f 0.x0/.x x0/

that approximates it so well near x0 that

                                    lim     f .x/ T .x/  D 0:

                                 x!x0 x x0

Moreover, the tangent line is the "limit" of the secant line through the points .x1; f .x0//
and .x0; f .x0// as x1 approaches x0.
                                    Section 5.3 Partial Derivatives and the Differential 331

                                    z

                                                                    z = f (x, y)

                                                                                   y
                                                       D

x

                     Figure 5.3.1

Differentiability of a function of n variables has an analogous geometric interpretation.

We will illustrate it for n D 2. If f is defined in a region D in R2, then the set of points

.x; y; ´/ such that

                     ´ D f .x; y/; .x; y/ 2 D;                                             (5.3.27)

is a surface in R3 (Figure 5.3.1).

                                    z                    Tangen
                                          z = f (x,y)          t plane

                                                                                        y
                                                       (x0, y0)

                     x

                                         Figure 5.3.2

If f is differentiable at X0 D .x0; y0/, then the plane

´ D T .x; y/ D f .X0/ C fx.X0/.x x0/ C fy.X0/.y y0/                                        (5.3.28)

intersects the surface (5.3.27) at .x0; y0; f .x0; y0// and approximates the surface so well
near .x0; y0/ that
332 Chapter 5 Real-Valued Functions of Several Variables

                                 lim p f .x; y/ T .x; y/ D 0
                            .x;y/!.x0;y0/ .x x0/2 C .y y0/2

(Figure 5.3.2). Moreover, (5.3.28) is the only plane in R3 with these properties (Exer-
cise 5.3.25). We say that this plane is tangent to the surface ´ D f .x; y/ at the point
.x0; y0; f .x0; y0//. We will now show that it is the "limit" of "secant planes" associated
with the surface ´ D f .x; y/, just as a tangent line to a curve y D f .x/ in R3 is the limit
of secant lines to the curve (Section 2.3).

   Let Xi D .xi ; yi / .i D 1; 2; 3/. The equation of the "secant plane" through the points
.xi ; yi ; f .xi ; yi // .i D 1; 2; 3/ on the surface ´ D f .x; y/ (Figure 5.3.3) is of the form

         ´ D f .X0/ C A.x x0/ C B.y y0/;                                    (5.3.29)

where A and B satisfy the system

         f .X1/ D f .X0/ C A.x1 x0/ C B.y1 y0/;
         f .X2/ D f .X0/ C A.x2 x0/ C B.y2 y0/:

Solving for A and B yields

     A D .f .X1/ f .X0//.y2 y0/ .f .X2/ f .X0//.y1 y0/                      (5.3.30)
                     .x1 x0/.y2 y0/ .x2 x0/.y1 y0/

and

     B D .f .X2/ f .X0//.x1 x0/ .f .X1/ f .X0//.x2 x0/                      (5.3.31)
                     .x1 x0/.y2 y0/ .x2 x0/.y1 y0/

if

         .x1 x0/.y2 y0/ .x2 x0/.y1 y0/ ¤ 0;                                 (5.3.32)

which is equivalent to the requirement that X0, X1, and X2 do not lie on a line (Exer-
cise 5.3.23). If we write

         X1 D X0 C t U and X2 D X0 C t V;

where U D .u1; u2/ and V D .v1; v2/ are fixed nonzero vectors (Figure 5.3.3), then
(5.3.30), (5.3.31), and (5.3.32) take the more convenient forms

         f .X0 C tU/              f .X0/ v2   f .X0 C tV/     f .X0/ u2
                                                                         ;
     AD                     t          u1 v2               t                (5.3.33)
                                  f .X0/ u1   u2 v1           f .X0/ v1     (5.3.34)
         f .X0 C tV/                          f .X0 C tU/                ;
                                       u1 v2
     BD                     t                              t
                                              u2 v1

and
                                           u1v2 u2v1 ¤ 0:
                      Section 5.3 Partial Derivatives and the Differential 333

                        z

                                                                            y

                                        X0             X  2

                                                                         V

                                                  X1
       x

                                                                      U

                                        Figure 5.3.3

    If f is differentiable at X0, then

    f .X/ f .X0/ D fx .X0/.x x0/ C fy.X0/.y y0/ C .X/jX X0j; (5.3.35)

where

                                         lim .X/ D 0:                          (5.3.36)

                                        X!X0

Substituting first X D X0 C tU and then X D X0 C tV in (5.3.35) and dividing by t yields

       f .X0 C tU/    f .X0/ D fx .X0/u1 C fy.X0/u2 C E1.t /jUj                (5.3.37)
                   t

and    f .X0 C tV/    f .X0/ D fx .X0/v1 C fy.X0/v2 C E2.t /jVj;               (5.3.38)
where              t

       E1.t/ D .X0 C tU/jtj=t and E2.t/ D .X0 C tV/jtj=t;

so

                      lim Ei .t/ D 0; i D 1; 2;                                (5.3.39)

                      t !0

because of (5.3.36). Substituting (5.3.37) and (5.3.38) into (5.3.33) and (5.3.34) yields

       A D fx .X0/ C 1.t /; B D fy.X0/ C 2.t /;                                (5.3.40)

where
334 Chapter 5 Real-Valued Functions of Several Variables

                      1.t / D v2jUjE1.t /              u2jVjE2.t /
                                         u1v2          u2v1

and                                                                                 (5.3.41)
                                2.t/ D u1jVjE2.t/ v1jUjE1.t/ ;
                                                    u1v2 u2v1

so
                                      lim i .t/ D 0; i D 1; 2;

                                                      t !0

because of (5.3.39).

From (5.3.29) and (5.3.40), the equation of the secant plane is

´ D f .X0/ C OEfx .X0/ C 1.t /.x x0/ C OEfy.X0/ C 2.t /.y y0/:

Therefore, because of (5.3.41), the secant plane "approaches" the tangent plane (5.3.28) as
t approaches zero.

Maxima and Minima

We say that X0 is a local extreme point of f if there is a i > 0 such that

                             f .X/ f .X0/

does not change sign in Si .X0/ \ Df . More specifically, X0 is a local maximum point if
                                             f .X/ Ä f .X0/

or a local minimum point if

                             f .X/ f .X0/

for all X in Si.X0/ \ Df .
   The next theorem is analogous to Theorem 2.3.7.

Theorem 5.3.11 Suppose that f is defined in a neighborhood of X0 in Rn and fx1 .X0/;
fx2 .X0/; . . . ; fxn .X0/ exist: Let X0 be a local extreme point of f: Then

                             fxi .X0/ D 0; 1 Ä i Ä n:                               (5.3.42)

Proof Let

E1 D .1; 0; : : : ; 0/; E2 D .0; 1; 0; : : : ; 0/; : : : ; En D .0; 0; : : : ; 1/;

and
                                gi .t/ D f .X0 C tEi /; 1 Ä i Ä n:

Then gi is differentiable at t D 0, with

                               0          .0/  D  fxi  .X0 /

                             gi
                                   Section 5.3 Partial Derivatives and the Differential 335

(Definition 5.3.1). Since X0 is a local extreme point of f , t0 D 0 is a local extreme point

of  gi  .  Now  Theorem  2.3.7  implies  that  g0   .0/  D  0,   and  this  implies  (5.3.42).

                                                 i

    The converse of Theorem 5.3.11 is false, since (5.3.42) may hold at a point X0 that is

not a local extreme point of f . For example, let X0 D .0; 0/ and

                                         f .x; y/ D x3 C y3:

We say that a point X0 where (5.3.42) holds is a critical point of f . Thus, if f is defined
in a neighborhood of a local extreme point X0, then X0 is a critical point of f ; however, a
critical point need not be a local extreme point of f .

   The use of Theorem 5.3.11 for finding local extreme points is covered in calculus, so we
will not pursue it here.

                                         5.3 Exercises

1. Calculate @f .X/=@^.                                                  r!

                         2                                       1          2
           (a) f .x; y/ D x C 2xy cos x, ^ D p ;
                                                         Â3                 3
                                                                                 Ã
                                                            1 11
           (b) f .x; y; ´/ D e  xCy 2 C2´   , ^D p ; p ;p

                                         Â                       3 3Ã 3
                                            1            1            1
           (c) f .X/ D jXj , ^ D p ; p ; ; p2

                                               n         n            n

           (d) f .x; y; ´/ D log.1 C x C y C ´/, ^ D .0; 1; 0/

2. Let                                       8
                                f .x; y/ D x2 C y2 < xy sin x ;
                                                                 .x; y/ ¤ .0; 0/;
                                             :                   .x; y/ D .0; 0/;
                                               0;

      and let ^ D . 1; 2/ be a unit vector. Find @f .0; 0/=@^.

3. Find @f .X0/=@^, where ^ is the unit vector in the direction of X1 X/.

     (a) f .x; y; ´/ D sin xy´; X0 D .1; 1; 2/, X1 D .3; 2; 1/
     (b) f .x; y; ´/ D e .x2Cy2C2´/; X0 D .1; 0; 1/, X1 D .2; 0; 1/
     (c) f .x; y; ´/ D log.1 C x C y C ´/; X0 D .1; 0; 1/, X1 D .3; 0; 1/
     (d) f .X/ D jXj4; X0 D 0, X1 D .1; 1; : : : ; 1/

4. Give a geometrical interpretation of the directional derivative @f .x0; y0/=@^ of a
      function of two variables.

5. Find all first-order partial derivatives.
      (a) f .x; y; ´/ D log.x C y C 2´/ (b) f .x; y; ´/ D x2 C 3xy´ C 2xy

           (c) f .x; y; ´/ D xey´                        (d) f .x; y; ´/ D ´ C sin x2y

6. Find all second-order partial derivatives of the functions in Exercise 5.3.5.
336 Chapter 5 Real-Valued Functions of Several Variables

7. Find all second-order partial derivatives of the following functions at .0; 0/.
                8 22
                <xy.x y
(a) f .x; y/ D x2 C y2 ; .x; y/ ¤ .0; 0/;
                :
                 0;         .x; y/ D .0; 0/
                ( x2 tan 1 y y2 tan 1 x ; x ¤ 0; y ¤ 0;
(b) f .x; y/ D           x  y

                 0;                        x D 0 or y D 0

(Here j tan 1 uj < =2.)

8. Find a function f D f .x; y/ such that fxy exists for all .x; y/, but fy exists
      nowhere.

9. Let u and v be functions of two variables with continuous second-order partial
      derivatives in a region S . Suppose that ux D vy and uy D vx in S . Show
      that
                                      uxx C uyy D vxx C vyy D 0

in S.

10. Let f be a function of .x1; x2; : : : ; xn/ .n 2/ such that fxi , fxj , and fxi xj .i ¤
        j / exist on a neighborhood of X0 and fxi xj is continuous at X0. Use Theorem 5.3.3
        to prove that fxj xi .X0/ exists and equals fxi xj .X0/.

11. Use Exercise 5.3.10 and induction on r to prove Theorem 5.3.4.

12. Let r1; r2; : : : ; rn be nonnegative integers such that

                         r1 C r2 C C rn D r 0:

(a) Show that

       .´1 C ´2 C                       X             r S ´r1 r2 r 1 ´2 ´nn;
                            C ´n/r D
                            r r1Sr2S rnS

               P
       where r denotes summation over all n-tuples .r1; r2; : : : ; rn/ that satisfy

       the stated conditions. HINT: This is obvious if n D 1; and it follows from

       Exercise 1.2.19 if n D 2: Use induction on n:

(b) Show that there are

                            rS

                            r1Sr2S rnS

      ordered n-tuples of integers .i1; i2; : : : ; in/ that contain r1 ones, r2 twos, . . . ,
      and rn n's.
(c) Let f be a function of .x1; x2; : : : ; xn/. Show that there are

                                                             rS
                                                      r1Sr2S rnS

               partial derivatives fxi1 xi2 xir that involve differentiation ri times with respect
               to xi , for i D 1; 2; : : : ; n.
13. Prove Lemma 5.3.8.
                            Section 5.3 Partial Derivatives and the Differential 337

14. Show that the function    82
                              < xy
       f .x; y/ D x6 C 2y2 ; .x; y/ ¤ .0; 0/;
                              :
                               0;                 .x; y/ D .0; 0/;

        has a directional derivative in the direction of an arbitrary unit vector ^ at .0; 0/, but
        f is not continuous at .0; 0/.

15. Prove: If fx and fy are bounded in a neighborhood of .x0; y0/, then f is continuous
        at .x0; y0/.

16. Show directly from Definition 5.3.5 that f is differentiable at X0.
       (a) f .x; y/ D 2x2 C 3xy C y2, X0 D .1; 2/
       (b) f .x; y; ´/ D 2x2 C 3x C 4y´, X0 D .1; 1; 1/
       (c) f .X/ D jXj2, X0 arbitrary

17. Suppose that fx exists on a neighborhood of .x0; y0/ and is continuous at .x0; y0/,
        while fy merely exists at .x0; y0/. Show that f is differentiable at .x0; y0/.

18. Find df and dX0 f , and write .dX0 f /.X X0/.
       (a) f .x; y/ D x3 C 4xy2 C 2xy sin x, X0 D .0; 2/
       (b) f .x; y; ´/ D e .xCyC´/, X0 D .0; 0; 0/
       (c) f .X/ D log.1 C x1 C 2x2 C 3x3 C C nxn/, X0 D 0
       (d) f .X/ D jXj2r, X0 D .1; 1; 1; : : : ; 1/

19. (a) Suppose that f is differentiable at X0 and ^ D . 1; 2; : : : ; n/ is a unit
               vector. Show that

       @f .X0/ D fx1 .X0/ 1 C fx2 .X0/ 2 C                C fxn .X0/ n:
         @^

       (b) For what unit vector ^ does @f .X0/=@^ attain its maximum value?
20. Let f be defined on Rn by

       f .X/ D g.x1/ C g.x2/ C C g.xn/;

where                               u2 ( sin 1 ;

                            g.u/ D         u      u ¤ 0;
                                                  u D 0:
                                    0;

Show that f is differentiable at .0; 0; : : : ; 0/, but fx1 , fx2 , . . . , fxn are all discon-
tinuous at .0; 0; : : : ; 0/.

21. The purpose of this exercise is to show that if f , fx and fy exist on a neighborhood

N of .x0; y0/ and fx and fy are differentiable at .x0; y0/, then fxy .x0; y0/ D

fyx.x0; y0/. Suppose that the open square

       °                    .x; y/  jx x0j < jhj; jy y0j < jhj  «
338 Chapter 5 Real-Valued Functions of Several Variables

is in N . Consider

B.h/ D f .x0 C h; y0 C h/ f .x0 C h; y0/ f .x0; y0 C h/ C f .x0; y0/:

(a) Use the mean value theorem as we did in the proof of Theorem 5.3.3 to write

                    B.h/ D OEfx .bx; y0 C k/ fx .bx; y0/ h;

where bx is between x0 and x0 C h. Then use the differentiability of fx at
.x0; y0/ to infer that

B.h/ D h2fxy.x0; y0/ C hE1.h/; where                      lim E1.h/ D 0:
                                                          h!0 h

(b) Use the mean value theorem to write

                    B.h/ D fy.x0 C h; by/ fy.x0; by/ h;

where by is between y0 and y0 C h. Then use the differentiability of fy at
.x0; y0/ to infer that

B.h/ D h2fyx .x0; y0/ C hE2.h/; where                     lim E2.h/ D 0:
                                                          h!0 h

       (c) Infer from (a) and (b) that fxy.x0; y0/ D fyx.x0; y0/.
22. (a) Let fxi and fxj be differentiable at a point X0 in Rn. Show from Exer-

               cise 5.3.21 that
                                               fxi xj .X0/ D fxj xi .X0/:

       (b) Use (a) and induction on r to show that all .r 1/-st order partial derivatives
               of f are differentiable on an open subset S of Rn, then fxi1 xi2 xir .X/ (X 2 S )
               depends only on the number of differentiations with respect to each variable,
               and not on the order in which they are performed.

23. Prove that .x0; y0/, .x1; y1/, and .x2; y2/ lie on a line if and only if

                    .x1 x0/.y2 y0/ .x2 x0/.y1 y0/ D 0:

24. Find the equation of the tangent plane to the surface

                         ´ D f .x; y/ at .x0; y0; ´0/ D .x0; y0; f .x0; y0//:

       (a) f .x; y/ D x2 C y2 1; .x0; y0/ D .1; 2/
       (b) f .x; y/ D 2x C 3y C 1; .x0; y0/ D .1; 1/
       (c) f .x; y/ D xy sin xy; .x0; y0/ D .1; =2/
       (d) f .x; y/ D x2 2y2 C 3xy; .x0; y0/ D .2; 1/
                             Section 5.4 The Chain Rule and Taylor's Theorem 339

25. Prove: If f is differentiable at .x0; y0/ and

                             f .x; y/ a b.x x0/ c.y          y0/ D 0;
            lim              p
            .x;y/!.x0 ;y0 /               .x x0/2 C .y y0/2

then a D f .x0; y0/, b D fx .x0; y0/, and c D fy.x0; y0/.

5.4 THE CHAIN RULE AND TAYLOR'S THEOREM

We now consider the problem of differentiating a composite function

                                           h.U/ D f .G.U//;

where G D .g1; g2; : : : ; gn/ is a vector-valued function, as defined in Section 5.2. We
begin with the following definition.

Definition 5.4.1 A vector-valued function G D .g1; g2; : : : ; gn/ is differentiable at
                                      U0 D .u10; u20; : : : ; um0/

if its component functions g1, g2, . . . , gn are differentiable at U0.

We need the following lemma to prove the main result of the section.

Lemma 5.4.2 Suppose that G D .g1; g2; : : : ; gn/ is differentiable at

                 U0 D .u10; u20; : : : ; um0/;

and define                   X 0 n X m Â @g Ã i .U0 211=2

            M D@             i D1 j D1 @uj         A:

Then; if > 0; there is a i > 0 such that

            jG.U/ G.U0/j < M C            if 0 < jU U0j < i:
                jU U0j

Proof Since g1, g2, . . . , gn are differentiable at U0, applying Lemma 5.3.8 to gi shows
that

gi .U/ gi .U0/ D .dU0 gi /.U U0/ C Ei .U/j.U U0j                        (5.4.1)
                       X m @gi .U0/

                    D @uj .uj uj 0/ C Ei .U/j.U U0j;

                                 j D1
340 Chapter 5 Real-Valued Functions of Several Variables

where                          lim Ei .U/ D 0;  1 Ä i Ä n:                 (5.4.2)
From Schwarz's inequality,
                              U!U0

                     jgi .U/ gi .U0/j Ä .Mi C jEi .U/j/jU U0j;

where                         X 0 m Â @g Ã i .U0/ 211=2

                              Mi D @  j D1 @uj    A:

Therefore,     jG.U/          G.U0/j Ä  nX                     !1=2
From (5.4.2),      jU         U0j
                                              .Mi C jEi .U/j/2 :

                                        i D1

                     nX                 !1=2      nX           !1=2

                lim           .Mi C jEi .U/j/2 D         Mi 2        D M;

               U!U0  i D1                         i D1

which implies the conclusion.
   The following theorem is analogous to Theorem 2.3.5.

Theorem 5.4.3 (The Chain Rule) Suppose that the real-valued function f is
differentiable at X0 in Rn; the vector-valued function G D .g1; g2; : : : ; gn/ is differentiable
at U0 in Rm; and X0 D G.U0/: Then the real-valued composite function h D f iG defined

by

                              h.U/ D f .G.U//                              (5.4.3)

is differentiable at U0; and

       dU0 h D fx1 .X0/dU0 g1 C fx2 .X0/dU0 g2 C C fxn .X0/dU0 gn:         (5.4.4)

Proof We leave it to you to show that U0 is an interior point of the domain of h (Exer-
cise 5.4.1), so it is legitimate to ask if h is differentiable at U0.

   Let X0 D .x10; x20; : : : ; xn0/. Note that

                              xi0 D gi .U0/; 1 Ä i Ä n;

by assumption. Since f is differentiable at X0, Lemma 5.3.8 implies that   (5.4.5)

                                        Xn
                  f .X/ f .X0/ D fxi .X0/.xi xi0/ C E.X/jX X0j;

                                                          i D1

where

                               lim E.X/ D 0:

                              X!X0
                               Section 5.4 The Chain Rule and Taylor's Theorem 341

Substituting X D G.U/ and X0 D G.U0/ in (5.4.5) and recalling (5.4.3) yields

h.U/              Xn                      gi .U0// C E.G.U//jG.U/    G.U0 /j:  (5.4.6)
       h.U0/ D fxi .X0/.gi .U/

                       i D1

Substituting (5.4.1) into (5.4.6) yields

       Xn Xn !
h.U/ h.U0/ D fxi .X0/.dU0 gi /.U U0/ C                    fxi .X0/Ei .U/ jU U0j

       i D1                                     i D1

       CE.G.U//jG.U/ G.U0j:

Since

                         lim E.G.U// D lim E.X/ D 0;
                         U!U0             X!X0

(5.4.2) and Lemma 5.4.2 imply that

       h.U/              h.U0 /     Xn                    U0/
                                        fxi .X0dU0 gi .U       D 0:

                                    i D1

                                    jU U0j

Therefore, h is differentiable at U0, and dU0h is given by (5.4.4).

Example 5.4.1 Let
                                  f .x; y; ´/ D 2x2 C 4xy C 3y´;

               g1.u; v/ D u2 C v2; g2.u; v/ D u2 2v2; g3.u; v/ D uv;
and

                             h.u; v/ D f .g1.u; v/; g2.u; v/; g3.u; v//:
Let U0 D .1; 1/ and

       X0 D .g1.U0/; g2.U0/; g3.U0// D .2; 1; 1/:

Then

       fx .X0/ D 4; fy.X0/ D 5; f´.X0/ D 3;

                         @g1.U0/ D 2; @g1.U0/ D 2;
                         @u               @v

                         @g2.U0/ D 2; @g2.U0/ D 4;
                         @u               @v

                         @g3.U0/ D 1;     @g3.U0/ D 1:
                            @u               @v

Therefore,               2 dv; dU0 g2 D 2 du C 4 dv; dU0 g3 D        du C dv;
          dU0 g1 D 2 du
342 Chapter 5 Real-Valued Functions of Several Variables

and, from (5.4.4),

dU0 h D fx.X0/ dU0 g1 C fy .X0/ dU0 g2 C f´.X0/ dU0 g3
       D 4.2 du 2 dv/ C 5.2 du C 4 dv/ 3. du C dv/

                    D 21 du C 9 dv:

Since                    dU0 h D hu.U0/ du C hv.U0/ dv
we conclude that         hu.U0/ D 21 and hv.U0/ D 9:

                                                                                       (5.4.7)

This can also be obtained by writing h explicitly in terms of .u; v/ and differentiating; thus,

h.u; v/ D 2OEg1.u; v/2 C 4g1.u; v/g2.u; v/ C 3g2.u; v/g3.u; v/

                    D 2.u2 C v2/2 C 4.u2 C v2/.u2 2v2/ C 3.u2 2v2/uv

                    D 6u4 C 3u3v 6uv3 6v4:

Hence,                             6v3 and        hv.u; v/ D 3u3         18uv2  24v3;
         hu.u; v/ D 24u3 C 9u2v

so hu.1; 1/ D 21 and hv.1; 1/ D 9, consistent with (5.4.7).

Corollary 5.4.4 Under the assumptions of Theorem 5.4.3;

                    @h.U0/ Xn @f .X0/ @gj .U0/
                                D                          ;  1 Ä i Ä m:               (5.4.8)
                         @ui             @xj @ui
                                   j D1

Proof Substituting

dU0 gi D @gi .U0/ du1 C @gi .U0/ du2 C            C @gi .U0/ dum;         1 Ä i Ä n;
                    @u1            @u2                 @um

into (5.4.4) and collecting multipliers of du1, du2, . . . , dum yields

                                   0                          1
                                   X m Xn @f .X0/ @gj .U0/
                         dU0 h D @                            A dui :
                                   iD1 j D1 @xj @ui

However, from Theorem 5.3.6,

                                            X m @h.U0/
                                   dU0 h D        @ui dui :

                                            i D1

Comparing the last two equations yields (5.4.8).
             Section 5.4 The Chain Rule and Taylor's Theorem 343

     When it is not important to emphasize the particular point X0, we write (5.4.8) less

formally as

             @h Xn @f @gj
             @ui D                  ;              1 Ä i Ä m;                   (5.4.9)
                          @xj @ui
                    j D1

with the understanding that in calculating @h.U0/=@ui , @gj =@ui is evaluated at U0 and
@f =@xj at X0 D G.U0/.

   The formulas (5.4.8) and (5.4.9) can also be simplified by replacing the symbol G with
X D X.U/; then we write

                                            h.U/ D f .X.U//

and          @h.U0/ Xn @f .X0/ @xj .U0/

             @ui D        j D1                                       ;
                                                   @xj @ui

or simply

                    @h Xn @f @xj
                         D                                   :                  (5.4.10)
                    @ui                            @xj @ui
                             j D1

Example 5.4.2 Let .r; Â/ be polar coordinates in the xy-plane; that is,

             x D r cos Â; y D r sin Â:

Suppose that f D f .x; y/ is differentiable on a set S , and let

             h.r; Â/ D f .r cos Â; r sin Â/:

If .r cos Â; r sin Â/ 2 S , (5.4.10) implies that

             @h @f @x @f @y                        @f                   @f
             @r D @x @r C @y @r D cos Â @x C sin Â @y                           (5.4.11)

and

             @h @f @x @f @y                            @f                   @f
             @Â D @x @Â C @y @Â D r sin Â @x C r cos Â @y ;

where fx and fy are evaluated at .x; y/ D .r cos Â; r sin Â/.

     The proof of Corollary 5.4.4 suggests a straightforward way to calculate the partial

derivatives of a composite function without using (5.4.10) explicitly. If h.U/ D f .X.U//,

then Theorem 5.4.3 , in the more casual notation introduced before Example 5.4.2, implies

that

             dh D fx1 dx1 C fx2 dx2 C C fxn dxn;                                (5.4.12)

where dx1, dx2, . . . , dxn must be written in terms of the differentials du1, du2, . . . , dum
of the independent variables; thus,
344 Chapter 5 Real-Valued Functions of Several Variables

                 dxi D @xi du1 C @xi du2 C               C @xi dum:
                       @u1      @u2                         @um

Substituting this into (5.4.12) and collecting the multipliers of du1, du2, . . . , dum yields (5.4.10).

Example 5.4.3 If

                       h.r; Â; ´/ D f .x.r; Â/; y.r; Â/; ´/;

then
                                   dh D fx dx C fy dy C f´ d´:

But                @x       @x                           @y      @y
hence,           dx D @r dr C @Â dÂ and dy D @r dr C @Â dÂI

                   Â @x @x Ã Â @y @y Ã
        dh D fx @r d r C @Â dÂ C fy @r d r C @Â dÂ C f´ d´

               Â @x @y Ã Â @x @y Ã
            D fx @r C fy @r d r C fx @Â C fy @Â dÂ C f´ d´;

so                 @x       @y                    @x         @y

                 hr D fx @r C fy @r ; hÂ D fx @Â C fy @Â ; h´ D f´:

Example 5.4.4 Let

                       h.x/ D f .x; y .x; ´.x// ; ´.x//:

Then

                       dh D fx dx C fy dy C f´ d´;                   (5.4.13)
                       dy D yx dx C y´ d´;                           (5.4.14)

and                                                                  (5.4.15)
                                     d´ D ´0 dx;

where the prime indicates differentiation with respect to x. Substituting (5.4.15) into

(5.4.14) yields

                            dy D .yx C y´´0/ dx

and substituting this and (5.4.15) into (5.4.13) yields

                   dh D OEfx C fy.yx C y´´0/ C f´´0 dxI

hence,

                       h0 D fx C fy .yx C y´´0/ C f´´0:

Here fx, fy , and f´ are evaluated at .x; y.x; ´.x//; ´.x//, yx and y´ are evaluated at
.x; ´.x//, and ´0 is evaluated at x.
                                 Section 5.4 The Chain Rule and Taylor's Theorem 345

Higher Derivatives of Composite Functions

Higher derivatives of composite functions can be computed by repeatedly applying the
chain rule. For example, differentiating (5.4.10) with respect to uk yields

                  @2h Xn @ Â @f @xj Ã
                  @uk@ui D @uk @xj @ui
                              j D1
                              n                     Xn                ÂÃ  (5.4.16)
                              X @f @ xj     2             @xj @ @f

                        D @xj @uk @ui C @ui @uk @xj :
                              j D1                  j D1

We must be careful finding               @ Â @f Ã
                                                       ;

                                        @uk @xj

which really stands here for            @ Â @f .X.U// Ã

                                    @uk        @xj        :               (5.4.17)

The safest procedure is to write temporarily

                                                  @f .X/
                                        g.X/ D @xj I

then (5.4.17) becomes

                        @g.X.U// Xn @g.X.U// @xs.U/
                                        D                          :
                              @uk sD1 @xs @uk

Since                                             @2f

                                        @g
                                        @xs D @xs @xj ;

this yields                   @ Â @f Ã Xn @2f @xs

                              @uk @xk       D  sD1 @xs @xj @uk  :

Substituting this into (5.4.16) yields

             @2h  Xn @f @2xj Xn @xj Xn @2f @xs
       @uk @ui D @xj @uk @ui C @ui @xs @xj @uk:                           (5.4.18)

                  j D1                      j D1       sD1

   To compute hui uk .U0/ from this formula, we evaluate the partial derivatives of x1, x2,
. . . , xn at U0 and those of f at X0 D X.U0/. The formula is valid if x1, x2, . . . , xn and
their first partial derivatives are differentiable at U0 and f , fxi , fx2 , . . . , fxn and their first
partial derivatives are differentiable at X0.

   Instead of memorizing (5.4.18), you should understand how it is derived and use the
method, rather than the formula, when calculating second partial derivatives of composite
functions. The same method applies to the calculation of higher derivatives.
346 Chapter 5 Real-Valued Functions of Several Variables

Example 5.4.5 Suppose that fx and fy in Example 5.4.2 are differentiable on an open
set S in R2. Differentiating (5.4.11) with respect to r yields

       @2h @ Â @f Ã @ Â @f Ã
       @r 2 D cos Â @r @x C sin Â @r @y

              Â @2f @x @2f @y Ã                              Â @2f @x @2f @y Ã               (5.4.19)

       D cos Â @x2 @r C @y @x @r C sin Â @x @y @r C @y2 @r

if .x; y/ 2 S . Since

              @x                     @y                              @2f      @2f
              @r D cos Â; @r D sin Â; and @x @y D @y @x

if .x; y/ 2 S (Exercise 5.3.21), (5.4.19) yields

              @2h        2 @2f                               @2f              2 @2f
                         D cos Â 2 C 2 sin Â cos Â                   C sin Â 2 :
              @r 2           @x                              @x @y            @y

Differentiating (5.4.11) with respect to Â yields

        @2h              @f              @f             @ Â @f Ã                   @ Â @f Ã
       @Â @r  D sin Â @x C cos Â @y            C cos Â @Â @x C sin Â @Â @y
                                                        Â @2f @x @2f @y Ã
                         @f              @f
              D sin Â @x C cos Â @y            C cos Â @x2 @Â C @y @x @Â
                         Â @2f @x              @2f @y Ã
              C sin Â @x @y @Â C               @y2 @Â :

Since                    @x                             @y

                         @Â D r sin Â and @Â D r cos Â;

it follows that              @f              @f                    Â @2f           @2f Ã
                 @2h     sin Â @x C cos Â @y        r sin Â cos Â @x2              @y2
                @Â @r D

                         Cr .cos2 Â  sin2 Â / @2f :
                                             @x@y

The Mean Value Theorem

For a composite function of the form

                         h.t/ D f .x1.t/; x2.t/; : : : ; xn.t//

where t is a real variable, x1, x2, . . . , xn are differentiable at t0, and f is differentiable at
X0 D X.t0/, (5.4.8) takes the form

                             h0.t0/ D    Xn    fxj  .X  .t0  //x  0  .t0  /:
                                                                  j
                                                                                             (5.4.20)

                                         j D1

This will be useful in the proof of the following theorem.
                                Section 5.4 The Chain Rule and Taylor's Theorem 347

Theorem 5.4.5 (Mean Value Theorem for Functions of n Variables)
Let f be continuous at X1 D .x11; x21; : : : ; xn1/ and X2 D .x12; x22; : : : ; xn2/ and dif-
ferentiable on the line segment L from X1 to X2: Then

                       Xn                                                    (5.4.21)
f .X2/ f .X1/ D fxi .X0/.xi2 xi1/ D .dX0 f /.X2 X1/

                                  i D1

for some X0 on L distinct from X1 and X2.

Proof An equation of L is                          t /X1;     0 Ä t Ä 1:
                           X D X.t/ D tX2 C .1

Our hypotheses imply that the function

                                             h.t/ D f .X.t//
is continuous on OE0; 1 and differentiable on .0; 1/. Since

                                xi .t / D txi2 C .1 t /xi1;

(5.4.20) implies that

                                 Xn                xi1/;      0 < t < 1:
                       h0.t / D fxi .X.t //.xi2

                                     i D1

From the mean value theorem for functions of one variable (Theorem 2.3.11),

                                h.1/ h.0/ D h0.t0/

for some t0 2 .0; 1/. Since h.1/ D f .X2/ and h.0/ D f .X1/, this implies (5.4.21) with
X0 D X.t0/.

Corollary 5.4.6 If fx1 ; fx2; . . . ; fxn are identically zero in an open region S of Rn;
then f is constant in S:

Proof We will show that if X0 and X are in S , then f .X/ D f .X0/. Since S is an open
region, S is polygonally connected (Theorem 5.1.20). Therefore, there are points

                                X0; X1; : : : ; Xn D X

such that the line segment Li from Xi 1 to Xi is in S , 1 Ä i Ä n. From Theorem 5.4.5,

                       f .Xi /                Xn              Xi 1/;
                                f .Xi 1/ D .deXi f /.Xi

                                                     i D1

where eX is on Li and therefore in S . Therefore,

                       fxi .eXi / D fx2 .eXi / D D fxn .eXi / D 0;
348 Chapter 5 Real-Valued Functions of Several Variables

which means that deXi f Á 0. Hence,                  D f .Xn/I
                                  f .X0/ D f .X1/ D

that is, f .X/ D f .X0/ for every X in S .

Higher Differentials and Taylor's Theorem

Suppose that f is defined in an n-ball B .X0/, with > 0. If X 2 B .X0/, then

                     X.t/ D X0 C t.X X0/ 2 B .X/; 0 Ä t Ä 1;

so the function

                                       h.t/ D f .X.t//

is defined for 0 Ä t Ä 1. From Theorem 5.4.3 (see also (5.4.20)),

                                          Xn
                                h0.t / D fxi .X.t /.xi xi0/

                                              i D1

if f is differentiable in B .X0/, and                               !
                                                               xi0/ .xj
                 h00.t / D Xn @      Xn @f .X.t//                          xj 0/
                           j D1 @xj          @xi .xi

                                     i D1

                         Xn @2f .X.t//               xi 0/.xj     xj 0/
                     D @xj @xi .xi

                         i;j D1

if fx1 , fx2 , . . . , fxn are differentiable in B .X0/. Continuing in this way, we see that

.r /             Xn  @r f .X.t//                                           .xir xir;0/ (5.4.22)
h .t/ D                                      .xi1    xi1;0 /.xi2  xi2;0 /
           i1;i2;:::;ir D1 @xir @xir 1 @xi1

if all partial derivatives of f of order Ä r 1 are differentiable in B .X0/.
   This motivates the following definition.

Definition 5.4.7 Suppose that r 1 and all partial derivatives of f of order Ä r 1

are differentiable in a neighborhood of X0. Then the r th differential of f at X0, denoted
by dX0 .r/f , is defined by

                   .r / Xn                   @r f .X0/ dxi1 dxi2           dxir ;  (5.4.23)
                 dX0 f D
                     i1;i2;:::;ir D1 @xir @xir 1 @xi1

where dx1, dx2, . . . , dxn are the differentials introduced in Section 5.3; that is, dxi is the
function whose value at a point in Rn is the i th coordinate of the point. For convenience,

we define                            .dX0 .0/f / D f .X0/:

Notice that dX0 .1/f D dX0 f .
                              Section 5.4 The Chain Rule and Taylor's Theorem 349

    Under the assumptions of Definition 5.4.7, the value of

                                                  @r f .X0/
                                             @xir @xir 1 @xi1

depends only on the number of times f is differentiated with respect to each variable,

and not on the order in which the differentiations are performed (Exercise 5.3.22). Hence,
Exercise 5.3.12 implies that (5.4.23) can be rewritten as

    .r /     X            rS                 @r f .X0/         r1          r2     rn
    dX0 f D                                             rn .dx1/ .dx2/ .dxn/ ; (5.4.24)
                                     r1 r2
             r r1Sr2S rnS @x1 @x2 @xn
    P
where r indicates summation over all ordered n-tuples .r1; r2; : : : ; rn/ of nonnegative

integers such that

                              r1 C r2 C C rn D r

and @xiri is omitted from the "denominators" of all terms in (5.4.24) for which ri D 0. In

particular, if n D 2,

                         .r / Xr              !
                       dX0 f D               r @r f .x0; y0/ .dx/j .dy/r j :
                                             j @xj @yr j
                                       j D0

Example 5.4.6 Let                                  1
                              f .x; y/ D 1 C ax C by ;

where a and b are constants. Then

                          @r f .x; y/ D . 1/r r S             aj br j r C1 ;
                          @xj @yr j                     .1 C ax C by/

so                                   r r S Xr r !

          dX0 .r/f D .1 C ax0 C by0/rC1 . 1/                   j rj            j  rj
                                                                  a b .dx/ .dy/
                                                        j D0  j

                       D      . 1/r r S      rC1 .a dx C b dy/     r

                          .1 C ax0 C by0/

if 1 C ax0 C by0 ¤ 0.

Example 5.4.7 Let                            0                     1
                              f .X/ D exp @             Xn

                                                             aj xj A ;

                                                        j D1

where a1, a2, . . . , an are constants. Then                            0             1
                                                              arnn exp @   Xn
                    @r f .X/                 r r1 r2
                              rn D . 1/ a1 a2                                   aj xj A :
             r1 r2
             @x1 @x2 @xn                                                   j D1
350 Chapter 5 Real-Valued Functions of Several Variables

Therefore,              1/r X r S a1r1 a2r2         anrn .dx1/r1 .dx2/r2              !
    .dX0 .r/f /.^/ D .       0 r r1Sr2S r1nS                                 .d xn /rn

                   D.   exp @  Xn  aj xj 0A

                                     j D1                           0              1
                                                 C an dxn/r exp @      Xn
                        1/r .a1 dx1 C a2 dx2 C
                                                                           aj xj 0A

                                                                       j D1

(Exercise 5.3.12).

   The next theorem is analogous to Taylor's theorem for functions of one variable (Theo-
rem 2.5.4).

Theorem 5.4.8 (Taylor's Theorem for Functions of n Variables) Suppose
that f and its partial derivatives of order Ä k are differentiable at X0 and X in Rn and on

the line segment L connecting them: Then

          f .X/ D   Xk 1 .r /                    1  .kC1/
                             .dX0 f /.X X/ C        .de f /.X X0/                     (5.4.25)
                    rD0 r S                   .k C 1/S X

for some eX on L distinct from X0 and X.

Proof Define

                               h.t/ D f .X0 C t.X X0//:                               (5.4.26)

With ^ D X X0, our assumptions and the discussion preceding Definition 5.4.7 imply
that h, h0, . . . , h.kC1/ exist on OE0; 1. From Taylor's theorem for functions of one variable,

                               h.1/ D  Xk h.r/.0/ h.kC1/. /
                                             r S C .k C 1/S ;                         (5.4.27)

                                       r D0

for some  2 .0; 1/. From (5.4.26),

                             h.0/ D f .X0/ and h.1/ D f .X/:                          (5.4.28)

From (5.4.22) and (5.4.23) with ^ D X X0,

                             h.r/.0/ D .dX0 .r/f /.X X0/; 1 Ä r Ä k;                  (5.4.29)
                                                                                      (5.4.30)
and                                           Á

                        h.kC1/. / D d kC1f .X X0/
                                       eX
                         Section 5.4 The Chain Rule and Taylor's Theorem 351

where                            eX D X0 C .X X0/

is on L and distinct from X0 and X. Substituting (5.4.28), (5.4.29), and (5.4.30) into
(5.4.27) yields (5.4.25).

Example 5.4.8 Theorem 5.4.8 and the results of Example 5.4.6 with X0 D .0; 0/ and
^ D .x; y/ imply that if 1 C ax C by > 0, then

       1 D Xk . 1/r .ax C by/r C . 1/kC1 .ax C by/kC1

                                                                                                                   kC2
       1 C ax C by rD0                             .1 C a x C b y/

for some 2 .0; 1/. (Note that depends on k as well as .x; y/.)

Example 5.4.9 Theorem 5.4.8 and the results of Example 5.4.7 with X0 D 0 and

^ D X imply that

           0      Xn  1          Xk . 1/r
       exp @
                      aj xj A D            .a1x1 C a2x2 C       C anxn/r
                  j D1 r D0 r S

                                 . 1/kC1                        C anxn/kC1
                                 C .k C 1/S .a1x1 C a2x2 C
                                 20                13
                                           Xn
                                 exp 4 @ aj xj A5 ;

                                           j D1

for some 2 .0; 1/.

   By analogy with the situation for functions of one variable, we define the kth Taylor
polynomial of f about X0 by

                                              Xk 1 .r /
                                  Tk.X/ D r S .dX0 f /.X X0/

                                                                 r D0

if the differentials exist; then (5.4.25) can be rewritten as

                    f .X/ D Tk.X/ C 1 .d .kC1/f /.X X0/:
                                          .k C 1/S eX

A Sufficient Condition for Relative Extreme Values

The next theorem leads to a useful sufficient condition for local maxima and minima. It
is related to Theorem 2.5.1. Strictly speaking, however, it is not a generalization of Theo-
rem 2.5.1 (Exercise 5.4.18).
352 Chapter 5 Real-Valued Functions of Several Variables

Theorem 5.4.9 Suppose that f and its partial derivatives of order Ä k 1 are differ-
entiable in a neighborhood N of a point X0 in Rn and all kth-order partial derivatives of

f are continuous at X0: Then

                                         f .X/ Tk.X/
                   lim                                  k D 0:                (5.4.31)
                   X!X0 jX X0j

Proof If > 0, there is a i > 0 such that Bi .X0/                N and all kth-order partial

derivatives of f satisfy the inequality

                                       @kf .X0/         
 @kf .eX/                                               
 @xik @xik 1 @xi1  @xik @xik 1 @xi1                     < ;     eX 2 Bi.X0/:  (5.4.32)

Now suppose that X 2 Bi.X0/. From Theorem 5.4.8 with k replaced by k 1,

                                           1 .k/                              (5.4.33)
                 f .X/ D Tk 1.X/ C .deX f /.X X0/;

                                          kS

where eX is some point on the line segment from X0 to X and is therefore in Bi .X0/. We
can rewrite (5.4.33) as

                 1 h .k/                                  .k/ i
f .X/ D Tk.X/ C kS .deX f /.X X0/ .dX0 f /.X X0/ :                            (5.4.34)

But (5.4.23) and (5.4.32) imply that     .dX0 .k/f /.X                X0jk    (5.4.35)
                                                            k
                     .k/                                X0/ < n jX
                    .d f /.X X0/
                       eX

(Exercise 5.4.17), which implies that

                 jf .X/ Tk.X/j < nk ;                   X 2 Bi .X0/;
                 jX X0jk                 kS

from (5.4.34). This implies (5.4.31).

Let r be a positive integer and X0 D .x10; x20; : : : ; xn0/. A function of the form

          X                            x10/r1 .x2       x20/r2  .xn xn0/rn ;  (5.4.36)
p.X/ D ar1r2:::rn .x1

              r

where the coefficients far1r2:::rng are constants and the summation is over all n-tuples of
nonnegative integers .r1; r2; : : : ; rn/ such that

                   r1 C r2 C C rn D r;

is a homogeneous polynomial of degree r in X X0, provided that at least one of the

coefficients is nonzero. For example, if f satisfies the conditions of Definition 5.4.7, then

the function       p.X/ D .dX0 .r/f /.X X0/
                        Section 5.4 The Chain Rule and Taylor's Theorem 353

is such a polynomial if at least one of the r th-order mixed partial derivatives of f at X0 is
nonzero.

   Clearly, p.X0/ D 0 if p is a homogeneous polynomial of degree r 1 in X X0.
If p.X/ 0 for all X, we say that p is positive semidefinite; if p.X/ > 0 except when
X D X0, p is positive definite.

   Similarly, p is negative semidefinite if p.X/ Ä 0 or negative definite if p.X/ < 0 for all
X ¤ X0. In all these cases, p is semidefinite.

With p as in (5.4.36),

                        p. X C 2X0/ D . 1/r p.X/;

so p cannot be semidefinite if r is odd.

Example 5.4.10 The polynomial
                          p.x; y; ´/ D x2 C y2 C ´2 C xy C x´ C y´

is homogeneous of degree 2 in X D .x; y; ´/. We can rewrite p as

                                     1  .x C y/2 C .y C ´/2 C .´ C x/2  ;
                     p.x; y; ´/ D
                        2

so p is nonnegative, and p.x; y; ´/ D 0 if and only if

                        x C y D y C ´ D ´ C x D 0;

which is equivalent to .x; y; ´/ D .0; 0; 0/. Therefore, p is positive definite and p is
negative definite.

   The polynomial

                                p1.x; y; ´/ D x2 C y2 C ´2 C 2xy

can be rewritten as

                        p1.x; y; ´/ D .x C y/2 C ´2;

so p1 is nonnegative. Since p1.1; 1; 0/ D 0, p1 is positive semidefinite and  p1 is
negative semidefinite.

The polynomial

                        p2.x; y; ´/ D x2 y2 C ´2

is not semidefinite, since, for example,

                        p2.1; 0; 0/ D 1 and p2.0; 1; 0/ D 1:

From Theorem 5.3.11, if f is differentiable and attains a local extreme value at X0, then

                                          dX0 f D 0;                          (5.4.37)

since fx1 .X0/ D fx2 .X0/ D D fxn .X0/ D 0. However, the converse is false. The next
theorem provides a method for deciding whether a point satisfying (5.4.37) is an extreme

point. It is related to Theorem 2.5.3.
354 Chapter 5 Real-Valued Functions of Several Variables

Theorem 5.4.10 Suppose that f satisfies the hypotheses of Theorem 5.4.9 with k

2; and             dX0 .r/f Á 0 .1 Ä r Ä k 1/; dX0 .k/f 6Á 0:

                                                                               (5.4.38)

Then
(a) X0 is not a local extreme point of f unless dX0 .k/f is semidefinite as a polynomial in

      X X0: In particular; X0 is not a local extreme point of f if k is odd:

(b) X0 is a local minimum point of f if dX0 .k/f is positive definite; or a local maximum
      point if dX0 .k/f is negative definite:

(c) If dX0 .k/f is semidefinite; then X0 may be a local extreme point of f; but it need not
      be:

Proof From (5.4.38) and Theorem 5.4.9,

                          f .X/  f .X0/   1kS .dX0 .k//.X  X0/                 (5.4.39)
                    lim               jX  X0jk                  D 0:

                   X!X0

If X D X0 C tU, where U is a constant vector, then
                                .dX0 .k/f /.X X0/ D t k .dX0 .k/f /.U/;

so (5.4.39) implies that

                        f .X0 C tU/      f .X0/  t k .k/
                   lim                      tk      .dX0 f /.U/
                                                 kS                      D 0;
                   t !0

or, equivalently,

                   lim f .X0 C tU/       f .X0/ D 1kS .dX0 .k/f /.U/           (5.4.40)
                   t !0              tk

for any constant vector U.

To prove (a), suppose that dX0 .k/f is not semidefinite. Then there are vectors U1 and U2

such that          .dX0 .k/f /.U1/ > 0 and .dX0 .k/f /.U2/ < 0:

This and (5.4.40) imply that

                   f .X0 C tU1/ > f .X0/ and f .X0 C tU2/ < f .X0/

for t sufficiently small. Hence, X0 is not a local extreme point of f .
  To prove (b), first assume that dX0 .k/f is positive definite. Then it can be shown that

there is a > 0 such that

                              .dX0 .k/f /.X X0/  jX X0jk                       (5.4.41)
                                       kS
                              Section 5.4 The Chain Rule and Taylor's Theorem 355

for all X (Exercise 5.4.19). From (5.4.39), there is a i > 0 such that

            f .X/  f .X0/     1kS .dX0 .k/f /.X  X0/
                                                      >
                   jX X0jk                               2  if jX X0j < i:

Therefore,

f .X/ f .X0/ > 1kS .dX0 .k//.X X0/ 2 jX X0jk if jX X0j < i:

This and (5.4.41) imply that

                       f .X/ f .X0/ > jX X0jk if jX X0j < i;
                                              2

which implies that X0 is a local minimum point of f . This proves half of (b). We leave
the other half to you (Exercise 5.4.20).

  To prove (c) merely requires examples; see Exercise 5.4.21.

Corollary 5.4.11 Suppose that f; fx; and fy are differentiable in a neigborhood of a
critical point X0 D .x0; y0/ of f and fxx ; fyy; and fxy are continuous at .x0; y0/: Let

                           D D fxx .x0; y0/fxy .x0; y0/ fxy2 .x0; y0/:

Then
(a) .x0; y0/ is a local extreme point of f if D > 0I .x0; y0/ is a local minimum point if

      fxx .x0; y0/ > 0, or a local maximum point if fxx .x0; y0/ < 0:
(b) .x0; y0/ is not a local extreme point of f if D < 0:

Proof Write .x x0; y y0/ D .u; v/ and
                        p.u; v/ D .dX.2/0 f /.u; v/ D Au2 C 2Buv C C v2;

where A D fxx .x0; y0/, B D fxy.x0; y0/, and C D fyy.x0; y0/, so
                                            D D AC B2:

If D > 0, then A ¤ 0, and we can write

                              Â                  B2 2Ã Â    B2 2 Ã
                                 2 2B                             v
            p.u; v/ D A u C A uv C A2 v C C
                              Â B Ã2 D 2                    A

                   DA uC Av C Av :

This cannot vanish unless u D v D 0. Hence, dX0 .2/f is positive definite if A > 0 or
negative definite if A < 0, and Theorem 5.4.10(b) implies (a).

   If D < 0, there are three possibilities:
356 Chapter 5 Real-Valued Functions of Several Variables

                                          ÂB Ã D
1. A ¤ 0; then p.1; 0/ D A and p A ; 1 D A .

                                           Â  BÃ D
2. C ¤ 0; then p.0; 1/ D C and p 1;           C DC.

3. A D C D 0; then B ¤ 0 and p.1; 1/ D 2B and p.1; 1/ D 2B.

   In each case the two given values of p differ in sign, so X0 is not a local extreme point
of f , from Theorem 5.4.10(a).

Example 5.4.11 If

                   f .x; y/ D eax2Cby2 ;

then
                       fx.x; y/ D 2axf .x; y/; fy.x; y/ D 2byf .x; y/;

so
                                       fx.0; 0/ D fy.0; 0/ D 0;

and .0; 0/ is a critical point of f . To apply Corollary 5.4.11, we calculate

                   fxx .x; y/ D .2a C 4a2x2/f .x; y/;

                   fyy.x; y/ D .2b C 4b2y2/f .x; y/;

                   fxy.x; y/ D 4abxyf .x; y/:

Therefore,                             fxy2 .0; 0/ D .2a/.2b/  .0/.0/ D 4ab:
              D D fxx .0; 0/fyy.0; 0/

Corollary 5.4.11 implies that .0; 0/ is a local minimum point if a and b are positive, a local
maximum if a and b are negative, and neither if one is positive and the other is negative.
Corollary 5.4.11 does not apply if a or b is zero.

                   5.4 Exercises

In the exercises on the use of the chain rule, assume that the functions satisfy appropriate
differentiability conditions.

 1. Under the assumptions of Theorem 5.4.3, show that U0 is an interior point of the
        domain of h.
                      Section 5.4 The Chain Rule and Taylor's Theorem 357

2. Let h.U/ D f .G.U// and find dU0h by Theorem 5.4.3, and then by writing h
      explicitly as a function of U.

(a) f .x; y/ D 3x2 C 4xy2 C 3x,      .u0; v0/ D .0; 1/
       g1.u; v/ D veuCv 1,
       g2.u; v/ D e uCv 1,

(b) f .x; y; ´/ D e .xCyC´/,                  .u0; v0; w0/ D .1; 1; 1/
      g1.u; v; w/ D log u log v C log w,
      g2.u; v; w/ D 2 log u 3 log w,
      g3.u; v; w/ D log u C log v C 2 log w,

(c) f .x; y/ D .x C y/2,
       g1.u; v/ D u cos v, .u0; v0/ D .3; =2/
       g2.u; v/ D u sin v,

(d) f .x; y; ´/ D x2 C y2 C ´2,      .u0; v0; w0/ D .4; =3; =6/
       g1.u; v; w/ D u cos v sin w,
       g2.u; v; w/ D u cos v cos w,
       g3.u; v; w/ D u sin v;

3. Let h.r; Â; ´/ D f .x; y; ´/, where x D r cos Â and y D r sin Â. Find hr , hÂ , and
      h´ in terms of fx, fy, and f´.

4. Let h.r; Â; / D f .x; y; ´/, where x D r sin cos Â, y D r sin sin Â, and ´ D
      r cos . Find hr , hÂ , and h in terms of fx, fy, and f´.

5. Prove:

(a) If h.u; v/ D f .u2 C v2/, then vhu uhv D 0.

(b) If h.u; v/ D f .sin u C cos v/, then hu sin v C hv cos u D 0.
(c) If h.u; v/ D f .u=v/, then uhu C vhv D 0.
(d) If h.u; v/ D f .g.u; v/; g.u; v//, then dh D .fx fy/ dg.

6. Find hy and h´ if

                      h.y; ´/ D g.x.y; ´/; y; ´; w.y; ´//:

7. Suppose that u, v, and f are defined on . 1; 1/. Let u and v be differentiable
      and f be continuous for all x. Show that

           d Z v.x/ f .t / dt D f .v.x//v0.x/    f .u.x//u0 .x/:
           dx u.x/

8. We say that f D f .x1; x2; : : : ; xn/ is homogeneous of degree r if Df is open and
      there is a constant r such that

                              f .tx1; tx2; : : : ; txn/ D t r f .x1; x2; : : : ; xn/
358 Chapter 5 Real-Valued Functions of Several Variables

whenever t > 0 and .x1; x2; : : : ; xn/ and .tx1; tx2; : : : ; txn/ are in Df . Prove: If
f is differentiable and homogeneous of degree r , then

               Xn
                   xi fxi .x1; x2; : : : ; xn/ D rf .x1; x2; : : : ; xn/:

               i D1

      (This is Euler's theorem for homogeneous functions.)
9. If h.r; Â/ D f .r cos Â; r sin Â/, show that

                                             1  1
                    fxx C fyy D hrr C r hr C r 2 hÂÂ :

        pHINT: Rewrite the defining equation as f .x; y/ D h.r .x; y/; Â.x; y//; with r .x; y/ D
           x2 C y2 and Â.x; y/ D tan 1.y=x/; and differentiate with respect to x and y:

10. Let h.u; v/ D f .a.u; v/; b.u; v//, where au D bv and av D bu. Show that

                    huu C hvv D .fxx C fyy /.au2 C av2/:

11. Prove: If

                          u.x; t/ D f .x ct/ C g.x C ct/;

then utt D c2uxx .

12. Let h.u; v/ D f .u C v; u v/. Show that

(a) fxx        fyy D huv  (b) fxx C fyy D 1 .huu C hvv/
                                                 2

13. Returning to Exercise 5.4.4, find hrr and hrÂ in terms of the partial derivatives of

f.

14. Let huv D 0 for all .u; v/. Show that h is of the form

                          h.u; v/ D U.u/ C V .v/:

Use this and Exercise 5.4.12(a) to show that if fxx fyy D 0 for all .x; y/, then

                          f .x; y/ D U.x C y/ C V .x y/:

15. Prove or give a counterexample: If f is differentiable and fx D 0 in a region D,
        then f .x1; y/ D f .x2; y/ whenever .x1; y/ and .x2; y/ are in D; that is f .x; y/
        depends only on y.

16. Find T3.X/.
       (a) f .x; y/ D ex cos y, X0 D .0; 0/
       (b) f .x; y/ D e x y, X0 D .0; 0/
       (c) f .x; y; ´/ D .x C y C ´ 3/5, X0 D .1; 1; 1/
       (d) f .x; y; ´/ D sin x sin y sin ´, X0 D .0; 0; 0/

17. Use Eqns. (5.4.23) and (5.4.32) to prove Eqn. (5.4.35).
                            Section 5.4 The Chain Rule and Taylor's Theorem 359

18. Carefully explain why Theorem 5.4.9 is not a generalization of Theorem 2.5.1.

19. Suppose that p is a homogeneous polynomial of degree r in Y and p.Y/ > 0 for all
        nonzero Y in Rn. Show that there is a > °0 su ch that p«.Y/ jYjr for all Y in
        Rn. HINT: p assumes a minimum on the set Y  jYj D 1 : Use this to establish the
        inequality in Eqn. (5.4.41):

20. Complete the proof of Theorem 5.4.10(b).

21. (a) Show that .0; 0/ is a critical point of each of the following functions, and that
               they have positive semidefinite second differentials at .0; 0/.

                            p.x; y/ D x2     2xy C y2 C x4 C y4I
                            q.x; y/ D x2     2xy C y2 x4 y4:

       (b) Show that D as defined in Corollary 5.4.11 is zero for both p and q.
       (c) Show that .0; 0/ is a local minimum point of p but not a local extreme point

               of q.

22. Suppose that p D p.x1; x2; : : : ; xn/ is a homogeneous polynomial of degree r
        (Exercise 5.4.8). Let i1, i2, . . . , in be nonnegative integers such that

                                i1 C i2 C C in D k;

and let                                      @kp.x1; x2; : : : ; xn/

                     q.x1; x2; : : : ; xn/ D i1 i2               in :
                                                      @x1 @x2 @xn

Show that q is homogeneous of degree Ä r k, subject to the convention that a

homogeneous polynomial of negative degree is identically zero.

23. Suppose that f D f .x1; x2; : : : ; xn/ is a homogeous function of degree r (Exer-
        cise 8), with mixed partial derivative of all orders. Show that

             Xn      xi xj  @2f .x1; x2; : : : ; xn/  D r .r  1/f .x1; x2; : : : ; xn/

             i;j D1         @xi @xj

and

         Xn          @3.x1; x2; : : : ; xn/
              xi xj xk @xi @xj @xk D r .r 1/.r 2/f .x1; x2; : : : ; xn/:
     i;j;kD1

        Can you generalize these results?                     e anxn ;
24. Obtain the result in Example 5.4.7 by writing

                                      F .X/ D e a1x1 e a2x2

formally multiplying the series

                     e ai xi D  X 1  .  1/ri .ai xi /ri ;     1Äi Än
                                                ri S
                                ri D0

together, and collecting the resulting products appropriately.
360 Chapter 5 Real-Valued Functions of Several Variables

25. Let     f .x; y/ D exCy:

By writing

            f .x; y/ D               X 1 .x C y/r
                                                  ;
                                     r D0  rS

and expanding .x C y/r by means of the binomial theorem, verify that

              .r / Xr                 !
            d(0;0/f D                r @r f .0; 0/ .dx/j .dy/r j :
                                     j @xj @yr j
                               j D0
                                       CHAPTER 6

                              Vector-Valued Functions
                                  of Several Variables

IN THIS CHAPTER we study the differential calculus of vector-valued functions of several
variables.
SECTION 6.1 reviews matrices, determinants, and linear transformations, which are inte-
gral parts of the differential calculus as presented here.
SECTION 6.2 defines continuity and differentiability of vector-valued functions of several
variables. The differential of a vector-valued function F is defined as a certain linear trans-
formation. The matrix of this linear transformation is called the differential matrix of F,
denoted by F0. The chain rule is extended to compositions of differentiable vector-valued
functions.
SECTION 6.3 presents a complete proof of the inverse function theorem.
SECTION 6.4. uses the inverse function theorem to prove the implicit function theorem.

6.1 LINEAR TRANSFORMATIONS AND MATRICES

In this and subsequent sections it will often be convenient to write vectors vertically; thus,
instead of X D .x1; x2; : : : ; xn/ we will write

                                                    23
                                                        x1

                                              6 X D 6 x 6 2 7 : 77
                                                    4 :: 5
                                                        xn

when dealing with matrix operations. Although we assume that you have completed a
course in linear algebra, we will review the pertinent matrix operations.

   We have defined vector-valued functions as ordered n-tuples of real-valued functions, in
connection with composite functions h D f i G, where f is real-valued and G is vector-
valued. We now consider vector-valued functions as objects of interest on their own.

                                                    361
362 Chapter 6 Vector-Valued Functions of Several Variables

If f1, f2, . . . , fm are real-valued functions defined on a set D in Rn, then
                                                 23
                                                     f1

                                           6 F D 6 f 6 2 7 : 77
                                                 4 :: 5

                                                    fm

assigns to every X in D an m-vector

                                     2  f1 .X/    3

                                     6  f2 .X/    7
                                     6            7
                           F.X/ D 6 :: 7 :
                                     4:5

                                        fm.X/

Recall that f1, f2, . . . , fm are the component functions, or simply components, of F. We

write

                                     F W Rn ! Rm

to indicate that the domain of F is in Rn and the range of F is in Rm. We also say that F is a
transformation from Rn to Rm. If m D 1, we identify F with its single component function

f1 and regard it as a real-valued function.

Example 6.1.1 The transformation F W R2 ! R3 defined by

                                     2  2x C 3y      3

                           F.x; y/ D 4 x C 4y 5

                                        xy

has component functions

       f1.x; y/ D 2x C 3y; f2.x; y/ D x C 4y; f3.x; y/ D x y:

Linear Transformations

The simplest interesting transformations from Rn to Rm are the linear transformations,
defined as follows

Definition 6.1.1 A transformation L W Rn ! Rm defined on all of Rn is linear if

                           L.X C Y/ D L.X/ C L.Y/

for all X and Y in Rn and

                                     L.aX/ D aL.X/

for all X in Rn and real numbers a.
                                 Section 6.1 Linear Transformations and Matrices 363

Theorem 6.1.2 A transformation L W Rn ! Rm defined on all of Rn is linear if and

only if                       2                                        3
                              6                           C a1nxn
                              6  a11x1 C a12x2 C          C a2nxn 777 ;         (6.1.1)
                    L.X/ D 6
                              4  a21x1 C a22x2 C                       5
                                                   ::
                                                   :

                                 am1x1 C am2x2 C C amnxn

where the aij 's are constants:

Proof If can be seen by induction (Exercise 6.1.1) that if L is linear, then

L.a1X1 C a2X2 C C ak Xk/ D a1L.X1/ C a2L.X2/ C C akL.Xk/ (6.1.2)

for any vectors X1, X2, . . . , Xk and real numbers a1, a2, . . . , ak. Any X in Rn can be

written as          23           23            23                    23
                                                                         0
                    x1              1               0
                                                                     607
                    6 x2 7       607           617                   67
                    67           67            67              C xn 6 :: 7
            X D 6 :: 7 D x1 6 :: 7 C x2 6 :: 7 C                     4:5
                    4:5          4:5           4:5

                    xn              0               0                     1

            D x1E1 C x2E2 C C xnEn:

Applying (6.1.2) with k D n, Xi D Ei , and ai D xi yields

                    L.X/ D x1L.E1/ C x2L.E2/ C C xnL.En/:                       (6.1.3)

Now denote                                  2          3

                                            6  a1j     7
                                            6          7
                                               a2j
                                 L.Ej / D 6 :: 7 ;
                                            4:5

                                               amj

so (6.1.3) becomes

                        2   a11  3       2     a12  3             2  a1n     3

                        6   a21  7       6     a22  7             6  a2n     7
                        6        7       6          7             6          7
            L.X/ D x1 6 :: 7 C x2 6 :: 7 C                     C xn 6 :: 7 ;
                        4:5 4:5                                   4:5

                            am1                am2                   amn

which is equivalent to (6.1.1). This proves that if L is linear, then L has the form (6.1.1).
We leave the proof of the converse to you (Exercise 6.1.2).

We call the rectangular array

                                 2  a11 a12               a1n  3

                                 6  a21  a21              a2n  7
                                 6                             7
                           A D 6 :: :: : : :: 7                                 (6.1.4)
                                 4:         :       : :5

                                    am1 am2               amn
364 Chapter 6 Vector-Valued Functions of Several Variables

the matrix of the linear transformation (6.1.1). The number aij in the i th row and j th
column of A is called the .i; j /th entry of A. We say that A is an m n matrix, since A
has m rows and n columns. We will sometimes abbreviate (6.1.4) as

                                                A D OEaij :

Example 6.1.2 The transformation F of Example 6.1.1 is linear. The matrix of F is
                                  2              3
                                       23

                                  4 1 4 5:

                                       11

   We will now recall the matrix operations that we need to study the differential calculus
of transformations.

Definition 6.1.3                                                             n matrix

(a) If c is a real number and A D OEaij  is an m n matrix, then cA is the m
      defined by
                                                  cA D OEcaij I

that is, cA is obtained by multiplying every entry of A by c.

(b) If A D OEaij  and B D OEbij  are m n matrices, then the sum A C B is the m n
      matrix
                                             A C B D OEaij C bij I

that is, the sum of two m n matrices is obtained by adding corresponding entries.
The sum of two matrices is not defined unless they have the same number of rows and
the same number of columns.

(c) If A D OEaij  is an m p matrix and B D OEbij  is a p    n matrix, then the product
      C D AB is the m n matrix with                         1 Ä i Ä m; 1 Ä j Ä n:

cij D ai1b1j C ai2b2j C                          Xp
                                  C aip bpj D aikbkj ;

                                                 kD1

Thus, the .i; j /th entry of AB is obtained by multiplying each entry in the i th row of
A by the corresponding entry in the j th column of B and adding the products. This
definition requires that A have the same number of columns as B has rows. Otherwise,
AB is undefined.

Example 6.1.3 Let                             3  2             3
                               2  212                 01    1
                                                            2 5;
                         AD4      1 0 3 5; B D 4 1 0
                                                            1
and                               010                 30

                                        2               3
                                            50   12
                                                 3 1 5:
                                  CD4 3 0
                                                 11
                                            10
                               Section 6.1 Linear Transformations and Matrices 365

Then                    2    2.2/ 2.1/ 2.2/  32                  3
and                                                  424
         2A D 4 2. 1/ 2.0/ 2.3/ 5 D 4                2 0 65

                             2.0/ 2.1/ 2.0/          020

                  2          2C0  1C1          32                          3
      ACBD4                  11   0C0  2C1                     223
                             0C3  1C0  3C2 5D4                 2 0 5 5:
                                       0C1
                                                               311

   The (2, 3) entry in the product AC is obtained by multiplying the entries of the second
row of A by those of the third column of C and adding the products: thus, the (2, 3) entry
of AC is

                               . 1/.1/ C .0/. 3/ C .3/. 1/ D 4:

The full product AC is

      2  212               32  50  12        32      15 0             3
                                                               37
      4 1 0 3 54 3 0               3 1 5D4 2 0                 4 1 5:

         010                   10  11                30        31

Notice that A C C, B C C, CA, and CB are undefined.

We leave the proofs of next three theorems to you (Exercises 6.1.7-6.1.9)

Theorem 6.1.4 If A; B; and C are m n matrices; then
                                   .A C B/ C C D A C .B C C/:

Theorem 6.1.5 If A and B are m n matrices and r and s are real numbers; then (a)
r.sA/ D .rs/AI (b) .r C s/A D rA C sAI (c) r.A C B/ D rA C rB:

Theorem 6.1.6 If A; B; and C are m p; p q; and q n matrices; respectively;
then .AB/C D A.BC/:

   The next theorem shows why Definition 6.1.3 is appropriate. We leave the proof to you
(Exercise 6.1.11).

Theorem 6.1.7

(a) If we regard the vector            23

                                       6     x1  7
                                       6         7
                                             x2
                                   X D 6 :: 7
                                       4:5

                                             xn

      as an n 1 matrix; then the linear transformation (6.1.1) can be written as

                                   L.X/ D AX:
366 Chapter 6 Vector-Valued Functions of Several Variables

(b) If L1 and L2 are linear transformations from Rn to Rm with matrices A1 and A2
      respectively; then c1L1 C c2L2 is the linear transformation from Rn to Rm with
      matrix c1A1 C c2A2:

(c) If L1 W Rn ! Rp and L2 W Rp ! Rm are linear transformations with matrices A1
      and A2; respectively; then the composite function L3 D L2 i L1; defined by

                                            L3.X/ D L2.L1.X//;

      is the linear transformation from Rn to Rm with matrix A2A1:

Example 6.1.4 If

                    2         2x C 3y    3                2     xy    3

               L1.X/ D 4 3x C 2y 5 and L2.X/ D 4 4x C y 5 ;

                              xC y                              x

then                       2      3                    2           3
                                                                1
                              23                          1     1 5:

                    A1 D 4 3 2 5 and A2 D 4 4                   0

                              11                          1

The linear transformation

                                  L D 2L1 C L2

is defined by

                    L.X/ D 2L1.X/ C L2.X/                       3
                              2                    32
                                  2x C 3y                 xy

                              D 2 4 3x C 2y 5 C 4 4x C y 5

                              2          xC y  3          x

                                 3x C 5y
                              D 4 10x C 5y 5 :

                                  x C 2y

The matrix of L is                  2           3
                                          3  5
                                             5 5 D 2A1 C A2:
                              A D 4 10
                                             2
                                          1

 Example 6.1.5 Let                    Ä            W R2 ! R2;
and                        L1.X/ D x C 2y 3x C 4y

                                      2                3
                           L2.U/ D 4         uC v
                                             u 2v 5 W R2 ! R3:

                                         3u C v
                               Section 6.1 Linear Transformations and Matrices 367

Then L3 D L2 i L1 W R2 ! R3 is given by                               32
         2                                                                                 3
                                  .x C 2y/ C .3x C 4y/                        4x C 6y
L3.X/ D L2..L1.X// D 4 .x C 2y/ 2.3x C 4y/ 5 D 4                              7x 10y 5 :
                                                                              6x C 10y
                               3.x C 2y/ C .3x C 4y/

The matrices of L1 and L2 are                                 2          3

      Ä  12                                                      11
         34
A1 D                              and A2 D 4 1 2 5 ;

                                                                 31

respectively. The matrix of L3 is                         3
                                          2            6
                                                4     10 5 D A2A1:

                                   CD4 7              10

                                                6

Example 6.1.6 The linear transformations of Example 6.1.5 can be written as
                                                              2       1 3Ä
Ä                              Ä                                   1
L1.X/ D 1 2 x ; L2.U/ D 4 1 2 5 u ;
   34 y                                                          31 v

4 6 and 2 3 Ä
                                  L3.X/ D 4 7 10 5 x :
                                                   6 10 y

A New Notation for the Differential

If a real-valued function f W Rn ! R is differentiable at X0, then

dX0 f D fx1 .X0/ dx1 C fx2 .X0/ dx2 C C fxn .X0/ dxn:

This can be written as a matrix product                               2  dx1  3
                   dX0 f D OEfx1 .X0/ fx2 .X0/
                                                                      6  dx2  7
                                                                      6       7
                                                              fxn .X0/ 6 :: 7 :  (6.1.5)
                                                                      4:5        (6.1.6)

                                                                         dxn

We define the differential matrix of f at X0 by

f 0.X0/ D OEfx1 .X0/ fx2 .X0/                                    fxn .X0/

and the differential linear transformation by              3
                                                   2
                                                      dx1
                                  6 d X D 6 dx 6 2 7 : 77 :
                                                   4 :: 5

                                                      dxn
368 Chapter 6 Vector-Valued Functions of Several Variables

Then (6.1.5) can be rewritten as

                                  dX0 f D f 0.X0/ d X:                            (6.1.7)

   This is analogous to the corresponding formula for functions of one variable (Exam-
ple 5.3.7), and shows that the differential matrix f 0.X0/ is a natural generalization of the

derivative. With this new notation we can express the defining property of the differential

in a way similar to the form that applies for n D 1:

       f .X/                      f .X0/ f 0.X0/.X         X0/ D 0;
 lim                                   jX X0j

X!X0

where X0 D .x10; x20; : : : ; xn0/ and f 0.X0/.X X0/ is the matrix product

                                                        2  x1 x10    3

                                                        6  x2  x20   7
                                                        6            7
OEfx1 .X0/ fx2 .X0/                     fxn .X0/ 6 :: 7 :
                                                        4:5

                                                           xn xn0

   As before, we omit the X0 in (6.1.6) and (6.1.7) when it is not necessary to emphasize
the specific point; thus, we write

f 0 D fx1 fx2                           fxn and df D f 0d X:

Example 6.1.7 If                  f .x; y; ´/ D 4x2y´3;

then
                            f 0.x; y; ´/ D OE8xy´3 4x2´3 12x2y´2:

In particular, if X0 D .1; 1; 2/, then

                  f 0.X0/ D OE 64 32 48;

so
                                                                           23
                                                                              dx

                      dX0f D f 0.X0/ d X D OE 64 32 48 4 dy 5
                                                                              d´

                                                D 64 dx C 32 dy 48 d´:

The Norm of a Matrix

We will need the following definition in the next section.

Definition 6.1.8 The norm; kAk; of an m n matrix A D OEaij  is the smallest number
such that

                                            jAXj Ä kAk jXj
for all X in Rn:
                    Section 6.1 Linear Transformations and Matrices 369

   To justify this definition, we must show that kAk exists. The components of Y D AX
are

                        yi D ai1x1 C ai2x2 C C ainxn; 1 Ä i Ä m:

By Schwarz's inequality,

                                 yi2 Ä .ai21 C ai22 C C ain 2 /jXj2:

Summing this over 1 Ä i Ä m yields

                                      0  X m Xn     1

                    jYj2 Ä @                        aij2 A jXj2:

                                         i D1 j D1

Therefore, the set  B D °K  jAXj Ä KjXj for all X in Rn«

is nonempty. Since B is bounded below by zero, B has an infimum . If > 0, then  C
is in B because if not, then no number less than  C could be in B. Then  C would be
a lower bound for B, contradicting the definition of . Hence,

                    jAXj Ä . C /jXj; X 2 Rn:

Since is an arbitrary positive number, this implies that
                                       jAXj Ä jXj; X 2 Rn;

so  2 B. Since no smaller number is in B, we conclude that kAk D .

   In our applications we will not have to actually compute the norm of a matrix A; rather,
it will be sufficient to know that the norm exists (finite).

Square Matrices

Linear transformations from Rn to Rn will be important when we discuss the inverse func-
tion theorem in Section 6.3 and change of variables in multiple integrals in Section 7.3.
The matrix of such a transformation is square; that is, it has the same number of rows and
columns.

We assume that you know the definition of the determinant

                                      a11  a12         a1n        
                                                                  
                     det.A/ D  a  21 a22 : : : a2n  : 
                                     :: :: : : :: 
                                     an1 an2           ann        

of an n n matrix    2                                       3

                    6  a11 a12                         a1n  7
                    6                                       7
                       a21               a22           a2n
                    A D 6 :: :: : : :: 7 :
                    4: : : :5

                       an1 an2                         ann
370 Chapter 6 Vector-Valued Functions of Several Variables

The transpose, At , of a matrix A (square or not) is the matrix obtained by interchanging

the rows and columns of A; thus, if

                    2       3        3                   2      13    3
                        12                                          0
                            4 5 ; then At D 4 2 1                   1 5:
              AD4 3 1

              01 2                                              34 2

A square matrix and its transpose have the same determinant; thus,

                                     det.At / D det.A/:

   We take the next theorem from linear algebra as given.
Theorem 6.1.9 If A and B are n n matrices; then

                                      det.AB/ D det.A/ det.B/:

   The entries aii , 1 Ä i Ä n, of an n n matrix A are on the main diagonal of A. The n n
matrix with ones on the main diagonal and zeros elsewhere is called the identity matrix and
is denoted by I; thus, if n D 3,

                                        2  100        3

                            I D 4 0 1 0 5:

                                           001

   We call I the identity matrix because AI D A and IA D A if A is any n n matrix. We
say that an n n matrix A is nonsingular if there is an n n matrix A 1, the inverse of A,
such that AA 1 D A 1A D I. Otherwise, we say that A is singular

   Our main objective is to show that an n n matrix A is nonsingular if and only if
det.A/ ¤ 0. We will also find a formula for the inverse.

Definition 6.1.10 Let A D OEaij  be an n n matrix; with n           2: The cofactor of an

entry aij is                cij D . 1/iCj det.Aij /;

where Aij is the .n 1/ .n 1/ matrix obtained by deleting the i th row and j th column
of A: The adjoint of A; denoted by adj.A/; is the n n matrix whose .i; j /th entry is cj i :

Example 6.1.8 The cofactors of                               3
                                                      21
                                               2      1 25
                                                   4
                                                      12
                                         AD4 3
                                                   0
                             Section 6.1 Linear Transformations and Matrices 371

are                                                                                             
                                                                                              1  D 3;
    c11  D   1 2      D  4;  c12 D  3 2            D    6;                       c13 D   3    1
                                                                                         
                12                     02                                                  0

    c  21 D  2 1  1 2    D 3; c22 D  4 1  0 2    D 8; c23 D  4 2  0 1  D 4;                   

             2 1                    4 1                                                  4      
                                                                                              2  D 10;
    c31  D      12    D  5;  c32 D     32          D    5;                       c33 D     3  1
                                                                                         

so                                  2                                            3

                                       43 5

                             adj.A/ D 4 6 8 5 5 :

                                       3 4 10

Notice that adj.A/ is the transpose of the matrix      3
                                                    3
                                         2          45
                                               46
                                                   10
                                         43 8

                                               55

obtained by replacing each entry of A by its cofactor.

    For a proof of the following theorem, see any elementary linear algebra text.

Theorem 6.1.11 Let A be an n n matrix:

(a) The sum of the products of the entries of a row of A and their cofactors equals det.A/;
      while the sum of the products of the entries of a row of A and the cofactors of the
      entries of a different row equals zeroI that is;

                             Xn              det.A/;                             i D j;         (6.1.8)
                                  aikcjk D   0;                                  i ¤ j:

                             kD1

(b) The sum of the products of the entries of a column of A and their cofactors equals
      det.A/; while the sum of the products of the entries of a column of A and the cofactors
      of the entries of a different column equals zeroI that is;

                             Xn              det.A/;                             i D j;         (6.1.9)
                                  cki akj D  0;                                  i ¤ j:

                             kD1

    If we compute det.A/ from the formula

                                                       Xn
                                          det.A/ D aikcik;

                                                                            kD1
372 Chapter 6 Vector-Valued Functions of Several Variables

we say that we are expanding the determinant in cofactors of its i th row. Since we can

choose i arbitrarily from f1; : : : ; ng, there are n ways to do this. If we compute det.A/

from the formula                      Xn
                          det.A/ D akj ckj ;

                                      kD1

we say that we are expanding the determinant in cofactors of its j th column. There are also
n ways to do this.

    In particular, we note that det.I/ D 1 for all n 1.

Theorem 6.1.12 Let A be an n n matrix: If det.A/ D 0; then A is singular: If
det.A/ ¤ 0; then A is nonsingular; and A has the unique inverse

                          A 1 D 1 adj.A/:                                 (6.1.10)
                                   det.A/

Proof If det.A/ D 0, then det.AB/ D 0 for any n n matrix, by Theorem 6.1.9.
Therefore, since det.I/ D 1, there is no matrix n n matrix B such that AB D I; that is, A
is singular if det.A/ D 0. Now suppose that det.A/ ¤ 0. Since (6.1.8) implies that

                          A adj.A/ D det.A/I

and (6.1.9) implies that

                          adj.A/A D det.A/I;

dividing both sides of these two equations by det.A/ shows that if A 1 is as defined in

(6.1.10), then AA 1 D A 1A D I. Therefore, A 1 is an inverse of A. To see that it is the
only inverse, suppose that B is an n n matrix such that AB D I. Then A 1.AB/ D A 1,
so .A 1A/B D A 1. Since AA 1 D I and IB D B, it follows that B D A 1.

Example 6.1.9 In Example 6.1.8 we found that the adjoint of

                                   2  4 21               3

                          AD4 3 1 2 5

                                      0 12

is                                 2                        3

                                      43 5

                          adj.A/ D 4 6 8 5 5 :

                                      3 4 10

We can compute det.A/ by finding any diagonal entry of A adj.A/.  (Why?)  This yields

det.A/ D 25. (Verify.) Therefore,

                                   2  43 5                  3

                          A 1 D 1 4 6 8 5 5:
                                   25 3 4 10
                           Section 6.1 Linear Transformations and Matrices 373

Now consider the equation

                                   AX D Y                                        (6.1.11)

with

          2                     3  23                            23
             a11 a12       a1n             x1                                y1
          6                     7  6                   7         6               7
          6  a21  a22      a2n  7  6       x2          7         6           y2  7
          A D 6 :: :: :: :: 7 ; X D 6 :: 7 ; and Y D 6 :: 7 :
          4: : : :5                4:5                           4:5

             an1 an2       ann             xn                                yn

Here A and Y are given, and the problem is to find X.

Theorem 6.1.13 The system (6.1.11) has a solution X for any given Y if and only if
A is nonsingular: In this case; the solution is unique and is given by X D A 1Y.

Proof     Suppose that A is nonsingular, and let X D A 1Y. Then
                          AX D A.A 1Y/ D .AA 1/Y D IY D YI

 that is, X is a solution of (6.1.11). To see that X is the only solution of (6.1.11), suppose
 that AX1 D Y. Then AX1 D AX, so

                                         A 1.AX/ D A 1.AX1/

and
                                         .A 1A/X D .A 1A/X1;

which is equivalent to IX D IX1, or X D X1.
   Conversely, suppose that (6.1.11) has a solution for every Y, and let Xi satisfy AXi D

Ei , 1 Ä i Ä n. Let
                                          B D OEX1 X2 XnI

that is, X1, X2, . . . , Xn are the columns of B. Then

                  AB D OEAX1 AX2 AXn D OEE1 E2 En D I:

To show that B D A 1, we must still show that BA D I. We first note that, since AB D I
and det.BA/ D det.AB/ D 1 (Theorem 6.1.9), BA is nonsingular (Theorem 6.1.12). Now
note that

                                   .BA/.BA/ D B.AB/A/ D BIAI

that is,

                           .BA/.BA/ D .BA/:

Multiplying both sides of this equation on the left by BA/ 1 yields BA D I.

   The following theorem gives a useful formula for the components of the solution of
(6.1.11).
374 Chapter 6 Vector-Valued Functions of Several Variables

Theorem 6.1.14 (Cramer's Rule) If A D OEaij  is nonsingular; then the solu-
tion of the system

                          a11x1 C a12x2 C                 C a1nxn D y1
                          a21x1 C a22x2 C                 C a2nxn D y2

                          an1x1 C an2x2 C                             ::
                                                                      :
                                                          C annxn D yn

.or; in matrix form; AX D Y/ is given by

                                xi D Di ; 1 Ä i Ä n;
                                       det.A/

where Di is the determinant of the matrix obtained by replacing the i th column of A with

YI thus;

            y1     a12          a1n                       a11       y1        a13          a1n  
                                                                                                
            y2     a22  :::     a2n                       a21       y2        a23          a2n  
                                                                                                
     D1 D  ::      :: ::        ::  ; D2 D  ::                      ::        :: : :       ::   ;  ;
                                                     : : : : :                                  
          : : : : 
           yn an2               ann                   an1 yn an3                           ann 

                                         a11              a1;n 1        y1    
                                                                              
                                         a21              a2;n 1        y2    
                             Dn D  ::                                         :
                                                 ::         ::          ::    
                                     : :                        : :
                                      an1              an;n 1 yn 

Proof     From Theorems 6.1.12 and 6.1.13, the solution of AX D Y is

            23                                2                                       32 3
               x1                                    c11 c21                    cn1        y1
            6 x2 7                            6                                       76        7
            67               1           1    6      c12    c22                 cn2   76   y2   7
            6 :: 7 D A Y D                    6                                       7 6 :: 7
            4:5                      det.A/ 4                       ::     :          54 : 5

               xn               2                    c1n c2n                    cnn   3    yn

                                         c11y1 C c21y2 C C cn1yn
                                6 D 6 c 6 12y1 C c22y2 C : C cn2yn 777 :
                                4                               ::                    5

                                         c1ny1 C c2ny2 C C cnnyn

But                                                                                        
                                                                                           
                                                            y1      a12               a1n  
                                                                                           
                                                            y2      a22         :::   a2n

               c11y1 C c21y2 C C cn1yn D  :: :: : : ::  ;       :       :          :  :    
                                                                                           
                                                           yn an2                     ann 
                                Section 6.1 Linear Transformations and Matrices 375

as can be seen by expanding the determinant on the right in cofactors of its first column.

Similarly,

                                                a11      y1           a13             a1n     
                                                                                              
                                                a21      y2           a23             a2n     
            c12y1 C c22y2 C     C cn2yn D  :                                             ::  ;
                                                  :             ::       :: : :
                                                   :           :         :       :      :     
                                                                                              
                                             an1 yn an3                               ann 

as can be seen by expanding the determinant on the right in cofactors of its second column.
Continuing in this way completes the proof.

Example 6.1.10 The matrix of the system

                                           4x C 2y C ´ D 1
                                            3x y C 2´ D 2

                                                   y C 2´ D 0

is                                    2                  3

                                         4 21

                                A D 4 3 1 2 5:

                                         0 12

Expanding det.A/ in cofactors of its first row yields

                                                                                      
            det.A/ D 4  1 2  1 2    2  3 2  0 2    C 1  3 1  0 1 

                        D 4. 4/ 2.6/ C 1.3/ D 25:

Using Cramer's rule to solve the system yields

                 1           2  1                                     4     1  1    
                                                                                    
            1x D 25  20      1 2  1 2  D 5 ; y D 25  3 2 2  0 0 2  D 5 ;21                 2

                                         4      2     1  
                                                         
                        ´ D 25  30 1            1 2  1 0  D 5 :       1

    A system of n equations in n unknowns

                        a11x1 C a12x2 C            C a1nxn D 0                                  (6.1.12)
                        a21x1 C a22x2 C            C a2nxn D 0

                        an1x1 C an2x2 C                        ::
                                                               :

                                                   C annxn D 0

(or, in matrix form, AX D 0) is homogeneous. It is obvious that X0 D 0 satisfies this
system. We call this the trivial solution of (6.1.12). Any other solutions of (6.1.12), if they
exist, are nontrivial.
376 Chapter 6 Vector-Valued Functions of Several Variables

   We will need the following theorems. The proofs may be found in any linear algebra
text.

Theorem 6.1.15 The homogeneous system (6.1.12) of n equations in n unknowns has
a nontrivial solution if and only if det.A/ D 0:

Theorem 6.1.16 If A1; A2; . . . ; Ak are nonsingular n n matrices; then so is A1A2 Ak ;
and

                               .A1A2 Ak/ 1 D Ak 1Ak 1 1 A1 1:

                                       6.1 Exercises

1. Prove: If L W Rn ! Rm is a linear transformation, then

L.a1X1 C a2X2 C C akXk/ D a1L.X1/ C a2L.X2/ C C akL.Xk /

if X1; X2; : : : ; Xk are in Rn and a1, a2, . . . , ak are real numbers.

2. Prove that the transformation L defined by Eqn. (6.1.1) is linear.

3. Find the matrix of L.                                        2               3

             2             3x C 4y C 6´   3                        2x1 C 4x2

(a) L.X/ D 4 2x 47 C 2´ 5                             (b) L.X/ D 66 3x 4 1 2x2 775
                                                                   7x1 4x2
                           7x C 2y C 3´
                                                                   6x1 C x2

4. Find cA.                2                 3                            2            3
                                                                             1  30
                              224 6                                             1 25
                                                                2; A D 4 0
(a) c D 4; A D 4 0 0 1 3 5                            (b) c D                   13
                                                                             1
                              3 4 7 11

5. Find A C B.                       3       2        103       3
                  2           23
                        1

(a) A D 4 1 1 4 5 ; B D 4 5 6 7 5

                  0 14                                012

            2                3         2            3
               0           5     BD4         12
                           2 5;              0 35
(b) A D 4 3
                           7                 47
               1

6. Find AB. 2                        3          2            3
                        1     23          BD4         12
                              1 4 5;                  0 35
     (a) A D 4 0

                  0 14                                47
                                             23
Ä (b) A D 5 3 2 1 6 6 7 4 1 ; B D 6 31 7 4 4 75

                                                   7
                             Section 6.1 Linear Transformations and Matrices 377

7. Prove Theorem 6.1.4.

8. Prove Theorem 6.1.5.

9. Prove Theorem 6.1.6.

10. Suppose that A C B and AB are both defined. What can be said about A and B?

11. Prove Theorem 6.1.7.

12. Find the matrix of aL1 C bL2.
   2                                      3
                           3x C 2y C ´
(a) L1.x; y; ´/ D 4 x C 4y C 2´ 5,

                             3x 4y C ´

                 2                            3  a D 2;  bD 1
L2.x; y; ´/ D 4               xCy ´
                             2x C y C 3´ 5;

                                    yC ´

   2                       2x C 3y  3            2       3x y     3

(b) L1.x; y/ D 4 x y 5 ; L2.x; y/ D 4 x C y 5 ; a D 4; b D

                           4x C y                        xy

2

13. Find the matrices of L1iL2 and L2iL1, where L1 and L2 are as in Exercise 6.1.12(a).

14. Write the transformations of Exercise 6.1.12 in the form L.X/ D AX.

15. Find f 0 and f 0.X0/.

(a) f .x; y; ´/ D 3x2y´, X0 D .1; 1; 1/

(b) f .x; y/ D sin.x C y/, X0 D . =4; =4/

(c) f .x; y; ´/ D xye x´, X0 D .1; 2; 0/

(d) f .x; y; ´/ D tan.x C 2y C ´/, X0 D . =4; =8; =4/
                                             pp                p
(e) f .X/ D jXj W Rn ! R, X0 D .1= n; 1= n; : : : ; 1= n/

16. Let A D OEaij  be an m n matrix and

                                    °                          «
                           D max jaij j  1 Ä i Ä m; 1 Ä i Ä n :

                       p
Show that kAk Ä mn.

17. Prove: If A has at least one nonzero entry, then kAk ¤ 0.

18. Prove: kA C Bk Ä kAk C kBk.

19. Prove: kABk Ä kAk kBk.

20. Solve by Cramer's rule.

        x C y C 2´ D 1                               xC y ´D 5
(a) 2x y C ´ D 1                             (b) 3x 2y C 2´ D 0

         x 2y 3´ D 2                                4x C 2y 3´ D 14
378 Chapter 6 Vector-Valued Functions of Several Variables

x C 2y C 3´ D 5                     x y C ´ 2w D 1

(c) x             ´D 1           (d) 2x C y 3´ C 3w D 4
                                 3x C 2y                       C w D 13
x C y C 2´ D 4
                                 2x C y ´                      D4

21. Find A 1 by the method of Theorem 6.1.12. 2 3
Ä                                         12 3
   12                            (b) 4 1 0 1 5
(a) 3 4
                                    11 2

     2             3             2  101                     3
         4  21
            1 25                 (d) 4 0 1 1 5
(c) 4 3
            12                      110
         0

     2            00     3       2               11 2 1        3
           12
                  0   0  7       (f ) 66 2 2 1 3 7 4 1 4 1 2 75
(e) 66 2 3 4 0 0         7
           00     2 35

                  12                             31 0 1

22. For 1 Ä i; j Ä m, let aij D aij .X/ be a real-valued function continuous on a
        compact set K in Rn. Suppose that the m m matrix

                               A.X/ D OEaij .X/

is nonsingular for each X in K, and define the m m matrix

                               B.X; Y/ D OEbij .X; Y/

by
                                B.X; Y/ D A 1.X/A.Y/ I:

Show that for each > 0 there is a i > 0 such that

                         jbij .X; Y/j < ; 1 Ä i; j Ä m;

if X; Y 2 K and jX    Yj < i. HINT: Show that bij is continuous on the set

                            °.X; Y/  X 2 K; Y 2 K :    «

Then assume that the conclusion is false and use Exercise 5.1.32 to obtain a contradiction:

6.2 CONTINUITY AND DIFFERENTIABILITY OF TRANS-
FORMATIONS

Throughout the rest of this chapter, transformations F and points X should be considered as
written in vertical form when they occur in connection with matrix operations. However,
we will write X D .x1; x2; : : : ; xn/ when X is the argument of a function.
            Section 6.2 Continuity and Differentiability of Transformations 379

Continuous Transformations

In Section 5.2 we defined a vector-valued function (transformation) to be continuous at X0
if each of its component functions is continuous at X0. We leave it to you to show that this
implies the following theorem (Exercise 1).

Theorem 6.2.1 Suppose that X0 is in; and a limit point of; the domain of F W Rn !
Rm: Then F is continuous at X0 if and only if for each > 0 there is a i > 0 such that

            jF.X/ F.X0/j < if jX X0j < i and X 2 DF:                                   (6.2.1)

   This theorem is the same as Theorem 5.2.7 except that the "absolute value" in (6.2.1)
now stands for distance in Rm rather than R.

   If C is a constant vector, then "limX!X0 F.X/ D C" means that

                                          lim jF.X/ Cj D 0:

                                                          X!X0

Theorem 6.2.1 implies that F is continuous at X0 if and only if

                                          lim F.X/ D F.X0/:

                                                           X!X0

Example 6.2.1 The linear transformation

            2               xC yC´                        3

            L.X/ D 4 2x 3y C ´ 5

                            2x C y ´

is continuous at every X0 in R3, since                    x0/ C .y  y0/ C .´       3
                                                          x0/ 3.y   y0/ C .´  ´0 /
                                                2         x0/ C .y  y0/ .´    ´0/ 5 ;
                                                      .x                      ´0 /

         L.X/ L.X0/ D L.X X0/ D 4 2.x

                                                    2.x

and applying Schwarz's inequality to each component yields          X0j2:
                 jL.X/ L.X0/j2 Ä .3 C 14 C 6/jX X0j2 D 23jX

Therefore,

            jL.X/ L.X0/j <  if jX X0j < p :
                                                  23

Differentiable Transformations

In Section 5.4 we defined a vector-valued function (transformation) to be differentiable at
X0 if each of its components is differentiable at X0 (Definition 5.4.1). The next theorem
characterizes this property in a useful way.
380 Chapter 6 Vector-Valued Functions of Several Variables

Theorem 6.2.2 A transformation F D .f1; f2; : : : ; fm/ defined in a neighborhood of
X0 2 Rn is differentiable at X0 if and only if there is a constant m n matrix A such that

                                  F.X/       F.X0/ A.X    X0/ D 0:                     (6.2.2)
                            lim                jX X0j

                           X!X0

If (6.2.2) holds; then A is given uniquely by

                           2 @f1.X0/ @f1.X0/                     @f1.X0/ 3

                           6        @x1        @x2                    @xn  7
                           6                                               7
            Ä @fi .X0/ 666 @f2.X0/ @f2.X0/                       @f2.X0/ 777
AD                         D 6 @x1             @x2                    @xn 7 :          (6.2.3)
            @xj            6:                  ::                     ::   7
                           6         ::          :        ::  :            7
                           6                                            :7
                           4 @fm.X0/ @fm.X0/                     @fm.X0/ 5

                                    @x1        @x2                    @xn

Proof Let X0 D .x10; x20; : : : ; xn0/. If F is differentiable at X0, then so are f1, f2,
. . . , fm (Definition 5.4.1). Hence,

                   fi .X/  fi .X0/  Xn @fi .X0/           xj 0/
             lim                           @xj .xj              D 0;
                                                                           1 Ä i Ä m;
            X!X0                    j D1

                                    jX X0j

which implies (6.2.2) with A as in (6.2.3).

   Now suppose that (6.2.2) holds with A D OEaij . Since each component of the vector in
(6.2.2) approaches zero as X approaches X0, it follows that

                   fi .X/  fi .X0/           Xn           xj 0/       1 Ä i Ä m;
             lim                 jX              aij .xj        D 0;

            X!X0                             j D1

                                             X0j

so each fi is differentiable at X0, and therefore so is F (Definition 5.4.1).          By Theo-

rem 5.3.6,

                           aij D @fi .X0/ ;  1 Ä i Ä m;   1 Ä j Ä n;
                                     @xj

which implies (6.2.3).
   A transformation T W Rn ! Rm of the form

                                       T.X/ D U C A.X X0/;

where U is a constant vector in Rm, X0 is a constant vector in Rn, and A is a constant m n
matrix, is said to be affine. Theorem 6.2.2 says that if F is differentiable at X0, then F can
be well approximated by an affine transformation.
                 Section 6.2 Continuity and Differentiability of Transformations 381

Example 6.2.2 The components of the transformation

                                              2 x2 C 2xy C ´ 3
                                    F.X/ D 4 x C 2x´ C y 5

                                                  x2 C y2 C ´2

are differentiable at X0 D .1; 0; 2/. Evaluating the partial derivatives of the components

there yields                        2               3

                                       221

                               A D 4 5 1 2 5:

                                       204

(Verify). Therefore, Theorem 6.2.2 implies that the affine transformation

                 T.X/ D F.X0/ C A.X            X0/

                               2 32    2       21   32               3
                               3                          x1

                            D4 5 5C4 5         1 2 54 y 5

                               5       2       04         ´2

satisfies                           F.X/ T.X/

                               lim                  D 0:
                               X!X0 jX X0j

Differential of a Transformation

If F D .f1; f2; : : : ; fm/ is differentiable at X0, we define the differential of F at X0 to be

the linear transformation              2            3

                                       6  dX0 f1    7
                                       6            7
                                          dX0 f2
                               dX0 F D 6 : 7 :                               (6.2.4)
                                       4 :: 5

                                          dX0 fm

We call the matrix A in (6.2.3) the differential matrix of F at X0 and denote it by F0.X0/;

thus,                      2 @f1.X0/ @f1.X0/                    @f1.X0/ 3

                            6  @x1        @x2                   @xn     7
                            6                                           7
                            666 @f2.X0/ @f2.X0/                 @f2.X0/ 777
              0             6 @x1         @x2                   @xn 7
              F .X0/ D 6                                                7:   (6.2.5)
                           6   ::          ::       :::         ::      7
                           66:            :                       :7    7

                            6                                           7
                            4 @fm.X0/ @fm.X0/             @fm.X0/ 5

                               @x1        @x2                   @xn
382 Chapter 6 Vector-Valued Functions of Several Variables

(It is important to bear in mind that while F is a function from Rn to Rm, F0 is not such
a function; F0 is an m n matrix.) From Theorem 6.2.2, the differential can be written in

terms of the differential matrix as

                                               2    dx1         3

                                               6    dx2         7
                                               6                7
                         dX0 F D F0.X0/ 6 : 7                                 (6.2.6)
                                               4 :: 5

                                                    dxn

or, more succinctly, as

                                     dX0 F D F0.X0/ d X;

where                                     2         3

                                               dx1
                                     6 d X D 6 dx 6 2 7 : 77 ;
                                          4 :: 5

                                               dxn

as defined earlier.

When it is not necessary to emphasize the particular point X0, we write (6.2.4) as

                                          2    df1  3

                                     6 d F D 6 df 6 2 7 : 77 ;
                                          4 :: 5

                                               dfm

(6.2.5) as

                         2 @f1 @f1                              @f1 3

                         6           @x1  @x2                   @xn  7
                         6                                           7
                          666 @f2 @f2                           @f2 777
                         0 6 @x1 @x2                            @xn 7
                         F D6                                        7;
                         6           ::   ::        :::         ::   7
                         66:                :                     :7 7

                         6                                           7
                         4 @fm @fm                              @fm 5

                                     @x1 @x2                    @xn

and (6.2.6) as

                                         d F D F0 d X:

With the differential notation we can rewrite (6.2.2) as

                            F.X/     F.X0/ F0.X0/.X                 X0/ D 0:
                      lim                 jX X0j

                     X!X0
                       Section 6.2 Continuity and Differentiability of Transformations 383

Example         6.2.3  The linear transformation

                                 2      a11x1 C a12x2 C                    3
                                 6                            C a1nxn
                                 6      a21x1 C a22x2 C       C a2nxn 777
                       F.X/ D 6                           ::
                                 4                        :                5
                                                              C amnxn
                                    am1x1 C am2x2 C

can be written as F.X/ D AX, where A D OEaij . Then
                                                 F0 D AI

that is, the differential matrix of a linear transformation is independent of X and is the

matrix of the transformation. For example, the differential matrix of

                                           Ä                  23
                       F.x1; x2; x3/ D 1 2 3                     x1

                                              210             4 x2 5
                                                                 x3

is                                      Ä

                                        F0 D 1 2 3 :
                                           210

If F.X/ D X (the identity transformation), then F0 D I (the identity matrix).

Example 6.2.4 The transformation
                                                    2x3
                                                    6 x2 C y2 7

                                      F.x; y/ D 666 y 777
                                                    4 x2 C y2 5
                                                          2xy

is differentiable at every point of R2 except .0; 0/, and

                                     2    y2 x2               2xy 3
                                     6  .x2 C y2/2
                                     6                        .x2 C y2/2  7
                       F0.x; y/ D 666        2xy                          7
                                     4   .x2 C y2/2           x2 y2 777 :
                                                              .x2 C y2/2 5

                                        2y                    2x

In particular,                      2                         13
                                          0                   27

                                    6                            7
                       F0.1; 1/ D 66 1 4 2                    0 7;

                                          2                      5

                                                              2
384 Chapter 6 Vector-Valued Functions of Several Variables

so

                     2 0 2 1 3 2 0                                      13      1

                  1  B                            6 76                  2 7Ä    C
                     B                            617 6 1                  7 x 1C
      lim p          BF.x; y/ 6 2 7 6 2                                 07      C
.x;y/!.1;1/ .x 1/2 C .y 1/2 @                     4 54                     5 y 1A

                                                     2         2        2

                                  23
                                      0

                               D 4 0 5:

                                      0

    If m D n, the differential matrix is square and its determinant is called the Jacobian of

F. The standard notation for this determinant is

                                @f1 @f1                        @f1  

                                        @x1       @x2          @xn  
                                                                    
                                        @f2       @f2          @f2  
             @.f1; f2; : : : ; fn/  D  @x1 @x2                       
                                                               @xn 
             @.x1; x2; : : : ; xn/  ::
                                                                     :
                                                     :: : : :: 
                               :                     :     : :      

                                @fn @fn                        @fn  

                                        @x1 @x2                @xn

We will often write the Jacobian of F more simply as J.F/, and its value at X0 as J F.X0/.

   Since an n n matrix is nonsingular if and only if its determinant is nonzero, it follows
that if F W Rn ! Rn is differentiable at X0, then F0.X0/ is nonsingular if and only if
J F.X0/ ¤ 0. We will soon use this important fact.

Example 6.2.5 If               2 x2 2x C ´ 3

                               6                           7
                                     6                     7
                     F.x; y; ´/ D 6     x C 2xy C ´2       7;
                               4                           5

                                        x Cy C´

then

                               2x       2         0     1  
                                                           
      @.f1; f2; f3/
      @.x D J F.X/ D  1; x2; x3/  1 C 2y 2x 2´  1 1 1 

                                                                              
                     D .2x 2/  2x 2´  1 1    C  1 C 2y 2x  1 1 

                     D .2x 2/.2x 2´/ C .1 C 2y 2x/:
                       Section 6.2 Continuity and Differentiability of Transformations 385

In particular, J F.1;  1; 1/ D 3, so the differential matrix

                                           2               3
                         F0.1; 1; 1/ D 4       001
                                               1 2 25

                                               111

is nonsingular.

Properties of Differentiable Transformations
We leave the proof of the following theorem to you (Exercise 6.2.16).

Theorem 6.2.3 If F W Rn ! Rm is differentiable at X0; then F is continuous at X0:

    Theorem 5.3.10 and Definition 5.4.1 imply the following theorem.

Theorem 6.2.4 Let F D .f1; f2; : : : ; fm/ W Rn ! Rm; and suppose that the partial

derivatives              @fi ; 1 Ä i Ä m; 1 Ä j Ä n;
                         @xj
                                                                       (6.2.7)

exist on a neighborhood of X0 and are continuous at X0: Then F is differentiable at X0:

   We say that F is continuously differentiable on a set S if S is contained in an open set
on which the partial derivatives in (6.2.7) are continuous. The next three lemmas give
properties of continuously differentiable transformations that we will need later.

Lemma 6.2.5 Suppose that F W Rn ! Rm is continuously differentiable on a neigh-
borhood N of X0: Then; for every > 0; there is a i > 0 such that

       jF.X/ F.Y/j < .kF0.X0/k C /jX Yj if A; Y 2 Bi.X0/:              (6.2.8)

Proof  Consider the auxiliary function
                                 G.X/ D F.X/
                                               F0 .X0 /X:              (6.2.9)

The components of G are

                         gi .X/ D fi .X/  Xn @fi .X0/@xj
                                                               ;

                                          j D1 x j

so                       @gi .X/ D @fi .X/ @fi .X0/ :

                         @xj              @xj  @xj
386 Chapter 6 Vector-Valued Functions of Several Variables

Thus, @gi =@xj is continuous on N and zero at X0. Therefore, there is a i > 0 such that

 @gi .X/    < p

       @xj     mn      for 1 Ä i Ä m; 1 Ä j Ä n; if jX X0j < i: (6.2.10)

Now suppose that X, Y 2 Bi.X0/. By Theorem 5.4.5,

                                        Xn @gi .Xi /
                       gi .X/ gi .Y/ D           @xj .xj yj /;                (6.2.11)

                                        j D1

where Xi is on the line segment from X to Y, so Xi 2 Bi.X0/. From (6.2.10), (6.2.11),

and Schwarz's inequality,

                           2 @X 0 n Ä @gi .Xi / 2A 2 2 1 2
            .gi .X/ gi .Y// Ä                           jX Yj < jX Yj :
                                        @xj                      m
                               j D1

Summing this from i D 1 to i D m and taking square roots yields

                 jG.X/ G.Y/j < jX Yj if X; Y 2 Bi.X0/:                        (6.2.12)

To complete the proof, we note that                                           (6.2.13)
                        F.X/ F.Y/ D G.X/ G.Y/ C F0.X0/.X Y/;

so (6.2.12) and the triangle inequality imply (6.2.8).

Lemma 6.2.6 Suppose that F W Rn ! Rn is continuously differentiable on a neigh-
borhood of X0 and F0.X0/ is nonsingular: Let

                                            1                                 (6.2.14)
                               r D k.F0.X0// 1k :

Then; for every > 0; there is a i > 0 such that

              jF.X/ F.Y/j .r /jX Yj if X; Y 2 Bi.X0/:                         (6.2.15)

Proof       Let X and Y be arbitrary points in DF and let G be as in (6.2.9). From (6.2.13),

              jF.X/ F.Y/j jF0.X0/.X Y/j jG.X/ G.Y/j;                          (6.2.16)

Since

                           X Y D OEF0.X0/ 1F0.X0/.X Y/;

(6.2.14) implies that      jX Yj Ä 1 jF0.X0/.X Yj;
so                                       r

                           jF0.X0/.X Y/j r jX Yj:                             (6.2.17)

Now choose i > 0 so that (6.2.12) holds. Then (6.2.16) and (6.2.17) imply (6.2.15).

See Exercise 6.2.19 for a stronger conclusion in the case where F is linear.
                  Section 6.2 Continuity and Differentiability of Transformations 387

Lemma 6.2.7 If F W Rn ! Rm is continuously differentiable on an open set containing
a compact set D; then there is a constant M such that

                  jF.Y/ F.X/j Ä M jY Xj if X; Y 2 D:                             (6.2.18)

Proof On                S D °.X; Y/  X; Y 2 D« R2n

define                  8        F.X/ F0.X/.Y            X/j ; Y ¤ X;
                        <jF.Y/      jY Xj                        Y D X:
          g.X; Y/ D :

                          0;

Then g is continuous for all .X; Y/ in S such that X ¤ Y. We now show that if X0 2 D,
then

                         lim g.X; Y/ D 0 D g.X0; X0/I                            (6.2.19)

                    .X;Y/!.X0;X0 /

that is, g is also continuous at points .X0; X0/ in S .

Suppose that > 0 and X0 2 D. Since the partial derivatives of f1, f2, . . . , fm are

continuous on an open set containing D, there is a i > 0 such that

          @fi .X/  < p
 @fi .Y/
 @xj      @xj         mn  if X; Y 2 Bi.X0/; 1 Ä i Ä m; 1 Ä j Ä n: (6.2.20)

(Note that @fi =@xj is uniformly continuous on Bi.X0/ for i sufficiently small, from The-

orem 5.2.14.) Applying Theorem 5.4.5 to f1, f2, . . . , fm, we find that if X, Y 2 Bi .X0/,

then                                 Xn @fi .Xi /

                    fi .Y/ fi .X/ D        @xj .yj xj /;

                                     j D1

where Xi is on the line segment from X to Y. From this,

2         fi .X/  Xn @fi .X/         X 32 2 n Ä @fi .Xi /           @fi .X/ .yj      32
4fi .Y/                 @xj .yj  xj /5 D 4                           @xj         xj /5

                  j D1                         j D1 @xj

                                     Ä jY                   2 Xn Ä @fi .Xi /  @fi .X/ 2
                                                         Xj                    @xj

                                                                       @xj

                                                                j D1

                                           (by Schwarz's inequality)

                                            2               (by (6.2.20)) :

                                     < jY Xj2
                                        m

Summing from i D 1 to i D m and taking square roots yields

          jF.Y/ F.X/ F0.X/.Y X/j < jY Xj if X; Y 2 Bi .X0/:

This implies (6.2.19) and completes the proof that g is continuous on S .
388 Chapter 6 Vector-Valued Functions of Several Variables

   Since D is compact, so is S (Exercise 5.1.27). Therefore, g is bounded on S (Theo-
rem 5.2.12); thus, for some M1,

                jF.Y/ F.X/ F0.X/.Y X/j Ä M1jX Yj if X; Y 2 D:

But                                                                  (6.2.21)

        jF.Y/ F.X/j Ä jF.Y/ F.X/ F0.X/.Y X/j C jF0.X/.Y X/j
                           Ä .M1 C kF0.X/k/j.Y Xj:

Since     0 @X 0 m Xn Ä @fi .X/                              11=2
       kF .X/k Ä
                                                            2
                                     @xj
                                                             A
                              i D1 j D1

and the partial derivatives f@fi =@xj g are bounded on D, it follows that kF0.X/k is bounded
on D; that is, there is a constant M2 such that

                              kF0.X/k Ä M2; X 2 D:

Now (6.2.21) implies (6.2.18) with M D M1 C M2.

The Chain Rule for Transformations

By using differential matrices, we can write the chain rule for transformations in a form
analogous to the form of the chain rule for real-valued functions of one variable (Theo-
rem 2.3.5).

Theorem 6.2.8 Suppose that F W Rn ! Rm is differentiable at X0; G W Rk ! Rn is
differentiable at U0; and X0 D G.U0/: Then the composite function H D F i G W Rk !
Rm; defined by

                                           H.U/ D F.G.U//;

is differentiable at U0: Moreover;

                              H0.U0/ D F0.G.U0 //G0.U0/              (6.2.22)

and                                 dU0 H D dX0 F i dU0 G;           (6.2.23)
where i denotes composition:

Proof The components of H are h1, h2, . . . , hm, where

                                    hi .U/ D fi .G.U//:

Applying Theorem 5.4.3 to hi yields

       dU0 hi D               Xn @fi .X0/                1 Ä i Ä m:
                                     @xj dU0 gj ;                    (6.2.24)

                              j D1
                    Section 6.2 Continuity and Differentiability of Transformations 389

Since                      2             3               2            3

                           6     dU0 h1  7               6    dU0 g1  7
                           6             7               6            7
                                 dU0 h2                       dU0 g2
       dU0 H D 6 :: 7                        and dU0 G D 6 :: 7 ;
                           4:5                           4:5

                              dU0 hm                          dU0 gn

the m equations in (6.2.24) can be written in matrix form as

                         dU0 H D F0.X0/dU0 G D F0.G.U0 //dU0 G:                 (6.2.25)

But                              dU0 G D G0.U0/ d U;
where
                                             2  d u1  3
so (6.2.25) can be rewritten as
                                             6  d u2  7
                                             6        7
                                   d U D 6 :: 7 ;
                                             4:5

                                                d uk

                              dU0 H D F0.G.U0 //G0.U0/ d U:

On the other hand,

                                 dU0 H D H0.U0/ d U:

Comparing the last two equations yields (6.2.22). Since G0.U0/ is the matrix of dU0G and
F0.G.U0// D F0.X0/ is the matrix of dX0F, Theorem 6.1.7(c) and (6.2.22) imply (6.2.23).

Example 6.2.6 Let U0 D .1; 1/,

                    2 pu 3                                        " x2 C y2 C 2´2 #

                        66p              7
G.U/ D G.u; v/ D 6                       7
                           u2 C 3v2      7;  F.X/ D F.x; y; ´/ D                     ;
                    4p 5                                                 x2 y2

                              vC2

and
                                           H.U/ D F.G.U//:

Since G is differentiable at U0 D .1; 1/ and F is differentiable at

                                       X0 D G.U0/ D .1; 2; 1/;

Theorem 6.2.8 implies that H is differentiable at .1; 1/. To find H0.1; 1/ from (6.2.22),
we first find that
390 Chapter 6 Vector-Valued Functions of Several Variables

                                 2        1                       3
                                 6      2pu
                                 6                        07
                      G0.U/ D 666         u                       7
                                 6  p                   3v        7
                                 4                  p             7
                                      u2 C 3v2       u2 C 3v2     7
                                                                  7
                                          0               1       5

                                                       p
                                                    2 vC2

and                            Ä

                      F0.X/ D 2x 2y 4´ :
                                    2x 2y 0

Then, from (6.2.22),

     H0.1;            1/ D F0.1; 2; 1/G0.1; 1/          3
                                                21
                                                    0
                         Ä                 62           7Ä
                      D2            4 4 61          37            3  4:
                                           62       2 7D             6
                            2       40     4           5          1

                                           0        1

                                                    2

We can check this by expressing H directly in terms of .u; v/ as

                  2      p2 p                       Á2        p        3
                  6
     H.u; v/ D 4                                                     2
                               u C u2 C 3v2 C 2 v C 2 7
                                    p2 p                      Á2     5
                                                    u2 C 3v2
                                        u

                      D  Ä u C u2 C 3v2 C 2v C 4

                                  u u2 3v2

and differentiating to obtain
                                               Ä

                                 H0.u; v/ D 1 C 2u 6v C 2 ;
                                                   1 2u 6v

which yields                             Ä             4;
as we saw before.        H0.1; 1/ D 3                  6

                                              1

                                    6.2 Exercises

1. Show that the following definitions are equivalent.

     (a) F D .f1; f2; : : : ; fm/ is continuous at X0 if f1, f2, . . . , fm are continuous
             at X0.
                Section 6.2 Continuity and Differentiability of Transformations 391

(b) F is continuous at X0 if for every > 0 there is a i > 0 such that jF.X/
      F.X0/j < if jX X0j < i and X 2 DF.

2. Verify that     lim F.X/ F.X0/ F0.X0/.X X0/ D 0:

                   X!X0               jX X0j

                2  3x C 4y  3

(a) F.X/ D 4 2x y 5 ; X0 D .x0; y0; ´0/

                   xC y

                2 2x2 C xy C 1 3
(b) F.X/ D 4                      5;
                   xy                 X0 D .1; 1/

                   x2 C y2

                2  sin.x C y/  3

(c) F.X/ D 4 sin.y C ´/ 5 ;       X0 D . =4; 0; =4/

                   sin.x C ´/

3. Suppose that F W Rn ! Rm and h W Rn ! R have the same domain and are
      continuous at X0. Show that the product hF D .hf1; hf2; : : : ; hfm/ is continuous at
      X0.

4. Suppose that F and G are transformations from Rn to Rm with common domain D.
      Show that if F and G are continuous at X0 2 D, then so are F C G and F G.

5. Suppose that F W Rn ! Rm is defined in a neighborhood of X0 and continuous at
      X0, G W Rk ! Rn is defined in a neighborhood of U0 and continuous at U0, and

      X0 D G.U0/. Prove that the composite function H D F i G is continuous at U0.

6. Prove: If F W Rn ! Rm is continuous on a set S , then jFj is continuous on S .

7. Prove: If F W Rn ! Rm is continuous on a compact set S , then jFj is bounded on
      S , and there are points X0 and X1 in S such that

                   jF.X0/j Ä jF.X/j Ä jF.X1/j; X 2 S I

      that is, jFj attains its infimum and supremum on S . HINT: Use Exercise 6.2.6:
8. Prove that a linear transformation L W Rn ! Rm is continuous on Rn. Do not use

      Theorem 6.2.8.

9. Let A be an m n matrix.
     (a) Use Exercises 6.2.7 and 6.2.8 to show that the quantitites

M.A/ D max jAXj  X ¤ 0                and m.A/ D min jAXj  X ¤ 0
                    jXj                                          jXj

                                                        °  «
exist. HINT: Consider the function L.Y/ D AY on S D Y  jYj D 1 :
392 Chapter 6 Vector-Valued Functions of Several Variables

       (b) Show that M.A/ D kAk.
       (c) Prove: If n > m or n D m and A is singular, then m.A/ D 0. (This requires a

               result from linear algebra on the existence of nontrivial solutions of AX D 0.)
       (d) Prove: If n D m and A is nonsingular, then

                                       m.A/M.A 1 / D m.A 1/M.A/ D 1:

10. We say that F W Rn ! Rm is uniformly continuous on S if each of its components
        is uniformly continuous on S . Prove: If F is uniformly continuous on S , then for
        each > 0 there is a i > 0 such that

              jF.X/ F.Y/j <               if jX Yj < i and X; Y 2 S:

11. Show that if F is continuous on Rn and F .X C Y/ D F.X/ C F.Y/ for all X and Y
        in Rn, then A is linear. HINT: The rational numbers are dense in the reals:

12. Find F0 and J F. Then find an affine transformation G such that

                                  lim     F.X/ G.Y/  D 0:

                                  X!X0 X X0

                       2 x2 C y C 2´ 3    X0 D .1; 1; 0/
(a) F.x; y; ´/ D 4 cos.x C y C ´/ 5 ;

                                  exy´

                    Ä ex cos y
(b) F.x; y/ D ex sin y ; X0 D .0; =2/

                       2 x2       y2 3    X0 D .1; 1; 1/
(c) F.x; y; ´/ D 4 y2             ´2 5 ;

                           ´2     x2

13. Find F0.                                                 2         3

                      Ä .x C y C ´/ex                        6  g1.x/  7
                                                             6         7
                                                                g2.x/
(a) F.x; y; ´/ D                          (b) F.x/ D 6 :: 7
                               2  2x
                         .x C y /e                           4:5

                     2 ex sin y´ 3                              gn.x/
(c) F.x; y; ´/ D 4 ey sin x´ 5

                         e´ sin xy

14. Find F0 and J F.                                      2               3

                      Ä                                         r cos Â cos
                         r cos Â       (b) F.r; Â; / D 4 r sin Â cos 5
(a) F.r; Â/ D r sin Â
                                                                r sin
                      2           3
                         r cos Â

(c) F.r; Â; ´/ D 4 r sin Â 5

                         ´
Section 6.2 Continuity and Differentiability of Transformations 393

15. Prove: If G1 and G2 are affine transformations and
                                           lim G1.X/ G2.Y/ D 0;
                                         X!X0 jX X0j

        then G1 D G2.
16. Prove Theorem 6.2.3.
17. Show that if F W Rn ! Rm is differentiable at X0 and > 0, there is a i > 0 such

        that
                   jF.X/ F.X0/j Ä .kF0.X0/k C /jX X0j if jX X0j < i:

        Compare this with Lemma 6.2.5.
18. Suppose that F W Rn ! Rn is differentiable at X0 and F0.X0/ is nonsingular. Let

                                                             1
                                               r D kOEF0.X0/ 1k

        and suppose that > 0. Show that there is a i > 0 such that

jF.X/ F.X0/j .r /jX X0j if jX X0j < i:

Compare this with Lemma 6.2.6.

19. Prove: If L W Rn ! Rm is defined by L.X/ D A.X/, where A is nonsingular, then

                        jL.X/ L.Y/j          1
                                          kA 1k jX Yj

for all X and Y in Rn.

20. Use Theorem 6.2.8 to find H0.U0/, where H.U/ D F.G.U/. Check your results by

expressing H directly in terms of U and differentiating.  2                 3

              2 x2 C y2 3                                 6  w cos u sin v  7

(a) F.x; y; ´/ D 4      ´        5;  G.u; v; w/  D        6  w sin u sin v  7,  U0  D
                                                          4                 5
                        x2 C y2
                                                                w cos v

. =2; =2; 2/

2 x2 y2 3                                    "  v cos u   #

(b) F.x; y/ D 4 y 5 ; G.u; v/ D                              ; U0 D . =4; 3/
                        x v sin u
              2                           3                  2           3
                        3x C 4y C 2´ C 6                        uv

(c) F.x; y; ´/ D 4 4x 2y C ´ 1 5 ; G.u; v/ D 4 u C v 5,

                        xC yC ´ 2                               u 2v

U0 arbitrary
394 Chapter 6 Vector-Valued Functions of Several Variables

(d) F.x; y/ D  Ä          ; G.u; v; w/ D  Ä 2u v C w          ; U0 D .1; 1; 2/
                  xCy

               xy                         e  u2 v2

               Ä x2 C y2     Ä eu cos v
(e) F.x; y/ D 2 2 ; G.u; v/ D u                               ; U0 D .0; 0/
               xy                         e sin v

                    2 x C 2y 3 Ä
(f ) F.x; y/ D 4 x y2 5 ; G.u; v/ D u C 2v 2 2u v2 ; U0 D .1; 2/

                        x Cy

21. Suppose that F and G are continuously differentiable on Rn, with values in Rn, and

let H D F i G. Show that

@.h1; h2; : : : ; hn/ D @.f1; f2; : : : ; fn/ @.g1; g2; : : : ; gn/ :
@.u1; u2; : : : ; un/ @.x1; x2; : : : ; xn/ @.u1; u2; : : : ; un/

        Where should these Jacobians be evaluated?

22. Suppose that F W Rn ! Rm and X is a limit point of DF contained in DF. Show
        that F is continuous at X if and only if limk!1 F.Xk / D F.X/ whenever fXkg is a
        sequence of points in DF such that limk!1 Xk D X. HINT: See Exercise 5.2.15:

23. Suppose that F W Rn ! Rm is continuous on a compact subset S of Rn. Show that
        F.S / is a compact subset of Rm.

6.3 THE INVERSE FUNCTION THEOREM

So far our discussion of transformations has dealt mainly with properties that could just as
well be defined and studied by considering the component functions individually. Now we
turn to questions involving a transformation as a whole, that cannot be studied by regarding
it as a collection of independent component functions.

   In this section we restrict our attention to transformations from Rn to itself. It is useful
to interpret such transformations geometrically. If F D .f1; f2; : : : ; fn/, we can think of
the components of

                                F.X/ D .f1.X/; f2.X/; : : : ; fn.X//

as the coordinates of a point U D F.X/ in another "copy" of Rn. Thus, U D .u1; u2; : : : ; un/,
with

                       u1 D f1.X/; u2 D f2.X/; : : : ; un D fn.X/:

We say that F maps X to U, and that U is the image of X under F. Occasionally we will

also write @ui =@xj to mean @fi =@xj . If S DF, then the set

                          °                  «
               F.S / D U  U D F.X/; X 2 S

is the image of S under F.

   We will often denote the components of X by x, y, . . . , and the components of U by u,
v, ....
                                Section 6.3 The Inverse Function Theorem 395

Example 6.3.1 If

                  Ä u Ä x2 C y2
                     v D F.x; y/ D x2 y2 ;

then
                     u D f1.x; y/ D x2 C y2; v D f2.x; y/ D x2 y2;

and

    ux.x; y/ D @f1.x; y/ D 2x;     uy .x; y/ D @f1.x; y/ D 2y;
                       @x                             @y

    vx.x; y/ D @f2.x; y/ D 2x;     vy.x; y/ D @f2.x; y/ D 2y:
                       @x                             @y

To find F.R2/, we observe that

                  u C v D 2x2; u v D 2y2;

so                              °             «
                F.R2/ T D .u; v/  u C v 0; u v 0 ;

which is the part of the uv-plane shaded in Figure 6.3.1. If .u; v/ 2 T , then
                                   Â pu C v pu v Ã Ä u

                                 F 2 ; 2 Dv;

so F.R2/ D T .

                                v
                                                                  u - v = 0

                                                    u

                                              u + v = 0

                                Figure 6.3.1
396 Chapter 6 Vector-Valued Functions of Several Variables

Invertible Transformations

A transformation F is one-to-one, or invertible, if F.X1/ and F.X2/ are distinct whenever

X1 and X2 are distinct points of DF. In this case, we can define a function G on the range

                                   °                           «
       R.F/ D U  U D F.X/ for some X 2 DF

of F by defining G.U/ to be the unique point in DF such that F.U/ D U. Then

                            DG D R.F/ and R.G/ D DF:

Moreover, G is one-to-one,

                                   G.F.X// D X; X 2 DF;

and
                                      F.G.U// D U; U 2 DG:

We say that G is the inverse of F, and write G D F 1. The relation between F and G is
symmetric; that is, F is also the inverse of G, and we write F D G 1.

Example 6.3.2 The linear transformation

                                Ä                  Ä
                                   u D L.x; y/ D x y
                                   v                  xCy                    (6.3.1)

maps .x; y/ to .u; v/, where

                                      u D x y;                               (6.3.2)
                                      v D x C y:

L is one-to-one and R.L/ D R2, since for each .u; v/ in R2 there is exactly one .x; y/

such that L.x; y/ D .u; v/. This is so because the system (6.3.2) can be solved uniquely

for .x; y/ in terms of .u; v/:

                                      x D 12 .u C v/;                        (6.3.3)
                                      y D 12 . u C v/:

Thus,                                            1Ä uCv

                                L 1.u; v/ D        uCv :
                                                2

Example 6.3.3 The linear transformation

       Ä                                           Ä
                                uv D L1.x; y/ D x C y 2x C 2y

maps .x; y/ onto .u; v/, where

                                      u D x C y;                             (6.3.4)
                                      v D 2x C 2y:
                                           Section 6.3 The Inverse Function Theorem 397

L1 is not one-to-one, since every point on the line
                                        x C y D c (constant)

is mapped onto the single point .c; 2c/. Hence, L1 does not have an inverse.

The crucial difference between the transformations of Examples 6.3.2 and 6.3.3 is that

the matrix of L is nonsingular while the matrix of L1 is singular. Thus, L (see (6.3.1)) can

be written as                    Ä         Ä             Ä
                                                    1 x;
                                    uD1             1y                        (6.3.5)
                                    v         1

where the matrix has the inverse       2 1 13
                                       4 2 2 5:

                                               11
                                               22

(Verify.) Multiplying both sides of (6.3.5) by this matrix yields

                   2 1 1 3Ä Ä
                   4 2 25 u D x ;
                                       11        v  y

                                       22

which is equivalent to (6.3.3).            Ä
   Since the matrix                           11
                                              22

of L1 is singular, (6.3.4) cannot be solved uniquely for .x; y/ in terms of .u; v/. In fact, it
cannot be solved at all unless v D 2u.

   The following theorem settles the question of invertibility of linear transformations from
Rn to Rn. We leave the proof to you (Exercise 6.3.2).

Theorem 6.3.1 The linear transformation
                                   U D L.X/ D AX .Rn ! Rn/

is invertible if and only if A is nonsingular; in which case R.L/ D Rn and
                                           L 1.U/ D A 1U:

Polar Coordinates

We will now briefly review polar coordinates, which we will use in some of the following
 examples.

    The coordinates of any point .x; y/ can be written in infinitely many ways as

                                    x D r cos Â; y D r sin Â;                 (6.3.6)
398 Chapter 6 Vector-Valued Functions of Several Variables

where

                                 r2 D x2 C y2

and, if r > 0, Â is the angle from the x-axis to the line segment from .0; 0/ to .x; y/,
measured counterclockwise (Figure 6.3.2).

                    y

                                                 (x, y)

                                        2

                               2 + y
                              x

                              
                                                                                 x

                                 Figure 6.3.2

   For each .x; y/ ¤ .0; 0/ there are infinitely many values of Â, differing by integral
multiples of 2 , that satisfy (6.3.6). If Â is any of these values, we say that Â is an argument
of .x; y/, and write

                                             Â D arg.x; y/:

By itself, this does not define a function. However, if is an arbitrary fixed number, then

                       Â D arg.x; y/; Ä Â < C 2 ;

does define a function, since every half-open interval OE ; C 2 / contains exactly one
argument of .x; y/.

   We do not define arg.0; 0/, since (6.3.6) places no restriction on Â if .x; y/ D .0; 0/ and
therefore r D 0.

The transformation

       Ä x 2 p 2 C y2 3
       r D G.x; y/ D 4                       5;
       Â arg.x; y/                               Ä arg.x; y/ < C 2 ;

is defined and one-to-one on

                              °DG D .x; y/  .x; y/ ¤ .0; 0/ ;«

and its range is              °                               «
                    R.G/ D .r; Â/  r > 0; Ä Â < C 2 :
                           Section 6.3 The Inverse Function Theorem 399

For example, if D 0, then               2p 3
                                              2

                                        67
                           G.1; 1/ D 4 5 ;

                                                           4
since =4 is the unique argument of .1; 1/ in OE0; 2 /. If D , then

                                                      2p 3
                                                             2

                                                      67
                                         G.1; 1/ D 4 9 5 ;

                                                           4

since 9 =4 is the unique argument of .1; 1/ in OE ; 3 /.

   If arg.x0; y0/ D , then .x0; y0/ is on the half-line shown in Figure 6.3.3 and G is
not continuous at .x0; y0/, since every neighborhood of .x0; y0/ contains points .x; y/ for
which the second component of G.x; y/ is arbitrarily close to C 2 , while the second
component of G.x0; y0/ is . We will show later, however, that G is continuous, in fact,
continuously differentiable, on the plane with this half-line deleted.

y

                                                            (x0 , y0 )

                                                 
                                                                                                        x

                                        Figure 6.3.3

Local Invertibility
A transformation F may fail to be one-to-one, but be one-to-one on a subset S of DF. By
this we mean that F.X1/ and F.X2/ are distinct whenever X1 and X2 are distinct points of
S . In this case, F is not invertible, but if FS is defined on S by

                                      FS .X/ D F.X/; X 2 S;
and left undefined for X 62 S , then FS is invertible. We say that FS is the restriction of F
to S , and that F 1 S is the inverse of F restricted to S . The domain of F 1 S is F.S /.
400 Chapter 6 Vector-Valued Functions of Several Variables

   If F is one-to-one on a neighborhood of X0, we say that F is locally invertible at X0. If
this is true for every X0 in a set S , then F is locally invertible on S .

Example 6.3.4 The transformation                                   (6.3.7)
                                  Ä u Ä x2 y2
                                     v D F.x; y/ D 2xy

is not one-to-one, since

                               F. x; y/ D F.x; y/:                 (6.3.8)

It is one-to-one on S if and only if S does not contain any pair of distinct points of the form

.x0; y0/ and . x0; y0/; (6.3.8) implies the necessity of this condition, and its sufficiency

follows from the fact that if

                               F.x1; y1/ D F.x0; y0/;              (6.3.9)

then

      .x1; y1/ D .x0; y0/ or .x1; y1/ D . x0; y0/:                 (6.3.10)

To see this, suppose that (6.3.9) holds; then

                               x12 y12 D x02 y02                   (6.3.11)

and

                                        x1y1 D x0y0:               (6.3.12)

Squaring both sides of (6.3.11) yields

                          x14 2x21 y21 C y14 D x04 2x20y20 C y04:

This and (6.3.12) imply that   x41 x40 D y40 y41 :                 (6.3.13)
From (6.3.11),                 x12 x02 D y12 y02:                  (6.3.14)
Factoring (6.3.13) yields

      .x12 x02/.x12 C x02/ D .y02 y12/.y02 C y12/:

If either side of (6.3.14) is nonzero, we can cancel to obtain

                               x21 C x20 D y20 y12;

which implies that x0 D x1 D y0 D y1 D 0, so (6.3.10) holds in this case. On the other
hand, if both sides of (6.3.14) are zero, then

                               x1 D x0; y1 D y0:

From (6.3.12), the same sign must be chosen in these equalities, which proves that (6.3.8)
implies (6.3.10) in this case also.
                      Section 6.3 The Inverse Function Theorem 401

We now see, for example, that F is one-to-one on every set S of the form

                °S D .x; y/  ax C by > 0 ;     «

where a and b are constants, not both zero. Geometrically, S is an open half-plane; that is,
the set of points on one side of, but not on, the line

                   ax C by D 0

(Figure 6.3.4). Therefore, F is locally invertible at every X0 ¤ .0; 0/, since every such
point lies in a half-plane of this form. However, F is not locally invertible at .0; 0/. (Why
not?) Thus, F is locally invertible on the entire plane with .0; 0/ removed.

             y

                     by = 0
                ax +

                      ax + by > 0

                                                                        x

                (a, b)

                   Figure 6.3.4

It is instructive to find F 1 S for a specific choice of S . Suppose that S is the open right

half-plane:     S D .x; y/  x > 0 :°«

                                                                           (6.3.15)

Then F.S / is the entire uv-plane except for the nonpositive u axis. To see this, note that
every point in S can be written in polar coordinates as

             x D r cos Â; y D r sin Â; r > 0;     2             <Â < :
                                                                2

Therefore, from (6.3.7), F.x; y/ has coordinates .u; v/, where

             u D x2 y2 D r 2.cos2 Â sin2 Â / D r 2 cos 2Â;
             v D 2xy D 2r 2 cos Â sin Â D r 2 sin 2Â:
402 Chapter 6 Vector-Valued Functions of Several Variables

Every point in the uv-plane can be written in polar coordinates as

                        u D cos ; v D sin ;

where either D 0 or

                           p                           Ä< ;
                        D u2 C v2 > 0;

and the points for which D 0 or  D are of the form .u; 0/, with u Ä 0 (Figure 6.3.5).
If .u; v/ D F.x; y/ for some .x; y/ in S , then (6.3.15) implies that > 0 and <  <

  . Conversely, any point in the uv-plane with polar coordinates . ; / satisfying these
conditions is the image under F of the point

                            .x; y/ D . 1=2 cos =2; 1=2 sin =2/ 2 S:

Thus,

                 2      .u2 C v2/1=4 cos.arg.u; v/=2/  3

       FS1.u; v/ D 4    .u2 C v2/1=4 sin.arg.u; v/=2   5;           < arg.u; v/ < :

                               v

                                                            (u,v)

                                              2

                                          v
                                     2 +
                                     u

                                                     
                         = - u

                                  Figure 6.3.5

Because of (6.3.8), F also maps the open left half-plane

                               S1 D .x; y/  x < 0°     «

onto F.S /, and

                 2      .u2 C v2/1=4 cos.arg.u; v/=2/  3

       FS11 .u; v/ D 4  .u2 C v2/1=4 sin.arg.u; v/=2/  5;   < arg.u; v/ < 3 ;

                 D FS1.u; v/:
                                              Section 6.3 The Inverse Function Theorem 403

Example 6.3.5 The transformation                                          (6.3.16)
                                  Ä u Ä ex cos y
                                     v D F.x; y/ D ex sin y

is not one-to-one, since

                             F.x; y C 2k / D F.x; y/                      (6.3.17)

if k is any integer. This transformation is one-to-one on a set S if and only if S does not

contain any pair of points .x0; y0/ and .x0; y0 C 2k /, where k is a nonzero integer. This

condition is necessary because of (6.3.17); we leave it to you to show that it is sufficient

(Exercise 6.3.8). Therefore, for example, F is one-to-one on

S D .x; y/  1 < x < 1; Ä y < C 2°                                «        (6.3.18)

where is arbitrary. Geometrically, S is the infinite strip bounded by the lines y D and
y D C 2 . The lower boundary is in S , but the upper is not (Figure 6.3.6). Since every
point is in the interior of some such strip, F is locally invertible on the entire plane.

y

                                                              y =  + 2
                                                              y = 

                                                              x

                                      Figure 6.3.6

The range of FS is the entire uv-plane except the origin, since if .u; v/ ¤ .0; 0/, then

.u; v/ can be written uniquely as

                                   Ä          Ä
                                      u D cos  ;
                                      v          sin 

where                                         Ä< C2 ;
                                        > 0;

so .u; v/ is the image under F of

                                   .x; y/ D .log ; / 2 S:

The origin is not in R.F/, since
                       jF.x; y/j2 D .ex cos y/2 C .ex sin y/2 D e2x ¤ 0:
404 Chapter 6 Vector-Valued Functions of Several Variables

Finally,

          2               log.u2 C v2/1=2  3

          FS1 .u; v/ D 4                   5;    Ä arg.u; v/ < C 2 :

                          arg.u; v/

The domain of F 1 S is the entire uv-plane except for .0; 0/.

Regular Transformations

The question of invertibility of an arbitrary transformation F W Rn ! Rn is too general to
have a useful answer. However, there is a useful and easily applicable sufficient condition
which implies that one-to-one restrictions of continuously differentiable transformations
have continuously differentiable inverses.

To motivate our study of this question, let us first consider the linear transformation

                            2  a11 a12           a1n           32 3
                                                               x1
          6 F.X/ D AX D 6 a 6 21 a22 : : : a2n 7 : 7 6 7 6 x 6 2 7 : 77 :
                            4 :: :: : : :: 5 4 :: 5

                               an1 an2           ann           xn

From Theorem 6.3.1, F is invertible if and only if A is nonsingular, in which case R.F/ D
Rn and

                                           F 1.U/ D A 1U:

Since A and A 1 are the differential matrices of F and F 1, respectively, we can say that a
linear transformation is invertible if and only if its differential matrix F0 is nonsingular, in
which case the differential matrix of F 1 is given by

                               .F 1/0 D .F0/ 1:

Because of this, it is tempting to conjecture that if F W Rn ! Rn is continuously differen-
tiable and A0.X/ is nonsingular, or, equivalently, J F.X/ ¤ 0, for X in a set S , then F is
one-to-one on S . However, this is false. For example, if

                                                    Ä ex cos y
                                       F.x; y/ D ex sin y ;

then      J F.x; y/ D  ex cos y x ex sin y  x  D e2x ¤ 0;

                            e sin y e cos y                                (6.3.19)

but F is not one-to-one on R2 (Example 6.3.5). The best that can be said in general is
that if F is continuously differentiable and J F.X/ ¤ 0 in an open set S , then F is locally
invertible on S , and the local inverses are continuously differentiable. This is part of the
inverse function theorem, which we will prove presently. First, we need the following
definition.
                       Section 6.3 The Inverse Function Theorem 405

Definition 6.3.2 A transformation F W Rn ! Rn is regular on an open set S if F is
one-to-one and continuously differentiable on S , and J F.X/ ¤ 0 if X 2 S . We will also
say that F is regular on an arbitrary set S if F is regular on an open set containing S .

Example 6.3.6 If                    Ä
                       F.x; y/ D x y

                                       xCy

(Example 6.3.2), then                              
                       J F.x; y/ D  1           1  D 2;
                                                1
                                         1

so F is one-to-one on R2. Hence, F is regular on R2.

If                                           Ä

                       F.x; y/ D x C y
                                                2x C 2y

(Example 6.3.3), then  J F.x; y/ D  1 1  D 0;       

                                                22

so F is not regular on any subset of R2.
   x If Ä 2 y2
                                       F.x; y/ D 2xy

(Example 6.3.4), then

                                                    
                       J F.x; y/ D  2x          2y  D 2.x2 C y2/;
                                                2x
                                         2y

so F is regular on any open set S on which F° is one-to-one,«provided that .0; 0/ 62 S . For ex-
ample, F is regular on the open half-plane .x; y/  x > 0 , since we saw in Example 6.3.4
that F is one-to-one on this half-plane.

   e If Ä x cos y
                                       F.x; y/ D ex cos y

(Example 6.3.5), then J F.x; y/ D e2x (see (6.3.19)), so F is regular on any open set on
which it is one-to-one. The interior of S in (6.3.18) is an example of such a set.

Theorem 6.3.3 Suppose that F W Rn ! Rn is regular on an open set S; and let
G D F 1 S : Then F.S / is open; G is continuously differentiable on F.S /; and

                            G0.U/ D .F0.X// 1; where U D F.X/:

Moreover; since G is one-to-one on F.S /; G is regular on F.S /:
406 Chapter 6 Vector-Valued Functions of Several Variables

Proof We first show that if X0 2 S , then a neighborhood of F.X0/ is in F.S /. This
implies that F.S / is open.

Since S is open, there is a > 0 such that B .X0/ S . Let B be the boundary of

B .X0/; thus,                           ° «
                                  B D  X jX X0j D :
                                                                (6.3.20)

The function

                                        .X/ D jF.X/ F.X0/j

is continuous on S and therefore on B, which is compact. Hence, by Theorem 5.2.12, there
is a point X1 in B where .X/ attains its minimum value, say m, on B. Moreover, m > 0,
since X1 ¤ X0 and F is one-to-one on S . Therefore,

                       jF.X/ F.X0/j m > 0 if jX X0j D :         (6.3.21)

The set                           °                        «
                                  U  jU F.X0/j < m=2

is a neighborhood of F.X0/. We will show that it is a subset of F.S /. To see this, let U be

a fixed point in this set; thus,

                                        jU F .X0/j < m=2:       (6.3.22)

Consider the function

                                        1.X/ D jU F.X/j2;

which is continuous on S . Note that

                                  1.X/    m2                    (6.3.23)
                                           4 if jX X0j D ;

since if jX X0j D , then

               jU F.X/j D j.U F.X0// C .F.X0/ F.X//j          

                                        jF.X0/ F.X/j jU F.X0/j

                                              mm
                                        m 2 D 2;

from (6.3.21) and (6.3.22).                                   on the compact set B .X0/
   Since 1 is continuous on S , 1 attains a minimum value

(Theorem 5.2.12); that is, there is an X in B .X0/ such that

                          1.X/ 1.X/ D ; X 2 B .X0/:

Setting X D X0, we conclude from this and (6.3.22) that

                                  1.X/ D                  m2
                                          Ä 1.X0/ < 4 :

Because of (6.3.20) and (6.3.23), this rules out the possibility that X 2 B, so X 2 B .X0/.
                                     Section 6.3 The Inverse Function Theorem 407

Now we want to show that D 0; that is, U D F.X/. To this end, we note that 1.X/

can be written as              Xn
                     1.X/ D .uj
                                             fj .X//2 ;

                                     j D1

so 1 is differentiable on Bp.X0/. Therefore, the first partial derivatives of 1 are all zero
at the local minimum point X (Theorem 5.3.11), so

                     Xn @fj .X/      fj .X// D 0; 1 Ä i Ä n;
                            @xi .uj

                     j D1

or, in matrix form,

                     F0.X/.U F.X// D 0:

Since F0.X/ is nonsingular this implies that U D F.X/ (Theorem 6.1.13). Thus, we have
shown that every U that satisfies (6.3.22) is in F.S /. Therefore, since X0 is an arbitrary
point of S , F.S / is open.

   Next, we show that G is continuous on F.S /. Suppose that U0 2 F.S / and X0 is the
unique point in S such that F.X0/ D U0. Since F0.X0/ is invertible, Lemma 6.2.6 implies

that there is a > 0 and an open neighborhood N of X0 such that N S and

                     jF.X/ F.X0/j jX X0j if X 2 N:            (6.3.24)

(Exercise 6.2.18 also implies this.) Since F satisfies the hypotheses of the present theorem

on N , the first part of this proof shows that F.N / is an open set containing U0 D F.X0/.
Therefore, there is a i > 0 such that X D G.U/ is in N if U 2 Bi.U0/. Setting X D G.U/
and X0 D G.U0/ in (6.3.24) yields

jF.G.U// F.G.U0//j jG.U/ G.U0/j if U 2 Bi.U0/:

Since F.G.U// D U, this can be rewritten as

                                             1                (6.3.25)
                     jG.U/ G.U0/j Ä jU U0j if U 2 Bi.U0/;

which means that G is continuous at U0. Since U0 is an arbitrary point in F.S /, it follows
that G is continous on F.S /.

   We will now show that G is differentiable at U0. Since

                                       G.F.X// D X; X 2 S;

the chain rule (Theorem 6.2.8) implies that if G is differentiable at U0, then
                                           G0.U0/F0.X0/ D I
408 Chapter 6 Vector-Valued Functions of Several Variables

(Example 6.2.3). Therefore, if G is differentiable at U0, the differential matrix of G must

be
                                         G0.U0/ D OEF0.X0/ 1;

so to show that G is differentiable at U0, we must show that if

           H.U/ D  G.U/ G.U0/ OEF0.X0/ 1.U U0/                      .U ¤ U0/;       (6.3.26)

                             jU U0j

then

                                   lim H.U/ D 0:                                    (6.3.27)

                                  U!U0

Since F is one-to-one on S and F.G.U// D U, it follows that if U ¤ U0, then G.U/ ¤

G.U0/. Therefore, we can multiply the numerator and denominator of (6.3.26) by jG.U/

G.U0/j to obtain

      H.U/ D jG.U/ G.U0j     G.U/            G.U0/ OEF0.X0/ 1 .U         !
                     jU U0j                     jG.U/ G.U0/j        U0/

           D jG.U/ G.U0/j F0.X 1 Â U U0 F0.X0/.G.U/ G.U0// Ã 0/
                   jU U0j                                           jG.U/ G.U0/j

if 0 < jU  U0j < i. Because of (6.3.25), this implies that

                                             U0 F0.X0/.G.U/ G.U0//                
           jH.U/j Ä 1 kOEF0.X0/ 1k  U             jG.U/ G.U0/j

if 0 < jU U0j < i. Now let

                               U  U0 F0.X0/.G.U/ G.U0//
                   H1.U/ D             jG.U/ G.U0/j

To complete the proof of (6.3.27), we must show that

                                   lim H1.U/ D 0:                                   (6.3.28)

                                  U!U0

Since F is differentiable at X0, we know that if

                                       F.X/  F.X0 /   F0 .X0 /.X    X0/ ;
                   H2.X/ D lim                    jX  X0j

                                    X!X0

then                                                                                (6.3.29)
                                             lim H2.X/ D 0:

                                                              X!X0

Since F.G.U// D U and X0 D G.U0/,

                             H1.U/ D H2.G.U//:
                                    Section 6.3 The Inverse Function Theorem 409

Now suppose that > 0. From (6.3.29), there is a i1 > 0 such that

jH2.X/j < if 0 < jX X0j D jX G.U0/j < i1:                                 (6.3.30)

Since G is continuous at U0, there is a i2 2 .0; i/ such that

jG.U/ G.U0/j < i1 if 0 < jU U0j < i2:

This and (6.3.30) imply that

jH1.U/j D jH2.G.U//j < if 0 < jU U0j < i2:

Since this implies (6.3.28), G is differentiable at X0.
   Since U0 is an arbitrary member of F.N /, we can now drop the zero subscript and

conclude that G is continuous and differentiable on F.N /, and

                                 G0.U/ D OEF0.X/ 1; U 2 F.N /:

To see that G is continuously differentiable on F.N /, we observe that by Theorem 6.1.14,
each entry of G0.U/ (that is, each partial derivative @gi .U/=@uj , 1 Ä i; j Ä n) can be

written as the ratio, with nonzero denominator, of determinants with entries of the form

                                    @fr .G.U// :                          (6.3.31)
                                        @xs

Since @fr =@xs is continuous on N and G is continuous on F.N /, Theorem 5.2.10 implies

that (6.3.31) is continuous on F.N /. Since a determinant is a continuous function of its
entries, it now follows that the entries of G0.U/ are continuous on F.N /.

Branches of the Inverse

If F is regular on an open set S , we say that F 1 S is a branch of F 1. (This is a convenient
 terminology but is not meant to imply that F actually has an inverse.) From this definition,
 it is possible to define a branch of F 1 on a set T R.F/ if and only if T D F.S /, where

 F is regular on S . There may be open subsets of R.F/ that do not have this property, and
 therefore no branch of F 1 can be defined on them. It is also possible that T D F.S1/ D

 F.S2/, where S1 and S2 are distinct subsets of DF. In this case, more than one branch of
 F 1 is defined on T . Thus, we saw in Example 6.3.4 that two branches of F 1 may be
 defined on a set T . In Example 6.3.5 infinitely many branches of F 1 are defined on the

 same set.

It is useful to define branches of the argument To do this, we think of the relationship

between polar and rectangular coordinates in terms of the transformation

                              Ä     Ä
                                 x D F.r; Â/ D r cos Â ;
                                 y                r sin Â                 (6.3.32)

where for the moment we regard r and Â as rectangular coordinates of a°point in an r«Â-
plane. Let S be an open subset of the right half of this plane (that is, S .r; Â/  r > 0 )
410 Chapter 6 Vector-Valued Functions of Several Variables

that does not contain any pair of points .r; Â/ and .r; Â C2k /, where k is a nonzero integer.

Then F is one-to-one and continuously differentiable on S , with

                            Ä                        r sin Â                    (6.3.33)
               F0.r; Â / D cos Â                     r cos Â

                                sin Â

and

               J F.r; Â/ D r > 0; .r; Â/ 2 S:                                   (6.3.34)

Hence, F is regular on S . Now let T D F.S /, the set of points in the xy-plane with

polar coordinates in S . Theorem 6.3.3 states that T is open and FS has a continuously
differentiable inverse (which we denote by G, rather than FS1, for typographical reasons)

            Ä x 2 p 2 C y2 3
            r D G.x; y/ D 4                              5 ; .x; y/ 2 T;
            Â
                                            argS .x; y/

where argS .x; y/ is the unique value of arg.x; y/ such that

                             p                                Á

               .r; Â / D x2 C y2; argS .x; y/ 2 S:

We say that argS .x; y/ is a branch of the argument defined on T . Theorem 6.3.3 also
implies that

                                      "  cos Â  sin Â #       (see (6.3.33))
     G0.x; y/ D F0.r; Â / 1 D            sin Â  cos Â

                             2 rx r y 3
                                         p           p
                             6 x2 C y2 x2 C y2 7
               D4                           y            x5       (see (6.3.32)):

                                            x2 C y2      x2 C y2

Therefore,

            @ argS .x; y/ D      y              @ argS .x; y/ @y D x2 C y2 x :  (6.3.35)
                 @x          x2 C y2 ;

   A branch of arg.x; y/ can be defined on an open set T of the xy-plane if and only if
the polar coordinates of the points in T form an open subset of the r Â-plane that does not
intersect the Â-axis or contain any two points of the form .r; Â/ and .r; Â C 2k /, where
k is a nonzero integer. No subset containing the origin .x; y/ D .0; 0/ has this property,
nor does any deleted neighborhood of the origin (Exercise 6.3.14), so there are open sets
on which no branch of the argument can be defined. However, if one branch can be defined
on T , then so can infinitely many others. (Why?) All branches of arg.x; y/ have the same
partial derivatives, given in (6.3.35).
                                   Section 6.3 The Inverse Function Theorem 411

Example 6.3.7 The set           

        T D .x; y/  .x; y/ ¤ .x; 0/ with x 0 ;°                «

which is the entire xy-plane with the nonnegative x-axis deleted, can be written as T D

F.Sk /, where F is as in (6.3.32), k is an integer, and
                          °
        Sk D .r; Â/  r > 0; 2k < Â < 2.k C 1/ :                «

For each integer k, we can define a branch argSk .x; y/ of the argument in Sk by taking
argSk .x; y/ to be the value of arg.x; y/ that satisfies

                                  2k < argSk .x; y/ < 2.k C 1/ :
Each of these branches is continuously differentiable in T , with derivatives as given in
(6.3.35), and

        argSk .x; y/ argSj .x; y/ D 2.k j / ; .x; y/ 2 T:

Example 6.3.8 Returning to the transformation
                                 Ä u Ä x2 y2
                                    v D F.x; y/ D 2xy ;

we now see from Example 6.3.4 that a branch G of F 1 can be defined on any subset T of

the uv-plane on which a branch of arg.u; v/ can be defined, and G has the form

     Ä 2 .u2 C v2/1=4 cos.arg.u; v/=2/ 3
     x D G.u; v/ D 4                                        5 ; .u; v/ 2 T;
     y                       .u2 C v2/1=4 sin.arg.u; v/=2/                          (6.3.36)

where arg.u; v/ is a branch of the argument defined on T . If G1 and G2 are different
branches of F 1 defined on the same set T , then G1 D G2. (Why?)

     From Theorem 6.3.3,

                                   Ä                        1
        G0.u; v/ D F0.x; y/ 1 D 2x 2y
                                      2y 2x
                                         1 Ä xy
                                   D 2.x2 C y2/ y x :

Substituting for x and y in terms of u and v from (6.3.36), we find that

        @x @y                x        1
        @u D @v D 2.x2 C y2/ D 2.u2 C v2/1=4 cos.arg.u; v/=2/                       (6.3.37)
                                                                                    (6.3.38)
and

        @x @y                   y        1
        @v D @u D 2.x2 C y2/ D 2.u2 C v2/1=4 sin.arg.u; v/=2/:

It is essential that the same branch of the argument be used here and in (6.3.36).
412 Chapter 6 Vector-Valued Functions of Several Variables

   We leave it to you (Exercise 6.3.16) to verify that (6.3.37) and (6.3.38) can also be
obtained by differentiating (6.3.36) directly.

Example 6.3.9 If  Ä u Ä ex cos y
                     v D F.x; y/ D ex sin y

(Example 6.3.5), we can also define a branch G of F 1 on any subset T of the uv-plane on

which a branch of arg.u; v/ can be defined, and G has the form

                  Ä x Ä log.u2 C v2/1=2                                     (6.3.39)
                     y D G.u; v/ D arg.u; v/ :

Since the branches of the argument differ by integral multiples of 2 , (6.3.39) implies that

if G1 and G2 are branches of F 1, both defined on T , then

G1.u; v/                        Ä    (k D integer):
                  G2.u; v/ D 0 2k

From Theorem 6.3.3,                  1 Ä ex cos y ex sin y 1
                G0.u; v/ D F0.x; y/    D ex sin y ex cos y
                                          Ä e x cos y e x sin y
                                       D e x sin y e x cos y :

Substituting for x and y in terms of u and v from (6.3.39), we find that

                           @x @u D @y@v D e x cos y D e 2x u D u2 C v2 u

and
                           @x @v D @y @u D e x sin y D e 2xv D u2 C v2 v :

The Inverse Function Theorem

Examples 6.3.4 and 6.3.5 show that a continuously differentiable function F may fail to
have an inverse on a set S even if J F.X/ ¤ 0 on S . However, the next theorem shows that
in this case F is locally invertible on S .

Theorem 6.3.4 (The Inverse Function Theorem) Let F W Rn ! Rn be
continuously differentiable on an open set S; and suppose that J F.X/ ¤ 0 on S: Then; if
X0 2 S; there is an open neighborhood N of X0 on which F is regular: Moreover; F.N /
is open and G D F 1 N is continuously differentiable on F.N /; with

                    G0.U/ D F0.X/ 1 .where U D F.X//; U 2 F.N /:
                             Section 6.3 The Inverse Function Theorem 413

Proof Lemma 6.2.6 implies that there is an open neighborhood N of X0 on which F is
one-to-one. The rest of the conclusions then follow from applying Theorem 6.3.3 to F on
N.

Corollary 6.3.5 If F is continuously differentiable on a neighborhood of X0 and J F.X0/ ¤
0; then there is an open neighborhood N of X0 on which the conclusions of Theorem 6.3.4
hold:

Proof By continuity, since J F0.X0/ ¤ 0, J F0.X/ is nonzero for all X in some open
neighborhood S of X0. Now apply Theorem 6.3.4.

Example 6.3.10 Let X0 D .1; 2; 1/ and

            23                 2                       1/2 C 1 3
            u                          x C y C .´      1/2 1 5 :
                                                       2/2 C 3
            4 v 5 D F.x; y; ´/ D 4 y C ´ C .x

            w                          ´ C x C .y

Then                         2            1 2´              3
so                                  1                     2
                                          1            1
            F0.x; y; ´/ D 4 2x 2                            5;

                                    1  2y 4 1

                               1       1  0   
                                              
                  J F.X0/ D  01        1 1  0 1  D 2:

In this case, it is difficult to describe N or find G D F 1 N explicitly; however, we know that
F.N / is a neighborhood of U0 D F.X0/ D .4; 2; 5/, that G.U0/ D X0 D .1; 2; 1/, and

that                      2               31       2              3

       G0.U0/ D F0.X0/ 1 D 4 0 1 1 5 D 1 1 0 1 4 1 1 1 5 : 1 1 1
                                                2 111
                             101

Therefore,

            23 2                              32   u4     3
               1             111
            G.U/ D 4 2 5 C 1 4 1 1 1 5 4 v 2 5 C E.U/;
                  2 111
               1                                   w5

where                             E.U/
                          4/2 C .v 2/2 C .w
               lim p                                        D 0I
            U!.4;2;5/ .u                               5/2

thus we have approximated G near U0 D .4; 2; 5/ by an affine transformation.

   Theor°em 6.3.4 and «(6.3.34) imply that the transformation (6.3.32) is locally invertible
on S D .r; Â/  r > 0 , which means that it is possible to define a branch of arg.x; y/ in a
neighborhood of any point .x0; y0/ ¤ .0; 0/. It also implies, as we have already seen, that
414 Chapter 6 Vector-Valued Functions of Several Variables

the transformation (6.3.7) of Example 6.3.4 is locally invertible everywhere except at .0; 0/,
where its Jacobian equals zero, and the transformation (6.3.16) of Example 6.3.5 is locally
invertible everywhere.

                                       6.3 Exercises

1. Prove: If F is invertible, then F 1 is unique.

2. Prove Theorem 6.3.1.

3. Prove: The linear transformation L.X/ D AX cannot be one-to-one on any open set
      if A is singular. HINT: Use Theorem 6.1.15:

4. Let                     "p x2 C y2    #

             G.x; y/ D                      ;      =2 Ä arg.x; y/ < 5 =2:

                              arg.x; y/

Find                          (b) G.1; 0/                (c) G. 1; 0/
(a) G.0; 1/

(d) G.2; 2/                   (e) G. 1; 1/

5. Same as Exercise 6.3.4, except that 2 Ä arg.x; y/ < 0.

6. (a) Prove: If f W R ! R is continuous and locally invertible on .a; b/, then f is
             invertible on .a; b/.

(b) Give an example showing that the continuity assumption is needed in (a).

7. Let                                      Ä x2 y2
                               F.x; y/ D 2xy

(Example 6.3.4) and

             S D .x; y/  ax C by > 0°              «  .a2 C b2 ¤ 0/:

Find F.S / and F 1 S . If

                              S1 D .x; y/  ax C by < 0 ;°«

      show that F.S1/ D F.S / and F 1 S1 D F 1 S .

8. Show that the transformation
                                    Ä u Ä ex cos y
                                       v D F.x; y/ D ex sin y

(Example 6.3.5) is one-to-one on any set S that does not contain any pair of points
.x0; y0/ and .x0; y0 C 2k /, where k is a nonzero integer.
                                              Section 6.3 The Inverse Function Theorem 415

9. Suppose that F W Rn ! Rn is continuous and invertible on a compact set S . Show
      that F 1 S is continuous. HINT: If F 1 S is not continuous at U in F.S /; then there is
      an 0 > 0 and a sequence fUkg in F.S / such that limk!1 Uk D U while

                                  jFS1.Uk / FS1.U/j 0; k 1:

Use Exercise 5.1.32 to obtain a contradiction:

10. Find F 1 and .F 1/0:                Ä
        Ä
(a) uv D F.x; y/ D                         4x C 2y
                                           3x C y

        23                                 2        x C y C 2´       3
           u

(b) 4 v 5 D F.x; y; ´/ D 4 3x C y 4´ 5

           w                                        x y C 2´

11. In addition to the assumptions of Theorem 6.3.3, suppose that all qth-order .q > 1/

partial derivatives of the components of F are continuous on S . Show that all qth-

order partial derivatives of F 1 S are continuous on F.S /.

12. If                               Ä u Ä x2 C y2
                                        v D F.x; y/ D x2 y2

(Example 6.3.1), find four branches G1, G2, G3, and G4 of F 1 defined on
                                        °
                                 T1 D .u; v/  u C v > 0; u v > 0 ;             «

and     verify  that  G0    .u;  v/  D  .F0 .x .u;  v/;  y.u;  v///  1, 1 Ä i  Ä 4.

                         i

13. Suppose that A is a nonsingular n n matrix and
                                                              2 23
                                                                  x1
                                                              6 x2 7
                                                              6 27

                                           U D F.X/ D A 6 : 7 :
                                                              4 :: 5

                                                               x2

                                                                 n

(a) Show that F is regular on the set
                                              °
                                        S D X  ei xi > 0; 1 Ä i Ä n ;          «

      where ei D 1, 1 Ä i Ä n.
(b) Find FS1.U/. (c) Find .F 1 S /0.U/.

14. Let Â.x; y/ be a branch of arg.x; y/ defined on an open set S .

(a) Show that Â.x; y/ cannot assume a local extreme value at any point of S .

(b) Prove: If a ¤ 0 and the line segment from .x0; y0/ to .ax0; ay0/ is in S , then

        Â.ax0; ay0/ D Â.x0; y0/.

(c) Show that S cannot contain a subset of the form

                                        n                      p                  o
                                 A D .x; y/  0 < r1 Ä x2 C y2 Ä r2 :
416 Chapter 6 Vector-Valued Functions of Several Variables

(d) Show that no branch of arg.x; y/ can be defined on a deleted neighborhood
      of the origin.

15. Obtain Eqn. (6.3.35) formally by differentiating:

(a) arg.x; y/ D cos 1 p x               (b) arg.x; y/ D sin 1 p y
                               x2 C y2                                 x2 C y2

(c) arg.x; y/ D tan 1 y
                            x

Where do these formulas come from? What is the disadvantage of using any one of
them to define arg.x; y/?

16. For the transformation
                                     Ä u Ä x2 y2
                                         v D F.x; y/ D 2xy

        (Example 6.3.4), find a branch G of F 1 defined on T D °.u; v/  au C bv > 0«.
        Find G0 by means of the formula G0.U/ D OEF0.X/ 1 of Theorem 6.3.3, and also by
        direct differentiation with respect to u and v.

17. A transformation               Ä
                      F.x; y/ D u.x; y/

                                      v.x; y/

is analytic on a set S if it is continuously differentiable and

                      ux D vy ; uy D vx

        on S . Prove: If F is analytic and regular on S , then F 1 S is analytic on F.S /; that is,
        xu D uv and xv D uu.

18. Prove: If U D F.X/ and X D G.U/ are inverse functions, then

                      @.u1; u2; : : : ; un/ @.x1; x2; : : : ; xn/ D 1:
                      @.x1; x2; : : : ; xn @.u1; u2; : : : ; un/

        Where should the Jacobians be evaluated?

19. Give an example of a transformation F W Rn ! Rn that is invertible but not regular
        on Rn.

20. Find an affine transformation A that so well approximates the branch G of F 1
        defined near U0 D F.X0/ that

                      lim               G.U/ A.U/      D 0:

                      U!U0 jU U0j

       Ä                  Ä x4y5 4x
(a) uv    D F.x; y/ D x3y2 3y ; X0 D .1; 1/
                                       Section 6.4 The Implicit Function Theorem 417

(b)  Ä u Ä x2y C xy                              2 ; X0 D .1; 1/
        D F.x; y/ D
     v                                 2xy C xy

     23                                2 2x2y C x3 C ´ 3
         u

(c) 4 v 5 D F.x; y; ´/ D 4 x3 C y´ 5 ;                               X D .0; 1; 1/

     w                                    xCyC´

     23                                2  x cos y cos ´  3
         u

(d) 4 v 5 D F.x; y; ´/ D 4 x sin y cos ´ 5 ; X0 D .1; =2; /

     w                                    x sin ´

21. If F is defined by                             2     r cos Â cos     3
                                23
                                    x

                        4 y 5 D F.r; Â; / D 4 r sin Â cos 5

                        ´                                   r sin

and G is a branch of F 1, find G0 in terms of r , Â , and . HINT: See Exer-
cise 6.2.14.b/:

22. If F is defined by  23                               2            3
                           x
                                                            r cos Â

                        4 y 5 D F.r; Â; ´/ D 4 r sin Â 5

                           ´                                ´

and G is a branch of F 1, find G0 in terms of r , Â , and ´. HINT: See Exer-
cise 6.2.14.c/:

23. Suppose that F W Rn ! Rn is regular on a compact set T . Show that F.@T / D
        @F.T /; that is, boundary points map to boundary points. HINT: Use Exercise 6.2.23

        and Theorem 6.3.3 to show that @F.T / F.@T /: Then apply this result with F and
        T replaced by F 1 and F.T / to show that F.@T / @F.T /:

6.4 THE IMPLICIT FUNCTION THEOREM

In this section we consider transformations from RnCm to Rm. It will be convenient to
denote points in RnCm by

            .X; U/ D .x1; x2; : : : ; xn; u1; u2; : : : ; um/:

We will often denote the components of X by x, y, . . . , and the components of U by u, v,
....

   To motivate the problem we are interested in, we first ask whether the linear system of
m equations in m C n variables

a11x1 C a12x2 C         C a1nxn C b11u1 C b12u2 C                  C b1mum D 0       (6.4.1)
a21x1 C a22x2 C         C a2nxn C b21u1 C b22ux C                  C b2mum D 0

am1x1 C am2x2 C         C amnxn C bm1u1 C bm2u2 C                                ::
                                                                                 :

                                                                   C bmmum D 0
418 Chapter 6 Vector-Valued Functions of Several Variables

determines u1, u2, . . . , um uniquely in terms of x1, x2, . . . , xn. By rewriting the system in
matrix form as

                                             AX C BU D 0;

where

       2  a11 a12            a1n         3             2  b11 b12       b1m  3

       6  a21  a22           a2n         7             6  b21      b22  b2m  7
       6                                 7             6                     7
       A D 6 :: :: : : :: 7 ; B D 6 :: :: : : :: 7 ;
       4:      :             : :5                      4: : : : 5

          am1 am2            amn                          bm1 bm2       bmm

                             23                           23
                             x1                                u1
               6 X D 6 x 6 2 7 : 7 6 7 ; and U D 6 u 6 2 7 : 77 ;
                             4 :: 5                       4 :: 5

                             xn                           um

we see that (6.4.1) can be solved uniquely for U in terms of X if the square matrix B is
nonsingular. In this case the solution is

                                 U D B 1AX:

For our purposes it is convenient to restate this: If

                             F.X; U/ D AX C BU;                                 (6.4.2)

where B is nonsingular, then the system

                                              F.X; U/ D 0

determines U as a function of X, for all X in Rn.
   Notice that F in (6.4.2) is a linear transformation. If F is a more general transformation

from RnCm to Rm, we can still ask whether the system

                                 F.X; U/ D 0;

or, in terms of components,

               f1.x1; x2; : : : ; xn; u1; u2; : : : ; um/ D 0
               f2.x1; x2; : : : ; xn; u1; u2; : : : ; um/ D 0

                                                           ::
                                                           :
               fm.x1; x2; : : : ; xn; u1; u2; : : : ; um/ D 0;

can be solved for U in terms of X. However, the situation is now more complicated, even
if m D 1. For example, suppose that m D 1 and

                                   f .x; y; u/ D 1 x2 y2 u2:
                                       Section 6.4 The Implicit Function Theorem 419

If x2 C y2 > 1, then no value of u satisfies

                                       f .x; y; u/ D 0:                          (6.4.3)

However, infinitely many functions u D u.x; y/ satisfy (6.4.3) on the set
                                    S D °.x; y/  x2 C y2 Ä 1« :

They are of the form                            p
                           u.x; y/ D .x; y/ 1 x2 y2;

where .x; y/ can be chosen arbitrarily, for each .x; y/ in S , to be 1 or 1. We can narrow

the choice of functions to two by requiring that u be continuous on S ; then

                                        p                                        (6.4.4)
                           u.x; y/ D 1 x2 y2

or p
                                       u.x; y/ D 1 x2 y2:

We can define a unique continuous solution u of (6.4.3) by specifying its value at a single

interior point of S . For example, if we require that

                           Â1 1Ã 1
                           u p ;p D p ;
                                       33                    3

then u must be as defined by (6.4.4).

The question of whether an arbitrary system

                                       F.X; U/ D 0

determines U as a function of X is too general to have a useful answer. However, there

is a theorem, the implicit function theorem, that answers this question affirmatively in

an important special case. To facilitate the statement of this theorem, we partition the
differential matrix of F W RnCm ! Rm:

       2 @f1 @f1                       @f1       @f1 @f1                 @f1 3
                                       @xn j @u1 @u2
       6 @x1 @x2                                                         @um 7
       6                                                                      7
       6  @f2         @f2              @f2       @f2 @f2                 @f2  7
       6                               @xn j @u1 @u2                          7
F0     6  @x1         @x2                                                @um  7
    D  6                                                                      7  (6.4.5)
       6                                                                      7
       6  ::          :: : : ::                  ::              :: : :  ::   7
       6:             :    : :j:                                :        : :7
       4 @fm @fm                                                         @fm 5
                                       @fm    j  @fm @fm

          @x1 @x2                      @xn       @u1 @u2                 @um

or
                                             F0 D OEFX; FU;

where FX is the submatrix to the left of the dashed line in (6.4.5) and FU is to the right.

   For the linear transformation (6.4.2), FX D A and FU D B, and we have seen that the
system F.X; U/ D 0 defines U as a function of X for all X in Rn if FU is nonsingular. The

next theorem shows that a related result holds for more general transformations.
420 Chapter 6 Vector-Valued Functions of Several Variables

Theorem 6.4.1 (The Implicit Function Theorem) Suppose that F W RnCm !
Rm is continuously differentiable on an open set S of RnCm containing .X0; U0/: Let

F.X0; U0/ D 0; and suppose that FU.X0; U0/ is nonsingular: Then there is a neighborhood

M of .X0; U0/; contained in S; on which FU.X; U/ is nonsingular and a neighborhood N
of X0 in Rn on which a unique continuously differentiable transformation G W Rn ! Rm

is defined; such that G.X0/ D U0 and

               .X; G.X// 2 M and F.X; G.X// D 0 if X 2 N:                       (6.4.6)

Moreover;

               G0.X/ D OEFU.X; G.X// 1FX.X; G.X//; X 2 N:                       (6.4.7)

Proof  Define ^ W RnCm ! RnCm by

                                           2 x1 3

                                           6 x2 7
                                           6            7
                                           6      :     7
                                           6 :: 7
                                           6            7
                                           6 xn 7
                                           6            7
                                 ^.X; U/ D 6 f1.X; U/ 7                         (6.4.8)
                                           6            7
                                           6            7
                                           666 f2.X; U/ 7 : 77
                                           4 :: 5

                                              fm.X; U/

or, in "horizontal"notation by

                                 ^.X; U/ D .X; F.X; U//:                        (6.4.9)

Then ^ is continuously differentiable on S and, since F.X0; U0/ D 0,

                                 ^.X0; U0/ D .X0; 0/:                           (6.4.10)

The differential matrix of ^ is
       21 0                                                     03
                                 000

       6                                                             7
       6                                                             7
       6   0   1                 000                            0    7
       6                                                             7
       6   ::   :: : : ::           ::         :: : :           ::   7
       6:      :                ::    :       :         : :7
       6                                                             7
       60 0                      100                            07
       6                                                             7
       6                                                        @f1 777 Ä I 0
       6 @f1 @f1                 @f1 @f1 @f1
       6
^0 D 6 @x1 @x2                   @xn @u1 @u2                    @um  7D         ;
       6                                                             7   FX FU
       666 @f2 @f2               @f2 @f2 @f2                    @f2 777

       6 @x1 @x2                 @xn @u1 @u2                    @um 7
       6                                                             7
       6   ::   :: : : ::              ::       :: : :          ::   7
       66:      :               ::    :        :        : :7         7

       6                                                             7
       4 @fm @fm                 @fm @fm @fm                    @fm 5

           @x1 @x2               @xn @u1 @u2                    @um
                                            Section 6.4 The Implicit Function Theorem 421

where I is the n n identity matrix, 0 is the n m matrix with all zero entries, and FX
and FU are as in (6.4.5). By expanding det.^0/ and the determinants that evolve from it in
terms of the cofactors of their first rows, it can be shown in n steps that

                                      @f1 @f1            @f1 
                                      @u1 @u2            @um 
                                                              
                                       @f2  @f2          @f2  
                                                              
                         det.^0/       @u1  @u2          @um   D det.FU/:
                J  ^  D           D                           
                                                              
                                     : ::   ::: : :  : : ::

                                      @fm @fm            @fm    
                                                                
                                       @u1 @u2           @um

In particular,

                         J ^.X0; U0/ D det.FU.X0; U0/ ¤ 0:

Since ^ is continuously differentiable on S , Corollary 6.3.5 implies that ^ is regular on
some open neighborhood M of .X0; U0/ and that Mc D ^.M / is open.

   Because of the form of ^ (see (6.4.8) or (6.4.9)), we can write points of c M as .X; V/,
where V 2 Rm. Corollary 6.3.5 also implies that ^ has a a continuously differentiable
inverse  .X; V/ defined on c M with values in M . Since ^ leaves the "X part" of .X; U/

fixed, a local inverse of ^ must also have this property. Therefore,  must have the form

                                            2 x1 3

                                            6 x2 7
                                            6            7
                                            6    :       7
                                            6 :: 7
                                            6            7
                                            6 xn 7
                                            6            7
                                            6            7
                                   .X; V/ D 666 h1.X; V/ 777
                                            6            7
                                            6 h2.X; V/ 7
                                            6            7
                                            6 :: 7
                                            6:7
                                            4            5

                                               hm.X; V/

or, in "horizontal" notation,

                                       .X; V/ D .X; H.X; V//;

where H W RnCm ! Rm is continuously differentiable on Mc. We will show that G.X/ D
H.X; 0/ has the stated properties.

   From (6.4.10), .X0; 0/ 2 c M and, since c M is open, there is a neighborhood N of X0 in
Rn such that .X; 0/ 2 c M if X 2 N (Exercise 6.4.2). Therefore, .X; G.X// D  .X; 0/ 2 M
if X 2 N . Since  D ^ 1, .X; 0/ D ^.X; G.X//. Setting X D X0 and recalling (6.4.10)
shows that G.X0/ D U0, since ^ is one-to-one on M .
422 Chapter 6 Vector-Valued Functions of Several Variables

Henceforth we assume that X 2 N . Now,

.X; 0/ D ^. .X; 0//        (since ^ D  1/
        D ^.X; G.X//       (since .X; 0/ D .X; G.X//)
        D .X; F.X; G.X///  (since ^.X; U/ D .X; F.X; U//):

Therefore, F.X; G.X// D 0; that is, G satisfies (6.4.6). To see that G is unique, suppose
that G1 W Rn ! Rm also satisfies (6.4.6). Then

                     ^.X; G.X// D .X; F.X; G.X/// D .X; 0/

and
                           ^.X; G1.X// D .X; F.X; G1.X/// D .X; 0/

for all X in N . Since ^ is one-to-one on M , this implies that G.X/ D G1.X/.
   Since the partial derivatives

                     @hi ; 1 Ä i Ä m; 1 Ä j Ä n;
                     @xj

are con°tinuous functio«ns of .X; V/ on Mc, they are continuous with respect to X on the
subset .X; 0/  X 2 N of c M . Therefore, G is continuously differentiable on N . To verify
(6.4.7), we write F.X; G.X// D 0 in terms of components; thus,

fi .x1; x2; : : : ; xn; g1.X/; g2.X/; : : : ; gm.X// D 0; 1 Ä i Ä m; X 2 N:

Since fi and g1, g2, . . . , gm are continuously differentiable on their respective domains,
the chain rule (Theorem 5.4.3) implies that

@fi .X; G.X// X m @fi .X; G.X// @gr.X/        1 Ä i Ä m; 1 Ä j Ä n;
C                                       D 0;                                   (6.4.11)
@xj rD1 @ur @xj

or, in matrix form,

                     FX.X; G.X// C FU.X; G.X//G0 .X/ D 0:                      (6.4.12)

Since .X; G.X// 2 M for all X in N and FU.X; U/ is nonsingular when .X; U/ 2 M , we
can multiply (6.4.12) on the left by FU1.X; G.X// to obtain (6.4.7). This completes the

proof.

   In Theorem 6.4.1 we denoted the implicitly defined transformation by G for reasons
of clarity in the proof. However, in applying the theorem it is convenient to denote the
transformation more informally by U D U.X/; thus, U.X0/ D U0, and we replace (6.4.6)
and (6.4.7) by

.X; U.X// 2 M and X.X; U.X// D 0 if X 2 N;

and
                      U0.X/ D OEFU.X; U.X// 1FX.X; U.X//; X 2 N;
                                               Section 6.4 The Implicit Function Theorem 423

while (6.4.11) becomes

                 @fi X m @fi @ur                           1 Ä i Ä m; 1 Ä j Ä n;
                           C                   D 0;                               (6.4.13)
                 @xj rD1 @ur @xj

it being understood that the partial derivatives of ur and fi are evaluated at X and .X; U.X//,
respectively.

The following corollary is the implicit function theorem for m D 1.

Corollary 6.4.2 Suppose that f W RnC1 ! R is continuously differentiable on an

open set containing .X0; u0/; with f .X0; u0/ D 0 and fu.X0; u0/ ¤ 0. Then there is a
neighborhood M of .X0; u0/; contained in S; and a neighborhood N of X0 in Rn on which
is defined a unique continuously differentiable function u D u.X/ W Rn ! R such that

                 .X; u.X// 2 M and fu.X; u.X// ¤ 0; X 2 N;

                 u.X0/ D u0; and f .X; u.X// D 0; X 2 N:

The partial derivatives of u are given by

                           uxi .X/ D        fxi .X; u.X// ;       1 Ä i Ä n:
                                            fu.X; u.X//

Example 6.4.1 Let f .x; y; u/ D 1 x2 y2 u2                                        2u:
and .x0; y0; u0/ D . 12 ; 12 ; p12 /. Then f .x0; y0; ´0/ D 0 and                 p

              fx.x; y; u/ D 2x; fy.x; y; u/ D 2y; fu.x; y; u/ D                     2 ¤ 0, Corol-

Since f is continuously differentiable everywhere and fu.x0; y0; u0/ D                     (6.4.14)
lary 6.4.2 implies that the conditions                                                     (6.4.15)

                              2  2          2                                 1
                       1 x y u D 0; u.1=2; 1=2/ D p ;
                                                                              2

determine  u  D  u.x;  y/  near  .x0;  y0/  D  .  1  ;  1  /  so  that
                                                  2     2

                       ux.x; y/ D fx.x; y; u.x; y// D x ;
                                        fu.x; y; u.x; y// u.x; y/

and
                             uy.x; y/ D fy .x; y; u.x; y// D y :
                                              fu.x; y; u.x; y// u.x; y/

   It is not necessary to memorize formulas like (6.4.14) and (6.4.15). Since we know that
f and u are differentiable, we can obtain (6.4.14) and (6.4.15) by applying the chain rule
to the identity

                                         f .x; y; u.x; y// D 0:
424 Chapter 6 Vector-Valued Functions of Several Variables

Example 6.4.2 Let                                                             (6.4.16)
                   f .x; y; u/ D x3y2u2 C 3xy4u4 3x6y6u7 C 12x 13             (6.4.17)

and .x0; y0; u0/ D .1; 1; 1/, so f .x0; y0; u0/ D 0. Then
                      fx.x; y; u/ D 3x2y2u2 C 3y4u4 18x5y6u7 C 12;
                      fy.x; y; u/ D 2x3yu2 C 12xy3u4 18x6y5u7;
                      fu.x; y; u/ D 2x3y2u C 12xy4u3 21x6y6u6:

Since fu.1; 1; 1/ D 7 ¤ 0, Corollary 6.4.2 implies that the conditions

                                   f .x; y; u/ D 0; u.1; 1/ D 1

determine u as a continuously differentiable function of .x; y/ near .1; 1/.

   If we try to solve (6.4.16) for u, we see very clearly that Theorem 6.4.1 and Corol-
lary 6.4.2 are existence theorems; that is, they tell us that there is a function u D u.x; y/
that satisfies (6.4.17), but not how to find it. In this case there is no convenient formula for
the function, although its partial derivatives can be expressed conveniently in terms of x,
y, and u.x; y/:

    ux.x; y/ D fx.x; y; u.x; y// ; uy.x; y/ D fy.x; y; u.x; y// :
    fu.x; y; u.x; y//                                     fu.x; y; u.x; y//

In particular, since u.1; 1/ D 1,

    ux.1; 1/ D                     0          uy.1; 1/ D    44
                                    7 D 0;                   7 D 7:

Example 6.4.3 Let
                                       2x3 Ä

                                 X D 4 y 5 and U D u ;
                                           ´v

2x and Ä 2 C y2 C ´2 C u2 v2
                           F.X; U/ D x2 C ´2 C 2u v :

If X0 D .1; 1; 1/ and U0 D .0; 2/, then F.X0; U0/ D 0. Moreover,

                   Ä                                       Ä
    FU.X; U/ D 2u 2v 2 1                    and FX D 4x 2y 2´ 2x 0 2´ ;

so                                          0   4  D 8 ¤ 0:

    det.FU .X0 ;                   U0//  D    21
                                            
                                  Section 6.4 The Implicit Function Theorem 425

Hence, the conditions

                        F.X; U/ D 0; U.1; 1; 1/ D .0; 2/

determine U D U.X/ near X0. Although it is difficult to find U.X/ explicitly, we can
approximate U.X/ near X0 by an affine transformation. Thus, from (6.4.7),

               U0.X0/ D       OEFU.X0; U.X0// 1FX.X0; U.X0//                    (6.4.18)
                        D
                        D     Ä 0 4 1Ä 4 2 2
                        D
                                  21        2 02

                              1Ä 1 4 Ä 4       22
                              8 20 2           02

                              1Ä 4 2 6
                              8 84 4 :

Therefore,

            Ä              Ä         Ä              2    x1               3

               u.x; y/        0 C1      42     64 4 y C 1 5 Ä
               v.x; y/        28        84                ´1                 0

    lim                 OE.x 1/2 C .y C 1/2 C .´ 1/21=2                      D 0:

X!.1; 1;1/

   Again, it is not necessary to memorize (6.4.18), since the partial derivatives of an implic-
itly defined function can be obtained from the chain rule and Cramer's rule, as in the next
example.

Example 6.4.4 Let u D u.x; y/ and v D v.x; y/ be differentiable and satisfy

                            x2 C 2y2 C 3´2 C u2 C v D 6                         (6.4.19)
                           2x3 C 4y2 C 2´2 C u C v2 D 9

and                                                                             (6.4.20)
                               u.1; 1; 0/ D 1; v.1; 1; 0/ D 2:

To find ux and vx, we differentiate (6.4.19) with respect to x to obtain

                               2x C 2uux C vx D 0
                              6x2 C ux C 2vvx D 0:

Therefore,              Ä         Ä         Ä

                           2u 1      ux D      6x2 2x ;
                            1 2v     vx
426 Chapter 6 Vector-Valued Functions of Several Variables

and Cramer's rule yields                              
                               ux D   2x 6x2     1  2v  6x2 4xv
                                     
                                      2u1            D
                                                 1  2v  4uv 1 

and                                              

                                      2u 2x  1 6x2  2x 12x2u
           vx D                                  D
                                      2u 1  1 2v    4uv 1

if 4uv ¤ 1. In particular, from (6.4.20),

                                     22                                                            14 14
           ux.1; 1; 0/ D 9 D 9 ; vx.1; 1; 0/ D 9 D 9 :

Jacobians

It is convenient to extend the notation introduced in Section 6.2 for the Jacobian of a trans-

formation F W Rm ! Rm. If f1, f2, . . . , fm are real-valued functions of k variables,

k m, and 1, 2, . . . , m are any m of the variables, then we call the determinant

            @f1 @f1                                 @f1                                         

                                     @1    @2       @m                                          
                                                                                                
            @f2 @f2                                 @f2 
            @1 @2                                   @m 
                                                                                                ;
            ::                                :: : : :: 
           :                                  :    : :                                          

            @fm @fm                                 @fm                                         

                                     @1 @2          @m

the Jacobian of f1, f2, . . . , fm with respect to 1, 2, . . . , m. We denote this Jacobian by

                                       @.f1; f2; : : : ; fm/ ;
                                       @. 1; 2; : : : ; m/

and we denote the value of the Jacobian at a point P by
                                                                

                                          @.f1; f2; : : : ; fm/  :
                                          @. 1; 2; : : : ; m/ 

                                                                                             P

Example 6.4.5 If
                                                Ä 3x2 C 2xy C ´2

                               F.x; y; ´/ D 4x2 C 2xy2 C ´3 ;
                                                Section 6.4 The Implicit Function Theorem 427

then       @.f1; f2/  @.x; y/ D  6x C 2y 2x  8x C 2y2 4xy  ; @.f1; f2/  @.y; ´/ D  2x 4xy           
                                                                                              2´  3´2  ;
and                                 @.f1; f2/  @.´; x/ D  2´ 6x C 2y  3´2 8x C 2y2  :
                                                                                                
The values of these Jacobians at X0 D . 1; 1; 0/ are                                          0  0  D 0;
                                                                          
                                                                                         
        @  .f1  ;  f2  /            4  2              @  .f1  ;  f2  /                     2
                                D      4  D 4;                                D
         @.x; y/                    6                    @.y; ´/                           4

                            X0                                            X0

and                                 @.f1; f2/                    
                                     @.´; x/ 
                                                  D  00       4  6  D 0:

                                              X0

The requirement in Theorem 6.4.1 that FU.X0; U0/ be nonsingular is equivalent to
                                                       

                                @.f1; f2; : : : ; fm/  ¤ 0:
                                @.u1; u2; : : : ; um/ 

                                                                                .X0 ;U0 /

If this is so then, for a fixed j , Cramer's rule allows us to write the solution of (6.4.13) as

                       @ui D        @.f1; f2; : : : ; fi ; : : : ; fm/      1 Ä i Ä m;
                       @xj          @.u1; u2; : : : ; xj ; : : : ; um/ ;
                                    @.f1; f2; : : : ; fi ; : : : ; fm/
                                    @.u1; u2; : : : ; ui ; : : : ; um/

Notice that the determinant in the numerator on the right is obtained by replacing the i th

column of the determinant in the denominator, which is

                                    2 @f1 3              2 @f1 3

                                    6  @ui  7            6    @xj         7
                                    6       7            6                7
                                    6  @f2  7             6   @f2         7
                                    6       7             6               7
                                    6       7            6                7
                                    6 @ui 7 ;     by     6    @xj         7:
                                    6:7                  6:7
                                    6 :: 7                6 :: 7
                                    6       7            6                7
                                    4 @fm 5              4 @fm 5

                                       @ui                    @xj

So far we have considered only the problem of solving a continuously differentiable

system

                                    F.X; U/ D 0 .F W RnCm ! Rm/                                           (6.4.21)

for the last m variables, u1, u2, . . . , um, in terms of the first n, x1, x2, . . . , xn. This was
merely for convenience; (6.4.21) can be solved near .X0; U0/ for any m of the variables in
terms of the other n, provided only that the Jacobian of f1, f2, . . . , fm with respect to the
chosen m variables is nonzero at .X0; U0/. This can be seen by renaming the variables and
applying Theorem 6.4.1.
428 Chapter 6 Vector-Valued Functions of Several Variables

Example 6.4.6 Let                  Ä
                   F.x; y; ´/ D f .x; y; ´/

                                      g.x; y; ´/

be continuously differentiable in a neighborhood of .x0; y0; ´0/. Suppose that

                          F.x0; y0; ´0/ D 0

and                           

                   @.f; g/                         ¤ 0:                         (6.4.22)

                   @.x; ´/         .x0 ;y0 ;´0 /

Then Theorem 6.4.1 with X D .y/ and U D .x; ´/ implies that the conditions

     f .x; y; ´/ D 0; g.x; y; ´/ D 0; x.y0/ D x0; ´.y0/ D ´0;                   (6.4.23)

determine x and ´ as continuously differentiable functions of y near y0. Differentiating
(6.4.23) with respect to y and regarding x and ´ as functions of y yields

                   fxx0 C fy C f´´0 D 0
                   gx x0 C gy C g´´0 D 0:

Rewriting this as

                   fx x0 C f´´0 D fy
                   gx x0 C g´´0 D gy ;

and solving for x0 and ´0 by Cramer's rule yields

                          fy          f´           @.f; g/
                                                   @.y; ´/
                    gy                g´           @.f; g/
                   x0 D                   D        @.x; ´/                      (6.4.24)
                          fx       f´     
                         gx        g´     

and                                                @.f; g/
                                                   @.x; y/
                          fx       fy
                    gx gy 
                   ´0 D                D                    :                   (6.4.25)
                          fx       f´              @.f; g/
                                       
                      gx g´                        @.x; ´/

Equation (6.4.22) implies that @.f; g/=@.x; ´/ is nonzero if y is sufficiently close to y0.

Example 6.4.7 Let X0 D .1; 1; 2/ and

                   Ä                        Ä 6x C 6y C 4´3 44
                      f .x; y; ´/
     F.x; y; ´/ D g.x; y; ´/ D x2 y2 C 8´ 14 :
                                        Section 6.4 The Implicit Function Theorem 429

Then F.X0/ D 0,                                  6 12´2 
                     @.f; g/ D                  2x 8  ;
                     @.x; ´/

and                  @.f; g/                           

                     @.x; ´/            D  6 48  D 144 ¤ 0:
                                                28
                               .1;1;2/

Therefore, Theorem 6.4.1 with X D .y/ and U D .x; ´/ implies that the conditions

                     f .x; y; ´/ D 0; g.x; y; ´/ D 0;

and

                               x.1/ D 1; ´.1/ D 2;                       (6.4.26)

determine x and ´ as continuously differentiable functions of y near y0 D 1. From (6.4.24)

and (6.4.25),

                     @.f; g/                 6            
                                                   12´2 

                                                          
                                         2y 8               2 C y´2
                 xD0 @.y; ´/   D                   12´2  D  2 C x´2

                     @.f; g/                 6
                                        
                     @.x; ´/  2x 8 

and                                                      

                     @.f; g/             6 6  2x 2y 

                 ´0 D @.x; y/ D                             yx
                                                   12´2  D  4 C 2x´2 :
                     @.f; g/                 6
                                        
                     @.x; ´/             2x 8 

These equations hold near y D 1. Together with (6.4.26) they imply that

                             x0.1/ D 1; ´0.1/ D 0:

Example 6.4.8 Continuing with Example 6.4.7, Theorem 6.4.1 implies that the con-
ditions

                  f .x; y; ´/ D 0; g.x; y; ´/ D 0; y.1/ D 1; ´.1/ D 2

determine y and ´ as functions of x near x0 D 1, since

                     @.f; g/                    6  12´2 
                                           
                                        D
                     @.y; ´/  2y 8 

and                                                    

                     @.f; g/                    6  48  
                                                       
                                        D  2 8  D 144 ¤ 0:
                     @.y; ´/   .1;1;2/

However, Theorem 6.4.1 does not imply that the conditions

               f .x; y; ´/ D 0; g.x; y; ´/ D 0; x.2/ D 1; y.2/ D 1
430 Chapter 6 Vector-Valued Functions of Several Variables

define x and y as functions of ´ near ´0 D 2, since                      
                                                                    6  2y 
                                                                      
                                         @.f; g/  @.x; y/ D  6 2x  6  D 0:
                                                                   2
and            
      @.f; g/ 
                                             6
                                         
                                     D 2
      @.x; y/    .1;1;2/

   We close this section by observing that the functions u1, u2, . . . , um defined in Theo-
rem 6.4.1 have higher derivatives if f1; f2; : : : ; fm do, and they may be obtained by differ-
entiating (6.4.13), using the chain rule. (Exercise 6.4.17).

Example 6.4.9 Suppose that u and v are functions of .x; y/ that satisfy
                                f .x; y; u; v/ D x u2 v2 C 9 D 0
                              g.x; y; u; v/ D y u2 C v2 10 D 0:

Then                                             
      @.f; g/  @.u; v/ D  2u 2u              2v  D 8uv:
                                             2v

From Theorem 6.4.1, if uv ¤ 0, then

                                                                       
      u 1 @.f; g/ 1  x D D  10                                     2v  2v  1  D 4u ;

             8uv @.x; v/ 8uv

                                                                       
      u 1 @.f; g/ 1  y D D  01                                     2v  2v  1  D 4u ;

             8uv @.y; v/ 8uv

      v 1 @.f; g/ 1  x D 8uv @.u; x/ D 8uv  2u 1  2u 0  1  D 4v ;  

      v 1 @.f; g/ 1  y D 8uv @.u; y/ D 8uv  2u 0  2u 1  1  D 4v :  

These can be differentiated as many times as we wish. For example,

      uxx D                          ux D         1
      uxy D                          4u2        16u3 ;
                                     uy D
                                     4u2          1
                                                16u3 ;

and

                                     vx      1
      vyx D 2 D 2 :
                                     4v 16v
                                  Section 6.4 The Implicit Function Theorem 431
                              6.4 Exercises

1. Solve for U D .u; : : : / as a function of X D .x; : : : /.
Ä            Ä     Ä              Ä     Ä
(a) 1 1 1 1     uC1 1                xD0
                v             23     y                          0

   u v C w C 3x C 2y D 0

(b) u C v C w x C y D 0

   uCv w           C yD0

(c) 3u C v C y D sin x
          u C 2v C x D sin y

               2u C 2v C w C 2x C 2y C ´ D 0
     (d) u v C 2w C x y C 2´ D 0

               3u C 2v w C 3x C 2y ´ D 0

2. Suppose that X0 2 Rn and U0 2 Rm. Prove: If N1 is a neighborhood of .X0; U0/
      in RnCm, there is a neighborhood N of X0 in Rn such that .X; U0/ 2 N1 if X 2 N .

3. Let .X0; U0/ be an arbitrary point in RnCm. Give an example of a function F W
      RnCm ! Rm such that F is continuously differentiable on RnCm, F.X0; U0/ D 0,
      FU.X0; U0/ is singular, and the conditions F.X; U/ D 0 and U.X0/ D Y0

     (a) determine U as a continuously differentiable function of X for all X;
     (b) determine U as a continuous function of X for all X, but U is not differentiable

             at X0;
     (c) do not determine U as a function of X.

4. Let u D u.x; y/ be determined near .1; 1/ by

                           x2yu C 2xy2u3 3x3y3u5 D 0; u.1; 1/ D 1:

      Find ux.1; 1/ and uy .1; 1/.
5. Let u D u.x; y; ´/ be determined near .1; 1; 1/ by

                       x2y5´2u5 C 2xy2u3 3x3´2u D 0; u.1; 1; 1/ D 1:

      Find ux.1; 1; 1/, uy.1; 1; 1/, and u´.1; 1; 1/.

6. Find u.x0; y0/, ux .x0; y0/, and uy.x0; y0/.
     (a) 2x2 C y2 C ueu D 6; .x0; y0/ D .1; 2/
     (b) u.x C 1/ C x.y C 2/ C y.u 2/ D 0; .x0; y0/ D . 1; 2/
     (c) 1 eu sin.x C y/ D 0; .x0; y0/ D . =4; =4/
     (d) x log u C y log x C u log y D 0; .x0; y0/ D .1; 1/
432 Chapter 6 Vector-Valued Functions of Several Variables

7. Find u.x0; y0/, ux.x0; y0/, and uy.x0; y0/ for all continuously differentiable func-
      tions u that satisfy the given equation near .x0; y0/.

(a) 2x2y4 3uxy3 C u2x4y3 D 0; .x0; y0/ D .1; 1/

(b) cos u cos x C sin u sin y D 0; .x0; y0/ D .0; /

8. Suppose that U D .u; v/ is continuously differentiable with respect to .x; y; ´/ and

satisfies               x2 C 4y2 C ´2 2u2 C v2 D 4

                                    .x C ´/2 C u v D 3

and

                        u.1;  1  ;  1/ D  2;  v.1;  1  ;  1/ D 1:
                              2                     2

Find  U0.1;  1  ;  1/.
             2

9. Let u and v be continuously differentiable with respect to x and satisfy

                        u C 2u2 C v2 C x2 C 2v x D 0

                                    xuv C eu sin.v C x/ D 0

        and u.0/ D v.0/ D 0. Find u0.0/ and v0.0/.
10. Let U D .u; v; w/ be continuously differentiable with respect to .x; y/ and satisfy

                        x2y C xy2 C u2 .v C w/2 D 3

                                     exCy u v w D 2
                             .x C y/2 C u C v C w2 D 3

        and U.1; 1/ D .1; 2; 0/. Find U0.1; 1/.

11. Two continuously differentiable transformations U D .u; v/ of .x; y/ satisfy the
        system

                                    xyu 4yu C 9xv D 0
                                      2xy 3y2 C v2 D 0

        near .x0; y0/ D .1; 1/. Find the value of each transformation and its differential
        matrix at .1; 1/.
12. Suppose that u, v, and w are continuously differentiable functions of .x; y; ´/ that
        satisfy the system

                                  ex cos y C e´ cos u C ev cos w C x D 3
                                  ex sin y C e´ sin u C ev cos w D 1
                                  ex tan y C e´ tan u C ev tan w C ´ D 0

near .x0; y0; ´0/ D .0; 0; 0/, and u.0; 0; 0/ D v.0; 0; 0/ D w.0; 0; 0/ D 0. Find
ux.0; 0; 0/, vx.0; 0; 0/, and wx.0; 0; 0/.
                Section 6.4 The Implicit Function Theorem 433

13. Let F D .f; g; h/ be continuously differentiable in a neighborhood of P0 D .x0; y0; ´0; u0; v0/,

F.P0/ D 0, and              
                @.f; g; h/  ¤ 0:
                @.y; ´; u/ P0

Then Theorem 6.4.1 implies that the conditions

F.x; y; ´; u; v/ D 0; y.x0; v0/ D u0; ´.x0; v0/ D ´0; u.x0; v0/ D u0

        determine y, ´, and u as continuously differentiable functions of .x; v/ near .x0; v0/.
        Use Cramer's rule to express their first partial derivatives as ratios of Jacobians.

14. Decide which pairs of the variables x, y, ´, u, and v are determined as functions of
        the others by the system

                 x C 2y C 3´ C u C 6v D 0
                2x C 4y C ´ C 2u C 2v D 0;

        and solve for them.
15. Let y and v be continuously differentiable functions of .x; ´; u/ that satisfy

                                      x2 C 4y2 C ´2 2u2 C v2 D 4
                                                  .x C ´/2 C u v D 3

        near .x0; ´0; u0/ D .1; 1; 2/, and suppose that

                                                      1
                                  y.1; 1; 2/ D 2 ; v.1; 1; 2/ D 1:

        Find yx.1; 1; 2/ and vu.1; 1; 2/.
16. Let u, v, and x be continuously differentiable functions of .w; y/ that satisfy

                                     x2y C xy2 C u2 .v C w/2 D 3
                                                  exCy u v w D 2

                                           .x C y/2 C u C v C w2 D 3

near .w0; y0/ D .0; 1/, and suppose that

                u.0; 1/ D 1; v.0; 1/ D 2; x.0; 1/ D 1:

        Find the first partial derivatives of u, v, and x with respect to y and w at .0; 1/.

17. In addition to the assumptions of Theorem 6.4.1, suppose that F has all partial
        derivatives of order Ä q in S . Show that U D U.X/ has all partial derivatives
        of order Ä q in N .
434 Chapter 6 Vector-Valued Functions of Several Variables

18. Calculate all first and second partial derivatives at .x0; y0/ D .1; 1/ of the functions
        u and v that satisfy

           x2 C y2 C u2 C v2 D 3       u.1; 1/ D 0; v.1; 1/ D 1:
           x C y C u C v D 3;

19. Calculate all first and second partial derivatives at .x0; y0/ D .1; 1/ of the func-
        tions u and v that satisfy

           u2 v2 D x y 2       u.1; 1/ D 1; v.1; 1/ D 1:
               2uv D x C y 2;

20. Suppose that f1, f2, . . . , fn are continuously differentiable functions of X in a
        region S in Rn, is continuously differentiable function of U in a region T of Rn,

           .f1.X/; f2.X/; : : : ; fn.X// 2 T; X 2 S;

           .f1.X/; f2.X/; : : : ; fn.X// D 0; X 2 S;

and        Xn    2             .U/  >  0;  U 2 T:
Show that        uj

           j D1

           @.f1; f2; : : : ; fn/ D 0;      X 2 S:
           @.x1; x2; : : : ; xn/
           CHAPTER 7

     Integrals of Functions
      of Several Variables

IN THIS CHAPTER we study the integral calculus of real-valued functions of several
variables.
SECTION 7.1 defines multiple integrals, first over rectangular parallelepipeds in Rn and
then over more general sets. The discussion deals with the multiple integral of a function
whose discontinuities form a set of Jordan content zero, over a set whose boundary has
Jordan content zero.

SECTION 7.2 deals with evaluation of multiple integrals by means of iterated integrals.

SECTION 7.3 begins with the definition of Jordan measurability, followed by a derivation
of the rule for change of content under a linear transformation, an intuitive formulation of
the rule for change of variables in multiple integrals, and finally a careful statement and
proof of the rule. This is a complicated proof.

7.1 DEFINITION AND EXISTENCE OF THE MULTIPLE IN-
TEGRAL

We now consider the Riemann integral of a real-valued function f defined on a subset of
Rn, where n 2. Much of this development will be analogous to the development in

Sections 3.1-3 for n D 1, but there is an important difference: for n D 1, we considered
integrals over closed intervals only, but for n > 1 we must consider more complicated

regions of integration. To defer complications due to geometry, we first consider integrals
over rectangles in Rn, which we now define.

Integrals over Rectangles

The

                           S1 S2  Sn

of subsets S1, S2, . . . , Sn of R is the set of points .x1; x2; : : : ; xn/ in Rn such that x1 2

S1; x2 2 S2; : : : ; xn 2 Sn. For example, the Cartesian product of the two closed intervals

                           435
436 Chapter 7 Integrals of Functions of Several Variables

OEa1; b1 OEa2; b2 D .x; y/  a1 Ä x Ä b1; a2 Ä y Ä b2°              «

is a rectangle in R2 with sides parallel to the x- and y-axes (Figure 7.1.1).

    y

b2

a2

       a1                                                       x

                                                 b1

              Figure 7.1.1

The Cartesian product of three closed intervals

OEa1; b1 OEa2; b2 OEa3; b3 D .x; y; ´/  a1 Ä x Ä b1; a2 Ä y Ä b2; a3 Ä ´ Ä b3° «

is a rectangular parallelepiped in R3 with faces parallel to the coordinate axes (Figure 7.1.2).

           z

                                                             y

x

                     Figure 7.1.2
                      Section 7.1 Definition and Existence of the Multiple Integral 437

Definition 7.1.1 A coordinate rectangle R in Rn is the Cartesian product of n closed

intervals; that is,

                      R D OEa1; b1 OEa2; b2       OEan; bn:

The content of R is

                      V .R/ D .b1 a1/.b2 a2/ .bn an/:

The numbers b1 a1, b2 a2, . . . , bn an are the edge lengths of R. If they are equal,
then R is a coordinate cube. If ar D br for some r , then V .R/ D 0 and we say that R is
degenerate; otherwise, R is nondegenerate.

   If n D 1, 2, or 3, then V .R/ is, respectively, the length of an interval, the area of a
rectangle, or the volume of a rectangular parallelepiped. Henceforth, "rectangle" or "cube"
will always mean "coordinate rectangle" or "coordinate cube" unless it is stated otherwise.

If

                      R D OEa1; b1 OEa2; b2                 OEan; bn

and
                            Pr W ar D ar0 < ar1 < < armr D br

is a partition of OEar ; br , 1 Ä r Ä n, then the set of all rectangles in Rn that can be written
as

OEa1;j1 1; a1j1 OEa2;j2 1; a2j2   OEan;jn 1; anjn; 1 Ä jr Ä mr ; 1 Ä r Ä n;

is a partition of R. We denote this partition by

                      P D P1 P2                   Pn                  (7.1.1)

and define its norm to be the maximum of the norms of P1, P2, . . . , Pn, as defined in
Section 3.1; thus,

                               kP k D maxfkP1k; kP2k; : : : ; kPnkg:

Put another way, kP k is the largest of the edge lengths of all the subrectangles in P .
   Geometrically, a rectangle in R2 is partitioned by drawing horizontal and vertical lines

through it (Figure 7.1.3); in R3, by drawing planes through it parallel to the coordinate axes.
Partitioning divides a rectangle R into finitely many subrectangles that we can number in
arbitrary order as R1, R2, . . . , Rk. Sometimes it is convenient to write

                                  P D fR1; R2; : : : ; Rkg

rather than (7.1.1).
438 Chapter 7 Integrals of Functions of Several Variables

                                  y

                               b2

                          a2                                                                    x
                                       a1                                         b1

                                               Figure 7.1.3

If P D P1 P2                 Pn  and           P0  D  P0          P0          P0   are     partitions   of  the  same

                  P0                                    1           2           n
                                                      P0
rectangle,  then      is  a  refinement    of  P  if       is  a  refinement  of  Pi ,  1  Ä  i  Ä  n,  as  defined  in
                                                        i

Section 3.1.

Suppose that f is a real-valued function defined on a rectangle R in Rn, P D fR1; R2; : : : ; Rkg

is a partition of R, and Xj is an arbitrary point in Rj , 1 Ä j Ä k. Then

                                                  Xk
                                               D f .Xj /V .Rj /

                                                   j D1

is a Riemann sum of f over P . Since Xj can be chosen arbitrarily in Rj , there are infinitely
many Riemann sums for a given function f over any partition P of R.

   The following definition is similar to Definition 3.1.1.

Definition 7.1.2 Let f be a real-valued function defined on a rectangle R in Rn. We
say that f is Riemann integrable on R if there is a number L with the following property:
For every > 0, there is a i > 0 such that

                                               j Lj <

if is any Riemann sum of f over a partition P of R such that kP k < i. In this case, we
say that L is the Riemann integral of f over R, and write

                                           Z
                                               f .X/ d X D L:

                                                                R

                                                                 R
   If R is degenerate, then Definition 7.1.2 implies that R f .X/ d X D 0 for any function f
defined on R (Exercise 7.1.1). Therefore, it should be understood henceforth that whenever
we speak of a rectangle in Rn we mean a nondegenerate rectangle, unless it is stated to the
contrary.
                Section 7.1 Definition and Existence of the Multiple Integral 439

          R
     The integral R f .X/d X is also written as
       Z                                  Z

            f .x; y/ d.x; y/ .n D 2/;              f .x; y; ´/ d.x; y; ´/ .n D 3/;

          R                                      R

or           Z

                  f .x1; x2; : : : ; xn/ d.x1; x2; : : : ; xn/ (n arbitrary):

                R

   Here d X does not stand for the differential of X, as defined in Section 6.2. It merely
identifies x1, x2, . . . , xn, the components of X, asRthe variables of iRntegration. To avoid this
minor inconsistency, some authors write simply R f rather than R f .X/ d X.

   As in the case where n D 1, we will say simply "integrable" or "integral" when we
mean "Riemann integrable" or "Riemann integral." If n 2, we call the integral of Defi-
nition 7.1.2 a multiple integral; for n D 2 and n D 3 we also call them double and triple
integrals, respectively. When we wish to distinguish between multiple integrals and the
integral we studied in Chapter .n D 1/, we will call the latter an ordinary integral.

                               R
Example 7.1.1 Find R f .x; y/ d.x; y/, where

                                     R D OEa; b OEc; d 

and
                                           f .x; y/ D x C y:

Solution Let P1 and P2 be partitions of OEa; b and OEc; d ; thus,

     P1 W a D x0 < x1 < < xr D b and P2 W c D y0 < y1 <                        < ys D d:
                                                                                          (7.1.2)
A typical Riemann sum of f over P D P1 P2 is given by                                     (7.1.3)
                                                                                          (7.1.4)
                D         Xr Xs      . ij C Áij /.xi  xi 1/.yj  yj 1/;                    (7.1.5)
                                                                                          (7.1.6)
                          i D1 j D1

where

                          xi 1 Ä ij Ä xi and          yj 1 Ä Áij Ä yj :
                                                      yj D yj C yj 1 ;
The midpoints of OExi 1; xi  and OEyj 1; yj  are
                                                                   2
                          xi D xi C xi 1 and
                                      2

and (7.1.3) implies that

                          j ij xi j Ä xi xi 1 Ä kP1k Ä kP k
                                       2              2         2

and

                          jÁij yj j Ä yj yj 1 Ä kP2k Ä kP k :
                                       2              2         2
440 Chapter 7 Integrals of Functions of Several Variables

Now we rewrite (7.1.2) as

            D  Xr Xs      .xi C yj /.xi  xi 1/.yj    yj 1/

               i D1 j D1                                                        (7.1.7)
                  Xr Xs                                                         (7.1.8)
               C          . ij xi / C .Áij yj / .xi xi          1/.yj   yj 1/:

                           i D1 j D1

         R
To find R f .x; y/ d.x; y/ from (7.1.7), we recall that

                   Xr     .xi xi 1/ D b a;         Xs  .yj yj 1/ D d c

                   i D1                            j D1

(Example 3.1.1), and

                   Xr    .xi2 xi2 1/ D b2 a2;      Xs    .yj2 yj2 1/ D d 2 c2

                                                                                (7.1.9)

                   i D1                            j D1

(Example 3.1.2).

Because of (7.1.5) and (7.1.6) the absolute value of the second sum in (7.1.7) does not

exceed                                                                # X 2 s          3
                                                                xi 1/ 4 .yj     yj 1/5
kP k    Xr Xs     .xi     xi 1/.yj                   "Xr
                                    yj 1/ D kP k .xi

        j D1 j D1                                    i D1               j D1

                                         D kP k.b a/.d c/

(see (7.1.8)), so (7.1.7) implies that                   

                                                         
            Xr Xs  .xi C yj /.xi xi 1/.yj yj 1/ Ä kP k.b a/.d c/:

 i D1 j D1                                                                      (7.1.10)

It now follows that       xi 1/.yj  yj 1/ D  "Xr     xi .xi          # X 2 s           3
                                                               xi 1/ 4 .yj      yj 1/5
      Xr Xs
               xi .xi                          i D1                  j D1

         i D1j D1                                               xi 1/ (from (7.1.8))

                                         D .d          Xr
                                                     c/ xi .xi

                                                         i D1
                                                   c Xr
                                            d            .xi2   xi2 1/  (from (7.1.4))
                                         D     2 iD1                    (from (7.1.9)):

                                         D d c .b2 a2/
                                               2

Similarly,

                   Xr Xs            xi 1/.yj yj 1/ D b a .d 2 c2/:
                            yj .xi                               2

                   i D1 j D1
                        Section 7.1 Definition and Existence of the Multiple Integral 441

Therefore, (7.1.10) can be written as

 d c  .b2 a2/ b a .d 2 c2/ Ä kP k.b a/.d c/:            

                     2                    2

Since the right side can be made as small as we wish by choosing kP k sufficiently small,

Z1                                            c/.b2    a2/ C .b  a/.d 2  c2/ :
     .x C y/ d.x; y/ D .d
                             2
  R

Upper and Lower Integrals

The following theorem is analogous to Theorem 3.1.2.

Theorem 7.1.3 If f is unbounded on the nondegenerate rectangle R in Rn; then f is
not integrable on R:

Proof We will show that if f is unbounded on R, P D fR1; R2; : : : ; Rkg is any parti-
tion of R, and M > 0, then there are Riemann sums and 0 of f over P such that

                                       j      0j M:                                (7.1.11)

This implies that f cannot satisfy Definition 7.1.2. (Why?)
   Let
                                               Xk
                                           D f .Xj /V .Rj /

                                                                   j D1

be a Riemann sum of f over P . There must be an integer i in f1; 2; : : : ; kg such that

                             jf .X/ f .Xi /j             M                         (7.1.12)
                                                       V .Ri /

for some X in Ri , because if this were not so, we would have

                     jf .X/                 M      X 2 Rj ;      1 Ä j Ä k:
                             f .Xj /j < V .Rj / ;

If this is so, then

jf .X/j D jf .Xj / C f .X/ f .Xj /j Ä jf .Xj /j C jf .X/                 f .Xj /j

                                        M     X 2 Rj ;    1 Ä j Ä k:
                     Ä jf .Xj /j C V .Rj / ;

However, this implies that

  jf .X/j Ä max jf .Xj /j C                   M        1Ä j Ä k ;     X 2 R;

                                              V .Rj /

which contradicts the assumption that f is unbounded on R.
442 Chapter 7 Integrals of Functions of Several Variables

Now suppose that X satisfies (7.1.12), and consider the Riemann sum

                                   0D  Xn    f  .X  0  /V  .Rj  /
                                                    j

                                       j D1

over the same partition P , where

                                     0 Xj ; j ¤ i;
                                   Xj D

                                            X; j D i:

Since

                            j      0j D jf .X/ f .Xi /jV .Ri /;

(7.1.12) implies (7.1.11).

   Because of Theorem 7.1.3, we need consider only bounded functions in connection with
Definition 7.1.2. As in the case where n D 1, it is now convenient to define the upper
and lower integrals of a bounded function over a rectangle. The following definition is
analogous to Definition 3.1.3.

Definition 7.1.4 If f is bounded on a rectangle R in Rn and P D fR1; R2; : : : ; Rkg
is a partition of R, let

       Mj D sup f .X/; mj D inf f .X/:
                                                           X2Rj
                               X2Rj

The upper sum of f over P is

                                                   Xk
                                       S.P / D Mj V .Rj /;

                                                                        j D1

and the upper integral of f over R, denoted by
                                              Z
                                                  f .X/ d X;

                                                                    R

is the infimum of all upper sums. The lower sum of f over P is

                                                   Xk
                                        s.P / D mj V .Rj /;

                                                                        j D1

and the lower integral of f over R, denoted by
                                              Z
                                                  f .X/ d X;

                                                                    R

is the supremum of all lower sums.

The following theorem is analogous to Theorem 3.1.4.
                         Section 7.1 Definition and Existence of the Multiple Integral 443

Theorem 7.1.5 Let f be bounded on a rectangle R and let P be a partition of R:
Then

(a) The upper sum S.P/ of f over P is the supremum of the set of all Riemann sums of
      f over P:

(b) The lower sum s.P/ of f over P is the infimum of the set of all Riemann sums of f
      over P:

Proof Exercise 7.1.5.

    If
                                     m Ä f .X/ Ä M for X in R;

then

                         mV .R/ Ä s.P / Ä S.P / Ä M V .R/I
             R              R
therefore, R f .X/ d X and R f .X/ d X exist, are unique, and satisfy the inequalities

                               Z

                            mV .R/ Ä f .X/ d X Ä M V .R/

                                                 R

and                            Z

                            mV .R/ Ä f .X/ d X Ä M V .R/:

                                                 R

    The upper and lower integrals are also written as

                   Z              Z

                         f .x; y/ d.x; y/ and f .x; y/ d.x; y/ .n D 2/;

                      R           R

             Z                    Z

                   f .x; y; ´/ d.x; y; ´/ and f .x; y; ´/ d.x; y; ´/ .n D 3/;

                R                 R

or                       Z

                              f .x1; x2; : : : ; xn/ d.x1; x2; : : : ; xn/

                            R

and                Z

                        f .x1; x2; : : : ; xn/ d.x1; x2; : : : ; xn/  (n arbitrary):

                      R

                         R           R
Example 7.1.2 Find R f .x; y/ d.x; y/ and R f .x; y/ d.x; y/, with R D OEa; b

OEc; d  and

                               f .x; y/ D x C y;

as in Example 7.1.1.

Solution Let P1 and P2 be partitions of OEa; b and OEc; d ; thus,                     < ys D d:
      P1 W a D x0 < x1 < < xr D b and P2 W c D y0 < y1 <
444 Chapter 7 Integrals of Functions of Several Variables

The maximum and minimum values of f on the rectangle OExi    1; xi  OEyj    1; yj  are xi Cyj
and xi 1 C yj 1, respectively. Therefore,                    yj 1/                    (7.1.13)

                 S.P / D  Xr Xs  .xi C yj /.xi  xi 1/.yj

                          i D1 j D1

and

                 s.P / D  Xr Xs  .xi 1 C yj 1/.xi         xi 1/.yj  yj 1/:

                                                                                   (7.1.14)

                          i D1 j D1

By substituting

                        1                                    xi 1/ C .yj    yj 1/
          xi C yj D 2 OE.xi C xi 1/ C .yj C yj 1/ C .xi
into (7.1.13), we find that

                                     1                                             (7.1.15)
                          S.P / D 2 .1 C 2 C 3 C 4/;

where         Xr                 Xs
       1 D .xi2           xi 1 2 / .yj
                                              yj 1/ D .b2 a2/.d c/;
                  i D1               j D1     yj2 1/ D .b a/.d 2 c2/;
                                               yj 1/ Ä kPk.b a/.d c/;
              Xr                 Xs           yj 1/2 Ä kPk.b a/.d c/:
       2 D .xi            xi 1/ .yj2

                  i D1              j D1

              Xr                  Xs
       3 D .xi            xi 1/2 .yj

                  i D1                j D1

              Xr                 Xs
       4 D .xi            xi 1/ .yj

                  i D1              j D1

Substituting these four results into (7.1.15) shows that

                          I < S.P / < I C kP k.b a/.d c/;

where                          .d c/.b2 a2/ C .b a/.d 2 c2/
                         ID 2 :

From this, we see that    Z

                                       .x C y/ d.x; y/ D I:

                                     R

     After substituting

                           1
       xi 1 C yj 1 D 2 OE.xi C xi 1/ C .yj C yj 1/ .xi xi 1/ .yj yj 1/

into (7.1.14), a similar argument shows that

                          I kP k.b a/.d c/ < s.P / < I;
                          Section 7.1 Definition and Existence of the Multiple Integral 445

so                                      Z

                                             .x C y/ d.x; y/ D I:

                                           R

    We now prove an analog of Lemma 3.2.1.

Lemma 7.1.6 Suppose that jf .X/j Ä M if X is in the rectangle

                                R D OEa1; b1 OEa2; b2                OEan; bn:

Let P D P1 P2                   Pn  and    P0  D  P0   P0            P0   be   partitions   of  R;  where  P0

                                                    1    2             n                                     j

is obtained by adding rj partition points to Pj ; 1 Ä j Ä n: Then

                                                                  0              1
                                                  2M V .R/ @Xn rj A kP k
        S.P /                   S.P 0/     S.P /                     j D1 bj aj                     (7.1.16)

and                                                         0                   1

        s.P / Ä s.P 0/ Ä s.P / C 2M V .R/ @Xn rj A kP k:                                            (7.1.17)
                                                                  j D1 bj aj

Proof We will prove (7.1.16) and leave the proof of (7.1.17) to you (Exercise 7.1.7).

First  suppose that  P0   is obtained by adding one    point to P1,       and   P0   D  Pj  for 2   Ä  j  Ä  n.

                       1                                                          j

If Pr is defined by

        Pr W ar D ar0 < ar1 < < armr D br ; 1 Ä r Ä n;

then a typical subrectangle of P is of the form

        Rj1j2 jn D OEa1;j1 1; a1j1 OEa2;j2 1; a2j2                        OEan;jn 1; anjn:

Let c be the additional point introduced into P1 to obtain P10, and suppose that

                                           a1;k 1 < c < a1k:

If j1 ¤ k, then Rj1j2 jn is common to P and P 0, so the terms associated with it in S.P 0/
and S.P / cancel in the difference S.P / S.P 0/. To analyze the terms that do not cancel,

define  Rkj2 jn .1/ D OEa1;k 1; c OEa2;j2 1; a2j2 

                                                                          OEan;jn 1; anjn;

        Rkj2 jn .2/ D OEc; a1k  OEa2;j2 1; a2j2                         OEan;jn 1; anjn ;

                                                  °                       «
                                Mkj2 jn D sup f .X/  X 2 Rkj2 jn                                    (7.1.18)

and                       .i /             n                .i /     o

                     Mkj2 jn D sup f .X/ X 2 Rkj2 jn ; i D 1; 2:                                    (7.1.19)
446 Chapter 7 Integrals of Functions of Several Variables

Then S.P / S.P 0/ is the sum of terms of the form                             (7.1.20)
      h .1/ .2/ i
       Mkj2 jn .a1k a1;k 1/ Mkj2 jn .c a1;k 1/ Mkj2 jn.a1k c/

                            .a2j2 a2;j2 1/ .anjn an;jn 1/:

The terms within the brackets can be rewritten as                             (7.1.21)
       .Mkj2 jn Mkj2 jn .1/ /.c a1;k 1/ C .Mkj2 jn Mkj2 jn .2/ /.a1k c/;      (7.1.22)

which is nonnegative, because of (7.1.18) and (7.1.19). Therefore,
                                             S.P 0/ Ä S.P /:

Moreover, the quantity in (7.1.21) is not greater than 2M.a1k a1;k 1/, so (7.1.20) implies
that the general surviving term in S.P / S.P 0/ is not greater than

                   2M kP k.a2j2 a2;j2 1/ .anjn an;jn 1/:

The sum of these terms as j2, . . . , jn assume all possible values 1 Ä ji Ä mi , 2 Ä i Ä n,
is

                        2M kP k.b2 a2/ .bn an/ D 2M kP kV .R/ :
                                                                      b1 a1

This implies that

                         S.P / Ä S.P 0/ C 2M kP kV .R/ :
                                                   b1 a1

This and (7.1.22) imply (7.1.16) for r1 D 1 and r2 D D rn D 0.

Similarly, if ri D 1 for some i in f1; : : : ; ng and rj D 0 if j ¤ i , then

                                  S.P / Ä S.P 0/ C 2M kP kV .R/ :             C rn times, as in
                                                             bi ai

To obtain (7.1.16) in the general case, repeat this argument r1 C r2 C
the proof of Lemma 3.2.1.

   Lemma 7.1.6 implies the following theorems and lemma, with proofs analogous to the
proofs of their counterparts in Section 3.2.

Theorem 7.1.7 If f is bounded on a rectangle R; then

                         Z           Z

                               f .X/ d X Ä f .X/ d X:

                            R        R

Proof Exercise 7.1.8.
   The next theorem is analogous to Theorem 3.2.3.

Theorem 7.1.8 If f is integrable on a rectangle R; then

                   Z           Z                    Z

                         f .X/ d X D f .X/ d X D f .X/ d X:

                      R           R                    R

Proof Exercise 7.1.9.
              Section 7.1 Definition and Existence of the Multiple Integral 447

Lemma 7.1.9 If f is bounded on a rectangle R and > 0; there is a i > 0 such that

              Z                          Z

                    f .X/ d X Ä S.P / < f .X/ d X C

                 R                          R

and           Z                          Z

                    f .X/ d X s.P / > f .X/ d X

                 R                          R

if kP k < i:

Proof Exercise 7.1.10.
   The next theorem is analogous to Theorem 3.2.5.

Theorem 7.1.10 If f is bounded on a rectangle R and

                    Z              Z

                          f .X/ d X D f .X/ d X D L;

                       R              R

then f is integrable on R; and

                                   Z

                                       f .X/ d X D L:

                                     R

Proof Exercise 7.1.11.

   Theorems 7.1.8 and 7.1.10 imply the following theorem, which is analogous to Theo-
rem 3.2.6.

Theorem 7.1.11 A bounded function f is integrable on a rectangle R if and only if

                       Z              Z

                                   f .X/ d X D f .X/ d X:

                                R        R

   The next theorem translates this into a test that can be conveniently applied. It is analo-
gous to Theorem 3.2.7.

Theorem 7.1.12 If f is bounded on a rectangle R; then f is integrable on R if and
only if for every > 0 there is a partition P of R such that

                                           S.P / s.P / < :

Proof Exercise 7.1.12.

   Theorem 7.1.12 provides a useful criterion for integrability. The next theorem is an
important application. It is analogous to Theorem 3.2.8.

Theorem 7.1.13 If f is continuous on a rectangle R in Rn; then f is integrable on R:
448 Chapter 7 Integrals of Functions of Several Variables

Proof Let > 0. Since f is uniformly continuous on R (Theorem 5.2.14), there is a

i > 0 such that

                                   jf .X/ f .X0/j <                                                     (7.1.23)
                                                          V .R/

if X and X0 are in R and jX   X0j < i. Let P D fR1; R2; : : : ; Rkg be a partition of R with
            p
kP k < i=  n.  Since f  is continuous on R, there are points Xj                    and  X0    in Rj  such that

                                                                                           j

           f .Xj / D Mj D sup f .X/ and               f   .X          0  /  D  mj  D    inf   f .X/
                                                                      j               X2Rj
                                        X2Rj

(Theorem 5.2.12). Therefore,

                                    Xn
                 S.P/ s.P/ D .f .Xj / f .X0j //V .Rj /:

                                          j D1

                   p         X0 j  <  i,  and,  from  (7.1.23)           with  X   D  Xj  and  X0    D  X0 ,
Since kP k < i= n, jXj
                                j                                                                          j

                        S.P/       s.P/ <             Xk    V .Rj / D :
                                            V .R/
                                                      j D1

Hence, f is integrable on R, by Theorem 7.1.12.

Sets with Zero Content

                                                                           R
The next definition will enable us to establish the existence of R f .X/ d X in cases where
f is bounded on the rectangle R, but is not necessarily continuous for all X in R.

Definition 7.1.14 A subset E of Rn has zero content if for each                               > 0 there is a finite
set of rectangles T1, T2, . . . , Tm such that                                                             (7.1.24)
                                                                                                           (7.1.25)
                                          E     [m    Tj

                                                j D1

and
                                             X m
                                                  V .Tj / < :

                                                                j D1

Example 7.1.3 Since the empty set is contained in every rectangle, the empty set has
zero content. If E consists of finitely many points X1, X2, . . . , Xm, then Xj can be enclosed
in a rectangle Tj such that

                                     V .Tj / < m ; 1 Ä j Ä m:
Then (7.1.24) and (7.1.25) hold, so E has zero content.
                            Section 7.1 Definition and Existence of the Multiple Integral 449

Example 7.1.4 Any bounded set E with only finitely many limit points has zero con-
tent. To see this, we first observe that if E has no limit points, then it must be finite, by the

Bolzano-Weierstrass theorem (Theorem 1.3.8), and therefore must have zero content, by

Example 7.1.3. Now suppose that the limit points of E are X1, X2, . . . , Xm. Let R1, R2,
. . . , Rm be rectangles such that Xi 2 R0i and

                                     V .Ri / < 2m; 1 Ä i Ä m:                        (7.1.26)

The set of points of E that are not in [mj D1Rj has no limit points (why?) and, being
bounded, must be finite (again by the Bolzano-Weierstrass theorem). If this set contains p

points,  then  it  can  be  covered  by  rectangles  R10 ,  R20 ,  ...,  R0    with

                                                                            p

                                     V .Rj0 / < 2p ; 1 Ä j Ä p:                      (7.1.27)

Now,                                       [m ! [ [ 0 p 1

                                     E           Ri         @ R0 A

                                                                         j

                                           i D1             j D1

and, from (7.1.26) and (7.1.27),

                                     X m             Xp
                                           V .Ri / C V .Rj0 / < :

                                     i D1            j D1

Example 7.1.5 If f is continuous on OEa; b, then the curve

                                       y D f .x/; a Ä x Ä b                              (7.1.28)
(that is, the set °.x; y/  y D f .x/; a Ä x Ä b«/, has zero content in R2.           To see this,

suppose that > 0, and choose i > 0 such that

         jf .x/ f .x0/j < if x; x0 2 OEa; b and jx x0j < i:                          (7.1.29)

This is possible because f is uniformly continuous on OEa; b (Theorem 2.2.12). Let

                            P W a D x0 < x1 < < xn D b

be a partition of OEa; b with kP k < i, and choose 1, 2, . . . , n so that
                                    xi 1 Ä i Ä xi ; 1 Ä i Ä n:

Then, from (7.1.29),

                            jf .x/ f . i /j < if xi 1 Ä x Ä xi :

This means that every point on the curve (7.1.28) above the interval OExi 1; xi  is in a rect-
angle with area 2 .xi xi 1/ (Figure 7.1.4). Since the total area of these rectangles is
2 .b a/, the curve has zero content.
450 Chapter 7 Integrals of Functions of Several Variables

                     y

                                                                                                y = f (i) +
                                                                                                y = f (i)
                                                                                                y = f (i) -

                    a     xi-1              xi                                      x
                                                            b

                                         i

                                      Figure 7.1.4

The next lemma follows immediately from Definition 7.1.14.

Lemma 7.1.15 The union of finitely many sets with zero content has zero content:

   The following theorem will enable us to define multiple integrals over more general
subsets of Rn.

Theorem 7.1.16 Suppose that f is bounded on a rectangle

                       R D OEa1; b1 OEa2; b2             OEan; bn                                            (7.1.30)

and continuous except on a subset E of R with zero content: Then f is integrable on R:

Proof Suppose that     > 0. Since E has zero content, there are rectangles T1, T2, . . . ,
Tm such that
                                            [m
                                      E           Tj
                                                                                                             (7.1.31)

                                            j D1

and                                   X m

                                            V .Tj / < :                                                      (7.1.32)

                                      j D1

We may assume that T1, T2, . . . , Tm are contained in R, since, if not, their intersections

with R would be contained in R, and still satisfy (7.1.31) and (7.1.32). We may also assume

that if T is any rectangle such that
                       0              1
                       \ [m
     T @ T 0j A D ;; then T \ E D ;
                                                                                                             (7.1.33)

                          j D1
                           Section 7.1 Definition and Existence of the Multiple Integral 451

since if this were not so, we could make it so by enlarging T1, T2, . . . , Tm slightly while
maintaining (7.1.32). Now suppose that

                      Tj D OEa1j ; b1j  OEa2j ; b2j            OEanj ; bnj ; 1 Ä j Ä m;

let Pi0 be the partition of OEai ; bi  (see (7.1.30)) with partition points

                           ai ; bi ; ai1; bi1; ai2; bi2; : : : ; aim; bim

(these are not in increasing order), 1 Ä i Ä n, and let

                                      P0 D P10 P20                     Pn0:

Then P0 consists of rectangles whose union equals [mj D1Tj and other rectangles T10, T20,
      T 0k                                                                         T0
...,        that  do  not  intersect  E.  (We  need  (7.1.33)  to  be  sure  that       \  E  D  ;; 1  Ä  i  Ä  k:/
                                                                                     i

If we let                                 [m                       [k

                                      B D Tj and C D Ti0;

                                          j D1                     i D1

then R D B [ C and f is continuous on the compact set C . If P D fR1; R2; : : : ; Rkg is
a refinement of P0, then every subrectangle Rj of P is contained entirely in B or entirely
in C . Therefore, we can write

            S.P / s.P / D 1.Mj mj /V .Rj / C 2.Mj mj /V .Rj /;                                            (7.1.34)

where 1 and 2 are summations over values of j for which Rj B and Rj C ,
respectively. Now suppose that

                                          jf .X/j Ä M for X in R:

Then                                                                   X m                                (7.1.35)
         1.Mj              mj /V .Rj / Ä 2M 1V .Rj / D 2M V .Tj / < 2M ;

                                                                                          j D1

from (7.1.32). Since f is uniformly continuous on the compact set C (Theorem 5.2.14),
there is a i > 0 such that Mj mj < if kP k < i and Rj C ; hence,

                           2.Mj mj /V .Rj / < 2 V .Rj / Ä V .R/:

This, (7.1.34), and (7.1.35) imply that

                                      S.P / s.P / < OE2M C V .R/

if kP k < i and P is a refinement of P0. Therefore, Theorem 7.1.12 implies that f is
integrable on R.
452 Chapter 7 Integrals of Functions of Several Variables

Example 7.1.6 The function                            0 Ä x < y Ä 1;
                                            (         0 Ä y Ä x Ä 1;
                                              x C y;

                              f .x; y/ D
                                              5;

is continuous on R D OE0; 1 OE0; 1 except on the line segment

                                  y D x; 0 Ä x Ä 1

(Figure 7.1.5). Since the line segment has zero content (Example 7.1.5), f is integrable on
R.

                         y

                                                            y = x

1
     f (x, y) = x + y

                                  f (x, y) = 5

                                                                                          x
                                                      1

                                  Figure 7.1.5

Integrals over More General Subsets of Rn
We can now define the integral of a bounded function over more general subsets of Rn.

Definition 7.1.17 Suppose that f is bounded on a bounded subset of S of Rn, and let

                                        (                   X 2 S;                           (7.1.36)
                                          f .X/;            X 62 S:

                            fS .X/ D
                                          0;

Let R be a rectangle containing S . Then the integral of f over S is defined to be

                            Z                         Z

                                  f .X/ d X D fS .X/ d X

  R                            S                         R
if R fS .X/ d X exists.
Section 7.1 Definition and Existence of the Multiple Integral 453

   To see that this definitiRon makes sense, we must show thatRif R1 and R2 are two rect-
angles containing S and R1 fS .X/ d X exists, then so does R2 fS .X/ dX, and the two
integrals are equal. The proof of this is sketched in Exercise 7.1.27.

Definition 7.1.18 If S isRa bounded subset of Rn and the integral S R d X (with inte-
grand f Á 1) exists, we call S d X the content (also, area if n D 2 or volume if n D 3)
of S , and denote it by V .S /; thus,

                                                       Z
                                            V .S / D d X:

                                                                                 S

Theorem 7.1.19 Suppose that f is bounded on a bounded set S and continuous ex-
cept on a subset E of S with zero content. Suppose also that @S has zero content: Then f
is integrable on S:

Proof Let fS be as in (7.1.36). Since a discontinuity of fS is either a discontinuity of f
or a point of @S , the set of discontinuities of fS is the union of two sets of zero content and
therefore is of zero content (Lemma 7.1.15). Therefore, fS is integrable on any rectangle
containing S (from Theorem 7.1.16), and consequently on S (Definition 7.1.17).

Differentiable Surfaces

Differentiable surfaces, defined as follows, form an important class of sets of zero content
in Rn.

Definition 7.1.20 A differentiable surface S in Rn .n > 1/ is the image of a compact
subset D of Rm, where m < n, under a continuously differentiable transformation G W

Rm ! Rn. If m D 1, S is also called a differentiable curve.

Example 7.1.7 The circle

                          °.x; y/  x2 C y2 D 9«

is a differentiable curve in R2, since it is the image of D D OE0; 2   under the continuously
differentiable transformation G W R ! R2 defined by

                                                       Ä
                                      X D G.Â/ D 3 cos Â :

                                                          3 sin Â

Example 7.1.8 The sphere
                                   °.x; y; ´/  x2 C y2 C ´2 D 4«

is a differentiable surface in R3, since it is the image of

D D .Â; /  0 Ä Â Ä 2 ; =2 Ä°                                         «
                                                             Ä =2

under the continuously differentiable transformation G W R2 ! R3 defined by

                            2  2 cos Â cos                   3

X D G.Â; / D 4 2 sin Â cos 5 :

                               2 sin
454 Chapter 7 Integrals of Functions of Several Variables

Example 7.1.9 The set
             
°.x1; x2; x3; x4/  xi                                                         «
                       0 .i D 1; 2; 3; 4/; x1 C x2 D 1; x3 C x4 D 1

is a differentiable surface in R4, since it is the image of D D OE0; 1  OE0; 1 under the

continuously differentiable transformation G W R2 ! R4 defined by

                                                 2  u   3

                       X D G.u; v/ D 66 1 u 7 4 75 :v

                                                    1v

Theorem 7.1.21 A differentiable surface in Rn has zero content:

Proof Let S , D, and G be as in Definition 7.1.20. From Lemma 6.2.7, there is a
constant M such that

             jG.X/ G.Y/j Ä M jX Yj if X; Y 2 D:                                  (7.1.37)

Since D is bounded, D is contained in a cube

             C D OEa1; b1 OEa2; b2                      OEam; bm;

where
                                     bi ai D L; 1 Ä i Ä m:

Suppose that we partition C into N m smaller cubes by partitioning each of the intervals
OEai ; bi  into N equal subintervals. Let R1, R2, . . . , Rk be the smaller cubes so produced that
contain points of D, and select points X1, X2, . . . , Xk such that Xi 2 D \ Ri , 1 Ä i Ä k.
If Y 2 D \ Ri , then (7.1.37) implies that

                       jG.Xi / G.Y/j Ä M jXi Yj:                                 (7.1.38)

Since Xi and Y are both in the cube Ri with edge length L=N ,
                                                            p

                                                          Lm
                                          jXi Yj Ä N :

This and (7.1.38) imply that                            MLpm
                                    jG.Xi /  G.Y/j Ä N ;

which in turnpimplies that G.Y/ lies in a cube eRi in Rn centered at G.Xi /, with sides of
length 2ML m=N . Now

Xk e         Â 2MLpm Ãn m Â 2MLpm Ãn                               p n mn
V .Ri / D k                                  ÄN               D .2ML m/ N :
iD1 N N

Since n > m, we can make the sum on the left arbitrarily small by taking N sufficiently
large. Therefore, S has zero content.

   Theorems 7.1.19 and 7.1.21 imply the following theorem.
                           Section 7.1 Definition and Existence of the Multiple Integral 455
Theorem 7.1.22 Suppose that S is a bounded set in Rn; with boundary consisting of
a finite number of differentiable surfaces: Let f be bounded on S and continuous except
on a set of zero content. Then f is integrable on S:
Example 7.1.10 Let

                                S D °.x; y/  x2 C y2 D 1; x 0« I
thus, S is bounded by a semicircle and a line segment (Figure 7.1.6), both differentiable
curves in R2. Let

                                  ( .1 x2 y2/1=2; .x; y/ 2 S; y 0;
                    f .x; y/ D

                                      .1 x2 y2/1=2; .x; y/ 2 S; y < 0:
Then f is continous on S except on the line segment

                                         y D 0; 0 Ä x < 1;
which has zero content, from Example 7.1.5. Hence, Theorem 7.1.22 implies that f is
integrable on S .

                                                               y

                                                                              x2 + y2 = 1, x  0
                                                                                                 x

                                        Figure 7.1.6

Properties of Multiple Integrals
We now list some theorems on properties of multiple integrals. The proofs are similar to
those of the analogous theorems in Section 3.3.

   Note: Because of Definition 7.1.17, if we say that a function f is integrable on a set S ,
then S is necessarily bounded.
456 Chapter 7 Integrals of Functions of Several Variables

Theorem 7.1.23 If f and g are integrable on S; then so is f C g; and

        Z                           Z                           Z

                     .f C g/.X/ d X D f .X/ d X C g.X/ d X:

           S                           S                           S

Proof Exercise 7.1.20.

Theorem 7.1.24 If f is integrable on S and c is a constant; then cf is integrable on

S; and                     Z                        Z

                                 .cf /.X/ d X D c f .X/ d X:

                              S                        S

Proof Exercise 7.1.21.

Theorem 7.1.25 If f and g are integrable on S and f .X/ Ä g.X/ for X in S; then

                              Z                  Z

                                    f .X/ d X Ä g.X/ d X:

                                 S                  S

Proof Exercise 7.1.22.

Theorem 7.1.26 If f is integrable on S; then so is jf j; and

                           Z        Z

                                    f .X/ d X Ä        jf .X/j d X:
                           
                                 S               S

Proof Exercise 7.1.23.

Theorem 7.1.27 If f and g are integrable on S; then so is the product fg:

Proof Exercise 7.1.24.

Theorem 7.1.28       Suppose that u is continuous and v is integrable and nonnegative on
a rectangle R: Then
                     Z                                    Z
for some X0 in R:
                           u.X/v.X/ d X D u.X0/ v.X/ d X

                        R                                    R

Proof Exercise 7.1.25.

Lemma 7.1.29 Suppose that S is contained in a bounded set T           and f  is integrable

on S: Then fS .see (7.1.36)/ is integrable on T; and

                              Z                  Z

                                    fS .X/ d X D f .X/ d X:

                                 T                  S

Proof From Definition 7.1.17 with f and S replaced by fS and T ,
                       Section 7.1 Definition and Existence of the Multiple Integral 457

                            .fS /T .X/ D fS .X/; X 2 T;
                                      0;          X 62 T:

Since S T , .fS /T D fS . (Verify.) Now suppose that R is a rectangle containing T .
Then R also contains S (Figure 7.1.7),

                                                            R
                                                  T

                                 Figure 7.1.7

so  Z                  Z

         f .X/ d X D fS .X/ d X       (Definition 7.1.17, applied to f and S /
       S ZR                           (since .fS /T D fS )
                                      (Definition 7.1.17, applied to fS and T /;
                 D .fS /T .X/ d X
                    ZR

                 D fS .X/ d X

                       T

which completes the proof.

Theorem 7.1.30 If f is integrable on disjoint sets S1 and S2; then f is integrable on

S1 [ S2; and     Z                 Z              Z

                            f .X/ d X D f .X/ d X C f .X/ d X:          (7.1.39)

                    S1 [S2            S1             S2

Proof For i D 1, 2, let                 (
                                          f .X/;
                                                  X 2 Si ;
                            fSi .X/ D             X 62 Si :
                                          0;

From Lemma 7.1.29 with S D Si and T D S1 [ S2, fSi is integrable on S1 [ S2, and
                    Z                 Z

                    S1 [S2  fSi .X/ d X D f .X/ d X; i D 1; 2:
                                          Si

Theorem 7.1.23 now implies that fS1 C fS2 is integrable on S1 [ S2 and
       Z                           Z              Z

                 .fS1 C fS2/.X/ d X D f .X/ d X C f .X/ d X:            (7.1.40)

          S1[S2                       S1                     S2
458 Chapter 7 Integrals of Functions of Several Variables

Since S1 \ S2 D ;,

                fS1 C fS2 .X/ D fS1 .X/ C fS2 .X/ D f .X/; X 2 S1 [ S2:
Therefore, (7.1.40) implies (7.1.39).

  We leave it to you to prove the following extension of Theorem 7.1.30. (Exercise 7.1.31(b)).

Corollary 7.1.31 Suppose that f is integrable on sets S1 and S2 such that S1 \ S2

has zero content: Then f is integrable on S1 [ S2; and

                     Z                      Z                 Z

                             f .X/ d X D f .X/ d X C f .X/ d X:

                     S1 [S2                    S1                S2

Example 7.1.11 Let

                        S1 D .x; y/  0 Ä x Ä 1; 0 Ä y Ä 1 C x°       «

and °  «
                            S2 D .x; y/  1 Ä x Ä 0; 0 Ä y Ä 1 x

(Figure 7.1.8).

                                               y

                                 y = 1 - x         y = 1 + x

                                               S

                             -1                               1         x

                                      Figure 7.1.8

Then                                        °                    «
                             S1 \ S2 D .0; y/  0 Ä y Ä 1

has zero content. Hence, Corollary 7.1.31 implies that if f is integrable on S1 and S2, then

f is also integrable over

                 S D S1 [ S2 D .x; y/  1 Ä x Ä 1; 0 Ä y Ä 1 C jxj°         «

(Figure 7.1.9), and

                     Z                      Z                 Z

                             f .X/ d X D f .X/ d X C f .X/ d X:

                     S1 [S2                    S1                S2
          Section 7.1 Definition and Existence of the Multiple Integral 459

       y                                                              y

          y = 1 + x                                        y = 1 - x

             S1                                            S2

                           x                                                 x

                                     Figure 7.1.9
We will discuss this example further in the next section.

                                     7.1 Exercises

                                                                                R
1. Prove: If R is degenerate, then Definition 7.1.2 implies that R f .X/ d X D 0 if f

      is bounded on R.

2. Evaluate directly from Definition 7.1.2.
             R

     (a) R.3x C 2y/ d.x; y/; R D OE0; 2 OE1; 3
              R

     (b) R xy d.x; y/; R D OE0; 1 OE0; 1
3. Suppose that a R b f .x/ dx anRd c R d g.y/ dy exist, and let R D OEa; b OEc; d . Criticize

      the following "proof" that R f .x/g.y/ d.x; y/ exists and equals
                                      Zb ! Zd !

                           f .x/ dx          g.y/ dy :

                        a                 c

(See Exercise 7.1.30 for a correct proof of this assertion.)
"Proof." Let

P1 W a D x0 < x1 < < xr D b and P2 W c D y0 < y1 < < ys D d

be partitions of OEa; b and OEc; d , and P D P1 P2. Then a typical Riemann sum of
fg over P is of the form

          D  Xr Xs      f . i /g.Áj /.xi  xi 1/.yj             yj 1/ D 1 2;

             i D1 j D1

where

            Xr             xi 1/ and              Xs                     yj 1/
       1 D f . i /.xi                        2 D g.Áj /.yj

               i D1                                  j D1
460 Chapter 7 Integrals of Functions of Several Variables

are typical Riemann sums of f over OEa; b and g over OEc; d . Since f and g are

integrable on these intervals,

             Z b     Z d 
            1                            f .x/ dx and  2      g.y/ dy
                                                                     
                 a                                         c

can be made arbitrarily small by taking kP1k and kP2k sufficiently small.          From

this, it is straightforward to show that

                Z b ! Z d !
                                            f .x/ dx      g.y/ dy 
                                                                  
                                         a            c

can be made arbitrarily small by taking kP k sufficiently small. This implies the
stated result.

4. RSuppose that f .x; y/ 0 on R D OEa; b OEc; d . Justify the interpretation of
       R f .x; y/ d.x; y/, if it exists, as the volume of the region in R3 bounded by the
      surfaces ´ D f .x; y/ and the planes ´ D 0, x D a, x D b, y D c, and y D d .

5. Prove Theorem 7.1.5. HINT: See the proof of Theorem 3.1.4:

6. Suppose that                             if x and y are rational,
                                    8       if x is rational and y is irrational,
                                    ^^0     if x is irrational and y is rational,
                                    <       if x and y are irrational.
                                      1

                      f .x; y/ D ^^2
                                    :
                                      3

Find

      Z                                     Z

            f .x; y/ d.x; y/ and f .x; y/ d.x; y/ if R D OEa; b OEc; d :

         R                                     R

 7. Prove Eqn. (7.1.17) of Lemma 7.1.6.
 8. Prove Theorem 7.1.7 HINT: See the proof of Theorem 3.2.2:
 9. Prove Theorem 7.1.8 HINT: See the proof of Theorem 3.2.3:
10. Prove Lemma 7.1.9 HINT: See the proof of Lemma 3.2.4:
11. Prove Theorem 7.1.10 HINT: See the proof of Theorem 3.2.5:
12. Prove Theorem 7.1.12 HINT: See the proof of Theorem 3.2.7:
13. Give an example of a denumerable set in R2 that does not have zero content.
14. Prove:

       (a) If S1 and S2 have zero content, then S1 [ S2 has zero content.
       (b) If S1 has zero content and S2 S1, then S2 has zero content.
       (c) If S has zero content, then S has zero content.
15. Show that a degenerate rectangle has zero content.
       Section 7.1 Definition and Existence of the Multiple Integral 461

16. Suppose that f is continuous on a compact set S in Rn. Show that the surface
        ´ D f .X/, X 2 S , has zero content in RnC1. HINT: See Example 7.1.5:

17. Let S be a bounded set such that S \ @S does not have zero content.

(a) Suppose that f is defined on S and f .X/ > 0 on a subset T of S \ @S
      that does not have zero content. Show that f is not integrable on S .

(b) Conclude that V .S / is undefined.

18. (a) Suppose thRat h is bounded and h.X/ D 0 except on a set of zero content.
               Show that S h.X/ d X D 0 for any bounded set S .
                               R

       (b) Suppose that S f .X/ d X exists, g is bounded on S , and f .X/ D g.X/ except

for X in a set of zero content. Show that g is integrable on S and

                                 Z            Z

                                       g.X/ d X D f .X/ d X:

                                    S         S

19. Suppose that f is integrable on a set S and S0 is a subset of S such that @S0 has
        zero content. Show that f is integrable on S0.

20. Prove Theorem 7.1.23 HINT: See the proof of Theorem 3.3.1:

21. Prove Theorem 7.1.24.

22. Prove Theorem 7.1.25 HINT: See the proof of Theorem 3.3.4:

23. Prove Theorem 7.1.26 HINT: See the proof of Theorem 3.3.5:

24. Prove Theorem 7.1.27 HINT: See the proof of Theorem 3.3.6:

25. Prove Theorem 7.1.28 HINT: See the proof of Theorem 3.3.7:

26. Prove: If f is integrable on a rectangle R, then f is integrable on any subrectangle
        of R. HINT: Use Theorem 7.1.12I see the proof of Theorem 3.3.8:

27. Suppose that R and eR are rectangles, R eR, g is bounded on Re, and g.X/ D 0 if

X 62 R. R R
(a) Show that eR g.X/ d X exists if and only if R g.X/ d X exists and, in this
case,
                                 Z            Z

                                 eR    g.X/ d X D g.X/ d X:

                                                 R

HINT: Use Exercise 7.1.26:

(b) Use (a)Rto show that Definition 7.1.17 is legitimate; that is, the existence and
      value of S f .X/ d X does not depend on the particular rectangle chosen to
      contain S .

28. (a) Suppose that f is integrable on a rectangle R and P D fR1; R2; : : : ; Rkg is
               a partition of R. Show that

                           Z                  Xk Z

                                 f .X/ d X D           f .X/ d X:

                              R               j D1 Rj

HINT: Use Exercise 7.1.26:
462 Chapter 7 Integrals of Functions of Several Variables

(b) Use (a) to show that if f is continuous on R anRd P is a partition of R, then
      there is a Riemann sum of f over P that equals R f .X/ d X.

29. Suppose that f is continuously differentiable on a rectangle R. Show that there is a

constant M such that     Z           

                            R  f .X/ d X Ä M kP k
                         

if is any Riemann sum of f over a partition P of R. HINT: Use Exercise 7.1.28.b/

        and Theorem 5.4.5:
30. Suppose that a R b f .x/ dx and c R d g.y/ dy exist, and let R D OEa; b OEc; d .

(a) Use Theorems 3.2.7 and 7.1.12 to show that

                      Z                       Z

                           f .x/ d.x; y/ and                    g.y/ d.x; y/

                         R                                    R

      both exist. R
(b) Use Theorem 7.1.27 to prove that R f .x/g.y/ d.x; y/ exists.

(c) Justify using the argument given in Exercise 7.1.3 to show that

Z                                 Zb                          ! Zd !

      f .x/g.y/ d.x; y/ D                     f .x/ dx              g.y/ dy :

   R                              a                              c

31. (a) Suppose that f is integrable on S and S0 is obtained by reRmoving a set of
               zero content from S . Show that f is integrable on S0 and S0 f .X/ d X D
               R
                S f .X/ d X.

       (b) Prove Corollary 7.1.31.

7.2 ITERATED INTEGRALS AND MULTIPLE INTEGRALS

Except for very simple examples, it is impractical to evaluate multiple integrals directly
from Definitions 7.1.2 and 7.1.17. Fortunately, this can usually be accomplished by evalu-
ating n successive ordinary integrals. To motivate the method, let us first assume that f is
continuous on R D OEa; b OEc; d . Then, for each y in OEc; d , f .x; y/ is continuous with
respect to x on OEa; b, so the integral

                                                  Zb
                                        F .y/ D f .x; y/ dx

                                                                          a

exists. Moreover, the uniform continuity of f on R implies that F is continuous (Exer-

cise 7.2.3) and therefore integrable on OEc; d . We say that

      Zd                       Zd Zb                          !

I1 D F .y/ dy D                               f .x; y/ dx dy

      c                        c  a
                               Section 7.2 Iterated Integrals and Multiple Integrals 463

is an iterated integral of f over R. We will usually write it as

                                  Zd Zb

                               I1 D dy f .x; y/ dx:

                                  c                a

Another iterated integral can be defined by writing             a Ä x Ä b;

                                         Zd
                               G.x/ D f .x; y/ dy;

                                                             c

and defining               Zb                   Zb     Zd !
                                                            f .x; y/ dy dx;
                  I2 D G.x/ dx D
                                                         c
                           a                    a

which we usually write as

                                  Zb Zd

                               I2 D dx f .x; y/ dy:

                                  a                c

Example 7.2.1 Let

                                  f .x; y/ D x C y

 and R D OE0; 1 OE1; 2. Then
                     Z 1 Z 1 Â x2 Ã 1  1

           0 0 F .y/ D f .x; y/ dx D .x C y/ dx D 2 xD0 C xy  D 2 C y
and

                     Z 2 Z 2 Â 1 Ã Â y y2 Ã 2 
               1 1 I1 D F .y/ dy D 2 C y dy D 2 C 2 1 D 2:

Also,

              Z2               Â                2 Ã 2                       Â 1Ã 3
                                             y                                x C 2 D x C 2;
G.x/ D            .x C y/ dy D xy C                    D .2x C 2/
                                     2 yD1      
              1

and
                 Z 1 Z 1 Â 3 Ã Â x2 3x Ã 1 

          0 0 I2 D G.x/ dx D x C 2 dx D 2 C 2 0 D 2:

   In this example, I1 D I2; moreover, on setting a D 0, b D 1, c D 1, and d D 2 in
Example 7.1.1, we see that Z

                                           .x C y/ d.x; y/ D 2;

                                                           R

so the common value of the iterated integrals equals the multiple integral. The following
theorem shows that this is not an accident.
464 Chapter 7 Integrals of Functions of Several Variables

Theorem 7.2.1 Suppose that f is integrable on R D OEa; b                     OEc; d  and

                                                  Zb
                                        F .y/ D f .x; y/ dx

                                                                          a

exists for each y in OEc; d : Then F is integrable on OEc; d ; and

                               Zd          Z

                                     F .y/ dy D f .x; y/ d.x; y/I                              (7.2.1)
                                                                                               (7.2.2)
                               c              R

that is;                    Zd Zb                Z

                               dy f .x; y/ dx D f .x; y/ d.x; y/:

                            c        a              R

Proof Let

      P1 W a D x0 < x1 < < xr D b and P2 W c D y0 < y1 < < ys D d

be partitions of OEa; b and OEc; d , and P D P1 P2. Suppose that

                                  yj 1 Ä Áj Ä yj ; 1 Ä j Ä s;                                  (7.2.3)

so                                                                                             (7.2.4)
                                           Xs

                                        D F .Áj /.yj yj 1/

                                                              j D1

is a typical Riemann sum of F over P2. Since

                                  Zb             Xr Z x

           F .Áj / D f .x; Áj / dx D                        f .x; Áj / dx;

                                  a              i D1 xi 1

(7.2.3) implies that if

           mij D inf f .x; y/  xi 1 Ä x Ä xi ; yj 1 Ä y Ä yj°                «

and °  «
                      Mij D sup f .x; y/  xi 1 Ä x Ä xi ; yj 1 Ä y Ä yj ;

then       Xr                                       Xr

                            mij .xi xi 1/ Ä F .Áj / Ä Mij .xi xi 1/:

           i D1                                     i D1

Multiplying this by yj yj 1 and summing from j D 1 to j D s yields

          Xs Xr                xi 1/.yj             Xs              yj 1/
                   mij .xi               yj 1/ Ä F .Áj /.yj

          j D1 i D1                           j D1

                                           Ä  Xs Xr      Mij .xi             xi 1/.yj  yj 1/;

                                              j D1 i D1
                                 Section 7.2 Iterated Integrals and Multiple Integrals 465

which, from (7.2.4), can be rewritten as

                                 sf .P/ Ä Ä Sf .P/;                           (7.2.5)

where sf .P/ and Sf .P/ are the lower and upper sums of f over P. Now let sF .P2/ and
SF .P2/ be the lower and upper sums of F over P2; since they are respectively the infimum
and supremum of the Riemann sums of F over P2 (Theorem 3.1.4), (7.2.5) implies that

                              sf .P/ Ä sF .P2/ Ä SF .P2/ Ä Sf .P/:            (7.2.6)

Since f is integrable on R, there is for each > 0 a partition P of R such that Sf .P/

sf .P/ < , from Theorem 7.1.12. Consequently, from (7.2.6), there is a partition P2 of

OEc; d  such that SF .P2/ sF .P2/ < , so F is integrable on OEc; d , from Theorem 3.2.7.
   It remains to verify (7.2.1). From (7.2.4) and the definition of c R d F .y/ dy, there is for

each > 0 a i > 0 such that

                           Z d 
                            F .y/ dy  < if kP2k < iI
                           c              

that is,                         Zd

                              < F .y/ dy < C if                 kP2k < i:
                                                                 if kPk < i;
                                    c

This and (7.2.5) imply that

          sf .P/                    Zd

                                 < F .y/ dy < Sf .P/ C

                                       c

and this implies that            Zd                       Z

          Z                      Ä F .y/ dy Ä f .x; y/ d.x; y/ C              (7.2.7)
              f .x; y/ d.x; y/
                                 c                           R
                 R

(Definition 7.1.4). Since

                           Z                        Z

                                 f .x; y/ d.x; y/ D f .x; y/ d.x; y/

                              R                        R

(Theorem 7.1.8) and can be made arbitrarily small, (7.2.7) implies (7.2.1).

   If f is continuous on R, then f satisfies the hypotheses of Theorem 7.2.1 (Exercise 7.2.3),
so (7.2.2) is valid in this case.

     R
   If R f .x; y/ d.x; y/ and

                                 Zd                    a Ä x Ä b;

                                      f .x; y/ dy;

                                   c
466 Chapter 7 Integrals of Functions of Several Variables

exist, then by interchanging x and y in Theorem 7.2.1, we see that

      Zb Zd                             Z

            dx f .x; y/ dy D f .x; y/ d.x; y/:

         a     c                           R

This and (7.2.2) yield the following corollary of Theorem 7.2.1.

Corollary 7.2.2 If f is integrable on OEa; b OEc; d ; then

      Zb Zd                             Zd Zb

         dx f .x; y/ dy D dy f .x; y/ dx;

      a     c                           c             a

provided that c R d f .x; y/ dy exists for a Ä x Ä b and a R b f .x; y/ dx exists for c Ä y Ä d:
In particular; these hypotheses hold if f is continuous on OEa; b OEc; d :

Example 7.2.2 The function

                                    f .x; y/ D x C y

is continuous everywhere, so (7.2.2) holds for every rectangle R. For example, let R D

OE0; 1 OE1; 2. Then (7.2.2) yields

Z           Z2 Z1                                     Z 2 "Â 2          Ã 1 #
                                                              x
      .x C y/ d.x; y/ D dy .x C y/ dx D                           C xy         dy
                                                              2         
   R           1                    0                 1                   xD0

            Z 2 Â1 Ã                       Â y y2 Ã 2 
            1 D 2 C y dy D 2 C 2 1 D 2:

Since f also satisfies the hypotheses of Theorem 7.2.1 with x and y interchanged, we

can calculate the double integral from the iterated integral in which the integrations are

performed in the opposite order; thus,

Z           Z1 Z2                                     Z 1 "Â        2 Ã 2 #
                                                                    y
      .x C y/ d.x; y/ D dx .x C y/ dy D                     xy C               dx
                                                                    2 yD1
   R           0                    1                 0

            Z 1Â 3Ã                        Â x2 3x Ã 1 
            0 D x C 2 dx D 2 C 2 0 D 2:

                                                                                   Rd Rb
   A plausible partRial converse of Theorem 7.2.1 would be that if c dy a f .x; y/ dx
exists then so does R f .x; y/ d.x; y/; however, the next example shows that this need not
be so.

Example 7.2.3 If f is defined on R D OE0; 1 OE0; 1 by

                                f .x; y/ D 2xy if y is rational;
                                               y if y is irrational;
                                     Section 7.2 Iterated Integrals and Multiple Integrals 467

then                           Z1                                  0 Ä y Ä 1;
and
However, f                         f .x; y/ dx D y;

                                 0

                            Z1 Z1                                  Z1 1

                               0 0 0 dy f .x; y/ dx D y dy D 2 :

            is not integrable on R (Exercise 7.2.7).

    The next theorem generalizes Theorem 7.2.1 to Rn.

Theorem 7.2.3 Let I1; I2; . . . ; In be closed intervals and suppose that f is integrable

on R D I1 I2                In: Suppose that there is an integer p in f1; 2; : : : ; n 1g such that
                                         Z

       Fp.xpC1 ; xpC2; : : : ; xn/ D                                  f .x1; x2; : : : ; xn/ d.x1; x2; : : : ; xp/

                                                          I1 I2    Ip

exists for each .xpC1; xpC2; : : : ; xn/ in IpC1 IpC2              In: Then
             Z

                                   Fp.xpC1; xpC2; : : : ; xn/ d.xpC1 ; xpC2; : : : ; xn/

            IpC1 IpC2          In
                  R
exists and equals R f .X/ d X.

Proof For convenience, denote .xpC1; xpC2; : : : ; xn/ by Y. Denote Rb D I1 I2

Ip and T D IpC1 IpC2                 In. Let bP D fRb1; bR2; : : : ; bRkg and Q D fT1; T2; : : : ; Tsg

be partitions of bR and T , respectively. Then the collection of rectangles of the form bRi Tj

(1 Ä i Ä k, 1 Ä j Ä s) is a partition P of R; moreover, every partition P of R is of this

form.

    Suppose that

                                         Yj 2 Tj ; 1 Ä j Ä s;                                   (7.2.8)

so                                       Xs

                                         D Fp.Yj /V .Tj /                                       (7.2.9)

                                         j D1

is a typical Riemann sum of Fp over Q. Since
                              Z

            Fp.Yj/ D f .x1; x2; : : : ; xp; Yj / d.x1; x2; : : : ; xp/
                               bR
                               Xk Z
                            D            f .x1; x2; : : : ; xp; Yj / d.x1; x2; : : : ; xp/;
                               j D1 bRj

(7.2.8) implies that if  n                                                                   o

       mij D inf f .x1; x2; : : : ; xp; Y/  .x1; x2; : : : ; xp/ 2 bRi ; Y 2 Tj

and n                                                                                        o
       Mij D sup f .x1; x2; : : : ; xp; Y/  .x1; x2; : : : ; xp/ 2 Rbi ; Y 2 Tj ;
468 Chapter 7 Integrals of Functions of Several Variables

then                         Xk                                 Xk

                                   mij V .Rbi / Ä Fp.Yj/ Ä Mij V .Rbi /:

                             i D1                               i D1

Multiplying this by V .Tj / and summing from j D 1 to j D s yields

          Xs Xk                                Xs                        Xs Xk
                     mij V .Rbi /V .Tj / Ä Fp.Yj /V .Tj / Ä                         Mij V .Rbi /V .Tj /;

          j D1 i D1                            j D1                      j D1 i D1

which, from (7.2.9), can be rewritten as

                                            sf .P/ Ä Ä Sf .P/;                           (7.2.10)

where sf .P/ and Sf .P/ are the lower and upper sums of f over P. Now let sFp .Q/ and
SFp.Q/ be the lower and upper sums of Fp over Q; since they are respectively the infimum
and supremum of the Riemann sums of Fp over Q (Theorem 7.1.5), (7.2.10) implies that

                                  sf .P/ Ä sFp .Q/ Ä SFp .Q/ Ä Sf .P/:                   (7.2.11)

Since f is integrable on R, there is for each > 0 a partition P of R such that Sf .P/
sf .P/ < , from Theorem 7.1.12. Consequently, from (7.2.11), there is a partition Q of T
such that SFp .Q/ sFp .Q/ < , so Fp is integrable on T , from Theorem 7.1.12.

It remains to verify that

                                      Z                   Z

                                            f .X/ d X D Fp.Y/ d Y:                                   (7.2.12)
                                                                                    > 0 a i > 0 such that
                                         R  R                T

From (7.2.9) and the definition of T Fp.Y/ d Y, there is for each
                                Z                       
                                                        
                                      Fp.Y/ d Y           <     if kQk < iI
                                                        
                                   T

that is,                              Z

                                   < Fp.Y/ d Y < C if                       kQk < i:
                                                                            if kPk < i;
                                         T

This and (7.2.10) imply that
                                    Z

                     sf .P/        < Fp.Y/ d Y < Sf .P/ C

                                         T

and this implies that

                     Z                         Z                      Z

                          f .X/ d X            Ä Fp.Y/ d Y Ä f .X/ d X C :               (7.2.13)

                        R                            T                   R

      Z                      Z

Since f .X/ d X D f .X/ d X (Theorem 7.1.8) and                             can be made arbitrarily small,

          R                     R

(7.2.13) implies (7.2.12).
                                  Section 7.2 Iterated Integrals and Multiple Integrals 469

Theorem 7.2.4 Let Ij D OEaj ; bj ; 1 Ä j Ä n, and suppose that f is integrable on

R D I1 I2      In: Suppose also that the integrals

                               Z

      Fp.xpC1 ; : : : ; xn/ D               f .X/ d.x1; x2; : : : ; xp/; 1 Ä p Ä n 1;

                                  I1 I2 Ip

exist for all

                            .xpC1; : : : ; xn/ in IpC1           In:

Then the iterated integral

               Z bn              Z bn 1          Z b2   Z b1

                         dxn             dxn 1          dx2 f .X/ dx1

               an                 an 1           a2         a1

                     R
exists and equals R f .X/ d X:

Proof The proof is by induction. From Theorem 7.2.1, the proposition is true for n D 2.
Now assume n > 2 and the proposition is true with n replaced by n 1. Holding xn fixed

and applying this assumption yields

                         Z bn 1          Z bn 2         Z b2     Z b1

               Fn.xn/ D          dxn 1           dxn 2           dx2 f .X/ dx1:

                         an 1            an 2           a2       a1

Now Theorem 7.2.3 with p D n 1 completes the induction.

Example 7.2.4 Let R D OE0; 1 OE1; 2 OE0; 1 and
                                       f .x; y; ´/ D x C y C ´:

Then

                    Z 1 Â x2 Ã 1  1
      0 F1.y; ´/ D .x C y C ´/ dx D 2 xD0 C xy C x´  D 2 C y C ´;

                    Z 2 Z 2 Â1 Ã
         1 1 F2.´/ D F1.y; ´/ dy D 2 C y C ´ dy

                    Â y y2 Ã 2 
                 D 2 C 2 yD1 C y´  D 2 C ´;

and
  Z Z 1 Z 1 Â ´2 Ã 1  5
    R 0 0 f .x; y; ´/ d.x; y; ´/ D F2.´/ d´ D .2 C ´/ d´ D 2´ C 2 0 D 2 :

   The hypotheses of Theorems 7.2.3 and 7.2.4 are stated so as to justify successive in-
tegrations with respect to x1, then x2, then x3, and so forth. It is legitimate to use other
orders of integration if the hypotheses are adjusted accordingly. For example, suppose that
470 Chapter 7 Integrals of Functions of Several Variables

                                                               R
fi1; i2; : : : ; ing is a permutation of f1; 2; : : : ; ng and R f .X/ d X exists, along with

             Z

                           f .X/ d.xi1 ; xi2; : : : ; xij /; 1 Ä j Ä n 1;                     (7.2.14)

          Ii1 Ii2      Iij

for each

          .xij C1 ; xij C2; : : : ; xin/ in Iij C1 Iij C2                    Iin :            (7.2.15)
                                                                                              (7.2.16)
Then, by renaming the variables, we infer from Theorem 7.2.4 that

Z                      Z bin        Z bin 1              Z bi2        Z bi1

          f .X/ d X D         dxin           dxin 1             dxi2         f .X/ dxi1 :

   R                   ain          ain 1                ai2          ai1

   Since there are nS permutations of f1; 2; : : : ; ng, there are nS ways of evaluating a mul-
tiple integral over a rectangle in Rn, provided that the integrand satisfies appropriate hy-

potheses. In particular, if f is continuous on R and fi1; i2; : : : ; ing is any permutation of

f1; 2; : : : ; ng, then f is continuous with respect to .xi1 ; xi2; : : : ; xij / on Ii1 Ii2   Iij

for each fixed .xijC1 ; xijC2; : : : ; xin/ satisfying (7.2.15). Therefore, the integrals (7.2.14)

exist for every permutation of f1; 2; : : : ; ng (Theorem 7.1.13). We summarize this in the

next theorem, which now follows from Theorem 7.2.4.

Theorem 7.2.5 If f is continuous on

                            R D OEa1; b1 OEa2; b2               OEan; bn;

      R
then R f .X/ d X can be evaluated by iterated integrals in any of the nS ways indicated in
(7.2.16):

Example 7.2.5 If f is continuous on R D OEa1; b1 OEa2; b2 OEa3; b3, then

          Z                                  Z b3 Z b2 Z b1

                       f .x; y; ´/ d.x; y; ´/ D d´ dy f .x; y; ´/ dx

                   R                                 a3       a2      a1
                                             Z b2 Z b3 Z b1

                                             D dy d´ f .x; y; ´/ dx

                                               a2          a3           a1

                                             Z b3        Z b1         Z b2

                                             D d´ dx f .x; y; ´/ dy

                                               a3          a1           a2

                                             Z b1        Z b3         Z b2

                                             D dx d´ f .x; y; ´/ dy

                                               a1          a3           a2

                                             Z b2        Z b1         Z b3

                                             D dy dx f .x; y; ´/ d´

                                               a2         a1            a3

                                             Z b1        Z b2         Z b3

                                             D dx dy f .x; y; ´/ d´:

                                                     a1         a2    a3
                                  Section 7.2 Iterated Integrals and Multiple Integrals 471

Integrals over More General Sets

We now consider the problem of evaluating multiple integrals over more general sets. First,

suppose that f is integrable on a set of the form

                    S D .x; y/  u.y/ Ä x Ä v.y/; c Ä y Ä d°               «     (7.2.17)

(Figure 7.2.1).

If u.y/  a and v.y/ Ä b for c Ä y Ä d , and
                                        (
                                          f .x; y/;  .x; y/ 2 S;                (7.2.18)
                                                     .x; y/ 62 S;
                         fS .x; y/ D
                                          0;

then                   Z                       Z

                             f .x; y/ d.x; y/ D fS .x; y/ d.x; y/;

                          S                       R

where R D OEa; b OEc; d .. From Theorem 7.2.1,

                    Z                       Zd Zb

                          fS .x; y/ d.x; y/ D dy fS .x; y/ dx

                       R                       c     a

provided that a R b fS .x; y/ dx exists for each y in OEc; d . From (7.2.17) and (7.2.18), this

integral can be written as          Z v.y/

                                            f .x; y/ dx:                        (7.2.19)

                                    u.y/

Thus, we have proved the following theorem.

                 y

                    x = u(y)                                       y = d
                                                          x = v(y)

                                                           y = c

                            a                        b                       x

                                    Figure 7.2.1

Theorem 7.2.6 If f is integrable on the set S in (7.2.17) and the integral (7.2.19)

exists for c Ä y Ä d; then

                 Z                          Z d Z v.y/

                          f .x; y/ d.x; y/ D dy            f .x; y/ dx:         (7.2.20)

                    S                       c        u.y/
472 Chapter 7 Integrals of Functions of Several Variables

   From Theorem 7.1.22, the assumptions of Theorem 7.2.6 are satisfied if f is continuous
on S and u and v are continuously differentiable on OEc; d .

Interchanging x and y in Theorem 7.2.6 shows that if f is integrable on

                    S D .x; y/  u.x/ Ä y Ä v.x/; a Ä x Ä b°                   «     (7.2.21)

(Figure 7.2.2) and                     Z v.x/
                                               f .x; y/ dy

                                         u.x/

exists for a Ä x Ä b, then

                    Z                   Z b Z v.x/

                          f .x; y/ d.x; y/ D dx                 f .x; y/ dy:        (7.2.22)

                       S                a        u.x/

                    y
                                                                   y = v (x)

                                        S

                                                 y = u(x)

                                  a                                              x

                                                                b

                                       Figure 7.2.2

Example 7.2.6 Suppose that

                                              f .x; y/ D xy

and S is the region bounded by the curves x D y2 and x D y (Figure 7.2.3). Since S can
be represented in the form (7.2.17) as

                              S D °.x; y/  y2 Ä x Ä y; 0 Ä y Ä 1« ;

(7.2.20) yields             Z           Z1 Zy

                                  xy d.x; y/ D dy xy dx;

                               S           0     y2

which, incidentally, can be written as

                            Z           Z1           Zy

                                  xy d.x; y/ D y dy x dx;

                               S           0                y2
                                Section 7.2 Iterated Integrals and Multiple Integrals 473

since y is independent of x. Evaluating the iterated integral yields

             Z                     Z 1 2 y !                  Z1
                                          x                1
                                                                     3  y5/ dy
                   xy d.x; y/ D           2 y2 y dy D 2 0 .y

                S                  0

                                   1 Â y4 y6 Ã 1  1
                             D 2 4 6 0 D 24:
                       y

                                                        x = y
                                                             x = y2

                                                (1, 1)

                                      S

                                                                           x

                                      Figure 7.2.3

In this case we can also represent S in the form (7.2.21) as

                             °                  p                    «
                       S D .x; y/  x Ä y Ä x; 0 Ä x Ä 1 I

hence, from (7.2.22),

       Z                     Z1           Z px          Z 1 2 px !
                                                              y
             xy d.x; y/ D x dx                  y dy D                     x dx
                                                           0 2 yDx
          S                     0         x

                             1 2 3 Z 1                  1 Â x3 x4 Ã 1  1
                          D           .x     x / dx D 2 3            4 0 D 24 :
                             20

Example 7.2.7 To evaluate

                                      Z

                                         .x C y/ d.x; y/;

                                        S

where                  S D .x; y/  1 Ä x Ä 1; 0 Ä y Ä 1 C jxj°          «
474 Chapter 7 Integrals of Functions of Several Variables

(see Example 7.1.11 and Figure 7.2.4),

                                                               y

                          y = 1 - x             y = 1 + x

                                          S

                      -1                                   1                  x

                                      Figure 7.2.4

we invoke Corollary 7.1.31 and write

                Z               Z                          Z

                      .x C y/ d.x; y/ D .x C y/ d.x; y/ C .x C y/ d.x; y/;

                   S               S1                         S2

where

                      °S1 D .x; y/  0 Ä x Ä 1; 0 Ä y Ä 1 C x            «

and °  «
                            S2 D .x; y/  1 Ä x Ä 0; 0 Ä y Ä 1 x

(Figure 7.2.5).

From Theorem 7.2.6,

       Z Z 1 Z 1Cx Z 1 " .x C y/2 1Cx #
                                                                                        
                .x C y/ d.x; y/ D dx      .x C y/ dy D                     2      dx

            S1            0            0                          0              yD0

                      D  1Z 1         .2x C 1/ x dx22

                         20
                         1 Ä .2x C 1/3 x3 1 
                      D2 6                      3 0 D 2

and                      Z0 Z1 x                              Z 0"               2 1 x #
         Z                                                              .x C y/ 

                .x C y/ d.x; y/ D dx      .x C y/ dy D                     2 yD0 dx

            S2               1         0                             1

                         1 2 Z 0                1 Â x3 Ã 0  1
                      D         .1 x / dx D x                        3  1 D 3:
                         21                     2

Therefore,            Z 17
                       S .x C y/ d.x; y/ D 2 C 3 D 3 :
                             Section 7.2 Iterated Integrals and Multiple Integrals 475

       y                                                       y

          y = 1 + x                                 y = 1 - x

          S1                                        S2

                                      x                                          x

                                      Figure 7.2.5

Example 7.2.8 To find the area A of the region bounded by the curves
                                   y D x2 C 1 and y D 9 x2

(Figure 7.2.6), we evaluate           Z

                                      A D d.x; y/;

                                                 S

where  S D °.x; y/  x2 C 1 Ä y Ä 9 x2;                          «
                                                    2ÄxÄ2 :

According to Theorem 7.2.6,

          Z 2 Z 9 x2                     Z2

       A D dx                         dy D .9 x2/ .x2 C 1/ dx

                2            x2 C1    Â2     2x3 Ã 2  64
                                              3  2D 3:
          Z2                 2x2/ dx D 8x

       D .8

                2

                                         y

                             (-2, 5)  S              y = x2 + 1
                                                    (2, 5)

                                                     y = 9 - x2
                                                                              x

                                      Figure 7.2.6
476 Chapter 7 Integrals of Functions of Several Variables

   Theorem 7.2.6 has an analog for n > 2. Suppose that f is integrable on a set S of points
X D .x1; x2; : : : ; xn/ satisfying the inequalities

               uj .xj C1; : : : ; xn/ Ä xj Ä vj .xj C1; : : : ; xn/; 1 Ä j Ä n 1;

and
                                             an Ä xn Ä bn:

Then, under appropriate additional assumptions, it can be shown by an argument analogous

to the one that led to Theorem 7.2.6 that

Z              Z bn           Z vn.xn/            Z v2.x3;:::;xn /        Z v1.x2;:::;xn/

      f .X/ d X D dxn                      dxn 1                    dx2                     f .X/ dx1:

   S           an                un .xn /         u2 .x3 ;:::;xn /        u1 .x2 ;:::;xn /

These additional assumptions are tedious to state for general n. The following theorem
contains a complete statement for n D 3.

Theorem 7.2.7 Suppose that f is integrable on

      S D .x; y; ´/  u1.y; ´/ Ä x Ä v1.y; ´/; u2.´/ Ä y Ä v2.´/; c Ä ´ Ä d ;°               «

and let     S.´/ D .x; y/  u1.y; ´/ Ä x Ä v1.y; ´/; u2.´/ Ä y Ä v2.´/°    «

for each ´ in OEc; d : Then

         Z                                 Z d Z v2.´/ Z v1.y;´/

               f .x; y; ´/ d.x; y; ´/ D d´                  dy            f .x; y; ´/ dx;

            S                              c      u2 .´/        u1 .y;´/

provided that                      Z v1.y;´/
exists for all .y; ´/ such that               f .x; y; ´/ dx

                                     u1 .y;´/

                              c Ä ´ Ä d and u2.´/ Ä y Ä v2.´/;

and                                Z
exists for all ´ in OEc; d :
                                         f .x; y; ´/ d.x; y/

                                     S .´/

Example 7.2.9 Suppose that f is continuous on the region S in R3 bounded by the
coordinate planes and the plane

                                            x C y C 2´ D 2

(Figure 7.2.7); thus,
                       Section 7.2 Iterated Integrals and Multiple Integrals 477

                                z

                                                x + y + 2z = 1
                                                                                   y

                    x

                                        Figure 7.2.7

S D .x; y; ´/  0 Ä x Ä 2 y 2´; 0 Ä y Ä 2 2´; 0 Ä ´ Ä 1 :°     «

From Theorem 7.2.7,

Z                      Z 1 Z 2 2´ Z 2 y 2´

                f .x; y; ´/ d.x; y; ´/ D d´     dy            f .x; y; ´/ dx:

   S                   0                     0             0

There are five other iterated integrals that equal the multiple integral. We leave it to you

to verify that

Z                      Z 2 Z 1 y=2 Z 2 y 2´

      f .x; y; ´/ d.x; y; ´/ D dy               d´            f .x; y; ´/ dx

S                      0                     0          0

                       Z 1 Z 2 2´ Z 2 x 2´

                       D d´                     dx            f .x; y; ´/ dy

                       0                     0          0

                       Z 2 Z 1 x=2 Z 2 x 2´

                       D dx                     d´            f .x; y; ´/ dy

                       0                     0          0

                       Z 2 Z 2 x Z 1 x=2 y=2

                       D dx                     dy            f .x; y; ´/ d´

                       0                     0         0

                       Z 2 Z 2 y Z 1 x=2 y=2

                       D dy                     dx            f .x; y; ´/ d´

                       0                     0          0

(Exercise 7.2.15).

   Thus far we have viewed the iterated integral as a tool for evaluating multiple integrals.
In some problems the iterated integral is itself the object of interest. In this case a result
478 Chapter 7 Integrals of Functions of Several Variables

like Theorem 7.2.6 can be used to evaluate the iterated integral. The procedure is as follows.
(a) Express the given iterated integral as a multiple integral, and check to see that the

      multiple integral exists.

(b) Look for another iterated integral that equals the multiple integral and is easier to
      evaluate than the given one. The two iterated integrals must be equal, by Theo-
      rem 7.2.6.

This procedure is called changing the order of integration of an iterated integral.

Example 7.2.10 The iterated integral

                          Z1 Zy
                    I D dy e .x 1/2 dx

                       0              0

is hard to evaluate because e .x 1/2 has no elementary antiderivative. The set of points

.x; y/ that enter into the integration, which we call the region of integration, is

                    S D .x; y/  0 Ä x Ä y; 0 Ä y Ä 1°                «

(Figure 7.2.8).

                 y

                                                              y = x
                 1

                                                                             x
                                         1

                       Figure 7.2.8

Therefore,                   Z
                       I D e .x 1/2 d.x; y/;
                                                                                     (7.2.23)
                                 S

and this multiple integral exists because its integrand is continuous. Since S can also be

written as          °S D .x; y/  x Ä y Ä 1; 0 Ä x Ä 1 ;              «
                               Section 7.2 Iterated Integrals and Multiple Integrals 479

Theorem 7.2.6 implies that

Z                              Z1                                         Z1              Z1
                                                                                              .x
   e .x 1/2 d.x; y/ D e .x 1/2 dx dy D                                                            1/e .x 1/2 dx

   S 0 1 x 0
                               D 1 e .x 1/2  1  D .1 e 1/:
                               2             02

This and (7.2.23) imply that

                                      I D 1 .1 e 1/:
                                            2

Example 7.2.11 Suppose that f is continuous on OEa; 1/ and y satisfies the differen-

tial equation

                                  y00.x/ D f .x/; x > a;                                                  (7.2.24)

with initial conditions

                                   y.a/ D y0.a/ D 0:

Integrating (7.2.24) yields                 Zx
                                  y0.x/ D f .t/ dt;

                                             a

since y0.a/ D 0. Integrating this yields

                                          Zx Zs

                               y.x/ D ds f .t/ dt;

                                          a                                  a

since y.a/ D 0. This can be reduced to a single integral as follows. Since the function

                                      g.s; t/ D f .t/

is continuous for all .s; t/ such that t a, g is integrable on

                               °                                                          «
                               S D .s; t/  a Ä t Ä s; a Ä s Ä x

(Figure 7.2.9), and Theorem 7.2.6 implies that

                         Z                Zx Zs

                               f .t/ d.s; t/ D ds f .t/ dt D y.x/:                                        (7.2.25)

                            S             a                                  a

However, S can also be described as

                               °                                                          «
                               S D .s; t/  t Ä s Ä x; a Ä t Ä x

so Theorem 7.2.6 implies that

               Z                  Zx         Zx                                 Zx

                  f .t/ d.s; t/ D f .t/ dt ds D .x                                           t/f .t/ dt:

               S                   a                                      t     a

Comparing this with (7.2.25) yields                                          t/f .t/ dt:
                                                Zx

                                      y.x/ D .x

                                                                       a
480 Chapter 7 Integrals of Functions of Several Variables

                                    t

                                                                                             s = t

                                                        S
             a

                         a xs

                            Figure 7.2.9

                         7.2 Exercises

1. Evaluate

Z2 Z1                                                      Z2 Z1

(a) dy .x C 3y/ dx                  (b) dx .x3 C y4/ dy

0            1                                                1      0

Z2           Z2                                            Z log 2                                  Z1
                                    (d) y dy xex2ydx
(c) x dx sin xy dy

   =2           1                                             0                                     0

2. Let Ij D OEaj ; bj , 1 Ä j Ä 3, and suppose that f is integrable on R D I1 I2 I3.
      Prove:

(a) If the integral                   Z b1
                         G.y; ´/ D f .x; y; ´/ dx

                                              a1

exists for .y; ´/ 2 I2 I3, then G is integrable on I2 I3 and

                   Z                                       Z

                         f .x; y; ´/ d.x; y; ´/ D                    G.y; ´/ d.y; ´/:

                      R                                       I2 I3

(b) If the integral              Z

                         H.´/ D            f .x; y; ´/ d.x; y/

                                    I1 I2
                      Section 7.2 Iterated Integrals and Multiple Integrals 481

        exists for ´ 2 I3, then H is integrable on I3 and

                   Z                                    Z b3

                         f .x; y; ´/ d.x; y; ´/ D H.´/ d´:

                      R                                 a3

      HINT: For both parts; see the proof of Theorem 7.2.1:
3. Prove: If f is continuous on OEa; b OEc; d , then the function

                                                     Zb
                                          F .y/ D f .x; y/ dx

                                                                              a

      is continuous on OEc; d . HINT: Use Theorem 5.2.14:
4. Suppose that

                   f .x0; y0/ f .x; y/ if a Ä x Ä x0 Ä b; c Ä y Ä y0 Ä d:

Show that f satisfies the hypotheses of Theorem 7.2.1 on R D OEa; b OEc; d . HINT:
See the proof of Theorem 3.2.9:

5. Evaluate by means of iterated integrals:
             Z

(a) .xy C 1/ d.x; y/;    R D OE0; 1             OE1; 2

            R

       Z

(b) .2x C 3y/ d.x; y/; R D OE1; 3 OE1; 2

        R
        Z xy
(c) p              d.x; y/;  R D OE0; 1         OE0; 1
        R x2 C y2

(d) R R x cos xy cos 2 x d.x; y/; R D OE0; 41  OE0; 2 

6. Let A be the set of points of the form .2 mp; 2 mq/, where p and q are odd integers

and m is a nonnegative integer. Let

                                      (         .x; y/ 62 A;
                                        1;      .x; y/ 2 A:

                         f .x; y/ D
                                        0;

Show that f is not integrable on any rectangle R D OEa; b OEc; d , but

        Zb Zd                Zd Zb

           dx f .x; y/ dy D dy f .x; y/ dx D .b a/.d c/: .A/

        a  c                 c               a

HINT: For (A); use Theorem 3.5.6 and Exercise 3.5.6:

7. Let             f .x; y/ D 2xy               if y is rational;
                                  y             if y is irrational;

and R D OE0; 1 OE0; 1 (Example 7.2.3).
482 Chapter 7 Integrals of Functions of Several Variables

                     R                             R
     (a) Calculate R f .x; y/ d.x; y/ and R f .x; y/ d.x; y/, and show that f is not

        integrable on R.                  Á           R1 R1                  Á
                     R1 R1
     (b) Calculate 0 0 f .x; y/ dy dx and 0 0 f .x; y/ dy dx.

8. Let R D OE0; 1 OE0; 1 OE0; 1, Re D OE0; 1 OE0; 1, and

                           8                       if y and ´ are rational;
                           ^^2xy C 2x´             if y is irrational and ´ is rational;
                           <                       if y is rational and ´ is irrational;
                                                   if y and ´ are irrational:
                             y C 2x´
           f .x; y; ´/ D ^^2xy C ´

                           :
                             yC´

     Calculate
        Z                                 Z

     (a) f .x; y; ´/ d.x; y; ´/ and f .x; y; ´/ d.x; y; ´/

        Z  R                           Z     R

     (b) f .x; y; ´/ d.x; y/ and f .x; y; ´/ d.x; y/
           eR                          eR
        Z1 Z1                              Z1 Z1 Z1

     (c) dy f .x; y; ´/ dx and d´ dy f .x; y; ´/ dx.

        0         0                          0        0        0

9. Suppose that f is bounded on R D OEa; b OEc; d . Prove:
                                                            !
        Z                           Zb Zd

     (a) f .x; y/ d.x; y/ Ä                     f .x; y/ dy dx. HINT: Use Exercise 3.2.6(a):

           R                        a     c                 !

        Z                           Zb Zd

     (b) f .x; y/ d.x; y/                       f .x; y/ dy dx. HINT: Use Exercise 3.2.6(b):

           R                        a     c

10. Use Exercise 7.2.9 to prove the following generalization of Theorem 7.2.1: If f is
        integrable on R D OEa; b OEc; d , then

                          Zb                             Zd

                               f .x; y/ dy and               f .x; y/ dy

                            a                            c

     are integrable on OEa; b, and

     Zb Zd                ! Zb               Zd                !          Z

                  f .x; y/ dy dx D                    f .x; y/ dy dx D f .x; y/ d.x; y/:

     a         c                       a        c                            R

11.  Evaluate
            Z

     (a) .x 2y C 3´/ d.x; y; ´/; R D OE 2; 0 OE2; 5 OE 3; 2

            ZR
     (b) e x2 y2 sin x sin ´ d.x; y; ´/; R D OE 1; 1 OE0; 2 OE0; =2

            ZR

     (c) .xy C 2x´ C y´/ d.x; y; ´/; R D OE 1; 1 OE0; 1 OE 1; 1

                 R
                          Section 7.2 Iterated Integrals and Multiple Integrals 483

            Z
     (d) x2y3´exy2´2 d.x; y; ´/; R D OE0; 1 OE0; 1 OE0; 1

     R

12.  Evaluate
            Z
     (a) .2x C y2/ d.x; y/; S D °.x; y/  0 Ä x Ä 9 y2; 3 Ä y Ä 3«

     ZS

     (b) 2xy d.x; y/; S is bounded by y D x2 and x D y2

            Z S sin y     S D .x; y/  log y Ä x Ä log 2y; =2 Ä y Ä°                                         «
     (c) ex d.x; y/;
     SR y

                                                                                                   2
13. Evaluate S .x C y/ d.x; y/, where S is bounded by y D x and y D 2x, using

     iterated integrals of both possible types.

14. Find the area of the set bounded by the given curves.

       (a) y D x2 C 9, y D x2 9, x D 1, x D 1

       (b) y D x C 2, y D 4 x, x D 0
       (c) x D y2 4, x D 4 y2
       (d) y D e2x, y D 2x, x D 3

                                                                             R
15. In Example 7.2.9, verify the last five representations of S f .x; y; ´/ d.x; y; ´/ as

        iterated integrals.

16. Let S be the region in R3 bounded by the coordinate planes and the plane x C
        R2y C 3´ D 1. Let f be continuous on S . Set up six iterated integrals that equal
         S f .x; y; ´/ d.x; y; ´/.

17. Evaluate
               Z

       (a) x d.x; y; ´/; S is bounded by the coordinate planes and the plane

                        S

           3x C y C ´ D 2.
     (b) ye´ Z d.x; y; ´/; S D °.x; y; ´/  0 Ä x Ä 1; 0 Ä y Ä px; 0 Ä ´ Ä y2«

                  S

            Z

     (c) xy´ d.x; y; ´/;

     Sn                                            p                                                  p  o
     S D .x; y; ´/  0 Ä y Ä 1; 0 Ä x Ä 1
                                                      y2; 0 Ä ´ Ä x2 C y2

       Z (d) y´ d.x; y; ´/; S D °.x; y; ´/  ´2 Ä x Ä p´; 0 Ä y Ä ´; 0 Ä ´ Ä 1«

                         S

18. Find the volume of S .

     (a) S is bounded by the surfaces ´ D x2 C y2 and ´ D 8 x2 y2.

     (b) S D f.x; y; ´/ j 0 Ä ´ Ä x2 C y2; .x; y; 0/ is in the triangle with vertices

     .0; 1; 0/, .0; 0; 0/, and .1; 0; 0/}
               °                                           2«
     (c) S D .x; y; ´/ 0 Ä y Ä x ; 0 Ä x Ä 2; 0 Ä ´ Ä y2

               °                                           2 2«
     (d) S D .x; y; ´/ x 0; y 0; 0 Ä ´ Ä 4 4x 4y
484 Chapter 7 Integrals of Functions of Several Variables

19. Let R D OEa1; b2 OEa2; b2        OEan; bn. Evaluate
R R2 2
(a) R .x1 C x2 C C xn/ d X                      (b) R .x1 C x2 C         C  x2   /  d  X

                                                                              n

     R       xn d X
(c) R x1x2;

20. Assuming that f is continuous, express

                      Z 1 Z p1 y2

                                     dy p f .x; y/ dx
                               1=2           1 y2

        as an iterated integral with the order of integration reversed.
                   R

21. Evaluate S .x Cy/ d.x; y/ of Example 7.2.7 by means of iterated integrals in which

the first integration is with respect to x.

Z 1 Z p1 x2 dy
22. Evaluate x dx                 p          :
                                   x2 C y2
0                  0

23. Suppose that f is continuous on OEa; 1/,

                                  y.n/.x/ D f .x/; t a;

and y.a/ D y0.a/ D D y.n 1/.a/ D 0.

(a) Integrate repeatedly to show that

                      Z x Z tn                     Z t3 Z t2

             y.x/ D dtn dtn 1                              dt2 f .t1/ dt1:                .A/

                               a     a             a       a

(b) By successive reversals of orders of integration as in Example 7.2.11, deduce

from (A) that                       1 Zx
                      y.x/ D .n 1/S a .x
                                                      t/n 1f .t/ dt:

24. Let T D OE0;  OE0; ; > 0. By calculating
                                                    Z

                                    I.a/ D lim e xy sin ax d.x; y/

                                                                   !1 T

in two different ways, show that                   if a > 0:
                              Z 1 sin ax
                               0 x dx D 2

7.3 CHANGE OF VARIABLES IN MULTIPLE INTEGRALS

In Section 3.3 we saw that a change of variables may simplify the evaluation of an ordinary
integral. We now consider change of variables in multiple integrals.
                           Section 7.3 Change of Variables in Multiple Integrals 485

   Prior to formulating the rule for change of variables, we must deal with some rather
involved preliminary considerations.

Jordan Measurable Sets

In Section we defined the content of a set S to be                                                  (7.3.1)
                                                         Z

                                              V .S / D d X

                                                                                    S

if the integral exists. If R is a rectangle containing S , then (7.3.1) can be rewritten as
                                                   Z

                                        V .S / D S .X/ d X;

                                                                           R

where S is the characteristic function of S , defined by

                             S .X/ D 1; X 2 S;
                                         0; X 62 S:

From Exercise 7.1.27, the existence and value of V .S / do not depend on the particular
choice of the enclosing rectangle R. We say that S is Jordan measurable if V .S / exists.
Then V .S / is the Jordan content of S .

   We leave it to you (Exercise 7.3.2) to show that S has zero content according to Defini-
tion 7.1.14 if and only if S has Jordan content zero.

Theorem 7.3.1 A bounded set S is Jordan measurable if and only if the boundary of
S has zero content:

Proof Let R be a rectangle containing S . Suppose that V .@S / D 0. Since S is

bRounded on R and discontinuous only on @S (Exercise 2.2.9), Theorem 7.1.19 implies that
 R S .X/ d X exists. For the converse, suppose that @S does not have zero content and
let P D fR1; R2; : : : ; Rkg be a partition of R. For each j in f1; 2; : : : ; kg there are three

possibilities:

1. Rj  S ; then

                   min S .X/  X 2 Rj D max S .X/  X 2 Rj D 1:°«°                              «

2. Rj \ S ¤ ; and Rj \ S c ¤ ;; then

       min S .X/  X 2 Rj D 0 and max S .X/  X 2 Rj D 1:°«                              °         «

3. Rj  S c ; then

                   min S .X/  X 2 Rj D max S .X/  X 2 Rj D 0:°«°                              «
486 Chapter 7 Integrals of Functions of Several Variables

Let                     «                     °                        c«
             °       S and U2 D j  Rj \ S ¤ ; and Rj \ S ¤ ; :             (7.3.2)

     U1 D j  Rj

Then the upper and lower sums of S over P are

          S.P / D    X      V .Rj / C  X      V .Rj /

                     j 2U1             j 2U2                               (7.3.3)

            D total content of the subrectangles in P that intersect S

and                  X

            s.P / D         V .Rj /

                j 2U1                                                      (7.3.4)

            D total content of the subrectangles in P contained in S :

Therefore,                                             X

                            S.P / s.P / D                    V .Rj /;

                                                                                 j 2U2

which is the total content of the subrectangles in P that intersect both S and S c. Since
these subrectangles contain @S , which does not have zero content, there is an 0 > 0 such
that

                                           S.P / s.P / 0

for every partition P of R. By Theorem 7.1.12, this implies that S is not integrable on R,
so S is not Jordan measurable.

Theorems 7.1.19 and 7.3.1 imply the following corollary.

Corollary 7.3.2 If f is bounded and continuous on a bounded Jordan measurable set
S; then f is integrable on S:

Lemma 7.3.3 Suppose that K is a bounded set with zero content and ; > 0: Then
there are cubes C1; C2; . . . ; Cr with edge lengths < such that Cj \ K ¤ ;; 1 Ä j Ä r;

                                          K   [r       Cj ;

                                                                           (7.3.5)

                                              j D1

and
                                             Xr
                                                  V .Cj / < :

                                                                j D1

Proof Since V .K/ D 0,                 Z

                                              K.X/ d X D 0

                                          C

if C is any cube containing K. From this and the definition of the integral, there is a i > 0

such that if P is any partition of C with kP k Ä i and is any Riemann sum of K over

P , then

                                          0Ä Ä :                           (7.3.6)
             Section 7.3 Change of Variables in Multiple Integrals 487

Now suppose that P D fC1; C2; : : : ; Ckg is a partition of C into cubes with

             kP k < min. ; i/;                                                       (7.3.7)

and let C1, C2, . . . , Ck be numbered so that Cj \ K ¤ ; if 1 Ä j Ä r and Cj \ K D ;
if r C 1 Ä j Ä k. Then (7.3.5) holds, and a typical Riemann sum of K over P is of the

form            Xr

             D        K .Xj /V .Cj /

                j D1

with Xj 2 Cj , 1 Ä j Ä r . In particular, we can choose Xj from K, so that     K .Xj / D 1,
and

                                                  Xr
                                               D V .Cj /:

                                                                        j D1

Now (7.3.6) and (7.3.7) imply that C1, C2, . . . , Cr have the required properties.

Transformations of Jordan-Measurable Sets

To formulate the theorem on change of variables in multiple integrals, we must first con-
sider the question of preservation of Jordan measurability under a regular transformation.

Lemma 7.3.4 Suppose that G W Rn ! Rn is continuously differentiable on a bounded
open set S; and let K be a closed subset of S with zero content: Then G.K/ has zero
content.

Proof Since K is a compact subset of the open set S , there is a       1 > 0 such that the

compact set     °                     «
             K 1 D X  dist.X; K/ Ä 1

is contained in S (Exercise 5.1.26). From Lemma 6.2.7, there is a constant M such that

             jG.Y/ G.X/j Ä M jY Xj if X; Y 2 K 1:                                    (7.3.8)

Now suppose that > 0. Spince V .K/ D 0, there are cubes C1, C2, . . . , Cr with edge
lengths s1, s2, . . . , sr < 1= n such that Cj \ K ¤ ;, 1 Ä j Ä r ,

                K     [r    Cj ;

                      j D1

and                                                                                  (7.3.9)
                                             Xr
                                                  V .Cj / <

                                                                 j D1

(Lemma 7.3.3). For 1 Ä j Ä r , let Xj 2 Cj \ K. If X 2 Cj , then
                                                         p

                                       jX Xj j Ä sj n < 1;
488 Chapter 7 Integrals of Functions of Several Variables

                                        p
so X 2 K and jG.X/ G.Xj /j Ä M jX Xj j ÄpM n sj , from (7.3.8). Therefore, G.Cj /
is contained in a cube Cej with edge length 2M n sj , centered at G.Xj /. Since
                            p nn            pn
                 V .C j / D .2M n/ sj D .2M n/ V .Cj /;e

we now see that                   [r
                                       Cej
                            G.K/
                                  j D1

and              Xr         p Xr

                                                           p
                       V .Cej / Ä .2M n/n V .Cj / < .2M n/n ;

                 j D1             j D1
where the last inequality follows from (7.3.9). Since .2M pn/n does not depend on , it

follows that V .G.K// D 0.

Theorem 7.3.5 Suppose that G W Rn ! Rn is regular on a compact Jordan measur-
able set S: Then G.S / is compact and Jordan measurable:

Proof We leave it to you to prove that G.S / is compact (Exercise 6.2.23). Since S
is Jordan measurable, V .@S / D 0, by Theorem 7.3.1. Therefore, V .G.@S // D 0, by
Lemma 7.3.4. But G.@S / D @.G.S // (Exercise 6.3.23), so V .@.G.S /// D 0, which
implies that G.S / is Jordan measurable, again by Theorem 7.3.1.

Change of Content Under a Linear Transformation

To motivate and prove the rule for change of variables in multiple integrals, we must know
 how V .L.S // is related to V .S / if S is a compact Jordan measurable set and L is a nonsin-
 gular linear transformation. (From Theorem 7.3.5, L.S / is compact and Jordan measurable
 in this case.) The next lemma from linear algebra will help to establish this relationship.
 We omit the proof.

Lemma 7.3.6 A nonsingular n n matrix A can be written as

                            A D EkEk 1 E1;                                       (7.3.10)

where each Ei is a matrix that can be obtained from the n  n identity matrix I by one of
the following operationsW
(a) interchanging two rows of II
(b) multiplying a row of I by a nonzero constantI
(c) adding a multiple of one row of I to another:

   Matrices of the kind described in this lemma are called elementary matrices. The key to
the proof of the lemma is that if E is an elementary n n matrix and A is any n n matrix,
then EA is the matrix obtained by applying to A the same operation that must be applied
to I to produce E (Exercise 7.3.6). Also, the inverse of an elementary matrix of type (a),
(b), or (c) is an elementary matrix of the same type (Exercise 7.3.7).

   The next example illustrates the procedure for finding the factorization (7.3.10).
       Section 7.3 Change of Variables in Multiple Integrals 489

Example 7.3.1 The matrix

                                       2  011     3

                                    AD4 1 0 1 5

                                          220

is nonsingular, since det.A/ D 4. Interchanging the first two rows of A yields

                                    2  101     3

       A1 D 4 0 1 1 5 D bE1A;

                                       220

where                                  2          3

                                          010

                          bE1 D 4 1 0 0 5 :

                                          001

Subtracting twice the first row of A1 from the third yields

              2                                  3
                  10                           1
                                               1 5 D bE2bE1A;
       A2 D 4 0 1                              2

                  02

where                            2                    3
                          bE2 D 4         100
                                          0 1 0 5:

                                          201

Subtracting twice the second row of A2 from the third yields

              2                              3
                  10                      1
                                          1 5 D bE3bE2bE1A;
       A3 D 4 0 1

                                    00 4

where                            2                    3
                                     1         00
                                               1 0 5:
                          bE3 D 4 0
                                               21
                                     0

Multiplying the third row of A3 by  1  yields
                                    4

                          2         101   3

       A4 D 4 0 1 1 5 D bE4bA3bE2bE1A;

                                    001

where                            2                   3
                                     10           0
                                                  0 5:
                          bE4 D 4 0 1
                                                  1
                                     00
                                                  4
490 Chapter 7 Integrals of Functions of Several Variables

Subtracting the third row of A4 from the first yields
                          2            3
                                 100

                      A5 D 4 0 1 1 5 D bE5bA4bE3bE2bE1A;

                                 001

where                                   2                 3
                                            10         1
                                                       0 5:
                                 bE5 D 4 0 1
                                                       1
                                            00

Finally, subtracting the third row of A5 from the second yields

                                 I D bE6bE5bE4bE3bE2bE1A;                             (7.3.11)

where                                   2                 3
                                            10         0
                                                       1 5:
                                 bE6 D 4 0 1
                                                       1
                                            00

From (7.3.11) and Theorem 6.1.16,

            A D .bE6bE5bE4bE3bE2bE1/ 1 D bE 1 1 bE 1 2 bE 1 3 bE 1 4 bE 1 5 bE 1 6 :

Therefore,

                                 A D E6E5E4E3E2E1;

where       2                    3                     2          3

                      100                                    101
E1 D bE6 1 D 4 0 1 1 5,                E2 D bE5 1 D 4 0 1 0 5,

                      001                                    001

                   2                3                  2     100  3
                      10         0
                                 0 5,  E4 D bE3 1 D 4 0 1 0 5,
E3 D bA4 1 D 4 0 1
                                 4                           021
                      00

            2         100        3                     2     010  3

E5 D bE2 1 D 4 0 1 0 5,                E6 D bE1 1 D 4 1 0 0 5

                      201                                    001

(Exercise 7.3.7(c)).

  Lemma 7.3.6 and Theorem 6.1.7(c) imply that an arbitrary invertible linear transforma-
tion L W Rn ! Rn, defined by

                                    X D L.Y/ D AY;                                    (7.3.12)

can be written as a composition

                                 L D Lk i Lk 1 i i L1;                                (7.3.13)

where

                          Li .Y/ D Ei Y; 1 Ä i Ä k:
                             Section 7.3 Change of Variables in Multiple Integrals 491

Theorem 7.3.7 If S is a compact Jordan measurable subset of Rn and L W Rn ! Rn
is the invertible linear transformation X D L.Y/ D AY; then

                                    V .L.S // D j det.A/jV .S /:                          (7.3.14)

Proof Theorem 7.3.5 implies that L.S / is Jordan measurable. If

                                    V .L.R// D j det.A/jV .R/                             (7.3.15)

whenever R is a rectangle, then (7.3.14) holds if S is any compact Jordan measurable

set. To see this, suppose that > 0, let R be a rectangle containing S , and let P D

fR1; R2; : : : ; Rkg be a partition of R such that the upper and lower sums of S over P

satisfy the inequality

                                    S.P / s.P / < :                                       (7.3.16)

Let U1 and U2 be as in (7.3.2). From (7.3.3) and (7.3.4),

       s.P / D   X      V .Rj / Ä V .S / Ä     X      V .Rj / C  X      V .Rj / D S.P /:

                                                                                          (7.3.17)

                 j 2U1                      j 2U1                j 2U2

Theorem 7.3.7 implies that L.R1/, L.R2/, . . . , L.Rk/ and L.S / are all Jordan measurable.

Since                               [                 [
                                         Rj S                Rj ;

                             j 2U1                    j 2S1[S2

it follows that           0         1                 0                    1

                              [                L.S /  L@         [      Rj A :
                        L @ Rj A

                             j 2U1                        j 2S1[S2

Since L is one-to-one on Rn, this implies that

       X      V .L.Rj // Ä V .L.S // Ä         X      V .L.Rj // C  X      V .L.Rj //:

                                                                                          (7.3.18)

       j 2U1                                   j 2U1                j 2U2

If we assume that (7.3.15) holds whenever R is a rectangle, then

                        V .L.Rj // D j det.A/jV .Rj /; 1 Ä j Ä k;

so (7.3.18) implies that

                                              V .L.S //
                                    s.P / Ä j det.A/j Ä S.P /:

This, (7.3.16) and (7.3.17) imply that                    
                                               V .L.S //  < I
                                               j det.A/j
                                       V .S /

hence, since can be made arbitrarily small, (7.3.14) follows for any Jordan measurable
set.
492 Chapter 7 Integrals of Functions of Several Variables

To complete the proof, we must verify (7.3.15) for every rectangle

                   R D OEa1; b1 OEa2; b2              OEan; bn D I1 I2                         In:

Suppose that A in (7.3.12) is an elementary matrix; that is, let

                                           X D L.Y/ D EY:

CASE 1. If E is obtained by interchanging the i th and j th rows of I, then
                                      8
                                      <yr if r ¤ i and r ¤ j I

                              xr D yj if r D i I
                                      :
                                        yi if r D j :

Then L.R/ is the Cartesian product of I1, I2, . . . , In with Ii and Ij interchanged, so

                                 V .L.R// D V .R/ D j det.E/jV .R/

since det.E/ D 1 in this case (Exercise 7.3.7(a)).
   CASE 2. If E is obtained by multiplying the r th row of I by a, then

                                     xr D yr if r ¤ i ;
                                             ayi if r D i :

Then

                   L.R/ D I1                      Ii 1 Ii IiC10                     In;

where  I0  is  an  interval  with  length  equal  to  jaj  times  the   length  of  Ii  ,  so

        i

                                 V .L.R// D jajV .R/ D j det.E/jV .R/

since det.E/ D a in this case (Exercise 7.3.7(a)).
   CASE 3. If E is obtained by adding a times the j th row of I to its i th row (j ¤ i ), then

                                     xr D yr if r ¤ i I yi C ayj if r D i :

Then

L.R/ D .x1; x2; : : : ; xn/  ai C axj Ä xi Ä bi C axj and ar Ä xr Ä br if r ¤ i ;°                  «

which is a parallelogram if n D 2 and a parallelepiped if n D 3 (Figure 7.3.1). Now
                                                        Z

                                     V .L.R// D                   d X;

                                                           L.R/

which we can evaluate as an iterated integral in which the first integration is with respect

to xi . For example, if i D 1, then

                   Z bn              Z bn 1                Z b2              Z b1Caxj

           V .L.R// D dxn                    dxn 1                dx2                   dx1:        (7.3.19)

                             an      an 1                     a2             a1 Ca xj
                              Section 7.3 Change of Variables in Multiple Integrals 493

Since                             Z b1Caxj    Z b1

                                              dy1 D dy1;

                                    a1 Ca xj  a1

(7.3.19) can be rewritten as

                              Z bn  Z bn 1           Z b2  Z b1

       V .L.R// D dxn                         dxn 1        dx2 dx1

                              an    an 1             a2    a1

               D .bn an/.bn 1 an 1/                  .b1 a1/ D V .R/:

Hence, V .L.R// D j det.E/jV .R/, since det.E/ D 1 in this case (Exercise 7.3.7(a)).

           y2

       a2

                                                                i = 1, j = 2, a > 0
       b2

               a1 b1 y1

               y3

                                                           i = 2, j = 3, a > 0

                                                                                             y2

                   y1

                                        Figure 7.3.1
   From what we have shown so far, (7.3.14) holds if A is an elementary matrix and S is
any compact Jordan measurable set. If A is an arbitrary nonsingular matrix,
494 Chapter 7 Integrals of Functions of Several Variables

then we can write A as a product of elementary matrices (7.3.10) and apply our known
result successively to L1, L2, . . . , Lk (see (7.3.13)). This yields

            V .L.S // D j det.Ek/j j det.Ek 1/j j det E1jV .S / D j det.A/jV .S /;

by Theorem 6.1.9 and induction.

Formulation of the Rule for Change of Variables

We now formulate the rule for change of variables in a multiple integral. Since we are for
the present interested only in "discovering" the rule, we will make any assumptions that
ease this task, deferring questions of rigor until the proof.

   Throughout the rest of this section it will be convenient to think of the range and domain
of a transformation G W Rn ! Rn as subsets of distinct copies of Rn. We will denote the
copy containing DG as En, and write G W En ! Rn and X D G.Y/, reversing the usual

roles of X and Y.

   If G is regular on a subset S of En, then each X in G.S / can be identified by specifying

the unique point Y in S such that X D G.Y/.
                                          R

   Suppose that we wish to evaluate T f .X/ d X, where T is the image of a compact Jordan
measurable set S under the regular transformation X D G.Y/. For simplicity, we take S to

be a rectangle and assume that f is continuous on T D G.S /.

Now suppose that P D fR1; R2; : : : ; Rkg is a partition of S and Tj D G.Rj / (Fig-

ure 7.3.2).

             v                                         y

                       Rj     X = G(U)                               Tj

                       S                                             T
                                             u                                           x

                              Figure 7.3.2

Then                   Z                        Xk Z

                              f .X/ d X D                 f .X/ d X                         (7.3.20)

                           T                    j D1 Tj

(Corollary 7.1.31 and induction). Since f is continuous, there is a point Xj in Tj such that

                Z                               Z

                       f .X/ d X D f .Xj / d X D f .Xj /V .Tj /

                   Tj                              Tj
                                        Section 7.3 Change of Variables in Multiple Integrals 495

(Theorem 7.1.28), so (7.3.20) can be rewritten as

                                     Z                    Xk

                                           f .X/ d X D f .Xj /V .Tj /:                                        (7.3.21)

                                        T                 j D1

Now we approximate V .Tj /. If

                                                  Xj D G.Yj /;                                                (7.3.22)

then Yj 2 Rj and, since G is differentiable at Yj ,                                                           (7.3.23)
                                G.Y/ G.Yj / C G0.Yj /.Y Yj /:

Here G and Y Yj are written as column matrices, G0 is a differential matrix, and " "
means "approximately equal" in a sense that we could make precise if we wished (Theo-
rem 6.2.2).

   It is reasonable to expect that the Jordan content of G.Rj / is approximately equal to the
Jordan content of A.Rj /, where A is the affine transformation

                                A.Y/ D G.Yj / C G0.Yj /.Y Yj /

on the right side of (7.3.23); that is,

                                           V .G.Rj // V .A.Rj //:                                             (7.3.24)

We can think of the affine transformation A as a composition A D A3 i A2 i A1, where

                                           A1.Y/ D Y Yj ;
                                           A2.Y/ D G0.Yj /Y;

and
                                          A3.Y/ D G.Yj / C Y:

Let  R0    D   A1.Rj /.  Since A1     merely shifts Rj        to  a  different  location,  R0    is also a rectangle,

        j                                                                                     j

and

                                               V .Rj0 / D V .Rj /:                                            (7.3.25)

Now  let   R00   D  A2.Rj0  /.  (In  general,  R00   is  not  a  rectangle.)    Since  A2  is    the  linear  transfor-

              j                                   j
mation with nonsingular matrix G0.Yj /, Theorem 7.3.7 implies that

                         V .Rj00// D j det G0.Yj /jV .Rj0 / D jJ G.Yj /jV .Rj /;                              (7.3.26)

where      JG  is  the  Jacobian  of  G.   Now    let  R000  D    A3.Rj00/.  Since  A3  merely        shifts  all  points

                                                          j

in the same way,

                                               V  .R000/  D   V   .Rj00 /:                                    (7.3.27)

                                                      j

Now (7.3.24)-(7.3.27) suggest that

                                           V .Tj / jJ G.Yj /jV .Rj /:
496 Chapter 7 Integrals of Functions of Several Variables

(Recall that Tj D G.Rj /.) Substituting this and (7.3.22) into (7.3.21) yields

                     Z              Xk
                                         f .G.Yj //jJ G.Yj /jV .Rj /:
                         f .X/ d X
                                    j D1
                       T

But the sum on the right is a Riemann sum for the integral
                                       Z

                                          f .G.Y//jJ G.Y/j d Y;

                                                          S

which suggests that

                     Z                 Z

                           f .X/ d X D f .G.Y//jJ G.Y/j d Y:

                        T                  S

We will prove this by an argument that was published in the American Mathematical
Monthly [Vol. 61 (1954), pp. 81-85] by J. Schwartz.

The Main Theorem

We now prove the following form of the rule for change of variable in a multiple integral.

Theorem 7.3.8 Suppose that G W En ! Rn is regular on a compact Jordan measur-

able set S and f is continuous on G.S /: Then

                     Z                     Z

                               f .X/ d X D f .G.Y//jJ G.Y/j d Y:                (7.3.28)

                        G.S /                 S

   Since the proof is complicated, we break it down to a series of lemmas. We first observe
that both integrals in (7.3.28) exist, by Corollary 7.3.2, since their integrands are continu-
ous. (Note that S is compact and Jordan measurable by assumption, and G.S / is compact
and Jordan measurable by Theorem 7.3.5.) Also, the result is trivial if V .S / D 0, since then
V .G.S // D 0 by Lemma 7.3.4, and both integrals in (7.3.28) vanish. Hence, we assume
that V .S / > 0. We need the following definition.

Definition 7.3.9 If A D OEaij  is an n n matrix; then

                                    8            9
                                    <Xn                     =
                                           jaij j  1 Ä i Ä n
                               max  :                       ;

                                     j D1

is the infinity norm of A; denoted by kAk1.

Lemma 7.3.10 Suppose that G W En ! Rn is regular on a cube C in En; and let A be

a nonsingular n n matrix: Then

V .G.C // Ä j det.A/j max °kA 1G0.Y/k1  Y 2 C « n V .C /:                       (7.3.29)
                         Section 7.3 Change of Variables in Multiple Integrals 497

Proof Let s be the edge length of C . Let Y0 D .c1; c2; : : : ; cn/ be the center of C , and

suppose that H D .y1; y2; : : : ; yn/ 2 C . If H D .h1; h2; : : : ; hn/ is continuously differen-

tiable on C , then applying the mean value theorem (Theorem 5.4.5) to the components of

H yields

                              Xn @hi .Yi /
            hi .Y/ hi .Y0/ D        @yj .yj cj /; 1 Ä i Ä n;

                              j D1

where Yi 2 C . Hence, recalling that                       n
                                                    Ä @hi
                                                                 ;
                                        H0.Y/ D
                                                      @yj  i;j D1

applying Definition 7.3.9, and noting that jyj cj j Ä s=2, 1 Ä j Ä n, we infer that

            jhi .Y/  hi .Y0/j Ä s max °kH0.Y/k1  Y 2 C « ;          1 Ä i Ä n:
                                  2

This means that H.C / is contained in a cube with center X0 D H.Y0/ and edge length
                                     s max °kH0.Y/k1  Y 2 C « :

Therefore,           V .H.C // Ä max fkH0.Y/k1n  Y 2 C « sn                     (7.3.30)
Now let                          D max fkH0.Y/k1n  Y 2 C « V .C /:
                                         L.X/ D A 1X

and set H D L i G; then

                     H.C / D L.G.C // and H0 D A 1G0;

so (7.3.30) implies that                                                        (7.3.31)
                    V .L.G.C /// Ä max °kA 1G0.Y/k1  Y 2 C « n V .C /:

Since L is linear, Theorem 7.3.7 with A replaced by A 1 implies that

                               V .L.G.C /// D j det.A/ 1jV .G.C //:

This and (7.3.31) imply that
               j det.A 1/jV .G.C // Ä max °kA 1G0.Y/k1  Y 2 C « n V .C /:

Since det.A 1/ D 1= det.A/, this implies (7.3.29).

Lemma 7.3.11 If G W En ! Rn is regular on a cube C in Rn; then                  (7.3.32)
                                                    Z

                                    V .G.C // Ä jJ G.Y/j d Y:

                                                                             C
498 Chapter 7 Integrals of Functions of Several Variables

Proof Let P be a partition of C into subcubes C1, C2, . . . , Ck with centers Y1, Y2, . . . ,

Yk. Then

                                         Xk                                (7.3.33)
                          V .G.C // D V .G.Cj //:

                                         j D1

Applying Lemma 7.3.10 to Cj with A D G0.Aj / yields                        (7.3.34)
    V .G.Cj // Ä jJ G.Yj /j max °k.G0.Yj // 1G0.Y/k1  Y 2 Cj « n V .Cj /:

Exercise 6.1.22 implies that if > 0, there is a i > 0 such that       if kP k < i:
      max °k.G0.Yj // 1 G0.Y/k1  Y 2 Cj « < 1 C ; 1 Ä j Ä k;

Therefore, from (7.3.34),
                              V .G.Cj // Ä .1 C /njJ G.Yj /jV .Cj /;

so (7.3.33) implies that

                                    Xk
          V .G.C // Ä .1 C /n jJ G.Yj /jV .Cj / if kP k < i:

                          j D1

                                                           R          can be taken arbi-
Since the sum on the right is a Riemann sum for C jJ G.Y/j d Y and
trarily small, this implies (7.3.32).

Lemma 7.3.12 Suppose that S is Jordan measurable and ; > 0: Then there are

cubes C1; C2; . . . ; Cr in S with edge lengths < ; such that Cj      S; 1 Ä j Ä r;
                                                                                 (7.3.35)
C 0i \ C 0j D ; if i ¤ j; and
                                                  Xr

                                       V .S / Ä V .Cj / C :

                                         j D1

Proof     Since S is Jordan measurable,
                                      Z

                                            S .X/ d X D V .S /

                                                    C

if C is any cube containing S . From this and the definition of the integral, there is a i > 0
such that if P is any partition of C with kP k < i and is any Riemann sum of S over
P , then > V .S / =2. Therefore, if s.P / is the lower sum of S over P, then

                          s.P/ > V .S /        if kPk < i:                 (7.3.36)

Now suppose that P D fC1; C2; : : : ; Ckg is a partition of C into cubes with kP k <
min. ; i/, and let C1, C2, . . . , Ck be numberedPso that Cj S if 1 Ä j Ä r and
Cj \ S c ¤ ; if j > r . From (7.3.4), s.P/ D j D1 r V .Ck /. This and (7.3.36) imply
(7.3.35). Clearly, C 0i \ C 0j D ; if i ¤ j .
                                Section 7.3 Change of Variables in Multiple Integrals 499

Lemma 7.3.13 Suppose that G W En ! Rn is regular on a compact Jordan measur-

able set S and f is continuous and nonnegative on G.S /: Let
                             Z                        Z

                 Q.S / D               f .X/ d X           f .G.Y//jJ G.Y/j d Y:         (7.3.37)

                                G.S /                    S

Then Q.S / Ä 0:

Proof From the continuity of J G and f on the compact sets S and G.S /, there are
constants M1 and M2 such that

                                jJ G.Y/j Ä M1 if Y 2 S                                   (7.3.38)

and

                                jf .X/j Ä M2 if X 2 G.S /                                (7.3.39)

(Theorem 5.2.11). Now suppose that > 0. Since f i G is uniformly continuous on S
(Theorem 5.2.14), there is a i > 0 such that

     jf .G.Y// f .G.Y0//j < if jY Y0j < i and Y; Y0 2 S:                                 (7.3.40)

Now let C1, C2, . . . , Cr be chosen as described in Lemma 7.3.12, with                  p
                                       8                           9               D i= n. Let

                                       <               [r =
                                S1 D Y 2 S  Y ... Cj :
                                       :                           ;
                                                            j D1

Then V .S1/ < and                         0              1

                                             [r
                                       S D @ Cj A [ S1:
                                                                                         (7.3.41)

                                             j D1

Suppose that Y1, Y2, . . . , Yr are points in C1, C2, . . . , Cr and Xj D G.Yj /, 1 Ä j Ä r .

From (7.3.41) and Theorem 7.1.30,
                    Z                     Z

     Q.S / D                 f .X/ d X                f .G.Y//jJ G.Y/j d Y

                      G.S1 /                      S1     Xr Z      f .G.Y//jJ G.Y/j d Y

                       Xr Z            f .X/ d X
                    C

                    Z j D1 G.Cj / Z j D1 Cj

                 D           f .X/ d X                f .G.Y//jJ G.Y/j d Y

                      G.S1 /                       S1

                       Xr Z            .f .X/ f .Aj // d X
                    C

                       j D1 G.Cj /

                    C  Xr Z     ..f .G.Yj // f .G.Y///jJ.G.Y/j d Y

                       j D1 Cj                                              !

                       Xr                                   Z

                    C f .Xj / V .G.Cj //                           jJ G.Y/j d Y :

                       j D1                                    Cj
500 Chapter 7 Integrals of Functions of Several Variables

Since f .X/ 0,                   Z

                                       f .G.Y//jJ G.Y/j d Y 0;

                                    S1

and Lemma 7.3.11 implies that the last sum is nonpositive. Therefore,

                                    Q.S / Ä I1 C I2 C I3;                                                  (7.3.42)

where           Z                            Xr Z
                                      I2 D
       I1 D               f .X/ d X;                                                jf .X/  f .Xj /j d X;

                   G.S1/                                               j D1 G.Cj /

and r Z
                      X
                I3 D                jf .G/.Yj // f .G.Y//jjJ G.Y/j d Y:

                      j D1 Cj

We will now estimate these three terms. Suppose that > 0.

   To estimate I1, we first remind you that since G is regular on the compact set S , G is
also regular on some open set O containing S (Definition 6.3.2). Therefore, since S1 S
and V .S1/ < , S1 can be covered by cubes T1, T2, . . . , Tm such that

                                      Xr                                                                   (7.3.43)
                                          V .Tj / <

                                                                 j D1

and G is regular on j D1 Sm Tj . Now,

       I1 Ä M2V .G.S1//                                                (from (7.3.39))
                                                                       .since S1 [mj D1Tj /
                       X m                                             (from Lemma 7.3.11)
                Ä M2 V .G.Tj //                                        (from (7.3.38) and (7.3.43)):

                           j D1     jJ G.Y/j d Y

                       X m Z
                Ä M2

                      j D1 Tj

                Ä M2M1

   To estimate I2, we note that if X and Xj are in G.Cj / then X D G.Y/pand Xj D G.Yj /
for some Y and Yj in Cj . Since the edge length of Cj is less than i= n, it follows that
jY Yj j < i, so jf .X/ f .Xj /j < , by (7.3.40). Therefore,

                I2 <      Xr
                   Ä          V .G.Cj //
                   Ä
                   Ä      j D1      jJ G.Y/jd Y

                          Xr Z

                      j D1 Cj                                          (from Lemma 7.3.11)

                          Xr                                           (from (7.3.38)/
                      M1 V .Cj /                                       .since [j D1 r Cj S /:

                            j D1

                      M1V .S /
                           Section 7.3 Change of Variables in Multiple Integrals 501

   To estimate I3, we note again from (7.3.40) that jf .G.Yj // f .G.Y//j <      if Y and
Yj are in Cj . Hence,

                  I3 <     Xr Z jJ G.Y/jd Y

                           j D1 Cj

                                    Xr
                           Ä M1 V .Cj / (from (7.3.38)

                           j D1

                                   Ä M1V .S /
because j D1 Sr Cj S and C 0i \ C 0j D ; if i ¤ j .

   From these inequalities on I1, I2, and I3, (7.3.42) now implies that

                           Q.S / < M1.M2 C 2V .S // :

Since is an arbitrary positive number, it now follows that Q.S / Ä 0.

Lemma 7.3.14 Under the assumptions of Lemma 7.3.13; Q.S/ 0:

Proof Let      G1 D G 1; S1 D G.S /; f1 D .jJ Gj/f i G;

                                                                                 (7.3.44)

and            Z                      Z

     Q1.S1/ D              f1.Y/ d Y     f1.G1.X//jJ G1 .X/j d X:                (7.3.45)

                  G1 .S1/             S1

Since G1 is regular on S1 (Theorem 6.3.3) and f1 is continuous and nonnegative on
G1.S1/ D S , Lemma 7.3.13 implies that Q1.S1/ Ä 0. However, substituting from (7.3.44)
into (7.3.45) and again noting that G1.S1/ D S yields

                       Z

     Q1.S1/ D    f .G.Y//jJ G.Y/j d Y
               SZ
                                                                                 (7.3.46)
                       f .G.G 1.X///jJ G.G 1 .X//jjJ G 1.X/j d X:

                  G.S /

Since G.G 1.X// D X, f .G.G 1.X/// D f .X/. However, it is important to interpret the
symbol J G.G 1.X// properly. We are not substituting G 1.X/ into G here; rather, we are
evaluating the determinant of the differential matrix of G at the point Y D G 1.X/. From

Theorems 6.1.9 and 6.3.3,

                           jJ G.G 1.X//jjJ G 1 .X/j D 1;

so (7.3.46) can be rewritten as                 Z                        Q.S /:
                            Z
                                                       f .X/ d X D
              Q1.S1/ D f .G.Y//jJ G.Y/j d Y
                                                  G.S /
                                          S

Since Q1.S1/ Ä 0, it now follows that Q.S / 0.
502 Chapter 7 Integrals of Functions of Several Variables

We can now complete the proof of Theorem 7.3.8. Lemmas 7.3.13 and 7.3.14 imply

(7.3.28) if f is nonnegative on S . Now suppose that

                                      °               «
                              m D min f .X/  X 2 G.S / < 0:

Then f  m is nonnegative on G.S /, so (7.3.28) with f replaced by f m implies that

                 Z                         Z

                           .f .X/ m/ d X D .f .G.Y/ m/jJ G.Y/j d Y:                                           (7.3.47)

                    G.S /                     S

However, setting f D 1 in (7.3.28) yields

                               Z           Z

                                      d X D jJ G.Y/j d Y;

                               G.S /             S

so (7.3.47) implies (7.3.28).

The assumptions of Theorem 7.3.8 are too stringent for many applications. For example,

to find the area of the disc      °.x; y/  x2 C y2 Ä 1« ;

it is convenient to use polar coordinates and regard the circle as G.S /, where                               (7.3.48)
                                                      Ä

                                        G.r; Â/ D r cos Â
                                                         r sin Â

and S is the compact set

                               °                             «
                           S D .r; Â/  0 Ä r Ä 1; 0 Ä Â Ä 2                                                   (7.3.49)

(Figure 7.3.3).

                                                                                   y
        

                                                                                                 x2 + y2 = 1

        2                                                  G(S)
                    S                                                                       x

                               X = G(r, )

                                                   r
                           1

                                        Figure 7.3.3
                                  Section 7.3 Change of Variables in Multiple Integrals 503

Since                                          Ä
                                  G0.r; Â / D cos Â
                                                          r sin Â ;
                                                   sin Â  r cos Â

it follows that J G.r; Â/ D r . Therefore, formally applying Theorem 7.3.8 with f Á 1

yields                  Z         Z                       Z1         Z2

        AD                        d X D r d.r; Â/ D r dr dÂ D :

                           G.S /     S                         0     0

Although this is a familiar result, Theorem 7.3.8 does not really apply here, since G.r; 0/ D
G.r; 2 /, 0 Ä r Ä 1, so G is not one-to-one on S , and therefore not regular on S .

   The next theorem shows that the assumptions of Theorem 7.3.8 can be relaxed so as to
include this example.

Theorem 7.3.15 Suppose that G W En ! Rn is continuously differentiable on a

bounded open set N containing the compact Jordan measurable set S; and regular on
S 0: Suppose also that G.S / is Jordan measurable; f is continuous on G.S /; and G.C / is

Jordan measurable for every cube C N . Then

                        Z                   Z

                                  f .X/ d X D f .G.Y//jJ G.Y/j d Y:           (7.3.50)

                           G.S /               S

Proof Since f is continuous on G.S / and .jJ Gj/f iG is continuous on S , the integrals
in (7.3.50) both exist, by Corollary 7.3.2. Now let

                                              D dist .@S; N c /

(Exercise 5.1.25), and            °                            «

                                  P D Y  dist.Y; @S / Ä :
                                                                  2

Then P is a compact subset of N (Exercise 5.1.26) and @S P 0 (Figure 7.3.4).

   Since S is Jordan measurable, V .@S / D 0, by Theorem 7.3.1. Therefore, if > 0, we
can choose cubes C1, C2, . . . , Ck in P 0 such that

                                        @S        [k      Cj0

                                                                              (7.3.51)

                                                  j D1

and

                                     Xk                                       (7.3.52)
                                         V .Cj / <

                                     j D1

Now let S1 be the closure of the set of points in S that are not in any of the cubes C1,

C2, . . . , Ck; thus,                                      Ác
                                  S1 D S \ [kj D1Cj :
504 Chapter 7 Integrals of Functions of Several Variables

Because of (7.3.51), S1 \ @S D ;, so S1 is a compact Jordan measurable subset of S 0.
Therefore, G is regular on S1, and f is continuous on G.S1/. Consequently, if Q is as
defined in (7.3.37), then Q.S1/ D 0 by Theorem 7.3.8.

                                             S
                                          D
                              

                            N = open set bounded by outer curve
                            S = closed set bounded by inner curve

                                    Figure 7.3.4

Now

                       Q.S / D Q.S1/ C Q.S \ S1c / D Q.S \ S1c /                       (7.3.53)

(Exercise 7.3.11) and    Z                       Z                                   

                 c                                                                   
                                                                                     
     jQ.S \ S1 /j Ä                  f .X/ d X C           f .G.Y//jJ G.Y/j d Y :
                          G.S \S1c/               S \S c1                            

But              Z                                

                           f .G.Y//jJ G.Y/j d Y Ä M1M2V .S \ S1 /;        c             (7.3.54)
                                                                                       [kj D1Cj ,
                  S \S c1 
                                                                                        (7.3.55)
where M1 and M2 are as defined in (7.3.38) and (7.3.39).           Since  S  \  Sc

                                                                                  1

(7.3.52) implies that V .S \ S1k/ < ; therefore,
                       Z 
                              f .G.Y//jJ G.Y/j d Y Ä M1M2 ;
                        S \S c1 

from (7.3.54). Also

     Z                                                        Xk

                                                  c
                 f .X/ d X Ä M2V .G.S \ S1 // Ä M2 V .G.Cj //:                         (7.3.56)
      G.S \S1c/             
                                                           j D1
                                 Section 7.3 Change of Variables in Multiple Integrals 505

By the argument that led to (7.3.30) with H D G and C D Cj ,
                       V .G.Cj // Ä max °kG0.Y/k1  Y 2 Cj « n V .Cj /;

so (7.3.56) can be rewritten as

Z  ° 0  « n
                           f .X/ d X Ä M2 max kG .Y/k1  Y 2 P ;
 G.S \S1c/                          

because of (7.3.52). Since can be made arbitrarily small, this and (7.3.55) imply that
Q.S \ S1c / D 0. Now Q.S / D 0, from (7.3.53).

   The transformation to polar coordinates to compute the area of the disc is now justi-
fied, since G and S as defined by (7.3.48) and (7.3.49) satisfy the assumptions of Theo-
rem 7.3.15.

Polar Coordinates

If G is the transformation from polar to rectangle coordinates

                           Ä                   Ä
                                 x D G.r; Â/ D r cos Â ;
                                 y                r sin Â                    (7.3.57)

then J G.r; Â/ D r and (7.3.50) becomes

  Z                                      Z

                           f .x; y/ d.x; y/ D f .r cos Â; r sin Â/r d.r; Â/

                    G.S /                   S

if we assume, as is conventional, that S is in the closed right half of the r Â-plane. This
transformation is especially useful when the boundaries of S can be expressed conveniently
in terms of polar coordinates, as in the example preceding Theorem 7.3.15. Two more
examples follow.

Example 7.3.2 Evaluate

                                         Z
                                    I D .x2 C y/ d.x; y/;

                                              T

where T is the annulus T D °.x; y/  1 Ä x2 C y2 Ä 4«

(Figure 7.3.5(b)).

Solution We write T D G.S/, with G as in (7.3.57) and

                                 °                              «
                           S D .r; Â/  1 Ä r Ä 2; 0 Ä Â Ä 2
506 Chapter 7 Integrals of Functions of Several Variables

(Figure 7.3.5(a)). Theorem 7.3.15 implies that

                                     Z
                               I D .r 2 cos2 Â C r sin Â /r d.r; Â /;

                                                        S

which we evaluate as an iterated integral:

Z2      Z2

I D r 2 d r .r cos2 Â C sin Â / dÂ

Z 2 1 Z 2 0                                       ÁÄ
                    r C r cos 2Â C sin Â dÂ since cos2 Â D 1 .1 C cos 2Â/
D r2dr              0 22                                               2

1                                           2 Z  2 3 r 4 2  15
2 Z 2 Ä r Â r
D r  C sin 2Â cos Â  d r D                               r dr D  D :
1     24                                    Â D0      1    y 41 4

   2

                                                           T

                    S                                                  1 2x

                                            r

                    (a)                                    (b)

                          Figure 7.3.5

Example 7.3.3 Evaluate    Z

                          I D y d.x; y/;

                                    T

where T is the region in the xy-plane bounded by the curve whose points have polar coor-
dinates satisfying

                                     r D 1 cos Â; 0 Ä Â Ä

(Figure 7.3.6(b)).

Solution We write T D G.S /, with G as in (7.3.57) and S the shaded region in
Figure 7.3.6(a). From (7.3.50),

                                             Z

                                       I D .r sin Â/r d.r; Â/;

                                                                   S
                  Section 7.3 Change of Variables in Multiple Integrals 507

which we evaluate as an iterated integral:

         2 Z Z 1 cos Â 1 Z                               .1  cos Â /3 sin Â dÂ
      I D sin Â dÂ              r dr D
                                               30
         0 0
         D 1 .1 cos Â /4 4  D :
         12            03

      r                                                      y

             S
                                                                 T

                   x

             (a)                                             (b)

                            Figure 7.3.6

Spherical Coordinates

If G is the transformation from spherical to rectangular coordinates,

             23                             2  r cos Â cos      3
                x

             4 y 5 D G.r; Â; / D 4 r sin Â cos 5 ;                              (7.3.58)
                                                                                (7.3.59)
             ´                                 r sin

then         2                                                            3

                  cos Â cos                 r sin Â cos      r cos Â sin

      G0.r; Â; / D 4 sin Â cos              r cos Â cos      r sin Â sin 5

                       sin                               0 r cos

and J G.r; Â; / D r 2 cos , so (7.3.50) becomes
            Z

                    f .x; y; ´/ d.x; y; ´/

                    G.S /

                Z
            D f .r cos Â cos ; r sin Â cos ; r sin /r 2 cos d.r; Â; /

                         S

if we make the conventional assumption that j j Ä =2 and r 0.
508 Chapter 7 Integrals of Functions of Several Variables

Example 7.3.4 Let a > 0. Find the volume of
                 T D °.x; y; ´/  x2 C y2 C ´2 Ä a2; x 0; y 0; ´ 0« ;

which is one eighth of a sphere (Figure 7.3.7(b)).

                                                     

                                                   
                                                   2

                                                                                
                                                     
                                                     2
      a
r (a)
                          z

                           a

                                                           ay

     a
x

                             (b)

                    Figure 7.3.7

Solution We write T D G.S/ with G as in (7.3.58) and

S D .r; Â; /  0 Ä r Ä a; 0 Ä Â Ä =2; 0 Ä°                     «
                                                      Ä =2
                          Section 7.3 Change of Variables in Multiple Integrals 509

(Figure 7.3.7(a)), and let f Á 1 in (7.3.59). Theorem 7.3.15 implies that

          Z               Z

V .T / D            d X D r 2 cos d.r; Â; /

             G.S /           S
          2 Z a Z =2 Z =2 Â a3 Ã Á a3
          D r dr                dÂ         cos d D 3                   2 (7.3.1) D 6 :

             0         0                0

Example 7.3.5 Evaluate the iterated integral

                Z a Z pa2 x2 Z pa2 x2 y2

          I D x dx                         dy                    ´ d´  .a > 0/:

                    0        0                    0

Solution  We first rewrite I as a multiple integral

                                    Z

                                ID                x´ d.x; y; ´/

                                           G.S /

where G and S are as in Example 7.3.4. From Theorem 7.3.15,

Z

I D .r cos Â cos /.r sin /.r 2 cos / d.r; Â; /

   S            Z =2                                             Â a5 Ã  Â 1 Ã a5
Za                               Z =2

D r4dr                 cos Â dÂ            cos2 sin d   D 5 (7.3.1) 3 D 15 :

   0            0                0

Other Examples
We now consider other applications of Theorem 7.3.15.

Example 7.3.6 Evaluate

                                     Z

                                I D .x C 4y/ d.x; y/;

                                          T

where T is the parallelogram bounded by the lines

                x C y D 1; x C y D 2; x 2y D 0; and x 2y D 3
(Figure 7.3.8(b)).

Solution We define new variables u and v by

                       Ä                             Ä
                          u D F.x; y/ D x C y :
                          v                             x 2y
510 Chapter 7 Integrals of Functions of Several Variables

                                  v

      3

                                            x
                              S y = F-1(u,v)

                        1     2                                         u

                                    (a)

         y

                                            x - 2y = 0

                                                              x - 2y = 3

                                 T                                      x

                                                             x + y = 2
                                                    x + y = 1

                                     (b)

                              Figure 7.3.8

Then                    Ä 2 2u C v 3
                           xy D F 1.u; v/ D 64 u 3 7 v 5 ;

                                     2           3
                                            1  3  1
                        J F .u; v/ D 13
                                               D ;
                                     1      1 3
                                         3
                                            3

and T D F 1.S /, where

                           °                               «
                        S D .u; v/  1 Ä u Ä 2; 0 Ä v Ä 3
               Section 7.3 Change of Variables in Multiple Integrals 511

(Figure 7.3.8(a)). Applying Theorem 7.3.15 with G D F 1 yields

ID  Z Â 2u C v 4u 4v Ã Â 1Ã 1 Z
               C               d.u; v/ D .2u                    v/ d.u; v/
          3          3      3             3S
    S                       1 Z 3  2 2 
    1Z 3 Z 2
D 3 0 1 dv .2u v/ du D 3 0 .u         uv/ dv
    1Z 3             1 Â v2 Ã 3  3
                                             uD1

D 3 0 .3 v/dv D 3 3v 2 0 D 2 :

Example 7.3.7 Evaluate
                                  Z

                            I D e.x2 y2/2 e4x2y2 .x2 C y2/ d.x; y/;

                                                   T

where T is the annulus T D °.x; y/  a2 Ä x2 C y2 Ä b2« with a > 0 and b > 0 (Fig-

ure 7.3.9(a)).

          y                               y

          T                           T2                        T1
                  a
                        bx                                      a bx

                                      T3                        T4

          (a)                             (b)

                        Figure 7.3.9

Solution The forms of the arguments of the exponential functions suggest that we
introduce new variables u and v defined by

                                 Ä u Ä x2 y2
                                    v D F.x; y/ D 2xy

and apply Theorem 7.3.15 to G D F 1. However, F is not one-to-one on T 0 and therefore
has no inverse on T 0 (Example 6.3.4). To remove this difficulty, we regard T as the union
of the quarter-annuli T1, T2, T3, and T4 in the four quadrants (Figure 7.3.9)(b)), and let

                                  Z
                           Ij D e.x2 y2/2 e4x2y2 .x2 C y2/ d.x; y/:

                                                   Tj
512 Chapter 7 Integrals of Functions of Several Variables

Since the pairwise intersections of T1, T2, T3, and T4 all have zero content, I D I1 C
I2 C I3 C I4 (Corollary 7.1.31). Theorem 7.3.8 implies that I1 D I2 D I3 D I4 (Exer-
cise 7.3.12), so I D 4I1. Since I1 does not contain any pairs of distinct points of the form
.x0; y0/ and . x0; y0/, F is one-to-one on T1 (Example 6.3.4),

                      F.T1/ D S1 D °.u; v/  a4 Ä u2 C v2 Ä b4; v 0«

(Figure 7.3.10(b)),

                                                              v

      
                                                                                 s1

                       S1

                   a2         b2                                                                      u
                                                                                        a2 b2

                       (a)                                    (b)

                                    Figure 7.3.10

and a branch G of F 1 can be defined on S1 (Example 6.3.8). Now Theorem 7.3.15 implies

that                   Z

                   I1 D e.x2 y2/2 e4x2y2 .x2 C y2/jJ G.u; v/j d.u; v/;

                          S1

where x and y must still be written in terms of u and v. Since it is easy to verify that

                                    J F.x; y/ D 4.x2 C y2/

and therefore                                             1
                                    J G.u; v/ D 4.x2 C y2/ ;

doing this yields                   1 u2Cv2 Z

                                    I1 D 4 S1 e  d.u; v/:                                                (7.3.60)

To evaluate this integral, we let and  be polar coordinates in the uv-plane (Figure 7.3.11)

and define H by               Ä                  Ä

                                 u D H. ; / D cos  I
                                 v                     sin 

then S1 D H.eS 1/, where

                       e°             2             2                                «
                          S1 D . ; / a Ä Ä b ; 0 Ä  Ä
               Section 7.3 Change of Variables in Multiple Integrals 513

(Figure 7.3.10(a)); hence, applying Theorem 7.3.15 to (7.3.60) yields

           1 2 Z                                1 2 Z
        I1 D 4 eS1 e jJ H. ; /j d. ; / D 4 eS1 e d. ; /
           1 2 Z Z b2
        D      d        e dD                    .eb4 ea4/  I

           40     a2                            8

hence,

               I D 4I1 D .eb4                   e a4 /:
                              2

           v

                                                (u, v)
                                                                           u

                                       Figure 7.3.11

Example 7.3.8 Evaluate
                                    Z

                              I D ex1Cx2C Cxn d.x1; x2; : : : ; xn/;

                                                      T

where T is the region defined by

                           ai Ä x1 C x2 C C xi Ä bi ; 1 Ä i Ä n:

Solution We define the new variables y1, y2, . . . , yn by Y D F.X/, where

                            fi .X/ D x1 C x2 C  C xi; 1 Ä i Ä n:
If G D F 1 then T D G.S /, where

              S D OEa1; b1 OEa2; b2                OEan; bn;

and J G.Y/ D 1, since J F.X/ D 1 (verify); hence, Theorem 7.3.8 implies that
514 Chapter 7 Integrals of Functions of Several Variables

       Z

    I D eynd.y1; y2; : : : ; yn/

         S    Z b2            Z bn 1           Z bn            e yn dyn

       Z b1

    D dy1 dy2                         dyn   1

          a1  a2              an 1                         an

    D .b1 a1/.b2 a2/ .bn 1 an 1/.ebn ean/:

                    7.3 Exercises

1. Give a counterexample to the following statement: If S1 and S2 are disjoint subsets
      of a rectangle R, then either

    Z                   Z                   Z

          S1 .X/ d X C        S2 .X/ d X D                     S1[S2 .X/ d X

       R                   R                   R

or  Z                   Z                   Z

          S1 .X/ d X C        S2 .X/ d X D                     S1[S2 .X/ d X:

       R                   R                   R

2. Show that a set E has content zero according to Definition 7.1.14 if and only if E
      has Jordan content zero.

3. Show that if S1 and S2 are Jordan measurable, then so are S1 [ S2 and S1 \ S2.

4. Prove:

     (a) If S is Jordan measurable then so is S , and V .S / D V .S /. Must S be Jordan
             measurable if S is?

     (b) If T is a Jordan measurable subset of a Jordan measurable set S , then S T
             is Jordan measurable.

5. Suppose that H is a subset of a compact Jordan measurable set S such that the inter-
      section of H with any compact subset of S 0 has zero content. Show that V .H / D 0.

6. Suppose that E is an n n elementary matrix and A is an arbitrary n p matrix.
      Show that EA is the matrix obtained by applying to A the operation by which E is
      obtained from the n n identity matrix.

7. (a) Calculate the determinants of elementary matrices of types (a), (b), and (c)
             of Lemma 7.3.6.

     (b) Show that the inverse of an elementary matrix of type (a), (b), or (c) is an
             elementary matrix of the same type.

     (c) Verify the inverses given for bE1; : : : ; bE6 in Example 7.3.1.
                         Section 7.3 Change of Variables in Multiple Integrals 515

8. Write as a product of elementary matrices.
2                     3    2                     3
   101                             232

(a) 4 1 1 0 5 (b) 4 0 1 5 5

   011                             024

9. Suppose that ad bc ¤ 0, u1 < u2, and v1 < v2. Find the area of the parallelogram
      bounded by the lines

                         ax C by D u1;         ax C by D u2;
                         cx C dy D v1;         cx C dy D v2:

10. Find the volume of the parallelepiped defined by
                 1 Ä 2x C 3y 2´ Ä 2; 5 Ä x C 5y Ä 7; 1 Ä 2x C 4y Ä 6:

11. In writing Eqn. (7.3.53) we assumed that

   Z                               Z                      Z

                      f .X/ d X D            f .X/ d X C     G.S \S1c/  f .X/ d X:

      G.S /                           G.S1/

Justify this. HINT: Show that G.S1/ \ G.S \ S1c / has zero content:

12. Use Theorem 7.3.8 to show that I1 D I2 D I3 D I4 in Example 7.3.7.

13. Let ei D 1, 0 Ä i Ä n. Let T be a bounded subset of Rn and

      bT D .e1x1; e2x2; : : : ; enxn/  .x1; x2; : : : ; xn/ 2 T :°             «

Suppose that f is defined on T and define g on bT by

                      g.e1x1; e2x2; : : : ; enxn/ D e0f .x1; x2; : : : ; xn/:

(a) Prove directly from Definitions 7.1.2 and 7.1.17 that f is integrable on T if

and only if g is integrable on bT , and in this case

                           Z                        Z

                           bT      g.Y/ d Y D e0 f .X/ d X:

                                                       T

(b) Suppose that Tb D T ,

                      f .e1x1; e2x2; : : : ; enxn/ D f .x1; x2; : : : ; xn/;

and f is integrable on T . Show that
                                    Z

                                        f .X/ d X D 0:

                                                     T

14. Find the area of
°                                                «
(a) .x; y/  y Ä x Ä 4y; 1 Ä x C 2y Ä 3 ;
516 Chapter 7 Integrals of Functions of Several Variables

(b) .x; y/  2 Ä xy Ä 4; 2x Ä y Ä 5x .°         «

15. Evaluate                     Z

                                    .3x2 C 2y C ´/ d.x; y; ´/;

                                   T

where           T D .x; y; ´/  jx yj Ä 1; jy ´j Ä 1; j´ C xj Ä 1 :°     «

16. Evaluate                     Z

                                     .y2 C x2y 2x4/ d.x; y/;

                                    T

where T is the region bounded by the curves

                           xy D 1; xy D 2; y D x2; y D x2 C 1:

17. Evaluate                           Z
                                          .x4
                                               y4/exy d.x; y/;
                                         T

where T is the region in the first quadrant bounded by the hyperbolas

                  xy D 1; xy D 2; x2 y2 D 2; x2 y2 D 3:

18. Find the volume of the ellipsoid

                                 x2 y2 ´2
                                 a2 C b2 C c2 D 1 .a; b; c > 0/:

19. Evaluate                     Z ex2Cy2C´2

                                       p              d.x; y; ´/;
                                 T x2 C y2 C ´2

where                         T D °.x; y; ´/  9 Ä x2 C y2 C ´2 Ä 25« :

                                                                                          p
20. Find the volume of the set T bounded by the surfaces ´ D 0, ´ D x2 C y2, and

        x2 C y2 D 4.

21. Evaluate                     Z
                                     xy´.x4
                                               y4/ d.x; y; ´/;
                                   T

where                                     y2 Ä 2; 3 Ä x2 C y2 Ä 4; 0 Ä ´ Ä 1« :
         T D °.x; y; ´/  1 Ä x2

22. Evaluate
       Z p2 Z p4 y2 dx                                     Z 2 Z p4 x2
                                                                           ex2Cy2 dy
(a)             dy               1 C x2 C y2          (b) dx
                                     p
          0            py                                       0  0
Z 1 Z 1 x2 Z 1 x2 y2

(c) dx p dy                                    ´2 d´

             1             1 x2     0
                  Section 7.3 Change of Variables in Multiple Integrals 517

23. Use the change of variables

       23                                  2  r cos Â1 cos Â2 cos Â3       3
       x1
       66 x 4 2 77 6 5 D G.r; Â1; Â2; Â3/ D 6 r sin Â 4 1 cos Â2 cos Â3 775
       x3                                              r sin Â2 cos Â3

       x4                                                r sin Â3

to compute the content of the 4-ball
                   T D °.x1; x2; x3; x4/  x12 C x22 C x32 C x42 Ä a2« :

24. Suppose that A D OEaij  is a nonsingular n n matrix and T is the region in Rn
        defined by

       1 Ä ai1x1 C ai2x2 C C ainxn Ä i ; 1 Ä i Ä n:

(a) Find V .T /.

(b) Show that if c1, c2, . . . , cn are constants, then

                  Z X 0 n 1                V .T / Xn
                  @ cj xj A d X D                            di .i C i /;
                                              2 iD1
                  T j D1

where                            23                    23

                                    d1                   c1
                                 6      7       6 c2 7
                                 6  d2  7  t 16 7
                                 6 :: 7 D .A / 6 :: 7 :
                                 4:5                   4:5

                                    dn                   cn

                                           °             «
25. If Vn is the content of the n-ball T D X  jXj Ä 1 , find the content of the n-

dimensional ellipsoid defined by

                                        Xn x2j
                                               2 Ä 1:

                                        j D1 aj

Leave the answer in terms of Vn.
                CHAPTER 8
                Metric Spaces

IN THIS CHAPTER we study metric spaces.
SECTION 8.1 defines the concept and basic properties of a metric space. Several examples
of metric spaces are considered.
SECTION 8.2 defines and discusses compactness in a metric space.
SECTION 8.3 deals with continuous functions on metric spaces.

8.1 INTRODUCTION TO METRIC SPACES

Definition 8.1.1 A metric space is a nonempty set A together with a real-valued func-
tion defined on A A such that if u, v, and w are arbitrary members of A, then
(a) .u; v/ 0, with equality if and only if u D v;
(b) .u; v/ D .v; u/;
(c) .u; v/ Ä .u; w/ C .w; v/.
We say that is a metric on A.

If n 2 and u1, u2, . . . , un are arbitrary members of A, then (c) and induction yield

the inequality

                .u1; un/ Ä  nX1   .ui ; uiC1/:

                            i D1

Example 8.1.1 The set R of real numbers with .u; v/ D ju vj is a metric space.
Definition 8.1.1(c) is the familiar triangle inequality:

                ju vj Ä ju wj C jw uj:

   Motivated by this example, in an arbitrary metric space we call .u; v/ the distance from
u to v, and we call Definition 8.1.1(c) the triangle inequality.

                            518
                                                 Section 8.1 Introduction to Metric Spaces 519

Example 8.1.2 If A is an arbitrary nonempty set, then

                                       .u; v/ D 0 if u D v;
                                                    1 if u ¤ v

is a metric on A (Exercise 8.1.5). We call it the discrete metric.

   Example 8.1.2 shows that it is possible to define a metric on any nonempty set A. In
fact, it is possible to define infinitely many metrics on any set with more than one member
(Exercise 8.1.3). Therefore, to specify a metric space completely, we must specify the
couple .A; /, where A is the set and is the metric. (In some cases we will not be so
precise; for example, we will always refer to the real numbers with the metric .u; v/ D
ju vj simply as R.)

   There is an important kind of metric space that arises when a definition of length is
imposed on a vector space. Although we assume that you are familiar with the definition
of a vector space, we restate it here for convenience. We confine the definition to vector
spaces over the real numbers.

Definition 8.1.2 A vector space A is a nonempty set of elements called vectors on
which two operations, vector addition and scalar multiplication (multiplication by real
numbers) are defined, such that the following assertions are true for all U, V, and W in
A and all real numbers r and s:
 1. U C V 2 A;
 2. U C V D V C U;
 3. U C .V C W/ D .U C V/ C W;
 4. There is a vector 0 in A such that U C 0 D U;
 5. There is a vector U in A such that U C . U/ D 0;
 6. r U 2 A;
 7. r .U C V/ D r U C r V;
 8. .r C s/U D r U C sU;
 9. r .sU/ D .r s/U;
10. 1U D U.

   We say that A is closed under vector addition if (1) is true, and that A is closed under
scalar multiplication if (6) is true. It can be shown that if B is any nonempty subset of A
that is closed under vector addition and scalar multiplication, then B together with these
operations is itself a vector space. (See any linear algebra text for the proof.) We say that
B is a subspace of A.

Definition 8.1.3 A normed vector space is a vector space A together with a real-valued
function N defined on A, such that if u and v are arbitrary vectors in A and a is a real
number, then
(a) N.u/ 0 with equality if and only if u D 0;
(b) N.au/ D jajN.u/;
(c) N.u C v/ Ä N.u/ C N.v/.
We say that N is a norm on A, and .A; N / is a normed vector space.
520 Chapter 8 Metric Spaces

Theorem 8.1.4 If .A; N / is a normed vector space; then                           (8.1.1)
                                           .x; y/ D N.x y/

is a metric on A:

Proof From (a) with u D x y, .x; y/ D N.x y/ 0, with equality if and only
if x D y. From (b) with u D x y and a D 1,

                  .y; x/ D N.y x/ D N. .x y// D N.x y/ D .x; y/:
From (c) with u D x ´ and v D ´ y,

              .x; y/ D N.x y/ Ä N.x ´/ C N.´ y/ D .x; ´/ C .´; y/:

   We will say that the metric in (8.1.1) is induced by the norm N . Whenever we speak of
a normed vector space .A; N /, it is to be understood that we are regarding it as a metric
space .A; /, where is the metric induced by N .

   We will often write N.u/ as kuk. In this case we will denote the normed vector space as
.A; k k/.

Theorem 8.1.5 If x and y are vectors in a normed vector space .A; N /; then

                jN.x/ N.y/j Ä N.x y/:                                             (8.1.2)

Proof Since

                             x D y C .x y/;

Definition 8.1.3(c) with u D y and v D x y implies that

                             N.x/ Ä N.y/ C N.x y/;

or
                                     N.x/ N.y/ Ä N.x y/:

Interchanging x and y yields

                                     N.y/ N.x/ Ä N.y x/:    y and a D             1), the last

Since N.x y/ D N.y x/ (Definition 8.1.3(b) with u D x
two inequalities imply (8.1.2).

Metrics for Rn

In Section 5.1 we defined the norm of a vector X D .x1; x2; : : : ; xn/ in Rn as

                                    n !1=2
                                    X
                             kXk D        xi2  :

                                    i D1
                                     Section 8.1 Introduction to Metric Spaces 521

The metric induced by this norm is                         !1=2
                                                  Xn  yi /2 :

                                    .X; Y/ D .xi

                                          i D1

Whenever we write Rn without identifying the norm or metric specifically, we are referring
to Rn with this norm and this induced metric.

The following definition provides infinitely many norms and metrics on Rn.

Definition 8.1.6 If p     1 and X D .x1; x2; : : : ; xn/, let

                                          Xn            !1=p

                          kXkp D                jxi jp         :            (8.1.3)

                                          i D1

The metric induced on Rn by this norm is

                                          Xn                   !1=p

                          p.X; Y/ D             jxi     yi jp        :

                                          i D1

   To justify this definition, we must verify that (8.1.3) actually defines a norm. Since it is

clear that kXkp 0 with equality if and only if X D 0, and kaXkp D jajkXkp if a is any
real number and X 2 Rn, this reduces to showing that

                                     kX C Ykp Ä kXkp C kYkp                 (8.1.4)
for every X and Y in Rn. Since

                                        jxi C yi j Ä jxi j C jyi j;

summing both sides of this equation from i D 1 to n yields (8.1.4) with p D 1. To handle
the case where p > 1, we need the following lemmas. The inequality established in the
first lemma is known as Hölder's inequality.

Lemma 8.1.7 Suppose that 1; 2; . . . ; n and 1; 2; . . . ; n are nonnegative numbers:
Let p > 1 and q D p=.p 1/I thus;

                                11                                          (8.1.5)
                                p C q D 1:

Then                                 n !1=p n !1=q

       X               n        X                       X

                          i iÄ            p                       q     :   (8.1.6)

                                          i                       i

       i D1                     i D1                    i D1

Proof  Let  and  be any two positive numbers, and consider the function
                                            p q

                                  f ./ D p C q ;
522 Chapter 8 Metric Spaces

where we regard  as a constant. Since f 0./ D q 1  and f 00./ D .q 1/q                                    2>0

for  > 0, f assumes its minimum value on OE0; 1/ at  D 1=.q 1/ D p 1. But

               f .p 1/ D p C .p 1/q                              Â1 1                      Ã
                              p             q         p D p C                             1 D 0:

                                                                    pq

Therefore,                           p q                                                                  (8.1.7)
Now let                        Ä p C q if ;  0:

                           0  Xn        1 1=p                               0  Xn         1 1=q

                  i D      i @ jpA                   and i D i @                      qA         :

                                                                                      j

                           j D1                                                j D1

From (8.1.7),                           0            11               0           11

                                      p Xn                      q Xn
                        i i Ä i @                  pA C i @                     qA :
                                  p               j             q              j

                                        j D1                             j D1
From (8.1.5), summing this from i D 1 to n yields iD1 Pn i i Ä 1, which implies (8.1.6).

Lemma 8.1.8 (Minkowski's Inequality) Suppose that u1; u2; . . . ; un and v1;

v2; . . . ; vn are nonnegative numbers and p > 1: Then

                     nX                 !1=p          n !1=p                    n !1=p
                                                     X                         X
                           .ui C vi /p         Ä           uip        C              vip   :
                                                                                                          (8.1.8)

                     i D1                            i D1                      i D1

Proof Again, let q D p=.p 1/. We write

               Xn                     Xn                              Xn
                     .ui C vi /p D ui .ui C vi /p 1 C vi .ui C vi /p 1:
                                                                                                          (8.1.9)

               i D1                   i D1                            i D1

From Hölder's inequality with i D ui and i D .ui C vi /p 1,

            Xn                               n !1=p             Xn                   !1=q
                ui .ui C vi /p 1 Ä          X
                                                                      .ui C vi /p ;                       (8.1.10)
                                                     p

                                                ui

            i D1                            i D1                i D1

since q.p   1/ D p. Similarly,

               Xn                                  n !1=p             Xn                  !1=q
                    vi .ui C vi /p 1 Ä            X
                                                                            .ui C vi /p :
                 i D1                                      p
                                                                      i D1
                                                      vi

                                                  i D1

This, (8.1.9), and (8.1.10) imply that
                           2                           n !1=p3
n                                          !1=p       X                         X n                 !1=q
                                   n
X                             X                           vpi 5
            .ui C vi / Ä 4 uip          p          C                                  .ui C vi /p :
                                                      i D1
i D1                          i D1                                              i D1
                                         Section 8.1 Introduction to Metric Spaces 523

Since 1 1=q D 1=p, this implies (8.1.8), which is known as Minkowski's inequality.

    We leave it to you to verify that Minkowski's inequality implies (8.1.4) if p > 1.

    We now define the 1-norm on Rn by

                                             °                                            «
                          kXk1 D max jxi j  1 Ä i Ä n :                                                        (8.1.11)

We leave it to you to verify (Exercise 8.1.15) that k k1 is a norm on Rn. The associated

metric is              1.X; Y/ D max jxi yi j  1 Ä i Ä n :°                                      «

    The following theorem justifies the notation in (8.1.11).

Theorem 8.1.9 If X 2 Rn and p2 > p1 1; then

                                  kXkp2 Ä kXkp1 I                                                              (8.1.12)

moreover,                                     °                                               «
                       lim kXkp D max jxi j  1 Ä i Ä n :
                       p!1                                                                                     (8.1.13)

                                                                                          °                «
Proof Let u1, u2, . . . , un be nonnegative and M D max ui  1 Ä i Ä n . Define

                                              n !1=p
                                             X
                                  .p/ D            uip                              :

                                             i D1

Since ui =  .p/ Ä 1 and p2 > p1,
                                   Â ui Ãp1
                                       .p2/   Â ui Ãp2
                                                             I

                                                  .p2 /

therefore,

            .p1/ D  Xn Â     ui Ãp1 !1=p1               Xn Â                           ui Ãp2 !1=p1
            .p2 /            .p2/                                                                        D 1;
                    i D1                                i D1
                                                                                       .p2/

so .p1/ .p2/. Since M Ä .p/ Ä M n1=p, limp!1 .p/ D M . Letting ui D jxi j
yields (8.1.12) and (8.1.13).

   Since Minkowski's inequality is false if p < 1 (Exercise 8.1.19), (8.1.3) is not a norm in
this case. However, if 0 < p < 1, then

                                                      Xn
                                           kXkp D jxi jp

                                                                              i D1

is a norm on Rn (Exercise 8.1.20).

Vector Spaces of Sequences of Real Numbers

In this section and in the exercises we will consider subsets of the vector space R1 con-

sisting of sequences X D fxi g1 iD1, with vector addition and scalar multiplication defined

by

            X       C  Y  D  fxi  C       1   and         r                         X  D  fr  xi   1

                                     yi giD1                                                      gi D1 :
524 Chapter 8 Metric Spaces

Example 8.1.3 Suppose that 1 < p < 1 and let

                                     (                   1                    )
                                                 X
                        `p D X 2 R1  jxi jp < 1 :

                                                       i D1

Let                                              1               !1=p
Show that .`p; k                                 X
                                     kXkp D              jxi jp         :

                                                 i D1

                  kp/ is a normed vector space.

Solution  Suppose that X, Y 2 `p. From Minkowski's inequality,

                  Xn                 !1=p        Xn            !1=p           X  n             !1=p

                        jxi C yi jp        Ä           jxi jp           C              jyi jp

                  i D1                           i D1                         i D1

for each n. Since the right side remains bounded as n ! 1, so does the left, and

          1                    !1=p        1             !1=p           1              !1=p
          X                                X                            X
                  jxi C yi jp        Ä           jxi jp          C            jyi jp           ;
                                                                                                     (8.1.14)

          i D1                             i D1                         i D1

so X C Y 2 `p. Therefore, `p is closed under vector addition. Since `p is obviously closed
under scalar multiplication, `p is a vector space, and (8.1.14) implies that k kp is a norm
on `p.

The metric induced by k kp is

                                                 X 1                    !1=p
                                                     jxi
                               p.X; Y/ D                         yi jp           :
                                                 i D1

Henceforth, we will denote .`p ; k kp/ simply by `p.

Example 8.1.4 Let

                                     °                                              «
                                              1 1
                        `1 D X 2 R fxi giD1 is bounded :

Let                                                 ° «
                               kXk1 D sup jxi j  i 1 :

We leave it to you (Exercise 8.1.26) to show that .`1; k k1/ is a normed vector space.

The metric induced by k k1 is

                                                    °               «
                               1.X; Y/ D sup jxi yi j  i 1 :

Henceforth, we will denote .`1; k k1/ simply by `1.
                    Section 8.1 Introduction to Metric Spaces 525

Familiar Definitions and Theorems

At this point you may want to review Definition 1.3.1 and Exercises 1.3.6 and 1.3.7, which
apply equally well to subsets of a metric space .A; /.

   We will now state some definitions and theorems for a general metric space .A; / that
are analogous to definitions and theorems presented in Section 1.3 for the real numbers. To
avoid repetition, it is to be understood in all these definitions that we are discussing a given
metric space .A; /.

Definition 8.1.10 If u0 2 A and > 0, the set

                 °N .u0/ D u 2 A  .u0; u/ <           «

is called an -neighborhood of u0. (Sometimes we call S the open ball of radius centered

at u0.) If a subset S of A contains an -neighborhood of u0, then S is a neighborhood of

u0, and u0 is an interior point of S . The set of interior points of S is the interior of S ,
denoted by S 0. If every point of S is an interior point (that is, S 0 D S ), then S is open. A
set S is closed if S c is open.

Example 8.1.5 Show that if r > 0, then the open ball

                 °Sr .u0/ D u 2 A  .u0; u/ < r        «

is an open set.

Solution We must show that if u1 2 Sr .u0/, then there is an > 0 such that

                 S .u1/ Sr .u0/:                                            (8.1.15)

If u1 2 Sr .u0/, then .u1; u0/ < r . Since

                 .u; u0/ Ä .u; u1/ C .u1; u0/

for any u in A, .u; u0/ < r if .u; u1/ < r .u1; u0/. Therefore, (8.1.15) holds if
  < r .u1; u0/.
   The entire space A is open and therefore ; .D Ac / is closed. However, ; is also open,

for to deny this is to say that it contains a point that is not an interior point, which is absurd
because ; contains no points. Since ; is open, A .D ;c / is closed. If A D R, these are the
only sets that are both open and closed, but this is not so in all metric spaces. For example,
if is the discrete metric, then every subset of A is both open and closed. (Verify!)

   A deleted neighborhood of a point u0 is a set that contains every point of some neigh-
borhood of u0 except u0 itself. (If is the discrete metric then the empty set is a deleted
neighborhood of every member of A!)

   The proof of the following theorem is identical to the proof Theorem 1.3.3.
526 Chapter 8 Metric Spaces

Theorem 8.1.11
(a) The union of open sets is open.
(b) The intersection of closed sets is closed.

Definition 8.1.12 Let S be a subset of A. Then

(a) u0 is a limit point of S if every deleted neighborhood of u0 contains a point of S .

(b) u0 is a boundary point of S if every neighborhood of u0 contains at least one point
      in S and one not in S . The set of boundary points of S is the boundary of S , denoted
      by @S . The closure of S , denoted by S , is defined by S D S [ @S .

(c) u0 is an isolated point of S if u0 2 S and there is a neighborhood of u0 that contains
      no other point of S .

(d) u0 is exterior to S if u0 is in the interior of S c. The collection of such points is the
      exterior of S .

Although this definition is identical to Definition 1.3.4, you should not assume that con-

clusions valid for the real numbers are necessarily valid in all metric spaces. For example,

if A D R and .u; v/ D ju  vj, then  °

                          S r .u0/ D u  .u; u0/ Ä r :             «

This is not true in every metric space (Exercise 8.1.6).

   For the proof of the following theorem, see the proofs of Theorem 1.3.5 and Corol-
lary 1.3.6.

Theorem 8.1.13 A set is closed if and only if it contains all its limit points:

Completeness

Since metric spaces are not ordered, concepts and results concerning the real numbers that
depend on order for their definitions must be redefined and reexamined in the context of
metric spaces. The first example of this kind is completeness. To discuss this concept, we
begin by defining an infinite sequence (more briefly, a sequence) in a metric space .A; / as
a function defined on the integers n k with values in A. As we did for real sequences, we
denote a sequence in A by, for example, fung D fung1 nDk. A subsequence of a sequence
in A is defined in exactly the same way as a subsequence of a sequence of real numbers
(Definition 4.2.1).

Definition 8.1.14 A sequence fung in a metric space .A; / converges to u 2 A if

                                            lim .un; u/ D 0:                     (8.1.16)

                                                             n!1

In this case we say that limn!1 un D u.

   We leave the proof of the following theorem to you. (See the proofs of Theorems 4.1.2
and 4.2.2.)
Section 8.1 Introduction to Metric Spaces 527

Theorem 8.1.15
(a) The limit of a convergent sequence is unique:
(b) If limn!1 un D u; then every subsequence of fung converges to u:

Definition 8.1.16 A sequence fung in a metric space .A; / is a Cauchy sequence if
for every > 0 there is an integer N such that

.un; um/ < and m; n > N:                                              (8.1.17)

   We note that if is the metric induced by a norm k k on A, then (8.1.16) and (8.1.17)
can be replaced by

                                           lim kun uk D 0

                                                             n!1

and
                                 kun umk < and m; n > N;

respectively.

Theorem 8.1.17 If a sequence fung in a metric space .A; / is convergent; then it is
a Cauchy sequence.

Proof Suppose that limn!1 un D u. If > 0, there is an integer N such that
 .un; u/ < =2 if n > N . Therefore, if m, n > N , then

                                .un; um/ Ä .un; u/ C .u; um/ < :

Definition 8.1.18 A metric space .A; / is complete if every Cauchy sequence in A
has a limit.

Example 8.1.6 Theorem 4.1.13 implies that the set R of real numbers with .u; v/
D ju vj is a complete metric space.

   This example raises a question that we should resolve before going further. In Section 1.1
we defined completeness to mean that the real numbers have the following property:

  Axiom (I). Every nonempty set of real numbers that is bounded above has a supremum.
   Here we are saying that the real numbers are complete because every Cauchy sequence
of real numbers has a limit. We will now show that these two usages of "complete" are
consistent.
528 Chapter 8 Metric Spaces

The proof of Theorem 4.1.13 requires the existence of the (finite) limits inferior and

superior of a bounded sequence of real numbers, a consequence of Axiom (I). However,

the assertion in Axiom (I) can be deduced as a theorem if Axiom (I) is replaced by the

assumption that every Cauchy sequence of real numbers has a limit. To see this, let T be a

nonempty set of real numbers that is bounded above. We first show that there are sequences

fui  g1     and  fvi  g1     with  the  following  properties  for  all  i  1:

      i D1             i D1
                       Section 8.1 Introduction to Metric Spaces 529

(a) ui Ä t for some t 2 T and vi t for all t 2 T ;
(b) .vi ui / Ä 2i 1.v1 u1/.

(c) ui Ä uiC1 Ä viC1 Ä vi
  Since T is nonempty and bounded above, u1 and v1 can be chosen to satisfy (a) with

i D 1. Clearly, (b) holds with i D 1. Let w1 D .u1 C v1/=2, and let

                 .u2; v2/ D .w1; v1/ if w1 Ä t for some t 2 T ; .u1; w1/ if w1 t for all t 2 T :

In either case, (a) and (b) hold with i D 2 and (c) holds with i D 1. Now suppose that
n > 1 and fu1; : : : ; ung and fv1; : : : ; vng have been chosen so that (a) and (b) hold for
1 Ä i Ä n and (c) holds for 1 Ä i Ä n 1. Let wn D .un C vn/=2 and let

                 .unC1; vnC1/ D .wn; vn/ .un; wn/     if wn Ä t for some t 2 T ;
                                                      if wn t for all t 2 T :

Then (a) and (b) hold for 1 Ä i Ä n C 1 and (c) holds for 1 Ä i Ä n. This completes
the induction.

  Now (b) and (c) imply that

0 Ä uiC1 ui Ä 2i 1.v1 u1/ and 0 Ä vi viC1 Ä 2i 1.v1 u1/; i 1:

By an argument similar to the one used in Example 4.1.14, this implies that fui g1 iD1 and
fvi g1 iD1 are Cauchy sequences. Therefore the sequences both converge (because of our
assumption), and (b) implies that they have the same limit. Let

                 lim ui D lim vi D :
                 i !1                              i !1

If t 2 T , then vi t for all i , so  D limi!1 vi t; therefore,  is an upper bound of
T . Now suppose that > 0. Then there is an integer N such that uN >  . From the
definition of uN , there is a tN in T such that tN uN >  . Therefore,  D sup T .

Example 8.1.7 (The Metric Space COEa; b) Let C OEa; b denote the set of all

real-valued functions f continuous on the finite closed interval OEa; b. From Theorem 2.2.9,

the quantity     kf k D max jf .x/j  a Ä x Ä b°              «

is well defined. We leave it to you to verify that it is a norm on C OEa; b. The metric induced

by this norm is

                 .f; g/ D kf gk D max jf .x/ g.x/j  a Ä x Ä b :°                                  «

Whenever we refer to C OEa; b, we mean this metric space or, equivalently, this normed
linear space.

   From Theorem 4.4.6, a Cauchy sequence ffng in C OEa; b converges uniformly to a func-
tion f on OEa; b, and Corollary 4.4.8 implies that f is in C OEa; b; hence, C OEa; b is complete.
530 Chapter 8 Metric Spaces

The Principle of Nested Sets                           Tn for all n.
We say that a sequence fTng of sets is nested if TnC1

Theorem 8.1.19 (The Principle of Nested Sets) A metric space .A; / is
complete if and only if every nested sequence fTng of nonempty closed subsets of A such
that limn!1 d.Tn/ D 0 has a nonempty intersection:

Proof Suppose that .A; / is complete and fTng is a nested sequence of nonempty

closed subsets of A such that limn!1 d.Tn/ D 0. For each n, choose tn 2 Tn. If m n,

then tm, tn 2 Tn, so .tn; tm/ < d.Tn/. Since limn!1 d.Tn/ D 0, ftng is a Cauchy se-

quence. Therefore, limn!1 tn D t exists. Since t is a limit point of Tn and Tn is closed
for all n, t 2 Tn for all n. Therefore, t 2 \1 nD1Tn; in fact, \1 nD1Tn D ftg. (Why?)

Now suppose that .A; / is not complete, and let ftng be a Cauchy sequence in A that

°does not have a«limit. Choose n1 so that .tn; tn1 / < 1=2 if n n1, and let T1 D
 t  .t; tn1 / Ä 1 . Now suppose that j > 1 and we have specified n1, n2, . . . , nj 1

and T1, T2, . . . , Tj 1. Choose nj > nj 1 so that .tn; tnj / < 2 j if n      nj , and let
        °  j C1«
Tj D t .t; tnj / Ä 2    . Then Tj is closed and nonempty, Tj C1 Tj for all j ,
                                                                                 \1
and limj !1 d.Tj / D 0. Moreover, tn 2 Tj if n         nj .  Therefore, if t  2           T  j  ,
                                                                                    j D1

then .tn; t/ < 2 j , n  nj , so limn!1 tn D t, contrary to our assumption. Hence,
\1 j D1Tj D ;.

Equivalent Metrics

When considering more than one metric on a given set A we must be careful, for example,
in saying that a set is open, or that a sequence converges, etc., since the truth or falsity of
the statement will in general depend on the metric as well as the set on which it is imposed.
In this situation we will alway refer to the metric space by its "full name;" that is, .A; /
rather than just A.

Definition 8.1.20 If and are both metrics on a set A, then and            are equivalent
if there are positive constants  and  such that                                  (8.1.18)

                     .x; y/
              Ä .x; y/ Ä  for all x; y 2 A such that x ¤ y:

Theorem 8.1.21 If and are equivalent metrics on a set A; then .A; / and .A; /
have the same open sets.

Proof Suppose that (8.1.18) holds. Let S be an open set in .A; / and let x0 2 S . Then
there is an > 0 such that x 2 S if .x; x0/ < , so the second inequality in (8.1.18)
implies that x0 2 S if .x; x0/ Ä =. Therefore, S is open in .A; /.

   Conversely, suppose that S is open in .A; / and let x0 2 S . Then there is an > 0
such that x 2 S if .x; x0/ < , so the first inequality in (8.1.18) implies that x0 2 S if

 .x; x0/ Ä . Therefore, S is open in .A; /.
                                              Section 8.1 Introduction to Metric Spaces 531

Theorem 8.1.22 Any two norms N1 and N2 on Rn induce equivalent metrics on Rn:

Proof It suffices to show that there are positive constants  and  such

                                 Ä N1.X/ Ä  if          X ¤ 0:                              (8.1.19)
                                      N2.X /

We will show that if N is any norm on Rn, there are positive constants aN and bN such

that

                          aN kXk2 Ä N.X/ Ä bN kXk2 if X ¤ 0                                 (8.1.20)

and leave it to you to verify that this implies (8.1.19) with  D aN1 =bN2 and  D bN1 =aN2 .
   We write X Y D .x1; x2; : : : ; xn/ as

                                               Xn
                                   X Y D .xi yi /Ei ;

                                                    i D1

where Ei is the vector with i th component equal to 1 and all other components equal to 0.
From Definition 8.1.3(b), (c), and induction,

                                N .X           Xn       yi jN.Ei/I
                                        Y/ Ä jxi

                                                  i D1

therefore, by Schwarz's inequality,

                                   N.X Y/ Ä KkX Yk2;                                        (8.1.21)

where                                         Xn        !1=2
                                       KD
                                                    N 2.Ei/ :
From (8.1.21) and Theorem 8.1.5,
                                              i D1

                                jN.X/ N.Y/j Ä KkX Yk2;

so  N  is  continuous on  Rn    D  Rn.  By  Theorem  5.2.12,  there  are  vectors  U1  and  U2  such

                             2

that kU1k2 D kU2k2 D 1,

           °                               «                         °                      «
      N.U1/ D min N.U/  kUk2 D 1 ; and N.U2/ D max N.U/  kUk2 D 1 :

If aN D N.U1/ and bN D N.U2/, then aN and bN are positive (Definition 8.1.3(a)), and
                                          ÂXÃ

                              aN Ä N kXk2 Ä bN if X ¤ 0:

This and Definition 8.1.3(b) imply (8.1.20).
   We leave the proof of the following theorem to you.
532 Chapter 8 Metric Spaces

Theorem 8.1.23 Suppose that and are equivalent metrics on A: Then
(a) A sequence fung converges to u in .A; / if and only if it converges to u in .A; /:
(b) A sequence fung is a Cauchy sequence in .A; / if and only if it is a Cauchy sequence

      in .A; /:
(c) .A; / is complete if and only if .A; / is complete:

                                       8.1 Exercises

1. Show that (a), (b), and (c) of Definition 8.1.1 are equivalent to
        (i) .u; v/ D 0 if and only if u D v;
       (ii) .u; v/ Ä .w; u/ C .w; v/.

2. Prove: If x, y, u, and v are arbitrary members of a metric space .A; /, then

                                j .x; y/ .u; v/j Ä .x; u/ C .v; y/:

3. (a) Suppose that .A; / is a metric space, and define

                                       .u; v/
                      1.u; v/ D 1 C .u; v/ :

             Show that .A; 1/ is a metric space.
     (b) Show that infinitely many metrics can be defined on any set A with more than

             one member.

4. Let .A; / be a metric space, and let

                                     .u; v/
                      .u; v/ D 1 C .u; v/ :

      Show that a subset of A is open in .A; / if and only if it is open in .A; /.
5. Show that if A is an arbitrary nonempty set, then

                   .u; v/ D 0 if v D u;
                               1 if v ¤ u;

is a metric on A.

6. Suppose that .A; / is a metric space, u0 2 A, and r > 0.
                   °  «
(a) Show that S r .u0/ u  .u; u0/ Ä r if A contains more than one point.
                                                             °                      «
(b) Verify that if is the discrete metric, then S 1.u0/ ¤ u  .u; u0/ Ä 1 .
                                        Section 8.1 Introduction to Metric Spaces 533

7. Prove:
     (a) The intersection of finitely many open sets is open.
     (b) The union of finitely many closed sets is closed.

8. Prove:

     (a) If U is a neighborhood of u0 and U V , then V is a neighborhood of u0.
     (b) If U1, U2, . . . , Un are neighborhoods of u0, so is \niD1Ui .
9. Prove: A limit point of a set S is either an interior point or a boundary point of S .

10. Prove: An isolated point of S is a boundary point of S c .

11. Prove:

(a) A boundary point of a set S is either a limit point or an isolated point of S .
(b) A set S is closed if and only if S D S .

12. Let S be an arbitrary set. Prove: (a) @S is closed. (b) S 0 is open. (c) The exterior
       of S is open. (d) The limit points of S form a closed set. (e) S D S .

13. Prove:

(a)  .S1    \  S2/0  D  S0   \  S0      (b)                 S0   [  S0     .S1 [ S2/0

                          1       2                           1       2

14. Prove:

(a) @.S1 [ S2/ @S1 [ @S2                (b) @.S1 \ S2/ @S1 [ @S2

(c) @S @S                               (d) @S D @S c

(e) @.S T / @S [ @T

15. Show that

                                kXk D maxfjx1j; jx2j; : : : ; jxnjg

is a norm on Rn.

16. Suppose that .Ai ; i /, 1 Ä i Ä k, are metric spaces. Let

     A D A1 A2                  Ak D X D .x1; x2; : : : ; xk/  xi 2 Ai ; 1 Ä i Ä k :°  «

If X and Y are in A, let

                                                 Xk         .xi ; yi /:
                                     .X; Y/ D

                                                      i D1

(a) Show that is a metric on A.
534 Chapter 8 Metric Spaces

(b) Let fXr g1 rD1 D f.x1r ; x2r; : : : ; xkr/g1 rD1 be a sequence in A. Show that

                                  lim Xr D bX D .bx1; bx2; : : : ; bxk/

                                  r !1

     if and only if

                                      lim xir D bxi ; 1 Ä i Ä k:

                                     r !1

(c)  Show  that  fXr   g1     is  a  Cauchy             sequence          in  .A;    /  if  and  only  if  fxi r  g1     is  a

                        r D1                                                                                       r D1

     Cauchy sequence in .Ai ; i /, 1 Ä i Ä k.

(d) Show that .A; / is complete if and only if .Ai ; i / is complete, 1 Ä i Ä k.

17. For each positive integer i , let .Ai ; i / be a metric space. Let A be the set of all

        objects of the form X D .x1; x2; : : : ; xn; : : : /, where xi 2 Ai , i 1. (For example,
        if Ai D RP, i1 1, then A D R1.) Let fi g1 iD1 be any sequence of positive numbers
        such that iD1 i < 1.

(a) Show that

                                                           X 1                i .xi ; yi /
                                     .X; Y/ D i 1 C i .xi ; yi /
                                                           i D1

     is a metric on A.

(b)  Let  fXr g1 r D1  D  f.x1r   ;  x2r ;  :  :  :  ;  xnr ;  :  :  :  /g1      be  a  sequence  in   A.  Show   that

                                                                           r D1

                              lim Xr D bX D .bx1; bx2; : : : ; bxn; : : : /

                              r !1

     if and only if

                                     lim xir D bxi ; i 1:

                                     r !1

(c)  Show  that  fXr   g1     is  a  Cauchy             sequence          in  .A;    /  if  and  only  if  fxi r  g1     is  a

                        r D1                                                                                       r D1

     Cauchy sequence in .Ai ; i / for all i 1.

(d) Show that .A; / is complete if and only if .Ai ; i / is complete for all i 1.

18. Let C OE0; 1/ be the set of all real-valued functions continuous on OE0; 1/. For each
        nonnegative integer n, let

                             kf kn D max jf .x/j  0 Ä x Ä n°                            «

and                              n.f; g/ D kf gkn :
Define                                        1 C kf gkn
(a) Show that
                                            X 1 1
                                .f; g/ D 2n 1 n.f; g/:

                                                     nD1

                     is a metric on C OE0; 1/.
                                                  Section 8.1 Introduction to Metric Spaces 535

     (b) Let ffkg1 kD1 be a sequence of functions in C OE0; 1/. Show that
                                                   lim fk D f

                                                                      k!1

           in the sense of Definition 8.1.14 if and only if

                                                   lim fk.x/ D f .x/

                                                  k!1

               uniformly on every finite subinterval of OE0; 1/.
       (c) Show that .C OE0; 1/; / is complete.
19. Show that Minkowski's inequality is false if 0 < p < 1.
20. Suppose that 0 < p < 1. Show that if u and v are nonnegative, then

                                              .u C v/p Ä up C vp:

     Use this to show that if X, Y 2 Rn,

                                      Xn                                     Xn
                              .X/ D jxi jp; and                      .Y/ D jyi jp;

                                          i D1                                   i D1

     then
                                        .X C Y/ Ä .X/ C .Y/:

     Is a norm on Rn?

21.  Suppose  that      X  D  fxi  g1     is  in  `p ,  where  p  >  1.  Show  that

                                    i D1

     (a) X 2 `r for all r > p;

     (b) If r > p, then kXkr Ä kXkp;

     (c) limr!1 kXkr D kXk1.

22. Let .A; / be a metric space.

     (a) Suppose that fung and fvng are sequences in A, limn!1 un D u, and limn!1 vn D
           v. Show that limn!1 .un; vn/ D .u; v/.

     (b) Conclude from (b) that if limn!1 un D u and v is arbitrary in A, then
           limn!1 .un; v/ D .u; v/.

23. Prove: If fur g1 rD1 is a Cauchy sequence in a normed vector space .A; k k/, then
           kg1
     fkur           is  bounded.
              r D1

24. Let                 (1                                                                 )
                                                               X         1; are bounded :
              A D X 2 R1  the partial sums xi ; n

                                                               i D1

     (a) Show that                                              
                                                                Xn 
                                                                
                                                  kXk D sup  xi 
                                                           n 1 iD1 

           is a norm on A.

     (b) Let .X; Y/ D kX Yk. Show that .A; / is complete.
536 Chapter 8 Metric Spaces

25. (a) Show that                                     Zb

                                             kf k D jf .x/j dx

                                                             a

           is a norm on C OEa; b,
     (b) Show that the sequence ffng defined by

                                                              x a Án
                                                 fn.x/ D b a

          is a Cauchy sequence in .C OEa; b; k k/.

     (c) Show that .C OEa; b; k k/ is not complete.

26. (a) Verify that `1 is a normed vector space.
       (b) Show that `1 is complete.

27.  Let  A  be  the  subset  of   R1  consisting   of  convergent  sequences  X  D  fxi  g1 .   Define

                                                                                           i D1
     kXk D supi 1 jxi j. Show that .A; k k/ is a complete normed vector space.

28. Let A be the subset of R°1 consistin«g of sequences X D fxi g1 iD1 such that limi!1 xi D
        0. Define kXk D max jxi j  i 1 . Show that .A; k k/ is a complete normed vector
        space.

29.  (a)     Show  that  Rn    is  complete  if  p      1.

                            p

     (b) Show that `p is complete if p 1.

30. Show that if X D fxi g1 iD1 2 `p and Y D fyi g1 iD1 2 `q , where 1=p C 1=q D 1,
        then Z D fxi yi g 2 `1.

8.2 COMPACT SETS IN A METRIC SPACE

Throughout this section it is to be understood that .A; / is a metric space and that the sets
under consideration are subsets of A.

  °We say that «a collection H of open subsets of A is an open covering of T if T
[ H  H 2 H . We say that T has the Heine-Borel property if every open covering H

of T contains a finite collection Hb such that

                                             n              o
                                       T [ H  H 2 Hb :

   From Theorem 1.3.7, every nonempty closed and bounded subset of the real numbers
has the Heine-Borel property. Moreover, from Exercise 1.3.21, any nonempty set of reals
that has the Heine-Borel property is closed and bounded. Given these results, we defined
a compact set of reals to be a closed and bounded set, and we now draw the following
conclusion:

   A nonempty set of real numbers has the Heine-Borel property if and only if it is compact.
                                    Section 8.2 Compact Sets in a Metric Space 537

   The definition of boundedness of a set of real numbers is based on the ordering of the
real numbers: if a and b are distinct real numbers then either a < b or b < a. Since there
is no such ordering in a general metric space, we introduce the following definition.

Definition 8.2.1 The diameter of a nonempty subset S of A is

d.S / D sup .u; v/  u; v 2 T :      °                    «

If d.S / < 1 then S is bounded.

   As we will see below, a closed and bounded subset of a general metric space may fail
to have the Heine-Borel property. Since we want "compact" and "has the Heine-Borel
property" to be synonymous in connection with a general metric space, we simply make
the following definition.

Definition 8.2.2 A set T is compact if it has the Heine-Borel property.

Theorem 8.2.3 An infinite subset T of A is compact if and only if every infinite subset
of T has a limit point in T:

Proof Suppose that T has an infinite subset E with no limit point in T . Then, if t 2 T ,
there is a°n open set «Ht such that t 2 Ht and Ht contains at most one member of E. Then
H D [ Ht  t 2 T is an open covering of T , but no finite collection fHt1 ; Ht2 ; : : : ; Htk g
of sets from H can cover E, since E is infinite. Therefore, no such collection can cover T ;

that is, T is not compact.

   Now suppose that every infinite subset of T has a limit point in T , and let H be an open
covering of T . We first show that there is a sequence fHi g1 iD1 of sets from H that covers
T.

If > 0, then T can be covered by -neighborhoods of finitely many points of T . We

prove this by contradiction. Let t1 2 T . If N .t1/ does not cover T , there is a t2 2 T such

that .t1; t2/ . Now suppose that n 2 and we have chosen t1, t2, . . . , tn such that
 .ti ; tj / , 1 Ä i < j Ä n. If [niD1N .ti / does not cover T , there is a tnC1 2 T such

that .ti ; tnC1/ , 1 Ä i Ä n. Therefore, .ti ; tj / , 1 Ä i < j Ä n C 1. Hence,

by induction, if no finite collection of -neighborhoods of points in T covers T , there is an

infinite sequence ftng1 nD1 in T such that .ti ; tj /    , i ¤ j . Such a sequence could not
have a limit point, contrary to our assumption.

   By taking successively equal to 1, 1=2, . . . , 1=n, . . . , we can now conclude that, for
each n, there are points t1n, t2n, . . . , tkn;n such that

                                 T  [ kn  N1= n.ti n /:

                                    i D1

Denote Bin D N1=n.tin/, 1 Ä i Ä n, n 1, and define

fG1; G2; G3; :::g D fB11; : : : ; Bk1;1; B12; : : : ; Bk2;2; B13; : : : ; Bk3;3; : : : g:
538 Chapter 8 Metric Spaces

   If t 2 T , there is an H in H such that t 2 H . Since H is open, there is an > 0 such
that N .t/ H . Since t 2 Gj for infinitely many values of j and limj !1 d.Gj / D 0,

                                                    Gj N .t/ H

for  some  j.  Therefore,  if  f  G  j  i  g  1     is  the  subsequence  of  fGj g  such  that  Gji  is  a  subset  of
                                              i D1
some Hi in H (the fHi g are not necessarily distinct), then

                                                        T    [ 1   Hi :

                                                                                                             (8.2.1)

                                                             i D1

We will now show that                                        [N

                                                        T          Hi :                                      (8.2.2)

                                                             i D1

for some integer N . If this is not so, there is an infinite sequence ftng1 nD1 in T such that

                                                    [n                                                       (8.2.3)
                                              tn ... Hi ; n 1:

                                                      i D1

From our assumption, ftng1 nD1 has a limit t in T . From (8.2.1), t 2 Hk for some k, so
N .t / Hk for some > 0. Since limn!1 tn D t, there is an integer N such that

                               tn 2 N .t / Hk                [n    Hi ; n > k;

                                                             i D1

which contradicts (8.2.3). This verifies (8.2.2), so T is compact.

   Any finite subset of a metric space obviously has the Heine-Borel property and is there-
fore compact. Since Theorem 8.2.3 does not deal with finite sets, it is often more convenient
to work with the following criterion for compactness, which is also applicable to finite sets.

Theorem 8.2.4 A subset T of a metric A is compact if and only if every infinite se-
quence ftng of members of T has a subsequence that converges to a member of T:

Proof Suppose that T is compact and ftng T . If ftng has only finitely many distinct
terms, there is a t in T such that tn D t for infinitely many values of n; if this is so for
n1 < n2 < , then limj !1 tnj D t. If ftng has infinitely many distinct terms, then ftng
has a limit point t in T , so there are integers n1 < n2 < such that .tnj ; t/ < 1=j ;
therefore, limj !1 tnj D t .

   Conversely, suppose that every sequence in T has a subsequence that converges to a limit
in T . If S is an infinite subset of T , we can choose a sequence ftng of distinct points in
S . By assumption, ftng has a subsequence that converges to a member t of T . Since t is a
limit point of ftng, and therefore of T , T is compact.

Theorem 8.2.5 If T is compact; then every Cauchy sequence ftng1 nD1 in T converges
to a limit in T:
                                        Section 8.2 Compact Sets in a Metric Space 539

Proof By Theorem 8.2.4, ftng has a subsequence ftnj g such that

                        lim tnj D t 2 T:                                      (8.2.4)

                       j !1

We will show that limn!1 tn D t .

   Suppose that > 0. Since ftng is a Cauchy sequence, there is an integer N such that
 .tn; tm/ < , n > m N . From (8.2.4), there is an m D nj N such that .tm; t/ < .
Therefore,

                           .tn; t/ Ä .tn; tm/ C .tm; t/ < 2 ; n m:

Theorem 8.2.6 If T is compact; then T is closed and bounded.

Proof Suppose that t is a limit point of T . For each n, choose tn ¤ t 2 B1=n.t/ \ T .

Then limn!1 tn D t. Since every subsequence of ftng also converges to t, t 2 T , by

Theorem 8.2.3. Therefore, T is closed.  
                       °                     «
The family of unit open balls H D B1.t/  t 2 T is an open covering of T . Since T is

compact, there are finitely many members t1, t2, . . . , tn of T such that S [nj D1B1.tj /.
If u and v are arbitrary members of T , then u 2 B1.tr / and v 2 B1.ts/ for some r and s in

f1; 2; : : : ; ng, so

.u; v/ Ä .u; tr / C .tr ; ts/ C .ts; v/                          «
                                          °
                       Ä 2 C .tr ; ts/ Ä 2 C max .ti ; tj /  1 Ä i < j Ä n :

Therefore, T is bounded.

   The converse of Theorem 8.2.6 is false; for example, if A is any infinite set equipped
with the discrete metric (Example 8.1.2.), then eve°ry subset of«A is bounded and closed.
However, if T is an infinite subset of A, then H D ftg  t 2 T is an open covering of T ,
but no finite subfamily of H covers T .

Definition 8.2.7 A set T is totally bounded if for every > 0 there is a finite set T
with the following property: if t 2 T , there is an s 2 T such that .s; t/ < . We say that
T is a finite -net for T .

   We leave it to you (Exercise 8.2.4) to show that every totally bounded set is bounded and
that the converse is false.
540 Chapter 8 Metric Spaces

Theorem 8.2.8 If T is compact; then T is totally bounded.

Proof We will prove that if T is not totally bounded, then T is not compact. If T is not
totally bounded, there is an > 0 such that there is no finite -net for T . Let t1 2 T . Then
there must be a t2 in T such that .t1; t2/ > . (If not, the singleton set ft1g would be a
finite -net for T .) Now suppose that n 2 and we have chosen t1, t2, . . . , tn such that

 .ti ; tj / , 1 Ä i < j Ä n. Then there must be a tnC1 2 T such that .ti ; tnC1/ ,
1 Ä i Ä n. (If not, ft1; t2; : : : ; tng would be a finite -net for T .) Therefore, .ti ; tj / ,
1 Ä i < j Ä n C 1. Hence, by induction, there is an infinite sequence ftng1 nD1 in T such
that .ti ; tj / , i ¤ j . Since such a sequence has no limit point, T is not compact, by
Theorem 8.2.4.
                                                     Section 8.2 Compact Sets in a Metric Space 541

Theorem 8.2.9 If .A; / is complete and T is closed and totally bounded; then T is
compact.

Proof      Let  S   be  an  infinite  subset     of  T  ,  and  let  fsi  g1     be  a  sequence  of  distinct  members

                                                                           i D1
of S . We will show that fsi g1 iD1 has a convergent subsequence. Since T is closed, the limit
of this subsequence is in T , which implies that T is compact, by Theorem 8.2.4.

   For n 1, let T1=n be a finite 1=n-net for T . Let fsi0g1 iD1 D fsi g1 iD1. Since T1 is
finite and fsi0g1 iD1 is infinite, there must be a member t1 of T1 such that .si0; t1/ Ä 1
for infinitely many values of i . Let fsi1g1 iD1 be the subsequence of fsi0g1 iD1 such that

 .si1; t1/ Ä 1.

    We continue by induction. Suppose that n > 1 and we have chosen an infinite subse-

quence fsi;n    1 g1     of  fsi;n  2 g1 i D1 .  Since T1=n is finite and fsi;n         1g1           is  infinite,  there

                   i D1                                                                    i D1
must be member tn of T1=n such that .si;n 1; tn/ Ä 1=n for infinitely many values of

i.  Let fsing1 iD1  be the subsequence of fsi;n                 1g1       such that     .sin; tn/ Ä 1=n. From the

                                                                   i D1

triangle inequality,

                             .sin; sj n/ Ä 2=n; i; j 1; n 1:                                                    (8.2.5)

Now let bsi D sii , i 1. Then fbsi g1 iD1 is an infinite sequence of members of T . Mo-
roever, if i; j n, then bsi and bsj are both included in fsing1 iD1, so (8.2.5) implies that

 .bsi ;bsj / Ä 2=n; that is, fbsi g1 iD1 is a Cauchy sequence and therefore has a limit, since
.A; / is complete.

Example 8.2.1 Let T be the subset of `1 such that jxi j Ä i , i                                   1, where limi!1 i D
0. Show that T is compact.

Solution We will show that T is totally bounded in `1. Since `1 is complete (Exer-
cise 8.1.26), Theorem 8.2.9 will then imply that T is compact. °  «

   Let > 0. Choose N so that i Ä if i °> N. Let D max i  1 Ä« i Ä n and let p
be an integer such that p > . Let Q D ri  ri D integer inOE p; p . Then the subset
of `1 such that xi 2 Q , 1 Ä i Ä N , and xi D 0, i > N , is a finite -net for T .

Compact Subsets of COEa; b

In Example 8.1.7 we showed that C OEa; b is a complete metric space under the metric

                    .f; g/ D kf gk D max jf .x/ g.x/j  a Ä x Ä b :°                               «

We will now give necessary and sufficient conditions for a subset of C OEa; b to be compact.

Definition 8.2.10 A subset T of C OEa; b is uniformly bounded if there is a constant M

such that

                            jf .x/j Ä M if a Ä x Ä b and f 2 T:                                                 (8.2.6)

A subset T of C OEa; b is equicontinuous if for each > 0 there is a i > 0 such that

    jf .x1/ f .x2/j Ä if x1; x2 2 OEa; b; jx1 x2j < i; and f 2 T: (8.2.7)
542 Chapter 8 Metric Spaces

   Theorem 2.2.8 implies that for each f in C OEa; b there is a constant Mf which depends
on f , such that

                                   jf .x/j Ä Mf if a Ä x Ä b;
and Theorem 2.2.12 implies that there is a constant if which depends on f and such that

             jf .x1/ f .x2/j Ä if x1; x2 2 OEa; b and jx1 x2j < if :

The difference in Definition 8.2.11 is that the same M and i apply to all f in T .

Theorem 8.2.11 A nonempty subset T of C OEa; b is compact if and only if it is closed;
uniformly bounded; and equicontinuous.

Proof For necessity, suppose that T is compact. Then T is closed (Theorem 8.2.6)
and totally bounded (Theorem 8.2.8). Therefore, if > 0, there is a finite subset T D
fg1; g2; : : : ; gkg of C OEa; b such that if f 2 T , then kf gi k Ä for some i in f1; 2; : : : ; kg.
If we temporarily let D 1, this implies that

         kf k D k.f gi / C gi k Ä kf gi k C kgi k Ä 1 C kgi k;

which implies (8.2.6) with

                              °                   «
                            M D 1 C max kgi k  1 Ä i Ä k :

For (8.2.7), we again let be arbitary, and write

jf .x1/  f .x2/j Ä jf .x1/    gi .x1/j C jgi .x1/ gi .x2/j C jgi .x2/  f .x2/j
                  Ä jgi .x1/  gi .x2/j C 2kf gi k
                  < jgi .x1/  gi .x2/j C 2 :                                    (8.2.8)

Since each of the finitely many functions g1, g2, . . . , gk is uniformly continuous on OEa; b
(Theorem 2.2.12), there is a i > 0 such that

         jgi .x1/ gi .x2/j < if jx1 x2j < i; 1 Ä i Ä k:

This and (8.2.8) imply (8.2.7) with replaced by 3 . Since this replacement is of no
consequence, this proves necessity.

   For sufficiency, we will show that T is totally bounded. Since T is closed by assumption
and C OEa; b is complete, Theorem 8.2.9 will then imply that T is compact.

   Let m and n be positive integers and let

         r                                        sM        n Ä s Ä nI
         r D a C m .b a/; 0 Ä r Ä m; and Ás D n ;

that is, a D 0 < 1 < < m D b is a partition of OEa; b into subintervals of length
.b a/=m, and M D Á n < Á nC1 < < Án 1 < Án D M is a partition of the
                 Section 8.2 Compact Sets in a Metric Space 543

segment of the y-axis between y D M and y D M into subsegments of length M=n.
Let Smn be the subset of C OEa; b consisting of functions g such that

            fg. 0/; g. 1/; : : : ; g. m/g fÁ n; Á nC1 : : : ; Án 1; Áng

and g is linear on OE i 1; i , 1 Ä i Ä m. Since there are only .m C 1/.2n C 1/ points of the
form . r ; Ás/, Smn is a finite subset of C OEa; b.

Now suppose that > 0, and choose i > 0 to satisfy (8.2.7). Choose m and n so that

.b a/=m < i and 2M=n < . If f is an arbitrary member of T , there is a g in Smn such

that

                 jg. i / f . i /j < ; 0 Ä i Ä m:                          (8.2.9)

If 0 Ä i Ä m 1,

jg. i / g. iC1 /j D jg. i / f . i /j C jf . i / f . iC1/j C jf . iC1/ g. iC1 /j: (8.2.10)

Since iC1 i < i, (8.2.7), (8.2.9), and (8.2.10) imply that

                 jg. i / g. iC1 /j < 3 :

Therefore,

                 jg. i / g.x/j < 3 ; i Ä x Ä iC1;                         (8.2.11)

since g is linear on OE i ; iC1.
   Now let x be an arbitrary point in OEa; b, and choose i so that x 2 OE i ; iC1. Then

      jf .x/ g.x/j Ä jf .x/ f . i /j C jf . i / g. i /j C jg. i / g.x/j;

so (8.2.7), (8.2.9), and (8.2.11) imply that jf .x/ g.x/j < 5 , a Ä x Ä b. Therefore, Smn
is a finite 5 -net for T , so T is totally bounded.

Theorem 8.2.12 (Ascoli-Arzela Theorem) Suppose that F is an infinite uni-
formly bounded and equicontinuous family of functions on OEa; b: Then there is a sequence
ffng in F that converges uniformly to a continuous function on OEa; b:

Proof Let T be the closure of F ; that is, f 2 T if and only if either f 2 T or f
is the uniform limit of a sequence of members of F . Then T is also uniformly bounded
and equicontinuous (verify), and T is closed. Hence, T is compact, by Theorem 8.2.12.
Therefore, F has a limit point in T . (In this context, the limit point is a function f in
T .) Since f is a limit point of F , there is for each integer n a function fn in F such that
kfn f k < 1=n; that is ffng converges uniformly to f on OEa; b.

                 8.2 Exercises

1. Suppose that T1, T2, . . . , Tk are compact sets in a metric space .A; /. Show that
      [kj D1Tj is compact.
544 Chapter 8 Metric Spaces

2. (a) Show that a closed subset of a compact set is compact.

(b) Suppose that T is any collection of closed subsets of a metric space .A; /,
                                                      °        «
and some bT in T is compact. Show that \ T  T 2 T is compact.

(c) Show t°hatif T is«a collection of compact subsets of a metric space .A; /,
      then \ T  T 2 T is compact.

3. If S and T are nonempty subsets of a metric space .A; /, we define the distance

from S to T by      dist.S; T / D inf .s; t/  s 2 S; t 2 T :°  «

      Show that if S and T are compact, then dist.S; T / D .s; t/ for some s in S and
      some t in T .

4. (a) Show that every totally bounded set is bounded.
     (b) Let
                                               iir D 1 if i D r; 0 if i ¤ r;

and let T be the subset of `1 consisting of the sequences Xr D fiir g1 iD1,
r 1. Show that T is bounded, but not totally bounded.

5. Let T be a compact subset of a metric space .A; /. Show that there are members s

      and t of T such that d.s; t/ D d.T /.           1, where iD1 i P1 < 1. Show
6. Let T be the subset of `1 such that jxi j Ä i , i

      that T is compact.                              1, where i i P1 2 < 1. Show
7. Let T be the subset of `2 such that jxi j Ä i , i

that T is compact.

8. Let S be a nonempty subset of a metric space .A; / and le°t u0 be an arbitr«ary
      member of A. Show that S is bounded if and only if D D .u; u0/  u 2 S is
      bounded.

9. Let .A; / be a metric space.

(a) Prove: If S is a bounded subset of A, then S (closure of S ) is bounded. Find
      d.S /.

(b) Prove: If every bounded closed subset of A is compact, then .A; / is com-
      plete.

10. Let .A; / be the metric space defined in Exercise 8.1.16 Let

                                 T D T1 T2            Tk ;

        where Ti Ai and Ti ¤ ;, 1 Ä i Ä k. Show that T is compact if and only Ti is
        compact for 1 Ä i Ä k.

11. Let .A; / be the metric space defined in Exercise 8.1.17. Let

                             T D T1 T2        Tn            ;
        Section 8.3 Continuous Functions on Metric Spaces 545

     where Ti Ai and Ti ¤ ;, i          1. Show that if T is compact, then Ti is compact
     for all i 1.

12. Let fTng1 nD1 be a sequence of nonempty closed sets of a metric space such that (a)
       T1 is compact; (b) TnC1 Tn, n 1; and (c) limn!1 d.Tn/ D 0. Show that
        \1 nD1Tn contains exactly one member.

8.3 CONTINUOUS FUNCTIONS ON METRIC SPACES

In Chapter we studied real-valued functions defined on subsets of Rn, and in Chapter 6.4.
we studied functions defined on subsets of Rn with values in Rm. These are examples of
functions defined on one metric space with values in another metric space.(Of course, the
two spaces are the same if n D m.)

   In this section we briefly consider functions defined on subsets of a metric space .A; /
with values in a metric space .B; /. We indicate that f is such a function by writing

        f W .A; / ! .B; /:

The domain and range of f are the sets

     Df D u 2 A  f .u/ is defined°        «

and  °Rf D v 2 B  v D f .u/ for some u in Df :«

Definition 8.3.1 We say that                                                (8.3.1)
                                              lim f .u/ D bv
                                             u!bu

if bu 2 Df and for each > 0 there is a i > 0 such that
                      .f .u/;bv/ < if u 2 Df and 0 < .u; bu/ < i:

Definition 8.3.2 We say that f is continuous at bu if bu 2 Df and for each > 0 there
is a i > 0 such that

     .f .u/; f .bu// < if u 2 Df \ Ni .bu/:                                 (8.3.2)

If f is continuous at every point of a set S , then f is continuous on S.

   Note that (8.3.2) can be written as
                                    f .Df \ Ni.bu// N .f .bu//:

Also, f is automatically continuous at every isolated point of Df . (Why?)
546 Chapter 8 Metric Spaces

Example 8.3.1 If .A; k k/ is a normed vector space, then Theorem 8.3.5 implies that
f .u/ D kuk is a continuous function from .A; / to R, since

                                       jkuk kbukj Ä ku buk:

Here we are applying Definition 8.3.2 with .u; bu/ D ku buk and .v;bv/ D jv bvj.

Theorem 8.3.3 Suppose that bu 2 Df : Then

                             lim f .u/ D bv                                   (8.3.3)
                             u!bu                                             (8.3.4)
                                                                              (8.3.5)
if and only if

                              lim f .un/ D bv

                             n!1

for every sequence fung in Df such that

                              lim un D bu:

                             n!1

Proof Suppose that (8.3.3) is true, and let fung be a sequence in Df that satisfies
(8.3.5). Let > 0 and choose i > 0 to satisfy (8.3.1). From (8.3.5), there is an inte-
ger N such that .un; bu/ < i if n N . Therefore, .f .un/;bv/ < if n N , which
implies (8.3.4).

   For the converse, suppose that (8.3.3) is false. Then there is an 0 > 0 and a sequence
fung in Df such that .un; bu/ < 1=n and .f .un/;bv/ 0, so (8.3.4) is false.

   We leave the proof of the next two theorems to you.

Theorem 8.3.4 A function f is continuous at bu if and only if
                                           lim f .u/ D f .bu/:
                                           u!bu

Theorem 8.3.5 A function f is continuous at bu if and only if
                                           lim f .un/ D f .bu/

                                                            n!1

whenever fung is a sequence in Df that converges to bu.

Theorem 8.3.6 If f is continuous on a compact set T; then f .T / is compact.

Proof Let fvng be an infinite sequence in f .T /. For each n, vn D f .un/ for some un 2

T . Since T is compact, fung has a subsequence funj g such that limj !1 unj D bu 2 T
(Theorem 8.2.4). From Theorem 8.3.5, limj !1 f .unj / D f .bu/; that is, limj !1 vnj D
f .bu/. Therefore, f .T / is compact, again by Theorem 8.2.4.

Definition 8.3.7 A function f is uniformly continuous on a subset S of Df if for each
  > 0 there is a i > 0 such that

                .f .u/; f .v// < whenever .u; v/ < i and u; v 2 S:
                               Section 8.3 Continuous Functions on Metric Spaces 547

Theorem 8.3.8 If f is continuous on a compact set T; then f is uniformly continuous
on T .

Proof If f is not uniformly continuous on T , then for some 0 > 0 there are sequences
fung and fvng in T such that .un; vn/ < 1=n and

                                   .f .un/; f .vn// 0:                      (8.3.6)

Since T is compact, fung has a subsequence funk g that converges to a limit bu in T (Theo-
rem 8.2.4). Since .unk ; vnk / < 1=nk , limk!1 vnk D bu also. Then

                        lim f .unk / D lim f .vnk / D f .bu/
                        k!1            k!1

(Theorem 8.3.5), which contradicts (8.3.6).

Definition 8.3.9 If f W .A; / ! .A; / is defined on all of A and there is a constant 
in .0; 1/ such that

.f .u/; f .v// Ä  .u; v/ for all .u; v/ 2 A A;                              (8.3.7)

then f is a contraction of .A; /.

We note that a contraction of .A; / is uniformly continuous on A.

Theorem 8.3.10 (Contraction Mapping Theorem) If f is a contraction
of a complete metric space .A; /; then the equation

                                       f .u/ D u                            (8.3.8)

has a unique solution:

Proof To see that (8.3.8) cannot have more than one solution, suppose that u D f .u/

and v D f .v/. Then

                                   .u; v/ D .f .u/; f .v//:                 (8.3.9)

However, (8.3.7) implies that

                               .f .u/; f .v// Ä  .u; v/:                    (8.3.10)

Since (8.3.9) and (8.3.10) imply that

                                       .u; v/ Ä  .u; v/

and  < 1, it follows that .u; v/ D 0. Hence u D v.
   We will now show that (8.3.8) has a solution. With u0 arbitrary, define

                               un D f .un 1/; n 1:                          (8.3.11)

We will show that fung converges. From (8.3.7) and (8.3.11),

.unC1; un/ D .f .un/; f .un 1// Ä  .un; un 1/:                              (8.3.12)
548 Chapter 8 Metric Spaces

The inequality

                        .unC1; un/ Ä n .u1; u0/; n 0;                            (8.3.13)

follows by induction from (8.3.12). If n > m, repeated application of the triangle inequality
yields

                .un; um/ Ä .un; un 1/ C .un 1; un 2/ C C .umC1; um/;

and (8.3.13) yields

                .un; um/ Ä .u1; u0/m.1 C  C  C n m 1/ <  : m
                                                               1

Now it follows that

                        .un; um/ < .u1; u0/ N if n; m > N;
                                         1

and, since limN!1 N D 0, fung is a Cauchy sequence. Since A is complete, fung has a
limit bu. Since f is continuous at bu,

                        f .bu/ D lim f .un 1/ D lim un D bu;
                             n!1             n!1

where Theorem 8.3.5 implies the first equality and (8.3.11) implies the second.

Example 8.3.2 Suppose that h D h.x/ is continuous on OEa; b, K D K.x; y/ is con-
tinuous on OEa; b OEa; b, and jK.x; y/j Ä M if a Ä x; y Ä b. Show that if j j <
1=M.b a/ there is a unique u in C OEa; b such that

                u.x/ D h.x/ C  Zb                     a Ä x Ä b:                 (8.3.14)
                                   K.x; y/u.y/ dy;

                                 a

(This is Fredholm's integral equation.)

Solution  Let A be C OEa; b, which is complete. If u 2 C OEa; b, let f .u/ D v, where

                v.x/ D h.x/ C  Zb                     a Ä x Ä b:

                                    K.x; y/u.y/ dy;

                                 a

Since v 2 C OEa; b, f W C OEa; b ! C OEa; b. If u1, u2 2 C OEa; b, then

                jv1.x/                 Zb             v1.y/j dy;

                        v2.x/j Ä j j jK.x; y/jju1.y/

                                                a

so
                               kv1 v2k Ä j jM.b a/ku1 u2k:

Since j jM.b a/ < 1, f is a contraction. Hence, there is a unique u in C OEa; b such that
f .u/ D u. This u satisfies (8.3.14).
                                   Section 8.3 Continuous Functions on Metric Spaces 549

                                      8.3 Exercises

1. Suppose that f W .A; / ! .B; / and Df D A. Show that the following state-
      ments are equivalent.
     (a) f is continuous on A.
     (b) If V is any open set in .B; /, then f 1.V / is open in .A; /.
     (c) If V is any closed set in .B; /, then f 1.V / is closed in .A; /.

2. A metric space .A; / is connected if A cannot be written as A D A1 [ A2, where
      A1 and A2 are nonempty disjoint open sets. Suppose that .A; / is connected and
      f W .A; / ! .B; /, where Df D A, Rf D B, and f is continuous on A. Show
      that .B; / is connected.

3. Let f be a continuous real-valued function on a compact subset S of a metric space
      .A; /. Let be the usual metric on R; that is, .x; y/ D jx yj.
     (a) Show that f is bounded on S .
     (b) Let  D infu2S f .u/ and  D supu2S f .u/. Show that there are points u1
             and u2 in OEa; b such that f .u1/ D  and f .u2/ D .

4. Let f W .A; / ! .B; / be continuous on a subset U of A. Let u be in U and
      define the real-valued function g W .A; / ! R by

                                    g.u/ D .f .u/; f .u//; u 2 U:

     (a) Show that g is continuous on U .
     (b) Show that if U is compact, then g is uniformly continuous on U .
     (c) Show that if U is compact, then there is a bu 2 U such that g.u/ Ä g.bu/,

             u2 U.
5. Suppose that .A; /, .B; /, and .C; / are metric spaces, and let

                          f W .A; / ! .B; / and g W .B; / ! .C; /;

      where Df D A, Rf D Dg D B, and f and g are continuous. Define h W .A; / !
      .C; / by h.u/ D g.f .u//. Show that h is continuous on A.
6. Let .A; / be the set of all bounded real-valued functions on a nonempty set S ,
      with .u; v/ D sups2S ju.s/ v.s/j. Let s1, s2, . . . , sk be members of S , and
      f .u/ D g.u.s1/; u.s2/; : : : ; u.sk//, where g is real-valued and continuous on Rk .
      Show that f is a continuous function from .A; / to R.
7. Let .A; / be the set of all bounded real-valued functions on a nonempty set S ,
      with .u; v/ D sups2S ju.s/ v.s/j. Show that f .u/ D infs2S u.s/ and g.u/ D
      sups2S u.s/ are uniformly continuous functions from .A; / to R.
8. Let I OEa; b be the set of all real-valued functions that are Riemann integrable on

                                                                                       Zb
      OEa; b, with .u; v/ D supaÄxÄb ju.x/ v.x/j. Show that f .u/ D u.x/ dx is a

                                                                                                                               a

      uniformly continuous function from I OEa; b to R.
550 Answers to Selected Exercises

                              Answers to Selected
                                    Exercises

Section 1.1 pp. 9-10

1:1:1 (p. 9) (a) 2 max.a; b/ (b) 2 min.a; b/ (c) 4 max.a; b; c/ (d) 4 min.a; b; c/
                                                                                 p                 p
1:1:5 (p. 9) (a) 1 (no); 1 (yes) (b) 3 (no)p; 3 (no) p(c) 7 (yes); 7 (yes)
(d) 2 (no); 3 (no) (e) 1 (no); 1 (no) (f ) 7 (no); 7 (no)

Section 1.2 pp. 15-19                                            (c) 2 n.2n/S=.nS/2                (d) nn=nS
1:2:9 (p. 16) (a) 2n=.2n/S (b) 2 3n=.2n C 1/S

1:2:10 (p. 16) (b) no 1:2:11 (p. 16) (b) no
                                  0                  1
                                             Xn 1
                              xn                     A
1:2:20 (p. 18) An D @ln x
                                 nS j D1 j

1:2:21 (p. 18) fn.x1; x2; : : : ; xn/ D 2n 1 max.x1; x2; : : : ; xn/, gn.x1; x2; : : : ; xn/ D
2n 1 min.x1; x2; : : : ; xn/

Section 1.3 pp. 27-29

1:3:1 (p. 27) (a) OE 12 ; 1/; .       1;  1  /[OE1;  1/;  .  1;  0[. 32  ;  1/;  .0;  3  ;  .  1;  0    [  .  3  ;  1/;
                                          2                                           2                       2
       1
.  1;  2    [  OE1;  1/  (b)  .  3;   2/ [ .2; 3/; . 1;      3 [ OE 2; 2 [ OE3; 1/; ;; . 1; 1/;                     ;;

. 1; 3 [ OE 2; 2 [ OE3; 1/ (c) ;; . 1; 1/; ;; . 1; 1/; ;; . 1; 1/

(d) ;; . 1; 1/; OE 1; 1; . 1; 1/ [ .1; 1/; OE 1; 1; . 1; 1/

1:3:2 (p. 27) (a) .0; 3 (b) OE0; 2 (c) . 1; 1/ [ .2; 1/ (d) . 1; 0 [ .3; 1/

1:3:4  (p.     27)   (a)  1      (b)  1      (c) 6   (d) 1
                          4           6
                                                               Answers to Selected Exercises 551

1:3:5 (p. 27) (a) neither; . 1; 2/ [ .3; 1/; . 1; 1/ [ .2; 3/; . 1; 1 [ .2; 3/;
. 1; 1 [ OE2; 3 (b) open; S ; .1; 2/; OE1; 2 (c) closed; . 3S; °2/ [ .7; 8/; . 1; 3/ «[
. 2; 7/ [.8; 1/; . 1 3 [OE 2; 7 [OE8; 1/ (d) closed; ;; .n; n C 1/  n D integer ;
. 1; 1/ °  «
1:3:20 (p. 28) (a) x  x D 1=n; n D 1; 2; : : : ; (b) ; (c), (d) S1 D rationals,
S2 D irrationals (e) any set whose supremum is an isolated point of the set (f ), (g) the
rationals (h) S1 D rationals, S2 D irrationals

Section 2.1 pp. 48-53

2:1:2 (p. 48) Df D OE 2; 1/ [ OE3; 1/, Dg D . 1; 3 [ OE3; 7/ [ .7; 1/, Df g D

Dfg D OE3; 7/ [ .7; 1/, Df =g D .3; 4/ [ .4; 7/ [ .7; 1/         « °
                          °                                                     «
2:1:3° (p . 48)« (a), (b) x  x ¤ .2k C 1/ =2 where k D integer (c) x  x ¤ 0; 1
(d) x  x ¤ 0 (e) OE1; 1/

2:1:4 (p. 49) (a) 4 (b) 12 (c) 1 (d) 2 (e) 2

2:1:6  (p.  49)  (a)  11  (b)  2  (c)  1  (d) 2
                      17       3       3

2:1:7 (p. 49) (a) 0; 2 (b) 0, none (c) 31 ; 31   (d) none, 0
2:1:15 (p. 50) (a) 0 (b) 0 (c) none (d) 0        (e) none (f ) 0

2:1:18 (p. 50) (a) 0 (b) 0 (c) none (d) none (e) none (f ) 0

2:1:20 (p. 50) (a) 1 (b) 1 (c) 1 (d) 1 (e) 1 (f ) 1

2:1:22 (p. 51) (a) none (b) 1 (c) 1 (d) none

2:1:24 (p. 51) (a) 1 (b) 1 (c) 1 (d) 1 (e) none (f ) 1

2:1:31  (p.  52)  (a)  3  (b)  3  (c) 1   (d) 1           (e) 1  (f )  1
                       2       2                                       2

2:1:32 (p. 52) limx!1 r .x/ D 1 if n > m and an=bm > 0; D 1 if n > m and
an=bm < 0; D an=bm if n D m; D 0 if n < m. limx! 1 r .x/ D . 1/n m limx!1 r .x/

2:1:33 (p. 52) limx!x0 f .x/ D limx!x0 g.x/

2:1:37 (p. 52) (c) limx!x0 .f g/.x/ Ä limx!x0 f .x/ limx!x0 g.x/; limx!x0 .f
g/.x/ limx!x0 f .x/ limx!x0 g.x/

Section 2.2 pp. 69-73

2:2:3 (p. 69) (a) from the right (b) continuous (c) none (d) continuous (e)
none (f ) continuous (g) from the left
2:2:4 (p. 69) OE0; 1/, .0; 1/, OE1; 2/, .1; 2/, .1; 2, OE1; 2 2:2:5 (p. 69) OE0; 1/, .0; 1/,
.1; 1/ 2:2:13 (p. 70) (b) tanh x is continuous for all x, coth x for all x ¤ 0
552 Answers to Selected Exercises

2:2:16 (p. 7S0) No 2:2:21 (p. 71) (a) OE 1; 1, OE0; 1/ (b) nD 1S S1 .2n ; .2nC1/ /,
.0; 1/ (c) nD 1 1 .n ; .n C 1/ /, . 1; 1/ [ . 1; 1/ [ .1; 1/ (d) nD 1 1 OEn ; .n C
12 / , OE0; 1/

2:2:23 (p. 71) (a) . 1; 1/ (b) . 1; 1/         (c)  x0  ¤  .2k C  3  /; k D integer  (d)
                                                                  2
x ¤ 12                                      1                                     1
        (e) x ¤ 1        (f )  x  ¤  .k  C  2  /; k D integer  (g)   x  ¤  .k  C  2  /; k D

integer (h) x ¤ 0 (i) x ¤ 0

Section 2.3 pp. 84-88

2:3:4 (p. 85) (b) p.c/ D q.c/ and p0 .c/ D qC0 .c/

2:3:5 (p. 85) f .k/.x/ D n.n 1/ .n k 1/xn k 1jxj if 1 Ä k Ä n 1; f .n/.x/ D nS
if x > 0; f .n/.x/ D nS if x < 0; f .k/.x/ D 0 if k > n and x ¤ 0; f .k/.0/ does not

exist if k n.

2:3:7 (p. 85) (a) c0 D ac         bs, s0 D bc C as (b) c.x/ D eax cos bx, s.x/ D
eax sin bx

2:3:15 (p. 86) (b) f .x/ D 1 if x Ä 0, f .x/ D 1 if x > 0; then f 0.0C/ D 0, but
fC0 .0/ does not exist. (c) continuous from the right

2:3:22 (p. 87) There is no such function (Theorem 2.3.9).

2:3:24 (p. 87) Counterexample: Let x0 D 0, f .x/ D jxj3=2 sin.1=x/ if x ¤ 0, and
f .0/ D 0 .

2:3:27 (p. 88) Counterexample: Let x0 D 0, f .x/ D x=jxj if x ¤ 0, f .0/ D 0.

Section 2.4 pp. 96-98

2:4:2 (p. 96) 1   2:4:3  (p.   96)   1   2:4:4 (p. 96) 1       2:4:5 (p. 96) . 1/n 1n
                                     2
2:4:6 (p. 96) 1 2:4:7 (p. 96) 0 2:4:8 (p. 96) 1 2:4:9 (p. 96) 0

2:4:10 (p. 96) 0     2:4:11 (p. 96) 0          2:4:12 (p. 96) 1         2:4:13 (p. 96) 0
                     2:4:15 (p. 96) 0          2:4:16 (p. 96) 0         2:4:17 (p. 96) 1
2:4:14 (p. 96)    1  2:4:19 (p. 96) 1          2:4:20 (p. 96) e         2:4:21 (p. 96) 1
                  2  2:4:22 (p. 96) 0
2:4:18 (p. 96) 1

2:4:24 (p. 96) 1=e

2:4:23 (p. 96) 1 if  Ä 0, 0 if  > 0

2:4:25 (p. 96) e2 2:4:26 (p. 96) 1 2:4:27 (p. 96) 0 2:4:28 (p. 96) 0

2:4:29 (p. 96) 1 if  > 0, 1 if  Ä 0

2:4:30 (p. 96) 1 2:4:31 (p. 97) 1 2:4:32 (p. 97) 1=120 2:4:33 (p. 97) 1

2:4:34 (p. 97) 1 2:4:35 (p. 97) 1 if  Ä 0, 0 if  > 0

2:4:36 (p. 97) 1 2:4:37 (p. 97) 1 2:4:38 (p. 97) 0 2:4:39 (p. 97) 0

2:4:40 (p. 97) 0 2:4:41 (p. 97) (b) Suppose that g0 is continuous at x0 and f .x/ D
g.x/ if x Ä x0, f .x/ D 1 C g.x/ if x > x0.

2:4:44 (p. 97) (a) 1 (b) e (c) 1 2:4:45 (p. 98) eL
                                                                   Answers to Selected Exercises 553

Section 2.5 pp. 107-112

2:5:2 (p. 107) f .nC1/.x0/=.nC 1/S. 2:5:4 (p. 107) (b) Counterexample: Let x0 D 0
and f .x/ D xjxj.

2:5:5 (p. 108) (b) Let g.x/ D 1 C jx x0j, so f .x/ D .x x0/.1 C jx x0j/.

2:5:6 (p. 108) (b) Let g.x/ D 1 C jx x0j, so f .x/ D .x x0/2.1 C jx x0j/.

2:5:10 (p. 109) (b) (i) 1, 2, 2, 0 (ii) 0, , 3 =2, 4 C 3=2
         (iii) 2=4, 2 , 6 C 2=4, 4 (iv) 2, 5, 16, 65

2:5:11 (p. 109) (b) 0, 1, 0, 5                                                       pp p

2:5p:12 (p. 110) (b) (i) 0, 1, 0, 5 (ii) 1, 0, 6, 24 (iii) 2, 3 2, 11 2,
57 2             (iv) 1, 3, 14, 88 (a) min (b) neither (c) min (d) max (e)

min (f ) neither (g) min (h) min

2:5:14 (p. 110) f .x/ D e 1=x2 if x ¤ 0, f .0/ D 0 (Exercise 2:5:1 (p. 107))
                                                                                 p

2:5:15 (p. 111) Npone if b2 4c < 0; local min at x1 D . b C b2 4c/=2 and local
max at x1 D . b b2 4c/=2 if b2 4c > 0; if b2 D 4c then x D b=2 is a critical

point, but not a local extreme point.

                            1 Á3                1            2               1

2:5:16 (p. 111) (a) 6 20 (b) 83 (c) 512p2 (d) 4.63/4

2:5:20 (p. 112) (a) M3h=3, where M3 D supjx cjÄh jf .3/.c/j
    (b) M4h2=12 where M4 D supjx cjÄh jf .4/.c/j

2:5:21 (p. 112) k D h=2

Section 3.1 pp. 125-128

3:1:8 (p. 126) (b) monotonic functions (c) Let OEa; b D OE0; 1 and P D f0; 1g. Let
                    1
f .0/  D  f .1/  D  2  and  f .x/  D  x  if  0  <  x  <  1.  Then  s.P /  D  0  and  S.P /  D  1,  but  neither

is a Riemann sum of f over P .

3:1:9 (p. 127) (a) 21 , 12 (b) 12 , 1 3:1:10 (p. 127) eb ea 3:1:11 (p. 127)
1 cos b 3:1:12 (p. 127) sin b

3:1:14 (p. 127) f .a/OEg1 g.a/ C f .d /.g2 g1/ C f .b/OEg.b/ g2
3:1:15 (p. 127) f .a/OEg1 g.a/ C f .b/OEg.b/ gp C mD1 Pp 1 f .am/.gmC1 gm/
3:1:16 (p. 127) (a) If g Á 1 and f is arbitrary, then a R b f .x/ dg.x/ D 0.

Section 3.3 pp. 149-151

3:3:7  (p.  150)    (a)  u  D  c   D  2      (b) u D c D 0         (c) u D .e        2/=.e               p
                                      3                                                        1/; c D u
554 Answers to Selected Exercises

Section 3.4 pp. 165-171

3:4:4 (p. 166)

(a) (i) p 2 (ii) p > 0                        (iii) 0

(b) (i) p 2 (ii) p > 0                        (iii) 0

(c) (i) none (ii) p > 0                       (iii) 1=p

(d) (i) p Ä 0 (ii) 0 < p < 1 (iii) 1=.1 p/

(e) (i) none (ii) none

3:4:5 (p. 166) (a) nS  (b)          1  (c) divergent              (d) 1            (e) 1         (f ) 0
                                    2

3:4:8 (p. 166) (a) divergent (b) convergent (c) divergent (d) convergent (e)

convergent (f ) divergent

3:4:9 (p. 166) (a) p < 2 (b) p < 1 (c) p > 1 (d) 1 < p < 2 (e) none
(f ) none (g) p < 1

3:4:11 (p. 167) (a) p q < 1 (b) p; q < 1 (c) 1 < p < 2q 1 (d) q > 1,
p C q > 1 (e) p C q > 1 (f ) q C 1 < p < 3q C 1

3:4:12 (p. 167) deg g deg f 2

3:4:18 (p. 168)

(a) (i) p > 1          (ii) 0 < p Ä 1

(b) (i) p > 1          (ii) p Ä 1

(c) (i) p > 1          (ii) 0 Ä p Ä 1

(d) (i) p > 0          (ii) none

(e) (i) 1 < p < 4 (ii) 0 < p Ä 1

(f )   (i)  p  >  1    (ii)      0  <  p  Ä   1
                  2                           2

3:4:25 (p. 169)

(a) (i) p > 1 (ii) 2 < p Ä 1
(b) (i) p > 1 (ii) none
(c) (i) p < 1 (ii) none
(d) (i) none (ii) none
(e) (i) p < 1 (ii) p > 1

Section 4.1 pp. 192-195

4:1:3 (p. 192) (a) 2 (b) 1 (c) 0 4:1:4 (p. 192) (a) 1=2 (b) 1=2 (c)

1=2 (d) 1=2                      4:1:14 (p. 193) (a) 1                         (b) 1         (c) 1       (d) 1
                              p

4:1:11 (p. 192) (d) A

(e) 0

4:1:22 (p. 193) If sn D 1 and tn D 1=n, then .limn!1 sn/=.limn!1 tn/ D 1=0 D 1,
but limn!1 sn=tn D 1.

4:1:24 (p. 193) (a) 1, 0 (b) 1, 1 if jrj > 1; 2, 2 if r D 1; 0, 0 if r D 1; 1,
                                                                      21 ,  1
1 if jrj < 1   (c) 1,  1 if r <           1;  0,  0  if  jr j  <  1;        2  if  r  D  1;  1,  1 if r > 1

(d) 1, 1 (e) jtj, jtj
                                       Answers to Selected Exercises 555

                                                                       p         p
4:1:25 (p. 194) (a) 1, 1 (b) 2, 2 (c) 3, 1 (c) 3=2, 3=2

4:1:34  (p.  194)  (b)  If fsng  D  f1; 0; 1; 0; : : : g, then limn!1  tn  D  1
                                                                              2

Section 4.2 pp. 199-200

4:2:2 (p. 199) (a) limm!1 s2m D 1, limm!1 s2mC1 D 1
(b) limm!1 s4m D 1, limm!1 s4mC2 D 1, limm!1 s2mC1 D 0
(c) limm!1 s2m D 0, limm!1 s4mC1 D 1, limm!1 s4mC3 D 1
(d) limn!1 sn D 0 (e) limm!1 s2m D 1, limm!1 s2mC1pD 0
(f ) limm!1 s8m D limm!1 s8mC2 D 1, limm!1 s8mC1 D 2, p

     limm!1 s8mC3 D limm!1 s8mC7 D 0, limm!1 s8mC5 D 2,
     limm!1 s8mC4 D limm!1 s8mC6 D 1
4:2:3 (p. 199) f1; 2; 1; 2; 3; 1; 2; 3; 4; 1; 2; 3; 4; 5; : : : g

4:2:8 (p. 200) Let ftng be any convergent sequence and fsng D ft1; 1; t2; 2; : : : ; tn; n; : : : g.

Section 4.3 pp. 228-234

4:3:4 (p. 229) (b) No; consider P 1=n

4:3:8 (p. 229) (a) convergent (b) convergent (c) divergent (d) divergent
(e) convergent (f ) convergent (g) divergent (h) convergent

4:3:10 (p. 229) (a) p > 1 (b) p > 1 (c) p > 1

4:3:15 (p. 230) (a) convergent (b) convergent if 0 < r < 1, divergent if r 1
(c) divergent (d) convergent (e) divergent (f ) convergent

4:3:17 (p. 231) (a) convergent (b) convergent (c) convergent (d) convergent

4:3:18 (p. 231) (a) divergent (b) convergent if and only if 0 < r < 1 or r D 1 and
p < 1 (c) convergent (d) convergent (e) convergent

4:3:19 (p. 231) (a) divergent (b) convergent (c) convergent (d) convergent if
 <  1, divergent if   1

4:3:20 (p. 231) (a) divergent       (b) convergent (c) convergent (d) convergent
                                    (b) P. 1/n=n, P Ä . 1/n C 1
4:3:21 (p. 231) (a) P. 1/n
(c) P. 1/n2n (d) P. 1/n                                           n n log n

4:3:27 (p. 232) (a) conditionally convergent (b) conditionally convergent (c) abso-
lutely convergent (d) absolutely convergent

4:3:28 (p. 232) Let k and s be the degrees of the numerator and denominator, respec-
tively. If jr j D 1, the series converges absolutely if and only if s k C 2. The series
converges conditionally if s D k C 1 and r D 1, and diverges in all other cases, where
s k C 1 and jr j D 1.

                            P np
4:3:30 (p. 232) (b) . 1/ = n 4:3:41 (p. 233) (a) 0 (b) 2A a0
556 Answers to Selected Exercises

Section 4.4 pp. 253-256

4:4:1 (p. 253) (a) F .x/ D 0; jxj Ä 1 (b) F .x/ D 0; jxj Ä 1

(c) F .x/ D 0; 1 < x Ä 1 (d) F .x/ D sin x; 1 < x < 1

(e) F .x/ D 1; 1 < x Ä 1; F .x/ D 0; jxj > 1 (f ) F .x/ D x; 1 < x < 1
(g) F .x/ D x2=2; 1 < x < 1 (h) F .x/ D 0; 1 < x < 1

(i) F .x/ D 1; 1 < x < 1

4:4:5 (p. 254) (a) F .x/ D 0 (b) F .x/ D 1; jxj < 1; F .x/ D 0; jxj > 1
(c) F .x/ D sin x=x

4:4:6 (p. 254) (c) Fn.x/ D xn; Sk D OE k=.k C 1/; k=.k C 1/

4:4:7 (p. 254) (a) OE 1; 1 (b) OE r; r [ f1g [ f 1g; 0 < r < 1 (c) OE r; r [ f1g; 0 <

r <1
(d) OE r; r; r > 0 (e) . 1; 1=r [ OE r; r [ OE1=r; 1/ [ f1g; 0 < r < 1
(f ) OE r; r; r > 0 (g) OE r; r; r > 0 (h) . 1; r [ OEr; 1/ [ f0g; r > 0
(i) OE r; r; r > 0

4:4:12 (p. 254) (b) Let S D .0; 1, Fn.x/ D sin.x=n/, Gn.x/ D 1=x2; then F D 0,
G D 1=x2, and the convergence is uniform, but kFnGnkS D 1.

4:4:14 (p. 255) (a) 3     (b) 1    (c)  1     (d) e  1
                                        2

4:4:17 (p. 255) (a) compact subsets of . 12 ; 1/ (b) OE 12 ; 1/ (c) closed sub-
              p       p!
           1     5; 1C 5
sets of       2  2            (d) . 1; 1/ (e) OEr; 1/; r > 1 (f ) compact subsets

of . 1; 0/ [ .0; 1/ P
4:4:19 (p. 255) (a) Let S D . 1; 1/, fn D an (constant), where an converges

conditionally, and gn D janj. (b) "absolutely"                         P
                                   P
4:4:20 (p. 255) (a) (i) means that jfn.Px/j converges pointwise and fn.x/ con-
verges uniformly on S , while (ii) means that jfn.x/j converges uniformly on S .

4:4:27 (p. 256) (a) X 1 . 1/n x2nC1                X 1         x 2nC1
                            nD0 nS.2n C 1/    (b) . 1/n
                                                     nD0 .2n C 1/.2n C 1/S

Section 4.5 pp. 275-280

4:5:2 (p. 276) (a) 1=3e   (b) 1    (c)     1  (d) 1     (e) 1
                                           3

4:5:8 (p. 276) (a) 1   (b)    1  (c)    1     (d) 4  (e) 1=e   (f ) 1
                              2         4

4:5:10 (p. 277) x.1 C x/=.1 x/3 4:5:12 (p. 277) e x2

4:5:16 (p. 277)  X 1 . 1/n 1       1/nI R D 1
                       n2 .x
                 nD1

4:5:17 (p. 277) X 1 Tan 1x D . 1/n x2nC1 I f .2n/.0/ D 0I f .2nC1/.0/ D .   1/2 .2 n/S;
                                   nD0 .2n C 1/
                                                    Answers to Selected Exercises 557

                  1 X 1        . 1/n
      D Tan 1 p D
   6 3 nD0 .2n C 1/3nC1=2

X 1 4:5:22 (p. 278) cosh x D x2n X 1 , sinh x D x2nC1
                          nD0 .2n/S              nD0 .2n C 1/S
4:5:23 (p. 278) .1 x/ nD0 P1 xn D 1 converges for all x

4:5:24 (p. 278) (a) x C x2 C x3 3x5 C (b) 1 x x2 C 5x3 C (c)
                                   3 40                                 26
   x2 x4  721x6                        x3 x4         x5
1     C           C            (d) x2      C             C
   2 24 720                              2 66

4:5:27 (p. 279) (a) 1 C x C 2x2 C x3 C (b) 1 x x2 C 3x3 C                        (c) 1 C x2 C 5x4 C 61x6 C
                               33                                    22                     2 24 720
(d) 1 C x2 C 7x4 C 31x6 C          (e) 2 x2 C x4     x6
         6 360 15120                                     C
                                                 12 360

4:5:28 (p. 279) F .x/ D .1        5 D 3 C 2 D X 1 OE3nC1                         . 2/nC1 xn
                               3x/.1 C 2x/ 1 3x 1 C 2x nD0

4:5:29 (p. 279) 1

Section 5.1 pp. 299-302

5:1:1 (p. 299) (a) .3; 0; 3; 3/ (b) . 1; 1; 4/ (c) . 16 ; 11 12 ; 23 24 ; 536 /
                   p           p                 p                   p
5:1:3 (p. 299) (a) 15 (b) 65=12 (c) 31 (d) 3
                   p           p                                  p
5:1:4 (p. 299) (a) 89 (b) 166=12 (c) 3 (d) 31

5:1:5 (p. 299) (a) 12     (b)  1   (c) 27
                               32

5:1:7 (p. 299) X D X0 C tU . 1 < t < 1/ in all cases.

5:1:8 (p. 299) : : : U and X1 X0 are scalar multiples of V.

5:1:9 (p. 299) (a) X D .1; 3; 4; 2/ C t.1; 3; 5; 3/

(b) X D .3; 1; 2; 1; 4; / C t. 1; 1; 1; 3; 7/

(c) X D .1; 2; 1/ C t. 1; 3; 0/          p

5:1:10 (p. 300) (a) 5 (b) 2 (c) 1=2 5  
                       °                                                                     «
5:1:1°1 (p. 300) (a)(i) .x1; x2; x3; x4/  «jxi j Ä 3 .i D 1; 2; 3/ with at least one equality
(ii) .x1; x2; x3; x4/  jxi j Ä 3 .i D 1; 2; 3/ (iii) S
   °                                                              «
(iv) .x1; x2; x3; x4/  jxi j > 3 for at least one of i D 1; 2; 3
                                   °                            22«
(b) (i) S (ii) S (iii) ; (iv) .x; y; ´/ ´ ¤ 1 or x C y > 1

5:1:12 (p. 300) (a) open (b) neither (c) closed

5:1:18 (p. 300) (a) . ; 1; 0/ (b) .1; 0; e/                          (e) 1
5:1:19 (p. 300) (a) 6 (b) 6 (c) 2p5 (d) 2Lpn
5:1:29 (p. 302) °.x; y/  x2 C y2 D 1«
558 Answers to Selected Exercises

5:1:33 (p. 302) : : : if for A there is an integer R such that jXr j > A if r R.

Section 5.2 pp. 314-316

5:2:1 (p. 314) (a) 10 (b) 3 (c) 1 (d) 0 (e) 0 (f ) 0

5:2:3 (p. 315) (b) a=.1 C a2/

5:2:4 (p. 315) (a) 1 (b) 1 (c) no (d) 1 (e) no

5:2:5 (p. 315) (a) 0 (b) 0 (c) none (d) 0 (e) none

5:2:6 (p. 316) (a) . . . if Df is unbounded and for each M there is an R such that
f .X/ > M if X 2 Df and jXj > R. (b) Replace "> M " by "< M " in (a).

5:2:7 (p. 316) limX!0 f .X/ D 0 if a1Ca2C Can > b; no limit if a1Ca2C Can Ä
b and a21 C a22 C     a2
                   C       ¤  0;  limX!0  f .X/  D  1  if  a1  D  a2  D  D an D 0 and b > 0.
                        n                           p

5:2:8 (p. 316) No; for example, limx!1 g.x; x/ D 0. °  « n
5:2:9 (p. 316) (a) R3 (b) R2 (c) R3 (d) R2 (e) .x; y/ x y (f ) R

5:2:10 (p. 316) (a) R3 f.0; 0; 0/g (b) R2 (c) R2 (d) R2 (e) R2

5:2:11 (p. 316) f .x; y/ D xy=.x2 C y2/ if .x; y/ ¤ .0; 0/ and f .0; 0/ D 0

Section 5.3 pp. 335-339

                      2                                    r   2         1 2y xCy2C2´

5:3:1 (p. 335) (a) p .x C y cos x xy sin x/ 2 .x cos x/ (b) p e
                      3                                        3         3

       2
(c) p .x1 C x2 C C xn/ (d) 1=.1 C x C y C ´/
n
                   2p
5:3:2 (p. 335) 1 2 5:3:3 (p. 335) (a) 5 = 6 (b) 2e (c) 0 (d) 0

5:3:5 (p. 335) (a) fx D fy D 1=.x C y C 2´/, f´ D 2=.x C y C 2´/

(b) fx D 2x C 3y´ C 2y, fy D 3x´ C 2x, f´ D 3xy (c) fx D ey´, fy D x´ey´,
f´ D xyey´ (d) fx D 2xy cos x2y, fy D x2 cos x2y, f´ D 1

5:3:6 (p. 335) (a) fxx D fyy D fxy D fyx D 1=.x C y C 2´/2, fx´ D f´x D
fy´ D f´y D 2=.x C y C 2´/2, f´´ D 4=.x C y C 2´/2

(b) fxx D 2, fyy D f´´ D 0, fxy D fyx D 3´ C 2, fx´ D f´x D 3y, fy´ D f´y D 3x

(c) fxx D 0, fyy D x´2ey´, f´´ D xy2ey´, fxy D fyx D ´ey´, fx´ D f´x D yey´,
fy´ D f´y D xey´

(d) fxx D 2y cos x2y 4x2y2 sin x2y, fyy D x4 sin x2y, f´´ D 0, fxy D fyx D
2x cos x2y 2x3y sin x2y, fx´ D f´x D fy´ D f´y D 0

5:3:7 (p. 336) (a) fxx.0; 0/ D fyy.0; 0/ D 0, fxy .0; 0/ D 1, fyx.0; 0/ D 1
(b) fxx .0; 0/ D fyy.0; 0/ D 0, fxy.0; 0/ D 1, fyx .0; 0/ D 1

5:3:8 (p. 336) f .x; y/ D g.x; y/Ch.y/, where gxy exists everywhere and h is nowhere

differentiable.
                                                                           Answers to Selected Exercises 559

5:3:18 (p. 337) (a) df D .3x2 C4y2 C2y sin x C2xy cos x/ dx C.8xy C2x sin x/ dy,

dX0 f D 16 dx, .dX0 f /.X X0/ D 16x
(b) df D e x y ´ .dx C dy C d´/, dX0f D dx dy d´,

.dX0 f /.X X0/ D x y                1 ´ Pn Pn
(c) df D .1 C x1 C 2x2 C               C nxn/               j D1 j dxj , dX0 f D j D1 j dxj ,

                         Pn
.dX0 f /.X X0/ D j D1 jxj ,
                          Pn                                          r 1 Pn
(d) df D 2r jXj2r 2 j D1 xj dxj , dX0 f D 2r n                                      j D1 dxj ,
                                  Pn
.dX0 f /.X X0/ D 2r nr 1 j D1.xj 1/,

5:3:19 (p. 337) (b) The unit vector in the direction of .fx1 .X0/; fx2.X0/; : : : ; fxn.X0//
provided that this is not 0; if it is 0, then @f .X0/=@^ D 0 for every ^.

5:3:24 (p. 338) (a) ´ D 2x C4y 6 (b) ´ D 2x C3y C1 (c) ´ D . x/=2Cy =2
(d) ´ D x C 10y C 4

Section 5.4 pp. 356-360

5:4:2 (p. 357) (a) 5 du C 34 dv (b) 0 (c) 6 du 18 dv (d) 8 du

5:4:3 (p. 357) hr D fx cos Â C fy sin Â , hÂ D r . fx sin Â C fy cos Â /, h´ D f´

5:4:4 (p. 357) hr D fx sin cos Â C fy sin sin Â C f´ cos , hÂ D r sin . fx sin Â C
fy cos Â /, h D r .fx cos cos Â C fy cos sin Â f´ sin /

5:4:6 (p. 357) hy D gx xy C gy C gw wy, h´ D gx x´ C g´ C gw w´

5:4:13 (p. 358) hrr D fxx sin2 cos2 Â Cfyy sin2 sin2 Â Cf´´ cos2 Cfxy sin2 sin 2Â C

fy´ sin 2 sin Â C fx´ sin 2 cos Â ,

hrÂ D . fx sin Â C fy cos Â / sin                 r                fxx / sin2 sin 2Â C rfxy sin2        cos 2Â C
                                               C 2 .fyy
r
2 .f´y cos Â  f´x sin Â / sin 2

5:4:16 (p. 358) (a) 1 C x C x2 y2 C x3 xy2
                                        22 6 2

(b) 1 x y C x2 C xy C y2 x3 x2y xy2 y3
                    2                  26 2                           26
(c) 0 (d) xy´

5:4:21  (p.   359)  (a)  .d  2      p  /.x  ;  y  /  D  .d  2      q  /.x  ;  y  /  D  2.x      y/2
                             .0;0/                          .0;0/

Section 6.1 pp. 376-378

                       2 3 22 43
                          3 46                               63 27
                                                             6                      7
6:1:3 (p. 376) (a) 4 2              4 25                (b)  4        74            5

                          7 23                                        61

                       2     8 8 16 24                  3                  2        260              3

6:1:4 (p. 376) (a) 4 0 0 4 12 5 (b) 4 0 2 4 5

                          12 16 28 44                                               226
560 Answers to Selected Exercises

                           2         2       6  3         2           3
                                2                            17
                                     7       3 5 (b) 4       3 55
6:1:5 (p. 376) (a) 4 6
                                     2       6               5 14
                                0      3
                           2                       Ä
                                   25         (b) 29
                              13   31 5
6:1:6 (p. 376) (a) 4 16                               50
                                   25
                              16

6:1:10 (p. 377) A and B are square of the same order.
                           2                 3        2            3
                               7 33                       14 10

6:1:12 (p. 377) (a) 4 4 7 7 5 (b) 4 6 2 5

                               6      91           2      14 2     3
                      2                    3
                                                      5 60
                           76           4

6:1:13 (p. 377) 4 9 7 13 5, 4 4 12 3 5

                           5 0 14                     4 03

6:1:15 (p. 377) (a) 6xy´ 3x´2 3x2y ; 6 3 3

(b) cos.x C y/ 1 1 ; 0 0
(c) .1 x´/ye x´ xe x´ x2ye x´ ; 2 1 2

(d) sec2.x C 2y C ´/ 1 2 1 ; 2 4 2

(e) jXj x1 x21                            1                  1
                                   xn ; p 1 1
                                          n

6:1:20 (p.      377) (a) .2; 3;       2/ (b) .2; 3; 0/2 (c) . 2; 0;       1/ (d) .3; 1; 3; 2/
                                                                           3
6:1:21 (p.                    1Ä      4 2 (b) 1 1 1 4 3 1
                378) (a) 10           31 2 1 1                           2
         2                                                               45
(c) 1 4                         3            2                  3
                435                                                      2
     25         6 8 55
        2                             (d) 1 1 1 1 4 1 1 1 5
           3                              2 111
                34         10  3                2                            3
(e) 1 66 2 4 0
     7             20      0   7                      120                5   7
           0       10          7      (f ) 1 6 10 6 14 18 10 4 21 22 10      7
                   02      0                                             20

                           35                                            25 5

                01 2                                  17 24 10           25

Section 6.2 pp. 390-394                         2x                     1        2               3
                                      2   sin.x C y C ´/        sin.x C y C ´/

6:2:12  (p.     392)  (a)  F0.X/   D  6      y´exy´                x´exy´       sin.x C y C ´/  7
                                      4                                                         5;

                                                                                xyexy´

J F.X/ D exy´ sin.x C y C ´/OEx.1 2x/.y ´/ ´.x y/;
                                                          Answers to Selected Exercises 561

2 32                         2     12    32  x1        3
   0

G.X/ D 4 1 5 C 4 0                 0 0 54 y C1 5

   1                         0     01           ´
(b) F0 Ä .X/ D ex cos y x
                    e sin y           ex sin y x ; J F.X/ D e2x;
                                      e cos y

           Ä           Ä           1  Ä   x
G.X/ D 0            C0
                                   0 y =2
              1           1

                 2  2x 2y 0               3

(c) F0.X/ D 4 0 2y 2´ 5; J F D 0;

                    2x 0 2´

2                220               32    x1  3

G.X/ D 4 0 2 2 5 4 y 1 5

                 202                     ´1
6:2:13 (p. 392) (a) F0 Ä .X/ D .x C y C ´ C 1/ex 2 2 x
                                                                  ex ex

                                                                       x
                                         .2x x y /e 2ye 0
                 20 3
                    g1.x/
6 (b) F0.X/ D 6 g 6 20 .x/ 7 : 77
                 4 :: 5

                   gn0 .x/             ´ex cos y´ yex cos y´ 3
                 2x

                     e sin y´

(c) F0.r; Â / D 4 ´ey cos x´ ey sin x´                 xey cos x´ 5
                      ye´ cos xy xe´ cos xy             e´ sin xy
                                         Ä
                                                        r sin Â ; J F.r; Â/ D r
6:2:14 (p. 392) (a) F0.r; Â/ D cos Â                   r cos Â
                                             sin Â

                      2                   r sin Â cos                     3
                          cos Â cos       r cos Â cos     r cos Â sin
                                                          r sin Â sin 5;
(b) F0.r; Â; / D 4 sin Â cos                   0
                                                            r cos
                             sin

           J F.r; Â; / D r 2 cos

                    2                               3
                       cos Â          r sin Â 0

(c) F0.r; Â; ´/ D 4 sin Â r cos Â 0 5; J F.r; Â; ´/ D r

                             0         01
                             Ä Ä 29 33
6:2:20 (p. 393) (a) 1 0 0 4                     (b) 18 0
                               0 20                         20    (c) 4 3 8 5

Ä Ä 2 5 10 3                                                                     10

(d) 4 3 1 (e) 2 0 (f ) 4 9 18 5
0 11                                  20
                                                          48
562 Answers to Selected Exercises

Section 6.3 pp. 414-417

6p:3:4 (p. 414) (a) OE1;     =2 (b) OE1; 2                             (c) OE1;                         p
OE 2; 3 =4                   3 =2 (b) OE1; 2                            (c) OE1;                (d) OE2 2; 9 =4 (e)
6:3:5p(p. 414) (a) OE1;
(e) OE 2; 5 =4                                                                                                 p
                                                                                                  (d) OE2 2; 7 =4

6:3:6 (p. 414) (b) Let f .x/ D x .0 Ä x Ä 12 /, f .x/ D x                                       1  . 21  <x   Ä 1/; then f  is
                                                                                                2
locally invertible but not invertible on OE0; 1.
                          °                                                                        «
6:3:7 (p. 414) F.S / D .u; v/  C 2 < arg.u; v/ < C 2 , where is an argu-

ment of .a; b/; " #
                               cos.arg.u; v/=2/
F 1 S .u; v/ D .u2 C v2/1=4                                         ;2                       < arg.u; v/ < 2 C
                               sin.arg.u; v/=2/
                          Ä x 1 Ä u 2v                                                              Ä
                                                                                         10 1 1 2
6:3:10 (p. 415) (a) y D 10 3u C 4v ; .F / D 10 3 4
23 2                                          3                                 2                       3
(b) 4 y 5 D x 1 4 u w 5; .F 1/0 D u C 2v C 3w 1 4 1 0 1 5 1 2 3
                    2 u C v C 2w                                          2 11 2
        ´                                  Äp                                                      Äp                        p
                                                                                                                          1= pu C v
                                      1       pu C v 0                                          1        1= pu C v        1= u v
6:3:12 (p. 415) G1.u; v/ D p                                  , G1.u; v/ D p
                                       2 uv                                                  2 2 1= u v
                    Äp                                                    Äp                                  p
                1      pu C v                                 1                    1= pu C v 1= pu C v
G2.u; v/ D p                   , G2.u; v/ D p0

                 2  Äp    uv                               2 2 1= u v 1= u v
                                                                       Äp                                  p
                1      pu C v 0                               1                    1= pu C v 1= pu C v
G3.u; v/ D p                   , G3.u; v/ D p
                 2        uv                               2 2 1= u v 1= u v
                    Äp                                                    Äp                                  p
                1      pu C v                                 1                    1= pu C v 1= pu C v
G4.u; v/ D p                   , G4.u; v/ D p0

                 2        uv                               2 2 1= u v 1= u v

6:3:15 (p. 416) From solving x D r cos Â, y D r sin Â for Â D arg.x; y/. Each equation

is satisfied by angles that are not arguments of .x; y/, since none of the formulas identifies

the quadrant of .x; y/ uniquely. Moreover, (c) does not hold if x D 0.
                    Ä                                                           "                             #
6:3:16 (p. 416) x D G.u; v/ D .u2 C v2/1=4 cosOE 2 arg.u; v/ ,                               1

                       y                                                              sin.arg.u; v/=2/

where  =2 < arg.u; v/ <  C                    =2 and  is an argument of .a; b/;
                     1 Ä xy

G0.u; v/ D 2.x2 C y2/ y x

6:3:19  (p.  416)   If F.x1; x2; : : : ; xn/     D  .x  3  ;  x  3  ;  :  :  :  ;  x  3  /,  then F is   invertible, but
                                                        1        2                    n

J F.0/ D 0. Ä                                       1Ä5 5                                Ä
6:3:20 (p. 416) (a) A.U/ D 1                        25 3 8                                  uC5
                                                                                            v4
                                            1
                                                                  Answers to Selected Exercises 563

             Ä 1 1Ä 4                      Ä
(b) A.U/ D 1 C 6 3                    2 u2

             2 32                     3 v3                        3
                                               32
                0          0          11              u1

(c) A.U/ D 4 1 5 C 4 1 1 0 5 4 v 1 5

                1     32   1 00                       w2
             2                                     32                3
                   1            010                         u

(d) A.U/ D 4 =2 5 C 4 1 0 0 5 4 v C 1 5

                                001                         w                           sin 3
                                   2 cos Â cos                   sin Â cos

                                   6                                                           7
                                   6              sin Â                 cos Â                  7
6:3:21  (p.  417)  G0.x; y; ´/  D  6                                                       07
                                   6           r cos                    r cos                  7
                                   4                                                           5
                                            1                        1                  1
                                               cos Â sin                sin Â sin       r cos
                                            r                        r3
                                   2
                                            cos Â sin Â 0
                                   6                                    7
                                   6        1            1              7
6:3:22  (p.  417)  G0.x; y; ´/  D  6           sin Â        cos Â       07
                                   4                                       5
                                            r            r

                                               0            01

Section 6.4 pp. 431-434

                      Ä u 1Ä 3 4 Ä x
6:4:1 (p. 431) (a) v D 2 1 2 y
2 u 3 2 3 3 3Ä Ä Ä
(b) 4 v 5 D 1 4                          x               u           1         2     1     Ä   y C sin x
                                                                  D
                      1 25                     (c)       v                           3
        w 2 23 y                                                     51                        x C sin y

(d) u D x, v D y, ´ D w
                                0                           1r
                                   Xn
6:4:3 (p. 431) fi .X; U/ D @ aij .xj xj 0/A .ui ui0/s, 1 Ä i Ä m, where r

                                   j D1

and s are positive integers and not all aij D 0. (a) r D s D 3; (b) r D 1, s D 3; (c)

r Ds D2

6:4:4 (p. 431) ux.1; 1/ D       5  ,  uy .1;   1/  D     1
                                8                        2

6:4:5 (p. 431) ux.1; 1; 1/ D 85 , uy.1; 1; 1/ D             89 ,  u´.1; 1; 1/     D  1
                                                                                     2

6:4:6 (p. 431) (a) u.1; 2/ D 0, ux.1; 2/ D uy .1; 2/ D 4

(b) u. 1; 2/ D 2, ux. 1; 2/ D 1, uy . 1; 2/ D                        1
                                                                     2

(c) u. =2; =2/ D ux. =2; =2/ D uy. =2; =2/ D 0

(d) u.1; 1/ D 1, ux.1; 1/ D uy.1; 1/ D 1

6:4:7 (p. 431) (a) u1.1; 1/ D 1, @u1.1; 1/ D 5,                         @u1.1; 1/ D 2
                                                  @x                        @y
564 Answers to Selected Exercises

u2.1; 1/ D 2, @u2.1; 1/ D 14; @u2.1; 1/ D 2
               @x                             @y

(b) uk .0; / D .2k C 1/ =2,             @uk.0; / D 0, @uk.0; / D                  1, k D integer
                                              @x                        @y        3, v0.0/ D 1
                     1Ä 1 2
6:4:8 (p. 432) 5 1 2                    11 6:4:9 (p. 432) u0.0/ D
                                        3
                         2
6:4:10 (p. 432) 1 5 5 4 5 5             5

                       6 66             3                         Ä     13;
                                     Ä                                  12

6:4:11 (p. 432) U1.1; 1/ D                    , U1.1; 1/ D0

            Ä                           1     Ä

U2.1; 1/ D     3   0, U2.1; 1/ D                     13

               1                                     12

6:4:12 (p. 432) ux.0; 0; 0/ D 2, vx.0; 0; 0/ D wx.0; 0; 0/ D 2

                        @.f; g; h/                             @.f; g; h/         @.f; g; h/

6:4:13 (p. 433) yx D @.x; ´; u/ , yv D @.v; ´; u/ , ´x D @.y; x; u/ ,
                        @.f; g; h/                             @.f; g; h/         @.f; g; h/

                        @.y; ´; u/                             @.y; ´; u/         @.y; ´; u/

@.f; g; h/              @.f; g; h/                             @.f; g; h/

´v D @.y; v; u/ , ux D @.y; ´; x/ , uv D @.y; ´; v/
@.f; g; h/              @.f; g; h/                             @.f; g; h/

@.y; ´; u/              @.y; ´; u/                             @.y; ´; u/

6:4:14 (p. 433) x D 2y u, ´ D 2v; x D 2y u, v D ´ ; y D x u ,
                                                                                        2        22
               xu              ´                                                                 ´
´ D 2v; y D 2 2 , v D 2 ; ´ D 2v, u D x 2y; u D x 2y, v D 2

6:4:15 (p. 433) yx.1; 1; 2/ D                     1  ,  vu.1;  1;    2/ D 1
                                                  2

6:4:16 (p. 433) uw .0;  1/  D           5  ,  uy  .0;   1/ D 0, vw .0;      1/ D  5  ,  vy  .0;  1/ D 0,
                                        6                                         6
xw .0; 1/ D 1, xy.0; 1/ D 1

6:4:18 (p. 434) ux.1; 1/ D 0, uy.1; 1/ D 0, vx.1; 1/ D 1, vy .1; 1/ D 1, uxx .1; 1/ D
2,
uxy .1; 1/ D 1, uyy.1; 1/ D 2, vxx .1; 1/ D 2, vxy.1; 1/ D 1, vyy.1; 1/ D 2

6:4:19 (p. 434) ux.1; 1/ D 0, uy .1; 1/ D 1 , vx.1; 1/ D 1 , vy.1;                               1/ D 0,
                                                               2                  2
               1                           1                         1                  1
uxx .1; 1/ D 8 , uxy.1; 1/ D 8 , uyy.1; 1/ D 8 , vxx .1; 1/ D 8 ,
               1                        1
vxy.1; 1/ D 8 , vyy.1; 1/ D 8
                                                                                                Index 565

Section 7.1 pp. 459-462

7:1:2  (p.  459) (a) 28        «(b)  1    7:1:6 (p. 460) 3.b a/.d c/, 0                      7:1:13 (p. 460)
°                                    4
.m; n/  m; n D integers

Section 7.2 pp. 480-484

7:2:1 (p. 480) (a) 12 (b) 79 20 (c) 1 (d) .1 log 2/=2
                                                     p
7:2:5  (p.  481)  (a)    7      (b) 17       (c) 32 . 2 1/             (d) 1=4
                         4

7:2:7  (p.   481) (a)    83 ,   5    (b) 38 , 58        7:2:8  (p.  482)    (a)     43 ,  5     (b) 34 ´ C 12 ,
                                8                                                         4
45 ´ C 21 (c) ´ C 21 , 1

7:2:11 (p. 482) (a) 285 (b) 0 (c) 0 (d) 14 .e 25 /

7:2:12 (p. 483) (a) 324            (b)    1   (c) 1            7:2:13  (p.  483)    52
                                          6                                         15

7:2:14 (p. 483) (a) 36 (b) 1 (c) 643 (d) .e6 C 17/=2

7:2:17  (p.  483)  (a)      2      (b) 12 .e      25 /  (c) 124        (d) 136
                            27

7:2:18 (p. 483) (a) 16               (b)  1       (c) 128 21 (d) 2
                                          6                Pn

7:2:19 (p. 484) (a) 21 .b1 a1/ .bn an/ j D1.aj C bj /
(b) 31 .b1 a1/ .bn an/ j D1 Pn .aj2 C aj bj C bj2/

(c) 2 n.b21 a12/ .bn2 an2/
                   R p3=2          R p1 x2
7:2:20 (p. 484) p3=2 dx 1=2 f .x; y/ dy                            7:2:22   (p.  484)        1
                                                                                             2

Section 7.3 pp. 514-517

7:3:1 (p. 514) Let S1 and S2 be dense subsets of R such that S1 [ S2 D R.

7:3:7 (p. 514) (a) 1; c (constant); 1 7:3:9 (p. 515) .u2 u1/.v2 v1/=jad bcj

7:3:10  (p.  515)     5     7:3:14      (p.   515) (a)         4    (b)     log  5        7:3:15 (p. 516) 3
                      6                                        9                 2
                   1        7:3:17 (p. 516) 54 e.e
7:3:16  (p.  516)  2                                           1/

7:3:18  (p.  516)  4     abc       7:3:19 (p. 516) 2 .e25              e9/       7:3:20 (p. 516) 16 =3
                   3
7:3:21 (p. 516) 21=64

7:3:22 (p. 516) (a) . =8/ log 5 (b) . =4/.e4 1/ (c) 2 =15

7:3:23 (p. 517) 2a4=2

7:3:24 (p. 517) (a) .1 1/ .n n/=j det.A/j 7:3:25 (p. 517) ja1a2 anjVn
                                        Index

A                                                 Binomial coefficient, 17 (Exercise 1.2.19),
Abel's test, 219                                              102, 194 (Exercise 4.1.35)
Abel's theorem, 273, 279
Absolute convergence, 215                         Binomial series, 266
                                                  Binomial theorem, 17 (Exercise 1.2.19)
      of an improper integral, 160                Bolzano-Weierstrass theorem, 27, 294,
      of a series of constants, 215
      of a series of functions, 247                           301 (Exercise 5.1.22)
Absolute integrability, 160                       Bound
Absolute uniform convergence, 247, 255
                                                        lower, 7
            (Exercises 4.4.17 and 4.4.20),              upper, 3
            256 (Exercise 4.4.21)                 Boundary, 526
      of a power series, 257                            point, 289, 526
Absolute value, 2                                       of a set, 23, 289
Addition of power series, 267                     Bounded convergence theorem, 243
Adjoint matrix, 370                               Bounded function, 47, 60, 313
Affine transformation, 380                        Boundedness of a continuous function
Alternating series, 203                                 on a closed interval, 62, 199
      test, 203, 219                                    on a compact set, 313
Analytic transformation, 416 (Exercise 6.3.17)    Boundedness of an integrable function,
Angle between two vectors, 286
Antiderivative, 143, 150 (Exercise 3.3.16)                    119
Archimedean property, 5                                 on a metric space, 537
Area under a curve, 116                           Bounded sequence, 181, 197, 292
Argument, 398                                     Bounded set
      branch of, 409, 410, 415 (Exercise 6.3.14)        above, 3, 313
Ascoli-Arzela theorem, 543                              below 7, 313
Associative laws                                  Bounded variation, 134-135 (Exercises 3.2.7,
      for the real numbers, 2 (see p. 1)
      for vector addition, 283                                3.2.9, 3.2.10)
                                                  Branch

                                                        of an argument, 409, 415
                                                        of an inverse, 409

B                                                 C
Bessel function, 277 (Exercise 4.5.11)            C[a,b], 521

                                                        equicontinuous subset of, 541

                                        566
                                                   Index 567

      uniformly bounded subset of, 541             Composite function, 58, 311
Cartesian product, 31, 435                               continuity of, 59, 311
Cauchy product of series, 226, 233 (Ex-                  differentiability of, 77, 340
                                                         higher derivatives of, 345
            ercise 4.3.40), 280 (Exercise 4.5.32)        Taylor polynomial of, 109-110
Cauchy sequence, 527                                           (Exercise 2.5.11)
Cauchy's convergence criterion
                                                   Composition of functions, 58
      for sequences of real numbers, 190           Conditional convergence
      for sequences of vectors, 292
      for series of real numbers, 204                    of an improper integral, 162
Cauchy's root test, 215                                  of a series, 217
Cauchy's uniform convergence criterion             Conditionally integrable, 162
      for sequences, 239                           Connected metric space, 549 (Exercise 8.3.2)
      for series, 246                              Connected set, 295
Chain rule, 77, 340, 388                                 polygonally, 296
Change of variable, 145, 147                       Containment of a set, 19
      in an improper integral, 164                 Content, 453
      in a multiple integral, 496                        of a coordinate rectangle, 437
                                                         of a set, 485
         formulation of the rule for, 494                zero, 448, 514 (Exercise refexer:7.3.2)
      in an ordinary integral, 145, 147            Continuity, 54, 302
Changing the order of integration, 478                   of a composite function, 59, 311
Characteristic function, 70 (Exercise 2.2.9),            of a differentiable function, 76, 325
                                                         of a function of n variables, 309
            485                                          of a function of one variable, 54
Closed                                                   on an interval, 55
                                                         from the left, 54
      under scalar multiplication, 519                   of a monotonic function, 67
      under vector addition, 519                         piecewise, 56
Closed interval, 23                                      from the right, 54
Closed n-ball, 291                                       on a set, 56, 311
Closed set, 21, 289, 525                                 of a sum, difference, product, and
Closure of a set, 23, 289
Cofactor, 370                                                  quotient, 57, 311
      expanding a determinant in, 371-372                in terms of sequences, 198
Commutative laws                                         of a transformation, 379
      for the reals, 2 (See p. 1)                        uniform, 64, 66, 314, 392 (Exercise 6.2.10)
      for vector addition, 283                           of a uniform limit, 242
Compact set, 20, 293, 537                                of a uniformly convergent series, 250
Comparison test                                    Continuous function 54, 309
      for improper integrals, 156                        boundedness of, 62, 313
      for series, 206                                    extreme values of on a closed inter-
Complement of a set, 20
Complete metric space, 527                                     val, 62
Completeness axiom, 4                                    integrability of, 133
Complete ordered field, 4                                intermediate values of, 63, 313
Component function, 311                                  on a metric space, 545
Components, 284 (see p. 281)                       Continuous transformation, 379
      of a vector-valued function, 311, 362
568 Index                                   Dedekind's theorem, 9 (Exercise 1.1.8)
                                            Defined inductively, 12
Continuously differentiable, 73, 80, 329,   Degree
            385, 409
                                                  of a homogeneous polynomial, 352
Contraction mapping theorem, 547                  of a polynomial, 98
Convergence                                 Deleted -neighborhood, 22
                                            Deleted neighborhood, 525
      absolute                              Dense set, 6, 29 (Exercise 1.3.22), 70 (Ex-
         of an improper integral, 160
         of a series of constants, 215                  ercise 2.2.10)
                                            Density of the rationals, 6, 392 (Esercise 6.2.11)
      absolute uniform, 247                 Density of the irrationals, 6
      conditional                           Denumerable set, 176
                                            Derivative, 73
         of a series, 217
         of an improper integral, 162             of a composite function, 77
      of an improper integral, 152                directional, 317
      of an infinite series, 201                  infinite, 88 (Exercise 2.3.26)
      interval of, 258                            of an inverse function, 86 (Exercise 2.3.14)
      pointwise                                   left-hand, 79
         of a sequence of functions, 234,         nth, 73
                                                  one-sided, 79
            238                                   ordinary, 317
         of a series of functions, 244            partial, 317
      of a power series, 257                      of a power series, 261-262
      radius of, 258                              right-hand, 79
      of a sequence in a metric space, 526        r th order, 319
      of a sequence in Rn, 292                    second, 73
      of a sequence of real numbers, 179          of a sum, difference, product, and
      of a series of constants, 200
      of a sum, difference, or product of               quotient, 77
                                                  zeroth, 73
            sequences, 184                  Determinant, 368 (see p. 369)
      of a Taylor series, 264                     expanding in cofactors, 371-372
      uniform, 246                                of a product of square matrices, 370
                                            Diameter of a set, 292, 586
         of a sequence, 237                 Difference quotient, 73
         of a series, 246                   Differentiability
Coordinate cube, 437                              of a composite function, 340
      degenerate, 437                             continuous, 329
      nondegenerate, 437                          of a function of one variable, 73
Coordinate rectangle, 437                         of a function of several variables, 323
Coordinates,                                      of the limit of a sequence, 243
      polar, 397, 502, 505                        of a power series, 260-262
      spherical, 507                              of a series, 252
Covering, open, 25, 293, 536                Differentiable 73, 323
Cramer's rule, 373                                continuously, 73, 80, 409
Critical point, 81, 335                           curve, 453
Curve, differentiable, 453

D
Decreasing sequence, 182
Dedekind cut, 9 (Exercise 1.1.8)
      function, continuity of, 76, 325, 385                                    Index 569
      on an interval, 80
      on a set, 73                           E
      surface, 453                           Edge lengths of a coordinate rectangle,
      transformation, 380
      vector-valued function, 339                        437
Differential, 326                            Elementary matrix, 488
      higher, 348                            Empty set, 4
      of a linear transformation, 367        Entries of a matrix, 364
      matrix, 367, 381                        -neighborhood, 21, 289, 525
      of a real-valued function, 326          -net, 539
      of a sum, difference, product, and     Equicontinuous subset of C OEa; b, 541
                                             Equivalent metrics, 530
            quotient, 328                    Error in approximating derivatives, 112
      of a transformation, 381
Differential equation, 170-171                           (Exercises 112-112)
                                             Euclidean n-space, 282 (see p. 281)
            (Exercises 3.4.27-3.4.29)        Euler's constant, 230 (Exercise 4.3.14)
Directional derivative, 317                  Euler's theorem, 357-358 (Exercise 2.4.8)
Dirichlet's test                             Existence of an improper integral, 152
                                             Existence theorem, 420
      for improper integrals, 163            Expanding a determinant, 362-372
      for series of constants, 217           Exponential function, 70 (Exercise 2.2.12),
      for uniform convergence of series,
                                                         72 (Exercise 2.2.33), 228, 273
            248                              Extended mean value theorem, 106
Disconnected set, 295                        Extended reals, 7,
Discontinuity                                Exterior point, 289, 526
                                             Exterior of a set, 23, 289, 526
      jump, 56
      removable, 58                          F
Discrete metric, 519                         Faa di Bruno's formula, 109
Disjoint sets, 20
Distance                                                 (Exercise 2.5.11)
      in a metric space, 518                 Fibonnacci numbers, 17 (Exercise 1.2.17)
      from a point to a set, 301             Field

            (Exercise 5.1.24)                      complete ordered, 4
      between subsets of a metric space,           ordered, 2
                                                   properties, 2 (see p. 1)
            549 (Exercise 8.3.3)             Finite real, 7
      between two sets, 301                  First mean value theorem for integrals,

            (Exercise 5.1.25)                            139
      between two vectors, 283               Forward differences, 104, 71 (Example 2.2.18),
Distributive law, 2 (see p. 1)
Divergence, unconditional, 233                           112 (Exercises 2.5.19-2.5.22)
                                             Fredholm's integral equation, 548
            (Exercise 4.3.38)                Function 31, 32
Divergent improper integral, 152
Divergent sequence, 179                            absolutely integrable, 160
Divergent series, 201                              Bessel, 277 (Exercise 277)
Domain of a function, 31 (see p. 30), 545          bounded, 47, 60, 313
Double integral, 438
                                                      above, 60, 313
                                                      below, 60, 313
570 Index

      of bounded variation, 134 (Exercise 3.2.7)  Generating function, 278 (Exercise 4.5.26)
      characteristic, 70 (Exercise 2.2.9), 485    Geometric series, 202
      composite, 58, 311                          Grouping terms of series, 220
      decreasing, 44
      differentiable at a point, 73, 323          H
      domain of, 31, 32                           Heine-Borel property,
      exponential, 70 (Exercise 2.2.12), 72       Heine-Borel theorem, 172, 66, 172, 293
                                                  Higher derivatives of a composite func-
            (Exercise 2.2.33), 227, 273
      generating, 278 (Exercise 4.5.26)                       tion, 345
      homogeneous, 357 (Exercise 5.4.8)           Higher differential, 348
      increasing, 44                              Homogeneous function, 357 (Exercise 5.4.8),
      infimum of, 55, 313
      inverse of, 68                                          359 (Exercise 5.4.23)
      linear, 325                                 Homogeneous polynomial, 359 (Exercise 5.4.22),
      locally integrable, 152                     Homogeneous system, 375
      maximum of, 60                              Hypercube, 295 (see p. 294)
      monotonic, 44, 67                           Hölder's inequality, 521
      nondecreasing, 44
      nonincreasing, 44                           I
      nonoscillatory at a point, 162              Identity matrix, 370
      nth power of, 33                            Image, 394
      oscillation of, 171                         Implicit function theorem, 420, 423
      piecewise continuous, 56                    Improper integrability, 146
      range of, 31, 32                            Improper integral, 152
      rational, 33, 232, (Exercise 4.3.28),
                                                        absolutely convergent, 160
            276 (Exercise 4.5.4)                        change of variable in, 164
      real-valued, 302                                  conditionally convergent, 162
      restriction of, 399                               convergence of, 152
      Riemann integrable, 114, 438                      divergence of, 152
      Riemann-Stieltjes integrable, 125                 existence of, 152
      strictly monotonic, 44                            of a nonnegative function, 156
      supremum of, 313                            Incompleteness of the rationals, 6
      value of, 31, 32                            Increasing sequence, 182
      vector-valued, 311                          Indeterminate forms, 91, 93-95
Functions,                                        Induction assumption, 12
      composition of, 58, 311                     Induction proof, 12
      difference of, 32                           Inequality,
      product of, 32                                    Hölder, 521
      quotient of, 32                                   Minkowski, 522
      sum of, 32                                        Schwarz, 284
Fundamental theorem of calculus, 143                    triangle, 2, 285
                                                  Infimum
G                                                       of a function, 60, 313
Generalized mean value theorem, 83                      of a set, 7

                                                           existence and uniqueness of, 7, 9
                                                              (Exercise 1.1.6)
                                                    Index 571

Infinite derivative, 88 (Exercise 2.3.26)                 Riemann-Stieltjes, 125, 127 (Exer-
Infinite limits, 42, 306, 317, 316(Exercise 5.2.6)              cise 3.1.16), 135 (Exercises 3.2.8-
Infinite sequence, 179                                          3.2.10), 151 (Exercise 3.3.23)

      in a metric space, 526                              over subsets of Rn, 436 (See p. 435),
Infinite series, 210, 244                                       450, 452, 471-472

      convergence of, 201                                 of a sum, 136, 456
      integrability of, 251                               test, 207
      oscillatory, 201                                    triple, 439
Infinity norm, 496, 523, 524                        Integration by parts, 144
Inner product, 284                                        for Riemann-Stieltjes integrals, 135
Instantaneous
      rate of change, 74                                        (Exercise 3.2.8)
      velocity, 74                                  Interior of a set, 21, 289
Integrability                                       Interior point, 21, 289, 525
      conditional, 162                              Intermediate value theorem
      of a continuous function, 133
      of a function of bounded variation,                 for continuous functions, 63, 313
                                                          for derivatives 82
            134 (Exercise 3.2.7)                    Intersection of sets, 20
      improper, 152                                 Interval
      of an infinite series, 251                          closed, 23
      local, 152                                          half closed, 23
      of a monotonic function, 133                        half open, 23
      of a power series, 264                              open, 21
Integrable                                                semi-infinite, 21, 23
      Riemann, 114, 438                             Interval of convergence, 258
      Riemann-Stieltjes, 125                              for derivatives, 82
Integral                                            Inverse function, 68
      over an arbitrary set in Rn, 452                    branch of, 409
      of a constant times a function, 136,                derivative of, 86 (Exercise. 2.3.14)
                                                          of a function restricted to a set, 399
            456                                           of a matrix, 370
      double, 439                                         of a transformation, 396
      improper, 151                                 Inverse function theorem, 412
      iterated, 462                                 Invertible, locally, 400
      lower                                         Invertible transformation, 396
                                                    Irrational number, 6
         for Riemann integral, 120, 442             Isolated point, 23, 289, 526
         for Riemann-Stieltjes integral 128         Iterated integral, 462
                                                    Iterated logarithm, 97 (Example 2.4.42),
            (Exercise 3.1.17)
      multiple, 439                                             167 (Exercise 3.4.10), 208 230
      ordinary, 439                                             (Exercise 4.3.11), 230 (Exercise 4.3.16)
      of a product, 138, 456
      proper, 153                                   J
      over a rectangle in Rn, 436 (See p. 435)      Jacobian, 384, 426
      Riemann, 114, 438                             Jordan content, 485

                                                          changed by linear transformation, 488
572 Index                                      Linear function, 325
                                               Linear transformation, 362
Jordan measurable set, 485, 488
Jump discontinuity, 56                               change of content under, 490
                                                     differential of, 367
L                                                    matrix of, 363
Lebesgue measure zero, 175, 177 (Exer-         Lipschitz condition, 84, 87 (Exercise 2.3.24),

            cises 3.5.7, 3.5.8)                            140
Lebesgue's existence criterion, 176            Local extreme point, 80, 334
Left limit inferior, 47                        Local extreme value, 80
Left limit superior, 47                        Local integrability, 152
Left-hand derivative, 79                       Local maximum point, 80, 334
Left-hand limit, 38                            Local minimum point, 80, 334
Legendre polynomial, 278 (Exercise 4.5.27)     Locally invertible, 400
Leibniz's rule, 86, (Exercise. 2.3.12)         Lower bound, 7
Length of a vector, 283                        Lower integral, 120, 442
l'Hospital's rule, 88                          Lower sum, 120, 442
Limit of a real-valued function, 302
Limit                                          M
                                               Maclaurin's series, 264
      along a curve, 315 (Exercise 5.2.3)      Magnitude, 2
      in the extended reals, 43                Main diagonal of a matrix, 370
      inferior of a sequence, 188              Mathematical induction, 10, 13
                                               Matrices
         left, 47
      infinite, 42, 306, 316 (Exercise 5.2.6)        product of, 364
      at infinity, 307, 316 (Exercise 5.2.6)         sum of, 364
      left-hand, 38                            Matrix
      one-sided, 37, 40                              adjoint, 370
      point, 23, 289, 526                            of a composition of linear transfor-
      pointwise, 234, 238, 244
      at 1, 40                                             mations, 366
      of a real-valued function                      differential, 367, 381
                                                     elementary, 488
         as x approaches x0, 34                      identity, 370
         as x approaches 1, 40                       inverse, 370
         as x approaches 1, 50 (Exer-                of a linear transformation, 363
                                                     main diagonal of, 370
            cise 2.1.14)                             nonsingular, 370
      right-hand, 39                                 norm of, 368
      of a sequence, 179, 292                        scalar multiple of, 364
      uniqueness of, 35, 305                         singular, 370
      of a sum, product, or quotient, 35,            square, 368 (See p. 369)
                                                     transpose of, 370
            305                                Maximum value, local, 80
      superior, left, 47                       Maximum of a function, 60
      superior of a sequence, 188              Mean value theorem, 83, 347
      uniform, 237                                   extended, 106
      uniqueness of, 35, 305
Line segments in Rn, 288
Line, parametric representation of, 288-

            289
      generalized, 83                                                             Index 573
      for integrals, 138, 144
Metric, 518                                           infinity, 496, 523, 524
      discrete, 519                                   of a matrix, 368
      induced by a norm, 520                          metric induced by, 520
Metrics, equivalent, 530                              of a partition, 114, 437
Metric space, 518                                     on a vector space, 519
      complete, 527                             Normed vector space, 519
      connected, 549 (Exercise 8.3.2)           nth derivative, 73
Minimum of a function, 60                       nth partial sum of a series, 201
Minimum value, local, 80                        nth term of a series, 201
Minkowski's inequality, 522                     Number, natural, 10
Monotonic function, 44, 67, 84                  Number, prime, 15
      integrability of, 133
Monotonic sequence, 182                         O
Multinomial coefficient, 322, 336 (Exer-        One-sided derivative, 79
                                                One-sided limit, 37
            cise 5.3.12)                        One-to-one transformation, 396
Multiple integral, 439                          Open ball, 525
Multiplication                                  Open covering, 25, 293, 536
                                                Open interval, 21
      of matrices, 364                          Open n-ball, 290
      of series, 223                            Open set, 21, 289, 525
      scalar, 519                               Ordered field, 2
Multiplicity of a zero, 87 (Exercise. 2.3.21),
                                                      complete, 4
            108 (Exercises 2.5.5-2.5.7)         Order relation, 2
                                                Ordinary derivative, 317
N                                               Ordinary integral, 439
Natural numbers, 10                             Origin of Rn, 283
n-ball, 290-291                                 Oscillation of a function, 171
Negative definite polynomial, 353
Negative semidefinite polynomial, 353                 at a point, 172
Neighborhood, 21, 289, 525                      Oscillatory infinite series, 201

      deleted, 22, 525                          P
      deleted , 22                              Parametric representation of a line, 288,
       , 21
Nested sets, 292, 530                                       289
      principle of, 292, 530                    Partial derivative, 317
Nondecreasing sequence, 182
Nondegenerate coordinate cube, 437                    r th order, 319
Nondenumerable set, 176                         Partial sums, 244
Nonempty set, 4                                 Partition, 114, 437
Nonincreasing sequence, 182
Nonoscillatory at a point, 162                        norm of, 114, 437
Nonsingular matrix, 370                               points, 114
Nontrivial solution, 375                              refinement of, 114, 438
Norm                                            Path, polygonal, 296
                                                Peano's postulates, 10-11
                                                Piecewise continuous function, 56
                                                Point, 19
574 Index                                         of matrices, 364
                                                  of power series, 268
      boundary, 23, 289, 526                      of series, 223
      critical, 81, 335                     Proper integral, 153
      exterior, 23, 289, 526
      at infinity, 7                        R
      interior, 21, 289                     Rn, 282 (see p. 281)
      isolated, 23, 289, 526                r th order partial derivative, 319
      limit, 23, 289, 526                   Raabe's test, 212
      local extreme, 80, 334                Radius of convergence, 258
      local maximum, 80, 334                Range of a function, 31, 32, 545
      local minimum, 80, 334                Ratio of a geometric series, 202
      in terms of sequences, 197            Ratio test, 210
Pointwise convergence                       Rational function, 33, 232 (Exercise 4.3.28),
      of a sequence of functions, 234, 238
      of a series, 244                                  276 (Exercise 4.5.4)
Pointwise limit, 234, 238, 244              Rational numbers, 2
Polar coordinates, 397, 502, 505
Polygonal path, 296                               density of, 6
Polygonally connected, 296                        incompleteness of, 6
Polynomial, 33, 98                          Real line, 19
      homogeneous, 352                      Real number system, 19
      negative definite, 353                Real-valued function,
      negative semidefinite, 353                  of n variables, 302
      positive definite, 353                      of a real variable, 31
      positive semidefinite, 353            Reals, extended, 7
      semidefinite, 353                     Rearrangement of series, 221
      Taylor, 99, 351                       Rectangle, coordinate, 437
Power series, 257                           Refinement of a partition, 114, 438
      arithmetic operations with, 267       Region, 295, 297
      continuity of, 260-261                Region of integration, 476
      convergence of, 257                   Regular transformation, 405
      differentiability of, 260-261         Remainder in Taylor's formula, 405
      integration of, 264                   Removable discontinuity, 58
      of a product, 268                     Restriction of a function, 399
      of a reciprocal, 271                  Riemann integrable, 114, 438
      of a quotient, 269                    Riemann integral 114 (see p. 113), 438
      uniqueness of, 263                          uniqueness of, 125 (Exercise 3.1.1)
Prime, 15                                   Riemann sum, 114, 438
Principal value, 155                        Riemann-Stieltjes integral, 125
Principle of mathematical induction, 11,          integration by parts for, 135 (Exer-

            14                                          cise 3.2.8)
Principle of nested sets, 530               Riemann-Stieltjes sum, 125
Product                                     Right limit inferior, 53 (Exercise 2.1.39)
                                            Right limit superior, 53 (Exercise 2.1.39)
      Cartesian, 31, 436 (see p. 435)       Right-hand derivative, 79
      Cauchy, 226, 233 (Example 4.3.40)     Right-hand limit, 39
      inner, 284
Rolle's theorem, 82                                                                Index 575

S                                                      multiplication of, 223
Scalar multiple, 282                                   of nonnegative terms, 205
Scalar multiplication, 519                             partial sums of, 244
Schwarz's inequality, 284                              power, 257
Secant plane, 332-333                                  product of, 218
Second derivative, 73                                  rearrangement of, 221
Second derivative test, 103                            Taylor, 223
Second mean value theorem for integrals,               term by term differentiation of, 252
                                                       term by term integration of, 251
            144                                        uniformly convergent, 246
Sequence, 179, 526                               Set
                                                       boundary of, 23, 289, 526
      bounded, 181, 292                                bounded, 7, 537
      bounded above, 181
      bounded below, 181                                  above, 3
      Cauchy, 527                                         below, 7
      convergence of, 179, 292, 526                    closed, 21, 289, 525
      decreasing, 182                                  closure of, 23, 289, 526
      divergent, 179                                   compact, 26, 293, 537
                                                       complement of, 20
         to 1, 181                                     connected, 295
      of functional values, 183                        containment of, 19
      of functions,                                    content of, 485
                                                       dense, 6, 29 (Example 1.3.22), 70
         pointwise, 234
      increasing, 182                                        (Exercise 2.2.10)
      limit of, 179, 292                               denumerable, 176
                                                       diameter of, 292, 537
         uniform, 237                                  disconnected, 295
      limit inferior of, 188                           empty, 4
      limit superior of, 188                           exterior of, 23, 289, 526
      monotonic, 182                                   interior of, 21, 289, 525
      nondecreasing, 182                               nondenumerable, 176
      nonincreasing, 182                               nonempty, 4
      nth term of, 179                                 open, 21, 289, 525
      terms of, 179                                    singleton, 20
      unbounded, 292                                   strict containment of, 20
      uniformly convergent, 237                        subset of, 19
Series                                                 totally bounded, 539
      alternating, 203                                 unbounded below, 7
      binomial, 266                                    uniformly bounded, 541
      Cauchy product of, 226, 233 (Exer-               universal, 19
                                                 Sets
            cise 4.3.40), 280 (Exercise 4.5.32)        disjoint, 20
      differentiability of, 252                        equality of, 19
      divergent, 201                                   intersection of, 20
      geometric, 202                                   nested, 530
      grouping terms in, 220
      Maclaurin, 264
576 Index                                           for functions of n variables, 350
                                                    for a function of one variable, 104
      union of, 20                            Terms of a sequence, 179
Simple zero, 108 (Exercise 2.5.5)             Term by term differentiation, 252
Singleton set, 20                             Term by term integration, 251
Singular matrix, 370                          Test
Solution of a system of linear equations            Cauchy's root, 215
                                                    comparison
      nontrivial, 375                               for improper integrals, 156
      trivial, 375                                  for series, 206
Space                                               integral, 207
      metric, 518                                   Raabe, 212
      vector, 519                                   ratio, 210
Spherical coordinates, 507                          second derivative, 103
Square matrix, 368 (see p. 369)               Topological properties of Rn, 282 (See
Subsequence, 195
      of a convergent sequence, 196, 527                  p. 281)
Subset, 19                                    Topological space, 26
Subspace of a vector space, 519               Total variation, 134 (Exercise 3.2.7)
Successor, 11                                 Totally bounded, 539
Sum                                           Transformation, 362
      of matrices, 364
      Riemann, 114, 438                             affine, 380
                                                    analytic, 416 (Exercise 6.3.17)
         lower, 120, 442                            continuous, 379
         upper, 120, 442                            differentiable, 339, 379-380
      Riemann-Stieltjes, 125                        differential of, 381
      of vectors, 282                               inverse of, 396
Summation by parts, 218                             invertible, 396396
Supremum                                            linear, 362
      of a function, 60, 313                        one-to-one, 396
      of a set, 3                                   regular, 405
         existence and uniqueness of, 4       Transitivity of <, 31
Surface, 331                                  Transpose of a matrix, 370
      differentiable, 453                     Triangle inequality, 2, 285
                                                    in a metric space, 518
T                                             Triple integral, 439
Tangent                                       Trivial solution, 375

      to a curve, 75                          U
      line, 75                                Unbounded
      plane, 332
Taylor polynomial, 99, 351                          above, 7
      of a composite function, 109 (Exer-           below, 7
                                                    sequence, 292
            cise 2.5.11)                      Unconditional divergence, 233 (Exercise 4.3.38)
      of a product, 109 (Exercise 2.5.10)     Uniform continuity, 64, 72 (Exercises 2.2.30-
      of a reciprocal, 110 (Exercise 2.5.12)
Taylor series, 264                                        2.2.32), 546
      convergence of, 264
Taylor's theorem
                                                    Index 577

      for functions of n variables, 314, 392        Weierstrass's test, 246
            (Exercise 6.2.10)
                                                    Z
Uniform convergence                                 Zero content, 448, 460 (Exercises 7.1.14,
      properties preserved by
         continuity, 242                                        7.1.15), 461 (Exercises 7.1.16-
         differentiability, 243                                 7.1.19), 487, 514 (Exercise 7.3.2),
         integrability, 242                                     515 (Exercise. 7.3.11)
      of a sequence, 236                            Zero
      of a series, 246                                    multiplicity of, 108 (Exercises 2.5.5-
                                                                2.5.7)
Uniformly bounded set in C OEa; b, 541                    simple 108 (Exercise 2.5.5)
Union of sets, 20                                   Zeroth derivative, 73
Uniqueness

      of infimum, 7
      of limit, 35, 305, 527
      of power series, 263
      of prime factorization, 16 (Exercise 1.2.14)
      of Riemann integral, 125 (Exercise 3.1.1)
      of supremum, 4
Uniform continuity, 64, 66, 72 (Exercises 2.2.30-

            2.2.32)
Unit vector, 283
Universal set, 19
Upper bound, 3
Upper integral, 120, 442
Upper sum, 120, 442

V
Value

      of a function, 31, 32
      local maximum, 80
      local minimum, 80
      principal, 155
Variation, total, 134 (Exercise 3.2.7)
Vector, 283, 519
Vector space, 283, 519
      normed, 519
      subspace of, 519
Vector sum, 282
Vector, unit, 283
Vector-valued function, 362 (see p. 361)
      continuous, 379
      differentiable, 379-380

W
Weighted average, 139
